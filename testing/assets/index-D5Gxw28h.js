(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function af(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const nn={},Wl=[],_s=()=>{},Im=()=>!1,Ru=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),lf=e=>e.startsWith("onUpdate:"),Rn=Object.assign,rf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},F1=Object.prototype.hasOwnProperty,Kt=(e,t)=>F1.call(e,t),ut=Array.isArray,Zl=e=>cc(e)==="[object Map]",ar=e=>cc(e)==="[object Set]",Zf=e=>cc(e)==="[object Date]",_t=e=>typeof e=="function",fn=e=>typeof e=="string",Ss=e=>typeof e=="symbol",Qt=e=>e!==null&&typeof e=="object",xm=e=>(Qt(e)||_t(e))&&_t(e.then)&&_t(e.catch),$m=Object.prototype.toString,cc=e=>$m.call(e),U1=e=>cc(e).slice(8,-1),Tm=e=>cc(e)==="[object Object]",Ou=e=>fn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dr=af(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Nu=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},z1=/-\w/g,ts=Nu(e=>e.replace(z1,t=>t.slice(1).toUpperCase())),H1=/\B([A-Z])/g,gi=Nu(e=>e.replace(H1,"-$1").toLowerCase()),Bu=Nu(e=>e.charAt(0).toUpperCase()+e.slice(1)),kd=Nu(e=>e?`on${Bu(e)}`:""),ui=(e,t)=>!Object.is(e,t),Wc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Mm=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Fu=e=>{const t=parseFloat(e);return isNaN(t)?e:t},V1=e=>{const t=fn(e)?Number(e):NaN;return isNaN(t)?e:t};let Kf;const Uu=()=>Kf||(Kf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],o=fn(s)?W1(s):tt(s);if(o)for(const i in o)t[i]=o[i]}return t}else if(fn(e)||Qt(e))return e}const G1=/;(?![^(]*\))/g,q1=/:([^]+)/,j1=/\/\*[^]*?\*\//g;function W1(e){const t={};return e.replace(j1,"").split(G1).forEach(n=>{if(n){const s=n.split(q1);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function le(e){let t="";if(fn(e))t=e;else if(ut(e))for(let n=0;n<e.length;n++){const s=le(e[n]);s&&(t+=s+" ")}else if(Qt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Z1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",K1=af(Z1);function Am(e){return!!e||e===""}function Y1(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=el(e[s],t[s]);return n}function el(e,t){if(e===t)return!0;let n=Zf(e),s=Zf(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=Ss(e),s=Ss(t),n||s)return e===t;if(n=ut(e),s=ut(t),n||s)return n&&s?Y1(e,t):!1;if(n=Qt(e),s=Qt(t),n||s){if(!n||!s)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const l in e){const c=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(c&&!d||!c&&d||!el(e[l],t[l]))return!1}}return String(e)===String(t)}function cf(e,t){return e.findIndex(n=>el(n,t))}const Em=e=>!!(e&&e.__v_isRef===!0),b=e=>fn(e)?e:e==null?"":ut(e)||Qt(e)&&(e.toString===$m||!_t(e.toString))?Em(e)?b(e.value):JSON.stringify(e,Pm,2):String(e),Pm=(e,t)=>Em(t)?Pm(e,t.value):Zl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,o],i)=>(n[bd(s,i)+" =>"]=o,n),{})}:ar(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>bd(n))}:Ss(t)?bd(t):Qt(t)&&!ut(t)&&!Tm(t)?String(t):t,bd=(e,t="")=>{var n;return Ss(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function J1(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Yn;class Dm{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yn,!t&&Yn&&(this.index=(Yn.scopes||(Yn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Yn;try{return Yn=this,t()}finally{Yn=n}}}on(){++this._on===1&&(this.prevScope=Yn,Yn=this)}off(){this._on>0&&--this._on===0&&(Yn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Rm(e){return new Dm(e)}function Om(){return Yn}function X1(e,t=!1){Yn&&Yn.cleanups.push(e)}let sn;const wd=new WeakSet;class Nm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yn&&Yn.active&&Yn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wd.has(this)&&(wd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Fm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Yf(this),Um(this);const t=sn,n=Cs;sn=this,Cs=!0;try{return this.fn()}finally{zm(this),sn=t,Cs=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)hf(t);this.deps=this.depsTail=void 0,Yf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){wh(this)&&this.run()}get dirty(){return wh(this)}}let Bm=0,Rr,Or;function Fm(e,t=!1){if(e.flags|=8,t){e.next=Or,Or=e;return}e.next=Rr,Rr=e}function uf(){Bm++}function df(){if(--Bm>0)return;if(Or){let t=Or;for(Or=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Rr;){let t=Rr;for(Rr=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function Um(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function zm(e){let t,n=e.depsTail,s=n;for(;s;){const o=s.prevDep;s.version===-1?(s===n&&(n=o),hf(s),Q1(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=o}e.deps=t,e.depsTail=n}function wh(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Hm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Hm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Jr)||(e.globalVersion=Jr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!wh(e))))return;e.flags|=2;const t=e.dep,n=sn,s=Cs;sn=e,Cs=!0;try{Um(e);const o=e.fn(e._value);(t.version===0||ui(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{sn=n,Cs=s,zm(e),e.flags&=-3}}function hf(e,t=!1){const{dep:n,prevSub:s,nextSub:o}=e;if(s&&(s.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)hf(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Q1(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Cs=!0;const Vm=[];function Ca(){Vm.push(Cs),Cs=!1}function La(){const e=Vm.pop();Cs=e===void 0?!0:e}function Yf(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=sn;sn=void 0;try{t()}finally{sn=n}}}let Jr=0;class ek{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ff{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!sn||!Cs||sn===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==sn)n=this.activeLink=new ek(sn,this),sn.deps?(n.prevDep=sn.depsTail,sn.depsTail.nextDep=n,sn.depsTail=n):sn.deps=sn.depsTail=n,Gm(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=sn.depsTail,n.nextDep=void 0,sn.depsTail.nextDep=n,sn.depsTail=n,sn.deps===n&&(sn.deps=s)}return n}trigger(t){this.version++,Jr++,this.notify(t)}notify(t){uf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{df()}}}function Gm(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Gm(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const lu=new WeakMap,Yi=Symbol(""),_h=Symbol(""),Xr=Symbol("");function Qn(e,t,n){if(Cs&&sn){let s=lu.get(e);s||lu.set(e,s=new Map);let o=s.get(n);o||(s.set(n,o=new ff),o.map=s,o.key=n),o.track()}}function pa(e,t,n,s,o,i){const l=lu.get(e);if(!l){Jr++;return}const c=d=>{d&&d.trigger()};if(uf(),t==="clear")l.forEach(c);else{const d=ut(e),h=d&&Ou(n);if(d&&n==="length"){const f=Number(s);l.forEach((m,y)=>{(y==="length"||y===Xr||!Ss(y)&&y>=f)&&c(m)})}else switch((n!==void 0||l.has(void 0))&&c(l.get(n)),h&&c(l.get(Xr)),t){case"add":d?h&&c(l.get("length")):(c(l.get(Yi)),Zl(e)&&c(l.get(_h)));break;case"delete":d||(c(l.get(Yi)),Zl(e)&&c(l.get(_h)));break;case"set":Zl(e)&&c(l.get(Yi));break}}df()}function tk(e,t){const n=lu.get(e);return n&&n.get(t)}function Rl(e){const t=Ht(e);return t===e?t:(Qn(t,"iterate",Xr),Uo(e)?t:t.map(Is))}function zu(e){return Qn(e=Ht(e),"iterate",Xr),e}function ei(e,t){return Sa(e)?wa(e)?Ql(Is(t)):Ql(t):Is(t)}const nk={__proto__:null,[Symbol.iterator](){return _d(this,Symbol.iterator,e=>ei(this,e))},concat(...e){return Rl(this).concat(...e.map(t=>ut(t)?Rl(t):t))},entries(){return _d(this,"entries",e=>(e[1]=ei(this,e[1]),e))},every(e,t){return ra(this,"every",e,t,void 0,arguments)},filter(e,t){return ra(this,"filter",e,t,n=>n.map(s=>ei(this,s)),arguments)},find(e,t){return ra(this,"find",e,t,n=>ei(this,n),arguments)},findIndex(e,t){return ra(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return ra(this,"findLast",e,t,n=>ei(this,n),arguments)},findLastIndex(e,t){return ra(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return ra(this,"forEach",e,t,void 0,arguments)},includes(...e){return Cd(this,"includes",e)},indexOf(...e){return Cd(this,"indexOf",e)},join(e){return Rl(this).join(e)},lastIndexOf(...e){return Cd(this,"lastIndexOf",e)},map(e,t){return ra(this,"map",e,t,void 0,arguments)},pop(){return wr(this,"pop")},push(...e){return wr(this,"push",e)},reduce(e,...t){return Jf(this,"reduce",e,t)},reduceRight(e,...t){return Jf(this,"reduceRight",e,t)},shift(){return wr(this,"shift")},some(e,t){return ra(this,"some",e,t,void 0,arguments)},splice(...e){return wr(this,"splice",e)},toReversed(){return Rl(this).toReversed()},toSorted(e){return Rl(this).toSorted(e)},toSpliced(...e){return Rl(this).toSpliced(...e)},unshift(...e){return wr(this,"unshift",e)},values(){return _d(this,"values",e=>ei(this,e))}};function _d(e,t,n){const s=zu(e),o=s[t]();return s!==e&&!Uo(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=n(i.value)),i}),o}const ok=Array.prototype;function ra(e,t,n,s,o,i){const l=zu(e),c=l!==e&&!Uo(e),d=l[t];if(d!==ok[t]){const m=d.apply(e,i);return c?Is(m):m}let h=n;l!==e&&(c?h=function(m,y){return n.call(this,ei(e,m),y,e)}:n.length>2&&(h=function(m,y){return n.call(this,m,y,e)}));const f=d.call(l,h,s);return c&&o?o(f):f}function Jf(e,t,n,s){const o=zu(e);let i=n;return o!==e&&(Uo(e)?n.length>3&&(i=function(l,c,d){return n.call(this,l,c,d,e)}):i=function(l,c,d){return n.call(this,l,ei(e,c),d,e)}),o[t](i,...s)}function Cd(e,t,n){const s=Ht(e);Qn(s,"iterate",Xr);const o=s[t](...n);return(o===-1||o===!1)&&Hu(n[0])?(n[0]=Ht(n[0]),s[t](...n)):o}function wr(e,t,n=[]){Ca(),uf();const s=Ht(e)[t].apply(e,n);return df(),La(),s}const sk=af("__proto__,__v_isRef,__isVue"),qm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ss));function ak(e){Ss(e)||(e=String(e));const t=Ht(this);return Qn(t,"has",e),t.hasOwnProperty(e)}class jm{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(o?i?vk:Ym:i?Km:Zm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const l=ut(t);if(!o){let d;if(l&&(d=nk[n]))return d;if(n==="hasOwnProperty")return ak}const c=Reflect.get(t,n,hn(t)?t:s);if((Ss(n)?qm.has(n):sk(n))||(o||Qn(t,"get",n),i))return c;if(hn(c)){const d=l&&Ou(n)?c:c.value;return o&&Qt(d)?Lh(d):d}return Qt(c)?o?Lh(c):ol(c):c}}class Wm extends jm{constructor(t=!1){super(!1,t)}set(t,n,s,o){let i=t[n];const l=ut(t)&&Ou(n);if(!this._isShallow){const h=Sa(i);if(!Uo(s)&&!Sa(s)&&(i=Ht(i),s=Ht(s)),!l&&hn(i)&&!hn(s))return h||(i.value=s),!0}const c=l?Number(n)<t.length:Kt(t,n),d=Reflect.set(t,n,s,hn(t)?t:o);return t===Ht(o)&&(c?ui(s,i)&&pa(t,"set",n,s):pa(t,"add",n,s)),d}deleteProperty(t,n){const s=Kt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&s&&pa(t,"delete",n,void 0),o}has(t,n){const s=Reflect.has(t,n);return(!Ss(n)||!qm.has(n))&&Qn(t,"has",n),s}ownKeys(t){return Qn(t,"iterate",ut(t)?"length":Yi),Reflect.ownKeys(t)}}class ik extends jm{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const lk=new Wm,rk=new ik,ck=new Wm(!0);const Ch=e=>e,Pc=e=>Reflect.getPrototypeOf(e);function uk(e,t,n){return function(...s){const o=this.__v_raw,i=Ht(o),l=Zl(i),c=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=o[e](...s),f=n?Ch:t?Ql:Is;return!t&&Qn(i,"iterate",d?_h:Yi),{next(){const{value:m,done:y}=h.next();return y?{value:m,done:y}:{value:c?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Dc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function dk(e,t){const n={get(o){const i=this.__v_raw,l=Ht(i),c=Ht(o);e||(ui(o,c)&&Qn(l,"get",o),Qn(l,"get",c));const{has:d}=Pc(l),h=t?Ch:e?Ql:Is;if(d.call(l,o))return h(i.get(o));if(d.call(l,c))return h(i.get(c));i!==l&&i.get(o)},get size(){const o=this.__v_raw;return!e&&Qn(Ht(o),"iterate",Yi),o.size},has(o){const i=this.__v_raw,l=Ht(i),c=Ht(o);return e||(ui(o,c)&&Qn(l,"has",o),Qn(l,"has",c)),o===c?i.has(o):i.has(o)||i.has(c)},forEach(o,i){const l=this,c=l.__v_raw,d=Ht(c),h=t?Ch:e?Ql:Is;return!e&&Qn(d,"iterate",Yi),c.forEach((f,m)=>o.call(i,h(f),h(m),l))}};return Rn(n,e?{add:Dc("add"),set:Dc("set"),delete:Dc("delete"),clear:Dc("clear")}:{add(o){!t&&!Uo(o)&&!Sa(o)&&(o=Ht(o));const i=Ht(this);return Pc(i).has.call(i,o)||(i.add(o),pa(i,"add",o,o)),this},set(o,i){!t&&!Uo(i)&&!Sa(i)&&(i=Ht(i));const l=Ht(this),{has:c,get:d}=Pc(l);let h=c.call(l,o);h||(o=Ht(o),h=c.call(l,o));const f=d.call(l,o);return l.set(o,i),h?ui(i,f)&&pa(l,"set",o,i):pa(l,"add",o,i),this},delete(o){const i=Ht(this),{has:l,get:c}=Pc(i);let d=l.call(i,o);d||(o=Ht(o),d=l.call(i,o)),c&&c.call(i,o);const h=i.delete(o);return d&&pa(i,"delete",o,void 0),h},clear(){const o=Ht(this),i=o.size!==0,l=o.clear();return i&&pa(o,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=uk(o,e,t)}),n}function pf(e,t){const n=dk(e,t);return(s,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?s:Reflect.get(Kt(n,o)&&o in s?n:s,o,i)}const hk={get:pf(!1,!1)},fk={get:pf(!1,!0)},pk={get:pf(!0,!1)};const Zm=new WeakMap,Km=new WeakMap,Ym=new WeakMap,vk=new WeakMap;function mk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function gk(e){return e.__v_skip||!Object.isExtensible(e)?0:mk(U1(e))}function ol(e){return Sa(e)?e:vf(e,!1,lk,hk,Zm)}function Jm(e){return vf(e,!1,ck,fk,Km)}function Lh(e){return vf(e,!0,rk,pk,Ym)}function vf(e,t,n,s,o){if(!Qt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=gk(e);if(i===0)return e;const l=o.get(e);if(l)return l;const c=new Proxy(e,i===2?s:n);return o.set(e,c),c}function wa(e){return Sa(e)?wa(e.__v_raw):!!(e&&e.__v_isReactive)}function Sa(e){return!!(e&&e.__v_isReadonly)}function Uo(e){return!!(e&&e.__v_isShallow)}function Hu(e){return e?!!e.__v_raw:!1}function Ht(e){const t=e&&e.__v_raw;return t?Ht(t):e}function mf(e){return!Kt(e,"__v_skip")&&Object.isExtensible(e)&&Mm(e,"__v_skip",!0),e}const Is=e=>Qt(e)?ol(e):e,Ql=e=>Qt(e)?Lh(e):e;function hn(e){return e?e.__v_isRef===!0:!1}function D(e){return Xm(e,!1)}function yk(e){return Xm(e,!0)}function Xm(e,t){return hn(e)?e:new kk(e,t)}class kk{constructor(t,n){this.dep=new ff,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Ht(t),this._value=n?t:Is(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||Uo(t)||Sa(t);t=s?t:Ht(t),ui(t,n)&&(this._rawValue=t,this._value=s?t:Is(t),this.dep.trigger())}}function B(e){return hn(e)?e.value:e}function ru(e){return _t(e)?e():B(e)}const bk={get:(e,t,n)=>t==="__v_raw"?e:B(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const o=e[t];return hn(o)&&!hn(n)?(o.value=n,!0):Reflect.set(e,t,n,s)}};function Qm(e){return wa(e)?e:new Proxy(e,bk)}function wk(e){const t=ut(e)?new Array(e.length):{};for(const n in e)t[n]=Ck(e,n);return t}class _k{constructor(t,n,s){this._object=t,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Ht(t);let o=!0,i=t;if(!ut(t)||!Ou(String(n)))do o=!Hu(i)||Uo(i);while(o&&(i=i.__v_raw));this._shallow=o}get value(){let t=this._object[this._key];return this._shallow&&(t=B(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&hn(this._raw[this._key])){const n=this._object[this._key];if(hn(n)){n.value=t;return}}this._object[this._key]=t}get dep(){return tk(this._raw,this._key)}}function Ck(e,t,n){return new _k(e,t,n)}class Lk{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new ff(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Jr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&sn!==this)return Fm(this,!0),!0}get value(){const t=this.dep.track();return Hm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Sk(e,t,n=!1){let s,o;return _t(e)?s=e:(s=e.get,o=e.set),new Lk(s,o,n)}const Rc={},cu=new WeakMap;let Hi;function Ik(e,t=!1,n=Hi){if(n){let s=cu.get(n);s||cu.set(n,s=[]),s.push(e)}}function xk(e,t,n=nn){const{immediate:s,deep:o,once:i,scheduler:l,augmentJob:c,call:d}=n,h=S=>o?S:Uo(S)||o===!1||o===0?va(S,1):va(S);let f,m,y,k,w=!1,x=!1;if(hn(e)?(m=()=>e.value,w=Uo(e)):wa(e)?(m=()=>h(e),w=!0):ut(e)?(x=!0,w=e.some(S=>wa(S)||Uo(S)),m=()=>e.map(S=>{if(hn(S))return S.value;if(wa(S))return h(S);if(_t(S))return d?d(S,2):S()})):_t(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){Ca();try{y()}finally{La()}}const S=Hi;Hi=f;try{return d?d(e,3,[k]):e(k)}finally{Hi=S}}:m=_s,t&&o){const S=m,$=o===!0?1/0:o;m=()=>va(S(),$)}const A=Om(),E=()=>{f.stop(),A&&A.active&&rf(A.effects,f)};if(i&&t){const S=t;t=(...$)=>{S(...$),E()}}let _=x?new Array(e.length).fill(Rc):Rc;const C=S=>{if(!(!(f.flags&1)||!f.dirty&&!S))if(t){const $=f.run();if(o||w||(x?$.some((R,T)=>ui(R,_[T])):ui($,_))){y&&y();const R=Hi;Hi=f;try{const T=[$,_===Rc?void 0:x&&_[0]===Rc?[]:_,k];_=$,d?d(t,3,T):t(...T)}finally{Hi=R}}}else f.run()};return c&&c(C),f=new Nm(m),f.scheduler=l?()=>l(C,!1):C,k=S=>Ik(S,!1,f),y=f.onStop=()=>{const S=cu.get(f);if(S){if(d)d(S,4);else for(const $ of S)$();cu.delete(f)}},t?s?C(!0):_=f.run():l?l(C.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function va(e,t=1/0,n){if(t<=0||!Qt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,hn(e))va(e.value,t,n);else if(ut(e))for(let s=0;s<e.length;s++)va(e[s],t,n);else if(ar(e)||Zl(e))e.forEach(s=>{va(s,t,n)});else if(Tm(e)){for(const s in e)va(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&va(e[s],t,n)}return e}function uc(e,t,n,s){try{return s?e(...s):e()}catch(o){Vu(o,t,n)}}function xs(e,t,n,s){if(_t(e)){const o=uc(e,t,n,s);return o&&xm(o)&&o.catch(i=>{Vu(i,t,n)}),o}if(ut(e)){const o=[];for(let i=0;i<e.length;i++)o.push(xs(e[i],t,n,s));return o}}function Vu(e,t,n,s=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||nn;if(t){let c=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${n}`;for(;c;){const f=c.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,h)===!1)return}c=c.parent}if(i){Ca(),uc(i,null,10,[e,d,h]),La();return}}$k(e,n,o,s,l)}function $k(e,t,n,s=!0,o=!1){if(o)throw e;console.error(e)}const mo=[];let Vs=-1;const Kl=[];let ti=null,Ul=0;const eg=Promise.resolve();let uu=null;function rn(e){const t=uu||eg;return e?t.then(this?e.bind(this):e):t}function Tk(e){let t=Vs+1,n=mo.length;for(;t<n;){const s=t+n>>>1,o=mo[s],i=Qr(o);i<e||i===e&&o.flags&2?t=s+1:n=s}return t}function gf(e){if(!(e.flags&1)){const t=Qr(e),n=mo[mo.length-1];!n||!(e.flags&2)&&t>=Qr(n)?mo.push(e):mo.splice(Tk(t),0,e),e.flags|=1,tg()}}function tg(){uu||(uu=eg.then(sg))}function ng(e){ut(e)?Kl.push(...e):ti&&e.id===-1?ti.splice(Ul+1,0,e):e.flags&1||(Kl.push(e),e.flags|=1),tg()}function Xf(e,t,n=Vs+1){for(;n<mo.length;n++){const s=mo[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;mo.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function og(e){if(Kl.length){const t=[...new Set(Kl)].sort((n,s)=>Qr(n)-Qr(s));if(Kl.length=0,ti){ti.push(...t);return}for(ti=t,Ul=0;Ul<ti.length;Ul++){const n=ti[Ul];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ti=null,Ul=0}}const Qr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sg(e){try{for(Vs=0;Vs<mo.length;Vs++){const t=mo[Vs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),uc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Vs<mo.length;Vs++){const t=mo[Vs];t&&(t.flags&=-2)}Vs=-1,mo.length=0,og(),uu=null,(mo.length||Kl.length)&&sg()}}let Hn=null,ag=null;function du(e){const t=Hn;return Hn=e,ag=e&&e.type.__scopeId||null,t}function Ve(e,t=Hn,n){if(!t||e._n)return e;const s=(...o)=>{s._d&&pu(-1);const i=du(t);let l;try{l=e(...o)}finally{du(i),s._d&&pu(1)}return l};return s._n=!0,s._c=!0,s._d=!0,s}function We(e,t){if(Hn===null)return e;const n=Ku(Hn),s=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,l,c,d=nn]=t[o];i&&(_t(i)&&(i={mounted:i,updated:i}),i.deep&&va(l),s.push({dir:i,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d}))}return e}function Ri(e,t,n,s){const o=e.dirs,i=t&&t.dirs;for(let l=0;l<o.length;l++){const c=o[l];i&&(c.oldValue=i[l].value);let d=c.dir[s];d&&(Ca(),xs(d,n,8,[e.el,c,e,t]),La())}}function Nr(e,t){if(to){let n=to.provides;const s=to.parent&&to.parent.provides;s===n&&(n=to.provides=Object.create(s)),n[e]=t}}function $o(e,t,n=!1){const s=Zu();if(s||Ji){let o=Ji?Ji._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&_t(t)?t.call(s&&s.proxy):t}}function Mk(){return!!(Zu()||Ji)}const Ak=Symbol.for("v-scx"),Ek=()=>$o(Ak);function Ye(e,t,n){return ig(e,t,n)}function ig(e,t,n=nn){const{immediate:s,deep:o,flush:i,once:l}=n,c=Rn({},n),d=t&&s||!t&&i!=="post";let h;if(sc){if(i==="sync"){const k=Ek();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=_s,k.resume=_s,k.pause=_s,k}}const f=to;c.call=(k,w,x)=>xs(k,f,w,x);let m=!1;i==="post"?c.scheduler=k=>{po(k,f&&f.suspense)}:i!=="sync"&&(m=!0,c.scheduler=(k,w)=>{w?k():gf(k)}),c.augmentJob=k=>{t&&(k.flags|=4),m&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const y=xk(e,t,c);return sc&&(h?h.push(y):d&&y()),y}function Pk(e,t,n){const s=this.proxy,o=fn(e)?e.includes(".")?lg(s,e):()=>s[e]:e.bind(s,s);let i;_t(t)?i=t:(i=t.handler,n=t);const l=dc(this),c=ig(o,i.bind(s),n);return l(),c}function lg(e,t){const n=t.split(".");return()=>{let s=e;for(let o=0;o<n.length&&s;o++)s=s[n[o]];return s}}const rg=Symbol("_vte"),cg=e=>e.__isTeleport,Br=e=>e&&(e.disabled||e.disabled===""),Qf=e=>e&&(e.defer||e.defer===""),ep=e=>typeof SVGElement<"u"&&e instanceof SVGElement,tp=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Sh=(e,t)=>{const n=e&&e.to;return fn(n)?t?t(n):null:n},ug={name:"Teleport",__isTeleport:!0,process(e,t,n,s,o,i,l,c,d,h){const{mc:f,pc:m,pbc:y,o:{insert:k,querySelector:w,createText:x,createComment:A}}=h,E=Br(t.props);let{shapeFlag:_,children:C,dynamicChildren:S}=t;if(e==null){const $=t.el=x(""),R=t.anchor=x("");k($,n,s),k(R,n,s);const T=(M,U)=>{_&16&&f(C,M,U,o,i,l,c,d)},O=()=>{const M=t.target=Sh(t.props,w),U=dg(M,t,x,k);M&&(l!=="svg"&&ep(M)?l="svg":l!=="mathml"&&tp(M)&&(l="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(M),E||(T(M,U),Zc(t,!1)))};E&&(T(n,R),Zc(t,!0)),Qf(t.props)?(t.el.__isMounted=!1,po(()=>{O(),delete t.el.__isMounted},i)):O()}else{if(Qf(t.props)&&e.el.__isMounted===!1){po(()=>{ug.process(e,t,n,s,o,i,l,c,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const $=t.anchor=e.anchor,R=t.target=e.target,T=t.targetAnchor=e.targetAnchor,O=Br(e.props),M=O?n:R,U=O?$:T;if(l==="svg"||ep(R)?l="svg":(l==="mathml"||tp(R))&&(l="mathml"),S?(y(e.dynamicChildren,S,M,o,i,l,c),_f(e,t,!0)):d||m(e,t,M,U,o,i,l,c,!1),E)O?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Oc(t,n,$,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=Sh(t.props,w);F&&Oc(t,F,null,h,0)}else O&&Oc(t,R,T,h,1);Zc(t,E)}},remove(e,t,n,{um:s,o:{remove:o}},i){const{shapeFlag:l,children:c,anchor:d,targetStart:h,targetAnchor:f,target:m,props:y}=e;if(m&&(o(h),o(f)),i&&o(d),l&16){const k=i||!Br(y);for(let w=0;w<c.length;w++){const x=c[w];s(x,t,n,k,!!x.dynamicChildren)}}},move:Oc,hydrate:Dk};function Oc(e,t,n,{o:{insert:s},m:o},i=2){i===0&&s(e.targetAnchor,t,n);const{el:l,anchor:c,shapeFlag:d,children:h,props:f}=e,m=i===2;if(m&&s(l,t,n),(!m||Br(f))&&d&16)for(let y=0;y<h.length;y++)o(h[y],t,n,2);m&&s(c,t,n)}function Dk(e,t,n,s,o,i,{o:{nextSibling:l,parentNode:c,querySelector:d,insert:h,createText:f}},m){function y(x,A,E,_){A.anchor=m(l(x),A,c(x),n,s,o,i),A.targetStart=E,A.targetAnchor=_}const k=t.target=Sh(t.props,d),w=Br(t.props);if(k){const x=k._lpa||k.firstChild;if(t.shapeFlag&16)if(w)y(e,t,x,x&&l(x));else{t.anchor=l(e);let A=x;for(;A;){if(A&&A.nodeType===8){if(A.data==="teleport start anchor")t.targetStart=A;else if(A.data==="teleport anchor"){t.targetAnchor=A,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}A=l(A)}t.targetAnchor||dg(k,t,f,h),m(x&&l(x),t,k,n,s,o,i)}Zc(t,w)}else w&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const ec=ug;function Zc(e,t){const n=e.ctx;if(n&&n.ut){let s,o;for(t?(s=e.el,o=e.anchor):(s=e.targetStart,o=e.targetAnchor);s&&s!==o;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function dg(e,t,n,s){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[rg]=i,e&&(s(o,e),s(i,e)),i}const fa=Symbol("_leaveCb"),Nc=Symbol("_enterCb");function Rk(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return cn(()=>{e.isMounted=!0}),wg(()=>{e.isUnmounting=!0}),e}const Yo=[Function,Array],hg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Yo,onEnter:Yo,onAfterEnter:Yo,onEnterCancelled:Yo,onBeforeLeave:Yo,onLeave:Yo,onAfterLeave:Yo,onLeaveCancelled:Yo,onBeforeAppear:Yo,onAppear:Yo,onAfterAppear:Yo,onAppearCancelled:Yo},fg=e=>{const t=e.subTree;return t.component?fg(t.component):t},Ok={name:"BaseTransition",props:hg,setup(e,{slots:t}){const n=Zu(),s=Rk();return()=>{const o=t.default&&mg(t.default(),!0);if(!o||!o.length)return;const i=pg(o),l=Ht(e),{mode:c}=l;if(s.isLeaving)return Ld(i);const d=np(i);if(!d)return Ld(i);let h=Ih(d,l,s,n,m=>h=m);d.type!==eo&&tc(d,h);let f=n.subTree&&np(n.subTree);if(f&&f.type!==eo&&!Gi(f,d)&&fg(n).type!==eo){let m=Ih(f,l,s,n);if(tc(f,m),c==="out-in"&&d.type!==eo)return s.isLeaving=!0,m.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete m.afterLeave,f=void 0},Ld(i);c==="in-out"&&d.type!==eo?m.delayLeave=(y,k,w)=>{const x=vg(s,f);x[String(f.key)]=f,y[fa]=()=>{k(),y[fa]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{w(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function pg(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==eo){t=n;break}}return t}const Nk=Ok;function vg(e,t){const{leavingVNodes:n}=e;let s=n.get(t.type);return s||(s=Object.create(null),n.set(t.type,s)),s}function Ih(e,t,n,s,o){const{appear:i,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:k,onAfterLeave:w,onLeaveCancelled:x,onBeforeAppear:A,onAppear:E,onAfterAppear:_,onAppearCancelled:C}=t,S=String(e.key),$=vg(n,e),R=(M,U)=>{M&&xs(M,s,9,U)},T=(M,U)=>{const F=U[1];R(M,U),ut(M)?M.every(j=>j.length<=1)&&F():M.length<=1&&F()},O={mode:l,persisted:c,beforeEnter(M){let U=d;if(!n.isMounted)if(i)U=A||d;else return;M[fa]&&M[fa](!0);const F=$[S];F&&Gi(e,F)&&F.el[fa]&&F.el[fa](),R(U,[M])},enter(M){let U=h,F=f,j=m;if(!n.isMounted)if(i)U=E||h,F=_||f,j=C||m;else return;let Z=!1;const Q=M[Nc]=re=>{Z||(Z=!0,re?R(j,[M]):R(F,[M]),O.delayedLeave&&O.delayedLeave(),M[Nc]=void 0)};U?T(U,[M,Q]):Q()},leave(M,U){const F=String(e.key);if(M[Nc]&&M[Nc](!0),n.isUnmounting)return U();R(y,[M]);let j=!1;const Z=M[fa]=Q=>{j||(j=!0,U(),Q?R(x,[M]):R(w,[M]),M[fa]=void 0,$[F]===e&&delete $[F])};$[F]=e,k?T(k,[M,Z]):Z()},clone(M){const U=Ih(M,t,n,s,o);return o&&o(U),U}};return O}function Ld(e){if(Gu(e))return e=fi(e),e.children=null,e}function np(e){if(!Gu(e))return cg(e.type)&&e.children?pg(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&_t(n.default))return n.default()}}function tc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,tc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function mg(e,t=!1,n){let s=[],o=0;for(let i=0;i<e.length;i++){let l=e[i];const c=n==null?l.key:String(n)+String(l.key!=null?l.key:i);l.type===Se?(l.patchFlag&128&&o++,s=s.concat(mg(l.children,t,c))):(t||l.type!==eo)&&s.push(c!=null?fi(l,{key:c}):l)}if(o>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function gg(e,t){return _t(e)?Rn({name:e.name},t,{setup:e}):e}function yg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const hu=new WeakMap;function Fr(e,t,n,s,o=!1){if(ut(e)){e.forEach((w,x)=>Fr(w,t&&(ut(t)?t[x]:t),n,s,o));return}if(Yl(s)&&!o){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Fr(e,t,n,s.component.subTree);return}const i=s.shapeFlag&4?Ku(s.component):s.el,l=o?null:i,{i:c,r:d}=e,h=t&&t.r,f=c.refs===nn?c.refs={}:c.refs,m=c.setupState,y=Ht(m),k=m===nn?Im:w=>Kt(y,w);if(h!=null&&h!==d){if(op(t),fn(h))f[h]=null,k(h)&&(m[h]=null);else if(hn(h)){h.value=null;const w=t;w.k&&(f[w.k]=null)}}if(_t(d))uc(d,c,12,[l,f]);else{const w=fn(d),x=hn(d);if(w||x){const A=()=>{if(e.f){const E=w?k(d)?m[d]:f[d]:d.value;if(o)ut(E)&&rf(E,i);else if(ut(E))E.includes(i)||E.push(i);else if(w)f[d]=[i],k(d)&&(m[d]=f[d]);else{const _=[i];d.value=_,e.k&&(f[e.k]=_)}}else w?(f[d]=l,k(d)&&(m[d]=l)):x&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const E=()=>{A(),hu.delete(e)};E.id=-1,hu.set(e,E),po(E,n)}else op(e),A()}}}function op(e){const t=hu.get(e);t&&(t.flags|=8,hu.delete(e))}Uu().requestIdleCallback;Uu().cancelIdleCallback;const Yl=e=>!!e.type.__asyncLoader,Gu=e=>e.type.__isKeepAlive;function Bk(e,t){kg(e,"a",t)}function Fk(e,t){kg(e,"da",t)}function kg(e,t,n=to){const s=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(qu(t,s,n),n){let o=n.parent;for(;o&&o.parent;)Gu(o.parent.vnode)&&Uk(s,t,n,o),o=o.parent}}function Uk(e,t,n,s){const o=qu(t,e,s,!0);In(()=>{rf(s[t],o)},n)}function qu(e,t,n=to,s=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Ca();const c=dc(n),d=xs(t,n,e,l);return c(),La(),d});return s?o.unshift(i):o.push(i),i}}const xa=e=>(t,n=to)=>{(!sc||e==="sp")&&qu(e,(...s)=>t(...s),n)},zk=xa("bm"),cn=xa("m"),bg=xa("bu"),Hk=xa("u"),wg=xa("bum"),In=xa("um"),Vk=xa("sp"),Gk=xa("rtg"),qk=xa("rtc");function jk(e,t=to){qu("ec",e,t)}const _g="components";function yf(e,t){return Lg(_g,e,!0,t)||e}const Cg=Symbol.for("v-ndc");function Wk(e){return fn(e)?Lg(_g,e,!1)||e:e||Cg}function Lg(e,t,n=!0,s=!1){const o=Hn||to;if(o){const i=o.type;{const c=M0(i,!1);if(c&&(c===t||c===ts(t)||c===Bu(ts(t))))return i}const l=sp(o[e]||i[e],t)||sp(o.appContext[e],t);return!l&&s?i:l}}function sp(e,t){return e&&(e[t]||e[ts(t)]||e[Bu(ts(t))])}function je(e,t,n,s){let o;const i=n,l=ut(e);if(l||fn(e)){const c=l&&wa(e);let d=!1,h=!1;c&&(d=!Uo(e),h=Sa(e),e=zu(e)),o=new Array(e.length);for(let f=0,m=e.length;f<m;f++)o[f]=t(d?h?Ql(Is(e[f])):Is(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let c=0;c<e;c++)o[c]=t(c+1,c,void 0,i)}else if(Qt(e))if(e[Symbol.iterator])o=Array.from(e,(c,d)=>t(c,d,void 0,i));else{const c=Object.keys(e);o=new Array(c.length);for(let d=0,h=c.length;d<h;d++){const f=c[d];o[d]=t(e[f],f,d,i)}}else o=[];return o}function kf(e,t){for(let n=0;n<t.length;n++){const s=t[n];if(ut(s))for(let o=0;o<s.length;o++)e[s[o].name]=s[o].fn;else s&&(e[s.name]=s.key?(...o)=>{const i=s.fn(...o);return i&&(i.key=s.key),i}:s.fn)}return e}function go(e,t,n={},s,o){if(Hn.ce||Hn.parent&&Yl(Hn.parent)&&Hn.parent.ce){const h=Object.keys(n).length>0;return t!=="default"&&(n.name=t),p(),Ge(Se,null,[Pe("slot",n,s&&s())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),p();const l=i&&Sg(i(n)),c=n.key||l&&l.key,d=Ge(Se,{key:(c&&!Ss(c)?c:`_${t}`)+(!l&&s?"_fb":"")},l||(s?s():[]),l&&e._===1?64:-2);return!o&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function Sg(e){return e.some(t=>oc(t)?!(t.type===eo||t.type===Se&&!Sg(t.children)):!0)?e:null}const xh=e=>e?Gg(e)?Ku(e):xh(e.parent):null,Ur=Rn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>xh(e.parent),$root:e=>xh(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>xg(e),$forceUpdate:e=>e.f||(e.f=()=>{gf(e.update)}),$nextTick:e=>e.n||(e.n=rn.bind(e.proxy)),$watch:e=>Pk.bind(e)}),Sd=(e,t)=>e!==nn&&!e.__isScriptSetup&&Kt(e,t),Zk={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:o,props:i,accessCache:l,type:c,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return s[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(Sd(s,t))return l[t]=1,s[t];if(o!==nn&&Kt(o,t))return l[t]=2,o[t];if(Kt(i,t))return l[t]=3,i[t];if(n!==nn&&Kt(n,t))return l[t]=4,n[t];$h&&(l[t]=0)}}const h=Ur[t];let f,m;if(h)return t==="$attrs"&&Qn(e.attrs,"get",""),h(e);if((f=c.__cssModules)&&(f=f[t]))return f;if(n!==nn&&Kt(n,t))return l[t]=4,n[t];if(m=d.config.globalProperties,Kt(m,t))return m[t]},set({_:e},t,n){const{data:s,setupState:o,ctx:i}=e;return Sd(o,t)?(o[t]=n,!0):s!==nn&&Kt(s,t)?(s[t]=n,!0):Kt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:o,props:i,type:l}},c){let d;return!!(n[c]||e!==nn&&c[0]!=="$"&&Kt(e,c)||Sd(t,c)||Kt(i,c)||Kt(s,c)||Kt(Ur,c)||Kt(o.config.globalProperties,c)||(d=l.__cssModules)&&d[c])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Kt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function ap(e){return ut(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let $h=!0;function Kk(e){const t=xg(e),n=e.proxy,s=e.ctx;$h=!1,t.beforeCreate&&ip(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:l,watch:c,provide:d,inject:h,created:f,beforeMount:m,mounted:y,beforeUpdate:k,updated:w,activated:x,deactivated:A,beforeDestroy:E,beforeUnmount:_,destroyed:C,unmounted:S,render:$,renderTracked:R,renderTriggered:T,errorCaptured:O,serverPrefetch:M,expose:U,inheritAttrs:F,components:j,directives:Z,filters:Q}=t;if(h&&Yk(h,s,null),l)for(const ae in l){const q=l[ae];_t(q)&&(s[ae]=q.bind(n))}if(o){const ae=o.call(n,n);Qt(ae)&&(e.data=ol(ae))}if($h=!0,i)for(const ae in i){const q=i[ae],Y=_t(q)?q.bind(n,n):_t(q.get)?q.get.bind(n,n):_s,te=!_t(q)&&_t(q.set)?q.set.bind(n):_s,ue=H({get:Y,set:te});Object.defineProperty(s,ae,{enumerable:!0,configurable:!0,get:()=>ue.value,set:_e=>ue.value=_e})}if(c)for(const ae in c)Ig(c[ae],s,n,ae);if(d){const ae=_t(d)?d.call(n):d;Reflect.ownKeys(ae).forEach(q=>{Nr(q,ae[q])})}f&&ip(f,e,"c");function K(ae,q){ut(q)?q.forEach(Y=>ae(Y.bind(n))):q&&ae(q.bind(n))}if(K(zk,m),K(cn,y),K(bg,k),K(Hk,w),K(Bk,x),K(Fk,A),K(jk,O),K(qk,R),K(Gk,T),K(wg,_),K(In,S),K(Vk,M),ut(U))if(U.length){const ae=e.exposed||(e.exposed={});U.forEach(q=>{Object.defineProperty(ae,q,{get:()=>n[q],set:Y=>n[q]=Y,enumerable:!0})})}else e.exposed||(e.exposed={});$&&e.render===_s&&(e.render=$),F!=null&&(e.inheritAttrs=F),j&&(e.components=j),Z&&(e.directives=Z),M&&yg(e)}function Yk(e,t,n=_s){ut(e)&&(e=Th(e));for(const s in e){const o=e[s];let i;Qt(o)?"default"in o?i=$o(o.from||s,o.default,!0):i=$o(o.from||s):i=$o(o),hn(i)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[s]=i}}function ip(e,t,n){xs(ut(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function Ig(e,t,n,s){let o=s.includes(".")?lg(n,s):()=>n[s];if(fn(e)){const i=t[e];_t(i)&&Ye(o,i)}else if(_t(e))Ye(o,e.bind(n));else if(Qt(e))if(ut(e))e.forEach(i=>Ig(i,t,n,s));else{const i=_t(e.handler)?e.handler.bind(n):t[e.handler];_t(i)&&Ye(o,i,e)}}function xg(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,c=i.get(t);let d;return c?d=c:!o.length&&!n&&!s?d=t:(d={},o.length&&o.forEach(h=>fu(d,h,l,!0)),fu(d,t,l)),Qt(t)&&i.set(t,d),d}function fu(e,t,n,s=!1){const{mixins:o,extends:i}=t;i&&fu(e,i,n,!0),o&&o.forEach(l=>fu(e,l,n,!0));for(const l in t)if(!(s&&l==="expose")){const c=Jk[l]||n&&n[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const Jk={data:lp,props:rp,emits:rp,methods:xr,computed:xr,beforeCreate:ho,created:ho,beforeMount:ho,mounted:ho,beforeUpdate:ho,updated:ho,beforeDestroy:ho,beforeUnmount:ho,destroyed:ho,unmounted:ho,activated:ho,deactivated:ho,errorCaptured:ho,serverPrefetch:ho,components:xr,directives:xr,watch:Qk,provide:lp,inject:Xk};function lp(e,t){return t?e?function(){return Rn(_t(e)?e.call(this,this):e,_t(t)?t.call(this,this):t)}:t:e}function Xk(e,t){return xr(Th(e),Th(t))}function Th(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ho(e,t){return e?[...new Set([].concat(e,t))]:t}function xr(e,t){return e?Rn(Object.create(null),e,t):t}function rp(e,t){return e?ut(e)&&ut(t)?[...new Set([...e,...t])]:Rn(Object.create(null),ap(e),ap(t??{})):t}function Qk(e,t){if(!e)return t;if(!t)return e;const n=Rn(Object.create(null),e);for(const s in t)n[s]=ho(e[s],t[s]);return n}function $g(){return{app:null,config:{isNativeTag:Im,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let e0=0;function t0(e,t){return function(s,o=null){_t(s)||(s=Rn({},s)),o!=null&&!Qt(o)&&(o=null);const i=$g(),l=new WeakSet,c=[];let d=!1;const h=i.app={_uid:e0++,_component:s,_props:o,_container:null,_context:i,_instance:null,version:E0,get config(){return i.config},set config(f){},use(f,...m){return l.has(f)||(f&&_t(f.install)?(l.add(f),f.install(h,...m)):_t(f)&&(l.add(f),f(h,...m))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,m){return m?(i.components[f]=m,h):i.components[f]},directive(f,m){return m?(i.directives[f]=m,h):i.directives[f]},mount(f,m,y){if(!d){const k=h._ceVNode||Pe(s,o);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,f,y),d=!0,h._container=f,f.__vue_app__=h,Ku(k.component)}},onUnmount(f){c.push(f)},unmount(){d&&(xs(c,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,m){return i.provides[f]=m,h},runWithContext(f){const m=Ji;Ji=h;try{return f()}finally{Ji=m}}};return h}}let Ji=null;const n0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ts(t)}Modifiers`]||e[`${gi(t)}Modifiers`];function o0(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||nn;let o=n;const i=t.startsWith("update:"),l=i&&n0(s,t.slice(7));l&&(l.trim&&(o=n.map(f=>fn(f)?f.trim():f)),l.number&&(o=n.map(Fu)));let c,d=s[c=kd(t)]||s[c=kd(ts(t))];!d&&i&&(d=s[c=kd(gi(t))]),d&&xs(d,e,6,o);const h=s[c+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,xs(h,e,6,o)}}const s0=new WeakMap;function Tg(e,t,n=!1){const s=n?s0:t.emitsCache,o=s.get(e);if(o!==void 0)return o;const i=e.emits;let l={},c=!1;if(!_t(e)){const d=h=>{const f=Tg(h,t,!0);f&&(c=!0,Rn(l,f))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!c?(Qt(e)&&s.set(e,null),null):(ut(i)?i.forEach(d=>l[d]=null):Rn(l,i),Qt(e)&&s.set(e,l),l)}function ju(e,t){return!e||!Ru(t)?!1:(t=t.slice(2).replace(/Once$/,""),Kt(e,t[0].toLowerCase()+t.slice(1))||Kt(e,gi(t))||Kt(e,t))}function cp(e){const{type:t,vnode:n,proxy:s,withProxy:o,propsOptions:[i],slots:l,attrs:c,emit:d,render:h,renderCache:f,props:m,data:y,setupState:k,ctx:w,inheritAttrs:x}=e,A=du(e);let E,_;try{if(n.shapeFlag&4){const S=o||s,$=S;E=qs(h.call($,S,f,m,k,y,w)),_=c}else{const S=t;E=qs(S.length>1?S(m,{attrs:c,slots:l,emit:d}):S(m,null)),_=t.props?c:a0(c)}}catch(S){Hr.length=0,Vu(S,e,1),E=Pe(eo)}let C=E;if(_&&x!==!1){const S=Object.keys(_),{shapeFlag:$}=C;S.length&&$&7&&(i&&S.some(lf)&&(_=i0(_,i)),C=fi(C,_,!1,!0))}return n.dirs&&(C=fi(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(n.dirs):n.dirs),n.transition&&tc(C,n.transition),E=C,du(A),E}const a0=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ru(n))&&((t||(t={}))[n]=e[n]);return t},i0=(e,t)=>{const n={};for(const s in e)(!lf(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function l0(e,t,n){const{props:s,children:o,component:i}=e,{props:l,children:c,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return s?up(s,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==s[y]&&!ju(h,y))return!0}}}else return(o||c)&&(!c||!c.$stable)?!0:s===l?!1:s?l?up(s,l,h):!0:!!l;return!1}function up(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let o=0;o<s.length;o++){const i=s[o];if(t[i]!==e[i]&&!ju(n,i))return!0}return!1}function r0({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const Mg={},Ag=()=>Object.create(Mg),Eg=e=>Object.getPrototypeOf(e)===Mg;function c0(e,t,n,s=!1){const o={},i=Ag();e.propsDefaults=Object.create(null),Pg(e,t,o,i);for(const l in e.propsOptions[0])l in o||(o[l]=void 0);n?e.props=s?o:Jm(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function u0(e,t,n,s){const{props:o,attrs:i,vnode:{patchFlag:l}}=e,c=Ht(o),[d]=e.propsOptions;let h=!1;if((s||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(ju(e.emitsOptions,y))continue;const k=t[y];if(d)if(Kt(i,y))k!==i[y]&&(i[y]=k,h=!0);else{const w=ts(y);o[w]=Mh(d,c,w,k,e,!1)}else k!==i[y]&&(i[y]=k,h=!0)}}}else{Pg(e,t,o,i)&&(h=!0);let f;for(const m in c)(!t||!Kt(t,m)&&((f=gi(m))===m||!Kt(t,f)))&&(d?n&&(n[m]!==void 0||n[f]!==void 0)&&(o[m]=Mh(d,c,m,void 0,e,!0)):delete o[m]);if(i!==c)for(const m in i)(!t||!Kt(t,m))&&(delete i[m],h=!0)}h&&pa(e.attrs,"set","")}function Pg(e,t,n,s){const[o,i]=e.propsOptions;let l=!1,c;if(t)for(let d in t){if(Dr(d))continue;const h=t[d];let f;o&&Kt(o,f=ts(d))?!i||!i.includes(f)?n[f]=h:(c||(c={}))[f]=h:ju(e.emitsOptions,d)||(!(d in s)||h!==s[d])&&(s[d]=h,l=!0)}if(i){const d=Ht(n),h=c||nn;for(let f=0;f<i.length;f++){const m=i[f];n[m]=Mh(o,d,m,h[m],e,!Kt(h,m))}}return l}function Mh(e,t,n,s,o,i){const l=e[n];if(l!=null){const c=Kt(l,"default");if(c&&s===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&_t(d)){const{propsDefaults:h}=o;if(n in h)s=h[n];else{const f=dc(o);s=h[n]=d.call(null,t),f()}}else s=d;o.ce&&o.ce._setProp(n,s)}l[0]&&(i&&!c?s=!1:l[1]&&(s===""||s===gi(n))&&(s=!0))}return s}const d0=new WeakMap;function Dg(e,t,n=!1){const s=n?d0:t.propsCache,o=s.get(e);if(o)return o;const i=e.props,l={},c=[];let d=!1;if(!_t(e)){const f=m=>{d=!0;const[y,k]=Dg(m,t,!0);Rn(l,y),k&&c.push(...k)};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Qt(e)&&s.set(e,Wl),Wl;if(ut(i))for(let f=0;f<i.length;f++){const m=ts(i[f]);dp(m)&&(l[m]=nn)}else if(i)for(const f in i){const m=ts(f);if(dp(m)){const y=i[f],k=l[m]=ut(y)||_t(y)?{type:y}:Rn({},y),w=k.type;let x=!1,A=!0;if(ut(w))for(let E=0;E<w.length;++E){const _=w[E],C=_t(_)&&_.name;if(C==="Boolean"){x=!0;break}else C==="String"&&(A=!1)}else x=_t(w)&&w.name==="Boolean";k[0]=x,k[1]=A,(x||Kt(k,"default"))&&c.push(m)}}const h=[l,c];return Qt(e)&&s.set(e,h),h}function dp(e){return e[0]!=="$"&&!Dr(e)}const bf=e=>e==="_"||e==="_ctx"||e==="$stable",wf=e=>ut(e)?e.map(qs):[qs(e)],h0=(e,t,n)=>{if(t._n)return t;const s=Ve((...o)=>wf(t(...o)),n);return s._c=!1,s},Rg=(e,t,n)=>{const s=e._ctx;for(const o in e){if(bf(o))continue;const i=e[o];if(_t(i))t[o]=h0(o,i,s);else if(i!=null){const l=wf(i);t[o]=()=>l}}},Og=(e,t)=>{const n=wf(t);e.slots.default=()=>n},Ng=(e,t,n)=>{for(const s in t)(n||!bf(s))&&(e[s]=t[s])},f0=(e,t,n)=>{const s=e.slots=Ag();if(e.vnode.shapeFlag&32){const o=t._;o?(Ng(s,t,n),n&&Mm(s,"_",o,!0)):Rg(t,s)}else t&&Og(e,t)},p0=(e,t,n)=>{const{vnode:s,slots:o}=e;let i=!0,l=nn;if(s.shapeFlag&32){const c=t._;c?n&&c===1?i=!1:Ng(o,t,n):(i=!t.$stable,Rg(t,o)),l=t}else t&&(Og(e,t),l={default:1});if(i)for(const c in o)!bf(c)&&l[c]==null&&delete o[c]},po=k0;function v0(e){return m0(e)}function m0(e,t){const n=Uu();n.__VUE__=!0;const{insert:s,remove:o,patchProp:i,createElement:l,createText:c,createComment:d,setText:h,setElementText:f,parentNode:m,nextSibling:y,setScopeId:k=_s,insertStaticContent:w}=e,x=(G,X,ee,Ce=null,Be=null,Fe=null,Ee=void 0,oe=null,ge=!!X.dynamicChildren)=>{if(G===X)return;G&&!Gi(G,X)&&(Ce=z(G),_e(G,Be,Fe,!0),G=null),X.patchFlag===-2&&(ge=!1,X.dynamicChildren=null);const{type:Ne,ref:Oe,shapeFlag:xe}=X;switch(Ne){case Wu:A(G,X,ee,Ce);break;case eo:E(G,X,ee,Ce);break;case zr:G==null&&_(X,ee,Ce,Ee);break;case Se:j(G,X,ee,Ce,Be,Fe,Ee,oe,ge);break;default:xe&1?$(G,X,ee,Ce,Be,Fe,Ee,oe,ge):xe&6?Z(G,X,ee,Ce,Be,Fe,Ee,oe,ge):(xe&64||xe&128)&&Ne.process(G,X,ee,Ce,Be,Fe,Ee,oe,ge,ie)}Oe!=null&&Be?Fr(Oe,G&&G.ref,Fe,X||G,!X):Oe==null&&G&&G.ref!=null&&Fr(G.ref,null,Fe,G,!0)},A=(G,X,ee,Ce)=>{if(G==null)s(X.el=c(X.children),ee,Ce);else{const Be=X.el=G.el;X.children!==G.children&&h(Be,X.children)}},E=(G,X,ee,Ce)=>{G==null?s(X.el=d(X.children||""),ee,Ce):X.el=G.el},_=(G,X,ee,Ce)=>{[G.el,G.anchor]=w(G.children,X,ee,Ce,G.el,G.anchor)},C=({el:G,anchor:X},ee,Ce)=>{let Be;for(;G&&G!==X;)Be=y(G),s(G,ee,Ce),G=Be;s(X,ee,Ce)},S=({el:G,anchor:X})=>{let ee;for(;G&&G!==X;)ee=y(G),o(G),G=ee;o(X)},$=(G,X,ee,Ce,Be,Fe,Ee,oe,ge)=>{if(X.type==="svg"?Ee="svg":X.type==="math"&&(Ee="mathml"),G==null)R(X,ee,Ce,Be,Fe,Ee,oe,ge);else{const Ne=G.el&&G.el._isVueCE?G.el:null;try{Ne&&Ne._beginPatch(),M(G,X,Be,Fe,Ee,oe,ge)}finally{Ne&&Ne._endPatch()}}},R=(G,X,ee,Ce,Be,Fe,Ee,oe)=>{let ge,Ne;const{props:Oe,shapeFlag:xe,transition:me,dirs:Ze}=G;if(ge=G.el=l(G.type,Fe,Oe&&Oe.is,Oe),xe&8?f(ge,G.children):xe&16&&O(G.children,ge,null,Ce,Be,Id(G,Fe),Ee,oe),Ze&&Ri(G,null,Ce,"created"),T(ge,G,G.scopeId,Ee,Ce),Oe){for(const fe in Oe)fe!=="value"&&!Dr(fe)&&i(ge,fe,null,Oe[fe],Fe,Ce);"value"in Oe&&i(ge,"value",null,Oe.value,Fe),(Ne=Oe.onVnodeBeforeMount)&&Us(Ne,Ce,G)}Ze&&Ri(G,null,Ce,"beforeMount");const qe=g0(Be,me);qe&&me.beforeEnter(ge),s(ge,X,ee),((Ne=Oe&&Oe.onVnodeMounted)||qe||Ze)&&po(()=>{Ne&&Us(Ne,Ce,G),qe&&me.enter(ge),Ze&&Ri(G,null,Ce,"mounted")},Be)},T=(G,X,ee,Ce,Be)=>{if(ee&&k(G,ee),Ce)for(let Fe=0;Fe<Ce.length;Fe++)k(G,Ce[Fe]);if(Be){let Fe=Be.subTree;if(X===Fe||Ug(Fe.type)&&(Fe.ssContent===X||Fe.ssFallback===X)){const Ee=Be.vnode;T(G,Ee,Ee.scopeId,Ee.slotScopeIds,Be.parent)}}},O=(G,X,ee,Ce,Be,Fe,Ee,oe,ge=0)=>{for(let Ne=ge;Ne<G.length;Ne++){const Oe=G[Ne]=oe?ni(G[Ne]):qs(G[Ne]);x(null,Oe,X,ee,Ce,Be,Fe,Ee,oe)}},M=(G,X,ee,Ce,Be,Fe,Ee)=>{const oe=X.el=G.el;let{patchFlag:ge,dynamicChildren:Ne,dirs:Oe}=X;ge|=G.patchFlag&16;const xe=G.props||nn,me=X.props||nn;let Ze;if(ee&&Oi(ee,!1),(Ze=me.onVnodeBeforeUpdate)&&Us(Ze,ee,X,G),Oe&&Ri(X,G,ee,"beforeUpdate"),ee&&Oi(ee,!0),(xe.innerHTML&&me.innerHTML==null||xe.textContent&&me.textContent==null)&&f(oe,""),Ne?U(G.dynamicChildren,Ne,oe,ee,Ce,Id(X,Be),Fe):Ee||q(G,X,oe,null,ee,Ce,Id(X,Be),Fe,!1),ge>0){if(ge&16)F(oe,xe,me,ee,Be);else if(ge&2&&xe.class!==me.class&&i(oe,"class",null,me.class,Be),ge&4&&i(oe,"style",xe.style,me.style,Be),ge&8){const qe=X.dynamicProps;for(let fe=0;fe<qe.length;fe++){const ke=qe[fe],ne=xe[ke],ye=me[ke];(ye!==ne||ke==="value")&&i(oe,ke,ne,ye,Be,ee)}}ge&1&&G.children!==X.children&&f(oe,X.children)}else!Ee&&Ne==null&&F(oe,xe,me,ee,Be);((Ze=me.onVnodeUpdated)||Oe)&&po(()=>{Ze&&Us(Ze,ee,X,G),Oe&&Ri(X,G,ee,"updated")},Ce)},U=(G,X,ee,Ce,Be,Fe,Ee)=>{for(let oe=0;oe<X.length;oe++){const ge=G[oe],Ne=X[oe],Oe=ge.el&&(ge.type===Se||!Gi(ge,Ne)||ge.shapeFlag&198)?m(ge.el):ee;x(ge,Ne,Oe,null,Ce,Be,Fe,Ee,!0)}},F=(G,X,ee,Ce,Be)=>{if(X!==ee){if(X!==nn)for(const Fe in X)!Dr(Fe)&&!(Fe in ee)&&i(G,Fe,X[Fe],null,Be,Ce);for(const Fe in ee){if(Dr(Fe))continue;const Ee=ee[Fe],oe=X[Fe];Ee!==oe&&Fe!=="value"&&i(G,Fe,oe,Ee,Be,Ce)}"value"in ee&&i(G,"value",X.value,ee.value,Be)}},j=(G,X,ee,Ce,Be,Fe,Ee,oe,ge)=>{const Ne=X.el=G?G.el:c(""),Oe=X.anchor=G?G.anchor:c("");let{patchFlag:xe,dynamicChildren:me,slotScopeIds:Ze}=X;Ze&&(oe=oe?oe.concat(Ze):Ze),G==null?(s(Ne,ee,Ce),s(Oe,ee,Ce),O(X.children||[],ee,Oe,Be,Fe,Ee,oe,ge)):xe>0&&xe&64&&me&&G.dynamicChildren&&G.dynamicChildren.length===me.length?(U(G.dynamicChildren,me,ee,Be,Fe,Ee,oe),(X.key!=null||Be&&X===Be.subTree)&&_f(G,X,!0)):q(G,X,ee,Oe,Be,Fe,Ee,oe,ge)},Z=(G,X,ee,Ce,Be,Fe,Ee,oe,ge)=>{X.slotScopeIds=oe,G==null?X.shapeFlag&512?Be.ctx.activate(X,ee,Ce,Ee,ge):Q(X,ee,Ce,Be,Fe,Ee,ge):re(G,X,ge)},Q=(G,X,ee,Ce,Be,Fe,Ee)=>{const oe=G.component=S0(G,Ce,Be);if(Gu(G)&&(oe.ctx.renderer=ie),I0(oe,!1,Ee),oe.asyncDep){if(Be&&Be.registerDep(oe,K,Ee),!G.el){const ge=oe.subTree=Pe(eo);E(null,ge,X,ee),G.placeholder=ge.el}}else K(oe,G,X,ee,Be,Fe,Ee)},re=(G,X,ee)=>{const Ce=X.component=G.component;if(l0(G,X,ee))if(Ce.asyncDep&&!Ce.asyncResolved){ae(Ce,X,ee);return}else Ce.next=X,Ce.update();else X.el=G.el,Ce.vnode=X},K=(G,X,ee,Ce,Be,Fe,Ee)=>{const oe=()=>{if(G.isMounted){let{next:xe,bu:me,u:Ze,parent:qe,vnode:fe}=G;{const ct=Bg(G);if(ct){xe&&(xe.el=fe.el,ae(G,xe,Ee)),ct.asyncDep.then(()=>{G.isUnmounted||oe()});return}}let ke=xe,ne;Oi(G,!1),xe?(xe.el=fe.el,ae(G,xe,Ee)):xe=fe,me&&Wc(me),(ne=xe.props&&xe.props.onVnodeBeforeUpdate)&&Us(ne,qe,xe,fe),Oi(G,!0);const ye=cp(G),He=G.subTree;G.subTree=ye,x(He,ye,m(He.el),z(He),G,Be,Fe),xe.el=ye.el,ke===null&&r0(G,ye.el),Ze&&po(Ze,Be),(ne=xe.props&&xe.props.onVnodeUpdated)&&po(()=>Us(ne,qe,xe,fe),Be)}else{let xe;const{el:me,props:Ze}=X,{bm:qe,m:fe,parent:ke,root:ne,type:ye}=G,He=Yl(X);Oi(G,!1),qe&&Wc(qe),!He&&(xe=Ze&&Ze.onVnodeBeforeMount)&&Us(xe,ke,X),Oi(G,!0);{ne.ce&&ne.ce._def.shadowRoot!==!1&&ne.ce._injectChildStyle(ye);const ct=G.subTree=cp(G);x(null,ct,ee,Ce,G,Be,Fe),X.el=ct.el}if(fe&&po(fe,Be),!He&&(xe=Ze&&Ze.onVnodeMounted)){const ct=X;po(()=>Us(xe,ke,ct),Be)}(X.shapeFlag&256||ke&&Yl(ke.vnode)&&ke.vnode.shapeFlag&256)&&G.a&&po(G.a,Be),G.isMounted=!0,X=ee=Ce=null}};G.scope.on();const ge=G.effect=new Nm(oe);G.scope.off();const Ne=G.update=ge.run.bind(ge),Oe=G.job=ge.runIfDirty.bind(ge);Oe.i=G,Oe.id=G.uid,ge.scheduler=()=>gf(Oe),Oi(G,!0),Ne()},ae=(G,X,ee)=>{X.component=G;const Ce=G.vnode.props;G.vnode=X,G.next=null,u0(G,X.props,Ce,ee),p0(G,X.children,ee),Ca(),Xf(G),La()},q=(G,X,ee,Ce,Be,Fe,Ee,oe,ge=!1)=>{const Ne=G&&G.children,Oe=G?G.shapeFlag:0,xe=X.children,{patchFlag:me,shapeFlag:Ze}=X;if(me>0){if(me&128){te(Ne,xe,ee,Ce,Be,Fe,Ee,oe,ge);return}else if(me&256){Y(Ne,xe,ee,Ce,Be,Fe,Ee,oe,ge);return}}Ze&8?(Oe&16&&be(Ne,Be,Fe),xe!==Ne&&f(ee,xe)):Oe&16?Ze&16?te(Ne,xe,ee,Ce,Be,Fe,Ee,oe,ge):be(Ne,Be,Fe,!0):(Oe&8&&f(ee,""),Ze&16&&O(xe,ee,Ce,Be,Fe,Ee,oe,ge))},Y=(G,X,ee,Ce,Be,Fe,Ee,oe,ge)=>{G=G||Wl,X=X||Wl;const Ne=G.length,Oe=X.length,xe=Math.min(Ne,Oe);let me;for(me=0;me<xe;me++){const Ze=X[me]=ge?ni(X[me]):qs(X[me]);x(G[me],Ze,ee,null,Be,Fe,Ee,oe,ge)}Ne>Oe?be(G,Be,Fe,!0,!1,xe):O(X,ee,Ce,Be,Fe,Ee,oe,ge,xe)},te=(G,X,ee,Ce,Be,Fe,Ee,oe,ge)=>{let Ne=0;const Oe=X.length;let xe=G.length-1,me=Oe-1;for(;Ne<=xe&&Ne<=me;){const Ze=G[Ne],qe=X[Ne]=ge?ni(X[Ne]):qs(X[Ne]);if(Gi(Ze,qe))x(Ze,qe,ee,null,Be,Fe,Ee,oe,ge);else break;Ne++}for(;Ne<=xe&&Ne<=me;){const Ze=G[xe],qe=X[me]=ge?ni(X[me]):qs(X[me]);if(Gi(Ze,qe))x(Ze,qe,ee,null,Be,Fe,Ee,oe,ge);else break;xe--,me--}if(Ne>xe){if(Ne<=me){const Ze=me+1,qe=Ze<Oe?X[Ze].el:Ce;for(;Ne<=me;)x(null,X[Ne]=ge?ni(X[Ne]):qs(X[Ne]),ee,qe,Be,Fe,Ee,oe,ge),Ne++}}else if(Ne>me)for(;Ne<=xe;)_e(G[Ne],Be,Fe,!0),Ne++;else{const Ze=Ne,qe=Ne,fe=new Map;for(Ne=qe;Ne<=me;Ne++){const Lt=X[Ne]=ge?ni(X[Ne]):qs(X[Ne]);Lt.key!=null&&fe.set(Lt.key,Ne)}let ke,ne=0;const ye=me-qe+1;let He=!1,ct=0;const ht=new Array(ye);for(Ne=0;Ne<ye;Ne++)ht[Ne]=0;for(Ne=Ze;Ne<=xe;Ne++){const Lt=G[Ne];if(ne>=ye){_e(Lt,Be,Fe,!0);continue}let Bt;if(Lt.key!=null)Bt=fe.get(Lt.key);else for(ke=qe;ke<=me;ke++)if(ht[ke-qe]===0&&Gi(Lt,X[ke])){Bt=ke;break}Bt===void 0?_e(Lt,Be,Fe,!0):(ht[Bt-qe]=Ne+1,Bt>=ct?ct=Bt:He=!0,x(Lt,X[Bt],ee,null,Be,Fe,Ee,oe,ge),ne++)}const Nt=He?y0(ht):Wl;for(ke=Nt.length-1,Ne=ye-1;Ne>=0;Ne--){const Lt=qe+Ne,Bt=X[Lt],Et=X[Lt+1],yo=Lt+1<Oe?Et.el||Fg(Et):Ce;ht[Ne]===0?x(null,Bt,ee,yo,Be,Fe,Ee,oe,ge):He&&(ke<0||Ne!==Nt[ke]?ue(Bt,ee,yo,2):ke--)}}},ue=(G,X,ee,Ce,Be=null)=>{const{el:Fe,type:Ee,transition:oe,children:ge,shapeFlag:Ne}=G;if(Ne&6){ue(G.component.subTree,X,ee,Ce);return}if(Ne&128){G.suspense.move(X,ee,Ce);return}if(Ne&64){Ee.move(G,X,ee,ie);return}if(Ee===Se){s(Fe,X,ee);for(let xe=0;xe<ge.length;xe++)ue(ge[xe],X,ee,Ce);s(G.anchor,X,ee);return}if(Ee===zr){C(G,X,ee);return}if(Ce!==2&&Ne&1&&oe)if(Ce===0)oe.beforeEnter(Fe),s(Fe,X,ee),po(()=>oe.enter(Fe),Be);else{const{leave:xe,delayLeave:me,afterLeave:Ze}=oe,qe=()=>{G.ctx.isUnmounted?o(Fe):s(Fe,X,ee)},fe=()=>{Fe._isLeaving&&Fe[fa](!0),xe(Fe,()=>{qe(),Ze&&Ze()})};me?me(Fe,qe,fe):fe()}else s(Fe,X,ee)},_e=(G,X,ee,Ce=!1,Be=!1)=>{const{type:Fe,props:Ee,ref:oe,children:ge,dynamicChildren:Ne,shapeFlag:Oe,patchFlag:xe,dirs:me,cacheIndex:Ze}=G;if(xe===-2&&(Be=!1),oe!=null&&(Ca(),Fr(oe,null,ee,G,!0),La()),Ze!=null&&(X.renderCache[Ze]=void 0),Oe&256){X.ctx.deactivate(G);return}const qe=Oe&1&&me,fe=!Yl(G);let ke;if(fe&&(ke=Ee&&Ee.onVnodeBeforeUnmount)&&Us(ke,X,G),Oe&6)Re(G.component,ee,Ce);else{if(Oe&128){G.suspense.unmount(ee,Ce);return}qe&&Ri(G,null,X,"beforeUnmount"),Oe&64?G.type.remove(G,X,ee,ie,Ce):Ne&&!Ne.hasOnce&&(Fe!==Se||xe>0&&xe&64)?be(Ne,X,ee,!1,!0):(Fe===Se&&xe&384||!Be&&Oe&16)&&be(ge,X,ee),Ce&&$e(G)}(fe&&(ke=Ee&&Ee.onVnodeUnmounted)||qe)&&po(()=>{ke&&Us(ke,X,G),qe&&Ri(G,null,X,"unmounted")},ee)},$e=G=>{const{type:X,el:ee,anchor:Ce,transition:Be}=G;if(X===Se){De(ee,Ce);return}if(X===zr){S(G);return}const Fe=()=>{o(ee),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(G.shapeFlag&1&&Be&&!Be.persisted){const{leave:Ee,delayLeave:oe}=Be,ge=()=>Ee(ee,Fe);oe?oe(G.el,Fe,ge):ge()}else Fe()},De=(G,X)=>{let ee;for(;G!==X;)ee=y(G),o(G),G=ee;o(X)},Re=(G,X,ee)=>{const{bum:Ce,scope:Be,job:Fe,subTree:Ee,um:oe,m:ge,a:Ne}=G;hp(ge),hp(Ne),Ce&&Wc(Ce),Be.stop(),Fe&&(Fe.flags|=8,_e(Ee,G,X,ee)),oe&&po(oe,X),po(()=>{G.isUnmounted=!0},X)},be=(G,X,ee,Ce=!1,Be=!1,Fe=0)=>{for(let Ee=Fe;Ee<G.length;Ee++)_e(G[Ee],X,ee,Ce,Be)},z=G=>{if(G.shapeFlag&6)return z(G.component.subTree);if(G.shapeFlag&128)return G.suspense.next();const X=y(G.anchor||G.el),ee=X&&X[rg];return ee?y(ee):X};let J=!1;const de=(G,X,ee)=>{let Ce;G==null?X._vnode&&(_e(X._vnode,null,null,!0),Ce=X._vnode.component):x(X._vnode||null,G,X,null,null,null,ee),X._vnode=G,J||(J=!0,Xf(Ce),og(),J=!1)},ie={p:x,um:_e,m:ue,r:$e,mt:Q,mc:O,pc:q,pbc:U,n:z,o:e};return{render:de,hydrate:void 0,createApp:t0(de)}}function Id({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Oi({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function g0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function _f(e,t,n=!1){const s=e.children,o=t.children;if(ut(s)&&ut(o))for(let i=0;i<s.length;i++){const l=s[i];let c=o[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=o[i]=ni(o[i]),c.el=l.el),!n&&c.patchFlag!==-2&&_f(l,c)),c.type===Wu&&(c.patchFlag!==-1?c.el=l.el:c.__elIndex=i+(e.type===Se?1:0)),c.type===eo&&!c.el&&(c.el=l.el)}}function y0(e){const t=e.slice(),n=[0];let s,o,i,l,c;const d=e.length;for(s=0;s<d;s++){const h=e[s];if(h!==0){if(o=n[n.length-1],e[o]<h){t[s]=o,n.push(s);continue}for(i=0,l=n.length-1;i<l;)c=i+l>>1,e[n[c]]<h?i=c+1:l=c;h<e[n[i]]&&(i>0&&(t[s]=n[i-1]),n[i]=s)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}function Bg(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Bg(t)}function hp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Fg(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Fg(t.subTree):null}const Ug=e=>e.__isSuspense;function k0(e,t){t&&t.pendingBranch?ut(e)?t.effects.push(...e):t.effects.push(e):ng(e)}const Se=Symbol.for("v-fgt"),Wu=Symbol.for("v-txt"),eo=Symbol.for("v-cmt"),zr=Symbol.for("v-stc"),Hr=[];let Fo=null;function p(e=!1){Hr.push(Fo=e?null:[])}function b0(){Hr.pop(),Fo=Hr[Hr.length-1]||null}let nc=1;function pu(e,t=!1){nc+=e,e<0&&Fo&&t&&(Fo.hasOnce=!0)}function zg(e){return e.dynamicChildren=nc>0?Fo||Wl:null,b0(),nc>0&&Fo&&Fo.push(e),e}function g(e,t,n,s,o,i){return zg(r(e,t,n,s,o,i,!0))}function Ge(e,t,n,s,o){return zg(Pe(e,t,n,s,o,!0))}function oc(e){return e?e.__v_isVNode===!0:!1}function Gi(e,t){return e.type===t.type&&e.key===t.key}const Hg=({key:e})=>e??null,Kc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?fn(e)||hn(e)||_t(e)?{i:Hn,r:e,k:t,f:!!n}:e:null);function r(e,t=null,n=null,s=0,o=null,i=e===Se?0:1,l=!1,c=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Hg(t),ref:t&&Kc(t),scopeId:ag,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Hn};return c?(Cf(d,n),i&128&&e.normalize(d)):n&&(d.shapeFlag|=fn(n)?8:16),nc>0&&!l&&Fo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&Fo.push(d),d}const Pe=w0;function w0(e,t=null,n=null,s=0,o=null,i=!1){if((!e||e===Cg)&&(e=eo),oc(e)){const c=fi(e,t,!0);return n&&Cf(c,n),nc>0&&!i&&Fo&&(c.shapeFlag&6?Fo[Fo.indexOf(e)]=c:Fo.push(c)),c.patchFlag=-2,c}if(A0(e)&&(e=e.__vccOpts),t){t=_0(t);let{class:c,style:d}=t;c&&!fn(c)&&(t.class=le(c)),Qt(d)&&(Hu(d)&&!ut(d)&&(d=Rn({},d)),t.style=tt(d))}const l=fn(e)?1:Ug(e)?128:cg(e)?64:Qt(e)?4:_t(e)?2:0;return r(e,t,n,s,o,l,i,!0)}function _0(e){return e?Hu(e)||Eg(e)?Rn({},e):e:null}function fi(e,t,n=!1,s=!1){const{props:o,ref:i,patchFlag:l,children:c,transition:d}=e,h=t?Vg(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Hg(h),ref:t&&t.ref?n&&i?ut(i)?i.concat(Kc(t)):[i,Kc(t)]:Kc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Se?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&fi(e.ssContent),ssFallback:e.ssFallback&&fi(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&s&&tc(f,d.clone(f)),f}function Je(e=" ",t=0){return Pe(Wu,null,e,t)}function pi(e,t){const n=Pe(zr,null,e);return n.staticCount=t,n}function P(e="",t=!1){return t?(p(),Ge(eo,null,e)):Pe(eo,null,e)}function qs(e){return e==null||typeof e=="boolean"?Pe(eo):ut(e)?Pe(Se,null,e.slice()):oc(e)?ni(e):Pe(Wu,null,String(e))}function ni(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:fi(e)}function Cf(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(ut(t))n=16;else if(typeof t=="object")if(s&65){const o=t.default;o&&(o._c&&(o._d=!1),Cf(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!Eg(t)?t._ctx=Hn:o===3&&Hn&&(Hn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else _t(t)?(t={default:t,_ctx:Hn},n=32):(t=String(t),s&64?(n=16,t=[Je(t)]):n=8);e.children=t,e.shapeFlag|=n}function Vg(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const o in s)if(o==="class")t.class!==s.class&&(t.class=le([t.class,s.class]));else if(o==="style")t.style=tt([t.style,s.style]);else if(Ru(o)){const i=t[o],l=s[o];l&&i!==l&&!(ut(i)&&i.includes(l))&&(t[o]=i?[].concat(i,l):l)}else o!==""&&(t[o]=s[o])}return t}function Us(e,t,n,s=null){xs(e,t,7,[n,s])}const C0=$g();let L0=0;function S0(e,t,n){const s=e.type,o=(t?t.appContext:e.appContext)||C0,i={uid:L0++,vnode:e,type:s,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Dm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Dg(s,o),emitsOptions:Tg(s,o),emit:null,emitted:null,propsDefaults:nn,inheritAttrs:s.inheritAttrs,ctx:nn,data:nn,props:nn,attrs:nn,slots:nn,refs:nn,setupState:nn,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=o0.bind(null,i),e.ce&&e.ce(i),i}let to=null;const Zu=()=>to||Hn;let vu,Ah;{const e=Uu(),t=(n,s)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(s),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};vu=t("__VUE_INSTANCE_SETTERS__",n=>to=n),Ah=t("__VUE_SSR_SETTERS__",n=>sc=n)}const dc=e=>{const t=to;return vu(e),e.scope.on(),()=>{e.scope.off(),vu(t)}},fp=()=>{to&&to.scope.off(),vu(null)};function Gg(e){return e.vnode.shapeFlag&4}let sc=!1;function I0(e,t=!1,n=!1){t&&Ah(t);const{props:s,children:o}=e.vnode,i=Gg(e);c0(e,s,i,t),f0(e,o,n||t);const l=i?x0(e,t):void 0;return t&&Ah(!1),l}function x0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Zk);const{setup:s}=n;if(s){Ca();const o=e.setupContext=s.length>1?T0(e):null,i=dc(e),l=uc(s,e,0,[e.props,o]),c=xm(l);if(La(),i(),(c||e.sp)&&!Yl(e)&&yg(e),c){if(l.then(fp,fp),t)return l.then(d=>{pp(e,d)}).catch(d=>{Vu(d,e,0)});e.asyncDep=l}else pp(e,l)}else qg(e)}function pp(e,t,n){_t(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qt(t)&&(e.setupState=Qm(t)),qg(e)}function qg(e,t,n){const s=e.type;e.render||(e.render=s.render||_s);{const o=dc(e);Ca();try{Kk(e)}finally{La(),o()}}}const $0={get(e,t){return Qn(e,"get",""),e[t]}};function T0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,$0),slots:e.slots,emit:e.emit,expose:t}}function Ku(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Qm(mf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ur)return Ur[n](e)},has(t,n){return n in t||n in Ur}})):e.proxy}function M0(e,t=!0){return _t(e)?e.displayName||e.name:e.name||t&&e.__name}function A0(e){return _t(e)&&"__vccOpts"in e}const H=(e,t)=>Sk(e,t,sc);function Lf(e,t,n){try{pu(-1);const s=arguments.length;return s===2?Qt(t)&&!ut(t)?oc(t)?Pe(e,null,[t]):Pe(e,t):Pe(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&oc(n)&&(n=[n]),Pe(e,t,n))}finally{pu(1)}}const E0="3.5.26";let Eh;const vp=typeof window<"u"&&window.trustedTypes;if(vp)try{Eh=vp.createPolicy("vue",{createHTML:e=>e})}catch{}const jg=Eh?e=>Eh.createHTML(e):e=>e,P0="http://www.w3.org/2000/svg",D0="http://www.w3.org/1998/Math/MathML",ha=typeof document<"u"?document:null,mp=ha&&ha.createElement("template"),R0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const o=t==="svg"?ha.createElementNS(P0,e):t==="mathml"?ha.createElementNS(D0,e):n?ha.createElement(e,{is:n}):ha.createElement(e);return e==="select"&&s&&s.multiple!=null&&o.setAttribute("multiple",s.multiple),o},createText:e=>ha.createTextNode(e),createComment:e=>ha.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ha.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,o,i){const l=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{mp.innerHTML=jg(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const c=mp.content;if(s==="svg"||s==="mathml"){const d=c.firstChild;for(;d.firstChild;)c.appendChild(d.firstChild);c.removeChild(d)}t.insertBefore(c,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ka="transition",_r="animation",ac=Symbol("_vtc"),Wg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},O0=Rn({},hg,Wg),N0=e=>(e.displayName="Transition",e.props=O0,e),Ls=N0((e,{slots:t})=>Lf(Nk,B0(e),t)),Ni=(e,t=[])=>{ut(e)?e.forEach(n=>n(...t)):e&&e(...t)},gp=e=>e?ut(e)?e.some(t=>t.length>1):e.length>1:!1;function B0(e){const t={};for(const j in e)j in Wg||(t[j]=e[j]);if(e.css===!1)return t;const{name:n="v",type:s,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=c,leaveFromClass:m=`${n}-leave-from`,leaveActiveClass:y=`${n}-leave-active`,leaveToClass:k=`${n}-leave-to`}=e,w=F0(o),x=w&&w[0],A=w&&w[1],{onBeforeEnter:E,onEnter:_,onEnterCancelled:C,onLeave:S,onLeaveCancelled:$,onBeforeAppear:R=E,onAppear:T=_,onAppearCancelled:O=C}=t,M=(j,Z,Q,re)=>{j._enterCancelled=re,Bi(j,Z?f:c),Bi(j,Z?h:l),Q&&Q()},U=(j,Z)=>{j._isLeaving=!1,Bi(j,m),Bi(j,k),Bi(j,y),Z&&Z()},F=j=>(Z,Q)=>{const re=j?T:_,K=()=>M(Z,j,Q);Ni(re,[Z,K]),yp(()=>{Bi(Z,j?d:i),ca(Z,j?f:c),gp(re)||kp(Z,s,x,K)})};return Rn(t,{onBeforeEnter(j){Ni(E,[j]),ca(j,i),ca(j,l)},onBeforeAppear(j){Ni(R,[j]),ca(j,d),ca(j,h)},onEnter:F(!1),onAppear:F(!0),onLeave(j,Z){j._isLeaving=!0;const Q=()=>U(j,Z);ca(j,m),j._enterCancelled?(ca(j,y),_p(j)):(_p(j),ca(j,y)),yp(()=>{j._isLeaving&&(Bi(j,m),ca(j,k),gp(S)||kp(j,s,A,Q))}),Ni(S,[j,Q])},onEnterCancelled(j){M(j,!1,void 0,!0),Ni(C,[j])},onAppearCancelled(j){M(j,!0,void 0,!0),Ni(O,[j])},onLeaveCancelled(j){U(j),Ni($,[j])}})}function F0(e){if(e==null)return null;if(Qt(e))return[xd(e.enter),xd(e.leave)];{const t=xd(e);return[t,t]}}function xd(e){return V1(e)}function ca(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[ac]||(e[ac]=new Set)).add(t)}function Bi(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const n=e[ac];n&&(n.delete(t),n.size||(e[ac]=void 0))}function yp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let U0=0;function kp(e,t,n,s){const o=e._endId=++U0,i=()=>{o===e._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:l,timeout:c,propCount:d}=z0(e,t);if(!l)return s();const h=l+"end";let f=0;const m=()=>{e.removeEventListener(h,y),i()},y=k=>{k.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},c+1),e.addEventListener(h,y)}function z0(e,t){const n=window.getComputedStyle(e),s=w=>(n[w]||"").split(", "),o=s(`${Ka}Delay`),i=s(`${Ka}Duration`),l=bp(o,i),c=s(`${_r}Delay`),d=s(`${_r}Duration`),h=bp(c,d);let f=null,m=0,y=0;t===Ka?l>0&&(f=Ka,m=l,y=i.length):t===_r?h>0&&(f=_r,m=h,y=d.length):(m=Math.max(l,h),f=m>0?l>h?Ka:_r:null,y=f?f===Ka?i.length:d.length:0);const k=f===Ka&&/\b(?:transform|all)(?:,|$)/.test(s(`${Ka}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:k}}function bp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,s)=>wp(n)+wp(e[s])))}function wp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function _p(e){return(e?e.ownerDocument:document).body.offsetHeight}function H0(e,t,n){const s=e[ac];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const mu=Symbol("_vod"),Zg=Symbol("_vsh"),ns={name:"show",beforeMount(e,{value:t},{transition:n}){e[mu]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Cr(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),Cr(e,!0),s.enter(e)):s.leave(e,()=>{Cr(e,!1)}):Cr(e,t))},beforeUnmount(e,{value:t}){Cr(e,t)}};function Cr(e,t){e.style.display=t?e[mu]:"none",e[Zg]=!t}const Kg=Symbol("");function V0(e){const t=Zu();if(!t)return;const n=t.ut=(o=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>gu(i,o))},s=()=>{const o=e(t.proxy);t.ce?gu(t.ce,o):Ph(t.subTree,o),n(o)};bg(()=>{ng(s)}),cn(()=>{Ye(s,_s,{flush:"post"});const o=new MutationObserver(s);o.observe(t.subTree.el.parentNode,{childList:!0}),In(()=>o.disconnect())})}function Ph(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Ph(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)gu(e.el,t);else if(e.type===Se)e.children.forEach(n=>Ph(n,t));else if(e.type===zr){let{el:n,anchor:s}=e;for(;n&&(gu(n,t),n!==s);)n=n.nextSibling}}function gu(e,t){if(e.nodeType===1){const n=e.style;let s="";for(const o in t){const i=J1(t[o]);n.setProperty(`--${o}`,i),s+=`--${o}: ${i};`}n[Kg]=s}}const G0=/(?:^|;)\s*display\s*:/;function q0(e,t,n){const s=e.style,o=fn(n);let i=!1;if(n&&!o){if(t)if(fn(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();n[c]==null&&Yc(s,c,"")}else for(const l in t)n[l]==null&&Yc(s,l,"");for(const l in n)l==="display"&&(i=!0),Yc(s,l,n[l])}else if(o){if(t!==n){const l=s[Kg];l&&(n+=";"+l),s.cssText=n,i=G0.test(n)}}else t&&e.removeAttribute("style");mu in e&&(e[mu]=i?s.display:"",e[Zg]&&(s.display="none"))}const Cp=/\s*!important$/;function Yc(e,t,n){if(ut(n))n.forEach(s=>Yc(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=j0(e,t);Cp.test(n)?e.setProperty(gi(s),n.replace(Cp,""),"important"):e[s]=n}}const Lp=["Webkit","Moz","ms"],$d={};function j0(e,t){const n=$d[t];if(n)return n;let s=ts(t);if(s!=="filter"&&s in e)return $d[t]=s;s=Bu(s);for(let o=0;o<Lp.length;o++){const i=Lp[o]+s;if(i in e)return $d[t]=i}return t}const Sp="http://www.w3.org/1999/xlink";function Ip(e,t,n,s,o,i=K1(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Sp,t.slice(6,t.length)):e.setAttributeNS(Sp,t,n):n==null||i&&!Am(n)?e.removeAttribute(t):e.setAttribute(t,i?"":Ss(n)?String(n):n)}function xp(e,t,n,s,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?jg(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(c!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=Am(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(o||t)}function ma(e,t,n,s){e.addEventListener(t,n,s)}function W0(e,t,n,s){e.removeEventListener(t,n,s)}const $p=Symbol("_vei");function Z0(e,t,n,s,o=null){const i=e[$p]||(e[$p]={}),l=i[t];if(s&&l)l.value=s;else{const[c,d]=K0(t);if(s){const h=i[t]=X0(s,o);ma(e,c,h,d)}else l&&(W0(e,c,l,d),i[t]=void 0)}}const Tp=/(?:Once|Passive|Capture)$/;function K0(e){let t;if(Tp.test(e)){t={};let s;for(;s=e.match(Tp);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):gi(e.slice(2)),t]}let Td=0;const Y0=Promise.resolve(),J0=()=>Td||(Y0.then(()=>Td=0),Td=Date.now());function X0(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;xs(Q0(s,n.value),t,5,[s])};return n.value=e,n.attached=J0(),n}function Q0(e,t){if(ut(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>o=>!o._stopped&&s&&s(o))}else return t}const Mp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,eb=(e,t,n,s,o,i)=>{const l=o==="svg";t==="class"?H0(e,s,l):t==="style"?q0(e,n,s):Ru(t)?lf(t)||Z0(e,t,n,s,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):tb(e,t,s,l))?(xp(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Ip(e,t,s,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!fn(s))?xp(e,ts(t),s,i,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),Ip(e,t,s,l))};function tb(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&Mp(t)&&_t(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Mp(t)&&fn(n)?!1:t in e}const vi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ut(t)?n=>Wc(t,n):t};function nb(e){e.target.composing=!0}function Ap(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const es=Symbol("_assign");function Ep(e,t,n){return t&&(e=e.trim()),n&&(e=Fu(e)),e}const st={created(e,{modifiers:{lazy:t,trim:n,number:s}},o){e[es]=vi(o);const i=s||o.props&&o.props.type==="number";ma(e,t?"change":"input",l=>{l.target.composing||e[es](Ep(e.value,n,i))}),(n||i)&&ma(e,"change",()=>{e.value=Ep(e.value,n,i)}),t||(ma(e,"compositionstart",nb),ma(e,"compositionend",Ap),ma(e,"change",Ap))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:o,number:i}},l){if(e[es]=vi(l),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Fu(e.value):e.value,d=t??"";c!==d&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||o&&e.value.trim()===d)||(e.value=d))}},$s={deep:!0,created(e,t,n){e[es]=vi(n),ma(e,"change",()=>{const s=e._modelValue,o=er(e),i=e.checked,l=e[es];if(ut(s)){const c=cf(s,o),d=c!==-1;if(i&&!d)l(s.concat(o));else if(!i&&d){const h=[...s];h.splice(c,1),l(h)}}else if(ar(s)){const c=new Set(s);i?c.add(o):c.delete(o),l(c)}else l(Yg(e,i))})},mounted:Pp,beforeUpdate(e,t,n){e[es]=vi(n),Pp(e,t,n)}};function Pp(e,{value:t,oldValue:n},s){e._modelValue=t;let o;if(ut(t))o=cf(t,s.props.value)>-1;else if(ar(t))o=t.has(s.props.value);else{if(t===n)return;o=el(t,Yg(e,!0))}e.checked!==o&&(e.checked=o)}const Dp={created(e,{value:t},n){e.checked=el(t,n.props.value),e[es]=vi(n),ma(e,"change",()=>{e[es](er(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[es]=vi(s),t!==n&&(e.checked=el(t,s.props.value))}},no={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const o=ar(t);ma(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?Fu(er(l)):er(l));e[es](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,rn(()=>{e._assigning=!1})}),e[es]=vi(s)},mounted(e,{value:t}){Rp(e,t)},beforeUpdate(e,t,n){e[es]=vi(n)},updated(e,{value:t}){e._assigning||Rp(e,t)}};function Rp(e,t){const n=e.multiple,s=ut(t);if(!(n&&!s&&!ar(t))){for(let o=0,i=e.options.length;o<i;o++){const l=e.options[o],c=er(l);if(n)if(s){const d=typeof c;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(c)):l.selected=cf(t,c)>-1}else l.selected=t.has(c);else if(el(er(l),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function er(e){return"_value"in e?e._value:e.value}function Yg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const ob=["ctrl","shift","alt","meta"],sb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>ob.some(n=>e[`${n}Key`]&&!t.includes(n))},rt=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=((o,...i)=>{for(let l=0;l<t.length;l++){const c=sb[t[l]];if(c&&c(o,t))return}return e(o,...i)}))},ab={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Xo=(e,t)=>{const n=e._withKeys||(e._withKeys={}),s=t.join(".");return n[s]||(n[s]=(o=>{if(!("key"in o))return;const i=gi(o.key);if(t.some(l=>l===i||ab[l]===i))return e(o)}))},ib=Rn({patchProp:eb},R0);let Op;function lb(){return Op||(Op=v0(ib))}const rb=((...e)=>{const t=lb().createApp(...e),{mount:n}=t;return t.mount=s=>{const o=ub(s);if(!o)return;const i=t._component;!_t(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const l=n(o,!1,cb(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),l},t});function cb(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ub(e){return fn(e)?document.querySelector(e):e}let Jg;const Yu=e=>Jg=e,Xg=Symbol();function Dh(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Vr;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Vr||(Vr={}));function db(){const e=Rm(!0),t=e.run(()=>D({}));let n=[],s=[];const o=mf({install(i){Yu(o),o._a=i,i.provide(Xg,o),i.config.globalProperties.$pinia=o,s.forEach(l=>n.push(l)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const Qg=()=>{};function Np(e,t,n,s=Qg){e.add(t);const o=()=>{e.delete(t)&&s()};return!n&&Om()&&X1(o),o}function Ol(e,...t){e.forEach(n=>{n(...t)})}const hb=e=>e(),Bp=Symbol(),Md=Symbol();function Rh(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,s)=>e.set(s,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const s=t[n],o=e[n];Dh(o)&&Dh(s)&&e.hasOwnProperty(n)&&!hn(s)&&!wa(s)?e[n]=Rh(o,s):e[n]=s}return e}const fb=Symbol();function pb(e){return!Dh(e)||!Object.prototype.hasOwnProperty.call(e,fb)}const{assign:Xa}=Object;function vb(e){return!!(hn(e)&&e.effect)}function mb(e,t,n,s){const{state:o,actions:i,getters:l}=t,c=n.state.value[e];let d;function h(){c||(n.state.value[e]=o?o():{});const f=wk(n.state.value[e]);return Xa(f,i,Object.keys(l||{}).reduce((m,y)=>(m[y]=mf(H(()=>{Yu(n);const k=n._s.get(e);return l[y].call(k,k)})),m),{}))}return d=ey(e,h,t,n,s,!0),d}function ey(e,t,n={},s,o,i){let l;const c=Xa({actions:{}},n),d={deep:!0};let h,f,m=new Set,y=new Set,k;const w=s.state.value[e];!i&&!w&&(s.state.value[e]={}),D({});let x;function A(O){let M;h=f=!1,typeof O=="function"?(O(s.state.value[e]),M={type:Vr.patchFunction,storeId:e,events:k}):(Rh(s.state.value[e],O),M={type:Vr.patchObject,payload:O,storeId:e,events:k});const U=x=Symbol();rn().then(()=>{x===U&&(h=!0)}),f=!0,Ol(m,M,s.state.value[e])}const E=i?function(){const{state:M}=n,U=M?M():{};this.$patch(F=>{Xa(F,U)})}:Qg;function _(){l.stop(),m.clear(),y.clear(),s._s.delete(e)}const C=(O,M="")=>{if(Bp in O)return O[Md]=M,O;const U=function(){Yu(s);const F=Array.from(arguments),j=new Set,Z=new Set;function Q(ae){j.add(ae)}function re(ae){Z.add(ae)}Ol(y,{args:F,name:U[Md],store:$,after:Q,onError:re});let K;try{K=O.apply(this&&this.$id===e?this:$,F)}catch(ae){throw Ol(Z,ae),ae}return K instanceof Promise?K.then(ae=>(Ol(j,ae),ae)).catch(ae=>(Ol(Z,ae),Promise.reject(ae))):(Ol(j,K),K)};return U[Bp]=!0,U[Md]=M,U},S={_p:s,$id:e,$onAction:Np.bind(null,y),$patch:A,$reset:E,$subscribe(O,M={}){const U=Np(m,O,M.detached,()=>F()),F=l.run(()=>Ye(()=>s.state.value[e],j=>{(M.flush==="sync"?f:h)&&O({storeId:e,type:Vr.direct,events:k},j)},Xa({},d,M)));return U},$dispose:_},$=ol(S);s._s.set(e,$);const T=(s._a&&s._a.runWithContext||hb)(()=>s._e.run(()=>(l=Rm()).run(()=>t({action:C}))));for(const O in T){const M=T[O];if(hn(M)&&!vb(M)||wa(M))i||(w&&pb(M)&&(hn(M)?M.value=w[O]:Rh(M,w[O])),s.state.value[e][O]=M);else if(typeof M=="function"){const U=C(M,O);T[O]=U,c.actions[O]=M}}return Xa($,T),Xa(Ht($),T),Object.defineProperty($,"$state",{get:()=>s.state.value[e],set:O=>{A(M=>{Xa(M,O)})}}),s._p.forEach(O=>{Xa($,l.run(()=>O({store:$,app:s._a,pinia:s,options:c})))}),w&&i&&n.hydrate&&n.hydrate($.$state,w),h=!0,f=!0,$}function Sf(e,t,n){let s;const o=typeof t=="function";s=o?n:t;function i(l,c){const d=Mk();return l=l||(d?$o(Xg,null):null),l&&Yu(l),l=Jg,l._s.has(e)||(o?ey(e,t,s,l):mb(e,s,l)),l._s.get(e)}return i.$id=e,i}const zl=typeof document<"u";function ty(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function gb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&ty(e.default)}const Zt=Object.assign;function Ad(e,t){const n={};for(const s in t){const o=t[s];n[s]=Ts(o)?o.map(e):e(o)}return n}const Gr=()=>{},Ts=Array.isArray;function Fp(e,t){const n={};for(const s in e)n[s]=s in t?t[s]:e[s];return n}const ny=/#/g,yb=/&/g,kb=/\//g,bb=/=/g,wb=/\?/g,oy=/\+/g,_b=/%5B/g,Cb=/%5D/g,sy=/%5E/g,Lb=/%60/g,ay=/%7B/g,Sb=/%7C/g,iy=/%7D/g,Ib=/%20/g;function If(e){return e==null?"":encodeURI(""+e).replace(Sb,"|").replace(_b,"[").replace(Cb,"]")}function xb(e){return If(e).replace(ay,"{").replace(iy,"}").replace(sy,"^")}function Oh(e){return If(e).replace(oy,"%2B").replace(Ib,"+").replace(ny,"%23").replace(yb,"%26").replace(Lb,"`").replace(ay,"{").replace(iy,"}").replace(sy,"^")}function $b(e){return Oh(e).replace(bb,"%3D")}function Tb(e){return If(e).replace(ny,"%23").replace(wb,"%3F")}function Mb(e){return Tb(e).replace(kb,"%2F")}function ic(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ab=/\/$/,Eb=e=>e.replace(Ab,"");function Ed(e,t,n="/"){let s,o={},i="",l="";const c=t.indexOf("#");let d=t.indexOf("?");return d=c>=0&&d>c?-1:d,d>=0&&(s=t.slice(0,d),i=t.slice(d,c>0?c:t.length),o=e(i.slice(1))),c>=0&&(s=s||t.slice(0,c),l=t.slice(c,t.length)),s=Ob(s??t,n),{fullPath:s+i+l,path:s,query:o,hash:ic(l)}}function Pb(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Up(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Db(e,t,n){const s=t.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&tr(t.matched[s],n.matched[o])&&ly(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function tr(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ly(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!Rb(e[n],t[n]))return!1;return!0}function Rb(e,t){return Ts(e)?zp(e,t):Ts(t)?zp(t,e):e?.valueOf()===t?.valueOf()}function zp(e,t){return Ts(t)?e.length===t.length&&e.every((n,s)=>n===t[s]):e.length===1&&e[0]===t}function Ob(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),s=e.split("/"),o=s[s.length-1];(o===".."||o===".")&&s.push("");let i=n.length-1,l,c;for(l=0;l<s.length;l++)if(c=s[l],c!==".")if(c==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(l).join("/")}const Ya={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Nh=(function(e){return e.pop="pop",e.push="push",e})({}),Pd=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Nb(e){if(!e)if(zl){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Eb(e)}const Bb=/^[^#]+#/;function Fb(e,t){return e.replace(Bb,"#")+t}function Ub(e,t){const n=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:t.behavior,left:s.left-n.left-(t.left||0),top:s.top-n.top-(t.top||0)}}const Ju=()=>({left:window.scrollX,top:window.scrollY});function zb(e){let t;if("el"in e){const n=e.el,s=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=Ub(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Hp(e,t){return(history.state?history.state.position-t:-1)+e}const Bh=new Map;function Hb(e,t){Bh.set(e,t)}function Vb(e){const t=Bh.get(e);return Bh.delete(e),t}function Gb(e){return typeof e=="string"||e&&typeof e=="object"}function ry(e){return typeof e=="string"||typeof e=="symbol"}let gn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const cy=Symbol("");gn.MATCHER_NOT_FOUND+"",gn.NAVIGATION_GUARD_REDIRECT+"",gn.NAVIGATION_ABORTED+"",gn.NAVIGATION_CANCELLED+"",gn.NAVIGATION_DUPLICATED+"";function nr(e,t){return Zt(new Error,{type:e,[cy]:!0},t)}function ua(e,t){return e instanceof Error&&cy in e&&(t==null||!!(e.type&t))}const qb=["params","query","hash"];function jb(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of qb)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function Wb(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const o=n[s].replace(oy," "),i=o.indexOf("="),l=ic(i<0?o:o.slice(0,i)),c=i<0?null:ic(o.slice(i+1));if(l in t){let d=t[l];Ts(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function Vp(e){let t="";for(let n in e){const s=e[n];if(n=$b(n),s==null){s!==void 0&&(t+=(t.length?"&":"")+n);continue}(Ts(s)?s.map(o=>o&&Oh(o)):[s&&Oh(s)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function Zb(e){const t={};for(const n in e){const s=e[n];s!==void 0&&(t[n]=Ts(s)?s.map(o=>o==null?null:""+o):s==null?s:""+s)}return t}const Kb=Symbol(""),Gp=Symbol(""),Xu=Symbol(""),xf=Symbol(""),Fh=Symbol("");function Lr(){let e=[];function t(s){return e.push(s),()=>{const o=e.indexOf(s);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function oi(e,t,n,s,o,i=l=>l()){const l=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((c,d)=>{const h=y=>{y===!1?d(nr(gn.NAVIGATION_ABORTED,{from:n,to:t})):y instanceof Error?d(y):Gb(y)?d(nr(gn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&s.enterCallbacks[o]===l&&typeof y=="function"&&l.push(y),c())},f=i(()=>e.call(s&&s.instances[o],t,n,h));let m=Promise.resolve(f);e.length<3&&(m=m.then(h)),m.catch(y=>d(y))})}function Dd(e,t,n,s,o=i=>i()){const i=[];for(const l of e)for(const c in l.components){let d=l.components[c];if(!(t!=="beforeRouteEnter"&&!l.instances[c]))if(ty(d)){const h=(d.__vccOpts||d)[t];h&&i.push(oi(h,n,s,l,c,o))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${l.path}"`);const m=gb(f)?f.default:f;l.mods[c]=f,l.components[c]=m;const y=(m.__vccOpts||m)[t];return y&&oi(y,n,s,l,c,o)()}))}}return i}function Yb(e,t){const n=[],s=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const c=t.matched[l];c&&(e.matched.find(h=>tr(h,c))?s.push(c):n.push(c));const d=e.matched[l];d&&(t.matched.find(h=>tr(h,d))||o.push(d))}return[n,s,o]}let Jb=()=>location.protocol+"//"+location.host;function uy(e,t){const{pathname:n,search:s,hash:o}=t,i=e.indexOf("#");if(i>-1){let l=o.includes(e.slice(i))?e.slice(i).length:1,c=o.slice(l);return c[0]!=="/"&&(c="/"+c),Up(c,"")}return Up(n,e)+s+o}function Xb(e,t,n,s){let o=[],i=[],l=null;const c=({state:y})=>{const k=uy(e,location),w=n.value,x=t.value;let A=0;if(y){if(n.value=k,t.value=y,l&&l===w){l=null;return}A=x?y.position-x.position:0}else s(k);o.forEach(E=>{E(n.value,w,{delta:A,type:Nh.pop,direction:A?A>0?Pd.forward:Pd.back:Pd.unknown})})};function d(){l=n.value}function h(y){o.push(y);const k=()=>{const w=o.indexOf(y);w>-1&&o.splice(w,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Zt({},y.state,{scroll:Ju()}),"")}}function m(){for(const y of i)y();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:m}}function qp(e,t,n,s=!1,o=!1){return{back:e,current:t,forward:n,replaced:s,position:window.history.length,scroll:o?Ju():null}}function Qb(e){const{history:t,location:n}=window,s={value:uy(e,n)},o={value:t.state};o.value||i(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const m=e.indexOf("#"),y=m>-1?(n.host&&document.querySelector("base")?e:e.slice(m))+d:Jb()+e+d;try{t[f?"replaceState":"pushState"](h,"",y),o.value=h}catch(k){console.error(k),n[f?"replace":"assign"](y)}}function l(d,h){i(d,Zt({},t.state,qp(o.value.back,d,o.value.forward,!0),h,{position:o.value.position}),!0),s.value=d}function c(d,h){const f=Zt({},o.value,t.state,{forward:d,scroll:Ju()});i(f.current,f,!0),i(d,Zt({},qp(s.value,d,null),{position:f.position+1},h),!1),s.value=d}return{location:s,state:o,push:c,replace:l}}function ew(e){e=Nb(e);const t=Qb(e),n=Xb(e,t.state,t.location,t.replace);function s(i,l=!0){l||n.pauseListeners(),history.go(i)}const o=Zt({location:"",base:e,go:s,createHref:Fb.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function tw(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),ew(e)}let Zi=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Tn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Tn||{});const nw={type:Zi.Static,value:""},ow=/[a-zA-Z0-9_]/;function sw(e){if(!e)return[[]];if(e==="/")return[[nw]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${n})/"${h}": ${k}`)}let n=Tn.Static,s=n;const o=[];let i;function l(){i&&o.push(i),i=[]}let c=0,d,h="",f="";function m(){h&&(n===Tn.Static?i.push({type:Zi.Static,value:h}):n===Tn.Param||n===Tn.ParamRegExp||n===Tn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Zi.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;c<e.length;){if(d=e[c++],d==="\\"&&n!==Tn.ParamRegExp){s=n,n=Tn.EscapeNext;continue}switch(n){case Tn.Static:d==="/"?(h&&m(),l()):d===":"?(m(),n=Tn.Param):y();break;case Tn.EscapeNext:y(),n=s;break;case Tn.Param:d==="("?n=Tn.ParamRegExp:ow.test(d)?y():(m(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--);break;case Tn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:n=Tn.ParamRegExpEnd:f+=d;break;case Tn.ParamRegExpEnd:m(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--,f="";break;default:t("Unknown state");break}}return n===Tn.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),m(),l(),o}const jp="[^/]+?",aw={sensitive:!1,strict:!1,start:!0,end:!0};var vo=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(vo||{});const iw=/[.+*?^${}()[\]/\\]/g;function lw(e,t){const n=Zt({},aw,t),s=[];let o=n.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[vo.Root];n.strict&&!h.length&&(o+="/");for(let m=0;m<h.length;m++){const y=h[m];let k=vo.Segment+(n.sensitive?vo.BonusCaseSensitive:0);if(y.type===Zi.Static)m||(o+="/"),o+=y.value.replace(iw,"\\$&"),k+=vo.Static;else if(y.type===Zi.Param){const{value:w,repeatable:x,optional:A,regexp:E}=y;i.push({name:w,repeatable:x,optional:A});const _=E||jp;if(_!==jp){k+=vo.BonusCustomRegExp;try{`${_}`}catch(S){throw new Error(`Invalid custom RegExp for param "${w}" (${_}): `+S.message)}}let C=x?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;m||(C=A&&h.length<2?`(?:/${C})`:"/"+C),A&&(C+="?"),o+=C,k+=vo.Dynamic,A&&(k+=vo.BonusOptional),x&&(k+=vo.BonusRepeatable),_===".*"&&(k+=vo.BonusWildcard)}f.push(k)}s.push(f)}if(n.strict&&n.end){const h=s.length-1;s[h][s[h].length-1]+=vo.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const l=new RegExp(o,n.sensitive?"":"i");function c(h){const f=h.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const k=f[y]||"",w=i[y-1];m[w.name]=k&&w.repeatable?k.split("/"):k}return m}function d(h){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const k of y)if(k.type===Zi.Static)f+=k.value;else if(k.type===Zi.Param){const{value:w,repeatable:x,optional:A}=k,E=w in h?h[w]:"";if(Ts(E)&&!x)throw new Error(`Provided param "${w}" is an array but it is not repeatable (* or + modifiers)`);const _=Ts(E)?E.join("/"):E;if(!_)if(A)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${w}"`);f+=_}}return f||"/"}return{re:l,score:s,keys:i,parse:c,stringify:d}}function rw(e,t){let n=0;for(;n<e.length&&n<t.length;){const s=t[n]-e[n];if(s)return s;n++}return e.length<t.length?e.length===1&&e[0]===vo.Static+vo.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===vo.Static+vo.Segment?1:-1:0}function dy(e,t){let n=0;const s=e.score,o=t.score;for(;n<s.length&&n<o.length;){const i=rw(s[n],o[n]);if(i)return i;n++}if(Math.abs(o.length-s.length)===1){if(Wp(s))return 1;if(Wp(o))return-1}return o.length-s.length}function Wp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const cw={strict:!1,end:!0,sensitive:!1};function uw(e,t,n){const s=lw(sw(e.path),n),o=Zt(s,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function dw(e,t){const n=[],s=new Map;t=Fp(cw,t);function o(m){return s.get(m)}function i(m,y,k){const w=!k,x=Kp(m);x.aliasOf=k&&k.record;const A=Fp(t,m),E=[x];if("alias"in m){const S=typeof m.alias=="string"?[m.alias]:m.alias;for(const $ of S)E.push(Kp(Zt({},x,{components:k?k.record.components:x.components,path:$,aliasOf:k?k.record:x})))}let _,C;for(const S of E){const{path:$}=S;if(y&&$[0]!=="/"){const R=y.record.path,T=R[R.length-1]==="/"?"":"/";S.path=y.record.path+($&&T+$)}if(_=uw(S,y,A),k?k.alias.push(_):(C=C||_,C!==_&&C.alias.push(_),w&&m.name&&!Yp(_)&&l(m.name)),hy(_)&&d(_),x.children){const R=x.children;for(let T=0;T<R.length;T++)i(R[T],_,k&&k.children[T])}k=k||_}return C?()=>{l(C)}:Gr}function l(m){if(ry(m)){const y=s.get(m);y&&(s.delete(m),n.splice(n.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=n.indexOf(m);y>-1&&(n.splice(y,1),m.record.name&&s.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function c(){return n}function d(m){const y=pw(m,n);n.splice(y,0,m),m.record.name&&!Yp(m)&&s.set(m.record.name,m)}function h(m,y){let k,w={},x,A;if("name"in m&&m.name){if(k=s.get(m.name),!k)throw nr(gn.MATCHER_NOT_FOUND,{location:m});A=k.record.name,w=Zt(Zp(y.params,k.keys.filter(C=>!C.optional).concat(k.parent?k.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),m.params&&Zp(m.params,k.keys.map(C=>C.name))),x=k.stringify(w)}else if(m.path!=null)x=m.path,k=n.find(C=>C.re.test(x)),k&&(w=k.parse(x),A=k.record.name);else{if(k=y.name?s.get(y.name):n.find(C=>C.re.test(y.path)),!k)throw nr(gn.MATCHER_NOT_FOUND,{location:m,currentLocation:y});A=k.record.name,w=Zt({},y.params,m.params),x=k.stringify(w)}const E=[];let _=k;for(;_;)E.unshift(_.record),_=_.parent;return{name:A,path:x,params:w,matched:E,meta:fw(E)}}e.forEach(m=>i(m));function f(){n.length=0,s.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:c,getRecordMatcher:o}}function Zp(e,t){const n={};for(const s of t)s in e&&(n[s]=e[s]);return n}function Kp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:hw(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function hw(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const s in e.components)t[s]=typeof n=="object"?n[s]:n;return t}function Yp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function fw(e){return e.reduce((t,n)=>Zt(t,n.meta),{})}function pw(e,t){let n=0,s=t.length;for(;n!==s;){const i=n+s>>1;dy(e,t[i])<0?s=i:n=i+1}const o=vw(e);return o&&(s=t.lastIndexOf(o,s-1)),s}function vw(e){let t=e;for(;t=t.parent;)if(hy(t)&&dy(e,t)===0)return t}function hy({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Jp(e){const t=$o(Xu),n=$o(xf),s=H(()=>{const d=B(e.to);return t.resolve(d)}),o=H(()=>{const{matched:d}=s.value,{length:h}=d,f=d[h-1],m=n.matched;if(!f||!m.length)return-1;const y=m.findIndex(tr.bind(null,f));if(y>-1)return y;const k=Xp(d[h-2]);return h>1&&Xp(f)===k&&m[m.length-1].path!==k?m.findIndex(tr.bind(null,d[h-2])):y}),i=H(()=>o.value>-1&&bw(n.params,s.value.params)),l=H(()=>o.value>-1&&o.value===n.matched.length-1&&ly(n.params,s.value.params));function c(d={}){if(kw(d)){const h=t[B(e.replace)?"replace":"push"](B(e.to)).catch(Gr);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:s,href:H(()=>s.value.href),isActive:i,isExactActive:l,navigate:c}}function mw(e){return e.length===1?e[0]:e}const gw=gg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Jp,setup(e,{slots:t}){const n=ol(Jp(e)),{options:s}=$o(Xu),o=H(()=>({[Qp(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Qp(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&mw(t.default(n));return e.custom?i:Lf("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),yw=gw;function kw(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function bw(e,t){for(const n in t){const s=t[n],o=e[n];if(typeof s=="string"){if(s!==o)return!1}else if(!Ts(o)||o.length!==s.length||s.some((i,l)=>i.valueOf()!==o[l].valueOf()))return!1}return!0}function Xp(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Qp=(e,t,n)=>e??t??n,ww=gg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=$o(Fh),o=H(()=>e.route||s.value),i=$o(Gp,0),l=H(()=>{let h=B(i);const{matched:f}=o.value;let m;for(;(m=f[h])&&!m.components;)h++;return h}),c=H(()=>o.value.matched[l.value]);Nr(Gp,H(()=>l.value+1)),Nr(Kb,c),Nr(Fh,o);const d=D();return Ye(()=>[d.value,c.value,e.name],([h,f,m],[y,k,w])=>{f&&(f.instances[m]=h,k&&k!==f&&h&&h===y&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!tr(f,k)||!y)&&(f.enterCallbacks[m]||[]).forEach(x=>x(h))},{flush:"post"}),()=>{const h=o.value,f=e.name,m=c.value,y=m&&m.components[f];if(!y)return ev(n.default,{Component:y,route:h});const k=m.props[f],w=k?k===!0?h.params:typeof k=="function"?k(h):k:null,A=Lf(y,Zt({},w,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return ev(n.default,{Component:A,route:h})||A}}});function ev(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const _w=ww;function Cw(e){const t=dw(e.routes,e),n=e.parseQuery||Wb,s=e.stringifyQuery||Vp,o=e.history,i=Lr(),l=Lr(),c=Lr(),d=yk(Ya);let h=Ya;zl&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ad.bind(null,z=>""+z),m=Ad.bind(null,Mb),y=Ad.bind(null,ic);function k(z,J){let de,ie;return ry(z)?(de=t.getRecordMatcher(z),ie=J):ie=z,t.addRoute(ie,de)}function w(z){const J=t.getRecordMatcher(z);J&&t.removeRoute(J)}function x(){return t.getRoutes().map(z=>z.record)}function A(z){return!!t.getRecordMatcher(z)}function E(z,J){if(J=Zt({},J||d.value),typeof z=="string"){const ee=Ed(n,z,J.path),Ce=t.resolve({path:ee.path},J),Be=o.createHref(ee.fullPath);return Zt(ee,Ce,{params:y(Ce.params),hash:ic(ee.hash),redirectedFrom:void 0,href:Be})}let de;if(z.path!=null)de=Zt({},z,{path:Ed(n,z.path,J.path).path});else{const ee=Zt({},z.params);for(const Ce in ee)ee[Ce]==null&&delete ee[Ce];de=Zt({},z,{params:m(ee)}),J.params=m(J.params)}const ie=t.resolve(de,J),Ae=z.hash||"";ie.params=f(y(ie.params));const G=Pb(s,Zt({},z,{hash:xb(Ae),path:ie.path})),X=o.createHref(G);return Zt({fullPath:G,hash:Ae,query:s===Vp?Zb(z.query):z.query||{}},ie,{redirectedFrom:void 0,href:X})}function _(z){return typeof z=="string"?Ed(n,z,d.value.path):Zt({},z)}function C(z,J){if(h!==z)return nr(gn.NAVIGATION_CANCELLED,{from:J,to:z})}function S(z){return T(z)}function $(z){return S(Zt(_(z),{replace:!0}))}function R(z,J){const de=z.matched[z.matched.length-1];if(de&&de.redirect){const{redirect:ie}=de;let Ae=typeof ie=="function"?ie(z,J):ie;return typeof Ae=="string"&&(Ae=Ae.includes("?")||Ae.includes("#")?Ae=_(Ae):{path:Ae},Ae.params={}),Zt({query:z.query,hash:z.hash,params:Ae.path!=null?{}:z.params},Ae)}}function T(z,J){const de=h=E(z),ie=d.value,Ae=z.state,G=z.force,X=z.replace===!0,ee=R(de,ie);if(ee)return T(Zt(_(ee),{state:typeof ee=="object"?Zt({},Ae,ee.state):Ae,force:G,replace:X}),J||de);const Ce=de;Ce.redirectedFrom=J;let Be;return!G&&Db(s,ie,de)&&(Be=nr(gn.NAVIGATION_DUPLICATED,{to:Ce,from:ie}),ue(ie,ie,!0,!1)),(Be?Promise.resolve(Be):U(Ce,ie)).catch(Fe=>ua(Fe)?ua(Fe,gn.NAVIGATION_GUARD_REDIRECT)?Fe:te(Fe):q(Fe,Ce,ie)).then(Fe=>{if(Fe){if(ua(Fe,gn.NAVIGATION_GUARD_REDIRECT))return T(Zt({replace:X},_(Fe.to),{state:typeof Fe.to=="object"?Zt({},Ae,Fe.to.state):Ae,force:G}),J||Ce)}else Fe=j(Ce,ie,!0,X,Ae);return F(Ce,ie,Fe),Fe})}function O(z,J){const de=C(z,J);return de?Promise.reject(de):Promise.resolve()}function M(z){const J=De.values().next().value;return J&&typeof J.runWithContext=="function"?J.runWithContext(z):z()}function U(z,J){let de;const[ie,Ae,G]=Yb(z,J);de=Dd(ie.reverse(),"beforeRouteLeave",z,J);for(const ee of ie)ee.leaveGuards.forEach(Ce=>{de.push(oi(Ce,z,J))});const X=O.bind(null,z,J);return de.push(X),be(de).then(()=>{de=[];for(const ee of i.list())de.push(oi(ee,z,J));return de.push(X),be(de)}).then(()=>{de=Dd(Ae,"beforeRouteUpdate",z,J);for(const ee of Ae)ee.updateGuards.forEach(Ce=>{de.push(oi(Ce,z,J))});return de.push(X),be(de)}).then(()=>{de=[];for(const ee of G)if(ee.beforeEnter)if(Ts(ee.beforeEnter))for(const Ce of ee.beforeEnter)de.push(oi(Ce,z,J));else de.push(oi(ee.beforeEnter,z,J));return de.push(X),be(de)}).then(()=>(z.matched.forEach(ee=>ee.enterCallbacks={}),de=Dd(G,"beforeRouteEnter",z,J,M),de.push(X),be(de))).then(()=>{de=[];for(const ee of l.list())de.push(oi(ee,z,J));return de.push(X),be(de)}).catch(ee=>ua(ee,gn.NAVIGATION_CANCELLED)?ee:Promise.reject(ee))}function F(z,J,de){c.list().forEach(ie=>M(()=>ie(z,J,de)))}function j(z,J,de,ie,Ae){const G=C(z,J);if(G)return G;const X=J===Ya,ee=zl?history.state:{};de&&(ie||X?o.replace(z.fullPath,Zt({scroll:X&&ee&&ee.scroll},Ae)):o.push(z.fullPath,Ae)),d.value=z,ue(z,J,de,X),te()}let Z;function Q(){Z||(Z=o.listen((z,J,de)=>{if(!Re.listening)return;const ie=E(z),Ae=R(ie,Re.currentRoute.value);if(Ae){T(Zt(Ae,{replace:!0,force:!0}),ie).catch(Gr);return}h=ie;const G=d.value;zl&&Hb(Hp(G.fullPath,de.delta),Ju()),U(ie,G).catch(X=>ua(X,gn.NAVIGATION_ABORTED|gn.NAVIGATION_CANCELLED)?X:ua(X,gn.NAVIGATION_GUARD_REDIRECT)?(T(Zt(_(X.to),{force:!0}),ie).then(ee=>{ua(ee,gn.NAVIGATION_ABORTED|gn.NAVIGATION_DUPLICATED)&&!de.delta&&de.type===Nh.pop&&o.go(-1,!1)}).catch(Gr),Promise.reject()):(de.delta&&o.go(-de.delta,!1),q(X,ie,G))).then(X=>{X=X||j(ie,G,!1),X&&(de.delta&&!ua(X,gn.NAVIGATION_CANCELLED)?o.go(-de.delta,!1):de.type===Nh.pop&&ua(X,gn.NAVIGATION_ABORTED|gn.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),F(ie,G,X)}).catch(Gr)}))}let re=Lr(),K=Lr(),ae;function q(z,J,de){te(z);const ie=K.list();return ie.length?ie.forEach(Ae=>Ae(z,J,de)):console.error(z),Promise.reject(z)}function Y(){return ae&&d.value!==Ya?Promise.resolve():new Promise((z,J)=>{re.add([z,J])})}function te(z){return ae||(ae=!z,Q(),re.list().forEach(([J,de])=>z?de(z):J()),re.reset()),z}function ue(z,J,de,ie){const{scrollBehavior:Ae}=e;if(!zl||!Ae)return Promise.resolve();const G=!de&&Vb(Hp(z.fullPath,0))||(ie||!de)&&history.state&&history.state.scroll||null;return rn().then(()=>Ae(z,J,G)).then(X=>X&&zb(X)).catch(X=>q(X,z,J))}const _e=z=>o.go(z);let $e;const De=new Set,Re={currentRoute:d,listening:!0,addRoute:k,removeRoute:w,clearRoutes:t.clearRoutes,hasRoute:A,getRoutes:x,resolve:E,options:e,push:S,replace:$,go:_e,back:()=>_e(-1),forward:()=>_e(1),beforeEach:i.add,beforeResolve:l.add,afterEach:c.add,onError:K.add,isReady:Y,install(z){z.component("RouterLink",yw),z.component("RouterView",_w),z.config.globalProperties.$router=Re,Object.defineProperty(z.config.globalProperties,"$route",{enumerable:!0,get:()=>B(d)}),zl&&!$e&&d.value===Ya&&($e=!0,S(o.location).catch(ie=>{}));const J={};for(const ie in Ya)Object.defineProperty(J,ie,{get:()=>d.value[ie],enumerable:!0});z.provide(Xu,Re),z.provide(xf,Jm(J)),z.provide(Fh,d);const de=z.unmount;De.add(z),z.unmount=function(){De.delete(z),De.size<1&&(h=Ya,Z&&Z(),Z=null,d.value=Ya,$e=!1,ae=!1),de()}}};function be(z){return z.reduce((J,de)=>J.then(()=>M(de)),Promise.resolve())}return Re}function ir(){return $o(Xu)}function Qu(e){return $o(xf)}const Lw=500,Sw=3e3,Iw=500,qi=D(new Map),$f=D(!1),yu=D("");let fy=!1,xw=0,qr=null;function $w(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:Lw}:{message:"Loading...",delay:Sw}}function Tw(){qr&&(clearTimeout(qr),qr=null)}function Mw(e){if(e.skipLoadingOverlay)return null;const t=(e.method||"get").toUpperCase();if(fy&&t==="GET")return null;Tw();const n=++xw,{message:s,delay:o}=$w(e.method),i=setTimeout(()=>{qi.value.has(n)&&(yu.value=s,$f.value=!0)},o);return qi.value.set(n,{config:e,message:s,timeoutId:i}),e._loadingRequestId=n,n}function tv(e){if(e===null)return;const t=qi.value.get(e);if(t)if(clearTimeout(t.timeoutId),qi.value.delete(e),qi.value.size===0)qr=setTimeout(()=>{qi.value.size===0&&($f.value=!1,yu.value=""),qr=null},Iw);else{const n=qi.value.values().next().value;n&&(yu.value=n.message)}}function nv(e){return e?._loadingRequestId}function Aw(){return{showOverlay:$f,overlayMessage:yu}}function ov(e){fy=e}const Ke=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},Ew={key:0,class:"loading-overlay"},Pw={class:"loading-content"},Dw={class:"loading-message"},Rw={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:n}=Aw();return(s,o)=>(p(),Ge(Ls,{name:"fade"},{default:Ve(()=>[B(t)?(p(),g("div",Ew,[r("div",Pw,[o[0]||(o[0]=r("div",{class:"spinner"},null,-1)),r("p",Dw,b(B(n)||"Loading..."),1)])])):P("",!0)]),_:1}))}},Ow=Ke(Rw,[["__scopeId","data-v-fdee3530"]]),Nw={__name:"App",setup(e){const t=ir(),n=D(""),s=["/","/sessions"];return Ye(()=>t.currentRoute.value,(o,i)=>{if(!i?.path){n.value="";return}const l=s.indexOf(o.path),c=s.indexOf(i.path);l!==-1&&c!==-1?n.value=l>c?"slide-left":"slide-right":n.value=""},{immediate:!0}),(o,i)=>{const l=yf("router-view");return p(),g(Se,null,[Pe(l,null,{default:Ve(({Component:c,route:d})=>[Pe(Ls,{name:n.value,mode:"out-in"},{default:Ve(()=>[(p(),Ge(Wk(c),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Pe(Ow)],64)}}},lr="marshalSessions",Bw=30;function ku(e,t){return`${e}:${t}`}function Tf(e){const[t,n]=e.split(":");return{eventId:t,marshalId:n}}function yi(){try{return JSON.parse(localStorage.getItem(lr)||"{}")}catch{return{}}}function bu(e){const t=yi(),n=Object.entries(t).filter(([s])=>s.startsWith(`${e}:`)).map(([s,o])=>({sessionKey:s,...o}));return n.length===0?null:(n.sort((s,o)=>new Date(o.lastAccessed)-new Date(s.lastAccessed)),n[0])}function sv(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const n=yi(),s=ku(e,t.marshalId);n[s]={...n[s],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(lr,JSON.stringify(n))}function Uh(e){const t=yi(),{eventId:n,marshalId:s}=Tf(e);delete t[e],localStorage.setItem(lr,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${n}_${s}`)}function py(e,t){const n=yi(),s=ku(e,t);n[s]&&(n[s].lastAccessed=new Date().toISOString(),localStorage.setItem(lr,JSON.stringify(n)))}function vy(){const e=yi(),t=new Date;t.setDate(t.getDate()-Bw);let n=!1;for(const s of Object.keys(e))if(new Date(e[s].lastAccessed)<t){const{eventId:i,marshalId:l}=Tf(s);delete e[s],localStorage.removeItem(`marshalCode_${i}_${l}`),n=!0}n&&localStorage.setItem(lr,JSON.stringify(e))}function my(){const e=yi(),t=[];for(let s=0;s<localStorage.length;s++){const o=localStorage.key(s);if(o&&o.startsWith("marshal_")&&!o.startsWith("marshalCode_")&&!o.startsWith("marshalSessions")){const i=o.replace("marshal_",""),l=localStorage.getItem(o);if(l){const c=ku(i,l);e[c]||(e[c]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(o)}}const n=Object.keys(e).filter(s=>!s.includes(":"));for(const s of n){const o=e[s];if(o&&o.marshalId){const i=ku(s,o.marshalId);e[i]||(e[i]={...o,eventId:s}),delete e[s]}}(t.length>0||n.length>0)&&(localStorage.setItem(lr,JSON.stringify(e)),t.forEach(s=>localStorage.removeItem(s)))}function Fw(){const e=yi();return Object.entries(e).map(([t,n])=>{const{eventId:s,marshalId:o}=Tf(t);return{sessionKey:t,eventId:s,marshalId:o,...n}}).filter(t=>t.token).sort((t,n)=>t.eventDate&&n.eventDate?new Date(t.eventDate)-new Date(n.eventDate):new Date(n.lastAccessed)-new Date(t.lastAccessed))}function gy(){const e=yi();return Object.values(e).some(t=>t.token)}function yy(e,t){const n=`marshalCode_${e}_${t}`,s=localStorage.getItem(n);return s||localStorage.getItem(`marshalCode_${e}`)}function Uw(e,t,n){localStorage.setItem(`marshalCode_${e}_${t}`,n)}function ky(e,t){return function(){return e.apply(t,arguments)}}const{toString:zw}=Object.prototype,{getPrototypeOf:Mf}=Object,{iterator:ed,toStringTag:by}=Symbol,td=(e=>t=>{const n=zw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ms=e=>(e=e.toLowerCase(),t=>td(t)===e),nd=e=>t=>typeof t===e,{isArray:rr}=Array,or=nd("undefined");function hc(e){return e!==null&&!or(e)&&e.constructor!==null&&!or(e.constructor)&&To(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const wy=Ms("ArrayBuffer");function Hw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&wy(e.buffer),t}const Vw=nd("string"),To=nd("function"),_y=nd("number"),fc=e=>e!==null&&typeof e=="object",Gw=e=>e===!0||e===!1,Jc=e=>{if(td(e)!=="object")return!1;const t=Mf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(by in e)&&!(ed in e)},qw=e=>{if(!fc(e)||hc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},jw=Ms("Date"),Ww=Ms("File"),Zw=Ms("Blob"),Kw=Ms("FileList"),Yw=e=>fc(e)&&To(e.pipe),Jw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||To(e.append)&&((t=td(e))==="formdata"||t==="object"&&To(e.toString)&&e.toString()==="[object FormData]"))},Xw=Ms("URLSearchParams"),[Qw,e_,t_,n_]=["ReadableStream","Request","Response","Headers"].map(Ms),o_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),rr(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(hc(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let c;for(s=0;s<l;s++)c=i[s],t.call(null,e[c],c,e)}}function Cy(e,t){if(hc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ly=e=>!or(e)&&e!==Ki;function zh(){const{caseless:e,skipUndefined:t}=Ly(this)&&this||{},n={},s=(o,i)=>{const l=e&&Cy(n,i)||i;Jc(n[l])&&Jc(o)?n[l]=zh(n[l],o):Jc(o)?n[l]=zh({},o):rr(o)?n[l]=o.slice():(!t||!or(o))&&(n[l]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&pc(arguments[o],s);return n}const s_=(e,t,n,{allOwnKeys:s}={})=>(pc(t,(o,i)=>{n&&To(o)?e[i]=ky(o,n):e[i]=o},{allOwnKeys:s}),e),a_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),i_=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},l_=(e,t,n,s)=>{let o,i,l;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)l=o[i],(!s||s(l,e,t))&&!c[l]&&(t[l]=e[l],c[l]=!0);e=n!==!1&&Mf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},r_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},c_=e=>{if(!e)return null;if(rr(e))return e;let t=e.length;if(!_y(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},u_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Mf(Uint8Array)),d_=(e,t)=>{const s=(e&&e[ed]).call(e);let o;for(;(o=s.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},h_=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},f_=Ms("HTMLFormElement"),p_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),av=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),v_=Ms("RegExp"),Sy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};pc(n,(o,i)=>{let l;(l=t(o,i,e))!==!1&&(s[i]=l||o)}),Object.defineProperties(e,s)},m_=e=>{Sy(e,(t,n)=>{if(To(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(To(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},g_=(e,t)=>{const n={},s=o=>{o.forEach(i=>{n[i]=!0})};return rr(e)?s(e):s(String(e).split(t)),n},y_=()=>{},k_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function b_(e){return!!(e&&To(e.append)&&e[by]==="FormData"&&e[ed])}const w_=e=>{const t=new Array(10),n=(s,o)=>{if(fc(s)){if(t.indexOf(s)>=0)return;if(hc(s))return s;if(!("toJSON"in s)){t[o]=s;const i=rr(s)?[]:{};return pc(s,(l,c)=>{const d=n(l,o+1);!or(d)&&(i[c]=d)}),t[o]=void 0,i}}return s};return n(e,0)},__=Ms("AsyncFunction"),C_=e=>e&&(fc(e)||To(e))&&To(e.then)&&To(e.catch),Iy=((e,t)=>e?setImmediate:t?((n,s)=>(Ki.addEventListener("message",({source:o,data:i})=>{o===Ki&&i===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Ki.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",To(Ki.postMessage)),L_=typeof queueMicrotask<"u"?queueMicrotask.bind(Ki):typeof process<"u"&&process.nextTick||Iy,S_=e=>e!=null&&To(e[ed]),ze={isArray:rr,isArrayBuffer:wy,isBuffer:hc,isFormData:Jw,isArrayBufferView:Hw,isString:Vw,isNumber:_y,isBoolean:Gw,isObject:fc,isPlainObject:Jc,isEmptyObject:qw,isReadableStream:Qw,isRequest:e_,isResponse:t_,isHeaders:n_,isUndefined:or,isDate:jw,isFile:Ww,isBlob:Zw,isRegExp:v_,isFunction:To,isStream:Yw,isURLSearchParams:Xw,isTypedArray:u_,isFileList:Kw,forEach:pc,merge:zh,extend:s_,trim:o_,stripBOM:a_,inherits:i_,toFlatObject:l_,kindOf:td,kindOfTest:Ms,endsWith:r_,toArray:c_,forEachEntry:d_,matchAll:h_,isHTMLForm:f_,hasOwnProperty:av,hasOwnProp:av,reduceDescriptors:Sy,freezeMethods:m_,toObjectSet:g_,toCamelCase:p_,noop:y_,toFiniteNumber:k_,findKey:Cy,global:Ki,isContextDefined:Ly,isSpecCompliantForm:b_,toJSONObject:w_,isAsyncFn:__,isThenable:C_,setImmediate:Iy,asap:L_,isIterable:S_};function It(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}ze.inherits(It,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ze.toJSONObject(this.config),code:this.code,status:this.status}}});const xy=It.prototype,$y={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{$y[e]={value:e}});Object.defineProperties(It,$y);Object.defineProperty(xy,"isAxiosError",{value:!0});It.from=(e,t,n,s,o,i)=>{const l=Object.create(xy);ze.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const c=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return It.call(l,c,d,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const I_=null;function Hh(e){return ze.isPlainObject(e)||ze.isArray(e)}function Ty(e){return ze.endsWith(e,"[]")?e.slice(0,-2):e}function iv(e,t,n){return e?e.concat(t).map(function(o,i){return o=Ty(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function x_(e){return ze.isArray(e)&&!e.some(Hh)}const $_=ze.toFlatObject(ze,{},null,function(t){return/^is[A-Z]/.test(t)});function od(e,t,n){if(!ze.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ze.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,A){return!ze.isUndefined(A[x])});const s=n.metaTokens,o=n.visitor||f,i=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&ze.isSpecCompliantForm(t);if(!ze.isFunction(o))throw new TypeError("visitor must be a function");function h(w){if(w===null)return"";if(ze.isDate(w))return w.toISOString();if(ze.isBoolean(w))return w.toString();if(!d&&ze.isBlob(w))throw new It("Blob is not supported. Use a Buffer instead.");return ze.isArrayBuffer(w)||ze.isTypedArray(w)?d&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function f(w,x,A){let E=w;if(w&&!A&&typeof w=="object"){if(ze.endsWith(x,"{}"))x=s?x:x.slice(0,-2),w=JSON.stringify(w);else if(ze.isArray(w)&&x_(w)||(ze.isFileList(w)||ze.endsWith(x,"[]"))&&(E=ze.toArray(w)))return x=Ty(x),E.forEach(function(C,S){!(ze.isUndefined(C)||C===null)&&t.append(l===!0?iv([x],S,i):l===null?x:x+"[]",h(C))}),!1}return Hh(w)?!0:(t.append(iv(A,x,i),h(w)),!1)}const m=[],y=Object.assign($_,{defaultVisitor:f,convertValue:h,isVisitable:Hh});function k(w,x){if(!ze.isUndefined(w)){if(m.indexOf(w)!==-1)throw Error("Circular reference detected in "+x.join("."));m.push(w),ze.forEach(w,function(E,_){(!(ze.isUndefined(E)||E===null)&&o.call(t,E,ze.isString(_)?_.trim():_,x,y))===!0&&k(E,x?x.concat(_):[_])}),m.pop()}}if(!ze.isObject(e))throw new TypeError("data must be an object");return k(e),t}function lv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Af(e,t){this._pairs=[],e&&od(e,this,t)}const My=Af.prototype;My.append=function(t,n){this._pairs.push([t,n])};My.toString=function(t){const n=t?function(s){return t.call(this,s,lv)}:lv;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function T_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ay(e,t,n){if(!t)return e;const s=n&&n.encode||T_;ze.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(t,n):i=ze.isURLSearchParams(t)?t.toString():new Af(t,n).toString(s),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class rv{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ze.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Ey={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},M_=typeof URLSearchParams<"u"?URLSearchParams:Af,A_=typeof FormData<"u"?FormData:null,E_=typeof Blob<"u"?Blob:null,P_={isBrowser:!0,classes:{URLSearchParams:M_,FormData:A_,Blob:E_},protocols:["http","https","file","blob","url","data"]},Ef=typeof window<"u"&&typeof document<"u",Vh=typeof navigator=="object"&&navigator||void 0,D_=Ef&&(!Vh||["ReactNative","NativeScript","NS"].indexOf(Vh.product)<0),R_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",O_=Ef&&window.location.href||"http://localhost",N_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ef,hasStandardBrowserEnv:D_,hasStandardBrowserWebWorkerEnv:R_,navigator:Vh,origin:O_},Symbol.toStringTag,{value:"Module"})),oo={...N_,...P_};function B_(e,t){return od(e,new oo.classes.URLSearchParams,{visitor:function(n,s,o,i){return oo.isNode&&ze.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function F_(e){return ze.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function U_(e){const t={},n=Object.keys(e);let s;const o=n.length;let i;for(s=0;s<o;s++)i=n[s],t[i]=e[i];return t}function Py(e){function t(n,s,o,i){let l=n[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=i>=n.length;return l=!l&&ze.isArray(o)?o.length:l,d?(ze.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!c):((!o[l]||!ze.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],i)&&ze.isArray(o[l])&&(o[l]=U_(o[l])),!c)}if(ze.isFormData(e)&&ze.isFunction(e.entries)){const n={};return ze.forEachEntry(e,(s,o)=>{t(F_(s),o,n,0)}),n}return null}function z_(e,t,n){if(ze.isString(e))try{return(t||JSON.parse)(e),ze.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const vc={transitional:Ey,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,i=ze.isObject(t);if(i&&ze.isHTMLForm(t)&&(t=new FormData(t)),ze.isFormData(t))return o?JSON.stringify(Py(t)):t;if(ze.isArrayBuffer(t)||ze.isBuffer(t)||ze.isStream(t)||ze.isFile(t)||ze.isBlob(t)||ze.isReadableStream(t))return t;if(ze.isArrayBufferView(t))return t.buffer;if(ze.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return B_(t,this.formSerializer).toString();if((c=ze.isFileList(t))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return od(c?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),z_(t)):t}],transformResponse:[function(t){const n=this.transitional||vc.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(ze.isResponse(t)||ze.isReadableStream(t))return t;if(t&&ze.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?It.from(c,It.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oo.classes.FormData,Blob:oo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ze.forEach(["delete","get","head","post","put","patch"],e=>{vc.headers[e]={}});const H_=ze.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),V_=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&H_[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},cv=Symbol("internals");function Sr(e){return e&&String(e).trim().toLowerCase()}function Xc(e){return e===!1||e==null?e:ze.isArray(e)?e.map(Xc):String(e)}function G_(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const q_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Rd(e,t,n,s,o){if(ze.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!ze.isString(t)){if(ze.isString(s))return t.indexOf(s)!==-1;if(ze.isRegExp(s))return s.test(t)}}function j_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function W_(e,t){const n=ze.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,i,l){return this[s].call(this,t,o,i,l)},configurable:!0})})}let Mo=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function i(c,d,h){const f=Sr(d);if(!f)throw new Error("header name must be a non-empty string");const m=ze.findKey(o,f);(!m||o[m]===void 0||h===!0||h===void 0&&o[m]!==!1)&&(o[m||d]=Xc(c))}const l=(c,d)=>ze.forEach(c,(h,f)=>i(h,f,d));if(ze.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(ze.isString(t)&&(t=t.trim())&&!q_(t))l(V_(t),n);else if(ze.isObject(t)&&ze.isIterable(t)){let c={},d,h;for(const f of t){if(!ze.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[h=f[0]]=(d=c[h])?ze.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(c,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=Sr(t),t){const s=ze.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return G_(o);if(ze.isFunction(n))return n.call(this,o,s);if(ze.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Sr(t),t){const s=ze.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Rd(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function i(l){if(l=Sr(l),l){const c=ze.findKey(s,l);c&&(!n||Rd(s,s[c],c,n))&&(delete s[c],o=!0)}}return ze.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const i=n[s];(!t||Rd(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,s={};return ze.forEach(this,(o,i)=>{const l=ze.findKey(s,i);if(l){n[l]=Xc(o),delete n[i];return}const c=t?j_(i):String(i).trim();c!==i&&delete n[i],n[c]=Xc(o),s[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ze.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&ze.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[cv]=this[cv]={accessors:{}}).accessors,o=this.prototype;function i(l){const c=Sr(l);s[c]||(W_(o,l),s[c]=!0)}return ze.isArray(t)?t.forEach(i):i(t),this}};Mo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ze.reduceDescriptors(Mo.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});ze.freezeMethods(Mo);function Od(e,t){const n=this||vc,s=t||n,o=Mo.from(s.headers);let i=s.data;return ze.forEach(e,function(c){i=c.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Dy(e){return!!(e&&e.__CANCEL__)}function cr(e,t,n){It.call(this,e??"canceled",It.ERR_CANCELED,t,n),this.name="CanceledError"}ze.inherits(cr,It,{__CANCEL__:!0});function Ry(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Z_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function K_(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=s[i];l||(l=h),n[o]=d,s[o]=h;let m=i,y=0;for(;m!==o;)y+=n[m++],m=m%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(y*1e3/k):void 0}}function Y_(e,t){let n=0,s=1e3/t,o,i;const l=(h,f=Date.now())=>{n=f,o=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),m=f-n;m>=s?l(h,f):(o=h,i||(i=setTimeout(()=>{i=null,l(o)},s-m)))},()=>o&&l(o)]}const wu=(e,t,n=3)=>{let s=0;const o=K_(50,250);return Y_(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,d=l-s,h=o(d),f=l<=c;s=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:h||void 0,estimated:h&&c&&f?(c-l)/h:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(m)},n)},uv=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},dv=e=>(...t)=>ze.asap(()=>e(...t)),J_=oo.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,oo.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(oo.origin),oo.navigator&&/(msie|trident)/i.test(oo.navigator.userAgent)):()=>!0,X_=oo.hasStandardBrowserEnv?{write(e,t,n,s,o,i,l){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];ze.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),ze.isString(s)&&c.push(`path=${s}`),ze.isString(o)&&c.push(`domain=${o}`),i===!0&&c.push("secure"),ze.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Q_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function eC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Oy(e,t,n){let s=!Q_(t);return e&&(s||n==!1)?eC(e,t):t}const hv=e=>e instanceof Mo?{...e}:e;function tl(e,t){t=t||{};const n={};function s(h,f,m,y){return ze.isPlainObject(h)&&ze.isPlainObject(f)?ze.merge.call({caseless:y},h,f):ze.isPlainObject(f)?ze.merge({},f):ze.isArray(f)?f.slice():f}function o(h,f,m,y){if(ze.isUndefined(f)){if(!ze.isUndefined(h))return s(void 0,h,m,y)}else return s(h,f,m,y)}function i(h,f){if(!ze.isUndefined(f))return s(void 0,f)}function l(h,f){if(ze.isUndefined(f)){if(!ze.isUndefined(h))return s(void 0,h)}else return s(void 0,f)}function c(h,f,m){if(m in t)return s(h,f);if(m in e)return s(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(h,f,m)=>o(hv(h),hv(f),m,!0)};return ze.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||o,y=m(e[f],t[f],f);ze.isUndefined(y)&&m!==c||(n[f]=y)}),n}const Ny=e=>{const t=tl({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:i,headers:l,auth:c}=t;if(t.headers=l=Mo.from(l),t.url=Ay(Oy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),ze.isFormData(n)){if(oo.hasStandardBrowserEnv||oo.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ze.isFunction(n.getHeaders)){const d=n.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{h.includes(f.toLowerCase())&&l.set(f,m)})}}if(oo.hasStandardBrowserEnv&&(s&&ze.isFunction(s)&&(s=s(t)),s||s!==!1&&J_(t.url))){const d=o&&i&&X_.read(i);d&&l.set(o,d)}return t},tC=typeof XMLHttpRequest<"u",nC=tC&&function(e){return new Promise(function(n,s){const o=Ny(e);let i=o.data;const l=Mo.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:h}=o,f,m,y,k,w;function x(){k&&k(),w&&w(),o.cancelToken&&o.cancelToken.unsubscribe(f),o.signal&&o.signal.removeEventListener("abort",f)}let A=new XMLHttpRequest;A.open(o.method.toUpperCase(),o.url,!0),A.timeout=o.timeout;function E(){if(!A)return;const C=Mo.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders()),$={data:!c||c==="text"||c==="json"?A.responseText:A.response,status:A.status,statusText:A.statusText,headers:C,config:e,request:A};Ry(function(T){n(T),x()},function(T){s(T),x()},$),A=null}"onloadend"in A?A.onloadend=E:A.onreadystatechange=function(){!A||A.readyState!==4||A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0)||setTimeout(E)},A.onabort=function(){A&&(s(new It("Request aborted",It.ECONNABORTED,e,A)),A=null)},A.onerror=function(S){const $=S&&S.message?S.message:"Network Error",R=new It($,It.ERR_NETWORK,e,A);R.event=S||null,s(R),A=null},A.ontimeout=function(){let S=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const $=o.transitional||Ey;o.timeoutErrorMessage&&(S=o.timeoutErrorMessage),s(new It(S,$.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,A)),A=null},i===void 0&&l.setContentType(null),"setRequestHeader"in A&&ze.forEach(l.toJSON(),function(S,$){A.setRequestHeader($,S)}),ze.isUndefined(o.withCredentials)||(A.withCredentials=!!o.withCredentials),c&&c!=="json"&&(A.responseType=o.responseType),h&&([y,w]=wu(h,!0),A.addEventListener("progress",y)),d&&A.upload&&([m,k]=wu(d),A.upload.addEventListener("progress",m),A.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(f=C=>{A&&(s(!C||C.type?new cr(null,e,A):C),A.abort(),A=null)},o.cancelToken&&o.cancelToken.subscribe(f),o.signal&&(o.signal.aborted?f():o.signal.addEventListener("abort",f)));const _=Z_(o.url);if(_&&oo.protocols.indexOf(_)===-1){s(new It("Unsupported protocol "+_+":",It.ERR_BAD_REQUEST,e));return}A.send(i||null)})},oC=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const i=function(h){if(!o){o=!0,c();const f=h instanceof Error?h:this.reason;s.abort(f instanceof It?f:new cr(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new It(`timeout ${t} of ms exceeded`,It.ETIMEDOUT))},t);const c=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=s;return d.unsubscribe=()=>ze.asap(c),d}},sC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},aC=async function*(e,t){for await(const n of iC(e))yield*sC(n,t)},iC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},fv=(e,t,n,s)=>{const o=aC(e,t);let i=0,l,c=d=>{l||(l=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await o.next();if(h){c(),d.close();return}let m=f.byteLength;if(n){let y=i+=m;n(y)}d.enqueue(new Uint8Array(f))}catch(h){throw c(h),h}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},pv=64*1024,{isFunction:Bc}=ze,lC=(({Request:e,Response:t})=>({Request:e,Response:t}))(ze.global),{ReadableStream:vv,TextEncoder:mv}=ze.global,gv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},rC=e=>{e=ze.merge.call({skipUndefined:!0},lC,e);const{fetch:t,Request:n,Response:s}=e,o=t?Bc(t):typeof fetch=="function",i=Bc(n),l=Bc(s);if(!o)return!1;const c=o&&Bc(vv),d=o&&(typeof mv=="function"?(w=>x=>w.encode(x))(new mv):async w=>new Uint8Array(await new n(w).arrayBuffer())),h=i&&c&&gv(()=>{let w=!1;const x=new n(oo.origin,{body:new vv,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!x}),f=l&&c&&gv(()=>ze.isReadableStream(new s("").body)),m={stream:f&&(w=>w.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!m[w]&&(m[w]=(x,A)=>{let E=x&&x[w];if(E)return E.call(x);throw new It(`Response type '${w}' is not supported`,It.ERR_NOT_SUPPORT,A)})});const y=async w=>{if(w==null)return 0;if(ze.isBlob(w))return w.size;if(ze.isSpecCompliantForm(w))return(await new n(oo.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(ze.isArrayBufferView(w)||ze.isArrayBuffer(w))return w.byteLength;if(ze.isURLSearchParams(w)&&(w=w+""),ze.isString(w))return(await d(w)).byteLength},k=async(w,x)=>{const A=ze.toFiniteNumber(w.getContentLength());return A??y(x)};return async w=>{let{url:x,method:A,data:E,signal:_,cancelToken:C,timeout:S,onDownloadProgress:$,onUploadProgress:R,responseType:T,headers:O,withCredentials:M="same-origin",fetchOptions:U}=Ny(w),F=t||fetch;T=T?(T+"").toLowerCase():"text";let j=oC([_,C&&C.toAbortSignal()],S),Z=null;const Q=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let re;try{if(R&&h&&A!=="get"&&A!=="head"&&(re=await k(O,E))!==0){let ue=new n(x,{method:"POST",body:E,duplex:"half"}),_e;if(ze.isFormData(E)&&(_e=ue.headers.get("content-type"))&&O.setContentType(_e),ue.body){const[$e,De]=uv(re,wu(dv(R)));E=fv(ue.body,pv,$e,De)}}ze.isString(M)||(M=M?"include":"omit");const K=i&&"credentials"in n.prototype,ae={...U,signal:j,method:A.toUpperCase(),headers:O.normalize().toJSON(),body:E,duplex:"half",credentials:K?M:void 0};Z=i&&new n(x,ae);let q=await(i?F(Z,U):F(x,ae));const Y=f&&(T==="stream"||T==="response");if(f&&($||Y&&Q)){const ue={};["status","statusText","headers"].forEach(Re=>{ue[Re]=q[Re]});const _e=ze.toFiniteNumber(q.headers.get("content-length")),[$e,De]=$&&uv(_e,wu(dv($),!0))||[];q=new s(fv(q.body,pv,$e,()=>{De&&De(),Q&&Q()}),ue)}T=T||"text";let te=await m[ze.findKey(m,T)||"text"](q,w);return!Y&&Q&&Q(),await new Promise((ue,_e)=>{Ry(ue,_e,{data:te,headers:Mo.from(q.headers),status:q.status,statusText:q.statusText,config:w,request:Z})})}catch(K){throw Q&&Q(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new It("Network Error",It.ERR_NETWORK,w,Z),{cause:K.cause||K}):It.from(K,K&&K.code,w,Z)}}},cC=new Map,By=e=>{let t=e&&e.env||{};const{fetch:n,Request:s,Response:o}=t,i=[s,o,n];let l=i.length,c=l,d,h,f=cC;for(;c--;)d=i[c],h=f.get(d),h===void 0&&f.set(d,h=c?new Map:rC(t)),f=h;return h};By();const Pf={http:I_,xhr:nC,fetch:{get:By}};ze.forEach(Pf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const yv=e=>`- ${e}`,uC=e=>ze.isFunction(e)||e===null||e===!1;function dC(e,t){e=ze.isArray(e)?e:[e];const{length:n}=e;let s,o;const i={};for(let l=0;l<n;l++){s=e[l];let c;if(o=s,!uC(s)&&(o=Pf[(c=String(s)).toLowerCase()],o===void 0))throw new It(`Unknown adapter '${c}'`);if(o&&(ze.isFunction(o)||(o=o.get(t))))break;i[c||"#"+l]=o}if(!o){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=n?l.length>1?`since :
`+l.map(yv).join(`
`):" "+yv(l[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const Fy={getAdapter:dC,adapters:Pf};function Nd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new cr(null,e)}function kv(e){return Nd(e),e.headers=Mo.from(e.headers),e.data=Od.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Fy.getAdapter(e.adapter||vc.adapter,e)(e).then(function(s){return Nd(e),s.data=Od.call(e,e.transformResponse,s),s.headers=Mo.from(s.headers),s},function(s){return Dy(s)||(Nd(e),s&&s.response&&(s.response.data=Od.call(e,e.transformResponse,s.response),s.response.headers=Mo.from(s.response.headers))),Promise.reject(s)})}const Uy="1.13.2",sd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sd[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const bv={};sd.transitional=function(t,n,s){function o(i,l){return"[Axios v"+Uy+"] Transitional option '"+i+"'"+l+(s?". "+s:"")}return(i,l,c)=>{if(t===!1)throw new It(o(l," has been removed"+(n?" in "+n:"")),It.ERR_DEPRECATED);return n&&!bv[l]&&(bv[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,c):!0}};sd.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function hC(e,t,n){if(typeof e!="object")throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const i=s[o],l=t[i];if(l){const c=e[i],d=c===void 0||l(c,i,e);if(d!==!0)throw new It("option "+i+" must be "+d,It.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new It("Unknown option "+i,It.ERR_BAD_OPTION)}}const Qc={assertOptions:hC,validators:sd},zs=Qc.validators;let Xi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new rv,response:new rv}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=tl(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:i}=n;s!==void 0&&Qc.assertOptions(s,{silentJSONParsing:zs.transitional(zs.boolean),forcedJSONParsing:zs.transitional(zs.boolean),clarifyTimeoutError:zs.transitional(zs.boolean)},!1),o!=null&&(ze.isFunction(o)?n.paramsSerializer={serialize:o}:Qc.assertOptions(o,{encode:zs.function,serialize:zs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Qc.assertOptions(n,{baseUrl:zs.spelling("baseURL"),withXsrfToken:zs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&ze.merge(i.common,i[n.method]);i&&ze.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),n.headers=Mo.concat(l,i);const c=[];let d=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(d=d&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let f,m=0,y;if(!d){const w=[kv.bind(this),void 0];for(w.unshift(...c),w.push(...h),y=w.length,f=Promise.resolve(n);m<y;)f=f.then(w[m++],w[m++]);return f}y=c.length;let k=n;for(;m<y;){const w=c[m++],x=c[m++];try{k=w(k)}catch(A){x.call(this,A);break}}try{f=kv.call(this,k)}catch(w){return Promise.reject(w)}for(m=0,y=h.length;m<y;)f=f.then(h[m++],h[m++]);return f}getUri(t){t=tl(this.defaults,t);const n=Oy(t.baseURL,t.url,t.allowAbsoluteUrls);return Ay(n,t.params,t.paramsSerializer)}};ze.forEach(["delete","get","head","options"],function(t){Xi.prototype[t]=function(n,s){return this.request(tl(s||{},{method:t,url:n,data:(s||{}).data}))}});ze.forEach(["post","put","patch"],function(t){function n(s){return function(i,l,c){return this.request(tl(c||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Xi.prototype[t]=n(),Xi.prototype[t+"Form"]=n(!0)});let fC=class zy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(o=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](o);s._listeners=null}),this.promise.then=o=>{let i;const l=new Promise(c=>{s.subscribe(c),i=c}).then(o);return l.cancel=function(){s.unsubscribe(i)},l},t(function(i,l,c){s.reason||(s.reason=new cr(i,l,c),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new zy(function(o){t=o}),cancel:t}}};function pC(e){return function(n){return e.apply(null,n)}}function vC(e){return ze.isObject(e)&&e.isAxiosError===!0}const Gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Gh).forEach(([e,t])=>{Gh[t]=e});function Hy(e){const t=new Xi(e),n=ky(Xi.prototype.request,t);return ze.extend(n,Xi.prototype,t,{allOwnKeys:!0}),ze.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Hy(tl(e,o))},n}const wn=Hy(vc);wn.Axios=Xi;wn.CanceledError=cr;wn.CancelToken=fC;wn.isCancel=Dy;wn.VERSION=Uy;wn.toFormData=od;wn.AxiosError=It;wn.Cancel=wn.CanceledError;wn.all=function(t){return Promise.all(t)};wn.spread=pC;wn.isAxiosError=vC;wn.mergeConfig=tl;wn.AxiosHeaders=Mo;wn.formToJSON=e=>Py(ze.isHTMLForm(e)?new FormData(e):e);wn.getAdapter=Fy.getAdapter;wn.HttpStatusCode=Gh;wn.default=wn;const{Axios:cX,AxiosError:uX,CanceledError:dX,isCancel:hX,CancelToken:fX,VERSION:pX,all:vX,Cancel:mX,isAxiosError:gX,spread:yX,toFormData:kX,AxiosHeaders:bX,HttpStatusCode:wX,formToJSON:_X,getAdapter:CX,mergeConfig:LX}=wn,ai="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",mC="VolunteerCheckinOffline",gC=1;let ws=null;async function $a(){return ws||new Promise((e,t)=>{const n=indexedDB.open(mC,gC);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{ws=n.result,e(ws)},n.onupgradeneeded=s=>{const o=s.target.result;o.objectStoreNames.contains("eventData")||o.createObjectStore("eventData",{keyPath:"eventId"}),o.objectStoreNames.contains("pendingActions")||o.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),o.objectStoreNames.contains("syncMeta")||o.createObjectStore("syncMeta",{keyPath:"key"})}})}async function lc(e,t){return await $a(),new Promise((n,s)=>{const o=ws.transaction(["eventData","syncMeta"],"readwrite"),i=o.objectStore("eventData"),l=o.objectStore("syncMeta"),c={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(c),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function di(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}async function eu(e,t,n){const s=await di(e);s&&(s[t]=n,s.cachedAt=new Date().toISOString(),await lc(e,s))}async function yC(e){return await $a(),new Promise((t,n)=>{const o=ws.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=o.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function Vy(){return await $a(),new Promise((e,t)=>{const i=ws.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(c=>c.status==="pending"||c.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function _u(){return(await Vy()).length}async function wv(e,t){return await $a(),new Promise((n,s)=>{const o=ws.transaction(["pendingActions"],"readwrite"),i=o.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const c=l.result;c&&(Object.assign(c,t),i.put(c))},o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function _v(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}async function kC(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>n(i.error)})}const et=wn.create({baseURL:ai,headers:{"Content-Type":"application/json"},timeout:15e3});let qh=!1,Gy={type:null,eventId:null};function No(e,t=null){Gy={type:e,eventId:t}}async function bC(){}function Cv(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const n of t){const s=e.match(n);if(s)return s[1]}return null}function wC(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function qy(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Gy}const _C=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];et.interceptors.request.use(e=>{if(_C.some(i=>e.url?.includes(i)))return e;const n=localStorage.getItem("adminEmail");n&&(e.headers["X-Admin-Email"]=n);const s=qy();let o=null;if(s.type==="marshal"&&s.eventId){const i=bu(s.eventId);i?.token&&(o=i.token)}return o||(o=localStorage.getItem("sessionToken")),o&&(e.headers.Authorization=`Bearer ${o}`),Mw(e),e});let Cu=0;const CC=2;function LC(){if(Cu++,Cu>=CC&&qy().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function SC(){Cu=0}function Bd(){Cu=0}function IC(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),n=e.headers?.Authorization||e.headers?.authorization;if(n&&t&&n.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const o=window.location.hash||"";return!!(o.match(/#\/event\/[^/?]+/)||o==="#/marshal"||o.startsWith("#/marshal?"))}et.interceptors.response.use(e=>{const t=nv(e.config);t&&tv(t),qh=!1,SC();const n=e.config.url,s=Cv(n);return e.config.method,e},async e=>{const t=e.config,n=nv(t);if(n&&tv(n),e.response&&(e.response.status===401||e.response.status===403))return IC(t)||LC(),Promise.reject(e);if(wC(e)&&(qh=!0,t.method==="get")){const s=Cv(t.url);if(s){const o=await di(s);if(o)return console.log("Returning cached data for:",t.url),Promise.resolve({data:o,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Oo(e,t,n){return await yC({type:e,payload:t,eventId:t.eventId}),await bC(),{data:n,status:200,statusText:"OK (queued)",queued:!0}}function Jn(){return qh||!navigator.onLine}const xC={check:()=>et.head("/health")},jh=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),Ws={requestLogin:e=>et.post("/auth/request-login",{email:e,frontendUrl:jh()}),verifyToken:e=>et.post("/auth/verify-token",{token:e}),instantLogin:e=>et.post("/auth/instant-login",{email:e}),createAdmin:e=>et.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>et.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>et.get("/auth/me",{params:{eventId:e}}),logout:()=>et.post("/auth/logout")},Fc={getProfile:()=>et.get("/auth/profile"),updateProfile:e=>et.put("/auth/profile",e),getPerson:(e,t)=>et.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,n)=>et.put(`/people/${e}`,n,{params:{eventId:t}})},ii={create:e=>et.post("/events",e),getAll:()=>et.get("/events"),getById:e=>et.get(`/events/${e}`),update:(e,t)=>et.put(`/events/${e}`,t),delete:e=>et.delete(`/events/${e}`),uploadGpx:(e,t)=>{const n=new FormData;return n.append("gpx",t),et.post(`/events/${e}/upload-gpx`,n,{headers:{"Content-Type":"multipart/form-data"}})}},Xn={create:e=>et.post("/locations",e),getById:(e,t)=>et.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>et.get(`/events/${e}/locations`,t),update:(e,t,n)=>et.put(`/locations/${e}/${t}`,n),delete:(e,t)=>et.delete(`/locations/${e}/${t}`),importCsv:(e,t,n)=>{const s=new FormData;return s.append("csv",t),et.post(`/locations/import/${e}?deleteExisting=${n}`,s,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>et.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,n,s={})=>et.post(`/locations/${e}/${t}/update-position`,n,s),getDynamicCheckpoints:(e,t={})=>et.get(`/events/${e}/dynamic-checkpoints`,t)},$r={create:e=>et.post("/assignments",e),getById:(e,t)=>et.get(`/assignments/${e}/${t}`),getByEvent:e=>et.get(`/assignments/event/${e}`),delete:(e,t)=>et.delete(`/assignments/${e}/${t}`),getEventStatus:e=>et.get(`/events/${e}/status`)},hi={checkIn:e=>et.post("/checkin",e),toggleCheckIn:(e,t,{latitude:n,longitude:s,action:o}={})=>et.post(`/checkin/${e}/${t}/toggle`,{latitude:n??null,longitude:s??null,action:o??null}),adminCheckIn:(e,t)=>et.post(`/checkin/admin/${e}/${t}`)},Fd={getAdmins:e=>et.get(`/events/${e}/admins`),addAdmin:(e,t)=>et.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>et.delete(`/events/${e}/admins/${t}`)},bs={create:e=>et.post("/marshals",e),getByEvent:e=>et.get(`/events/${e}/marshals`),getById:(e,t)=>et.get(`/marshals/${e}/${t}`),update:(e,t,n)=>et.put(`/marshals/${e}/${t}`,n),delete:(e,t)=>et.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>et.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:jh()}}),sendMagicLink:(e,t)=>et.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:jh()}),importCsv:(e,t)=>{const n=new FormData;return n.append("csv",t),et.post(`/marshals/import/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}})}},ga={create:e=>et.post("/areas",e),getByEvent:e=>et.get(`/events/${e}/areas`),getById:(e,t)=>et.get(`/areas/${e}/${t}`),update:(e,t,n)=>et.put(`/areas/${e}/${t}`,n),delete:(e,t)=>et.delete(`/areas/${e}/${t}`),recalculate:e=>et.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>et.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>et.get(`/events/${e}/area-lead-dashboard`)},Ot={create:(e,t)=>et.post(`/events/${e}/checklist-items`,t),getByEvent:e=>et.get(`/events/${e}/checklist-items`),getById:(e,t)=>et.get(`/checklist-items/${e}/${t}`),update:(e,t,n)=>et.put(`/checklist-items/${e}/${t}`,n),delete:(e,t)=>et.delete(`/checklist-items/${e}/${t}`),getReport:e=>et.get(`/events/${e}/checklist-report`),getDetailedReport:e=>et.get(`/events/${e}/checklist-report/detailed`),getMarshalChecklist:(e,t)=>et.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>et.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>et.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/complete`,n),uncomplete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/uncomplete`,n),reorder:(e,t)=>et.post(`/events/${e}/checklist-items/reorder`,{items:t})},ys={create:(e,t)=>et.post(`/events/${e}/notes`,t),getByEvent:e=>et.get(`/events/${e}/notes`),getById:(e,t)=>et.get(`/events/${e}/notes/${t}`),update:(e,t,n)=>et.put(`/events/${e}/notes/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>et.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>et.get(`/events/${e}/my-notes`),reorder:(e,t)=>et.post(`/events/${e}/notes/reorder`,{items:t})},da={create:(e,t)=>et.post(`/events/${e}/contacts`,t),getByEvent:e=>et.get(`/events/${e}/contacts`),getById:(e,t)=>et.get(`/events/${e}/contacts/${t}`),update:(e,t,n)=>et.put(`/events/${e}/contacts/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/contacts/${t}`),getRoles:e=>et.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>et.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>et.get(`/events/${e}/my-contacts`),reorder:(e,t)=>et.post(`/events/${e}/contacts/reorder`,{items:t})},Qa={getAll:e=>et.get(`/events/${e}/role-definitions`),create:(e,t)=>et.post(`/events/${e}/role-definitions`,t),update:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/role-definitions/${t}`),getPeople:(e,t)=>et.get(`/events/${e}/role-definitions/${t}/people`),updatePeople:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}/people`,n),reorder:(e,t)=>et.post(`/events/${e}/role-definitions/reorder`,{items:t}),getMyRoles:e=>et.get(`/events/${e}/my-roles`)},js={create:(e,t)=>et.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>et.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>et.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>et.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,n)=>et.patch(`/events/${e}/incidents/${t}`,n),addNote:(e,t,n)=>et.post(`/events/${e}/incidents/${t}/notes`,{note:n})},$C={class:"hero-animation-container"},TC={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,n=D(!1);return cn(()=>{t.animate?requestAnimationFrame(()=>{n.value=!0}):n.value=!0}),(s,o)=>(p(),g("div",$C,[(p(),g("svg",{viewBox:"0 0 400 350",class:le(["hero-map-svg",{animate:n.value&&e.animate,"no-animate":n.value&&!e.animate}])},[...o[0]||(o[0]=[pi(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},MC=Ke(TC,[["__scopeId","data-v-cec8ae43"]]),AC={class:"hero-header"},EC={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=D(!1);return cn(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(n,s)=>(p(),g("div",AC,[Pe(MC,{animate:t.value},null,8,["animate"]),e.title?(p(),g("div",{key:0,class:le(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,b(e.title),1)],2)):P("",!0)]))}},jy=Ke(EC,[["__scopeId","data-v-c824ab01"]]),mc=Sf("auth",()=>{const e=D(localStorage.getItem("adminEmail")||null),t=D(!!e.value),n=D(!1);return{adminEmail:e,isAuthenticated:t,loginPending:n,requestLogin:async c=>{const d=await Ws.requestLogin(c);return d.data.success&&(n.value=!0),d.data},verifyToken:async c=>{const d=await Ws.verifyToken(c);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,n.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),No("admin")),d.data},instantLogin:async c=>{const d=await Ws.instantLogin(c);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),No("admin")),d.data},logout:async()=>{try{await Ws.logout()}catch{}e.value=null,t.value=!1,n.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),No(null)}}}),PC={class:"modal-card"},DC={key:0,class:"email-sent"},RC={key:1},OC={class:"form-group"},NC=["disabled"],BC={key:0,class:"error"},FC={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const n=e,s=t,o=mc(),i=D(""),l=D(!1),c=D(null),d=D(!1);async function h(){l.value=!0,c.value=null;try{const y=await o.requestLogin(i.value);y.success?(d.value=!0,s("success",i.value)):c.value=y.message||"Failed to send login link. Please try again."}catch{c.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,c.value=null}function m(){s("close")}return Ye(()=>n.show,y=>{y||setTimeout(()=>{f()},200)}),(y,k)=>(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",style:tt({zIndex:e.zIndex}),onClick:rt(m,["self"])},[r("div",PC,[r("button",{class:"modal-close",onClick:m},""),d.value?(p(),g("div",DC,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(p(),g("div",RC,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(h,["prevent"])},[r("div",OC,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=w=>i.value=w),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},b(l.value?"Sending...":"Send login link"),9,NC)],32),c.value?(p(),g("div",BC,b(c.value),1)):P("",!0)]))])],4)):P("",!0)]),_:1})]))}},Wy=Ke(FC,[["__scopeId","data-v-7c646305"]]),UC={class:"home"},zC={class:"hero-section"},HC={class:"content-section"},VC={class:"container"},GC={class:"carousel"},qC={class:"carousel-indicators"},jC=["onClick"],WC={__name:"Home",setup(e){const t=Qu(),n=ir();function s(){const y=!!localStorage.getItem("adminEmail"),k=gy();return y||k}function o(){s()?n.push("/sessions"):f.value=!0}const i=D(0);let l=null;function c(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=D(!1);function m(){f.value=!1,t.query.login&&n.replace({query:{}})}return cn(()=>{h(),t.query.login&&(s()?n.replace("/sessions"):f.value=!0)}),In(()=>{l&&clearInterval(l)}),(y,k)=>(p(),g("div",UC,[r("section",zC,[Pe(jy,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:o}," Join us or login ")]),r("section",HC,[r("div",VC,[k[2]||(k[2]=pi('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",GC,[r("div",{class:"carousel-track",style:tt({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[pi('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",qC,[(p(),g(Se,null,je(2,(w,x)=>r("button",{key:x,class:le(["indicator",{active:i.value===x}]),onClick:A=>c(x)},null,10,jC)),64))])])])]),Pe(Wy,{show:f.value,onClose:m},null,8,["show"])]))}},ZC=Ke(WC,[["__scopeId","data-v-aaecbd22"]]),KC={class:"admin-login"},YC={class:"login-card"},JC={key:0,class:"email-sent"},XC={class:"form-group"},QC=["disabled"],e2={key:0,class:"error"},t2={__name:"AdminLogin",setup(e){const t=mc(),n=D(""),s=D(!1),o=D(null),i=D(!1),l=async()=>{s.value=!0,o.value=null;try{const d=await t.requestLogin(n.value);d.success?i.value=!0:o.value=d.message||"Failed to send login link. Please try again."}catch{o.value="Failed to send login link. Please try again."}finally{s.value=!1}},c=()=>{n.value="",i.value=!1,o.value=null};return(d,h)=>{const f=yf("router-link");return p(),g("div",KC,[r("div",YC,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(p(),g("div",JC,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(n.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:c,class:"btn btn-secondary"}," Use a different email ")])):(p(),g(Se,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",XC,[We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=m=>n.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,n.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:s.value},b(s.value?"Sending...":"Send login link"),9,QC)],32),o.value?(p(),g("div",e2,b(o.value),1)):P("",!0)],64)),Pe(f,{to:"/",class:"back-link"},{default:Ve(()=>[...h[6]||(h[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},n2=Ke(t2,[["__scopeId","data-v-5d0a88c2"]]),o2={class:"admin-verify"},s2={class:"verify-card"},a2={key:0,class:"status"},i2={key:1,class:"status error"},l2={key:2,class:"status success"},r2={__name:"AdminVerify",setup(e){const t=ir(),n=Qu(),s=mc(),o=D(!0),i=D(null);return cn(async()=>{const l=n.query.token;if(!l){i.value="No login token provided. Please request a new login link.",o.value=!1;return}try{const c=await s.verifyToken(l);c.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=c.message||"Invalid or expired login link. Please request a new one."}catch(c){console.error("Verification error:",c),i.value="Failed to verify login. Please try again."}finally{o.value=!1}}),(l,c)=>{const d=yf("router-link");return p(),g("div",o2,[r("div",s2,[o.value?(p(),g("div",a2,[...c[0]||(c[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(p(),g("div",i2,[c[2]||(c[2]=r("h2",null,"Login failed",-1)),r("p",null,b(i.value),1),Pe(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ve(()=>[...c[1]||(c[1]=[Je(" Try again ",-1)])]),_:1})])):(p(),g("div",l2,[...c[3]||(c[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},c2=Ke(r2,[["__scopeId","data-v-b2435a84"]]),Zy=Sf("events",()=>{const e=D([]),t=D(null),n=D([]),s=D([]),o=D(null),i=D(!1),l=D(null),c=async()=>{i.value=!0,l.value=null;try{const R=await ii.getAll();e.value=R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},d=async R=>{i.value=!0,l.value=null;try{const T=await ii.getById(R);t.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},h=async R=>{i.value=!0,l.value=null;try{const T=await ii.create(R);return e.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},f=async(R,T)=>{i.value=!0,l.value=null;try{const O=await ii.update(R,T),M=e.value.findIndex(U=>U.id===R);return M!==-1&&(e.value[M]=O.data),t.value?.id===R&&(t.value=O.data),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},m=async R=>{i.value=!0,l.value=null;try{await ii.delete(R),e.value=e.value.filter(T=>T.id!==R)}catch(T){throw l.value=T.message,T}finally{i.value=!1}},y=async R=>{i.value=!0,l.value=null;try{const T=await Xn.getByEvent(R);n.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}};return{events:e,currentEvent:t,locations:n,assignments:s,eventStatus:o,loading:i,error:l,fetchEvents:c,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async R=>{i.value=!0,l.value=null;try{const T=await Xn.create(R);return n.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},updateLocation:async(R,T,O)=>{i.value=!0,l.value=null;try{const M=await Xn.update(R,T,O),U=n.value.findIndex(F=>F.id===T);return U!==-1&&(n.value[U]=M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},deleteLocation:async(R,T)=>{i.value=!0,l.value=null;try{await Xn.delete(R,T),n.value=n.value.filter(O=>O.id!==T)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},bulkUpdateLocationTimes:async(R,T)=>{i.value=!0,l.value=null;try{const O=await Xn.bulkUpdateTimes(R,T);return await y(R),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchAssignments:async R=>{i.value=!0,l.value=null;try{const T=await $r.getByEvent(R);s.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},createAssignment:async R=>{i.value=!0,l.value=null;try{const T=await $r.create(R);return s.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},deleteAssignment:async(R,T)=>{i.value=!0,l.value=null;try{await $r.delete(R,T),s.value=s.value.filter(O=>O.id!==T)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchEventStatus:async R=>{i.value=!0,l.value=null;try{const T=await $r.getEventStatus(R);return o.value=T.data,T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},updateAssignmentCheckIn:R=>{const T=s.value.findIndex(O=>O.id===R.id);T!==-1&&(s.value[T]=R),o.value&&o.value.locations.forEach(O=>{const M=O.assignments.findIndex(U=>U.id===R.id);M!==-1&&(O.assignments[M]=R,O.checkedInCount=O.assignments.filter(U=>U.isCheckedIn).length)})}}});function Ky(e="details",t=[]){const n=D(e),s=m=>{n.value=m},o=()=>{n.value=e},i=m=>n.value===m,l=H(()=>t.length===0?-1:t.indexOf(n.value)),c=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?n.value=t[k]:m&&(n.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?n.value=t[k]:m&&(n.value=t[t.length-1])},h=H(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=H(()=>t.length===0?!1:l.value>0);return{activeTab:n,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:s,resetTab:o,isActiveTab:i,nextTab:c,previousTab:d}}function u2(){const e=D(!1),t=D(""),n=D(""),s=D(null),o=D(!1),i=D("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:n,confirmModalIsDanger:o,confirmModalConfirmText:i,showConfirm:(f,m,y,k={})=>{t.value=f,n.value=m,s.value=y,o.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,s.value&&(s.value(),s.value=null)},handleConfirmModalCancel:()=>{e.value=!1,s.value=null},closeConfirmModal:()=>{e.value=!1,s.value=null}}}const Hl=D({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),ka={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},ya={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function ji(e,t,n="Marshals"){if(!t)return"";const s=ka[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${ka.people[n]?.singular||"Person"} point`:s?.singular?s.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Yy(e,t,n="Marshals"){if(!t)return"";const s=ka[e]?.[t];return t==="Person points"?`${ka.people[n]?.singular||"Person"} points`:s?.plural?s.plural:t}function Wh(e,t){return e==="Person points"?`${ka.people[t]?.singular||"Person"} points`:e}function Zh(e){e&&(Hl.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const vs=e=>e.toLowerCase(),ms=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function dt(){const e=f=>{const m=Hl.value[f],y=ka[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Hl.value.people;return`${ka.people[k]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=Hl.value[f],y=ka[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Hl.value.people;return`${ka.people[k]?.singular||"Person"} points`}return y?.plural||m},n=H(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),s=H(()=>({person:vs(e("people")),checkpoint:vs(e("checkpoint")),area:vs(e("area")),checklist:vs(e("checklist")),course:vs(e("course")),people:vs(t("people")),checkpoints:vs(t("checkpoint")),areas:vs(t("area")),checklists:vs(t("checklist")),courses:vs(t("course"))})),o=H(()=>({person:ms(e("people")),checkpoint:ms(e("checkpoint")),area:ms(e("area")),checklist:ms(e("checklist")),course:ms(e("course")),people:ms(t("people")),checkpoints:ms(t("checkpoint")),areas:ms(t("area")),checklists:ms(t("checklist")),courses:ms(t("course"))})),i=H(()=>({course:n.value.course,checkpoints:n.value.checkpoints,areas:n.value.areas,marshals:n.value.people,checklists:n.value.checklists,notes:"Notes",details:"Event details"}));return{terms:n,termsLower:s,termsSentence:o,tabLabels:i,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>vs(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>ms(m?t(f):e(f)),terminology:Hl}}function d2(){const e=D(!1),t=D(null),n=D({}),s=D(null),o=D(null),i=D([]),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(1),m=H(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value!==null:t.value==="draw-area"?o.value&&o.value.length>=3:t.value==="add-multiple"),y=Z=>{if(Z){const Q=Z.getMapCenter?.(),re=Z.getMapZoom?.();Q&&re!==null&&(l.value=Q,c.value=re)}},k=(Z={})=>{s.value=null,e.value=!0,t.value="place-checkpoint",n.value={title:Z.title||"Select checkpoint location",description:Z.description||"Click on the map to set the location. Click again to reposition."}},w=(Z,Q="checkpoint")=>{s.value=null,e.value=!0,t.value="move-checkpoint",n.value={title:`Move ${Q}: ${Z}`,description:"Click on the map to set the new location"}},x=(Z={})=>{e.value=!0,t.value="draw-area",d.value=!0,n.value={title:Z.title||"Draw area boundary",description:Z.description||"Click to add points. Click Done when finished to complete the area."}},A=(Z=1)=>{f.value=Z,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,n.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=Z=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value=Z:t.value==="add-multiple"&&_(Z)},_=Z=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Z.lat,longitude:Z.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,n.value={...n.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},C=Z=>{o.value=Z},S=()=>o.value&&o.value.length>=3?o.value.map(Z=>({lat:Z.lat,lng:Z.lng})):null,$=()=>{e.value=!1,t.value=null,n.value={},s.value=null,l.value=null,c.value=null,o.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:n,tempLocationCoords:s,currentDrawingPolygon:o,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:c,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:w,enterDrawAreaMode:x,enterAddMultipleMode:A,handleFullscreenMapClick:E,handlePolygonDrawing:C,getCompletedPolygon:S,exitFullscreen:$,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,o.value=null),$()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>s.value,createDisplayCheckpoints:(Z,Q,re)=>H(()=>{const K=[...Z.value];return t.value==="place-checkpoint"&&s.value&&K.push({id:"temp-single",name:Q.value?.name||"New Checkpoint",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:Q.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&s.value&&re.value&&K.push({id:"temp-move",name:re.value.name+" (new position)",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:re.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&K.push(...i.value),K}),createDisplayAreas:(Z,Q)=>H(()=>{const re=[...Z.value];if(t.value==="draw-area"&&Q.value?.polygon?.length>0){const K=re.findIndex(ae=>ae.id===Q.value.id);K>=0?re[K]={...Q.value}:re.push({...Q.value,id:Q.value.id||"temp-area"})}return re}),calculateStartingNumber:Z=>{const Q=Z.value.map(re=>{const K=re.name.match(/^Checkpoint (\d+)$/);return K?parseInt(K[1]):0}).filter(re=>re>0);return Q.length>0?Math.max(...Q)+1:1}}}function h2(e){const t=D([]),n=D(!1);return{eventAdmins:t,showAddAdmin:n,loadEventAdmins:async()=>{try{const d=await Fd.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{n.value=!0},closeAddAdminModal:()=>{n.value=!1},addAdmin:async d=>{await Fd.addAdmin(e.value,d)},removeAdmin:async d=>{await Fd.removeAdmin(e.value,d)}}}function f2(e){const t=D(!1),n=D(!1),s=D(!1),o=D(!1),i=D(!1),l=D(!1),c=D(null),d=D(null),h=D(null),f=D(null);return{showUploadRoute:t,showImportLocations:n,showImportMarshals:s,uploading:o,importing:i,importingMarshals:l,uploadError:c,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{c.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,c.value=null},uploadRoute:async $=>{if(!$)return c.value="Please select a GPX file",null;o.value=!0,c.value=null;try{return await ii.uploadGpx(e.value,$),!0}catch(R){return console.error("Failed to upload route:",R),c.value=R.response?.data?.message||"Failed to upload route. Please try again.",null}finally{o.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,n.value=!0},closeImportLocationsModal:()=>{n.value=!1,d.value=null,h.value=null},importLocations:async($,R)=>{if(!$)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const T=await Xn.importCsv(e.value,$,R);return h.value=T.data,T.data}catch(T){return console.error("Failed to import locations:",T),d.value=T.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,s.value=!0},closeImportMarshalsModal:()=>{s.value=!1,d.value=null,f.value=null},importMarshals:async $=>{if(!$)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const R=await bs.importCsv(e.value,$);return f.value=R.data,R.data}catch(R){return console.error("Failed to import marshals:",R),d.value=R.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:($,R="location")=>{const T=R==="location"?"location(s)":"marshal(s)";let M=`<p>Created <strong>${$[R==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${T} and <strong>${$.assignmentsCreated}</strong> assignment(s)</p>`;return $.errors&&$.errors.length>0&&(M+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',$.errors.forEach(U=>{M+=`<li>${U}</li>`}),M+="</ul>"),M}}}const Jy="admin-theme-preference",Fi=D(p2());function p2(){return typeof window>"u"?"system":localStorage.getItem(Jy)||"system"}function v2(e){localStorage.setItem(Jy,e)}function Xy(){const e=H(()=>Fi.value==="system"?"light dark":Fi.value),t=(o,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Fi.value=o,v2(o)},n=()=>{const o=["system","light","dark"],l=(o.indexOf(Fi.value)+1)%o.length;t(o[l])},s=H(()=>Fi.value==="dark"?!0:Fi.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Fi,colorScheme:e,isDark:s,setTheme:t,cycleTheme:n}}const Qy=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",rc=e=>{if(!e)return"";const t=new Date(e),n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${n}-${s}-${o}T${i}:${l}`},Lu=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const n=e.includes("."),s=e.includes("/");return n!==s},sl=(e,t,n,s)=>{const i=e*Math.PI/180,l=n*Math.PI/180,c=(n-e)*Math.PI/180,d=(s-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},m2=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ud(e,{areas:t=[],locations:n=[],marshals:s=[]}){if(!e||e.length===0)return e;const o=new Set(t.map(h=>h.id)),i=new Set(n.map(h=>h.id)),l=new Set(s.map(h=>h.id)),c=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,m=h.ids||[];if(!f||m.length===0)return h;const y=m.filter(k=>c.has(k)?!0:f==="Area"?o.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:y}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function e1({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:n=[],areaLeadAreaIds:s=[],locationId:o,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const c=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(c){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(n.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(o))&&n.includes(o)||d.some(f=>n.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(n.length>0)return!0}else if(d.some(f=>i.includes(f))&&n.includes(o))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(s.length>0)return!0}else if(d.some(f=>s.includes(f)))return!0;break}}return!1}function t1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tr={exports:{}};var g2=Tr.exports,Lv;function y2(){return Lv||(Lv=1,(function(e,t){(function(n,s){s(t)})(g2,(function(n){var s="1.9.4";function o(a){var u,v,I,N;for(v=1,I=arguments.length;v<I;v++){N=arguments[v];for(u in N)a[u]=N[u]}return a}var i=Object.create||(function(){function a(){}return function(u){return a.prototype=u,new a}})();function l(a,u){var v=Array.prototype.slice;if(a.bind)return a.bind.apply(a,v.call(arguments,1));var I=v.call(arguments,2);return function(){return a.apply(u,I.length?I.concat(v.call(arguments)):arguments)}}var c=0;function d(a){return"_leaflet_id"in a||(a._leaflet_id=++c),a._leaflet_id}function h(a,u,v){var I,N,W,he;return he=function(){I=!1,N&&(W.apply(v,N),N=!1)},W=function(){I?N=arguments:(a.apply(v,arguments),setTimeout(he,u),I=!0)},W}function f(a,u,v){var I=u[1],N=u[0],W=I-N;return a===I&&v?a:((a-N)%W+W)%W+N}function m(){return!1}function y(a,u){if(u===!1)return a;var v=Math.pow(10,u===void 0?6:u);return Math.round(a*v)/v}function k(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function w(a){return k(a).split(/\s+/)}function x(a,u){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?i(a.options):{});for(var v in u)a.options[v]=u[v];return a.options}function A(a,u,v){var I=[];for(var N in a)I.push(encodeURIComponent(v?N.toUpperCase():N)+"="+encodeURIComponent(a[N]));return(!u||u.indexOf("?")===-1?"?":"&")+I.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function _(a,u){return a.replace(E,function(v,I){var N=u[I];if(N===void 0)throw new Error("No value provided for variable "+v);return typeof N=="function"&&(N=N(u)),N})}var C=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function S(a,u){for(var v=0;v<a.length;v++)if(a[v]===u)return v;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var T=0;function O(a){var u=+new Date,v=Math.max(0,16-(u-T));return T=u+v,window.setTimeout(a,v)}var M=window.requestAnimationFrame||R("RequestAnimationFrame")||O,U=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,u,v){if(v&&M===O)a.call(u);else return M.call(window,l(a,u))}function j(a){a&&U.call(window,a)}var Z={__proto__:null,extend:o,create:i,bind:l,get lastId(){return c},stamp:d,throttle:h,wrapNum:f,falseFn:m,formatNum:y,trim:k,splitWords:w,setOptions:x,getParamString:A,template:_,isArray:C,indexOf:S,emptyImageUrl:$,requestFn:M,cancelFn:U,requestAnimFrame:F,cancelAnimFrame:j};function Q(){}Q.extend=function(a){var u=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=u.__super__=this.prototype,I=i(v);I.constructor=u,u.prototype=I;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(u[N]=this[N]);return a.statics&&o(u,a.statics),a.includes&&(re(a.includes),o.apply(null,[I].concat(a.includes))),o(I,a),delete I.statics,delete I.includes,I.options&&(I.options=v.options?i(v.options):{},o(I.options,a.options)),I._initHooks=[],I.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,he=I._initHooks.length;W<he;W++)I._initHooks[W].call(this)}},u},Q.include=function(a){var u=this.prototype.options;return o(this.prototype,a),a.options&&(this.prototype.options=u,this.mergeOptions(a.options)),this},Q.mergeOptions=function(a){return o(this.prototype.options,a),this},Q.addInitHook=function(a){var u=Array.prototype.slice.call(arguments,1),v=typeof a=="function"?a:function(){this[a].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function re(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=C(a)?a:[a];for(var u=0;u<a.length;u++)a[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(a,u,v){if(typeof a=="object")for(var I in a)this._on(I,a[I],u);else{a=w(a);for(var N=0,W=a.length;N<W;N++)this._on(a[N],u,v)}return this},off:function(a,u,v){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var I in a)this._off(I,a[I],u);else{a=w(a);for(var N=arguments.length===1,W=0,he=a.length;W<he;W++)N?this._off(a[W]):this._off(a[W],u,v)}return this},_on:function(a,u,v,I){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(a,u,v)===!1){v===this&&(v=void 0);var N={fn:u,ctx:v};I&&(N.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(N)}},_off:function(a,u,v){var I,N,W;if(this._events&&(I=this._events[a],!!I)){if(arguments.length===1){if(this._firingCount)for(N=0,W=I.length;N<W;N++)I[N].fn=m;delete this._events[a];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var he=this._listens(a,u,v);if(he!==!1){var Me=I[he];this._firingCount&&(Me.fn=m,this._events[a]=I=I.slice()),I.splice(he,1)}}},fire:function(a,u,v){if(!this.listens(a,v))return this;var I=o({},u,{type:a,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var N=this._events[a];if(N){this._firingCount=this._firingCount+1||1;for(var W=0,he=N.length;W<he;W++){var Me=N[W],Ue=Me.fn;Me.once&&this.off(a,Ue,Me.ctx),Ue.call(Me.ctx||this,I)}this._firingCount--}}return v&&this._propagateEvent(I),this},listens:function(a,u,v,I){typeof a!="string"&&console.warn('"string" type argument expected');var N=u;typeof u!="function"&&(I=!!u,N=void 0,v=void 0);var W=this._events&&this._events[a];if(W&&W.length&&this._listens(a,N,v)!==!1)return!0;if(I){for(var he in this._eventParents)if(this._eventParents[he].listens(a,u,v,I))return!0}return!1},_listens:function(a,u,v){if(!this._events)return!1;var I=this._events[a]||[];if(!u)return!!I.length;v===this&&(v=void 0);for(var N=0,W=I.length;N<W;N++)if(I[N].fn===u&&I[N].ctx===v)return N;return!1},once:function(a,u,v){if(typeof a=="object")for(var I in a)this._on(I,a[I],u,!0);else{a=w(a);for(var N=0,W=a.length;N<W;N++)this._on(a[N],u,v,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d(a)],this},_propagateEvent:function(a){for(var u in this._eventParents)this._eventParents[u].fire(a.type,o({layer:a.target,propagatedFrom:a.target},a),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var ae=Q.extend(K);function q(a,u,v){this.x=v?Math.round(a):a,this.y=v?Math.round(u):u}var Y=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(a){return this.clone()._add(te(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(te(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new q(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new q(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Y(this.x),this.y=Y(this.y),this},distanceTo:function(a){a=te(a);var u=a.x-this.x,v=a.y-this.y;return Math.sqrt(u*u+v*v)},equals:function(a){return a=te(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=te(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function te(a,u,v){return a instanceof q?a:C(a)?new q(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new q(a.x,a.y):new q(a,u,v)}function ue(a,u){if(a)for(var v=u?[a,u]:a,I=0,N=v.length;I<N;I++)this.extend(v[I])}ue.prototype={extend:function(a){var u,v;if(!a)return this;if(a instanceof q||typeof a[0]=="number"||"x"in a)u=v=te(a);else if(a=_e(a),u=a.min,v=a.max,!u||!v)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=v.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(a){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var u,v;return typeof a[0]=="number"||a instanceof q?a=te(a):a=_e(a),a instanceof ue?(u=a.min,v=a.max):u=v=a,u.x>=this.min.x&&v.x<=this.max.x&&u.y>=this.min.y&&v.y<=this.max.y},intersects:function(a){a=_e(a);var u=this.min,v=this.max,I=a.min,N=a.max,W=N.x>=u.x&&I.x<=v.x,he=N.y>=u.y&&I.y<=v.y;return W&&he},overlaps:function(a){a=_e(a);var u=this.min,v=this.max,I=a.min,N=a.max,W=N.x>u.x&&I.x<v.x,he=N.y>u.y&&I.y<v.y;return W&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var u=this.min,v=this.max,I=Math.abs(u.x-v.x)*a,N=Math.abs(u.y-v.y)*a;return _e(te(u.x-I,u.y-N),te(v.x+I,v.y+N))},equals:function(a){return a?(a=_e(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function _e(a,u){return!a||a instanceof ue?a:new ue(a,u)}function $e(a,u){if(a)for(var v=u?[a,u]:a,I=0,N=v.length;I<N;I++)this.extend(v[I])}$e.prototype={extend:function(a){var u=this._southWest,v=this._northEast,I,N;if(a instanceof Re)I=a,N=a;else if(a instanceof $e){if(I=a._southWest,N=a._northEast,!I||!N)return this}else return a?this.extend(be(a)||De(a)):this;return!u&&!v?(this._southWest=new Re(I.lat,I.lng),this._northEast=new Re(N.lat,N.lng)):(u.lat=Math.min(I.lat,u.lat),u.lng=Math.min(I.lng,u.lng),v.lat=Math.max(N.lat,v.lat),v.lng=Math.max(N.lng,v.lng)),this},pad:function(a){var u=this._southWest,v=this._northEast,I=Math.abs(u.lat-v.lat)*a,N=Math.abs(u.lng-v.lng)*a;return new $e(new Re(u.lat-I,u.lng-N),new Re(v.lat+I,v.lng+N))},getCenter:function(){return new Re((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Re(this.getNorth(),this.getWest())},getSouthEast:function(){return new Re(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof Re||"lat"in a?a=be(a):a=De(a);var u=this._southWest,v=this._northEast,I,N;return a instanceof $e?(I=a.getSouthWest(),N=a.getNorthEast()):I=N=a,I.lat>=u.lat&&N.lat<=v.lat&&I.lng>=u.lng&&N.lng<=v.lng},intersects:function(a){a=De(a);var u=this._southWest,v=this._northEast,I=a.getSouthWest(),N=a.getNorthEast(),W=N.lat>=u.lat&&I.lat<=v.lat,he=N.lng>=u.lng&&I.lng<=v.lng;return W&&he},overlaps:function(a){a=De(a);var u=this._southWest,v=this._northEast,I=a.getSouthWest(),N=a.getNorthEast(),W=N.lat>u.lat&&I.lat<v.lat,he=N.lng>u.lng&&I.lng<v.lng;return W&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,u){return a?(a=De(a),this._southWest.equals(a.getSouthWest(),u)&&this._northEast.equals(a.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function De(a,u){return a instanceof $e?a:new $e(a,u)}function Re(a,u,v){if(isNaN(a)||isNaN(u))throw new Error("Invalid LatLng object: ("+a+", "+u+")");this.lat=+a,this.lng=+u,v!==void 0&&(this.alt=+v)}Re.prototype={equals:function(a,u){if(!a)return!1;a=be(a);var v=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return v<=(u===void 0?1e-9:u)},toString:function(a){return"LatLng("+y(this.lat,a)+", "+y(this.lng,a)+")"},distanceTo:function(a){return J.distance(this,be(a))},wrap:function(){return J.wrapLatLng(this)},toBounds:function(a){var u=180*a/40075017,v=u/Math.cos(Math.PI/180*this.lat);return De([this.lat-u,this.lng-v],[this.lat+u,this.lng+v])},clone:function(){return new Re(this.lat,this.lng,this.alt)}};function be(a,u,v){return a instanceof Re?a:C(a)&&typeof a[0]!="object"?a.length===3?new Re(a[0],a[1],a[2]):a.length===2?new Re(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new Re(a.lat,"lng"in a?a.lng:a.lon,a.alt):u===void 0?null:new Re(a,u,v)}var z={latLngToPoint:function(a,u){var v=this.projection.project(a),I=this.scale(u);return this.transformation._transform(v,I)},pointToLatLng:function(a,u){var v=this.scale(u),I=this.transformation.untransform(a,v);return this.projection.unproject(I)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var u=this.projection.bounds,v=this.scale(a),I=this.transformation.transform(u.min,v),N=this.transformation.transform(u.max,v);return new ue(I,N)},infinite:!1,wrapLatLng:function(a){var u=this.wrapLng?f(a.lng,this.wrapLng,!0):a.lng,v=this.wrapLat?f(a.lat,this.wrapLat,!0):a.lat,I=a.alt;return new Re(v,u,I)},wrapLatLngBounds:function(a){var u=a.getCenter(),v=this.wrapLatLng(u),I=u.lat-v.lat,N=u.lng-v.lng;if(I===0&&N===0)return a;var W=a.getSouthWest(),he=a.getNorthEast(),Me=new Re(W.lat-I,W.lng-N),Ue=new Re(he.lat-I,he.lng-N);return new $e(Me,Ue)}},J=o({},z,{wrapLng:[-180,180],R:6371e3,distance:function(a,u){var v=Math.PI/180,I=a.lat*v,N=u.lat*v,W=Math.sin((u.lat-a.lat)*v/2),he=Math.sin((u.lng-a.lng)*v/2),Me=W*W+Math.cos(I)*Math.cos(N)*he*he,Ue=2*Math.atan2(Math.sqrt(Me),Math.sqrt(1-Me));return this.R*Ue}}),de=6378137,ie={R:de,MAX_LATITUDE:85.0511287798,project:function(a){var u=Math.PI/180,v=this.MAX_LATITUDE,I=Math.max(Math.min(v,a.lat),-v),N=Math.sin(I*u);return new q(this.R*a.lng*u,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(a){var u=180/Math.PI;return new Re((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*u,a.x*u/this.R)},bounds:(function(){var a=de*Math.PI;return new ue([-a,-a],[a,a])})()};function Ae(a,u,v,I){if(C(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=u,this._c=v,this._d=I}Ae.prototype={transform:function(a,u){return this._transform(a.clone(),u)},_transform:function(a,u){return u=u||1,a.x=u*(this._a*a.x+this._b),a.y=u*(this._c*a.y+this._d),a},untransform:function(a,u){return u=u||1,new q((a.x/u-this._b)/this._a,(a.y/u-this._d)/this._c)}};function G(a,u,v,I){return new Ae(a,u,v,I)}var X=o({},J,{code:"EPSG:3857",projection:ie,transformation:(function(){var a=.5/(Math.PI*ie.R);return G(a,.5,-a,.5)})()}),ee=o({},X,{code:"EPSG:900913"});function Ce(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function Be(a,u){var v="",I,N,W,he,Me,Ue;for(I=0,W=a.length;I<W;I++){for(Me=a[I],N=0,he=Me.length;N<he;N++)Ue=Me[N],v+=(N?"L":"M")+Ue.x+" "+Ue.y;v+=u?Qe.svg?"z":"x":""}return v||"M0 0"}var Fe=document.documentElement.style,Ee="ActiveXObject"in window,oe=Ee&&!document.addEventListener,ge="msLaunchUri"in navigator&&!("documentMode"in document),Ne=lt("webkit"),Oe=lt("android"),xe=lt("android 2")||lt("android 3"),me=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=Oe&&lt("Google")&&me<537&&!("AudioNode"in window),qe=!!window.opera,fe=!ge&&lt("chrome"),ke=lt("gecko")&&!Ne&&!qe&&!Ee,ne=!fe&&lt("safari"),ye=lt("phantom"),He="OTransition"in Fe,ct=navigator.platform.indexOf("Win")===0,ht=Ee&&"transition"in Fe,Nt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,Lt="MozPerspective"in Fe,Bt=!window.L_DISABLE_3D&&(ht||Nt||Lt)&&!He&&!ye,Et=typeof orientation<"u"||lt("mobile"),yo=Et&&Ne,ko=Et&&Nt,ft=!window.PointerEvent&&window.MSPointerEvent,Pt=!!(window.PointerEvent||ft),vt="ontouchstart"in window||!!window.TouchEvent,An=!window.L_NO_TOUCH&&(vt||Pt),Ao=Et&&qe,ao=Et&&ke,bo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Gt=(function(){var a=!1;try{var u=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",m,u),window.removeEventListener("testPassiveEventSupport",m,u)}catch{}return a})(),As=(function(){return!!document.createElement("canvas").getContext})(),wo=!!(document.createElementNS&&Ce("svg").createSVGRect),zo=!!wo&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),pe=!wo&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var u=a.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),ve=navigator.platform.indexOf("Mac")===0,Ie=navigator.platform.indexOf("Linux")===0;function lt(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var Qe={ie:Ee,ielt9:oe,edge:ge,webkit:Ne,android:Oe,android23:xe,androidStock:Ze,opera:qe,chrome:fe,gecko:ke,safari:ne,phantom:ye,opera12:He,win:ct,ie3d:ht,webkit3d:Nt,gecko3d:Lt,any3d:Bt,mobile:Et,mobileWebkit:yo,mobileWebkit3d:ko,msPointer:ft,pointer:Pt,touch:An,touchNative:vt,mobileOpera:Ao,mobileGecko:ao,retina:bo,passiveEvents:Gt,canvas:As,svg:wo,vml:pe,inlineSvg:zo,mac:ve,linux:Ie},Ft=Qe.msPointer?"MSPointerDown":"pointerdown",an=Qe.msPointer?"MSPointerMove":"pointermove",yn=Qe.msPointer?"MSPointerUp":"pointerup",_n=Qe.msPointer?"MSPointerCancel":"pointercancel",_o={touchstart:Ft,touchmove:an,touchend:yn,touchcancel:_n},Ho={touchstart:Vn,touchmove:Es,touchend:Es,touchcancel:Es},Vo={},Ma=!1;function dl(a,u,v){return u==="touchstart"&&Aa(),Ho[u]?(v=Ho[u].bind(this,v),a.addEventListener(_o[u],v,!1),v):(console.warn("wrong event specified:",u),m)}function hl(a,u,v){if(!_o[u]){console.warn("wrong event specified:",u);return}a.removeEventListener(_o[u],v,!1)}function ki(a){Vo[a.pointerId]=a}function Go(a){Vo[a.pointerId]&&(Vo[a.pointerId]=a)}function qo(a){delete Vo[a.pointerId]}function Aa(){Ma||(document.addEventListener(Ft,ki,!0),document.addEventListener(an,Go,!0),document.addEventListener(yn,qo,!0),document.addEventListener(_n,qo,!0),Ma=!0)}function Es(a,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var v in Vo)u.touches.push(Vo[v]);u.changedTouches=[u],a(u)}}function Vn(a,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&qt(u),Es(a,u)}function bi(a){var u={},v,I;for(I in a)v=a[I],u[I]=v&&v.bind?v.bind(a):v;return a=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var Gn=200;function jo(a,u){a.addEventListener("dblclick",u);var v=0,I;function N(W){if(W.detail!==1){I=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var he=fl(W);if(!(he.some(function(Ue){return Ue instanceof HTMLLabelElement&&Ue.attributes.for})&&!he.some(function(Ue){return Ue instanceof HTMLInputElement||Ue instanceof HTMLSelectElement}))){var Me=Date.now();Me-v<=Gn?(I++,I===2&&u(bi(W))):I=1,v=Me}}}return a.addEventListener("click",N),{dblclick:u,simDblclick:N}}function os(a,u){a.removeEventListener("dblclick",u.dblclick),a.removeEventListener("click",u.simDblclick)}var Ys=Eo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),io=Eo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Js=io==="webkitTransition"||io==="OTransition"?io+"End":"transitionend";function qn(a){return typeof a=="string"?document.getElementById(a):a}function Wo(a,u){var v=a.style[u]||a.currentStyle&&a.currentStyle[u];if((!v||v==="auto")&&document.defaultView){var I=document.defaultView.getComputedStyle(a,null);v=I?I[u]:null}return v==="auto"?null:v}function bt(a,u,v){var I=document.createElement(a);return I.className=u||"",v&&v.appendChild(I),I}function Dt(a){var u=a.parentNode;u&&u.removeChild(a)}function jn(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function On(a){var u=a.parentNode;u&&u.lastChild!==a&&u.appendChild(a)}function Nn(a){var u=a.parentNode;u&&u.firstChild!==a&&u.insertBefore(a,u.firstChild)}function ss(a,u){if(a.classList!==void 0)return a.classList.contains(u);var v=Lo(a);return v.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(v)}function pt(a,u){if(a.classList!==void 0)for(var v=w(u),I=0,N=v.length;I<N;I++)a.classList.add(v[I]);else if(!ss(a,u)){var W=Lo(a);Co(a,(W?W+" ":"")+u)}}function Vt(a,u){a.classList!==void 0?a.classList.remove(u):Co(a,k((" "+Lo(a)+" ").replace(" "+u+" "," ")))}function Co(a,u){a.className.baseVal===void 0?a.className=u:a.className.baseVal=u}function Lo(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Cn(a,u){"opacity"in a.style?a.style.opacity=u:"filter"in a.style&&Xs(a,u)}function Xs(a,u){var v=!1,I="DXImageTransform.Microsoft.Alpha";try{v=a.filters.item(I)}catch{if(u===1)return}u=Math.round(u*100),v?(v.Enabled=u!==100,v.Opacity=u):a.style.filter+=" progid:"+I+"(opacity="+u+")"}function Eo(a){for(var u=document.documentElement.style,v=0;v<a.length;v++)if(a[v]in u)return a[v];return!1}function So(a,u,v){var I=u||new q(0,0);a.style[Ys]=(Qe.ie3d?"translate("+I.x+"px,"+I.y+"px)":"translate3d("+I.x+"px,"+I.y+"px,0)")+(v?" scale("+v+")":"")}function en(a,u){a._leaflet_pos=u,Qe.any3d?So(a,u):(a.style.left=u.x+"px",a.style.top=u.y+"px")}function Wn(a){return a._leaflet_pos||new q(0,0)}var lo,Ps,Ea;if("onselectstart"in document)lo=function(){wt(window,"selectstart",qt)},Ps=function(){Ut(window,"selectstart",qt)};else{var Qs=Eo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);lo=function(){if(Qs){var a=document.documentElement.style;Ea=a[Qs],a[Qs]="none"}},Ps=function(){Qs&&(document.documentElement.style[Qs]=Ea,Ea=void 0)}}function wi(){wt(window,"dragstart",qt)}function Pa(){Ut(window,"dragstart",qt)}var Da,Ds;function Ra(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Rs(),Da=a,Ds=a.style.outlineStyle,a.style.outlineStyle="none",wt(window,"keydown",Rs))}function Rs(){Da&&(Da.style.outlineStyle=Ds,Da=void 0,Ds=void 0,Ut(window,"keydown",Rs))}function _i(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function Ci(a){var u=a.getBoundingClientRect();return{x:u.width/a.offsetWidth||1,y:u.height/a.offsetHeight||1,boundingClientRect:u}}var ur={__proto__:null,TRANSFORM:Ys,TRANSITION:io,TRANSITION_END:Js,get:qn,getStyle:Wo,create:bt,remove:Dt,empty:jn,toFront:On,toBack:Nn,hasClass:ss,addClass:pt,removeClass:Vt,setClass:Co,getClass:Lo,setOpacity:Cn,testProp:Eo,setTransform:So,setPosition:en,getPosition:Wn,get disableTextSelection(){return lo},get enableTextSelection(){return Ps},disableImageDrag:wi,enableImageDrag:Pa,preventOutline:Ra,restoreOutline:Rs,getSizedParentNode:_i,getScale:Ci};function wt(a,u,v,I){if(u&&typeof u=="object")for(var N in u)Li(a,N,u[N],v);else{u=w(u);for(var W=0,he=u.length;W<he;W++)Li(a,u[W],v,I)}return this}var Rt="_leaflet_events";function Ut(a,u,v,I){if(arguments.length===1)Oa(a),delete a[Rt];else if(u&&typeof u=="object")for(var N in u)ea(a,N,u[N],v);else if(u=w(u),arguments.length===2)Oa(a,function(Me){return S(u,Me)!==-1});else for(var W=0,he=u.length;W<he;W++)ea(a,u[W],v,I);return this}function Oa(a,u){for(var v in a[Rt]){var I=v.split(/\d/)[0];(!u||u(I))&&ea(a,I,null,null,v)}}var ro={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Li(a,u,v,I){var N=u+d(v)+(I?"_"+d(I):"");if(a[Rt]&&a[Rt][N])return this;var W=function(Me){return v.call(I||a,Me||window.event)},he=W;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?W=dl(a,u,W):Qe.touch&&u==="dblclick"?W=jo(a,W):"addEventListener"in a?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?a.addEventListener(ro[u]||u,W,Qe.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(W=function(Me){Me=Me||window.event,Na(a,Me)&&he(Me)},a.addEventListener(ro[u],W,!1)):a.addEventListener(u,he,!1):a.attachEvent("on"+u,W),a[Rt]=a[Rt]||{},a[Rt][N]=W}function ea(a,u,v,I,N){N=N||u+d(v)+(I?"_"+d(I):"");var W=a[Rt]&&a[Rt][N];if(!W)return this;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?hl(a,u,W):Qe.touch&&u==="dblclick"?os(a,W):"removeEventListener"in a?a.removeEventListener(ro[u]||u,W,!1):a.detachEvent("on"+u,W),a[Rt][N]=null}function as(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Zn(a){return Li(a,"wheel",as),this}function kn(a){return wt(a,"mousedown touchstart dblclick contextmenu",as),a._leaflet_disable_click=!0,this}function qt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function co(a){return qt(a),as(a),this}function fl(a){if(a.composedPath)return a.composedPath();for(var u=[],v=a.target;v;)u.push(v),v=v.parentNode;return u}function xn(a,u){if(!u)return new q(a.clientX,a.clientY);var v=Ci(u),I=v.boundingClientRect;return new q((a.clientX-I.left)/v.x-u.clientLeft,(a.clientY-I.top)/v.y-u.clientTop)}var ta=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Os(a){return Qe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/ta:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function Na(a,u){var v=u.relatedTarget;if(!v)return!0;try{for(;v&&v!==a;)v=v.parentNode}catch{return!1}return v!==a}var pl={__proto__:null,on:wt,off:Ut,stopPropagation:as,disableScrollPropagation:Zn,disableClickPropagation:kn,preventDefault:qt,stop:co,getPropagationPath:fl,getMousePosition:xn,getWheelDelta:Os,isExternalTarget:Na,addListener:wt,removeListener:Ut},Si=ae.extend({run:function(a,u,v,I){this.stop(),this._el=a,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(I||.5,.2),this._startPos=Wn(a),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var u=+new Date-this._startTime,v=this._duration*1e3;u<v?this._runFrame(this._easeOut(u/v),a):(this._runFrame(1),this._complete())},_runFrame:function(a,u){var v=this._startPos.add(this._offset.multiplyBy(a));u&&v._round(),en(this._el,v),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),$t=ae.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,u){u=x(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(be(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=io&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),wt(this._proxy,Js,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,u,v){if(u=u===void 0?this._zoom:this._limitZoom(u),a=this._limitCenter(be(a),u,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=o({animate:v.animate},v.zoom),v.pan=o({animate:v.animate,duration:v.duration},v.pan));var I=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,u,v.zoom):this._tryAnimatedPan(a,v.pan);if(I)return clearTimeout(this._sizeTimer),this}return this._resetView(a,u,v.pan&&v.pan.noMoveStart),this},setZoom:function(a,u){return this._loaded?this.setView(this.getCenter(),a,{zoom:u}):(this._zoom=a,this)},zoomIn:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,u)},zoomOut:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,u)},setZoomAround:function(a,u,v){var I=this.getZoomScale(u),N=this.getSize().divideBy(2),W=a instanceof q?a:this.latLngToContainerPoint(a),he=W.subtract(N).multiplyBy(1-1/I),Me=this.containerPointToLatLng(N.add(he));return this.setView(Me,u,{zoom:v})},_getBoundsCenterZoom:function(a,u){u=u||{},a=a.getBounds?a.getBounds():De(a);var v=te(u.paddingTopLeft||u.padding||[0,0]),I=te(u.paddingBottomRight||u.padding||[0,0]),N=this.getBoundsZoom(a,!1,v.add(I));if(N=typeof u.maxZoom=="number"?Math.min(u.maxZoom,N):N,N===1/0)return{center:a.getCenter(),zoom:N};var W=I.subtract(v).divideBy(2),he=this.project(a.getSouthWest(),N),Me=this.project(a.getNorthEast(),N),Ue=this.unproject(he.add(Me).divideBy(2).add(W),N);return{center:Ue,zoom:N}},fitBounds:function(a,u){if(a=De(a),!a.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(a,u);return this.setView(v.center,v.zoom,u)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,u){return this.setView(a,this._zoom,{pan:u})},panBy:function(a,u){if(a=te(a).round(),u=u||{},!a.x&&!a.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Si,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){pt(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,v,u.duration||.25,u.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,u,v){if(v=v||{},v.animate===!1||!Qe.any3d)return this.setView(a,u,v);this._stop();var I=this.project(this.getCenter()),N=this.project(a),W=this.getSize(),he=this._zoom;a=be(a),u=u===void 0?he:u;var Me=Math.max(W.x,W.y),Ue=Me*this.getZoomScale(he,u),Xe=N.distanceTo(I)||1,it=1.42,mt=it*it;function Tt(Ln){var Ec=Ln?-1:1,R1=Ln?Ue:Me,O1=Ue*Ue-Me*Me+Ec*mt*mt*Xe*Xe,N1=2*R1*mt*Xe,yd=O1/N1,Wf=Math.sqrt(yd*yd+1)-yd,B1=Wf<1e-9?-18:Math.log(Wf);return B1}function uo(Ln){return(Math.exp(Ln)-Math.exp(-Ln))/2}function Dn(Ln){return(Math.exp(Ln)+Math.exp(-Ln))/2}function Ko(Ln){return uo(Ln)/Dn(Ln)}var Io=Tt(0);function Dl(Ln){return Me*(Dn(Io)/Dn(Io+it*Ln))}function A1(Ln){return Me*(Dn(Io)*Ko(Io+it*Ln)-uo(Io))/mt}function E1(Ln){return 1-Math.pow(1-Ln,1.5)}var P1=Date.now(),qf=(Tt(1)-Io)/it,D1=v.duration?1e3*v.duration:1e3*qf*.8;function jf(){var Ln=(Date.now()-P1)/D1,Ec=E1(Ln)*qf;Ln<=1?(this._flyToFrame=F(jf,this),this._move(this.unproject(I.add(N.subtract(I).multiplyBy(A1(Ec)/Xe)),he),this.getScaleZoom(Me/Dl(Ec),he),{flyTo:!0})):this._move(a,u)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),jf.call(this),this},flyToBounds:function(a,u){var v=this._getBoundsCenterZoom(a,u);return this.flyTo(v.center,v.zoom,u)},setMaxBounds:function(a){return a=De(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var u=this.options.minZoom;return this.options.minZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var u=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,u){this._enforcingBounds=!0;var v=this.getCenter(),I=this._limitCenter(v,this._zoom,De(a));return v.equals(I)||this.panTo(I,u),this._enforcingBounds=!1,this},panInside:function(a,u){u=u||{};var v=te(u.paddingTopLeft||u.padding||[0,0]),I=te(u.paddingBottomRight||u.padding||[0,0]),N=this.project(this.getCenter()),W=this.project(a),he=this.getPixelBounds(),Me=_e([he.min.add(v),he.max.subtract(I)]),Ue=Me.getSize();if(!Me.contains(W)){this._enforcingBounds=!0;var Xe=W.subtract(Me.getCenter()),it=Me.extend(W).getSize().subtract(Ue);N.x+=Xe.x<0?-it.x:it.x,N.y+=Xe.y<0?-it.y:it.y,this.panTo(this.unproject(N),u),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=o({animate:!1,pan:!0},a===!0?{animate:!0}:a);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),I=u.divideBy(2).round(),N=v.divideBy(2).round(),W=I.subtract(N);return!W.x&&!W.y?this:(a.animate&&a.pan?this.panBy(W):(a.pan&&this._rawPanBy(W),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=o({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,v,a):navigator.geolocation.getCurrentPosition(u,v,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var u=a.code,v=a.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var u=a.coords.latitude,v=a.coords.longitude,I=new Re(u,v),N=I.toBounds(a.coords.accuracy*2),W=this._locateOptions;if(W.setView){var he=this.getBoundsZoom(N);this.setView(I,W.maxZoom?Math.min(he,W.maxZoom):he)}var Me={latlng:I,bounds:N,timestamp:a.timestamp};for(var Ue in a.coords)typeof a.coords[Ue]=="number"&&(Me[Ue]=a.coords[Ue]);this.fire("locationfound",Me)}},addHandler:function(a,u){if(!u)return this;var v=this[a]=new u(this);return this._handlers.push(v),this.options[a]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Dt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Dt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,u){var v="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),I=bt("div",v,u||this._mapPane);return a&&(this._panes[a]=I),I},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),u=this.unproject(a.getBottomLeft()),v=this.unproject(a.getTopRight());return new $e(u,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,u,v){a=De(a),v=te(v||[0,0]);var I=this.getZoom()||0,N=this.getMinZoom(),W=this.getMaxZoom(),he=a.getNorthWest(),Me=a.getSouthEast(),Ue=this.getSize().subtract(v),Xe=_e(this.project(Me,I),this.project(he,I)).getSize(),it=Qe.any3d?this.options.zoomSnap:1,mt=Ue.x/Xe.x,Tt=Ue.y/Xe.y,uo=u?Math.max(mt,Tt):Math.min(mt,Tt);return I=this.getScaleZoom(uo,I),it&&(I=Math.round(I/(it/100))*(it/100),I=u?Math.ceil(I/it)*it:Math.floor(I/it)*it),Math.max(N,Math.min(W,I))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,u){var v=this._getTopLeftPoint(a,u);return new ue(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,u){var v=this.options.crs;return u=u===void 0?this._zoom:u,v.scale(a)/v.scale(u)},getScaleZoom:function(a,u){var v=this.options.crs;u=u===void 0?this._zoom:u;var I=v.zoom(a*v.scale(u));return isNaN(I)?1/0:I},project:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(be(a),u)},unproject:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(te(a),u)},layerPointToLatLng:function(a){var u=te(a).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(a){var u=this.project(be(a))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(be(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(De(a))},distance:function(a,u){return this.options.crs.distance(be(a),be(u))},containerPointToLayerPoint:function(a){return te(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return te(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var u=this.containerPointToLayerPoint(te(a));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(be(a)))},mouseEventToContainerPoint:function(a){return xn(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var u=this._container=qn(a);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");wt(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,pt(a,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=Wo(a,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),en(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(a.markerPane,"leaflet-zoom-hide"),pt(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,u,v){en(this._mapPane,new q(0,0));var I=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var N=this._zoom!==u;this._moveStart(N,v)._move(a,u)._moveEnd(N),this.fire("viewreset"),I&&this.fire("load")},_moveStart:function(a,u){return a&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(a,u,v,I){u===void 0&&(u=this._zoom);var N=this._zoom!==u;return this._zoom=u,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),I?v&&v.pinch&&this.fire("zoom",v):((N||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){en(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[d(this._container)]=this;var u=a?Ut:wt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,u){for(var v=[],I,N=u==="mouseout"||u==="mouseover",W=a.target||a.srcElement,he=!1;W;){if(I=this._targets[d(W)],I&&(u==="click"||u==="preclick")&&this._draggableMoved(I)){he=!0;break}if(I&&I.listens(u,!0)&&(N&&!Na(W,a)||(v.push(I),N))||W===this._container)break;W=W.parentNode}return!v.length&&!he&&!N&&this.listens(u,!0)&&(v=[this]),v},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var u=a.target||a.srcElement;if(!(!this._loaded||u._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(u))){var v=a.type;v==="mousedown"&&Ra(u),this._fireDOMEvent(a,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,u,v){if(a.type==="click"){var I=o({},a);I.type="preclick",this._fireDOMEvent(I,I.type,v)}var N=this._findEventTargets(a,u);if(v){for(var W=[],he=0;he<v.length;he++)v[he].listens(u,!0)&&W.push(v[he]);N=W.concat(N)}if(N.length){u==="contextmenu"&&qt(a);var Me=N[0],Ue={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var Xe=Me.getLatLng&&(!Me._radius||Me._radius<=10);Ue.containerPoint=Xe?this.latLngToContainerPoint(Me.getLatLng()):this.mouseEventToContainerPoint(a),Ue.layerPoint=this.containerPointToLayerPoint(Ue.containerPoint),Ue.latlng=Xe?Me.getLatLng():this.layerPointToLatLng(Ue.layerPoint)}for(he=0;he<N.length;he++)if(N[he].fire(u,Ue,!0),Ue.originalEvent._stopped||N[he].options.bubblingMouseEvents===!1&&S(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,u=this._handlers.length;a<u;a++)this._handlers[a].disable()},whenReady:function(a,u){return this._loaded?a.call(u||this,{target:this}):this.on("load",a,u),this},_getMapPanePos:function(){return Wn(this._mapPane)||new q(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,u){var v=a&&u!==void 0?this._getNewPixelOrigin(a,u):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,u){var v=this.getSize()._divideBy(2);return this.project(a,u)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,u,v){var I=this._getNewPixelOrigin(v,u);return this.project(a,u)._subtract(I)},_latLngBoundsToNewLayerBounds:function(a,u,v){var I=this._getNewPixelOrigin(v,u);return _e([this.project(a.getSouthWest(),u)._subtract(I),this.project(a.getNorthWest(),u)._subtract(I),this.project(a.getSouthEast(),u)._subtract(I),this.project(a.getNorthEast(),u)._subtract(I)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,u,v){if(!v)return a;var I=this.project(a,u),N=this.getSize().divideBy(2),W=new ue(I.subtract(N),I.add(N)),he=this._getBoundsOffset(W,v,u);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?a:this.unproject(I.add(he),u)},_limitOffset:function(a,u){if(!u)return a;var v=this.getPixelBounds(),I=new ue(v.min.add(a),v.max.add(a));return a.add(this._getBoundsOffset(I,u))},_getBoundsOffset:function(a,u,v){var I=_e(this.project(u.getNorthEast(),v),this.project(u.getSouthWest(),v)),N=I.min.subtract(a.min),W=I.max.subtract(a.max),he=this._rebound(N.x,-W.x),Me=this._rebound(N.y,-W.y);return new q(he,Me)},_rebound:function(a,u){return a+u>0?Math.round(a-u)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(u))},_limitZoom:function(a){var u=this.getMinZoom(),v=this.getMaxZoom(),I=Qe.any3d?this.options.zoomSnap:1;return I&&(a=Math.round(a/I)*I),Math.max(u,Math.min(v,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,u){var v=this._getCenterOffset(a)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,u),!0)},_createAnimProxy:function(){var a=this._proxy=bt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(u){var v=Ys,I=this._proxy.style[v];So(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),I===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Dt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),u=this.getZoom();So(this._proxy,this.project(a,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,u,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var I=this.getZoomScale(u),N=this._getCenterOffset(a)._divideBy(1-1/I);return v.animate!==!0&&!this.getSize().contains(N)?!1:(F(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(a,u,!0)},this),!0)},_animateZoom:function(a,u,v,I){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=u,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:u,noUpdate:I}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function vl(a,u){return new $t(a,u)}var En=Q.extend({options:{position:"topright"},initialize:function(a){x(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var u=this._map;return u&&u.removeControl(this),this.options.position=a,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var u=this._container=this.onAdd(a),v=this.getPosition(),I=a._controlCorners[v];return pt(u,"leaflet-control"),v.indexOf("bottom")!==-1?I.insertBefore(u,I.firstChild):I.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Dt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),is=function(a){return new En(a)};$t.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},u="leaflet-",v=this._controlContainer=bt("div",u+"control-container",this._container);function I(N,W){var he=u+N+" "+u+W;a[N+W]=bt("div",he,v)}I("top","left"),I("top","right"),I("bottom","left"),I("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Dt(this._controlCorners[a]);Dt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ml=En.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,u,v,I){return v<I?-1:I<v?1:0}},initialize:function(a,u,v){x(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var I in a)this._addLayer(a[I],I);for(I in u)this._addLayer(u[I],I,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return En.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,u){return this._addLayer(a,u),this._map?this._update():this},addOverlay:function(a,u){return this._addLayer(a,u,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(a));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(pt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",u=this._container=bt("div",a),v=this.options.collapsed;u.setAttribute("aria-haspopup",!0),kn(u),Zn(u);var I=this._section=bt("section",a+"-list");v&&(this._map.on("click",this.collapse,this),wt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=bt("a",a+"-toggle",u);N.href="#",N.title="Layers",N.setAttribute("role","button"),wt(N,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){qt(W),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=bt("div",a+"-base",I),this._separator=bt("div",a+"-separator",I),this._overlaysList=bt("div",a+"-overlays",I),u.appendChild(I)},_getLayer:function(a){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===a)return this._layers[u]},_addLayer:function(a,u,v){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:u,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(I,N){return this.options.sortFunction(I.layer,N.layer,I.name,N.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;jn(this._baseLayersList),jn(this._overlaysList),this._layerControlInputs=[];var a,u,v,I,N=0;for(v=0;v<this._layers.length;v++)I=this._layers[v],this._addItem(I),u=u||I.overlay,a=a||!I.overlay,N+=I.overlay?0:1;return this.options.hideSingleBase&&(a=a&&N>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=u&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var u=this._getLayer(d(a.target)),v=u.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;v&&this._map.fire(v,u)},_createRadioElement:function(a,u){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(u?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=v,I.firstChild},_addItem:function(a){var u=document.createElement("label"),v=this._map.hasLayer(a.layer),I;a.overlay?(I=document.createElement("input"),I.type="checkbox",I.className="leaflet-control-layers-selector",I.defaultChecked=v):I=this._createRadioElement("leaflet-base-layers_"+d(this),v),this._layerControlInputs.push(I),I.layerId=d(a.layer),wt(I,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+a.name;var W=document.createElement("span");u.appendChild(W),W.appendChild(I),W.appendChild(N);var he=a.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,u,v,I=[],N=[];this._handlingClick=!0;for(var W=a.length-1;W>=0;W--)u=a[W],v=this._getLayer(u.layerId).layer,u.checked?I.push(v):u.checked||N.push(v);for(W=0;W<N.length;W++)this._map.hasLayer(N[W])&&this._map.removeLayer(N[W]);for(W=0;W<I.length;W++)this._map.hasLayer(I[W])||this._map.addLayer(I[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,u,v,I=this._map.getZoom(),N=a.length-1;N>=0;N--)u=a[N],v=this._getLayer(u.layerId).layer,u.disabled=v.options.minZoom!==void 0&&I<v.options.minZoom||v.options.maxZoom!==void 0&&I>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,wt(a,"click",qt),this.expand();var u=this;setTimeout(function(){Ut(a,"click",qt),u._preventClick=!1})}}),Ii=function(a,u,v){return new ml(a,u,v)},ls=En.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var u="leaflet-control-zoom",v=bt("div",u+" leaflet-bar"),I=this.options;return this._zoomInButton=this._createButton(I.zoomInText,I.zoomInTitle,u+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(I.zoomOutText,I.zoomOutTitle,u+"-out",v,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,u,v,I,N){var W=bt("a",v,I);return W.innerHTML=a,W.href="#",W.title=u,W.setAttribute("role","button"),W.setAttribute("aria-label",u),kn(W),wt(W,"click",co),wt(W,"click",N,this),wt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var a=this._map,u="leaflet-disabled";Vt(this._zoomInButton,u),Vt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(pt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(pt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});$t.mergeOptions({zoomControl:!0}),$t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ls,this.addControl(this.zoomControl))});var xi=function(a){return new ls(a)},gl=En.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var u="leaflet-control-scale",v=bt("div",u),I=this.options;return this._addScales(I,u+"-line",v),a.on(I.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),v},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,u,v){a.metric&&(this._mScale=bt("div",u,v)),a.imperial&&(this._iScale=bt("div",u,v))},_update:function(){var a=this._map,u=a.getSize().y/2,v=a.distance(a.containerPointToLatLng([0,u]),a.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(v)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var u=this._getRoundNum(a),v=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,v,u/a)},_updateImperial:function(a){var u=a*3.2808399,v,I,N;u>5280?(v=u/5280,I=this._getRoundNum(v),this._updateScale(this._iScale,I+" mi",I/v)):(N=this._getRoundNum(u),this._updateScale(this._iScale,N+" ft",N/u))},_updateScale:function(a,u,v){a.style.width=Math.round(this.options.maxWidth*v)+"px",a.innerHTML=u},_getRoundNum:function(a){var u=Math.pow(10,(Math.floor(a)+"").length-1),v=a/u;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,u*v}}),dr=function(a){return new gl(a)},na='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',oa=En.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?na+" ":"")+"Leaflet</a>"},initialize:function(a){x(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=bt("div","leaflet-control-attribution"),kn(this._container);for(var u in a._layers)a._layers[u].getAttribution&&this.addAttribution(a._layers[u].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var u in this._attributions)this._attributions[u]&&a.push(u);var v=[];this.options.prefix&&v.push(this.options.prefix),a.length&&v.push(a.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});$t.mergeOptions({attributionControl:!0}),$t.addInitHook(function(){this.options.attributionControl&&new oa().addTo(this)});var Ns=function(a){return new oa(a)};En.Layers=ml,En.Zoom=ls,En.Scale=gl,En.Attribution=oa,is.layers=Ii,is.zoom=xi,is.scale=dr,is.attribution=Ns;var Pn=Q.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Pn.addTo=function(a,u){return a.addHandler(u,this),this};var $i={Events:K},Ti=Qe.touch?"touchstart mousedown":"mousedown",Po=ae.extend({options:{clickTolerance:3},initialize:function(a,u,v,I){x(this,I),this._element=a,this._dragStartTarget=u||a,this._preventOutline=v},enable:function(){this._enabled||(wt(this._dragStartTarget,Ti,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Po._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,Ti,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!ss(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Po._dragging===this&&this.finishDrag();return}if(!(Po._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Po._dragging=this,this._preventOutline&&Ra(this._element),wi(),lo(),!this._moving)){this.fire("down");var u=a.touches?a.touches[0]:a,v=_i(this._element);this._startPoint=new q(u.clientX,u.clientY),this._startPos=Wn(this._element),this._parentScale=Ci(v);var I=a.type==="mousedown";wt(document,I?"mousemove":"touchmove",this._onMove,this),wt(document,I?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var u=a.touches&&a.touches.length===1?a.touches[0]:a,v=new q(u.clientX,u.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,qt(a),this._moved||(this.fire("dragstart"),this._moved=!0,pt(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),en(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Vt(document.body,"leaflet-dragging"),this._lastTarget&&(Vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),Pa(),Ps();var u=this._moved&&this._moving;this._moving=!1,Po._dragging=!1,u&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function yl(a,u,v){var I,N=[1,4,2,8],W,he,Me,Ue,Xe,it,mt,Tt;for(W=0,it=a.length;W<it;W++)a[W]._code=rs(a[W],u);for(Me=0;Me<4;Me++){for(mt=N[Me],I=[],W=0,it=a.length,he=it-1;W<it;he=W++)Ue=a[W],Xe=a[he],Ue._code&mt?Xe._code&mt||(Tt=Ha(Xe,Ue,mt,u,v),Tt._code=rs(Tt,u),I.push(Tt)):(Xe._code&mt&&(Tt=Ha(Xe,Ue,mt,u,v),Tt._code=rs(Tt,u),I.push(Tt)),I.push(Ue));a=I}return a}function kl(a,u){var v,I,N,W,he,Me,Ue,Xe,it;if(!a||a.length===0)throw new Error("latlngs not passed");Bn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var mt=be([0,0]),Tt=De(a),uo=Tt.getNorthWest().distanceTo(Tt.getSouthWest())*Tt.getNorthEast().distanceTo(Tt.getNorthWest());uo<1700&&(mt=Bs(a));var Dn=a.length,Ko=[];for(v=0;v<Dn;v++){var Io=be(a[v]);Ko.push(u.project(be([Io.lat-mt.lat,Io.lng-mt.lng])))}for(Me=Ue=Xe=0,v=0,I=Dn-1;v<Dn;I=v++)N=Ko[v],W=Ko[I],he=N.y*W.x-W.y*N.x,Ue+=(N.x+W.x)*he,Xe+=(N.y+W.y)*he,Me+=he*3;Me===0?it=Ko[0]:it=[Ue/Me,Xe/Me];var Dl=u.unproject(te(it));return be([Dl.lat+mt.lat,Dl.lng+mt.lng])}function Bs(a){for(var u=0,v=0,I=0,N=0;N<a.length;N++){var W=be(a[N]);u+=W.lat,v+=W.lng,I++}return be([u/I,v/I])}var Ba={__proto__:null,clipPolygon:yl,polygonCenter:kl,centroid:Bs};function Fa(a,u){if(!u||!a.length)return a.slice();var v=u*u;return a=fr(a,v),a=wl(a,v),a}function bl(a,u,v){return Math.sqrt(aa(a,u,v,!0))}function hr(a,u,v){return aa(a,u,v)}function wl(a,u){var v=a.length,I=typeof Uint8Array<"u"?Uint8Array:Array,N=new I(v);N[0]=N[v-1]=1,Ua(a,N,u,0,v-1);var W,he=[];for(W=0;W<v;W++)N[W]&&he.push(a[W]);return he}function Ua(a,u,v,I,N){var W=0,he,Me,Ue;for(Me=I+1;Me<=N-1;Me++)Ue=aa(a[Me],a[I],a[N],!0),Ue>W&&(he=Me,W=Ue);W>v&&(u[he]=1,Ua(a,u,v,I,he),Ua(a,u,v,he,N))}function fr(a,u){for(var v=[a[0]],I=1,N=0,W=a.length;I<W;I++)pr(a[I],a[N])>u&&(v.push(a[I]),N=I);return N<W-1&&v.push(a[W-1]),v}var za;function sa(a,u,v,I,N){var W=I?za:rs(a,v),he=rs(u,v),Me,Ue,Xe;for(za=he;;){if(!(W|he))return[a,u];if(W&he)return!1;Me=W||he,Ue=Ha(a,u,Me,v,N),Xe=rs(Ue,v),Me===W?(a=Ue,W=Xe):(u=Ue,he=Xe)}}function Ha(a,u,v,I,N){var W=u.x-a.x,he=u.y-a.y,Me=I.min,Ue=I.max,Xe,it;return v&8?(Xe=a.x+W*(Ue.y-a.y)/he,it=Ue.y):v&4?(Xe=a.x+W*(Me.y-a.y)/he,it=Me.y):v&2?(Xe=Ue.x,it=a.y+he*(Ue.x-a.x)/W):v&1&&(Xe=Me.x,it=a.y+he*(Me.x-a.x)/W),new q(Xe,it,N)}function rs(a,u){var v=0;return a.x<u.min.x?v|=1:a.x>u.max.x&&(v|=2),a.y<u.min.y?v|=4:a.y>u.max.y&&(v|=8),v}function pr(a,u){var v=u.x-a.x,I=u.y-a.y;return v*v+I*I}function aa(a,u,v,I){var N=u.x,W=u.y,he=v.x-N,Me=v.y-W,Ue=he*he+Me*Me,Xe;return Ue>0&&(Xe=((a.x-N)*he+(a.y-W)*Me)/Ue,Xe>1?(N=v.x,W=v.y):Xe>0&&(N+=he*Xe,W+=Me*Xe)),he=a.x-N,Me=a.y-W,I?he*he+Me*Me:new q(N,W)}function Bn(a){return!C(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function ia(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Bn(a)}function Va(a,u){var v,I,N,W,he,Me,Ue,Xe;if(!a||a.length===0)throw new Error("latlngs not passed");Bn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var it=be([0,0]),mt=De(a),Tt=mt.getNorthWest().distanceTo(mt.getSouthWest())*mt.getNorthEast().distanceTo(mt.getNorthWest());Tt<1700&&(it=Bs(a));var uo=a.length,Dn=[];for(v=0;v<uo;v++){var Ko=be(a[v]);Dn.push(u.project(be([Ko.lat-it.lat,Ko.lng-it.lng])))}for(v=0,I=0;v<uo-1;v++)I+=Dn[v].distanceTo(Dn[v+1])/2;if(I===0)Xe=Dn[0];else for(v=0,W=0;v<uo-1;v++)if(he=Dn[v],Me=Dn[v+1],N=he.distanceTo(Me),W+=N,W>I){Ue=(W-I)/N,Xe=[Me.x-Ue*(Me.x-he.x),Me.y-Ue*(Me.y-he.y)];break}var Io=u.unproject(te(Xe));return be([Io.lat+it.lat,Io.lng+it.lng])}var cs={__proto__:null,simplify:Fa,pointToSegmentDistance:bl,closestPointOnSegment:hr,clipSegment:sa,_getEdgeIntersection:Ha,_getBitCode:rs,_sqClosestPointOnSegment:aa,isFlat:Bn,_flat:ia,polylineCenter:Va},Te={project:function(a){return new q(a.lng,a.lat)},unproject:function(a){return new Re(a.y,a.x)},bounds:new ue([-180,-90],[180,90])},Le={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var u=Math.PI/180,v=this.R,I=a.lat*u,N=this.R_MINOR/v,W=Math.sqrt(1-N*N),he=W*Math.sin(I),Me=Math.tan(Math.PI/4-I/2)/Math.pow((1-he)/(1+he),W/2);return I=-v*Math.log(Math.max(Me,1e-10)),new q(a.lng*u*v,I)},unproject:function(a){for(var u=180/Math.PI,v=this.R,I=this.R_MINOR/v,N=Math.sqrt(1-I*I),W=Math.exp(-a.y/v),he=Math.PI/2-2*Math.atan(W),Me=0,Ue=.1,Xe;Me<15&&Math.abs(Ue)>1e-7;Me++)Xe=N*Math.sin(he),Xe=Math.pow((1-Xe)/(1+Xe),N/2),Ue=Math.PI/2-2*Math.atan(W*Xe)-he,he+=Ue;return new Re(he*u,a.x*u/v)}},ot={__proto__:null,LonLat:Te,Mercator:Le,SphericalMercator:ie},gt=o({},J,{code:"EPSG:3395",projection:Le,transformation:(function(){var a=.5/(Math.PI*Le.R);return G(a,.5,-a,.5)})()}),Ct=o({},J,{code:"EPSG:4326",projection:Te,transformation:G(1/180,1,-1/180,.5)}),Xt=o({},z,{projection:Te,transformation:G(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,u){var v=u.lng-a.lng,I=u.lat-a.lat;return Math.sqrt(v*v+I*I)},infinite:!0});z.Earth=J,z.EPSG3395=gt,z.EPSG3857=X,z.EPSG900913=ee,z.EPSG4326=Ct,z.Simple=Xt;var tn=ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var u=a.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var v=this.getEvents();u.on(v,this),this.once("remove",function(){u.off(v,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});$t.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(a);return this._layers[u]?this:(this._layers[u]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var u=d(a);return this._layers[u]?(this._loaded&&a.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return d(a)in this._layers},eachLayer:function(a,u){for(var v in this._layers)a.call(u,this._layers[v]);return this},_addLayers:function(a){a=a?C(a)?a:[a]:[];for(var u=0,v=a.length;u<v;u++)this.addLayer(a[u])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[d(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var u=d(a);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,u=-1/0,v=this._getZoomSpan();for(var I in this._zoomBoundLayers){var N=this._zoomBoundLayers[I].options;a=N.minZoom===void 0?a:Math.min(a,N.minZoom),u=N.maxZoom===void 0?u:Math.max(u,N.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=a===1/0?void 0:a,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var on=tn.extend({initialize:function(a,u){x(this,u),this._layers={};var v,I;if(a)for(v=0,I=a.length;v<I;v++)this.addLayer(a[v])},addLayer:function(a){var u=this.getLayerId(a);return this._layers[u]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var u=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(a){var u=typeof a=="number"?a:this.getLayerId(a);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var u=Array.prototype.slice.call(arguments,1),v,I;for(v in this._layers)I=this._layers[v],I[a]&&I[a].apply(I,u);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,u){for(var v in this._layers)a.call(u,this._layers[v]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d(a)}}),bn=function(a,u){return new on(a,u)},pn=on.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),on.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),on.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new $e;for(var u in this._layers){var v=this._layers[u];a.extend(v.getBounds?v.getBounds():v.getLatLng())}return a}}),At=function(a,u){return new pn(a,u)},un=Q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){x(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,u){var v=this._getIconUrl(a);if(!v){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var I=this._createImg(v,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(I,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(I.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),I},_setIconStyles:function(a,u){var v=this.options,I=v[u+"Size"];typeof I=="number"&&(I=[I,I]);var N=te(I),W=te(u==="shadow"&&v.shadowAnchor||v.iconAnchor||N&&N.divideBy(2,!0));a.className="leaflet-marker-"+u+" "+(v.className||""),W&&(a.style.marginLeft=-W.x+"px",a.style.marginTop=-W.y+"px"),N&&(a.style.width=N.x+"px",a.style.height=N.y+"px")},_createImg:function(a,u){return u=u||document.createElement("img"),u.src=a,u},_getIconUrl:function(a){return Qe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function vr(a){return new un(a)}var la=un.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof la.imagePath!="string"&&(la.imagePath=this._detectIconPath()),(this.options.imagePath||la.imagePath)+un.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var u=function(v,I,N){var W=I.exec(v);return W&&W[N]};return a=u(a,/^url\((['"])?(.+)\1\)$/,2),a&&u(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=bt("div","leaflet-default-icon-path",document.body),u=Wo(a,"background-image")||Wo(a,"backgroundImage");if(document.body.removeChild(a),u=this._stripUrl(u),u)return u;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),mr=Pn.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Po(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var u=this._marker,v=u._map,I=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,W=Wn(u._icon),he=v.getPixelBounds(),Me=v.getPixelOrigin(),Ue=_e(he.min._subtract(Me).add(N),he.max._subtract(Me).subtract(N));if(!Ue.contains(W)){var Xe=te((Math.max(Ue.max.x,W.x)-Ue.max.x)/(he.max.x-Ue.max.x)-(Math.min(Ue.min.x,W.x)-Ue.min.x)/(he.min.x-Ue.min.x),(Math.max(Ue.max.y,W.y)-Ue.max.y)/(he.max.y-Ue.max.y)-(Math.min(Ue.min.y,W.y)-Ue.min.y)/(he.min.y-Ue.min.y)).multiplyBy(I);v.panBy(Xe,{animate:!1}),this._draggable._newPos._add(Xe),this._draggable._startPos._add(Xe),en(u._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var u=this._marker,v=u._shadow,I=Wn(u._icon),N=u._map.layerPointToLatLng(I);v&&en(v,I),u._latlng=N,a.latlng=N,a.oldLatLng=this._oldLatLng,u.fire("move",a).fire("drag",a)},_onDragEnd:function(a){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),_l=tn.extend({options:{icon:new la,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,u){x(this,u),this._latlng=be(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var u=this._latlng;return this._latlng=be(a),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=a.icon.createIcon(this._icon),I=!1;v!==this._icon&&(this._icon&&this._removeIcon(),I=!0,a.title&&(v.title=a.title),v.tagName==="IMG"&&(v.alt=a.alt||"")),pt(v,u),a.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wt(v,"focus",this._panOnFocus,this);var N=a.icon.createShadow(this._shadow),W=!1;N!==this._shadow&&(this._removeShadow(),W=!0),N&&(pt(N,u),N.alt=""),this._shadow=N,a.opacity<1&&this._updateOpacity(),I&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&W&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Dt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Dt(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&en(this._icon,a),this._shadow&&en(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mr)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mr(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Cn(this._icon,a),this._shadow&&Cn(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var u=this.options.icon.options,v=u.iconSize?te(u.iconSize):te(0,0),I=u.iconAnchor?te(u.iconAnchor):te(0,0);a.panInside(this._latlng,{paddingTopLeft:I,paddingBottomRight:v.subtract(I)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _c(a,u){return new _l(a,u)}var Fs=tn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return x(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Mi=Fs.extend({options:{fill:!0,radius:10},initialize:function(a,u){x(this,u),this._latlng=be(a),this._radius=this.options.radius},setLatLng:function(a){var u=this._latlng;return this._latlng=be(a),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var u=a&&a.radius||this._radius;return Fs.prototype.setStyle.call(this,a),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,u=this._radiusY||a,v=this._clickTolerance(),I=[a+v,u+v];this._pxBounds=new ue(this._point.subtract(I),this._point.add(I))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function rd(a,u){return new Mi(a,u)}var gr=Mi.extend({initialize:function(a,u,v){if(typeof u=="number"&&(u=o({},v,{radius:u})),x(this,u),this._latlng=be(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new $e(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Fs.prototype.setStyle,_project:function(){var a=this._latlng.lng,u=this._latlng.lat,v=this._map,I=v.options.crs;if(I.distance===J.distance){var N=Math.PI/180,W=this._mRadius/J.R/N,he=v.project([u+W,a]),Me=v.project([u-W,a]),Ue=he.add(Me).divideBy(2),Xe=v.unproject(Ue).lat,it=Math.acos((Math.cos(W*N)-Math.sin(u*N)*Math.sin(Xe*N))/(Math.cos(u*N)*Math.cos(Xe*N)))/N;(isNaN(it)||it===0)&&(it=W/Math.cos(Math.PI/180*u)),this._point=Ue.subtract(v.getPixelOrigin()),this._radius=isNaN(it)?0:Ue.x-v.project([Xe,a-it]).x,this._radiusY=Ue.y-he.y}else{var mt=I.unproject(I.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(mt).x}this._updateBounds()}});function cd(a,u,v){return new gr(a,u,v)}var us=Fs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,u){x(this,u),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var u=1/0,v=null,I=aa,N,W,he=0,Me=this._parts.length;he<Me;he++)for(var Ue=this._parts[he],Xe=1,it=Ue.length;Xe<it;Xe++){N=Ue[Xe-1],W=Ue[Xe];var mt=I(a,N,W,!0);mt<u&&(u=mt,v=I(a,N,W))}return v&&(v.distance=Math.sqrt(u)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Va(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,u){return u=u||this._defaultShape(),a=be(a),u.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new $e,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Bn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var u=[],v=Bn(a),I=0,N=a.length;I<N;I++)v?(u[I]=be(a[I]),this._bounds.extend(u[I])):u[I]=this._convertLatLngs(a[I]);return u},_project:function(){var a=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),u=new q(a,a);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(a,u,v){var I=a[0]instanceof Re,N=a.length,W,he;if(I){for(he=[],W=0;W<N;W++)he[W]=this._map.latLngToLayerPoint(a[W]),v.extend(he[W]);u.push(he)}else for(W=0;W<N;W++)this._projectLatlngs(a[W],u,v)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,v,I,N,W,he,Me,Ue;for(v=0,N=0,W=this._rings.length;v<W;v++)for(Ue=this._rings[v],I=0,he=Ue.length;I<he-1;I++)Me=sa(Ue[I],Ue[I+1],a,I,!0),Me&&(u[N]=u[N]||[],u[N].push(Me[0]),(Me[1]!==Ue[I+1]||I===he-2)&&(u[N].push(Me[1]),N++))}},_simplifyPoints:function(){for(var a=this._parts,u=this.options.smoothFactor,v=0,I=a.length;v<I;v++)a[v]=Fa(a[v],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,u){var v,I,N,W,he,Me,Ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(v=0,W=this._parts.length;v<W;v++)for(Me=this._parts[v],I=0,he=Me.length,N=he-1;I<he;N=I++)if(!(!u&&I===0)&&bl(a,Me[N],Me[I])<=Ue)return!0;return!1}});function ud(a,u){return new us(a,u)}us._flat=ia;var Ga=us.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return kl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var u=us.prototype._convertLatLngs.call(this,a),v=u.length;return v>=2&&u[0]instanceof Re&&u[0].equals(u[v-1])&&u.pop(),u},_setLatLngs:function(a){us.prototype._setLatLngs.call(this,a),Bn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Bn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,u=this.options.weight,v=new q(u,u);if(a=new ue(a.min.subtract(v),a.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var I=0,N=this._rings.length,W;I<N;I++)W=yl(this._rings[I],a,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var u=!1,v,I,N,W,he,Me,Ue,Xe;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(W=0,Ue=this._parts.length;W<Ue;W++)for(v=this._parts[W],he=0,Xe=v.length,Me=Xe-1;he<Xe;Me=he++)I=v[he],N=v[Me],I.y>a.y!=N.y>a.y&&a.x<(N.x-I.x)*(a.y-I.y)/(N.y-I.y)+I.x&&(u=!u);return u||us.prototype._containsPoint.call(this,a,!0)}});function dd(a,u){return new Ga(a,u)}var ds=pn.extend({initialize:function(a,u){x(this,u),this._layers={},a&&this.addData(a)},addData:function(a){var u=C(a)?a:a.features,v,I,N;if(u){for(v=0,I=u.length;v<I;v++)N=u[v],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var W=this.options;if(W.filter&&!W.filter(a))return this;var he=Cl(a,W);return he?(he.feature=Il(a),he.defaultOptions=he.options,this.resetStyle(he),W.onEachFeature&&W.onEachFeature(a,he),this.addLayer(he)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=o({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(u){this._setLayerStyle(u,a)},this)},_setLayerStyle:function(a,u){a.setStyle&&(typeof u=="function"&&(u=u(a.feature)),a.setStyle(u))}});function Cl(a,u){var v=a.type==="Feature"?a.geometry:a,I=v?v.coordinates:null,N=[],W=u&&u.pointToLayer,he=u&&u.coordsToLatLng||yr,Me,Ue,Xe,it;if(!I&&!v)return null;switch(v.type){case"Point":return Me=he(I),Cc(W,a,Me,u);case"MultiPoint":for(Xe=0,it=I.length;Xe<it;Xe++)Me=he(I[Xe]),N.push(Cc(W,a,Me,u));return new pn(N);case"LineString":case"MultiLineString":return Ue=Ll(I,v.type==="LineString"?0:1,he),new us(Ue,u);case"Polygon":case"MultiPolygon":return Ue=Ll(I,v.type==="Polygon"?1:2,he),new Ga(Ue,u);case"GeometryCollection":for(Xe=0,it=v.geometries.length;Xe<it;Xe++){var mt=Cl({geometry:v.geometries[Xe],type:"Feature",properties:a.properties},u);mt&&N.push(mt)}return new pn(N);case"FeatureCollection":for(Xe=0,it=v.features.length;Xe<it;Xe++){var Tt=Cl(v.features[Xe],u);Tt&&N.push(Tt)}return new pn(N);default:throw new Error("Invalid GeoJSON object.")}}function Cc(a,u,v,I){return a?a(u,v):new _l(v,I&&I.markersInheritOptions&&I)}function yr(a){return new Re(a[1],a[0],a[2])}function Ll(a,u,v){for(var I=[],N=0,W=a.length,he;N<W;N++)he=u?Ll(a[N],u-1,v):(v||yr)(a[N]),I.push(he);return I}function qa(a,u){return a=be(a),a.alt!==void 0?[y(a.lng,u),y(a.lat,u),y(a.alt,u)]:[y(a.lng,u),y(a.lat,u)]}function Sl(a,u,v,I){for(var N=[],W=0,he=a.length;W<he;W++)N.push(u?Sl(a[W],Bn(a[W])?0:u-1,v,I):qa(a[W],I));return!u&&v&&N.length>0&&N.push(N[0].slice()),N}function hs(a,u){return a.feature?o({},a.feature,{geometry:u}):Il(u)}function Il(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var xl={toGeoJSON:function(a){return hs(this,{type:"Point",coordinates:qa(this.getLatLng(),a)})}};_l.include(xl),gr.include(xl),Mi.include(xl),us.include({toGeoJSON:function(a){var u=!Bn(this._latlngs),v=Sl(this._latlngs,u?1:0,!1,a);return hs(this,{type:(u?"Multi":"")+"LineString",coordinates:v})}}),Ga.include({toGeoJSON:function(a){var u=!Bn(this._latlngs),v=u&&!Bn(this._latlngs[0]),I=Sl(this._latlngs,v?2:u?1:0,!0,a);return u||(I=[I]),hs(this,{type:(v?"Multi":"")+"Polygon",coordinates:I})}}),on.include({toMultiPoint:function(a){var u=[];return this.eachLayer(function(v){u.push(v.toGeoJSON(a).geometry.coordinates)}),hs(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(a){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(a);var v=u==="GeometryCollection",I=[];return this.eachLayer(function(N){if(N.toGeoJSON){var W=N.toGeoJSON(a);if(v)I.push(W.geometry);else{var he=Il(W);he.type==="FeatureCollection"?I.push.apply(I,he.features):I.push(he)}}}),v?hs(this,{geometries:I,type:"GeometryCollection"}):{type:"FeatureCollection",features:I}}});function $l(a,u){return new ds(a,u)}var kr=$l,Tl=tn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,u,v){this._url=a,this._bounds=De(u),x(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Dt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&On(this._image),this},bringToBack:function(){return this._map&&Nn(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=De(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",u=this._image=a?this._url:bt("img");if(pt(u,"leaflet-image-layer"),this._zoomAnimated&&pt(u,"leaflet-zoom-animated"),this.options.className&&pt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(a){var u=this._map.getZoomScale(a.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;So(this._image,v,u)},_reset:function(){var a=this._image,u=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=u.getSize();en(a,u.min),a.style.width=v.x+"px",a.style.height=v.y+"px"},_updateOpacity:function(){Cn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),hd=function(a,u,v){return new Tl(a,u,v)},Lc=Tl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",u=this._image=a?this._url:bt("video");if(pt(u,"leaflet-image-layer"),this._zoomAnimated&&pt(u,"leaflet-zoom-animated"),this.options.className&&pt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onloadeddata=l(this.fire,this,"load"),a){for(var v=u.getElementsByTagName("source"),I=[],N=0;N<v.length;N++)I.push(v[N].src);this._url=v.length>0?I:[u.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var he=bt("source");he.src=this._url[W],u.appendChild(he)}}});function fd(a,u,v){return new Lc(a,u,v)}var Sc=Tl.extend({_initImage:function(){var a=this._image=this._url;pt(a,"leaflet-image-layer"),this._zoomAnimated&&pt(a,"leaflet-zoom-animated"),this.options.className&&pt(a,this.options.className),a.onselectstart=m,a.onmousemove=m}});function pd(a,u,v){return new Sc(a,u,v)}var Zo=tn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,u){a&&(a instanceof Re||C(a))?(this._latlng=be(a),x(this,u)):(x(this,a),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Cn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Cn(this._container,1),this.bringToFront(),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Cn(this._container,0),this._removeTimeout=setTimeout(l(Dt,void 0,this._container),200)):Dt(this._container),this.options.interactive&&(Vt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=be(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&On(this._container),this},bringToBack:function(){return this._map&&Nn(this._container),this},_prepareOpen:function(a){var u=this._source;if(!u._map)return!1;if(u instanceof pn){u=null;var v=this._source._layers;for(var I in v)if(v[I]._map){u=v[I];break}if(!u)return!1;this._source=u}if(!a)if(u.getCenter)a=u.getCenter();else if(u.getLatLng)a=u.getLatLng();else if(u.getBounds)a=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")a.innerHTML=u;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),u=te(this.options.offset),v=this._getAnchor();this._zoomAnimated?en(this._container,a.add(v)):u=u.add(a).add(v);var I=this._containerBottom=-u.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=I+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});$t.include({_initOverlay:function(a,u,v,I){var N=u;return N instanceof a||(N=new a(I).setContent(u)),v&&N.setLatLng(v),N}}),tn.include({_initOverlay:function(a,u,v,I){var N=v;return N instanceof a?(x(N,I),N._source=this):(N=u&&!I?u:new a(I,this),N.setContent(v)),N}});var Ml=Zo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Zo.prototype.openOn.call(this,a)},onAdd:function(a){Zo.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Fs||this._source.on("preclick",as))},onRemove:function(a){Zo.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Fs||this._source.off("preclick",as))},getEvents:function(){var a=Zo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",u=this._container=bt("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=bt("div",a+"-content-wrapper",u);if(this._contentNode=bt("div",a+"-content",v),kn(u),Zn(this._contentNode),wt(u,"contextmenu",as),this._tipContainer=bt("div",a+"-tip-container",u),this._tip=bt("div",a+"-tip",this._tipContainer),this.options.closeButton){var I=this._closeButton=bt("a",a+"-close-button",u);I.setAttribute("role","button"),I.setAttribute("aria-label","Close popup"),I.href="#close",I.innerHTML='<span aria-hidden="true">&#215;</span>',wt(I,"click",function(N){qt(N),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,u=a.style;u.width="",u.whiteSpace="nowrap";var v=a.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),u.width=v+1+"px",u.whiteSpace="",u.height="";var I=a.offsetHeight,N=this.options.maxHeight,W="leaflet-popup-scrolled";N&&I>N?(u.height=N+"px",pt(a,W)):Vt(a,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),v=this._getAnchor();en(this._container,u.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,u=parseInt(Wo(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+u,I=this._containerWidth,N=new q(this._containerLeft,-v-this._containerBottom);N._add(Wn(this._container));var W=a.layerPointToContainerPoint(N),he=te(this.options.autoPanPadding),Me=te(this.options.autoPanPaddingTopLeft||he),Ue=te(this.options.autoPanPaddingBottomRight||he),Xe=a.getSize(),it=0,mt=0;W.x+I+Ue.x>Xe.x&&(it=W.x+I-Xe.x+Ue.x),W.x-it-Me.x<0&&(it=W.x-Me.x),W.y+v+Ue.y>Xe.y&&(mt=W.y+v-Xe.y+Ue.y),W.y-mt-Me.y<0&&(mt=W.y-Me.y),(it||mt)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([it,mt]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),vd=function(a,u){return new Ml(a,u)};$t.mergeOptions({closePopupOnClick:!0}),$t.include({openPopup:function(a,u,v){return this._initOverlay(Ml,a,u,v).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),tn.include({bindPopup:function(a,u){return this._popup=this._initOverlay(Ml,this._popup,a,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof pn||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){co(a);var u=a.layer||a.target;if(this._popup._source===u&&!(u instanceof Fs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=u,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Al=Zo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Zo.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Zo.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Zo.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",u=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=bt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var u,v,I=this._map,N=this._container,W=I.latLngToContainerPoint(I.getCenter()),he=I.layerPointToContainerPoint(a),Me=this.options.direction,Ue=N.offsetWidth,Xe=N.offsetHeight,it=te(this.options.offset),mt=this._getAnchor();Me==="top"?(u=Ue/2,v=Xe):Me==="bottom"?(u=Ue/2,v=0):Me==="center"?(u=Ue/2,v=Xe/2):Me==="right"?(u=0,v=Xe/2):Me==="left"?(u=Ue,v=Xe/2):he.x<W.x?(Me="right",u=0,v=Xe/2):(Me="left",u=Ue+(it.x+mt.x)*2,v=Xe/2),a=a.subtract(te(u,v,!0)).add(it).add(mt),Vt(N,"leaflet-tooltip-right"),Vt(N,"leaflet-tooltip-left"),Vt(N,"leaflet-tooltip-top"),Vt(N,"leaflet-tooltip-bottom"),pt(N,"leaflet-tooltip-"+Me),en(N,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Cn(this._container,a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(u)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ic=function(a,u){return new Al(a,u)};$t.include({openTooltip:function(a,u,v){return this._initOverlay(Al,a,u,v).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),tn.include({bindTooltip:function(a,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Al,this._tooltip,a,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var u=a?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[u](v),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof pn||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&(wt(u,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),wt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var u=a.latlng,v,I;this._tooltip.options.sticky&&a.originalEvent&&(v=this._map.mouseEventToContainerPoint(a.originalEvent),I=this._map.containerPointToLayerPoint(v),u=this._map.layerPointToLatLng(I)),this._tooltip.setLatLng(u)}});var xc=un.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var u=a&&a.tagName==="DIV"?a:document.createElement("div"),v=this.options;if(v.html instanceof Element?(jn(u),u.appendChild(v.html)):u.innerHTML=v.html!==!1?v.html:"",v.bgPos){var I=te(v.bgPos);u.style.backgroundPosition=-I.x+"px "+-I.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function $c(a){return new xc(a)}un.Default=la;var Ai=tn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){x(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Dt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(On(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Nn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof q?a:new q(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var u=this.getPane().children,v=-a(-1/0,1/0),I=0,N=u.length,W;I<N;I++)W=u[I].style.zIndex,u[I]!==this._container&&W&&(v=a(v,+W));isFinite(v)&&(this.options.zIndex=v+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){Cn(this._container,this.options.opacity);var a=+new Date,u=!1,v=!1;for(var I in this._tiles){var N=this._tiles[I];if(!(!N.current||!N.loaded)){var W=Math.min(1,(a-N.loaded)/200);Cn(N.el,W),W<1?u=!0:(N.active?v=!0:this._onOpaqueTile(N),N.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),u&&(j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=bt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,u=this.options.maxZoom;if(a!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===a?(this._levels[v].el.style.zIndex=u-Math.abs(a-v),this._onUpdateLevel(v)):(Dt(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var I=this._levels[a],N=this._map;return I||(I=this._levels[a]={},I.el=bt("div","leaflet-tile-container leaflet-zoom-animated",this._container),I.el.style.zIndex=u,I.origin=N.project(N.unproject(N.getPixelOrigin()),a).round(),I.zoom=a,this._setZoomTransform(I,N.getCenter(),N.getZoom()),m(I.el.offsetWidth),this._onCreateLevel(I)),this._level=I,I}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var a,u,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)u=this._tiles[a],u.retain=u.current;for(a in this._tiles)if(u=this._tiles[a],u.current&&!u.active){var I=u.coords;this._retainParent(I.x,I.y,I.z,I.z-5)||this._retainChildren(I.x,I.y,I.z,I.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var u in this._tiles)this._tiles[u].coords.z===a&&this._removeTile(u)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Dt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,u,v,I){var N=Math.floor(a/2),W=Math.floor(u/2),he=v-1,Me=new q(+N,+W);Me.z=+he;var Ue=this._tileCoordsToKey(Me),Xe=this._tiles[Ue];return Xe&&Xe.active?(Xe.retain=!0,!0):(Xe&&Xe.loaded&&(Xe.retain=!0),he>I?this._retainParent(N,W,he,I):!1)},_retainChildren:function(a,u,v,I){for(var N=2*a;N<2*a+2;N++)for(var W=2*u;W<2*u+2;W++){var he=new q(N,W);he.z=v+1;var Me=this._tileCoordsToKey(he),Ue=this._tiles[Me];if(Ue&&Ue.active){Ue.retain=!0;continue}else Ue&&Ue.loaded&&(Ue.retain=!0);v+1<I&&this._retainChildren(N,W,v+1,I)}},_resetView:function(a){var u=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var u=this.options;return u.minNativeZoom!==void 0&&a<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<a?u.maxNativeZoom:a},_setView:function(a,u,v,I){var N=Math.round(u);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var W=this.options.updateWhenZooming&&N!==this._tileZoom;(!I||W)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(a),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(a,u)},_setZoomTransforms:function(a,u){for(var v in this._levels)this._setZoomTransform(this._levels[v],a,u)},_setZoomTransform:function(a,u,v){var I=this._map.getZoomScale(v,a.zoom),N=a.origin.multiplyBy(I).subtract(this._map._getNewPixelOrigin(u,v)).round();Qe.any3d?So(a.el,N,I):en(a.el,N)},_resetGrid:function(){var a=this._map,u=a.options.crs,v=this._tileSize=this.getTileSize(),I=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,u.wrapLng[0]],I).x/v.x),Math.ceil(a.project([0,u.wrapLng[1]],I).x/v.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([u.wrapLat[0],0],I).y/v.x),Math.ceil(a.project([u.wrapLat[1],0],I).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var u=this._map,v=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),I=u.getZoomScale(v,this._tileZoom),N=u.project(a,this._tileZoom).floor(),W=u.getSize().divideBy(I*2);return new ue(N.subtract(W),N.add(W))},_update:function(a){var u=this._map;if(u){var v=this._clampZoom(u.getZoom());if(a===void 0&&(a=u.getCenter()),this._tileZoom!==void 0){var I=this._getTiledPixelBounds(a),N=this._pxBoundsToTileRange(I),W=N.getCenter(),he=[],Me=this.options.keepBuffer,Ue=new ue(N.getBottomLeft().subtract([Me,-Me]),N.getTopRight().add([Me,-Me]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Xe in this._tiles){var it=this._tiles[Xe].coords;(it.z!==this._tileZoom||!Ue.contains(new q(it.x,it.y)))&&(this._tiles[Xe].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(a,v);return}for(var mt=N.min.y;mt<=N.max.y;mt++)for(var Tt=N.min.x;Tt<=N.max.x;Tt++){var uo=new q(Tt,mt);if(uo.z=this._tileZoom,!!this._isValidTile(uo)){var Dn=this._tiles[this._tileCoordsToKey(uo)];Dn?Dn.current=!0:he.push(uo)}}if(he.sort(function(Io,Dl){return Io.distanceTo(W)-Dl.distanceTo(W)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ko=document.createDocumentFragment();for(Tt=0;Tt<he.length;Tt++)this._addTile(he[Tt],Ko);this._level.el.appendChild(Ko)}}}},_isValidTile:function(a){var u=this._map.options.crs;if(!u.infinite){var v=this._globalTileRange;if(!u.wrapLng&&(a.x<v.min.x||a.x>v.max.x)||!u.wrapLat&&(a.y<v.min.y||a.y>v.max.y))return!1}if(!this.options.bounds)return!0;var I=this._tileCoordsToBounds(a);return De(this.options.bounds).overlaps(I)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var u=this._map,v=this.getTileSize(),I=a.scaleBy(v),N=I.add(v),W=u.unproject(I,a.z),he=u.unproject(N,a.z);return[W,he]},_tileCoordsToBounds:function(a){var u=this._tileCoordsToNwSe(a),v=new $e(u[0],u[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var u=a.split(":"),v=new q(+u[0],+u[1]);return v.z=+u[2],v},_removeTile:function(a){var u=this._tiles[a];u&&(Dt(u.el),delete this._tiles[a],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){pt(a,"leaflet-tile");var u=this.getTileSize();a.style.width=u.x+"px",a.style.height=u.y+"px",a.onselectstart=m,a.onmousemove=m,Qe.ielt9&&this.options.opacity<1&&Cn(a,this.options.opacity)},_addTile:function(a,u){var v=this._getTilePos(a),I=this._tileCoordsToKey(a),N=this.createTile(this._wrapCoords(a),l(this._tileReady,this,a));this._initTile(N),this.createTile.length<2&&F(l(this._tileReady,this,a,null,N)),en(N,v),this._tiles[I]={el:N,coords:a,current:!0},u.appendChild(N),this.fire("tileloadstart",{tile:N,coords:a})},_tileReady:function(a,u,v){u&&this.fire("tileerror",{error:u,tile:v,coords:a});var I=this._tileCoordsToKey(a);v=this._tiles[I],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Cn(v.el,0),j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),u||(pt(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var u=new q(this._wrapX?f(a.x,this._wrapX):a.x,this._wrapY?f(a.y,this._wrapY):a.y);return u.z=a.z,u},_pxBoundsToTileRange:function(a){var u=this.getTileSize();return new ue(a.min.unscaleBy(u).floor(),a.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function md(a){return new Ai(a)}var ja=Ai.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,u){this._url=a,u=x(this,u),u.detectRetina&&Qe.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,u){return this._url===a&&u===void 0&&(u=!0),this._url=a,u||this.redraw(),this},createTile:function(a,u){var v=document.createElement("img");return wt(v,"load",l(this._tileOnLoad,this,u,v)),wt(v,"error",l(this._tileOnError,this,u,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(a),v},getTileUrl:function(a){var u={r:Qe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-a.y;this.options.tms&&(u.y=v),u["-y"]=v}return _(this._url,o(u,this.options))},_tileOnLoad:function(a,u){Qe.ielt9?setTimeout(l(a,this,null,u),0):a(null,u)},_tileOnError:function(a,u,v){var I=this.options.errorTileUrl;I&&u.getAttribute("src")!==I&&(u.src=I),a(v,u)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,u=this.options.maxZoom,v=this.options.zoomReverse,I=this.options.zoomOffset;return v&&(a=u-a),a+I},_getSubdomain:function(a){var u=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var a,u;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(u=this._tiles[a].el,u.onload=m,u.onerror=m,!u.complete)){u.src=$;var v=this._tiles[a].coords;Dt(u),delete this._tiles[a],this.fire("tileabort",{tile:u,coords:v})}},_removeTile:function(a){var u=this._tiles[a];if(u)return u.el.setAttribute("src",$),Ai.prototype._removeTile.call(this,a)},_tileReady:function(a,u,v){if(!(!this._map||v&&v.getAttribute("src")===$))return Ai.prototype._tileReady.call(this,a,u,v)}});function El(a,u){return new ja(a,u)}var Tc=ja.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,u){this._url=a;var v=o({},this.defaultWmsParams);for(var I in u)I in this.options||(v[I]=u[I]);u=x(this,u);var N=u.detectRetina&&Qe.retina?2:1,W=this.getTileSize();v.width=W.x*N,v.height=W.y*N,this.wmsParams=v},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,ja.prototype.onAdd.call(this,a)},getTileUrl:function(a){var u=this._tileCoordsToNwSe(a),v=this._crs,I=_e(v.project(u[0]),v.project(u[1])),N=I.min,W=I.max,he=(this._wmsVersion>=1.3&&this._crs===Ct?[N.y,N.x,W.y,W.x]:[N.x,N.y,W.x,W.y]).join(","),Me=ja.prototype.getTileUrl.call(this,a);return Me+A(this.wmsParams,Me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(a,u){return o(this.wmsParams,a),u||this.redraw(),this}});function gd(a,u){return new Tc(a,u)}ja.WMS=Tc,El.wms=gd;var fs=tn.extend({options:{padding:.1},initialize:function(a){x(this,a),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,u){var v=this._map.getZoomScale(u,this._zoom),I=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,u),W=I.multiplyBy(-v).add(N).subtract(this._map._getNewPixelOrigin(a,u));Qe.any3d?So(this._container,W,v):en(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,u=this._map.getSize(),v=this._map.containerPointToLayerPoint(u.multiplyBy(-a)).round();this._bounds=new ue(v,v.add(u.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),br=fs.extend({options:{tolerance:0},getEvents:function(){var a=fs.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");wt(a,"mousemove",this._onMouseMove,this),wt(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),wt(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Dt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var u in this._layers)a=this._layers[u],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fs.prototype._update.call(this);var a=this._bounds,u=this._container,v=a.getSize(),I=Qe.retina?2:1;en(u,a.min),u.width=I*v.x,u.height=I*v.y,u.style.width=v.x+"px",u.style.height=v.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){fs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[d(a)]=a;var u=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var u=a._order,v=u.next,I=u.prev;v?v.prev=I:this._drawLast=I,I?I.next=v:this._drawFirst=v,delete a._order,delete this._layers[d(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var u=a.options.dashArray.split(/[, ]+/),v=[],I,N;for(N=0;N<u.length;N++){if(I=Number(u[N]),isNaN(I))return;v.push(I)}a.options._dashArray=v}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var u=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(a._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(a._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var u=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,u=this._redrawBounds;if(this._ctx.save(),u){var v=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var I=this._drawFirst;I;I=I.next)a=I.layer,(!u||a._pxBounds&&a._pxBounds.intersects(u))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,u){if(this._drawing){var v,I,N,W,he=a._parts,Me=he.length,Ue=this._ctx;if(Me){for(Ue.beginPath(),v=0;v<Me;v++){for(I=0,N=he[v].length;I<N;I++)W=he[v][I],Ue[I?"lineTo":"moveTo"](W.x,W.y);u&&Ue.closePath()}this._fillStroke(Ue,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var u=a._point,v=this._ctx,I=Math.max(Math.round(a._radius),1),N=(Math.max(Math.round(a._radiusY),1)||I)/I;N!==1&&(v.save(),v.scale(1,N)),v.beginPath(),v.arc(u.x,u.y/N,I,0,Math.PI*2,!1),N!==1&&v.restore(),this._fillStroke(v,a)}},_fillStroke:function(a,u){var v=u.options;v.fill&&(a.globalAlpha=v.fillOpacity,a.fillStyle=v.fillColor||v.color,a.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(a.setLineDash&&a.setLineDash(u.options&&u.options._dashArray||[]),a.globalAlpha=v.opacity,a.lineWidth=v.weight,a.strokeStyle=v.color,a.lineCap=v.lineCap,a.lineJoin=v.lineJoin,a.stroke())},_onClick:function(a){for(var u=this._map.mouseEventToLayerPoint(a),v,I,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(u)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(v))&&(I=v);this._fireEvent(I?[I]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,u)}},_handleMouseOut:function(a){var u=this._hoveredLayer;u&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([u],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,u){if(!this._mouseHoverThrottled){for(var v,I,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(u)&&(I=v);I!==this._hoveredLayer&&(this._handleMouseOut(a),I&&(pt(this._container,"leaflet-interactive"),this._fireEvent([I],a,"mouseover"),this._hoveredLayer=I)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,u,v){this._map._fireDOMEvent(u,v||u.type,a)},_bringToFront:function(a){var u=a._order;if(u){var v=u.next,I=u.prev;if(v)v.prev=I;else return;I?I.next=v:v&&(this._drawFirst=v),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(a)}},_bringToBack:function(a){var u=a._order;if(u){var v=u.next,I=u.prev;if(I)I.next=v;else return;v?v.prev=I:I&&(this._drawLast=I),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(a)}}});function Mc(a){return Qe.canvas?new br(a):null}var ps=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ac={_initContainer:function(){this._container=bt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fs.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var u=a._container=ps("shape");pt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",a._path=ps("path"),u.appendChild(a._path),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){var u=a._container;this._container.appendChild(u),a.options.interactive&&a.addInteractiveTarget(u)},_removePath:function(a){var u=a._container;Dt(u),a.removeInteractiveTarget(u),delete this._layers[d(a)]},_updateStyle:function(a){var u=a._stroke,v=a._fill,I=a.options,N=a._container;N.stroked=!!I.stroke,N.filled=!!I.fill,I.stroke?(u||(u=a._stroke=ps("stroke")),N.appendChild(u),u.weight=I.weight+"px",u.color=I.color,u.opacity=I.opacity,I.dashArray?u.dashStyle=C(I.dashArray)?I.dashArray.join(" "):I.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=I.lineCap.replace("butt","flat"),u.joinstyle=I.lineJoin):u&&(N.removeChild(u),a._stroke=null),I.fill?(v||(v=a._fill=ps("fill")),N.appendChild(v),v.color=I.fillColor||I.color,v.opacity=I.fillOpacity):v&&(N.removeChild(v),a._fill=null)},_updateCircle:function(a){var u=a._point.round(),v=Math.round(a._radius),I=Math.round(a._radiusY||v);this._setPath(a,a._empty()?"M0 0":"AL "+u.x+","+u.y+" "+v+","+I+" 0,"+65535*360)},_setPath:function(a,u){a._path.v=u},_bringToFront:function(a){On(a._container)},_bringToBack:function(a){Nn(a._container)}},Ei=Qe.vml?ps:Ce,Wa=fs.extend({_initContainer:function(){this._container=Ei("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ei("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Dt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fs.prototype._update.call(this);var a=this._bounds,u=a.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,v.setAttribute("width",u.x),v.setAttribute("height",u.y)),en(v,a.min),v.setAttribute("viewBox",[a.min.x,a.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(a){var u=a._path=Ei("path");a.options.className&&pt(u,a.options.className),a.options.interactive&&pt(u,"leaflet-interactive"),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Dt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[d(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var u=a._path,v=a.options;u&&(v.stroke?(u.setAttribute("stroke",v.color),u.setAttribute("stroke-opacity",v.opacity),u.setAttribute("stroke-width",v.weight),u.setAttribute("stroke-linecap",v.lineCap),u.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?u.setAttribute("stroke-dasharray",v.dashArray):u.removeAttribute("stroke-dasharray"),v.dashOffset?u.setAttribute("stroke-dashoffset",v.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),v.fill?(u.setAttribute("fill",v.fillColor||v.color),u.setAttribute("fill-opacity",v.fillOpacity),u.setAttribute("fill-rule",v.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(a,u){this._setPath(a,Be(a._parts,u))},_updateCircle:function(a){var u=a._point,v=Math.max(Math.round(a._radius),1),I=Math.max(Math.round(a._radiusY),1)||v,N="a"+v+","+I+" 0 1,0 ",W=a._empty()?"M0 0":"M"+(u.x-v)+","+u.y+N+v*2+",0 "+N+-v*2+",0 ";this._setPath(a,W)},_setPath:function(a,u){a._path.setAttribute("d",u)},_bringToFront:function(a){On(a._path)},_bringToBack:function(a){Nn(a._path)}});Qe.vml&&Wa.include(Ac);function V(a){return Qe.svg||Qe.vml?new Wa(a):null}$t.include({getRenderer:function(a){var u=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var u=this._paneRenderers[a];return u===void 0&&(u=this._createRenderer({pane:a}),this._paneRenderers[a]=u),u},_createRenderer:function(a){return this.options.preferCanvas&&Mc(a)||V(a)}});var se=Ga.extend({initialize:function(a,u){Ga.prototype.initialize.call(this,this._boundsToLatLngs(a),u)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=De(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function ce(a,u){return new se(a,u)}Wa.create=Ei,Wa.pointsToPath=Be,ds.geometryToLayer=Cl,ds.coordsToLatLng=yr,ds.coordsToLatLngs=Ll,ds.latLngToCoords=qa,ds.latLngsToCoords=Sl,ds.getFeature=hs,ds.asFeature=Il,$t.mergeOptions({boxZoom:!0});var we=Pn.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){wt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Dt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),lo(),wi(),this._startPoint=this._map.mouseEventToContainerPoint(a),wt(document,{contextmenu:co,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=bt("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var u=new ue(this._point,this._startPoint),v=u.getSize();en(this._box,u.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Dt(this._box),Vt(this._container,"leaflet-crosshair")),Ps(),Pa(),Ut(document,{contextmenu:co,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new $e(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});$t.addInitHook("addHandler","boxZoom",we),$t.mergeOptions({doubleClickZoom:!0});var at=Pn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var u=this._map,v=u.getZoom(),I=u.options.zoomDelta,N=a.originalEvent.shiftKey?v-I:v+I;u.options.doubleClickZoom==="center"?u.setZoom(N):u.setZoomAround(a.containerPoint,N)}});$t.addInitHook("addHandler","doubleClickZoom",at),$t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var xt=Pn.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Po(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Vt(this._map._container,"leaflet-grab"),Vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=De(this._map.options.maxBounds);this._offsetLimit=_e(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var u=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(u),this._prunePositions(u)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,u){return a-(a-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;a.x<u.min.x&&(a.x=this._viscousLimit(a.x,u.min.x)),a.y<u.min.y&&(a.y=this._viscousLimit(a.y,u.min.y)),a.x>u.max.x&&(a.x=this._viscousLimit(a.x,u.max.x)),a.y>u.max.y&&(a.y=this._viscousLimit(a.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,u=Math.round(a/2),v=this._initialWorldOffset,I=this._draggable._newPos.x,N=(I-u+v)%a+u-v,W=(I+u+v)%a-u-v,he=Math.abs(N+v)<Math.abs(W+v)?N:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(a){var u=this._map,v=u.options,I=!v.inertia||a.noInertia||this._times.length<2;if(u.fire("dragend",a),I)u.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,he=v.easeLinearity,Me=N.multiplyBy(he/W),Ue=Me.distanceTo([0,0]),Xe=Math.min(v.inertiaMaxSpeed,Ue),it=Me.multiplyBy(Xe/Ue),mt=Xe/(v.inertiaDeceleration*he),Tt=it.multiplyBy(-mt/2).round();!Tt.x&&!Tt.y?u.fire("moveend"):(Tt=u._limitOffset(Tt,u.options.maxBounds),F(function(){u.panBy(Tt,{duration:mt,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});$t.addInitHook("addHandler","dragging",xt),$t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var jt=Pn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),wt(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,u=document.documentElement,v=a.scrollTop||u.scrollTop,I=a.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(I,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var u=this._panKeys={},v=this.keyCodes,I,N;for(I=0,N=v.left.length;I<N;I++)u[v.left[I]]=[-1*a,0];for(I=0,N=v.right.length;I<N;I++)u[v.right[I]]=[a,0];for(I=0,N=v.down.length;I<N;I++)u[v.down[I]]=[0,a];for(I=0,N=v.up.length;I<N;I++)u[v.up[I]]=[0,-1*a]},_setZoomDelta:function(a){var u=this._zoomKeys={},v=this.keyCodes,I,N;for(I=0,N=v.zoomIn.length;I<N;I++)u[v.zoomIn[I]]=a;for(I=0,N=v.zoomOut.length;I<N;I++)u[v.zoomOut[I]]=-a},_addHooks:function(){wt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var u=a.keyCode,v=this._map,I;if(u in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(I=this._panKeys[u],a.shiftKey&&(I=te(I).multiplyBy(3)),v.options.maxBounds&&(I=v._limitOffset(te(I),v.options.maxBounds)),v.options.worldCopyJump){var N=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(I)));v.panTo(N)}else v.panBy(I)}else if(u in this._zoomKeys)v.setZoom(v.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;co(a)}}});$t.addInitHook("addHandler","keyboard",jt),$t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var $n=Pn.extend({addHooks:function(){wt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var u=Os(a),v=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var I=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),I),co(a)},_performZoom:function(){var a=this._map,u=a.getZoom(),v=this._map.options.zoomSnap||0;a._stop();var I=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(I))))/Math.LN2,W=v?Math.ceil(N/v)*v:N,he=a._limitZoom(u+(this._delta>0?W:-W))-u;this._delta=0,this._startTime=null,he&&(a.options.scrollWheelZoom==="center"?a.setZoom(u+he):a.setZoomAround(this._lastMousePos,u+he))}});$t.addInitHook("addHandler","scrollWheelZoom",$n);var Pi=600;$t.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var Di=Pn.extend({addHooks:function(){wt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var u=a.touches[0];this._startPos=this._newPos=new q(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(wt(document,"touchend",qt),wt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Pi),wt(document,"touchend touchcancel contextmenu",this._cancel,this),wt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Ut(document,"touchend",qt),Ut(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(a){var u=a.touches[0];this._newPos=new q(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,u){var v=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});v._simulated=!0,u.target.dispatchEvent(v)}});$t.addInitHook("addHandler","tapHold",Di),$t.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var Pl=Pn.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),wt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var u=this._map;if(!(!a.touches||a.touches.length!==2||u._animatingZoom||this._zooming)){var v=u.mouseEventToContainerPoint(a.touches[0]),I=u.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(v.add(I)._divideBy(2))),this._startDist=v.distanceTo(I),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),wt(document,"touchmove",this._onTouchMove,this),wt(document,"touchend touchcancel",this._onTouchEnd,this),qt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var u=this._map,v=u.mouseEventToContainerPoint(a.touches[0]),I=u.mouseEventToContainerPoint(a.touches[1]),N=v.distanceTo(I)/this._startDist;if(this._zoom=u.getScaleZoom(N,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&N<1||this._zoom>u.getMaxZoom()&&N>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var W=v._add(I)._divideBy(2)._subtract(this._centerPoint);if(N===1&&W.x===0&&W.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var he=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(he,this,!0),qt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});$t.addInitHook("addHandler","touchZoom",Pl),$t.BoxZoom=we,$t.DoubleClickZoom=at,$t.Drag=xt,$t.Keyboard=jt,$t.ScrollWheelZoom=$n,$t.TapHold=Di,$t.TouchZoom=Pl,n.Bounds=ue,n.Browser=Qe,n.CRS=z,n.Canvas=br,n.Circle=gr,n.CircleMarker=Mi,n.Class=Q,n.Control=En,n.DivIcon=xc,n.DivOverlay=Zo,n.DomEvent=pl,n.DomUtil=ur,n.Draggable=Po,n.Evented=ae,n.FeatureGroup=pn,n.GeoJSON=ds,n.GridLayer=Ai,n.Handler=Pn,n.Icon=un,n.ImageOverlay=Tl,n.LatLng=Re,n.LatLngBounds=$e,n.Layer=tn,n.LayerGroup=on,n.LineUtil=cs,n.Map=$t,n.Marker=_l,n.Mixin=$i,n.Path=Fs,n.Point=q,n.PolyUtil=Ba,n.Polygon=Ga,n.Polyline=us,n.Popup=Ml,n.PosAnimation=Si,n.Projection=ot,n.Rectangle=se,n.Renderer=fs,n.SVG=Wa,n.SVGOverlay=Sc,n.TileLayer=ja,n.Tooltip=Al,n.Transformation=Ae,n.Util=Z,n.VideoOverlay=Lc,n.bind=l,n.bounds=_e,n.canvas=Mc,n.circle=cd,n.circleMarker=rd,n.control=is,n.divIcon=$c,n.extend=o,n.featureGroup=At,n.geoJSON=$l,n.geoJson=kr,n.gridLayer=md,n.icon=vr,n.imageOverlay=hd,n.latLng=be,n.latLngBounds=De,n.layerGroup=bn,n.map=vl,n.marker=_c,n.point=te,n.polygon=dd,n.polyline=ud,n.popup=vd,n.rectangle=ce,n.setOptions=x,n.stamp=d,n.svg=V,n.svgOverlay=pd,n.tileLayer=El,n.tooltip=Ic,n.transformation=G,n.version=s,n.videoOverlay=fd;var Za=window.L;n.noConflict=function(){return window.L=Za,this},window.L=n}))})(Tr,Tr.exports)),Tr.exports}var k2=y2();const Jt=t1(k2);(function(e,t,n){function s(o,i){for(;(o=o.parentElement)&&!o.classList.contains(i););return o}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(o,i){this._map=o,this._container=o._container,this._overlayPane=o._panes.overlayPane,this._popupPane=o._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(L.DomUtil.disableTextSelection(),o.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(o){L.setOptions(this,o)},_fireCreatedEvent:function(o){this._map.fire(L.Draw.Event.CREATED,{layer:o,layerType:this.type})},_cancelDrawing:function(o){o.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(o,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var o=this._markers.pop(),i=this._poly,l=i.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(o),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(c,!1)}},addVertex:function(o){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(o))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(o)),this._poly.addLatLng(o),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(o,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var o=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(o[o.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(o.originalEvent)},_vertexChanged:function(o,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(o,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(o){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(o),this._clickHandled=!0,this._disableNewMarkers();var i=o.originalEvent,l=i.clientX,c=i.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(o,i){this._mouseDownOrigin=L.point(o,i)},_onMouseUp:function(o){var i=o.originalEvent,l=i.clientX,c=i.clientY;this._endPoint.call(this,l,c,o),this._clickHandled=null},_endPoint:function(o,i,l){if(this._mouseDownOrigin){var c=L.point(o,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(o){var i,l,c=o.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,o),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(o){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=c.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_createMarker:function(o){var i=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(o){var i=this._markers?this._markers.length:0;i>0&&(o=o||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),o))},_updateTooltip:function(o){var i=this._getTooltipText();o&&this._tooltip.updatePosition(o),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(o,i){var l,c,d,h=Math.floor(Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=h>m?h-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)l=y/h,c={x:Math.floor(o.x*(1-l)+l*i.x),y:Math.floor(o.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(o){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=o},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var o,i,l=this.options.showLength;return this._markers.length===0?o={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",o=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),o},_updateRunningMeasure:function(o,i){var l,c,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),c=L.GeometryUtil.isVersion07x()?o.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(o,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(i?1:-1))},_getMeasurementString:function(){var o,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return o=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(o,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var o=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(o,i){L.Draw.Polyline.prototype.initialize.call(this,o,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var o=this._markers.length;o===1&&this._markers[0].on("click",this._finishShape,this),o>2&&(this._markers[o-1].on("dblclick",this._finishShape,this),o>3&&this._markers[o-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var o,i;return this._markers.length===0?o=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(o=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(o=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:o,subtext:i}},_getMeasurementString:function(){var o=this._area,i="";return o||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),o&&(i+="<br>"+L.GeometryUtil.readableArea(o,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(o,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,o,i)},_cleanUpShape:function(){var o=this._markers.length;o>0&&(this._markers[0].off("click",this._finishShape,this),o>2&&this._markers[o-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(o,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(o){this._isDrawing=!0,this._startLatLng=o.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(o.originalEvent)},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(o,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(o){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!s(o.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(o){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,o)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,o),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_getTooltipText:function(){var o,i,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(o),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(o){return new L.Marker(o,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(o){this._onMouseMove(o),this._onClick()},_fireCreatedEvent:function(){var o=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},_fireCreatedEvent:function(){var o=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)},_createMarker:function(o){return new L.CircleMarker(o,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(o,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},_drawShape:function(o){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(o);else var i=this._map.distance(this._startLatLng,o);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_onMouseMove:function(o){var i,l=o.latlng,c=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";c&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(o,i){this._marker=o,L.setOptions(this,i)},addHooks:function(){var o=this._marker;o.dragging.enable(),o.on("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},removeHooks:function(){var o=this._marker;o.dragging.disable(),o.off("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},_onDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var o=this._marker._icon;o&&(o.style.display="none",L.DomUtil.hasClass(o,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,-4)):(L.DomUtil.addClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,4)),o.style.display="")},_offsetMarker:function(o,i){var l=parseInt(o.style.marginTop,10)-i,c=parseInt(o.style.marginLeft,10)-i;o.style.marginTop=l+"px",o.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(o){this.latlngs=[o._latlngs],o._holes&&(this.latlngs=this.latlngs.concat(o._holes)),this._poly=o,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(o){for(var i=0;i<this._verticesHandlers.length;i++)o(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(o){o.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(o){o.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(o){o.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var o=0;o<this.latlngs.length;o++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[o],this._poly.options.poly))},_updateLatLngs:function(o){this.latlngs=[o.layer._latlngs],o.layer._holes&&(this.latlngs=this.latlngs.concat(o.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(o,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=o,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var o=this._poly,i=o._path;o instanceof L.Polygon||(o.options.fill=!1,o.options.editing&&(o.options.editing.fill=!1)),i&&o.options.editing&&o.options.editing.className&&(o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var o=this._poly,i=o._path;i&&o.options.editing&&o.options.editing.className&&(o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.original),o._map&&(o._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var o,i,l,c,d=this._defaultShape();for(o=0,l=d.length;o<l;o++)c=this._createMarker(d[o],o),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var h,f;for(o=0,i=l-1;o<l;i=o++)(o!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[o],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:this.options.icon});return l._origLatLng=o,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var o=this._defaultShape(),i=[].splice.apply(o,arguments);return this._poly._convertLatLngs(o,!0),this._poly.redraw(),i},_removeMarker:function(o){var i=o._index;this._markerGroup.removeLayer(o),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(o){var i=o.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,c),i.setLatLng(c);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(o){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=o.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(o){var i=o.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),c=o.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(o,i){this._markerGroup.eachLayer(function(l){l._index>o&&(l._index+=i)})},_createMiddleMarker:function(o,i){var l,c,d,h=this._getMiddleLatLng(o,i),f=this._createMarker(h);f.setOpacity(.6),o._middleRight=i._middleLeft=f,c=function(){f.off("touchmove",c,this);var m=i._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,h),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),i._index++,this._updatePrevNext(o,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",c,this),f.off("dragend",d,this),f.off("touchmove",c,this),this._createMiddleMarker(o,f),this._createMiddleMarker(f,i)},l=function(){c.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",c,this).on("dragend",d,this).on("touchmove",c,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(o,i){o&&(o._next=i),i&&(i._prev=o)},_getMiddleLatLng:function(o,i){var l=this._poly._map,c=l.project(o.getLatLng()),d=l.project(i.getLatLng());return l.unproject(c._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(o,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=o,L.Util.setOptions(this,i)},addHooks:function(){var o=this._shape;this._shape._map&&(this._map=this._shape._map,o.setStyle(o.options.editing),o._map&&(this._map=o._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var o=this._shape;if(o.setStyle(o.options.original),o._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(o){o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(o){o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(o){o.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(o){var i=o.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(o){o.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(o){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o),typeof this._getCorners=="function"){var i=this._getCorners(),l=o.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return o.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(o){o.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds(),i=o.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var o=this._getCorners();this._resizeMarkers=[];for(var i=0,l=o.length;i<l;i++)this._resizeMarkers.push(this._createMarker(o[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(o){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o);var i=this._getCorners(),l=o.target,c=l._cornerIndex;this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(o){var i,l,c=o.target;c===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,o)},_move:function(o){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),d=c.getCenter(),h=[],f=0,m=l.length;f<m;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([o.lat+i[0],o.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(o){var i;this._shape.setBounds(L.latLngBounds(o,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var o=this._shape.getBounds();return[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()]},_toggleCornerMarkers:function(o){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(o)},_repositionCornerMarkers:function(){for(var o=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(o[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getLatLng();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(o){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(o);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(o),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var o=this._shape.getLatLng(),i=this._getResizeMarkerPoint(o);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(o){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(o);return this._map.unproject([l.x+i,l.y-i])},_resize:function(o){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(o):radius=this._map.distance(i,o),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(o,i){var l={};if(o.touches!==void 0){if(!o.touches.length)return;l=o.touches[0]}else if(o.pointerType!=="touch"||(l=o,!this._filterClick(o)))return;var c=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:o})},_filterClick:function(o){var i=o.timeStamp||o.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||o.target._simulatedClick&&!o._simulated?(L.DomEvent.stop(o),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(o){this._map._loaded&&this._touchEvent(o,"touchstart")},_onTouchEnd:function(o){this._map._loaded&&this._touchEvent(o,"touchend")},_onTouchCancel:function(o){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(o,i)}},_onTouchLeave:function(o){this._map._loaded&&this._touchEvent(o,"touchleave")},_onTouchMove:function(o){this._map._loaded&&this._touchEvent(o,"touchmove")},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var o=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(o,"leaflet-clickable"),L.DomEvent.on(o,"click",this._onMouseClick,this),L.DomEvent.on(o,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(o,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(o){for(var i=[],l=0,c=o.length;l<c;l++)Array.isArray(o[l])?i.push(L.LatLngUtil.cloneLatLngs(o[l])):i.push(this.cloneLatLng(o[l]));return i},cloneLatLng:function(o){return L.latLng(o.lat,o.lng)}},(function(){var o={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,c,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=i[m],c=i[(m+1)%d],h+=(c.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(c.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var c=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,m=h&&h.decimal;if(f||m){var y=c.split(".");c=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(c=c+m+y[1])}return c},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},o,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,c,d,m){var f,m=L.Util.extend({},o,m);switch(l?typeof l=="string"?l:"metric":c?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(i,m.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,m.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,m.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(i,m.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(o,i,l,c){return this._checkCounterclockwise(o,l,c)!==this._checkCounterclockwise(i,l,c)&&this._checkCounterclockwise(o,i,l)!==this._checkCounterclockwise(o,i,c)},_checkCounterclockwise:function(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}}),L.Polyline.include({intersects:function(){var o,i,l,c=this._getProjectedPoints(),d=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(o=d-1;o>=3;o--)if(i=c[o-1],l=c[o],this._lineSegmentsIntersectsRange(i,l,o-2))return!0;return!1},newLatLngIntersects:function(o,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(o),i)},newPointIntersects:function(o,i){var l=this._getProjectedPoints(),c=l?l.length:0,d=l?l[c-1]:null,h=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,o,h,i?1:0)},_tooFewPointsForIntersection:function(o){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=o||0,!i||l<=3},_lineSegmentsIntersectsRange:function(o,i,l,c){var d,h,f=this._getProjectedPoints();c=c||0;for(var m=l;m>c;m--)if(d=f[m-1],h=f[m],L.LineUtil.segmentsIntersect(o,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var o=[],i=this._defaultShape(),l=0;l<i.length;l++)o.push(this._map.latLngToLayerPoint(i[l]));return o}}),L.Polygon.include({intersects:function(){var o,i,l,c,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(o=d.length,i=d[0],l=d[o-1],c=o-2,this._lineSegmentsIntersectsRange(l,i,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(o){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,o);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(o){var i,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(o))&&(c||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(i));return l},onRemove:function(){for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&this._toolbars[o].removeToolbar()},setDrawingOptions:function(o){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(o)},_toolbarEnabled:function(o){var i=o.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(o){L.setOptions(this,o),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(o){var i,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,d=this._toolbarClass||"",h=this.getModeHandlers(o);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=o,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,c++,d,h[i].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var o in this._modes)this._modes.hasOwnProperty(o)&&(this._disposeButton(this._modes[o].button,this._modes[o].handler.enable,this._modes[o].handler),this._modes[o].handler.disable(),this._modes[o].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(o,i,l,c,d){var h=o.type;this._modes[h]={},this._modes[h].handler=o,this._modes[h].button=this._createButton({type:h,title:d,className:c+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(o){var i=L.DomUtil.create("a",o.className||"",o.container),l=L.DomUtil.create("span","sr-only",o.container);i.href="#",i.appendChild(l),o.title&&(i.title=o.title,l.innerHTML=o.title),o.text&&(i.innerHTML=o.text,l.innerHTML=o.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,c,o.callback,o.context),i},_disposeButton:function(o,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(o,"click",L.DomEvent.stopPropagation).off(o,"mousedown",L.DomEvent.stopPropagation).off(o,"dblclick",L.DomEvent.stopPropagation).off(o,"touchstart",L.DomEvent.stopPropagation).off(o,"click",L.DomEvent.preventDefault).off(o,l,i)},_handlerActivated:function(o){this.disable(),this._activeMode=this._modes[o.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(o){var i,l,c,d,h=this._actionsContainer,f=this.getActions(o),m=f.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var o=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",o===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),o===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(o){this._map=o,this._popupPane=o._panes.popupPane,this._visible=!1,this._container=o.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(o){return this._container?(o.subtext=o.subtext||"",o.subtext.length!==0||this._singleLineLabel?o.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(o.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+o.subtext+"</span><br />":"")+"<span>"+o.text+"</span>",o.text||o.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(o){var i=this._map.latLngToLayerPoint(o),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(o){for(var i in this.options)this.options.hasOwnProperty(i)&&o[i]&&(o[i]=L.extend({},this.options[i],o[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,o)},getModeHandlers:function(o){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(o,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(o,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(o,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(o,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(o,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(o,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(o){return[{enabled:o.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:o.completeShape,context:o},{enabled:o.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:o.deleteLastVertex,context:o},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(o){L.setOptions(this,o);for(var i in this._modes)this._modes.hasOwnProperty(i)&&o.hasOwnProperty(i)&&this._modes[i].handler.setOptions(o[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(o){o.edit&&(o.edit.selectedPathOptions===void 0&&(o.edit.selectedPathOptions=this.options.edit.selectedPathOptions),o.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,o.edit.selectedPathOptions)),o.remove&&(o.remove=L.extend({},this.options.remove,o.remove)),o.poly&&(o.poly=L.extend({},this.options.poly,o.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,o),this._selectedFeatureCount=0},getModeHandlers:function(o){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(o,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(o,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(o){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return o.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(o){var i=L.Toolbar.prototype.addToolbar.call(this,o);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var o,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(o=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(o=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),o._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(o){this._revertLayer(o)},this)},save:function(){var o=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(o.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:o})},_backupLayer:function(o){var i=L.Util.stamp(o);this._uneditedLayerProps[i]||(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(o.getLatLngs())}:o instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng()),radius:o.getRadius()}:(o instanceof L.Marker||o instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(o){var i=L.Util.stamp(o);o.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?o.setLatLngs(this._uneditedLayerProps[i].latlngs):o instanceof L.Circle?(o.setLatLng(this._uneditedLayerProps[i].latlng),o.setRadius(this._uneditedLayerProps[i].radius)):(o instanceof L.Marker||o instanceof L.CircleMarker)&&o.setLatLng(this._uneditedLayerProps[i].latlng),o.fire("revert-edited",{layer:o}))},_enableLayerEdit:function(o){var i,l,c=o.layer||o.target||o;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=c.options.color,i.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=i),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(o){var i=o.layer||o.target||o;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_onMarkerDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(o){var i=o.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(l);o.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(o){this._deletableLayers.addLayer(o),o.fire("revert-deleted",{layer:o})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(o){this._removeLayer({layer:o})},this),this.save()},_enableLayerDelete:function(o){(o.layer||o.target||o).on("click",this._removeLayer,this)},_disableLayerDelete:function(o){var i=o.layer||o.target||o;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(o){var i=o.layer||o.target||o;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const n1=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Sv=e=>e.length*6+12,zd=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),b2=(e,t)=>{if(!e||t.length===0)return new Set;const n=[],s=e.getBounds();t.forEach(l=>{if(s.contains(l.getLatLng())){const c=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&n.push({marker:l,pixelPos:c,location:d})}});const o=n.map(({marker:l,pixelPos:c,location:d})=>{const m=Sv(d.name),y=d.description?Sv(`${d.name}: ${n1(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:c.x-15,right:c.x+15,top:c.y-15,bottom:c.y+15},baseLabelBox:{left:c.x-m/2,right:c.x+m/2,top:c.y+15+2,bottom:c.y+15+2+20},descLabelBox:d.description?{left:c.x-y/2,right:c.x+y/2,top:c.y+15+2,bottom:c.y+15+2+20}:null}}),i=new Set;return o.forEach(({marker:l,location:c,markerBox:d,baseLabelBox:h,descLabelBox:f},m)=>{if(!c.description)return;let y=!1;for(let k=0;k<o.length;k++){if(m===k)continue;const w=o[k];if(zd(f,w.markerBox)||zd(f,w.baseLabelBox)){y=!0;break}if(w.descLabelBox&&i.has(w.location.id)&&zd(f,w.descLabelBox)){y=!0;break}}y||i.add(c.id)}),i},Uc=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],w2=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Su=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function Qi(e){return Su.find(t=>t.value===e)||Su[0]}function _2(e){return Qi(e).defaultColor||"#667eea"}function C2(e,t){return t||_2(e)}const Kh={dot:(e,t=32)=>{const n=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const n=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const n=t/2,s=4,o=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s} ${l},${o} ${i},${o}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s-o} ${n+o},${s} ${n},${s+o} ${n-o},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-3,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${n+o*Math.cos(d)},${s+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${n+i*Math.cos(h)},${s+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<6;l++){const c=Math.PI/6+l*Math.PI/3;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<5;l++){const c=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Iv={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Gl={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=13,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${16+o*Math.cos(d)},${16+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},xv={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function zn({type:e,backgroundShape:t="circle",backgroundColor:n,borderColor:s,iconColor:o,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(n||s||o||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const c=Qi(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(c.isShapeOnly){const m=n||c.defaultColor||"#667eea",y=s||"#fff";if(Gl[e])f=Gl[e]({backgroundColor:m,borderColor:y});else return Kh[e]?.(m,h)||null}else{const m=n||"#667eea",y=s||"#fff",k=o||"#fff",w=t||"circle";w!=="none"&&Gl[w]&&(f+=Gl[w]({backgroundColor:m,borderColor:y})),xv[e]&&(f+=xv[e](k,m))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const L2={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function S2(e,t){return e===0?"missing":e>=t?"full":"partial"}function Yh(e,t){const n=S2(e,t);return L2[n]}function I2(e,t,n=32){if(e==="default")return null;if(Iv[e])return Iv[e](n);if(Kh[e]){const s=t||"#667eea";return Kh[e](s,n)}return null}const x2=["circle","square","hexagon","pentagon"];function $2(e){return x2.includes(e)}function T2(e,t,n,s,o=32,i=!0){const l=I2(e,t,o),c=Yh(n,s);if(!l)return null;const d=i&&$2(e),h=C2(e,t),f=A2(h),m=o1(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=o>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${n}/${s}</div>
  `:"";return`
    <div style="position: relative; width: ${o}px; height: ${o}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${c}
      </div>
    </div>
  `}function M2(e){const t=e.replace("#",""),n=parseInt(t.substr(0,2),16)/255,s=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function o1(e){return!e||e.length<6?!1:M2(e)>.4}function A2(e){return o1(e)?"#1F2937":"#FFFFFF"}const E2={class:"map-container-wrapper"},P2="#667eea",D2={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null);let l=null;const c=D([]),d=D([]),h=D([]);let f=null,m=null;const y=D([]);let k=null,w=null,x=!1;const A=D(!1),E=()=>{if(l){const Oe=l.getCenter();return{lat:Oe.lat,lng:Oe.lng}}return null},_=()=>l?l.getZoom():null,C=()=>{if(c.value.length>0){h.value.push([...c.value]);const Oe=d.value.pop()||[];c.value=Oe,Ce(),o("polygon-drawing",c.value)}},S=()=>{if(h.value.length>0){d.value.push([...c.value]);const Oe=h.value.pop();c.value=Oe,Ce(),o("polygon-drawing",c.value)}},$=()=>c.value.length>0,R=()=>h.value.length>0,T=()=>c.value.length,O=()=>{c.value.length>=3&&(o("polygon-complete",[...c.value]),M())},M=()=>{c.value=[],d.value=[],h.value=[],Ce()},U=()=>{!l||!s.userLocation||(l.setView([s.userLocation.lat,s.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),A.value=!0)},F=(Oe,xe,me=null)=>{if(!l||Oe==null||xe==null)return;l.setView([Oe,xe],me??l.getZoom(),{animate:!0,duration:.5});const Ze=s.center&&Math.abs(s.center.lat-Oe)<1e-4&&Math.abs(s.center.lng-xe)<1e-4;A.value=!Ze},j=D(!0),Z=D(!0),Q=(Oe,xe)=>{if(!l||Oe==null||xe==null)return!0;const me=l.getBounds(),Ze=Jt.latLng(Oe,xe);return me.contains(Ze)};t({getMapCenter:E,getMapZoom:_,undoPolygonPoint:C,redoPolygonPoint:S,canUndo:$,canRedo:R,getPolygonPointCount:T,completePolygon:O,clearPolygonDrawing:M,recenterOnUserLocation:U,recenterOnLocation:F,isLocationInView:Q,userLocationInView:Z,highlightedLocationInView:j});const re=D([]);let K=null;const ae=D(!0),q=D(!1),Y=D(new Set),te=D([]);let ue=null,_e=null;const $e=H(()=>s.hideRecenterButton||!s.highlightLocationId||!A.value?!1:!j.value),De=D({}),Re=()=>{const Oe={};if(s.highlightLocationId){const xe=s.locations.find(me=>me.id===s.highlightLocationId);if(xe?.latitude&&xe?.longitude){const me=Q(xe.latitude,xe.longitude);j.value=me,Oe[s.highlightLocationId]=me,De.value=Oe;return}}if(s.highlightLocationIds&&s.highlightLocationIds.length>0){let xe=!0;for(const me of s.highlightLocationIds){const Ze=s.locations.find(qe=>qe.id===me);if(Ze?.latitude&&Ze?.longitude){const qe=Q(Ze.latitude,Ze.longitude);Oe[me]=qe,qe||(xe=!1)}else Oe[me]=!0}j.value=xe,De.value=Oe;return}if(!l){j.value=!0,De.value={};return}j.value=!0,De.value={}},be=()=>{if(!l||!s.userLocation){Z.value=!0;return}Z.value=Q(s.userLocation.lat,s.userLocation.lng)},z=()=>{Re(),be(),o("visibility-change",{userLocationInView:Z.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:De.value})},J=()=>{if(!l||!s.highlightLocationId)return;const Oe=s.locations.find(xe=>xe.id===s.highlightLocationId);!Oe||!Oe.latitude||!Oe.longitude||(l.setView([Oe.latitude,Oe.longitude],l.getZoom(),{animate:!0,duration:.5}),A.value=!1,j.value=!0)},de=(Oe,xe,me,Ze,qe=!1)=>{const fe=me?"36px":Ze?"20px":"30px",ke=me?"#667eea":"white",ne=qe?"":Yh(Oe,xe);return`
    <div style="position: relative; width: ${fe}; height: ${fe};">
      <div style="
        background-color: ${P2};
        width: ${fe};
        height: ${fe};
        border-radius: 50%;
        border: 3px solid ${ke};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${qe?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ne}
      </div>`}
    </div>
  `},ie=()=>{if(!l)return;const Oe=b2(l,re.value),xe=Array.from(Y.value).sort().join(","),me=Array.from(Oe).sort().join(",");xe!==me&&(Y.value=Oe,Ne())},Ae=()=>{if(_e&&(_e.remove(),_e=null),!l||!s.userLocation)return;const Oe=Jt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});_e=Jt.marker([s.userLocation.lat,s.userLocation.lng],{icon:Oe}).addTo(l).bindPopup("Your location")},G=()=>{if(!i.value)return;let Oe=51.505,xe=-.09,me=13;const Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,qe=(ke,ne)=>ke!=null&&ne!=null&&!(ke===0&&ne===0),fe=[];Ze.length>0&&fe.push(...Ze.filter(ke=>qe(ke.latitude,ke.longitude)).map(ke=>({lat:ke.latitude,lng:ke.longitude}))),s.route&&s.route.length>0&&fe.push(...s.route.filter(ke=>qe(ke.lat,ke.lng)).map(ke=>({lat:ke.lat,lng:ke.lng}))),s.center?(Oe=s.center.lat,xe=s.center.lng,me=s.zoom??13):fe.length>0&&(Oe=fe.reduce((ke,ne)=>ke+ne.lat,0)/fe.length,xe=fe.reduce((ke,ne)=>ke+ne.lng,0)/fe.length,me=10),l=Jt.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([Oe,xe],me),Jt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),s.clickable&&l.on("click",ke=>{s.drawingMode||o("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}),l.on("zoomstart",()=>{ge=!0}),l.on("zoomend moveend",()=>{ge=!1,oe?Ne():ie(),z()}),l.on("dragstart",()=>{A.value=!0}),Ne(),X(),ee(),Ae(),Ee(),Fe(),l.whenReady(()=>{z()})},X=()=>{if(K&&(K.remove(),K=null),!l||s.route.length===0)return;const Oe=s.route.map(fe=>[fe.lat,fe.lng]),xe=s.routeColor||"#3388ff",me=s.routeWeight||4;let Ze=null,qe="butt";switch(s.routeStyle){case"dash":Ze="10, 10";break;case"dash-long":Ze="20, 12";break;case"dash-short":Ze="6, 6";break;case"dash-dense":Ze="6, 3";break;case"dot":Ze="2, 8",qe="round";break;case"dot-sparse":Ze="2, 14",qe="round";break;case"dot-dense":Ze="2, 2",qe="round";break;case"dash-dot":Ze="16, 8, 4, 8";break;case"dash-dot-dot":Ze="16, 6, 4, 6, 4, 6";break;case"long-short":Ze="16, 4, 6, 4";break;case"double-dash":Ze="8, 3, 8, 8";break}K=Jt.polyline(Oe,{color:xe,weight:me,opacity:.7,dashArray:Ze,lineCap:qe}).addTo(l)},ee=()=>{te.value.forEach(Oe=>Oe.remove()),te.value=[],!(!l||s.areas.length===0)&&s.areas.forEach(Oe=>{const xe=typeof Oe.polygon=="string"?JSON.parse(Oe.polygon):Oe.polygon;if(!xe||xe.length===0)return;const me=xe.map(ke=>[ke.lat,ke.lng]),Ze=Oe.id===s.selectedAreaId,qe=Oe.color||"#667eea",fe=Jt.polygon(me,{color:qe,fillColor:qe,fillOpacity:Ze?.4:.2,weight:Ze?3:2,opacity:.8}).addTo(l);fe.setStyle({pane:"overlayPane"}),s.drawingMode||(fe.on("click",()=>o("area-click",Oe)),fe.on("mouseover",()=>{fe.setStyle({fillOpacity:.4})}),fe.on("mouseout",()=>{fe.setStyle({fillOpacity:Ze?.4:.2})})),te.value.push(fe)})},Ce=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),c.value.length!==0&&(m=Jt.layerGroup().addTo(l),c.value.forEach((Oe,xe)=>{const me=xe===0,Ze=xe===c.value.length-1,qe=Jt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${me?"16px":"12px"};
        height: ${me?"16px":"12px"};
        background-color: ${me?"#667eea":Ze?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[me?16:12,me?16:12],iconAnchor:[me?8:6,me?8:6]});Jt.marker([Oe.lat,Oe.lng],{icon:qe,interactive:!1}).addTo(m)}),c.value.length>=2))){const Oe=c.value.map(xe=>[xe.lat,xe.lng]);c.value.length>=3&&Oe.push(Oe[0]),f=Jt.polyline(Oe,{color:"#667eea",weight:3,opacity:.8,dashArray:c.value.length<3?"10, 10":null}).addTo(l)}},Be=()=>{if(!l||(k&&(k.remove(),k=null),w&&(w.remove(),w=null),y.value.length===0))return;const Oe=y.value.map(me=>[me.lat,me.lng]);k=Jt.polygon(Oe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),w=Jt.layerGroup({pane:"markerPane"}).addTo(l);const xe=me=>{y.value.length<=3||(y.value.splice(me,1),x=!0,o("polygon-update",[...y.value]),Be())};y.value.forEach((me,Ze)=>{const qe=y.value.length>3,fe=Jt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),ke=Jt.marker([me.lat,me.lng],{icon:fe,draggable:!0}).addTo(w);if(ke.on("drag",ne=>{const ye=ne.target.getLatLng();y.value[Ze]={lat:ye.lat,lng:ye.lng};const He=y.value.map(ct=>[ct.lat,ct.lng]);k.setLatLngs(He)}),ke.on("dragend",()=>{x=!0,o("polygon-update",[...y.value])}),ke.on("contextmenu",ne=>{Jt.DomEvent.preventDefault(ne),qe&&xe(Ze)}),qe){const ne=document.createElement("div"),ye=document.createElement("button");ye.textContent="Delete point",ye.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const He=ct=>{ct.preventDefault(),ct.stopPropagation(),ke.closePopup(),xe(Ze)};ye.addEventListener("click",He),ye.addEventListener("touchend",He),ne.appendChild(ye),ke.bindPopup(ne,{closeButton:!1,className:"vertex-popup"})}})},Fe=(Oe=!0)=>{if(l){if(!s.editingPolygon||s.editingPolygon.length===0){k&&(k.remove(),k=null),w&&(w.remove(),w=null),y.value=[];return}if(y.value=s.editingPolygon.map(xe=>({lat:xe.lat,lng:xe.lng})),Be(),Oe&&y.value.length>=3){const xe=Jt.latLngBounds(y.value.map(me=>[me.lat,me.lng]));l.fitBounds(xe,{padding:[50,50]})}}},Ee=()=>{if(!l)return;if(ue||(ue=new Jt.FeatureGroup,l.addLayer(ue)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!s.drawingMode){M(),ue&&ue.clearLayers();return}let Oe=0,xe=null,me=!1,Ze=!1;const qe=300,fe=15,ke=ht=>{d.value.push([...c.value]),h.value=[],c.value.push({lat:ht.lat,lng:ht.lng}),Ce(),o("polygon-drawing",c.value)},ne=ht=>{ht.originalEvent&&ht.originalEvent.sourceCapabilities?.firesTouchEvents||ke(ht.latlng)},ye=ht=>{if(ht.touches.length>1){Ze=!0;return}Ze=!1,Oe=Date.now(),xe={x:ht.touches[0].clientX,y:ht.touches[0].clientY},me=!1},He=ht=>{if(!xe||Ze)return;const Nt=ht.touches[0].clientX-xe.x,Lt=ht.touches[0].clientY-xe.y;Math.sqrt(Nt*Nt+Lt*Lt)>fe&&(me=!0)},ct=ht=>{if(Ze){Ze=!1,xe=null;return}if(Date.now()-Oe<qe&&!me&&xe){const Lt=ht.changedTouches[0],Bt=Jt.point(Lt.clientX-l.getContainer().getBoundingClientRect().left,Lt.clientY-l.getContainer().getBoundingClientRect().top),Et=l.containerPointToLatLng(Bt);ht.preventDefault(),ht.stopPropagation(),ke(Et)}xe=null,me=!1};l.on("click",ne),l.getContainer().addEventListener("touchstart",ye,{passive:!0}),l.getContainer().addEventListener("touchmove",He,{passive:!0}),l.getContainer().addEventListener("touchend",ct,{passive:!1}),l._customDrawingHandlers={handleClick:ne,handleTouchStart:ye,handleTouchMove:He,handleTouchEnd:ct},Ce()};let oe=!1,ge=!1;const Ne=()=>{if(l&&(l._animatingZoom||ge)){oe=!0;return}if(oe=!1,re.value.forEach(me=>{me._map&&(me.off(),me.remove())}),re.value=[],!l)return;const Oe=i.value?.clientWidth||400,xe=Math.floor(Oe*.75);if(s.locations.forEach(me=>{const Ze=me.latitude??me.Latitude,qe=me.longitude??me.Longitude;if(Ze==null||qe==null||Ze===0&&qe===0)return;const fe=me.checkedInCount||0,ke=me.requiredMarshals||1,ne=s.highlightLocationId===me.id||s.highlightLocationIds.includes(me.id),ye=me.isDynamic||me.IsDynamic,He=s.simplifyNonHighlighted&&!ne&&!ye,ct=me.resolvedStyleType||me.ResolvedStyleType,ht=me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor,Nt=me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor,Lt=me.resolvedStyleIconColor||me.ResolvedStyleIconColor,Bt=me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape,Et=ct&&ct!=="default"||ht||Nt||Lt||Bt&&Bt!=="circle"&&Bt!=="default",yo=me.resolvedStyleMapRotation??me.ResolvedStyleMapRotation??me.styleMapRotation??me.StyleMapRotation??0,ko=parseInt(yo,10)||0,ft=me.areaColor||"#999",Pt=me.areaId&&!s.marshalMode,An=Y.value.has(me.id)&&me.description?`${me.name}: ${n1(me.description,50)}`:me.name,Ao=ne?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",ao=ne?"#667eea":He?"#e0e0e0":"white",bo=ne?"white":He?"#888":"#333";let Gt;if(He){const Qe="20px";Gt=`
        <div style="
          background-color: #999;
          width: ${Qe};
          height: ${Qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const As=!s.marshalMode,wo=Yh(fe,ke),zo=As?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${fe}/${ke}</div>`:"";if(!He&&Et){const Qe=ne?40:32,Ft=me.resolvedStyleSize||me.ResolvedStyleSize||"100",an=zn({type:me.resolvedStyleType||me.ResolvedStyleType,backgroundShape:me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape||"circle",backgroundColor:me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor||"",borderColor:me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor||"",iconColor:me.resolvedStyleIconColor||me.ResolvedStyleIconColor||"",size:Ft});an?Gt=an:Gt=T2(me.resolvedStyleType,me.resolvedStyleColor,fe,ke,Qe,As)||de(fe,ke,ne,s.marshalMode,!0)}else He||(Gt=de(fe,ke,ne,s.marshalMode,!0));const pe=ko!==0?`transform: rotate(${ko}deg);`:"",ve=Jt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ao}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Pt?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ft};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${pe}">
                ${Gt}
              </div>
              ${He||s.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${wo}
              </div>`}
              ${He?"":zo}
            </div>
          </div>
          <div style="
            background-color: ${ao};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ne?"12px":"11px"};
            font-weight: bold;
            color: ${bo};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${xe}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${An}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Ie=s.marshalMode?`<b>${me.name}</b>${me.description?`<br>${me.description}`:""}`:`<b>${me.name}</b><br>${me.description||""}<br>Checked in: ${fe}/${ke}`,lt=Jt.marker([me.latitude,me.longitude],{icon:ve}).addTo(l).bindPopup(Ie);lt.on("click",()=>{o("location-click",me)}),lt.locationData=me,re.value.push(lt)}),l&&ae.value&&!s.center&&!q.value){const me=[],Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,qe=(fe,ke)=>fe!=null&&ke!=null&&!(fe===0&&ke===0);if(Ze.length>0&&me.push(...Ze.filter(fe=>qe(fe.latitude,fe.longitude)).map(fe=>[fe.latitude,fe.longitude])),s.route.length>0&&me.push(...s.route.filter(fe=>qe(fe.lat,fe.lng)).map(fe=>[fe.lat,fe.lng])),me.length>0){const fe=Jt.latLngBounds(me);l.fitBounds(fe,{padding:[50,50]}),ae.value=!1,q.value=!0}}else s.center&&(ae.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&ie()},100)};return cn(()=>{q.value=!1,ae.value=!0,G();let Oe,xe=0,me=0;const Ze=new ResizeObserver(qe=>{if(l&&qe.length>0){const{width:fe,height:ke}=qe[0].contentRect;(Math.abs(fe-xe)>10||Math.abs(ke-me)>10)&&(xe=fe,me=ke,clearTimeout(Oe),Oe=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&Ze.observe(i.value),In(()=>{clearTimeout(Oe),Ze.disconnect()})}),Ye(()=>s.locations,Oe=>{if(Ne(),l&&!q.value&&Oe.length>0&&!s.center){const xe=Oe.map(fe=>fe.latitude),me=Oe.map(fe=>fe.longitude),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,qe=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,qe],10),q.value=!0,ae.value=!1}l&&setTimeout(()=>z(),50)},{deep:!0}),Ye(()=>s.route,Oe=>{if(X(),Ne(),l&&!q.value&&Oe&&Oe.length>0&&!s.center){const xe=Oe.map(fe=>fe.lat),me=Oe.map(fe=>fe.lng),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,qe=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,qe],10),q.value=!0,ae.value=!1}},{deep:!0}),Ye(()=>[s.routeColor,s.routeStyle,s.routeWeight],()=>{X()}),Ye(()=>s.center,(Oe,xe)=>{l&&!A.value&&(!xe||Math.abs(Oe.lat-xe.lat)>1e-6||Math.abs(Oe.lng-xe.lng)>1e-6)&&l.setView([Oe.lat,Oe.lng],s.zoom)}),Ye(()=>s.areas,()=>{ee()},{deep:!0}),Ye(()=>s.selectedAreaId,()=>{ee()}),Ye(()=>s.drawingMode,()=>{Ee()}),Ye(()=>s.editingPolygon,()=>{if(x){x=!1;return}Fe()},{deep:!0}),Ye(()=>s.userLocation,()=>{Ae()},{deep:!0}),Ye(()=>s.highlightLocationId,()=>{Ne()}),Ye(()=>s.highlightLocationIds,()=>{Ne(),l&&setTimeout(()=>z(),50)},{deep:!0}),Ye(()=>s.marshalMode,()=>{Ne()}),Ye(()=>s.simplifyNonHighlighted,()=>{Ne()}),Ye(()=>s.clickable,Oe=>{l&&(l.off("click"),Oe&&l.on("click",xe=>{s.drawingMode||o("map-click",{lat:xe.latlng.lat,lng:xe.latlng.lng})}))}),(Oe,xe)=>(p(),g("div",E2,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),$e.value?(p(),g("button",{key:0,class:"recenter-btn",onClick:J,title:"Recenter on checkpoint"},[...xe[0]||(xe[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):P("",!0)]))}},Jh=Ke(D2,[["__scopeId","data-v-59e540e9"]]);function Qo(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const R2={class:"areas-selection"},O2={key:0,class:"areas-selection-header"},N2={class:"areas-list"},B2=["checked","onChange"],F2={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>[...n.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Qo(d.name,h.name))),i=H(()=>n.areas.length>0&&n.selectedAreaIds.length===n.areas.length),l=d=>{const h=[...n.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),s("update:selectedAreaIds",h)},c=()=>{i.value?s("update:selectedAreaIds",[]):s("update:selectedAreaIds",n.areas.map(d=>d.id))};return(d,h)=>(p(),g("div",R2,[e.areas.length>1?(p(),g("div",O2,[r("button",{onClick:c,class:"toggle-all-btn"},b(i.value?"Deselect all":"Select all"),1)])):P("",!0),r("div",N2,[(p(!0),g(Se,null,je(o.value,f=>(p(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,B2),r("span",{class:"area-color-dot",style:tt({backgroundColor:f.color||"#667eea"})},null,4),Je(" "+b(f.name),1)]))),128))])]))}},U2=Ke(F2,[["__scopeId","data-v-ba19009b"]]),z2={key:1,class:"toolbar-btn-wrapper filters-wrapper"},H2={key:1,class:"dropdown-content filters-dropdown"},V2={class:"filters-header"},G2={class:"filter-section"},q2={class:"filter-checkbox"},j2=["checked"],W2={key:0,class:"filter-checkbox"},Z2=["checked"],K2={class:"filter-section"},Y2={class:"filter-checkbox"},J2=["checked"],X2={class:"filter-checkbox"},Q2=["checked"],eL={class:"filter-checkbox"},tL=["checked"],nL={key:0,class:"filter-section"},oL=["onClick","title"],sL={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},aL={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},iL=["innerHTML"],lL={key:0,class:"dropdown-content action-dropdown"},rL=["onClick"],cL={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:n}){const{terms:s}=dt(),o=e,i=n,l=D(!1),c=D(null),d=H(()=>c.value!==null),h=()=>{l.value=!l.value,l.value&&(c.value=null)},f=(w,x)=>{i("filter-change",{...o.filters,[w]:x})},m=w=>{w.items&&w.items.length>0?c.value===w.id?c.value=null:(c.value=w.id,l.value=!1):i("action-click",{actionId:w.id})},y=(w,x)=>{c.value=null,i("action-click",{actionId:w,itemId:x})};return t({closeDropdowns:()=>{l.value=!1,c.value=null}}),(w,x)=>(p(),g("div",{class:le(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(p(),g("button",{key:0,class:"toolbar-btn",onClick:x[0]||(x[0]=A=>w.$emit("fullscreen-click")),title:"Fullscreen"},[...x[9]||(x[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(p(),g("div",z2,[l.value?(p(),g("div",{key:0,class:"mobile-backdrop",onClick:x[1]||(x[1]=A=>l.value=!1)})):P("",!0),r("button",{class:le(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...x[10]||(x[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(p(),g("div",H2,[r("div",V2,[x[12]||(x[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:x[2]||(x[2]=A=>l.value=!1),title:"Close"},[...x[11]||(x[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",G2,[x[13]||(x[13]=r("h4",null,"Display",-1)),r("label",q2,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:x[3]||(x[3]=A=>f("showRoute",A.target.checked))},null,40,j2),r("span",null,b(B(s).course)+" line",1)]),e.areas.length>0?(p(),g("label",W2,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:x[4]||(x[4]=A=>f("showAreaOverlays",A.target.checked))},null,40,Z2),r("span",null,b(B(s).area)+" overlays",1)])):P("",!0)]),r("div",K2,[r("h4",null,b(B(s).checkpoints),1),r("label",Y2,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:x[5]||(x[5]=A=>f("showUncheckedIn",A.target.checked))},null,40,J2),x[14]||(x[14]=r("span",{class:"status-indicator unchecked"},null,-1)),x[15]||(x[15]=r("span",null,"Unchecked-in",-1))]),r("label",X2,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:x[6]||(x[6]=A=>f("showPartiallyCheckedIn",A.target.checked))},null,40,Q2),x[16]||(x[16]=r("span",{class:"status-indicator partial"},null,-1)),x[17]||(x[17]=r("span",null,"Partially checked-in",-1))]),r("label",eL,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:x[7]||(x[7]=A=>f("showFullyCheckedIn",A.target.checked))},null,40,tL),x[18]||(x[18]=r("span",{class:"status-indicator full"},null,-1)),x[19]||(x[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(p(),g("div",nL,[r("h4",null,b(B(s).areas),1),Pe(U2,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":x[8]||(x[8]=A=>f("selectedAreaIds",A))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(p(!0),g(Se,null,je(e.actions,A=>(p(),g("div",{key:A.id,class:le(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:le(["toolbar-btn",{active:c.value===A.id}]),onClick:E=>m(A),title:A.label||A.id},[A.icon==="plus"?(p(),g("svg",sL,[...x[20]||(x[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):A.icon==="edit"?(p(),g("svg",aL,[...x[21]||(x[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):A.icon==="custom"?(p(),g("span",{key:2,innerHTML:A.customIcon},null,8,iL)):P("",!0)],10,oL),A.items&&c.value===A.id?(p(),g("div",lL,[(p(!0),g(Se,null,je(A.items,E=>(p(),g("button",{key:E.id,onClick:_=>y(A.id,E.id),class:"dropdown-item"},b(E.label),9,rL))),128))])):P("",!0)],2))),128))],2))}},$v=Ke(cL,[["__scopeId","data-v-adedd545"]]),uL={key:0,class:"drawing-controls"},dL={class:"point-count"},hL={class:"undo-redo-buttons"},fL=["disabled"],pL=["disabled"],vL={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.show&&n.pointCount>0),i=l=>{if(!o.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),n.canUndo&&s("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),n.canRedo&&s("redo"))};return cn(()=>{document.addEventListener("keydown",i)}),In(()=>{document.removeEventListener("keydown",i)}),(l,c)=>o.value?(p(),g("div",uL,[r("div",dL,b(e.pointCount)+" point"+b(e.pointCount!==1?"s":""),1),r("div",hL,[r("button",{onClick:c[0]||(c[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,fL),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,pL)])])):P("",!0)}},Tv=Ke(vL,[["__scopeId","data-v-6cd009cb"]]),mL={class:"context-info"},gL={class:"action-buttons"},yL=["disabled"],kL={key:0,class:"fullscreen-map-banner"},bL={class:"fullscreen-map-container"},wL={key:1,class:"fullscreen-map-footer"},_L={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const n=e,s=H(()=>n.headerTextColor?{color:n.headerTextColor}:{}),o=t,i=()=>{o("done")},l=()=>{o("cancel")},c=()=>{o("close")},d=h=>{h.key==="Escape"&&n.show&&(n.mode==="view"?c():l())};return Ye(()=>n.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),cn(()=>{document.addEventListener("keydown",d)}),In(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(p(),Ge(ec,{to:"body"},[e.show?(p(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=rt(()=>{},["prevent","self"]))},[r("div",{class:le(["fullscreen-map-header",{compact:e.mode==="view"}]),style:tt(e.headerStyle)},[r("div",mL,[r("h3",{style:tt({color:e.headerTextColor})},b(e.title),5),e.description?(p(),g("p",{key:0,style:tt({color:e.headerTextColor,opacity:.85})},b(e.description),5)):P("",!0)]),r("div",gL,[go(h.$slots,"actions",{},void 0,!0),e.mode==="view"?(p(),g("button",{key:0,type:"button",onClick:rt(c,["stop"]),class:"btn btn-close-x",style:tt(s.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(p(),g(Se,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,yL)],64))])],6),h.$slots.banner?(p(),g("div",kL,[go(h.$slots,"banner",{},void 0,!0)])):P("",!0),r("div",bL,[go(h.$slots,"default",{},void 0,!0)]),h.$slots.footer?(p(),g("div",wL,[go(h.$slots,"footer",{},void 0,!0)])):P("",!0)],32)):P("",!0)]))}},CL=Ke(_L,[["__scopeId","data-v-a1e3e36c"]]),LL={class:"map-wrapper"},SL={class:"fullscreen-map-wrapper"},IL={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(!1),f=D(0),m=D(!1),y=D(!1),k=D({...s.filters});Ye(()=>s.filters,K=>{k.value={...K}},{deep:!0}),Ye(()=>s.areas,K=>{s.showFilters&&K.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=K.map(ae=>ae.id))},{immediate:!0});const w=H(()=>s.showFilters?s.locations.filter(K=>{const ae=K.checkedInCount||0,q=K.requiredMarshals||1,Y=ae===0,te=ae>0&&ae<q,ue=ae>=q;if(Y&&!k.value.showUncheckedIn||te&&!k.value.showPartiallyCheckedIn||ue&&!k.value.showFullyCheckedIn)return!1;const _e=K.areaIds||K.AreaIds||[];return!(s.areas.length>0&&_e.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!_e.some(De=>k.value.selectedAreaIds.includes(De))))}):s.locations),x=H(()=>s.showFilters?k.value.showRoute?s.route:[]:s.route),A=H(()=>s.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?s.areas.filter(K=>k.value.selectedAreaIds.includes(K.id)):s.areas.length>0?[]:s.areas:s.areas),E=H(()=>s.mode==="select-point"?!0:s.mode==="draw-polygon"?f.value>=3:!0),_=()=>h.value?l.value:i.value,C=()=>{h.value=!0,o("fullscreen-change",!0)},S=()=>{h.value=!1,o("fullscreen-change",!1)},$=()=>{if(s.mode==="draw-polygon"){const K=_();K&&K.clearPolygonDrawing(),f.value=0,m.value=!1,y.value=!1}h.value=!1,o("fullscreen-cancel"),o("fullscreen-change",!1)},R=()=>{if(s.mode==="draw-polygon"&&f.value>=3){const K=_();K&&K.completePolygon()}h.value=!1,o("fullscreen-done"),o("fullscreen-change",!1)},T=K=>{k.value=K,o("filter-change",K)},O=K=>{s.mode==="select-point"&&o("point-selected",K),o("map-click",K)},M=K=>{f.value=K?.length||0,j(),o("polygon-drawing",K)},U=K=>{o("polygon-complete",K),f.value=0,m.value=!1,y.value=!1},F=K=>{o("polygon-update",K)},j=()=>{const K=_();K&&(m.value=K.canUndo?K.canUndo():!1,y.value=K.canRedo?K.canRedo():!1)},Z=()=>{const K=_();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),j())},Q=()=>{const K=_();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),j())};return t({getMapCenter:()=>_()?.getMapCenter?.(),getMapZoom:()=>_()?.getMapZoom?.(),undoPolygonPoint:Z,redoPolygonPoint:Q,canUndo:()=>m.value,canRedo:()=>y.value,getPolygonPointCount:()=>f.value,completePolygon:()=>_()?.completePolygon?.(),clearPolygonDrawing:()=>{_()?.clearPolygonDrawing?.(),f.value=0,m.value=!1,y.value=!1},recenterOnUserLocation:()=>_()?.recenterOnUserLocation?.(),recenterOnLocation:(K,ae,q)=>_()?.recenterOnLocation?.(K,ae,q),isLocationInView:(K,ae)=>_()?.isLocationInView?.(K,ae)??!0,getUserLocationInView:()=>_()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>_()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,o("fullscreen-change",!0)},closeFullscreen:S,closeDropdowns:()=>{c.value&&c.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(K,ae)=>(p(),g("div",{class:"common-map",style:tt({height:e.height})},[r("div",LL,[Pe(Jh,{ref_key:"mapViewRef",ref:i,locations:w.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,areas:A.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[0]||(ae[0]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[1]||(ae[1]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:M,onPolygonUpdate:F,onVisibilityChange:ae[2]||(ae[2]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","route-weight","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe($v,{ref_key:"toolbarRef",ref:c,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:C,onFilterChange:T,onActionClick:ae[3]||(ae[3]=q=>K.$emit("action-click",q))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Pe(Tv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])]),Pe(CL,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":E.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:$,onClose:S},kf({default:Ve(()=>[r("div",SL,[Pe(Jh,{ref_key:"fullscreenMapViewRef",ref:l,locations:w.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,areas:A.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[4]||(ae[4]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[5]||(ae[5]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:M,onPolygonUpdate:F,onVisibilityChange:ae[6]||(ae[6]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe($v,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:T,onActionClick:ae[7]||(ae[7]=q=>K.$emit("action-click",q))},null,8,["show-filters","filters","areas","actions","position"]),Pe(Tv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[K.$slots["fullscreen-actions"]?{name:"actions",fn:Ve(()=>[go(K.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,K.$slots["fullscreen-banner"]?{name:"banner",fn:Ve(()=>[go(K.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,K.$slots["fullscreen-footer"]?{name:"footer",fn:Ve(()=>[go(K.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},al=Ke(IL,[["__scopeId","data-v-b4c73381"]]),Un=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],tu="#667eea";function xL(e){const t=e.map(s=>s.color);return Un.find(s=>!t.includes(s.hex))?.hex||tu}function Xh(e){const t=e.replace("#",""),n=parseInt(t.slice(0,2),16)/255,s=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Iu(e){return!e||e===""?"#ffffff":Xh(e)>.179?"#333333":"#ffffff"}function Qh(e,t){const n=e||dn.headerGradientStart,s=t||dn.headerGradientEnd,o=Xh(n),i=Xh(s);return(o+i)/2>.35?"#333333":"#ffffff"}const dn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},$L={class:"branding-color-picker"},TL={key:0,class:"picker-label"},ML={class:"color-name"},AL={key:1,class:"color-popup"},EL={class:"popup-header"},PL={class:"color-grid"},DL=["title","onClick"],RL={key:0,class:"check-mark"},OL={key:0,class:"check-mark"},NL={key:0,class:"custom-hex-input"},BL={class:"hex-input-row"},FL=["disabled"],UL={key:0,class:"hex-error"},zL={key:1,class:"contrast-preview"},HL={__name:"BrandingColorPicker",props:{modelValue:{type:String,default:""},label:{type:String,default:""},defaultColor:{type:String,default:""},showDefault:{type:Boolean,default:!0},showContrastPreview:{type:Boolean,default:!0},colors:{type:Array,default:()=>Un}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(!1),l=D(""),c=D(null),d=H(()=>n.modelValue&&n.modelValue!=="default"?n.modelValue:n.defaultColor||dn.headerGradientStart),h=H(()=>{if(!n.modelValue||n.modelValue===""||n.modelValue==="default")return"Default";const C=n.colors.find(S=>S.hex.toLowerCase()===n.modelValue.toLowerCase());return C?C.name:n.modelValue}),f=H(()=>Iu(d.value));function m(C){return n.modelValue&&n.modelValue.toLowerCase()===C.toLowerCase()}const y=H(()=>!n.modelValue||n.modelValue===""||n.modelValue==="default"?!1:!n.colors.some(C=>C.hex.toLowerCase()===n.modelValue.toLowerCase())),k=H(()=>{if(!l.value)return!1;const C=l.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(C)||/^[0-9A-Fa-f]{3}$/.test(C)});function w(){o.value=!o.value,o.value||(i.value=!1)}function x(C){i.value=!1,s("update:modelValue",C),o.value=!1}function A(){i.value=!i.value,i.value&&(y.value?l.value=n.modelValue.replace(/^#/,""):l.value="",rn(()=>{c.value?.focus()}))}function E(){l.value=l.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()}function _(){if(!k.value)return;let C=l.value;C.length===3&&(C=C[0]+C[0]+C[1]+C[1]+C[2]+C[2]),s("update:modelValue","#"+C),i.value=!1,o.value=!1}return(C,S)=>(p(),g("div",$L,[e.label?(p(),g("label",TL,b(e.label),1)):P("",!0),r("button",{type:"button",class:le(["color-button",{active:o.value}]),onClick:w},[r("span",{class:"color-swatch",style:tt({backgroundColor:d.value})},null,4),r("span",ML,b(h.value),1),S[3]||(S[3]=r("span",{class:"arrow"},"",-1))],2),o.value?(p(),g("div",AL,[r("div",EL,[r("span",null,b(e.label||"Select colour"),1),r("button",{type:"button",class:"popup-close",onClick:S[0]||(S[0]=$=>o.value=!1)},"")]),r("div",PL,[e.showDefault?(p(),g("button",{key:0,type:"button",class:le(["color-option default-option",{selected:e.modelValue===""||e.modelValue==="default"}]),onClick:S[1]||(S[1]=$=>x(""))},[...S[4]||(S[4]=[r("span",{class:"default-icon"},"",-1),r("span",null,"Default",-1)])],2)):P("",!0),(p(!0),g(Se,null,je(e.colors,$=>(p(),g("button",{key:$.hex,type:"button",class:le(["color-option",{selected:m($.hex)}]),style:tt({backgroundColor:$.hex}),title:$.name,onClick:R=>x($.hex)},[m($.hex)?(p(),g("span",RL,"")):P("",!0)],14,DL))),128)),r("button",{type:"button",class:le(["color-option custom-option",{selected:y.value}]),style:tt(y.value?{backgroundColor:e.modelValue}:{}),title:"Custom colour",onClick:A},[S[5]||(S[5]=r("svg",{class:"custom-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"})],-1)),y.value?(p(),g("span",OL,"")):P("",!0)],6)]),i.value?(p(),g("div",NL,[S[7]||(S[7]=r("label",null,"Enter hex code",-1)),r("div",BL,[S[6]||(S[6]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInput",ref:c,"onUpdate:modelValue":S[2]||(S[2]=$=>l.value=$),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:l.value&&!k.value}]),onInput:E,onKeydown:Xo(_,["enter"])},null,34),[[st,l.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:k.value?"#"+l.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!k.value,onClick:_}," Apply ",8,FL)]),l.value&&!k.value?(p(),g("span",UL," Invalid hex code ")):P("",!0)])):P("",!0),e.showContrastPreview?(p(),g("div",zL,[S[8]||(S[8]=r("span",{class:"preview-label"},"Text will appear:",-1)),r("span",{class:"preview-text",style:tt({backgroundColor:d.value,color:f.value})}," Sample Text ",4)])):P("",!0)])):P("",!0)]))}},VL=Ke(HL,[["__scopeId","data-v-713a193b"]]),GL={class:"course-areas-tab"},qL={key:0,class:"route-settings-bar"},jL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},WL=["stroke","stroke-dasharray","stroke-linecap"],ZL=["onClick"],KL={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},YL=["stroke","stroke-dasharray","stroke-linecap"],JL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},XL=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],QL=["onClick"],eS={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},tS=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],nS=["disabled"],Mv="#3388ff",oS={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map","update:routeSettings"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=e,l=n,c=D(null),d=D(null),h=D(null),f=D(null),m=D(0),y=D(!1),k=D(!1),w=D(i.routeColor),x=D(i.routeStyle),A=D(i.routeWeight);Ye(()=>i.routeColor,$e=>{w.value=$e},{immediate:!0}),Ye(()=>i.routeStyle,$e=>{x.value=$e},{immediate:!0}),Ye(()=>i.routeWeight,$e=>{A.value=$e},{immediate:!0});const E=H(()=>{const $e=w.value!==i.routeColor,De=x.value!==i.routeStyle,Re=A.value!==i.routeWeight;return $e||De||Re}),_=[{value:"line",label:"Solid"},{value:"dash",label:"Dashed"},{value:"dash-long",label:"Long dash"},{value:"dash-short",label:"Short dash"},{value:"dash-dense",label:"Dense dash"},{value:"dot",label:"Dotted"},{value:"dot-sparse",label:"Sparse dots"},{value:"dot-dense",label:"Dense dots"},{value:"dash-dot",label:"Dash-dot"},{value:"dash-dot-dot",label:"Dash-dot-dot"},{value:"long-short",label:"Long-short"},{value:"double-dash",label:"Double dash"}],C=[{value:2,label:"Thin"},{value:4,label:"Normal"},{value:6,label:"Thick"},{value:8,label:"Extra thick"}],S=H(()=>w.value||Mv),$=$e=>{const De=$e.replace("#",""),Re=parseInt(De.substr(0,2),16)/255,be=parseInt(De.substr(2,2),16)/255,z=parseInt(De.substr(4,2),16)/255,J=de=>de<=.03928?de/12.92:Math.pow((de+.055)/1.055,2.4);return .2126*J(Re)+.7152*J(be)+.0722*J(z)},R=H(()=>{const $e=S.value;return $($e)>.5?{backgroundColor:"#333",borderColor:"#555"}:{}}),T=$e=>{switch($e){case"dash":return"8, 6";case"dash-long":return"16, 8";case"dash-short":return"4, 4";case"dash-dense":return"6, 3";case"dot":return"2, 4";case"dot-sparse":return"2, 8";case"dot-dense":return"2, 2";case"dash-dot":return"12, 4, 2, 4";case"dash-dot-dot":return"12, 4, 2, 4, 2, 4";case"long-short":return"16, 4, 6, 4";case"double-dash":return"8, 3, 8, 8";default:return"none"}},O=$e=>$e==="dot"||$e==="dot-sparse"||$e==="dot-dense"?"round":"butt",M=()=>{y.value=!y.value,k.value=!1},U=()=>{k.value=!k.value,y.value=!1},F=$e=>{x.value=$e,y.value=!1},j=$e=>{A.value=$e,k.value=!1},Z=()=>{l("update:routeSettings",{routeColor:w.value,routeStyle:x.value,routeWeight:A.value})},Q=$e=>{h.value&&!h.value.contains($e.target)&&(y.value=!1),f.value&&!f.value.contains($e.target)&&(k.value=!1)};Ye([y,k],([$e,De])=>{$e||De?document.addEventListener("click",Q,!0):document.removeEventListener("click",Q,!0)}),In(()=>{document.removeEventListener("click",Q,!0)});const re=D({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),K=H(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:s.value.checkpoint},{id:"many-checkpoints",label:`Many ${o.value.checkpoints}`},{id:"area",label:s.value.area},{id:"import",label:`Import ${o.value.checkpoints}...`},{id:"upload",label:`Upload ${o.value.course}...`}]}]),ae=({actionId:$e,itemId:De})=>{$e==="add"&&(De==="checkpoint"?(l("add-checkpoint-from-map"),te()):De==="many-checkpoints"?(l("add-many-checkpoints-from-map"),te()):De==="area"?(l("add-area-from-map"),te()):De==="import"?l("import-checkpoints"):De==="upload"&&l("upload-route"))},q=$e=>{re.value=$e},Y=$e=>{m.value=$e?.length||0},te=()=>{c.value&&c.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:te,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ye(()=>i.areas,$e=>{if($e.length>0){const De=new Set(re.value.selectedAreaIds);$e.forEach(Re=>{De.has(Re.id)||re.value.selectedAreaIds.push(Re.id)}),re.value.selectedAreaIds=re.value.selectedAreaIds.filter(Re=>$e.some(be=>be.id===Re))}},{immediate:!0}),Ye(()=>i.drawingMode,$e=>{$e||(m.value=0)}),($e,De)=>(p(),g("div",GL,[e.route.length>0?(p(),g("div",qL,[De[7]||(De[7]=r("span",{class:"route-settings-label"},"Route style:",-1)),Pe(VL,{"model-value":w.value,"default-color":Mv,"show-contrast-preview":!1,"show-default":!0,"onUpdate:modelValue":De[0]||(De[0]=Re=>w.value=Re)},null,8,["model-value"]),r("div",{class:"style-selector",ref_key:"styleSelectorRef",ref:h},[r("button",{type:"button",class:"style-selector-button",onClick:M},[(p(),g("svg",jL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:S.value,"stroke-width":"3","stroke-dasharray":T(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,WL)])),De[5]||(De[5]=r("span",{class:"style-selector-arrow"},"",-1))]),y.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),g(Se,null,je(_,Re=>r("button",{key:Re.value,type:"button",class:le(["style-option",{selected:(x.value||"line")===Re.value}]),onClick:be=>F(Re.value)},[(p(),g("svg",KL,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:S.value,"stroke-width":"3","stroke-dasharray":T(Re.value),"stroke-linecap":O(Re.value)},null,8,YL)]))],10,ZL)),64))],4)):P("",!0)],512),r("div",{class:"style-selector",ref_key:"weightSelectorRef",ref:f},[r("button",{type:"button",class:"style-selector-button",onClick:U},[(p(),g("svg",JL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:S.value,"stroke-width":A.value||4,"stroke-dasharray":T(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,XL)])),De[6]||(De[6]=r("span",{class:"style-selector-arrow"},"",-1))]),k.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),g(Se,null,je(C,Re=>r("button",{key:Re.value,type:"button",class:le(["style-option",{selected:(A.value||4)===Re.value}]),onClick:be=>j(Re.value)},[(p(),g("svg",eS,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:S.value,"stroke-width":Re.value,"stroke-dasharray":T(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,tS)]))],10,QL)),64))],4)):P("",!0)],512),r("button",{type:"button",class:"btn-save-style",disabled:!E.value,onClick:Z}," Save ",8,nS)])):P("",!0),r("div",{class:"map-section",ref_key:"mapSection",ref:c},[Pe(al,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,"route-color":w.value,"route-style":x.value,"route-weight":A.value,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:re.value,"toolbar-actions":K.value,"fullscreen-title":e.drawingMode?`Draw ${B(o).area} boundary`:B(s).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:De[1]||(De[1]=Re=>$e.$emit("map-click",Re)),onLocationClick:De[2]||(De[2]=Re=>$e.$emit("location-click",Re)),onAreaClick:De[3]||(De[3]=Re=>$e.$emit("area-click",Re)),onPolygonComplete:De[4]||(De[4]=Re=>$e.$emit("polygon-complete",Re)),onPolygonDrawing:Y,onFilterChange:q,onActionClick:ae},null,8,["locations","route","route-color","route-style","route-weight","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},sS=Ke(oS,[["__scopeId","data-v-4903e5fa"]]),aS=(e,t)=>{const n=String(e).trim(),s=String(t).trim(),o=parseFloat(n),i=parseFloat(s),l=!isNaN(o)&&String(o)===n,c=!isNaN(i)&&String(i)===s;return l&&c?o-i:n.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})},s1=(e,t)=>[...e].sort((n,s)=>{const o=n.displayOrder||0,i=s.displayOrder||0;if(o!==i)return o-i;const l=n.text.localeCompare(s.text,void 0,{sensitivity:"base"});if(l!==0)return l;const c=t(n),d=t(s);return c.localeCompare(d,void 0,{numeric:!0,sensitivity:"base"})}),iS={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,n)=>(p(),g("button",{class:le(["status-pill",[e.variant,{active:e.active}]]),onClick:n[0]||(n[0]=s=>t.$emit("click"))},[go(t.$slots,"default",{},void 0,!0)],2))}},Mt=Ke(iS,[["__scopeId","data-v-a94deea5"]]),lS={class:"check-in-toggle-container"},rS=["disabled"],cS={key:0,class:"toggle-spinner"},uS={key:1,class:"toggle-icon"},dS={class:"toggle-label"},hS={key:0,class:"check-in-details"},fS={key:0,class:"check-in-method"},pS={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,n=H(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),s=H(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),o=H(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=H(()=>{const{checkedInBy:c,checkInMethod:d,marshalName:h}=t;return c&&c!==h?c:d||""}),l=c=>{if(!c)return"";const d=new Date(c),f=(new Date-d)/(1e3*60*60),m=d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return f>24?`${d.toLocaleDateString([],{day:"numeric",month:"short"})}, ${m}`:m};return(c,d)=>(p(),g("div",lS,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[e.isLoading?(p(),g("span",cS)):e.isCheckedIn?(p(),g("span",uS,"")):P("",!0),r("span",dS,b(o.value),1)],10,rS),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(p(),g("span",hS,[Je(b(l(e.checkInTime))+" ",1),i.value?(p(),g("span",fS,"("+b(i.value)+")",1)):P("",!0),n.value?(p(),g("span",{key:1,class:le(["check-in-distance",s.value]),onClick:d[1]||(d[1]=rt(h=>c.$emit("distance-click"),["stop"]))},b(n.value),3)):P("",!0)])):P("",!0)]))}},xu=Ke(pS,[["__scopeId","data-v-cc97f986"]]),vS={class:"confirm-modal"},mS={class:"confirm-actions"},gS={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const n=t,s=()=>{n("confirm")},o=()=>{n("cancel")};return(i,l)=>e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:rt(o,["self"])},[r("div",vS,[r("h3",null,b(e.title),1),r("p",null,b(e.message),1),r("div",mS,[e.showCancel?(p(),g("button",{key:0,onClick:o,class:"btn btn-secondary"},b(e.cancelText),1)):P("",!0),r("button",{onClick:s,class:le(["btn",e.isDanger?"btn-danger":"btn-primary"])},b(e.confirmText),3)])])])):P("",!0)}},mi=Ke(gS,[["__scopeId","data-v-b3f01e55"]]),yS={class:"base-modal-header"},kS={class:"base-modal-header-content"},bS={key:0,class:"base-modal-title"},wS={key:0,class:"base-modal-tab-header"},_S={key:1,class:"base-modal-footer"},CS={key:0,class:"base-modal-actions"},LS={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=()=>{const C=document.documentElement,S=getComputedStyle(C).getPropertyValue("--modal-resize-duration").trim();return S.endsWith("s")?parseFloat(S)*1e3:300},s=e,o=t,i=D(!1),l=D(!1),c=D(null),d=D(null);let h=null,f=!1,m=0;const y=()=>{if(!d.value||!c.value||f)return;const C=d.value.scrollHeight,S=m;if(S===C||m===0){m=C;return}f=!0,d.value.style.height=`${S}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${C}px`;const $=n();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=C},$)},k=()=>{!c.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),h=new MutationObserver(()=>{rn(()=>{y()})}),h.observe(c.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},w=()=>{h&&(h.disconnect(),h=null)};cn(()=>{rn(()=>{s.show&&k()})}),In(()=>{w()}),Ye(()=>s.show,C=>{C?rn(()=>{m=0,k()}):w()});const x=()=>{s.closeOnOverlay&&A()},A=()=>{s.confirmOnClose&&s.isDirty?i.value=!0:o("close")},E=()=>{i.value=!1,o("close")},_=()=>{i.value=!1};return(C,S)=>(p(),Ge(Ls,{name:"modal",appear:""},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"base-modal-overlay",style:tt({zIndex:e.zIndex}),onClick:rt(x,["self"])},[r("div",{class:le(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",yS,[r("div",kS,[go(C.$slots,"header",{},()=>[e.title?(p(),g("h2",bS,b(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(p(),g("button",{key:0,onClick:A,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),C.$slots["tab-header"]?(p(),g("div",wS,[go(C.$slots,"tab-header",{},void 0,!0)])):P("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:c},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[go(C.$slots,"default",{},void 0,!0)],512)],512),C.$slots.footer||C.$slots.actions?(p(),g("div",_S,[go(C.$slots,"footer",{},()=>[C.$slots.actions?(p(),g("div",CS,[go(C.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!l.value?(p(),Ge(mi,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:E,onCancel:_},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},Yt=Ke(LS,[["__scopeId","data-v-141bdab1"]]),SS={class:"map-modal-content"},IS={class:"location-info"},xS={key:0,class:"info-row"},$S={class:"info-value"},TS={key:1,class:"info-row"},MS={class:"info-label"},AS={class:"info-value"},ES={key:2,class:"info-row distance-row"},PS={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=dt(),n=e,s=D(null);let o=null,i=null,l=null;const c=H(()=>t.value.checkpoint),d=H(()=>n.marshalName&&n.checkpointName?`${n.marshalName} - ${n.checkpointName}`:n.marshalName?n.marshalName:"Check-in location"),h=H(()=>n.distance===null?"":n.distance<1e3?`${Math.round(n.distance)} m`:`${(n.distance/1e3).toFixed(2)} km`),f=H(()=>n.distance===null?"":n.distance<=50?"distance-close":n.distance<=100?"distance-medium":"distance-far"),m=(x,A)=>x==null||A==null?"Unknown":`${x.toFixed(6)}, ${A.toFixed(6)}`,y=()=>{if(!s.value||o)return;let x=[51.505,-.09],A=15;n.checkInLocation&&(x=[n.checkInLocation.lat,n.checkInLocation.lng]),o=Jt.map(s.value).setView(x,A),Jt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(o),k()},k=()=>{if(!o)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const x=[];if(n.checkInLocation){const A=Jt.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Jt.marker([n.checkInLocation.lat,n.checkInLocation.lng],{icon:A}).addTo(o).bindPopup(`<b>${n.marshalName||"Marshal"}</b><br>Check-in location`),x.push([n.checkInLocation.lat,n.checkInLocation.lng])}if(n.checkpointLocation&&n.checkpointLocation.lat&&n.checkpointLocation.lng){const A=Jt.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${n.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Jt.marker([n.checkpointLocation.lat,n.checkpointLocation.lng],{icon:A}).addTo(o).bindPopup(`<b>${n.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),x.push([n.checkpointLocation.lat,n.checkpointLocation.lng])}if(x.length===2){const A=Jt.latLngBounds(x);o.fitBounds(A,{padding:[50,50],maxZoom:17})}else x.length===1&&o.setView(x[0],16)},w=()=>{o&&(o.remove(),o=null,i=null,l=null)};return Ye(()=>n.show,async x=>{x?(await rn(),setTimeout(()=>{y()},100)):w()}),Ye([()=>n.checkInLocation,()=>n.checkpointLocation],()=>{o&&k()},{deep:!0}),cn(()=>{n.show&&rn(()=>{setTimeout(()=>{y()},100)})}),In(()=>{w()}),(x,A)=>(p(),Ge(Yt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:A[0]||(A[0]=E=>x.$emit("close"))},{default:Ve(()=>[r("div",SS,[r("div",{class:"map-container",ref_key:"mapContainer",ref:s},null,512),r("div",IS,[e.checkInLocation?(p(),g("div",xS,[A[1]||(A[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",$S,b(m(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):P("",!0),e.checkpointLocation?(p(),g("div",TS,[r("span",MS,b(c.value)+" location:",1),r("span",AS,b(m(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):P("",!0),e.distance!==null?(p(),g("div",ES,[A[2]||(A[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:le(["info-value distance-value",f.value])},b(h.value),3)])):P("",!0)])])]),_:1},8,["show","title","z-index"]))}},Df=Ke(PS,[["__scopeId","data-v-011fa479"]]),DS={class:"marshals-tab"},RS={class:"tab-header"},OS={class:"button-group"},NS={key:0,class:"status-pills"},BS={class:"filters-section"},FS={class:"search-group"},US={class:"marshals-grid"},zS={class:"marshals-table"},HS={key:0,class:"sort-indicator"},VS={key:0,class:"sort-indicator"},GS={key:0,class:"sort-indicator"},qS={key:0,class:"sort-indicator"},jS=["onClick"],WS=["rowspan"],ZS={class:"checkpoint-cell"},KS={class:"checkpoint-name"},YS={key:0,class:"checkpoint-description"},JS=["rowspan"],XS={key:0,class:"last-active-text"},QS={key:1,class:"last-active-never"},eI=["onClick"],tI={class:"no-checkpoint-text"},nI={class:"hide-on-mobile last-active-cell"},oI={key:0,class:"last-active-text"},sI={key:1,class:"last-active-never"},aI={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:n}){const{terms:s}=dt(),o=e,i=n,l=D(null),c=D(!1),d=D(null),h=z=>{l.value=z},f=z=>{d.value=z,c.value=!0},m=()=>{c.value=!1,d.value=null},y=H(()=>d.value?_e(d.value.marshalId):""),k=H(()=>d.value?te(d.value.locationId):""),w=H(()=>{if(!d.value)return null;const{checkInLatitude:z,checkInLongitude:J}=d.value;return!z||!J?null:{lat:z,lng:J}}),x=H(()=>{if(!d.value)return null;const z=Y(d.value.locationId);return!z?.latitude||!z?.longitude?null:{lat:z.latitude,lng:z.longitude}}),A=H(()=>d.value?$e(d.value):null),E=D(!1),_=D(null),C=z=>{z.isCheckedIn?(_.value=z,E.value=!0):i("toggle-check-in",z)},S=()=>{_.value&&i("toggle-check-in",_.value),E.value=!1,_.value=null},$=()=>{E.value=!1,_.value=null},R=H(()=>_.value?`Are you sure you want to undo ${_e(_.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const T=D("name"),O=D("asc"),M=D(""),U=D("all"),F=z=>{U.value=z},j=z=>{T.value===z?O.value=O.value==="asc"?"desc":"asc":(T.value=z,O.value="asc")},Z=z=>o.assignments.filter(J=>J.marshalId===z),Q=H(()=>new Set(o.assignments.filter(z=>z.isCheckedIn).map(z=>z.marshalId))),re=H(()=>new Set(o.assignments.map(z=>z.marshalId))),K=H(()=>Q.value.size),ae=H(()=>o.marshals.filter(z=>!re.value.has(z.id)).length),q=H(()=>o.marshals.filter(z=>re.value.has(z.id)&&!Q.value.has(z.id)).length),Y=z=>o.locations.find(J=>J.id===z),te=z=>{const J=Y(z);return J?J.name:"Unknown"},ue=z=>{const J=Y(z);return J?J.description:""},_e=z=>{const J=o.marshals.find(de=>de.id===z);return J?J.name:""},$e=z=>{const{checkInLatitude:J,checkInLongitude:de,locationId:ie}=z,Ae=Y(ie);return!J||!de||!Ae?.latitude||!Ae?.longitude?null:sl(J,de,Ae.latitude,Ae.longitude)},De=z=>{if(!z)return"";const J=new Date(z),ie=new Date-J,Ae=Math.floor(ie/6e4),G=Math.floor(Ae/60),X=Math.floor(G/24);return Ae<1?"just now":Ae<60?`${Ae}m ago`:G<24?`${G}h ago`:X===1?"yesterday":X<7?`${X}d ago`:J.toLocaleDateString()},Re=H(()=>{let z=o.marshals;if(U.value==="unassigned"?z=z.filter(J=>!re.value.has(J.id)):U.value==="checked-in"?z=z.filter(J=>Q.value.has(J.id)):U.value==="not-checked-in"&&(z=z.filter(J=>re.value.has(J.id)&&!Q.value.has(J.id))),M.value.trim()){const J=M.value.toLowerCase().trim().split(/\s+/);z=z.filter(de=>{const Ae=Z(de.id).map(X=>{const ee=Y(X.locationId);return ee?`${ee.name||""} ${ee.description||""}`:""}).join(" "),G=`${de.name} ${Ae}`.toLowerCase();return J.every(X=>G.includes(X))})}return z}),be=H(()=>{const z=[...Re.value];return z.sort((J,de)=>{let ie=0;if(T.value==="name")ie=J.name.localeCompare(de.name);else if(T.value==="checkpoint"){const Ae=Z(J.id),G=Z(de.id),X=Ae.length>0?te(Ae[0].locationId):"",ee=G.length>0?te(G[0].locationId):"";ie=aS(X,ee)}else if(T.value==="status"){const Ae=Z(J.id),G=Z(de.id),X=Ae.length>0&&Ae[0].isCheckedIn?1:0;ie=(G.length>0&&G[0].isCheckedIn?1:0)-X}else if(T.value==="lastActive"){const Ae=J.lastAccessedDate?new Date(J.lastAccessedDate).getTime():0;ie=(de.lastAccessedDate?new Date(de.lastAccessedDate).getTime():0)-Ae}return O.value==="asc"?ie:-ie}),z});return(z,J)=>(p(),g("div",DS,[r("div",RS,[r("div",OS,[r("button",{onClick:J[0]||(J[0]=de=>z.$emit("add-marshal")),class:"btn btn-primary"}," Add "+b(B(s).person.toLowerCase()),1),r("button",{onClick:J[1]||(J[1]=de=>z.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(p(),g("div",NS,[Pe(Mt,{variant:"neutral",active:U.value==="all",onClick:J[2]||(J[2]=de=>F("all"))},{default:Ve(()=>[Je(b(e.marshals.length)+" total ",1)]),_:1},8,["active"]),ae.value>0&&ae.value<e.marshals.length?(p(),Ge(Mt,{key:0,variant:"warning",active:U.value==="unassigned",onClick:J[3]||(J[3]=de=>F("unassigned"))},{default:Ve(()=>[Je(b(ae.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),K.value>0&&K.value<e.marshals.length?(p(),Ge(Mt,{key:1,variant:"success",active:U.value==="checked-in",onClick:J[4]||(J[4]=de=>F("checked-in"))},{default:Ve(()=>[Je(b(K.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),q.value>0&&q.value<e.marshals.length?(p(),Ge(Mt,{key:2,variant:"danger",active:U.value==="not-checked-in",onClick:J[5]||(J[5]=de=>F("not-checked-in"))},{default:Ve(()=>[Je(b(q.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",BS,[r("div",FS,[We(r("input",{"onUpdate:modelValue":J[6]||(J[6]=de=>M.value=de),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,M.value]])])]),r("div",US,[r("table",zS,[r("thead",null,[r("tr",null,[r("th",{onClick:J[7]||(J[7]=de=>j("name")),class:"sortable"},[J[12]||(J[12]=Je(" Name ",-1)),T.value==="name"?(p(),g("span",HS,b(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[8]||(J[8]=de=>j("checkpoint")),class:"sortable"},[Je(b(B(s).checkpoint)+" ",1),T.value==="checkpoint"?(p(),g("span",VS,b(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[9]||(J[9]=de=>j("status")),class:"sortable"},[J[13]||(J[13]=Je(" Status ",-1)),T.value==="status"?(p(),g("span",GS,b(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[10]||(J[10]=de=>j("lastActive")),class:"sortable hide-on-mobile"},[J[14]||(J[14]=Je(" Last active ",-1)),T.value==="lastActive"?(p(),g("span",qS,b(O.value==="asc"?"":""),1)):P("",!0)])])]),r("tbody",null,[(p(!0),g(Se,null,je(be.value,de=>(p(),g(Se,{key:de.id},[Z(de.id).length>0?(p(!0),g(Se,{key:0},je(Z(de.id),(ie,Ae)=>(p(),g("tr",{key:`${de.id}-${ie.id}`,class:"marshal-row",onClick:G=>z.$emit("select-marshal",de)},[Ae===0?(p(),g("td",{key:0,rowspan:Z(de.id).length},b(de.name),9,WS)):P("",!0),r("td",ZS,[r("div",KS,b(te(ie.locationId)),1),ue(ie.locationId)?(p(),g("div",YS,b(ue(ie.locationId)),1)):P("",!0)]),r("td",{onClick:J[11]||(J[11]=rt(()=>{},["stop"])),class:"check-in-cell"},[Pe(xu,{"is-checked-in":ie.isCheckedIn,"check-in-time":ie.checkInTime,"check-in-method":ie.checkInMethod,"checked-in-by":ie.checkedInBy,"marshal-name":_e(ie.marshalId),"is-loading":l.value===ie.id,distance:$e(ie),onToggle:G=>C(ie),onDistanceClick:G=>f(ie)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),Ae===0?(p(),g("td",{key:1,rowspan:Z(de.id).length,class:"hide-on-mobile last-active-cell"},[de.lastAccessedDate?(p(),g("span",XS,b(De(de.lastAccessedDate)),1)):(p(),g("span",QS,"Never"))],8,JS)):P("",!0)],8,jS))),128)):(p(),g("tr",{key:1,class:"marshal-row",onClick:ie=>z.$emit("select-marshal",de)},[r("td",null,b(de.name),1),r("td",tI,"No "+b(B(s).checkpoint.toLowerCase())+" assigned",1),J[15]||(J[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",nI,[de.lastAccessedDate?(p(),g("span",oI,b(De(de.lastAccessedDate)),1)):(p(),g("span",sI,"Never"))])],8,eI))],64))),128))])])]),Pe(Df,{show:c.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":w.value,"checkpoint-location":x.value,distance:A.value,onClose:m},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Pe(mi,{show:E.value,title:"Confirm check-out",message:R.value,"confirm-text":"Check out","is-danger":!0,onConfirm:S,onCancel:$},null,8,["show","message"])]))}},iI=Ke(aI,[["__scopeId","data-v-bdb66e38"]]),lI={class:"assignment-pills"},rI={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:n}=dt(),s=e,o=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${n.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${n.value.checkpoints}`,SpecificPeople:`Specific ${n.value.people}`,EveryAreaLead:`Every ${n.value.area} lead`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,OnePerArea:`One per ${n.value.area}`,OneLeadPerArea:`One lead per ${n.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${n.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?s.areas.find(y=>y.id===h)?.name||null:f==="Checkpoint"?s.locations.find(y=>y.id===h)?.name||null:f==="Marshal"&&s.marshals.find(y=>y.id===h)?.name||null,c=h=>{if(!h)return[];const f=o(h.scope),m=h.ids||[];if(h.itemType===null||m.length===0)return[f];if(m.includes("ALL_MARSHALS"))return["Everyone"];if(m.includes("ALL_AREAS"))return[`${f} (All ${n.value.areas})`];if(m.includes("ALL_CHECKPOINTS"))return[`${f} (All ${n.value.checkpoints})`];const y=m.filter(w=>l(w,h.itemType)!==null);if(y.length===0)return[];if(y.length>s.maxExpandedItems)return[`${f} (${y.length})`];const k=i(h.scope);return y.map(w=>{const x=l(w,h.itemType);return k?`${k} ${x}`:x})},d=H(()=>{if(!s.scopeConfigurations||s.scopeConfigurations.length===0)return[];const h=[];for(const f of s.scopeConfigurations)h.push(...c(f));return h});return(h,f)=>(p(),g("div",lI,[(p(!0),g(Se,null,je(d.value,(m,y)=>(p(),g("span",{key:y,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},b(m),1))),128))]))}},nl=Ke(rI,[["__scopeId","data-v-82c305e5"]]);function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Ks(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Av(Object(n),!0).forEach(function(s){cI(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function nu(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nu=function(t){return typeof t}:nu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function cI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ia(){return Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ia.apply(this,arguments)}function uI(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,i;for(i=0;i<s.length;i++)o=s[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function dI(e,t){if(e==null)return{};var n=uI(e,t),s,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)s=i[o],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}var hI="1.14.0";function _a(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Ta=_a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),gc=_a(/Edge/i),Ev=_a(/firefox/i),jr=_a(/safari/i)&&!_a(/chrome/i)&&!_a(/android/i),a1=_a(/iP(ad|od|hone)/i),fI=_a(/chrome/i)&&_a(/android/i),i1={capture:!1,passive:!1};function Wt(e,t,n){e.addEventListener(t,n,!Ta&&i1)}function zt(e,t,n){e.removeEventListener(t,n,!Ta&&i1)}function $u(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function pI(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Gs(e,t,n,s){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&$u(e,t):$u(e,t))||s&&e===n)return e;if(e===n)break}while(e=pI(e))}return null}var Pv=/\s+/g;function Do(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var s=(" "+e.className+" ").replace(Pv," ").replace(" "+t+" "," ");e.className=(s+(n?" "+t:"")).replace(Pv," ")}}function yt(e,t,n){var s=e&&e.style;if(s){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in s)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),s[t]=n+(typeof n=="string"?"":"px")}}function Jl(e,t){var n="";if(typeof e=="string")n=e;else do{var s=yt(e,"transform");s&&s!=="none"&&(n=s+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function l1(e,t,n){if(e){var s=e.getElementsByTagName(t),o=0,i=s.length;if(n)for(;o<i;o++)n(s[o],o);return s}return[]}function Zs(){var e=document.scrollingElement;return e||document.documentElement}function Mn(e,t,n,s,o){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,c,d,h,f,m;if(e!==window&&e.parentNode&&e!==Zs()?(i=e.getBoundingClientRect(),l=i.top,c=i.left,d=i.bottom,h=i.right,f=i.height,m=i.width):(l=0,c=0,d=window.innerHeight,h=window.innerWidth,f=window.innerHeight,m=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!Ta))do if(o&&o.getBoundingClientRect&&(yt(o,"transform")!=="none"||n&&yt(o,"position")!=="static")){var y=o.getBoundingClientRect();l-=y.top+parseInt(yt(o,"border-top-width")),c-=y.left+parseInt(yt(o,"border-left-width")),d=l+i.height,h=c+i.width;break}while(o=o.parentNode);if(s&&e!==window){var k=Jl(o||e),w=k&&k.a,x=k&&k.d;k&&(l/=x,c/=w,m/=w,f/=x,d=l+f,h=c+m)}return{top:l,left:c,bottom:d,right:h,width:m,height:f}}}function Dv(e,t,n){for(var s=ri(e,!0),o=Mn(e)[t];s;){var i=Mn(s)[n],l=void 0;if(l=o>=i,!l)return s;if(s===Zs())break;s=ri(s,!1)}return!1}function sr(e,t,n,s){for(var o=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==kt.ghost&&(s||l[i]!==kt.dragged)&&Gs(l[i],n.draggable,e,!1)){if(o===t)return l[i];o++}i++}return null}function Rf(e,t){for(var n=e.lastElementChild;n&&(n===kt.ghost||yt(n,"display")==="none"||t&&!$u(n,t));)n=n.previousElementSibling;return n||null}function Jo(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==kt.clone&&(!t||$u(e,t))&&n++;return n}function Rv(e){var t=0,n=0,s=Zs();if(e)do{var o=Jl(e),i=o.a,l=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*l}while(e!==s&&(e=e.parentNode));return[t,n]}function vI(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e[n][s])return Number(n)}return-1}function ri(e,t){if(!e||!e.getBoundingClientRect)return Zs();var n=e,s=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=yt(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Zs();if(s||t)return n;s=!0}}while(n=n.parentNode);return Zs()}function mI(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Hd(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Wr;function r1(e,t){return function(){if(!Wr){var n=arguments,s=this;n.length===1?e.call(s,n[0]):e.apply(s,n),Wr=setTimeout(function(){Wr=void 0},t)}}}function gI(){clearTimeout(Wr),Wr=void 0}function c1(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function u1(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var Bo="Sortable"+new Date().getTime();function yI(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var s=[].slice.call(this.el.children);s.forEach(function(o){if(!(yt(o,"display")==="none"||o===kt.ghost)){e.push({target:o,rect:Mn(o)});var i=Ks({},e[e.length-1].rect);if(o.thisAnimationDuration){var l=Jl(o,!0);l&&(i.top-=l.f,i.left-=l.e)}o.fromRect=i}})}},addAnimationState:function(s){e.push(s)},removeAnimationState:function(s){e.splice(vI(e,{target:s}),1)},animateAll:function(s){var o=this;if(!this.options.animation){clearTimeout(t),typeof s=="function"&&s();return}var i=!1,l=0;e.forEach(function(c){var d=0,h=c.target,f=h.fromRect,m=Mn(h),y=h.prevFromRect,k=h.prevToRect,w=c.rect,x=Jl(h,!0);x&&(m.top-=x.f,m.left-=x.e),h.toRect=m,h.thisAnimationDuration&&Hd(y,m)&&!Hd(f,m)&&(w.top-m.top)/(w.left-m.left)===(f.top-m.top)/(f.left-m.left)&&(d=bI(w,y,k,o.options)),Hd(m,f)||(h.prevFromRect=f,h.prevToRect=m,d||(d=o.options.animation),o.animate(h,w,m,d)),d&&(i=!0,l=Math.max(l,d),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},d),h.thisAnimationDuration=d)}),clearTimeout(t),i?t=setTimeout(function(){typeof s=="function"&&s()},l):typeof s=="function"&&s(),e=[]},animate:function(s,o,i,l){if(l){yt(s,"transition",""),yt(s,"transform","");var c=Jl(this.el),d=c&&c.a,h=c&&c.d,f=(o.left-i.left)/(d||1),m=(o.top-i.top)/(h||1);s.animatingX=!!f,s.animatingY=!!m,yt(s,"transform","translate3d("+f+"px,"+m+"px,0)"),this.forRepaintDummy=kI(s),yt(s,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),yt(s,"transform","translate3d(0,0,0)"),typeof s.animated=="number"&&clearTimeout(s.animated),s.animated=setTimeout(function(){yt(s,"transition",""),yt(s,"transform",""),s.animated=!1,s.animatingX=!1,s.animatingY=!1},l)}}}}function kI(e){return e.offsetWidth}function bI(e,t,n,s){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*s.animation}var Nl=[],Vd={initializeByDefault:!0},yc={mount:function(t){for(var n in Vd)Vd.hasOwnProperty(n)&&!(n in t)&&(t[n]=Vd[n]);Nl.forEach(function(s){if(s.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Nl.push(t)},pluginEvent:function(t,n,s){var o=this;this.eventCanceled=!1,s.cancel=function(){o.eventCanceled=!0};var i=t+"Global";Nl.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][i]&&n[l.pluginName][i](Ks({sortable:n},s)),n.options[l.pluginName]&&n[l.pluginName][t]&&n[l.pluginName][t](Ks({sortable:n},s)))})},initializePlugins:function(t,n,s,o){Nl.forEach(function(c){var d=c.pluginName;if(!(!t.options[d]&&!c.initializeByDefault)){var h=new c(t,n,t.options);h.sortable=t,h.options=t.options,t[d]=h,Ia(s,h.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,n){var s={};return Nl.forEach(function(o){typeof o.eventProperties=="function"&&Ia(s,o.eventProperties.call(n[o.pluginName],t))}),s},modifyOption:function(t,n,s){var o;return Nl.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(t[i.pluginName],s))}),o}};function wI(e){var t=e.sortable,n=e.rootEl,s=e.name,o=e.targetEl,i=e.cloneEl,l=e.toEl,c=e.fromEl,d=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,m=e.newDraggableIndex,y=e.originalEvent,k=e.putSortable,w=e.extraEventProperties;if(t=t||n&&n[Bo],!!t){var x,A=t.options,E="on"+s.charAt(0).toUpperCase()+s.substr(1);window.CustomEvent&&!Ta&&!gc?x=new CustomEvent(s,{bubbles:!0,cancelable:!0}):(x=document.createEvent("Event"),x.initEvent(s,!0,!0)),x.to=l||n,x.from=c||n,x.item=o||n,x.clone=i,x.oldIndex=d,x.newIndex=h,x.oldDraggableIndex=f,x.newDraggableIndex=m,x.originalEvent=y,x.pullMode=k?k.lastPutMode:void 0;var _=Ks(Ks({},w),yc.getEventProperties(s,t));for(var C in _)x[C]=_[C];n&&n.dispatchEvent(x),A[E]&&A[E].call(t,x)}}var _I=["evt"],xo=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.evt,i=dI(s,_I);yc.pluginEvent.bind(kt)(t,n,Ks({dragEl:nt,parentEl:vn,ghostEl:St,rootEl:ln,nextEl:Vi,lastDownEl:ou,cloneEl:mn,cloneHidden:li,dragStarted:Mr,putSortable:Fn,activeSortable:kt.active,originalEvent:o,oldIndex:ql,oldDraggableIndex:Zr,newIndex:Ro,newDraggableIndex:si,hideGhostForTarget:p1,unhideGhostForTarget:v1,cloneNowHidden:function(){li=!0},cloneNowShown:function(){li=!1},dispatchSortableEvent:function(c){fo({sortable:n,name:c,originalEvent:o})}},i))};function fo(e){wI(Ks({putSortable:Fn,cloneEl:mn,targetEl:nt,rootEl:ln,oldIndex:ql,oldDraggableIndex:Zr,newIndex:Ro,newDraggableIndex:si},e))}var nt,vn,St,ln,Vi,ou,mn,li,ql,Ro,Zr,si,zc,Fn,Vl=!1,Tu=!1,Mu=[],Ui,gs,Gd,qd,Ov,Nv,Mr,Bl,Kr,Yr=!1,Hc=!1,su,Kn,jd=[],ef=!1,Au=[],ad=typeof document<"u",Vc=a1,Bv=gc||Ta?"cssFloat":"float",CI=ad&&!fI&&!a1&&"draggable"in document.createElement("div"),d1=(function(){if(ad){if(Ta)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),h1=function(t,n){var s=yt(t),o=parseInt(s.width)-parseInt(s.paddingLeft)-parseInt(s.paddingRight)-parseInt(s.borderLeftWidth)-parseInt(s.borderRightWidth),i=sr(t,0,n),l=sr(t,1,n),c=i&&yt(i),d=l&&yt(l),h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Mn(i).width,f=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Mn(l).width;if(s.display==="flex")return s.flexDirection==="column"||s.flexDirection==="column-reverse"?"vertical":"horizontal";if(s.display==="grid")return s.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&c.float&&c.float!=="none"){var m=c.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===m)?"vertical":"horizontal"}return i&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||h>=o&&s[Bv]==="none"||l&&s[Bv]==="none"&&h+f>o)?"vertical":"horizontal"},LI=function(t,n,s){var o=s?t.left:t.top,i=s?t.right:t.bottom,l=s?t.width:t.height,c=s?n.left:n.top,d=s?n.right:n.bottom,h=s?n.width:n.height;return o===c||i===d||o+l/2===c+h/2},SI=function(t,n){var s;return Mu.some(function(o){var i=o[Bo].options.emptyInsertThreshold;if(!(!i||Rf(o))){var l=Mn(o),c=t>=l.left-i&&t<=l.right+i,d=n>=l.top-i&&n<=l.bottom+i;if(c&&d)return s=o}}),s},f1=function(t){function n(i,l){return function(c,d,h,f){var m=c.options.group.name&&d.options.group.name&&c.options.group.name===d.options.group.name;if(i==null&&(l||m))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return n(i(c,d,h,f),l)(c,d,h,f);var y=(l?c:d).options.group.name;return i===!0||typeof i=="string"&&i===y||i.join&&i.indexOf(y)>-1}}var s={},o=t.group;(!o||nu(o)!="object")&&(o={name:o}),s.name=o.name,s.checkPull=n(o.pull,!0),s.checkPut=n(o.put),s.revertClone=o.revertClone,t.group=s},p1=function(){!d1&&St&&yt(St,"display","none")},v1=function(){!d1&&St&&yt(St,"display","")};ad&&document.addEventListener("click",function(e){if(Tu)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tu=!1,!1},!0);var zi=function(t){if(nt){t=t.touches?t.touches[0]:t;var n=SI(t.clientX,t.clientY);if(n){var s={};for(var o in t)t.hasOwnProperty(o)&&(s[o]=t[o]);s.target=s.rootEl=n,s.preventDefault=void 0,s.stopPropagation=void 0,n[Bo]._onDragOver(s)}}},II=function(t){nt&&nt.parentNode[Bo]._isOutsideThisEl(t.target)};function kt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Ia({},t),e[Bo]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return h1(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:kt.supportPointer!==!1&&"PointerEvent"in window&&!jr,emptyInsertThreshold:5};yc.initializePlugins(this,e,n);for(var s in n)!(s in t)&&(t[s]=n[s]);f1(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:CI,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Wt(e,"pointerdown",this._onTapStart):(Wt(e,"mousedown",this._onTapStart),Wt(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Wt(e,"dragover",this),Wt(e,"dragenter",this)),Mu.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Ia(this,yI())}kt.prototype={constructor:kt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Bl=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,nt):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,s=this.el,o=this.options,i=o.preventOnFilter,l=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(c||t).target,h=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,f=o.filter;if(DI(s),!nt&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||o.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&jr&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=Gs(d,o.draggable,s,!1),!(d&&d.animated)&&ou!==d)){if(ql=Jo(d),Zr=Jo(d,o.draggable),typeof f=="function"){if(f.call(this,t,d,this)){fo({sortable:n,rootEl:h,name:"filter",targetEl:d,toEl:s,fromEl:s}),xo("filter",n,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(f&&(f=f.split(",").some(function(m){if(m=Gs(h,m.trim(),s,!1),m)return fo({sortable:n,rootEl:m,name:"filter",targetEl:d,fromEl:s,toEl:s}),xo("filter",n,{evt:t}),!0}),f)){i&&t.cancelable&&t.preventDefault();return}o.handle&&!Gs(h,o.handle,s,!1)||this._prepareDragStart(t,c,d)}}},_prepareDragStart:function(t,n,s){var o=this,i=o.el,l=o.options,c=i.ownerDocument,d;if(s&&!nt&&s.parentNode===i){var h=Mn(s);if(ln=i,nt=s,vn=nt.parentNode,Vi=nt.nextSibling,ou=s,zc=l.group,kt.dragged=nt,Ui={target:nt,clientX:(n||t).clientX,clientY:(n||t).clientY},Ov=Ui.clientX-h.left,Nv=Ui.clientY-h.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,nt.style["will-change"]="all",d=function(){if(xo("delayEnded",o,{evt:t}),kt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Ev&&o.nativeDraggable&&(nt.draggable=!0),o._triggerDragStart(t,n),fo({sortable:o,name:"choose",originalEvent:t}),Do(nt,l.chosenClass,!0)},l.ignore.split(",").forEach(function(f){l1(nt,f.trim(),Wd)}),Wt(c,"dragover",zi),Wt(c,"mousemove",zi),Wt(c,"touchmove",zi),Wt(c,"mouseup",o._onDrop),Wt(c,"touchend",o._onDrop),Wt(c,"touchcancel",o._onDrop),Ev&&this.nativeDraggable&&(this.options.touchStartThreshold=4,nt.draggable=!0),xo("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(gc||Ta))){if(kt.eventCanceled){this._onDrop();return}Wt(c,"mouseup",o._disableDelayedDrag),Wt(c,"touchend",o._disableDelayedDrag),Wt(c,"touchcancel",o._disableDelayedDrag),Wt(c,"mousemove",o._delayedDragTouchMoveHandler),Wt(c,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&Wt(c,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){nt&&Wd(nt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;zt(t,"mouseup",this._disableDelayedDrag),zt(t,"touchend",this._disableDelayedDrag),zt(t,"touchcancel",this._disableDelayedDrag),zt(t,"mousemove",this._delayedDragTouchMoveHandler),zt(t,"touchmove",this._delayedDragTouchMoveHandler),zt(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Wt(document,"pointermove",this._onTouchMove):n?Wt(document,"touchmove",this._onTouchMove):Wt(document,"mousemove",this._onTouchMove):(Wt(nt,"dragend",this),Wt(ln,"dragstart",this._onDragStart));try{document.selection?au(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Vl=!1,ln&&nt){xo("dragStarted",this,{evt:n}),this.nativeDraggable&&Wt(document,"dragover",II);var s=this.options;!t&&Do(nt,s.dragClass,!1),Do(nt,s.ghostClass,!0),kt.active=this,t&&this._appendGhost(),fo({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(gs){this._lastX=gs.clientX,this._lastY=gs.clientY,p1();for(var t=document.elementFromPoint(gs.clientX,gs.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(gs.clientX,gs.clientY),t!==n);)n=t;if(nt.parentNode[Bo]._isOutsideThisEl(t),n)do{if(n[Bo]){var s=void 0;if(s=n[Bo]._onDragOver({clientX:gs.clientX,clientY:gs.clientY,target:t,rootEl:n}),s&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);v1()}},_onTouchMove:function(t){if(Ui){var n=this.options,s=n.fallbackTolerance,o=n.fallbackOffset,i=t.touches?t.touches[0]:t,l=St&&Jl(St,!0),c=St&&l&&l.a,d=St&&l&&l.d,h=Vc&&Kn&&Rv(Kn),f=(i.clientX-Ui.clientX+o.x)/(c||1)+(h?h[0]-jd[0]:0)/(c||1),m=(i.clientY-Ui.clientY+o.y)/(d||1)+(h?h[1]-jd[1]:0)/(d||1);if(!kt.active&&!Vl){if(s&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<s)return;this._onDragStart(t,!0)}if(St){l?(l.e+=f-(Gd||0),l.f+=m-(qd||0)):l={a:1,b:0,c:0,d:1,e:f,f:m};var y="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");yt(St,"webkitTransform",y),yt(St,"mozTransform",y),yt(St,"msTransform",y),yt(St,"transform",y),Gd=f,qd=m,gs=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!St){var t=this.options.fallbackOnBody?document.body:ln,n=Mn(nt,!0,Vc,!0,t),s=this.options;if(Vc){for(Kn=t;yt(Kn,"position")==="static"&&yt(Kn,"transform")==="none"&&Kn!==document;)Kn=Kn.parentNode;Kn!==document.body&&Kn!==document.documentElement?(Kn===document&&(Kn=Zs()),n.top+=Kn.scrollTop,n.left+=Kn.scrollLeft):Kn=Zs(),jd=Rv(Kn)}St=nt.cloneNode(!0),Do(St,s.ghostClass,!1),Do(St,s.fallbackClass,!0),Do(St,s.dragClass,!0),yt(St,"transition",""),yt(St,"transform",""),yt(St,"box-sizing","border-box"),yt(St,"margin",0),yt(St,"top",n.top),yt(St,"left",n.left),yt(St,"width",n.width),yt(St,"height",n.height),yt(St,"opacity","0.8"),yt(St,"position",Vc?"absolute":"fixed"),yt(St,"zIndex","100000"),yt(St,"pointerEvents","none"),kt.ghost=St,t.appendChild(St),yt(St,"transform-origin",Ov/parseInt(St.style.width)*100+"% "+Nv/parseInt(St.style.height)*100+"%")}},_onDragStart:function(t,n){var s=this,o=t.dataTransfer,i=s.options;if(xo("dragStart",this,{evt:t}),kt.eventCanceled){this._onDrop();return}xo("setupClone",this),kt.eventCanceled||(mn=u1(nt),mn.draggable=!1,mn.style["will-change"]="",this._hideClone(),Do(mn,this.options.chosenClass,!1),kt.clone=mn),s.cloneId=au(function(){xo("clone",s),!kt.eventCanceled&&(s.options.removeCloneOnHide||ln.insertBefore(mn,nt),s._hideClone(),fo({sortable:s,name:"clone"}))}),!n&&Do(nt,i.dragClass,!0),n?(Tu=!0,s._loopId=setInterval(s._emulateDragOver,50)):(zt(document,"mouseup",s._onDrop),zt(document,"touchend",s._onDrop),zt(document,"touchcancel",s._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(s,o,nt)),Wt(document,"drop",s),yt(nt,"transform","translateZ(0)")),Vl=!0,s._dragStartId=au(s._dragStarted.bind(s,n,t)),Wt(document,"selectstart",s),Mr=!0,jr&&yt(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,s=t.target,o,i,l,c=this.options,d=c.group,h=kt.active,f=zc===d,m=c.sort,y=Fn||h,k,w=this,x=!1;if(ef)return;function A(q,Y){xo(q,w,Ks({evt:t,isOwner:f,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:i,canSort:m,fromSortable:y,target:s,completed:_,onMove:function(ue,_e){return Gc(ln,n,nt,o,ue,Mn(ue),t,_e)},changed:C},Y))}function E(){A("dragOverAnimationCapture"),w.captureAnimationState(),w!==y&&y.captureAnimationState()}function _(q){return A("dragOverCompleted",{insertion:q}),q&&(f?h._hideClone():h._showClone(w),w!==y&&(Do(nt,Fn?Fn.options.ghostClass:h.options.ghostClass,!1),Do(nt,c.ghostClass,!0)),Fn!==w&&w!==kt.active?Fn=w:w===kt.active&&Fn&&(Fn=null),y===w&&(w._ignoreWhileAnimating=s),w.animateAll(function(){A("dragOverAnimationComplete"),w._ignoreWhileAnimating=null}),w!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(s===nt&&!nt.animated||s===n&&!s.animated)&&(Bl=null),!c.dragoverBubble&&!t.rootEl&&s!==document&&(nt.parentNode[Bo]._isOutsideThisEl(t.target),!q&&zi(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),x=!0}function C(){Ro=Jo(nt),si=Jo(nt,c.draggable),fo({sortable:w,name:"change",toEl:n,newIndex:Ro,newDraggableIndex:si,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),s=Gs(s,c.draggable,n,!0),A("dragOver"),kt.eventCanceled)return x;if(nt.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||w._ignoreWhileAnimating===s)return _(!1);if(Tu=!1,h&&!c.disabled&&(f?m||(l=vn!==ln):Fn===this||(this.lastPutMode=zc.checkPull(this,h,nt,t))&&d.checkPut(this,h,nt,t))){if(k=this._getDirection(t,s)==="vertical",o=Mn(nt),A("dragOverValid"),kt.eventCanceled)return x;if(l)return vn=ln,E(),this._hideClone(),A("revert"),kt.eventCanceled||(Vi?ln.insertBefore(nt,Vi):ln.appendChild(nt)),_(!0);var S=Rf(n,c.draggable);if(!S||MI(t,k,this)&&!S.animated){if(S===nt)return _(!1);if(S&&n===t.target&&(s=S),s&&(i=Mn(s)),Gc(ln,n,nt,o,s,i,t,!!s)!==!1)return E(),n.appendChild(nt),vn=n,C(),_(!0)}else if(S&&TI(t,k,this)){var $=sr(n,0,c,!0);if($===nt)return _(!1);if(s=$,i=Mn(s),Gc(ln,n,nt,o,s,i,t,!1)!==!1)return E(),n.insertBefore(nt,$),vn=n,C(),_(!0)}else if(s.parentNode===n){i=Mn(s);var R=0,T,O=nt.parentNode!==n,M=!LI(nt.animated&&nt.toRect||o,s.animated&&s.toRect||i,k),U=k?"top":"left",F=Dv(s,"top","top")||Dv(nt,"top","top"),j=F?F.scrollTop:void 0;Bl!==s&&(T=i[U],Yr=!1,Hc=!M&&c.invertSwap||O),R=AI(t,s,i,k,M?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,Hc,Bl===s);var Z;if(R!==0){var Q=Jo(nt);do Q-=R,Z=vn.children[Q];while(Z&&(yt(Z,"display")==="none"||Z===St))}if(R===0||Z===s)return _(!1);Bl=s,Kr=R;var re=s.nextElementSibling,K=!1;K=R===1;var ae=Gc(ln,n,nt,o,s,i,t,K);if(ae!==!1)return(ae===1||ae===-1)&&(K=ae===1),ef=!0,setTimeout($I,30),E(),K&&!re?n.appendChild(nt):s.parentNode.insertBefore(nt,K?re:s),F&&c1(F,0,j-F.scrollTop),vn=nt.parentNode,T!==void 0&&!Hc&&(su=Math.abs(T-Mn(s)[U])),C(),_(!0)}if(n.contains(nt))return _(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zt(document,"mousemove",this._onTouchMove),zt(document,"touchmove",this._onTouchMove),zt(document,"pointermove",this._onTouchMove),zt(document,"dragover",zi),zt(document,"mousemove",zi),zt(document,"touchmove",zi)},_offUpEvents:function(){var t=this.el.ownerDocument;zt(t,"mouseup",this._onDrop),zt(t,"touchend",this._onDrop),zt(t,"pointerup",this._onDrop),zt(t,"touchcancel",this._onDrop),zt(document,"selectstart",this)},_onDrop:function(t){var n=this.el,s=this.options;if(Ro=Jo(nt),si=Jo(nt,s.draggable),xo("drop",this,{evt:t}),vn=nt&&nt.parentNode,Ro=Jo(nt),si=Jo(nt,s.draggable),kt.eventCanceled){this._nulling();return}Vl=!1,Hc=!1,Yr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),tf(this.cloneId),tf(this._dragStartId),this.nativeDraggable&&(zt(document,"drop",this),zt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),jr&&yt(document.body,"user-select",""),yt(nt,"transform",""),t&&(Mr&&(t.cancelable&&t.preventDefault(),!s.dropBubble&&t.stopPropagation()),St&&St.parentNode&&St.parentNode.removeChild(St),(ln===vn||Fn&&Fn.lastPutMode!=="clone")&&mn&&mn.parentNode&&mn.parentNode.removeChild(mn),nt&&(this.nativeDraggable&&zt(nt,"dragend",this),Wd(nt),nt.style["will-change"]="",Mr&&!Vl&&Do(nt,Fn?Fn.options.ghostClass:this.options.ghostClass,!1),Do(nt,this.options.chosenClass,!1),fo({sortable:this,name:"unchoose",toEl:vn,newIndex:null,newDraggableIndex:null,originalEvent:t}),ln!==vn?(Ro>=0&&(fo({rootEl:vn,name:"add",toEl:vn,fromEl:ln,originalEvent:t}),fo({sortable:this,name:"remove",toEl:vn,originalEvent:t}),fo({rootEl:vn,name:"sort",toEl:vn,fromEl:ln,originalEvent:t}),fo({sortable:this,name:"sort",toEl:vn,originalEvent:t})),Fn&&Fn.save()):Ro!==ql&&Ro>=0&&(fo({sortable:this,name:"update",toEl:vn,originalEvent:t}),fo({sortable:this,name:"sort",toEl:vn,originalEvent:t})),kt.active&&((Ro==null||Ro===-1)&&(Ro=ql,si=Zr),fo({sortable:this,name:"end",toEl:vn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){xo("nulling",this),ln=nt=vn=St=Vi=mn=ou=li=Ui=gs=Mr=Ro=si=ql=Zr=Bl=Kr=Fn=zc=kt.dragged=kt.ghost=kt.clone=kt.active=null,Au.forEach(function(t){t.checked=!0}),Au.length=Gd=qd=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":nt&&(this._onDragOver(t),xI(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,s=this.el.children,o=0,i=s.length,l=this.options;o<i;o++)n=s[o],Gs(n,l.draggable,this.el,!1)&&t.push(n.getAttribute(l.dataIdAttr)||PI(n));return t},sort:function(t,n){var s={},o=this.el;this.toArray().forEach(function(i,l){var c=o.children[l];Gs(c,this.options.draggable,o,!1)&&(s[i]=c)},this),n&&this.captureAnimationState(),t.forEach(function(i){s[i]&&(o.removeChild(s[i]),o.appendChild(s[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Gs(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var s=this.options;if(n===void 0)return s[t];var o=yc.modifyOption(this,t,n);typeof o<"u"?s[t]=o:s[t]=n,t==="group"&&f1(s)},destroy:function(){xo("destroy",this);var t=this.el;t[Bo]=null,zt(t,"mousedown",this._onTapStart),zt(t,"touchstart",this._onTapStart),zt(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(zt(t,"dragover",this),zt(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Mu.splice(Mu.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!li){if(xo("hideClone",this),kt.eventCanceled)return;yt(mn,"display","none"),this.options.removeCloneOnHide&&mn.parentNode&&mn.parentNode.removeChild(mn),li=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(li){if(xo("showClone",this),kt.eventCanceled)return;nt.parentNode==ln&&!this.options.group.revertClone?ln.insertBefore(mn,nt):Vi?ln.insertBefore(mn,Vi):ln.appendChild(mn),this.options.group.revertClone&&this.animate(nt,mn),yt(mn,"display",""),li=!1}}};function xI(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Gc(e,t,n,s,o,i,l,c){var d,h=e[Bo],f=h.options.onMove,m;return window.CustomEvent&&!Ta&&!gc?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=e,d.dragged=n,d.draggedRect=s,d.related=o||t,d.relatedRect=i||Mn(t),d.willInsertAfter=c,d.originalEvent=l,e.dispatchEvent(d),f&&(m=f.call(h,d,l)),m}function Wd(e){e.draggable=!1}function $I(){ef=!1}function TI(e,t,n){var s=Mn(sr(n.el,0,n.options,!0)),o=10;return t?e.clientX<s.left-o||e.clientY<s.top&&e.clientX<s.right:e.clientY<s.top-o||e.clientY<s.bottom&&e.clientX<s.left}function MI(e,t,n){var s=Mn(Rf(n.el,n.options.draggable)),o=10;return t?e.clientX>s.right+o||e.clientX<=s.right&&e.clientY>s.bottom&&e.clientX>=s.left:e.clientX>s.right&&e.clientY>s.top||e.clientX<=s.right&&e.clientY>s.bottom+o}function AI(e,t,n,s,o,i,l,c){var d=s?e.clientY:e.clientX,h=s?n.height:n.width,f=s?n.top:n.left,m=s?n.bottom:n.right,y=!1;if(!l){if(c&&su<h*o){if(!Yr&&(Kr===1?d>f+h*i/2:d<m-h*i/2)&&(Yr=!0),Yr)y=!0;else if(Kr===1?d<f+su:d>m-su)return-Kr}else if(d>f+h*(1-o)/2&&d<m-h*(1-o)/2)return EI(t)}return y=y||l,y&&(d<f+h*i/2||d>m-h*i/2)?d>f+h/2?1:-1:0}function EI(e){return Jo(nt)<Jo(e)?1:-1}function PI(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,s=0;n--;)s+=t.charCodeAt(n);return s.toString(36)}function DI(e){Au.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var s=t[n];s.checked&&Au.push(s)}}function au(e){return setTimeout(e,0)}function tf(e){return clearTimeout(e)}ad&&Wt(document,"touchmove",function(e){(kt.active||Vl)&&e.cancelable&&e.preventDefault()});kt.utils={on:Wt,off:zt,css:yt,find:l1,is:function(t,n){return!!Gs(t,n,t,!1)},extend:mI,throttle:r1,closest:Gs,toggleClass:Do,clone:u1,index:Jo,nextTick:au,cancelNextTick:tf,detectDirection:h1,getChild:sr};kt.get=function(e){return e[Bo]};kt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(s){if(!s.prototype||!s.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(s));s.utils&&(kt.utils=Ks(Ks({},kt.utils),s.utils)),yc.mount(s)})};kt.create=function(e,t){return new kt(e,t)};kt.version=hI;var Sn=[],Ar,nf,of=!1,Zd,Kd,Eu,Er;function RI(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var s=n.originalEvent;this.sortable.nativeDraggable?Wt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Wt(document,"pointermove",this._handleFallbackAutoScroll):s.touches?Wt(document,"touchmove",this._handleFallbackAutoScroll):Wt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var s=n.originalEvent;!this.options.dragOverBubble&&!s.rootEl&&this._handleAutoScroll(s)},drop:function(){this.sortable.nativeDraggable?zt(document,"dragover",this._handleAutoScroll):(zt(document,"pointermove",this._handleFallbackAutoScroll),zt(document,"touchmove",this._handleFallbackAutoScroll),zt(document,"mousemove",this._handleFallbackAutoScroll)),Fv(),iu(),gI()},nulling:function(){Eu=nf=Ar=of=Er=Zd=Kd=null,Sn.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,s){var o=this,i=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(i,l);if(Eu=n,s||this.options.forceAutoScrollFallback||gc||Ta||jr){Yd(n,this.options,c,s);var d=ri(c,!0);of&&(!Er||i!==Zd||l!==Kd)&&(Er&&Fv(),Er=setInterval(function(){var h=ri(document.elementFromPoint(i,l),!0);h!==d&&(d=h,iu()),Yd(n,o.options,h,s)},10),Zd=i,Kd=l)}else{if(!this.options.bubbleScroll||ri(c,!0)===Zs()){iu();return}Yd(n,this.options,ri(c,!1),!1)}}},Ia(e,{pluginName:"scroll",initializeByDefault:!0})}function iu(){Sn.forEach(function(e){clearInterval(e.pid)}),Sn=[]}function Fv(){clearInterval(Er)}var Yd=r1(function(e,t,n,s){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,c=t.scrollSpeed,d=Zs(),h=!1,f;nf!==n&&(nf=n,iu(),Ar=t.scroll,f=t.scrollFn,Ar===!0&&(Ar=ri(n,!0)));var m=0,y=Ar;do{var k=y,w=Mn(k),x=w.top,A=w.bottom,E=w.left,_=w.right,C=w.width,S=w.height,$=void 0,R=void 0,T=k.scrollWidth,O=k.scrollHeight,M=yt(k),U=k.scrollLeft,F=k.scrollTop;k===d?($=C<T&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),R=S<O&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):($=C<T&&(M.overflowX==="auto"||M.overflowX==="scroll"),R=S<O&&(M.overflowY==="auto"||M.overflowY==="scroll"));var j=$&&(Math.abs(_-o)<=l&&U+C<T)-(Math.abs(E-o)<=l&&!!U),Z=R&&(Math.abs(A-i)<=l&&F+S<O)-(Math.abs(x-i)<=l&&!!F);if(!Sn[m])for(var Q=0;Q<=m;Q++)Sn[Q]||(Sn[Q]={});(Sn[m].vx!=j||Sn[m].vy!=Z||Sn[m].el!==k)&&(Sn[m].el=k,Sn[m].vx=j,Sn[m].vy=Z,clearInterval(Sn[m].pid),(j!=0||Z!=0)&&(h=!0,Sn[m].pid=setInterval((function(){s&&this.layer===0&&kt.active._onTouchMove(Eu);var re=Sn[this.layer].vy?Sn[this.layer].vy*c:0,K=Sn[this.layer].vx?Sn[this.layer].vx*c:0;typeof f=="function"&&f.call(kt.dragged.parentNode[Bo],K,re,e,Eu,Sn[this.layer].el)!=="continue"||c1(Sn[this.layer].el,K,re)}).bind({layer:m}),24))),m++}while(t.bubbleScroll&&y!==d&&(y=ri(y,!1)));of=h}},30),m1=function(t){var n=t.originalEvent,s=t.putSortable,o=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,c=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(n){var h=s||i;c();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(f.clientX,f.clientY);d(),h&&!h.el.contains(m)&&(l("spill"),this.onSpill({dragEl:o,putSortable:s}))}};function Of(){}Of.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,s=t.putSortable;this.sortable.captureAnimationState(),s&&s.captureAnimationState();var o=sr(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),s&&s.animateAll()},drop:m1};Ia(Of,{pluginName:"revertOnSpill"});function Nf(){}Nf.prototype={onSpill:function(t){var n=t.dragEl,s=t.putSortable,o=s||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:m1};Ia(Nf,{pluginName:"removeOnSpill"});kt.mount(new RI);kt.mount(Nf,Of);const OI=["data-id"],NI={key:0,class:"order-overlay"},il={__name:"DraggableList",props:{items:{type:Array,required:!0},itemKey:{type:String,default:"id"},pinnedKey:{type:String,default:null},disabled:{type:Boolean,default:!1},layout:{type:String,default:"list"},showOrderOverlay:{type:Boolean,default:!0}},emits:["reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(!1);let l=null;const c=D([...n.items]);Ye(()=>n.items,k=>{c.value=[...k]},{deep:!0}),Ye(()=>n.disabled,k=>{l&&l.option("disabled",k)});const d=k=>{i.value=!1;const{oldIndex:w,newIndex:x}=k;if(w===x)return;const A=c.value.splice(w,1)[0];c.value.splice(x,0,A);const E=c.value.map((_,C)=>({id:_[n.itemKey],displayOrder:C+1}));s("reorder",{items:c.value,changes:E})},h=()=>{i.value=!0},f=k=>{if(!n.pinnedKey)return!0;const w=k.dragged.dataset.id,x=c.value.find(S=>String(S[n.itemKey])===w);if(!x)return!0;const A=x[n.pinnedKey],E=k.related.dataset.id,_=c.value.find(S=>String(S[n.itemKey])===E);if(!_)return!0;const C=_[n.pinnedKey];return A===C},m=()=>{o.value&&(l=kt.create(o.value,{animation:200,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",disabled:n.disabled,onMove:f,onStart:h,onEnd:d}))},y=()=>{l&&(l.destroy(),l=null)};return cn(()=>{rn(()=>{m()})}),In(()=>{y()}),(k,w)=>(p(),g("div",{ref_key:"listRef",ref:o,class:le(["draggable-list",{"draggable-grid":e.layout==="grid","is-dragging":i.value}])},[(p(!0),g(Se,null,je(c.value,(x,A)=>(p(),g("div",{key:x[e.itemKey],"data-id":x[e.itemKey],class:"draggable-item"},[go(k.$slots,"item",{element:x,index:A}),i.value&&e.showOrderOverlay?(p(),g("div",NI,b(A+1),1)):P("",!0)],8,OI))),128))],2))}},BI=["title"],ll={__name:"DragHandle",props:{disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(p(),g("span",{class:le(["drag-handle",{disabled:e.disabled}]),title:e.disabled?"":"Drag to reorder"},[...n[0]||(n[0]=[pi('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><circle cx="5" cy="3" r="1.5"></circle><circle cx="11" cy="3" r="1.5"></circle><circle cx="5" cy="8" r="1.5"></circle><circle cx="11" cy="8" r="1.5"></circle><circle cx="5" cy="13" r="1.5"></circle><circle cx="11" cy="13" r="1.5"></circle></svg>',1)])],10,BI))}},FI={class:"checklists-tab"},UI={class:"tab-header"},zI={class:"button-group"},HI={class:"view-toggle"},VI={key:0,class:"status-pills"},GI={key:1,class:"status-pills"},qI={key:2,class:"status-pills"},jI={key:3,class:"status-pills"},WI={class:"filters-section"},ZI={class:"search-group"},KI=["placeholder"],YI={class:"checklist-items-list"},JI={key:0,class:"empty-state"},XI={class:"checklist-item-card"},QI={class:"checklist-item-content"},ex=["onClick"],tx={key:0,class:"loading-state"},nx={key:1,class:"empty-state"},ox={class:"filters-section"},sx={class:"search-group"},ax=["placeholder"],ix={class:"report-list"},lx={key:0,class:"empty-state"},rx=["onClick"],cx={class:"report-card-title"},ux={class:"expand-icon"},dx={class:"report-card-stats"},hx={key:0,class:"report-card-body"},fx={class:"task-text"},px={key:0,class:"task-completed-by"},vx={key:0,class:"loading-state"},mx={key:1,class:"empty-state"},gx={class:"filters-section"},yx={class:"search-group"},kx=["placeholder"],bx={class:"report-list"},wx={key:0,class:"empty-state"},_x=["onClick"],Cx={class:"report-card-title"},Lx={class:"expand-icon"},Sx={class:"report-card-stats"},Ix={key:0,class:"report-card-body"},xx={key:0,class:"empty-state small"},$x={class:"task-text"},Tx={key:0,class:"task-completed-by"},Mx={key:0,class:"loading-state"},Ax={key:1,class:"empty-state"},Ex={class:"filters-section"},Px={class:"search-group"},Dx=["placeholder"],Rx={class:"report-list"},Ox={key:0,class:"empty-state"},Nx=["onClick"],Bx={class:"report-card-title"},Fx={class:"expand-icon"},Ux={class:"report-card-stats"},zx={class:"stat-badge secondary"},Hx={key:0,class:"report-card-body nested-body"},Vx=["onClick"],Gx={class:"nested-card-title"},qx={class:"expand-icon"},jx={class:"nested-card-stats"},Wx={key:0,class:"nested-card-body"},Zx={class:"task-text"},Kx={key:0,class:"task-completed-by"},Yx={key:0,class:"loading-state"},Jx={key:1,class:"empty-state"},Xx={class:"filters-section"},Qx={class:"search-group"},e$=["placeholder"],t$={class:"report-list"},n$={key:0,class:"empty-state"},o$=["onClick"],s$={class:"report-card-title"},a$={class:"expand-icon"},i$={class:"report-card-title-text"},l$={key:0,class:"report-card-description"},r$={class:"report-card-stats"},c$={class:"stat-badge secondary"},u$={key:0,class:"report-card-body nested-body"},d$=["onClick"],h$={class:"nested-card-title"},f$={class:"expand-icon"},p$={class:"nested-card-stats"},v$={key:0,class:"nested-card-body"},m$={class:"task-text"},g$={key:0,class:"task-completed-by"},y$={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null},detailedReport:{type:Object,default:null},isLoadingDetailedReport:{type:Boolean,default:!1}},emits:["add-checklist-item","select-checklist-item","reorder","load-detailed-report"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D("define"),l=D(""),c=D(""),d=D(""),h=D(""),f=D(""),m=D("all"),y=D("all"),k=D("all"),w=D("all"),x=D(new Set),A=D(new Set),E=D(new Set),_=D(new Set),C=D(new Set),S=D(new Set),$=be=>{i.value=be,(be==="byPerson"||be==="byTask"||be==="byCheckpoint"||be==="byArea")&&!s.detailedReport&&!s.isLoadingDetailedReport&&o("load-detailed-report")},R=be=>{x.value.has(be)?x.value.delete(be):(x.value.clear(),x.value.add(be)),x.value=new Set(x.value)},T=be=>{A.value.has(be)?A.value.delete(be):(A.value.clear(),A.value.add(be)),A.value=new Set(A.value)},O=be=>{E.value.has(be)?(E.value.delete(be),C.value.clear()):(E.value.clear(),C.value.clear(),E.value.add(be)),E.value=new Set(E.value),C.value=new Set(C.value)},M=be=>{_.value.has(be)?(_.value.delete(be),S.value.clear()):(_.value.clear(),S.value.clear(),_.value.add(be)),_.value=new Set(_.value),S.value=new Set(S.value)},U=(be,z)=>{const J=`${be}:${z}`;C.value.has(J)?C.value.delete(J):([...C.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>C.value.delete(ie)),C.value.add(J)),C.value=new Set(C.value)},F=(be,z)=>{const J=`${be}:${z}`;S.value.has(J)?S.value.delete(J):([...S.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>S.value.delete(ie)),S.value.add(J)),S.value=new Set(S.value)},j=H(()=>{if(!l.value.trim())return s.checklistItems;const be=l.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(z=>{const J=(z.text||"").toLowerCase();return be.every(de=>J.includes(de))})}),Z=H(()=>[...j.value].sort((be,z)=>be.displayOrder!==z.displayOrder?be.displayOrder-z.displayOrder:Qo(be.text,z.text))),Q=(be,z)=>be===0?"incomplete":be===z?"complete":"partial",re=(be,z)=>be===0?"not-started":be===z?"complete":"partial",K=H(()=>{if(!s.detailedReport?.detailedByPerson)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByPerson;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),ae=H(()=>{if(!s.detailedReport?.detailedByTask)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByTask;return{total:be.length,incomplete:be.filter(z=>Q(z.completedCount,z.applicableCount)==="incomplete").length,partial:be.filter(z=>Q(z.completedCount,z.applicableCount)==="partial").length,complete:be.filter(z=>Q(z.completedCount,z.applicableCount)==="complete").length}}),q=H(()=>{if(!s.detailedReport?.detailedByCheckpoint)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByCheckpoint;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),Y=H(()=>{if(!s.detailedReport?.detailedByArea)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByArea;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),te=H(()=>{if(!s.detailedReport?.detailedByPerson)return[];let be=s.detailedReport.detailedByPerson;if(m.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===m.value)),c.value.trim()){const z=c.value.toLowerCase().trim().split(/\s+/);be=be.filter(J=>{const de=(J.marshalName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be}),ue=H(()=>{if(!s.detailedReport?.detailedByTask)return[];let be=s.detailedReport.detailedByTask;if(y.value!=="all"&&(be=be.filter(z=>Q(z.completedCount,z.applicableCount)===y.value)),d.value.trim()){const z=d.value.toLowerCase().trim().split(/\s+/);be=be.filter(J=>{const de=(J.text||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be}),_e=H(()=>{if(!s.detailedReport?.detailedByCheckpoint)return[];let be=[...s.detailedReport.detailedByCheckpoint];if(k.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===k.value)),h.value.trim()){const z=h.value.toLowerCase().trim().split(/\s+/);be=be.filter(J=>{const de=(J.checkpointName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be.sort((z,J)=>Qo(z.checkpointName,J.checkpointName)),be}),$e=H(()=>{if(!s.detailedReport?.detailedByArea)return[];let be=[...s.detailedReport.detailedByArea];if(w.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===w.value)),f.value.trim()){const z=f.value.toLowerCase().trim().split(/\s+/);be=be.filter(J=>{const de=(J.areaName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be.sort((z,J)=>Qo(z.areaName,J.areaName)),be}),De=be=>[...be].sort((z,J)=>z.displayOrder!==J.displayOrder?z.displayOrder-J.displayOrder:Qo(z.text,J.text)),Re=({changes:be})=>{o("reorder",be)};return(be,z)=>(p(),g("div",FI,[r("div",UI,[r("div",zI,[r("div",HI,[r("button",{class:le(["view-toggle-btn",{active:i.value==="define"}]),onClick:z[0]||(z[0]=J=>$("define"))}," Define ",2),r("button",{class:le(["view-toggle-btn",{active:i.value==="byArea"}]),onClick:z[1]||(z[1]=J=>$("byArea"))}," By "+b(B(n).area),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byCheckpoint"}]),onClick:z[2]||(z[2]=J=>$("byCheckpoint"))}," By "+b(B(n).checkpoint),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byPerson"}]),onClick:z[3]||(z[3]=J=>$("byPerson"))}," By "+b(B(n).person),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byTask"}]),onClick:z[4]||(z[4]=J=>$("byTask"))}," By "+b(B(n).checklist),3)]),i.value==="define"?(p(),g("button",{key:0,onClick:z[5]||(z[5]=J=>be.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+b(B(n).checklist),1)):P("",!0)]),i.value==="byArea"&&Y.value.total>0?(p(),g("div",VI,[Pe(Mt,{variant:"neutral",active:w.value==="all",onClick:z[6]||(z[6]=J=>w.value="all")},{default:Ve(()=>[Je(b(Y.value.total)+" total ",1)]),_:1},8,["active"]),Y.value.incomplete>0?(p(),Ge(Mt,{key:0,variant:"danger",active:w.value==="incomplete",onClick:z[7]||(z[7]=J=>w.value="incomplete")},{default:Ve(()=>[Je(b(Y.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),Y.value.partial>0?(p(),Ge(Mt,{key:1,variant:"warning",active:w.value==="partial",onClick:z[8]||(z[8]=J=>w.value="partial")},{default:Ve(()=>[Je(b(Y.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),Y.value.complete>0?(p(),Ge(Mt,{key:2,variant:"success",active:w.value==="complete",onClick:z[9]||(z[9]=J=>w.value="complete")},{default:Ve(()=>[Je(b(Y.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byCheckpoint"&&q.value.total>0?(p(),g("div",GI,[Pe(Mt,{variant:"neutral",active:k.value==="all",onClick:z[10]||(z[10]=J=>k.value="all")},{default:Ve(()=>[Je(b(q.value.total)+" total ",1)]),_:1},8,["active"]),q.value.incomplete>0?(p(),Ge(Mt,{key:0,variant:"danger",active:k.value==="incomplete",onClick:z[11]||(z[11]=J=>k.value="incomplete")},{default:Ve(()=>[Je(b(q.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),q.value.partial>0?(p(),Ge(Mt,{key:1,variant:"warning",active:k.value==="partial",onClick:z[12]||(z[12]=J=>k.value="partial")},{default:Ve(()=>[Je(b(q.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),q.value.complete>0?(p(),Ge(Mt,{key:2,variant:"success",active:k.value==="complete",onClick:z[13]||(z[13]=J=>k.value="complete")},{default:Ve(()=>[Je(b(q.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byPerson"&&K.value.total>0?(p(),g("div",qI,[Pe(Mt,{variant:"neutral",active:m.value==="all",onClick:z[14]||(z[14]=J=>m.value="all")},{default:Ve(()=>[Je(b(K.value.total)+" total ",1)]),_:1},8,["active"]),K.value.incomplete>0?(p(),Ge(Mt,{key:0,variant:"danger",active:m.value==="incomplete",onClick:z[15]||(z[15]=J=>m.value="incomplete")},{default:Ve(()=>[Je(b(K.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),K.value.partial>0?(p(),Ge(Mt,{key:1,variant:"warning",active:m.value==="partial",onClick:z[16]||(z[16]=J=>m.value="partial")},{default:Ve(()=>[Je(b(K.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),K.value.complete>0?(p(),Ge(Mt,{key:2,variant:"success",active:m.value==="complete",onClick:z[17]||(z[17]=J=>m.value="complete")},{default:Ve(()=>[Je(b(K.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byTask"&&ae.value.total>0?(p(),g("div",jI,[Pe(Mt,{variant:"neutral",active:y.value==="all",onClick:z[18]||(z[18]=J=>y.value="all")},{default:Ve(()=>[Je(b(ae.value.total)+" total ",1)]),_:1},8,["active"]),ae.value.incomplete>0?(p(),Ge(Mt,{key:0,variant:"danger",active:y.value==="incomplete",onClick:z[19]||(z[19]=J=>y.value="incomplete")},{default:Ve(()=>[Je(b(ae.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),ae.value.partial>0?(p(),Ge(Mt,{key:1,variant:"warning",active:y.value==="partial",onClick:z[20]||(z[20]=J=>y.value="partial")},{default:Ve(()=>[Je(b(ae.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),ae.value.complete>0?(p(),Ge(Mt,{key:2,variant:"success",active:y.value==="complete",onClick:z[21]||(z[21]=J=>y.value="complete")},{default:Ve(()=>[Je(b(ae.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),i.value==="define"?(p(),g(Se,{key:0},[r("div",WI,[r("div",ZI,[We(r("input",{"onUpdate:modelValue":z[22]||(z[22]=J=>l.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checklists}...`},null,8,KI),[[st,l.value]])])]),r("div",YI,[j.value.length===0?(p(),g("div",JI,[r("p",null,b(l.value?`No ${B(n).checklists} match your search.`:`No ${B(n).checklists} yet. Create one to get started!`),1)])):(p(),Ge(il,{key:1,items:Z.value,"item-key":"itemId",disabled:!!l.value,onReorder:Re},{item:Ve(({element:J})=>[r("div",XI,[l.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",QI,[r("div",{class:"checklist-item-title",onClick:de=>be.$emit("select-checklist-item",J,"details")},[r("strong",null,b(J.text),1)],8,ex),Pe(nl,{class:"checklist-item-scopes","scope-configurations":J.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:de=>be.$emit("select-checklist-item",J,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])])]),_:1},8,["items","disabled"]))])],64)):i.value==="byPerson"?(p(),g(Se,{key:1},[e.isLoadingDetailedReport?(p(),g("div",tx,[...z[27]||(z[27]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",ox,[r("div",sx,[We(r("input",{"onUpdate:modelValue":z[23]||(z[23]=J=>c.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).people}...`},null,8,ax),[[st,c.value]])])]),r("div",ix,[te.value.length===0?(p(),g("div",lx,[r("p",null,b(c.value||m.value!=="all"?`No ${B(n).people} match your filters.`:`No ${B(n).people} with ${B(n).checklists}.`),1)])):P("",!0),(p(!0),g(Se,null,je(te.value,J=>(p(),g("div",{key:J.marshalId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>R(J.marshalId)},[r("div",cx,[r("span",ux,b(x.value.has(J.marshalId)?"":""),1),r("strong",null,b(J.marshalName),1)]),r("div",dx,[r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},b(J.completedTasks)+" / "+b(J.totalTasks),3)])],8,rx),x.value.has(J.marshalId)?(p(),g("div",hx,[(p(!0),g(Se,null,je(De(J.tasks),de=>(p(),g("div",{key:de.itemId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},b(de.isCompleted?"":""),3),r("span",fx,b(de.text),1),de.isCompleted&&de.completedBy?(p(),g("span",px," by "+b(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",nx,[...z[28]||(z[28]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byTask"?(p(),g(Se,{key:2},[e.isLoadingDetailedReport?(p(),g("div",vx,[...z[29]||(z[29]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",gx,[r("div",yx,[We(r("input",{"onUpdate:modelValue":z[24]||(z[24]=J=>d.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checklists}...`},null,8,kx),[[st,d.value]])])]),r("div",bx,[ue.value.length===0?(p(),g("div",wx,[r("p",null,b(d.value||y.value!=="all"?`No ${B(n).checklists} match your filters.`:`No ${B(n).checklists} defined.`),1)])):P("",!0),(p(!0),g(Se,null,je(ue.value,J=>(p(),g("div",{key:J.itemId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>T(J.itemId)},[r("div",Cx,[r("span",Lx,b(A.value.has(J.itemId)?"":""),1),r("strong",null,b(J.text),1)]),r("div",Sx,[r("span",{class:le(["stat-badge",re(J.completedCount,J.applicableCount)])},b(J.completedCount)+" / "+b(J.applicableCount),3)])],8,_x),A.value.has(J.itemId)?(p(),g("div",Ix,[J.marshals.length===0?(p(),g("div",xx,[r("p",null,"No "+b(B(n).people)+" assigned to this "+b(B(n).checklist)+".",1)])):P("",!0),(p(!0),g(Se,null,je(J.marshals,de=>(p(),g("div",{key:de.marshalId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},b(de.isCompleted?"":""),3),r("span",$x,b(de.marshalName),1),de.isCompleted&&de.completedBy?(p(),g("span",Tx," by "+b(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",mx,[...z[30]||(z[30]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byArea"?(p(),g(Se,{key:3},[e.isLoadingDetailedReport?(p(),g("div",Mx,[...z[31]||(z[31]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",Ex,[r("div",Px,[We(r("input",{"onUpdate:modelValue":z[25]||(z[25]=J=>f.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).areas}...`},null,8,Dx),[[st,f.value]])])]),r("div",Rx,[$e.value.length===0?(p(),g("div",Ox,[r("p",null,b(f.value||w.value!=="all"?`No ${B(n).areas} match your filters.`:`No ${B(n).areas} with ${B(n).people}.`),1)])):P("",!0),(p(!0),g(Se,null,je($e.value,J=>(p(),g("div",{key:J.areaId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>M(J.areaId)},[r("div",Bx,[r("span",Fx,b(_.value.has(J.areaId)?"":""),1),r("strong",null,b(J.areaName),1)]),r("div",Ux,[r("span",zx,b(J.totalPeople)+" "+b(J.totalPeople===1?B(n).person:B(n).people),1),r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},b(J.completedTasks)+" / "+b(J.totalTasks),3)])],8,Nx),_.value.has(J.areaId)?(p(),g("div",Hx,[(p(!0),g(Se,null,je(J.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:rt(ie=>F(J.areaId,de.marshalId),["stop"])},[r("div",Gx,[r("span",qx,b(S.value.has(`${J.areaId}:${de.marshalId}`)?"":""),1),r("strong",null,b(de.marshalName),1)]),r("div",jx,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},b(de.completedTasks)+" / "+b(de.totalTasks),3)])],8,Vx),S.value.has(`${J.areaId}:${de.marshalId}`)?(p(),g("div",Wx,[(p(!0),g(Se,null,je(De(de.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},b(ie.isCompleted?"":""),3),r("span",Zx,b(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",Kx," by "+b(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",Ax,[...z[32]||(z[32]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byCheckpoint"?(p(),g(Se,{key:4},[e.isLoadingDetailedReport?(p(),g("div",Yx,[...z[33]||(z[33]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",Xx,[r("div",Qx,[We(r("input",{"onUpdate:modelValue":z[26]||(z[26]=J=>h.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checkpoints}...`},null,8,e$),[[st,h.value]])])]),r("div",t$,[_e.value.length===0?(p(),g("div",n$,[r("p",null,b(h.value||k.value!=="all"?`No ${B(n).checkpoints} match your filters.`:`No ${B(n).checkpoints} with ${B(n).people}.`),1)])):P("",!0),(p(!0),g(Se,null,je(_e.value,J=>(p(),g("div",{key:J.checkpointId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>O(J.checkpointId)},[r("div",s$,[r("span",a$,b(E.value.has(J.checkpointId)?"":""),1),r("div",i$,[r("strong",null,b(J.checkpointName),1),J.checkpointDescription?(p(),g("span",l$,b(J.checkpointDescription),1)):P("",!0)])]),r("div",r$,[r("span",c$,b(J.totalPeople)+" "+b(J.totalPeople===1?B(n).person:B(n).people),1),r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},b(J.completedTasks)+" / "+b(J.totalTasks),3)])],8,o$),E.value.has(J.checkpointId)?(p(),g("div",u$,[(p(!0),g(Se,null,je(J.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:rt(ie=>U(J.checkpointId,de.marshalId),["stop"])},[r("div",h$,[r("span",f$,b(C.value.has(`${J.checkpointId}:${de.marshalId}`)?"":""),1),r("strong",null,b(de.marshalName),1)]),r("div",p$,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},b(de.completedTasks)+" / "+b(de.totalTasks),3)])],8,d$),C.value.has(`${J.checkpointId}:${de.marshalId}`)?(p(),g("div",v$,[(p(!0),g(Se,null,je(De(de.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},b(ie.isCompleted?"":""),3),r("span",m$,b(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",g$," by "+b(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",Jx,[...z[34]||(z[34]=[r("p",null,"No report data available.",-1)])]))],64)):P("",!0)]))}},k$=Ke(y$,[["__scopeId","data-v-48e233e8"]]),b$={class:"notes-tab"},w$={class:"tab-header"},_$={class:"button-group"},C$={class:"filters-section"},L$={class:"search-group"},S$={class:"notes-list"},I$={key:0,class:"empty-state"},x$=["onClick"],$$={class:"note-header"},T$={class:"note-title-row"},M$={key:0,class:"pin-icon",title:"Pinned"},A$={key:1,class:"emergency-indicator",title:"Shown in emergency info"},E$={class:"note-meta"},P$={key:0,class:"category-badge"},D$={class:"created-info"},R$={key:0,class:"note-preview"},O$={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=H(()=>{if(!o.value.trim())return n.notes;const f=o.value.toLowerCase().trim().split(/\s+/);return n.notes.filter(m=>{const y=`${m.title||""} ${m.content||""} ${m.priority||""}`.toLowerCase();return f.every(k=>y.includes(k))})}),l=H(()=>{const f={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((m,y)=>{if(m.isPinned!==y.isPinned)return m.isPinned?-1:1;const k=f[m.priority]??2,w=f[y.priority]??2;return k!==w?k-w:m.displayOrder!==y.displayOrder?m.displayOrder-y.displayOrder:Qo(m.title,y.title)})}),c=({changes:f})=>{const m=f.map(y=>({id:y.id,displayOrder:y.displayOrder}));s("reorder",m)},d=f=>{if(!f)return"";const m=150;return f.length<=m?f:f.substring(0,m)+"..."},h=f=>{if(!f)return"";const m=new Date(f),k=new Date-m,w=Math.floor(k/6e4),x=Math.floor(k/36e5),A=Math.floor(k/864e5);return w<1?"Just now":w<60?`${w}m ago`:x<24?`${x}h ago`:A<7?`${A}d ago`:m.toLocaleDateString()};return(f,m)=>(p(),g("div",b$,[r("div",w$,[r("div",_$,[r("button",{onClick:m[0]||(m[0]=y=>f.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",C$,[r("div",L$,[We(r("input",{"onUpdate:modelValue":m[1]||(m[1]=y=>o.value=y),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,o.value]])])]),r("div",S$,[i.value.length===0?(p(),g("div",I$,[r("p",null,b(o.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):(p(),Ge(il,{key:1,items:l.value,"item-key":"noteId","pinned-key":"isPinned",disabled:!!o.value,onReorder:c},{item:Ve(({element:y})=>[r("div",{class:le(["note-card",{pinned:y.isPinned}])},[o.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",{class:"note-content",onClick:k=>f.$emit("select-note",y)},[r("div",$$,[r("div",T$,[y.isPinned?(p(),g("span",M$,"")):P("",!0),r("span",{class:le(["priority-indicator",y.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,b(y.title),1),y.showInEmergencyInfo?(p(),g("span",A$,"")):P("",!0)]),r("div",E$,[y.category?(p(),g("span",P$,b(y.category),1)):P("",!0),r("span",D$,b(h(y.createdAt)),1)])]),y.content?(p(),g("div",R$,b(d(y.content)),1)):P("",!0),Pe(nl,{"scope-configurations":y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],8,x$)],2)]),_:1},8,["items","disabled"]))])]))}},N$=Ke(O$,[["__scopeId","data-v-715ffc72"]]),B$={class:"contacts-tab"},F$={class:"tab-header"},U$={class:"button-group"},z$={key:0,class:"status-pills"},H$={class:"filters-section"},V$={class:"search-group"},G$={class:"contacts-list"},q$={key:0,class:"empty-state"},j$=["onClick"],W$={class:"contact-header"},Z$={class:"contact-name-row"},K$={key:0,class:"pin-icon",title:"Pinned"},Y$={key:1,class:"primary-badge",title:"Primary contact"},J$={key:2,class:"emergency-indicator",title:"Shown in emergency info"},X$={class:"contact-roles"},Q$={class:"contact-details"},eT={key:0,class:"contact-detail"},tT={key:1,class:"contact-detail"},nT={key:0,class:"contact-notes"},oT={key:2,class:"no-scope-warning"},sT={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]}},emits:["add-contact","select-contact","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=D("all"),l=H(()=>n.contacts.filter(C=>!C.scopeConfigurations||C.scopeConfigurations.length===0).length),c=H(()=>n.contacts.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0).length),d=C=>{i.value=C},h=C=>C?C.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=H(()=>{const C=new Map;for(const S of n.roleDefinitions)C.set(S.roleId,S.name),C.set(S.name,S.name);return C}),m=C=>{if(!C)return"";const S=f.value.get(C);return S||C.replace(/([A-Z])/g," $1").replace(/^./,$=>$.toUpperCase()).trim()},y=C=>C.roles&&Array.isArray(C.roles)&&C.roles.length>0?C.roles:C.role?[C.role]:[],k=C=>y(C).map(m).join(" "),w=C=>{if(!C)return"";const S=100;return C.length<=S?C:C.substring(0,S)+"..."},x=H(()=>{let C=n.contacts;if(i.value==="no-scope"?C=C.filter(S=>!S.scopeConfigurations||S.scopeConfigurations.length===0):i.value==="with-scope"&&(C=C.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0)),o.value.trim()){const $=h(o.value).split(" ").filter(R=>R.length>0);C=C.filter(R=>{const T=k(R),O=h(`${R.name||""} ${T} ${R.email||""} ${R.phone||""}`);return $.every(M=>O.includes(M))})}return C}),A=H(()=>[...x.value].sort((C,S)=>{if(C.isPinned!==S.isPinned)return C.isPinned?-1:1;const $=C.displayOrder||0,R=S.displayOrder||0;return $!==R?$-R:(C.name||"").localeCompare(S.name||"",void 0,{sensitivity:"base"})})),E=H(()=>{const C=o.value.trim();return i.value==="no-scope"?C?"No unassigned contacts match your search.":"All contacts are assigned.":i.value==="with-scope"?C?"No assigned contacts match your search.":"No contacts are assigned yet.":C?"No contacts match your search.":"No contacts yet. Create one to get started!"}),_=({changes:C})=>{s("reorder",C)};return(C,S)=>(p(),g("div",B$,[r("div",F$,[r("div",U$,[r("button",{onClick:S[0]||(S[0]=$=>C.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(p(),g("div",z$,[Pe(Mt,{variant:"neutral",active:i.value==="all",onClick:S[1]||(S[1]=$=>d("all"))},{default:Ve(()=>[Je(b(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0&&c.value<e.contacts.length?(p(),Ge(Mt,{key:0,variant:"success",active:i.value==="with-scope",onClick:S[2]||(S[2]=$=>d("with-scope"))},{default:Ve(()=>[Je(b(c.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),l.value>0&&l.value<e.contacts.length?(p(),Ge(Mt,{key:1,variant:"danger",active:i.value==="no-scope",onClick:S[3]||(S[3]=$=>d("no-scope"))},{default:Ve(()=>[Je(b(l.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",H$,[r("div",V$,[We(r("input",{"onUpdate:modelValue":S[4]||(S[4]=$=>o.value=$),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,o.value]])])]),r("div",G$,[x.value.length===0?(p(),g("div",q$,[r("p",null,b(E.value),1)])):(p(),Ge(il,{key:1,items:A.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!!o.value||i.value!=="all",onReorder:_},{item:Ve(({element:$})=>[r("div",{class:le(["contact-card",{pinned:$.isPinned,primary:$.isPrimary}])},[!o.value&&i.value==="all"?(p(),Ge(ll,{key:0})):P("",!0),r("div",{class:"contact-content",onClick:R=>C.$emit("select-contact",$)},[r("div",W$,[r("div",Z$,[$.isPinned?(p(),g("span",K$,"")):P("",!0),$.isPrimary?(p(),g("span",Y$,"")):P("",!0),r("strong",null,b($.name),1),$.showInEmergencyInfo?(p(),g("span",J$,"")):P("",!0)]),r("div",X$,[(p(!0),g(Se,null,je(y($),R=>(p(),g("span",{key:R,class:le(["role-badge",{"emergency-role":R==="Emergency"}])},b(m(R)),3))),128))])]),r("div",Q$,[$.phone?(p(),g("span",eT,b($.phone),1)):P("",!0),$.email?(p(),g("span",tT,b($.email),1)):P("",!0)]),$.notes?(p(),g("div",nT,b(w($.notes)),1)):P("",!0),$.scopeConfigurations&&$.scopeConfigurations.length>0?(p(),Ge(nl,{key:1,"scope-configurations":$.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("div",oT," No visibility scope configured "))],8,j$)],2)]),_:1},8,["items","disabled"]))])]))}},aT=Ke(sT,[["__scopeId","data-v-83f433bf"]]),iT={class:"roles-tab"},lT={class:"tab-header"},rT={class:"button-group"},cT={key:0,class:"status-pills"},uT={class:"filters-section"},dT={class:"search-group"},hT={class:"roles-list"},fT={key:0,class:"empty-state"},pT=["onClick"],vT={class:"role-header"},mT={class:"role-name-row"},gT={key:0,class:"built-in-badge",title:"Built-in role"},yT={class:"role-usage"},kT={key:0,class:"role-notes"},bT={key:1,class:"role-notes empty"},wT={__name:"RolesTab",props:{roleDefinitions:{type:Array,required:!0}},emits:["add-role","select-role","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=H(()=>n.roleDefinitions.reduce((y,k)=>y+(k.usageCount||0),0)),l=y=>y?y.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",c=y=>{if(!y)return"";const k=150;return y.length<=k?y:y.substring(0,k)+"..."},d=H(()=>{if(!o.value.trim())return n.roleDefinitions;const k=l(o.value).split(" ").filter(w=>w.length>0);return n.roleDefinitions.filter(w=>{const x=l(`${w.name||""} ${w.notes||""}`);return k.every(A=>x.includes(A))})}),h=H(()=>[...d.value].sort((y,k)=>{const w=y.displayOrder||0,x=k.displayOrder||0;return w!==x?w-x:(y.name||"").localeCompare(k.name||"",void 0,{numeric:!0,sensitivity:"base"})})),f=H(()=>o.value.trim()?"No roles match your search.":"No roles defined yet. Create one to get started!"),m=({changes:y})=>{s("reorder",y)};return(y,k)=>(p(),g("div",iT,[r("div",lT,[r("div",rT,[r("button",{onClick:k[0]||(k[0]=w=>y.$emit("add-role")),class:"btn btn-primary"}," Add role ")]),e.roleDefinitions.length>0?(p(),g("div",cT,[Pe(Mt,{variant:"neutral"},{default:Ve(()=>[Je(b(e.roleDefinitions.length)+" "+b(e.roleDefinitions.length===1?"role":"roles"),1)]),_:1}),i.value>0?(p(),Ge(Mt,{key:0,variant:"success"},{default:Ve(()=>[Je(b(i.value)+" "+b(i.value===1?"assignment":"assignments"),1)]),_:1})):P("",!0)])):P("",!0)]),r("div",uT,[r("div",dT,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>o.value=w),type:"text",class:"search-input",placeholder:"Search by name or notes..."},null,512),[[st,o.value]])])]),r("div",hT,[d.value.length===0?(p(),g("div",fT,[r("p",null,b(f.value),1)])):(p(),Ge(il,{key:1,items:h.value,"item-key":"roleId",disabled:!!o.value,onReorder:m},{item:Ve(({element:w})=>[r("div",{class:le(["role-card",{"built-in":w.isBuiltIn}])},[o.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",{class:"role-content",onClick:x=>y.$emit("select-role",w)},[r("div",vT,[r("div",mT,[r("strong",null,b(w.name),1),w.isBuiltIn?(p(),g("span",gT,"Built-in")):P("",!0)]),r("div",yT,[r("span",{class:le(["usage-badge",{"has-usage":w.usageCount>0}])},b(w.usageCount)+" "+b(w.usageCount===1?"person":"people"),3)])]),w.notes?(p(),g("div",kT,b(c(w.notes)),1)):(p(),g("div",bT," No notes "))],8,pT)],2)]),_:1},8,["items","disabled"]))])]))}},_T=Ke(wT,[["__scopeId","data-v-634d49c0"]]),g1=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],CT={class:"event-details-tab"},LT={class:"event-info-card"},ST={class:"form-group"},IT={class:"form-group"},xT={class:"form-row"},$T={class:"form-group"},TT={class:"form-group"},MT=["value"],AT={class:"form-actions"},ET=["disabled"],PT={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const n=e,s=t,o=D({...n.eventData});Ye(()=>n.eventData,c=>{o.value={...c}},{deep:!0});const i=()=>{s("update:formDirty",!0)},l=()=>{s("submit",{...o.value})};return(c,d)=>(p(),g("div",CT,[r("div",LT,[r("form",{onSubmit:rt(l,["prevent"]),class:"event-details-form"},[r("div",ST,[d[4]||(d[4]=r("label",null,"Event name",-1)),We(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>o.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.name]])]),r("div",IT,[d[5]||(d[5]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>o.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[st,o.value.description]])]),r("div",xT,[r("div",$T,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),We(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>o.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.eventDate]])]),r("div",TT,[d[7]||(d[7]=r("label",null,"Time zone",-1)),We(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(p(!0),g(Se,null,je(B(g1),h=>(p(),g("option",{key:h.value,value:h.value},b(h.label),9,MT))),128))],544),[[no,o.value.timeZoneId]])])]),r("div",AT,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,ET)])],32)])]))}},DT=Ke(PT,[["__scopeId","data-v-2754c3cc"]]),RT={class:"admins-list"},OT={class:"admin-info"},NT={class:"admin-role"},BT=["onClick"],FT={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,n)=>(p(),g("div",null,[r("button",{onClick:n[0]||(n[0]=s=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",RT,[(p(!0),g(Se,null,je(e.admins,s=>(p(),g("div",{key:s.userEmail,class:"admin-item"},[r("div",OT,[r("strong",null,b(s.userEmail),1),r("span",NT,b(s.role),1)]),e.admins.length>1?(p(),g("button",{key:0,onClick:o=>t.$emit("remove-admin",s.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,BT)):P("",!0)]))),128))])]))}},UT=Ke(FT,[["__scopeId","data-v-e526860b"]]),zT={class:"modal-content"},HT={class:"modal-body"},VT={class:"preview-section"},GT={class:"map-preview"},qT=["innerHTML"],jT={class:"options-grid"},WT={class:"option-button-content"},ZT={class:"option-button-value icon-value"},KT=["innerHTML"],YT={class:"option-button-content"},JT={class:"option-button-value color-value"},XT=["disabled"],QT={class:"option-button-content"},eM={class:"option-button-value color-value"},tM={class:"option-button-content"},nM={class:"option-button-value icon-value"},oM=["innerHTML"],sM=["disabled"],aM={class:"option-button-content"},iM={class:"option-button-value color-value"},lM={class:"option-button-content"},rM={class:"option-button-value"},cM={class:"option-button-content"},uM={class:"option-button-value"},dM={key:0,class:"centered-popup"},hM={class:"popup-grid"},fM=["onClick"],pM=["innerHTML"],vM={key:0},mM={key:1,class:"centered-popup"},gM={class:"popup-grid"},yM=["title","onClick"],kM=["innerHTML"],bM={key:0},wM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},_M={key:1,class:"custom-check-mark"},CM={key:0,class:"custom-hex-input"},LM={class:"hex-input-row"},SM=["disabled"],IM={key:0,class:"hex-error"},xM={key:2,class:"centered-popup"},$M={class:"popup-grid"},TM=["title","onClick"],MM=["innerHTML"],AM={key:0},EM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},PM={key:1,class:"custom-check-mark"},DM={key:0,class:"custom-hex-input"},RM={class:"hex-input-row"},OM=["disabled"],NM={key:0,class:"hex-error"},BM={key:3,class:"centered-popup icon-popup"},FM={class:"popup-grid"},UM=["onClick"],zM=["innerHTML"],HM={key:0},VM={key:4,class:"centered-popup"},GM={class:"popup-grid"},qM=["title","onClick"],jM=["innerHTML"],WM={key:0},ZM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},KM={key:1,class:"custom-check-mark"},YM={key:0,class:"custom-hex-input"},JM={class:"hex-input-row"},XM=["disabled"],QM={key:0,class:"hex-error"},eA={key:5,class:"centered-popup"},tA={class:"size-grid"},nA=["onClick"],oA=["innerHTML"],sA={key:6,class:"centered-popup"},aA={class:"rotation-content"},iA={class:"rotation-preview-container"},lA=["innerHTML"],rA={class:"rotation-control"},cA={class:"rotation-slider-container"},uA=["value"],dA={class:"rotation-value"},hA={class:"rotation-presets"},fA="#667eea",pA={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const n=e,s=t,o=D(n.backgroundShape||"circle"),i=D(n.iconType||"none"),l=D(n.backgroundColor||""),c=D(n.borderColor||""),d=D(n.iconColor||""),h=D(n.size||"100"),f=D(n.mapRotation??""),m=D(null),y=D(!1),k=D(!1),w=D(!1),x=D(""),A=D(""),E=D(""),_=D(null),C=D(null),S=D(null),$=pe=>pe==="default"?n.inheritedBackgroundShape||"circle":pe==="none"?"none":pe||"circle",R=pe=>pe==="default"||!pe?q():pe==="none"?"transparent":pe,T=pe=>pe==="default"?n.inheritedBorderColor||"#ffffff":pe==="none"||!pe?"transparent":pe,O=pe=>{if(pe==="default"){const ve=n.inheritedType;return ve&&ve!=="default"&&Qi(ve).category==="content"?ve:"none"}return pe==="none"||!pe?"none":pe},M=pe=>pe==="default"||!pe?n.inheritedIconColor||"#ffffff":pe==="none"?"transparent":pe,U=pe=>pe==="default"?n.inheritedSize||"100":pe||"100",F=pe=>{if(pe==="default"||pe===""){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null&&parseInt(ve,10)||0}return parseInt(pe,10)||0},j=H(()=>{const pe=n.inheritedBackgroundShape||"circle",ve=Uc.find(Ie=>Ie.value===pe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ve})`,showLabel:!0},...Uc.filter(Ie=>Ie.value!=="none").map(Ie=>({...Ie,showLabel:!1}))]}),Z=H(()=>{const pe=Su.filter(lt=>lt.category==="content"),ve=[{value:"none",label:"None",category:"content",showLabel:!0}],Ie=n.inheritedType;if(Ie&&Ie!=="default"){const lt=Qi(Ie);lt.category==="content"&&ve.push({value:"default",label:`Default (${lt.label||Ie})`,category:"content",showLabel:!0})}return ve.push(...pe.map(lt=>({...lt,showLabel:!1}))),ve}),Q=H(()=>{const pe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${pe[n.inheritedSize]||"Normal"})`},...w2.map(Ie=>({value:Ie.value,label:pe[Ie.value]||Ie.label}))]}),re=H(()=>$(o.value)!=="none"),K=H(()=>O(i.value)!=="none"),ae=H(()=>{const pe=n.inheritedBackgroundColor;return pe&&pe!=="default"&&pe.startsWith("#")?pe:fA}),q=()=>ae.value,Y=H(()=>l.value&&l.value!=="default"?l.value:q()),te=H(()=>c.value==="none"?"transparent":c.value?c.value:n.inheritedBorderColor&&n.inheritedBorderColor!=="none"?n.inheritedBorderColor:"#ffffff"),ue=H(()=>d.value?d.value:n.inheritedIconColor?n.inheritedIconColor:"#ffffff"),_e=H(()=>{const pe=ae.value,ve=Un.find(Ie=>Ie.hex.toLowerCase()===pe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},...Un.map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),$e=H(()=>{const pe=n.inheritedBorderColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Ie=>Ie.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Ie=>Ie.hex!=="#ffffff").map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),De=H(()=>{const pe=n.inheritedIconColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Ie=>Ie.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Ie=>Ie.hex!=="#ffffff").map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),Re=pe=>pe==="default"?!l.value||l.value==="default":l.value===pe,be=pe=>pe==="#ffffff"?!d.value||d.value==="#ffffff":d.value===pe,z=H(()=>{const pe=l.value;return!pe||pe==="default"||pe==="none"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),J=H(()=>{const pe=c.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),de=H(()=>{const pe=d.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),ie=H(()=>{if(!x.value)return!1;const pe=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Ae=H(()=>{if(!A.value)return!1;const pe=A.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),G=H(()=>{if(!E.value)return!1;const pe=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),X=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedBackgroundShape;return Ie?`Default (${Uc.find(Qe=>Qe.value===Ie)?.label||"Circle"})`:"Default (Circle)"}const ve=Uc.find(Ie=>Ie.value===pe);return ve?ve.label:"Circle"},ee=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedType;if(Ie&&Ie!=="default"){const lt=Qi(Ie);if(lt.category==="content")return`Default (${lt.label||Ie})`}return"Default"}const ve=Su.find(Ie=>Ie.value===pe);return ve?ve.label:"None"},Ce=pe=>{if(pe==="none")return"None";if(!pe||pe==="default"){const Ie=ae.value;return`Default (${Un.find(Qe=>Qe.hex.toLowerCase()===Ie.toLowerCase())?.name||"Custom"})`}const ve=[...Un].find(Ie=>Ie.hex.toLowerCase()===pe.toLowerCase());return ve?ve.name:pe},Be=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedBorderColor;return Ie&&Ie!=="none"?`Default (${Ie==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Ie)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...$e.value].find(Ie=>Ie.hex===pe);return ve?ve.name:pe},Fe=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedIconColor;return Ie?`Default (${Ie==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Ie)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...De.value].find(Ie=>Ie.hex===pe);return ve?ve.name:pe},Ee=pe=>{const ve={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(pe==="default"){const Ie=n.inheritedSize;return`Default (${ve[Ie]||"Normal"})`}return ve[pe]||"Normal"},oe=pe=>{if(pe==="default"||pe===""||pe===void 0||pe===null){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null?`Default (${ve})`:"Default (0)"}return`${pe}`},ge=pe=>{if(pe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ve=$(pe),Ie=R(l.value),lt=T(c.value);return Gl[ve]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Gl[ve]({backgroundColor:Ie,borderColor:lt==="transparent"?"none":lt})}</svg>`:""},Ne=pe=>{const ve=O(pe);return ve==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:zn({type:ve,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Oe=pe=>{const ve=$(pe);if(ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Ie=R(l.value),lt=T(c.value),Qe=O(i.value),Ft=M(d.value);return zn({type:Qe!=="none"?Qe:ve,backgroundShape:ve,backgroundColor:Ie,borderColor:lt==="transparent"?"none":lt,iconColor:Ft,size:"100",outputSize:28})},xe=pe=>{const ve=R(pe),Ie=$(o.value),lt=T(c.value),Qe=O(i.value),Ft=M(d.value);return Ie==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Ie,backgroundShape:Ie,backgroundColor:ve==="transparent"?"#e2e8f0":ve,borderColor:lt==="transparent"?"none":lt,iconColor:Ft,size:"100",outputSize:28})},me=pe=>{const ve=T(pe),Ie=$(o.value),lt=R(l.value),Qe=O(i.value),Ft=M(d.value);return Ie==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ve}" stroke-width="2"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Ie,backgroundShape:Ie,backgroundColor:lt,borderColor:ve==="transparent"?"none":ve,iconColor:Ft,size:"100",outputSize:28})},Ze=pe=>{const ve=O(pe),Ie=$(o.value),lt=R(l.value),Qe=T(c.value),Ft=M(d.value);if(ve==="none"&&Ie==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const an=Ie!=="none"?Ie:"circle";return zn({type:ve!=="none"?ve:an,backgroundShape:an,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:Ft,size:"100",outputSize:42})},qe=pe=>{const ve=M(pe),Ie=$(o.value),lt=R(l.value),Qe=T(c.value),Ft=O(i.value);return Ft==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Ft,backgroundShape:Ie!=="none"?Ie:"circle",backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:ve==="transparent"?"#e2e8f0":ve,size:"100",outputSize:28})},fe=pe=>{const ve=U(pe),Ie=$(o.value),lt=R(l.value),Qe=T(c.value),Ft=O(i.value),an=M(d.value);if(Ie==="none"&&Ft==="none")return"";const yn=Ie!=="none"?Ie:"circle";return zn({type:Ft!=="none"?Ft:yn,backgroundShape:yn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:an,size:ve})},ke=H(()=>{const pe=$(o.value),ve=R(l.value),Ie=T(c.value),lt=O(i.value),Qe=M(d.value),Ft=U(h.value);return pe==="none"&&lt==="none"?"":zn(pe==="none"&&lt!=="none"?{type:lt,backgroundShape:"none",backgroundColor:ve,borderColor:"none",iconColor:Qe,size:Ft}:{type:lt!=="none"?lt:pe,backgroundShape:pe,backgroundColor:ve,borderColor:Ie==="transparent"?"none":Ie,iconColor:Qe,size:Ft})}),ne=pe=>{m.value=m.value===pe?null:pe},ye=()=>{m.value=null,y.value=!1,k.value=!1,w.value=!1},He=pe=>{o.value=pe,ye()},ct=pe=>{l.value=pe,ye()},ht=pe=>{c.value=pe,ye()},Nt=pe=>{i.value=pe,ye()},Lt=pe=>{d.value=pe,ye()},Bt=pe=>{h.value=pe,ye()},Et=pe=>{f.value=pe,ye()},yo=()=>{y.value=!y.value,y.value&&(z.value?x.value=l.value.replace(/^#/,""):x.value="",rn(()=>_.value?.focus()))},ko=()=>{k.value=!k.value,k.value&&(J.value?A.value=c.value.replace(/^#/,""):A.value="",rn(()=>C.value?.focus()))},ft=()=>{w.value=!w.value,w.value&&(de.value?E.value=d.value.replace(/^#/,""):E.value="",rn(()=>S.value?.focus()))},Pt=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},vt=()=>{A.value=A.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},An=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Ao=pe=>pe.length===3?pe[0]+pe[0]+pe[1]+pe[1]+pe[2]+pe[2]:pe,ao=()=>{if(!ie.value)return;const pe=Ao(x.value);l.value="#"+pe,y.value=!1,ye()},bo=()=>{if(!Ae.value)return;const pe=Ao(A.value);c.value="#"+pe,k.value=!1,ye()},Gt=()=>{if(!G.value)return;const pe=Ao(E.value);d.value="#"+pe,w.value=!1,ye()},As=pe=>{f.value=pe};Ye(()=>n.isOpen,pe=>{if(pe){const ve=n.backgroundShape&&n.backgroundShape!=="default"&&n.backgroundShape!=="circle",Ie=n.iconType&&n.iconType!=="none"&&n.iconType!=="default",lt=n.backgroundColor&&n.backgroundColor!=="",Qe=n.borderColor&&n.borderColor!=="",Ft=n.iconColor&&n.iconColor!=="",an=n.size&&n.size!==""&&n.size!=="100",yn=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null&&n.mapRotation!==0;ve||Ie||lt||Qe||Ft||an||yn?(o.value=n.backgroundShape||"default",i.value=n.iconType||"default",l.value=n.backgroundColor||"default",c.value=n.borderColor||"default",d.value=n.iconColor||"default",h.value=n.size||"default",f.value=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null?n.mapRotation:"default"):(o.value="default",i.value="default",l.value="default",c.value="default",d.value="default",h.value="default",f.value="default"),m.value=null}});const wo=()=>{ye(),s("update:isOpen",!1),s("cancel")},zo=()=>{ye();const pe=lt=>lt==="default"?"":lt;let ve="";i.value==="none"?ve="none":i.value&&i.value!=="default"&&(ve=i.value);let Ie="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Ie=parseInt(f.value,10)||0),s("apply",{iconType:ve,backgroundShape:pe(o.value),backgroundColor:pe(l.value),borderColor:pe(c.value),iconColor:pe(d.value),size:pe(h.value),mapRotation:Ie}),s("update:isOpen",!1)};return(pe,ve)=>e.isOpen?(p(),g("div",{key:0,class:"modal-overlay",onClick:rt(wo,["self"])},[r("div",zT,[r("div",{class:"modal-header"},[ve[18]||(ve[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:wo},"")]),r("div",HT,[r("div",VT,[r("div",GT,[ve[19]||(ve[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,qT)])]),r("div",jT,[r("button",{type:"button",class:le(["option-button",{active:m.value==="shape"}]),onClick:ve[0]||(ve[0]=Ie=>ne("shape"))},[r("div",WT,[ve[20]||(ve[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",ZT,[r("div",{class:"icon-preview-small",innerHTML:ge(o.value)},null,8,KT),r("span",null,b(X(o.value)),1)])]),ve[21]||(ve[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="bgColor"}]),onClick:ve[1]||(ve[1]=Ie=>ne("bgColor"))},[r("div",YT,[ve[22]||(ve[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",JT,[r("span",{class:"color-swatch",style:tt({backgroundColor:Y.value})},null,4),r("span",null,b(Ce(l.value)),1)])]),ve[23]||(ve[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="borderColor",disabled:!re.value}]),disabled:!re.value,onClick:ve[2]||(ve[2]=Ie=>ne("borderColor"))},[r("div",QT,[ve[24]||(ve[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",eM,[r("span",{class:le(["color-swatch",{"no-border":c.value==="none"}]),style:tt(c.value!=="none"?{backgroundColor:te.value}:{})},null,6),r("span",null,b(Be(c.value)),1)])]),ve[25]||(ve[25]=r("span",{class:"option-button-arrow"},"",-1))],10,XT),r("button",{type:"button",class:le(["option-button",{active:m.value==="icon"}]),onClick:ve[3]||(ve[3]=Ie=>ne("icon"))},[r("div",tM,[ve[26]||(ve[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",nM,[r("div",{class:"icon-preview-small",innerHTML:Ne(i.value)},null,8,oM),r("span",null,b(ee(i.value)),1)])]),ve[27]||(ve[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="iconColor",disabled:!K.value}]),disabled:!K.value,onClick:ve[4]||(ve[4]=Ie=>ne("iconColor"))},[r("div",aM,[ve[28]||(ve[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",iM,[r("span",{class:"color-swatch",style:tt({backgroundColor:ue.value})},null,4),r("span",null,b(Fe(d.value)),1)])]),ve[29]||(ve[29]=r("span",{class:"option-button-arrow"},"",-1))],10,sM),r("button",{type:"button",class:le(["option-button",{active:m.value==="size"}]),onClick:ve[5]||(ve[5]=Ie=>ne("size"))},[r("div",lM,[ve[30]||(ve[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",rM,b(Ee(h.value)),1)]),ve[31]||(ve[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:ve[6]||(ve[6]=Ie=>ne("mapRotation"))},[r("div",cM,[ve[32]||(ve[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",uM,b(oe(f.value)),1)]),ve[33]||(ve[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(p(),g("div",dM,[r("div",{class:"popup-header"},[ve[34]||(ve[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",hM,[(p(!0),g(Se,null,je(j.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["popup-grid-item",{selected:o.value===Ie.value}]),onClick:lt=>He(Ie.value)},[r("div",{class:"popup-item-preview",innerHTML:Oe(Ie.value)},null,8,pM),Ie.showLabel?(p(),g("span",vM,b(Ie.label),1)):P("",!0)],10,fM))),128))])])):P("",!0),m.value==="bgColor"?(p(),g("div",mM,[r("div",{class:"popup-header"},[ve[35]||(ve[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",gM,[(p(!0),g(Se,null,je(_e.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:Re(Ie.hex)}]),title:Ie.name,onClick:lt=>ct(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:xe(Ie.hex)},null,8,kM),Ie.showLabel?(p(),g("span",bM,b(Ie.name),1)):P("",!0)],10,yM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:z.value}]),style:tt(z.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:yo},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(z.value?{backgroundColor:l.value}:{})},[z.value?P("",!0):(p(),g("svg",wM,[...ve[36]||(ve[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),z.value?(p(),g("span",_M,"")):P("",!0)],4),ve[37]||(ve[37]=r("span",null,"Custom",-1))],6)]),y.value?(p(),g("div",CM,[ve[39]||(ve[39]=r("label",null,"Enter hex code",-1)),r("div",LM,[ve[38]||(ve[38]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"bgHexInput",ref:_,"onUpdate:modelValue":ve[7]||(ve[7]=Ie=>x.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:x.value&&!ie.value}]),onInput:Pt,onKeydown:Xo(ao,["enter"])},null,34),[[st,x.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:ie.value?"#"+x.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!ie.value,onClick:ao}," Apply ",8,SM)]),x.value&&!ie.value?(p(),g("span",IM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="borderColor"?(p(),g("div",xM,[r("div",{class:"popup-header"},[ve[40]||(ve[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",$M,[(p(!0),g(Se,null,je($e.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:c.value===Ie.hex}]),title:Ie.name,onClick:lt=>ht(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(Ie.hex)},null,8,MM),Ie.showLabel?(p(),g("span",AM,b(Ie.name),1)):P("",!0)],10,TM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:J.value}]),style:tt(J.value?{"--custom-color":c.value}:{}),title:"Custom colour",onClick:ko},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(J.value?{backgroundColor:c.value}:{})},[J.value?P("",!0):(p(),g("svg",EM,[...ve[41]||(ve[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),J.value?(p(),g("span",PM,"")):P("",!0)],4),ve[42]||(ve[42]=r("span",null,"Custom",-1))],6)]),k.value?(p(),g("div",DM,[ve[44]||(ve[44]=r("label",null,"Enter hex code",-1)),r("div",RM,[ve[43]||(ve[43]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"borderHexInput",ref:C,"onUpdate:modelValue":ve[8]||(ve[8]=Ie=>A.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!Ae.value}]),onInput:vt,onKeydown:Xo(bo,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:Ae.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Ae.value,onClick:bo}," Apply ",8,OM)]),A.value&&!Ae.value?(p(),g("span",NM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="icon"?(p(),g("div",BM,[r("div",{class:"popup-header"},[ve[45]||(ve[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",FM,[(p(!0),g(Se,null,je(Z.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["popup-grid-item",{selected:i.value===Ie.value}]),onClick:lt=>Nt(Ie.value)},[r("div",{class:"popup-item-preview",innerHTML:Ze(Ie.value)},null,8,zM),Ie.showLabel?(p(),g("span",HM,b(Ie.label),1)):P("",!0)],10,UM))),128))])])):P("",!0),m.value==="iconColor"?(p(),g("div",VM,[r("div",{class:"popup-header"},[ve[46]||(ve[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",GM,[(p(!0),g(Se,null,je(De.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:be(Ie.hex)}]),title:Ie.name,onClick:lt=>Lt(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:qe(Ie.hex)},null,8,jM),Ie.showLabel?(p(),g("span",WM,b(Ie.name),1)):P("",!0)],10,qM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:de.value}]),style:tt(de.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:ft},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(de.value?{backgroundColor:d.value}:{})},[de.value?P("",!0):(p(),g("svg",ZM,[...ve[47]||(ve[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),de.value?(p(),g("span",KM,"")):P("",!0)],4),ve[48]||(ve[48]=r("span",null,"Custom",-1))],6)]),w.value?(p(),g("div",YM,[ve[50]||(ve[50]=r("label",null,"Enter hex code",-1)),r("div",JM,[ve[49]||(ve[49]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"iconHexInput",ref:S,"onUpdate:modelValue":ve[9]||(ve[9]=Ie=>E.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!G.value}]),onInput:An,onKeydown:Xo(Gt,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:G.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!G.value,onClick:Gt}," Apply ",8,XM)]),E.value&&!G.value?(p(),g("span",QM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="size"?(p(),g("div",eA,[r("div",{class:"popup-header"},[ve[51]||(ve[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",tA,[(p(!0),g(Se,null,je(Q.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["size-grid-item",{selected:h.value===Ie.value}]),onClick:lt=>Bt(Ie.value)},[r("div",{class:"size-preview",innerHTML:fe(Ie.value)},null,8,oA),r("span",null,b(Ie.label),1)],10,nA))),128))])])):P("",!0),m.value==="mapRotation"?(p(),g("div",sA,[r("div",{class:"popup-header"},[ve[52]||(ve[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",aA,[r("div",iA,[r("div",{class:"rotation-preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,lA)]),ve[53]||(ve[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",rA,[r("button",{type:"button",class:le(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ve[10]||(ve[10]=Ie=>Et("default"))}," Default ",2),r("div",cA,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ve[11]||(ve[11]=Ie=>As(parseInt(Ie.target.value,10)))},null,40,uA),r("div",dA,b(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",hA,[r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ve[12]||(ve[12]=Ie=>Et(-90))},"-90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ve[13]||(ve[13]=Ie=>Et(-45))},"-45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===0}]),onClick:ve[14]||(ve[14]=Ie=>Et(0))},"0",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===45}]),onClick:ve[15]||(ve[15]=Ie=>Et(45))},"+45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===90}]),onClick:ve[16]||(ve[16]=Ie=>Et(90))},"+90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===180}]),onClick:ve[17]||(ve[17]=Ie=>Et(180))},"180",2)])])])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:wo},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:zo},"Apply")])])])):P("",!0)}},vA=Ke(pA,[["__scopeId","data-v-bbab1a46"]]),mA={class:"checkpoint-style-picker"},gA={class:"form-group"},yA={class:"style-options"},kA=["innerHTML"],bA={class:"option-label"},wA=["innerHTML"],_A="#667eea",CA={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const n=e,s=t,o=D(n.styleType),i=D(n.styleColor||""),l=D(n.styleBackgroundShape||"default"),c=D(n.styleBackgroundColor||""),d=D(n.styleBorderColor||""),h=D(n.styleIconColor||""),f=D(n.styleSize||"default"),m=D(n.styleMapRotation||""),y=F=>!F||F==="default"?!1:Qi(F).category==="content",k=D(n.styleType&&n.styleType!=="default"&&n.styleType!=="custom"&&y(n.styleType)?n.styleType:"default"),w=D(!1),x=H(()=>!!(o.value&&o.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||c.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),A=F=>F&&F!==""&&F!=="default",E=F=>F&&F.startsWith("#"),_=H(()=>{const j=A(n.inheritedStyleType),Z=A(n.inheritedBackgroundShape),Q=E(n.inheritedBackgroundColor)||E(n.inheritedStyleColor),re=E(n.inheritedBorderColor),K=E(n.inheritedIconColor),ae=A(n.inheritedSize);if(j||Z||Q||re||K||ae){const Y=j?n.inheritedStyleType:Z?n.inheritedBackgroundShape:"circle",te=(E(n.inheritedBackgroundColor)?n.inheritedBackgroundColor:null)||(E(n.inheritedStyleColor)?n.inheritedStyleColor:null)||_A;return zn({type:Y,backgroundShape:n.inheritedBackgroundShape||"circle",backgroundColor:te,borderColor:n.inheritedBorderColor||"#ffffff",iconColor:n.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=H(()=>{const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),S=H(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const j=parseInt(m.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),$=H(()=>{if(x.value){const F=k.value&&k.value!=="none"&&k.value!=="default";let j=null;n.inheritedStyleType&&n.inheritedStyleType!=="default"&&n.inheritedStyleType!=="custom"&&Qi(n.inheritedStyleType).category==="content"&&(j=n.inheritedStyleType);const Z=k.value==="default"&&j,Q=F||Z,re=F?k.value:Z?j:null,K=l.value&&l.value!=="default"?l.value:n.inheritedBackgroundShape||"circle",ae=Q?re:K,q=c.value||n.inheritedBackgroundColor||n.inheritedStyleColor||"#667eea",Y=d.value||n.inheritedBorderColor||"#ffffff",te=h.value||n.inheritedIconColor||"#ffffff";return zn({type:ae,backgroundShape:K,backgroundColor:q,borderColor:Y,iconColor:te,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),R=()=>{o.value="default",k.value="default",s("update:styleType","default"),l.value="default",c.value="",i.value="",d.value="",h.value="",f.value="default",m.value="",s("update:styleBackgroundShape",""),s("update:styleBackgroundColor",""),s("update:styleColor",""),s("update:styleBorderColor",""),s("update:styleIconColor",""),s("update:styleSize",""),s("update:styleMapRotation",""),U()},T=()=>{w.value=!0},O=F=>{F.iconType==="none"?k.value="none":F.iconType?k.value=F.iconType:k.value="default",l.value=F.backgroundShape||"default",c.value=F.backgroundColor||"",d.value=F.borderColor||"",h.value=F.iconColor||"",f.value=F.size||"default",m.value=F.mapRotation??"";const j=F.iconType==="none"||F.iconType&&F.iconType!==""||F.backgroundShape||F.backgroundColor||F.borderColor||F.iconColor||F.size||F.mapRotation!==""&&F.mapRotation!==0;F.iconType&&F.iconType!=="none"?o.value=F.iconType:j?o.value="custom":o.value="default",s("update:styleType",o.value),s("update:styleBackgroundShape",F.backgroundShape),s("update:styleBackgroundColor",F.backgroundColor),s("update:styleBorderColor",F.borderColor),s("update:styleIconColor",F.iconColor),s("update:styleSize",F.size),s("update:styleMapRotation",F.mapRotation??""),U()},M=()=>{},U=()=>{s("change",{styleType:o.value,styleColor:c.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:c.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:m.value})};return Ye(()=>n.styleType,F=>{o.value=F,F&&F!=="default"&&F!=="custom"&&y(F)?k.value=F:k.value="default"}),Ye(()=>n.styleColor,F=>{i.value=F||""}),Ye(()=>n.styleBackgroundShape,F=>{l.value=F||"default"}),Ye(()=>n.styleBackgroundColor,F=>{c.value=F||""}),Ye(()=>n.styleBorderColor,F=>{d.value=F||""}),Ye(()=>n.styleIconColor,F=>{h.value=F||""}),Ye(()=>n.styleSize,F=>{f.value=F||"default"}),Ye(()=>n.styleMapRotation,F=>{m.value=F??""}),(F,j)=>(p(),g("div",mA,[r("div",gA,[r("label",null,b(e.iconLabel),1),r("div",yA,[r("button",{type:"button",class:le(["style-option-button",{selected:!x.value}]),onClick:R},[r("div",{class:"option-preview",style:tt(C.value),innerHTML:_.value},null,12,kA),r("span",bA,b(e.defaultLabel),1)],2),r("button",{type:"button",class:le(["style-option-button",{selected:x.value}]),onClick:T},[r("div",{class:"option-preview",style:tt(S.value),innerHTML:$.value},null,12,wA),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Pe(vA,{isOpen:w.value,"onUpdate:isOpen":j[0]||(j[0]=Z=>w.value=Z),"icon-type":k.value,"background-shape":l.value,"background-color":c.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:O,onCancel:M},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Bf=Ke(CA,[["__scopeId","data-v-c066da64"]]),LA={class:"logo-uploader"},SA={key:0,class:"logo-preview"},IA=["src"],xA=["disabled"],$A={key:0,class:"upload-progress"},TA={key:1,class:"upload-prompt"},MA={key:2,class:"error-message"},Uv=5*1024*1024,AA={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:n}){const s=K=>K?K.startsWith("/api")?ai+K.substring(4):K:"",o=e;function i(){const K={},ae=localStorage.getItem("adminEmail");ae&&(K["X-Admin-Email"]=ae);const q=localStorage.getItem("sessionToken");return q&&(K.Authorization=`Bearer ${q}`),K}const l=n;function c(){l("staged-change",{hasPendingChanges:k.value!==null||x.value,isPendingDelete:x.value,displayUrl:w.value||(x.value?"":o.modelValue)||""})}const d=D(null),h=D(!1),f=D(!1),m=D(""),y=D(Date.now()),k=D(null),w=D(""),x=D(!1),A=H(()=>{if(o.staged){if(w.value)return!0;if(x.value)return!1}return!!o.modelValue}),E=H(()=>{if(o.staged&&x.value)return"";if(o.staged&&w.value)return w.value;if(!o.modelValue)return"";const K=s(o.modelValue),ae=K.includes("?")?"&":"?";return`${K}${ae}_t=${y.value}`});function _(){w.value&&(URL.revokeObjectURL(w.value),w.value="")}In(()=>{_()});const C=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function S(){h.value||d.value?.click()}function $(K){const ae=K.target.files?.[0];ae&&T(ae),d.value&&(d.value.value="")}function R(K){f.value=!1;const ae=K.dataTransfer?.files?.[0];ae&&T(ae)}async function T(K){if(m.value="",!C.includes(K.type)){m.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>Uv){m.value=`File too large. Maximum size is ${Uv/(1024*1024)}MB.`;return}if(o.staged){_(),k.value=K,w.value=URL.createObjectURL(K),x.value=!1,c();return}h.value=!0;try{const ae=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...i()},body:K});if(!ae.ok){const Y=await ae.text().catch(()=>"");let te=`Upload failed (${ae.status})`;try{te=JSON.parse(Y).message||te}catch{Y&&(te=Y)}throw new Error(te)}const q=await ae.json();y.value=Date.now(),l("update:modelValue",q.logoUrl)}catch(ae){console.error("Logo upload error:",ae),ae.name==="TypeError"&&ae.message==="Failed to fetch"?m.value="Network error. Check your connection or try a smaller file.":ae.message?.includes("401")||ae.message?.includes("403")?m.value="Not authorized. Please refresh the page and try again.":m.value=ae.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function O(){if(m.value="",o.staged){k.value?(_(),k.value=null):o.modelValue&&(x.value=!0),c();return}h.value=!0;try{const K=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}l("update:modelValue","")}catch(K){console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function M(){if(!k.value)return{success:!0,logoUrl:x.value?"":o.modelValue};h.value=!0,m.value="";try{const K=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!K.ok){const q=await K.text().catch(()=>"");let Y=`Upload failed (${K.status})`;try{Y=JSON.parse(q).message||Y}catch{q&&(Y=q)}throw new Error(Y)}const ae=await K.json();return y.value=Date.now(),_(),k.value=null,x.value=!1,{success:!0,logoUrl:ae.logoUrl}}catch(K){return console.error("Logo upload error:",K),m.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}async function U(){if(!x.value)return{success:!0};h.value=!0,m.value="";try{const K=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}return x.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}function F(){return k.value!==null||x.value}function j(){return k.value}function Z(){return x.value}function Q(){return w.value?w.value:x.value?"":s(o.modelValue)||""}function re(){_(),k.value=null,x.value=!1}return t({uploadStagedFile:M,deleteStagedLogo:U,hasPendingChanges:F,getStagedFile:j,isPendingDelete:Z,getDisplayUrl:Q,resetStagedState:re}),(K,ae)=>(p(),g("div",LA,[ae[4]||(ae[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),A.value?(p(),g("div",SA,[r("img",{src:E.value,alt:"Event logo",class:"logo-image"},null,8,IA),r("button",{type:"button",class:"remove-btn",onClick:O,disabled:h.value}," Remove ",8,xA)])):(p(),g("div",{key:1,class:le(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:ae[0]||(ae[0]=rt(q=>f.value=!0,["prevent"])),onDragleave:ae[1]||(ae[1]=rt(q=>f.value=!1,["prevent"])),onDrop:rt(R,["prevent"]),onClick:S},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:$},null,544),h.value?(p(),g("div",$A,[...ae[2]||(ae[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(p(),g("div",TA,[...ae[3]||(ae[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),m.value?(p(),g("div",MA,b(m.value),1)):P("",!0)]))}},EA=Ke(AA,[["__scopeId","data-v-bfb1b332"]]),y1=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function PA(){return{...y1[0]}}function DA(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}const RA={class:"marshal-mockup-container"},OA={class:"presets-section"},NA={class:"presets-row"},BA=["title","onClick"],FA={class:"preset-name"},UA={class:"mockup-frame"},zA={key:0,class:"logo-cover-bg"},HA=["src"],VA=["src"],GA={class:"header-center"},qA={class:"event-name"},jA={class:"mockup-buttons"},WA=["src"],ZA={class:"mockup-body"},KA={class:"mockup-card"},YA={class:"card-content"},JA={class:"editor-header"},XA={class:"editor-content"},QA={class:"color-grid-inline"},eE={class:"color-field"},tE={class:"color-swatches"},nE=["title","onClick"],oE={key:0,class:"check"},sE={class:"custom-color-wrapper"},aE={class:"hex-popup-header"},iE={class:"hex-input-row"},lE=["disabled"],rE={key:0,class:"hex-error"},cE={class:"gradient-toggle"},uE={key:0,class:"color-field"},dE={class:"color-swatches"},hE=["title","onClick"],fE={key:0,class:"check"},pE={class:"custom-color-wrapper"},vE={class:"hex-popup-header"},mE={class:"hex-input-row"},gE=["disabled"],yE={key:0,class:"hex-error"},kE={key:1,class:"logo-position-section"},bE={class:"position-buttons"},wE={class:"color-swatches"},_E=["title","onClick"],CE={key:0,class:"check"},LE={class:"custom-color-wrapper"},SE={class:"hex-popup-header"},IE={class:"hex-input-row"},xE=["disabled"],$E={key:0,class:"hex-error"},TE={class:"color-grid-inline"},ME={class:"color-field"},AE={class:"color-swatches"},EE=["title","onClick"],PE={key:0,class:"check"},DE={class:"custom-color-wrapper"},RE={class:"hex-popup-header"},OE={class:"hex-input-row"},NE=["disabled"],BE={key:0,class:"hex-error"},FE={class:"gradient-toggle"},UE={key:0,class:"color-field"},zE={class:"color-swatches"},HE=["title","onClick"],VE={key:0,class:"check"},GE={class:"custom-color-wrapper"},qE={class:"hex-popup-header"},jE={class:"hex-input-row"},WE=["disabled"],ZE={key:0,class:"hex-error"},KE={class:"editor-footer"},YE={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:n}){const s=Ee=>Ee?Ee.startsWith("/api")?ai+Ee.substring(4):Ee:"",o=Un,i=e,l=n,c=D(null),d=y1,h=D(!1),f=D(!1),m=D(null),y=D(!1),k=D(""),w=Ee=>{typeof Ee=="object"&&Ee!==null?(y.value=Ee.isPendingDelete,k.value=Ee.displayUrl||"",l("logo-staged-change",Ee.hasPendingChanges)):(m.value&&(y.value=m.value.isPendingDelete(),k.value=m.value.getDisplayUrl()||""),l("logo-staged-change",!!Ee))},x=D(null),A=D(""),E=D(null),_=D(null),C=D({left:"50%",right:"auto",transform:"translateX(-50%)"}),S=Ee=>Ee?!o.some(oe=>oe.hex.toLowerCase()===Ee.toLowerCase()):!1,$=Ee=>!Ee||!S(Ee)?"#666666":Iu(Ee),R=Ee=>!Ee||!S(Ee)?"#e0e0e0":Ee,T=H(()=>{if(!A.value)return!1;const Ee=A.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Ee)||/^[0-9A-Fa-f]{3}$/.test(Ee)}),O=(Ee,oe)=>{if(x.value===Ee)x.value=null;else{x.value=Ee;let ge="";switch(Ee){case"headerStart":ge=i.branding.headerGradientStart;break;case"headerEnd":ge=i.branding.headerGradientEnd;break;case"pageStart":ge=i.branding.pageGradientStart;break;case"pageEnd":ge=i.branding.pageGradientEnd;break;case"accent":ge=i.branding.accentColor;break}if(ge&&S(ge)?A.value=ge.replace(/^#/,""):A.value="",oe&&_.value){const Ne=oe.currentTarget,Oe=_.value,xe=Ne.getBoundingClientRect(),me=Oe.getBoundingClientRect(),Ze=220,qe=12,fe=xe.left+xe.width/2-me.left,ke=me.width,ne=fe-Ze/2;fe+Ze/2>ke-qe?C.value={left:"auto",right:"0",transform:"none"}:ne<qe?C.value={left:"0",right:"auto",transform:"none"}:C.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}rn(()=>E.value?.focus())}},M=()=>{A.value=A.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},U=()=>{if(!T.value||!x.value)return;let Ee=A.value;Ee.length===3&&(Ee=Ee[0]+Ee[0]+Ee[1]+Ee[1]+Ee[2]+Ee[2]);const oe="#"+Ee;switch(x.value){case"headerStart":J("start",oe);break;case"headerEnd":z("headerGradientEnd",oe);break;case"pageStart":de("start",oe);break;case"pageEnd":z("pageGradientEnd",oe);break;case"accent":z("accentColor",oe);break}x.value=null};Ye(c,Ee=>{if(x.value=null,A.value="",Ee==="header"){const oe=i.branding.headerGradientStart||dn.headerGradientStart,ge=i.branding.headerGradientEnd||dn.headerGradientEnd;h.value=oe!==ge}else if(Ee==="page"){const oe=i.branding.pageGradientStart||dn.pageGradientStart,ge=i.branding.pageGradientEnd||dn.pageGradientEnd;f.value=oe!==ge}});const F={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=H(()=>i.branding.headerGradientStart||dn.headerGradientStart),Z=H(()=>i.branding.headerGradientEnd||dn.headerGradientEnd),Q=H(()=>i.branding.accentColor||dn.accentColor),re=H(()=>i.branding.pageGradientStart||dn.pageGradientStart),K=H(()=>i.branding.pageGradientEnd||dn.pageGradientEnd),ae=H(()=>i.branding.logoPosition||"left"),q=D(Date.now());Ye(()=>i.branding.logoUrl,()=>{q.value=Date.now(),y.value=!1,k.value=""});const Y=H(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),te=H(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const ge=s(k.value),Ne=ge.includes("?")?"&":"?";return`${ge}${Ne}_t=${q.value}`}if(!i.branding.logoUrl)return"";const Ee=s(i.branding.logoUrl),oe=Ee.includes("?")?"&":"?";return`${Ee}${oe}_t=${q.value}`}),ue=H(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Z.value} 100%)`})),_e=H(()=>Qh(j.value,Z.value)),$e=H(()=>({background:Q.value,color:Iu(Q.value)})),De=H(()=>({background:`linear-gradient(135deg, ${re.value} 0%, ${K.value} 100%)`}));function Re(Ee){c.value=c.value===Ee?null:Ee}function be(Ee){!Y.value&&Ee&&z("logoPosition",Ee),Re("logo")}function z(Ee,oe){l("update:branding",{...i.branding,[Ee]:oe})}function J(Ee,oe){h.value?z("headerGradientStart",oe):l("update:branding",{...i.branding,headerGradientStart:oe,headerGradientEnd:oe})}function de(Ee,oe){f.value?z("pageGradientStart",oe):l("update:branding",{...i.branding,pageGradientStart:oe,pageGradientEnd:oe})}function ie(){if(!h.value){const Ee=i.branding.headerGradientStart||dn.headerGradientStart;z("headerGradientEnd",Ee)}}function Ae(){if(!f.value){const Ee=i.branding.pageGradientStart||dn.pageGradientStart;z("pageGradientEnd",Ee)}}function G(Ee){l("update:branding",DA(i.branding,Ee)),c.value=null}async function X(){return m.value?await m.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ee(){return m.value?await m.value.deleteStagedLogo():{success:!0}}function Ce(){return m.value?.hasPendingChanges()||!1}function Be(){return m.value?.isPendingDelete()||!1}function Fe(){m.value&&m.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:X,deleteStagedLogo:ee,hasLogoChanges:Ce,isLogoPendingDelete:Be,resetLogo:Fe}),(Ee,oe)=>(p(),g("div",RA,[r("div",OA,[oe[32]||(oe[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",NA,[(p(!0),g(Se,null,je(B(d),ge=>(p(),g("button",{key:ge.name,type:"button",class:"preset-btn",title:ge.name,onClick:Ne=>G(ge)},[r("span",{class:"preset-preview",style:tt({background:`linear-gradient(135deg, ${ge.pageGradientStart} 0%, ${ge.pageGradientEnd} 100%)`})},null,4),r("span",FA,b(ge.name),1)],8,BA))),128))])]),r("div",UA,[r("div",{class:le(["mockup-page",{"region-active":c.value==="page"}]),style:tt(De.value),onClick:oe[7]||(oe[7]=ge=>Re("page"))},[r("div",{class:le(["mockup-header",[{"region-active":c.value==="header"},Y.value?`logo-${ae.value}`:"logo-none"]]),style:tt(ue.value),onClick:oe[5]||(oe[5]=rt(ge=>Re("header"),["stop"]))},[Y.value&&ae.value==="cover"?(p(),g("div",zA,[r("img",{src:te.value,alt:"Logo",class:"logo-cover-img"},null,8,HA)])):P("",!0),Y.value&&ae.value==="cover"?(p(),g("button",{key:1,type:"button",class:le(["logo-cover-edit-btn",{"region-active":c.value==="logo"}]),onClick:oe[0]||(oe[0]=rt(ge=>Re("logo"),["stop"])),title:"Edit logo"},[...oe[33]||(oe[33]=[r("span",null,"",-1)])],2)):P("",!0),Y.value&&ae.value==="left"?(p(),g("div",{key:2,class:le(["mockup-logo logo-left",{"region-active":c.value==="logo"}]),onClick:oe[1]||(oe[1]=rt(ge=>Re("logo"),["stop"]))},[r("img",{src:te.value,alt:"Logo",class:"logo-img"},null,8,VA)],2)):P("",!0),Y.value?P("",!0):(p(),g("div",{key:3,class:le(["logo-add-area logo-add-left",{"region-active":c.value==="logo"}]),onClick:oe[2]||(oe[2]=rt(ge=>be("left"),["stop"]))},[...oe[34]||(oe[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",GA,[r("div",{class:"mockup-title",style:tt({color:_e.value})},[r("span",qA,b(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:tt({color:_e.value})},b(e.eventDate||"Event Date"),5),r("div",jA,[oe[35]||(oe[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:tt({color:_e.value})},"Logout",4)])]),Y.value&&ae.value==="right"?(p(),g("div",{key:4,class:le(["mockup-logo logo-right",{"region-active":c.value==="logo"}]),onClick:oe[3]||(oe[3]=rt(ge=>Re("logo"),["stop"]))},[r("img",{src:te.value,alt:"Logo",class:"logo-img"},null,8,WA)],2)):P("",!0),Y.value?P("",!0):(p(),g("div",{key:5,class:le(["logo-add-area logo-add-right",{"region-active":c.value==="logo"}]),onClick:oe[4]||(oe[4]=rt(ge=>be("right"),["stop"]))},[...oe[36]||(oe[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",ZA,[r("div",KA,[oe[37]||(oe[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",YA,[r("div",{class:le(["mockup-checkin-btn",{"region-active":c.value==="accent"}]),style:tt($e.value),onClick:oe[6]||(oe[6]=rt(ge=>Re("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),We(r("div",{class:"editor-overlay",onClick:oe[31]||(oe[31]=rt(ge=>c.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:_,class:"editor-modal"},[r("div",JA,[r("span",null,b(F[c.value]),1),r("button",{type:"button",class:"editor-close",onClick:oe[8]||(oe[8]=ge=>c.value=null)},"")]),r("div",XA,[c.value==="header"?(p(),g(Se,{key:0},[oe[46]||(oe[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",QA,[r("div",eE,[r("label",null,b(h.value?"Start colour":"Colour"),1),r("div",tE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"hs-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>J("start",ge.hex)},[e.branding.headerGradientStart===ge.hex?(p(),g("span",oE,"")):P("",!0)],14,nE))),128)),r("div",sE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:S(e.branding.headerGradientStart)}]),style:tt({backgroundColor:R(e.branding.headerGradientStart)}),title:"Custom colour",onClick:oe[9]||(oe[9]=ge=>O("headerStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[38]||(oe[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",aE,[oe[39]||(oe[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[10]||(oe[10]=ge=>x.value=null)},"")]),r("div",iE,[oe[40]||(oe[40]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[11]||(oe[11]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!T.value}]),onInput:M,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:T.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!T.value,onClick:U}," Apply ",8,lE)]),A.value&&!T.value?(p(),g("span",rE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",cE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[12]||(oe[12]=ge=>h.value=ge),onChange:ie},null,544),[[$s,h.value]]),oe[41]||(oe[41]=r("span",null,"Use gradient",-1))])]),h.value?(p(),g("div",uE,[oe[45]||(oe[45]=r("label",null,"End colour",-1)),r("div",dE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"he-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>z("headerGradientEnd",ge.hex)},[e.branding.headerGradientEnd===ge.hex?(p(),g("span",fE,"")):P("",!0)],14,hE))),128)),r("div",pE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:S(e.branding.headerGradientEnd)}]),style:tt({backgroundColor:R(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:oe[13]||(oe[13]=ge=>O("headerEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[42]||(oe[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",vE,[oe[43]||(oe[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[14]||(oe[14]=ge=>x.value=null)},"")]),r("div",mE,[oe[44]||(oe[44]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[15]||(oe[15]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!T.value}]),onInput:M,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:T.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!T.value,onClick:U}," Apply ",8,gE)]),A.value&&!T.value?(p(),g("span",yE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0),c.value==="logo"?(p(),g("div",kE,[oe[47]||(oe[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",bE,[r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="left"}]),onClick:oe[16]||(oe[16]=ge=>z("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="cover"}]),onClick:oe[17]||(oe[17]=ge=>z("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="right"}]),onClick:oe[18]||(oe[18]=ge=>z("logoPosition","right"))}," Right ",2)])])):P("",!0),We(Pe(EA,{ref_key:"logoUploaderRef",ref:m,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":oe[19]||(oe[19]=ge=>z("logoUrl",ge)),onStagedChange:w},null,8,["model-value","event-id","admin-email"]),[[ns,c.value==="logo"]]),c.value==="accent"?(p(),g(Se,{key:2},[oe[51]||(oe[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",wE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"ac-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.accentColor===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>z("accentColor",ge.hex)},[e.branding.accentColor===ge.hex?(p(),g("span",CE,"")):P("",!0)],14,_E))),128)),r("div",LE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:S(e.branding.accentColor)}]),style:tt({backgroundColor:R(e.branding.accentColor)}),title:"Custom colour",onClick:oe[20]||(oe[20]=ge=>O("accent",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[48]||(oe[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="accent"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",SE,[oe[49]||(oe[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[21]||(oe[21]=ge=>x.value=null)},"")]),r("div",IE,[oe[50]||(oe[50]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[22]||(oe[22]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!T.value}]),onInput:M,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:T.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!T.value,onClick:U}," Apply ",8,xE)]),A.value&&!T.value?(p(),g("span",$E,"Invalid hex code")):P("",!0)],4)):P("",!0)])])],64)):P("",!0),c.value==="page"?(p(),g(Se,{key:3},[oe[60]||(oe[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",TE,[r("div",ME,[r("label",null,b(f.value?"Start colour":"Colour"),1),r("div",AE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"ps-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>de("start",ge.hex)},[e.branding.pageGradientStart===ge.hex?(p(),g("span",PE,"")):P("",!0)],14,EE))),128)),r("div",DE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:S(e.branding.pageGradientStart)}]),style:tt({backgroundColor:R(e.branding.pageGradientStart)}),title:"Custom colour",onClick:oe[23]||(oe[23]=ge=>O("pageStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[52]||(oe[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",RE,[oe[53]||(oe[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[24]||(oe[24]=ge=>x.value=null)},"")]),r("div",OE,[oe[54]||(oe[54]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[25]||(oe[25]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!T.value}]),onInput:M,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:T.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!T.value,onClick:U}," Apply ",8,NE)]),A.value&&!T.value?(p(),g("span",BE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",FE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[26]||(oe[26]=ge=>f.value=ge),onChange:Ae},null,544),[[$s,f.value]]),oe[55]||(oe[55]=r("span",null,"Use gradient",-1))])]),f.value?(p(),g("div",UE,[oe[59]||(oe[59]=r("label",null,"End colour",-1)),r("div",zE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"pe-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>z("pageGradientEnd",ge.hex)},[e.branding.pageGradientEnd===ge.hex?(p(),g("span",VE,"")):P("",!0)],14,HE))),128)),r("div",GE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:S(e.branding.pageGradientEnd)}]),style:tt({backgroundColor:R(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:oe[27]||(oe[27]=ge=>O("pageEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[56]||(oe[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",qE,[oe[57]||(oe[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[28]||(oe[28]=ge=>x.value=null)},"")]),r("div",jE,[oe[58]||(oe[58]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[29]||(oe[29]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!T.value}]),onInput:M,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:T.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!T.value,onClick:U}," Apply ",8,WE)]),A.value&&!T.value?(p(),g("span",ZE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0)]),r("div",KE,[r("button",{type:"button",class:"btn-done",onClick:oe[30]||(oe[30]=ge=>c.value=null)},"Done")])],512)],512),[[ns,c.value]]),oe[61]||(oe[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},JE=Ke(YE,[["__scopeId","data-v-01af4f2d"]]),XE={class:"settings-tab"},QE={class:"accordion"},e4={class:"accordion-section"},t4={class:"accordion-title"},n4={class:"accordion-icon"},o4={key:0,class:"accordion-content"},s4={class:"accordion-section"},a4={class:"accordion-icon"},i4={key:0,class:"accordion-content"},l4={class:"terminology-grid"},r4={class:"term-group"},c4=["value"],u4={class:"term-group"},d4=["value"],h4={class:"term-group"},f4=["value"],p4={class:"term-group"},v4=["value"],m4={class:"term-group"},g4=["value"],y4={class:"form-actions"},k4=["disabled"],b4={class:"accordion-section"},w4={class:"accordion-title"},_4={class:"accordion-icon"},C4={key:0,class:"accordion-content"},L4={class:"section-description"},S4={class:"form-actions"},I4=["disabled"],x4={class:"accordion-section"},$4={class:"accordion-title"},T4={class:"accordion-icon"},M4={key:0,class:"accordion-content"},A4={class:"section-description"},E4={class:"form-actions"},P4=["disabled"],D4=["disabled"],zv="admin_settings_accordion",R4={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=mc(),i=H(()=>o.adminEmail||""),l=e,c=t,d=D({...l.eventData}),h=D(null),f=D(!1),m=()=>l.eventId?`${zv}_${l.eventId}`:zv,y=D(null);cn(()=>{const T=localStorage.getItem(m());T&&(y.value=T)});const k=H(()=>{const T=d.value.peopleTerm||"Marshals";return ya.checkpoint.map(O=>({value:O,label:Wh(O,T)}))}),w=T=>{const O=y.value===T?null:T;y.value=O,O?localStorage.setItem(m(),O):localStorage.removeItem(m())};Ye(()=>l.eventData,T=>{d.value={...T},_.value=!1},{deep:!0});const x=()=>{c("update:formDirty",!0)},A=(T,O)=>{d.value[T]=O,x()},E=H(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),_=D(!1),C=T=>{_.value=T},S=T=>{d.value.brandingHeaderGradientStart=T.headerGradientStart,d.value.brandingHeaderGradientEnd=T.headerGradientEnd,d.value.brandingLogoUrl=T.logoUrl,d.value.brandingLogoPosition=T.logoPosition,d.value.brandingAccentColor=T.accentColor,d.value.brandingPageGradientStart=T.pageGradientStart,d.value.brandingPageGradientEnd=T.pageGradientEnd,x()},$=()=>{PA(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",_.value=!1,h.value?.resetLogo(),x()},R=async()=>{if(!f.value){f.value=!0;try{if(_.value&&h.value){if(h.value.isLogoPendingDelete()){const O=await h.value.deleteStagedLogo();if(!O.success){console.error("Failed to delete logo:",O.error);return}d.value.brandingLogoUrl=""}else{const O=await h.value.uploadStagedLogo();if(!O.success){console.error("Failed to upload logo:",O.error);return}O.logoUrl&&!O.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=O.logoUrl)}_.value=!1}c("submit",{...d.value})}finally{f.value=!1}}};return(T,O)=>(p(),g("div",XE,[r("div",QE,[r("div",e4,[r("button",{class:le(["accordion-header",{active:y.value==="admins"}]),onClick:O[0]||(O[0]=M=>w("admins"))},[r("span",t4,"Administrators ("+b(e.admins.length)+")",1),r("span",n4,b(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(p(),g("div",o4,[Pe(UT,{admins:e.admins,onAddAdmin:O[1]||(O[1]=M=>T.$emit("add-admin")),onRemoveAdmin:O[2]||(O[2]=M=>T.$emit("remove-admin",M))},null,8,["admins"])])):P("",!0)]),r("div",s4,[r("button",{class:le(["accordion-header",{active:y.value==="terminology"}]),onClick:O[3]||(O[3]=M=>w("terminology"))},[O[19]||(O[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",a4,b(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(p(),g("div",i4,[O[20]||(O[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",l4,[r("div",r4,[r("label",null,b(B(n).people)+" are called",1),We(r("select",{"onUpdate:modelValue":O[4]||(O[4]=M=>d.value.peopleTerm=M),class:"form-input",onChange:x},[(p(!0),g(Se,null,je(B(ya).people,M=>(p(),g("option",{key:M,value:M},b(M),9,c4))),128))],544),[[no,d.value.peopleTerm]])]),r("div",u4,[r("label",null,b(B(n).checkpoints)+" are called",1),We(r("select",{"onUpdate:modelValue":O[5]||(O[5]=M=>d.value.checkpointTerm=M),class:"form-input",onChange:x},[(p(!0),g(Se,null,je(k.value,M=>(p(),g("option",{key:M.value,value:M.value},b(M.label),9,d4))),128))],544),[[no,d.value.checkpointTerm]])]),r("div",h4,[r("label",null,b(B(n).areas)+" are called",1),We(r("select",{"onUpdate:modelValue":O[6]||(O[6]=M=>d.value.areaTerm=M),class:"form-input",onChange:x},[(p(!0),g(Se,null,je(B(ya).area,M=>(p(),g("option",{key:M,value:M},b(M),9,f4))),128))],544),[[no,d.value.areaTerm]])]),r("div",p4,[r("label",null,b(B(n).checklists)+" are called",1),We(r("select",{"onUpdate:modelValue":O[7]||(O[7]=M=>d.value.checklistTerm=M),class:"form-input",onChange:x},[(p(!0),g(Se,null,je(B(ya).checklist,M=>(p(),g("option",{key:M,value:M},b(M),9,v4))),128))],544),[[no,d.value.checklistTerm]])]),r("div",m4,[r("label",null,b(B(n).course)+" is called",1),We(r("select",{"onUpdate:modelValue":O[8]||(O[8]=M=>d.value.courseTerm=M),class:"form-input",onChange:x},[(p(!0),g(Se,null,je(B(ya).course,M=>(p(),g("option",{key:M,value:M},b(M),9,g4))),128))],544),[[no,d.value.courseTerm]])])]),r("div",y4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,k4)])])):P("",!0)]),r("div",b4,[r("button",{class:le(["accordion-header",{active:y.value==="appearance"}]),onClick:O[9]||(O[9]=M=>w("appearance"))},[r("span",w4,b(B(n).checkpoint)+" appearance",1),r("span",_4,b(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(p(),g("div",C4,[r("p",L4," Set the default marker style for all "+b(B(s).checkpoints)+" in this event. Individual "+b(B(s).areas)+" and "+b(B(s).checkpoints)+" can override this setting. ",1),Pe(Bf,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":O[10]||(O[10]=M=>A("defaultCheckpointStyleType",M)),"onUpdate:styleColor":O[11]||(O[11]=M=>A("defaultCheckpointStyleColor",M)),"onUpdate:styleBackgroundShape":O[12]||(O[12]=M=>A("defaultCheckpointStyleBackgroundShape",M)),"onUpdate:styleBackgroundColor":O[13]||(O[13]=M=>A("defaultCheckpointStyleBackgroundColor",M)),"onUpdate:styleBorderColor":O[14]||(O[14]=M=>A("defaultCheckpointStyleBorderColor",M)),"onUpdate:styleIconColor":O[15]||(O[15]=M=>A("defaultCheckpointStyleIconColor",M)),"onUpdate:styleSize":O[16]||(O[16]=M=>A("defaultCheckpointStyleSize",M)),"onUpdate:styleMapRotation":O[17]||(O[17]=M=>A("defaultCheckpointStyleMapRotation",M))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",S4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,I4)])])):P("",!0)]),r("div",x4,[r("button",{class:le(["accordion-header",{active:y.value==="branding"}]),onClick:O[18]||(O[18]=M=>w("branding"))},[r("span",$4,b(B(n).person)+" branding",1),r("span",T4,b(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(p(),g("div",M4,[r("p",A4," Customise the appearance of the "+b(B(s).person)+" view to match your organisation's branding. ",1),Pe(JE,{ref_key:"brandingMockupRef",ref:h,branding:E.value,"event-name":d.value.name,"event-date":B(Qy)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":S,onLogoStagedChange:C},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",E4,[r("button",{onClick:$,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,P4),r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty&&!_.value||f.value},b(f.value?"Saving...":"Save"),9,D4)])])):P("",!0)])])]))}},O4=Ke(R4,[["__scopeId","data-v-bb7e241a"]]),N4={class:"incident-header"},B4={class:"incident-title-row"},F4={class:"incident-title"},U4={class:"incident-badges"},z4={key:0,class:"incident-description"},H4={class:"incident-context"},V4={key:0,class:"context-item"},G4={key:1,class:"context-item"},q4={key:2,class:"context-item"},j4={class:"incident-footer"},W4={class:"reporter-info"},Z4={class:"time-info"},K4={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,n=H(()=>{if(t.incident.title)return t.incident.title;const c=t.incident.description||"";return c.length<=60?c:c.substring(0,57).trim()+"..."}),s=c=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[c]||c,o=c=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[c]||c,i=(c,d=120)=>!c||c.length<=d?c:c.substring(0,d).trim()+"...",l=c=>{if(!c)return"";const d=new Date(c),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),k=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(c,d)=>(p(),g("div",{class:le(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>c.$emit("select",e.incident))},[r("div",N4,[r("div",B4,[r("span",{class:le(["severity-indicator",e.incident.severity])},null,2),r("strong",F4,b(n.value),1)]),r("div",U4,[r("span",{class:le(["severity-badge",e.incident.severity])},b(s(e.incident.severity)),3),r("span",{class:le(["status-badge",e.incident.status])},b(o(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(p(),g("div",z4,b(i(e.incident.description)),1)):P("",!0),r("div",H4,[e.incident.context?.checkpoint?(p(),g("div",V4,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(p(),g("div",G4,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(p(),g("div",q4,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.area.areaName),1)])):P("",!0)]),r("div",j4,[r("span",W4," Reported by "+b(e.incident.reportedBy?.name||"Unknown"),1),r("span",Z4,b(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},kc=Ke(K4,[["__scopeId","data-v-690fd385"]]),Y4={class:"incidents-tab"},J4={class:"tab-header"},X4={class:"button-group"},Q4={key:0,class:"status-pills"},e3={class:"filters-section"},t3={class:"search-group"},n3={class:"incidents-list"},o3={key:0,class:"loading-state"},s3={key:1,class:"empty-state"},a3={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const n=e,s=D(""),o=D("all"),i=y=>{o.value=y},l=H(()=>n.incidents.filter(y=>y.status==="open").length),c=H(()=>n.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=H(()=>n.incidents.filter(y=>y.status==="resolved").length),h=H(()=>n.incidents.filter(y=>y.status==="closed").length),f=H(()=>{let y=n.incidents;if(o.value==="open"?y=y.filter(k=>k.status==="open"):o.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):o.value==="resolved"?y=y.filter(k=>k.status==="resolved"):o.value==="closed"&&(y=y.filter(k=>k.status==="closed")),s.value.trim()){const k=s.value.toLowerCase().trim().split(/\s+/);y=y.filter(w=>{const x=`${w.context?.checkpoint?.name||""} ${w.context?.checkpoint?.description||""}`,A=w.area?.areaName||"",E=[w.reportedBy?.name||"",...(w.context?.peopleAtCheckpoint||[]).map(S=>S.name||"")].join(" "),_=(w.updates||[]).map(S=>S.note||"").join(" "),C=`${w.title||""} ${w.description||""} ${x} ${A} ${E} ${_}`.toLowerCase();return k.every(S=>C.includes(S))})}return y}),m=H(()=>[...f.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(p(),g("div",Y4,[r("div",J4,[r("div",X4,[r("button",{onClick:k[0]||(k[0]=w=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(p(),g("div",Q4,[Pe(Mt,{variant:"neutral",active:o.value==="all",onClick:k[1]||(k[1]=w=>i("all"))},{default:Ve(()=>[Je(b(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(p(),Ge(Mt,{key:0,variant:"info",active:o.value==="open",onClick:k[2]||(k[2]=w=>i("open"))},{default:Ve(()=>[Je(b(l.value)+" open ",1)]),_:1},8,["active"])):P("",!0),c.value>0&&c.value<e.incidents.length?(p(),Ge(Mt,{key:1,variant:"purple",active:o.value==="in-progress",onClick:k[3]||(k[3]=w=>i("in-progress"))},{default:Ve(()=>[Je(b(c.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0&&d.value<e.incidents.length?(p(),Ge(Mt,{key:2,variant:"success",active:o.value==="resolved",onClick:k[4]||(k[4]=w=>i("resolved"))},{default:Ve(()=>[Je(b(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.incidents.length?(p(),Ge(Mt,{key:3,variant:"neutral",active:o.value==="closed",onClick:k[5]||(k[5]=w=>i("closed"))},{default:Ve(()=>[Je(b(h.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",e3,[r("div",t3,[We(r("input",{"onUpdate:modelValue":k[6]||(k[6]=w=>s.value=w),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,s.value]])])]),r("div",n3,[e.loading?(p(),g("div",o3," Loading incidents... ")):f.value.length===0?(p(),g("div",s3,[r("p",null,b(s.value||o.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(p(!0),g(Se,null,je(m.value,w=>(p(),Ge(kc,{key:w.incidentId,incident:w,onSelect:x=>y.$emit("select-incident",w)},null,8,["incident","onSelect"]))),128))])]))}},i3=Ke(a3,[["__scopeId","data-v-f24c84f4"]]),l3={key:0,class:"empty-state"},r3={key:0,class:"empty-hint"},c3={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,n)=>e.isEmpty?(p(),g("div",l3,[r("p",null,b(e.emptyMessage),1),e.emptyHint?(p(),g("p",r3,b(e.emptyHint),1)):P("",!0)])):(p(),g("div",{key:1,class:le(["cards-grid",e.gridClass])},[go(t.$slots,"default",{},void 0,!0)],2))}},bc=Ke(c3,[["__scopeId","data-v-a842b7b1"]]),u3={class:"checkpoint-card-header"},d3={class:"checkpoint-name-row"},h3=["innerHTML"],f3={class:"checkpoint-name"},p3={key:0,class:"checkpoint-description"},v3={key:0,class:"checkpoint-card-areas"},m3={class:"checkpoint-card-stats"},g3={key:1,class:"checkpoint-card-marshals"},y3={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.checkpoint.areaIds||n.checkpoint.AreaIds||[]),i=A=>{const E=n.areas.find(_=>_.id===A);return E?E.name:null},l=A=>{const E=n.areas.find(_=>_.id===A);return E?E.color:"#999"},c=H(()=>{const A=n.checkpoint,E=A.resolvedStyleBackgroundColor||A.ResolvedStyleBackgroundColor||A.resolvedStyleColor||A.ResolvedStyleColor;return E||(o.value.length>0?l(o.value[0]):"#667eea")}),d=H(()=>{const A=n.checkpoint,E=(A.assignments||[]).length;return A.requiredMarshals===0?null:E>=A.requiredMarshals?"full":E>0?"partial":"none"}),h=H(()=>[...n.checkpoint.assignments||[]].sort((E,_)=>(E.marshalName||"").localeCompare(_.marshalName||"",void 0,{sensitivity:"base"}))),f=H(()=>(n.checkpoint.assignments||[]).length),m=H(()=>(n.checkpoint.assignments||[]).filter(A=>A.isCheckedIn).length),y=H(()=>d.value?`staffing-${d.value}`:""),k=H(()=>{const A=f.value,E=m.value;return A===0?"":E===0?"checkin-none":E>=A?"checkin-full":"checkin-partial"}),w=H(()=>{const A=n.checkpoint,E=A.resolvedStyleType||A.ResolvedStyleType,_=A.resolvedStyleBackgroundColor||A.ResolvedStyleBackgroundColor||A.resolvedStyleColor||A.ResolvedStyleColor,C=A.resolvedStyleBorderColor||A.ResolvedStyleBorderColor,S=A.resolvedStyleIconColor||A.ResolvedStyleIconColor,$=A.resolvedStyleBackgroundShape||A.ResolvedStyleBackgroundShape;return E&&E!=="default"||_||C||S||$&&$!=="circle"?zn({type:E||"circle",backgroundShape:$||"circle",backgroundColor:_||"#667eea",borderColor:C||"#ffffff",iconColor:S||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),x=()=>{n.clickable&&s("click",n.checkpoint)};return(A,E)=>(p(),g("div",{class:le(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:tt({borderLeftColor:c.value}),onClick:x},[r("div",u3,[r("div",{class:le(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",d3,[r("span",{class:"checkpoint-icon",innerHTML:w.value},null,8,h3),r("span",f3,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",p3,"  "+b(e.checkpoint.description),1)):P("",!0)])],2)]),o.value.length>0?(p(),g("div",v3,[(p(!0),g(Se,null,je(o.value,_=>(p(),g("span",{key:_,class:"area-badge",style:tt({backgroundColor:l(_)})},b(i(_)),5))),128))])):P("",!0),r("div",m3,[r("span",{class:le(["stat-badge staffing-badge",y.value])},b(f.value)+"/"+b(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(p(),g("span",{key:0,class:le(["stat-badge",k.value])},b(m.value)+"/"+b(f.value)+" checked in ",3)):P("",!0)]),h.value.length>0?(p(),g("div",g3,[(p(!0),g(Se,null,je(h.value,_=>(p(),g("span",{key:_.id,class:le(["marshal-badge",{"checked-in":_.isCheckedIn}])},b(_.marshalName),3))),128))])):P("",!0)],6))}},k3=Ke(y3,[["__scopeId","data-v-7ae260df"]]),k1={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),Ge(bc,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Se,null,je(e.checkpoints,s=>(p(),Ge(k3,{key:s.id,checkpoint:s,areas:e.areas,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},b3={class:"checkpoints-tab"},w3={class:"tab-header"},_3={class:"button-group"},C3={key:0,class:"status-pills"},L3={class:"filters-section"},S3={class:"search-group"},I3=["placeholder"],x3={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=dt(),n=e,s=D(""),o=D("all"),i=_=>{o.value=_},l=_=>(_.assignments||[]).length,c=_=>(_.assignments||[]).filter(C=>C.isCheckedIn).length,d=H(()=>n.locations.filter(_=>l(_)>=_.requiredMarshals&&_.requiredMarshals>0).length),h=H(()=>n.locations.filter(_=>l(_)>0&&l(_)<_.requiredMarshals).length),f=H(()=>n.locations.filter(_=>l(_)===0&&_.requiredMarshals>0).length),m=H(()=>n.locations.filter(_=>{const C=l(_),S=c(_);return C>0&&S>=C}).length),y=H(()=>n.locations.filter(_=>{const C=l(_),S=c(_);return C>0&&S>0&&S<C}).length),k=H(()=>n.locations.filter(_=>{const C=l(_),S=c(_);return C>0&&S===0}).length),w=_=>{const C=n.areas.find(S=>S.id===_);return C?C.name:null},x=H(()=>{let _=n.locations;if(o.value==="full"?_=_.filter(C=>l(C)>=C.requiredMarshals&&C.requiredMarshals>0):o.value==="partial"?_=_.filter(C=>l(C)>0&&l(C)<C.requiredMarshals):o.value==="missing"?_=_.filter(C=>l(C)===0&&C.requiredMarshals>0):o.value==="checkin-full"?_=_.filter(C=>{const S=l(C),$=c(C);return S>0&&$>=S}):o.value==="checkin-partial"?_=_.filter(C=>{const S=l(C),$=c(C);return S>0&&$>0&&$<S}):o.value==="checkin-none"&&(_=_.filter(C=>{const S=l(C),$=c(C);return S>0&&$===0})),s.value.trim()){const C=s.value.toLowerCase().trim().split(/\s+/);_=_.filter(S=>{const R=(S.areaIds||S.AreaIds||[]).map(M=>w(M)||"").join(" "),T=(S.assignments||[]).map(M=>M.marshalName||"").join(" "),O=`${S.name||""} ${S.description||""} ${R} ${T}`.toLowerCase();return C.every(M=>O.includes(M))})}return _}),A=H(()=>[...x.value].sort((_,C)=>Qo(_.name,C.name))),E=H(()=>{const _=s.value.trim();return o.value==="full"?_?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:o.value==="partial"?_?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:o.value==="missing"?_?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:o.value==="checkin-full"?_?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:o.value==="checkin-partial"?_?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:o.value==="checkin-none"?_?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:_?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(_,C)=>(p(),g("div",b3,[r("div",w3,[r("div",_3,[r("button",{onClick:C[0]||(C[0]=S=>_.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+b(B(t).checkpoint),1),r("button",{onClick:C[1]||(C[1]=S=>_.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(p(),g("div",C3,[Pe(Mt,{variant:"neutral",active:o.value==="all",onClick:C[2]||(C[2]=S=>i("all"))},{default:Ve(()=>[Je(b(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(p(),Ge(Mt,{key:0,variant:"success",active:o.value==="full",onClick:C[3]||(C[3]=S=>i("full"))},{default:Ve(()=>[Je(b(d.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.locations.length?(p(),Ge(Mt,{key:1,variant:"warning",active:o.value==="partial",onClick:C[4]||(C[4]=S=>i("partial"))},{default:Ve(()=>[Je(b(h.value)+" partially staffed ",1)]),_:1},8,["active"])):P("",!0),f.value>0&&f.value<e.locations.length?(p(),Ge(Mt,{key:2,variant:"danger",active:o.value==="missing",onClick:C[5]||(C[5]=S=>i("missing"))},{default:Ve(()=>[Je(b(f.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0),m.value>0&&m.value<e.locations.length?(p(),Ge(Mt,{key:3,variant:"success",active:o.value==="checkin-full",onClick:C[6]||(C[6]=S=>i("checkin-full"))},{default:Ve(()=>[Je(b(m.value)+" fully checked in ",1)]),_:1},8,["active"])):P("",!0),y.value>0&&y.value<e.locations.length?(p(),Ge(Mt,{key:4,variant:"warning",active:o.value==="checkin-partial",onClick:C[7]||(C[7]=S=>i("checkin-partial"))},{default:Ve(()=>[Je(b(y.value)+" partially checked in ",1)]),_:1},8,["active"])):P("",!0),k.value>0&&k.value<e.locations.length?(p(),Ge(Mt,{key:5,variant:"danger",active:o.value==="checkin-none",onClick:C[8]||(C[8]=S=>i("checkin-none"))},{default:Ve(()=>[Je(b(k.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",L3,[r("div",S3,[We(r("input",{"onUpdate:modelValue":C[9]||(C[9]=S=>s.value=S),type:"text",class:"search-input",placeholder:`Search by name, description, ${B(t).area}, or ${B(t).person}...`},null,8,I3),[[st,s.value]])])]),Pe(k1,{checkpoints:A.value,areas:e.areas,"empty-message":E.value,onSelect:C[10]||(C[10]=S=>_.$emit("select-location",S))},null,8,["checkpoints","areas","empty-message"])]))}},$3=Ke(x3,[["__scopeId","data-v-846aa906"]]),T3={class:"area-card-header"},M3={class:"area-name-row"},A3={class:"area-name"},E3={key:0,class:"default-badge"},P3={key:0,class:"area-description"},D3={class:"area-card-stats"},R3={class:"stat-badge"},O3={class:"stat-badge"},N3={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.area.checkpointCount!==void 0?n.area.checkpointCount:n.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(n.area.id)||f.areaId===n.area.id).length),i=H(()=>n.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(n.area.id):!1):!1).length),l=H(()=>n.area.peopleTerm||n.eventPeopleTerm||"Marshals"),c=H(()=>{const f=n.area.checkpointTerm||n.eventCheckpointTerm||"Checkpoints";return o.value===1?ji("checkpoint",f,l.value):Yy("checkpoint",f,l.value)}),d=H(()=>`${o.value} ${c.value.toLowerCase()}`),h=()=>{n.clickable&&s("click",n.area)};return(f,m)=>(p(),g("div",{class:le(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:tt({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",T3,[r("div",{class:le(["area-card-title",{clickable:e.clickable}])},[r("div",M3,[r("span",A3,b(e.area.name),1),e.area.isDefault?(p(),g("span",E3,"Default")):P("",!0)]),e.area.description?(p(),g("span",P3,b(e.area.description),1)):P("",!0)],2)]),r("div",D3,[r("span",R3,b(d.value),1),r("span",O3,b(i.value)+" contact"+b(i.value===1?"":"s"),1)])],6))}},B3=Ke(N3,[["__scopeId","data-v-8ac20bf2"]]),F3={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),Ge(bc,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Se,null,je(e.areas,s=>(p(),Ge(B3,{key:s.id,area:s,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},U3={class:"areas-tab"},z3={class:"tab-header"},H3={class:"button-group"},V3={key:0,class:"status-pills"},G3={class:"filters-section"},q3={class:"search-group"},j3=["placeholder"],W3={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=dt(),n=e,s=D(""),o=d=>n.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=H(()=>{if(!s.value.trim())return n.areas;const d=s.value.toLowerCase().trim().split(/\s+/);return n.areas.filter(h=>{const m=o(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${m}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=H(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Qo(d.name,h.name))),c=H(()=>s.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(p(),g("div",U3,[r("div",z3,[r("div",H3,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+b(B(t).area),1)]),e.areas.length>0?(p(),g("div",V3,[Pe(Mt,{variant:"neutral",active:!1},{default:Ve(()=>[Je(b(e.areas.length)+" "+b(e.areas.length===1?B(t).area:B(t).areas),1)]),_:1})])):P("",!0)]),r("div",G3,[r("div",q3,[We(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>s.value=f),type:"text",class:"search-input",placeholder:`Search by ${B(t).area} name or ${B(t).checkpoint} name...`},null,8,j3),[[st,s.value]])])]),Pe(F3,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":c.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},Z3=Ke(W3,[["__scopeId","data-v-203f9606"]]),K3={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',roles:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15c0-4 3.5-7 8-7s8 3 8 7"/><path d="M4 15c0 1.5 3.5 3 8 3s8-1.5 8-3"/><path d="M20 15h2c.5 0 1-.5 1-1v-1c0-1-1-2-2.5-2H20"/><circle cx="12" cy="8" r="1"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},so=e=>K3[e]||"",Y3={class:"responsive-tabs"},J3=["onClick"],X3=["innerHTML"],Q3=["innerHTML"],eP={class:"hamburger-label"},tP=["onClick"],nP=["innerHTML"],oP={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D({}),h=D(!1),f=H(()=>n.tabs.find(E=>E.value===n.modelValue)),m=H(()=>f.value?f.value.label:"Menu"),y=()=>{if(c.value=!c.value,c.value&&i.value){const E=i.value.getBoundingClientRect();d.value={top:`${E.bottom+4}px`}}},k=E=>{s("update:modelValue",E),c.value=!1},w=E=>{if(!o.value)return;const _=o.value.contains(E.target);c.value&&!_&&(c.value=!1)},x=()=>{if(!l.value)return;const E=l.value,_=h.value;_&&(E.style.visibility="visible",E.style.position="static");const C=E.scrollWidth>E.clientWidth;_&&(E.style.visibility="",E.style.position=""),h.value=C};let A=null;return cn(()=>{document.addEventListener("click",w),rn(()=>{x()}),rn(()=>{const E=l.value?.parentElement;E&&(A=new ResizeObserver(()=>{x()}),A.observe(E))})}),In(()=>{document.removeEventListener("click",w),A&&A.disconnect()}),Ye(()=>n.tabs,()=>{rn(()=>{x()})},{deep:!0}),(E,_)=>(p(),g("div",Y3,[r("div",{ref_key:"visibleTabsRef",ref:l,class:le(["visible-tabs",{"is-hidden":h.value}])},[(p(!0),g(Se,null,je(e.tabs,C=>(p(),g("button",{key:C.value,class:le(["tab-button",{active:e.modelValue===C.value}]),onClick:S=>E.$emit("update:modelValue",C.value),type:"button"},[C.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(so)(C.icon)},null,8,X3)):P("",!0),Je(" "+b(C.label),1)],10,J3))),128))],2),r("div",{class:le(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:o},[r("button",{ref_key:"hamburgerButton",ref:i,class:le(["hamburger-button",{active:c.value}]),onClick:rt(y,["stop"]),type:"button"},[_[1]||(_[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(so)(f.value.icon)},null,8,Q3)):P("",!0),r("span",eP,b(m.value),1)],2),c.value?(p(),g("div",{key:0,class:"hamburger-dropdown",style:tt(d.value),onClick:_[0]||(_[0]=rt(()=>{},["stop"]))},[(p(!0),g(Se,null,je(e.tabs,C=>(p(),g("button",{key:C.value,class:le(["dropdown-item",{active:e.modelValue===C.value}]),onClick:rt(S=>k(C.value),["stop"]),type:"button"},[C.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(so)(C.icon)},null,8,nP)):P("",!0),Je(" "+b(C.label),1)],10,tP))),128))],4)):P("",!0)],512)],2)]))}},sP=Ke(oP,[["__scopeId","data-v-2467c6fc"]]),aP={class:"instruction"},iP={class:"share-link-container"},lP=["value"],rP={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=t,i=D(!1),l=D(null),c=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{o("close")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:`${B(n).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[r("p",aP,"Share this link with "+b(B(s).peoplePlural)+" so they can check in:",1),r("div",iP,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,lP),r("button",{onClick:c,class:"btn btn-primary"},b(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},cP=Ke(rP,[["__scopeId","data-v-b037c39b"]]);var Fl={},Jd,Hv;function uP(){return Hv||(Hv=1,Jd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Jd}var Xd={},Ja={},Vv;function rl(){if(Vv)return Ja;Vv=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Ja.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17},Ja.getSymbolTotalCodewords=function(s){return t[s]},Ja.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s},Ja.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');e=s},Ja.isKanjiModeEnabled=function(){return typeof e<"u"},Ja.toSJIS=function(s){return e(s)},Ja}var Qd={},Gv;function Ff(){return Gv||(Gv=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},e.from=function(s,o){if(e.isValid(s))return s;try{return t(s)}catch{return o}}})(Qd)),Qd}var eh,qv;function dP(){if(qv)return eh;qv=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let s=0;s<n;s++)this.putBit((t>>>n-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},eh=e,eh}var th,jv;function hP(){if(jv)return th;jv=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,s,o){const i=t*this.size+n;this.data[i]=s,o&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,s){this.data[t*this.size+n]^=s},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},th=e,th}var nh={},Wv;function fP(){return Wv||(Wv=1,(function(e){const t=rl().getSymbolSize;e.getRowColCoords=function(s){if(s===1)return[];const o=Math.floor(s/7)+2,i=t(s),l=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let d=1;d<o-1;d++)c[d]=c[d-1]-l;return c.push(6),c.reverse()},e.getPositions=function(s){const o=[],i=e.getRowColCoords(s),l=i.length;for(let c=0;c<l;c++)for(let d=0;d<l;d++)c===0&&d===0||c===0&&d===l-1||c===l-1&&d===0||o.push([i[c],i[d]]);return o}})(nh)),nh}var oh={},Zv;function pP(){if(Zv)return oh;Zv=1;const e=rl().getSymbolSize,t=7;return oh.getPositions=function(s){const o=e(s);return[[0,0],[o-t,0],[0,o-t]]},oh}var sh={},Kv;function vP(){return Kv||(Kv=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const i=o.size;let l=0,c=0,d=0,h=null,f=null;for(let m=0;m<i;m++){c=d=0,h=f=null;for(let y=0;y<i;y++){let k=o.get(m,y);k===h?c++:(c>=5&&(l+=t.N1+(c-5)),h=k,c=1),k=o.get(y,m),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}c>=5&&(l+=t.N1+(c-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(o){const i=o.size;let l=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=o.get(c,d)+o.get(c,d+1)+o.get(c+1,d)+o.get(c+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const i=o.size;let l=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let f=0;f<i;f++)c=c<<1&2047|o.get(h,f),f>=10&&(c===1488||c===93)&&l++,d=d<<1&2047|o.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let i=0;const l=o.data.length;for(let d=0;d<l;d++)i+=o.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function n(s,o,i){switch(s){case e.Patterns.PATTERN000:return(o+i)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(o+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return o*i%2+o*i%3===0;case e.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case e.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}e.applyMask=function(o,i){const l=i.size;for(let c=0;c<l;c++)for(let d=0;d<l;d++)i.isReserved(d,c)||i.xor(d,c,n(o,d,c))},e.getBestMask=function(o,i){const l=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,o);const f=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(h,o),f<d&&(d=f,c=h)}return c}})(sh)),sh}var qc={},Yv;function b1(){if(Yv)return qc;Yv=1;const e=Ff(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return qc.getBlocksCount=function(o,i){switch(i){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},qc.getTotalCodewordsCount=function(o,i){switch(i){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},qc}var ah={},Ir={},Jv;function mP(){if(Jv)return Ir;Jv=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let s=1;for(let o=0;o<255;o++)e[o]=s,t[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),Ir.log=function(s){if(s<1)throw new Error("log("+s+")");return t[s]},Ir.exp=function(s){return e[s]},Ir.mul=function(s,o){return s===0||o===0?0:e[t[s]+t[o]]},Ir}var Xv;function gP(){return Xv||(Xv=1,(function(e){const t=mP();e.mul=function(s,o){const i=new Uint8Array(s.length+o.length-1);for(let l=0;l<s.length;l++)for(let c=0;c<o.length;c++)i[l+c]^=t.mul(s[l],o[c]);return i},e.mod=function(s,o){let i=new Uint8Array(s);for(;i.length-o.length>=0;){const l=i[0];for(let d=0;d<o.length;d++)i[d]^=t.mul(o[d],l);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(s){let o=new Uint8Array([1]);for(let i=0;i<s;i++)o=e.mul(o,new Uint8Array([1,t.exp(i)]));return o}})(ah)),ah}var ih,Qv;function yP(){if(Qv)return ih;Qv=1;const e=gP();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(s){this.degree=s,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const i=e.mod(o,this.genPoly),l=this.degree-i.length;if(l>0){const c=new Uint8Array(this.degree);return c.set(i,l),c}return i},ih=t,ih}var lh={},rh={},ch={},em;function w1(){return em||(em=1,ch.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),ch}var Hs={},tm;function _1(){if(tm)return Hs;tm=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Hs.KANJI=new RegExp(n,"g"),Hs.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Hs.BYTE=new RegExp(s,"g"),Hs.NUMERIC=new RegExp(e,"g"),Hs.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Hs.testKanji=function(d){return o.test(d)},Hs.testNumeric=function(d){return i.test(d)},Hs.testAlphanumeric=function(d){return l.test(d)},Hs}var nm;function cl(){return nm||(nm=1,(function(e){const t=w1(),n=_1();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return n.testNumeric(i)?e.NUMERIC:n.testAlphanumeric(i)?e.ALPHANUMERIC:n.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(i,l){if(e.isValid(i))return i;try{return s(i)}catch{return l}}})(rh)),rh}var om;function kP(){return om||(om=1,(function(e){const t=rl(),n=b1(),s=Ff(),o=cl(),i=w1(),l=7973,c=t.getBCHDigit(l);function d(y,k,w){for(let x=1;x<=40;x++)if(k<=e.getCapacity(x,w,y))return x}function h(y,k){return o.getCharCountIndicator(y,k)+4}function f(y,k){let w=0;return y.forEach(function(x){const A=h(x.mode,k);w+=A+x.getBitsLength()}),w}function m(y,k){for(let w=1;w<=40;w++)if(f(y,w)<=e.getCapacity(w,k,o.MIXED))return w}e.from=function(k,w){return i.isValid(k)?parseInt(k,10):w},e.getCapacity=function(k,w,x){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=o.BYTE);const A=t.getSymbolTotalCodewords(k),E=n.getTotalCodewordsCount(k,w),_=(A-E)*8;if(x===o.MIXED)return _;const C=_-h(x,k);switch(x){case o.NUMERIC:return Math.floor(C/10*3);case o.ALPHANUMERIC:return Math.floor(C/11*2);case o.KANJI:return Math.floor(C/13);case o.BYTE:default:return Math.floor(C/8)}},e.getBestVersionForData=function(k,w){let x;const A=s.from(w,s.M);if(Array.isArray(k)){if(k.length>1)return m(k,A);if(k.length===0)return 1;x=k[0]}else x=k;return d(x.mode,x.getLength(),A)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let w=k<<12;for(;t.getBCHDigit(w)-c>=0;)w^=l<<t.getBCHDigit(w)-c;return k<<12|w}})(lh)),lh}var uh={},sm;function bP(){if(sm)return uh;sm=1;const e=rl(),t=1335,n=21522,s=e.getBCHDigit(t);return uh.getEncodedBits=function(i,l){const c=i.bit<<3|l;let d=c<<10;for(;e.getBCHDigit(d)-s>=0;)d^=t<<e.getBCHDigit(d)-s;return(c<<10|d)^n},uh}var dh={},hh,am;function wP(){if(am)return hh;am=1;const e=cl();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){let o,i,l;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),l=parseInt(i,10),s.put(l,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),l=parseInt(i,10),s.put(l,c*3+1))},hh=t,hh}var fh,im;function _P(){if(im)return fh;im=1;const e=cl(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(s){this.mode=e.ALPHANUMERIC,this.data=s}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[i]),6)},fh=n,fh}var ph,lm;function CP(){if(lm)return ph;lm=1;const e=cl();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(s){return s*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)},ph=t,ph}var vh,rm;function LP(){if(rm)return vh;rm=1;const e=cl(),t=rl();function n(s){this.mode=e.KANJI,this.data=s}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let o;for(o=0;o<this.data.length;o++){let i=t.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),s.put(i,13)}},vh=n,vh}var mh={exports:{}},cm;function SP(){return cm||(cm=1,(function(e){var t={single_source_shortest_paths:function(n,s,o){var i={},l={};l[s]=0;var c=t.PriorityQueue.make();c.push(s,0);for(var d,h,f,m,y,k,w,x,A;!c.empty();){d=c.pop(),h=d.value,m=d.cost,y=n[h]||{};for(f in y)y.hasOwnProperty(f)&&(k=y[f],w=m+k,x=l[f],A=typeof l[f]>"u",(A||x>w)&&(l[f]=w,c.push(f,w),i[f]=h))}if(typeof o<"u"&&typeof l[o]>"u"){var E=["Could not find a path from ",s," to ",o,"."].join("");throw new Error(E)}return i},extract_shortest_path_from_predecessor_list:function(n,s){for(var o=[],i=s;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,s,o){var i=t.single_source_shortest_paths(n,s,o);return t.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var s=t.PriorityQueue,o={},i;n=n||{};for(i in s)s.hasOwnProperty(i)&&(o[i]=s[i]);return o.queue=[],o.sorter=n.sorter||s.default_sorter,o},default_sorter:function(n,s){return n.cost-s.cost},push:function(n,s){var o={value:n,cost:s};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(mh)),mh.exports}var um;function IP(){return um||(um=1,(function(e){const t=cl(),n=wP(),s=_P(),o=CP(),i=LP(),l=_1(),c=rl(),d=SP();function h(E){return unescape(encodeURIComponent(E)).length}function f(E,_,C){const S=[];let $;for(;($=E.exec(C))!==null;)S.push({data:$[0],index:$.index,mode:_,length:$[0].length});return S}function m(E){const _=f(l.NUMERIC,t.NUMERIC,E),C=f(l.ALPHANUMERIC,t.ALPHANUMERIC,E);let S,$;return c.isKanjiModeEnabled()?(S=f(l.BYTE,t.BYTE,E),$=f(l.KANJI,t.KANJI,E)):(S=f(l.BYTE_KANJI,t.BYTE,E),$=[]),_.concat(C,S,$).sort(function(T,O){return T.index-O.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function y(E,_){switch(_){case t.NUMERIC:return n.getBitsLength(E);case t.ALPHANUMERIC:return s.getBitsLength(E);case t.KANJI:return i.getBitsLength(E);case t.BYTE:return o.getBitsLength(E)}}function k(E){return E.reduce(function(_,C){const S=_.length-1>=0?_[_.length-1]:null;return S&&S.mode===C.mode?(_[_.length-1].data+=C.data,_):(_.push(C),_)},[])}function w(E){const _=[];for(let C=0;C<E.length;C++){const S=E[C];switch(S.mode){case t.NUMERIC:_.push([S,{data:S.data,mode:t.ALPHANUMERIC,length:S.length},{data:S.data,mode:t.BYTE,length:S.length}]);break;case t.ALPHANUMERIC:_.push([S,{data:S.data,mode:t.BYTE,length:S.length}]);break;case t.KANJI:_.push([S,{data:S.data,mode:t.BYTE,length:h(S.data)}]);break;case t.BYTE:_.push([{data:S.data,mode:t.BYTE,length:h(S.data)}])}}return _}function x(E,_){const C={},S={start:{}};let $=["start"];for(let R=0;R<E.length;R++){const T=E[R],O=[];for(let M=0;M<T.length;M++){const U=T[M],F=""+R+M;O.push(F),C[F]={node:U,lastCount:0},S[F]={};for(let j=0;j<$.length;j++){const Z=$[j];C[Z]&&C[Z].node.mode===U.mode?(S[Z][F]=y(C[Z].lastCount+U.length,U.mode)-y(C[Z].lastCount,U.mode),C[Z].lastCount+=U.length):(C[Z]&&(C[Z].lastCount=U.length),S[Z][F]=y(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,_))}}$=O}for(let R=0;R<$.length;R++)S[$[R]].end=0;return{map:S,table:C}}function A(E,_){let C;const S=t.getBestModeForData(E);if(C=t.from(_,S),C!==t.BYTE&&C.bit<S.bit)throw new Error('"'+E+'" cannot be encoded with mode '+t.toString(C)+`.
 Suggested mode is: `+t.toString(S));switch(C===t.KANJI&&!c.isKanjiModeEnabled()&&(C=t.BYTE),C){case t.NUMERIC:return new n(E);case t.ALPHANUMERIC:return new s(E);case t.KANJI:return new i(E);case t.BYTE:return new o(E)}}e.fromArray=function(_){return _.reduce(function(C,S){return typeof S=="string"?C.push(A(S,null)):S.data&&C.push(A(S.data,S.mode)),C},[])},e.fromString=function(_,C){const S=m(_,c.isKanjiModeEnabled()),$=w(S),R=x($,C),T=d.find_path(R.map,"start","end"),O=[];for(let M=1;M<T.length-1;M++)O.push(R.table[T[M]].node);return e.fromArray(k(O))},e.rawSplit=function(_){return e.fromArray(m(_,c.isKanjiModeEnabled()))}})(dh)),dh}var dm;function xP(){if(dm)return Xd;dm=1;const e=rl(),t=Ff(),n=dP(),s=hP(),o=fP(),i=pP(),l=vP(),c=b1(),d=yP(),h=kP(),f=bP(),m=cl(),y=IP();function k(R,T){const O=R.size,M=i.getPositions(T);for(let U=0;U<M.length;U++){const F=M[U][0],j=M[U][1];for(let Z=-1;Z<=7;Z++)if(!(F+Z<=-1||O<=F+Z))for(let Q=-1;Q<=7;Q++)j+Q<=-1||O<=j+Q||(Z>=0&&Z<=6&&(Q===0||Q===6)||Q>=0&&Q<=6&&(Z===0||Z===6)||Z>=2&&Z<=4&&Q>=2&&Q<=4?R.set(F+Z,j+Q,!0,!0):R.set(F+Z,j+Q,!1,!0))}}function w(R){const T=R.size;for(let O=8;O<T-8;O++){const M=O%2===0;R.set(O,6,M,!0),R.set(6,O,M,!0)}}function x(R,T){const O=o.getPositions(T);for(let M=0;M<O.length;M++){const U=O[M][0],F=O[M][1];for(let j=-2;j<=2;j++)for(let Z=-2;Z<=2;Z++)j===-2||j===2||Z===-2||Z===2||j===0&&Z===0?R.set(U+j,F+Z,!0,!0):R.set(U+j,F+Z,!1,!0)}}function A(R,T){const O=R.size,M=h.getEncodedBits(T);let U,F,j;for(let Z=0;Z<18;Z++)U=Math.floor(Z/3),F=Z%3+O-8-3,j=(M>>Z&1)===1,R.set(U,F,j,!0),R.set(F,U,j,!0)}function E(R,T,O){const M=R.size,U=f.getEncodedBits(T,O);let F,j;for(F=0;F<15;F++)j=(U>>F&1)===1,F<6?R.set(F,8,j,!0):F<8?R.set(F+1,8,j,!0):R.set(M-15+F,8,j,!0),F<8?R.set(8,M-F-1,j,!0):F<9?R.set(8,15-F-1+1,j,!0):R.set(8,15-F-1,j,!0);R.set(M-8,8,1,!0)}function _(R,T){const O=R.size;let M=-1,U=O-1,F=7,j=0;for(let Z=O-1;Z>0;Z-=2)for(Z===6&&Z--;;){for(let Q=0;Q<2;Q++)if(!R.isReserved(U,Z-Q)){let re=!1;j<T.length&&(re=(T[j]>>>F&1)===1),R.set(U,Z-Q,re),F--,F===-1&&(j++,F=7)}if(U+=M,U<0||O<=U){U-=M,M=-M;break}}}function C(R,T,O){const M=new n;O.forEach(function(Q){M.put(Q.mode.bit,4),M.put(Q.getLength(),m.getCharCountIndicator(Q.mode,R)),Q.write(M)});const U=e.getSymbolTotalCodewords(R),F=c.getTotalCodewordsCount(R,T),j=(U-F)*8;for(M.getLengthInBits()+4<=j&&M.put(0,4);M.getLengthInBits()%8!==0;)M.putBit(0);const Z=(j-M.getLengthInBits())/8;for(let Q=0;Q<Z;Q++)M.put(Q%2?17:236,8);return S(M,R,T)}function S(R,T,O){const M=e.getSymbolTotalCodewords(T),U=c.getTotalCodewordsCount(T,O),F=M-U,j=c.getBlocksCount(T,O),Z=M%j,Q=j-Z,re=Math.floor(M/j),K=Math.floor(F/j),ae=K+1,q=re-K,Y=new d(q);let te=0;const ue=new Array(j),_e=new Array(j);let $e=0;const De=new Uint8Array(R.buffer);for(let de=0;de<j;de++){const ie=de<Q?K:ae;ue[de]=De.slice(te,te+ie),_e[de]=Y.encode(ue[de]),te+=ie,$e=Math.max($e,ie)}const Re=new Uint8Array(M);let be=0,z,J;for(z=0;z<$e;z++)for(J=0;J<j;J++)z<ue[J].length&&(Re[be++]=ue[J][z]);for(z=0;z<q;z++)for(J=0;J<j;J++)Re[be++]=_e[J][z];return Re}function $(R,T,O,M){let U;if(Array.isArray(R))U=y.fromArray(R);else if(typeof R=="string"){let re=T;if(!re){const K=y.rawSplit(R);re=h.getBestVersionForData(K,O)}U=y.fromString(R,re||40)}else throw new Error("Invalid data");const F=h.getBestVersionForData(U,O);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=F;else if(T<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const j=C(T,O,U),Z=e.getSymbolSize(T),Q=new s(Z);return k(Q,T),w(Q),x(Q,T),E(Q,O,0),T>=7&&A(Q,T),_(Q,j),isNaN(M)&&(M=l.getBestMask(Q,E.bind(null,Q,O))),l.applyMask(M,Q),E(Q,O,M),{modules:Q,version:T,errorCorrectionLevel:O,maskPattern:M,segments:U}}return Xd.create=function(T,O){if(typeof T>"u"||T==="")throw new Error("No input text");let M=t.M,U,F;return typeof O<"u"&&(M=t.from(O.errorCorrectionLevel,t.M),U=h.from(O.version),F=l.from(O.maskPattern),O.toSJISFunc&&e.setToSJISFunction(O.toSJISFunc)),$(T,U,M,F)},Xd}var gh={},yh={},hm;function C1(){return hm||(hm=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let s=n.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+n);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const o=parseInt(s.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+s.slice(0,6).join("")}}e.getOptions=function(s){s||(s={}),s.color||(s.color={});const o=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,l=s.scale||4;return{width:i,scale:i?4:l,margin:o,color:{dark:t(s.color.dark||"#000000ff"),light:t(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},e.getScale=function(s,o){return o.width&&o.width>=s+o.margin*2?o.width/(s+o.margin*2):o.scale},e.getImageWidth=function(s,o){const i=e.getScale(s,o);return Math.floor((s+o.margin*2)*i)},e.qrToImageData=function(s,o,i){const l=o.modules.size,c=o.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,m=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let k=0;k<h;k++){let w=(y*h+k)*4,x=i.color.light;if(y>=f&&k>=f&&y<h-f&&k<h-f){const A=Math.floor((y-f)/d),E=Math.floor((k-f)/d);x=m[c[A*l+E]?1:0]}s[w++]=x.r,s[w++]=x.g,s[w++]=x.b,s[w]=x.a}}})(yh)),yh}var fm;function $P(){return fm||(fm=1,(function(e){const t=C1();function n(o,i,l){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,c){let d=c,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=s()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),m=h.getContext("2d"),y=m.createImageData(f,f);return t.qrToImageData(y.data,i,d),n(m,h,f),m.putImageData(y,0,0),h},e.renderToDataURL=function(i,l,c){let d=c;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",m=d.rendererOpts||{};return h.toDataURL(f,m.quality)}})(gh)),gh}var kh={},pm;function TP(){if(pm)return kh;pm=1;const e=C1();function t(o,i){const l=o.a/255,c=i+'="'+o.hex+'"';return l<1?c+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':c}function n(o,i,l){let c=o+i;return typeof l<"u"&&(c+=" "+l),c}function s(o,i,l){let c="",d=0,h=!1,f=0;for(let m=0;m<o.length;m++){const y=Math.floor(m%i),k=Math.floor(m/i);!y&&!h&&(h=!0),o[m]?(f++,m>0&&y>0&&o[m-1]||(c+=h?n("M",y+l,.5+k+l):n("m",d,0),d=0,h=!1),y+1<i&&o[m+1]||(c+=n("h",f),f=0)):d++}return c}return kh.render=function(i,l,c){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,m=h+d.margin*2,y=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+s(f,h,d.margin)+'"/>',w='viewBox="0 0 '+m+" "+m+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+w+' shape-rendering="crispEdges">'+y+k+`</svg>
`;return typeof c=="function"&&c(null,A),A},kh}var vm;function MP(){if(vm)return Fl;vm=1;const e=uP(),t=xP(),n=$P(),s=TP();function o(i,l,c,d,h){const f=[].slice.call(arguments,1),m=f.length,y=typeof f[m-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(m<2)throw new Error("Too few arguments provided");m===2?(h=c,c=l,l=d=void 0):m===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=c,c=l,l=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(c=l,l=d=void 0):m===2&&!l.getContext&&(d=c,c=l,l=void 0),new Promise(function(k,w){try{const x=t.create(c,d);k(i(x,l,d))}catch(x){w(x)}})}try{const k=t.create(c,d);h(null,i(k,l,d))}catch(k){h(k)}}return Fl.create=t.create,Fl.toCanvas=o.bind(null,n.render),Fl.toDataURL=o.bind(null,n.renderToDataURL),Fl.toString=o.bind(null,function(i,l,c){return s.render(i,c)}),Fl}var AP=MP();const EP=t1(AP),PP={class:"qr-container"},DP={key:0,class:"qr-warning"},RP={key:1,class:"error-text"},OP={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3},warning:{type:String,default:""}},emits:["close"],setup(e){const t=e,n=D(null),s=D(""),o=async()=>{if(!(!n.value||!t.url)){s.value="";try{await EP.toCanvas(n.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),s.value="Failed to generate QR code"}}};return Ye(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(o,50)},{immediate:!0}),(i,l)=>(p(),Ge(Yt,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=c=>i.$emit("close"))},{actions:Ve(()=>[r("button",{onClick:l[0]||(l[0]=c=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",PP,[e.warning?(p(),g("p",DP,b(e.warning),1)):P("",!0),r("canvas",{ref_key:"canvasRef",ref:n,class:"qr-canvas"},null,512),s.value?(p(),g("p",RP,b(s.value),1)):P("",!0)])]),_:1},8,["show","title","z-index"]))}},Uf=Ke(OP,[["__scopeId","data-v-401727ed"]]),NP={class:"success-content"},BP={class:"success-message"},FP={class:"link-section"},UP={class:"help-text"},zP={key:0,class:"loading-text"},HP={key:1,class:"magic-link-container"},VP=["value"],GP={class:"magic-link-actions"},qP=["disabled"],jP={key:0,class:"success-text"},WP={key:1,class:"error-text"},ZP={key:2,class:"error-text"},KP={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(""),l=D(!1),c=D(!1),d=D(""),h=D(!1),f=D(!1),m=D(!1),y=D(""),k=D(!1),w=async()=>{if(!(!s.eventId||!s.marshalId)){c.value=!0,d.value="";try{const _=await bs.getMagicLink(s.eventId,s.marshalId);i.value=_.data.magicLink,l.value=_.data.hasEmail}catch(_){console.error("Failed to fetch magic link:",_),d.value="Failed to load login link"}finally{c.value=!1}}},x=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const _=document.createElement("textarea");_.value=i.value,_.style.position="fixed",_.style.left="-9999px",document.body.appendChild(_),_.select(),document.execCommand("copy"),document.body.removeChild(_)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(_){console.error("Failed to copy:",_)}},A=async()=>{if(!(!s.eventId||!s.marshalId)){f.value=!0,m.value=!1,y.value="";try{await bs.sendMagicLink(s.eventId,s.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(_){console.error("Failed to send email:",_),y.value=_.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},E=()=>{o("close")};return Ye(()=>s.show,_=>{_&&s.marshalId?w():(i.value="",l.value=!1,d.value="",h.value=!1,m.value=!1,y.value="",k.value=!1)},{immediate:!0}),(_,C)=>(p(),g(Se,null,[Pe(Yt,{show:e.show,title:`${B(n).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:E},{actions:Ve(()=>[r("button",{onClick:E,class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",NP,[C[4]||(C[4]=r("div",{class:"success-icon"},"",-1)),r("p",BP,[r("strong",null,b(e.marshalName),1),C[3]||(C[3]=Je(" has been added successfully. ",-1))])]),r("div",FP,[C[6]||(C[6]=r("label",null,"Login link",-1)),r("p",UP," Share this unique link with "+b(e.marshalName)+" so they can access their dashboard and check in. ",1),c.value?(p(),g("div",zP,"Loading link...")):i.value?(p(),g("div",HP,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:C[0]||(C[0]=S=>S.target.select())},null,40,VP),r("div",GP,[r("button",{type:"button",class:"btn btn-secondary",onClick:x},b(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:C[1]||(C[1]=S=>k.value=!0),title:"Show QR code"},[...C[5]||(C[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(p(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:A},b(f.value?"Sending...":"Send via email"),9,qP)):P("",!0)]),m.value?(p(),g("p",jP,"Email sent successfully!")):P("",!0),y.value?(p(),g("p",WP,b(y.value),1)):P("",!0)])):d.value?(p(),g("div",ZP,b(d.value),1)):P("",!0)])]),_:1},8,["show","title"]),Pe(Uf,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:C[2]||(C[2]=S=>k.value=!1)},null,8,["show","url"])],64))}},YP=Ke(KP,[["__scopeId","data-v-9aa97b04"]]),JP={class:"form-group"},XP={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D("");Ye(()=>n.show,d=>{d||(o.value="")});const i=()=>{s("update:isDirty",!0)},l=()=>{s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),Ge(Yt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ve(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",JP,[h[1]||(h[1]=r("label",null,"Email address",-1)),We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,o.value]])])],32)]),_:1},8,["show","is-dirty"]))}},QP=Ke(XP,[["__scopeId","data-v-a82da194"]]),e6={class:"form-group"},t6={key:0,class:"error"},n6=["disabled"],o6={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(null);Ye(()=>n.show,d=>{d||(o.value=null)});const i=d=>{o.value=d.target.files[0],s("update:isDirty",!0)},l=()=>{o.value&&s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),Ge(Yt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},b(e.uploading?"Uploading...":"Upload route"),9,n6)]),default:Ve(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",e6,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",t6,b(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},s6=Ke(o6,[["__scopeId","data-v-317975db"]]),a6={class:"instruction"},i6={class:"form-group"},l6={class:"form-group"},r6={class:"checkbox-label"},c6={key:0,class:"error"},u6={key:1,class:"import-result"},d6={key:0,class:"import-errors"},h6=["disabled"],f6={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(null),c=D(!1);Ye(()=>o.show,y=>{y||(l.value=null,c.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:c.value})},m=()=>{i("close")};return(y,k)=>(p(),Ge(Yt,{show:e.show,title:`Import ${B(s).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${B(s).checkpoints}`),9,h6)]),default:Ve(()=>[r("p",a6,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+b(B(n).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:rt(f,["prevent"])},[r("div",i6,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",l6,[r("label",r6,[We(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=w=>c.value=w),onChange:h},null,544),[[$s,c.value]]),Je(" Delete existing "+b(B(s).checkpoints)+" before import ",1)])]),e.error?(p(),g("div",c6,b(e.error),1)):P("",!0),e.result?(p(),g("div",u6,[r("p",null,"Created "+b(e.result.locationsCreated)+" "+b(B(s).checkpoints)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",d6,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Se,null,je(e.result.errors,(w,x)=>(p(),g("li",{key:x},b(w),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},p6=Ke(f6,[["__scopeId","data-v-75c79d31"]]),v6={class:"instruction"},m6={class:"form-group"},g6={key:0,class:"error"},y6={key:1,class:"import-result"},k6={key:0,class:"import-errors"},b6=["disabled"],w6={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(null);Ye(()=>o.show,f=>{f||(l.value=null)});const c=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,m)=>(p(),Ge(Yt,{show:e.show,title:`Import ${B(s).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Ve(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${B(s).people}`),9,b6)]),default:Ve(()=>[r("p",v6,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+b(B(n).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:rt(d,["prevent"])},[r("div",m6,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:c,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",g6,b(e.error),1)):P("",!0),e.result?(p(),g("div",y6,[r("p",null,"Imported "+b(e.result.marshalsCreated)+" "+b(B(s).people)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",k6,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Se,null,je(e.result.errors,(y,k)=>(p(),g("li",{key:k},b(y),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},_6=Ke(w6,[["__scopeId","data-v-be89bf1f"]]),C6=["onClick"],L6=["innerHTML"],S6={class:"hamburger-nav"},I6=["disabled"],x6=["innerHTML"],$6={class:"current-tab-label"},T6=["disabled"],M6={key:0,class:"hamburger-menu"},A6=["onClick"],E6=["innerHTML"],P6=400,D6={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D(!1),h=H(()=>{const $=n.tabs.find(R=>R.value===n.modelValue);return $?$.label:""}),f=H(()=>n.tabs.find(R=>R.value===n.modelValue)?.icon||null),m=H(()=>n.tabs.findIndex($=>$.value===n.modelValue)),y=H(()=>m.value>0),k=H(()=>m.value<n.tabs.length-1),w=()=>{y.value&&s("update:modelValue",n.tabs[m.value-1].value)},x=()=>{k.value&&s("update:modelValue",n.tabs[m.value+1].value)},A=()=>{if(!o.value)return;const $=o.value.clientWidth;if($<P6){c.value=!0;return}if(i.value&&!c.value){i.value.scrollWidth>$&&(c.value=!0);return}const R=n.tabs.some(M=>M.icon)?110:90,T=n.tabs.length*R,O=(n.tabs.length-1)*8;T+O<=$&&(c.value=!1,rn(()=>{i.value&&i.value.scrollWidth>$&&(c.value=!0)}))},E=()=>{d.value=!d.value},_=$=>{s("update:modelValue",$),d.value=!1},C=$=>{l.value&&!l.value.contains($.target)&&(d.value=!1)};let S=null;return cn(()=>{rn(()=>{A(),o.value&&typeof ResizeObserver<"u"&&(S=new ResizeObserver(()=>{A()}),S.observe(o.value)),document.addEventListener("click",C)})}),In(()=>{S&&S.disconnect(),document.removeEventListener("click",C)}),Ye(()=>n.tabs,()=>{rn(()=>{A()})},{deep:!0}),($,R)=>(p(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:o},[c.value?(p(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",S6,[r("button",{class:le(["nav-arrow",{invisible:!y.value}]),onClick:w,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,I6),r("button",{class:"hamburger-button",onClick:E,type:"button","aria-label":"Tab menu"},[f.value?(p(),g("span",{key:0,class:"current-tab-icon",innerHTML:B(so)(f.value)},null,8,x6)):P("",!0),r("span",$6,b(h.value),1),R[0]||(R[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:le(["nav-arrow",{invisible:!k.value}]),onClick:x,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,T6)]),d.value?(p(),g("div",M6,[(p(!0),g(Se,null,je(e.tabs,T=>(p(),g("button",{key:T.value,class:le(["menu-item",{active:e.modelValue===T.value}]),onClick:O=>_(T.value),type:"button"},[T.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(so)(T.icon)},null,8,E6)):P("",!0),Je(" "+b(T.label),1)],10,A6))),128))])):P("",!0)],512)):(p(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(p(!0),g(Se,null,je(e.tabs,T=>(p(),g("button",{key:T.value,class:le(["tab-button",{active:e.modelValue===T.value}]),onClick:O=>$.$emit("update:modelValue",T.value),type:"button"},[T.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(so)(T.icon)},null,8,L6)):P("",!0),Je(" "+b(T.label),1)],10,C6))),128))],512))],512))}},ul=Ke(D6,[["__scopeId","data-v-736c5d0a"]]),R6={class:"tab-content"},O6={class:"form-group"},N6=["value"],B6={class:"form-group"},F6=["value"],U6={class:"form-group"},z6={class:"area-display"},H6={key:0,class:"no-area"},V6={class:"form-help"},G6={class:"form-group checkbox-group"},q6={class:"checkbox-label"},j6=["checked"],W6={class:"form-help"},Z6={key:0,class:"custom-times-section"},K6={class:"form-group"},Y6=["value"],J6={class:"form-help"},X6={class:"form-group"},Q6=["value"],eD={class:"form-help"},tD={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>(n.form.areaIds||n.form.AreaIds||[]).map(d=>n.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(c,d)=>{s("update:form",{...n.form,[c]:d}),s("input")},l=c=>{const d={...n.form,useCustomTimes:c};if(!c)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&n.eventDate){const h=rc(n.eventDate);d.startTime=h,d.endTime=h}s("update:form",d),s("input")};return(c,d)=>(p(),g("div",R6,[r("form",{onSubmit:d[5]||(d[5]=rt(h=>c.$emit("save"),["prevent"]))},[r("div",O6,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,N6)]),r("div",B6,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,F6)]),r("div",U6,[r("label",null,b(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",z6,[o.value.length===0?(p(),g("span",H6," Not in any "+b(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(p(!0),g(Se,null,je(o.value,h=>(p(),g("span",{key:h.id,class:"area-badge",style:tt({backgroundColor:h.color||"var(--brand-primary)"})},b(h.name),5))),128))]),r("small",V6,b(e.areaTermPlural)+" are automatically assigned based on "+b(e.checkpointTermSingular.toLowerCase())+" location within "+b(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",G6,[r("label",q6,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,j6),r("span",null,"Use custom date/time for this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("small",W6," By default, "+b(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(p(),g("div",Z6,[r("div",K6,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,Y6),r("small",J6," When "+b(e.peopleTermPlural.toLowerCase())+" should arrive at this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("div",X6,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,Q6),r("small",eD," When "+b(e.peopleTermPlural.toLowerCase())+" can leave this "+b(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},nD=Ke(tD,[["__scopeId","data-v-aa628901"]]),oD={class:"scope-configuration-editor"},sD={class:"editor-header"},aD={class:"scope-types-list"},iD=["onClick"],lD={class:"scope-type-label"},rD={class:"scope-type-pill"},cD={class:"expand-label"},uD={class:"expand-icon"},dD={class:"modal-content"},hD={class:"modal-header"},fD={class:"modal-body"},pD={class:"scope-help"},vD={key:0,class:"form-group"},mD={class:"checkbox-label special-option"},gD=["checked"],yD={key:0,class:"specific-selection"},kD=["placeholder"],bD={class:"checkbox-group scrollable"},wD=["checked","onChange"],_D={key:1,class:"form-group"},CD={class:"checkbox-label special-option"},LD=["checked"],SD={key:0,class:"specific-selection"},ID={class:"checkbox-group scrollable"},xD=["checked","onChange"],$D={key:2,class:"form-group"},TD={class:"checkbox-label special-option"},MD=["checked"],AD={key:0,class:"specific-selection"},ED=["placeholder"],PD={class:"checkbox-group scrollable"},DD={key:0,class:"checkbox-label this-checkpoint-option"},RD=["checked"],OD={class:"checkpoint-info"},ND={class:"checkpoint-name"},BD=["checked","onChange"],FD={class:"checkpoint-info"},UD={class:"checkpoint-name"},zD={key:0,class:"checkpoint-description"},HD={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>[{scope:"SpecificPeople",label:`Specific ${n.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${n.value.person} at specified ${n.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${n.value.person} at each specified ${n.value.checkpoint}`},{scope:"OnePerArea",label:`One ${n.value.person} in specified ${n.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${n.value.areas}`},{scope:"EveryAreaLead",label:`Every ${n.value.area} lead at specified ${n.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${n.value.area}`}]),l=D({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),c=D(null),d=D(""),h=D(""),f=D(!s.isEditing);let m=!0,y=!1;const k=H(()=>i.value.filter(ie=>!s.excludeScopes.includes(ie.scope))),w=H(()=>f.value?k.value:k.value.filter(ie=>U(ie.scope))),x=H(()=>k.value.filter(Ae=>U(Ae.scope)).length<k.value.length),A=H(()=>{const ie=k.value.filter(Ae=>U(Ae.scope)).length;return k.value.length-ie}),E=H(()=>!s.currentCheckpointId&&s.intent==="location-update");Ye(()=>s.modelValue,ie=>{if(ie){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach(Ae=>{l.value[Ae]={enabled:!1,ids:[]}}),ie.forEach(Ae=>{Ae.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Ae.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Ae.ids]}:l.value[Ae.scope]&&(l.value[Ae.scope]={enabled:!0,ids:[...Ae.ids]})}),m=!1}},{immediate:!0});const _=()=>{const ie=[];return Object.keys(l.value).forEach(Ae=>{const G=l.value[Ae];if(G.enabled){const X={scope:Ae,itemType:C(Ae),ids:[...G.ids]};ie.push(X)}}),ie};Ye(l,()=>{if(m)return;if(Object.keys(l.value).some(G=>G!=="SpecificPeople"&&l.value[G].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const G=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(G,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Ae=_();o("update:modelValue",Ae),o("user-changed")},{deep:!0});const C=ie=>S(ie)?"Area":$(ie)?"Checkpoint":R(ie)?"Marshal":null,S=ie=>ie==="EveryoneInAreas"||ie==="OnePerArea"||ie==="EveryAreaLead"||ie==="OneLeadPerArea",$=ie=>ie==="EveryoneAtCheckpoints"||ie==="OnePerCheckpoint",R=ie=>ie==="SpecificPeople",T=ie=>{const Ae=i.value.find(G=>G.scope===ie);return Ae?Ae.label:ie},O=H(()=>s.headerText?s.headerText:s.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${n.value.checklist}?`),M=ie=>s.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${n.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${n.value.person} at each selected ${n.value.checkpoint} can update the location`,OnePerArea:`Any ${n.value.person} in each selected ${n.value.area} can update the location`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} can update the location`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} can update the location`,OneLeadPerArea:`Any ${n.value.area} lead at the selected ${n.value.areas} can update the location`}[ie]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${n.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${n.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${n.value.area} (shared completion)`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${n.value.area}, only ${n.value.area} leads can complete (shared among leads)`}[ie]||"",U=ie=>l.value[ie]?.enabled||!1,F=ie=>{const Ae=l.value[ie];if(!Ae||!Ae.enabled)return"No";const G=Ae.ids||[];if(S(ie)){if(G.includes("ALL_AREAS"))return`All ${n.value.areas}`;const X=G.length;return X>0?`${X} ${X!==1?n.value.areas:n.value.area}`:`Select ${n.value.areas}...`}if($(ie)){if(G.includes("ALL_CHECKPOINTS"))return`All ${n.value.checkpoints}`;if(G.length===1&&G[0]==="THIS_CHECKPOINT")return`This ${n.value.checkpoint}`;const X=G.length;return X>0?`${X} ${X!==1?n.value.checkpoints:n.value.checkpoint}`:`Select ${n.value.checkpoints}...`}if(R(ie)){if(G.includes("ALL_MARSHALS"))return"Everyone";const X=G.length;return X>0?`${X} ${X!==1?n.value.people:n.value.person}`:`Select ${n.value.people}...`}return"Configured"},j=ie=>{c.value=ie,d.value="",h.value=""},Z=()=>{c.value=null},Q=()=>{c.value&&(l.value[c.value]={enabled:!1,ids:[]}),Z()},re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_MARSHALS"),K=()=>{if(!c.value)return;const ie=l.value[c.value];re()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_MARSHALS"],ie.enabled=!0)},ae=ie=>c.value&&l.value[c.value]?.ids.includes(ie),q=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},Y=()=>{let ie=s.marshals;if(h.value){const G=h.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(G)||X.email&&X.email.toLowerCase().includes(G))}const Ae=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,X)=>{const ee=Ae.includes(G.id),Ce=Ae.includes(X.id);return ee&&!Ce?-1:!ee&&Ce?1:G.name.localeCompare(X.name,void 0,{sensitivity:"base"})})},te=()=>c.value&&l.value[c.value]?.ids.includes("ALL_AREAS"),ue=()=>{if(!c.value)return;const ie=l.value[c.value];te()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_AREAS"],ie.enabled=!0)},_e=ie=>c.value&&l.value[c.value]?.ids.includes(ie),$e=()=>{const ie=c.value?l.value[c.value]?.ids||[]:[];return[...s.areas].sort((Ae,G)=>{const X=ie.includes(Ae.id),ee=ie.includes(G.id);return X&&!ee?-1:!X&&ee?1:Ae.name.localeCompare(G.name,void 0,{sensitivity:"base"})})},De=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},Re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_CHECKPOINTS"),be=()=>{if(!c.value)return;const ie=l.value[c.value];Re()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_CHECKPOINTS"],ie.enabled=!0)},z=ie=>c.value&&l.value[c.value]?.ids.includes(ie),J=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},de=()=>{let ie=s.locations;if(d.value){const G=d.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(G)||X.description&&X.description.toLowerCase().includes(G))}const Ae=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,X)=>{const ee=Ae.includes(G.id),Ce=Ae.includes(X.id);return ee&&!Ce?-1:!ee&&Ce?1:Qo(G.name,X.name)})};return(ie,Ae)=>(p(),g("div",oD,[r("div",sD,[r("h4",null,b(O.value),1)]),r("div",aD,[(p(!0),g(Se,null,je(w.value,G=>(p(),g("div",{key:G.scope,class:le(["scope-type-row",{active:U(G.scope)}]),onClick:X=>j(G.scope)},[r("div",lD,b(G.label),1),r("div",rD,b(F(G.scope)),1)],10,iD))),128)),x.value?(p(),g("div",{key:0,class:"expand-row",onClick:Ae[0]||(Ae[0]=G=>f.value=!f.value)},[r("div",cD,b(f.value?"Show less":`Show ${A.value} more option${A.value!==1?"s":""}...`),1),r("div",uD,b(f.value?"":""),1)])):P("",!0)]),c.value?(p(),g("div",{key:0,class:"scope-config-modal",onClick:rt(Z,["self"])},[r("div",dD,[r("div",hD,[r("h5",null,b(T(c.value)),1),r("button",{onClick:Z,class:"btn-close",type:"button"},"")]),r("div",fD,[r("p",pD,b(M(c.value)),1),R(c.value)?(p(),g("div",vD,[r("label",mD,[r("input",{type:"checkbox",checked:re(),onChange:K},null,40,gD),r("span",null,[Ae[4]||(Ae[4]=r("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+b(B(n).people)+")",1)])]),re()?P("",!0):(p(),g("div",yD,[We(r("input",{"onUpdate:modelValue":Ae[1]||(Ae[1]=G=>h.value=G),type:"text",placeholder:`Search ${B(n).people}...`,class:"search-input"},null,8,kD),[[st,h.value]]),r("div",bD,[(p(!0),g(Se,null,je(Y(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:ae(G.id),onChange:X=>q(G.id)},null,40,wD),r("span",null,b(G.name),1)]))),128))])]))])):P("",!0),S(c.value)?(p(),g("div",_D,[r("label",CD,[r("input",{type:"checkbox",checked:te(),onChange:ue},null,40,LD),r("span",null,[r("strong",null,"All "+b(B(n).areas),1),Je(" (includes future "+b(B(n).areas)+")",1)])]),te()?P("",!0):(p(),g("div",SD,[r("div",ID,[(p(!0),g(Se,null,je($e(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:_e(G.id),onChange:X=>De(G.id)},null,40,xD),r("span",{class:"area-color-dot",style:tt({backgroundColor:G.color||"#667eea"})},null,4),r("span",null,b(G.name),1)]))),128))])]))])):P("",!0),$(c.value)?(p(),g("div",$D,[r("label",TD,[r("input",{type:"checkbox",checked:Re(),onChange:be},null,40,MD),r("span",null,[r("strong",null,"All "+b(B(n).checkpoints),1),Je(" (includes future "+b(B(n).checkpoints)+")",1)])]),Re()?P("",!0):(p(),g("div",AD,[We(r("input",{"onUpdate:modelValue":Ae[2]||(Ae[2]=G=>d.value=G),type:"text",placeholder:`Search ${B(n).checkpoints}...`,class:"search-input"},null,8,ED),[[st,d.value]]),r("div",PD,[E.value?(p(),g("label",DD,[r("input",{type:"checkbox",checked:z("THIS_CHECKPOINT"),onChange:Ae[3]||(Ae[3]=G=>J("THIS_CHECKPOINT"))},null,40,RD),r("div",OD,[r("span",ND,[r("strong",null,"This "+b(B(n).checkpoint),1)])])])):P("",!0),(p(!0),g(Se,null,je(de(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:z(G.id),onChange:X=>J(G.id)},null,40,BD),r("div",FD,[r("span",UD,b(G.name),1),G.description?(p(),g("span",zD," - "+b(G.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:Q,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:Z,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},id=Ke(HD,[["__scopeId","data-v-d465703e"]]),VD={class:"tab-content"},GD={class:"form-group"},qD=["value"],jD={key:0,class:"form-error"},WD={class:"form-row"},ZD={class:"form-group"},KD=["disabled"],YD={class:"form-group"},JD=["disabled"],XD={class:"form-group"},QD={class:"accordion-item"},e5={class:"accordion-preview"},t5={class:"accordion-arrow"},n5={key:0,class:"accordion-content"},o5={class:"section-description"},s5={class:"dynamic-checkbox"},a5=["checked"],i5={key:0,class:"dynamic-settings"},l5={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D(""),c=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ye(()=>n.form.longitude,k=>{i.value=c(k)},{immediate:!0}),Ye(()=>n.form.latitude,k=>{l.value=c(k)},{immediate:!0});const d=k=>{const w=k==="longitude"?i:l,x=parseFloat(w.value);isNaN(x)?w.value.trim()===""&&(s("update:form",{...n.form,[k]:0}),s("input"),w.value=c(0)):(s("update:form",{...n.form,[k]:x}),s("input"),w.value=c(x))},h=(k,w)=>{s("update:form",{...n.form,[k]:w}),s("input")},f=k=>{if(k){const x=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[n.form.id||"THIS_CHECKPOINT"]}];s("update:form",{...n.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else s("update:form",{...n.form,isDynamic:!1});s("input")},m=k=>{s("update:form",{...n.form,locationUpdateScopeConfigurations:k}),s("input")},y=k=>{if(!k)return!0;const w=k.includes(".")?k.split("."):k.split("/");if(w.length!==3)return!1;const x=/^[a-z]{1,20}$/;return w.every(A=>x.test(A))};return(k,w)=>(p(),g("div",VD,[r("form",{onSubmit:w[6]||(w[6]=rt(x=>k.$emit("save"),["prevent"]))},[r("div",GD,[w[10]||(w[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:w[0]||(w[0]=x=>h("what3Words",x.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,qD),e.form.what3Words&&!y(e.form.what3Words)?(p(),g("small",jD," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(p(),g(Se,{key:0},[r("div",WD,[r("div",ZD,[w[11]||(w[11]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":w[1]||(w[1]=x=>i.value=x),onBlur:w[2]||(w[2]=x=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,KD),[[st,i.value]])]),r("div",YD,[w[12]||(w[12]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":w[3]||(w[3]=x=>l.value=x),onBlur:w[4]||(w[4]=x=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,JD),[[st,l.value]])])]),r("div",XD,[r("button",{type:"button",onClick:w[5]||(w[5]=x=>k.$emit("move-location")),class:le(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[w[13]||(w[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+b(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",QD,[r("button",{type:"button",class:le(["accordion-header",{expanded:o.value}]),onClick:w[7]||(w[7]=x=>o.value=!o.value)},[w[14]||(w[14]=pi('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",e5,b(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",t5,b(o.value?"":""),1)],2),o.value?(p(),g("div",n5,[r("p",o5," Enable this for lead cars, sweep vehicles, or other moving "+b(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+b(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",s5,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:w[8]||(w[8]=x=>f(x.target.checked))},null,40,a5),r("span",null,"This "+b(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(p(),g("div",i5,[Pe(id,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:w[9]||(w[9]=x=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},r5=Ke(l5,[["__scopeId","data-v-bd432637"]]);function L1(e){const t=D(new Map),n=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:n,handleToggleCheckIn:f=>{const y=!n(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>n(f)?"":"",getStatusColor:f=>n(f)?"#28a745":"#dc3545",getStatusText:f=>n(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const c5={class:"card-main"},u5={class:"card-title"},d5={class:"marshal-name"},h5={key:0,class:"card-check-in"},f5={class:"toggle-icon"},p5={class:"toggle-label"},v5={key:0,class:"check-in-time"},m5={key:0,class:"check-in-method"},g5={key:1,class:"unsaved-indicator"},y5={key:1,class:"card-status-readonly"},k5={class:"status-icon"},b5={key:0,class:"check-in-time"},w5={key:0,class:"check-in-method"},_5={key:2,class:"card-badge"},C5={key:3,class:"card-badge"},L5={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const n=e,s=t,o=()=>{s("distance-click",n.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=H(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:w}=n.assignment;return y&&y!==w?y:k||""}),c=H(()=>!n.assignment.isPending&&!n.isMarkedForRemoval&&!n.readOnly),d=H(()=>{const{checkInLatitude:y,checkInLongitude:k}=n.assignment,w=n.location;return!y||!k||!w?.latitude||!w?.longitude?null:sl(y,k,w.latitude,w.longitude)}),h=H(()=>d.value===null?null:m2(d.value)),f=H(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),m=()=>{c.value&&s("click",n.assignment)};return(y,k)=>(p(),g("div",{class:le(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":c.value}]),onClick:m},[r("div",c5,[r("div",u5,[r("span",d5,b(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(p(),g("div",h5,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=rt(w=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",f5,b(e.effectiveCheckInStatus?"":""),1),r("span",p5,b(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",v5,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",m5,"("+b(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:rt(o,["stop"])},b(h.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",g5," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(p(),g("div",y5,[r("span",{class:le(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",k5,b(e.effectiveCheckInStatus?"":""),1),Je(" "+b(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(p(),g("span",b5,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",w5,"("+b(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:rt(o,["stop"])},b(h.value),3)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(p(),g("div",_5,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",C5,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=rt(w=>y.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=rt(w=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},S5=Ke(L5,[["__scopeId","data-v-85a18d73"]]),I5={class:"tab-content"},x5={key:0,class:"read-only-notice"},$5={key:1,class:"form-group"},T5=["value"],M5={class:"section-title"},A5={key:2,class:"assign-section"},E5={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:n}){const s=e,o=H(()=>s.peopleTerm.toLowerCase()),i=H(()=>s.personTerm.toLowerCase()),l=H(()=>s.checkpointTerm.toLowerCase()),c=n,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=L1(()=>c("input")),m=D(new Set),y=H(()=>s.assignments?.length||0),k=H(()=>s.assignments?[...s.assignments].sort((M,U)=>(M.marshalName||"").localeCompare(U.marshalName||"",void 0,{sensitivity:"base"})):[]),w=M=>m.value.has(M),x=M=>{M.isPending||c("select-marshal",M)},A=D(!1),E=D(null),_=M=>{h(M)?(E.value=M,A.value=!0):f(M)},C=()=>{E.value&&f(E.value),A.value=!1,E.value=null},S=()=>{A.value=!1,E.value=null},$=H(()=>E.value?`Are you sure you want to undo ${E.value.marshalName||"this marshal"}'s check-in?`:""),R=M=>{M.isPending?c("remove-assignment",M):(m.value.add(M.id),c("input"))},T=M=>{m.value.delete(M.id),c("input")},O=(M,U)=>{c("update:form",{...s.form,[M]:Number(U)}),c("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([M,U])=>({assignmentId:M,shouldBeCheckedIn:U})),getMarkedForRemoval:()=>Array.from(m.value)}),(M,U)=>(p(),g("div",I5,[e.readOnly?(p(),g("div",x5," Viewing from "+b(i.value)+" - "+b(o.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(p(),g("div",$5,[r("label",null,"Required "+b(o.value),1),r("input",{value:e.form.requiredMarshals,onInput:U[0]||(U[0]=F=>O("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,T5)])),r("h3",M5,"Assigned "+b(o.value)+" ("+b(y.value)+")",1),Pe(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${o.value} assigned yet.`,"empty-hint":`Use the button below to assign ${o.value} to this ${l.value}.`},{default:Ve(()=>[(p(!0),g(Se,null,je(k.value,F=>(p(),Ge(S5,{key:F.id,assignment:F,"effective-check-in-status":B(h)(F),"has-unsaved-changes":B(d).has(F.id),"is-marked-for-removal":w(F.id),"read-only":e.readOnly,location:e.form,onClick:x,onToggleCheckIn:_,onRemove:R,onUndoRemove:T,onDistanceClick:U[1]||(U[1]=j=>M.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(p(),g("div",A5,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:U[2]||(U[2]=F=>M.$emit("open-assign-modal"))}," + Assign "+b(i.value)+"... ",1)])),Pe(mi,{show:A.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:S},null,8,["show","message"])]))}},P5=Ke(E5,[["__scopeId","data-v-7124720e"]]),D5={class:"grouped-tasks-list"},R5={key:0,class:"empty-state"},O5={class:"task-group-header-row"},N5=["onClick"],B5={class:"task-header-content"},F5={class:"task-checkbox-area"},U5={class:"task-info"},z5={class:"task-name"},H5={class:"task-summary"},V5={key:0,class:"modified-badge"},G5={class:"task-scope"},q5=["title"],j5={class:"expand-arrow"},W5={key:0,class:"task-group-details"},Z5={class:"sub-group-header"},K5={class:"detail-checkbox"},Y5=["name","checked","disabled","onChange"],J5=["checked","disabled","onChange"],X5={class:"detail-content"},Q5={class:"detail-context"},e8={key:0,class:"detail-completion"},t8={key:0,class:"pending-text"},n8={class:"completion-text"},o8={class:"completion-time"},s8={key:1,class:"detail-uncomplete"},a8={key:2,class:"detail-disabled"},i8={class:"detail-checkbox"},l8=["checked","disabled","onChange"],r8={class:"detail-content"},c8={class:"detail-context"},u8={key:0,class:"detail-completion"},d8={key:0,class:"pending-text"},h8={class:"completion-text"},f8={class:"completion-time"},p8={key:1,class:"detail-uncomplete"},v8={key:2,class:"detail-disabled"},m8={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["toggle-complete","reorder"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(new Set),c=(S,$)=>{if(S==="Checkpoint"){const R=o.locations.find(T=>T.id===$);if(!R)return`${n.value.checkpoint} (unknown)`;if(R.description){const O=R.description.length>40?R.description.substring(0,40)+"...":R.description;return`${R.name} - ${O}`}return R.name}return S==="Area"?o.areas.find(T=>T.id===$)?.name||`${n.value.area} (unknown)`:$},d=(S,$)=>S==="Checkpoint"?o.locations.find(T=>T.id===$)?.name||"":S==="Area"?o.areas.find(T=>T.id===$)?.name||"":$,h=H(()=>{const S=new Map;for(const $ of o.items){S.has($.itemId)||S.set($.itemId,{itemId:$.itemId,text:$.text,displayOrder:$.displayOrder||0,matchedScope:$.matchedScope,items:[],subGroups:null,totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1,contextIds:new Set,completedContextIds:new Set});const R=S.get($.itemId);R.items.push($),A.includes($.matchedScope)&&$.completionContextId?(R.contextIds.add($.completionContextId),$.localIsCompleted&&R.completedContextIds.add($.completionContextId)):(R.totalCount++,$.localIsCompleted&&R.completedCount++),$.isModified&&(R.hasModified=!0)}for(const $ of S.values()){if(A.includes($.matchedScope)){$.totalCount=$.contextIds.size,$.completedCount=$.completedContextIds.size;const T=new Map;for(const O of $.items){const M=O.completionContextId;T.has(M)||T.set(M,{contextId:M,contextType:O.completionContextType,contextName:c(O.completionContextType,M),sortKey:d(O.completionContextType,M),items:[],isContextCompleted:!1});const U=T.get(M);U.items.push(O),O.localIsCompleted&&(U.isContextCompleted=!0)}$.subGroups=Array.from(T.values()).sort((O,M)=>O.sortKey.localeCompare(M.sortKey,void 0,{numeric:!0,sensitivity:"base"}));for(const O of $.subGroups)O.items.sort((M,U)=>{const F=M.contextOwnerName||"",j=U.contextOwnerName||"";return F.localeCompare(j,void 0,{sensitivity:"base"})})}else $.items.sort((T,O)=>{const M=E(T),U=E(O);return M.localeCompare(U,void 0,{numeric:!0,sensitivity:"base"})});$.allCompleted=$.totalCount>0&&$.completedCount===$.totalCount}return Array.from(S.values()).sort(($,R)=>{const T=$.displayOrder||0,O=R.displayOrder||0;return T!==O?T-O:$.text.localeCompare(R.text,void 0,{sensitivity:"base"})})}),f=S=>{l.value.has(S)?l.value.delete(S):l.value.add(S),l.value=new Set(l.value)},m=({changes:S})=>{i("reorder",S)},y=S=>S.hasModified?"status-modified":S.allCompleted?"status-completed":S.completedCount>0?"status-partial":"status-pending",k=S=>S.allCompleted?"":S.completedCount>0?"":"",w=S=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${s.value.area}`,EveryoneAtCheckpoints:`Per ${s.value.checkpoint}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[S.matchedScope]||S.matchedScope,x=S=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This task is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[S.matchedScope]||"",A=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],E=S=>{if(!S.completionContextType||!S.completionContextId)return"Everyone";if(A.includes(S.matchedScope)&&S.contextOwnerName)return S.contextOwnerName;if(S.completionContextType==="Checkpoint"){if(S.linksToCheckIn&&S.contextOwnerName){const T=o.locations.find(O=>O.id===S.completionContextId)?.name||S.linkedCheckpointName;return T?`${S.contextOwnerName} (${T})`:S.contextOwnerName}const $=o.locations.find(R=>R.id===S.completionContextId);return $?$.description?`${$.name} - ${$.description}`:$.name:`${n.value.checkpoint} (unknown)`}if(S.completionContextType==="Area"){const $=o.areas.find(R=>R.id===S.completionContextId);return $?$.name:`${n.value.area} (unknown)`}if(S.completionContextType==="Personal"){if(S.contextOwnerName)return S.contextOwnerName;if(S.completionContextId&&o.marshals.length>0){const $=o.marshals.find(R=>R.id===S.completionContextId||R.marshalId===S.completionContextId);if($)return $.name||$.marshalName}return"Assigned individually"}return S.completionContextType},_=S=>{if(!S)return"";const $=new Date(S),O=(new Date-$)/(1e3*60*60);return O<24&&O>=0?$.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):$.toLocaleString()},C=S=>S.completedByActorName&&S.contextOwnerName&&S.completedByActorName!==S.contextOwnerName?`${S.completedByActorName} on behalf of ${S.contextOwnerName}`:S.completedByActorName||S.contextOwnerName||"Unknown";return(S,$)=>(p(),g("div",D5,[h.value.length===0?(p(),g("div",R5,[...$[0]||($[0]=[r("p",null,"No tasks available.",-1)])])):(p(),Ge(il,{key:1,items:h.value,"item-key":"itemId",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:m},{item:Ve(({element:R})=>[r("div",{class:le(["task-group",{"all-completed":R.allCompleted,"has-modified":R.hasModified}])},[r("div",O5,[e.allowReorder?(p(),Ge(ll,{key:0,class:"task-drag-handle"})):P("",!0),r("button",{type:"button",class:"task-group-header",onClick:T=>f(R.itemId)},[r("div",B5,[r("div",F5,[r("span",{class:le(["task-status-icon",y(R)])},b(k(R)),3)]),r("div",U5,[r("div",z5,b(R.text),1),r("div",H5,[r("span",{class:le(["completion-count",{"all-done":R.allCompleted}])},b(R.completedCount)+"/"+b(R.totalCount)+" completed ",3),R.hasModified?(p(),g("span",V5," Modified ")):P("",!0)])]),r("div",G5,[R.items[0]?.scopeConfigurations?.length?(p(),Ge(nl,{key:0,"scope-configurations":R.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("span",{key:1,class:"scope-pill",title:x(R.items[0])},b(w(R.items[0])),9,q5))])]),r("span",j5,b(l.value.has(R.itemId)?"":""),1)],8,N5)]),l.value.has(R.itemId)?(p(),g("div",W5,[R.subGroups&&R.subGroups.length>0?(p(!0),g(Se,{key:0},je(R.subGroups,T=>(p(),g("div",{key:T.contextId,class:"task-sub-group"},[r("div",Z5,b(T.contextName),1),(p(!0),g(Se,null,je(T.items,O=>(p(),g("div",{key:`${O.itemId}-${O.completionContextId}-${O.contextOwnerMarshalId}`,class:le(["task-detail-item",{"item-completed":O.localIsCompleted,"item-modified":O.isModified}])},[r("div",K5,[T.isContextCompleted?(p(),g("input",{key:1,type:"checkbox",checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe&&!O.localIsCompleted,onChange:M=>S.$emit("toggle-complete",O)},null,40,J5)):(p(),g("input",{key:0,type:"radio",name:`shared-${O.itemId}-${T.contextId}`,checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe,onChange:M=>S.$emit("toggle-complete",O)},null,40,Y5))]),r("div",X5,[r("div",Q5,b(O.contextOwnerName||"Unknown marshal"),1),O.localIsCompleted?(p(),g("div",e8,[O.isModified&&!O.isCompleted?(p(),g("span",t8," Will be marked as completed ")):(p(),g(Se,{key:1},[r("span",n8,b(C(O)),1),r("span",o8,b(_(O.completedAt)),1)],64))])):O.isModified&&O.isCompleted?(p(),g("div",s8,[...$[1]||($[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):O.canBeCompletedByMe?P("",!0):(p(),g("div",a8," Already completed by someone else "))])],2))),128))]))),128)):(p(!0),g(Se,{key:1},je(R.items,T=>(p(),g("div",{key:`${T.itemId}-${T.completionContextId}`,class:le(["task-detail-item",{"item-completed":T.localIsCompleted,"item-modified":T.isModified}])},[r("div",i8,[r("input",{type:"checkbox",checked:T.localIsCompleted,disabled:!T.canBeCompletedByMe&&!T.localIsCompleted,onChange:O=>S.$emit("toggle-complete",T)},null,40,l8)]),r("div",r8,[r("div",c8,b(E(T)),1),T.localIsCompleted?(p(),g("div",u8,[T.isModified&&!T.isCompleted?(p(),g("span",d8," Will be marked as completed ")):(p(),g(Se,{key:1},[r("span",h8,b(C(T)),1),r("span",f8,b(_(T.completedAt)),1)],64))])):T.isModified&&T.isCompleted?(p(),g("div",p8,[...$[2]||($[2]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):T.canBeCompletedByMe?P("",!0):(p(),g("div",v8," Already completed by someone else "))])],2))),128))])):P("",!0)],2)]),_:1},8,["items","disabled","show-order-overlay"]))]))}},zf=Ke(m8,[["__scopeId","data-v-06c0c2c6"]]),g8={class:"checkpoint-checklist-view"},y8={key:0,class:"loading-state"},k8={key:1,class:"error-state"},b8={key:2,class:"empty-state"},w8={class:"help-text"},_8={key:3,class:"empty-state"},C8={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=H(()=>o.assignments.length===0),m=H(()=>l.value.map(E=>{const _=h.value.get(`${E.itemId}|||${E.completionContextId}`),C=_!==void 0?_.complete:E.isCompleted,S=_!==void 0&&_.complete!==E.isCompleted;return{...E,localIsCompleted:C,isModified:S}})),y=async()=>{if(!(!o.eventId||!o.locationId&&!o.areaId)){c.value=!0,d.value=null;try{const E=o.locationId?await Ot.getCheckpointChecklist(o.eventId,o.locationId):await Ot.getAreaChecklist(o.eventId,o.areaId);if(l.value=E.data||[],o.modelValue&&o.modelValue.length>0){const _=new Map;o.modelValue.forEach(C=>{_.set(`${C.itemId}|||${C.contextId}`,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),h.value=_}}catch(E){console.error("Failed to load checklist:",E),d.value=E.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},k=E=>{const _=E.contextOwnerMarshalId||(o.assignments.length>0?o.assignments[0].marshalId:null);if(!_)return;const C=`${E.itemId}|||${E.completionContextId}`,S=h.value.get(C),$=S!==void 0?S.complete:E.isCompleted;h.value.set(C,{complete:!$,contextType:E.completionContextType,contextId:E.completionContextId,marshalId:_}),w()},w=()=>{const E=[];for(const[_,C]of h.value.entries()){const[S,$]=_.split("|||"),R=l.value.find(T=>T.itemId===S&&T.completionContextId===$);R&&C.complete!==R.isCompleted&&E.push({itemId:S,complete:C.complete,contextType:C.contextType,contextId:C.contextId,marshalId:C.marshalId})}i("update:modelValue",E),i("change",E)},x=E=>{i("reorder",E)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const E=new Map;o.modelValue.forEach(_=>{E.set(`${_.itemId}|||${_.contextId}`,{complete:_.complete,contextType:_.contextType,contextId:_.contextId,marshalId:_.marshalId})}),h.value=E}},loadChecklist:y}),Ye(()=>[o.eventId,o.locationId,o.areaId],()=>{y()},{immediate:!0}),(E,_)=>(p(),g("div",g8,[c.value?(p(),g("div",y8," Loading checklist... ")):d.value?(p(),g("div",k8,[r("p",null,b(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(p(),g("div",b8,[r("p",null,"No "+b(B(s).peoplePlural)+" assigned to this "+b(B(s).checkpoint)+" yet.",1),r("p",w8,"Assign "+b(B(s).peoplePlural)+" to enable "+b(B(s).checklist)+" completion.",1)])):l.value.length===0?(p(),g("div",_8,[r("p",null,"No checklist items for this "+b(B(s).checkpoint)+".",1)])):(p(),Ge(zf,{key:4,items:m.value,locations:e.locations,areas:e.areas,marshals:e.marshals,"allow-reorder":e.allowReorder,onToggleComplete:k,onReorder:x},null,8,["items","locations","areas","marshals","allow-reorder"]))]))}},S1=Ke(C8,[["__scopeId","data-v-d3deb94b"]]),L8={class:"notes-view"},S8={key:0,class:"loading-state"},I8={key:1,class:"error-state"},x8={key:2,class:"empty-state"},$8={class:"note-item-content"},T8={class:"note-header"},M8={class:"note-title-row"},A8={key:0,class:"pin-icon",title:"Pinned"},E8={class:"note-title"},P8={class:"note-meta"},D8={key:0,class:"category-badge"},R8={key:0,class:"note-content"},O8={class:"note-footer"},N8={class:"created-info"},B8={key:1,class:"scope-info"},F8={key:1,class:"notes-list"},U8={class:"note-item-content"},z8={class:"note-header"},H8={class:"note-title-row"},V8={key:0,class:"pin-icon",title:"Pinned"},G8={class:"note-title"},q8={class:"note-meta"},j8={key:0,class:"category-badge"},W8={key:0,class:"note-content"},Z8={class:"note-footer"},K8={class:"created-info"},Y8={key:1,class:"scope-info"},J8={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0},allowReorder:{type:Boolean,default:!1}},emits:["reorder"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D([]),l=D(!1),c=D(null),d=H(()=>s.marshalId?"No notes for this marshal.":s.areaId?"No notes for this area.":s.locationId?"No notes for this checkpoint.":"No notes available."),h=H(()=>s.areaId?s.locations.filter(S=>S.areaIds&&S.areaIds.includes(s.areaId)):[]),f=H(()=>h.value.map(S=>S.id)),m=H(()=>{if(!s.areaId)return[];const S=new Set;return s.assignments.filter($=>f.value.includes($.locationId)).forEach($=>S.add($.marshalId)),Array.from(S)}),y=S=>s.assignments.filter($=>$.marshalId===S).map($=>$.locationId),k=S=>{const $=y(S),R=new Set;for(const T of $){const O=s.locations.find(M=>M.id===T);O?.areaIds&&O.areaIds.forEach(M=>R.add(M))}return Array.from(R)},w=(S,$)=>{if(!S.scopeConfigurations)return null;for(const R of S.scopeConfigurations){if(R.itemType==="Area"){if($.type==="area"&&(R.ids.includes($.areaId)||R.ids.includes("ALL_AREAS")))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"};if($.type==="checkpoint"){const O=s.locations.find(M=>M.id===$.locationId)?.areaIds||[];if(R.ids.includes("ALL_AREAS")||O.some(M=>R.ids.includes(M)))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(R.itemType==="Checkpoint"){if($.type==="checkpoint"&&(R.ids.includes($.locationId)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if($.type==="area"&&$.checkpointIds.some(O=>R.ids.includes(O)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(R.itemType==="Marshal"){if($.type==="marshal"&&(R.ids.includes($.marshalId)||R.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if($.type==="checkpoint"){const T=s.assignments.filter(M=>M.locationId===$.locationId).map(M=>M.marshalId);if(R.ids.includes("ALL_MARSHALS")||T.some(M=>R.ids.includes(M)))return{matched:!0,scope:"Marshal at checkpoint"}}if($.type==="area"&&(R.ids.includes("ALL_MARSHALS")||$.marshalIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Marshal in area"}}if($.type==="marshal"&&$.checkpointIds&&$.areaIds){if(R.itemType==="Checkpoint"&&(R.ids.includes("ALL_CHECKPOINTS")||$.checkpointIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Assigned checkpoint"};if(R.itemType==="Area"&&(R.ids.includes("ALL_AREAS")||$.areaIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},x=H(()=>{const S=s.allNotes||i.value;if(!S||S.length===0)return[];if(s.areaId&&s.allNotes){const $={type:"area",areaId:s.areaId,checkpointIds:f.value,marshalIds:m.value},R=[],T=new Set;for(const O of S){if(T.has(O.noteId))continue;const M=w(O,$);M&&(T.add(O.noteId),R.push({...O,matchedScope:M.scope}))}return R}if(s.locationId&&s.allNotes){const $={type:"checkpoint",locationId:s.locationId},R=[],T=new Set;for(const O of S){if(T.has(O.noteId))continue;const M=w(O,$);M&&(T.add(O.noteId),R.push({...O,matchedScope:M.scope}))}return R}if(s.marshalId&&s.allNotes){const $=y(s.marshalId),R=k(s.marshalId),T={type:"marshal",marshalId:s.marshalId,checkpointIds:$,areaIds:R},O=[],M=new Set;for(const U of S){if(M.has(U.noteId))continue;const F=w(U,T);F&&(M.add(U.noteId),O.push({...U,matchedScope:F.scope}))}return O}return S}),A=H(()=>{const S={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...x.value].sort(($,R)=>{if($.isPinned!==R.isPinned)return $.isPinned?-1:1;const T=S[$.priority]??2,O=S[R.priority]??2;return T!==O?T-O:$.displayOrder!==R.displayOrder?$.displayOrder-R.displayOrder:new Date(R.createdAt)-new Date($.createdAt)})}),E=({changes:S})=>{o("reorder",S)},_=async()=>{if(s.allNotes===null&&s.eventId){l.value=!0,c.value=null;try{let S;s.marshalId?S=await ys.getMarshalNotes(s.eventId,s.marshalId):S=await ys.getByEvent(s.eventId),i.value=S.data||[]}catch(S){console.error("Failed to load notes:",S),c.value=S.response?.data?.message||"Failed to load notes"}finally{l.value=!1}}};Ye(()=>[s.eventId,s.locationId,s.areaId,s.marshalId],()=>{s.allNotes===null&&_()},{immediate:!0});const C=S=>{if(!S)return"";const $=new Date(S),T=new Date-$,O=Math.floor(T/6e4),M=Math.floor(T/36e5),U=Math.floor(T/864e5);return O<1?"just now":O<60?`${O}m ago`:M<24?`${M}h ago`:U<7?`${U}d ago`:$.toLocaleDateString()};return t({loadNotes:_}),(S,$)=>(p(),g("div",L8,[l.value?(p(),g("div",S8," Loading notes... ")):c.value?(p(),g("div",I8,[r("p",null,b(c.value),1),r("button",{onClick:_,class:"btn btn-secondary btn-small"}," Retry ")])):x.value.length===0?(p(),g("div",x8,[r("p",null,b(d.value),1)])):(p(),g(Se,{key:3},[e.allowReorder?(p(),Ge(il,{key:0,items:A.value,"item-key":"noteId","pinned-key":"isPinned",onReorder:E,class:"notes-list"},{item:Ve(({element:R})=>[r("div",{class:le(["note-item",{pinned:R.isPinned}])},[Pe(ll),r("div",$8,[r("div",T8,[r("div",M8,[R.isPinned?(p(),g("span",A8,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",E8,b(R.title),1)]),r("div",P8,[R.category?(p(),g("span",D8,b(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},b(R.priority||"Normal"),3)])]),R.content?(p(),g("div",R8,b(R.content),1)):P("",!0),r("div",O8,[r("span",N8," Created by "+b(R.createdByName||"Unknown")+"  "+b(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),Ge(nl,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),g("span",B8,b(R.matchedScope),1)):P("",!0)])])],2)]),_:1},8,["items"])):(p(),g("div",F8,[(p(!0),g(Se,null,je(A.value,R=>(p(),g("div",{key:R.noteId,class:le(["note-item",{pinned:R.isPinned}])},[r("div",U8,[r("div",z8,[r("div",H8,[R.isPinned?(p(),g("span",V8,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",G8,b(R.title),1)]),r("div",q8,[R.category?(p(),g("span",j8,b(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},b(R.priority||"Normal"),3)])]),R.content?(p(),g("div",W8,b(R.content),1)):P("",!0),r("div",Z8,[r("span",K8," Created by "+b(R.createdByName||"Unknown")+"  "+b(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),Ge(nl,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),g("span",Y8,b(R.matchedScope),1)):P("",!0)])])],2))),128))]))],64))]))}},ld=Ke(J8,[["__scopeId","data-v-cd3c899d"]]),X8={class:"checklist-preview"},Q8={class:"preview-actions"},eR={class:"preview-header"},tR={key:0,class:"add-item-form"},nR=["placeholder"],oR=["disabled"],sR={key:1,class:"pending-items"},aR={class:"item-content"},iR={class:"item-header"},lR={class:"item-text"},rR={class:"item-scope"},cR=["onClick"],uR={key:2,class:"empty-state"},dR={key:0,class:"help-text"},hR={key:3,class:"checklist-items"},fR={class:"item-content"},pR={class:"item-header"},vR={class:"item-text"},mR={class:"item-scope"},gR=["title"],yR={key:0,class:"item-context"},kR={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=H(()=>o.checkpointTermSingular?o.checkpointTermSingular.toLowerCase():s.value.checkpoint),l=t,c=D(!1),d=D(""),h=D([...o.modelValue]);Ye(()=>o.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",c.value=!1,y())},m=C=>{h.value.splice(C,1),y()},y=()=>{l("update:modelValue",[...h.value]),l("change")},k=C=>{const S=C.scope,$=C.itemType,R=C.ids||[];return(S==="EveryoneAtCheckpoints"||S==="OnePerCheckpoint")&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):S==="OnePerCheckpoint"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(T=>o.pendingAreaIds.includes(T)):(S==="EveryoneInAreas"||S==="OnePerArea"||S==="EveryAreaLead"||S==="OneLeadPerArea")&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(T=>o.pendingAreaIds.includes(T)):!1},w=H(()=>o.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(S=>k(S)):!1)),x=C=>({EveryoneAtCheckpoints:`All at ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,EveryoneInAreas:`All in ${s.value.areas}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${s.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const S=C.scopeConfigurations.find(R=>k(R));if(!S)return x(C.scopeConfigurations[0].scope);const $=S.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${s.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${s.value.areas}`:x(S.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const S=C.scopeConfigurations.find(R=>k(R));return S&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${s.value.checkpoints}`,OnePerCheckpoint:`One person at each ${s.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${s.value.areas}`,OnePerArea:`One person in each ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`}[S.scope]||""},_=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const S=C.scopeConfigurations.find(T=>k(T));if(!S)return null;const $=S.itemType,R=S.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const T=o.areas.filter(O=>R.includes(O.id)&&o.pendingAreaIds.includes(O.id)).map(O=>O.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(C,S)=>(p(),g("div",X8,[r("div",Q8,[r("p",eR,b(e.isEditing?`Add new ${B(s).checklist} for this ${i.value}:`:`${B(n).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=$=>c.value=!c.value)},b(c.value?"Cancel":`Add ${B(s).checklist}`),1)]),c.value?(p(),g("div",tR,[We(r("input",{"onUpdate:modelValue":S[1]||(S[1]=$=>d.value=$),type:"text",placeholder:`Enter ${B(s).checklist} text...`,class:"add-item-input",onKeyup:Xo(f,["enter"])},null,40,nR),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,oR)])):P("",!0),h.value.length>0?(p(),g("div",sR,[(p(!0),g(Se,null,je(h.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"checklist-item pending"},[S[3]||(S[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",aR,[r("div",iR,[r("div",lR,b($.text),1),r("div",rR,[S[2]||(S[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>m(R),title:"Remove"},"  ",8,cR)])])])]))),128))])):P("",!0),!e.isEditing&&w.value.length===0&&h.value.length===0?(p(),g("div",uR,[r("p",null,"No "+b(B(s).checklists)+" will apply based on the current "+b(B(s).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",dR," Assign "+b(B(s).areas)+" to see relevant "+b(B(s).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&w.value.length>0?(p(),g("div",hR,[(p(!0),g(Se,null,je(w.value,$=>(p(),g("div",{key:$.id,class:"checklist-item"},[S[4]||(S[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",fR,[r("div",pR,[r("div",vR,b($.text),1),r("div",mR,[r("span",{class:"scope-pill",title:E($)},b(A($)),9,gR)])]),_($)?(p(),g("div",yR,b(_($)),1)):P("",!0)])]))),128))])):P("",!0)]))}},bR=Ke(kR,[["__scopeId","data-v-7d943b21"]]),wR={class:"notes-preview"},_R={class:"preview-actions"},CR={class:"preview-header"},LR={key:0,class:"add-item-form"},SR={class:"add-form-fields"},IR=["disabled"],xR={key:1,class:"pending-items"},$R={class:"note-header"},TR={class:"note-title"},MR={class:"note-actions"},AR=["onClick"],ER={key:0,class:"note-content"},PR={key:2,class:"empty-state"},DR={key:0,class:"help-text"},RR={key:3,class:"notes-list"},OR={class:"note-header"},NR={class:"note-title"},BR=["title"],FR={key:0,class:"note-content"},UR={key:1,class:"note-context"},zR={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():n.value.checkpoint),l=D(!1),c=D(""),d=D(""),h=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{!c.value.trim()&&!d.value.trim()||(h.value.push({title:c.value.trim(),content:d.value.trim(),isNew:!0}),c.value="",d.value="",l.value=!1,y())},m=C=>{h.value.splice(C,1),y()},y=()=>{o("update:modelValue",[...h.value]),o("change")},k=C=>{const S=C.scope,$=C.itemType,R=C.ids||[];return S==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):S==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(T=>s.pendingAreaIds.includes(T)):!1},w=H(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(S=>k(S)):!1)),x=C=>({EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const S=C.scopeConfigurations.find(R=>k(R));if(!S)return x(C.scopeConfigurations[0].scope);const $=S.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:x(S.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const S=C.scopeConfigurations.find(R=>k(R));return S&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[S.scope]||""},_=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const S=C.scopeConfigurations.find(T=>k(T));if(!S)return null;const $=S.itemType,R=S.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const T=s.areas.filter(O=>R.includes(O.id)&&s.pendingAreaIds.includes(O.id)).map(O=>O.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(C,S)=>(p(),g("div",wR,[r("div",_R,[r("p",CR,b(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=$=>l.value=!l.value)},b(l.value?"Cancel":"Add note"),1)]),l.value?(p(),g("div",LR,[r("div",SR,[We(r("input",{"onUpdate:modelValue":S[1]||(S[1]=$=>c.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,c.value]]),We(r("textarea",{"onUpdate:modelValue":S[2]||(S[2]=$=>d.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,IR)])):P("",!0),h.value.length>0?(p(),g("div",xR,[(p(!0),g(Se,null,je(h.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",$R,[r("span",TR,b($.title||"Untitled"),1),r("div",MR,[S[3]||(S[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>m(R),title:"Remove"},"  ",8,AR)])]),$.content?(p(),g("div",ER,b($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&w.value.length===0&&h.value.length===0?(p(),g("div",PR,[r("p",null,"No notes will apply based on the current "+b(B(n).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",DR," Assign "+b(B(n).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&w.value.length>0?(p(),g("div",RR,[(p(!0),g(Se,null,je(w.value,$=>(p(),g("div",{key:$.id,class:"note-item"},[r("div",OR,[r("span",NR,b($.title||"Untitled"),1),r("span",{class:"scope-pill",title:E($)},b(A($)),9,BR)]),$.content?(p(),g("div",FR,b($.content),1)):P("",!0),_($)?(p(),g("div",UR,b(_($)),1)):P("",!0)]))),128))])):P("",!0)]))}},HR=Ke(zR,[["__scopeId","data-v-71646c3f"]]),VR={class:"base-modal-title modal-title-with-icon"},GR=["innerHTML"],qR={key:7,class:"tab-content appearance-tab"},jR={class:"accordion-item"},WR=["innerHTML"],ZR={class:"accordion-title"},KR={class:"accordion-arrow"},YR={key:0,class:"accordion-content"},JR={class:"section-description"},XR={class:"accordion-item"},QR={class:"accordion-preview"},eO={class:"accordion-arrow"},tO={key:0,class:"accordion-content"},nO={class:"section-description"},oO={class:"terminology-row"},sO={class:"terminology-field"},aO=["value"],iO={value:""},lO=["value"],rO={class:"terminology-field"},cO=["value"],uO={value:""},dO=["value"],hO={key:8,class:"tab-content incidents-tab"},fO={class:"incidents-list"},pO={class:"custom-footer"},vO={class:"footer-left"},mm="edit_location_accordion",mO={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal","reorder-notes","reorder-checklists"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D("details"),l=D(!1),c=D(null),d=D(null),h=D([]),f=D([]),m=D([]),y=D({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=D(!1),w=D(null),x=fe=>{w.value=fe,k.value=!0},A=()=>{k.value=!1,w.value=null},E=H(()=>w.value&&w.value.marshalName||""),_=H(()=>y.value.name||s.location?.name||""),C=H(()=>{if(!w.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=w.value;return!fe||!ke?null:{lat:fe,lng:ke}}),S=H(()=>{const fe=y.value.latitude,ke=y.value.longitude;return!fe||!ke?null:{lat:fe,lng:ke}}),$=H(()=>{if(!w.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=w.value,ne=y.value.latitude,ye=y.value.longitude;return!fe||!ke||!ne||!ye?null:sl(fe,ke,ne,ye)}),R=()=>s.eventId?`${mm}_${s.eventId}`:mm,T=D({iconStyle:!1,terminology:!1});cn(()=>{const fe=localStorage.getItem(R());if(fe)try{const ke=JSON.parse(fe);T.value={...T.value,...ke}}catch{}});const O=fe=>{T.value[fe]=!T.value[fe],localStorage.setItem(R(),JSON.stringify(T.value))},M=H(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const ke=s.areas.filter(ne=>fe.includes(ne.id)&&ne.peopleTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].peopleTerm}return s.eventPeopleTerm||"Marshals"}),U=H(()=>y.value.peopleTerm?y.value.peopleTerm:M.value),F=H(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const ke=s.areas.filter(ne=>fe.includes(ne.id)&&ne.checkpointTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].checkpointTerm}return n.value.checkpoint});H(()=>F.value.toLowerCase());const j=H(()=>{const fe=y.value.checkpointTerm||s.location?.checkpointTerm||s.location?.CheckpointTerm;if(fe)return ji("checkpoint",fe,U.value);const ke=y.value.areaIds||[];let ne=null;if(ke.length>0){const ye=s.areas.filter(He=>ke.includes(He.id)&&He.checkpointTerm).sort((He,ct)=>(He.checkpointCount||0)-(ct.checkpointCount||0));ye.length>0&&(ne=ye[0].checkpointTerm)}return ne?ji("checkpoint",ne,U.value):n.value.checkpoint}),Z=H(()=>j.value.toLowerCase()),Q=H(()=>{const fe=U.value;return ji("people",fe)});H(()=>Q.value.toLowerCase());const re=H(()=>n.value.area);H(()=>re.value.toLowerCase());const K=H(()=>n.value.area),ae=H(()=>K.value.toLowerCase()),q=H(()=>n.value.areas),Y=H(()=>!!(s.location&&s.location.id)),te=H(()=>Y.value?`Edit ${Z.value}: ${s.location?.name||""}`:`Add ${Z.value}`),ue=H(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:U.value,icon:"marshal"},{value:"checklists",label:n.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return s.incidents&&s.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),_e=H(()=>ue.value.findIndex(fe=>fe.value===i.value)),$e=H(()=>_e.value===ue.value.length-1),De=H(()=>{const fe=y.value.areaIds||[],ke=s.areas.filter(ft=>fe.includes(ft.id)).sort((ft,Pt)=>(ft.checkpointCount||0)-(Pt.checkpointCount||0)),ne=(ft,Pt)=>{for(const vt of ke){const An=ft(vt);if(An&&An!=="default")return{value:An,source:"area"}}return Pt&&Pt!=="default"?{value:Pt,source:"event"}:{value:"",source:"none"}},ye=ne(ft=>ft.checkpointStyleType||ft.CheckpointStyleType,s.eventDefaultStyleType),He=ne(ft=>ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleColor),ct=ne(ft=>ft.checkpointStyleBackgroundShape||ft.CheckpointStyleBackgroundShape,s.eventDefaultStyleBackgroundShape),ht=ne(ft=>ft.checkpointStyleBackgroundColor||ft.CheckpointStyleBackgroundColor||ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleBackgroundColor||s.eventDefaultStyleColor),Nt=ne(ft=>ft.checkpointStyleBorderColor||ft.CheckpointStyleBorderColor,s.eventDefaultStyleBorderColor),Lt=ne(ft=>ft.checkpointStyleIconColor||ft.CheckpointStyleIconColor,s.eventDefaultStyleIconColor),Bt=ne(ft=>ft.checkpointStyleSize||ft.CheckpointStyleSize,s.eventDefaultStyleSize),Et=ne(ft=>ft.checkpointStyleMapRotation??ft.CheckpointStyleMapRotation,s.eventDefaultStyleMapRotation),ko=[ye,ct,ht,Nt,Lt,Bt,Et].some(ft=>ft.source==="area");return{type:ye.value||"default",color:He.value,backgroundShape:ct.value,backgroundColor:ht.value,borderColor:Nt.value,iconColor:Lt.value,size:Bt.value,mapRotation:Et.value,source:ko?"area":ye.value?"event":"none"}}),Re=H(()=>De.value.source==="area"?`${K.value} default`:"Event default"),be=H(()=>{const fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:De.value.type,ke=y.value.styleBackgroundShape||De.value.backgroundShape||"circle",ne=y.value.styleBackgroundColor||De.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||De.value.borderColor||"#ffffff",He=y.value.styleIconColor||De.value.iconColor||"#ffffff";return zn({type:fe||"circle",backgroundShape:ke,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100"})}),z=H(()=>{let fe,ke,ne,ye,He;return Y.value&&s.location?(fe=s.location.resolvedStyleType||s.location.ResolvedStyleType,ke=s.location.resolvedStyleBackgroundShape||s.location.ResolvedStyleBackgroundShape||"circle",ne=s.location.resolvedStyleBackgroundColor||s.location.ResolvedStyleBackgroundColor||s.location.resolvedStyleColor||s.location.ResolvedStyleColor||"#667eea",ye=s.location.resolvedStyleBorderColor||s.location.ResolvedStyleBorderColor||"#ffffff",He=s.location.resolvedStyleIconColor||s.location.ResolvedStyleIconColor||"#ffffff"):(fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:De.value.type,ke=y.value.styleBackgroundShape||De.value.backgroundShape||"circle",ne=y.value.styleBackgroundColor||De.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||De.value.borderColor||"#ffffff",He=y.value.styleIconColor||De.value.iconColor||"#ffffff"),zn({type:fe||"circle",backgroundShape:ke,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100",outputSize:28})}),J=H(()=>{const fe=!!y.value.checkpointTerm,ke=!!y.value.peopleTerm;return fe&&ke?`${ji("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:fe?ji("checkpoint",y.value.checkpointTerm,U.value):ke?y.value.peopleTerm:"Using defaults"}),de=H(()=>$e.value?null:ue.value[_e.value+1]),ie=H(()=>de.value?`${de.value.label}...`:""),Ae=D(!1),G=D(null);Ye(()=>s.location,fe=>{if(fe){const ke=fe.id||"new";if(G.value!==ke){G.value=ke,Ae.value=!0;let ne="",ye="";fe.startTime&&(ne=rc(fe.startTime)),fe.endTime&&(ye=rc(fe.endTime)),y.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:ne,endTime:ye,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ye(()=>s.show,fe=>{fe?(i.value="details",l.value=!1,h.value=[],f.value=[],m.value=[],c.value?.clearPendingChanges&&c.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(G.value=null,Ae.value=!1)});const X=fe=>{y.value=fe},ee=()=>{o("update:isDirty",!0)},Ce=()=>{l.value=!l.value,o("move-location",{isMoving:l.value,formData:{...y.value}})},Be=fe=>{h.value=fe,ee()},Fe=()=>{de.value&&(i.value=de.value.value)},Ee=()=>{const fe={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:c.value?.getPendingChanges?.()||[],assignmentsToRemove:c.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:s.assignments.filter(ke=>ke.isPending).map(ke=>({marshalId:ke.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};o("save",fe)},oe=()=>{s.location&&s.location.id&&o("delete",s.location.id)},ge=fe=>{o("remove-assignment",fe)},Ne=()=>{o("open-assign-modal")},Oe=fe=>{o("select-marshal",fe)},xe=()=>{o("close")},me=(fe,ke)=>{y.value[fe]=ke,ee()},Ze=fe=>{o("reorder-notes",fe)},qe=fe=>{o("reorder-checklists",fe)};return(fe,ke)=>(p(),Ge(Yt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:xe},{header:Ve(()=>[r("h2",VR,[z.value?(p(),g("span",{key:0,class:"modal-title-icon",innerHTML:z.value},null,8,GR)):P("",!0),Je(" "+b(te.value),1)])]),"tab-header":Ve(()=>[Pe(ul,{modelValue:i.value,"onUpdate:modelValue":ke[0]||(ke[0]=ne=>i.value=ne),tabs:ue.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",pO,[r("div",vO,[Y.value&&!e.lockedFromMarshal?(p(),g("button",{key:0,type:"button",onClick:oe,class:"btn btn-danger"}," Delete ")):P("",!0),!Y.value&&!$e.value?(p(),g("button",{key:1,type:"button",onClick:Fe,class:"btn btn-secondary mobile-only"},b(ie.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ee,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[i.value==="details"?(p(),Ge(nD,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":K.value,"area-term-plural":q.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,"onUpdate:form":X,onInput:ee,onSave:Ee},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),i.value==="location"?(p(),Ge(r5,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":Y.value,"onUpdate:form":X,onInput:ee,onSave:Ee,onMoveLocation:Ce},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),i.value==="marshals"?(p(),Ge(P5,{key:2,ref_key:"assignmentsTabRef",ref:c,form:y.value,assignments:e.assignments,"people-term":U.value,"person-term":Q.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":X,onInput:ee,onRemoveAssignment:ge,onOpenAssignModal:Ne,onSelectMarshal:Oe,onDistanceClick:x},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),i.value==="checklists"&&Y.value?(p(),Ge(S1,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":ke[1]||(ke[1]=ne=>h.value=ne),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onChange:Be,onReorder:qe},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):P("",!0),i.value==="checklists"?(p(),Ge(bR,{key:4,modelValue:f.value,"onUpdate:modelValue":ke[2]||(ke[2]=ne=>f.value=ne),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="notes"&&Y.value?(p(),Ge(ld,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Ze},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),i.value==="notes"?(p(),Ge(HR,{key:6,modelValue:m.value,"onUpdate:modelValue":ke[3]||(ke[3]=ne=>m.value=ne),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="appearance"?(p(),g("div",qR,[r("div",jR,[r("button",{type:"button",class:le(["accordion-header",{expanded:T.value.iconStyle}]),onClick:ke[4]||(ke[4]=ne=>O("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:be.value},null,8,WR),r("span",ZR,b(j.value)+" marker style",1),r("span",KR,b(T.value.iconStyle?"":""),1)],2),T.value.iconStyle?(p(),g("div",YR,[r("p",JR," Choose a custom icon for this "+b(Z.value)+", or leave as Default to inherit from "+b(ae.value)+" or event settings. ",1),Pe(Bf,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":De.value.type,"inherited-style-color":De.value.color,"inherited-background-shape":De.value.backgroundShape||"","inherited-background-color":De.value.backgroundColor||De.value.color||"","inherited-border-color":De.value.borderColor||"","inherited-icon-color":De.value.iconColor||"","inherited-size":De.value.size||"","inherited-map-rotation":De.value.mapRotation??"","default-label":Re.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ke[5]||(ke[5]=ne=>me("styleType",ne)),"onUpdate:styleColor":ke[6]||(ke[6]=ne=>me("styleColor",ne)),"onUpdate:styleBackgroundShape":ke[7]||(ke[7]=ne=>me("styleBackgroundShape",ne)),"onUpdate:styleBackgroundColor":ke[8]||(ke[8]=ne=>me("styleBackgroundColor",ne)),"onUpdate:styleBorderColor":ke[9]||(ke[9]=ne=>me("styleBorderColor",ne)),"onUpdate:styleIconColor":ke[10]||(ke[10]=ne=>me("styleIconColor",ne)),"onUpdate:styleSize":ke[11]||(ke[11]=ne=>me("styleSize",ne)),"onUpdate:styleMapRotation":ke[12]||(ke[12]=ne=>me("styleMapRotation",ne))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),r("div",XR,[r("button",{type:"button",class:le(["accordion-header",{expanded:T.value.terminology}]),onClick:ke[13]||(ke[13]=ne=>O("terminology"))},[ke[17]||(ke[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ke[18]||(ke[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",QR,b(J.value),1),r("span",eO,b(T.value.terminology?"":""),1)],2),T.value.terminology?(p(),g("div",tO,[r("p",nO," Customise what this "+b(Z.value)+" and its "+b(U.value.toLowerCase())+" are called. ",1),r("div",oO,[r("div",sO,[r("label",null,"What is this "+b(Z.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:ke[14]||(ke[14]=ne=>{X({...y.value,checkpointTerm:ne.target.value}),ee()})},[r("option",iO,"Use "+b(ae.value)+" default ("+b(j.value)+")",1),ke[19]||(ke[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),ke[20]||(ke[20]=r("option",{value:"Car"},"Car",-1)),ke[21]||(ke[21]=r("option",{value:"Bike"},"Bike",-1)),(p(!0),g(Se,null,je(B(ya).checkpoint,ne=>(p(),g("option",{key:ne,value:ne},b(ne),9,lO))),128))],40,aO)]),r("div",rO,[r("label",null,"What are "+b(U.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:ke[15]||(ke[15]=ne=>{X({...y.value,peopleTerm:ne.target.value}),ee()})},[r("option",uO,"Use "+b(ae.value)+" default ("+b(M.value)+")",1),(p(!0),g(Se,null,je(B(ya).people,ne=>(p(),g("option",{key:ne,value:ne},b(ne),9,dO))),128))],40,cO)])])])):P("",!0)])])):P("",!0),i.value==="incidents"?(p(),g("div",hO,[r("div",fO,[(p(!0),g(Se,null,je(e.incidents,ne=>(p(),Ge(kc,{key:ne.incidentId,incident:ne,onSelect:ke[16]||(ke[16]=ye=>fe.$emit("select-incident",ye))},null,8,["incident"]))),128))])])):P("",!0),Pe(Df,{show:k.value,"marshal-name":E.value,"checkpoint-name":_.value,"check-in-location":C.value,"checkpoint-location":S.value,distance:$.value,"z-index":e.zIndex+100,onClose:A},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},gO=Ke(mO,[["__scopeId","data-v-221a28c2"]]),yO={class:"tab-content"},kO={key:0,class:"error-banner"},bO=["value"],wO={key:0,class:"field-error"},_O={class:"contact-row"},CO=["value"],LO={key:0,class:"field-error"},SO=["value"],IO={key:0,class:"field-error"},xO=["value"],$O={key:0,class:"field-error"},TO={key:1,class:"magic-link-section"},MO={key:0,class:"loading-text"},AO={key:1,class:"magic-link-container"},EO={class:"magic-link-row"},PO=["value"],DO={key:0,class:"error-text"},RO={key:1,class:"magic-link-actions"},OO=["disabled"],NO={key:2,class:"success-text"},BO={key:3,class:"error-text"},FO={key:2,class:"error-text"},UO={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(""),f=D(!1),m=D(!1),y=D(""),k=D(!1),w=D(!1),x=D(!1),A=D(""),E=D(!1),_=(O,M)=>{o("update:form",{...s.form,[O]:M}),o("input")},C=async()=>{if(!(!s.eventId||!s.marshalId)){m.value=!0,y.value="";try{const O=await bs.getMagicLink(s.eventId,s.marshalId);h.value=O.data.magicLink,f.value=O.data.hasEmail}catch(O){console.error("Failed to fetch magic link:",O),y.value="Failed to load login link"}finally{m.value=!1}}},S=D(""),$=async()=>{S.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(O){console.warn("Clipboard API failed, trying fallback:",O)}try{const O=document.createElement("textarea");O.value=h.value,O.style.position="fixed",O.style.left="-9999px",O.style.top="0",document.body.appendChild(O),O.focus(),O.select();const M=document.execCommand("copy");document.body.removeChild(O),M?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(S.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3))}catch(O){console.error("Fallback copy failed:",O),S.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3)}},R=async()=>{if(!(!s.eventId||!s.marshalId)){w.value=!0,x.value=!1,A.value="";try{await bs.sendMagicLink(s.eventId,s.marshalId),x.value=!0,setTimeout(()=>{x.value=!1},3e3)}catch(O){console.error("Failed to send email:",O),A.value=O.response?.data?.message||"Failed to send email"}finally{w.value=!1}}};return Ye(()=>s.marshalId,O=>{O?C():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:O=>{rn(()=>{const U={name:i,email:l,phoneNumber:c,notes:d}[O];U?.value&&(U.value.focus(),U.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(O,M)=>(p(),g("div",yO,[e.validationErrors.general?(p(),g("div",kO,b(e.validationErrors.general),1)):P("",!0),r("div",{class:le(["form-group",{"has-error":e.validationErrors.name}])},[M[7]||(M[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:M[0]||(M[0]=U=>_("name",U.target.value)),type:"text",required:"",class:le(["form-input",{"input-error":e.validationErrors.name}])},null,42,bO),e.validationErrors.name?(p(),g("span",wO,b(e.validationErrors.name),1)):P("",!0)],2),r("div",_O,[r("div",{class:le(["form-group contact-email",{"has-error":e.validationErrors.email}])},[M[8]||(M[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:M[1]||(M[1]=U=>_("email",U.target.value)),type:"email",class:le(["form-input",{"input-error":e.validationErrors.email}])},null,42,CO),e.validationErrors.email?(p(),g("span",LO,b(e.validationErrors.email),1)):P("",!0)],2),r("div",{class:le(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[M[9]||(M[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:c,value:e.form.phoneNumber,onInput:M[2]||(M[2]=U=>_("phoneNumber",U.target.value)),type:"tel",class:le(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,SO),e.validationErrors.phoneNumber?(p(),g("span",IO,b(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),r("div",{class:le(["form-group",{"has-error":e.validationErrors.notes}])},[M[10]||(M[10]=r("label",null,"Additional details",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:M[3]||(M[3]=U=>_("notes",U.target.value)),class:le(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,xO),e.validationErrors.notes?(p(),g("span",$O,b(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(p(),g("div",TO,[M[12]||(M[12]=r("label",null,"Login link",-1)),M[13]||(M[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(p(),g("div",MO,"Loading link...")):h.value?(p(),g("div",AO,[r("div",EO,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:M[4]||(M[4]=U=>U.target.select())},null,40,PO),r("button",{type:"button",class:"btn btn-secondary",onClick:$},b(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:M[5]||(M[5]=U=>E.value=!0),title:"Show QR code"},[...M[11]||(M[11]=[pi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6c3801fd><rect x="3" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="3" y="14" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="14" width="3" height="3" data-v-6c3801fd></rect><rect x="19" y="14" width="2" height="2" data-v-6c3801fd></rect><rect x="14" y="19" width="2" height="2" data-v-6c3801fd></rect><rect x="19" y="19" width="2" height="2" data-v-6c3801fd></rect></svg>',1)])])]),S.value?(p(),g("p",DO,b(S.value),1)):P("",!0),f.value?(p(),g("div",RO,[r("button",{type:"button",class:"btn btn-primary",disabled:w.value,onClick:R},b(w.value?"Sending...":"Send via email"),9,OO)])):P("",!0),x.value?(p(),g("p",NO,"Email sent successfully!")):P("",!0),A.value?(p(),g("p",BO,b(A.value),1)):P("",!0)])):y.value?(p(),g("div",FO,b(y.value),1)):P("",!0)])):P("",!0),Pe(Uf,{show:E.value,url:h.value,title:"Scan to log in",onClose:M[6]||(M[6]=U=>E.value=!1)},null,8,["show","url"])]))}},zO=Ke(UO,[["__scopeId","data-v-6c3801fd"]]),HO={class:"card-header"},VO={class:"checkpoint-name-row"},GO=["innerHTML"],qO={class:"checkpoint-name"},jO={key:0,class:"checkpoint-description"},WO={key:0,class:"card-areas"},ZO={key:1,class:"card-check-in"},KO={key:0,class:"check-in-time"},YO={key:0,class:"check-in-method"},JO={key:1,class:"unsaved-indicator"},XO={key:2,class:"card-locked"},QO={class:"locked-badge"},eN={key:3,class:"card-badge"},tN={key:4,class:"card-badge"},nN={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.location?s.location.areaIds||s.location.AreaIds||[]:[]),l=H(()=>i.value.map(E=>{const _=s.areas.find(C=>C.id===E);return _?_.name:null}).filter(Boolean)),c=H(()=>i.value.map(E=>{const _=s.areas.find(C=>C.id===E);return _?_.color:"#999"})),d=H(()=>{if(!s.location)return"#667eea";const E=s.location,_=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor;if(_)return _;if(i.value.length>0){const C=s.areas.find(S=>S.id===i.value[0]);if(C)return C.color}return"#667eea"}),h=H(()=>{if(!s.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const E=s.location,_=E.resolvedStyleType||E.ResolvedStyleType,C=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor,S=E.resolvedStyleBorderColor||E.ResolvedStyleBorderColor,$=E.resolvedStyleIconColor||E.ResolvedStyleIconColor,R=E.resolvedStyleBackgroundShape||E.ResolvedStyleBackgroundShape;return _&&_!=="default"||C||S||$||R&&R!=="circle"?zn({type:_||"circle",backgroundShape:R||"circle",backgroundColor:C||"#667eea",borderColor:S||"#ffffff",iconColor:$||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=E=>E?new Date(E).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=H(()=>{const{checkedInBy:E,checkInMethod:_,marshalName:C}=s.assignment;return E&&E!==C?E:_||""}),y=H(()=>{const{checkInLatitude:E,checkInLongitude:_}=s.assignment,C=s.location;return!E||!_||!C?.latitude||!C?.longitude?null:sl(E,_,C.latitude,C.longitude)}),k=H(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),w=H(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),x=()=>{!s.assignment.isPending&&!s.isMarkedForRemoval&&!s.isLocked&&o("click",s.assignment)},A=()=>{o("distance-click",s.assignment)};return(E,_)=>(p(),g("div",{class:le(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:tt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",HO,[r("div",{class:"card-title",onClick:x},[r("span",VO,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,GO),r("span",qO,b(e.assignment.locationName),1),e.assignment.locationDescription?(p(),g("span",jO,"  "+b(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:_[0]||(_[0]=rt(C=>E.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=rt(C=>E.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(p(),g("div",WO,[(p(!0),g(Se,null,je(l.value,(C,S)=>(p(),g("span",{key:S,class:"area-badge",style:tt({backgroundColor:c.value[S]})},b(C),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(p(),g("div",ZO,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:_[2]||(_[2]=C=>E.$emit("toggle-check-in",e.assignment))},[..._[3]||(_[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",KO,[Je(b(f(e.assignment.checkInTime))+" ",1),m.value?(p(),g("span",YO,"("+b(m.value)+")",1)):P("",!0),k.value?(p(),g("span",{key:1,class:le(["check-in-distance",w.value]),onClick:rt(A,["stop"])},b(k.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",JO," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(p(),g("div",XO,[r("span",QO,"Viewing from this "+b(B(n).checkpoint),1)])):P("",!0),e.assignment.isPending?(p(),g("div",eN,[..._[4]||(_[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",tN,[..._[5]||(_[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},oN=Ke(nN,[["__scopeId","data-v-d3de6925"]]),sN={class:"tab-content"},aN={key:0,class:"read-only-notice"},iN={class:"section-title"},lN={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},rN={value:""},cN=["value"],uN={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,{pendingCheckInChanges:l,getEffectiveCheckInStatus:c,handleToggleCheckIn:d}=L1(()=>i("input")),h=D(""),f=D(new Set),m=H(()=>o.assignments?.length||0),y=U=>o.allLocations&&o.allLocations.find(F=>F.id===U)||null,k=H(()=>[...o.assignments].sort((U,F)=>(U.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),w=U=>f.value.has(U),x=U=>{U.isPending||i("select-checkpoint",U)},A=D(!1),E=D(null),_=U=>{c(U)?(E.value=U,A.value=!0):d(U)},C=()=>{E.value&&d(E.value),A.value=!1,E.value=null},S=()=>{A.value=!1,E.value=null},$=H(()=>E.value?`Are you sure you want to undo ${E.value.marshalName||"this marshal"}'s check-in?`:""),R=U=>{U.isPending?i("remove-assignment",U):(f.value.add(U.id),i("input"))},T=U=>{f.value.delete(U.id),i("input")},O=H(()=>{const U=[...o.availableLocations];return U.sort((F,j)=>F.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),U}),M=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([U,F])=>({assignmentId:U,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(U,F)=>(p(),g("div",sN,[e.lockedCheckpointId?(p(),g("div",aN," Viewing from "+b(B(s).checkpoint)+" - "+b(B(s).checkpoints)+" cannot be modified here. ",1)):P("",!0),r("h3",iN,"Assigned "+b(B(s).checkpoints)+" ("+b(m.value)+")",1),Pe(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${B(s).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${B(s).person} to ${B(s).checkpoints}.`},{default:Ve(()=>[(p(!0),g(Se,null,je(k.value,j=>(p(),Ge(oN,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":B(c)(j),"has-unsaved-changes":B(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":w(j.id),onClick:x,onToggleCheckIn:_,onRemove:R,onUndoRemove:T,onDistanceClick:F[0]||(F[0]=Z=>U.$emit("distance-click",Z))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&O.value.length>0?(p(),g("div",lN,[r("label",null,"Assign to "+b(B(s).checkpoint),1),We(r("select",{"onUpdate:modelValue":F[1]||(F[1]=j=>h.value=j),class:"form-input",onChange:M},[r("option",rN,"Select a "+b(B(s).checkpoint)+"...",1),(p(!0),g(Se,null,je(O.value,j=>(p(),g("option",{key:j.id,value:j.id},[Je(b(j.name),1),j.description?(p(),g(Se,{key:0},[Je(" - "+b(j.description),1)],64)):P("",!0)],8,cN))),128))],544),[[no,h.value]])])):P("",!0),Pe(mi,{show:A.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:S},null,8,["show","message"])]))}},dN=Ke(uN,[["__scopeId","data-v-07754949"]]),hN={class:"tab-content roles-tab"},fN={key:0,class:"empty-state"},pN={class:"help-text"},vN={key:1,class:"roles-list"},mN={class:"roles-label"},gN={class:"available-roles"},yN=["onClick"],kN={class:"role-checkbox"},bN=["checked","onChange"],wN={class:"role-info"},_N={class:"role-name"},CN={__name:"MarshalRolesTab",props:{roles:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["update:roles","input"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.roles||[]),l=D(new Set);Ye(()=>s.roles,f=>{l.value.size===0&&f&&f.length>0&&(l.value=new Set(f))},{immediate:!0});const c=H(()=>[...s.roleDefinitions].sort((f,m)=>{const y=l.value.has(f.roleId),k=l.value.has(m.roleId);return y!==k?y?-1:1:f.displayOrder!==m.displayOrder?(f.displayOrder||0)-(m.displayOrder||0):(f.name||"").localeCompare(m.name||"",void 0,{numeric:!0,sensitivity:"base"})})),d=H(()=>c.value),h=f=>{const m=i.value.includes(f);let y;m?y=i.value.filter(k=>k!==f):y=[...i.value,f],o("update:roles",y),o("input")};return(f,m)=>(p(),g("div",hN,[e.roleDefinitions.length===0?(p(),g("div",fN,[m[1]||(m[1]=r("p",null,"No roles have been defined for this event yet.",-1)),r("p",pN,"Create roles in the Roles tab to assign them to "+b(B(n).people)+".",1)])):(p(),g("div",vN,[r("label",mN,"Select roles for this "+b(B(n).person),1),r("div",gN,[(p(!0),g(Se,null,je(d.value,y=>(p(),g("div",{key:y.roleId,class:le(["role-option",{selected:i.value.includes(y.roleId)}]),onClick:k=>h(y.roleId)},[r("div",kN,[r("input",{type:"checkbox",checked:i.value.includes(y.roleId),onClick:m[0]||(m[0]=rt(()=>{},["stop"])),onChange:k=>h(y.roleId)},null,40,bN)]),r("div",wN,[r("span",_N,b(y.name),1)])],10,yN))),128))])]))]))}},LN=Ke(CN,[["__scopeId","data-v-f56e155c"]]),SN={class:"marshal-checklist-view"},IN={key:0,class:"loading-state"},xN={key:1,class:"error-state"},$N={key:2,class:"empty-state"},TN={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=H(()=>l.value.map(A=>{const E=h.value.get(A.itemId),_=E!==void 0?E.complete:A.isCompleted,C=E!==void 0&&E.complete!==A.isCompleted;return{...A,localIsCompleted:_,isModified:C}})),m=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,d.value=null;try{const A=await Ot.getMarshalChecklist(o.eventId,o.marshalId);if(l.value=A.data||[],o.modelValue&&o.modelValue.length>0){const E=new Map;o.modelValue.forEach(_=>{E.set(_.itemId,{complete:_.complete,contextType:_.contextType,contextId:_.contextId})}),h.value=E}}catch(A){console.error("Failed to load checklist:",A),d.value=A.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},y=A=>{const E=h.value.get(A.itemId),_=E!==void 0?E.complete:A.isCompleted;h.value.set(A.itemId,{complete:!_,contextType:A.completionContextType,contextId:A.completionContextId}),k()},k=()=>{const A=[];for(const[E,_]of h.value.entries()){const C=l.value.find(S=>S.itemId===E);C&&_.complete!==C.isCompleted&&A.push({itemId:E,complete:_.complete,contextType:_.contextType,contextId:_.contextId})}i("update:modelValue",A),i("change",A)},w=A=>{i("reorder",A)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const A=new Map;o.modelValue.forEach(E=>{A.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),h.value=A}},loadChecklist:m}),Ye(()=>[o.eventId,o.marshalId],()=>{m()},{immediate:!0}),(A,E)=>(p(),g("div",SN,[c.value?(p(),g("div",IN," Loading checklist... ")):d.value?(p(),g("div",xN,[r("p",null,b(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(p(),g("div",$N,[r("p",null,"No checklist items for this "+b(B(s).person)+".",1)])):(p(),Ge(zf,{key:3,items:f.value,locations:e.locations,areas:e.areas,"allow-reorder":e.allowReorder,onToggleComplete:y,onReorder:w},null,8,["items","locations","areas","allow-reorder"]))]))}},MN=Ke(TN,[["__scopeId","data-v-38a322f4"]]),AN={class:"checklist-preview"},EN={class:"preview-actions"},PN={class:"preview-header"},DN={key:0,class:"add-item-form"},RN=["placeholder"],ON=["disabled"],NN={key:1,class:"pending-items"},BN={class:"item-content"},FN={class:"item-header"},UN={class:"item-text"},zN={class:"item-scope"},HN=["onClick"],VN={key:2,class:"empty-state"},GN={key:0,class:"help-text"},qN={key:3,class:"checklist-items"},jN={class:"item-content"},WN={class:"item-header"},ZN={class:"item-text"},KN={class:"item-scope"},YN=["title"],JN={key:0,class:"item-context"},XN={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,_=>{c.value=[..._]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=_=>{c.value.splice(_,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")},m=H(()=>{const _=new Set;for(const C of s.pendingLocationIds){const S=s.allLocations.find($=>$.id===C);S&&(S.areaIds||S.AreaIds||[]).forEach(R=>_.add(R))}return[..._]}),y=_=>{const C=_.scope,S=_.itemType,$=_.ids||[];return C==="SpecificPeople"&&S==="Marshal"?$.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&S==="Checkpoint"?$.includes("ALL_CHECKPOINTS")?!0:$.some(R=>s.pendingLocationIds.includes(R)):C==="OnePerCheckpoint"&&S==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>m.value.includes(R)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&S==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>m.value.includes(R)):!1},k=H(()=>s.allChecklistItems.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some(C=>y(C)):!1)),w=_=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,EveryoneInAreas:`All in ${n.value.areas}`,OnePerArea:`One per ${n.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${n.value.area}`})[_]||_,x=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const C=_.scopeConfigurations.find($=>y($));if(!C)return w(_.scopeConfigurations[0].scope);const S=C.ids||[];return S.includes("ALL_MARSHALS")?"Everyone":S.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:S.includes("ALL_AREAS")?`All ${n.value.areas}`:w(C.scope)},A=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const C=_.scopeConfigurations.find($=>y($));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${n.value.checkpoints}`,OnePerCheckpoint:`One person at each ${n.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${n.value.areas}`,OnePerArea:`One person in each ${n.value.area} needs to complete this`,EveryAreaLead:`This item is for ${n.value.area} leads only`,OneLeadPerArea:`One ${n.value.area} lead needs to complete this`}[C.scope]||""},E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const C=_.scopeConfigurations.find(R=>y(R));if(!C)return null;const S=C.itemType,$=C.ids||[];if($.includes("ALL_MARSHALS")||$.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(S==="Checkpoint"){const R=s.allLocations.filter(T=>$.includes(T.id)&&s.pendingLocationIds.includes(T.id)).map(T=>T.name);if(R.length>0)return`At: ${R.join(", ")}`}if(S==="Area"){const R=s.areas.filter(T=>$.includes(T.id)&&m.value.includes(T.id)).map(T=>T.name);if(R.length>0)return`In: ${R.join(", ")}`}return null};return(_,C)=>(p(),g("div",AN,[r("div",EN,[r("p",PN,b(e.isEditing?`Add new ${B(n).checklist} for this ${B(n).person}:`:`${B(n).checklists} that will apply to this ${B(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=S=>i.value=!i.value)},b(i.value?"Cancel":`Add ${B(n).checklist}`),1)]),i.value?(p(),g("div",DN,[We(r("input",{"onUpdate:modelValue":C[1]||(C[1]=S=>l.value=S),type:"text",placeholder:`Enter ${B(n).checklist} text...`,class:"add-item-input",onKeyup:Xo(d,["enter"])},null,40,RN),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,ON)])):P("",!0),c.value.length>0?(p(),g("div",NN,[(p(!0),g(Se,null,je(c.value,(S,$)=>(p(),g("div",{key:`pending-${$}`,class:"checklist-item pending"},[C[3]||(C[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",BN,[r("div",FN,[r("div",UN,b(S.text),1),r("div",zN,[C[2]||(C[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:R=>h($),title:"Remove"},"  ",8,HN)])])])]))),128))])):P("",!0),!e.isEditing&&k.value.length===0&&c.value.length===0?(p(),g("div",VN,[r("p",null,"No "+b(B(n).checklists)+" will apply based on the current "+b(B(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",GN," Assign "+b(B(n).checkpoints)+" to see relevant "+b(B(n).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&k.value.length>0?(p(),g("div",qN,[(p(!0),g(Se,null,je(k.value,S=>(p(),g("div",{key:S.id,class:"checklist-item"},[C[4]||(C[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",jN,[r("div",WN,[r("div",ZN,b(S.text),1),r("div",KN,[r("span",{class:"scope-pill",title:A(S)},b(x(S)),9,YN)])]),E(S)?(p(),g("div",JN,b(E(S)),1)):P("",!0)])]))),128))])):P("",!0)]))}},QN=Ke(XN,[["__scopeId","data-v-6deaacc2"]]),eB={class:"notes-preview"},tB={class:"preview-actions"},nB={class:"preview-header"},oB={key:0,class:"add-item-form"},sB={class:"add-form-fields"},aB=["disabled"],iB={key:1,class:"pending-items"},lB={class:"note-header"},rB={class:"note-title"},cB={class:"note-actions"},uB=["onClick"],dB={key:0,class:"note-content"},hB={key:2,class:"empty-state"},fB={key:0,class:"help-text"},pB={key:3,class:"notes-list"},vB={class:"note-header"},mB={class:"note-title"},gB=["title"],yB={key:0,class:"note-content"},kB={key:1,class:"note-context"},bB={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{d.value=[...C]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=C=>{d.value.splice(C,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")},y=H(()=>{const C=new Set;for(const S of s.pendingLocationIds){const $=s.allLocations.find(R=>R.id===S);$&&($.areaIds||$.AreaIds||[]).forEach(T=>C.add(T))}return[...C]}),k=C=>{const S=C.scope,$=C.itemType,R=C.ids||[];return S==="SpecificPeople"&&$==="Marshal"?R.includes("ALL_MARSHALS"):S==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(T=>s.pendingLocationIds.includes(T)):S==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(T=>y.value.includes(T)):!1},w=H(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(S=>k(S)):!1)),x=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const S=C.scopeConfigurations.find(R=>k(R));if(!S)return x(C.scopeConfigurations[0].scope);const $=S.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:x(S.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const S=C.scopeConfigurations.find(R=>k(R));return S&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[S.scope]||""},_=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const S=C.scopeConfigurations.find(T=>k(T));if(!S)return null;const $=S.itemType,R=S.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const T=s.allLocations.filter(O=>R.includes(O.id)&&s.pendingLocationIds.includes(O.id)).map(O=>O.name);if(T.length>0)return`At: ${T.join(", ")}`}if($==="Area"){const T=s.areas.filter(O=>R.includes(O.id)&&y.value.includes(O.id)).map(O=>O.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(C,S)=>(p(),g("div",eB,[r("div",tB,[r("p",nB,b(e.isEditing?`Add new note for this ${B(n).person}:`:`Notes that will be visible to this ${B(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=$=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",oB,[r("div",sB,[We(r("input",{"onUpdate:modelValue":S[1]||(S[1]=$=>l.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":S[2]||(S[2]=$=>c.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,aB)])):P("",!0),d.value.length>0?(p(),g("div",iB,[(p(!0),g(Se,null,je(d.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",lB,[r("span",rB,b($.title||"Untitled"),1),r("div",cB,[S[3]||(S[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>f(R),title:"Remove"},"  ",8,uB)])]),$.content?(p(),g("div",dB,b($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&w.value.length===0&&d.value.length===0?(p(),g("div",hB,[r("p",null,"No notes will be visible based on the current "+b(B(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",fB," Assign "+b(B(n).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&w.value.length>0?(p(),g("div",pB,[(p(!0),g(Se,null,je(w.value,$=>(p(),g("div",{key:$.id,class:"note-item"},[r("div",vB,[r("span",mB,b($.title||"Untitled"),1),r("span",{class:"scope-pill",title:E($)},b(A($)),9,gB)]),$.content?(p(),g("div",yB,b($.content),1)):P("",!0),_($)?(p(),g("div",kB,b(_($)),1)):P("",!0)]))),128))])):P("",!0)]))}},wB=Ke(bB,[["__scopeId","data-v-e8e0946a"]]),_B={key:6,class:"tab-content incidents-tab"},CB={class:"incidents-list"},LB={class:"custom-footer"},SB={class:"footer-left"},IB={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3},roleDefinitions:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint","reorder-notes","reorder-checklists"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=e,l=n,c=D("details"),d=D(null),h=D(null),f=D(null),m=D([]),y=D([]),k=D([]),w=D([]),x=D({name:"",email:"",phoneNumber:"",notes:"",roles:[]}),A=D(!1),E=D(null),_=ee=>{E.value=ee,A.value=!0},C=()=>{A.value=!1,E.value=null},S=ee=>i.allLocations.find(Ce=>Ce.id===ee),$=H(()=>x.value.name||i.marshal?.name||""),R=H(()=>E.value&&S(E.value.locationId)?.name||""),T=H(()=>{if(!E.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce}=E.value;return!ee||!Ce?null:{lat:ee,lng:Ce}}),O=H(()=>{if(!E.value)return null;const ee=S(E.value.locationId);return!ee?.latitude||!ee?.longitude?null:{lat:ee.latitude,lng:ee.longitude}}),M=H(()=>{if(!E.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce,locationId:Be}=E.value,Fe=S(Be);return!ee||!Ce||!Fe?.latitude||!Fe?.longitude?null:sl(ee,Ce,Fe.latitude,Fe.longitude)}),U=H(()=>{const ee=i.isEditing?`Edit ${o.value.person}`:`Create ${o.value.person}`,Ce=x.value.name?.trim();return Ce?`${ee} - ${Ce}`:ee}),F=H(()=>{const ee=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:s.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ee.push({value:"incidents",label:"Incidents",icon:"incidents"}),ee.push({value:"roles",label:"Roles",icon:"roles"}),ee}),j=H(()=>F.value.findIndex(ee=>ee.value===c.value)),Z=H(()=>j.value===F.value.length-1),Q=H(()=>Z.value?null:F.value[j.value+1]),re=H(()=>Q.value?`${Q.value.label}...`:""),K=H(()=>y.value.map(ee=>ee.locationId)),ae=H(()=>i.isEditing?i.assignments:y.value.map(ee=>({id:`pending-${ee.locationId}`,locationId:ee.locationId,locationName:i.allLocations.find(Ce=>Ce.id===ee.locationId)?.name||"Unknown",isPending:!0}))),q=H(()=>{if(i.isEditing)return i.availableLocations;const ee=y.value.map(Ce=>Ce.locationId);return i.allLocations.filter(Ce=>!ee.includes(Ce.id))});Ye(()=>i.marshal,ee=>{ee?x.value={name:ee.name||"",email:ee.email||"",phoneNumber:ee.phoneNumber||"",notes:ee.notes||"",roles:ee.roles||[]}:x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}},{immediate:!0,deep:!0}),Ye(()=>i.show,ee=>{ee&&(c.value="details",m.value=[],y.value=[],k.value=[],w.value=[],i.isEditing||(x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const Y=ee=>{x.value=ee},te=ee=>{x.value={...x.value,roles:ee}},ue=()=>{l("update:isDirty",!0)},_e=()=>{l("update:isDirty",!0)},$e=()=>{Q.value&&(c.value=Q.value.value)},De=ee=>{l("reorder-notes",ee)},Re=ee=>{l("reorder-checklists",ee)},be=()=>{const ee={...x.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:w.value};l("save",ee)},z=()=>{l("delete")},J=ee=>{!i.isEditing&&ee.isPending?y.value=y.value.filter(Ce=>Ce.locationId!==ee.locationId):l("remove-assignment",ee)},de=ee=>{i.isEditing?l("assign-to-location",ee):(y.value.push({locationId:ee}),l("update:isDirty",!0))},ie=ee=>{l("select-checkpoint",ee)},Ae=()=>{l("close")};return t({switchToTab:ee=>{c.value=ee},focusField:ee=>{d.value?.focusField&&d.value.focusField(ee)}}),(ee,Ce)=>(p(),Ge(Yt,{show:e.show,title:U.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:Ae},{"tab-header":Ve(()=>[Pe(ul,{modelValue:c.value,"onUpdate:modelValue":Ce[0]||(Ce[0]=Be=>c.value=Be),tabs:F.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",LB,[r("div",SB,[e.isEditing&&!e.lockedCheckpointId?(p(),g("button",{key:0,type:"button",onClick:z,class:"btn btn-danger"}," Delete ")):P("",!0),!e.isEditing&&!Z.value?(p(),g("button",{key:1,type:"button",onClick:$e,class:"btn btn-secondary mobile-only"},b(re.value),1)):P("",!0)]),r("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[c.value==="details"?(p(),Ge(zO,{key:0,ref_key:"detailsTabRef",ref:d,form:x.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Y,onInput:ue},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),c.value==="checkpoints"?(p(),Ge(dN,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:ae.value,"available-locations":q.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:ue,onRemoveAssignment:J,onAssignToLocation:de,onSelectCheckpoint:ie,onDistanceClick:_},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),c.value==="checklists"&&e.isEditing?(p(),Ge(MN,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":Ce[1]||(Ce[1]=Be=>m.value=Be),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,"allow-reorder":!0,onChange:_e,onReorder:Re},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),c.value==="checklists"?(p(),Ge(QN,{key:3,modelValue:k.value,"onUpdate:modelValue":Ce[2]||(Ce[2]=Be=>k.value=Be),"all-checklist-items":e.allChecklistItems,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="notes"&&e.isEditing?(p(),Ge(ld,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:De},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),c.value==="notes"?(p(),Ge(wB,{key:5,modelValue:w.value,"onUpdate:modelValue":Ce[3]||(Ce[3]=Be=>w.value=Be),"all-notes":e.eventNotes,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="incidents"?(p(),g("div",_B,[r("div",CB,[(p(!0),g(Se,null,je(e.incidents,Be=>(p(),Ge(kc,{key:Be.incidentId,incident:Be,onSelect:Ce[4]||(Ce[4]=Fe=>ee.$emit("select-incident",Fe))},null,8,["incident"]))),128))])])):P("",!0),c.value==="roles"?(p(),Ge(LN,{key:7,roles:x.value.roles,"role-definitions":e.roleDefinitions,"onUpdate:roles":te,onInput:ue},null,8,["roles","role-definitions"])):P("",!0),Pe(Df,{show:A.value,"marshal-name":$.value,"checkpoint-name":R.value,"check-in-location":T.value,"checkpoint-location":O.value,distance:M.value,"z-index":e.zIndex+100,onClose:C},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},xB=Ke(IB,[["__scopeId","data-v-131580b5"]]),$B={class:"locations-list"},TB={class:"conflict-actions"},MB={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=t,i=c=>{o("choice",c)},l=()=>{o("close")};return(c,d)=>(p(),Ge(Yt,{show:e.show,title:`${B(n).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ve(()=>[r("div",TB,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+b(B(s).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ve(()=>[r("p",null,[r("strong",null,b(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),r("ul",$B,[(p(!0),g(Se,null,je(e.conflictData.locations,h=>(p(),g("li",{key:h},b(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},AB=Ke(MB,[["__scopeId","data-v-997e8aaa"]]),EB={key:0,class:"assign-marshal-section"},PB={value:""},DB=["value"],RB=["disabled"],OB={key:1,class:"assign-marshal-section create-mode"},NB={class:"form-group"},BB={class:"form-group"},FB={class:"form-group"},UB={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D({name:"",email:"",phoneNumber:""});Ye(()=>s.show,k=>{k||(i.value=!1,l.value="",c.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&o("assign-existing",l.value)},f=()=>{c.value.name&&o("create-and-assign",{...c.value})},m=()=>{i.value=!1,c.value={name:"",email:"",phoneNumber:""}},y=()=>{o("close")};return(k,w)=>(p(),Ge(Yt,{show:e.show,title:i.value?`Create new ${B(n).person}`:`Assign ${B(n).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ve(()=>[i.value?(p(),g(Se,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ve(()=>[i.value?(p(),g("div",OB,[r("h3",null,"Create new "+b(B(n).person),1),r("div",NB,[w[5]||(w[5]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":w[1]||(w[1]=x=>c.value.name=x),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",BB,[w[6]||(w[6]=r("label",null,"Email",-1)),We(r("input",{"onUpdate:modelValue":w[2]||(w[2]=x=>c.value.email=x),type:"email",class:"form-input"},null,512),[[st,c.value.email]])]),r("div",FB,[w[7]||(w[7]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":w[3]||(w[3]=x=>c.value.phoneNumber=x),type:"tel",class:"form-input"},null,512),[[st,c.value.phoneNumber]])])])):(p(),g("div",EB,[r("h3",null,"Select existing "+b(B(n).person),1),We(r("select",{"onUpdate:modelValue":w[0]||(w[0]=x=>l.value=x),class:"form-input"},[r("option",PB,"Choose a "+b(B(n).person)+"...",1),(p(!0),g(Se,null,je(e.marshals,x=>(p(),g("option",{key:x.id,value:x.id},[Je(b(x.name)+" ",1),x.assignedLocationIds&&x.assignedLocationIds.length>0?(p(),g(Se,{key:0},[Je(" (assigned to "+b(x.assignedLocationIds.length)+" "+b(x.assignedLocationIds.length>1?B(n).checkpoints:B(n).checkpoint)+") ",1)],64)):P("",!0)],8,DB))),128))],512),[[no,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+b(B(n).person),9,RB),w[4]||(w[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+b(B(n).person),1)]))]),_:1},8,["show","title"]))}},zB=Ke(UB,[["__scopeId","data-v-fa70b913"]]),HB={class:"shift-times-content"},VB={class:"info-text"},GB={class:"time-delta-info"},qB={class:"delta-detail"},jB={class:"delta-detail"},WB={class:"delta-summary"},ZB={class:"affected-checkpoints"},KB={class:"option-selection"},YB={class:"radio-option"},JB={class:"radio-option"},XB={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D("shift"),c=H(()=>{const y=new Date(o.oldEventDate);return new Date(o.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const k=Math.abs(y),w=y>=0?"+":"-",x=Math.floor(k/(1e3*60*60*24)),A=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(k%(1e3*60*60)/(1e3*60)),_=[];return x>0&&_.push(`${x}d`),A>0&&_.push(`${A}h`),E>0&&_.push(`${E}m`),`${w}${_.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:c.value})},m=()=>{i("cancel")};return(y,k)=>(p(),Ge(Yt,{show:e.show,title:`Shift ${B(n).checkpoint} Times?`,size:"medium",onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},b(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ve(()=>[r("div",HB,[r("p",VB," You've changed the event date/time. Some "+b(B(s).checkpoints)+" have custom times set. ",1),r("div",GB,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",qB," Old: "+b(d(e.oldEventDate)),1),r("div",jB," New: "+b(d(e.newEventDate)),1),r("div",WB," Delta: "+b(h(c.value)),1)]),r("p",ZB,[r("strong",null,b(e.affectedCheckpointsCount)+" "+b(e.affectedCheckpointsCount===1?B(s).checkpoint:B(s).checkpoints),1),k[3]||(k[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),r("div",KB,[r("label",YB,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=w=>l.value=w),type:"radio",value:"shift",name:"shift-option"},null,512),[[Dp,l.value]]),r("div",null,[r("strong",null,"Shift all "+b(B(s).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",JB,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>l.value=w),type:"radio",value:"keep",name:"shift-option"},null,512),[[Dp,l.value]]),r("div",null,[r("strong",null,"Keep "+b(B(s).checkpoint)+" times unchanged",1),r("small",null,b(B(n).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},QB=Ke(XB,[["__scopeId","data-v-a6454aff"]]),e9={class:"checklist-preview"},t9={class:"preview-actions"},n9={class:"preview-header"},o9={key:0,class:"add-item-form"},s9=["placeholder"],a9=["disabled"],i9={key:1,class:"pending-items"},l9={class:"item-content"},r9={class:"item-header"},c9={class:"item-text"},u9={class:"item-scope"},d9=["onClick"],h9={key:2,class:"empty-state"},f9={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,m=>{c.value=[...m]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=m=>{c.value.splice(m,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")};return(m,y)=>(p(),g("div",e9,[r("div",t9,[r("p",n9," Add new "+b(B(n).checklist)+" for this "+b(B(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=k=>i.value=!i.value)},b(i.value?"Cancel":`Add ${B(n).checklist}`),1)]),i.value?(p(),g("div",o9,[We(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),type:"text",placeholder:`Enter ${B(n).checklist} text...`,class:"add-item-input",onKeyup:Xo(d,["enter"])},null,40,s9),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,a9)])):P("",!0),c.value.length>0?(p(),g("div",i9,[(p(!0),g(Se,null,je(c.value,(k,w)=>(p(),g("div",{key:`pending-${w}`,class:"checklist-item pending"},[y[3]||(y[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",l9,[r("div",r9,[r("div",c9,b(k.text),1),r("div",u9,[y[2]||(y[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:x=>h(w),title:"Remove"},"  ",8,d9)])])])]))),128))])):P("",!0),c.value.length===0&&!i.value?(p(),g("div",h9,[r("p",null,"No new "+b(B(n).checklists)+" to add. Click the button above to create one.",1)])):P("",!0)]))}},p9=Ke(f9,[["__scopeId","data-v-a394c400"]]),v9={class:"notes-preview"},m9={class:"preview-actions"},g9={class:"preview-header"},y9={key:0,class:"add-item-form"},k9={class:"add-form-fields"},b9=["disabled"],w9={key:1,class:"pending-items"},_9={class:"note-header"},C9={class:"note-title"},L9={class:"note-actions"},S9=["onClick"],I9={key:0,class:"note-content"},x9={key:2,class:"empty-state"},$9={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=y=>{d.value.splice(y,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")};return(y,k)=>(p(),g("div",v9,[r("div",m9,[r("p",g9," Add new note for this "+b(B(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=w=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",y9,[r("div",k9,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>l.value=w),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=w=>c.value=w),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,b9)])):P("",!0),d.value.length>0?(p(),g("div",w9,[(p(!0),g(Se,null,je(d.value,(w,x)=>(p(),g("div",{key:`pending-${x}`,class:"note-item pending"},[r("div",_9,[r("span",C9,b(w.title||"Untitled"),1),r("div",L9,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:A=>f(x),title:"Remove"},"  ",8,S9)])]),w.content?(p(),g("div",I9,b(w.content),1)):P("",!0)]))),128))])):P("",!0),d.value.length===0&&!i.value?(p(),g("div",x9,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):P("",!0)]))}},T9=Ke($9,[["__scopeId","data-v-5e6bdcab"]]),M9={class:"search-section"},A9={class:"form-group"},E9={class:"suggestions-list"},P9={class:"suggestion-content"},D9={key:0,class:"suggestion-detail"},R9=["onClick"],O9={class:"suggestion-content"},N9={class:"suggestion-name"},B9={key:0,class:"suggestion-detail"},F9=["onClick"],U9={class:"suggestion-content"},z9={class:"suggestion-name"},H9={key:0,class:"suggestion-detail"},V9={key:1,class:"no-results"},G9={key:2,class:"no-results"},q9={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(""),l=D(null),c=H(()=>s.contacts.filter(T=>s.excludeContactIds.includes(T.contactId)&&T.marshalId).map(T=>T.marshalId)),d=H(()=>s.contacts.filter(T=>T.marshalId).map(T=>T.marshalId)),h=H(()=>s.contacts.filter(T=>!s.excludeContactIds.includes(T.contactId))),f=H(()=>s.marshals.filter(T=>!c.value.includes(T.id)&&!d.value.includes(T.id))),m=T=>T?T.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=H(()=>{const T=m(i.value);return T?T.split(" ").filter(O=>O.length>0):[]}),k=(T,O)=>{if(O.length===0)return{score:1,isPartial:!1};const M=m(T);let U=0;for(const F of O)M.includes(F)&&U++;return{score:U,isPartial:U>0&&U<O.length,isFullMatch:U===O.length}},w=H(()=>{const T=y.value,O=[];return h.value.forEach(M=>{const U=`${M.name||""} ${M.role||""}`,F=k(U,T);(T.length===0||F.score>0)&&O.push({key:`contact-${M.contactId}`,type:"contact",name:M.name,detail:M.role?R(M.role):null,data:M,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),f.value.forEach(M=>{const U=`${M.name||""} ${M.email||""}`,F=k(U,T);(T.length===0||F.score>0)&&O.push({key:`marshal-${M.id}`,type:"marshal",name:M.name,detail:M.email||M.phoneNumber||null,data:M,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),O.sort((M,U)=>U.matchScore!==M.matchScore?U.matchScore-M.matchScore:M.name.localeCompare(U.name,void 0,{sensitivity:"base"})),O}),x=H(()=>y.value.length===0?w.value:w.value.filter(T=>T.isFullMatch)),A=H(()=>y.value.length===0?[]:w.value.filter(T=>T.isPartial)),E=H(()=>A.value.length>0);Ye(()=>s.show,async T=>{T&&(i.value="",await rn(),l.value?.focus())});const _=T=>{const O=s.contacts.find(M=>M.marshalId===T.id);if(O){if(s.excludeContactIds.includes(O.contactId))return;o("select-contact",O)}else o("create-from-marshal",T)},C=T=>{o("select-contact",T)},S=()=>{o("create-new",i.value.trim())},$=()=>{o("close")},R=T=>T?T.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"";return(T,O)=>(p(),Ge(Yt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:$},{actions:Ve(()=>[r("button",{onClick:$,class:"btn btn-secondary"}," Cancel ")]),default:Ve(()=>[r("div",M9,[r("div",A9,[O[1]||(O[1]=r("label",null,"Search or create",-1)),We(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":O[0]||(O[0]=M=>i.value=M),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",E9,[r("div",{class:"suggestion-item create-new",onClick:S},[O[3]||(O[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",P9,[O[2]||(O[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(p(),g("span",D9,'"'+b(i.value.trim())+'"',1)):P("",!0)])]),(p(!0),g(Se,null,je(x.value,M=>(p(),g("div",{key:M.key,class:"suggestion-item",onClick:U=>M.type==="marshal"?_(M.data):C(M.data)},[r("span",{class:le(["suggestion-icon",M.type==="marshal"?"marshal-icon":"contact-icon"])},b(M.type==="marshal"?"M":"C"),3),r("div",O9,[r("span",N9,b(M.name),1),M.detail?(p(),g("span",B9,b(M.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":M.type==="contact"}])},b(M.type==="marshal"?B(n).person:"Contact"),3)],8,R9))),128)),E.value?(p(),g(Se,{key:0},[O[4]||(O[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(p(!0),g(Se,null,je(A.value,M=>(p(),g("div",{key:M.key,class:"suggestion-item",onClick:U=>M.type==="marshal"?_(M.data):C(M.data)},[r("span",{class:le(["suggestion-icon",M.type==="marshal"?"marshal-icon":"contact-icon"])},b(M.type==="marshal"?"M":"C"),3),r("div",U9,[r("span",z9,b(M.name),1),M.detail?(p(),g("span",H9,b(M.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":M.type==="contact"}])},b(M.type==="marshal"?B(n).person:"Contact"),3)],8,F9))),128))],64)):P("",!0),i.value.trim()&&x.value.length===0&&A.value.length===0?(p(),g("div",V9," No matching "+b(B(n).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!i.value.trim()&&x.value.length===0?(p(),g("div",G9," No "+b(B(n).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},j9=Ke(q9,[["__scopeId","data-v-e25ca97b"]]),W9={class:"contact-card-header"},Z9={class:"contact-name-row"},K9={key:0,class:"pin-icon",title:"Pinned"},Y9={key:1,class:"primary-badge",title:"Primary contact"},J9={class:"contact-name"},X9={key:0,class:"contact-role"},Q9={key:0,class:"emergency-indicator",title:"Shown in emergency info"},eF={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},tF=["title"],nF={key:0,class:"contact-card-details"},oF={key:0,class:"contact-phone"},sF={key:1,class:"contact-email"},aF={key:1,class:"contact-card-notes"},iF={key:3,class:"contact-card-badge"},lF={key:4,class:"contact-card-badge"},rF={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=H(()=>{const m=new Map;for(const y of s.roleDefinitions)m.set(y.roleId,y.name),m.set(y.name,y.name);return m}),l=H(()=>s.contact.roles&&Array.isArray(s.contact.roles)&&s.contact.roles.length>0?s.contact.roles:s.contact.role?[s.contact.role]:[]),c=H(()=>{const m=s.contact.scopeConfigurations;return!m||m.length===0}),d=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&o("click",s.contact)},h=m=>{if(!m)return"";const y=i.value.get(m);return y||(m==="AreaLead"?`${n.value.area} Lead`:m.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim())},f=m=>{if(!m)return"";const y=100;return m.length<=y?m:m.substring(0,y)+"..."};return(m,y)=>(p(),g("div",{class:le(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:d},[r("div",W9,[r("div",{class:le(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",Z9,[e.contact.isPinned&&!e.isMarkedForRemoval?(p(),g("span",K9,"")):P("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(p(),g("span",Y9,"")):P("",!0),r("span",J9,b(e.contact.name),1)]),l.value.length>0?(p(),g("span",X9,b(l.value.map(h).join(", ")),1)):P("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(p(),g("span",Q9,"")):P("",!0),c.value&&!e.isMarkedForRemoval&&!e.isPending?(p(),g("span",eF,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(p(),g("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:y[0]||(y[0]=rt(k=>m.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,tF)):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:y[1]||(y[1]=rt(k=>m.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(p(),g("div",nF,[e.contact.phone?(p(),g("span",oF,b(e.contact.phone),1)):P("",!0),e.contact.email?(p(),g("span",sF,b(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(p(),g("div",aF,b(f(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(p(),Ge(nl,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):P("",!0),e.isPending?(p(),g("div",iF,[...y[2]||(y[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",lF,[...y[3]||(y[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},cF=Ke(rF,[["__scopeId","data-v-9a194a03"]]),uF={class:"contact-card-wrapper"},dF={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["select","remove","undo-remove","reorder"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>[...n.contacts].sort((d,h)=>{if(d.isPinned!==h.isPinned)return d.isPinned?-1:1;const f=d.displayOrder||0,m=h.displayOrder||0;return f!==m?f-m:(d.name||"").localeCompare(h.name||"",void 0,{sensitivity:"base"})})),i=d=>typeof n.removeTitle=="function"?n.removeTitle(d):n.removeTitle,l=d=>!d.isPending,c=({changes:d})=>{s("reorder",d)};return(d,h)=>(p(),Ge(bc,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[e.contacts.length>0?(p(),Ge(il,{key:0,items:o.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:c},{item:Ve(({element:f})=>[r("div",uF,[e.allowReorder?(p(),Ge(ll,{key:0})):P("",!0),Pe(cF,{contact:f,"is-pending":f.isPending,"is-marked-for-removal":f.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":i(f),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:l(f),areas:e.areas,locations:e.locations,marshals:e.marshals,"role-definitions":e.roleDefinitions,onClick:m=>d.$emit("select",f),onRemove:h[0]||(h[0]=m=>d.$emit("remove",m)),onUndoRemove:h[1]||(h[1]=m=>d.$emit("undo-remove",m))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","role-definitions","onClick"])])]),_:1},8,["items","disabled","show-order-overlay"])):P("",!0)]),_:1},8,["is-empty","empty-message","empty-hint"]))}},hF=Ke(dF,[["__scopeId","data-v-4c025463"]]),fF={key:0,class:"tab-content"},pF={class:"form-group"},vF=["disabled"],mF={class:"form-group"},gF={key:1,class:"tab-content"},yF={class:"boundary-section"},kF={key:0,class:"boundary-preview"},bF={class:"boundary-actions"},wF={key:2,class:"tab-content"},_F={class:"contacts-header"},CF={class:"section-title"},LF={key:3,class:"tab-content"},SF={class:"section-title"},IF={key:4,class:"placeholder-message"},xF={key:7,class:"placeholder-message"},$F={key:10,class:"placeholder-message"},TF={key:11,class:"tab-content appearance-tab"},MF={class:"accordion-item"},AF=["innerHTML"],EF={class:"accordion-title"},PF={class:"accordion-arrow"},DF={key:0,class:"accordion-content"},RF={class:"section-description"},OF={class:"color-picker"},NF=["title","onClick"],BF={class:"accordion-item"},FF=["innerHTML"],UF={class:"accordion-title"},zF={class:"accordion-arrow"},HF={key:0,class:"accordion-content"},VF={class:"section-description"},GF={class:"accordion-item"},qF={class:"accordion-title"},jF={class:"accordion-preview"},WF={class:"accordion-arrow"},ZF={key:0,class:"accordion-content"},KF={class:"section-description"},YF={class:"form-group"},JF={value:""},XF=["value"],QF={class:"accordion-item"},e7={class:"accordion-title"},t7={class:"accordion-preview"},n7={class:"accordion-arrow"},o7={key:0,class:"accordion-content"},s7={class:"section-description"},a7={class:"form-group"},i7={value:""},l7=["value"],r7={key:12,class:"tab-content incidents-tab"},c7={class:"incidents-list"},u7={class:"custom-footer"},d7={class:"footer-left"},gm="edit_area_accordion",h7={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident","reorder-notes","reorder-checklists","reorder-contacts"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=()=>$.value.peopleTerm?$.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(ne=!0)=>{const ye=$.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",He=i();return ne?Yy("checkpoint",ye,He):ji("checkpoint",ye,He)},c=(ne=!0)=>l(ne).toLowerCase(),d=e,h=n,f=D("details"),m=D(null),y=D([]),k=D({}),w=D({}),x=D(!1),A=D(!1),E=D([]),_=D([]),C=D([]),S=D([]),$=D({name:"",description:"",color:tu,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>({name:"",description:"",color:xL(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),T=()=>d.eventId?`${gm}_${d.eventId}`:gm,O=D({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});cn(()=>{const ne=localStorage.getItem(T());if(ne)try{const ye=JSON.parse(ne);O.value={...O.value,...ye}}catch{}});const M=ne=>{O.value[ne]=!O.value[ne],localStorage.setItem(T(),JSON.stringify(O.value))},U=H(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${$.value.color||tu}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),F=H(()=>{const ne=$.value.checkpointStyleType!=="default"||$.value.checkpointStyleBackgroundShape||$.value.checkpointStyleBackgroundColor||$.value.checkpointStyleBorderColor||$.value.checkpointStyleIconColor||$.value.checkpointStyleSize,ye=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!ne&&!ye)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const He=$.value.checkpointStyleType&&$.value.checkpointStyleType!=="default"?$.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",ct=$.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",ht=$.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Nt=$.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Lt=$.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",Bt=$.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return zn({type:He!=="default"?He:ct,backgroundShape:ct,backgroundColor:ht,borderColor:Nt,iconColor:Lt,size:Bt,outputSize:24})}),j=H(()=>d.area&&d.area.id),Z=H(()=>!$.value.polygon||$.value.polygon.length===0?[]:$.value.polygon.map((ne,ye)=>({id:`polygon-point-${ye}`,latitude:ne.lat,longitude:ne.lng}))),Q=H(()=>d.area?.id?d.areas.filter(ne=>ne.id!==d.area.id).map(ne=>({...ne,color:"#999999"})):d.areas.map(ne=>({...ne,color:"#999999"})));H(()=>ue.value.map(ne=>ne.id));const re=H(()=>{const ne=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&ne.push({value:"incidents",label:"Incidents",icon:"incidents"}),ne}),K=H(()=>re.value.findIndex(ne=>ne.value===f.value)),ae=H(()=>K.value===re.value.length-1),q=H(()=>ae.value?null:re.value[K.value+1]),Y=H(()=>q.value?`${q.value.label}...`:""),te=H(()=>{if(!d.area||!d.area.id)return[];const ne=d.checkpoints.filter(ye=>ye.areaIds&&ye.areaIds.includes(d.area.id)).map(ye=>ye.id);return d.assignments.filter(ye=>ne.includes(ye.locationId))}),ue=H(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(ne=>ne.areaIds&&ne.areaIds.includes(d.area.id))),_e=H(()=>{const ne=[...ue.value];return ne.sort((ye,He)=>{const ct=ye.name.match(/^(\d+)/),ht=He.name.match(/^(\d+)/);if(ct&&ht){const Nt=parseInt(ct[1]),Lt=parseInt(ht[1]);if(Nt!==Lt)return Nt-Lt}return ye.name.localeCompare(He.name,void 0,{numeric:!0,sensitivity:"base"})}),ne}),$e=H(()=>!d.area||!d.area.id?[]:d.contacts.filter(ne=>ne.scopeConfigurations?ne.scopeConfigurations.some(ye=>ye.scope==="EveryoneInAreas"&&ye.itemType==="Area"?ye.ids?.includes("ALL_AREAS")?!0:ye.ids?.includes(d.area.id):!1):!1)),De=H(()=>{const ne=new Set($e.value.map(ct=>ct.contactId)),ye=$e.value.map(ct=>({...ct,isPending:!1,isExisting:!0,isMarkedForRemoval:_.value.includes(ct.contactId)})),He=E.value.filter(ct=>!ne.has(ct.contactId)).map(ct=>({...ct,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...ye,...He].sort((ct,ht)=>ct.name.localeCompare(ht.name,void 0,{sensitivity:"base"}))}),Re=H(()=>{const ne=$e.value.map(He=>He.contactId),ye=E.value.map(He=>He.contactId);return[...ne,...ye]}),be=async ne=>{if(!(k.value[ne]||w.value[ne])){w.value[ne]=!0;try{const He=(await Ot.getCheckpointChecklist(d.eventId,ne)).data||[];k.value[ne]={total:He.length,completed:He.filter(ct=>ct.isCompleted).length}}catch(ye){console.error("Failed to load checklist status for checkpoint:",ne,ye),k.value[ne]={total:0,completed:0}}finally{w.value[ne]=!1}}};Ye(()=>d.area,ne=>{if(ne){const ye=ne.polygon?typeof ne.polygon=="string"?JSON.parse(ne.polygon):ne.polygon:[];$.value={name:ne.name||"",description:ne.description||"",color:ne.color||tu,displayOrder:ne.displayOrder||0,isDefault:ne.isDefault||!1,polygon:ye,checkpointStyleType:ne.checkpointStyleType||"default",checkpointStyleColor:ne.checkpointStyleColor||"",checkpointStyleBackgroundShape:ne.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:ne.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:ne.checkpointStyleBorderColor||"",checkpointStyleIconColor:ne.checkpointStyleIconColor||"",checkpointStyleSize:ne.checkpointStyleSize||"",checkpointStyleMapRotation:ne.checkpointStyleMapRotation??"",peopleTerm:ne.peopleTerm||"",checkpointTerm:ne.checkpointTerm||""}}else $.value=R()},{immediate:!0,deep:!0}),Ye(()=>d.show,ne=>{ne&&(f.value=d.initialTab||"details",y.value=[],k.value={},w.value={},E.value=[],_.value=[],C.value=[],S.value=[],A.value=!1,j.value||($.value=R()),m.value?.resetLocalState&&m.value.resetLocalState())}),Ye(f,ne=>{ne==="checkpoints"&&d.area&&d.area.id&&ue.value.forEach(ye=>{setTimeout(()=>be(ye.id),0)})});const z=()=>{h("update:isDirty",!0)},J=ne=>{$.value.color=ne,z()},de=(ne,ye)=>{$.value[ne]=ye,z()},ie=()=>{h("draw-boundary",$.value)},Ae=ne=>{$.value.polygon=ne,z()},G=()=>{$.value.polygon=[],x.value=!1,z()},X=ne=>{A.value=!1,h("create-contact-from-marshal",{marshal:ne,area:d.area})},ee=ne=>{A.value=!1,h("create-new-contact",{name:ne,area:d.area})},Ce=ne=>{E.value.find(ye=>ye.contactId===ne.contactId)||(E.value.push(ne),z()),A.value=!1},Be=ne=>{E.value=E.value.filter(ye=>ye.contactId!==ne),z()},Fe=ne=>{_.value.includes(ne)||(_.value.push(ne),z())},Ee=ne=>ne.isPending?"Remove pending contact":`Remove from ${o.value.area}`,oe=ne=>{De.value.find(He=>He.contactId===ne)?.isPending?Be(ne):Fe(ne)},ge=ne=>{_.value=_.value.filter(ye=>ye!==ne),z()},Ne=ne=>{y.value=ne,z()},Oe=()=>{q.value&&(f.value=q.value.value)},xe=ne=>{h("reorder-notes",ne)},me=ne=>{h("reorder-checklists",ne)},Ze=ne=>{h("reorder-contacts",ne)},qe=()=>{const ne=d.area?{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,displayOrder:$.value.displayOrder,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:E.value||[],contactsToRemove:_.value||[],pendingNewChecklistItems:C.value||[],pendingNewNotes:S.value||[]}:{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,pendingContacts:E.value||[]};h("save",ne)},fe=()=>{h("delete",d.area.id)},ke=()=>{h("close")};return t({addPendingContact:ne=>{ne&&!E.value.find(ye=>ye.contactId===ne.contactId)&&(E.value.push(ne),z())},removeContactById:ne=>{const ye=E.value.some(He=>He.contactId===ne);E.value=E.value.filter(He=>He.contactId!==ne),_.value=_.value.filter(He=>He!==ne),ye&&z()}}),(ne,ye)=>(p(),Ge(Yt,{show:e.show,title:e.area&&e.area.id?`Edit ${B(o).area}: ${e.area.name}`:`Create new ${B(o).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ke},{"tab-header":Ve(()=>[Pe(ul,{modelValue:f.value,"onUpdate:modelValue":ye[0]||(ye[0]=He=>f.value=He),tabs:re.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",u7,[r("div",d7,[j.value&&!$.value.isDefault?(p(),g("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete ")):P("",!0),!j.value&&!ae.value?(p(),g("button",{key:1,type:"button",onClick:Oe,class:"btn btn-secondary mobile-only"},b(Y.value),1)):P("",!0)]),r("button",{type:"button",onClick:qe,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[f.value==="details"?(p(),g("div",fF,[r("form",{onSubmit:rt(qe,["prevent"])},[r("div",pF,[ye[27]||(ye[27]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":ye[1]||(ye[1]=He=>$.value.name=He),type:"text",required:"",class:"form-input",disabled:$.value.isDefault,onInput:z},null,40,vF),[[st,$.value.name]])]),r("div",mF,[ye[28]||(ye[28]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":ye[2]||(ye[2]=He=>$.value.description=He),class:"form-input",rows:"3",onInput:z},null,544),[[st,$.value.description]])])],32)])):P("",!0),f.value==="boundary"?(p(),g("div",gF,[r("div",yF,[$.value.polygon&&$.value.polygon.length>0?(p(),g("div",kF,[Pe(al,{mode:"edit-polygon","editing-polygon":$.value.polygon,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,locations:e.checkpoints,areas:Q.value,"all-locations-for-bounds":Z.value,height:"300px",onPolygonUpdate:Ae},null,8,["editing-polygon","route","route-color","route-style","route-weight","locations","areas","all-locations-for-bounds"]),ye[29]||(ye[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),r("div",bF,[!$.value.polygon||$.value.polygon.length===0?(p(),g("button",{key:0,onClick:ie,class:"btn btn-primary btn-full"}," Draw on map ")):(p(),g(Se,{key:1},[r("button",{onClick:ie,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:ye[3]||(ye[3]=He=>x.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Pe(mi,{show:x.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:G,onCancel:ye[4]||(ye[4]=He=>x.value=!1)},null,8,["show"]),f.value==="contacts"?(p(),g("div",wF,[r("div",_F,[r("h3",CF,b(B(s).area)+" contacts ("+b(De.value.length)+")",1),r("button",{onClick:ye[5]||(ye[5]=He=>A.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Pe(hF,{contacts:De.value,"show-remove-button":!0,"remove-title":Ee,"empty-message":`No contacts assigned to this ${B(o).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${B(o).people} in this ${B(o).area}.`,"allow-reorder":j.value,"role-definitions":e.roleDefinitions,onSelect:ye[6]||(ye[6]=He=>ne.$emit("edit-contact",He)),onRemove:oe,onUndoRemove:ge,onReorder:Ze},null,8,["contacts","empty-message","empty-hint","allow-reorder","role-definitions"])])):P("",!0),Pe(j9,{show:A.value,"area-name":$.value.name||"this "+B(o).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Re.value,onClose:ye[7]||(ye[7]=He=>A.value=!1),onSelectContact:Ce,onCreateFromMarshal:X,onCreateNew:ee},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(p(),g("div",LF,[r("h3",SF,b(l())+" in "+b(e.area?.name)+" ("+b(ue.value.length)+")",1),Pe(k1,{checkpoints:_e.value,areas:e.areas,"empty-message":`No ${c()} in this ${B(o).area} yet.`,onSelect:ye[8]||(ye[8]=He=>ne.$emit("select-checkpoint",He))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),f.value==="checkpoints"&&!j.value?(p(),g("div",IF,[r("p",null,b(l())+" will be automatically assigned based on boundaries after the "+b(B(o).area)+" is created.",1)])):P("",!0),f.value==="checklists"&&j.value?(p(),Ge(S1,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":ye[9]||(ye[9]=He=>y.value=He),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:te.value,marshals:e.marshals,"allow-reorder":!0,onChange:Ne,onReorder:me},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):P("",!0),f.value==="checklists"&&j.value?(p(),Ge(p9,{key:6,modelValue:C.value,"onUpdate:modelValue":ye[10]||(ye[10]=He=>C.value=He),onChange:z},null,8,["modelValue"])):P("",!0),f.value==="checklists"&&!j.value?(p(),g("div",xF,[r("p",null,b(B(s).checklists)+" can be assigned after the "+b(B(o).area)+" is created.",1)])):P("",!0),f.value==="notes"&&j.value?(p(),Ge(ld,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals,"allow-reorder":!0,onReorder:xe},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),f.value==="notes"&&j.value?(p(),Ge(T9,{key:9,modelValue:S.value,"onUpdate:modelValue":ye[11]||(ye[11]=He=>S.value=He),onChange:z},null,8,["modelValue"])):P("",!0),f.value==="notes"&&!j.value?(p(),g("div",$F,[r("p",null,"Notes can be viewed after the "+b(B(o).area)+" is created.",1)])):P("",!0),f.value==="appearance"?(p(),g("div",TF,[r("div",MF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.polygonColor}]),onClick:ye[12]||(ye[12]=He=>M("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:U.value},null,8,AF),r("span",EF,b(B(s).area)+" polygon colour",1),r("span",PF,b(O.value.polygonColor?"":""),1)],2),O.value.polygonColor?(p(),g("div",DF,[r("p",RF," Choose a colour for this "+b(B(o).area)+"'s boundary on the map. ",1),r("div",OF,[(p(!0),g(Se,null,je(B(Un),He=>(p(),g("div",{key:He.hex,class:le(["color-swatch",{selected:$.value.color===He.hex}]),style:tt({backgroundColor:He.hex}),title:He.name,onClick:ct=>J(He.hex)},null,14,NF))),128))])])):P("",!0)]),r("div",BF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.iconStyle}]),onClick:ye[13]||(ye[13]=He=>M("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:F.value},null,8,FF),r("span",UF,b(l(!1))+" marker style",1),r("span",zF,b(O.value.iconStyle?"":""),1)],2),O.value.iconStyle?(p(),g("div",HF,[r("p",VF," Set a default marker style for all "+b(c())+" in this "+b(B(o).area)+". Individual "+b(c())+" can override this setting. ",1),Pe(Bf,{"style-type":$.value.checkpointStyleType||"default","style-color":$.value.checkpointStyleColor||"","style-background-shape":$.value.checkpointStyleBackgroundShape||"","style-background-color":$.value.checkpointStyleBackgroundColor||"","style-border-color":$.value.checkpointStyleBorderColor||"","style-icon-color":$.value.checkpointStyleIconColor||"","style-size":$.value.checkpointStyleSize||"","style-map-rotation":$.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":ye[14]||(ye[14]=He=>de("checkpointStyleType",He)),"onUpdate:styleColor":ye[15]||(ye[15]=He=>de("checkpointStyleColor",He)),"onUpdate:styleBackgroundShape":ye[16]||(ye[16]=He=>de("checkpointStyleBackgroundShape",He)),"onUpdate:styleBackgroundColor":ye[17]||(ye[17]=He=>de("checkpointStyleBackgroundColor",He)),"onUpdate:styleBorderColor":ye[18]||(ye[18]=He=>de("checkpointStyleBorderColor",He)),"onUpdate:styleIconColor":ye[19]||(ye[19]=He=>de("checkpointStyleIconColor",He)),"onUpdate:styleSize":ye[20]||(ye[20]=He=>de("checkpointStyleSize",He)),"onUpdate:styleMapRotation":ye[21]||(ye[21]=He=>de("checkpointStyleMapRotation",He))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),r("div",GF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.peopleTerm}]),onClick:ye[22]||(ye[22]=He=>M("peopleTerm"))},[ye[30]||(ye[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",qF,b(i())+" terminology",1),r("span",jF,b($.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",WF,b(O.value.peopleTerm?"":""),1)],2),O.value.peopleTerm?(p(),g("div",ZF,[r("p",KF," Choose what "+b(i().toLowerCase())+" are called in this "+b(B(o).area)+". This will be inherited by "+b(c())+" unless they override it. ",1),r("div",YF,[ye[31]||(ye[31]=r("label",null,"What are people called?",-1)),We(r("select",{"onUpdate:modelValue":ye[23]||(ye[23]=He=>$.value.peopleTerm=He),class:"form-input",onChange:z},[r("option",JF,"Use event default ("+b(e.eventPeopleTerm)+")",1),(p(!0),g(Se,null,je(B(ya).people,He=>(p(),g("option",{key:He,value:He},b(He),9,XF))),128))],544),[[no,$.value.peopleTerm]])])])):P("",!0)]),r("div",QF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.checkpointTerm}]),onClick:ye[24]||(ye[24]=He=>M("checkpointTerm"))},[ye[32]||(ye[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",e7,b(l(!1))+" terminology",1),r("span",t7,b($.value.checkpointTerm?B(Wh)($.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",n7,b(O.value.checkpointTerm?"":""),1)],2),O.value.checkpointTerm?(p(),g("div",o7,[r("p",s7," Choose what "+b(c())+" are called in this "+b(B(o).area)+". ",1),r("div",a7,[r("label",null,"What are "+b(c())+" called?",1),We(r("select",{"onUpdate:modelValue":ye[25]||(ye[25]=He=>$.value.checkpointTerm=He),class:"form-input",onChange:z},[r("option",i7,"Use event default ("+b(e.eventCheckpointTerm)+")",1),(p(!0),g(Se,null,je(B(ya).checkpoint,He=>(p(),g("option",{key:He,value:He},b(B(Wh)(He,i())),9,l7))),128))],544),[[no,$.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),f.value==="incidents"?(p(),g("div",r7,[r("div",c7,[(p(!0),g(Se,null,je(e.incidents,He=>(p(),Ge(kc,{key:He.incidentId,incident:He,onSelect:ye[26]||(ye[26]=ct=>ne.$emit("select-incident",ct))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},f7=Ke(h7,[["__scopeId","data-v-562b692e"]]),p7=["innerHTML"],v7={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const n=t,s=()=>{n("close")};return(o,i)=>(p(),Ge(Yt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:s},{actions:Ve(()=>[r("button",{onClick:s,class:"btn btn-primary"},b(e.okText),1)]),default:Ve(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,p7)]),_:1},8,["show","title"]))}},wc=Ke(v7,[["__scopeId","data-v-a6e7148c"]]),m7={class:"tab-content"},g7={class:"form-group"},y7={for:"text"},k7=["placeholder"],b7={key:0,class:"checkbox-label-inline create-separate-items"},w7={key:0,class:"form-group link-to-checkin"},_7={class:"checkbox-label-inline"},C7={class:"help-text"},L7={key:1,class:"form-group link-to-checkin-warning"},S7={class:"help-text warning"},I7={class:"tab-content"},x7={class:"custom-footer"},$7={class:"footer-left"},T7={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},nextDisplayOrder:{type:Number,default:0}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:n,termsSentence:s}=dt(),o=e,i=t,l=D(!1),c=D(""),d=D("details"),h=D({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1}),f=H(()=>!!o.checklistItem),m=H(()=>{const O=h.value.scopeConfigurations.filter(M=>M.scope&&(M.ids?.length>0||M.scope==="Everyone"||M.scope==="EveryoneAtCheckpoints"||M.scope==="SpecificPeople"));return O.length===0?!1:O.every(M=>M.scope==="EveryoneAtCheckpoints"||M.scope==="SpecificPeople")}),y=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=H(()=>y.findIndex(O=>O.value===d.value)),w=H(()=>k.value===y.length-1),x=H(()=>w.value?"":y[k.value+1]?.label||"");Ye(()=>o.show,O=>{O&&(d.value=o.initialTab,o.checklistItem?h.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?A(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?A(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?A(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1,linksToCheckIn:o.checklistItem.linksToCheckIn||!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.nextDisplayOrder,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1},i("update:isDirty",!1))});const A=O=>{if(!O)return null;const M=new Date(O),U=M.getTimezoneOffset();return new Date(M.getTime()-U*60*1e3).toISOString().slice(0,16)},E=O=>O?new Date(O).toISOString():null,_=()=>{i("update:isDirty",!0)},C=()=>{i("close")},S=()=>{w.value||(d.value=y[k.value+1].value)},$=O=>{c.value=O,l.value=!0},R=()=>{if(!h.value.text||!h.value.text.trim()){$(`Please enter ${n.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){$("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(U=>!(U.itemType!==null&&(!U.ids||U.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const M={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:E(h.value.visibleFrom),visibleUntil:E(h.value.visibleUntil),mustCompleteBy:E(h.value.mustCompleteBy),linksToCheckIn:h.value.linksToCheckIn};f.value||(M.createSeparateItems=h.value.createSeparateItems),i("save",M)},T=()=>{i("delete",o.checklistItem.itemId)};return(O,M)=>(p(),g(Se,null,[Pe(Yt,{show:e.show,title:f.value?`Edit ${B(n).checklist}`:`Create ${B(n).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":Ve(()=>[Pe(ul,{modelValue:d.value,"onUpdate:modelValue":M[0]||(M[0]=U=>d.value=U),tabs:y},null,8,["modelValue"])]),footer:Ve(()=>[r("div",x7,[r("div",$7,[f.value?(p(),g("button",{key:0,type:"button",onClick:T,class:"btn btn-danger"}," Delete ")):P("",!0),!f.value&&!w.value?(p(),g("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},b(x.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(R,["prevent"]),class:"checklist-form"},[We(r("div",m7,[r("div",g7,[r("label",y7,b(B(s).checklist)+" text: *",1),We(r("textarea",{id:"text","onUpdate:modelValue":M[1]||(M[1]=U=>h.value.text=U),onInput:_,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${B(n).checklists}, one per line...`:`Enter the ${B(n).checklist} text...`},null,40,k7),[[st,h.value.text]]),f.value?P("",!0):(p(),g("label",b7,[We(r("input",{type:"checkbox","onUpdate:modelValue":M[2]||(M[2]=U=>h.value.createSeparateItems=U),onChange:_},null,544),[[$s,h.value.createSeparateItems]]),M[6]||(M[6]=r("span",null,"Each line creates a new item",-1))]))]),m.value?(p(),g("div",w7,[r("label",_7,[We(r("input",{type:"checkbox","onUpdate:modelValue":M[3]||(M[3]=U=>h.value.linksToCheckIn=U),onChange:_},null,544),[[$s,h.value.linksToCheckIn]]),M[7]||(M[7]=r("span",null,"Link to check-in status",-1))]),r("p",C7," Completing this "+b(B(n).checklist)+" will check the "+b(B(n).person)+" in at the "+b(B(n).checkpoint)+". Checking in will complete this "+b(B(n).checklist)+". ",1)])):h.value.linksToCheckIn?(p(),g("div",L7,[r("p",S7,[M[8]||(M[8]=r("strong",null,"Note:",-1)),Je(' Link to check-in is currently enabled but the visibility settings are incompatible. Change visibility to "Everyone at specific '+b(B(n).checkpoints)+'" or "Specific '+b(B(n).people)+'" to use this feature. ',1)])])):P("",!0)],512),[[ns,d.value==="details"]]),We(r("div",I7,[Pe(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":M[4]||(M[4]=U=>h.value.scopeConfigurations=U),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:_},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:l.value,title:"Validation error",message:c.value,onClose:M[5]||(M[5]=U=>l.value=!1)},null,8,["show","message"])],64))}},M7=Ke(T7,[["__scopeId","data-v-6f300b9a"]]),A7={class:"tab-content"},E7={class:"form-group"},P7={class:"form-group"},D7={class:"form-row"},R7={class:"form-group"},O7={class:"checkbox-label-inline show-emergency-checkbox"},N7={class:"form-group"},B7={class:"form-row"},F7={class:"form-group"},U7={class:"form-group checkbox-group-inline"},z7={class:"checkbox-label-inline"},H7={class:"tab-content"},V7={class:"custom-footer"},G7={class:"footer-left"},q7={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D("details"),c=D({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=S=>S==="Urgent"||S==="Emergency",h=H(()=>!!n.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],m=H(()=>f.findIndex(S=>S.value===l.value)),y=H(()=>m.value===f.length-1),k=H(()=>y.value?"":f[m.value+1]?.label||"");Ye(()=>n.show,S=>{S&&(l.value=n.initialTab,n.note?c.value={title:n.note.title||"",content:n.note.content||"",scopeConfigurations:n.note.scopeConfigurations?JSON.parse(JSON.stringify(n.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:n.note.displayOrder||0,priority:n.note.priority||"Normal",category:n.note.category||"",isPinned:n.note.isPinned||!1,showInEmergencyInfo:n.note.showInEmergencyInfo??d(n.note.priority)}:c.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},s("update:isDirty",!1))}),Ye(()=>c.value.priority,(S,$)=>{!h.value&&S!==$&&(d(S)?c.value.showInEmergencyInfo=!0:d($)&&(c.value.showInEmergencyInfo=!1))});const w=()=>{s("update:isDirty",!0)},x=()=>{s("close")},A=()=>{y.value||(l.value=f[m.value+1].value)},E=S=>{i.value=S,o.value=!0},_=()=>{if(!c.value.title||!c.value.title.trim()){E("Please enter a note title");return}if(!c.value.scopeConfigurations||c.value.scopeConfigurations.length===0){E("Please select at least one visibility scope");return}if(!c.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){E("Please configure at least one scope with valid selections");return}const $={title:c.value.title.trim(),content:c.value.content||"",scopeConfigurations:c.value.scopeConfigurations,displayOrder:c.value.displayOrder||0,priority:c.value.priority||"Normal",category:c.value.category?.trim()||null,isPinned:c.value.isPinned||!1,showInEmergencyInfo:c.value.showInEmergencyInfo};s("save",$)},C=()=>{s("delete",n.note.noteId)};return(S,$)=>(p(),g(Se,null,[Pe(Yt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{"tab-header":Ve(()=>[Pe(ul,{modelValue:l.value,"onUpdate:modelValue":$[0]||($[0]=R=>l.value=R),tabs:f},null,8,["modelValue"])]),footer:Ve(()=>[r("div",V7,[r("div",G7,[h.value?(p(),g("button",{key:0,type:"button",onClick:C,class:"btn btn-danger"}," Delete ")):P("",!0),!h.value&&!y.value?(p(),g("button",{key:1,type:"button",onClick:A,class:"btn btn-secondary mobile-only"},b(k.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:_,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(_,["prevent"]),class:"note-form"},[We(r("div",A7,[r("div",E7,[$[10]||($[10]=r("label",{for:"title"},"Title: *",-1)),We(r("input",{id:"title","onUpdate:modelValue":$[1]||($[1]=R=>c.value.title=R),type:"text",onInput:w,required:"",placeholder:"Enter note title..."},null,544),[[st,c.value.title]])]),r("div",P7,[$[11]||($[11]=r("label",{for:"content"},"Content:",-1)),We(r("textarea",{id:"content","onUpdate:modelValue":$[2]||($[2]=R=>c.value.content=R),onInput:w,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,c.value.content]])]),r("div",D7,[r("div",R7,[$[14]||($[14]=r("label",{for:"priority"},"Priority:",-1)),We(r("select",{id:"priority","onUpdate:modelValue":$[3]||($[3]=R=>c.value.priority=R),onChange:w},[...$[12]||($[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[no,c.value.priority]]),r("label",O7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[4]||($[4]=R=>c.value.showInEmergencyInfo=R),onChange:w},null,544),[[$s,c.value.showInEmergencyInfo]]),$[13]||($[13]=r("span",null,"Show in emergency info",-1))])]),r("div",N7,[$[15]||($[15]=r("label",{for:"category"},"Category:",-1)),We(r("input",{id:"category","onUpdate:modelValue":$[5]||($[5]=R=>c.value.category=R),type:"text",onInput:w,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,c.value.category]])])]),r("div",B7,[r("div",F7,[$[16]||($[16]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":$[6]||($[6]=R=>c.value.displayOrder=R),type:"number",onInput:w,min:"0"},null,544),[[st,c.value.displayOrder,void 0,{number:!0}]]),$[17]||($[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",U7,[r("label",z7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[7]||($[7]=R=>c.value.isPinned=R),onChange:w},null,544),[[$s,c.value.isPinned]]),$[18]||($[18]=r("span",null,"Pin to top",-1))]),$[19]||($[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ns,l.value==="details"]]),We(r("div",H7,[Pe(id,{modelValue:c.value.scopeConfigurations,"onUpdate:modelValue":$[8]||($[8]=R=>c.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:w},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:o.value,title:"Validation error",message:i.value,onClose:$[9]||($[9]=R=>o.value=!1)},null,8,["show","message"])],64))}},j7=Ke(q7,[["__scopeId","data-v-e8488047"]]),W7={class:"incident-detail-header"},Z7={class:"header-title-row"},K7={class:"modal-title"},Y7={class:"header-badges"},J7=["disabled"],X7={key:0,class:"status-dropdown-menu"},Q7=["onClick","disabled"],eU={key:0,class:"incident-detail-content"},tU={class:"accordion-section"},nU={class:"accordion-arrow"},oU={key:0,class:"accordion-content"},sU={class:"description-text"},aU={class:"accordion-section"},iU={class:"accordion-arrow"},lU={key:0,class:"accordion-content"},rU={class:"info-grid"},cU={class:"info-item"},uU={class:"info-value"},dU={class:"info-item"},hU={class:"info-value"},fU={key:0,class:"info-item"},pU={class:"info-label"},vU={class:"info-value"},mU={key:1,class:"info-item"},gU={class:"info-label"},yU={class:"info-value"},kU={key:2,class:"info-item"},bU={class:"info-value"},wU={key:0,class:"incident-map-container"},_U={class:"accordion-section"},CU={class:"accordion-preview"},LU={class:"accordion-arrow"},SU={key:0,class:"accordion-content"},IU={class:"reporter-info"},xU={class:"reporter-name"},$U={key:0,class:"accordion-section"},TU={class:"accordion-title"},MU={class:"accordion-preview"},AU={class:"accordion-arrow"},EU={key:0,class:"accordion-content"},PU={class:"marshals-list"},DU={class:"marshal-name"},RU={key:0,class:"checkin-badge success"},OU={key:1,class:"checkin-badge not-checked-in"},NU={class:"accordion-section"},BU={key:0,class:"accordion-preview"},FU={class:"accordion-arrow"},UU={key:0,class:"accordion-content"},zU={key:0,class:"notes-timeline"},HU={class:"note-header"},VU={class:"note-author"},GU={class:"note-time"},qU={key:0,class:"note-status-change"},jU={key:1,class:"note-text"},WU={key:1,class:"no-notes"},ZU={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:n,termsSentence:s}=dt(),o=e,i=t,l=D(!1),c=D(!1),d=D(null),h=D({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ye(()=>o.show,U=>{U&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},c.value=!1)});const f=U=>{d.value&&!d.value.contains(U.target)&&(c.value=!1)};Ye(c,U=>{U?document.addEventListener("click",f):document.removeEventListener("click",f)});const m=()=>{c.value=!c.value},y=U=>{o.incident?.status!==U&&(c.value=!1,M(U))},k=U=>{const F=h.value[U];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),F||(h.value[U]=!0)},w=H(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),x=H(()=>w.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),A=H(()=>w.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),E=H(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const U=o.incident.description||"";return U.length<=50?U:U.substring(0,47)+"..."}),_=H(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((F,j)=>(F.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),C=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],S=U=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[U]||U,$=U=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[U]||U,R=U=>{if(!U)return"";let F=U.name||"";if(U.description){const j=U.description,Z=40,Q=j.length>Z?j.substring(0,Z-3)+"...":j;F+=` - ${Q}`}return F},T=U=>U?new Date(U).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",O=U=>{if(!U)return"";const F=new Date(U),Z=new Date-F,Q=Math.floor(Z/6e4),re=Math.floor(Z/36e5),K=Math.floor(Z/864e5);return Q<1?"just now":Q<60?`${Q}m ago`:re<24?`${re}h ago`:K<7?`${K}d ago`:F.toLocaleDateString()},M=async U=>{if(o.incident?.status!==U){l.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:U})}finally{l.value=!1}}};return(U,F)=>(p(),Ge(Yt,{show:e.show,title:E.value,size:"large",onClose:F[7]||(F[7]=j=>U.$emit("close"))},{header:Ve(()=>[r("div",W7,[r("div",Z7,[r("span",{class:le(["severity-indicator",e.incident?.severity])},null,2),r("h2",K7,b(E.value),1)]),r("div",Y7,[r("span",{class:le(["severity-badge",e.incident?.severity])},b(S(e.incident?.severity)),3),e.canManage?(p(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:le(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:m,disabled:l.value},[Je(b($(e.incident?.status))+" ",1),F[8]||(F[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,J7),c.value?(p(),g("div",X7,[(p(),g(Se,null,je(C,j=>r("button",{key:j.value,type:"button",class:le(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Z=>y(j.value),disabled:e.incident?.status===j.value},[r("span",{class:le(["status-dot",j.value])},null,2),Je(" "+b(j.label),1)],10,Q7)),64))])):P("",!0)],512)):(p(),g("span",{key:1,class:le(["status-badge",e.incident?.status])},b($(e.incident?.status)),3))])])]),footer:Ve(()=>[r("button",{class:"btn btn-secondary",onClick:F[6]||(F[6]=j=>U.$emit("close"))},"Close")]),default:Ve(()=>[e.incident?(p(),g("div",eU,[r("div",tU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.description}]),onClick:F[0]||(F[0]=j=>k("description"))},[F[9]||(F[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",nU,b(h.value.description?"":""),1)],2),h.value.description?(p(),g("div",oU,[r("p",sU,b(e.incident.description),1)])):P("",!0)]),r("div",aU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.timeLocation}]),onClick:F[1]||(F[1]=j=>k("timeLocation"))},[F[10]||(F[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",iU,b(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(p(),g("div",lU,[r("div",rU,[r("div",cU,[F[11]||(F[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",uU,b(T(e.incident.incidentTime)),1)]),r("div",dU,[F[12]||(F[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",hU,b(T(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(p(),g("div",fU,[r("span",pU,b(B(s).checkpoint),1),r("span",vU,b(R(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(p(),g("div",mU,[r("span",gU,b(B(s).area),1),r("span",yU,b(e.incident.area.areaName),1)])):P("",!0),w.value?(p(),g("div",kU,[F[13]||(F[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",bU,b(e.incident.latitude.toFixed(6))+", "+b(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),w.value?(p(),g("div",wU,[Pe(al,{locations:e.checkpoints,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:x.value,zoom:15,"user-location":A.value,height:"200px"},null,8,["locations","route","route-color","route-style","route-weight","center","user-location"])])):P("",!0)])):P("",!0)]),r("div",_U,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.reporter}]),onClick:F[2]||(F[2]=j=>k("reporter"))},[F[14]||(F[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",CU,b(e.incident.reportedBy?.name||"Unknown"),1),r("span",LU,b(h.value.reporter?"":""),1)],2),h.value.reporter?(p(),g("div",SU,[r("div",IU,[r("span",xU,b(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),_.value.length?(p(),g("div",$U,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.marshals}]),onClick:F[3]||(F[3]=j=>k("marshals"))},[r("span",TU,b(B(n).peoplePlural)+" at "+b(B(n).checkpoint.toLowerCase()),1),r("span",MU,b(_.value.length),1),r("span",AU,b(h.value.marshals?"":""),1)],2),h.value.marshals?(p(),g("div",EU,[r("div",PU,[(p(!0),g(Se,null,je(_.value,j=>(p(),g("div",{key:j.marshalId,class:le(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",DU,b(j.name),1),j.wasCheckedIn?(p(),g("span",RU," Checked in "+b(O(j.checkInTime)),1)):(p(),g("span",OU," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),r("div",NU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.notes}]),onClick:F[4]||(F[4]=j=>k("notes"))},[F[15]||(F[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(p(),g("span",BU,b(e.incident.updates.length),1)):P("",!0),r("span",FU,b(h.value.notes?"":""),1)],2),h.value.notes?(p(),g("div",UU,[e.incident.updates?.length?(p(),g("div",zU,[(p(!0),g(Se,null,je(e.incident.updates,(j,Z)=>(p(),g("div",{key:Z,class:"note-item"},[r("div",HU,[r("span",VU,b(j.authorName||"System"),1),r("span",GU,b(O(j.timestamp)),1)]),j.statusChange?(p(),g("div",qU,[F[16]||(F[16]=Je(" Status changed to ",-1)),r("span",{class:le(["status-badge",j.statusChange])},b($(j.statusChange)),3)])):j.note?(p(),g("p",jU,b(j.note),1)):P("",!0)]))),128))])):(p(),g("div",WU," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:F[5]||(F[5]=j=>U.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},I1=Ke(ZU,[["__scopeId","data-v-cc8f343d"]]),KU={class:"form-group"},YU={class:"form-group"},JU={class:"form-row"},XU={class:"form-group form-group-half"},QU=["value"],ez={class:"form-group form-group-half"},tz={key:0,class:"form-group"},nz={for:"checkpoint",class:"form-label"},oz=["value"],sz={key:1,class:"form-group"},az={class:"form-label"},iz={class:"checkpoint-toggle"},lz={class:"checkbox-label"},rz={class:"checkpoint-name"},cz={key:0,class:"checkpoint-description"},uz={class:"form-group"},dz={class:"location-options"},hz={class:"location-buttons"},fz={key:0,class:"location-status"},pz={key:0,class:"location-getting"},vz={key:1,class:"location-display"},mz={key:0,class:"location-accuracy"},gz={key:2,class:"location-error"},yz={key:1,class:"map-picker-container"},kz={key:0,class:"map-picker-hint"},bz={key:2,class:"location-display"},wz={key:2,class:"error-message"},_z={class:"modal-actions"},Cz=["disabled"],Lz={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:n}=dt(),s=e,o=t,i=D({title:"",description:"",severity:"medium",incidentTime:""}),l=D(""),c=D(!0),d=D("none"),h=D(!1),f=D(null),m=D(null),y=D(null),k=D(!1),w=D(!1),x=D(null),A=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],E=()=>{const j=new Date,Z=j.getFullYear(),Q=String(j.getMonth()+1).padStart(2,"0"),re=String(j.getDate()).padStart(2,"0"),K=String(j.getHours()).padStart(2,"0"),ae=String(j.getMinutes()).padStart(2,"0");return`${Z}-${Q}-${re}T${K}:${ae}`},_=j=>j?new Date(j).toISOString():null,C=H(()=>s.checkpoints||[]),S=H(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=C.value.find(Z=>Z.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.initialLocation?.latitude!=null)return{lat:s.initialLocation.latitude,lng:s.initialLocation.longitude};if(s.checkpoint?.latitude!=null)return{lat:s.checkpoint.latitude,lng:s.checkpoint.longitude};if(C.value.length>0){const j=C.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.route?.length>0){const j=s.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),$=H(()=>i.value.description.trim()!==""),R=H(()=>i.value.description.trim()!=="");Ye(()=>s.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:E()},l.value="",c.value=!0,w.value=!1,x.value=null,y.value=null,f.value=null,m.value=null,s.initialLocation&&s.initialLocation.latitude!=null?(f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},m.value=s.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),s.checkpoint&&(l.value=s.checkpoint.locationId||s.checkpoint.id||""))});const T=j=>{y.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,m.value=null):j==="gps"?(d.value="gps",h.value=!1,M()):(d.value="none",h.value=!1,f.value=null,m.value=null)},O=j=>{f.value={latitude:j.lat,longitude:j.lng},m.value=null,h.value=!1},M=()=>{if(s.initialLocation&&s.initialLocation.latitude!=null){f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},m.value=s.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},m.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},U=async()=>{if(!(!R.value||w.value)){w.value=!0,x.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let Z=null,Q=!1;C.value.length>0?l.value?Z=l.value:Q=!0:s.checkpoint&&(c.value?Z=s.checkpoint.locationId||s.checkpoint.id||null:Q=!0);const re={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:_(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:Z,skipCheckpointAutoAssign:Q};o("submit",re)}catch(j){x.value=j.message||"Failed to report incident. Please try again.",w.value=!1}}},F=()=>{o("close")};return(j,Z)=>(p(),Ge(Yt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":$.value,onClose:F},{footer:Ve(()=>[r("div",_z,[r("button",{type:"button",class:"btn btn-secondary",onClick:F}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:U,disabled:!R.value||w.value},b(w.value?"Reporting...":"Report Incident"),9,Cz)])]),default:Ve(()=>[r("form",{onSubmit:rt(U,["prevent"]),class:"incident-form"},[r("div",KU,[Z[10]||(Z[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),We(r("input",{id:"title","onUpdate:modelValue":Z[0]||(Z[0]=Q=>i.value.title=Q),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),r("div",YU,[Z[11]||(Z[11]=r("label",{for:"description",class:"form-label"},[Je("Description "),r("span",{class:"required"},"*")],-1)),We(r("textarea",{id:"description","onUpdate:modelValue":Z[1]||(Z[1]=Q=>i.value.description=Q),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),r("div",JU,[r("div",XU,[Z[12]||(Z[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),We(r("select",{id:"severity","onUpdate:modelValue":Z[2]||(Z[2]=Q=>i.value.severity=Q),class:"form-input form-select"},[(p(),g(Se,null,je(A,Q=>r("option",{key:Q.value,value:Q.value},b(Q.label),9,QU)),64))],512),[[no,i.value.severity]])]),r("div",ez,[Z[13]||(Z[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),We(r("input",{id:"incidentTime","onUpdate:modelValue":Z[3]||(Z[3]=Q=>i.value.incidentTime=Q),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),C.value.length>0?(p(),g("div",tz,[r("label",nz,b(B(n).checkpoint),1),We(r("select",{id:"checkpoint","onUpdate:modelValue":Z[4]||(Z[4]=Q=>l.value=Q),class:"form-input form-select"},[Z[14]||(Z[14]=r("option",{value:""},"-- None / Unknown --",-1)),(p(!0),g(Se,null,je(C.value,Q=>(p(),g("option",{key:Q.id,value:Q.id},b(Q.name)+b(Q.description?` - ${Q.description}`:""),9,oz))),128))],512),[[no,l.value]])])):e.checkpoint?(p(),g("div",sz,[r("label",az,b(B(n).checkpoint),1),r("div",iz,[r("label",lz,[We(r("input",{type:"checkbox","onUpdate:modelValue":Z[5]||(Z[5]=Q=>c.value=Q)},null,512),[[$s,c.value]]),r("span",rz,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",cz," - "+b(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),r("div",uz,[Z[15]||(Z[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",dz,[r("div",hz,[r("button",{type:"button",class:le(["location-btn",{active:d.value==="gps"}]),onClick:Z[6]||(Z[6]=Q=>T("gps"))}," GPS ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="map"}]),onClick:Z[7]||(Z[7]=Q=>T("map"))}," Pick on map ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="none"}]),onClick:Z[8]||(Z[8]=Q=>T("none"))}," None ",2)]),d.value==="gps"?(p(),g("div",fz,[k.value?(p(),g("div",pz," Getting location... ")):f.value&&f.value.latitude!=null?(p(),g("div",vz,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),m.value?(p(),g("span",mz,"("+b(Math.round(m.value))+"m)",1)):P("",!0)])):y.value?(p(),g("div",gz,b(y.value),1)):P("",!0)])):P("",!0),d.value==="map"?(p(),g("div",yz,[h.value?(p(),g("div",kz,"Tap to select location")):P("",!0),h.value?(p(),Ge(al,{key:1,locations:C.value,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:S.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:O},null,8,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id"])):P("",!0),f.value&&f.value.latitude!=null?(p(),g("div",bz,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),h.value?P("",!0):(p(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:Z[9]||(Z[9]=Q=>h.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),x.value?(p(),g("div",wz,b(x.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},x1=Ke(Lz,[["__scopeId","data-v-8a211d20"]]),Sz={class:"tab-content"},Iz={key:0,class:"form-group"},xz={for:"marshalId"},$z=["value"],Tz={class:"help-text"},Mz={key:1,class:"form-group"},Az={class:"linked-marshal-info"},Ez={class:"linked-marshal-name"},Pz={class:"linked-marshal-hint"},Dz={key:2,class:"form-group"},Rz={class:"form-group"},Oz={key:0,class:"selected-roles"},Nz=["onClick"],Bz={class:"role-input-group"},Fz=["value"],Uz={class:"checkbox-label-inline show-emergency-checkbox"},zz={class:"form-row"},Hz={class:"form-group"},Vz={class:"form-group"},Gz={class:"form-group"},qz={class:"form-row"},jz={class:"form-group"},Wz={class:"form-group checkbox-group-inline"},Zz={class:"checkbox-label-inline"},Kz={class:"tab-content"},Yz={class:"custom-footer"},Jz={class:"footer-left"},Xz=["disabled"],Qz={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D("details"),d=D(""),h=D({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=H(()=>[...s.roleDefinitions].sort((Q,re)=>Q.isBuiltIn!==re.isBuiltIn?Q.isBuiltIn?-1:1:Q.displayOrder!==re.displayOrder?(Q.displayOrder||0)-(re.displayOrder||0):(Q.name||"").localeCompare(re.name||"",void 0,{numeric:!0,sensitivity:"base"}))),m=H(()=>{const Q=h.value.roles||[];return f.value.filter(re=>!Q.includes(re.roleId))}),y=Q=>s.roleDefinitions.find(K=>K.roleId===Q)?.name||Q,k=Q=>s.roleDefinitions.find(K=>K.roleId===Q)?.name==="EmergencyContact",w=()=>{d.value&&!h.value.roles.includes(d.value)&&(h.value.roles.push(d.value),k(d.value)&&(h.value.showInEmergencyInfo=!0),T()),d.value=""},x=Q=>{const re=h.value.roles.indexOf(Q);re>-1&&(h.value.roles.splice(re,1),k(Q)&&!h.value.roles.some(K=>k(K))&&(h.value.showInEmergencyInfo=!1),T())},A=H(()=>!!s.contact),E=H(()=>s.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),_=H(()=>!!h.value.marshalId),C=H(()=>!A.value&&!!s.prefilledMarshalId),S=H(()=>A.value&&!!s.contact?.marshalId),$=H(()=>s.contact?.marshalId?s.marshals.find(re=>re.id===s.contact.marshalId)?.name||"Unknown":""),R=H(()=>[...s.marshals].sort((Q,re)=>Qo(Q.name,re.name)));Ye(()=>s.show,Q=>{if(Q){if(c.value=s.initialTab,d.value="",s.contact){let re=[];s.contact.roles&&Array.isArray(s.contact.roles)&&(re=[...s.contact.roles]),h.value={roles:re,name:s.contact.name||"",phone:s.contact.phone||"",email:s.contact.email||"",notes:s.contact.notes||"",marshalId:s.contact.marshalId||null,showInEmergencyInfo:s.contact.showInEmergencyInfo??re.some(K=>k(K)),displayOrder:s.contact.displayOrder||0,isPinned:s.contact.isPinned||!1,scopeConfigurations:s.contact.scopeConfigurations?JSON.parse(JSON.stringify(s.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{let re;s.createFromAreaContext?re=[]:s.preselectedArea?re=[{scope:"EveryoneInAreas",itemType:"Area",ids:[s.preselectedArea.id]}]:re=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let K={name:s.prefilledName||"",phone:"",email:"",roles:[]};if(s.prefilledMarshalId){const ae=s.marshals.find(q=>q.id===s.prefilledMarshalId);ae&&(K={name:ae.name||"",phone:ae.phoneNumber||"",email:ae.email||"",roles:ae.roles||[]})}h.value={roles:[...K.roles],name:K.name,phone:K.phone,email:K.email,notes:"",marshalId:s.prefilledMarshalId||null,showInEmergencyInfo:K.roles.some(ae=>k(ae)),displayOrder:0,isPinned:!1,scopeConfigurations:re}}o("update:isDirty",!1)}});const T=()=>{o("update:isDirty",!0)},O=()=>{if(h.value.marshalId){const Q=s.marshals.find(re=>re.id===h.value.marshalId);Q&&(h.value.name=Q.name,!h.value.phone&&Q.phoneNumber&&(h.value.phone=Q.phoneNumber),!h.value.email&&Q.email&&(h.value.email=Q.email),h.value.roles=Q.roles?[...Q.roles]:[],h.value.showInEmergencyInfo=h.value.roles.some(re=>k(re)))}else h.value.name="";T()},M=()=>{o("close")},U=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}c.value="visibility"},F=Q=>{l.value=Q,i.value=!0},j=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}if(!s.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){F("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(K=>!(K.itemType!==null&&(!K.ids||K.ids.length===0)))){F("Please configure at least one scope with valid selections");return}}const Q={roles:h.value.roles,name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};o("save",Q)},Z=()=>{o("delete",s.contact.contactId)};return(Q,re)=>(p(),g(Se,null,[Pe(Yt,{show:e.show,title:A.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:M},{"tab-header":Ve(()=>[Pe(ul,{modelValue:c.value,"onUpdate:modelValue":re[0]||(re[0]=K=>c.value=K),tabs:E.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",Yz,[r("div",Jz,[A.value?(p(),g("button",{key:0,type:"button",onClick:Z,class:"btn btn-danger"}," Delete ")):P("",!0),!A.value&&c.value==="details"?(p(),g("button",{key:1,type:"button",onClick:U,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),r("button",{type:"button",onClick:j,class:"btn btn-success",disabled:A.value&&!e.isDirty}," Save ",8,Xz)])]),default:Ve(()=>[r("form",{onSubmit:rt(j,["prevent"]),class:"contact-form"},[We(r("div",Sz,[!C.value&&!S.value?(p(),g("div",Iz,[r("label",xz,"Link to "+b(B(n).person.toLowerCase())+":",1),We(r("select",{id:"marshalId","onUpdate:modelValue":re[1]||(re[1]=K=>h.value.marshalId=K),onChange:O},[re[12]||(re[12]=r("option",{value:null},"-- Not linked --",-1)),(p(!0),g(Se,null,je(R.value,K=>(p(),g("option",{key:K.id,value:K.id},b(K.name),9,$z))),128))],544),[[no,h.value.marshalId]]),r("span",Tz,"Optionally link to an existing "+b(B(n).person.toLowerCase())+" in the system",1)])):P("",!0),S.value?(p(),g("div",Mz,[r("label",null,"Linked "+b(B(n).person.toLowerCase())+":",1),r("div",Az,[r("span",Ez,b($.value),1),r("span",Pz,"Contact details are synced with this "+b(B(n).person.toLowerCase()),1)])])):P("",!0),_.value?P("",!0):(p(),g("div",Dz,[re[13]||(re[13]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":re[2]||(re[2]=K=>h.value.name=K),type:"text",onInput:T,placeholder:"Contact name..."},null,544),[[st,h.value.name]])])),r("div",Rz,[re[16]||(re[16]=r("label",null,"Roles: *",-1)),h.value.roles.length>0?(p(),g("div",Oz,[(p(!0),g(Se,null,je(h.value.roles,K=>(p(),g("span",{key:K,class:"role-pill"},[Je(b(y(K))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:ae=>x(K),title:"Remove role"},"",8,Nz)]))),128))])):P("",!0),r("div",Bz,[We(r("select",{id:"role","onUpdate:modelValue":re[3]||(re[3]=K=>d.value=K),onChange:w},[re[14]||(re[14]=r("option",{value:"",disabled:""},"Add a role...",-1)),(p(!0),g(Se,null,je(m.value,K=>(p(),g("option",{key:K.roleId,value:K.roleId},b(K.name),9,Fz))),128))],544),[[no,d.value]])]),r("label",Uz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[4]||(re[4]=K=>h.value.showInEmergencyInfo=K),onChange:T},null,544),[[$s,h.value.showInEmergencyInfo]]),re[15]||(re[15]=r("span",null,"Show in emergency info",-1))])]),r("div",zz,[r("div",Hz,[re[17]||(re[17]=r("label",{for:"phone"},"Phone:",-1)),We(r("input",{id:"phone","onUpdate:modelValue":re[5]||(re[5]=K=>h.value.phone=K),type:"tel",onInput:T,placeholder:"Phone number..."},null,544),[[st,h.value.phone]])]),r("div",Vz,[re[18]||(re[18]=r("label",{for:"email"},"Email:",-1)),We(r("input",{id:"email","onUpdate:modelValue":re[6]||(re[6]=K=>h.value.email=K),type:"email",onInput:T,placeholder:"Email address..."},null,544),[[st,h.value.email]])])]),r("div",Gz,[re[19]||(re[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":re[7]||(re[7]=K=>h.value.notes=K),onInput:T,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,h.value.notes]])]),r("div",qz,[r("div",jz,[re[20]||(re[20]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":re[8]||(re[8]=K=>h.value.displayOrder=K),type:"number",onInput:T,min:"0"},null,544),[[st,h.value.displayOrder,void 0,{number:!0}]]),re[21]||(re[21]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",Wz,[r("label",Zz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[9]||(re[9]=K=>h.value.isPinned=K),onChange:T},null,544),[[$s,h.value.isPinned]]),re[22]||(re[22]=r("span",null,"Pin to top",-1))]),re[23]||(re[23]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[ns,c.value==="details"]]),We(r("div",Kz,[Pe(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":re[10]||(re[10]=K=>h.value.scopeConfigurations=K),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":A.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:T},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:i.value,title:"Validation error",message:l.value,onClose:re[11]||(re[11]=K=>i.value=!1)},null,8,["show","message"])],64))}},eH=Ke(Qz,[["__scopeId","data-v-300a990f"]]),tH={class:"tab-content"},nH={class:"form-group"},oH={class:"form-group"},sH={class:"form-group checkbox-group"},aH={class:"checkbox-label"},iH={class:"checkbox-text"},lH={class:"help-text"},rH={class:"tab-content"},cH={key:0,class:"loading-state"},uH={key:1,class:"empty-state"},dH={key:2,class:"people-list"},hH={class:"search-row"},fH={class:"people-items"},pH=["checked","onChange"],vH={class:"person-name"},mH={class:"person-type-badge marshal"},gH={key:0,class:"empty-search"},yH={class:"custom-footer"},kH={class:"footer-left"},bH={__name:"EditRoleDefinitionModal",props:{show:{type:Boolean,default:!1},role:{type:Object,default:null},initialTab:{type:String,default:"details"},people:{type:Array,default:()=>[]},loadingPeople:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty","load-people"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D(new Map),h=D([]),f=D({marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set}),m=[{value:"details",label:"Details"},{value:"assignments",label:"Assignments"}],y=D(s.initialTab),k=D({name:"",notes:"",canManageAreaCheckpoints:!1}),w=H(()=>!!s.role?.roleId);Ye(()=>[s.show,s.role],([M,U])=>{M&&(y.value=s.initialTab,c.value="",d.value=new Map,h.value=[],f.value={marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set},U?k.value={name:U.name||"",notes:U.notes||"",canManageAreaCheckpoints:U.canManageAreaCheckpoints||!1}:k.value={name:"",notes:"",canManageAreaCheckpoints:!1},o("update:isDirty",!1))},{immediate:!0}),Ye(y,M=>{M==="assignments"&&w.value&&s.people.length===0&&o("load-people",s.role.roleId)}),Ye(()=>s.people,M=>{if(M.length>0&&(h.value=M.map(U=>({...U})),d.value.size===0)){const U=new Map;for(const F of M)U.set(F.id,F.hasRole);d.value=U}},{immediate:!0});const x=()=>{o("update:isDirty",!0)},A=M=>M==="Linked"?"Linked":M==="Marshal"?n.value.person:M==="Contact"?"Contact":M,E=H(()=>{let M=[...h.value];if(c.value.trim()){const U=c.value.toLowerCase();M=M.filter(F=>F.name.toLowerCase().includes(U))}return M.sort((U,F)=>{const j=d.value.get(U.id)??!1,Z=d.value.get(F.id)??!1;return j!==Z?j?-1:1:U.name.localeCompare(F.name,void 0,{sensitivity:"base"})})}),_=H(()=>h.value.length>0&&h.value.every(M=>M.hasRole));H(()=>f.value.marshalIdsToAdd.size>0||f.value.marshalIdsToRemove.size>0||f.value.contactIdsToAdd.size>0||f.value.contactIdsToRemove.size>0);const C=()=>{const M=!_.value;for(const U of h.value)U.hasRole!==M&&S(U,M)},S=(M,U)=>{const F=h.value.find(j=>j.id===M.id);F&&(F.hasRole=U),M.personType==="Marshal"||M.personType==="Linked"?U?f.value.marshalIdsToRemove.has(M.marshalId)?f.value.marshalIdsToRemove.delete(M.marshalId):f.value.marshalIdsToAdd.add(M.marshalId):f.value.marshalIdsToAdd.has(M.marshalId)?f.value.marshalIdsToAdd.delete(M.marshalId):f.value.marshalIdsToRemove.add(M.marshalId):M.personType==="Contact"&&(U?f.value.contactIdsToRemove.has(M.contactId)?f.value.contactIdsToRemove.delete(M.contactId):f.value.contactIdsToAdd.add(M.contactId):f.value.contactIdsToAdd.has(M.contactId)?f.value.contactIdsToAdd.delete(M.contactId):f.value.contactIdsToRemove.add(M.contactId)),o("update:isDirty",!0)},$=M=>{S(M,!M.hasRole)},R=()=>{if(!k.value.name.trim()){l.value="Role name is required.",i.value=!0;return}o("save",{name:k.value.name.trim(),notes:k.value.notes.trim(),canManageAreaCheckpoints:k.value.canManageAreaCheckpoints,assignmentChanges:{marshalIdsToAdd:Array.from(f.value.marshalIdsToAdd),marshalIdsToRemove:Array.from(f.value.marshalIdsToRemove),contactIdsToAdd:Array.from(f.value.contactIdsToAdd),contactIdsToRemove:Array.from(f.value.contactIdsToRemove)}})},T=()=>{o("delete",s.role.roleId)},O=()=>{o("close")};return(M,U)=>(p(),g(Se,null,[Pe(Yt,{show:e.show,title:w.value?"Edit role":"Create role",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:O},{"tab-header":Ve(()=>[Pe(ul,{modelValue:y.value,"onUpdate:modelValue":U[0]||(U[0]=F=>y.value=F),tabs:m},null,8,["modelValue"])]),footer:Ve(()=>[r("div",yH,[r("div",kH,[w.value?(p(),g("button",{key:0,type:"button",onClick:T,class:"btn btn-danger",title:"Delete this role"}," Delete ")):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(R,["prevent"]),class:"role-form"},[We(r("div",tH,[r("div",nH,[U[6]||(U[6]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":U[1]||(U[1]=F=>k.value.name=F),type:"text",onInput:x,required:"",placeholder:"Enter role name..."},null,544),[[st,k.value.name]])]),r("div",oH,[U[7]||(U[7]=r("label",{for:"notes"},"Notes:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":U[2]||(U[2]=F=>k.value.notes=F),onInput:x,rows:"6",placeholder:"Enter role description or notes..."},null,544),[[st,k.value.notes]]),U[8]||(U[8]=r("span",{class:"help-text"},"Describe what this role is responsible for",-1))]),r("div",sH,[r("label",aH,[We(r("input",{type:"checkbox","onUpdate:modelValue":U[3]||(U[3]=F=>k.value.canManageAreaCheckpoints=F),onChange:x},null,544),[[$s,k.value.canManageAreaCheckpoints]]),r("span",iH,"Is "+b(B(n).area.toLowerCase())+" lead",1)]),r("span",lH,"When enabled, "+b(B(n).people.toLowerCase())+" with this role can view all other "+b(B(n).checkpoints.toLowerCase())+" and "+b(B(n).people.toLowerCase())+" in their "+b(B(n).area.toLowerCase())+".",1)])],512),[[ns,y.value==="details"]]),We(r("div",rH,[U[11]||(U[11]=r("div",{class:"assignments-header"},[r("h4",null,"Who has this role?"),r("p",{class:"help-text"},"Select the people who should have this role assigned.")],-1)),e.loadingPeople?(p(),g("div",cH," Loading people... ")):e.people.length===0?(p(),g("div",uH,[...U[9]||(U[9]=[r("p",null,"No marshals or contacts to assign.",-1)])])):(p(),g("div",dH,[r("div",hH,[We(r("input",{"onUpdate:modelValue":U[4]||(U[4]=F=>c.value=F),type:"text",class:"search-input",placeholder:"Search by name..."},null,512),[[st,c.value]]),r("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C},b(_.value?"Deselect all":"Select all"),1)]),r("div",fH,[(p(!0),g(Se,null,je(E.value,F=>(p(),g("label",{key:F.id,class:le(["person-item",{checked:F.hasRole}])},[r("input",{type:"checkbox",checked:F.hasRole,onChange:j=>$(F)},null,40,pH),r("span",vH,b(F.name),1),F.personType==="Linked"?(p(),g(Se,{key:0},[r("span",mH,b(B(n).person),1),U[10]||(U[10]=r("span",{class:"person-type-badge contact"},"Contact",-1))],64)):(p(),g("span",{key:1,class:le(["person-type-badge",F.personType.toLowerCase()])},b(A(F.personType)),3))],2))),128))]),E.value.length===0?(p(),g("div",gH," No people match your search. ")):P("",!0)]))],512),[[ns,y.value==="assignments"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:i.value,title:"Validation error",message:l.value,onClose:U[5]||(U[5]=F=>i.value=!1)},null,8,["show","message"])],64))}},wH=Ke(bH,[["__scopeId","data-v-4a0e6d84"]]),_H={key:0,class:"fullscreen-map-overlay"},CH={class:"fullscreen-map-header"},LH={class:"context-info"},SH={key:0},IH={class:"action-buttons"},xH=["disabled"],$H={class:"fullscreen-map-container"},TH={key:0,class:"drawing-controls"},MH={class:"point-count"},AH={class:"undo-redo-buttons"},EH=["disabled"],PH=["disabled"],DH=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(0),l=D(!1),c=D(!1),d=()=>{s("done")},h=()=>{s("cancel")},f=x=>{i.value=x?.length||0,m(),s("polygon-drawing",x)},m=()=>{o.value&&(l.value=o.value.canUndo(),c.value=o.value.canRedo())},y=()=>{o.value&&(o.value.undoPolygonPoint(),m())},k=()=>{o.value&&(o.value.redoPolygonPoint(),m())};Ye(()=>n.show,x=>{x||(i.value=0,l.value=!1,c.value=!1)});const w=x=>{x.key==="Escape"&&n.show&&h(),n.show&&n.drawingMode&&((x.ctrlKey||x.metaKey)&&x.key==="z"&&!x.shiftKey?(x.preventDefault(),y()):(x.ctrlKey||x.metaKey)&&(x.key==="y"||x.key==="z"&&x.shiftKey)&&(x.preventDefault(),k()))};return cn(()=>{document.addEventListener("keydown",w)}),In(()=>{document.removeEventListener("keydown",w)}),(x,A)=>(p(),Ge(ec,{to:"body"},[e.show?(p(),g("div",_H,[r("div",CH,[r("div",LH,[r("h3",null,b(e.contextTitle),1),e.contextDescription?(p(),g("p",SH,b(e.contextDescription),1)):P("",!0)]),r("div",IH,[e.mode==="view"?(p(),g("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(p(),g(Se,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,xH)],64))])]),r("div",$H,[Pe(Jh,Vg({ref_key:"mapViewRef",ref:o,"drawing-mode":e.drawingMode},x.$attrs,{onMapClick:A[0]||(A[0]=E=>x.$emit("map-click",E)),onPolygonComplete:A[1]||(A[1]=E=>x.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:A[2]||(A[2]=E=>x.$emit("location-click",E)),onAreaClick:A[3]||(A[3]=E=>x.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(p(),g("div",TH,[r("div",MH,b(i.value)+" point"+b(i.value!==1?"s":""),1),r("div",AH,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,EH),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!c.value,title:"Redo point"}," Redo  ",8,PH)])])):P("",!0)])])):P("",!0)]))}}),RH=Ke(DH,[["__scopeId","data-v-9ce62b55"]]),OH={class:"form-group"},NH={class:"form-group"},BH={class:"form-group"},FH={key:0,class:"form-error"},UH={class:"form-row"},zH={class:"form-group",style:{flex:"1"}},HH={class:"form-group",style:{flex:"1"}},VH={class:"form-group",style:{flex:"0 0 auto"}},GH={class:"form-group"},qH={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ye(()=>s.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{o("update:isDirty",!0),o("update:location",{...i.value})},c=()=>{if(!Lu(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}o("save",i.value)},d=()=>{o("close")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:`Add ${B(n).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add "+b(B(n).checkpoint),1)]),default:Ve(()=>[r("form",{onSubmit:rt(c,["prevent"])},[r("div",OH,[f[7]||(f[7]=r("label",null,"Name",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>i.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",NH,[f[8]||(f[8]=r("label",null,"Description",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>i.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",BH,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>i.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!B(Lu)(i.value.what3Words)?(p(),g("small",FH," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),r("div",UH,[r("div",zH,[f[10]||(f[10]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>i.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",HH,[f[11]||(f[11]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",VH,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>h.$emit("set-on-map"))},"  ")])]),r("div",GH,[r("label",null,"Required "+b(B(n).people),1),We(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>i.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},jH=Ke(qH,[["__scopeId","data-v-fb51fed0"]]),WH=["aria-expanded","title"],ZH=["innerHTML"],KH={key:0,class:"dropdown-menu"},YH=["onClick"],JH=["innerHTML"],XH={__name:"ThemeToggle",setup(e){const{theme:t,isDark:n,setTheme:s}=Xy(),o=D(!1),i=D(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=H(()=>n.value?l.dark:l.light),h=()=>{o.value=!o.value},f=y=>{s(y),o.value=!1},m=y=>{i.value&&!i.value.contains(y.target)&&(o.value=!1)};return cn(()=>{document.addEventListener("click",m)}),In(()=>{document.removeEventListener("click",m)}),(y,k)=>(p(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":o.value,title:B(n)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,ZH)],8,WH),o.value?(p(),g("div",KH,[(p(),g(Se,null,je(c,w=>r("button",{key:w.value,class:le(["dropdown-item",{active:B(t)===w.value}]),onClick:x=>f(w.value)},[r("span",{class:"option-icon",innerHTML:w.icon},null,8,JH),r("span",null,b(w.label),1)],10,YH)),64))])):P("",!0)],512))}},QH=Ke(XH,[["__scopeId","data-v-969124a4"]]),eV={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},tV=["id"],nV=["filter"],oV={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){V0(n=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=H(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(n,s)=>(p(),g("svg",eV,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...s[0]||(s[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,tV)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,nV),s[2]||(s[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:le({"marshal-figure":e.animate})},[...s[1]||(s[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},sV=Ke(oV,[["__scopeId","data-v-3e647831"]]),aV={class:"header"},iV={class:"header-left"},lV={key:0},rV={class:"event-date"},cV={class:"header-actions"},uV={class:"container"},dV={class:"tabs-nav"},hV={class:"tab-content-wrapper"},fV={class:"add-note-form"},pV={class:"modal-footer-actions"},vV=["disabled"],mV=6e4,gV={__name:"AdminEventManage",setup(e){const t=Qu(),n=ir(),s=Zy(),o=H(()=>t.params.eventId),{activeTab:i,switchTab:l}=Ky("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","roles","settings"]),{showConfirmModal:c,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:w}=u2(),{tabLabels:x,terms:A,termsLower:E}=dt(),_=d2(),C=f2(o),S=h2(o),{colorScheme:$}=Xy(),R=H(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:x.value.course,icon:"course"},{value:"areas",label:x.value.areas,icon:"area"},{value:"checkpoints",label:x.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:x.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:x.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"roles",label:"Roles",icon:"roles"},{value:"settings",label:"Settings",icon:"settings"}]),T=D(null),O=D([]),M=D([]),U=D({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0,roles:0}),F=D(null),j=D(!1),Z=D(!1),Q=D(null),re=D(null),K=D(!1),ae=D(!1),q=D(null),Y=D(""),te=S.eventAdmins,ue=S.showAddAdmin,_e=C.showUploadRoute,$e=C.uploading,De=C.uploadError,Re=C.showImportLocations,be=C.showImportMarshals,z=C.importing,J=C.importingMarshals,de=C.importError,ie=C.importResult,Ae=C.importMarshalsResult,G=D(!1),X=D(!1),ee=D({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ce=D(!1),Be=D(!1),Fe=D({marshalName:"",locations:[],marshal:null}),Ee=D(null),oe=D([]),ge=D(!1),Ne=D(null),Oe=D(null),xe=D(null),me=D({}),Ze=D({id:"",name:"",email:"",phoneNumber:"",notes:""}),qe=D(!1),fe=D([]),ke=D([]),ne=D([]),ye=D([]),He=D(!1),ct=D(""),ht=D(""),Nt=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Lt=D(!1),Bt=D(!1),Et=D(""),yo=D(""),ko=D(0),ft=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Pt=D([]),vt=D(null),An=D(!1),Ao=D("details"),ao=D(null),bo=D(null),Gt=D(null),As=_.isAddingMultipleCheckpoints,wo=_.multiCheckpointCounter,zo=_.isFullscreenMapActive,pe=_.fullscreenMode,ve=_.fullscreenContext,Ie=_.tempLocationCoords,lt=_.tempCheckpoints,Qe=_.savedMapCenter,Ft=_.savedMapZoom,an=_.isDrawingAreaBoundary,yn=D(null),_n=D([]),_o=D(null),Ho=D(!1),Vo=D("details"),Ma=H(()=>!_n.value||_n.value.length===0?0:Math.max(..._n.value.map(se=>se.displayOrder||0))+1),dl=D(null),hl=D(null),ki=D(!1),Go=D([]),qo=D(null),Aa=D(!1),Es=D("details"),Vn=D([]),bi=D(!1),Gn=D(null),jo=D(!1),os=D(!1),Ys=D(!1),io=D(""),Js=D(!1),qn=D([]),Wo=D({builtInRoles:[],customRoles:[]}),bt=D(null),Dt=D(!1),jn=D([]),On=D(null),Nn=D(!1),ss=D("details"),pt=D([]),Vt=D(!1),Co=D("details"),Lo=D(null),Cn=D(""),Xs=D(null),Eo=D(null),So=H(()=>Eo.value?.marshalId!=null),en=()=>{n.push(`/event/${t.params.eventId}`)},Wn=H(()=>`${window.location.origin}/#/event/${t.params.eventId}`),lo=H(()=>{const V=[];return M.value.forEach(se=>{se.assignments&&V.push(...se.assignments)}),V}),Ps=H(()=>{if(!Ne.value)return M.value;const V=Ne.value.assignedLocationIds||[],se=ne.value.map(we=>we.locationId),ce=ye.value;return M.value.filter(we=>!V.includes(we.id)&&!se.includes(we.id)||ce.includes(we.id))}),Ea=H(()=>{let V=oe.value;if(F.value){const se=F.value.assignments.map(we=>we.marshalName),ce=fe.value.map(we=>we.marshalName);V=oe.value.filter(we=>!se.includes(we.name)&&!ce.includes(we.name))}return V.slice().sort((se,ce)=>se.name.localeCompare(ce.name))}),Qs=H(()=>pe.value==="draw-area"&&vt.value?.polygon?.length>0||_.canCompleteFullscreen.value),wi=H(()=>pe.value==="move-checkpoint"&&F.value?.id?F.value.id:null),Pa=H(()=>{const V=[...M.value];return pe.value==="place-checkpoint"&&Ie.value&&V.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Ie.value.lat,longitude:Ie.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),pe.value==="move-checkpoint"&&Ie.value&&F.value&&V.push({id:"temp-move",name:F.value.name+" (new position)",latitude:Ie.value.lat,longitude:Ie.value.lng,requiredMarshals:F.value.requiredMarshals,assignments:[],isTemporary:!0}),pe.value==="add-multiple"&&V.push(...lt.value),V}),Da=H(()=>{let V=[...Pt.value];return pe.value==="draw-area"&&vt.value?.id&&(V=V.filter(se=>se.id!==vt.value.id)),pe.value==="draw-area"&&vt.value?.polygon?.length>0&&V.push({...vt.value,id:vt.value.id||"temp-area"}),V}),Ds=H(()=>{if(!Ne.value||!Vn.value.length)return[];const V=Ne.value.id,se=Ne.value.assignedLocationIds||[];return Vn.value.filter(ce=>{if(ce.reportedBy?.marshalId===V)return!0;const we=ce.context?.checkpoint?.checkpointId;return!!(we&&se.includes(we))}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),Ra=H(()=>{if(!F.value||!Vn.value.length)return[];const V=F.value.id;return Vn.value.filter(se=>se.context?.checkpoint?.checkpointId===V).sort((se,ce)=>new Date(ce.incidentTime||ce.createdAt)-new Date(se.incidentTime||se.createdAt))}),Rs=H(()=>{if(!vt.value||!Vn.value.length)return[];const V=vt.value.id,se=M.value.filter(ce=>ce.areaIds&&ce.areaIds.includes(V)).map(ce=>ce.id);return Vn.value.filter(ce=>{const we=ce.context?.checkpoint?.checkpointId;return we&&se.includes(we)}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),_i=V=>{Gn.value=V,jo.value=!0},Ci=V=>{Gn.value=V,jo.value=!0},ur=V=>{Gn.value=V,jo.value=!0},wt=()=>{n.push("/sessions")},Rt=(V=!0)=>{qe.value=V},Ut=()=>{Lt.value=!0},Oa=async V=>{try{V&&(Nt.value={...V});const se=rc(T.value.eventDate),ce=Nt.value.eventDate;if(se!==ce){const we=O.value.filter(at=>at.startTime||at.endTime);if(we.length>0){Et.value=se,yo.value=ce,ko.value=we.length,Bt.value=!0;return}}await ro(!1,null)}catch(se){console.error("Failed to update event:",se),alert("Failed to update event. Please try again.")}},ro=async(V,se)=>{try{if(await s.updateEvent(t.params.eventId,{...Nt.value,defaultCheckpointStyleMapRotation:Nt.value.defaultCheckpointStyleMapRotation!=null?String(Nt.value.defaultCheckpointStyleMapRotation):null}),V&&se!==null){const ce=Math.floor(Math.abs(se)/1e3),we=se<0,at=Math.floor(ce/3600),xt=Math.floor(ce%3600/60),jt=ce%60,$n=`${we?"-":""}${at.toString().padStart(2,"0")}:${xt.toString().padStart(2,"0")}:${jt.toString().padStart(2,"0")}`;await s.bulkUpdateLocationTimes(t.params.eventId,$n)}await Zn(),Lt.value=!1}catch(ce){console.error("Failed to update event:",ce),alert("Failed to update event. Please try again.")}},Li=async({shouldShift:V,timeDelta:se})=>{Bt.value=!1,await ro(V,se)},ea=()=>{Bt.value=!1,Zn()},as=async({routeColor:V,routeStyle:se,routeWeight:ce})=>{if(T.value)try{await s.updateEvent(t.params.eventId,{name:T.value.name,description:T.value.description,eventDate:T.value.eventDate,timeZoneId:T.value.timeZoneId,routeColor:V,routeStyle:se,routeWeight:ce}),T.value={...T.value,routeColor:V,routeStyle:se,routeWeight:ce}}catch(we){console.error("Failed to update route settings:",we)}},Zn=async()=>{try{await s.fetchEvent(t.params.eventId),T.value=s.currentEvent,T.value&&(Nt.value={name:T.value.name||"",description:T.value.description||"",eventDate:rc(T.value.eventDate),timeZoneId:T.value.timeZoneId||"UTC",peopleTerm:T.value.peopleTerm||"Marshals",checkpointTerm:T.value.checkpointTerm||"Checkpoints",areaTerm:T.value.areaTerm||"Areas",checklistTerm:T.value.checklistTerm||"Checklists",courseTerm:T.value.courseTerm||"Course",defaultCheckpointStyleType:T.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:T.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:T.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:T.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:T.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:T.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:T.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:T.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:T.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:T.value.brandingHeaderGradientEnd||"",brandingLogoUrl:T.value.brandingLogoUrl||"",brandingLogoPosition:T.value.brandingLogoPosition||"",brandingAccentColor:T.value.brandingAccentColor||"",brandingPageGradientStart:T.value.brandingPageGradientStart||"",brandingPageGradientEnd:T.value.brandingPageGradientEnd||""},Lt.value=!1,Zh(T.value));const V=await Promise.allSettled([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),un(),kn(),qt(),co(),xn(),ta(),Os(),cs()]);O.value=s.locations,M.value=s.eventStatus.locations,V.forEach((se,ce)=>{se.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts","roles"][ce]}:`,se.reason)})}catch(V){console.error("Failed to load event data:",V)}},kn=async()=>{try{const V=await bs.getByEvent(t.params.eventId);oe.value=V.data,U.value.marshals=Date.now()}catch(V){console.error("Failed to load marshals:",V)}},qt=async()=>{try{const V=await ga.getByEvent(t.params.eventId);Pt.value=V.data,U.value.areas=Date.now()}catch(V){console.error("Failed to load areas:",V)}},co=async()=>{try{const[V,se]=await Promise.all([Ot.getByEvent(t.params.eventId),Ot.getReport(t.params.eventId)]);_n.value=V.data,dl.value=se.data,U.value.checklists=Date.now()}catch(V){console.error("Failed to load checklists:",V)}},fl=async()=>{try{ki.value=!0;const V=await Ot.getDetailedReport(t.params.eventId);hl.value=V.data}catch(V){console.error("Failed to load detailed report:",V)}finally{ki.value=!1}},xn=async()=>{try{const V=await ys.getByEvent(t.params.eventId);Go.value=V.data,U.value.notes=Date.now()}catch(V){console.error("Failed to load notes:",V)}},ta=async()=>{bi.value=!0;try{const V=await js.getAll(t.params.eventId);Vn.value=V.data.incidents||[],U.value.incidents=Date.now()}catch(V){console.error("Failed to load incidents:",V)}finally{bi.value=!1}},Os=async()=>{try{const[V,se]=await Promise.all([da.getByEvent(t.params.eventId),da.getRoles(t.params.eventId)]);qn.value=V.data,Wo.value=se.data,U.value.contacts=Date.now()}catch(V){console.error("Failed to load contacts:",V)}},Na=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId)]),O.value=s.locations,U.value.checkpoints=Date.now(),M.value=s.eventStatus.locations},pl=async()=>{await Promise.all([kn(),s.fetchEventStatus(t.params.eventId)]),M.value=s.eventStatus.locations},Si=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),qt()]),O.value=s.locations,M.value=s.eventStatus.locations},$t=async()=>{await s.fetchEventStatus(t.params.eventId),M.value=s.eventStatus.locations},vl=()=>{vt.value=null,Ao.value="details",qe.value=!1,An.value=!0},En=V=>{vt.value=V,bo.value=V.id,Ao.value="details",qe.value=!1,An.value=!0},is=async V=>{try{let se;if(vt.value&&vt.value.id){if(se=vt.value.id,await ga.update(t.params.eventId,se,V),V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Ot.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Ot.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}}else se=(await ga.create({eventId:t.params.eventId,...V})).data.id;if(V.pendingContacts&&V.pendingContacts.length>0&&se)for(const ce of V.pendingContacts)try{const we=ce.scopeConfigurations?JSON.parse(JSON.stringify(ce.scopeConfigurations)):[],at=we.find(xt=>xt.scope==="EveryoneInAreas"&&xt.itemType==="Area");at?(at.ids||(at.ids=[]),at.ids.includes(se)||at.ids.push(se)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[se]}),await da.update(t.params.eventId,ce.contactId,{...ce,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",ce,we)}if(V.contactsToRemove&&V.contactsToRemove.length>0&&se)for(const ce of V.contactsToRemove)try{const we=qn.value.find(jt=>jt.contactId===ce);if(!we)continue;const at=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],xt=at.find(jt=>jt.scope==="EveryoneInAreas"&&jt.itemType==="Area");if(xt&&xt.ids){xt.ids=xt.ids.filter($n=>$n!==se);const jt=xt.ids.length>0?at:at.filter($n=>!($n.scope==="EveryoneInAreas"&&$n.itemType==="Area"));await da.update(t.params.eventId,ce,{...we,scopeConfigurations:jt})}}catch(we){console.error("Failed to remove area from contact:",ce,we)}if((V.pendingContacts&&V.pendingContacts.length>0||V.contactsToRemove&&V.contactsToRemove.length>0)&&await Os(),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0&&se){for(const ce of V.pendingNewChecklistItems)if(ce.text?.trim())try{await Ot.create(t.params.eventId,{text:ce.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,isRequired:!1})}catch(we){console.error("Failed to create checklist item:",ce,we)}await co()}if(V.pendingNewNotes&&V.pendingNewNotes.length>0&&se){for(const ce of V.pendingNewNotes)if(!(!ce.title?.trim()&&!ce.content?.trim()))try{await ys.create(t.params.eventId,{title:ce.title||"Untitled",content:ce.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(we){console.error("Failed to create note:",ce,we)}await xn()}await qt(),await Zn(),Ii()}catch(se){console.error("Failed to save area:",se),alert(se.response?.data?.message||"Failed to save area. Please try again.")}},ml=async V=>{y(`Delete ${E.value.area}`,`Are you sure you want to delete this ${E.value.area}? ${A.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ga.delete(t.params.eventId,V),await ga.recalculate(t.params.eventId),await qt(),await Zn(),Ii()}catch(se){console.error(`Failed to delete ${E.value.area}:`,se),alert(se.response?.data?.message||`Failed to delete ${E.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ii=()=>{An.value=!1,vt.value=null,bo.value=null,qe.value=!1,an.value=!1,Gt.value=null},ls=({marshal:V,area:se})=>{bt.value=null,Co.value="details",qe.value=!1,Lo.value=se,Cn.value="",Xs.value=V.id,Dt.value=!0},xi=({name:V,area:se})=>{bt.value=null,Co.value="details",qe.value=!1,Lo.value=se,Cn.value=V,Xs.value=null,Dt.value=!0},gl=V=>{bt.value=V,Co.value="details",qe.value=!1,Dt.value=!0},dr=()=>{_o.value=null,Vo.value="details",qe.value=!1,Ho.value=!0},na=(V,se="details")=>{_o.value=V,Vo.value=se,qe.value=!1,Ho.value=!0},oa=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Pt.value,locations:M.value,marshals:oe.value})};if(_o.value&&_o.value.itemId)await Ot.update(t.params.eventId,_o.value.itemId,se);else{const ce=await Ot.create(t.params.eventId,se);ce.data.count&&ce.data.count>1&&(ct.value="Checklist Items Created",ht.value=`Successfully created ${ce.data.count} checklist items.`,He.value=!0)}await co(),Pn()}catch(se){console.error("Failed to save checklist item:",se);const ce=se.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ce)}},Ns=async V=>{y(`Delete ${E.value.checklist}`,`Are you sure you want to delete this ${E.value.checklist}?`,async()=>{try{await Ot.delete(t.params.eventId,V),await co(),Pn()}catch(se){console.error(`Failed to delete ${E.value.checklist}:`,se),alert(se.response?.data?.message||`Failed to delete ${E.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Pn=()=>{Ho.value=!1,_o.value=null,qe.value=!1},$i=async V=>{const se=[..._n.value];V.forEach(ce=>{const we=_n.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ot.reorder(t.params.eventId,V)}catch(ce){_n.value=se,console.error("Failed to reorder checklist items:",ce),alert("Failed to save order. Changes have been reverted.")}},Ti=()=>{qo.value=null,Es.value="details",qe.value=!1,Aa.value=!0},Po=V=>{qo.value=V,Es.value="details",qe.value=!1,Aa.value=!0},yl=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Pt.value,locations:M.value,marshals:oe.value})};qo.value&&qo.value.noteId?await ys.update(t.params.eventId,qo.value.noteId,se):await ys.create(t.params.eventId,se),await xn(),Bs()}catch(se){console.error("Failed to save note:",se);const ce=se.response?.data?.message||"Failed to save note. Please try again.";alert(ce)}},kl=async V=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await ys.delete(t.params.eventId,V),await xn(),Bs()}catch(se){console.error("Failed to delete note:",se),alert(se.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Bs=()=>{Aa.value=!1,qo.value=null,qe.value=!1},Ba=async V=>{const se=[...Go.value];V.forEach(ce=>{const we=Go.value.find(at=>at.noteId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await ys.reorder(t.params.eventId,V)}catch(ce){Go.value=se,console.error("Failed to reorder notes:",ce),alert("Failed to save order. Changes have been reverted.")}},Fa=async V=>{const se=[..._n.value];V.forEach(ce=>{const we=_n.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ot.reorder(t.params.eventId,V)}catch(ce){_n.value=se,console.error("Failed to reorder checklists:",ce),alert("Failed to save order. Changes have been reverted.")}},bl=()=>{os.value=!0},hr=async V=>{try{await js.create(t.params.eventId,V),os.value=!1,await ta()}catch(se){console.error("Failed to report incident:",se),alert(se.response?.data?.message||"Failed to report incident. Please try again.")}},wl=V=>{Gn.value=V,jo.value=!0},Ua=()=>{jo.value=!1,Gn.value=null},fr=async({incidentId:V,status:se})=>{try{if(await js.updateStatus(t.params.eventId,V,{status:se}),await ta(),Gn.value?.incidentId===V){const ce=Vn.value.find(we=>we.incidentId===V);ce&&(Gn.value=ce)}}catch(ce){console.error("Failed to update incident status:",ce),alert(ce.response?.data?.message||"Failed to update status. Please try again.")}},za=()=>{io.value="",Ys.value=!0},sa=()=>{Ys.value=!1,io.value=""},Ha=async()=>{if(!(!io.value.trim()||!Gn.value)){Js.value=!0;try{await js.addNote(t.params.eventId,Gn.value.incidentId,io.value.trim()),sa(),await ta();const V=Vn.value.find(se=>se.incidentId===Gn.value.incidentId);V&&(Gn.value=V)}catch(V){console.error("Failed to add note to incident:",V),alert(V.response?.data?.message||"Failed to add note. Please try again.")}finally{Js.value=!1}}},rs=()=>{bt.value=null,Co.value="details",Lo.value=null,qe.value=!1,Dt.value=!0},pr=V=>{bt.value=V,Co.value="details",qe.value=!1,Dt.value=!0},aa=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Pt.value,locations:M.value,marshals:oe.value})};let ce=null;const we=!bt.value||!bt.value.contactId,at=!!Lo.value;if(bt.value&&bt.value.contactId)await da.update(t.params.eventId,bt.value.contactId,se);else{const xt=await da.create(t.params.eventId,se);ce=xt.data?.contactId||xt.data?.id}if(await Os(),we&&at&&ce&&ao.value){const xt=qn.value.find(jt=>jt.contactId===ce);xt&&ao.value.addPendingContact(xt)}ia()}catch(se){console.error("Failed to save contact:",se);const ce=se.response?.data?.message||"Failed to save contact. Please try again.";alert(ce)}},Bn=async V=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await da.delete(t.params.eventId,V),await Os(),ao.value&&ao.value.removeContactById(V),ia()}catch(se){console.error("Failed to delete contact:",se),alert(se.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},ia=()=>{Dt.value=!1,bt.value=null,Lo.value=null,Cn.value="",Xs.value=null,qe.value=!1},Va=async V=>{const se=[...qn.value];V.forEach(ce=>{const we=qn.value.find(at=>at.contactId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await da.reorder(t.params.eventId,V)}catch(ce){qn.value=se,console.error("Failed to reorder contacts:",ce),alert("Failed to save order. Changes have been reverted.")}},cs=async()=>{try{const V=await Qa.getAll(t.params.eventId);jn.value=V.data,U.value.roles=Date.now()}catch(V){console.error("Failed to load role definitions:",V)}},Te=()=>{On.value=null,ss.value="details",pt.value=[],qe.value=!1,Nn.value=!0},Le=V=>{On.value=V,ss.value="details",pt.value=[],qe.value=!1,Nn.value=!0},ot=async V=>{try{const se=On.value?.roleId,{assignmentChanges:ce,...we}=V;se?(await Qa.update(t.params.eventId,se,we),ce&&(ce.marshalIdsToAdd.length>0||ce.marshalIdsToRemove.length>0||ce.contactIdsToAdd.length>0||ce.contactIdsToRemove.length>0)&&await Qa.updatePeople(t.params.eventId,se,ce)):await Qa.create(t.params.eventId,we),await cs(),Ct()}catch(se){console.error("Failed to save role:",se);const ce=se.response?.data?.message||"Failed to save role. Please try again.";alert(ce)}},gt=async V=>{const se=On.value?.usageCount||0;let ce="Are you sure you want to delete this role?";if(se>0){const we=se===1?E.value.person:E.value.people;ce=`This role is assigned to ${se} ${we}. They will all be unassigned from this role. Are you sure you want to delete it?`}y("Delete role",ce,async()=>{try{await Qa.delete(t.params.eventId,V),await cs(),Ct()}catch(we){console.error("Failed to delete role:",we),alert(we.response?.data?.message||"Failed to delete role. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ct=()=>{Nn.value=!1,On.value=null,pt.value=[],qe.value=!1},Xt=async V=>{Vt.value=!0;try{const se=await Qa.getPeople(t.params.eventId,V);pt.value=se.data}catch(se){console.error("Failed to load people for role:",se)}finally{Vt.value=!1}},tn=async V=>{const se=[...jn.value];V.forEach(ce=>{const we=jn.value.find(at=>at.roleId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Qa.reorder(t.params.eventId,V)}catch(ce){jn.value=se,console.error("Failed to reorder roles:",ce),alert("Failed to save order. Changes have been reverted.")}},on=V=>{Gt.value={...V,id:vt.value?.id};const se={...V,id:vt.value?.id,polygon:[]};vt.value=se;let ce=!1;if(V.polygon&&V.polygon.length>0){const we=V.polygon.map(a=>a.lat||a[0]),at=V.polygon.map(a=>a.lng||a[1]),xt=Math.min(...we),jt=Math.max(...we),$n=Math.min(...at),Pi=Math.max(...at);Qe.value={lat:(xt+jt)/2,lng:($n+Pi)/2};const Di=jt-xt,Pl=Pi-$n,Za=Math.max(Di,Pl);Ft.value=Za<.005?17:Za<.01?16:Za<.02?15:Za<.05?14:13,ce=!0}if(!ce&&V.checkpointIds&&V.checkpointIds.length>0){const we=M.value.filter(at=>V.checkpointIds.includes(at.id));if(we.length>0){const at=we.map(jt=>jt.latitude).filter(Boolean),xt=we.map(jt=>jt.longitude).filter(Boolean);if(at.length>0&&xt.length>0){const jt=Math.min(...at),$n=Math.max(...at),Pi=Math.min(...xt),Di=Math.max(...xt);Qe.value={lat:(jt+$n)/2,lng:(Pi+Di)/2};const Pl=$n-jt,Za=Di-Pi,a=Math.max(Pl,Za);Ft.value=a<.005?16:a<.01?15:a<.02?14:a<.05?13:12,ce=!0}}}if(!ce&&Q.value){const we=Q.value.getMapCenter(),at=Q.value.getMapZoom();we&&at!==null&&(Qe.value=we,Ft.value=at)}zo.value=!0,pe.value="draw-area",an.value=!0,ve.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},bn=V=>{Gt.value?vt.value={...vt.value||{},...Gt.value,polygon:V}:vt.value={...vt.value,polygon:V}},pn=V=>{_.handlePolygonDrawing(V)},At=()=>{an.value=!1,Gt.value&&(vt.value=Gt.value,An.value=!0,Gt.value=null)},un=()=>S.loadEventAdmins(),vr=async V=>{try{await S.addAdmin(V),await un(),mr()}catch(se){console.error("Failed to add admin:",se),alert(se.response?.data?.message||"Failed to add administrator. Please try again.")}},la=async V=>{y("Remove administrator",`Remove ${V} as an administrator?`,async()=>{try{await S.removeAdmin(V),await un()}catch(se){console.error("Failed to remove admin:",se),alert(se.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},mr=()=>{S.closeAddAdminModal(),qe.value=!1},_l=async V=>{await C.uploadRoute(V)&&(await Na(),_c())},_c=()=>{C.closeUploadRouteModal()},Fs=async({file:V,deleteExisting:se})=>{const ce=await C.importLocations(V,se);if(ce){await Si(),Mi();const we=C.formatImportResultMessage(ce,"location");ct.value="Import Complete",ht.value=we,He.value=!0}},Mi=()=>{C.closeImportLocationsModal()},rd=async V=>{if(Z.value)ft.value.latitude=V.lat,ft.value.longitude=V.lng;else if(X.value)ee.value.latitude=V.lat,ee.value.longitude=V.lng,F.value&&(F.value={...F.value,latitude:V.lat,longitude:V.lng}),X.value=!1,G.value=!0,Rt();else if(As.value)try{await s.createLocation({eventId:t.params.eventId,name:`Checkpoint ${wo.value}`,description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""}),wo.value++,await Zn()}catch(se){console.error("Failed to create checkpoint:",se),alert("Failed to create checkpoint. Please try again.")}},gr=V=>{_.handleFullscreenMapClick(V)},cd=V=>{ft.value={...V}},us=()=>{Z.value=!1,_.enterPlaceCheckpointMode()},ud=()=>{_.saveMapState(Q.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},_.enterPlaceCheckpointMode()},Ga=()=>{_.saveMapState(Q.value),zo.value=!0,pe.value="view",ve.value={title:"Course map",description:""}},dd=()=>{_.saveMapState(Q.value),vt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Pt.value.length},_.enterDrawAreaMode()},ds=()=>{F.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1,G.value=!0},Cl=()=>{const V=_.calculateStartingNumber(M);_.saveMapState(Q.value),_.enterAddMultipleMode(V)},Cc=()=>{if(pe.value==="place-checkpoint"){const V=_.getPlacedCoords()||{lat:0,lng:0};F.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1,qa(),G.value=!0}else if(pe.value==="move-checkpoint"){const V=_.getPlacedCoords();V&&(ee.value.latitude=V.lat,ee.value.longitude=V.lng,F.value&&(F.value={...F.value,...yn.value||{},latitude:V.lat,longitude:V.lng}),Rt()),yn.value=null,qa(),G.value=!0}else if(pe.value==="draw-area"){const V=_.getCompletedPolygon();V&&(Gt.value?vt.value={...vt.value||{},...Gt.value,polygon:V}:vt.value={...vt.value||{},polygon:V}),Gt.value=null,qa()}else pe.value==="add-multiple"&&yr()},yr=async()=>{const V=_.getTempCheckpoints();try{for(const se of V)await s.createLocation({eventId:t.params.eventId,name:se.name,description:se.description,latitude:se.latitude,longitude:se.longitude,requiredMarshals:se.requiredMarshals,what3Words:se.what3Words});_.clearTempCheckpoints(),qa(),await Zn()}catch(se){console.error("Failed to create checkpoints:",se),alert("Failed to create checkpoints. Please try again.")}},Ll=()=>{pe.value==="draw-area"?Gt.value&&(vt.value=Gt.value,Gt.value=null):pe.value==="move-checkpoint"&&(yn.value&&F.value&&Object.assign(F.value,yn.value),G.value=!0,X.value=!1),_.cancelFullscreen()},qa=()=>{_.exitFullscreen()},Sl=V=>{hs(V)},hs=V=>{F.value=V,ee.value={id:V.id,name:V.name,description:V.description||"",latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||""},fe.value=[],ke.value=[],qe.value=!1,G.value=!0,setTimeout(()=>{Q.value?.scrollMapIntoView()},100)},Il=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await s.createLocation({eventId:t.params.eventId,...V}),await Zn(),xl()}catch(se){console.error("Failed to save location:",se),alert("Failed to save location. Please try again.")}},xl=()=>{Z.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},qe.value=!1,qe.value=!1},$l=()=>{G.value=!1,F.value=null,j.value=!1,X.value=!1,Ce.value=!1,yn.value=null,ee.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1},kr=()=>{Ce.value=!1},Tl=()=>{Ce.value=!0},hd=V=>{V?.formData&&(yn.value=V.formData),G.value=!1,Ie.value=null;const se=yn.value?.latitude??F.value?.latitude,ce=yn.value?.longitude??F.value?.longitude;if(se&&ce)Qe.value={lat:se,lng:ce},Ft.value=16;else if(Q.value){const at=Q.value.getMapCenter(),xt=Q.value.getMapZoom();at&&xt!==null&&(Qe.value=at,Ft.value=xt)}const we=yn.value?.name||F.value?.name;zo.value=!0,pe.value="move-checkpoint",ve.value={title:`Move ${E.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},Lc=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format.");return}try{const se=!F.value.id;if(se){const ce=await s.createLocation({eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:ce.id,marshalId:we.marshalId})}else{const ce=F.value.id;if(await Xn.update(t.params.eventId,ce,{eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Ot.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ys.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of ke.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of fe.value)await s.createAssignment({eventId:t.params.eventId,locationId:F.value.id,marshalId:we.marshalId});if(V.checkInChanges&&V.checkInChanges.length>0)for(const we of V.checkInChanges){const at=F.value.assignments.find(xt=>xt.id===we.assignmentId);at&&at.isCheckedIn!==we.shouldBeCheckedIn&&await hi.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!se&&V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Ot.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Ot.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}await Zn(),$l()}catch(se){console.error("Failed to update location:",se),alert("Failed to update location. Please try again.")}},fd=async V=>{y(`Delete ${E.value.checkpoint}`,`Are you sure you want to delete this ${E.value.checkpoint}?`,async()=>{try{await Xn.delete(t.params.eventId,V),await Si(),$l()}catch(se){console.error(`Failed to delete ${E.value.checkpoint}:`,se),alert(`Failed to delete ${E.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Sc=async V=>{try{if(re.value&&re.value.setCheckingIn(V.id),await hi.adminCheckIn(t.params.eventId,V.id),await $t(),F.value){const se=M.value.find(ce=>ce.id===F.value.id);se&&(F.value=se)}}catch(se){console.error("Failed to toggle check-in:",se),alert("Failed to toggle check-in. Please try again.")}finally{re.value&&re.value.setCheckingIn(null)}},pd=V=>{const se=V?.id??V;if(se?.toString().startsWith("temp-")){const ce=F.value.assignments.find(we=>we.id===se);ce&&(fe.value=fe.value.filter(we=>we.marshalId!==ce.marshalId)),F.value.assignments=F.value.assignments.filter(we=>we.id!==se),Rt()}else ke.value.includes(se)||(ke.value.push(se),F.value.assignments=F.value.assignments.filter(ce=>ce.id!==se),Rt())},Zo=async V=>{const se=oe.value.find(we=>we.id===V);if(!se)return;const ce=M.value.filter(we=>we.assignments?.some(at=>at.marshalId===V&&we.id!==F.value.id));if(ce.length>0){Fe.value={marshalName:se.name,locations:ce.map(at=>at.name),marshal:se};const we=await new Promise(at=>{Ee.value=at,Be.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const at of ce){const xt=at.assignments.find(jt=>jt.marshalId===V);if(xt){ke.value.push(xt.id);const jt=M.value.findIndex($n=>$n.id===at.id);jt!==-1&&(M.value[jt].assignments=M.value[jt].assignments.filter($n=>$n.id!==xt.id))}}}fe.value.push({marshalId:se.id,marshalName:se.name}),F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:se.id,marshalName:se.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0}),Rt(),kr()},Ml=async V=>{try{const ce=(await bs.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber})).data;await kn(),fe.value.push({marshalId:ce.id,marshalName:ce.name}),F.value&&(F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ce.id,marshalName:ce.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0})),Rt(),kr()}catch(se){console.error("Failed to create marshal:",se),alert("Failed to create marshal. Please try again.")}},vd=()=>{Ne.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],qe.value=!1,ge.value=!0},Al=V=>{Ne.value=V,me.value={},Ze.value={id:V.id,name:V.name,email:V.email||"",phoneNumber:V.phoneNumber||"",notes:V.notes||""},ne.value=[],ye.value=[],qe.value=!1,ge.value=!0},Ic=H(()=>{if(!Ne.value)return[];const V=[];return M.value.forEach(se=>{se.assignments.filter(we=>we.marshalName===Ne.value.name&&!ye.value.includes(we.id)).forEach(we=>{V.push({...we,locationName:se.name,locationDescription:se.description||""})})}),ne.value.forEach((se,ce)=>{const we=M.value.find(at=>at.id===se.locationId);we&&V.push({id:`pending-${ce}`,locationId:se.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:Ne.value.id,marshalName:Ne.value.name,isCheckedIn:!1,isPending:!0})}),V}),xc=async V=>{try{let se=Ne.value?.id,ce=!1;if(Ne.value){if(await bs.update(t.params.eventId,Ne.value.id,{name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Ot.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ys.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}else se=(await bs.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]})).data.id,ce=!0;for(const we of ye.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of ne.value)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.checkInChanges&&V.checkInChanges.length>0){const we=Ic.value;for(const at of V.checkInChanges){const xt=we.find(jt=>jt.id===at.assignmentId);xt&&xt.isCheckedIn!==at.shouldBeCheckedIn&&await hi.adminCheckIn(t.params.eventId,at.assignmentId)}}if(V.checklistChanges&&V.checklistChanges.length>0)for(const we of V.checklistChanges)try{const at={marshalId:se};we.contextType&&we.contextId&&(at.contextType=we.contextType,at.contextId=we.contextId),we.complete?await Ot.complete(t.params.eventId,we.itemId,at):await Ot.uncomplete(t.params.eventId,we.itemId,at)}catch(at){console.error("Failed to process checklist change:",at);const xt=at.response?.data?.message||"Failed to update checklist item";alert(`Error: ${xt}`)}if(await Zn(),F.value){const we=M.value.find(at=>at.id===F.value.id);we&&(F.value=we)}El(),ce&&(q.value=se,Y.value=V.name,ae.value=!0)}catch(se){console.error("Failed to save marshal:",se);const ce=se.response?.data?.message||"Failed to save marshal. Please try again.";if(se.response?.status===400){const we=ce.toLowerCase();we.includes("name")?(me.value={name:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("name"))):we.includes("email")?(me.value={email:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("email"))):(me.value={general:ce},xe.value&&xe.value.switchToTab("details"))}else me.value={general:ce},xe.value&&xe.value.switchToTab("details")}},$c=async V=>{const se=V||Ne.value?.id;if(!se){console.error("No marshal ID to delete");return}const ce=E.value.person;y(`Delete ${ce}`,`Are you sure you want to delete this ${ce}?`,async()=>{try{await bs.delete(t.params.eventId,se),await pl(),El()}catch(we){console.error(`Failed to delete ${ce}:`,we),alert(`Failed to delete ${ce}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ai=V=>{$c(V.id)},md=V=>{const se=V?.id??V;if(se?.toString().startsWith("pending-")){const ce=V?.locationId;ce&&(ne.value=ne.value.filter(we=>we.locationId!==ce)),Rt()}else ye.value.includes(se)||(ye.value.push(se),Rt())},ja=V=>{ne.value.push({locationId:V}),Rt()},El=()=>{ge.value=!1,Ne.value=null,Oe.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],qe.value=!1},Tc=async V=>{const se=oe.value.find(ce=>ce.id===V.marshalId);if(!se){console.error("Marshal not found:",V.marshalId);return}Oe.value=F.value?.id||null,qe.value=!1,Ne.value=se,ge.value=!0},gd=V=>{const se=M.value.find(ce=>ce.id===V.locationId);if(!se){console.error("Location not found:",V.locationId);return}j.value=!0,qe.value=!1,F.value=se,G.value=!0},fs=async({file:V})=>{const se=await C.importMarshals(V);if(se){await pl(),br();const ce=C.formatImportResultMessage(se,"marshal");ct.value="Import Complete",ht.value=ce,He.value=!0}},br=()=>{C.closeImportMarshalsModal()},Mc=V=>{Ee.value&&(Ee.value(V),Ee.value=null),Be.value=!1};let ps=null;const Ac=async()=>{try{const V=t.params.eventId,se=await Xn.getDynamicCheckpoints(V);if(se.data&&Array.isArray(se.data))for(const ce of se.data){const we=M.value.find(at=>at.id===ce.checkpointId);we&&(we.latitude=ce.latitude,we.longitude=ce.longitude,we.lastLocationUpdate=ce.lastLocationUpdate)}}catch(V){console.warn("Failed to poll dynamic checkpoints:",V)}},Ei=()=>{ps||!M.value.some(se=>se.isDynamic||se.IsDynamic)||(Ac(),ps=setInterval(Ac,6e4))},Wa=()=>{ps&&(clearInterval(ps),ps=null)};return Ye(i,V=>{V==="course"?Ei():Wa();const se=Date.now(),ce=we=>se-U.value[we]>mV;switch(V){case"marshals":ce("marshals")&&kn(),ce("roles")&&cs();break;case"areas":ce("areas")&&qt(),ce("roles")&&cs();break;case"checkpoints":ce("checkpoints")&&Na();break;case"checklists":ce("checklists")&&co();break;case"notes":ce("notes")&&xn();break;case"incidents":ce("incidents")&&ta();break;case"contacts":ce("contacts")&&Os(),ce("roles")&&cs();break;case"roles":ce("roles")&&cs();break}}),cn(async()=>{await Zn();try{const V=await Ws.getMe(t.params.eventId);Eo.value=V.data}catch(V){console.warn("Failed to fetch user claims:",V)}i.value==="course"&&Ei()}),Ye(T,V=>{V&&(document.title="OnTheDay App - Admin")},{immediate:!0}),In(()=>{Wa()}),(V,se)=>(p(),g("div",{class:"admin-event-manage",style:tt({colorScheme:B($)})},[r("header",aV,[r("div",iV,[r("button",{onClick:wt,class:"btn-back",title:"Back to sessions"},[Pe(sV,{size:48,animate:""})]),T.value?(p(),g("div",lV,[r("h1",null,b(T.value.name),1),r("p",rV,b(B(Qy)(T.value.eventDate)),1)])):P("",!0)]),r("div",cV,[So.value?(p(),g("button",{key:0,onClick:en,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Pe(QH,{class:"theme-toggle-fixed"})]),r("div",uV,[r("div",dV,[Pe(sP,{tabs:R.value,"model-value":B(i),"onUpdate:modelValue":B(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",hV,[B(i)==="course"?(p(),Ge(sS,{key:0,ref_key:"courseAreasTab",ref:Q,checkpoints:M.value,areas:Pt.value,route:T.value?.route||[],"route-color":T.value?.routeColor||"","route-style":T.value?.routeStyle||"","route-weight":T.value?.routeWeight,"selected-area-id":bo.value,"drawing-mode":B(an),onMapClick:rd,onLocationClick:Sl,onAreaClick:En,onImportCheckpoints:se[0]||(se[0]=ce=>Re.value=!0),onUploadRoute:se[1]||(se[1]=ce=>_e.value=!0),onSelectLocation:hs,onAddArea:vl,onSelectArea:En,onPolygonComplete:bn,onCancelDrawing:At,onAddCheckpointFromMap:ud,onAddManyCheckpointsFromMap:Cl,onAddAreaFromMap:dd,onFullscreen:Ga,"onUpdate:routeSettings":as},null,8,["checkpoints","areas","route","route-color","route-style","route-weight","selected-area-id","drawing-mode"])):P("",!0),B(i)==="checkpoints"?(p(),Ge($3,{key:1,locations:M.value,areas:Pt.value,onAddCheckpointManually:ds,onImportCheckpoints:se[2]||(se[2]=ce=>Re.value=!0),onSelectLocation:hs},null,8,["locations","areas"])):P("",!0),B(i)==="areas"?(p(),Ge(Z3,{key:2,areas:Pt.value,checkpoints:M.value,contacts:qn.value,"event-people-term":T.value?.peopleTerm||"Marshals","event-checkpoint-term":T.value?.checkpointTerm||"Checkpoints",onAddArea:vl,onSelectArea:En},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),B(i)==="marshals"?(p(),Ge(iI,{key:3,ref_key:"marshalsTabRef",ref:re,marshals:oe.value,assignments:lo.value,locations:M.value,onAddMarshal:vd,onImportMarshals:se[3]||(se[3]=ce=>be.value=!0),onSelectMarshal:Al,onDeleteMarshal:Ai,onToggleCheckIn:Sc},null,8,["marshals","assignments","locations"])):P("",!0),B(i)==="checklists"?(p(),Ge(k$,{key:4,"checklist-items":_n.value,areas:Pt.value,locations:M.value,marshals:oe.value,"completion-report":dl.value,"detailed-report":hl.value,"is-loading-detailed-report":ki.value,onAddChecklistItem:dr,onSelectChecklistItem:na,onReorder:$i,onLoadDetailedReport:fl},null,8,["checklist-items","areas","locations","marshals","completion-report","detailed-report","is-loading-detailed-report"])):P("",!0),B(i)==="notes"?(p(),Ge(N$,{key:5,notes:Go.value,areas:Pt.value,locations:M.value,marshals:oe.value,onAddNote:Ti,onSelectNote:Po,onReorder:Ba},null,8,["notes","areas","locations","marshals"])):P("",!0),B(i)==="incidents"?(p(),Ge(i3,{key:6,incidents:Vn.value,areas:Pt.value,loading:bi.value,onSelectIncident:wl,onReportIncident:bl},null,8,["incidents","areas","loading"])):P("",!0),B(i)==="contacts"?(p(),Ge(aT,{key:7,contacts:qn.value,areas:Pt.value,locations:M.value,marshals:oe.value,"available-roles":Wo.value,"role-definitions":jn.value,onAddContact:rs,onSelectContact:pr,onReorder:Va},null,8,["contacts","areas","locations","marshals","available-roles","role-definitions"])):P("",!0),B(i)==="roles"?(p(),Ge(_T,{key:8,"role-definitions":jn.value,onAddRole:Te,onSelectRole:Le,onReorder:tn},null,8,["role-definitions"])):P("",!0),B(i)==="details"?(p(),Ge(DT,{key:9,"event-data":Nt.value,"form-dirty":Lt.value,onSubmit:Oa,"onUpdate:formDirty":Ut},null,8,["event-data","form-dirty"])):P("",!0),B(i)==="settings"?(p(),Ge(O4,{key:10,"event-data":Nt.value,"event-id":B(t).params.eventId,admins:B(te),"form-dirty":Lt.value,onSubmit:Oa,onAddAdmin:se[4]||(se[4]=ce=>ue.value=!0),onRemoveAdmin:la,"onUpdate:formDirty":Ut},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Pe(jH,{show:Z.value,location:ft.value,"is-dirty":qe.value,onClose:xl,onSave:Il,onSetOnMap:us,"onUpdate:isDirty":Rt,"onUpdate:location":cd},null,8,["show","location","is-dirty"]),Pe(gO,{show:G.value,location:F.value,assignments:F.value?.assignments||[],"event-date":T.value?.eventDate||"",areas:Pt.value,"event-id":B(t).params.eventId,"all-locations":M.value,notes:Go.value,"available-marshals":Ea.value,"all-marshals":oe.value,"all-checklist-items":_n.value,incidents:Ra.value,"is-dirty":qe.value,"event-default-style-type":T.value?.defaultCheckpointStyleType||T.value?.DefaultCheckpointStyleType||"default","event-default-style-color":T.value?.defaultCheckpointStyleColor||T.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":T.value?.defaultCheckpointStyleBackgroundShape||T.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":T.value?.defaultCheckpointStyleBackgroundColor||T.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":T.value?.defaultCheckpointStyleBorderColor||T.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":T.value?.defaultCheckpointStyleIconColor||T.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":T.value?.defaultCheckpointStyleSize||T.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":T.value?.defaultCheckpointStyleMapRotation??T.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":T.value?.peopleTerm||"Marshals","z-index":An.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:$l,onSave:Lc,onDelete:fd,onMoveLocation:hd,onRemoveAssignment:pd,onOpenAssignModal:Tl,"onUpdate:isDirty":Rt,onSelectIncident:Ci,onSelectMarshal:Tc,onReorderNotes:Ba,onReorderChecklists:Fa},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Pe(cP,{show:K.value,link:Wn.value,"is-dirty":!1,onClose:se[5]||(se[5]=ce=>K.value=!1)},null,8,["show","link"]),Pe(YP,{show:ae.value,"event-id":B(t).params.eventId,"marshal-id":q.value,"marshal-name":Y.value,onClose:se[6]||(se[6]=ce=>ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Pe(QP,{show:B(ue),"is-dirty":qe.value,onClose:mr,onSubmit:vr,"onUpdate:isDirty":Rt},null,8,["show","is-dirty"]),Pe(s6,{show:B(_e),uploading:B($e),error:B(De),"is-dirty":qe.value,onClose:_c,onSubmit:_l,"onUpdate:isDirty":Rt},null,8,["show","uploading","error","is-dirty"]),Pe(p6,{show:B(Re),importing:B(z),error:B(de),result:B(ie),"is-dirty":qe.value,onClose:Mi,onSubmit:Fs,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Pe(xB,{ref_key:"editMarshalModalRef",ref:xe,show:ge.value,marshal:Ne.value,"event-id":B(t).params.eventId,assignments:Ic.value,"available-locations":Ps.value,"all-locations":M.value,areas:Pt.value,"is-editing":!!Ne.value,"event-notes":Go.value,"all-checklist-items":_n.value,incidents:Ds.value,"all-marshals":oe.value,"is-dirty":qe.value,"validation-errors":me.value,"locked-checkpoint-id":Oe.value,"z-index":Oe.value?1100:1e3,"role-definitions":jn.value,onClose:El,onSave:xc,onDelete:$c,onRemoveAssignment:md,onAssignToLocation:ja,"onUpdate:isDirty":Rt,onSelectIncident:_i,onSelectCheckpoint:gd,onReorderNotes:Ba,onReorderChecklists:Fa},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index","role-definitions"]),Pe(_6,{show:B(be),importing:B(J),error:B(de),result:B(Ae),"is-dirty":qe.value,onClose:br,onSubmit:fs,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Pe(AB,{show:Be.value,"conflict-data":Fe.value,onClose:se[7]||(se[7]=ce=>Be.value=!1),onChoice:Mc},null,8,["show","conflict-data"]),Pe(zB,{show:Ce.value,"location-name":F.value?.name||"",marshals:Ea.value,onClose:kr,onAssignExisting:Zo,onCreateAndAssign:Ml},null,8,["show","location-name","marshals"]),Pe(QB,{show:Bt.value,"old-event-date":Et.value,"new-event-date":yo.value,"affected-checkpoints-count":ko.value,onConfirm:Li,onCancel:ea},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Pe(f7,{ref_key:"editAreaModalRef",ref:ao,show:An.value,area:vt.value,"initial-tab":Ao.value,checkpoints:M.value,marshals:oe.value,areas:Pt.value,route:T.value?.route||[],"route-color":T.value?.routeColor||"","route-style":T.value?.routeStyle||"","route-weight":T.value?.routeWeight,"is-dirty":qe.value,"event-id":B(t).params.eventId,"all-locations":M.value,assignments:lo.value,notes:Go.value,contacts:qn.value,incidents:Rs.value,"role-definitions":jn.value,"event-default-style-type":T.value?.defaultCheckpointStyleType||T.value?.DefaultCheckpointStyleType||"default","event-default-style-color":T.value?.defaultCheckpointStyleColor||T.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":T.value?.defaultCheckpointStyleBackgroundShape||T.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":T.value?.defaultCheckpointStyleBackgroundColor||T.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":T.value?.defaultCheckpointStyleBorderColor||T.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":T.value?.defaultCheckpointStyleIconColor||T.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":T.value?.defaultCheckpointStyleSize||T.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":T.value?.defaultCheckpointStyleMapRotation??T.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":T.value?.peopleTerm||"Marshals","event-checkpoint-term":T.value?.checkpointTerm||"Checkpoints",onClose:Ii,onSave:is,onDelete:ml,onDrawBoundary:on,"onUpdate:isDirty":Rt,onSelectCheckpoint:hs,onCreateContactFromMarshal:ls,onCreateNewContact:xi,onEditContact:gl,onSelectIncident:ur,onReorderNotes:Ba,onReorderChecklists:Fa,onReorderContacts:Va},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","route-color","route-style","route-weight","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","role-definitions","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Pe(M7,{show:Ho.value,"checklist-item":_o.value,"initial-tab":Vo.value,areas:Pt.value,locations:M.value,marshals:oe.value,"is-dirty":qe.value,"next-display-order":Ma.value,onClose:Pn,onSave:oa,onDelete:Ns,"onUpdate:isDirty":Rt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty","next-display-order"]),Pe(j7,{show:Aa.value,note:qo.value,"initial-tab":Es.value,areas:Pt.value,locations:M.value,marshals:oe.value,"is-dirty":qe.value,onClose:Bs,onSave:yl,onDelete:kl,"onUpdate:isDirty":Rt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Pe(I1,{show:jo.value,incident:Gn.value,route:T.value?.route||[],"route-color":T.value?.routeColor||"","route-style":T.value?.routeStyle||"","route-weight":T.value?.routeWeight,checkpoints:M.value,"can-manage":!0,onClose:Ua,onStatusChange:fr,onOpenAddNote:za},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints"]),Pe(Yt,{show:Ys.value,title:"Add update",size:"small",onClose:sa},{footer:Ve(()=>[r("div",pV,[r("button",{type:"button",class:"btn btn-secondary",onClick:sa}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Ha,disabled:!io.value.trim()||Js.value},b(Js.value?"Adding...":"Add update"),9,vV)])]),default:Ve(()=>[r("div",fV,[We(r("textarea",{"onUpdate:modelValue":se[8]||(se[8]=ce=>io.value=ce),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,io.value]])])]),_:1},8,["show"]),Pe(x1,{show:os.value,"event-id":B(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:M.value,route:T.value?.route||[],"route-color":T.value?.routeColor||"","route-style":T.value?.routeStyle||"","route-weight":T.value?.routeWeight,onClose:se[9]||(se[9]=ce=>os.value=!1),onSubmit:hr},null,8,["show","event-id","checkpoints","route","route-color","route-style","route-weight"]),Pe(eH,{show:Dt.value,contact:bt.value,"initial-tab":Co.value,areas:Pt.value,locations:M.value,marshals:oe.value,"available-roles":Wo.value,"role-definitions":jn.value,"is-dirty":qe.value,"prefilled-name":Cn.value,"prefilled-marshal-id":Xs.value,"create-from-area-context":!!Lo.value,onClose:ia,onSave:aa,onDelete:Bn,"onUpdate:isDirty":Rt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","role-definitions","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Pe(wH,{show:Nn.value,role:On.value,"initial-tab":ss.value,people:pt.value,"loading-people":Vt.value,"is-dirty":qe.value,onClose:Ct,onSave:ot,onDelete:gt,"onUpdate:isDirty":Rt,onLoadPeople:Xt},null,8,["show","role","initial-tab","people","loading-people","is-dirty"]),Pe(RH,{show:B(zo),mode:B(pe),"context-title":B(ve).title,"context-description":B(ve).description,"can-complete":Qs.value,clickable:B(pe)!=="draw-area","drawing-mode":B(pe)==="draw-area"&&B(an),locations:Pa.value,areas:Da.value,route:T.value?.route||[],"route-color":T.value?.routeColor||"","route-style":T.value?.routeStyle||"","route-weight":T.value?.routeWeight,"selected-area-id":bo.value,center:B(Qe),zoom:B(Ft),"highlight-location-id":wi.value,onMapClick:gr,onPolygonComplete:bn,onPolygonDrawing:pn,onDone:Cc,onCancel:Ll},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","route-color","route-style","route-weight","selected-area-id","center","zoom","highlight-location-id"]),Pe(wc,{show:He.value,title:ct.value,message:ht.value,onClose:se[10]||(se[10]=ce=>He.value=!1)},null,8,["show","title","message"]),Pe(mi,{show:B(c),title:B(d),message:B(h),"is-danger":B(f),"confirm-text":B(m),onConfirm:B(k),onCancel:B(w)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},yV=Ke(gV,[["__scopeId","data-v-efdf1f23"]]),kV={key:0,class:"emergency-notes-section"},bV={class:"emergency-notes-list"},wV={class:"note-header"},_V={key:0,class:"note-content"},CV={key:1,class:"emergency-contacts-section"},LV={class:"emergency-contacts-list"},SV={class:"contact-header"},IV={key:0,class:"role-badge"},xV={class:"contact-details"},$V={key:0,class:"info-section"},TV=["href"],MV={key:1,class:"info-section"},AV=["href"],EV={key:2,class:"info-section"},PV=["href"],DV={key:2,class:"no-contacts"},RV={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.notes?[...n.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,w=f.displayOrder||f.DisplayOrder||0;if(k!==w)return k-w;const x=h.priority||h.Priority,A=f.priority||f.Priority;return x==="Emergency"&&A!=="Emergency"?-1:A==="Emergency"&&x!=="Emergency"?1:0}):[]),i=H(()=>n.contacts?n.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,w=f.displayOrder||f.DisplayOrder||0;if(k!==w)return k-w;const x=h.name||h.Name||"",A=f.name||f.Name||"";return x.localeCompare(A,void 0,{sensitivity:"base"})}):[]),l=()=>{s("close")},c=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(p(),Ge(Yt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Ve(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[o.value.length>0?(p(),g("div",kV,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",bV,[(p(!0),g(Se,null,je(o.value,m=>(p(),g("div",{key:m.noteId||m.NoteId,class:le(["emergency-note-item",{"is-emergency":(m.priority||m.Priority)==="Emergency"}])},[r("div",wV,[r("h3",null,b(m.title||m.Title),1),r("span",{class:le(["priority-badge",(m.priority||m.Priority).toLowerCase()])},b(m.priority||m.Priority),3)]),m.content||m.Content?(p(),g("div",_V,b(m.content||m.Content),1)):P("",!0)],2))),128))])])):P("",!0),i.value&&i.value.length>0?(p(),g("div",CV,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",LV,[(p(!0),g(Se,null,je(i.value,m=>(p(),g("div",{key:m.contactId||m.name,class:"emergency-contact-item"},[r("div",SV,[r("h3",null,b(m.name),1),d(m).length>0?(p(),g("span",IV,b(d(m).map(c).join(", ")),1)):P("",!0)]),r("div",xV,[m.phone?(p(),g("div",$V,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${m.phone}`,class:"phone-link"},b(m.phone),9,TV)])):P("",!0),m.email?(p(),g("div",MV,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${m.email}`,class:"email-link"},b(m.email),9,AV)])):P("",!0),m.notes||m.details?(p(),g("div",EV,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,b(m.notes||m.details),1)])):P("",!0)]),m.phone?(p(),g("a",{key:0,href:`tel:${m.phone}`,class:"btn btn-danger btn-full"}," Call "+b(m.name),9,PV)):P("",!0)]))),128))])])):P("",!0),i.value.length===0&&o.value.length===0?(p(),g("div",DV,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},OV=Ke(RV,[["__scopeId","data-v-6ae197f1"]]),Pr=D(navigator.onLine),ba=D(!0),ci=D(0),jc=D(null),Wi=D("idle"),Xl=D(null),sf=D(!1);let ym=null,bh=!1,ks=null,km=0;function NV(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Pu(){ks&&(clearTimeout(ks),ks=null);const e=NV(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),ks=setTimeout(async()=>{if(ks=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await _u()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Du();const n=await _u();n>0&&navigator.onLine&&(console.log(`${n} actions remaining, scheduling retry...`),Pu())},e)}async function jl(){if(!navigator.onLine)return ba.value=!1,!1;try{return await xC.check(),ba.value=!0,!0}catch(e){return e.response?.status===404?(ba.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),ba.value=!1,!1)}}async function Hf(){const e=Date.now();if(e-km<2e3)return;km=e;const t=navigator.onLine;if(Pr.value=t,!t){ba.value=!1;return}sf.value=!0;try{await jl()&&ci.value>0&&Pu()}finally{sf.value=!1}}function bm(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),Hf())}function wm(){console.log("Window focused, checking connectivity..."),Hf()}async function BV(e){try{switch(e.type){case"checkin":await hi.checkIn(e.payload);break;case"checkin_toggle":await hi.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await hi.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Ot.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Ot.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const n=t.response.data?.message||t.response.data||"",s=typeof n=="string"?n.toLowerCase():"";if(s.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(s.includes("already completed")||s.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Du(){if(!bh&&navigator.onLine){bh=!0,Wi.value="syncing",Xl.value=null;try{const e=await Vy();if(e.length===0){Wi.value="success",ci.value=0;return}let t=0,n=0;for(const s of e){const o=await BV(s);if(o===!0)await _v(s.id),t++;else if(o==="permanent_failure")await _v(s.id),n++;else{const i=(s.attempts||0)+1;i>=5?(await wv(s.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),n++):await wv(s.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ci.value=await _u(),n>0?(Wi.value="error",Xl.value=`${n} action(s) failed to sync`):Wi.value="success"}catch(e){console.error("Sync error:",e),Wi.value="error",Xl.value="Failed to sync pending actions"}finally{bh=!1}}}function FV(){ym||(ym=setInterval(async()=>{navigator.onLine&&(await jl(),ba.value&&ci.value>0&&await Du())},3e4))}function Vf(){const e=H(()=>Pr.value&&ba.value);async function t(){ci.value=await _u()}async function n(){Pr.value=!0,await jl()&&ci.value>0&&Pu()}function s(){Pr.value=!1,ba.value=!1,ks&&(clearTimeout(ks),ks=null)}cn(async()=>{await $a(),await t(),window.addEventListener("online",n),window.addEventListener("offline",s),document.addEventListener("visibilitychange",bm),window.addEventListener("focus",wm),navigator.onLine&&await jl()&&ci.value>0&&Pu(),FV()}),In(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s),document.removeEventListener("visibilitychange",bm),window.removeEventListener("focus",wm),ks&&(clearTimeout(ks),ks=null)});async function o(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await lc(d,f),jc.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await di(d);return h&&(jc.value=h.cachedAt),h}async function l(d){jc.value=await kC(d)}async function c(){return navigator.onLine?await jl()?(await Du(),Wi.value==="success"):(Xl.value="Server is not responding",!1):(Xl.value="Cannot sync while offline",!1)}return{isOnline:Pr,isServerHealthy:ba,isFullyOnline:e,isCheckingStatus:sf,pendingActionsCount:ci,lastSyncTime:jc,syncStatus:Wi,syncError:Xl,checkServerHealth:jl,quickConnectivityCheck:Hf,syncPendingActions:Du,updatePendingCount:t,refreshCache:o,getCachedData:i,loadLastSyncTime:l,forcSync:c}}const UV={class:"offline-indicator-container"},zV={class:"offline-icon"},HV={key:0,viewBox:"0 0 24 24",fill:"currentColor"},VV={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},GV={class:"offline-text"},qV={key:0,class:"last-sync"},jV={class:"pending-text"},WV={key:0,class:"pending-subtext"},ZV={key:1,class:"syncing-text"},KV={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:n,isCheckingStatus:s,pendingActionsCount:o,lastSyncTime:i,syncStatus:l,syncError:c,forcSync:d}=Vf(),h=D(!1),f=D(""),m=D(""),y=H(()=>{if(!i.value)return"";const w=new Date(i.value),A=new Date-w,E=Math.floor(A/6e4),_=Math.floor(E/60);return E<1?"just now":E<60?`${E}m ago`:_<24?`${_}h ago`:w.toLocaleDateString()}),k=async()=>{await d()};return Ye(l,w=>{w==="success"&&o.value===0?(f.value="All actions synced successfully!",m.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):w==="error"&&(f.value=c.value||"Sync failed",m.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(w,x)=>(p(),g("div",UV,[Pe(Ls,{name:"slide"},{default:Ve(()=>[B(n)?P("",!0):(p(),g("div",{key:0,class:le(["offline-banner",{checking:B(s)}])},[r("span",zV,[B(s)?(p(),g("svg",VV,[...x[1]||(x[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(p(),g("svg",HV,[...x[0]||(x[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",GV,b(B(s)?"Checking connection...":B(t)?"Server unavailable":"You're offline"),1),B(i)&&!B(s)?(p(),g("span",qV," Last synced: "+b(y.value),1)):P("",!0)],2))]),_:1}),Pe(Ls,{name:"fade"},{default:Ve(()=>[B(o)>0?(p(),g("div",{key:0,class:le(["pending-banner",{"offline-pending":!B(n)}])},[x[2]||(x[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",jV,[Je(b(B(o))+" pending action"+b(B(o)!==1?"s":"")+" ",1),B(n)?P("",!0):(p(),g("span",WV,"(will sync when online)"))]),B(n)&&B(l)!=="syncing"?(p(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):B(l)==="syncing"?(p(),g("span",ZV,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Pe(Ls,{name:"fade"},{default:Ve(()=>[h.value?(p(),g("div",{key:0,class:le(["sync-toast",m.value])},b(f.value),3)):P("",!0)]),_:1})]))}},YV=Ke(KV,[["__scopeId","data-v-9c1e58f4"]]),JV={class:"modal-content check-in-reminder-modal"},XV={class:"modal-header warning"},QV={class:"modal-body"},eG={class:"reminder-message"},tG={key:0},nG={class:"reminder-hint"},oG={class:"modal-footer"},sG={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=dt();return(n,s)=>(p(),Ge(Ls,{name:"modal"},{default:Ve(()=>[e.show&&e.checkpoint?(p(),g("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=rt(o=>n.$emit("dismiss"),["self"]))},[r("div",JV,[r("div",XV,[s[4]||(s[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:s[0]||(s[0]=o=>n.$emit("dismiss"))},"")]),r("div",QV,[s[6]||(s[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",eG,[Je(" You have not checked in yet to "+b(B(t).checkpoint)+" ",1),r("strong",null,b(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(p(),g("span",tG," - "+b(e.checkpoint.location.description),1)):P("",!0),s[5]||(s[5]=Je(". ",-1))]),r("p",nG," Please check in when you arrive at your "+b(B(t).checkpoint)+". ",1)]),r("div",oG,[r("button",{onClick:s[1]||(s[1]=o=>n.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:s[2]||(s[2]=o=>n.$emit("go-to-checkpoint")),class:"btn btn-primary",style:tt(e.accentButtonStyle)}," Go to "+b(B(t).checkpoint),5)])])])):P("",!0)]),_:1}))}},aG=Ke(sG,[["__scopeId","data-v-4761fdb9"]]),iG={class:"modal-content location-update-modal"},lG={class:"modal-header"},rG={class:"modal-body"},cG={key:0,class:"success-message"},uG={key:1},dG={class:"modal-description"},hG={key:0,class:"last-update-info"},fG={key:1,class:"gps-status active"},pG={class:"update-option"},vG=["disabled"],mG={class:"update-option auto-update-option"},gG={class:"checkbox-label"},yG=["checked"],kG={class:"option-hint"},bG={class:"update-option"},wG=["disabled"],_G={class:"update-option"},CG={class:"option-label"},LG={key:0,class:"checkpoint-list"},SG=["onClick","disabled"],IG={class:"checkpoint-name"},xG={key:0,class:"checkpoint-description"},$G={key:1,class:"no-checkpoints"},TG={key:2,class:"error"},MG={class:"modal-footer"},AG={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=dt(),n=o=>o?new Date(o).toLocaleString():"",s=(o,i=50)=>o?o.length<=i?o:o.substring(0,i).trim()+"...":"";return(o,i)=>(p(),Ge(Ls,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=rt(l=>o.$emit("close"),["self"]))},[r("div",iG,[r("div",lG,[r("h3",null,"Update "+b(B(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>o.$emit("close"))},"")]),r("div",rG,[e.success?(p(),g("div",cG,b(e.success),1)):(p(),g("div",uG,[r("p",dG,[i[6]||(i[6]=Je(" Update the position of ",-1)),r("strong",null,b(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(p(),g("div",hG," Last updated: "+b(n(e.assignment.location.lastLocationUpdate)),1)):P("",!0),e.userLocation?(p(),g("div",fG,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):P("",!0),r("div",pG,[r("button",{onClick:i[1]||(i[1]=l=>o.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:tt(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+b(e.updating?"Updating...":"Use current GPS location"),1)],12,vG)]),r("div",mG,[r("label",gG,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>o.$emit("toggle-auto-update"))},null,40,yG),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",kG,"Automatically updates the "+b(B(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",bG,[r("button",{onClick:i[3]||(i[3]=l=>o.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,wG)]),r("div",_G,[r("label",CG,"Or copy location from another "+b(B(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(p(),g("div",LG,[(p(!0),g(Se,null,je(e.availableCheckpoints,l=>(p(),g("button",{key:l.id,onClick:c=>o.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",IG,b(l.name),1),l.description?(p(),g("span",xG,b(s(l.description)),1)):P("",!0)],8,SG))),128))])):(p(),g("p",$G," No other "+b(B(t).checkpoints)+" available to copy from. ",1))]),e.error?(p(),g("div",TG,b(e.error),1)):P("",!0)]))]),r("div",MG,[r("button",{onClick:i[4]||(i[4]=l=>o.$emit("close")),class:"btn btn-secondary"},b(e.success?"Ok":"Cancel"),1)])])])):P("",!0)]),_:1}))}},EG=Ke(AG,[["__scopeId","data-v-b3924a32"]]),PG={class:"contact-info"},DG={class:"contact-name-row"},RG={key:0,class:"primary-badge"},OG={class:"contact-name"},NG={key:0,class:"contact-notes-text"},BG={key:1,class:"contact-detail"},FG={key:2,class:"contact-detail"},UG={class:"contact-actions"},zG=["href"],HG=["href"],VG=["href"],GG={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),s=["Emergency","Safety","Medical","First Aid"],o=H(()=>n.value.length===0?!1:n.value.some(c=>s.some(d=>c.toLowerCase().includes(d.toLowerCase())))),i=c=>c?c.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=H(()=>n.value.length===0?"":n.value.map(i).join(", "));return(c,d)=>(p(),g("div",{class:le(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",PG,[r("div",DG,[e.isPrimary?(p(),g("span",RG,"")):P("",!0),r("span",OG,b(e.name),1),n.value.length>0?(p(),g("span",{key:1,class:le(["contact-role-badge",{"emergency-role":o.value}])},b(l.value),3)):P("",!0)]),e.notes?(p(),g("div",NG,b(e.notes),1)):P("",!0),e.phone?(p(),g("div",BG,b(e.phone),1)):P("",!0),e.email?(p(),g("div",FG,b(e.email),1)):P("",!0)]),r("div",UG,[e.phone?(p(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,zG)):P("",!0),e.phone?(p(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,HG)):P("",!0),e.email?(p(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,VG)):P("",!0)])],2))}},$1=Ke(GG,[["__scopeId","data-v-2fdc8dea"]]),qG={key:0,class:"accordion-section"},jG={class:"accordion-title"},WG=["innerHTML"],ZG={key:0,class:"header-count"},KG={class:"accordion-icon"},YG={key:0,class:"accordion-content"},JG={key:0,class:"loading"},XG={key:1,class:"contact-list"},QG={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.contacts.length>0||e.loading?(p(),g("div",qG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",jG,[r("span",{class:"section-icon",innerHTML:B(so)("contacts")},null,8,WG),Je(" Your "+b(e.contacts.length===1?"contact":"contacts"),1),e.contacts.length>1?(p(),g("span",ZG," ("+b(e.contacts.length)+")",1)):P("",!0)]),r("span",KG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",YG,[e.loading?(p(),g("div",JG,"Loading contacts...")):(p(),g("div",XG,[(p(!0),g(Se,null,je(e.contacts,s=>(p(),Ge($1,{key:s.contactId,name:s.name,roles:s.roles,role:s.role,phone:s.phone,email:s.email,notes:s.notes,"is-primary":s.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):P("",!0)])):P("",!0)}},eq=Ke(QG,[["__scopeId","data-v-87bba6dd"]]),tq={key:0,class:"accordion-section"},nq={class:"accordion-title"},oq=["innerHTML"],sq={key:0,class:"header-count"},aq={class:"accordion-icon"},iq={key:0,class:"accordion-content"},lq={key:0,class:"loading-state"},rq={key:1,class:"empty-state"},cq={key:2,class:"incidents-list"},uq={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,n)=>e.incidents.length>0||e.loading?(p(),g("div",tq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",nq,[r("span",{class:"section-icon",innerHTML:B(so)("incidents")},null,8,oq),Je(" Your "+b(e.incidents.length===1?"incident":"incidents"),1),e.incidents.length>1?(p(),g("span",sq," ("+b(e.incidents.length)+")",1)):P("",!0)]),r("span",aq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",iq,[e.loading?(p(),g("div",lq," Loading incidents... ")):e.incidents.length===0?(p(),g("div",rq,[...n[1]||(n[1]=[r("p",null,"No incidents to show.",-1)])])):(p(),g("div",cq,[(p(!0),g(Se,null,je(e.incidents,s=>(p(),Ge(kc,{key:s.incidentId,incident:s,onSelect:o=>t.$emit("select-incident",s)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0)}},dq=Ke(uq,[["__scopeId","data-v-8a5966fd"]]),hq={key:0,class:"accordion-section"},fq={class:"accordion-title"},pq=["innerHTML"],vq={class:"accordion-icon"},mq={key:0,class:"accordion-content"},gq={class:"event-details"},yq={key:0,class:"event-detail-row"},kq={class:"detail-value"},bq={key:1,class:"event-description"},wq={class:"detail-value"},_q={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=n=>n?new Date(n).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(n,s)=>e.eventDate||e.description?(p(),g("div",hq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:s[0]||(s[0]=o=>n.$emit("toggle"))},[r("span",fq,[r("span",{class:"section-icon",innerHTML:B(so)("event")},null,8,pq),s[1]||(s[1]=Je(" Event details ",-1))]),r("span",vq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",mq,[r("div",gq,[e.eventDate?(p(),g("div",yq,[s[2]||(s[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",kq,b(t(e.eventDate)),1)])):P("",!0),e.description?(p(),g("div",bq,[s[3]||(s[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",wq,b(e.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)}},Cq=Ke(_q,[["__scopeId","data-v-7c880ad1"]]),Lq={class:"accordion-section"},Sq={class:"accordion-title"},Iq=["innerHTML"],xq={class:"header-count"},$q={class:"header-count"},Tq={class:"accordion-icon"},Mq={key:0,class:"accordion-content"},Aq={key:0,class:"loading"},Eq={key:1,class:"error"},Pq={key:2,class:"empty-state"},Dq={class:"checklist-section"},Rq={class:"checklist-section-title"},Oq={key:0,class:"empty-state small"},Nq={key:1,class:"my-jobs-list"},Bq=["checked","disabled","onChange"],Fq={class:"my-job-content"},Uq={key:0,class:"context-info"},zq={key:1,class:"completion-info"},Hq={class:"completion-text"},Vq={class:"completion-time"},Gq={key:0,class:"checklist-section"},qq={class:"checklist-section-title"},jq={key:0,class:"checklist-items"},Wq={class:"item-checkbox"},Zq=["checked","disabled","onChange"],Kq={class:"item-content"},Yq={key:0,class:"item-context"},Jq={key:1,class:"completion-info"},Xq={class:"completion-text"},Qq={class:"completion-time"},ej={key:1,class:"checklist-groups"},tj=["onClick"],nj={class:"group-title"},oj={class:"group-status"},sj={class:"group-count"},aj={class:"group-expand-icon"},ij={key:0,class:"checklist-group-items"},lj={class:"item-checkbox"},rj=["checked","disabled","onChange"],cj={class:"item-content"},uj={key:0,class:"completion-info"},dj={class:"completion-text"},hj={class:"completion-time"},fj={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},ledAreaCount:{type:Number,default:1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=dt(),n=e,s=H(()=>n.ledAreaCount===1?t.value.area:t.value.areas),o=H(()=>n.ledAreaCount===1?`${t.value.area}'s`:`${t.value.areas}'`),i=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],l=H(()=>{let A=0;const E=new Set;for(const _ of n.myItems)if(i.includes(_.matchedScope)&&_.completionContextId){const C=`${_.itemId}_${_.completionContextId}`;E.has(C)||(E.add(C),A++)}else A++;return A}),c=H(()=>{let A=0;const E=new Set;for(const _ of n.myItems)if(i.includes(_.matchedScope)&&_.completionContextId){const C=`${_.itemId}_${_.completionContextId}`;E.has(C)||(E.add(C),_.isCompleted&&A++)}else _.isCompleted&&A++;return A}),d=H(()=>l.value-c.value),h=H(()=>{let A=0;const E=new Set;for(const _ of n.visibleItems)if(i.includes(_.matchedScope)&&_.completionContextId){const C=`${_.itemId}_${_.completionContextId}`;E.has(C)||(E.add(C),_.isCompleted||A++)}else _.isCompleted||A++;return A}),f=H(()=>{let A=0;const E=new Set;for(const _ of n.areaItems)if(i.includes(_.matchedScope)&&_.completionContextId){const C=`${_.itemId}_${_.completionContextId}`;E.has(C)||(E.add(C),n.areaItems.some($=>$.itemId===_.itemId&&$.completionContextId===_.completionContextId&&$.isCompleted)||A++)}else _.isCompleted||A++;return A}),m=A=>{if(!A)return"";const E=new Date(A),S=(new Date-E)/(1e3*60*60);return S<24&&S>=0?E.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):E.toLocaleString()},y=A=>A.completedByActorName&&A.contextOwnerName&&A.completedByActorName!==A.contextOwnerName?`${A.completedByActorName} on behalf of ${A.contextOwnerName}`:A.completedByActorName||"Unknown",k=A=>{if(A.completionContextType==="Checkpoint"&&A.completionContextId){const E=n.locations.find(_=>_.id===A.completionContextId);if(E){if(E.description){const C=E.description.length>50?E.description.substring(0,50)+"...":E.description;return`${E.name} - ${C}`}return E.name}}if(A.completionContextType==="Area"&&A.completionContextId){const E=n.areas.find(_=>_.id===A.completionContextId);if(E)return E.name}return""},w=A=>A.completionContextType==="Checkpoint"&&A.completionContextId?n.locations.find(_=>_.id===A.completionContextId)?.name||"":A.completionContextType==="Area"&&A.completionContextId&&n.areas.find(_=>_.id===A.completionContextId)?.name||"",x=H(()=>{if(!n.myItems||n.myItems.length===0)return[];const A=new Map;for(const _ of n.myItems)A.set(_.text,(A.get(_.text)||0)+1);return s1(n.myItems,w).map(_=>({..._,needsDisambiguation:A.get(_.text)>1,contextDisplayName:k(_)}))});return(A,E)=>(p(),g("div",Lq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:E[0]||(E[0]=_=>A.$emit("toggle"))},[r("span",Sq,[r("span",{class:"section-icon",innerHTML:B(so)("checklist")},null,8,Iq),e.isAreaLead?(p(),g(Se,{key:0},[Je(" Your "+b(B(t).checklists)+" ",1),r("span",xq,"(You: "+b(d.value)+", Your "+b(s.value)+": "+b(f.value)+")",1)],64)):(p(),g(Se,{key:1},[Je(" Your "+b(B(t).checklists)+" ",1),r("span",$q,"("+b(h.value)+")",1)],64))]),r("span",Tq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Mq,[e.loading?(p(),g("div",Aq,"Loading checklist...")):e.error?(p(),g("div",Eq,b(e.error),1)):l.value===0&&(!e.isAreaLead||e.areaItems.length===0)?(p(),g("div",Pq,[r("p",null,"No "+b(B(t).checklists)+" for you.",1)])):e.isAreaLead?(p(),g(Se,{key:3},[r("div",Dq,[r("h4",Rq,"Your "+b(B(t).checklists),1),x.value.length===0?(p(),g("div",Oq,[r("p",null,"No "+b(B(t).checklists)+" assigned to you.",1)])):(p(),g("div",Nq,[(p(!0),g(Se,null,je(x.value,_=>(p(),g("div",{key:`${_.itemId}_${_.completionContextType}_${_.completionContextId}`,class:le(["my-job-item",{"item-completed":_.isCompleted}])},[r("input",{type:"checkbox",checked:_.isCompleted,disabled:e.saving||!_.canBeCompletedByMe,onChange:C=>A.$emit("toggle-item",_)},null,40,Bq),r("div",Fq,[r("span",{class:le(["my-job-text",{completed:_.isCompleted}])},b(_.text),3),_.needsDisambiguation&&_.contextDisplayName?(p(),g("div",Uq,b(_.contextDisplayName),1)):P("",!0),_.isCompleted&&_.completedByActorName?(p(),g("div",zq,[r("span",Hq,b(y(_)),1),r("span",Vq,b(m(_.completedAt)),1)])):P("",!0)])],2))),128))]))]),e.areaItems.length>0?(p(),g("div",Gq,[r("h4",qq,"Your "+b(o.value)+" "+b(B(t).checklists),1),Pe(zf,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:E[1]||(E[1]=_=>A.$emit("toggle-item",_))},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(p(),g(Se,{key:4},[e.effectiveGroupBy==="none"?(p(),g("div",jq,[(p(!0),g(Se,null,je(e.visibleItems,_=>(p(),g("div",{key:`${_.itemId}_${_.completionContextType}_${_.completionContextId}`,class:le(["checklist-item",{"item-completed":_.isCompleted}])},[r("div",Wq,[r("input",{type:"checkbox",checked:_.isCompleted,disabled:!_.canBeCompletedByMe||e.saving,onChange:C=>A.$emit("toggle-item",_)},null,40,Zq)]),r("div",Kq,[r("div",{class:le(["item-text",{"text-completed":_.isCompleted}])},b(_.text),3),e.getContextName(_)?(p(),g("div",Yq,b(e.getContextName(_)),1)):P("",!0),_.isCompleted?(p(),g("div",Jq,[r("span",Xq,b(y(_)),1),r("span",Qq,b(m(_.completedAt)),1)])):P("",!0)])],2))),128))])):(p(),g("div",ej,[(p(!0),g(Se,null,je(e.groupedItems,_=>(p(),g("div",{key:_.key,class:"checklist-group"},[r("button",{class:le(["checklist-group-header",{expanded:e.expandedGroup===_.key,"all-complete":_.completedCount===_.items.length}]),onClick:C=>A.$emit("toggle-group",_.key)},[r("span",nj,b(_.name),1),r("span",oj,[r("span",sj,b(_.completedCount)+"/"+b(_.items.length),1),r("span",aj,b(e.expandedGroup===_.key?"":"+"),1)])],10,tj),e.expandedGroup===_.key?(p(),g("div",ij,[(p(!0),g(Se,null,je(_.items,C=>(p(),g("div",{key:`${C.itemId}_${C.completionContextType}_${C.completionContextId}`,class:le(["checklist-item",{"item-completed":C.isCompleted}])},[r("div",lj,[r("input",{type:"checkbox",checked:C.isCompleted,disabled:!C.canBeCompletedByMe||e.saving,onChange:S=>A.$emit("toggle-item",C)},null,40,rj)]),r("div",cj,[r("div",{class:le(["item-text",{"text-completed":C.isCompleted}])},b(C.text),3),C.isCompleted?(p(),g("div",uj,[r("span",dj,b(y(C)),1),r("span",hj,b(m(C.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]))}},pj=Ke(fj,[["__scopeId","data-v-b4d5587d"]]),vj={class:"accordion-section"},mj={class:"accordion-title"},gj=["innerHTML"],yj={key:0,class:"header-count"},kj={class:"accordion-icon"},bj={key:0,class:"accordion-content"},wj={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,n)=>(p(),g("div",vj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",mj,[r("span",{class:"section-icon",innerHTML:B(so)("notes")},null,8,gj),Je(" Your "+b(e.notes.length===1?"note":"notes"),1),e.notes.length>1?(p(),g("span",yj," ("+b(e.notes.length)+")",1)):P("",!0)]),r("span",kj,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",bj,[Pe(ld,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:n[1]||(n[1]=s=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]))}},_j=Ke(wj,[["__scopeId","data-v-ef145eb9"]]),Cj={class:"accordion-section"},Lj={class:"accordion-title"},Sj=["innerHTML"],Ij={key:0,class:"location-status active"},xj={key:1,class:"location-status"},$j={class:"accordion-icon"},Tj={key:0,class:"accordion-content map-content"},Mj={key:0,class:"map-selection-banner"},Aj={class:"map-wrapper"},Ej={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:n}=dt(),s=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),o=ol({headerStyle:H(()=>ru(s.headerStyle)),headerTextColor:H(()=>ru(s.headerTextColor))}),i=D(null);return t({mapRef:i,recenterOnLocation:(l,c,d)=>i.value?.recenterOnLocation?.(l,c,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,c)=>(p(),g("div",Cj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:c[0]||(c[0]=d=>l.$emit("toggle"))},[r("span",Lj,[r("span",{class:"section-icon",innerHTML:B(so)("course")},null,8,Sj),Je(" "+b(B(n).course)+" ",1),e.userLocation?(p(),g("span",Ij,"GPS Active")):(p(),g("span",xj,"GPS Inactive"))]),r("span",$j,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Tj,[e.selectingLocation?(p(),g("div",Mj,[r("span",null,[c[7]||(c[7]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),r("div",Aj,[Pe(al,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!1,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":B(n).course,"fullscreen-header-style":o.headerStyle,"fullscreen-header-text-color":o.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:le({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:c[3]||(c[3]=d=>l.$emit("map-click",d)),onLocationClick:c[4]||(c[4]=d=>l.$emit("location-click",d)),onActionClick:c[5]||(c[5]=d=>l.$emit("action-click",d)),onVisibilityChange:c[6]||(c[6]=d=>l.$emit("visibility-change",d))},kf({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ve(()=>[r("span",null,[c[8]||(c[8]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[2]||(c[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]))}},Pj=Ke(Ej,[["__scopeId","data-v-ff7cc2e4"]]),Dj={class:"area-lead-content"},Rj={key:0,class:"loading-state"},Oj={key:1,class:"error-state"},Nj={key:2,class:"empty-state"},Bj={key:3,class:"checkpoint-accordion"},Fj=["onClick"],Uj={class:"checkpoint-header-content"},zj={class:"checkpoint-title-row"},Hj={class:"checkpoint-name"},Vj={key:0,class:"area-badge"},Gj={key:0,class:"checkpoint-description-preview"},qj={class:"checkpoint-status-row"},jj={class:"status-badge marshals-status"},Wj={key:0,class:"status-badge tasks-status"},Zj={class:"accordion-icon"},Kj={key:0,class:"checkpoint-accordion-content"},Yj={class:"checkpoint-mini-map"},Jj={class:"checkpoint-marshals-section"},Xj={class:"marshals-label"},Qj={key:0,class:"empty-state"},eW={key:1,class:"marshals-list"},tW=["onClick"],nW={class:"marshal-header"},oW={class:"marshal-name-row"},sW={class:"marshal-name"},aW={key:0,class:"task-count"},iW={class:"check-status-row"},lW=["onClick","disabled"],rW={key:0,class:"check-in-time"},cW={key:0},uW={key:1,class:"last-access-time"},dW={key:0,class:"checkpoint-tasks-section"},hW={class:"marshals-label"},fW={class:"tasks-list"},pW=["disabled","onChange"],vW={class:"task-text"},mW=["disabled","onChange"],gW={class:"task-text"},yW={key:0,class:"marshal-details-modal"},kW={class:"details-section"},bW={class:"contact-info"},wW={key:0,class:"contact-row"},_W=["href"],CW={key:1,class:"contact-row"},LW=["href"],SW={key:2,class:"no-contact"},IW={class:"details-section"},xW={key:0,class:"checked-in-section"},$W={class:"checked-in-details"},TW={class:"check-time-detail"},MW={key:0,class:"check-method"},AW=["disabled"],EW={key:1,class:"not-checked-in-section"},PW=["disabled"],DW={key:2,class:"last-access-detail"},RW={class:"details-section"},OW={key:0,class:"no-tasks"},NW={key:1,class:"tasks-list modal-tasks"},BW=["disabled","onChange"],FW={class:"task-text"},UW={class:"details-section contact-actions-section"},zW={class:"contact-buttons"},HW=["href"],VW=["href"],GW=["href"],qW={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),{updatePendingCount:i}=Vf(),l=e,c=n,d=D(!1),h=D(null),f=D([]),m=D([]),y=D(null),k=D(!1),w=D(null),x=H(()=>{const q=new Set(l.areaIds);return q.size===0?[...m.value].sort((Y,te)=>Qo(Y.name,te.name)):m.value.filter(Y=>(Y.areaIds||[]).some(ue=>q.has(ue))).sort((Y,te)=>Qo(Y.name,te.name))}),A=(q,Y=60)=>q?q.length<=Y?q:q.substring(0,Y).trim()+"...":"",E=D(!1),_=D(null),C=D(null),S=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,Jn()){try{const q=await di(l.eventId);if(q?.areaLeadDashboard){f.value=q.areaLeadDashboard.areas||[],m.value=q.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(q){console.warn("Failed to load cached dashboard:",q)}h.value="Offline - no cached data available",d.value=!1;return}try{const q=await ga.getAreaLeadDashboard(l.eventId);f.value=q.data.areas||[],m.value=q.data.checkpoints||[];try{const Y=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await di(l.eventId)?await eu(l.eventId,"areaLeadDashboard",Y):await lc(l.eventId,{areaLeadDashboard:Y})}catch(Y){console.warn("Failed to cache dashboard:",Y)}}catch(q){console.error("Failed to load area lead dashboard:",q);try{const Y=await di(l.eventId);if(Y?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Y.areaLeadDashboard.areas||[],m.value=Y.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Y){console.warn("Failed to load cached dashboard:",Y)}h.value=q.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},$=q=>{y.value=y.value===q?null:q},R=q=>q.marshals.filter(Y=>Y.isCheckedIn).length,T=q=>{const Y=q.marshals.reduce((te,ue)=>te+ue.outstandingTaskCount,0);return q.outstandingTaskCount+Y},O=(q,Y)=>{_.value=q,C.value=Y,E.value=!0},M=()=>{E.value=!1,_.value=null,C.value=null},U=async(q,Y)=>{if(w.value)return;const te=q.assignmentId||q.id;if(!te){console.error("No assignment ID found for marshal:",q);return}w.value=q.marshalId;try{if(Jn())await Oo("checkin_toggle",{eventId:l.eventId,assignmentId:te}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated");else if(await hi.toggleCheckIn(l.eventId,te),await S(),c("checkin-updated"),_.value?.marshalId===q.marshalId&&C.value){const ue=m.value.find(_e=>_e.checkpointId===C.value.checkpointId);if(ue){const _e=ue.marshals.find($e=>$e.marshalId===q.marshalId);_e&&(_.value=_e)}}}catch(ue){console.error("Failed to check in marshal:",ue),(Jn()||!ue.response)&&(await Oo("checkin_toggle",{eventId:l.eventId,assignmentId:te}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated"))}finally{w.value=null}},F=async(q,Y)=>{if(k.value)return;k.value=!0;const ue={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId};try{Jn()?(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.outstandingTasks=Y.outstandingTasks.filter(_e=>_e.itemId!==q.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),c("checklist-updated")):(await Ot.complete(l.eventId,q.itemId,ue),await S(),c("checklist-updated"))}catch(_e){console.error("Failed to complete task:",_e),(Jn()||!_e.response)&&(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.outstandingTasks=Y.outstandingTasks.filter($e=>$e.itemId!==q.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},j=async(q,Y)=>{if(k.value)return;k.value=!0;const ue={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId,actorMarshalId:l.marshalId};try{Jn()?(await Oo("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(_e=>_e.itemId!==q.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(q),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),c("checklist-updated")):(await Ot.uncomplete(l.eventId,q.itemId,ue),await S(),c("checklist-updated"))}catch(_e){console.error("Failed to uncomplete task:",_e),(Jn()||!_e.response)&&(await Oo("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter($e=>$e.itemId!==q.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(q),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),c("checklist-updated"))}finally{k.value=!1}},Z=async q=>{if(k.value||!_.value)return;k.value=!0;const Y={marshalId:_.value.marshalId,contextType:q.contextType,contextId:q.contextId};try{if(Jn())await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:Y}),_.value.outstandingTasks=_.value.outstandingTasks.filter(te=>te.itemId!==q.itemId),_.value.outstandingTaskCount=Math.max(0,_.value.outstandingTaskCount-1),await i(),c("checklist-updated");else{if(await Ot.complete(l.eventId,q.itemId,Y),await S(),_.value&&C.value){const te=m.value.find(ue=>ue.checkpointId===C.value.checkpointId);if(te){const ue=te.marshals.find(_e=>_e.marshalId===_.value.marshalId);ue&&(_.value=ue)}}c("checklist-updated")}}catch(te){console.error("Failed to complete task:",te),(Jn()||!te.response)&&(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:Y}),_.value.outstandingTasks=_.value.outstandingTasks.filter(ue=>ue.itemId!==q.itemId),_.value.outstandingTaskCount=Math.max(0,_.value.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},Q=q=>q?new Date(q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",re=q=>{if(!q)return"";const Y=new Date(q),_e=(new Date-Y)/(1e3*60*60);return _e<24&&_e>=0?Y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Y.toLocaleString()},K=q=>{if(!q)return"";const Y=new Date(q),ue=new Date-Y,_e=Math.floor(ue/6e4),$e=Math.floor(_e/60),De=Math.floor($e/24);return _e<1?"just now":_e<60?`${_e}m ago`:$e<24?`${$e}h ago`:De===1?"yesterday":De<7?`${De}d ago`:Y.toLocaleDateString()},ae=q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${s.value.area} Lead`})[q]||q;return t({areas:f,checkpoints:m,loading:d,loadDashboard:S}),Ye(()=>l.eventId,()=>{S()},{immediate:!0}),(q,Y)=>(p(),g("div",Dj,[d.value?(p(),g("div",Rj," Loading dashboard... ")):h.value?(p(),g("div",Oj,[r("p",null,b(h.value),1),r("button",{onClick:S,class:"btn btn-secondary"},"Retry")])):x.value.length===0?(p(),g("div",Nj,[r("p",null,"No "+b(B(o).checkpoints)+" in your "+b(B(o).areas)+".",1)])):(p(),g("div",Bj,[(p(!0),g(Se,null,je(x.value,te=>(p(),g("div",{key:te.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:le(["checkpoint-accordion-header",{active:y.value===te.checkpointId}]),onClick:ue=>$(te.checkpointId)},[r("div",Uj,[r("div",zj,[r("span",Hj,b(te.name),1),te.areaName?(p(),g("span",Vj,b(te.areaName),1)):P("",!0)]),te.description?(p(),g("div",Gj,b(A(te.description)),1)):P("",!0),r("div",qj,[r("span",jj,b(R(te))+" / "+b(te.marshals.length)+" checked in ",1),T(te)>0?(p(),g("span",Wj,b(T(te))+" tasks ",1)):P("",!0)])]),r("span",Zj,b(y.value===te.checkpointId?"":"+"),1)],10,Fj),y.value===te.checkpointId?(p(),g("div",Kj,[r("div",Yj,[Pe(al,{locations:[{id:te.checkpointId,name:te.name,description:te.description,latitude:te.latitude,longitude:te.longitude}],route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:te.latitude,lng:te.longitude},zoom:16,"highlight-location-id":te.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","route-color","route-style","route-weight","center","highlight-location-id"])]),r("div",Jj,[r("div",Xj,b(B(s).people)+" ("+b(te.marshals.length)+")",1),te.marshals.length===0?(p(),g("div",Qj," No "+b(B(o).people)+" assigned to this "+b(B(o).checkpoint)+". ",1)):(p(),g("div",eW,[(p(!0),g(Se,null,je(te.marshals,ue=>(p(),g("div",{key:ue.marshalId,class:le(["marshal-card",{"is-checked-in":ue.isCheckedIn}]),onClick:_e=>O(ue,te)},[r("div",nW,[r("div",oW,[r("span",sW,b(ue.name),1),ue.outstandingTaskCount>0?(p(),g("span",aW,b(ue.outstandingTaskCount)+" tasks ",1)):P("",!0)]),r("div",iW,[r("div",{class:le(["check-status",{"checked-in":ue.isCheckedIn}])},b(ue.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:rt(_e=>U(ue),["stop"]),class:le(["quick-checkin-btn",{"undo-btn":ue.isCheckedIn}]),disabled:w.value===ue.marshalId},b(w.value===ue.marshalId?"...":ue.isCheckedIn?"Undo":"Check In"),11,lW)])]),ue.isCheckedIn&&ue.checkInTime?(p(),g("div",rW,[Je(b(Q(ue.checkInTime))+" ",1),ue.checkInMethod?(p(),g("span",cW," ("+b(ae(ue.checkInMethod))+")",1)):P("",!0)])):P("",!0),ue.lastAccessedAt?(p(),g("div",uW," Last active: "+b(K(ue.lastAccessedAt)),1)):P("",!0)],10,tW))),128))]))]),te.outstandingTaskCount>0||te.completedTasks&&te.completedTasks.length>0?(p(),g("div",dW,[r("div",hW,b(B(s).checkpoint)+" tasks",1),r("div",fW,[(p(!0),g(Se,null,je(te.outstandingTasks,ue=>(p(),g("div",{key:ue.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:_e=>F(ue,te)},null,40,pW),r("span",vW,b(ue.text),1)]))),128)),(p(!0),g(Se,null,je(te.completedTasks||[],ue=>(p(),g("div",{key:`completed-${ue.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:_e=>j(ue,te)},null,40,mW),r("span",gW,b(ue.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Pe(Yt,{show:E.value,title:_.value?.name||"Marshal Details",size:"large",onClose:M},{actions:Ve(()=>[r("button",{onClick:M,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[_.value?(p(),g("div",yW,[r("div",kW,[Y[4]||(Y[4]=r("h4",null,"Contact Details",-1)),r("div",bW,[_.value.email?(p(),g("div",wW,[Y[2]||(Y[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${_.value.email}`},b(_.value.email),9,_W)])):P("",!0),_.value.phoneNumber?(p(),g("div",CW,[Y[3]||(Y[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${_.value.phoneNumber}`},b(_.value.phoneNumber),9,LW)])):P("",!0),!_.value.email&&!_.value.phoneNumber?(p(),g("div",SW," No contact details available. ")):P("",!0)])]),r("div",IW,[Y[8]||(Y[8]=r("h4",null,"Check-in Status",-1)),_.value.isCheckedIn?(p(),g("div",xW,[r("div",$W,[Y[6]||(Y[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[Y[5]||(Y[5]=r("strong",null,"Checked In",-1)),r("p",TW,b(re(_.value.checkInTime)),1),_.value.checkInMethod?(p(),g("p",MW," Method: "+b(ae(_.value.checkInMethod)),1)):P("",!0)])]),r("button",{onClick:Y[0]||(Y[0]=te=>U(_.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:w.value===_.value.marshalId},b(w.value===_.value.marshalId?"Undoing...":"Undo Check-in"),9,AW)])):(p(),g("div",EW,[Y[7]||(Y[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:Y[1]||(Y[1]=te=>U(_.value,C.value)),class:"btn btn-primary check-in-btn",disabled:w.value===_.value.marshalId},b(w.value===_.value.marshalId?"Checking in...":"Check In"),9,PW)])),_.value.lastAccessedAt?(p(),g("div",DW," Last active: "+b(K(_.value.lastAccessedAt)),1)):P("",!0)]),r("div",RW,[r("h4",null,b(B(s).checklists)+" ("+b(_.value.outstandingTasks?.length||0)+" outstanding)",1),!_.value.outstandingTasks||_.value.outstandingTasks.length===0?(p(),g("div",OW," No outstanding tasks. ")):(p(),g("div",NW,[(p(!0),g(Se,null,je(_.value.outstandingTasks,te=>(p(),g("div",{key:te.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:ue=>Z(te)},null,40,BW),r("span",FW,b(te.text),1)]))),128))]))]),r("div",UW,[r("div",zW,[_.value.phoneNumber?(p(),g("a",{key:0,href:`tel:${_.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,HW)):P("",!0),_.value.phoneNumber?(p(),g("a",{key:1,href:`sms:${_.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,VW)):P("",!0),_.value.email?(p(),g("a",{key:2,href:`mailto:${_.value.email}`,class:"btn btn-secondary"}," Email ",8,GW)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},jW=Ke(qW,[["__scopeId","data-v-cdab7802"]]),WW={key:0,class:"accordion-section"},ZW={class:"accordion-title"},KW=["innerHTML"],YW={key:0,class:"header-count"},JW={class:"accordion-icon"},XW={key:0,class:"accordion-content area-lead-accordion-content"},QW={key:0,class:"area-filter-pills"},eZ=["onClick"],tZ={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:n}=dt(),s=D(null);return t({areaLeadRef:s}),(o,i)=>e.isAreaLead?(p(),g("div",WW,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",ZW,[r("span",{class:"section-icon",innerHTML:B(so)("area")},null,8,KW),Je(" Your "+b(e.areas.length===1?B(n).area:B(n).areas),1),e.areas.length>1?(p(),g("span",YW," ("+b(e.areas.length)+")",1)):P("",!0)]),r("span",JW,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",XW,[e.areas.length>1?(p(),g("div",QW,[(p(!0),g(Se,null,je(e.areas,l=>(p(),g("button",{key:l.areaId,class:le(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:tt(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:c=>o.$emit("toggle-filter",l.areaId)},b(l.name),15,eZ))),128))])):P("",!0),Pe(jW,{ref_key:"areaLeadRef",ref:s,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,onChecklistUpdated:i[1]||(i[1]=l=>o.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route","route-color","route-style","route-weight"])])):P("",!0)])):P("",!0)}},nZ=Ke(tZ,[["__scopeId","data-v-dfc09e28"]]),oZ={key:0,class:"accordion-section"},sZ={class:"accordion-title"},aZ=["innerHTML"],iZ={key:0,class:"header-count"},lZ={class:"accordion-icon"},rZ={key:0,class:"accordion-content area-lead-marshals-content"},cZ={class:"area-lead-marshals-list"},uZ=["onClick"],dZ={class:"marshal-header-info"},hZ={class:"marshal-name-row"},fZ={class:"marshal-name"},pZ={class:"marshal-meta"},vZ={class:"marshal-checkpoint"},mZ={key:0,class:"marshal-task-count"},gZ={class:"accordion-icon"},yZ={key:0,class:"area-lead-marshal-content"},kZ={key:0,class:"marshal-actions-row"},bZ=["onClick"],wZ={key:1,class:"marshal-contact-section"},_Z=["href"],CZ=["href"],LZ={key:2,class:"marshal-tasks-section"},SZ={class:"tasks-label"},IZ={class:"tasks-list"},xZ=["checked","disabled","onChange"],$Z={class:"task-content"},TZ={class:"task-text"},MZ={key:0,class:"task-context"},AZ={key:1,class:"task-completion-info"},EZ={key:0,class:"completion-by"},PZ={key:1,class:"completion-time"},DZ={key:3,class:"no-tasks-message"},RZ={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1},currentMarshalId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]}},emits:["toggle","toggle-marshal","check-in","toggle-task","show-qr"],setup(e){const{terms:t,termsLower:n}=dt(),s=e,o=m=>{if(!m||m.length===0)return"";const y=k=>k.description?`${k.name} - ${k.description}`:k.name;return m.length===1?y(m[0]):m.map(y).join(", ")},i=(m,y)=>{const k=m.completionContextType||m.contextType,w=m.completionContextId||m.contextId;if(k==="Checkpoint"&&w){const x=y.checkpoints?.find(E=>E.checkpointId===w);if(x){if(x.description){const _=x.description.length>50?x.description.substring(0,50)+"...":x.description;return`${x.name} - ${_}`}return x.name}const A=s.locations.find(E=>E.id===w);if(A){if(A.description){const _=A.description.length>50?A.description.substring(0,50)+"...":A.description;return`${A.name} - ${_}`}return A.name}}if(k==="Area"&&w){const x=s.areas.find(A=>A.id===w);if(x)return x.name}return""},l=(m,y)=>{const k=m.completionContextType||m.contextType,w=m.completionContextId||m.contextId;if(k==="Checkpoint"&&w){const x=y.checkpoints?.find(E=>E.checkpointId===w);return x?x.name||"":s.locations.find(E=>E.id===w)?.name||""}return k==="Area"&&w&&s.areas.find(A=>A.id===w)?.name||""},c=m=>{if(!m.allTasks||m.allTasks.length===0)return[];const y=new Map;for(const A of m.allTasks){const E=A.completionContextType||A.contextType,_=A.completionContextId||A.contextId,C=`${A.itemId}_${E}_${_}`;if(!y.has(C))y.set(C,{...A});else{const S=y.get(C);A.isCompleted&&!S.isCompleted&&y.set(C,{...S,isCompleted:!0,completedAt:A.completedAt||S.completedAt,completedByActorName:A.completedByActorName||S.completedByActorName,contextOwnerName:A.contextOwnerName||S.contextOwnerName})}}const k=Array.from(y.values()),w=new Map;for(const A of k)w.set(A.text,(w.get(A.text)||0)+1);return s1(k,A=>l(A,m)).map(A=>({...A,needsDisambiguation:w.get(A.text)>1,contextDisplayName:i(A,m)}))},d=m=>m.completedByActorName&&m.contextOwnerName&&m.completedByActorName!==m.contextOwnerName?`${m.completedByActorName} on behalf of ${m.contextOwnerName}`:m.completedByActorName||"",h=m=>{if(!m)return"";const y=new Date(m),x=(new Date-y)/(1e3*60*60);return x<24&&x>=0?y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):y.toLocaleString()},f=m=>{const y=c(m),k=y.length,w=y.filter(x=>x.isCompleted).length;return{total:k,completed:w}};return(m,y)=>e.isAreaLead&&e.marshals.length>0?(p(),g("div",oZ,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:y[0]||(y[0]=k=>m.$emit("toggle"))},[r("span",sZ,[r("span",{class:"section-icon",innerHTML:B(so)("marshal")},null,8,aZ),Je(" Your "+b(e.marshals.length===1?B(n).person:B(n).people),1),e.marshals.length>1?(p(),g("span",iZ," ("+b(e.marshals.length)+")",1)):P("",!0)]),r("span",lZ,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",rZ,[r("div",cZ,[(p(!0),g(Se,null,je(e.marshals,k=>(p(),g("div",{key:k.marshalId,class:"area-lead-marshal-item"},[r("button",{class:le(["area-lead-marshal-header",{active:e.expandedMarshalId===k.marshalId,"is-checked-in":k.isCheckedIn}]),onClick:w=>m.$emit("toggle-marshal",k.marshalId)},[r("div",dZ,[r("div",hZ,[r("span",fZ,b(k.name),1),r("span",{class:le(["check-status-badge",{"checked-in":k.isCheckedIn}])},b(k.isCheckedIn?"":""),3)]),r("div",pZ,[r("span",vZ,b(o(k.checkpoints)),1),f(k).total>0?(p(),g("span",mZ,b(f(k).completed)+" / "+b(f(k).total)+" "+b(B(n).checklists)+" complete ",1)):P("",!0)])]),r("span",gZ,b(e.expandedMarshalId===k.marshalId?"":"+"),1)],10,uZ),e.expandedMarshalId===k.marshalId?(p(),g("div",yZ,[k.marshalId!==e.currentMarshalId?(p(),g("div",kZ,[Pe(xu,{"is-checked-in":k.isCheckedIn,"check-in-time":k.checkInTime,"check-in-method":k.checkInMethod,"checked-in-by":k.checkedInBy,"marshal-name":k.marshalName,"is-loading":e.checkingInMarshalId===k.id,onToggle:w=>m.$emit("check-in",k)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:rt(w=>m.$emit("show-qr",k),["stop"]),title:"Show QR code for magic link"},[...y[1]||(y[1]=[pi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-efab33d3><rect x="3" y="3" width="7" height="7" data-v-efab33d3></rect><rect x="14" y="3" width="7" height="7" data-v-efab33d3></rect><rect x="3" y="14" width="7" height="7" data-v-efab33d3></rect><rect x="14" y="14" width="3" height="3" data-v-efab33d3></rect><rect x="19" y="14" width="2" height="2" data-v-efab33d3></rect><rect x="14" y="19" width="2" height="2" data-v-efab33d3></rect><rect x="19" y="19" width="2" height="2" data-v-efab33d3></rect></svg>',1)])],8,bZ)])):P("",!0),k.email||k.phoneNumber?(p(),g("div",wZ,[k.phoneNumber?(p(),g("a",{key:0,href:`tel:${k.phoneNumber}`,class:"contact-link"},b(k.phoneNumber),9,_Z)):P("",!0),k.email?(p(),g("a",{key:1,href:`mailto:${k.email}`,class:"contact-link"},b(k.email),9,CZ)):P("",!0)])):P("",!0),c(k).length>0?(p(),g("div",LZ,[r("div",SZ,b(B(t).checklists),1),r("div",IZ,[(p(!0),g(Se,null,je(c(k),w=>(p(),g("div",{key:`${w.itemId}-${w.completionContextType||w.contextType}-${w.completionContextId||w.contextId}`,class:le(["task-item",{"task-completed":w.isCompleted}])},[r("input",{type:"checkbox",checked:w.isCompleted,disabled:e.savingTask,onChange:x=>m.$emit("toggle-task",w,k)},null,40,xZ),r("div",$Z,[r("span",TZ,b(w.text),1),w.needsDisambiguation&&w.contextDisplayName?(p(),g("div",MZ,b(w.contextDisplayName),1)):P("",!0),w.isCompleted&&(w.completedByActorName||w.completedAt)?(p(),g("div",AZ,[d(w)?(p(),g("span",EZ,b(d(w)),1)):P("",!0),w.completedAt?(p(),g("span",PZ,b(h(w.completedAt)),1)):P("",!0)])):P("",!0)])],2))),128))])])):(p(),g("div",DZ," No "+b(B(n).checklists)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0)}},OZ=Ke(RZ,[["__scopeId","data-v-efab33d3"]]),NZ={class:"checkpoint-note-header"},BZ={key:0,class:"pin-icon",title:"Pinned"},FZ={class:"checkpoint-note-title"},UZ={key:0,class:"checkpoint-note-content"},zZ={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>(t.priority||"Normal").toLowerCase());return(s,o)=>(p(),g("div",{class:le(["checkpoint-note-item",n.value])},[r("div",NZ,[e.isPinned?(p(),g("span",BZ,"")):P("",!0),r("span",{class:le(["priority-indicator",n.value])},null,2),r("strong",FZ,b(e.title),1),r("span",{class:le(["priority-badge",n.value])},b(e.priority),3)]),e.content?(p(),g("div",UZ,b(e.content),1)):P("",!0)],2))}},HZ=Ke(zZ,[["__scopeId","data-v-5f2df920"]]),VZ={class:"checkpoint-accordion-section"},GZ={class:"checkpoint-header-content"},qZ={class:"checkpoint-title-row"},jZ=["innerHTML"],WZ={key:0,class:"checkpoint-check-icon"},ZZ={class:"checkpoint-name"},KZ={key:1,class:"area-badge"},YZ={key:2,class:"checkpoint-time-badge"},JZ={key:3,class:"checkpoint-distance-badge"},XZ={key:0,class:"checkpoint-description-preview"},QZ={class:"accordion-icon"},eK={key:0,class:"checkpoint-accordion-content"},tK={key:0,class:"checkpoint-mini-map"},nK={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},oK={class:"my-checkin-section"},sK={key:0,class:"check-in-error"},aK={key:1,class:"dynamic-location-section"},iK={class:"dynamic-location-header"},lK={class:"dynamic-badge"},rK={key:0,class:"last-update"},cK={key:0,class:"dynamic-location-actions"},uK=["disabled"],dK=["title"],hK={class:"checkpoint-marshals"},fK={class:"marshals-label"},pK={key:0,class:"marshals-list"},vK={key:0,class:"check-badge"},mK={key:1,class:"marshals-list-expanded"},gK=["onClick"],yK={class:"marshal-name-text"},kK={class:"marshal-status-icons"},bK={key:0,class:"check-badge"},wK={class:"expand-icon"},_K={key:0,class:"marshal-details-panel"},CK={class:"detail-row"},LK={key:0,class:"detail-row"},SK={key:1,class:"detail-row"},IK={key:2,class:"detail-row"},xK=["href"],$K={key:3,class:"detail-row"},TK=["href"],MK={key:4,class:"contact-buttons-mini"},AK=["href"],EK=["href"],PK=["href"],DK={key:5,class:"checkpoint-marshal-actions"},RK=["onClick"],OK={key:2,class:"checkpoint-area-contacts"},NK={class:"marshals-label"},BK={class:"contact-list"},FK={key:3,class:"checkpoint-notes"},UK={class:"checkpoint-notes-list"},zK={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{terms:n,termsLower:s}=dt(),o=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ol({headerStyle:H(()=>ru(o.headerStyle)),headerTextColor:H(()=>ru(o.headerTextColor))}),l=e,c=D(null),d=H(()=>l.assignment.location?.isDynamic),h=H(()=>{const _=l.assignment.location?.name||l.assignment.locationName,C=l.assignment.location?.description;return C?`${_}  ${C}`:_}),f=H(()=>{if(!d.value)return!1;const _=l.assignment.location,C=_?.locationUpdateScopeConfigurations||_?.LocationUpdateScopeConfigurations||[];return e1({scopeConfigurations:C,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),m=H(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const _=l.assignment.location;return!_?.latitude||!_?.longitude?null:sl(l.userLocation.lat,l.userLocation.lng,_.latitude,_.longitude)}),y=H(()=>{const _=m.value;return _==null?null:_<1e3?`${Math.round(_/10)*10} m`:`${(Math.round(_/100)/10).toFixed(1)} km`});t({mapRef:c});const k=_=>{const C=_?.iconType||"checkpoint",S=_?.iconColor||"#667eea",$={checkpoint:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return $[C]||$.checkpoint},w=(_,C)=>{const S=$=>$?new Date($).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return _&&C?`${S(_)} - ${S(C)}`:_?`from ${S(_)}`:C?`until ${S(C)}`:""},x=_=>_?new Date(_).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",A=_=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[_]||_,E=_=>{if(!_)return"";const C=new Date(_),R=(new Date-C)/(1e3*60*60);return R<24&&R>=0?C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):C.toLocaleString()};return(_,C)=>(p(),g("div",VZ,[r("button",{class:le(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:C[0]||(C[0]=S=>_.$emit("toggle"))},[r("div",GZ,[r("div",qZ,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,jZ),e.assignment.effectiveIsCheckedIn?(p(),g("span",WZ,"")):P("",!0),r("span",ZZ,b(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(p(),g("span",KZ,b(e.assignment.areaName),1)):P("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(p(),g("span",YZ,b(w(e.assignment.location.startTime,e.assignment.location.endTime)),1)):P("",!0),y.value?(p(),g("span",JZ,b(y.value),1)):P("",!0)]),e.assignment.location?.description?(p(),g("div",XZ,b(e.assignment.location.description),1)):P("",!0)]),r("span",QZ,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",eK,[e.assignment.location?(p(),g("div",tK,[Pe(al,{ref_key:"mapRef",ref:c,locations:e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:C[2]||(C[2]=S=>_.$emit("map-click",S)),onLocationClick:C[3]||(C[3]=S=>_.$emit("location-click",S)),onActionClick:C[4]||(C[4]=S=>_.$emit("action-click",S)),onVisibilityChange:C[5]||(C[5]=S=>_.$emit("visibility-change",S))},kf({_:2},[f.value?{name:"fullscreen-footer",fn:Ve(()=>[r("button",{class:"btn btn-primary",onClick:C[1]||(C[1]=S=>_.$emit("update-location"))},[(p(),g("svg",nK,[...C[9]||(C[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),C[10]||(C[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):P("",!0),r("div",oK,[Pe(xu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:C[6]||(C[6]=S=>_.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(p(),g("div",sK,b(e.checkInError),1)):P("",!0)]),d.value?(p(),g("div",aK,[r("div",iK,[r("span",lK,"Dynamic "+b(e.assignment.location.resolvedCheckpointTerm||B(s).checkpoint),1),e.assignment.location.lastLocationUpdate?(p(),g("span",rK," Last updated: "+b(E(e.assignment.location.lastLocationUpdate)),1)):P("",!0)]),f.value?(p(),g("div",cK,[r("button",{onClick:C[7]||(C[7]=S=>_.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...C[11]||(C[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,uK),r("button",{onClick:C[8]||(C[8]=S=>_.$emit("toggle-auto-update")),class:le(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[C[12]||(C[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+b(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,dK)])):P("",!0)])):P("",!0),r("div",hK,[r("div",fK,b(B(n).people)+":",1),e.isAreaLeadForCheckpoint?(p(),g("div",mK,[(p(!0),g(Se,null,je(e.assignment.allMarshals,S=>(p(),g("div",{key:S.marshalId,class:le(["marshal-card-mini",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn,expanded:e.expandedMarshalId===S.marshalId}])},[r("button",{class:"marshal-card-header",onClick:$=>_.$emit("toggle-marshal",S.marshalId)},[r("span",yK,b(S.marshalName)+b(S.marshalId===e.currentMarshalId?" (you)":""),1),r("span",kK,[S.effectiveIsCheckedIn?(p(),g("span",bK,"")):P("",!0),r("span",wK,b(e.expandedMarshalId===S.marshalId?"":"+"),1)])],8,gK),e.expandedMarshalId===S.marshalId?(p(),g("div",_K,[r("div",CK,[C[13]||(C[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:le(S.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},b(S.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),S.effectiveIsCheckedIn&&S.checkInTime?(p(),g("div",LK,[C[14]||(C[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,b(x(S.checkInTime)),1)])):P("",!0),S.checkInMethod?(p(),g("div",SK,[C[15]||(C[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,b(A(S.checkInMethod)),1)])):P("",!0),S.email?(p(),g("div",IK,[C[16]||(C[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+S.email},b(S.email),9,xK)])):P("",!0),S.phoneNumber?(p(),g("div",$K,[C[17]||(C[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+S.phoneNumber},b(S.phoneNumber),9,TK)])):P("",!0),S.email||S.phoneNumber?(p(),g("div",MK,[S.phoneNumber?(p(),g("a",{key:0,href:"tel:"+S.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,AK)):P("",!0),S.phoneNumber?(p(),g("a",{key:1,href:"sms:"+S.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,EK)):P("",!0),S.email?(p(),g("a",{key:2,href:"mailto:"+S.email,class:"btn btn-sm btn-secondary"},"Email",8,PK)):P("",!0)])):P("",!0),S.marshalId!==e.currentMarshalId?(p(),g("div",DK,[Pe(xu,{"is-checked-in":S.effectiveIsCheckedIn,"check-in-time":S.checkInTime,"check-in-method":S.checkInMethod,"checked-in-by":S.checkedInBy,"marshal-name":S.marshalName,"is-loading":e.checkingInMarshalId===S.id,onToggle:$=>_.$emit("marshal-check-in",S)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:rt($=>_.$emit("show-marshal-qr",S),["stop"]),title:"Show QR code for magic link"},[...C[18]||(C[18]=[pi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-bbde95f8><rect x="3" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="3" y="14" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="14" width="3" height="3" data-v-bbde95f8></rect><rect x="19" y="14" width="2" height="2" data-v-bbde95f8></rect><rect x="14" y="19" width="2" height="2" data-v-bbde95f8></rect><rect x="19" y="19" width="2" height="2" data-v-bbde95f8></rect></svg>',1)])],8,RK)])):P("",!0)])):P("",!0)],2))),128))])):(p(),g("div",pK,[(p(!0),g(Se,null,je(e.assignment.allMarshals,S=>(p(),g("span",{key:S.marshalId,class:le(["marshal-tag",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn}])},[Je(b(S.marshalName)+b(S.marshalId===e.currentMarshalId?" (you)":"")+" ",1),S.effectiveIsCheckedIn?(p(),g("span",vK,"")):P("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(p(),g("div",OK,[r("div",NK,b(B(n).area)+" contacts:",1),r("div",BK,[(p(!0),g(Se,null,je(e.assignment.areaContacts,S=>(p(),Ge($1,{key:S.marshalId,name:S.marshalName,role:S.role,phone:S.phone,email:S.email},null,8,["name","role","phone","email"]))),128))])])):P("",!0),e.notes.length>0?(p(),g("div",FK,[C[19]||(C[19]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",UK,[(p(!0),g(Se,null,je(e.notes,S=>(p(),Ge(HZ,{key:S.noteId,title:S.title,content:S.content,priority:S.priority,"is-pinned":S.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):P("",!0)])):P("",!0)]))}},HK=Ke(zK,[["__scopeId","data-v-bbde95f8"]]),VK={class:"accordion-section"},GK={class:"accordion-title"},qK=["innerHTML"],jK={key:0,class:"header-count"},WK={class:"accordion-icon"},ZK={key:0,class:"accordion-content assignments-accordion-content"},KK={key:0,class:"empty-state"},YK={key:1,class:"checkpoint-accordion"},JK={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{termsLower:n}=dt(),s=e,o=H(()=>s.assignments.map(c=>c.locationId)),i={},l=(c,d)=>{d?i[c]=d:delete i[c]};return t({checkpointRefs:i}),(c,d)=>(p(),g("div",VK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[r("span",GK,[r("span",{class:"section-icon",innerHTML:B(so)("checkpoint")},null,8,qK),Je(" Your "+b(e.assignments.length===1?B(n).checkpoint:B(n).checkpoints),1),e.assignments.length>1?(p(),g("span",jK," ("+b(e.assignments.length)+")",1)):P("",!0)]),r("span",WK,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",ZK,[e.assignments.length===0?(p(),g("div",KK,[r("p",null,"You don't have any "+b(B(n).checkpoint)+" assignments yet.",1)])):(p(),g("div",YK,[(p(!0),g(Se,null,je(e.assignments,h=>(p(),Ge(HK,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":o.value,onToggle:f=>c.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>c.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>c.$emit("location-click",f)),onActionClick:f=>c.$emit("action-click",h,f),onVisibilityChange:f=>c.$emit("visibility-change",h.id,f),onUpdateLocation:f=>c.$emit("update-location",h),onCheckIn:f=>c.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>c.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>c.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>c.$emit("toggle-auto-update",h),onShowMarshalQr:d[4]||(d[4]=f=>c.$emit("show-marshal-qr",f))},null,8,["assignment","is-expanded","all-locations","route","route-color","route-style","route-weight","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):P("",!0)]))}},XK=Ke(JK,[["__scopeId","data-v-e4d1cee8"]]),QK={key:0,class:"accordion-section"},eY={class:"accordion-title"},tY=["innerHTML"],nY={key:0,class:"header-count"},oY={class:"accordion-icon"},sY={key:0,class:"accordion-content"},aY={class:"roles-list"},iY={class:"role-title"},lY={class:"role-notes"},rY={__name:"MarshalRolesSection",props:{roles:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.roles.length>0?(p(),g("div",QK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",eY,[r("span",{class:"section-icon",innerHTML:B(so)("user")},null,8,tY),Je(" Your "+b(e.roles.length===1?"role":"roles"),1),e.roles.length>1?(p(),g("span",nY," ("+b(e.roles.length)+")",1)):P("",!0)]),r("span",oY,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",sY,[r("div",aY,[(p(!0),g(Se,null,je(e.roles,s=>(p(),g("div",{key:s.roleId,class:"role-card"},[r("div",iY,b(s.name),1),r("div",lY,b(s.notes),1)]))),128))])])):P("",!0)])):P("",!0)}},cY=Ke(rY,[["__scopeId","data-v-c6ef5d00"]]),T1="marshal-branding-cache";function uY(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${T1}-${e}`);return t?JSON.parse(t):null}catch{return null}}function dY(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${T1}-${e}`,JSON.stringify(t))}catch{}}function hY(e,t=null){const n=D(t?uY(t):null);Ye(()=>e.value,k=>{if(k&&t){const w={brandingPageGradientStart:k.brandingPageGradientStart,brandingPageGradientEnd:k.brandingPageGradientEnd,brandingHeaderGradientStart:k.brandingHeaderGradientStart,brandingHeaderGradientEnd:k.brandingHeaderGradientEnd,brandingAccentColor:k.brandingAccentColor,brandingLogoUrl:k.brandingLogoUrl,brandingLogoPosition:k.brandingLogoPosition};dY(t,w),n.value=w}},{immediate:!0});const s=(k,w)=>e.value?.[k]||n.value?.[k]||w,o=H(()=>{const k=s("brandingPageGradientStart",dn.pageGradientStart),w=s("brandingPageGradientEnd",dn.pageGradientEnd);return{background:`linear-gradient(135deg, ${k} 0%, ${w} 100%)`}}),i=H(()=>{const k=s("brandingHeaderGradientStart",dn.headerGradientStart),w=s("brandingHeaderGradientEnd",dn.headerGradientEnd);return{background:`linear-gradient(135deg, ${k} 0%, ${w} 100%)`}}),l=H(()=>{const k=s("brandingHeaderGradientStart",dn.headerGradientStart),w=s("brandingHeaderGradientEnd",dn.headerGradientEnd);return Qh(k,w)}),c=H(()=>{const k=s("brandingPageGradientStart",dn.pageGradientStart),w=s("brandingPageGradientEnd",dn.pageGradientEnd);return Qh(k,w)}),d=H(()=>s("brandingAccentColor",dn.accentColor)),h=H(()=>Iu(d.value)),f=H(()=>({background:d.value,color:h.value})),m=H(()=>{const k=s("brandingLogoUrl","");return k?k.startsWith("/api")?ai+k.substring(4):k:""}),y=H(()=>s("brandingLogoPosition","left"));return{pageBackgroundStyle:o,headerStyle:i,headerTextColor:l,pageTextColor:c,accentColor:d,accentTextColor:h,accentButtonStyle:f,brandingLogoUrl:m,brandingLogoPosition:y}}function fY(){const e=D(null),t=D(null);let n=null;const s=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),n=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},o=()=>{n!==null&&(navigator.geolocation.clearWatch(n),n=null)};return In(()=>{o()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:s,stopLocationTracking:o}}function _m(e){if(Array.isArray(e))return e;if(!e||!e.n||!e.d)return[];const{s:t=[],at:n=[],ct:s=[],m:o=[],c:i=[],d:l=[],n:c=[]}=e;return c.map(d=>{const h=l[d.i]||{},f=i[d.x]||{},m=s[f.t]||"",y=t[d.s]||"";let k=null,w=null,x=null;if(d.c&&d.a!=null&&d.a>=0){const _=o[d.a];_&&(k=_.n,x=_.i),d.at!=null&&d.at>=0&&(w=n[d.at])}let A=null,E=null;if(d.o!=null&&d.o>=0){const _=o[d.o];_&&(A=_.n,E=_.i)}return{itemId:h.i,text:h.t,scopeConfigurations:h.sc||[],displayOrder:h.o,isRequired:h.r,visibleFrom:h.vf,visibleUntil:h.vu,mustCompleteBy:h.mb,linksToCheckIn:h.l,linkedCheckpointId:h.lc,linkedCheckpointName:h.ln,isCompleted:d.c,canBeCompletedByMe:d.m,completedByActorName:k,completedByActorType:w,completedByActorId:x,completedAt:d.ca,completionContextType:m,completionContextId:f.i,matchedScope:y,contextOwnerName:A,contextOwnerMarshalId:E}})}function pY({eventId:e,currentMarshalId:t,currentPerson:n,assignments:s,areaLeadAreaIds:o,isAreaLead:i,allLocations:l,areas:c,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:m,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:w}){const x=D([]),A=D(!1),E=D(null),_=D(!1),C=D("person"),S=D(null),$=H(()=>x.value.slice().sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),R=H(()=>$.value.filter(Y=>Y.isCompleted).length),T=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],O=H(()=>{const Y=s.value.map(te=>te.locationId);return $.value.filter(te=>T.includes(te.matchedScope)?te.contextOwnerMarshalId!=null?!1:te.completionContextType==="Checkpoint"?Y.includes(te.completionContextId):te.completionContextType==="Area"?o.value.includes(te.completionContextId):!0:te.completionContextType==="Personal"?te.contextOwnerMarshalId===t.value:te.completionContextType==="Checkpoint"?te.linksToCheckIn?te.contextOwnerMarshalId===t.value:Y.includes(te.completionContextId):te.completionContextType==="Area"?o.value.includes(te.completionContextId):!0)}),M=H(()=>i.value?$.value.filter(Y=>T.includes(Y.matchedScope)?Y.contextOwnerMarshalId!=null:Y.completionContextType==="Personal"?Y.contextOwnerMarshalId!==t.value:Y.completionContextType==="Checkpoint"?Y.linksToCheckIn?Y.contextOwnerMarshalId!==t.value:!1:(Y.completionContextType==="Area",!1)):[]),U=H(()=>O.value.map(Y=>({...Y,localIsCompleted:Y.isCompleted,isModified:!1})).sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),F=H(()=>M.value.map(Y=>({...Y,localIsCompleted:Y.isCompleted,isModified:!1})).sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),j=H(()=>{const Y=f.value?.checkpoints||m.value||[];if(Y.length===0)return[];const te=[],ue=new Set;for(const _e of Y)for(const $e of _e.marshals||[])ue.has($e.marshalId)||(ue.add($e.marshalId),te.push($e));return te}),Z=H(()=>{if(i.value)return"none";const Y=$.value,te=new Set;for(const ue of Y)ue.completionContextType==="Checkpoint"&&ue.completionContextId&&te.add(ue.completionContextId);return te.size>1?"checkpoint":"none"}),Q=H(()=>{const Y=$.value,te={};for(const ue of Y){let _e,$e;ue.completionContextType==="Checkpoint"&&ue.completionContextId?(_e=`checkpoint_${ue.completionContextId}`,$e=l.value.find(Re=>Re.id===ue.completionContextId)?.name||"Unknown "+d.value.checkpoint):ue.completionContextType==="Area"&&ue.completionContextId?(_e=`area_${ue.completionContextId}`,$e=c.value.find(Re=>Re.id===ue.completionContextId)?.name||"Unknown "+d.value.area):(_e="personal",$e="Personal"),te[_e]||(te[_e]={key:_e,name:$e,items:[],completedCount:0}),te[_e].items.push(ue),ue.isCompleted&&te[_e].completedCount++}for(const ue of Object.values(te))ue.items.sort((_e,$e)=>{const De=_e.displayOrder||0,Re=$e.displayOrder||0;return De-Re});return Object.values(te).sort((ue,_e)=>ue.name.localeCompare(_e.name,void 0,{numeric:!0,sensitivity:"base"}))}),re=Y=>{S.value=S.value===Y?null:Y},K=Y=>{if(!Y.completionContextType||!Y.completionContextId)return null;if(Y.completionContextType==="Checkpoint"){const te=l.value.find(_e=>_e.id===Y.completionContextId);if(!te)return null;const ue=te.description?` - ${te.description}`:"";return`At ${h.value.checkpoint} ${te.name}${ue}`}if(Y.completionContextType==="Area"){const te=c.value.find(ue=>ue.id===Y.completionContextId);return te?`At ${h.value.area} ${te.name}`:null}return Y.completionContextType==="Personal"?"Personal item":null},ae=async(Y=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}Y||(A.value=!0),E.value=null;try{const te=e.value,ue=await Ot.getMarshalChecklist(te,t.value);let _e=_m(ue.data);if(i.value&&o.value.length>0){const $e=o.value.map(z=>Ot.getAreaChecklist(te,z).catch(J=>(console.warn(`Failed to fetch checklist for area ${z}:`,J),{data:null}))),De=await Promise.all($e),Re=new Map,be=z=>{const J=`${z.itemId}_${z.completionContextType}_${z.completionContextId}`;return z.contextOwnerMarshalId?`${J}_${z.contextOwnerMarshalId}`:J};for(const z of _e)Re.set(be(z),z);for(const z of De){const J=_m(z.data);for(const de of J){const ie=be(de);Re.has(ie)||Re.set(ie,de)}}_e=Array.from(Re.values())}x.value=_e,y?.value&&(y.value.checklist=Date.now())}catch(te){console.error("Failed to load checklist:",te.response?.status,te.response?.data),E.value=te.response?.data?.message||"Failed to load checklist"}finally{Y||(A.value=!1)}};return{checklistItems:x,checklistLoading:A,checklistError:E,savingChecklist:_,checklistGroupBy:C,expandedChecklistGroup:S,visibleChecklistItems:$,completedChecklistCount:R,myChecklistItems:O,areaChecklistItems:M,myChecklistItemsWithLocalState:U,areaChecklistItemsWithLocalState:F,areaMarshalsForChecklist:j,effectiveChecklistGroupBy:Z,groupedChecklistItems:Q,loadChecklist:ae,handleToggleChecklist:async Y=>{if(_.value)return;_.value=!0;const te=e.value,ue={marshalId:Y.contextOwnerMarshalId||t.value,contextType:Y.completionContextType,contextId:Y.completionContextId,actorMarshalId:t.value};try{if(Y.isCompleted)if(Jn())await Oo("checklist_uncomplete",{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted=!1,Y.completedAt=null,Y.completedByActorName=null,w&&await w();else{if(await Ot.uncomplete(te,Y.itemId,ue),Y.linksToCheckIn&&Y.linkedCheckpointId){const _e=s.value.find($e=>$e.locationId===Y.linkedCheckpointId);_e&&(_e.isCheckedIn=!1,_e.checkedInAt=null)}await ae(!0)}else if(Jn())await Oo("checklist_complete",{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted=!0,Y.completedAt=new Date().toISOString(),Y.completedByActorName=n.value?.name||"You",w&&await w();else{const _e=await Ot.complete(te,Y.itemId,ue),$e=Y.linkedCheckpointId||_e.data?.linkedCheckIn?.locationId;if(Y.linksToCheckIn&&$e){const De=s.value.find(Re=>Re.locationId===$e);if(De){const Re=_e.data?.linkedCheckIn?.checkedInAt||new Date().toISOString();De.isCheckedIn=!0,De.checkedInAt=Re}}await ae(!0)}k&&await k(te,"checklist",JSON.parse(JSON.stringify(x.value)))}catch(_e){if(console.error("Failed to toggle checklist item:",_e),Jn()||!_e.response){const $e=Y.isCompleted?"checklist_uncomplete":"checklist_complete";await Oo($e,{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted?(Y.isCompleted=!1,Y.completedAt=null,Y.completedByActorName=null):(Y.isCompleted=!0,Y.completedAt=new Date().toISOString(),Y.completedByActorName=n.value?.name||"You"),w&&await w(),k&&await k(te,"checklist",JSON.parse(JSON.stringify(x.value)))}}finally{_.value=!1}},toggleChecklistGroup:re,getContextName:K}}function vY({eventId:e,allLocations:t,userLocation:n,locationLastUpdated:s}){const o=D(!1),i=D(null),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(!1);let m=null,y=null,k=null;const w=q=>q?.isDynamic===!0||q?.IsDynamic===!0,x=(q,Y,te,ue)=>{const _e=t.value.find($e=>$e.id===q);_e&&(_e.latitude=Y,_e.longitude=te,_e.lastLocationUpdate=ue)},A=q=>{i.value=q,l.value=null,c.value=null,o.value=!0},E=()=>{o.value=!1,i.value=null,l.value=null,c.value=null,f.value=!1},_=()=>{o.value=!1,f.value=!0},C=()=>{f.value=!1,o.value=!0},S=async(q,Y,te,ue,_e=null)=>{d.value=!0;try{const $e=e.value,De={latitude:Y,longitude:te,sourceType:ue};_e&&(De.sourceCheckpointId=_e);const Re=await Xn.updatePosition($e,q,De);Re.data.success&&(h.value&&U(),x(q,Re.data.latitude,Re.data.longitude,Re.data.lastLocationUpdate))}catch($e){console.error("Failed to update location:",$e),$e.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},$=async()=>{if(i.value){d.value=!0,l.value=null;try{let q,Y;if(n.value&&s?.value&&Date.now()-s.value<3e4&&(q=n.value.lat,Y=n.value.lng),!q||!Y){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const $e=await new Promise((De,Re)=>{navigator.geolocation.getCurrentPosition(De,Re,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});q=$e.coords.latitude,Y=$e.coords.longitude}const te=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(te,ue,{latitude:q,longitude:Y,sourceType:"gps"});_e.data.success&&(c.value="Location updated successfully!",x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(q){console.error("Failed to update location with GPS:",q),q.response?.status===403?l.value="You do not have permission to update this location.":q.code===1?l.value="Location access denied. Please enable location permissions.":q.code===2?l.value="Unable to determine your location. Please try again.":q.code===3||q.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async q=>{if(!i.value)return;const Y=t.value.find(te=>te.id===q);if(!Y){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const te=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(te,ue,{latitude:Y.latitude,longitude:Y.longitude,sourceType:"checkpoint",sourceCheckpointId:q});_e.data.success&&(h.value&&U(),c.value=`Location copied from ${Y.name}!`,x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(te){console.error("Failed to copy location from checkpoint:",te),te.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},T=async(q,Y)=>{if(i.value){d.value=!0,l.value=null;try{const te=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(te,ue,{latitude:q,longitude:Y,sourceType:"manual"});_e.data.success&&(c.value="Location updated successfully!",x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(te){console.error("Failed to update location manually:",te),te.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},O=async q=>{if(!(!q||!("geolocation"in navigator)))try{const Y=await new Promise((_e,$e)=>{navigator.geolocation.getCurrentPosition(_e,$e,{enableHighAccuracy:!0,timeout:15e3})}),te=e.value,ue=q.locationId;await Xn.updatePosition(te,ue,{latitude:Y.coords.latitude,longitude:Y.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),x(ue,Y.coords.latitude,Y.coords.longitude,new Date().toISOString())}catch(Y){console.warn("Auto-update location failed:",Y)}},M=q=>{h.value=!0,O(q),m=setInterval(()=>{O(q)},6e4)},U=()=>{h.value=!1,m&&(clearInterval(m),m=null)},F=q=>{h.value?U():M(q)},j=()=>{y||!t.value.some(Y=>Y.isDynamic||Y.IsDynamic)||(y=setInterval(async()=>{try{const Y=e.value,te=await Xn.getDynamicCheckpoints(Y,{skipLoadingOverlay:!0});if(te.data&&Array.isArray(te.data))for(const ue of te.data){const _e=t.value.find($e=>$e.id===ue.checkpointId);_e&&(_e.latitude=ue.latitude,_e.longitude=ue.longitude,_e.lastLocationUpdate=ue.lastLocationUpdate)}}catch(Y){console.warn("Failed to poll dynamic checkpoints:",Y)}},6e4))},Z=()=>{y&&(clearInterval(y),y=null)},Q=async()=>{try{const q=e.value,Y=await Xn.getByEvent(q,{skipLoadingOverlay:!0});if(Y.data&&Array.isArray(Y.data))for(const te of Y.data){const ue=t.value.find(_e=>_e.id===te.id);ue&&(ue.latitude=te.latitude,ue.longitude=te.longitude,te.lastLocationUpdate&&(ue.lastLocationUpdate=te.lastLocationUpdate))}}catch(q){console.warn("Failed to poll all checkpoint locations:",q)}};return{showLocationUpdateModal:o,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:c,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:w,openLocationUpdateModal:A,closeLocationUpdateModal:E,startMapLocationSelect:_,cancelMapLocationSelect:C,updateDynamicCheckpointLocation:S,updateLocationWithGps:$,updateLocationFromCheckpoint:R,updateLocationManually:T,toggleAutoUpdate:F,startAutoUpdate:M,stopAutoUpdate:U,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:Z,startAllCheckpointsPolling:()=>{k||(Q(),k=setInterval(Q,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:q=>{f.value&&i.value&&(S(i.value.locationId,q.lat,q.lng,"manual"),f.value=!1)}}}function mY({eventId:e,assignments:t,allLocations:n,areaLeadRef:s,areaLeadCheckpoints:o,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:c,reloadChecklist:d,checklistItems:h,currentMarshalId:f}){const{termsLower:m}=dt(),y=D(null),k=D(null),w=D(null),x=D(!1),A=D(null),E=D(new Set),_=D(!1),C=D(""),S=()=>!1,$=Z=>{if(!Z)return"";const Q=new Date(Z),K=(new Date-Q)/(1e3*60*60),ae=Q.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K>24?`${Q.toLocaleDateString([],{day:"numeric",month:"short"})}, ${ae}`:ae},R=Z=>{if(!Z)return"";switch(Z){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return Z}},T=Z=>{E.value.add(Z),x.value=!1,A.value=null},O=()=>{_.value=!1,C.value=""},M=Z=>Z<1e3?`${Math.round(Z/10)*10} m`:`${(Math.round(Z/100)/10).toFixed(1)} km`,U=(Z,Q,re)=>{if(Z==null||Q==null)return;const K=n.value?.find(te=>te.id===re);if(!K)return;const ae=K.latitude,q=K.longitude;if(ae==null||q==null)return;const Y=sl(Z,Q,ae,q);if(Y>50){const te=M(Y);C.value=`Thanks for checking in. Just so you know, it's possible you are more than ${te} from your ${m.value.checkpoint} area.`,_.value=!0}},F=async(Z,Q=!0,re=null)=>{if(!Z?.id){w.value="Cannot check in: Assignment ID is missing";return}y.value=Z.id,k.value=Z.id,w.value=null;const K=e.value;if(!K){w.value="Cannot check in: Event ID is missing",y.value=null,k.value=null;return}const ae=Z.effectiveIsCheckedIn!==void 0?Z.effectiveIsCheckedIn:Z.isCheckedIn&&!S(Z.checkInTime),q=Z.isCheckedIn&&!ae,Y=ae?"check-out":q?"refresh":"check-in",te=!ae;let ue=null,_e=null,$e="Manual";if(Q&&!ae&&"geolocation"in navigator)try{const Re=await new Promise((be,z)=>{navigator.geolocation.getCurrentPosition(be,z,{enableHighAccuracy:!0,timeout:5e3})});ue=Re.coords.latitude,_e=Re.coords.longitude,$e="GPS"}catch{}const De={latitude:ue,longitude:_e,action:Y};try{if(Jn()){await Oo("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:De});const Re=t.value.findIndex(be=>be.id===Z.id);if(Re!==-1&&(t.value[Re]={...t.value[Re],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?`${$e} (pending)`:null,checkInLatitude:ue,checkInLongitude:_e}),re){const be=n.value.find(z=>z.id===re);if(be?.assignments){const z=be.assignments.find(J=>J.id===Z.id||J.marshalId===Z.marshalId);z&&(z.isCheckedIn=te,z.checkInTime=te?new Date().toISOString():null)}}l&&await l(),c&&await c(K,"locations",n.value)}else{const Re=await hi.toggleCheckIn(K,Z.id,De),be=Re.data?.assignment||Re.data,z=Re.data?.linkedTasksCompleted||[],J=Re.data?.linkedTasksUncompleted||0,de=t.value.findIndex(ie=>ie.id===Z.id);if(de!==-1&&(t.value[de]=be),re){const ie=n.value.find(Ae=>Ae.id===re);if(ie?.assignments){const Ae=ie.assignments.find(G=>G.id===Z.id||G.marshalId===Z.marshalId);Ae&&Object.assign(Ae,be)}}d&&(z.length>0||J>0)&&await d(!0)}if(re&&s?.value?.loadDashboard&&(await s.value.loadDashboard(),o&&s?.value?.checkpoints&&(o.value=s.value.checkpoints)),i&&i.value++,te&&ue!=null&&_e!=null){const Re=re||Z.locationId;Re&&U(ue,_e,Re)}}catch(Re){if(Jn()||!Re.response){await Oo("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:De});const be=t.value.findIndex(z=>z.id===Z.id);be!==-1&&(t.value[be]={...t.value[be],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?"Manual (pending)":null}),l&&await l()}else Re.response?.data?.message?w.value=Re.response.data.message:Re.message?w.value=Re.message:w.value=`Failed to ${Y}. Please try again.`}finally{y.value=null,k.value=null}};return{checkingIn:y,checkingInAssignment:k,checkInError:w,showCheckInReminderModal:x,checkInReminderCheckpoint:A,dismissedCheckInReminders:E,showDistanceWarning:_,distanceWarningMessage:C,isCheckInStale:S,formatCheckInTime:$,formatCheckInMethod:R,handleCheckInToggle:F,handleAreaLeadMarshalCheckIn:async Z=>{const re=(s?.value?.checkpoints||o?.value||[]).find(_e=>_e.marshals?.some($e=>$e.marshalId===Z.marshalId));if(!re){console.error("Could not find checkpoint for marshal:",Z);return}const K=re.marshals.find(_e=>_e.marshalId===Z.marshalId);if(!K)return;const ae=K.assignmentId||K.id;if(!ae){console.error("No assignment ID found for marshal:",K);return}const q=!Z.isCheckedIn,Y=re.checkpointId||re.locationId,te={id:ae,marshalId:Z.marshalId,isCheckedIn:Z.isCheckedIn,effectiveIsCheckedIn:Z.isCheckedIn};await F(te,!1,Y);const ue=[s?.value?.checkpoints,o?.value].filter(Boolean);for(const _e of ue)for(const $e of _e){const De=$e.marshals?.find(Re=>Re.marshalId===Z.marshalId);De&&(De.isCheckedIn=q,De.checkInTime=q?new Date().toISOString():null,De.checkInMethod=q?"AreaLead":null)}if(i&&i.value++,h?.value&&e?.value&&f?.value){const _e=h.value.filter($e=>$e.linksToCheckIn&&$e.linkedCheckpointId===Y&&($e.contextOwnerMarshalId===Z.marshalId||$e.completionContextType==="Checkpoint"&&$e.completionContextId===Y));if(_e.length>0){for(const $e of _e)try{const De={marshalId:$e.contextOwnerMarshalId||Z.marshalId,contextType:$e.completionContextType,contextId:$e.completionContextId,actorMarshalId:f.value};q&&!$e.isCompleted?await Ot.complete(e.value,$e.itemId,De):!q&&$e.isCompleted&&await Ot.uncomplete(e.value,$e.itemId,De)}catch(De){console.error("Failed to toggle linked task:",De)}d&&await d(!0)}}},dismissCheckInReminder:T,dismissDistanceWarning:O}}function gY({eventId:e,currentMarshalId:t,isAreaLead:n,areaLeadAreaIds:s,sectionLastLoadedAt:o,showMessage:i}){const l=D([]),c=D(!1),d=D(null),h=D(!1),f=D(!1),m=D(""),y=D(!1),k=D(!1),w=D(!1),x=H(()=>l.value.filter(O=>O.status==="open"||O.status==="acknowledged"||O.status==="in_progress").length),A=async()=>{const O=e.value;c.value=!0;try{const M=new Map;if(n.value&&s.value.length>0)for(const U of s.value)try{const j=(await js.getForArea(O,U)).data.incidents||[];for(const Z of j)M.set(Z.incidentId,Z)}catch(F){console.warn(`Failed to load incidents for area ${U}:`,F)}try{const F=(await js.getAll(O)).data.incidents||[];for(const j of F)j.reportedBy?.marshalId===t.value&&M.set(j.incidentId,j)}catch(U){console.debug("Could not load all incidents:",U)}l.value=Array.from(M.values()).sort((U,F)=>new Date(F.incidentTime||F.createdAt)-new Date(U.incidentTime||U.createdAt)),o?.value&&(o.value.incidents=Date.now())}catch(M){console.error("Failed to load incidents:",M)}finally{c.value=!1}},E=async O=>{w.value=!0;try{await js.create(e.value,O),k.value=!1,A(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(M){console.error("Failed to report incident:",M),i&&i("Error",M.response?.data?.message||"Failed to report incident. Please try again.")}finally{w.value=!1}},_=O=>{d.value=O,h.value=!0},C=()=>{h.value=!1,d.value=null},S=async({incidentId:O,status:M})=>{try{await js.updateStatus(e.value,O,{status:M});const U=l.value.find(F=>F.incidentId===O);U&&(U.status=M),d.value?.incidentId===O&&(d.value.status=M)}catch(U){console.error("Failed to update incident status:",U),i&&i("Error","Failed to update status. Please try again.")}},$=()=>{m.value="",f.value=!0},R=()=>{f.value=!1,m.value=""};return{myIncidents:l,incidentsLoading:c,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:f,incidentNoteText:m,submittingIncidentNote:y,showReportIncident:k,reportingIncident:w,openIncidentsCount:x,loadMyIncidents:A,handleReportIncident:E,openIncidentDetail:_,closeIncidentDetail:C,handleIncidentStatusChange:S,openAddIncidentNoteModal:$,closeAddIncidentNoteModal:R,submitIncidentNote:async()=>{if(!(!m.value.trim()||!d.value)){y.value=!0;try{await js.addNote(e.value,d.value.incidentId,m.value.trim()),R(),A();const O=await js.get(e.value,d.value.incidentId);d.value=O.data}catch(O){console.error("Failed to add note:",O),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const Cm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',Lm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',yY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',kY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function bY({userLocation:e,assignmentsWithDetails:t,courseMapRef:n}){const{termsLower:s}=dt(),o=D({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=D(!1),l=D(-1),c=D({}),d={},h=H(()=>t.value.filter(E=>E.location?.latitude&&E.location?.longitude&&!(E.location.latitude===0&&E.location.longitude===0))),f=H(()=>{const E=[];return E.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+s.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?yY:kY}),e.value&&!o.value.userLocationInView&&E.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Cm}),h.value.length>0&&!o.value.highlightedLocationInView&&E.push({id:"recenter-checkpoint",label:"My "+s.value.checkpoint,icon:"custom",customIcon:Lm}),E}),m=E=>{const _=o.value,C=_.userLocationInView!==E.userLocationInView||_.highlightedLocationInView!==E.highlightedLocationInView,S=JSON.stringify(_.highlightedLocationsVisibility)!==JSON.stringify(E.highlightedLocationsVisibility||{});(C||S)&&(o.value={...E,highlightedLocationsVisibility:E.highlightedLocationsVisibility||{}})},y=()=>{const E=h.value;if(E.length===0)return null;if(E.length===1)return l.value=0,E[0];const _=o.value.highlightedLocationsVisibility||{},C=[];for(let R=0;R<E.length;R++){const T=E[R].locationId;_[T]===!1&&C.push(R)}if(C.length===0)return l.value=0,E[0];if(C.length===1)return l.value=C[0],E[C[0]];const S=l.value;let $=-1;for(const R of C)if(R>S){$=R;break}return $===-1&&($=C[0]),l.value=$,E[$]};return{courseMapVisibility:o,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:m,handleCourseMapAction:({actionId:E})=>{if(E==="toggle-other-checkpoints")i.value=!i.value;else if(E==="recenter-user"&&e.value)n.value?.recenterOnUserLocation();else if(E==="recenter-checkpoint"){const _=y();_?.location&&n.value?.recenterOnLocation(_.location.latitude,_.location.longitude)}},checkpointMapVisibility:c,checkpointMapRefs:d,getCheckpointMapActions:E=>{const _=[],C=c.value[E]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!C.userLocationInView&&_.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Cm}),C.highlightedLocationInView||_.push({id:"recenter-checkpoint",label:s.value.checkpoint.charAt(0).toUpperCase()+s.value.checkpoint.slice(1),icon:"custom",customIcon:Lm}),_},handleCheckpointMapVisibilityChange:(E,_)=>{const C=c.value[E];(!C||C.userLocationInView!==_.userLocationInView||C.highlightedLocationInView!==_.highlightedLocationInView)&&(c.value={...c.value,[E]:_})},handleCheckpointMapAction:(E,{actionId:_})=>{const C=d[E.id];_==="recenter-user"&&e.value?C?.recenterOnUserLocation():_==="recenter-checkpoint"&&E.location&&C?.recenterOnLocation(E.location.latitude,E.location.longitude)}}}function wY({eventId:e,currentMarshalId:t,areaLeadRef:n,areaLeadCheckpoints:s,areaChecklistItems:o,myChecklistItems:i,areaLeadAreaIds:l,loadChecklist:c}){const d=D(null),h=D(!1),f=D(0),m=w=>{d.value=d.value===w?null:w},y=H(()=>{f.value;const w=n?.value?.checkpoints,x=s?.value,A=w?.length>0?w:x||[],E=o?.value||[],_=i?.value||[],C=[...E,..._],S=new Map;for(const R of A){const T=R.marshals||R.Marshals||[],O=R.checkpointId||R.CheckpointId,M=R.name||R.Name,U=R.description||R.Description,F=R.areaIds||R.AreaIds||[];for(const j of T){const Z=j.marshalId||j.MarshalId;if(!Z)continue;S.has(Z)||S.set(Z,{...j,marshalId:Z,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const Q=S.get(Z);Q.checkpoints.push({checkpointId:O,name:M,description:U}),Q.checkpointIds.add(O);for(const re of F)Q.areaIds.add(re)}}for(const R of C){const T=R.completionContextType,O=R.completionContextId,M=R.contextOwnerMarshalId;let U=[];if(M)S.has(M)&&(U=[S.get(M)]);else{if(T==="Personal")continue;if(T==="Checkpoint")for(const F of S.values())F.checkpointIds.has(O)&&U.push(F);else if(T==="Area")for(const F of S.values())F.areaIds.has(O)&&U.push(F);else U=Array.from(S.values())}for(const F of U)F.allTasks.push({...R,isCompleted:R.isCompleted||R.localIsCompleted}),F.totalTaskCount++,(R.isCompleted||R.localIsCompleted)&&F.completedTaskCount++}return Array.from(S.values()).map(R=>({...R,checkpointIds:Array.from(R.checkpointIds),areaIds:Array.from(R.areaIds)})).sort((R,T)=>(R.name||"").localeCompare(T.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:d,savingAreaLeadMarshalTask:h,areaLeadMarshalDataVersion:f,allAreaLeadMarshals:y,toggleAreaLeadMarshalExpansion:m,toggleAreaLeadMarshalTask:async(w,x)=>{if(h.value)return;h.value=!0;const A={marshalId:x.marshalId,contextType:w.completionContextType||w.contextType,contextId:w.completionContextId||w.contextId,actorMarshalId:t.value},E=!w.isCompleted;try{if(w.isCompleted?await Ot.uncomplete(e.value,w.itemId,A):await Ot.complete(e.value,w.itemId,A),w.linksToCheckIn){const _=n?.value?.checkpoints||s?.value||[];for(const C of _){const S=C.marshals?.find($=>$.marshalId===x.marshalId);S&&(S.isCheckedIn=E,S.checkInTime=E?new Date().toISOString():null,S.checkInMethod=E?"Task":null)}}n?.value?.loadDashboard&&(await n.value.loadDashboard(),s&&n?.value?.checkpoints&&(s.value=n.value.checkpoints)),f.value++,c&&await c(!0)}catch(_){console.error("Failed to toggle area lead marshal task:",_),console.error("Error response data:",_.response?.data)}finally{h.value=!1}}}}function _Y({router:e,route:t,onAuthSuccess:n}){const s=D(!1),o=D(!1),i=D(null),l=D(null),c=D(null),d=D(null),h=H(()=>l.value?.name||null),f=H(()=>d.value?.eventRoles?d.value.eventRoles.filter(M=>M.role==="EventAreaLead").flatMap(M=>M.areaIds||[]):[]),m=H(()=>f.value.length>0),y=H(()=>d.value?.eventRoles?d.value.eventRoles.some(O=>O.role==="EventAdmin"):!1),k=H(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),w=H(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let x=null;const A=()=>{x||(x=setInterval(async()=>{if(d.value?.marshalId)try{await Ws.getMe(t.params.eventId)}catch(O){console.debug("Heartbeat failed:",O)}},300*1e3))},E=()=>{x&&(clearInterval(x),x=null)},_=async(O,M,U=!1)=>{o.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:O,code:M,isReauth:U}),Bd();try{No("marshal",O);const F=await Ws.marshalLogin(O,M);if(console.log("Auth response:",F.data),F.data.success){sv(O,{token:F.data.sessionToken,marshalId:F.data.marshalId,marshalName:F.data.person?.name||null}),Uw(O,F.data.marshalId,M),l.value=F.data.person,c.value=F.data.marshalId,s.value=!0,console.log("Authenticated as marshal:",c.value,l.value?.name);try{const j=await Ws.getMe(O);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),A(),n&&await n()}else i.value=F.data.message||"Authentication failed"}catch(F){console.error("Authentication failed:",F),i.value=F.response?.data?.message||"Invalid or expired login link"}finally{o.value=!1}};return{isAuthenticated:s,authenticating:o,loginError:i,currentPerson:l,currentMarshalId:c,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:m,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:w,authenticateWithMagicCode:_,checkExistingSession:async O=>{No("marshal",O);const M=bu(O),U=M?.marshalId,F=U?yy(O,U):null;if(!M?.token)return F?(console.log("No session but have stored code, attempting re-authentication..."),Bd(),await _(O,F,!0),s.value):!1;try{const j=await Ws.getMe(O);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},c.value=j.data.marshalId,s.value=!0,py(O,j.data.marshalId),A(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),F)try{if(Bd(),await _(O,F,!0),s.value)return console.log("Re-authentication successful"),!0}catch(Z){console.error("Re-authentication failed:",Z)}M?.sessionKey&&Uh(M.sessionKey)}return!1},handleClose:O=>{E(),No(null),s.value=!1,l.value=null,c.value=null,d.value=null,O&&O(),e.push("/marshal")},handleRemoveSession:async O=>{const[M]=O.split(":");No("marshal",M);try{await Ws.logout()}catch{}Uh(O),No(null)},updateSessionEventInfo:(O,M,U)=>{const F=bu(O);F&&F.marshalId&&sv(O,{marshalId:F.marshalId,marshalName:F.marshalName,token:F.token,eventName:M,eventDate:U})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:A,stopHeartbeat:E}}function CY({eventDate:e,latitude:t,longitude:n}){const s=D(null),o=D(!1),i=D(null),l=["US","LR","MM"],c=H(()=>{try{const _=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(_)}catch{return!1}}),d=H(()=>c.value?"fahrenheit":"celsius"),h=H(()=>{if(!e.value)return null;const E=new Date,_=new Date(e.value);return E.setHours(0,0,0,0),_.setHours(0,0,0,0),Math.floor((_-E)/(1e3*60*60*24))}),f=H(()=>{const E=h.value;return E===null?!1:E>=-1&&E<=7}),m=E=>E>3?720*60*1e3:E>1?10800*1e3:3600*1e3,y=(E,_,C)=>`weather_${E.toFixed(2)}_${_.toFixed(2)}_${C}`,k=(E,_,C,S)=>{try{const $=y(E,_,C),R=localStorage.getItem($);if(!R)return null;const{data:T,timestamp:O}=JSON.parse(R),M=m(S);return Date.now()-O<M?T:(localStorage.removeItem($),null)}catch{return null}},w=(E,_,C,S)=>{try{const $=y(E,_,C);localStorage.setItem($,JSON.stringify({data:S,timestamp:Date.now()}))}catch{}},x={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},A=async()=>{const E=t.value,_=n.value,C=e.value,S=h.value;if(!E||!_||!C||!f.value){s.value=null;return}const $=new Date(C).toISOString().split("T")[0],R=k(E,_,$,S);if(R){s.value=R;return}o.value=!0,i.value=null;try{const T=c.value?"fahrenheit":"celsius",O=`https://api.open-meteo.com/v1/forecast?latitude=${E}&longitude=${_}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${T}&timezone=auto`,M=await fetch(O);if(!M.ok)throw new Error("Weather API request failed");const U=await M.json(),F=U.daily.time.indexOf($);if(F===-1){s.value=null;return}const j=U.daily.weathercode[F],Z=Math.round(U.daily.temperature_2m_max[F]),Q=Math.round(U.daily.temperature_2m_min[F]),re=x[j]||{icon:"cloud",description:"Unknown"},K={tempMax:Z,tempMin:Q,unit:c.value?"F":"C",icon:re.icon,description:re.description,weatherCode:j};w(E,_,$,K),s.value=K}catch(T){console.warn("Failed to fetch weather:",T),i.value=T.message,s.value=null}finally{o.value=!1}};return Ye([e,t,n,f],()=>{f.value&&t.value&&n.value?A():s.value=null},{immediate:!0}),{weather:s,loading:o,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:A}}const LY=["aria-label"],SY={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,n={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},s=H(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${n[t.icon]||"cloudy"}.svg`),o=H(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=H(()=>({width:o.value,height:o.value,backgroundColor:t.color,maskImage:`url(${s.value})`,WebkitMaskImage:`url(${s.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,c)=>(p(),g("span",{class:"weather-icon",style:tt(i.value),role:"img","aria-label":e.alt},null,12,LY))}},IY=Ke(SY,[["__scopeId","data-v-9861a237"]]),xY={key:0,class:"header-logo-cover"},$Y=["src"],TY={key:2,class:"header-logo header-logo-left"},MY=["src"],AY={class:"header-center"},EY={key:0},PY={key:1,class:"header-event-date"},DY=["title"],RY={class:"weather-temp"},OY={key:0,class:"header-actions"},NY={key:3,class:"header-logo header-logo-right"},BY=["src"],FY={class:"container"},UY={key:0,class:"selection-card"},zY={key:1,class:"selection-card"},HY={key:0,class:"loading"},VY={key:2,class:"selection-card error-card"},GY={class:"error"},qY={key:3,class:"dashboard"},jY={key:0,class:"welcome-bar"},WY={class:"welcome-info"},ZY={key:0,class:"welcome-email"},KY={key:0,class:"mode-switch"},YY={key:1,class:"mode-switch"},JY={class:"accordion"},XY={key:1,class:"refresh-indicator"},QY={class:"add-note-form"},eJ={class:"modal-actions"},tJ=["disabled"],nJ={key:0,class:"qr-loading-state"},oJ={key:1,class:"qr-error-state"},sJ=6e4,aJ={__name:"MarshalView",setup(e){const{terms:t,termsLower:n}=dt(),{updatePendingCount:s}=Vf(),o=Qu(),i=ir(),l=H(()=>o.params.eventId),c={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:m,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:w,isAreaLead:x,canSwitchToAdmin:A,isAdminButNeedsReauth:E,authenticateWithMagicCode:_,checkExistingSession:C,handleClose:S,updateSessionEventInfo:$,switchToAdminMode:R,stopHeartbeat:T}=_Y({router:i,route:o,onAuthSuccess:()=>c.onAuthSuccess?.()}),O=D(new Set),M=H(()=>w.value.length?K.value.filter(Te=>w.value.includes(Te.id)).map(Te=>({areaId:Te.id,name:Te.name,color:Te.color})).sort((Te,Le)=>(Te.name||"").localeCompare(Le.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ye(M,Te=>{Te.length>0&&O.value.size===0&&(O.value=new Set(Te.map(Le=>Le.areaId)))},{immediate:!0});const U=H(()=>w.value.filter(Te=>O.value.has(Te))),F=Te=>{const Le=new Set(O.value);Le.has(Te)?Le.delete(Te):Le.add(Te),O.value=Le},j=H(()=>{const Te=xn.value.find(ot=>ot.isCheckedIn&&!qn(ot.checkInTime)&&ot.location);if(Te?.location)return{id:Te.location.id,locationId:Te.location.id,name:Te.location.name,description:Te.location.description};if(qt.value){const ot=xn.value.find(gt=>gt.id===qt.value);if(ot?.location)return{id:ot.location.id,locationId:ot.location.id,name:ot.location.name,description:ot.location.description}}const Le=xn.value[0];return Le?.location?{id:Le.location.id,locationId:Le.location.id,name:Le.location.name,description:Le.location.description}:null}),Z=D(null),Q=D([]),re=D([]),K=D([]),ae=D(!0),q=D(!1),{pageBackgroundStyle:Y,headerStyle:te,headerTextColor:ue,pageTextColor:_e,accentColor:$e,accentTextColor:De,accentButtonStyle:Re,brandingLogoUrl:be,brandingLogoPosition:z}=hY(Z,o.params.eventId);Nr("marshalBranding",{headerStyle:te,headerTextColor:ue,accentButtonStyle:Re,accentColor:$e,accentTextColor:De});const J=H(()=>{if(!Q.value.length)return null;const Te=Q.value.filter(Le=>Le.latitude&&Le.longitude);return Te.length?Te.reduce((Le,ot)=>Le+ot.latitude,0)/Te.length:null}),de=H(()=>{if(!Q.value.length)return null;const Te=Q.value.filter(Le=>Le.latitude&&Le.longitude);return Te.length?Te.reduce((Le,ot)=>Le+ot.longitude,0)/Te.length:null}),ie=H(()=>Z.value?.eventDate||null),{weather:Ae,shouldShowWeather:G}=CY({eventDate:ie,latitude:J,longitude:de}),X=D("assignments"),ee=D({checklist:0,notes:0,incidents:0,eventContacts:0}),Ce=D([]),Be=D([]),Fe=D([]),Ee=D(null),oe=H(()=>Ee.value?.areaLeadRef?.value),{checklistItems:ge,checklistLoading:Ne,checklistError:Oe,savingChecklist:xe,expandedChecklistGroup:me,visibleChecklistItems:Ze,completedChecklistCount:qe,myChecklistItems:fe,areaChecklistItems:ke,areaChecklistItemsWithLocalState:ne,areaMarshalsForChecklist:ye,effectiveChecklistGroupBy:He,groupedChecklistItems:ct,loadChecklist:ht,handleToggleChecklist:Nt,toggleChecklistGroup:Lt,getContextName:Bt}=pY({eventId:l,currentMarshalId:y,currentPerson:m,assignments:re,areaLeadAreaIds:w,isAreaLead:x,allLocations:Q,areas:K,terms:t,termsLower:n,areaLeadRef:oe,areaLeadCheckpoints:Ce,sectionLastLoadedAt:ee,updateCachedField:eu,updatePendingCount:s}),{userLocation:Et,locationLastUpdated:yo,startLocationTracking:ko,stopLocationTracking:ft}=fY(),{showLocationUpdateModal:Pt,updatingLocationFor:vt,locationUpdateError:An,locationUpdateSuccess:Ao,updatingLocation:ao,autoUpdateEnabled:bo,selectingLocationOnMap:Gt,openLocationUpdateModal:As,closeLocationUpdateModal:wo,startMapLocationSelect:zo,cancelMapLocationSelect:pe,updateDynamicCheckpointLocation:ve,updateLocationWithGps:Ie,updateLocationFromCheckpoint:lt,toggleAutoUpdate:Qe,stopAutoUpdate:Ft,startDynamicCheckpointPolling:an,stopDynamicCheckpointPolling:yn,startAllCheckpointsPolling:_n,stopAllCheckpointsPolling:_o}=vY({eventId:l,allLocations:Q,userLocation:Et,locationLastUpdated:yo});let Ho=null;const Vo=async()=>{zo(),Ho=X.value,X.value="map",await rn(),ro.value?.openFullscreen?.()},Ma=()=>{Ho&&(X.value=Ho,Ho=null)},dl=()=>{pe(),ro.value?.mapRef?.closeFullscreen?.(),Ma()},{expandedAreaLeadMarshal:hl,savingAreaLeadMarshalTask:ki,areaLeadMarshalDataVersion:Go,allAreaLeadMarshals:qo,toggleAreaLeadMarshalExpansion:Aa,toggleAreaLeadMarshalTask:Es}=wY({eventId:l,currentMarshalId:y,areaLeadRef:oe,areaLeadCheckpoints:Ce,areaChecklistItems:ke,myChecklistItems:fe,areaLeadAreaIds:w,loadChecklist:ht}),{checkingIn:Vn,checkingInAssignment:bi,checkInError:Gn,showCheckInReminderModal:jo,checkInReminderCheckpoint:os,dismissedCheckInReminders:Ys,showDistanceWarning:io,distanceWarningMessage:Js,isCheckInStale:qn,handleCheckInToggle:Wo,handleAreaLeadMarshalCheckIn:bt,dismissCheckInReminder:Dt,dismissDistanceWarning:jn}=mY({eventId:l,assignments:re,allLocations:Q,areaLeadRef:oe,areaLeadCheckpoints:Ce,areaLeadMarshalDataVersion:Go,updatePendingCount:s,updateCachedField:eu,reloadChecklist:ht,checklistItems:ge,currentMarshalId:y}),On=D(!1),Nn=D(!1),ss=D(""),pt=D(""),Vt=D(null),Co=D(!1),Lo=D(""),Cn=D(""),Xs=(Te,Le)=>{Lo.value=Te,Cn.value=Le,Co.value=!0},Eo=D(!1),So=D(""),en=D(""),Wn=D(!1),lo=D(""),Ps=async Te=>{en.value=Te.name||Te.marshalName||"",So.value="",lo.value="",Wn.value=!0,Eo.value=!0;try{const Le=await bs.getMagicLink(l.value,Te.marshalId);So.value=Le.data.magicLink,Wn.value=!1}catch(Le){Wn.value=!1,lo.value=Le.response?.data?.message||"Failed to load magic link"}},{myIncidents:Ea,incidentsLoading:Qs,selectedIncident:wi,showIncidentDetail:Pa,showAddIncidentNoteModal:Da,incidentNoteText:Ds,submittingIncidentNote:Ra,showReportIncident:Rs,loadMyIncidents:_i,handleReportIncident:Ci,openIncidentDetail:ur,handleIncidentStatusChange:wt,openAddIncidentNoteModal:Rt,closeAddIncidentNoteModal:Ut,submitIncidentNote:Oa}=gY({eventId:l,currentMarshalId:y,isAreaLead:x,areaLeadAreaIds:w,sectionLastLoadedAt:ee,showMessage:Xs}),ro=D(null),Li=H(()=>ro.value),ea=D(null),as=Te=>!Te||Te.length===0?!1:Te.some(Le=>w.value.includes(Le)),Zn=Te=>{ea.value=ea.value===Te?null:Te},kn=Te=>{const Le=X.value===Te;if(X.value=Le?null:Te,!Le){const ot=Date.now(),gt=Ct=>ot-ee.value[Ct]>sJ;switch(Te){case"checklist":gt("checklist")&&ht();break;case"notes":gt("notes")&&za();break;case"incidents":gt("incidents")&&_i();break;case"eventContacts":gt("eventContacts")&&sa();break}}},qt=D(null),co=Te=>{qt.value=qt.value===Te?null:Te},fl=H(()=>X.value==="map"||X.value==="assignments"&&qt.value!==null);Ye(fl,Te=>{Te?_n():_o()});const xn=H(()=>re.value.map(Te=>{const Le=Q.value.find(At=>At.id===Te.locationId),ot=Le?.areaIds||Le?.AreaIds||[];let gt=null;ot.length>0&&K.value.length>0&&(gt=K.value.find(un=>ot.includes(un.id))?.name);const Xt=(Le?.assignments||[]).map(At=>({...At,effectiveIsCheckedIn:At.isCheckedIn&&!qn(At.checkInTime)})).sort((At,un)=>(At.marshalName||"").localeCompare(un.marshalName||"",void 0,{sensitivity:"base"})),tn=Bs.value.filter(At=>ot.includes(At.areaId)&&(!At.marshalId||At.marshalId!==y.value)),on=new Set,bn=tn.filter(At=>{const un=JSON.stringify({name:At.name||"",marshalId:At.marshalId||"",role:At.role||"",phone:At.phone||"",email:At.email||"",notes:At.notes||""});return on.has(un)?!1:(on.add(un),!0)}).sort((At,un)=>(At.marshalName||At.name||"").localeCompare(un.marshalName||un.name||"",void 0,{sensitivity:"base"})),pn=Te.isCheckedIn&&!qn(Te.checkInTime);return{...Te,location:Le,areaName:gt,areaIds:ot,allMarshals:Xt,areaContacts:bn,locationName:Le?.name||"Unknown Location",effectiveIsCheckedIn:pn}})),{courseMapActions:ta,hideOtherCheckpoints:Os,handleCourseMapVisibilityChange:Na,handleCourseMapAction:pl,getCheckpointMapActions:Si,handleCheckpointMapVisibilityChange:$t,handleCheckpointMapAction:vl}=bY({userLocation:Et,assignmentsWithDetails:xn,courseMapRef:Li}),En=H(()=>re.value.length>0?re.value[0]:null),is=H(()=>re.value.map(Te=>Te.locationId)),ml=H(()=>Os.value?Q.value.filter(Te=>{const Le=is.value.includes(Te.id),ot=Te.isDynamic||Te.IsDynamic;return Le||ot}):Q.value),Ii=H(()=>xn.value.some(Te=>Te.location?.isDynamic||Te.location?.IsDynamic)),ls=H(()=>xn.value.find(Te=>Te.location?.isDynamic||Te.location?.IsDynamic)),xi=H(()=>{const Te=ls.value;if(!Te)return!1;const Le=Te.location,ot=Le?.locationUpdateScopeConfigurations||Le?.LocationUpdateScopeConfigurations||[];return e1({scopeConfigurations:ot,marshalId:y.value,marshalAssignmentLocationIds:is.value,areaLeadAreaIds:w.value,locationId:Te.locationId,locationAreaIds:Te.areaIds||[]})}),gl=H(()=>{if(!Z.value||!xn.value.length)return[];const Te=new Date,Le=Z.value.eventDate?new Date(Z.value.eventDate):null;return xn.value.filter(ot=>{if(ot.effectiveIsCheckedIn||Ys.value.has(ot.id))return!1;const gt=ot.location;if(!gt)return!1;const Ct=gt.startTime?new Date(gt.startTime):Le;if(!Ct)return!1;let Xt;if(gt.endTime)Xt=new Date(gt.endTime);else if(Le)Xt=new Date(Le.getTime()+7200*1e3);else return!1;return Te>=Ct&&Te<Xt})});Ye(gl,Te=>{Te.length>0&&!jo.value&&(os.value=Te[0],jo.value=!0)},{immediate:!0}),Ye(io,Te=>{Te&&(Xs("Distance notice",Js.value),jn())});const dr=()=>{const Te=os.value;Te&&(Dt(Te.id),X.value="assignments",qt.value=Te.id)},na=H(()=>Z.value?.route?(typeof Z.value.route=="string"?JSON.parse(Z.value.route):Z.value.route)||[]:[]),oa=H(()=>!En.value||!Q.value.length?null:Q.value.find(Te=>Te.id===En.value.locationId)),Ns=D([]),Pn=D(!1),$i=H(()=>{const Te=Ns.value.filter(gt=>!gt.marshalId||gt.marshalId!==y.value),Le=new Set;return Te.filter(gt=>{const Ct=JSON.stringify({name:gt.name||"",marshalId:gt.marshalId||"",role:gt.role||"",phone:gt.phone||"",email:gt.email||"",notes:gt.notes||""});return Le.has(Ct)?!1:(Le.add(Ct),!0)}).sort((gt,Ct)=>{if(gt.isPinned!==Ct.isPinned)return gt.isPinned?-1:1;const Xt=gt.displayOrder||0,tn=Ct.displayOrder||0;return Xt!==tn?Xt-tn:(gt.name||"").localeCompare(Ct.name||"",void 0,{sensitivity:"base"})})}),Ti=H(()=>$i.value.filter(Te=>Te.showInEmergencyInfo)),Po=H(()=>Be.value.filter(Te=>Te.showInEmergencyInfo)),yl=H(()=>Ti.value.length>0||Po.value.length>0),kl=Te=>{if(!Be.value||Be.value.length===0)return[];const Le=[],ot=new Set;for(const Ct of Be.value){const Xt=Ct.noteId||Ct.NoteId||Ct.id;if(ot.has(Xt))continue;const tn=Ct.scopeConfigurations||Ct.ScopeConfigurations||[];let on=!1;if(tn.length>0)for(const bn of tn){const pn=bn.itemType||bn.ItemType,At=bn.ids||bn.Ids||[];if(pn==="Checkpoint"&&(At.includes(Te)||At.includes("ALL_CHECKPOINTS"))){on=!0;break}}else{const bn=Ct.matchedScope||Ct.MatchedScope||"";["EveryoneAtCheckpoints","Checkpoint"].some(At=>bn.includes(At)||bn===At)&&(on=!0)}on&&(ot.add(Xt),Le.push(Ct))}const gt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Le.sort((Ct,Xt)=>{const tn=Ct.isPinned||Ct.IsPinned,on=Xt.isPinned||Xt.IsPinned;if(tn&&!on)return-1;if(!tn&&on)return 1;const bn=gt[Ct.priority||Ct.Priority||"Normal"]??3,pn=gt[Xt.priority||Xt.Priority||"Normal"]??3;if(bn!==pn)return bn-pn;const At=Ct.displayOrder||Ct.DisplayOrder||0,un=Xt.displayOrder||Xt.DisplayOrder||0;if(At!==un)return At-un;const vr=Ct.createdAt||Ct.CreatedAt,la=Xt.createdAt||Xt.CreatedAt;return new Date(la)-new Date(vr)})},Bs=D([]),Ba=(Te,Le)=>Te.localeCompare(Le,void 0,{numeric:!0,sensitivity:"base"}),Fa=H(()=>{if(!vt.value)return[];const Te=vt.value.locationId;return Q.value.filter(Le=>Le.id!==Te&&Le.latitude!==0&&Le.longitude!==0).sort((Le,ot)=>Ba(Le.name,ot.name))}),bl=H(()=>oa.value?{lat:oa.value.latitude,lng:oa.value.longitude}:Et.value?Et.value:Q.value.length>0?{lat:Q.value[0].latitude,lng:Q.value[0].longitude}:{lat:51.505,lng:-.09}),hr=Te=>{if(Z.value=Te.event,K.value=Te.areas||[],Q.value=Te.locations||[],ge.value=Te.checklist||[],Ns.value=Te.contacts||[],Be.value=Te.notes||[],Fe.value=Te.roles||[],Te.areaLeadDashboard?.checkpoints&&(Ce.value=Te.areaLeadDashboard.checkpoints),Z.value&&Zh(Z.value),y.value){const Le=[];for(const ot of Q.value){const gt=ot.assignments?.find(Ct=>Ct.marshalId===y.value);gt&&Le.push(gt)}re.value=Le}},wl=async()=>{const Te=o.params.eventId;console.log("Loading event data for:",{eventId:Te,marshalId:y.value});const Le=await di(Te);let ot=!1;if(Le&&(console.log("Loaded cached data from:",Le.cachedAt),hr(Le),ot=!0,ae.value=!1),Jn())if(ot){console.log("Offline mode - using cached data");return}else{console.warn("No cached data available while offline");return}ot&&(q.value=!0),console.log("Fetching fresh event data in parallel...");const[gt,Ct,Xt]=await Promise.allSettled([ii.getById(Te),ga.getByEvent(Te),$r.getEventStatus(Te)]);if(gt.status==="fulfilled"?(Z.value=gt.value.data,console.log("Event loaded:",Z.value?.name),Z.value&&(Zh(Z.value),$(Te,Z.value.name,Z.value.eventDate))):console.error("Failed to load event:",gt.reason),Ct.status==="fulfilled"?(K.value=Ct.value.data||[],console.log("Areas loaded:",K.value.length)):console.error("Failed to load areas:",Ct.reason),Xt.status==="fulfilled"){if(Q.value=Xt.value.data?.locations||[],console.log("Locations loaded:",Q.value.length),y.value){const on=[];for(const bn of Q.value){const pn=bn.assignments?.find(At=>At.marshalId===y.value);pn&&on.push(pn)}re.value=on,console.log("Total assignments found:",re.value.length)}}else console.error("Failed to load event status:",Xt.reason);const tn=[ht(),sa(),za(),_i(),Ha()];x.value&&tn.push(fr()),await Promise.allSettled(tn);try{const on={event:Z.value,areas:K.value,locations:Q.value,checklist:ge.value,contacts:Ns.value,notes:Be.value,roles:Fe.value,marshalId:y.value};Ce.value.length>0&&(on.areaLeadDashboard={checkpoints:Ce.value});const bn=JSON.parse(JSON.stringify(on));await lc(Te,bn),console.log("Event data cached for offline access")}catch(on){console.warn("Failed to cache event data:",on)}an(),q.value=!1};c.onAuthSuccess=wl;const Ua=async()=>{const Te=o.params.eventId;if(Jn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Le=await ga.getAreaLeadDashboard(Te);if(Le.data){Ce.value=Le.data.checkpoints||[];const ot=JSON.parse(JSON.stringify({areas:Le.data.areas||[],checkpoints:Le.data.checkpoints||[]}));await di(Te)?await eu(Te,"areaLeadDashboard",ot):await lc(Te,{areaLeadDashboard:ot}),console.log("Area lead dashboard cached for offline access")}}catch(Le){Le.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Le)}console.log("Background preload complete")},fr=async()=>{const Te=o.params.eventId;try{const Le=await ga.getAreaLeadDashboard(Te);Le.data?.checkpoints&&(Ce.value=Le.data.checkpoints,console.log("Area lead dashboard loaded:",Ce.value.length,"checkpoints"))}catch(Le){Le.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Le)}},za=async()=>{const Te=o.params.eventId;try{const Le=await ys.getMyNotes(Te);Be.value=Le.data||[],ee.value.notes=Date.now(),console.log("Notes loaded:",Be.value.length)}catch(Le){console.error("Failed to load notes:",Le)}},sa=async()=>{const Te=o.params.eventId;Pn.value=!0;try{const Le=await da.getMyContacts(Te);Ns.value=Le.data||[],ee.value.eventContacts=Date.now(),console.log("Contacts loaded:",Ns.value.length)}catch(Le){console.warn("Failed to load contacts:",Le),Ns.value=[]}finally{Pn.value=!1}},Ha=async()=>{const Te=o.params.eventId;try{const Le=await Qa.getMyRoles(Te);Fe.value=Le.data||[],console.log("Roles loaded:",Fe.value.length)}catch(Le){console.warn("Failed to load roles:",Le),Fe.value=[]}},rs=()=>{Nn.value=!1,Vt.value&&(Vt.value(),Vt.value=null)},pr=()=>{Nn.value=!1,Vt.value=null},aa=()=>{Co.value=!1},Bn=async Te=>{if(Gt.value&&vt.value){await ve(vt.value.locationId,Te.lat,Te.lng,"manual"),Gt.value=!1,vt.value=null,ro.value?.mapRef?.closeFullscreen?.(),Ma();return}if(xi.value&&ls.value){const Le=ls.value;ss.value="Update location",pt.value=`Update ${Le.location?.name||"dynamic checkpoint"} to this location?`,Vt.value=async()=>{await ve(Le.locationId,Te.lat,Te.lng,"manual"),ro.value?.mapRef?.closeFullscreen?.()},Nn.value=!0}},ia=async Te=>{if(Gt.value&&vt.value){if(Te.id===vt.value.locationId)return;await ve(vt.value.locationId,Te.latitude,Te.longitude,"checkpoint",Te.id),Gt.value=!1,ro.value?.mapRef?.closeFullscreen?.(),Ma();return}if(xi.value&&ls.value){const Le=ls.value;if(Te.id===Le.locationId)return;ss.value="Copy location",pt.value=`Copy location from "${Te.name}" to ${Le.location?.name||"your dynamic checkpoint"}?`,Vt.value=async()=>{await ve(Le.locationId,Te.latitude,Te.longitude,"checkpoint",Te.id),ro.value?.mapRef?.closeFullscreen?.()},Nn.value=!0}},Va=()=>{S(()=>{re.value=[],ge.value=[],Bs.value=[]})},cs=Te=>Te?new Date(Te).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return cn(async()=>{ov(!0);const Te=o.params.eventId,Le=o.query.code;ae.value=!0;try{Le?await _(Te,Le):await C(Te)&&await wl()}finally{ae.value=!1}d.value&&(ko(),"requestIdleCallback"in window?requestIdleCallback(()=>{Ua()},{timeout:5e3}):setTimeout(()=>{Ua()},2e3))}),Ye(d,Te=>{Te?ko():ft()}),Ye(()=>o.query.code,async Te=>{if(Te&&d.value){ae.value=!0;try{await _(o.params.eventId,Te)}finally{ae.value=!1}}}),Ye(Z,Te=>{Te&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),In(()=>{T(),Ft(),yn(),_o(),ov(!1)}),(Te,Le)=>(p(),g("div",{class:"marshal-view",style:tt(B(Y))},[Pe(YV),r("header",{class:le(["header",`logo-${B(z)}`]),style:tt(B(te))},[B(be)&&B(z)==="cover"?(p(),g("div",xY,[r("img",{src:B(be),alt:"Event logo",class:"header-logo-cover-img"},null,8,$Y)])):P("",!0),B(d)&&B(z)==="right"?(p(),g("button",{key:1,onClick:Va,class:"btn-close-session btn-close-left",style:tt({color:B(ue)}),title:"Close session"},"  ",4)):P("",!0),B(be)&&B(z)==="left"?(p(),g("div",TY,[r("img",{src:B(be),alt:"Event logo",class:"header-logo-img"},null,8,MY)])):P("",!0),r("div",AY,[r("div",{class:"header-title",style:tt({color:B(ue)})},[Z.value?(p(),g("h1",EY,b(Z.value.name),1)):P("",!0),Z.value?.eventDate?(p(),g("div",PY,[Je(b(cs(Z.value.eventDate))+" ",1),B(G)&&B(Ae)?(p(),g("span",{key:0,class:"header-weather",title:B(Ae).description},[Pe(IY,{icon:B(Ae).icon,size:18,alt:B(Ae).description,color:B(ue)},null,8,["icon","alt","color"]),r("span",RY,b(B(Ae).tempMax)+""+b(B(Ae).unit),1)],8,DY)):P("",!0)])):P("",!0)],4),B(d)?(p(),g("div",OY,[r("button",{onClick:Le[0]||(Le[0]=ot=>Rs.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),yl.value?(p(),g("button",{key:0,onClick:Le[1]||(Le[1]=ot=>On.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):P("",!0)])):P("",!0)]),B(be)&&B(z)==="right"?(p(),g("div",NY,[r("img",{src:B(be),alt:"Event logo",class:"header-logo-img"},null,8,BY)])):P("",!0),B(d)&&B(z)!=="right"?(p(),g("button",{key:4,onClick:Va,class:"btn-close-session btn-close-right",style:tt({color:B(ue)}),title:"Close session"},"  ",4)):P("",!0)],6),r("div",FY,[ae.value?(p(),g("div",UY,[...Le[25]||(Le[25]=[r("div",{class:"loading"},"Loading...",-1)])])):!B(d)&&!B(f)?(p(),g("div",zY,[Le[26]||(Le[26]=r("h2",null,"Welcome",-1)),Le[27]||(Le[27]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),B(h)?(p(),g("p",HY,"Authenticating...")):P("",!0)])):B(f)?(p(),g("div",VY,[Le[28]||(Le[28]=r("h2",null,"Login failed",-1)),r("p",GY,b(B(f)),1),Le[29]||(Le[29]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(p(),g("div",qY,[B(A)||B(E)?(p(),g("div",jY,[r("div",WY,[B(m)?.email?(p(),g("span",ZY,b(B(m).email),1)):P("",!0)]),B(A)?(p(),g("div",KY,[r("button",{onClick:Le[2]||(Le[2]=(...ot)=>B(R)&&B(R)(...ot)),class:"btn-mode-switch"}," Switch to Admin ")])):B(E)?(p(),g("div",YY,[...Le[30]||(Le[30]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),r("div",JY,[Pe(cY,{roles:Fe.value,"is-expanded":X.value==="roles",onToggle:Le[3]||(Le[3]=ot=>kn("roles"))},null,8,["roles","is-expanded"]),xn.value.length>0?(p(),Ge(XK,{key:0,ref:"assignmentsSectionRef","is-expanded":X.value==="assignments",assignments:xn.value,"expanded-checkpoint-id":qt.value,"all-locations":Q.value,route:na.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,"user-location":B(Et),"has-dynamic-assignment":Ii.value,"current-marshal-id":B(y),"current-marshal-name":B(k),"checking-in-id":B(Vn),"checking-in-assignment-id":B(bi),"check-in-error":B(Gn),"checking-in-marshal-id":B(Vn),"expanded-marshal-id":ea.value,"updating-location":B(ao),"auto-update-enabled":B(bo),"get-toolbar-actions":B(Si),"is-area-lead-for-areas":as,"get-notes-for-checkpoint":kl,"area-lead-area-ids":B(w),onToggle:Le[4]||(Le[4]=ot=>kn("assignments")),onToggleCheckpoint:co,onMapClick:Bn,onLocationClick:ia,onActionClick:B(vl),onVisibilityChange:B($t),onUpdateLocation:B(As),onCheckIn:Le[5]||(Le[5]=ot=>B(Wo)(ot,!0)),onToggleMarshal:Zn,onMarshalCheckIn:Le[6]||(Le[6]=(ot,gt)=>B(Wo)(ot,!1,gt)),onToggleAutoUpdate:B(Qe),onShowMarshalQr:Ps},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","route-color","route-style","route-weight","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"])):P("",!0),B(fe).length>0||B(ke).length>0?(p(),Ge(pj,{key:1,loading:B(Ne),error:B(Oe),"is-expanded":X.value==="checklist","is-area-lead":B(x),"led-area-count":B(w).length,"my-items":B(fe),"area-items":B(ke),"area-items-with-local-state":B(ne),"visible-items":B(Ze),"grouped-items":B(ct),"completed-count":B(qe),saving:B(xe),"effective-group-by":B(He),"expanded-group":B(me),locations:Q.value,areas:K.value,marshals:B(ye),"get-context-name":B(Bt),onToggle:Le[7]||(Le[7]=ot=>kn("checklist")),onToggleItem:B(Nt),onToggleGroup:B(Lt)},null,8,["loading","error","is-expanded","is-area-lead","led-area-count","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"])):P("",!0),Be.value.length>0?(p(),Ge(_j,{key:2,"event-id":B(o).params.eventId,notes:Be.value,locations:Q.value,areas:K.value,assignments:re.value,"is-expanded":X.value==="notes",onToggle:Le[8]||(Le[8]=ot=>kn("notes")),onNotesChanged:za},null,8,["event-id","notes","locations","areas","assignments","is-expanded"])):P("",!0),$i.value.length>0?(p(),Ge(eq,{key:3,contacts:$i.value,loading:Pn.value,"is-expanded":X.value==="eventContacts",onToggle:Le[9]||(Le[9]=ot=>kn("eventContacts"))},null,8,["contacts","loading","is-expanded"])):P("",!0),Pe(dq,{incidents:B(Ea),loading:B(Qs),"is-expanded":X.value==="incidents",onToggle:Le[10]||(Le[10]=ot=>kn("incidents")),onSelectIncident:B(ur)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Pe(nZ,{ref_key:"areaLeadSectionRef",ref:Ee,"is-area-lead":B(x),"is-expanded":X.value==="areaLead",areas:M.value,"selected-filters":O.value,"filtered-area-ids":U.value,"event-id":B(o).params.eventId,"marshal-id":B(y),route:na.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onToggle:Le[11]||(Le[11]=ot=>kn("areaLead")),onToggleFilter:F,onChecklistUpdated:B(ht)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","route-color","route-style","route-weight","onChecklistUpdated"]),Pe(OZ,{"is-area-lead":B(x),"is-expanded":X.value==="areaLeadMarshals",marshals:B(qo),"expanded-marshal-id":B(hl),"checking-in-marshal-id":B(Vn),"saving-task":B(ki),"current-marshal-id":B(y),locations:Q.value,areas:K.value,onToggle:Le[12]||(Le[12]=ot=>kn("areaLeadMarshals")),onToggleMarshal:B(Aa),onCheckIn:B(bt),onToggleTask:B(Es),onShowQr:Ps},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","current-marshal-id","locations","areas","onToggleMarshal","onCheckIn","onToggleTask"]),Pe(Pj,{ref_key:"routeSectionRef",ref:ro,"is-expanded":X.value==="map","user-location":B(Et),"selecting-location":B(Gt),"selecting-location-name":B(vt)?.location?.name||"",locations:ml.value,route:na.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,center:bl.value,"highlight-location-ids":is.value,clickable:B(Gt)||xi.value,"toolbar-actions":B(ta),onToggle:Le[13]||(Le[13]=ot=>kn("map")),onCancelSelect:dl,onMapClick:Bn,onLocationClick:ia,onActionClick:B(pl),onVisibilityChange:B(Na)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","route-color","route-style","route-weight","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Pe(Cq,{"event-date":Z.value?.eventDate,description:Z.value?.description,"is-expanded":X.value==="eventDetails",onToggle:Le[14]||(Le[14]=ot=>kn("eventDetails"))},null,8,["event-date","description","is-expanded"])]),q.value?(p(),g("div",XY,[...Le[31]||(Le[31]=[r("span",{class:"refresh-spinner"},null,-1),r("span",null,"Updating...",-1)])])):P("",!0),r("div",{class:"logged-in-info",style:tt({color:B(_e)})}," Logged in as "+b(B(k)),5)]))]),Pe(OV,{show:On.value,contacts:Ti.value,notes:Po.value,onClose:Le[15]||(Le[15]=ot=>On.value=!1)},null,8,["show","contacts","notes"]),Pe(x1,{show:B(Rs),"event-id":l.value||"",checkpoint:j.value,"initial-location":B(Et),checkpoints:Q.value,route:na.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onClose:Le[16]||(Le[16]=ot=>Rs.value=!1),onSubmit:B(Ci)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","route-color","route-style","route-weight","onSubmit"]),Pe(I1,{show:B(Pa),incident:B(wi),route:na.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,checkpoints:Q.value,"can-manage":B(x),onClose:Le[17]||(Le[17]=ot=>Pa.value=!1),onStatusChange:B(wt),onOpenAddNote:B(Rt)},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Pe(Yt,{show:B(Da),title:"Add update",size:"small",onClose:B(Ut)},{footer:Ve(()=>[r("div",eJ,[r("button",{type:"button",class:"btn btn-secondary",onClick:Le[19]||(Le[19]=(...ot)=>B(Ut)&&B(Ut)(...ot))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Le[20]||(Le[20]=(...ot)=>B(Oa)&&B(Oa)(...ot)),disabled:!B(Ds).trim()||B(Ra)},b(B(Ra)?"Adding...":"Add update"),9,tJ)])]),default:Ve(()=>[r("div",QY,[We(r("textarea",{"onUpdate:modelValue":Le[18]||(Le[18]=ot=>hn(Ds)?Ds.value=ot:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,B(Ds)]])])]),_:1},8,["show","onClose"]),Pe(mi,{show:Nn.value,title:ss.value,message:pt.value,onConfirm:rs,onCancel:pr},null,8,["show","title","message"]),Pe(mi,{show:Co.value,title:Lo.value,message:Cn.value,"show-cancel":!1,onConfirm:aa},null,8,["show","title","message"]),Pe(aG,{show:B(jo),checkpoint:B(os),"accent-button-style":B(Re),onDismiss:Le[21]||(Le[21]=ot=>B(Dt)(B(os)?.id)),onGoToCheckpoint:dr},null,8,["show","checkpoint","accent-button-style"]),Pe(EG,{show:B(Pt),assignment:B(vt),"user-location":B(Et),"auto-update-enabled":B(bo),updating:B(ao),error:B(An),success:B(Ao),"available-checkpoints":Fa.value,"accent-button-style":B(Re),onClose:B(wo),onUpdateGps:B(Ie),onToggleAutoUpdate:Le[22]||(Le[22]=ot=>B(Qe)(B(vt))),onSelectOnMap:Vo,onCopyFromCheckpoint:B(lt)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"]),!Wn.value&&!lo.value&&So.value?(p(),Ge(Uf,{key:0,show:Eo.value,url:So.value,title:`Magic link for ${en.value}`,warning:`Only share this QR code with ${en.value}. This link provides full access to their ${B(n).person} dashboard.`,"z-index":1100,onClose:Le[23]||(Le[23]=ot=>Eo.value=!1)},null,8,["show","url","title","warning"])):P("",!0),Wn.value||lo.value?(p(),Ge(Yt,{key:1,show:Eo.value,title:`Magic link for ${en.value}`,size:"small","z-index":1100,onClose:Le[24]||(Le[24]=ot=>Eo.value=!1)},{default:Ve(()=>[Wn.value?(p(),g("div",nJ,[...Le[32]||(Le[32]=[r("p",null,"Loading magic link...",-1)])])):lo.value?(p(),g("div",oJ,[r("p",null,b(lo.value),1)])):P("",!0)]),_:1},8,["show","title"])):P("",!0)],4))}},iJ=Ke(aJ,[["__scopeId","data-v-d7d5ff4b"]]),lJ={class:"form-group"},rJ={class:"form-group"},cJ={class:"form-group"},uJ={class:"actions-left"},dJ={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const n=e,s=t,o=D({name:"",email:"",phone:""});Ye(()=>n.profile,h=>{h&&(o.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ye(()=>n.show,h=>{h&&n.profile&&(o.value={name:n.profile.name||"",email:n.profile.email||"",phone:n.profile.phone||""})});const i=()=>{s("update:isDirty",!0)},l=()=>{if(!o.value.name.trim()){alert("Name is required");return}if(!o.value.email.trim()){alert("Email is required");return}s("submit",{name:o.value.name.trim(),email:o.value.email.trim(),phone:o.value.phone?.trim()||""})},c=()=>{s("close")},d=()=>{s("logout")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("div",uJ,[e.showLogout?(p(),g("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):P("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:rt(l,["prevent"])},[r("div",lJ,[f[3]||(f[3]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>o.value.name=m),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,o.value.name]])]),r("div",rJ,[f[4]||(f[4]=r("label",null,"Email *",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>o.value.email=m),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,o.value.email]])]),r("div",cJ,[f[5]||(f[5]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>o.value.phone=m),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,o.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},hJ=Ke(dJ,[["__scopeId","data-v-178e5f48"]]),fJ={class:"tabs"},pJ={class:"tab-content"},vJ={class:"form-group"},mJ={class:"form-group"},gJ={class:"form-group"},yJ={class:"form-group"},kJ=["value"],bJ={class:"tab-content"},wJ={class:"emergency-contacts-section"},_J={key:0,class:"empty-state"},CJ={class:"card-header"},LJ=["onClick"],SJ={class:"form-group"},IJ=["onUpdate:modelValue"],xJ={class:"form-group"},$J=["onUpdate:modelValue"],TJ={class:"form-group"},MJ=["onUpdate:modelValue"],AJ={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const n=e,s=t,{activeTab:o,switchTab:i,resetTab:l}=Ky("basic",["basic","emergency"]),c=D({...n.eventData});Ye(()=>n.eventData,y=>{c.value={...y},c.value.emergencyContacts||(c.value.emergencyContacts=[])},{deep:!0}),Ye(()=>n.show,y=>{y&&l()});const d=()=>{c.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{c.value.emergencyContacts.splice(y,1)},f=()=>{s("submit",{...c.value})},m=()=>{s("close")};return(y,k)=>(p(),Ge(Yt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Ve(()=>[r("div",fJ,[r("button",{type:"button",onClick:k[0]||(k[0]=w=>B(i)("basic")),class:le(["tab-button",{active:B(o)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=w=>B(i)("emergency")),class:le(["tab-button",{active:B(o)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:rt(f,["prevent"])},[We(r("div",pJ,[r("div",vJ,[k[6]||(k[6]=r("label",null,"Event name *",-1)),We(r("input",{"onUpdate:modelValue":k[2]||(k[2]=w=>c.value.name=w),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",mJ,[k[7]||(k[7]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=w=>c.value.description=w),rows:"3",class:"form-input"},null,512),[[st,c.value.description]])]),r("div",gJ,[k[8]||(k[8]=r("label",null,"Event date *",-1)),We(r("input",{"onUpdate:modelValue":k[4]||(k[4]=w=>c.value.eventDate=w),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,c.value.eventDate]])]),r("div",yJ,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),We(r("select",{"onUpdate:modelValue":k[5]||(k[5]=w=>c.value.timeZoneId=w),required:"",class:"form-input"},[(p(!0),g(Se,null,je(B(g1),w=>(p(),g("option",{key:w.value,value:w.value},b(w.label),9,kJ))),128))],512),[[no,c.value.timeZoneId]])])],512),[[ns,B(o)==="basic"]]),We(r("div",bJ,[r("div",wJ,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),c.value.emergencyContacts.length===0?(p(),g("div",_J,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(p(!0),g(Se,null,je(c.value.emergencyContacts,(w,x)=>(p(),g("div",{key:x,class:"emergency-contact-card"},[r("div",CJ,[r("h4",null,"Contact "+b(x+1),1),r("button",{type:"button",onClick:A=>h(x),class:"btn-remove"},"  ",8,LJ)]),r("div",SJ,[k[12]||(k[12]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":A=>w.name=A,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,IJ),[[st,w.name]])]),r("div",xJ,[k[13]||(k[13]=r("label",null,"Phone *",-1)),We(r("input",{"onUpdate:modelValue":A=>w.phone=A,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,$J),[[st,w.phone]])]),r("div",TJ,[k[14]||(k[14]=r("label",null,"Additional details",-1)),We(r("textarea",{"onUpdate:modelValue":A=>w.details=A,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,MJ),[[st,w.details]])])]))),128))])],512),[[ns,B(o)==="emergency"]])],32)]),_:1},8,["show","title"]))}},EJ=Ke(AJ,[["__scopeId","data-v-d820eb4f"]]),PJ=Sf("profile",()=>{const e=D(null),t=D(!1),n=D(null);return{profile:e,loading:t,error:n,fetchProfile:async()=>{t.value=!0,n.value=null;try{const d=await Fc.getProfile();return e.value=d.data,d.data}catch(d){throw n.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,n.value=null;try{const h=await Fc.updateProfile(d);return e.value=h.data,h.data}catch(h){throw n.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,n.value=null;try{return(await Fc.getPerson(d,h)).data}catch(f){throw n.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,n.value=null;try{return(await Fc.updatePerson(d,h,f)).data}catch(m){throw n.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,n.value=null}}}),DJ={class:"sessions-view"},RJ={class:"sessions-container"},OJ={key:0,class:"loading-state"},NJ={key:1,class:"empty-state"},BJ={key:2,class:"sessions-list"},FJ={class:"section-header"},UJ={class:"section-actions"},zJ=["onClick"],HJ={class:"session-info"},VJ={class:"event-name"},GJ={key:0,class:"event-date"},qJ={key:1,class:"sign-in-section"},jJ={key:2,class:"section-header"},WJ=["onClick"],ZJ={class:"session-info"},KJ={class:"event-name"},YJ={class:"role-name"},JJ={key:0,class:"event-date"},XJ=["onClick"],QJ={class:"modal-card"},eX={class:"modal-actions"},tX={class:"modal-card"},nX={class:"modal-actions"},oX={__name:"SessionsView",setup(e){const t=ir(),n=mc(),s=Zy(),o=PJ(),i=D([]),l=D([]),c=D(!0),d=D(!1),h=D(!1),f=D(!1),m=D(!1),y=D(null),k=D(!1),w=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),x=H(()=>localStorage.getItem("adminEmail")),A=H(()=>!!x.value),E=()=>{i.value=Fw()},_=ae=>{py(ae.eventId,ae.marshalId),t.push(`/event/${ae.eventId}`)},C=ae=>{y.value=ae,f.value=!0},S=async()=>{if(!y.value)return;const{sessionKey:ae,eventId:q}=y.value;try{No("marshal",q),await authApi.logout()}catch{}Uh(ae),No(null),E(),f.value=!1,y.value=null},$=()=>{m.value=!0},R=async()=>{await n.logout(),l.value=[],m.value=!1},T=async()=>{if(h.value=!0,!o.profile)try{await o.fetchProfile()}catch(ae){console.error("Failed to load profile:",ae)}},O=async ae=>{try{await o.updateProfile(ae),h.value=!1}catch(q){console.error("Failed to save profile:",q),alert("Failed to save profile. Please try again.")}},M=async()=>{await n.logout(),l.value=[],h.value=!1},U=ae=>ae?new Date(ae).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",F=async()=>{if(A.value)try{No("admin");const ae=await ii.getAll();l.value=ae.data||[]}catch(ae){console.error("Failed to load admin events:",ae),l.value=[]}},j=ae=>{t.push(`/admin/event/${ae}`)},Z=()=>{t.push("/")},Q=()=>{},re=()=>{k.value=!1,w.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},K=async ae=>{try{const q={...ae,adminEmail:n.adminEmail};await s.createEvent(q),re(),await F()}catch(q){console.error("Failed to create event:",q),alert("Failed to create event. Please try again.")}};return cn(async()=>{document.title="OnTheDay App - Sessions",my(),vy(),E(),await F(),c.value=!1}),(ae,q)=>(p(),g("div",DJ,[r("div",RJ,[Pe(jy,{title:"Your sessions"}),c.value?(p(),g("div",OJ,[...q[9]||(q[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(p(),g("div",NJ,[q[10]||(q[10]=r("p",null,"No active sessions.",-1)),q[11]||(q[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:q[0]||(q[0]=Y=>d.value=!0)}," Sign in ")])):(p(),g("div",BJ,[A.value?(p(),g(Se,{key:0},[r("div",FJ,[q[12]||(q[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",UJ,[r("button",{class:"btn btn-small btn-primary",onClick:T}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:q[1]||(q[1]=Y=>k.value=!0)}," Create event ")])]),(p(!0),g(Se,null,je(l.value,Y=>(p(),g("div",{key:"admin-"+Y.id,class:"session-card admin-card",onClick:te=>j(Y.id)},[q[14]||(q[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",HJ,[r("div",VJ,b(Y.name),1),q[13]||(q[13]=r("div",{class:"role-name"},"Admin",-1)),Y.eventDate?(p(),g("div",GJ,b(U(Y.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:rt($,["stop"]),title:"Log out as admin"},"  ")],8,zJ))),128))],64)):(p(),g("div",qJ,[r("button",{class:"btn btn-primary",onClick:q[2]||(q[2]=Y=>d.value=!0)}," Sign in ")])),i.value.length>0?(p(),g("div",jJ,[...q[15]||(q[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):P("",!0),(p(!0),g(Se,null,je(i.value,Y=>(p(),g("div",{key:Y.sessionKey,class:"session-card",onClick:te=>_(Y)},[q[16]||(q[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",ZJ,[r("div",KJ,b(Y.eventName||"Event"),1),r("div",YJ,b(Y.marshalName||"Marshal"),1),Y.eventDate?(p(),g("div",JJ,b(U(Y.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:rt(te=>C(Y),["stop"]),title:"Log out from this session"},"  ",8,XJ)],8,WJ))),128))])),r("button",{class:"btn-back-home",onClick:Z,title:"Back to home"},"  ")]),Pe(Wy,{show:d.value,onClose:q[3]||(q[3]=Y=>d.value=!1),onSuccess:Q},null,8,["show"]),Pe(hJ,{show:h.value,profile:B(o).profile,"show-logout":!0,onClose:q[4]||(q[4]=Y=>h.value=!1),onSubmit:O,onLogout:M},null,8,["show","profile"]),Pe(EJ,{show:k.value,"event-data":w.value,"is-editing":!1,onClose:re,onSubmit:K},null,8,["show","event-data"]),(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[m.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:q[6]||(q[6]=rt(Y=>m.value=!1,["self"]))},[r("div",QJ,[q[17]||(q[17]=r("h3",null,"Log out as admin?",-1)),q[18]||(q[18]=r("p",null,"This will log you out from all admin events.",-1)),q[19]||(q[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",eX,[r("button",{class:"btn btn-secondary",onClick:q[5]||(q[5]=Y=>m.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:R},"Log out")])])])):P("",!0)]),_:1})])),(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[f.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:q[8]||(q[8]=rt(Y=>f.value=!1,["self"]))},[r("div",tX,[q[22]||(q[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[q[20]||(q[20]=Je("This will log you out from ",-1)),r("strong",null,b(y.value?.eventName||"this event"),1),q[21]||(q[21]=Je(".",-1))]),q[23]||(q[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",nX,[r("button",{class:"btn btn-secondary",onClick:q[7]||(q[7]=Y=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:S},"Log out")])])])):P("",!0)]),_:1})]))]))}},sX=Ke(oX,[["__scopeId","data-v-add55e1c"]]);let Sm=!1;function aX(){Sm||(Sm=!0,my(),vy())}const iX=[{path:"/",name:"Home",component:ZC},{path:"/admin/login",name:"AdminLogin",component:n2},{path:"/admin/verify",name:"AdminVerify",component:c2},{path:"/sessions",name:"Sessions",component:sX},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:yV,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:iJ},{path:"/:pathMatch(.*)*",redirect:"/"}],M1=Cw({history:tw("/VolunteerCheckin/testing/"),routes:iX});M1.beforeEach((e,t,n)=>{aX();const s=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!s){n({name:"AdminLogin"});return}if(e.meta.requiresAuth?No("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&No(null),e.name==="MarshalView"){const o=e.params.eventId,i=!!e.query.code,l=bu(o),c=l?.marshalId?yy(o,l.marshalId):null;if(i){n();return}if(l?.token){n();return}if(c){n();return}if(gy()){n({name:"Sessions"});return}}n()});$a().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Gf=rb(Nw);Gf.use(db());Gf.use(M1);Gf.mount("#app");
