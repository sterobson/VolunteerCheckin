(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function sf(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const en={},Kl=[],Ls=()=>{},Lm=()=>!1,Ru=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),af=e=>e.startsWith("onUpdate:"),Rn=Object.assign,lf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},N1=Object.prototype.hasOwnProperty,Wt=(e,t)=>N1.call(e,t),ut=Array.isArray,Yl=e=>cc(e)==="[object Map]",lr=e=>cc(e)==="[object Set]",Wf=e=>cc(e)==="[object Date]",_t=e=>typeof e=="function",hn=e=>typeof e=="string",xs=e=>typeof e=="symbol",Qt=e=>e!==null&&typeof e=="object",Sm=e=>(Qt(e)||_t(e))&&_t(e.then)&&_t(e.catch),Im=Object.prototype.toString,cc=e=>Im.call(e),B1=e=>cc(e).slice(8,-1),xm=e=>cc(e)==="[object Object]",Ou=e=>hn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dr=sf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Nu=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},F1=/-\w/g,ns=Nu(e=>e.replace(F1,t=>t.slice(1).toUpperCase())),U1=/\B([A-Z])/g,fi=Nu(e=>e.replace(U1,"-$1").toLowerCase()),Bu=Nu(e=>e.charAt(0).toUpperCase()+e.slice(1)),kd=Nu(e=>e?`on${Bu(e)}`:""),ii=(e,t)=>!Object.is(e,t),Wc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},$m=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Fu=e=>{const t=parseFloat(e);return isNaN(t)?e:t},z1=e=>{const t=hn(e)?Number(e):NaN;return isNaN(t)?e:t};let Zf;const Uu=()=>Zf||(Zf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],o=hn(s)?q1(s):tt(s);if(o)for(const i in o)t[i]=o[i]}return t}else if(hn(e)||Qt(e))return e}const H1=/;(?![^(]*\))/g,V1=/:([^]+)/,G1=/\/\*[^]*?\*\//g;function q1(e){const t={};return e.replace(G1,"").split(H1).forEach(n=>{if(n){const s=n.split(V1);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function le(e){let t="";if(hn(e))t=e;else if(ut(e))for(let n=0;n<e.length;n++){const s=le(e[n]);s&&(t+=s+" ")}else if(Qt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const j1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",W1=sf(j1);function Tm(e){return!!e||e===""}function Z1(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=tl(e[s],t[s]);return n}function tl(e,t){if(e===t)return!0;let n=Wf(e),s=Wf(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=xs(e),s=xs(t),n||s)return e===t;if(n=ut(e),s=ut(t),n||s)return n&&s?Z1(e,t):!1;if(n=Qt(e),s=Qt(t),n||s){if(!n||!s)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const l in e){const c=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(c&&!d||!c&&d||!tl(e[l],t[l]))return!1}}return String(e)===String(t)}function rf(e,t){return e.findIndex(n=>tl(n,t))}const Mm=e=>!!(e&&e.__v_isRef===!0),w=e=>hn(e)?e:e==null?"":ut(e)||Qt(e)&&(e.toString===Im||!_t(e.toString))?Mm(e)?w(e.value):JSON.stringify(e,Am,2):String(e),Am=(e,t)=>Mm(t)?Am(e,t.value):Yl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,o],i)=>(n[bd(s,i)+" =>"]=o,n),{})}:lr(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>bd(n))}:xs(t)?bd(t):Qt(t)&&!ut(t)&&!xm(t)?String(t):t,bd=(e,t="")=>{var n;return xs(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function K1(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Wn;class Em{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wn,!t&&Wn&&(this.index=(Wn.scopes||(Wn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Wn;try{return Wn=this,t()}finally{Wn=n}}}on(){++this._on===1&&(this.prevScope=Wn,Wn=this)}off(){this._on>0&&--this._on===0&&(Wn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Pm(e){return new Em(e)}function Dm(){return Wn}function Y1(e,t=!1){Wn&&Wn.cleanups.push(e)}let nn;const wd=new WeakSet;class Rm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wn&&Wn.active&&Wn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wd.has(this)&&(wd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Nm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Kf(this),Bm(this);const t=nn,n=Ss;nn=this,Ss=!0;try{return this.fn()}finally{Fm(this),nn=t,Ss=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)df(t);this.deps=this.depsTail=void 0,Kf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){wh(this)&&this.run()}get dirty(){return wh(this)}}let Om=0,Rr,Or;function Nm(e,t=!1){if(e.flags|=8,t){e.next=Or,Or=e;return}e.next=Rr,Rr=e}function cf(){Om++}function uf(){if(--Om>0)return;if(Or){let t=Or;for(Or=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Rr;){let t=Rr;for(Rr=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function Bm(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Fm(e){let t,n=e.depsTail,s=n;for(;s;){const o=s.prevDep;s.version===-1?(s===n&&(n=o),df(s),J1(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=o}e.deps=t,e.depsTail=n}function wh(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Um(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Um(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Jr)||(e.globalVersion=Jr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!wh(e))))return;e.flags|=2;const t=e.dep,n=nn,s=Ss;nn=e,Ss=!0;try{Bm(e);const o=e.fn(e._value);(t.version===0||ii(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{nn=n,Ss=s,Fm(e),e.flags&=-3}}function df(e,t=!1){const{dep:n,prevSub:s,nextSub:o}=e;if(s&&(s.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)df(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function J1(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Ss=!0;const zm=[];function _a(){zm.push(Ss),Ss=!1}function Ca(){const e=zm.pop();Ss=e===void 0?!0:e}function Kf(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=nn;nn=void 0;try{t()}finally{nn=n}}}let Jr=0;class X1{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class hf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!nn||!Ss||nn===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==nn)n=this.activeLink=new X1(nn,this),nn.deps?(n.prevDep=nn.depsTail,nn.depsTail.nextDep=n,nn.depsTail=n):nn.deps=nn.depsTail=n,Hm(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=nn.depsTail,n.nextDep=void 0,nn.depsTail.nextDep=n,nn.depsTail=n,nn.deps===n&&(nn.deps=s)}return n}trigger(t){this.version++,Jr++,this.notify(t)}notify(t){cf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{uf()}}}function Hm(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Hm(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const lu=new WeakMap,Ji=Symbol(""),_h=Symbol(""),Xr=Symbol("");function Yn(e,t,n){if(Ss&&nn){let s=lu.get(e);s||lu.set(e,s=new Map);let o=s.get(n);o||(s.set(n,o=new hf),o.map=s,o.key=n),o.track()}}function fa(e,t,n,s,o,i){const l=lu.get(e);if(!l){Jr++;return}const c=d=>{d&&d.trigger()};if(cf(),t==="clear")l.forEach(c);else{const d=ut(e),h=d&&Ou(n);if(d&&n==="length"){const f=Number(s);l.forEach((m,y)=>{(y==="length"||y===Xr||!xs(y)&&y>=f)&&c(m)})}else switch((n!==void 0||l.has(void 0))&&c(l.get(n)),h&&c(l.get(Xr)),t){case"add":d?h&&c(l.get("length")):(c(l.get(Ji)),Yl(e)&&c(l.get(_h)));break;case"delete":d||(c(l.get(Ji)),Yl(e)&&c(l.get(_h)));break;case"set":Yl(e)&&c(l.get(Ji));break}}uf()}function Q1(e,t){const n=lu.get(e);return n&&n.get(t)}function Nl(e){const t=Ut(e);return t===e?t:(Yn(t,"iterate",Xr),Fo(e)?t:t.map($s))}function zu(e){return Yn(e=Ut(e),"iterate",Xr),e}function Ya(e,t){return La(e)?ba(e)?tr($s(t)):tr(t):$s(t)}const ek={__proto__:null,[Symbol.iterator](){return _d(this,Symbol.iterator,e=>Ya(this,e))},concat(...e){return Nl(this).concat(...e.map(t=>ut(t)?Nl(t):t))},entries(){return _d(this,"entries",e=>(e[1]=Ya(this,e[1]),e))},every(e,t){return la(this,"every",e,t,void 0,arguments)},filter(e,t){return la(this,"filter",e,t,n=>n.map(s=>Ya(this,s)),arguments)},find(e,t){return la(this,"find",e,t,n=>Ya(this,n),arguments)},findIndex(e,t){return la(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return la(this,"findLast",e,t,n=>Ya(this,n),arguments)},findLastIndex(e,t){return la(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return la(this,"forEach",e,t,void 0,arguments)},includes(...e){return Cd(this,"includes",e)},indexOf(...e){return Cd(this,"indexOf",e)},join(e){return Nl(this).join(e)},lastIndexOf(...e){return Cd(this,"lastIndexOf",e)},map(e,t){return la(this,"map",e,t,void 0,arguments)},pop(){return wr(this,"pop")},push(...e){return wr(this,"push",e)},reduce(e,...t){return Yf(this,"reduce",e,t)},reduceRight(e,...t){return Yf(this,"reduceRight",e,t)},shift(){return wr(this,"shift")},some(e,t){return la(this,"some",e,t,void 0,arguments)},splice(...e){return wr(this,"splice",e)},toReversed(){return Nl(this).toReversed()},toSorted(e){return Nl(this).toSorted(e)},toSpliced(...e){return Nl(this).toSpliced(...e)},unshift(...e){return wr(this,"unshift",e)},values(){return _d(this,"values",e=>Ya(this,e))}};function _d(e,t,n){const s=zu(e),o=s[t]();return s!==e&&!Fo(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=n(i.value)),i}),o}const tk=Array.prototype;function la(e,t,n,s,o,i){const l=zu(e),c=l!==e&&!Fo(e),d=l[t];if(d!==tk[t]){const m=d.apply(e,i);return c?$s(m):m}let h=n;l!==e&&(c?h=function(m,y){return n.call(this,Ya(e,m),y,e)}:n.length>2&&(h=function(m,y){return n.call(this,m,y,e)}));const f=d.call(l,h,s);return c&&o?o(f):f}function Yf(e,t,n,s){const o=zu(e);let i=n;return o!==e&&(Fo(e)?n.length>3&&(i=function(l,c,d){return n.call(this,l,c,d,e)}):i=function(l,c,d){return n.call(this,l,Ya(e,c),d,e)}),o[t](i,...s)}function Cd(e,t,n){const s=Ut(e);Yn(s,"iterate",Xr);const o=s[t](...n);return(o===-1||o===!1)&&Hu(n[0])?(n[0]=Ut(n[0]),s[t](...n)):o}function wr(e,t,n=[]){_a(),cf();const s=Ut(e)[t].apply(e,n);return uf(),Ca(),s}const nk=sf("__proto__,__v_isRef,__isVue"),Vm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(xs));function ok(e){xs(e)||(e=String(e));const t=Ut(this);return Yn(t,"has",e),t.hasOwnProperty(e)}class Gm{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(o?i?fk:Zm:i?Wm:jm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const l=ut(t);if(!o){let d;if(l&&(d=ek[n]))return d;if(n==="hasOwnProperty")return ok}const c=Reflect.get(t,n,dn(t)?t:s);if((xs(n)?Vm.has(n):nk(n))||(o||Yn(t,"get",n),i))return c;if(dn(c)){const d=l&&Ou(n)?c:c.value;return o&&Qt(d)?Lh(d):d}return Qt(c)?o?Lh(c):sl(c):c}}class qm extends Gm{constructor(t=!1){super(!1,t)}set(t,n,s,o){let i=t[n];const l=ut(t)&&Ou(n);if(!this._isShallow){const h=La(i);if(!Fo(s)&&!La(s)&&(i=Ut(i),s=Ut(s)),!l&&dn(i)&&!dn(s))return h||(i.value=s),!0}const c=l?Number(n)<t.length:Wt(t,n),d=Reflect.set(t,n,s,dn(t)?t:o);return t===Ut(o)&&(c?ii(s,i)&&fa(t,"set",n,s):fa(t,"add",n,s)),d}deleteProperty(t,n){const s=Wt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&s&&fa(t,"delete",n,void 0),o}has(t,n){const s=Reflect.has(t,n);return(!xs(n)||!Vm.has(n))&&Yn(t,"has",n),s}ownKeys(t){return Yn(t,"iterate",ut(t)?"length":Ji),Reflect.ownKeys(t)}}class sk extends Gm{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const ak=new qm,ik=new sk,lk=new qm(!0);const Ch=e=>e,Pc=e=>Reflect.getPrototypeOf(e);function rk(e,t,n){return function(...s){const o=this.__v_raw,i=Ut(o),l=Yl(i),c=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=o[e](...s),f=n?Ch:t?tr:$s;return!t&&Yn(i,"iterate",d?_h:Ji),{next(){const{value:m,done:y}=h.next();return y?{value:m,done:y}:{value:c?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Dc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ck(e,t){const n={get(o){const i=this.__v_raw,l=Ut(i),c=Ut(o);e||(ii(o,c)&&Yn(l,"get",o),Yn(l,"get",c));const{has:d}=Pc(l),h=t?Ch:e?tr:$s;if(d.call(l,o))return h(i.get(o));if(d.call(l,c))return h(i.get(c));i!==l&&i.get(o)},get size(){const o=this.__v_raw;return!e&&Yn(Ut(o),"iterate",Ji),o.size},has(o){const i=this.__v_raw,l=Ut(i),c=Ut(o);return e||(ii(o,c)&&Yn(l,"has",o),Yn(l,"has",c)),o===c?i.has(o):i.has(o)||i.has(c)},forEach(o,i){const l=this,c=l.__v_raw,d=Ut(c),h=t?Ch:e?tr:$s;return!e&&Yn(d,"iterate",Ji),c.forEach((f,m)=>o.call(i,h(f),h(m),l))}};return Rn(n,e?{add:Dc("add"),set:Dc("set"),delete:Dc("delete"),clear:Dc("clear")}:{add(o){!t&&!Fo(o)&&!La(o)&&(o=Ut(o));const i=Ut(this);return Pc(i).has.call(i,o)||(i.add(o),fa(i,"add",o,o)),this},set(o,i){!t&&!Fo(i)&&!La(i)&&(i=Ut(i));const l=Ut(this),{has:c,get:d}=Pc(l);let h=c.call(l,o);h||(o=Ut(o),h=c.call(l,o));const f=d.call(l,o);return l.set(o,i),h?ii(i,f)&&fa(l,"set",o,i):fa(l,"add",o,i),this},delete(o){const i=Ut(this),{has:l,get:c}=Pc(i);let d=l.call(i,o);d||(o=Ut(o),d=l.call(i,o)),c&&c.call(i,o);const h=i.delete(o);return d&&fa(i,"delete",o,void 0),h},clear(){const o=Ut(this),i=o.size!==0,l=o.clear();return i&&fa(o,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=rk(o,e,t)}),n}function ff(e,t){const n=ck(e,t);return(s,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?s:Reflect.get(Wt(n,o)&&o in s?n:s,o,i)}const uk={get:ff(!1,!1)},dk={get:ff(!1,!0)},hk={get:ff(!0,!1)};const jm=new WeakMap,Wm=new WeakMap,Zm=new WeakMap,fk=new WeakMap;function pk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function vk(e){return e.__v_skip||!Object.isExtensible(e)?0:pk(B1(e))}function sl(e){return La(e)?e:pf(e,!1,ak,uk,jm)}function Km(e){return pf(e,!1,lk,dk,Wm)}function Lh(e){return pf(e,!0,ik,hk,Zm)}function pf(e,t,n,s,o){if(!Qt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=vk(e);if(i===0)return e;const l=o.get(e);if(l)return l;const c=new Proxy(e,i===2?s:n);return o.set(e,c),c}function ba(e){return La(e)?ba(e.__v_raw):!!(e&&e.__v_isReactive)}function La(e){return!!(e&&e.__v_isReadonly)}function Fo(e){return!!(e&&e.__v_isShallow)}function Hu(e){return e?!!e.__v_raw:!1}function Ut(e){const t=e&&e.__v_raw;return t?Ut(t):e}function vf(e){return!Wt(e,"__v_skip")&&Object.isExtensible(e)&&$m(e,"__v_skip",!0),e}const $s=e=>Qt(e)?sl(e):e,tr=e=>Qt(e)?Lh(e):e;function dn(e){return e?e.__v_isRef===!0:!1}function D(e){return Ym(e,!1)}function mk(e){return Ym(e,!0)}function Ym(e,t){return dn(e)?e:new gk(e,t)}class gk{constructor(t,n){this.dep=new hf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Ut(t),this._value=n?t:$s(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||Fo(t)||La(t);t=s?t:Ut(t),ii(t,n)&&(this._rawValue=t,this._value=s?t:$s(t),this.dep.trigger())}}function B(e){return dn(e)?e.value:e}function ru(e){return _t(e)?e():B(e)}const yk={get:(e,t,n)=>t==="__v_raw"?e:B(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const o=e[t];return dn(o)&&!dn(n)?(o.value=n,!0):Reflect.set(e,t,n,s)}};function Jm(e){return ba(e)?e:new Proxy(e,yk)}function kk(e){const t=ut(e)?new Array(e.length):{};for(const n in e)t[n]=wk(e,n);return t}class bk{constructor(t,n,s){this._object=t,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Ut(t);let o=!0,i=t;if(!ut(t)||!Ou(String(n)))do o=!Hu(i)||Fo(i);while(o&&(i=i.__v_raw));this._shallow=o}get value(){let t=this._object[this._key];return this._shallow&&(t=B(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&dn(this._raw[this._key])){const n=this._object[this._key];if(dn(n)){n.value=t;return}}this._object[this._key]=t}get dep(){return Q1(this._raw,this._key)}}function wk(e,t,n){return new bk(e,t,n)}class _k{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new hf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Jr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&nn!==this)return Nm(this,!0),!0}get value(){const t=this.dep.track();return Um(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Ck(e,t,n=!1){let s,o;return _t(e)?s=e:(s=e.get,o=e.set),new _k(s,o,n)}const Rc={},cu=new WeakMap;let Vi;function Lk(e,t=!1,n=Vi){if(n){let s=cu.get(n);s||cu.set(n,s=[]),s.push(e)}}function Sk(e,t,n=en){const{immediate:s,deep:o,once:i,scheduler:l,augmentJob:c,call:d}=n,h=_=>o?_:Fo(_)||o===!1||o===0?pa(_,1):pa(_);let f,m,y,k,b=!1,I=!1;if(dn(e)?(m=()=>e.value,b=Fo(e)):ba(e)?(m=()=>h(e),b=!0):ut(e)?(I=!0,b=e.some(_=>ba(_)||Fo(_)),m=()=>e.map(_=>{if(dn(_))return _.value;if(ba(_))return h(_);if(_t(_))return d?d(_,2):_()})):_t(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){_a();try{y()}finally{Ca()}}const _=Vi;Vi=f;try{return d?d(e,3,[k]):e(k)}finally{Vi=_}}:m=Ls,t&&o){const _=m,$=o===!0?1/0:o;m=()=>pa(_(),$)}const T=Dm(),E=()=>{f.stop(),T&&T.active&&lf(T.effects,f)};if(i&&t){const _=t;t=(...$)=>{_(...$),E()}}let x=I?new Array(e.length).fill(Rc):Rc;const C=_=>{if(!(!(f.flags&1)||!f.dirty&&!_))if(t){const $=f.run();if(o||b||(I?$.some((R,M)=>ii(R,x[M])):ii($,x))){y&&y();const R=Vi;Vi=f;try{const M=[$,x===Rc?void 0:I&&x[0]===Rc?[]:x,k];x=$,d?d(t,3,M):t(...M)}finally{Vi=R}}}else f.run()};return c&&c(C),f=new Rm(m),f.scheduler=l?()=>l(C,!1):C,k=_=>Lk(_,!1,f),y=f.onStop=()=>{const _=cu.get(f);if(_){if(d)d(_,4);else for(const $ of _)$();cu.delete(f)}},t?s?C(!0):x=f.run():l?l(C.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function pa(e,t=1/0,n){if(t<=0||!Qt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,dn(e))pa(e.value,t,n);else if(ut(e))for(let s=0;s<e.length;s++)pa(e[s],t,n);else if(lr(e)||Yl(e))e.forEach(s=>{pa(s,t,n)});else if(xm(e)){for(const s in e)pa(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&pa(e[s],t,n)}return e}function uc(e,t,n,s){try{return s?e(...s):e()}catch(o){Vu(o,t,n)}}function Ts(e,t,n,s){if(_t(e)){const o=uc(e,t,n,s);return o&&Sm(o)&&o.catch(i=>{Vu(i,t,n)}),o}if(ut(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Ts(e[i],t,n,s));return o}}function Vu(e,t,n,s=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||en;if(t){let c=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${n}`;for(;c;){const f=c.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,h)===!1)return}c=c.parent}if(i){_a(),uc(i,null,10,[e,d,h]),Ca();return}}Ik(e,n,o,s,l)}function Ik(e,t,n,s=!0,o=!1){if(o)throw e;console.error(e)}const vo=[];let zs=-1;const Jl=[];let Ja=null,Hl=0;const Xm=Promise.resolve();let uu=null;function cn(e){const t=uu||Xm;return e?t.then(this?e.bind(this):e):t}function xk(e){let t=zs+1,n=vo.length;for(;t<n;){const s=t+n>>>1,o=vo[s],i=Qr(o);i<e||i===e&&o.flags&2?t=s+1:n=s}return t}function mf(e){if(!(e.flags&1)){const t=Qr(e),n=vo[vo.length-1];!n||!(e.flags&2)&&t>=Qr(n)?vo.push(e):vo.splice(xk(t),0,e),e.flags|=1,Qm()}}function Qm(){uu||(uu=Xm.then(ng))}function eg(e){ut(e)?Jl.push(...e):Ja&&e.id===-1?Ja.splice(Hl+1,0,e):e.flags&1||(Jl.push(e),e.flags|=1),Qm()}function Jf(e,t,n=zs+1){for(;n<vo.length;n++){const s=vo[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;vo.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function tg(e){if(Jl.length){const t=[...new Set(Jl)].sort((n,s)=>Qr(n)-Qr(s));if(Jl.length=0,Ja){Ja.push(...t);return}for(Ja=t,Hl=0;Hl<Ja.length;Hl++){const n=Ja[Hl];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ja=null,Hl=0}}const Qr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function ng(e){try{for(zs=0;zs<vo.length;zs++){const t=vo[zs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),uc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;zs<vo.length;zs++){const t=vo[zs];t&&(t.flags&=-2)}zs=-1,vo.length=0,tg(),uu=null,(vo.length||Jl.length)&&ng()}}let Hn=null,og=null;function du(e){const t=Hn;return Hn=e,og=e&&e.type.__scopeId||null,t}function Ve(e,t=Hn,n){if(!t||e._n)return e;const s=(...o)=>{s._d&&pu(-1);const i=du(t);let l;try{l=e(...o)}finally{du(i),s._d&&pu(1)}return l};return s._n=!0,s._c=!0,s._d=!0,s}function We(e,t){if(Hn===null)return e;const n=Ku(Hn),s=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,l,c,d=en]=t[o];i&&(_t(i)&&(i={mounted:i,updated:i}),i.deep&&pa(l),s.push({dir:i,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d}))}return e}function Oi(e,t,n,s){const o=e.dirs,i=t&&t.dirs;for(let l=0;l<o.length;l++){const c=o[l];i&&(c.oldValue=i[l].value);let d=c.dir[s];d&&(_a(),Ts(d,n,8,[e.el,c,e,t]),Ca())}}function Nr(e,t){if(Xn){let n=Xn.provides;const s=Xn.parent&&Xn.parent.provides;s===n&&(n=Xn.provides=Object.create(s)),n[e]=t}}function xo(e,t,n=!1){const s=Zu();if(s||Xi){let o=Xi?Xi._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&_t(t)?t.call(s&&s.proxy):t}}function $k(){return!!(Zu()||Xi)}const Tk=Symbol.for("v-scx"),Mk=()=>xo(Tk);function Ye(e,t,n){return sg(e,t,n)}function sg(e,t,n=en){const{immediate:s,deep:o,flush:i,once:l}=n,c=Rn({},n),d=t&&s||!t&&i!=="post";let h;if(sc){if(i==="sync"){const k=Mk();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=Ls,k.resume=Ls,k.pause=Ls,k}}const f=Xn;c.call=(k,b,I)=>Ts(k,f,b,I);let m=!1;i==="post"?c.scheduler=k=>{fo(k,f&&f.suspense)}:i!=="sync"&&(m=!0,c.scheduler=(k,b)=>{b?k():mf(k)}),c.augmentJob=k=>{t&&(k.flags|=4),m&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const y=Sk(e,t,c);return sc&&(h?h.push(y):d&&y()),y}function Ak(e,t,n){const s=this.proxy,o=hn(e)?e.includes(".")?ag(s,e):()=>s[e]:e.bind(s,s);let i;_t(t)?i=t:(i=t.handler,n=t);const l=dc(this),c=sg(o,i.bind(s),n);return l(),c}function ag(e,t){const n=t.split(".");return()=>{let s=e;for(let o=0;o<n.length&&s;o++)s=s[n[o]];return s}}const ig=Symbol("_vte"),lg=e=>e.__isTeleport,Br=e=>e&&(e.disabled||e.disabled===""),Xf=e=>e&&(e.defer||e.defer===""),Qf=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ep=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Sh=(e,t)=>{const n=e&&e.to;return hn(n)?t?t(n):null:n},rg={name:"Teleport",__isTeleport:!0,process(e,t,n,s,o,i,l,c,d,h){const{mc:f,pc:m,pbc:y,o:{insert:k,querySelector:b,createText:I,createComment:T}}=h,E=Br(t.props);let{shapeFlag:x,children:C,dynamicChildren:_}=t;if(e==null){const $=t.el=I(""),R=t.anchor=I("");k($,n,s),k(R,n,s);const M=(A,U)=>{x&16&&f(C,A,U,o,i,l,c,d)},O=()=>{const A=t.target=Sh(t.props,b),U=cg(A,t,I,k);A&&(l!=="svg"&&Qf(A)?l="svg":l!=="mathml"&&ep(A)&&(l="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(A),E||(M(A,U),Zc(t,!1)))};E&&(M(n,R),Zc(t,!0)),Xf(t.props)?(t.el.__isMounted=!1,fo(()=>{O(),delete t.el.__isMounted},i)):O()}else{if(Xf(t.props)&&e.el.__isMounted===!1){fo(()=>{rg.process(e,t,n,s,o,i,l,c,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const $=t.anchor=e.anchor,R=t.target=e.target,M=t.targetAnchor=e.targetAnchor,O=Br(e.props),A=O?n:R,U=O?$:M;if(l==="svg"||Qf(R)?l="svg":(l==="mathml"||ep(R))&&(l="mathml"),_?(y(e.dynamicChildren,_,A,o,i,l,c),wf(e,t,!0)):d||m(e,t,A,U,o,i,l,c,!1),E)O?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Oc(t,n,$,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=Sh(t.props,b);F&&Oc(t,F,null,h,0)}else O&&Oc(t,R,M,h,1);Zc(t,E)}},remove(e,t,n,{um:s,o:{remove:o}},i){const{shapeFlag:l,children:c,anchor:d,targetStart:h,targetAnchor:f,target:m,props:y}=e;if(m&&(o(h),o(f)),i&&o(d),l&16){const k=i||!Br(y);for(let b=0;b<c.length;b++){const I=c[b];s(I,t,n,k,!!I.dynamicChildren)}}},move:Oc,hydrate:Ek};function Oc(e,t,n,{o:{insert:s},m:o},i=2){i===0&&s(e.targetAnchor,t,n);const{el:l,anchor:c,shapeFlag:d,children:h,props:f}=e,m=i===2;if(m&&s(l,t,n),(!m||Br(f))&&d&16)for(let y=0;y<h.length;y++)o(h[y],t,n,2);m&&s(c,t,n)}function Ek(e,t,n,s,o,i,{o:{nextSibling:l,parentNode:c,querySelector:d,insert:h,createText:f}},m){function y(I,T,E,x){T.anchor=m(l(I),T,c(I),n,s,o,i),T.targetStart=E,T.targetAnchor=x}const k=t.target=Sh(t.props,d),b=Br(t.props);if(k){const I=k._lpa||k.firstChild;if(t.shapeFlag&16)if(b)y(e,t,I,I&&l(I));else{t.anchor=l(e);let T=I;for(;T;){if(T&&T.nodeType===8){if(T.data==="teleport start anchor")t.targetStart=T;else if(T.data==="teleport anchor"){t.targetAnchor=T,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}T=l(T)}t.targetAnchor||cg(k,t,f,h),m(I&&l(I),t,k,n,s,o,i)}Zc(t,b)}else b&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const ec=rg;function Zc(e,t){const n=e.ctx;if(n&&n.ut){let s,o;for(t?(s=e.el,o=e.anchor):(s=e.targetStart,o=e.targetAnchor);s&&s!==o;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function cg(e,t,n,s){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[ig]=i,e&&(s(o,e),s(i,e)),i}const ha=Symbol("_leaveCb"),Nc=Symbol("_enterCb");function Pk(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return un(()=>{e.isMounted=!0}),kg(()=>{e.isUnmounting=!0}),e}const Jo=[Function,Array],ug={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Jo,onEnter:Jo,onAfterEnter:Jo,onEnterCancelled:Jo,onBeforeLeave:Jo,onLeave:Jo,onAfterLeave:Jo,onLeaveCancelled:Jo,onBeforeAppear:Jo,onAppear:Jo,onAfterAppear:Jo,onAppearCancelled:Jo},dg=e=>{const t=e.subTree;return t.component?dg(t.component):t},Dk={name:"BaseTransition",props:ug,setup(e,{slots:t}){const n=Zu(),s=Pk();return()=>{const o=t.default&&pg(t.default(),!0);if(!o||!o.length)return;const i=hg(o),l=Ut(e),{mode:c}=l;if(s.isLeaving)return Ld(i);const d=tp(i);if(!d)return Ld(i);let h=Ih(d,l,s,n,m=>h=m);d.type!==Jn&&tc(d,h);let f=n.subTree&&tp(n.subTree);if(f&&f.type!==Jn&&!qi(f,d)&&dg(n).type!==Jn){let m=Ih(f,l,s,n);if(tc(f,m),c==="out-in"&&d.type!==Jn)return s.isLeaving=!0,m.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete m.afterLeave,f=void 0},Ld(i);c==="in-out"&&d.type!==Jn?m.delayLeave=(y,k,b)=>{const I=fg(s,f);I[String(f.key)]=f,y[ha]=()=>{k(),y[ha]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{b(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function hg(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Jn){t=n;break}}return t}const Rk=Dk;function fg(e,t){const{leavingVNodes:n}=e;let s=n.get(t.type);return s||(s=Object.create(null),n.set(t.type,s)),s}function Ih(e,t,n,s,o){const{appear:i,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:k,onAfterLeave:b,onLeaveCancelled:I,onBeforeAppear:T,onAppear:E,onAfterAppear:x,onAppearCancelled:C}=t,_=String(e.key),$=fg(n,e),R=(A,U)=>{A&&Ts(A,s,9,U)},M=(A,U)=>{const F=U[1];R(A,U),ut(A)?A.every(j=>j.length<=1)&&F():A.length<=1&&F()},O={mode:l,persisted:c,beforeEnter(A){let U=d;if(!n.isMounted)if(i)U=T||d;else return;A[ha]&&A[ha](!0);const F=$[_];F&&qi(e,F)&&F.el[ha]&&F.el[ha](),R(U,[A])},enter(A){let U=h,F=f,j=m;if(!n.isMounted)if(i)U=E||h,F=x||f,j=C||m;else return;let Z=!1;const X=A[Nc]=re=>{Z||(Z=!0,re?R(j,[A]):R(F,[A]),O.delayedLeave&&O.delayedLeave(),A[Nc]=void 0)};U?M(U,[A,X]):X()},leave(A,U){const F=String(e.key);if(A[Nc]&&A[Nc](!0),n.isUnmounting)return U();R(y,[A]);let j=!1;const Z=A[ha]=X=>{j||(j=!0,U(),X?R(I,[A]):R(b,[A]),A[ha]=void 0,$[F]===e&&delete $[F])};$[F]=e,k?M(k,[A,Z]):Z()},clone(A){const U=Ih(A,t,n,s,o);return o&&o(U),U}};return O}function Ld(e){if(Gu(e))return e=ci(e),e.children=null,e}function tp(e){if(!Gu(e))return lg(e.type)&&e.children?hg(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&_t(n.default))return n.default()}}function tc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,tc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function pg(e,t=!1,n){let s=[],o=0;for(let i=0;i<e.length;i++){let l=e[i];const c=n==null?l.key:String(n)+String(l.key!=null?l.key:i);l.type===Se?(l.patchFlag&128&&o++,s=s.concat(pg(l.children,t,c))):(t||l.type!==Jn)&&s.push(c!=null?ci(l,{key:c}):l)}if(o>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function vg(e,t){return _t(e)?Rn({name:e.name},t,{setup:e}):e}function mg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const hu=new WeakMap;function Fr(e,t,n,s,o=!1){if(ut(e)){e.forEach((b,I)=>Fr(b,t&&(ut(t)?t[I]:t),n,s,o));return}if(Xl(s)&&!o){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Fr(e,t,n,s.component.subTree);return}const i=s.shapeFlag&4?Ku(s.component):s.el,l=o?null:i,{i:c,r:d}=e,h=t&&t.r,f=c.refs===en?c.refs={}:c.refs,m=c.setupState,y=Ut(m),k=m===en?Lm:b=>Wt(y,b);if(h!=null&&h!==d){if(np(t),hn(h))f[h]=null,k(h)&&(m[h]=null);else if(dn(h)){h.value=null;const b=t;b.k&&(f[b.k]=null)}}if(_t(d))uc(d,c,12,[l,f]);else{const b=hn(d),I=dn(d);if(b||I){const T=()=>{if(e.f){const E=b?k(d)?m[d]:f[d]:d.value;if(o)ut(E)&&lf(E,i);else if(ut(E))E.includes(i)||E.push(i);else if(b)f[d]=[i],k(d)&&(m[d]=f[d]);else{const x=[i];d.value=x,e.k&&(f[e.k]=x)}}else b?(f[d]=l,k(d)&&(m[d]=l)):I&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const E=()=>{T(),hu.delete(e)};E.id=-1,hu.set(e,E),fo(E,n)}else np(e),T()}}}function np(e){const t=hu.get(e);t&&(t.flags|=8,hu.delete(e))}Uu().requestIdleCallback;Uu().cancelIdleCallback;const Xl=e=>!!e.type.__asyncLoader,Gu=e=>e.type.__isKeepAlive;function Ok(e,t){gg(e,"a",t)}function Nk(e,t){gg(e,"da",t)}function gg(e,t,n=Xn){const s=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(qu(t,s,n),n){let o=n.parent;for(;o&&o.parent;)Gu(o.parent.vnode)&&Bk(s,t,n,o),o=o.parent}}function Bk(e,t,n,s){const o=qu(t,e,s,!0);Ln(()=>{lf(s[t],o)},n)}function qu(e,t,n=Xn,s=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...l)=>{_a();const c=dc(n),d=Ts(t,n,e,l);return c(),Ca(),d});return s?o.unshift(i):o.push(i),i}}const Ia=e=>(t,n=Xn)=>{(!sc||e==="sp")&&qu(e,(...s)=>t(...s),n)},Fk=Ia("bm"),un=Ia("m"),yg=Ia("bu"),Uk=Ia("u"),kg=Ia("bum"),Ln=Ia("um"),zk=Ia("sp"),Hk=Ia("rtg"),Vk=Ia("rtc");function Gk(e,t=Xn){qu("ec",e,t)}const bg="components";function gf(e,t){return _g(bg,e,!0,t)||e}const wg=Symbol.for("v-ndc");function qk(e){return hn(e)?_g(bg,e,!1)||e:e||wg}function _g(e,t,n=!0,s=!1){const o=Hn||Xn;if(o){const i=o.type;{const c=$0(i,!1);if(c&&(c===t||c===ns(t)||c===Bu(ns(t))))return i}const l=op(o[e]||i[e],t)||op(o.appContext[e],t);return!l&&s?i:l}}function op(e,t){return e&&(e[t]||e[ns(t)]||e[Bu(ns(t))])}function je(e,t,n,s){let o;const i=n,l=ut(e);if(l||hn(e)){const c=l&&ba(e);let d=!1,h=!1;c&&(d=!Fo(e),h=La(e),e=zu(e)),o=new Array(e.length);for(let f=0,m=e.length;f<m;f++)o[f]=t(d?h?tr($s(e[f])):$s(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let c=0;c<e;c++)o[c]=t(c+1,c,void 0,i)}else if(Qt(e))if(e[Symbol.iterator])o=Array.from(e,(c,d)=>t(c,d,void 0,i));else{const c=Object.keys(e);o=new Array(c.length);for(let d=0,h=c.length;d<h;d++){const f=c[d];o[d]=t(e[f],f,d,i)}}else o=[];return o}function yf(e,t){for(let n=0;n<t.length;n++){const s=t[n];if(ut(s))for(let o=0;o<s.length;o++)e[s[o].name]=s[o].fn;else s&&(e[s.name]=s.key?(...o)=>{const i=s.fn(...o);return i&&(i.key=s.key),i}:s.fn)}return e}function mo(e,t,n={},s,o){if(Hn.ce||Hn.parent&&Xl(Hn.parent)&&Hn.parent.ce){const h=Object.keys(n).length>0;return t!=="default"&&(n.name=t),p(),qe(Se,null,[Ee("slot",n,s&&s())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),p();const l=i&&Cg(i(n)),c=n.key||l&&l.key,d=qe(Se,{key:(c&&!xs(c)?c:`_${t}`)+(!l&&s?"_fb":"")},l||(s?s():[]),l&&e._===1?64:-2);return!o&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function Cg(e){return e.some(t=>oc(t)?!(t.type===Jn||t.type===Se&&!Cg(t.children)):!0)?e:null}const xh=e=>e?Hg(e)?Ku(e):xh(e.parent):null,Ur=Rn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>xh(e.parent),$root:e=>xh(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Sg(e),$forceUpdate:e=>e.f||(e.f=()=>{mf(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>Ak.bind(e)}),Sd=(e,t)=>e!==en&&!e.__isScriptSetup&&Wt(e,t),jk={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:o,props:i,accessCache:l,type:c,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return s[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(Sd(s,t))return l[t]=1,s[t];if(o!==en&&Wt(o,t))return l[t]=2,o[t];if(Wt(i,t))return l[t]=3,i[t];if(n!==en&&Wt(n,t))return l[t]=4,n[t];$h&&(l[t]=0)}}const h=Ur[t];let f,m;if(h)return t==="$attrs"&&Yn(e.attrs,"get",""),h(e);if((f=c.__cssModules)&&(f=f[t]))return f;if(n!==en&&Wt(n,t))return l[t]=4,n[t];if(m=d.config.globalProperties,Wt(m,t))return m[t]},set({_:e},t,n){const{data:s,setupState:o,ctx:i}=e;return Sd(o,t)?(o[t]=n,!0):s!==en&&Wt(s,t)?(s[t]=n,!0):Wt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:o,props:i,type:l}},c){let d;return!!(n[c]||e!==en&&c[0]!=="$"&&Wt(e,c)||Sd(t,c)||Wt(i,c)||Wt(s,c)||Wt(Ur,c)||Wt(o.config.globalProperties,c)||(d=l.__cssModules)&&d[c])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Wt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function sp(e){return ut(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let $h=!0;function Wk(e){const t=Sg(e),n=e.proxy,s=e.ctx;$h=!1,t.beforeCreate&&ap(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:l,watch:c,provide:d,inject:h,created:f,beforeMount:m,mounted:y,beforeUpdate:k,updated:b,activated:I,deactivated:T,beforeDestroy:E,beforeUnmount:x,destroyed:C,unmounted:_,render:$,renderTracked:R,renderTriggered:M,errorCaptured:O,serverPrefetch:A,expose:U,inheritAttrs:F,components:j,directives:Z,filters:X}=t;if(h&&Zk(h,s,null),l)for(const ae in l){const q=l[ae];_t(q)&&(s[ae]=q.bind(n))}if(o){const ae=o.call(n,n);Qt(ae)&&(e.data=sl(ae))}if($h=!0,i)for(const ae in i){const q=i[ae],Y=_t(q)?q.bind(n,n):_t(q.get)?q.get.bind(n,n):Ls,te=!_t(q)&&_t(q.set)?q.set.bind(n):Ls,ue=z({get:Y,set:te});Object.defineProperty(s,ae,{enumerable:!0,configurable:!0,get:()=>ue.value,set:_e=>ue.value=_e})}if(c)for(const ae in c)Lg(c[ae],s,n,ae);if(d){const ae=_t(d)?d.call(n):d;Reflect.ownKeys(ae).forEach(q=>{Nr(q,ae[q])})}f&&ap(f,e,"c");function K(ae,q){ut(q)?q.forEach(Y=>ae(Y.bind(n))):q&&ae(q.bind(n))}if(K(Fk,m),K(un,y),K(yg,k),K(Uk,b),K(Ok,I),K(Nk,T),K(Gk,O),K(Vk,R),K(Hk,M),K(kg,x),K(Ln,_),K(zk,A),ut(U))if(U.length){const ae=e.exposed||(e.exposed={});U.forEach(q=>{Object.defineProperty(ae,q,{get:()=>n[q],set:Y=>n[q]=Y,enumerable:!0})})}else e.exposed||(e.exposed={});$&&e.render===Ls&&(e.render=$),F!=null&&(e.inheritAttrs=F),j&&(e.components=j),Z&&(e.directives=Z),A&&mg(e)}function Zk(e,t,n=Ls){ut(e)&&(e=Th(e));for(const s in e){const o=e[s];let i;Qt(o)?"default"in o?i=xo(o.from||s,o.default,!0):i=xo(o.from||s):i=xo(o),dn(i)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[s]=i}}function ap(e,t,n){Ts(ut(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function Lg(e,t,n,s){let o=s.includes(".")?ag(n,s):()=>n[s];if(hn(e)){const i=t[e];_t(i)&&Ye(o,i)}else if(_t(e))Ye(o,e.bind(n));else if(Qt(e))if(ut(e))e.forEach(i=>Lg(i,t,n,s));else{const i=_t(e.handler)?e.handler.bind(n):t[e.handler];_t(i)&&Ye(o,i,e)}}function Sg(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,c=i.get(t);let d;return c?d=c:!o.length&&!n&&!s?d=t:(d={},o.length&&o.forEach(h=>fu(d,h,l,!0)),fu(d,t,l)),Qt(t)&&i.set(t,d),d}function fu(e,t,n,s=!1){const{mixins:o,extends:i}=t;i&&fu(e,i,n,!0),o&&o.forEach(l=>fu(e,l,n,!0));for(const l in t)if(!(s&&l==="expose")){const c=Kk[l]||n&&n[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const Kk={data:ip,props:lp,emits:lp,methods:xr,computed:xr,beforeCreate:uo,created:uo,beforeMount:uo,mounted:uo,beforeUpdate:uo,updated:uo,beforeDestroy:uo,beforeUnmount:uo,destroyed:uo,unmounted:uo,activated:uo,deactivated:uo,errorCaptured:uo,serverPrefetch:uo,components:xr,directives:xr,watch:Jk,provide:ip,inject:Yk};function ip(e,t){return t?e?function(){return Rn(_t(e)?e.call(this,this):e,_t(t)?t.call(this,this):t)}:t:e}function Yk(e,t){return xr(Th(e),Th(t))}function Th(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function uo(e,t){return e?[...new Set([].concat(e,t))]:t}function xr(e,t){return e?Rn(Object.create(null),e,t):t}function lp(e,t){return e?ut(e)&&ut(t)?[...new Set([...e,...t])]:Rn(Object.create(null),sp(e),sp(t??{})):t}function Jk(e,t){if(!e)return t;if(!t)return e;const n=Rn(Object.create(null),e);for(const s in t)n[s]=uo(e[s],t[s]);return n}function Ig(){return{app:null,config:{isNativeTag:Lm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Xk=0;function Qk(e,t){return function(s,o=null){_t(s)||(s=Rn({},s)),o!=null&&!Qt(o)&&(o=null);const i=Ig(),l=new WeakSet,c=[];let d=!1;const h=i.app={_uid:Xk++,_component:s,_props:o,_container:null,_context:i,_instance:null,version:M0,get config(){return i.config},set config(f){},use(f,...m){return l.has(f)||(f&&_t(f.install)?(l.add(f),f.install(h,...m)):_t(f)&&(l.add(f),f(h,...m))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,m){return m?(i.components[f]=m,h):i.components[f]},directive(f,m){return m?(i.directives[f]=m,h):i.directives[f]},mount(f,m,y){if(!d){const k=h._ceVNode||Ee(s,o);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,f,y),d=!0,h._container=f,f.__vue_app__=h,Ku(k.component)}},onUnmount(f){c.push(f)},unmount(){d&&(Ts(c,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,m){return i.provides[f]=m,h},runWithContext(f){const m=Xi;Xi=h;try{return f()}finally{Xi=m}}};return h}}let Xi=null;const e0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ns(t)}Modifiers`]||e[`${fi(t)}Modifiers`];function t0(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||en;let o=n;const i=t.startsWith("update:"),l=i&&e0(s,t.slice(7));l&&(l.trim&&(o=n.map(f=>hn(f)?f.trim():f)),l.number&&(o=n.map(Fu)));let c,d=s[c=kd(t)]||s[c=kd(ns(t))];!d&&i&&(d=s[c=kd(fi(t))]),d&&Ts(d,e,6,o);const h=s[c+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,Ts(h,e,6,o)}}const n0=new WeakMap;function xg(e,t,n=!1){const s=n?n0:t.emitsCache,o=s.get(e);if(o!==void 0)return o;const i=e.emits;let l={},c=!1;if(!_t(e)){const d=h=>{const f=xg(h,t,!0);f&&(c=!0,Rn(l,f))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!c?(Qt(e)&&s.set(e,null),null):(ut(i)?i.forEach(d=>l[d]=null):Rn(l,i),Qt(e)&&s.set(e,l),l)}function ju(e,t){return!e||!Ru(t)?!1:(t=t.slice(2).replace(/Once$/,""),Wt(e,t[0].toLowerCase()+t.slice(1))||Wt(e,fi(t))||Wt(e,t))}function rp(e){const{type:t,vnode:n,proxy:s,withProxy:o,propsOptions:[i],slots:l,attrs:c,emit:d,render:h,renderCache:f,props:m,data:y,setupState:k,ctx:b,inheritAttrs:I}=e,T=du(e);let E,x;try{if(n.shapeFlag&4){const _=o||s,$=_;E=Vs(h.call($,_,f,m,k,y,b)),x=c}else{const _=t;E=Vs(_.length>1?_(m,{attrs:c,slots:l,emit:d}):_(m,null)),x=t.props?c:o0(c)}}catch(_){Hr.length=0,Vu(_,e,1),E=Ee(Jn)}let C=E;if(x&&I!==!1){const _=Object.keys(x),{shapeFlag:$}=C;_.length&&$&7&&(i&&_.some(af)&&(x=s0(x,i)),C=ci(C,x,!1,!0))}return n.dirs&&(C=ci(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(n.dirs):n.dirs),n.transition&&tc(C,n.transition),E=C,du(T),E}const o0=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ru(n))&&((t||(t={}))[n]=e[n]);return t},s0=(e,t)=>{const n={};for(const s in e)(!af(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function a0(e,t,n){const{props:s,children:o,component:i}=e,{props:l,children:c,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return s?cp(s,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==s[y]&&!ju(h,y))return!0}}}else return(o||c)&&(!c||!c.$stable)?!0:s===l?!1:s?l?cp(s,l,h):!0:!!l;return!1}function cp(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let o=0;o<s.length;o++){const i=s[o];if(t[i]!==e[i]&&!ju(n,i))return!0}return!1}function i0({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const $g={},Tg=()=>Object.create($g),Mg=e=>Object.getPrototypeOf(e)===$g;function l0(e,t,n,s=!1){const o={},i=Tg();e.propsDefaults=Object.create(null),Ag(e,t,o,i);for(const l in e.propsOptions[0])l in o||(o[l]=void 0);n?e.props=s?o:Km(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function r0(e,t,n,s){const{props:o,attrs:i,vnode:{patchFlag:l}}=e,c=Ut(o),[d]=e.propsOptions;let h=!1;if((s||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(ju(e.emitsOptions,y))continue;const k=t[y];if(d)if(Wt(i,y))k!==i[y]&&(i[y]=k,h=!0);else{const b=ns(y);o[b]=Mh(d,c,b,k,e,!1)}else k!==i[y]&&(i[y]=k,h=!0)}}}else{Ag(e,t,o,i)&&(h=!0);let f;for(const m in c)(!t||!Wt(t,m)&&((f=fi(m))===m||!Wt(t,f)))&&(d?n&&(n[m]!==void 0||n[f]!==void 0)&&(o[m]=Mh(d,c,m,void 0,e,!0)):delete o[m]);if(i!==c)for(const m in i)(!t||!Wt(t,m))&&(delete i[m],h=!0)}h&&fa(e.attrs,"set","")}function Ag(e,t,n,s){const[o,i]=e.propsOptions;let l=!1,c;if(t)for(let d in t){if(Dr(d))continue;const h=t[d];let f;o&&Wt(o,f=ns(d))?!i||!i.includes(f)?n[f]=h:(c||(c={}))[f]=h:ju(e.emitsOptions,d)||(!(d in s)||h!==s[d])&&(s[d]=h,l=!0)}if(i){const d=Ut(n),h=c||en;for(let f=0;f<i.length;f++){const m=i[f];n[m]=Mh(o,d,m,h[m],e,!Wt(h,m))}}return l}function Mh(e,t,n,s,o,i){const l=e[n];if(l!=null){const c=Wt(l,"default");if(c&&s===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&_t(d)){const{propsDefaults:h}=o;if(n in h)s=h[n];else{const f=dc(o);s=h[n]=d.call(null,t),f()}}else s=d;o.ce&&o.ce._setProp(n,s)}l[0]&&(i&&!c?s=!1:l[1]&&(s===""||s===fi(n))&&(s=!0))}return s}const c0=new WeakMap;function Eg(e,t,n=!1){const s=n?c0:t.propsCache,o=s.get(e);if(o)return o;const i=e.props,l={},c=[];let d=!1;if(!_t(e)){const f=m=>{d=!0;const[y,k]=Eg(m,t,!0);Rn(l,y),k&&c.push(...k)};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Qt(e)&&s.set(e,Kl),Kl;if(ut(i))for(let f=0;f<i.length;f++){const m=ns(i[f]);up(m)&&(l[m]=en)}else if(i)for(const f in i){const m=ns(f);if(up(m)){const y=i[f],k=l[m]=ut(y)||_t(y)?{type:y}:Rn({},y),b=k.type;let I=!1,T=!0;if(ut(b))for(let E=0;E<b.length;++E){const x=b[E],C=_t(x)&&x.name;if(C==="Boolean"){I=!0;break}else C==="String"&&(T=!1)}else I=_t(b)&&b.name==="Boolean";k[0]=I,k[1]=T,(I||Wt(k,"default"))&&c.push(m)}}const h=[l,c];return Qt(e)&&s.set(e,h),h}function up(e){return e[0]!=="$"&&!Dr(e)}const kf=e=>e==="_"||e==="_ctx"||e==="$stable",bf=e=>ut(e)?e.map(Vs):[Vs(e)],u0=(e,t,n)=>{if(t._n)return t;const s=Ve((...o)=>bf(t(...o)),n);return s._c=!1,s},Pg=(e,t,n)=>{const s=e._ctx;for(const o in e){if(kf(o))continue;const i=e[o];if(_t(i))t[o]=u0(o,i,s);else if(i!=null){const l=bf(i);t[o]=()=>l}}},Dg=(e,t)=>{const n=bf(t);e.slots.default=()=>n},Rg=(e,t,n)=>{for(const s in t)(n||!kf(s))&&(e[s]=t[s])},d0=(e,t,n)=>{const s=e.slots=Tg();if(e.vnode.shapeFlag&32){const o=t._;o?(Rg(s,t,n),n&&$m(s,"_",o,!0)):Pg(t,s)}else t&&Dg(e,t)},h0=(e,t,n)=>{const{vnode:s,slots:o}=e;let i=!0,l=en;if(s.shapeFlag&32){const c=t._;c?n&&c===1?i=!1:Rg(o,t,n):(i=!t.$stable,Pg(t,o)),l=t}else t&&(Dg(e,t),l={default:1});if(i)for(const c in o)!kf(c)&&l[c]==null&&delete o[c]},fo=g0;function f0(e){return p0(e)}function p0(e,t){const n=Uu();n.__VUE__=!0;const{insert:s,remove:o,patchProp:i,createElement:l,createText:c,createComment:d,setText:h,setElementText:f,parentNode:m,nextSibling:y,setScopeId:k=Ls,insertStaticContent:b}=e,I=(G,Q,ee,Ce=null,Be=null,ze=null,Ae=void 0,oe=null,ge=!!Q.dynamicChildren)=>{if(G===Q)return;G&&!qi(G,Q)&&(Ce=H(G),_e(G,Be,ze,!0),G=null),Q.patchFlag===-2&&(ge=!1,Q.dynamicChildren=null);const{type:Ne,ref:Oe,shapeFlag:$e}=Q;switch(Ne){case Wu:T(G,Q,ee,Ce);break;case Jn:E(G,Q,ee,Ce);break;case zr:G==null&&x(Q,ee,Ce,Ae);break;case Se:j(G,Q,ee,Ce,Be,ze,Ae,oe,ge);break;default:$e&1?$(G,Q,ee,Ce,Be,ze,Ae,oe,ge):$e&6?Z(G,Q,ee,Ce,Be,ze,Ae,oe,ge):($e&64||$e&128)&&Ne.process(G,Q,ee,Ce,Be,ze,Ae,oe,ge,ie)}Oe!=null&&Be?Fr(Oe,G&&G.ref,ze,Q||G,!Q):Oe==null&&G&&G.ref!=null&&Fr(G.ref,null,ze,G,!0)},T=(G,Q,ee,Ce)=>{if(G==null)s(Q.el=c(Q.children),ee,Ce);else{const Be=Q.el=G.el;Q.children!==G.children&&h(Be,Q.children)}},E=(G,Q,ee,Ce)=>{G==null?s(Q.el=d(Q.children||""),ee,Ce):Q.el=G.el},x=(G,Q,ee,Ce)=>{[G.el,G.anchor]=b(G.children,Q,ee,Ce,G.el,G.anchor)},C=({el:G,anchor:Q},ee,Ce)=>{let Be;for(;G&&G!==Q;)Be=y(G),s(G,ee,Ce),G=Be;s(Q,ee,Ce)},_=({el:G,anchor:Q})=>{let ee;for(;G&&G!==Q;)ee=y(G),o(G),G=ee;o(Q)},$=(G,Q,ee,Ce,Be,ze,Ae,oe,ge)=>{if(Q.type==="svg"?Ae="svg":Q.type==="math"&&(Ae="mathml"),G==null)R(Q,ee,Ce,Be,ze,Ae,oe,ge);else{const Ne=G.el&&G.el._isVueCE?G.el:null;try{Ne&&Ne._beginPatch(),A(G,Q,Be,ze,Ae,oe,ge)}finally{Ne&&Ne._endPatch()}}},R=(G,Q,ee,Ce,Be,ze,Ae,oe)=>{let ge,Ne;const{props:Oe,shapeFlag:$e,transition:me,dirs:Ze}=G;if(ge=G.el=l(G.type,ze,Oe&&Oe.is,Oe),$e&8?f(ge,G.children):$e&16&&O(G.children,ge,null,Ce,Be,Id(G,ze),Ae,oe),Ze&&Oi(G,null,Ce,"created"),M(ge,G,G.scopeId,Ae,Ce),Oe){for(const fe in Oe)fe!=="value"&&!Dr(fe)&&i(ge,fe,null,Oe[fe],ze,Ce);"value"in Oe&&i(ge,"value",null,Oe.value,ze),(Ne=Oe.onVnodeBeforeMount)&&Bs(Ne,Ce,G)}Ze&&Oi(G,null,Ce,"beforeMount");const Ge=v0(Be,me);Ge&&me.beforeEnter(ge),s(ge,Q,ee),((Ne=Oe&&Oe.onVnodeMounted)||Ge||Ze)&&fo(()=>{Ne&&Bs(Ne,Ce,G),Ge&&me.enter(ge),Ze&&Oi(G,null,Ce,"mounted")},Be)},M=(G,Q,ee,Ce,Be)=>{if(ee&&k(G,ee),Ce)for(let ze=0;ze<Ce.length;ze++)k(G,Ce[ze]);if(Be){let ze=Be.subTree;if(Q===ze||Bg(ze.type)&&(ze.ssContent===Q||ze.ssFallback===Q)){const Ae=Be.vnode;M(G,Ae,Ae.scopeId,Ae.slotScopeIds,Be.parent)}}},O=(G,Q,ee,Ce,Be,ze,Ae,oe,ge=0)=>{for(let Ne=ge;Ne<G.length;Ne++){const Oe=G[Ne]=oe?Xa(G[Ne]):Vs(G[Ne]);I(null,Oe,Q,ee,Ce,Be,ze,Ae,oe)}},A=(G,Q,ee,Ce,Be,ze,Ae)=>{const oe=Q.el=G.el;let{patchFlag:ge,dynamicChildren:Ne,dirs:Oe}=Q;ge|=G.patchFlag&16;const $e=G.props||en,me=Q.props||en;let Ze;if(ee&&Ni(ee,!1),(Ze=me.onVnodeBeforeUpdate)&&Bs(Ze,ee,Q,G),Oe&&Oi(Q,G,ee,"beforeUpdate"),ee&&Ni(ee,!0),($e.innerHTML&&me.innerHTML==null||$e.textContent&&me.textContent==null)&&f(oe,""),Ne?U(G.dynamicChildren,Ne,oe,ee,Ce,Id(Q,Be),ze):Ae||q(G,Q,oe,null,ee,Ce,Id(Q,Be),ze,!1),ge>0){if(ge&16)F(oe,$e,me,ee,Be);else if(ge&2&&$e.class!==me.class&&i(oe,"class",null,me.class,Be),ge&4&&i(oe,"style",$e.style,me.style,Be),ge&8){const Ge=Q.dynamicProps;for(let fe=0;fe<Ge.length;fe++){const be=Ge[fe],ne=$e[be],ye=me[be];(ye!==ne||be==="value")&&i(oe,be,ne,ye,Be,ee)}}ge&1&&G.children!==Q.children&&f(oe,Q.children)}else!Ae&&Ne==null&&F(oe,$e,me,ee,Be);((Ze=me.onVnodeUpdated)||Oe)&&fo(()=>{Ze&&Bs(Ze,ee,Q,G),Oe&&Oi(Q,G,ee,"updated")},Ce)},U=(G,Q,ee,Ce,Be,ze,Ae)=>{for(let oe=0;oe<Q.length;oe++){const ge=G[oe],Ne=Q[oe],Oe=ge.el&&(ge.type===Se||!qi(ge,Ne)||ge.shapeFlag&198)?m(ge.el):ee;I(ge,Ne,Oe,null,Ce,Be,ze,Ae,!0)}},F=(G,Q,ee,Ce,Be)=>{if(Q!==ee){if(Q!==en)for(const ze in Q)!Dr(ze)&&!(ze in ee)&&i(G,ze,Q[ze],null,Be,Ce);for(const ze in ee){if(Dr(ze))continue;const Ae=ee[ze],oe=Q[ze];Ae!==oe&&ze!=="value"&&i(G,ze,oe,Ae,Be,Ce)}"value"in ee&&i(G,"value",Q.value,ee.value,Be)}},j=(G,Q,ee,Ce,Be,ze,Ae,oe,ge)=>{const Ne=Q.el=G?G.el:c(""),Oe=Q.anchor=G?G.anchor:c("");let{patchFlag:$e,dynamicChildren:me,slotScopeIds:Ze}=Q;Ze&&(oe=oe?oe.concat(Ze):Ze),G==null?(s(Ne,ee,Ce),s(Oe,ee,Ce),O(Q.children||[],ee,Oe,Be,ze,Ae,oe,ge)):$e>0&&$e&64&&me&&G.dynamicChildren&&G.dynamicChildren.length===me.length?(U(G.dynamicChildren,me,ee,Be,ze,Ae,oe),(Q.key!=null||Be&&Q===Be.subTree)&&wf(G,Q,!0)):q(G,Q,ee,Oe,Be,ze,Ae,oe,ge)},Z=(G,Q,ee,Ce,Be,ze,Ae,oe,ge)=>{Q.slotScopeIds=oe,G==null?Q.shapeFlag&512?Be.ctx.activate(Q,ee,Ce,Ae,ge):X(Q,ee,Ce,Be,ze,Ae,ge):re(G,Q,ge)},X=(G,Q,ee,Ce,Be,ze,Ae)=>{const oe=G.component=C0(G,Ce,Be);if(Gu(G)&&(oe.ctx.renderer=ie),L0(oe,!1,Ae),oe.asyncDep){if(Be&&Be.registerDep(oe,K,Ae),!G.el){const ge=oe.subTree=Ee(Jn);E(null,ge,Q,ee),G.placeholder=ge.el}}else K(oe,G,Q,ee,Be,ze,Ae)},re=(G,Q,ee)=>{const Ce=Q.component=G.component;if(a0(G,Q,ee))if(Ce.asyncDep&&!Ce.asyncResolved){ae(Ce,Q,ee);return}else Ce.next=Q,Ce.update();else Q.el=G.el,Ce.vnode=Q},K=(G,Q,ee,Ce,Be,ze,Ae)=>{const oe=()=>{if(G.isMounted){let{next:$e,bu:me,u:Ze,parent:Ge,vnode:fe}=G;{const rt=Og(G);if(rt){$e&&($e.el=fe.el,ae(G,$e,Ae)),rt.asyncDep.then(()=>{G.isUnmounted||oe()});return}}let be=$e,ne;Ni(G,!1),$e?($e.el=fe.el,ae(G,$e,Ae)):$e=fe,me&&Wc(me),(ne=$e.props&&$e.props.onVnodeBeforeUpdate)&&Bs(ne,Ge,$e,fe),Ni(G,!0);const ye=rp(G),He=G.subTree;G.subTree=ye,I(He,ye,m(He.el),H(He),G,Be,ze),$e.el=ye.el,be===null&&i0(G,ye.el),Ze&&fo(Ze,Be),(ne=$e.props&&$e.props.onVnodeUpdated)&&fo(()=>Bs(ne,Ge,$e,fe),Be)}else{let $e;const{el:me,props:Ze}=Q,{bm:Ge,m:fe,parent:be,root:ne,type:ye}=G,He=Xl(Q);Ni(G,!1),Ge&&Wc(Ge),!He&&($e=Ze&&Ze.onVnodeBeforeMount)&&Bs($e,be,Q),Ni(G,!0);{ne.ce&&ne.ce._def.shadowRoot!==!1&&ne.ce._injectChildStyle(ye);const rt=G.subTree=rp(G);I(null,rt,ee,Ce,G,Be,ze),Q.el=rt.el}if(fe&&fo(fe,Be),!He&&($e=Ze&&Ze.onVnodeMounted)){const rt=Q;fo(()=>Bs($e,be,rt),Be)}(Q.shapeFlag&256||be&&Xl(be.vnode)&&be.vnode.shapeFlag&256)&&G.a&&fo(G.a,Be),G.isMounted=!0,Q=ee=Ce=null}};G.scope.on();const ge=G.effect=new Rm(oe);G.scope.off();const Ne=G.update=ge.run.bind(ge),Oe=G.job=ge.runIfDirty.bind(ge);Oe.i=G,Oe.id=G.uid,ge.scheduler=()=>mf(Oe),Ni(G,!0),Ne()},ae=(G,Q,ee)=>{Q.component=G;const Ce=G.vnode.props;G.vnode=Q,G.next=null,r0(G,Q.props,Ce,ee),h0(G,Q.children,ee),_a(),Jf(G),Ca()},q=(G,Q,ee,Ce,Be,ze,Ae,oe,ge=!1)=>{const Ne=G&&G.children,Oe=G?G.shapeFlag:0,$e=Q.children,{patchFlag:me,shapeFlag:Ze}=Q;if(me>0){if(me&128){te(Ne,$e,ee,Ce,Be,ze,Ae,oe,ge);return}else if(me&256){Y(Ne,$e,ee,Ce,Be,ze,Ae,oe,ge);return}}Ze&8?(Oe&16&&ke(Ne,Be,ze),$e!==Ne&&f(ee,$e)):Oe&16?Ze&16?te(Ne,$e,ee,Ce,Be,ze,Ae,oe,ge):ke(Ne,Be,ze,!0):(Oe&8&&f(ee,""),Ze&16&&O($e,ee,Ce,Be,ze,Ae,oe,ge))},Y=(G,Q,ee,Ce,Be,ze,Ae,oe,ge)=>{G=G||Kl,Q=Q||Kl;const Ne=G.length,Oe=Q.length,$e=Math.min(Ne,Oe);let me;for(me=0;me<$e;me++){const Ze=Q[me]=ge?Xa(Q[me]):Vs(Q[me]);I(G[me],Ze,ee,null,Be,ze,Ae,oe,ge)}Ne>Oe?ke(G,Be,ze,!0,!1,$e):O(Q,ee,Ce,Be,ze,Ae,oe,ge,$e)},te=(G,Q,ee,Ce,Be,ze,Ae,oe,ge)=>{let Ne=0;const Oe=Q.length;let $e=G.length-1,me=Oe-1;for(;Ne<=$e&&Ne<=me;){const Ze=G[Ne],Ge=Q[Ne]=ge?Xa(Q[Ne]):Vs(Q[Ne]);if(qi(Ze,Ge))I(Ze,Ge,ee,null,Be,ze,Ae,oe,ge);else break;Ne++}for(;Ne<=$e&&Ne<=me;){const Ze=G[$e],Ge=Q[me]=ge?Xa(Q[me]):Vs(Q[me]);if(qi(Ze,Ge))I(Ze,Ge,ee,null,Be,ze,Ae,oe,ge);else break;$e--,me--}if(Ne>$e){if(Ne<=me){const Ze=me+1,Ge=Ze<Oe?Q[Ze].el:Ce;for(;Ne<=me;)I(null,Q[Ne]=ge?Xa(Q[Ne]):Vs(Q[Ne]),ee,Ge,Be,ze,Ae,oe,ge),Ne++}}else if(Ne>me)for(;Ne<=$e;)_e(G[Ne],Be,ze,!0),Ne++;else{const Ze=Ne,Ge=Ne,fe=new Map;for(Ne=Ge;Ne<=me;Ne++){const Lt=Q[Ne]=ge?Xa(Q[Ne]):Vs(Q[Ne]);Lt.key!=null&&fe.set(Lt.key,Ne)}let be,ne=0;const ye=me-Ge+1;let He=!1,rt=0;const kt=new Array(ye);for(Ne=0;Ne<ye;Ne++)kt[Ne]=0;for(Ne=Ze;Ne<=$e;Ne++){const Lt=G[Ne];if(ne>=ye){_e(Lt,Be,ze,!0);continue}let xt;if(Lt.key!=null)xt=fe.get(Lt.key);else for(be=Ge;be<=me;be++)if(kt[be-Ge]===0&&qi(Lt,Q[be])){xt=be;break}xt===void 0?_e(Lt,Be,ze,!0):(kt[xt-Ge]=Ne+1,xt>=rt?rt=xt:He=!0,I(Lt,Q[xt],ee,null,Be,ze,Ae,oe,ge),ne++)}const Ot=He?m0(kt):Kl;for(be=Ot.length-1,Ne=ye-1;Ne>=0;Ne--){const Lt=Ge+Ne,xt=Q[Lt],Kt=Q[Lt+1],no=Lt+1<Oe?Kt.el||Ng(Kt):Ce;kt[Ne]===0?I(null,xt,ee,no,Be,ze,Ae,oe,ge):He&&(be<0||Ne!==Ot[be]?ue(xt,ee,no,2):be--)}}},ue=(G,Q,ee,Ce,Be=null)=>{const{el:ze,type:Ae,transition:oe,children:ge,shapeFlag:Ne}=G;if(Ne&6){ue(G.component.subTree,Q,ee,Ce);return}if(Ne&128){G.suspense.move(Q,ee,Ce);return}if(Ne&64){Ae.move(G,Q,ee,ie);return}if(Ae===Se){s(ze,Q,ee);for(let $e=0;$e<ge.length;$e++)ue(ge[$e],Q,ee,Ce);s(G.anchor,Q,ee);return}if(Ae===zr){C(G,Q,ee);return}if(Ce!==2&&Ne&1&&oe)if(Ce===0)oe.beforeEnter(ze),s(ze,Q,ee),fo(()=>oe.enter(ze),Be);else{const{leave:$e,delayLeave:me,afterLeave:Ze}=oe,Ge=()=>{G.ctx.isUnmounted?o(ze):s(ze,Q,ee)},fe=()=>{ze._isLeaving&&ze[ha](!0),$e(ze,()=>{Ge(),Ze&&Ze()})};me?me(ze,Ge,fe):fe()}else s(ze,Q,ee)},_e=(G,Q,ee,Ce=!1,Be=!1)=>{const{type:ze,props:Ae,ref:oe,children:ge,dynamicChildren:Ne,shapeFlag:Oe,patchFlag:$e,dirs:me,cacheIndex:Ze}=G;if($e===-2&&(Be=!1),oe!=null&&(_a(),Fr(oe,null,ee,G,!0),Ca()),Ze!=null&&(Q.renderCache[Ze]=void 0),Oe&256){Q.ctx.deactivate(G);return}const Ge=Oe&1&&me,fe=!Xl(G);let be;if(fe&&(be=Ae&&Ae.onVnodeBeforeUnmount)&&Bs(be,Q,G),Oe&6)De(G.component,ee,Ce);else{if(Oe&128){G.suspense.unmount(ee,Ce);return}Ge&&Oi(G,null,Q,"beforeUnmount"),Oe&64?G.type.remove(G,Q,ee,ie,Ce):Ne&&!Ne.hasOnce&&(ze!==Se||$e>0&&$e&64)?ke(Ne,Q,ee,!1,!0):(ze===Se&&$e&384||!Be&&Oe&16)&&ke(ge,Q,ee),Ce&&Te(G)}(fe&&(be=Ae&&Ae.onVnodeUnmounted)||Ge)&&fo(()=>{be&&Bs(be,Q,G),Ge&&Oi(G,null,Q,"unmounted")},ee)},Te=G=>{const{type:Q,el:ee,anchor:Ce,transition:Be}=G;if(Q===Se){Pe(ee,Ce);return}if(Q===zr){_(G);return}const ze=()=>{o(ee),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(G.shapeFlag&1&&Be&&!Be.persisted){const{leave:Ae,delayLeave:oe}=Be,ge=()=>Ae(ee,ze);oe?oe(G.el,ze,ge):ge()}else ze()},Pe=(G,Q)=>{let ee;for(;G!==Q;)ee=y(G),o(G),G=ee;o(Q)},De=(G,Q,ee)=>{const{bum:Ce,scope:Be,job:ze,subTree:Ae,um:oe,m:ge,a:Ne}=G;dp(ge),dp(Ne),Ce&&Wc(Ce),Be.stop(),ze&&(ze.flags|=8,_e(Ae,G,Q,ee)),oe&&fo(oe,Q),fo(()=>{G.isUnmounted=!0},Q)},ke=(G,Q,ee,Ce=!1,Be=!1,ze=0)=>{for(let Ae=ze;Ae<G.length;Ae++)_e(G[Ae],Q,ee,Ce,Be)},H=G=>{if(G.shapeFlag&6)return H(G.component.subTree);if(G.shapeFlag&128)return G.suspense.next();const Q=y(G.anchor||G.el),ee=Q&&Q[ig];return ee?y(ee):Q};let J=!1;const de=(G,Q,ee)=>{let Ce;G==null?Q._vnode&&(_e(Q._vnode,null,null,!0),Ce=Q._vnode.component):I(Q._vnode||null,G,Q,null,null,null,ee),Q._vnode=G,J||(J=!0,Jf(Ce),tg(),J=!1)},ie={p:I,um:_e,m:ue,r:Te,mt:X,mc:O,pc:q,pbc:U,n:H,o:e};return{render:de,hydrate:void 0,createApp:Qk(de)}}function Id({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Ni({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function v0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function wf(e,t,n=!1){const s=e.children,o=t.children;if(ut(s)&&ut(o))for(let i=0;i<s.length;i++){const l=s[i];let c=o[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=o[i]=Xa(o[i]),c.el=l.el),!n&&c.patchFlag!==-2&&wf(l,c)),c.type===Wu&&(c.patchFlag!==-1?c.el=l.el:c.__elIndex=i+(e.type===Se?1:0)),c.type===Jn&&!c.el&&(c.el=l.el)}}function m0(e){const t=e.slice(),n=[0];let s,o,i,l,c;const d=e.length;for(s=0;s<d;s++){const h=e[s];if(h!==0){if(o=n[n.length-1],e[o]<h){t[s]=o,n.push(s);continue}for(i=0,l=n.length-1;i<l;)c=i+l>>1,e[n[c]]<h?i=c+1:l=c;h<e[n[i]]&&(i>0&&(t[s]=n[i-1]),n[i]=s)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}function Og(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Og(t)}function dp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Ng(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Ng(t.subTree):null}const Bg=e=>e.__isSuspense;function g0(e,t){t&&t.pendingBranch?ut(e)?t.effects.push(...e):t.effects.push(e):eg(e)}const Se=Symbol.for("v-fgt"),Wu=Symbol.for("v-txt"),Jn=Symbol.for("v-cmt"),zr=Symbol.for("v-stc"),Hr=[];let Bo=null;function p(e=!1){Hr.push(Bo=e?null:[])}function y0(){Hr.pop(),Bo=Hr[Hr.length-1]||null}let nc=1;function pu(e,t=!1){nc+=e,e<0&&Bo&&t&&(Bo.hasOnce=!0)}function Fg(e){return e.dynamicChildren=nc>0?Bo||Kl:null,y0(),nc>0&&Bo&&Bo.push(e),e}function g(e,t,n,s,o,i){return Fg(r(e,t,n,s,o,i,!0))}function qe(e,t,n,s,o){return Fg(Ee(e,t,n,s,o,!0))}function oc(e){return e?e.__v_isVNode===!0:!1}function qi(e,t){return e.type===t.type&&e.key===t.key}const Ug=({key:e})=>e??null,Kc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?hn(e)||dn(e)||_t(e)?{i:Hn,r:e,k:t,f:!!n}:e:null);function r(e,t=null,n=null,s=0,o=null,i=e===Se?0:1,l=!1,c=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ug(t),ref:t&&Kc(t),scopeId:og,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Hn};return c?(_f(d,n),i&128&&e.normalize(d)):n&&(d.shapeFlag|=hn(n)?8:16),nc>0&&!l&&Bo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&Bo.push(d),d}const Ee=k0;function k0(e,t=null,n=null,s=0,o=null,i=!1){if((!e||e===wg)&&(e=Jn),oc(e)){const c=ci(e,t,!0);return n&&_f(c,n),nc>0&&!i&&Bo&&(c.shapeFlag&6?Bo[Bo.indexOf(e)]=c:Bo.push(c)),c.patchFlag=-2,c}if(T0(e)&&(e=e.__vccOpts),t){t=b0(t);let{class:c,style:d}=t;c&&!hn(c)&&(t.class=le(c)),Qt(d)&&(Hu(d)&&!ut(d)&&(d=Rn({},d)),t.style=tt(d))}const l=hn(e)?1:Bg(e)?128:lg(e)?64:Qt(e)?4:_t(e)?2:0;return r(e,t,n,s,o,l,i,!0)}function b0(e){return e?Hu(e)||Mg(e)?Rn({},e):e:null}function ci(e,t,n=!1,s=!1){const{props:o,ref:i,patchFlag:l,children:c,transition:d}=e,h=t?zg(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Ug(h),ref:t&&t.ref?n&&i?ut(i)?i.concat(Kc(t)):[i,Kc(t)]:Kc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Se?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ci(e.ssContent),ssFallback:e.ssFallback&&ci(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&s&&tc(f,d.clone(f)),f}function Je(e=" ",t=0){return Ee(Wu,null,e,t)}function ui(e,t){const n=Ee(zr,null,e);return n.staticCount=t,n}function P(e="",t=!1){return t?(p(),qe(Jn,null,e)):Ee(Jn,null,e)}function Vs(e){return e==null||typeof e=="boolean"?Ee(Jn):ut(e)?Ee(Se,null,e.slice()):oc(e)?Xa(e):Ee(Wu,null,String(e))}function Xa(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ci(e)}function _f(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(ut(t))n=16;else if(typeof t=="object")if(s&65){const o=t.default;o&&(o._c&&(o._d=!1),_f(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!Mg(t)?t._ctx=Hn:o===3&&Hn&&(Hn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else _t(t)?(t={default:t,_ctx:Hn},n=32):(t=String(t),s&64?(n=16,t=[Je(t)]):n=8);e.children=t,e.shapeFlag|=n}function zg(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const o in s)if(o==="class")t.class!==s.class&&(t.class=le([t.class,s.class]));else if(o==="style")t.style=tt([t.style,s.style]);else if(Ru(o)){const i=t[o],l=s[o];l&&i!==l&&!(ut(i)&&i.includes(l))&&(t[o]=i?[].concat(i,l):l)}else o!==""&&(t[o]=s[o])}return t}function Bs(e,t,n,s=null){Ts(e,t,7,[n,s])}const w0=Ig();let _0=0;function C0(e,t,n){const s=e.type,o=(t?t.appContext:e.appContext)||w0,i={uid:_0++,vnode:e,type:s,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Em(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Eg(s,o),emitsOptions:xg(s,o),emit:null,emitted:null,propsDefaults:en,inheritAttrs:s.inheritAttrs,ctx:en,data:en,props:en,attrs:en,slots:en,refs:en,setupState:en,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=t0.bind(null,i),e.ce&&e.ce(i),i}let Xn=null;const Zu=()=>Xn||Hn;let vu,Ah;{const e=Uu(),t=(n,s)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(s),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};vu=t("__VUE_INSTANCE_SETTERS__",n=>Xn=n),Ah=t("__VUE_SSR_SETTERS__",n=>sc=n)}const dc=e=>{const t=Xn;return vu(e),e.scope.on(),()=>{e.scope.off(),vu(t)}},hp=()=>{Xn&&Xn.scope.off(),vu(null)};function Hg(e){return e.vnode.shapeFlag&4}let sc=!1;function L0(e,t=!1,n=!1){t&&Ah(t);const{props:s,children:o}=e.vnode,i=Hg(e);l0(e,s,i,t),d0(e,o,n||t);const l=i?S0(e,t):void 0;return t&&Ah(!1),l}function S0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,jk);const{setup:s}=n;if(s){_a();const o=e.setupContext=s.length>1?x0(e):null,i=dc(e),l=uc(s,e,0,[e.props,o]),c=Sm(l);if(Ca(),i(),(c||e.sp)&&!Xl(e)&&mg(e),c){if(l.then(hp,hp),t)return l.then(d=>{fp(e,d)}).catch(d=>{Vu(d,e,0)});e.asyncDep=l}else fp(e,l)}else Vg(e)}function fp(e,t,n){_t(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qt(t)&&(e.setupState=Jm(t)),Vg(e)}function Vg(e,t,n){const s=e.type;e.render||(e.render=s.render||Ls);{const o=dc(e);_a();try{Wk(e)}finally{Ca(),o()}}}const I0={get(e,t){return Yn(e,"get",""),e[t]}};function x0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,I0),slots:e.slots,emit:e.emit,expose:t}}function Ku(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Jm(vf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ur)return Ur[n](e)},has(t,n){return n in t||n in Ur}})):e.proxy}function $0(e,t=!0){return _t(e)?e.displayName||e.name:e.name||t&&e.__name}function T0(e){return _t(e)&&"__vccOpts"in e}const z=(e,t)=>Ck(e,t,sc);function Cf(e,t,n){try{pu(-1);const s=arguments.length;return s===2?Qt(t)&&!ut(t)?oc(t)?Ee(e,null,[t]):Ee(e,t):Ee(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&oc(n)&&(n=[n]),Ee(e,t,n))}finally{pu(1)}}const M0="3.5.26";let Eh;const pp=typeof window<"u"&&window.trustedTypes;if(pp)try{Eh=pp.createPolicy("vue",{createHTML:e=>e})}catch{}const Gg=Eh?e=>Eh.createHTML(e):e=>e,A0="http://www.w3.org/2000/svg",E0="http://www.w3.org/1998/Math/MathML",da=typeof document<"u"?document:null,vp=da&&da.createElement("template"),P0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const o=t==="svg"?da.createElementNS(A0,e):t==="mathml"?da.createElementNS(E0,e):n?da.createElement(e,{is:n}):da.createElement(e);return e==="select"&&s&&s.multiple!=null&&o.setAttribute("multiple",s.multiple),o},createText:e=>da.createTextNode(e),createComment:e=>da.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>da.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,o,i){const l=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{vp.innerHTML=Gg(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const c=vp.content;if(s==="svg"||s==="mathml"){const d=c.firstChild;for(;d.firstChild;)c.appendChild(d.firstChild);c.removeChild(d)}t.insertBefore(c,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},qa="transition",_r="animation",ac=Symbol("_vtc"),qg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},D0=Rn({},ug,qg),R0=e=>(e.displayName="Transition",e.props=D0,e),Is=R0((e,{slots:t})=>Cf(Rk,O0(e),t)),Bi=(e,t=[])=>{ut(e)?e.forEach(n=>n(...t)):e&&e(...t)},mp=e=>e?ut(e)?e.some(t=>t.length>1):e.length>1:!1;function O0(e){const t={};for(const j in e)j in qg||(t[j]=e[j]);if(e.css===!1)return t;const{name:n="v",type:s,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=c,leaveFromClass:m=`${n}-leave-from`,leaveActiveClass:y=`${n}-leave-active`,leaveToClass:k=`${n}-leave-to`}=e,b=N0(o),I=b&&b[0],T=b&&b[1],{onBeforeEnter:E,onEnter:x,onEnterCancelled:C,onLeave:_,onLeaveCancelled:$,onBeforeAppear:R=E,onAppear:M=x,onAppearCancelled:O=C}=t,A=(j,Z,X,re)=>{j._enterCancelled=re,Fi(j,Z?f:c),Fi(j,Z?h:l),X&&X()},U=(j,Z)=>{j._isLeaving=!1,Fi(j,m),Fi(j,k),Fi(j,y),Z&&Z()},F=j=>(Z,X)=>{const re=j?M:x,K=()=>A(Z,j,X);Bi(re,[Z,K]),gp(()=>{Fi(Z,j?d:i),ra(Z,j?f:c),mp(re)||yp(Z,s,I,K)})};return Rn(t,{onBeforeEnter(j){Bi(E,[j]),ra(j,i),ra(j,l)},onBeforeAppear(j){Bi(R,[j]),ra(j,d),ra(j,h)},onEnter:F(!1),onAppear:F(!0),onLeave(j,Z){j._isLeaving=!0;const X=()=>U(j,Z);ra(j,m),j._enterCancelled?(ra(j,y),wp(j)):(wp(j),ra(j,y)),gp(()=>{j._isLeaving&&(Fi(j,m),ra(j,k),mp(_)||yp(j,s,T,X))}),Bi(_,[j,X])},onEnterCancelled(j){A(j,!1,void 0,!0),Bi(C,[j])},onAppearCancelled(j){A(j,!0,void 0,!0),Bi(O,[j])},onLeaveCancelled(j){U(j),Bi($,[j])}})}function N0(e){if(e==null)return null;if(Qt(e))return[xd(e.enter),xd(e.leave)];{const t=xd(e);return[t,t]}}function xd(e){return z1(e)}function ra(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[ac]||(e[ac]=new Set)).add(t)}function Fi(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const n=e[ac];n&&(n.delete(t),n.size||(e[ac]=void 0))}function gp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let B0=0;function yp(e,t,n,s){const o=e._endId=++B0,i=()=>{o===e._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:l,timeout:c,propCount:d}=F0(e,t);if(!l)return s();const h=l+"end";let f=0;const m=()=>{e.removeEventListener(h,y),i()},y=k=>{k.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},c+1),e.addEventListener(h,y)}function F0(e,t){const n=window.getComputedStyle(e),s=b=>(n[b]||"").split(", "),o=s(`${qa}Delay`),i=s(`${qa}Duration`),l=kp(o,i),c=s(`${_r}Delay`),d=s(`${_r}Duration`),h=kp(c,d);let f=null,m=0,y=0;t===qa?l>0&&(f=qa,m=l,y=i.length):t===_r?h>0&&(f=_r,m=h,y=d.length):(m=Math.max(l,h),f=m>0?l>h?qa:_r:null,y=f?f===qa?i.length:d.length:0);const k=f===qa&&/\b(?:transform|all)(?:,|$)/.test(s(`${qa}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:k}}function kp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,s)=>bp(n)+bp(e[s])))}function bp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function wp(e){return(e?e.ownerDocument:document).body.offsetHeight}function U0(e,t,n){const s=e[ac];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const mu=Symbol("_vod"),jg=Symbol("_vsh"),os={name:"show",beforeMount(e,{value:t},{transition:n}){e[mu]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Cr(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),Cr(e,!0),s.enter(e)):s.leave(e,()=>{Cr(e,!1)}):Cr(e,t))},beforeUnmount(e,{value:t}){Cr(e,t)}};function Cr(e,t){e.style.display=t?e[mu]:"none",e[jg]=!t}const Wg=Symbol("");function z0(e){const t=Zu();if(!t)return;const n=t.ut=(o=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>gu(i,o))},s=()=>{const o=e(t.proxy);t.ce?gu(t.ce,o):Ph(t.subTree,o),n(o)};yg(()=>{eg(s)}),un(()=>{Ye(s,Ls,{flush:"post"});const o=new MutationObserver(s);o.observe(t.subTree.el.parentNode,{childList:!0}),Ln(()=>o.disconnect())})}function Ph(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Ph(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)gu(e.el,t);else if(e.type===Se)e.children.forEach(n=>Ph(n,t));else if(e.type===zr){let{el:n,anchor:s}=e;for(;n&&(gu(n,t),n!==s);)n=n.nextSibling}}function gu(e,t){if(e.nodeType===1){const n=e.style;let s="";for(const o in t){const i=K1(t[o]);n.setProperty(`--${o}`,i),s+=`--${o}: ${i};`}n[Wg]=s}}const H0=/(?:^|;)\s*display\s*:/;function V0(e,t,n){const s=e.style,o=hn(n);let i=!1;if(n&&!o){if(t)if(hn(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();n[c]==null&&Yc(s,c,"")}else for(const l in t)n[l]==null&&Yc(s,l,"");for(const l in n)l==="display"&&(i=!0),Yc(s,l,n[l])}else if(o){if(t!==n){const l=s[Wg];l&&(n+=";"+l),s.cssText=n,i=H0.test(n)}}else t&&e.removeAttribute("style");mu in e&&(e[mu]=i?s.display:"",e[jg]&&(s.display="none"))}const _p=/\s*!important$/;function Yc(e,t,n){if(ut(n))n.forEach(s=>Yc(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=G0(e,t);_p.test(n)?e.setProperty(fi(s),n.replace(_p,""),"important"):e[s]=n}}const Cp=["Webkit","Moz","ms"],$d={};function G0(e,t){const n=$d[t];if(n)return n;let s=ns(t);if(s!=="filter"&&s in e)return $d[t]=s;s=Bu(s);for(let o=0;o<Cp.length;o++){const i=Cp[o]+s;if(i in e)return $d[t]=i}return t}const Lp="http://www.w3.org/1999/xlink";function Sp(e,t,n,s,o,i=W1(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Lp,t.slice(6,t.length)):e.setAttributeNS(Lp,t,n):n==null||i&&!Tm(n)?e.removeAttribute(t):e.setAttribute(t,i?"":xs(n)?String(n):n)}function Ip(e,t,n,s,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Gg(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(c!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=Tm(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(o||t)}function va(e,t,n,s){e.addEventListener(t,n,s)}function q0(e,t,n,s){e.removeEventListener(t,n,s)}const xp=Symbol("_vei");function j0(e,t,n,s,o=null){const i=e[xp]||(e[xp]={}),l=i[t];if(s&&l)l.value=s;else{const[c,d]=W0(t);if(s){const h=i[t]=Y0(s,o);va(e,c,h,d)}else l&&(q0(e,c,l,d),i[t]=void 0)}}const $p=/(?:Once|Passive|Capture)$/;function W0(e){let t;if($p.test(e)){t={};let s;for(;s=e.match($p);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):fi(e.slice(2)),t]}let Td=0;const Z0=Promise.resolve(),K0=()=>Td||(Z0.then(()=>Td=0),Td=Date.now());function Y0(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;Ts(J0(s,n.value),t,5,[s])};return n.value=e,n.attached=K0(),n}function J0(e,t){if(ut(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>o=>!o._stopped&&s&&s(o))}else return t}const Tp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,X0=(e,t,n,s,o,i)=>{const l=o==="svg";t==="class"?U0(e,s,l):t==="style"?V0(e,n,s):Ru(t)?af(t)||j0(e,t,n,s,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Q0(e,t,s,l))?(Ip(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Sp(e,t,s,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!hn(s))?Ip(e,ns(t),s,i,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),Sp(e,t,s,l))};function Q0(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&Tp(t)&&_t(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Tp(t)&&hn(n)?!1:t in e}const di=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ut(t)?n=>Wc(t,n):t};function eb(e){e.target.composing=!0}function Mp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ts=Symbol("_assign");function Ap(e,t,n){return t&&(e=e.trim()),n&&(e=Fu(e)),e}const st={created(e,{modifiers:{lazy:t,trim:n,number:s}},o){e[ts]=di(o);const i=s||o.props&&o.props.type==="number";va(e,t?"change":"input",l=>{l.target.composing||e[ts](Ap(e.value,n,i))}),(n||i)&&va(e,"change",()=>{e.value=Ap(e.value,n,i)}),t||(va(e,"compositionstart",eb),va(e,"compositionend",Mp),va(e,"change",Mp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:o,number:i}},l){if(e[ts]=di(l),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Fu(e.value):e.value,d=t??"";c!==d&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||o&&e.value.trim()===d)||(e.value=d))}},Ms={deep:!0,created(e,t,n){e[ts]=di(n),va(e,"change",()=>{const s=e._modelValue,o=nr(e),i=e.checked,l=e[ts];if(ut(s)){const c=rf(s,o),d=c!==-1;if(i&&!d)l(s.concat(o));else if(!i&&d){const h=[...s];h.splice(c,1),l(h)}}else if(lr(s)){const c=new Set(s);i?c.add(o):c.delete(o),l(c)}else l(Zg(e,i))})},mounted:Ep,beforeUpdate(e,t,n){e[ts]=di(n),Ep(e,t,n)}};function Ep(e,{value:t,oldValue:n},s){e._modelValue=t;let o;if(ut(t))o=rf(t,s.props.value)>-1;else if(lr(t))o=t.has(s.props.value);else{if(t===n)return;o=tl(t,Zg(e,!0))}e.checked!==o&&(e.checked=o)}const Pp={created(e,{value:t},n){e.checked=tl(t,n.props.value),e[ts]=di(n),va(e,"change",()=>{e[ts](nr(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[ts]=di(s),t!==n&&(e.checked=tl(t,s.props.value))}},Qn={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const o=lr(t);va(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?Fu(nr(l)):nr(l));e[ts](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[ts]=di(s)},mounted(e,{value:t}){Dp(e,t)},beforeUpdate(e,t,n){e[ts]=di(n)},updated(e,{value:t}){e._assigning||Dp(e,t)}};function Dp(e,t){const n=e.multiple,s=ut(t);if(!(n&&!s&&!lr(t))){for(let o=0,i=e.options.length;o<i;o++){const l=e.options[o],c=nr(l);if(n)if(s){const d=typeof c;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(c)):l.selected=rf(t,c)>-1}else l.selected=t.has(c);else if(tl(nr(l),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function nr(e){return"_value"in e?e._value:e.value}function Zg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const tb=["ctrl","shift","alt","meta"],nb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>tb.some(n=>e[`${n}Key`]&&!t.includes(n))},ct=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=((o,...i)=>{for(let l=0;l<t.length;l++){const c=nb[t[l]];if(c&&c(o,t))return}return e(o,...i)}))},ob={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qo=(e,t)=>{const n=e._withKeys||(e._withKeys={}),s=t.join(".");return n[s]||(n[s]=(o=>{if(!("key"in o))return;const i=fi(o.key);if(t.some(l=>l===i||ob[l]===i))return e(o)}))},sb=Rn({patchProp:X0},P0);let Rp;function ab(){return Rp||(Rp=f0(sb))}const ib=((...e)=>{const t=ab().createApp(...e),{mount:n}=t;return t.mount=s=>{const o=rb(s);if(!o)return;const i=t._component;!_t(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const l=n(o,!1,lb(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),l},t});function lb(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function rb(e){return hn(e)?document.querySelector(e):e}let Kg;const Yu=e=>Kg=e,Yg=Symbol();function Dh(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Vr;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Vr||(Vr={}));function cb(){const e=Pm(!0),t=e.run(()=>D({}));let n=[],s=[];const o=vf({install(i){Yu(o),o._a=i,i.provide(Yg,o),i.config.globalProperties.$pinia=o,s.forEach(l=>n.push(l)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const Jg=()=>{};function Op(e,t,n,s=Jg){e.add(t);const o=()=>{e.delete(t)&&s()};return!n&&Dm()&&Y1(o),o}function Bl(e,...t){e.forEach(n=>{n(...t)})}const ub=e=>e(),Np=Symbol(),Md=Symbol();function Rh(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,s)=>e.set(s,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const s=t[n],o=e[n];Dh(o)&&Dh(s)&&e.hasOwnProperty(n)&&!dn(s)&&!ba(s)?e[n]=Rh(o,s):e[n]=s}return e}const db=Symbol();function hb(e){return!Dh(e)||!Object.prototype.hasOwnProperty.call(e,db)}const{assign:Za}=Object;function fb(e){return!!(dn(e)&&e.effect)}function pb(e,t,n,s){const{state:o,actions:i,getters:l}=t,c=n.state.value[e];let d;function h(){c||(n.state.value[e]=o?o():{});const f=kk(n.state.value[e]);return Za(f,i,Object.keys(l||{}).reduce((m,y)=>(m[y]=vf(z(()=>{Yu(n);const k=n._s.get(e);return l[y].call(k,k)})),m),{}))}return d=Xg(e,h,t,n,s,!0),d}function Xg(e,t,n={},s,o,i){let l;const c=Za({actions:{}},n),d={deep:!0};let h,f,m=new Set,y=new Set,k;const b=s.state.value[e];!i&&!b&&(s.state.value[e]={}),D({});let I;function T(O){let A;h=f=!1,typeof O=="function"?(O(s.state.value[e]),A={type:Vr.patchFunction,storeId:e,events:k}):(Rh(s.state.value[e],O),A={type:Vr.patchObject,payload:O,storeId:e,events:k});const U=I=Symbol();cn().then(()=>{I===U&&(h=!0)}),f=!0,Bl(m,A,s.state.value[e])}const E=i?function(){const{state:A}=n,U=A?A():{};this.$patch(F=>{Za(F,U)})}:Jg;function x(){l.stop(),m.clear(),y.clear(),s._s.delete(e)}const C=(O,A="")=>{if(Np in O)return O[Md]=A,O;const U=function(){Yu(s);const F=Array.from(arguments),j=new Set,Z=new Set;function X(ae){j.add(ae)}function re(ae){Z.add(ae)}Bl(y,{args:F,name:U[Md],store:$,after:X,onError:re});let K;try{K=O.apply(this&&this.$id===e?this:$,F)}catch(ae){throw Bl(Z,ae),ae}return K instanceof Promise?K.then(ae=>(Bl(j,ae),ae)).catch(ae=>(Bl(Z,ae),Promise.reject(ae))):(Bl(j,K),K)};return U[Np]=!0,U[Md]=A,U},_={_p:s,$id:e,$onAction:Op.bind(null,y),$patch:T,$reset:E,$subscribe(O,A={}){const U=Op(m,O,A.detached,()=>F()),F=l.run(()=>Ye(()=>s.state.value[e],j=>{(A.flush==="sync"?f:h)&&O({storeId:e,type:Vr.direct,events:k},j)},Za({},d,A)));return U},$dispose:x},$=sl(_);s._s.set(e,$);const M=(s._a&&s._a.runWithContext||ub)(()=>s._e.run(()=>(l=Pm()).run(()=>t({action:C}))));for(const O in M){const A=M[O];if(dn(A)&&!fb(A)||ba(A))i||(b&&hb(A)&&(dn(A)?A.value=b[O]:Rh(A,b[O])),s.state.value[e][O]=A);else if(typeof A=="function"){const U=C(A,O);M[O]=U,c.actions[O]=A}}return Za($,M),Za(Ut($),M),Object.defineProperty($,"$state",{get:()=>s.state.value[e],set:O=>{T(A=>{Za(A,O)})}}),s._p.forEach(O=>{Za($,l.run(()=>O({store:$,app:s._a,pinia:s,options:c})))}),b&&i&&n.hydrate&&n.hydrate($.$state,b),h=!0,f=!0,$}function Lf(e,t,n){let s;const o=typeof t=="function";s=o?n:t;function i(l,c){const d=$k();return l=l||(d?xo(Yg,null):null),l&&Yu(l),l=Kg,l._s.has(e)||(o?Xg(e,t,s,l):pb(e,s,l)),l._s.get(e)}return i.$id=e,i}const Vl=typeof document<"u";function Qg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function vb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Qg(e.default)}const jt=Object.assign;function Ad(e,t){const n={};for(const s in t){const o=t[s];n[s]=As(o)?o.map(e):e(o)}return n}const Gr=()=>{},As=Array.isArray;function Bp(e,t){const n={};for(const s in e)n[s]=s in t?t[s]:e[s];return n}const ey=/#/g,mb=/&/g,gb=/\//g,yb=/=/g,kb=/\?/g,ty=/\+/g,bb=/%5B/g,wb=/%5D/g,ny=/%5E/g,_b=/%60/g,oy=/%7B/g,Cb=/%7C/g,sy=/%7D/g,Lb=/%20/g;function Sf(e){return e==null?"":encodeURI(""+e).replace(Cb,"|").replace(bb,"[").replace(wb,"]")}function Sb(e){return Sf(e).replace(oy,"{").replace(sy,"}").replace(ny,"^")}function Oh(e){return Sf(e).replace(ty,"%2B").replace(Lb,"+").replace(ey,"%23").replace(mb,"%26").replace(_b,"`").replace(oy,"{").replace(sy,"}").replace(ny,"^")}function Ib(e){return Oh(e).replace(yb,"%3D")}function xb(e){return Sf(e).replace(ey,"%23").replace(kb,"%3F")}function $b(e){return xb(e).replace(gb,"%2F")}function ic(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Tb=/\/$/,Mb=e=>e.replace(Tb,"");function Ed(e,t,n="/"){let s,o={},i="",l="";const c=t.indexOf("#");let d=t.indexOf("?");return d=c>=0&&d>c?-1:d,d>=0&&(s=t.slice(0,d),i=t.slice(d,c>0?c:t.length),o=e(i.slice(1))),c>=0&&(s=s||t.slice(0,c),l=t.slice(c,t.length)),s=Db(s??t,n),{fullPath:s+i+l,path:s,query:o,hash:ic(l)}}function Ab(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Fp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Eb(e,t,n){const s=t.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&or(t.matched[s],n.matched[o])&&ay(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function or(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ay(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!Pb(e[n],t[n]))return!1;return!0}function Pb(e,t){return As(e)?Up(e,t):As(t)?Up(t,e):e?.valueOf()===t?.valueOf()}function Up(e,t){return As(t)?e.length===t.length&&e.every((n,s)=>n===t[s]):e.length===1&&e[0]===t}function Db(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),s=e.split("/"),o=s[s.length-1];(o===".."||o===".")&&s.push("");let i=n.length-1,l,c;for(l=0;l<s.length;l++)if(c=s[l],c!==".")if(c==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(l).join("/")}const ja={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Nh=(function(e){return e.pop="pop",e.push="push",e})({}),Pd=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Rb(e){if(!e)if(Vl){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Mb(e)}const Ob=/^[^#]+#/;function Nb(e,t){return e.replace(Ob,"#")+t}function Bb(e,t){const n=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:t.behavior,left:s.left-n.left-(t.left||0),top:s.top-n.top-(t.top||0)}}const Ju=()=>({left:window.scrollX,top:window.scrollY});function Fb(e){let t;if("el"in e){const n=e.el,s=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=Bb(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function zp(e,t){return(history.state?history.state.position-t:-1)+e}const Bh=new Map;function Ub(e,t){Bh.set(e,t)}function zb(e){const t=Bh.get(e);return Bh.delete(e),t}function Hb(e){return typeof e=="string"||e&&typeof e=="object"}function iy(e){return typeof e=="string"||typeof e=="symbol"}let vn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const ly=Symbol("");vn.MATCHER_NOT_FOUND+"",vn.NAVIGATION_GUARD_REDIRECT+"",vn.NAVIGATION_ABORTED+"",vn.NAVIGATION_CANCELLED+"",vn.NAVIGATION_DUPLICATED+"";function sr(e,t){return jt(new Error,{type:e,[ly]:!0},t)}function ca(e,t){return e instanceof Error&&ly in e&&(t==null||!!(e.type&t))}const Vb=["params","query","hash"];function Gb(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of Vb)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function qb(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const o=n[s].replace(ty," "),i=o.indexOf("="),l=ic(i<0?o:o.slice(0,i)),c=i<0?null:ic(o.slice(i+1));if(l in t){let d=t[l];As(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function Hp(e){let t="";for(let n in e){const s=e[n];if(n=Ib(n),s==null){s!==void 0&&(t+=(t.length?"&":"")+n);continue}(As(s)?s.map(o=>o&&Oh(o)):[s&&Oh(s)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function jb(e){const t={};for(const n in e){const s=e[n];s!==void 0&&(t[n]=As(s)?s.map(o=>o==null?null:""+o):s==null?s:""+s)}return t}const Wb=Symbol(""),Vp=Symbol(""),Xu=Symbol(""),If=Symbol(""),Fh=Symbol("");function Lr(){let e=[];function t(s){return e.push(s),()=>{const o=e.indexOf(s);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function Qa(e,t,n,s,o,i=l=>l()){const l=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((c,d)=>{const h=y=>{y===!1?d(sr(vn.NAVIGATION_ABORTED,{from:n,to:t})):y instanceof Error?d(y):Hb(y)?d(sr(vn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&s.enterCallbacks[o]===l&&typeof y=="function"&&l.push(y),c())},f=i(()=>e.call(s&&s.instances[o],t,n,h));let m=Promise.resolve(f);e.length<3&&(m=m.then(h)),m.catch(y=>d(y))})}function Dd(e,t,n,s,o=i=>i()){const i=[];for(const l of e)for(const c in l.components){let d=l.components[c];if(!(t!=="beforeRouteEnter"&&!l.instances[c]))if(Qg(d)){const h=(d.__vccOpts||d)[t];h&&i.push(Qa(h,n,s,l,c,o))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${l.path}"`);const m=vb(f)?f.default:f;l.mods[c]=f,l.components[c]=m;const y=(m.__vccOpts||m)[t];return y&&Qa(y,n,s,l,c,o)()}))}}return i}function Zb(e,t){const n=[],s=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const c=t.matched[l];c&&(e.matched.find(h=>or(h,c))?s.push(c):n.push(c));const d=e.matched[l];d&&(t.matched.find(h=>or(h,d))||o.push(d))}return[n,s,o]}let Kb=()=>location.protocol+"//"+location.host;function ry(e,t){const{pathname:n,search:s,hash:o}=t,i=e.indexOf("#");if(i>-1){let l=o.includes(e.slice(i))?e.slice(i).length:1,c=o.slice(l);return c[0]!=="/"&&(c="/"+c),Fp(c,"")}return Fp(n,e)+s+o}function Yb(e,t,n,s){let o=[],i=[],l=null;const c=({state:y})=>{const k=ry(e,location),b=n.value,I=t.value;let T=0;if(y){if(n.value=k,t.value=y,l&&l===b){l=null;return}T=I?y.position-I.position:0}else s(k);o.forEach(E=>{E(n.value,b,{delta:T,type:Nh.pop,direction:T?T>0?Pd.forward:Pd.back:Pd.unknown})})};function d(){l=n.value}function h(y){o.push(y);const k=()=>{const b=o.indexOf(y);b>-1&&o.splice(b,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(jt({},y.state,{scroll:Ju()}),"")}}function m(){for(const y of i)y();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:m}}function Gp(e,t,n,s=!1,o=!1){return{back:e,current:t,forward:n,replaced:s,position:window.history.length,scroll:o?Ju():null}}function Jb(e){const{history:t,location:n}=window,s={value:ry(e,n)},o={value:t.state};o.value||i(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const m=e.indexOf("#"),y=m>-1?(n.host&&document.querySelector("base")?e:e.slice(m))+d:Kb()+e+d;try{t[f?"replaceState":"pushState"](h,"",y),o.value=h}catch(k){console.error(k),n[f?"replace":"assign"](y)}}function l(d,h){i(d,jt({},t.state,Gp(o.value.back,d,o.value.forward,!0),h,{position:o.value.position}),!0),s.value=d}function c(d,h){const f=jt({},o.value,t.state,{forward:d,scroll:Ju()});i(f.current,f,!0),i(d,jt({},Gp(s.value,d,null),{position:f.position+1},h),!1),s.value=d}return{location:s,state:o,push:c,replace:l}}function Xb(e){e=Rb(e);const t=Jb(e),n=Yb(e,t.state,t.location,t.replace);function s(i,l=!0){l||n.pauseListeners(),history.go(i)}const o=jt({location:"",base:e,go:s,createHref:Nb.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function Qb(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Xb(e)}let Ki=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var $n=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})($n||{});const ew={type:Ki.Static,value:""},tw=/[a-zA-Z0-9_]/;function nw(e){if(!e)return[[]];if(e==="/")return[[ew]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${n})/"${h}": ${k}`)}let n=$n.Static,s=n;const o=[];let i;function l(){i&&o.push(i),i=[]}let c=0,d,h="",f="";function m(){h&&(n===$n.Static?i.push({type:Ki.Static,value:h}):n===$n.Param||n===$n.ParamRegExp||n===$n.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Ki.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;c<e.length;){if(d=e[c++],d==="\\"&&n!==$n.ParamRegExp){s=n,n=$n.EscapeNext;continue}switch(n){case $n.Static:d==="/"?(h&&m(),l()):d===":"?(m(),n=$n.Param):y();break;case $n.EscapeNext:y(),n=s;break;case $n.Param:d==="("?n=$n.ParamRegExp:tw.test(d)?y():(m(),n=$n.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--);break;case $n.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:n=$n.ParamRegExpEnd:f+=d;break;case $n.ParamRegExpEnd:m(),n=$n.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--,f="";break;default:t("Unknown state");break}}return n===$n.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),m(),l(),o}const qp="[^/]+?",ow={sensitive:!1,strict:!1,start:!0,end:!0};var po=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(po||{});const sw=/[.+*?^${}()[\]/\\]/g;function aw(e,t){const n=jt({},ow,t),s=[];let o=n.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[po.Root];n.strict&&!h.length&&(o+="/");for(let m=0;m<h.length;m++){const y=h[m];let k=po.Segment+(n.sensitive?po.BonusCaseSensitive:0);if(y.type===Ki.Static)m||(o+="/"),o+=y.value.replace(sw,"\\$&"),k+=po.Static;else if(y.type===Ki.Param){const{value:b,repeatable:I,optional:T,regexp:E}=y;i.push({name:b,repeatable:I,optional:T});const x=E||qp;if(x!==qp){k+=po.BonusCustomRegExp;try{`${x}`}catch(_){throw new Error(`Invalid custom RegExp for param "${b}" (${x}): `+_.message)}}let C=I?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;m||(C=T&&h.length<2?`(?:/${C})`:"/"+C),T&&(C+="?"),o+=C,k+=po.Dynamic,T&&(k+=po.BonusOptional),I&&(k+=po.BonusRepeatable),x===".*"&&(k+=po.BonusWildcard)}f.push(k)}s.push(f)}if(n.strict&&n.end){const h=s.length-1;s[h][s[h].length-1]+=po.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const l=new RegExp(o,n.sensitive?"":"i");function c(h){const f=h.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const k=f[y]||"",b=i[y-1];m[b.name]=k&&b.repeatable?k.split("/"):k}return m}function d(h){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const k of y)if(k.type===Ki.Static)f+=k.value;else if(k.type===Ki.Param){const{value:b,repeatable:I,optional:T}=k,E=b in h?h[b]:"";if(As(E)&&!I)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const x=As(E)?E.join("/"):E;if(!x)if(T)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${b}"`);f+=x}}return f||"/"}return{re:l,score:s,keys:i,parse:c,stringify:d}}function iw(e,t){let n=0;for(;n<e.length&&n<t.length;){const s=t[n]-e[n];if(s)return s;n++}return e.length<t.length?e.length===1&&e[0]===po.Static+po.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===po.Static+po.Segment?1:-1:0}function cy(e,t){let n=0;const s=e.score,o=t.score;for(;n<s.length&&n<o.length;){const i=iw(s[n],o[n]);if(i)return i;n++}if(Math.abs(o.length-s.length)===1){if(jp(s))return 1;if(jp(o))return-1}return o.length-s.length}function jp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const lw={strict:!1,end:!0,sensitive:!1};function rw(e,t,n){const s=aw(nw(e.path),n),o=jt(s,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function cw(e,t){const n=[],s=new Map;t=Bp(lw,t);function o(m){return s.get(m)}function i(m,y,k){const b=!k,I=Zp(m);I.aliasOf=k&&k.record;const T=Bp(t,m),E=[I];if("alias"in m){const _=typeof m.alias=="string"?[m.alias]:m.alias;for(const $ of _)E.push(Zp(jt({},I,{components:k?k.record.components:I.components,path:$,aliasOf:k?k.record:I})))}let x,C;for(const _ of E){const{path:$}=_;if(y&&$[0]!=="/"){const R=y.record.path,M=R[R.length-1]==="/"?"":"/";_.path=y.record.path+($&&M+$)}if(x=rw(_,y,T),k?k.alias.push(x):(C=C||x,C!==x&&C.alias.push(x),b&&m.name&&!Kp(x)&&l(m.name)),uy(x)&&d(x),I.children){const R=I.children;for(let M=0;M<R.length;M++)i(R[M],x,k&&k.children[M])}k=k||x}return C?()=>{l(C)}:Gr}function l(m){if(iy(m)){const y=s.get(m);y&&(s.delete(m),n.splice(n.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=n.indexOf(m);y>-1&&(n.splice(y,1),m.record.name&&s.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function c(){return n}function d(m){const y=hw(m,n);n.splice(y,0,m),m.record.name&&!Kp(m)&&s.set(m.record.name,m)}function h(m,y){let k,b={},I,T;if("name"in m&&m.name){if(k=s.get(m.name),!k)throw sr(vn.MATCHER_NOT_FOUND,{location:m});T=k.record.name,b=jt(Wp(y.params,k.keys.filter(C=>!C.optional).concat(k.parent?k.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),m.params&&Wp(m.params,k.keys.map(C=>C.name))),I=k.stringify(b)}else if(m.path!=null)I=m.path,k=n.find(C=>C.re.test(I)),k&&(b=k.parse(I),T=k.record.name);else{if(k=y.name?s.get(y.name):n.find(C=>C.re.test(y.path)),!k)throw sr(vn.MATCHER_NOT_FOUND,{location:m,currentLocation:y});T=k.record.name,b=jt({},y.params,m.params),I=k.stringify(b)}const E=[];let x=k;for(;x;)E.unshift(x.record),x=x.parent;return{name:T,path:I,params:b,matched:E,meta:dw(E)}}e.forEach(m=>i(m));function f(){n.length=0,s.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:c,getRecordMatcher:o}}function Wp(e,t){const n={};for(const s of t)s in e&&(n[s]=e[s]);return n}function Zp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:uw(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function uw(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const s in e.components)t[s]=typeof n=="object"?n[s]:n;return t}function Kp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function dw(e){return e.reduce((t,n)=>jt(t,n.meta),{})}function hw(e,t){let n=0,s=t.length;for(;n!==s;){const i=n+s>>1;cy(e,t[i])<0?s=i:n=i+1}const o=fw(e);return o&&(s=t.lastIndexOf(o,s-1)),s}function fw(e){let t=e;for(;t=t.parent;)if(uy(t)&&cy(e,t)===0)return t}function uy({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Yp(e){const t=xo(Xu),n=xo(If),s=z(()=>{const d=B(e.to);return t.resolve(d)}),o=z(()=>{const{matched:d}=s.value,{length:h}=d,f=d[h-1],m=n.matched;if(!f||!m.length)return-1;const y=m.findIndex(or.bind(null,f));if(y>-1)return y;const k=Jp(d[h-2]);return h>1&&Jp(f)===k&&m[m.length-1].path!==k?m.findIndex(or.bind(null,d[h-2])):y}),i=z(()=>o.value>-1&&yw(n.params,s.value.params)),l=z(()=>o.value>-1&&o.value===n.matched.length-1&&ay(n.params,s.value.params));function c(d={}){if(gw(d)){const h=t[B(e.replace)?"replace":"push"](B(e.to)).catch(Gr);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:s,href:z(()=>s.value.href),isActive:i,isExactActive:l,navigate:c}}function pw(e){return e.length===1?e[0]:e}const vw=vg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Yp,setup(e,{slots:t}){const n=sl(Yp(e)),{options:s}=xo(Xu),o=z(()=>({[Xp(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Xp(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&pw(t.default(n));return e.custom?i:Cf("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),mw=vw;function gw(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function yw(e,t){for(const n in t){const s=t[n],o=e[n];if(typeof s=="string"){if(s!==o)return!1}else if(!As(o)||o.length!==s.length||s.some((i,l)=>i.valueOf()!==o[l].valueOf()))return!1}return!0}function Jp(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Xp=(e,t,n)=>e??t??n,kw=vg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=xo(Fh),o=z(()=>e.route||s.value),i=xo(Vp,0),l=z(()=>{let h=B(i);const{matched:f}=o.value;let m;for(;(m=f[h])&&!m.components;)h++;return h}),c=z(()=>o.value.matched[l.value]);Nr(Vp,z(()=>l.value+1)),Nr(Wb,c),Nr(Fh,o);const d=D();return Ye(()=>[d.value,c.value,e.name],([h,f,m],[y,k,b])=>{f&&(f.instances[m]=h,k&&k!==f&&h&&h===y&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!or(f,k)||!y)&&(f.enterCallbacks[m]||[]).forEach(I=>I(h))},{flush:"post"}),()=>{const h=o.value,f=e.name,m=c.value,y=m&&m.components[f];if(!y)return Qp(n.default,{Component:y,route:h});const k=m.props[f],b=k?k===!0?h.params:typeof k=="function"?k(h):k:null,T=Cf(y,jt({},b,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return Qp(n.default,{Component:T,route:h})||T}}});function Qp(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const bw=kw;function ww(e){const t=cw(e.routes,e),n=e.parseQuery||qb,s=e.stringifyQuery||Hp,o=e.history,i=Lr(),l=Lr(),c=Lr(),d=mk(ja);let h=ja;Vl&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ad.bind(null,H=>""+H),m=Ad.bind(null,$b),y=Ad.bind(null,ic);function k(H,J){let de,ie;return iy(H)?(de=t.getRecordMatcher(H),ie=J):ie=H,t.addRoute(ie,de)}function b(H){const J=t.getRecordMatcher(H);J&&t.removeRoute(J)}function I(){return t.getRoutes().map(H=>H.record)}function T(H){return!!t.getRecordMatcher(H)}function E(H,J){if(J=jt({},J||d.value),typeof H=="string"){const ee=Ed(n,H,J.path),Ce=t.resolve({path:ee.path},J),Be=o.createHref(ee.fullPath);return jt(ee,Ce,{params:y(Ce.params),hash:ic(ee.hash),redirectedFrom:void 0,href:Be})}let de;if(H.path!=null)de=jt({},H,{path:Ed(n,H.path,J.path).path});else{const ee=jt({},H.params);for(const Ce in ee)ee[Ce]==null&&delete ee[Ce];de=jt({},H,{params:m(ee)}),J.params=m(J.params)}const ie=t.resolve(de,J),Re=H.hash||"";ie.params=f(y(ie.params));const G=Ab(s,jt({},H,{hash:Sb(Re),path:ie.path})),Q=o.createHref(G);return jt({fullPath:G,hash:Re,query:s===Hp?jb(H.query):H.query||{}},ie,{redirectedFrom:void 0,href:Q})}function x(H){return typeof H=="string"?Ed(n,H,d.value.path):jt({},H)}function C(H,J){if(h!==H)return sr(vn.NAVIGATION_CANCELLED,{from:J,to:H})}function _(H){return M(H)}function $(H){return _(jt(x(H),{replace:!0}))}function R(H,J){const de=H.matched[H.matched.length-1];if(de&&de.redirect){const{redirect:ie}=de;let Re=typeof ie=="function"?ie(H,J):ie;return typeof Re=="string"&&(Re=Re.includes("?")||Re.includes("#")?Re=x(Re):{path:Re},Re.params={}),jt({query:H.query,hash:H.hash,params:Re.path!=null?{}:H.params},Re)}}function M(H,J){const de=h=E(H),ie=d.value,Re=H.state,G=H.force,Q=H.replace===!0,ee=R(de,ie);if(ee)return M(jt(x(ee),{state:typeof ee=="object"?jt({},Re,ee.state):Re,force:G,replace:Q}),J||de);const Ce=de;Ce.redirectedFrom=J;let Be;return!G&&Eb(s,ie,de)&&(Be=sr(vn.NAVIGATION_DUPLICATED,{to:Ce,from:ie}),ue(ie,ie,!0,!1)),(Be?Promise.resolve(Be):U(Ce,ie)).catch(ze=>ca(ze)?ca(ze,vn.NAVIGATION_GUARD_REDIRECT)?ze:te(ze):q(ze,Ce,ie)).then(ze=>{if(ze){if(ca(ze,vn.NAVIGATION_GUARD_REDIRECT))return M(jt({replace:Q},x(ze.to),{state:typeof ze.to=="object"?jt({},Re,ze.to.state):Re,force:G}),J||Ce)}else ze=j(Ce,ie,!0,Q,Re);return F(Ce,ie,ze),ze})}function O(H,J){const de=C(H,J);return de?Promise.reject(de):Promise.resolve()}function A(H){const J=Pe.values().next().value;return J&&typeof J.runWithContext=="function"?J.runWithContext(H):H()}function U(H,J){let de;const[ie,Re,G]=Zb(H,J);de=Dd(ie.reverse(),"beforeRouteLeave",H,J);for(const ee of ie)ee.leaveGuards.forEach(Ce=>{de.push(Qa(Ce,H,J))});const Q=O.bind(null,H,J);return de.push(Q),ke(de).then(()=>{de=[];for(const ee of i.list())de.push(Qa(ee,H,J));return de.push(Q),ke(de)}).then(()=>{de=Dd(Re,"beforeRouteUpdate",H,J);for(const ee of Re)ee.updateGuards.forEach(Ce=>{de.push(Qa(Ce,H,J))});return de.push(Q),ke(de)}).then(()=>{de=[];for(const ee of G)if(ee.beforeEnter)if(As(ee.beforeEnter))for(const Ce of ee.beforeEnter)de.push(Qa(Ce,H,J));else de.push(Qa(ee.beforeEnter,H,J));return de.push(Q),ke(de)}).then(()=>(H.matched.forEach(ee=>ee.enterCallbacks={}),de=Dd(G,"beforeRouteEnter",H,J,A),de.push(Q),ke(de))).then(()=>{de=[];for(const ee of l.list())de.push(Qa(ee,H,J));return de.push(Q),ke(de)}).catch(ee=>ca(ee,vn.NAVIGATION_CANCELLED)?ee:Promise.reject(ee))}function F(H,J,de){c.list().forEach(ie=>A(()=>ie(H,J,de)))}function j(H,J,de,ie,Re){const G=C(H,J);if(G)return G;const Q=J===ja,ee=Vl?history.state:{};de&&(ie||Q?o.replace(H.fullPath,jt({scroll:Q&&ee&&ee.scroll},Re)):o.push(H.fullPath,Re)),d.value=H,ue(H,J,de,Q),te()}let Z;function X(){Z||(Z=o.listen((H,J,de)=>{if(!De.listening)return;const ie=E(H),Re=R(ie,De.currentRoute.value);if(Re){M(jt(Re,{replace:!0,force:!0}),ie).catch(Gr);return}h=ie;const G=d.value;Vl&&Ub(zp(G.fullPath,de.delta),Ju()),U(ie,G).catch(Q=>ca(Q,vn.NAVIGATION_ABORTED|vn.NAVIGATION_CANCELLED)?Q:ca(Q,vn.NAVIGATION_GUARD_REDIRECT)?(M(jt(x(Q.to),{force:!0}),ie).then(ee=>{ca(ee,vn.NAVIGATION_ABORTED|vn.NAVIGATION_DUPLICATED)&&!de.delta&&de.type===Nh.pop&&o.go(-1,!1)}).catch(Gr),Promise.reject()):(de.delta&&o.go(-de.delta,!1),q(Q,ie,G))).then(Q=>{Q=Q||j(ie,G,!1),Q&&(de.delta&&!ca(Q,vn.NAVIGATION_CANCELLED)?o.go(-de.delta,!1):de.type===Nh.pop&&ca(Q,vn.NAVIGATION_ABORTED|vn.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),F(ie,G,Q)}).catch(Gr)}))}let re=Lr(),K=Lr(),ae;function q(H,J,de){te(H);const ie=K.list();return ie.length?ie.forEach(Re=>Re(H,J,de)):console.error(H),Promise.reject(H)}function Y(){return ae&&d.value!==ja?Promise.resolve():new Promise((H,J)=>{re.add([H,J])})}function te(H){return ae||(ae=!H,X(),re.list().forEach(([J,de])=>H?de(H):J()),re.reset()),H}function ue(H,J,de,ie){const{scrollBehavior:Re}=e;if(!Vl||!Re)return Promise.resolve();const G=!de&&zb(zp(H.fullPath,0))||(ie||!de)&&history.state&&history.state.scroll||null;return cn().then(()=>Re(H,J,G)).then(Q=>Q&&Fb(Q)).catch(Q=>q(Q,H,J))}const _e=H=>o.go(H);let Te;const Pe=new Set,De={currentRoute:d,listening:!0,addRoute:k,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:T,getRoutes:I,resolve:E,options:e,push:_,replace:$,go:_e,back:()=>_e(-1),forward:()=>_e(1),beforeEach:i.add,beforeResolve:l.add,afterEach:c.add,onError:K.add,isReady:Y,install(H){H.component("RouterLink",mw),H.component("RouterView",bw),H.config.globalProperties.$router=De,Object.defineProperty(H.config.globalProperties,"$route",{enumerable:!0,get:()=>B(d)}),Vl&&!Te&&d.value===ja&&(Te=!0,_(o.location).catch(ie=>{}));const J={};for(const ie in ja)Object.defineProperty(J,ie,{get:()=>d.value[ie],enumerable:!0});H.provide(Xu,De),H.provide(If,Km(J)),H.provide(Fh,d);const de=H.unmount;Pe.add(H),H.unmount=function(){Pe.delete(H),Pe.size<1&&(h=ja,Z&&Z(),Z=null,d.value=ja,Te=!1,ae=!1),de()}}};function ke(H){return H.reduce((J,de)=>J.then(()=>A(de)),Promise.resolve())}return De}function rr(){return xo(Xu)}function Qu(e){return xo(If)}const _w=500,Cw=3e3,Lw=500,ji=D(new Map),xf=D(!1),yu=D("");let dy=!1,Sw=0,qr=null;function Iw(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:_w}:{message:"Loading...",delay:Cw}}function xw(){qr&&(clearTimeout(qr),qr=null)}function $w(e){if(e.skipLoadingOverlay)return null;const t=(e.method||"get").toUpperCase();if(dy&&t==="GET")return null;xw();const n=++Sw,{message:s,delay:o}=Iw(e.method),i=setTimeout(()=>{ji.value.has(n)&&(yu.value=s,xf.value=!0)},o);return ji.value.set(n,{config:e,message:s,timeoutId:i}),e._loadingRequestId=n,n}function ev(e){if(e===null)return;const t=ji.value.get(e);if(t)if(clearTimeout(t.timeoutId),ji.value.delete(e),ji.value.size===0)qr=setTimeout(()=>{ji.value.size===0&&(xf.value=!1,yu.value=""),qr=null},Lw);else{const n=ji.value.values().next().value;n&&(yu.value=n.message)}}function tv(e){return e?._loadingRequestId}function Tw(){return{showOverlay:xf,overlayMessage:yu}}function nv(e){dy=e}const Ke=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},Mw={key:0,class:"loading-overlay"},Aw={class:"loading-content"},Ew={class:"loading-message"},Pw={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:n}=Tw();return(s,o)=>(p(),qe(Is,{name:"fade"},{default:Ve(()=>[B(t)?(p(),g("div",Mw,[r("div",Aw,[o[0]||(o[0]=r("div",{class:"spinner"},null,-1)),r("p",Ew,w(B(n)||"Loading..."),1)])])):P("",!0)]),_:1}))}},Dw=Ke(Pw,[["__scopeId","data-v-fdee3530"]]),Rw={__name:"App",setup(e){const t=rr(),n=D(""),s=["/","/sessions"];return Ye(()=>t.currentRoute.value,(o,i)=>{if(!i?.path){n.value="";return}const l=s.indexOf(o.path),c=s.indexOf(i.path);l!==-1&&c!==-1?n.value=l>c?"slide-left":"slide-right":n.value=""},{immediate:!0}),(o,i)=>{const l=gf("router-view");return p(),g(Se,null,[Ee(l,null,{default:Ve(({Component:c,route:d})=>[Ee(Is,{name:n.value,mode:"out-in"},{default:Ve(()=>[(p(),qe(qk(c),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Ee(Dw)],64)}}},cr="marshalSessions",Ow=30;function ku(e,t){return`${e}:${t}`}function $f(e){const[t,n]=e.split(":");return{eventId:t,marshalId:n}}function pi(){try{return JSON.parse(localStorage.getItem(cr)||"{}")}catch{return{}}}function bu(e){const t=pi(),n=Object.entries(t).filter(([s])=>s.startsWith(`${e}:`)).map(([s,o])=>({sessionKey:s,...o}));return n.length===0?null:(n.sort((s,o)=>new Date(o.lastAccessed)-new Date(s.lastAccessed)),n[0])}function ov(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const n=pi(),s=ku(e,t.marshalId);n[s]={...n[s],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(cr,JSON.stringify(n))}function Uh(e){const t=pi(),{eventId:n,marshalId:s}=$f(e);delete t[e],localStorage.setItem(cr,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${n}_${s}`)}function hy(e,t){const n=pi(),s=ku(e,t);n[s]&&(n[s].lastAccessed=new Date().toISOString(),localStorage.setItem(cr,JSON.stringify(n)))}function fy(){const e=pi(),t=new Date;t.setDate(t.getDate()-Ow);let n=!1;for(const s of Object.keys(e))if(new Date(e[s].lastAccessed)<t){const{eventId:i,marshalId:l}=$f(s);delete e[s],localStorage.removeItem(`marshalCode_${i}_${l}`),n=!0}n&&localStorage.setItem(cr,JSON.stringify(e))}function py(){const e=pi(),t=[];for(let s=0;s<localStorage.length;s++){const o=localStorage.key(s);if(o&&o.startsWith("marshal_")&&!o.startsWith("marshalCode_")&&!o.startsWith("marshalSessions")){const i=o.replace("marshal_",""),l=localStorage.getItem(o);if(l){const c=ku(i,l);e[c]||(e[c]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(o)}}const n=Object.keys(e).filter(s=>!s.includes(":"));for(const s of n){const o=e[s];if(o&&o.marshalId){const i=ku(s,o.marshalId);e[i]||(e[i]={...o,eventId:s}),delete e[s]}}(t.length>0||n.length>0)&&(localStorage.setItem(cr,JSON.stringify(e)),t.forEach(s=>localStorage.removeItem(s)))}function Nw(){const e=pi();return Object.entries(e).map(([t,n])=>{const{eventId:s,marshalId:o}=$f(t);return{sessionKey:t,eventId:s,marshalId:o,...n}}).filter(t=>t.token).sort((t,n)=>t.eventDate&&n.eventDate?new Date(t.eventDate)-new Date(n.eventDate):new Date(n.lastAccessed)-new Date(t.lastAccessed))}function vy(){const e=pi();return Object.values(e).some(t=>t.token)}function my(e,t){const n=`marshalCode_${e}_${t}`,s=localStorage.getItem(n);return s||localStorage.getItem(`marshalCode_${e}`)}function Bw(e,t,n){localStorage.setItem(`marshalCode_${e}_${t}`,n)}function gy(e,t){return function(){return e.apply(t,arguments)}}const{toString:Fw}=Object.prototype,{getPrototypeOf:Tf}=Object,{iterator:ed,toStringTag:yy}=Symbol,td=(e=>t=>{const n=Fw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Es=e=>(e=e.toLowerCase(),t=>td(t)===e),nd=e=>t=>typeof t===e,{isArray:ur}=Array,ar=nd("undefined");function hc(e){return e!==null&&!ar(e)&&e.constructor!==null&&!ar(e.constructor)&&$o(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ky=Es("ArrayBuffer");function Uw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ky(e.buffer),t}const zw=nd("string"),$o=nd("function"),by=nd("number"),fc=e=>e!==null&&typeof e=="object",Hw=e=>e===!0||e===!1,Jc=e=>{if(td(e)!=="object")return!1;const t=Tf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(yy in e)&&!(ed in e)},Vw=e=>{if(!fc(e)||hc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Gw=Es("Date"),qw=Es("File"),jw=Es("Blob"),Ww=Es("FileList"),Zw=e=>fc(e)&&$o(e.pipe),Kw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||$o(e.append)&&((t=td(e))==="formdata"||t==="object"&&$o(e.toString)&&e.toString()==="[object FormData]"))},Yw=Es("URLSearchParams"),[Jw,Xw,Qw,e_]=["ReadableStream","Request","Response","Headers"].map(Es),t_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),ur(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(hc(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let c;for(s=0;s<l;s++)c=i[s],t.call(null,e[c],c,e)}}function wy(e,t){if(hc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Yi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_y=e=>!ar(e)&&e!==Yi;function zh(){const{caseless:e,skipUndefined:t}=_y(this)&&this||{},n={},s=(o,i)=>{const l=e&&wy(n,i)||i;Jc(n[l])&&Jc(o)?n[l]=zh(n[l],o):Jc(o)?n[l]=zh({},o):ur(o)?n[l]=o.slice():(!t||!ar(o))&&(n[l]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&pc(arguments[o],s);return n}const n_=(e,t,n,{allOwnKeys:s}={})=>(pc(t,(o,i)=>{n&&$o(o)?e[i]=gy(o,n):e[i]=o},{allOwnKeys:s}),e),o_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),s_=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},a_=(e,t,n,s)=>{let o,i,l;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)l=o[i],(!s||s(l,e,t))&&!c[l]&&(t[l]=e[l],c[l]=!0);e=n!==!1&&Tf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},i_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},l_=e=>{if(!e)return null;if(ur(e))return e;let t=e.length;if(!by(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},r_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Tf(Uint8Array)),c_=(e,t)=>{const s=(e&&e[ed]).call(e);let o;for(;(o=s.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},u_=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},d_=Es("HTMLFormElement"),h_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),sv=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),f_=Es("RegExp"),Cy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};pc(n,(o,i)=>{let l;(l=t(o,i,e))!==!1&&(s[i]=l||o)}),Object.defineProperties(e,s)},p_=e=>{Cy(e,(t,n)=>{if($o(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if($o(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},v_=(e,t)=>{const n={},s=o=>{o.forEach(i=>{n[i]=!0})};return ur(e)?s(e):s(String(e).split(t)),n},m_=()=>{},g_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function y_(e){return!!(e&&$o(e.append)&&e[yy]==="FormData"&&e[ed])}const k_=e=>{const t=new Array(10),n=(s,o)=>{if(fc(s)){if(t.indexOf(s)>=0)return;if(hc(s))return s;if(!("toJSON"in s)){t[o]=s;const i=ur(s)?[]:{};return pc(s,(l,c)=>{const d=n(l,o+1);!ar(d)&&(i[c]=d)}),t[o]=void 0,i}}return s};return n(e,0)},b_=Es("AsyncFunction"),w_=e=>e&&(fc(e)||$o(e))&&$o(e.then)&&$o(e.catch),Ly=((e,t)=>e?setImmediate:t?((n,s)=>(Yi.addEventListener("message",({source:o,data:i})=>{o===Yi&&i===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Yi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",$o(Yi.postMessage)),__=typeof queueMicrotask<"u"?queueMicrotask.bind(Yi):typeof process<"u"&&process.nextTick||Ly,C_=e=>e!=null&&$o(e[ed]),Ue={isArray:ur,isArrayBuffer:ky,isBuffer:hc,isFormData:Kw,isArrayBufferView:Uw,isString:zw,isNumber:by,isBoolean:Hw,isObject:fc,isPlainObject:Jc,isEmptyObject:Vw,isReadableStream:Jw,isRequest:Xw,isResponse:Qw,isHeaders:e_,isUndefined:ar,isDate:Gw,isFile:qw,isBlob:jw,isRegExp:f_,isFunction:$o,isStream:Zw,isURLSearchParams:Yw,isTypedArray:r_,isFileList:Ww,forEach:pc,merge:zh,extend:n_,trim:t_,stripBOM:o_,inherits:s_,toFlatObject:a_,kindOf:td,kindOfTest:Es,endsWith:i_,toArray:l_,forEachEntry:c_,matchAll:u_,isHTMLForm:d_,hasOwnProperty:sv,hasOwnProp:sv,reduceDescriptors:Cy,freezeMethods:p_,toObjectSet:v_,toCamelCase:h_,noop:m_,toFiniteNumber:g_,findKey:wy,global:Yi,isContextDefined:_y,isSpecCompliantForm:y_,toJSONObject:k_,isAsyncFn:b_,isThenable:w_,setImmediate:Ly,asap:__,isIterable:C_};function It(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}Ue.inherits(It,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ue.toJSONObject(this.config),code:this.code,status:this.status}}});const Sy=It.prototype,Iy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Iy[e]={value:e}});Object.defineProperties(It,Iy);Object.defineProperty(Sy,"isAxiosError",{value:!0});It.from=(e,t,n,s,o,i)=>{const l=Object.create(Sy);Ue.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const c=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return It.call(l,c,d,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const L_=null;function Hh(e){return Ue.isPlainObject(e)||Ue.isArray(e)}function xy(e){return Ue.endsWith(e,"[]")?e.slice(0,-2):e}function av(e,t,n){return e?e.concat(t).map(function(o,i){return o=xy(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function S_(e){return Ue.isArray(e)&&!e.some(Hh)}const I_=Ue.toFlatObject(Ue,{},null,function(t){return/^is[A-Z]/.test(t)});function od(e,t,n){if(!Ue.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Ue.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,T){return!Ue.isUndefined(T[I])});const s=n.metaTokens,o=n.visitor||f,i=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&Ue.isSpecCompliantForm(t);if(!Ue.isFunction(o))throw new TypeError("visitor must be a function");function h(b){if(b===null)return"";if(Ue.isDate(b))return b.toISOString();if(Ue.isBoolean(b))return b.toString();if(!d&&Ue.isBlob(b))throw new It("Blob is not supported. Use a Buffer instead.");return Ue.isArrayBuffer(b)||Ue.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function f(b,I,T){let E=b;if(b&&!T&&typeof b=="object"){if(Ue.endsWith(I,"{}"))I=s?I:I.slice(0,-2),b=JSON.stringify(b);else if(Ue.isArray(b)&&S_(b)||(Ue.isFileList(b)||Ue.endsWith(I,"[]"))&&(E=Ue.toArray(b)))return I=xy(I),E.forEach(function(C,_){!(Ue.isUndefined(C)||C===null)&&t.append(l===!0?av([I],_,i):l===null?I:I+"[]",h(C))}),!1}return Hh(b)?!0:(t.append(av(T,I,i),h(b)),!1)}const m=[],y=Object.assign(I_,{defaultVisitor:f,convertValue:h,isVisitable:Hh});function k(b,I){if(!Ue.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+I.join("."));m.push(b),Ue.forEach(b,function(E,x){(!(Ue.isUndefined(E)||E===null)&&o.call(t,E,Ue.isString(x)?x.trim():x,I,y))===!0&&k(E,I?I.concat(x):[x])}),m.pop()}}if(!Ue.isObject(e))throw new TypeError("data must be an object");return k(e),t}function iv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Mf(e,t){this._pairs=[],e&&od(e,this,t)}const $y=Mf.prototype;$y.append=function(t,n){this._pairs.push([t,n])};$y.toString=function(t){const n=t?function(s){return t.call(this,s,iv)}:iv;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function x_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ty(e,t,n){if(!t)return e;const s=n&&n.encode||x_;Ue.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(t,n):i=Ue.isURLSearchParams(t)?t.toString():new Mf(t,n).toString(s),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class lv{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ue.forEach(this.handlers,function(s){s!==null&&t(s)})}}const My={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$_=typeof URLSearchParams<"u"?URLSearchParams:Mf,T_=typeof FormData<"u"?FormData:null,M_=typeof Blob<"u"?Blob:null,A_={isBrowser:!0,classes:{URLSearchParams:$_,FormData:T_,Blob:M_},protocols:["http","https","file","blob","url","data"]},Af=typeof window<"u"&&typeof document<"u",Vh=typeof navigator=="object"&&navigator||void 0,E_=Af&&(!Vh||["ReactNative","NativeScript","NS"].indexOf(Vh.product)<0),P_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",D_=Af&&window.location.href||"http://localhost",R_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Af,hasStandardBrowserEnv:E_,hasStandardBrowserWebWorkerEnv:P_,navigator:Vh,origin:D_},Symbol.toStringTag,{value:"Module"})),eo={...R_,...A_};function O_(e,t){return od(e,new eo.classes.URLSearchParams,{visitor:function(n,s,o,i){return eo.isNode&&Ue.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function N_(e){return Ue.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function B_(e){const t={},n=Object.keys(e);let s;const o=n.length;let i;for(s=0;s<o;s++)i=n[s],t[i]=e[i];return t}function Ay(e){function t(n,s,o,i){let l=n[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=i>=n.length;return l=!l&&Ue.isArray(o)?o.length:l,d?(Ue.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!c):((!o[l]||!Ue.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],i)&&Ue.isArray(o[l])&&(o[l]=B_(o[l])),!c)}if(Ue.isFormData(e)&&Ue.isFunction(e.entries)){const n={};return Ue.forEachEntry(e,(s,o)=>{t(N_(s),o,n,0)}),n}return null}function F_(e,t,n){if(Ue.isString(e))try{return(t||JSON.parse)(e),Ue.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const vc={transitional:My,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,i=Ue.isObject(t);if(i&&Ue.isHTMLForm(t)&&(t=new FormData(t)),Ue.isFormData(t))return o?JSON.stringify(Ay(t)):t;if(Ue.isArrayBuffer(t)||Ue.isBuffer(t)||Ue.isStream(t)||Ue.isFile(t)||Ue.isBlob(t)||Ue.isReadableStream(t))return t;if(Ue.isArrayBufferView(t))return t.buffer;if(Ue.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return O_(t,this.formSerializer).toString();if((c=Ue.isFileList(t))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return od(c?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),F_(t)):t}],transformResponse:[function(t){const n=this.transitional||vc.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Ue.isResponse(t)||Ue.isReadableStream(t))return t;if(t&&Ue.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?It.from(c,It.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:eo.classes.FormData,Blob:eo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ue.forEach(["delete","get","head","post","put","patch"],e=>{vc.headers[e]={}});const U_=Ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),z_=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&U_[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},rv=Symbol("internals");function Sr(e){return e&&String(e).trim().toLowerCase()}function Xc(e){return e===!1||e==null?e:Ue.isArray(e)?e.map(Xc):String(e)}function H_(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const V_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Rd(e,t,n,s,o){if(Ue.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!Ue.isString(t)){if(Ue.isString(s))return t.indexOf(s)!==-1;if(Ue.isRegExp(s))return s.test(t)}}function G_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function q_(e,t){const n=Ue.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,i,l){return this[s].call(this,t,o,i,l)},configurable:!0})})}let To=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function i(c,d,h){const f=Sr(d);if(!f)throw new Error("header name must be a non-empty string");const m=Ue.findKey(o,f);(!m||o[m]===void 0||h===!0||h===void 0&&o[m]!==!1)&&(o[m||d]=Xc(c))}const l=(c,d)=>Ue.forEach(c,(h,f)=>i(h,f,d));if(Ue.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Ue.isString(t)&&(t=t.trim())&&!V_(t))l(z_(t),n);else if(Ue.isObject(t)&&Ue.isIterable(t)){let c={},d,h;for(const f of t){if(!Ue.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[h=f[0]]=(d=c[h])?Ue.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(c,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=Sr(t),t){const s=Ue.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return H_(o);if(Ue.isFunction(n))return n.call(this,o,s);if(Ue.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Sr(t),t){const s=Ue.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Rd(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function i(l){if(l=Sr(l),l){const c=Ue.findKey(s,l);c&&(!n||Rd(s,s[c],c,n))&&(delete s[c],o=!0)}}return Ue.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const i=n[s];(!t||Rd(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,s={};return Ue.forEach(this,(o,i)=>{const l=Ue.findKey(s,i);if(l){n[l]=Xc(o),delete n[i];return}const c=t?G_(i):String(i).trim();c!==i&&delete n[i],n[c]=Xc(o),s[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Ue.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&Ue.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[rv]=this[rv]={accessors:{}}).accessors,o=this.prototype;function i(l){const c=Sr(l);s[c]||(q_(o,l),s[c]=!0)}return Ue.isArray(t)?t.forEach(i):i(t),this}};To.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ue.reduceDescriptors(To.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});Ue.freezeMethods(To);function Od(e,t){const n=this||vc,s=t||n,o=To.from(s.headers);let i=s.data;return Ue.forEach(e,function(c){i=c.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Ey(e){return!!(e&&e.__CANCEL__)}function dr(e,t,n){It.call(this,e??"canceled",It.ERR_CANCELED,t,n),this.name="CanceledError"}Ue.inherits(dr,It,{__CANCEL__:!0});function Py(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function j_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function W_(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=s[i];l||(l=h),n[o]=d,s[o]=h;let m=i,y=0;for(;m!==o;)y+=n[m++],m=m%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(y*1e3/k):void 0}}function Z_(e,t){let n=0,s=1e3/t,o,i;const l=(h,f=Date.now())=>{n=f,o=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),m=f-n;m>=s?l(h,f):(o=h,i||(i=setTimeout(()=>{i=null,l(o)},s-m)))},()=>o&&l(o)]}const wu=(e,t,n=3)=>{let s=0;const o=W_(50,250);return Z_(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,d=l-s,h=o(d),f=l<=c;s=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:h||void 0,estimated:h&&c&&f?(c-l)/h:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(m)},n)},cv=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},uv=e=>(...t)=>Ue.asap(()=>e(...t)),K_=eo.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,eo.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(eo.origin),eo.navigator&&/(msie|trident)/i.test(eo.navigator.userAgent)):()=>!0,Y_=eo.hasStandardBrowserEnv?{write(e,t,n,s,o,i,l){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];Ue.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),Ue.isString(s)&&c.push(`path=${s}`),Ue.isString(o)&&c.push(`domain=${o}`),i===!0&&c.push("secure"),Ue.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function J_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function X_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Dy(e,t,n){let s=!J_(t);return e&&(s||n==!1)?X_(e,t):t}const dv=e=>e instanceof To?{...e}:e;function nl(e,t){t=t||{};const n={};function s(h,f,m,y){return Ue.isPlainObject(h)&&Ue.isPlainObject(f)?Ue.merge.call({caseless:y},h,f):Ue.isPlainObject(f)?Ue.merge({},f):Ue.isArray(f)?f.slice():f}function o(h,f,m,y){if(Ue.isUndefined(f)){if(!Ue.isUndefined(h))return s(void 0,h,m,y)}else return s(h,f,m,y)}function i(h,f){if(!Ue.isUndefined(f))return s(void 0,f)}function l(h,f){if(Ue.isUndefined(f)){if(!Ue.isUndefined(h))return s(void 0,h)}else return s(void 0,f)}function c(h,f,m){if(m in t)return s(h,f);if(m in e)return s(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(h,f,m)=>o(dv(h),dv(f),m,!0)};return Ue.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||o,y=m(e[f],t[f],f);Ue.isUndefined(y)&&m!==c||(n[f]=y)}),n}const Ry=e=>{const t=nl({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:i,headers:l,auth:c}=t;if(t.headers=l=To.from(l),t.url=Ty(Dy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Ue.isFormData(n)){if(eo.hasStandardBrowserEnv||eo.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Ue.isFunction(n.getHeaders)){const d=n.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{h.includes(f.toLowerCase())&&l.set(f,m)})}}if(eo.hasStandardBrowserEnv&&(s&&Ue.isFunction(s)&&(s=s(t)),s||s!==!1&&K_(t.url))){const d=o&&i&&Y_.read(i);d&&l.set(o,d)}return t},Q_=typeof XMLHttpRequest<"u",eC=Q_&&function(e){return new Promise(function(n,s){const o=Ry(e);let i=o.data;const l=To.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:h}=o,f,m,y,k,b;function I(){k&&k(),b&&b(),o.cancelToken&&o.cancelToken.unsubscribe(f),o.signal&&o.signal.removeEventListener("abort",f)}let T=new XMLHttpRequest;T.open(o.method.toUpperCase(),o.url,!0),T.timeout=o.timeout;function E(){if(!T)return;const C=To.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),$={data:!c||c==="text"||c==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:C,config:e,request:T};Py(function(M){n(M),I()},function(M){s(M),I()},$),T=null}"onloadend"in T?T.onloadend=E:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(E)},T.onabort=function(){T&&(s(new It("Request aborted",It.ECONNABORTED,e,T)),T=null)},T.onerror=function(_){const $=_&&_.message?_.message:"Network Error",R=new It($,It.ERR_NETWORK,e,T);R.event=_||null,s(R),T=null},T.ontimeout=function(){let _=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const $=o.transitional||My;o.timeoutErrorMessage&&(_=o.timeoutErrorMessage),s(new It(_,$.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,T)),T=null},i===void 0&&l.setContentType(null),"setRequestHeader"in T&&Ue.forEach(l.toJSON(),function(_,$){T.setRequestHeader($,_)}),Ue.isUndefined(o.withCredentials)||(T.withCredentials=!!o.withCredentials),c&&c!=="json"&&(T.responseType=o.responseType),h&&([y,b]=wu(h,!0),T.addEventListener("progress",y)),d&&T.upload&&([m,k]=wu(d),T.upload.addEventListener("progress",m),T.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(f=C=>{T&&(s(!C||C.type?new dr(null,e,T):C),T.abort(),T=null)},o.cancelToken&&o.cancelToken.subscribe(f),o.signal&&(o.signal.aborted?f():o.signal.addEventListener("abort",f)));const x=j_(o.url);if(x&&eo.protocols.indexOf(x)===-1){s(new It("Unsupported protocol "+x+":",It.ERR_BAD_REQUEST,e));return}T.send(i||null)})},tC=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const i=function(h){if(!o){o=!0,c();const f=h instanceof Error?h:this.reason;s.abort(f instanceof It?f:new dr(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new It(`timeout ${t} of ms exceeded`,It.ETIMEDOUT))},t);const c=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=s;return d.unsubscribe=()=>Ue.asap(c),d}},nC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},oC=async function*(e,t){for await(const n of sC(e))yield*nC(n,t)},sC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},hv=(e,t,n,s)=>{const o=oC(e,t);let i=0,l,c=d=>{l||(l=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await o.next();if(h){c(),d.close();return}let m=f.byteLength;if(n){let y=i+=m;n(y)}d.enqueue(new Uint8Array(f))}catch(h){throw c(h),h}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},fv=64*1024,{isFunction:Bc}=Ue,aC=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ue.global),{ReadableStream:pv,TextEncoder:vv}=Ue.global,mv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},iC=e=>{e=Ue.merge.call({skipUndefined:!0},aC,e);const{fetch:t,Request:n,Response:s}=e,o=t?Bc(t):typeof fetch=="function",i=Bc(n),l=Bc(s);if(!o)return!1;const c=o&&Bc(pv),d=o&&(typeof vv=="function"?(b=>I=>b.encode(I))(new vv):async b=>new Uint8Array(await new n(b).arrayBuffer())),h=i&&c&&mv(()=>{let b=!1;const I=new n(eo.origin,{body:new pv,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!I}),f=l&&c&&mv(()=>Ue.isReadableStream(new s("").body)),m={stream:f&&(b=>b.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!m[b]&&(m[b]=(I,T)=>{let E=I&&I[b];if(E)return E.call(I);throw new It(`Response type '${b}' is not supported`,It.ERR_NOT_SUPPORT,T)})});const y=async b=>{if(b==null)return 0;if(Ue.isBlob(b))return b.size;if(Ue.isSpecCompliantForm(b))return(await new n(eo.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Ue.isArrayBufferView(b)||Ue.isArrayBuffer(b))return b.byteLength;if(Ue.isURLSearchParams(b)&&(b=b+""),Ue.isString(b))return(await d(b)).byteLength},k=async(b,I)=>{const T=Ue.toFiniteNumber(b.getContentLength());return T??y(I)};return async b=>{let{url:I,method:T,data:E,signal:x,cancelToken:C,timeout:_,onDownloadProgress:$,onUploadProgress:R,responseType:M,headers:O,withCredentials:A="same-origin",fetchOptions:U}=Ry(b),F=t||fetch;M=M?(M+"").toLowerCase():"text";let j=tC([x,C&&C.toAbortSignal()],_),Z=null;const X=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let re;try{if(R&&h&&T!=="get"&&T!=="head"&&(re=await k(O,E))!==0){let ue=new n(I,{method:"POST",body:E,duplex:"half"}),_e;if(Ue.isFormData(E)&&(_e=ue.headers.get("content-type"))&&O.setContentType(_e),ue.body){const[Te,Pe]=cv(re,wu(uv(R)));E=hv(ue.body,fv,Te,Pe)}}Ue.isString(A)||(A=A?"include":"omit");const K=i&&"credentials"in n.prototype,ae={...U,signal:j,method:T.toUpperCase(),headers:O.normalize().toJSON(),body:E,duplex:"half",credentials:K?A:void 0};Z=i&&new n(I,ae);let q=await(i?F(Z,U):F(I,ae));const Y=f&&(M==="stream"||M==="response");if(f&&($||Y&&X)){const ue={};["status","statusText","headers"].forEach(De=>{ue[De]=q[De]});const _e=Ue.toFiniteNumber(q.headers.get("content-length")),[Te,Pe]=$&&cv(_e,wu(uv($),!0))||[];q=new s(hv(q.body,fv,Te,()=>{Pe&&Pe(),X&&X()}),ue)}M=M||"text";let te=await m[Ue.findKey(m,M)||"text"](q,b);return!Y&&X&&X(),await new Promise((ue,_e)=>{Py(ue,_e,{data:te,headers:To.from(q.headers),status:q.status,statusText:q.statusText,config:b,request:Z})})}catch(K){throw X&&X(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new It("Network Error",It.ERR_NETWORK,b,Z),{cause:K.cause||K}):It.from(K,K&&K.code,b,Z)}}},lC=new Map,Oy=e=>{let t=e&&e.env||{};const{fetch:n,Request:s,Response:o}=t,i=[s,o,n];let l=i.length,c=l,d,h,f=lC;for(;c--;)d=i[c],h=f.get(d),h===void 0&&f.set(d,h=c?new Map:iC(t)),f=h;return h};Oy();const Ef={http:L_,xhr:eC,fetch:{get:Oy}};Ue.forEach(Ef,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const gv=e=>`- ${e}`,rC=e=>Ue.isFunction(e)||e===null||e===!1;function cC(e,t){e=Ue.isArray(e)?e:[e];const{length:n}=e;let s,o;const i={};for(let l=0;l<n;l++){s=e[l];let c;if(o=s,!rC(s)&&(o=Ef[(c=String(s)).toLowerCase()],o===void 0))throw new It(`Unknown adapter '${c}'`);if(o&&(Ue.isFunction(o)||(o=o.get(t))))break;i[c||"#"+l]=o}if(!o){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=n?l.length>1?`since :
`+l.map(gv).join(`
`):" "+gv(l[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const Ny={getAdapter:cC,adapters:Ef};function Nd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new dr(null,e)}function yv(e){return Nd(e),e.headers=To.from(e.headers),e.data=Od.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ny.getAdapter(e.adapter||vc.adapter,e)(e).then(function(s){return Nd(e),s.data=Od.call(e,e.transformResponse,s),s.headers=To.from(s.headers),s},function(s){return Ey(s)||(Nd(e),s&&s.response&&(s.response.data=Od.call(e,e.transformResponse,s.response),s.response.headers=To.from(s.response.headers))),Promise.reject(s)})}const By="1.13.2",sd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sd[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const kv={};sd.transitional=function(t,n,s){function o(i,l){return"[Axios v"+By+"] Transitional option '"+i+"'"+l+(s?". "+s:"")}return(i,l,c)=>{if(t===!1)throw new It(o(l," has been removed"+(n?" in "+n:"")),It.ERR_DEPRECATED);return n&&!kv[l]&&(kv[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,c):!0}};sd.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function uC(e,t,n){if(typeof e!="object")throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const i=s[o],l=t[i];if(l){const c=e[i],d=c===void 0||l(c,i,e);if(d!==!0)throw new It("option "+i+" must be "+d,It.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new It("Unknown option "+i,It.ERR_BAD_OPTION)}}const Qc={assertOptions:uC,validators:sd},Fs=Qc.validators;let Qi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new lv,response:new lv}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=nl(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:i}=n;s!==void 0&&Qc.assertOptions(s,{silentJSONParsing:Fs.transitional(Fs.boolean),forcedJSONParsing:Fs.transitional(Fs.boolean),clarifyTimeoutError:Fs.transitional(Fs.boolean)},!1),o!=null&&(Ue.isFunction(o)?n.paramsSerializer={serialize:o}:Qc.assertOptions(o,{encode:Fs.function,serialize:Fs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Qc.assertOptions(n,{baseUrl:Fs.spelling("baseURL"),withXsrfToken:Fs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&Ue.merge(i.common,i[n.method]);i&&Ue.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),n.headers=To.concat(l,i);const c=[];let d=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(n)===!1||(d=d&&I.synchronous,c.unshift(I.fulfilled,I.rejected))});const h=[];this.interceptors.response.forEach(function(I){h.push(I.fulfilled,I.rejected)});let f,m=0,y;if(!d){const b=[yv.bind(this),void 0];for(b.unshift(...c),b.push(...h),y=b.length,f=Promise.resolve(n);m<y;)f=f.then(b[m++],b[m++]);return f}y=c.length;let k=n;for(;m<y;){const b=c[m++],I=c[m++];try{k=b(k)}catch(T){I.call(this,T);break}}try{f=yv.call(this,k)}catch(b){return Promise.reject(b)}for(m=0,y=h.length;m<y;)f=f.then(h[m++],h[m++]);return f}getUri(t){t=nl(this.defaults,t);const n=Dy(t.baseURL,t.url,t.allowAbsoluteUrls);return Ty(n,t.params,t.paramsSerializer)}};Ue.forEach(["delete","get","head","options"],function(t){Qi.prototype[t]=function(n,s){return this.request(nl(s||{},{method:t,url:n,data:(s||{}).data}))}});Ue.forEach(["post","put","patch"],function(t){function n(s){return function(i,l,c){return this.request(nl(c||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Qi.prototype[t]=n(),Qi.prototype[t+"Form"]=n(!0)});let dC=class Fy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(o=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](o);s._listeners=null}),this.promise.then=o=>{let i;const l=new Promise(c=>{s.subscribe(c),i=c}).then(o);return l.cancel=function(){s.unsubscribe(i)},l},t(function(i,l,c){s.reason||(s.reason=new dr(i,l,c),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Fy(function(o){t=o}),cancel:t}}};function hC(e){return function(n){return e.apply(null,n)}}function fC(e){return Ue.isObject(e)&&e.isAxiosError===!0}const Gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Gh).forEach(([e,t])=>{Gh[t]=e});function Uy(e){const t=new Qi(e),n=gy(Qi.prototype.request,t);return Ue.extend(n,Qi.prototype,t,{allOwnKeys:!0}),Ue.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Uy(nl(e,o))},n}const kn=Uy(vc);kn.Axios=Qi;kn.CanceledError=dr;kn.CancelToken=dC;kn.isCancel=Ey;kn.VERSION=By;kn.toFormData=od;kn.AxiosError=It;kn.Cancel=kn.CanceledError;kn.all=function(t){return Promise.all(t)};kn.spread=hC;kn.isAxiosError=fC;kn.mergeConfig=nl;kn.AxiosHeaders=To;kn.formToJSON=e=>Ay(Ue.isHTMLForm(e)?new FormData(e):e);kn.getAdapter=Ny.getAdapter;kn.HttpStatusCode=Gh;kn.default=kn;const{Axios:iX,AxiosError:lX,CanceledError:rX,isCancel:cX,CancelToken:uX,VERSION:dX,all:hX,Cancel:fX,isAxiosError:pX,spread:vX,toFormData:mX,AxiosHeaders:gX,HttpStatusCode:yX,formToJSON:kX,getAdapter:bX,mergeConfig:wX}=kn,ti="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",pC="VolunteerCheckinOffline",vC=1;let Cs=null;async function xa(){return Cs||new Promise((e,t)=>{const n=indexedDB.open(pC,vC);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{Cs=n.result,e(Cs)},n.onupgradeneeded=s=>{const o=s.target.result;o.objectStoreNames.contains("eventData")||o.createObjectStore("eventData",{keyPath:"eventId"}),o.objectStoreNames.contains("pendingActions")||o.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),o.objectStoreNames.contains("syncMeta")||o.createObjectStore("syncMeta",{keyPath:"key"})}})}async function lc(e,t){return await xa(),new Promise((n,s)=>{const o=Cs.transaction(["eventData","syncMeta"],"readwrite"),i=o.objectStore("eventData"),l=o.objectStore("syncMeta"),c={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(c),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function li(e){return await xa(),new Promise((t,n)=>{const i=Cs.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}async function eu(e,t,n){const s=await li(e);s&&(s[t]=n,s.cachedAt=new Date().toISOString(),await lc(e,s))}async function mC(e){return await xa(),new Promise((t,n)=>{const o=Cs.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=o.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function zy(){return await xa(),new Promise((e,t)=>{const i=Cs.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(c=>c.status==="pending"||c.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function _u(){return(await zy()).length}async function bv(e,t){return await xa(),new Promise((n,s)=>{const o=Cs.transaction(["pendingActions"],"readwrite"),i=o.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const c=l.result;c&&(Object.assign(c,t),i.put(c))},o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function wv(e){return await xa(),new Promise((t,n)=>{const i=Cs.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}async function gC(e){return await xa(),new Promise((t,n)=>{const i=Cs.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>n(i.error)})}const et=kn.create({baseURL:ti,headers:{"Content-Type":"application/json"},timeout:15e3});let qh=!1,Hy={type:null,eventId:null};function Oo(e,t=null){Hy={type:e,eventId:t}}async function yC(){}function _v(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const n of t){const s=e.match(n);if(s)return s[1]}return null}function kC(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Vy(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Hy}const bC=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];et.interceptors.request.use(e=>{if(bC.some(i=>e.url?.includes(i)))return e;const n=localStorage.getItem("adminEmail");n&&(e.headers["X-Admin-Email"]=n);const s=Vy();let o=null;if(s.type==="marshal"&&s.eventId){const i=bu(s.eventId);i?.token&&(o=i.token)}return o||(o=localStorage.getItem("sessionToken")),o&&(e.headers.Authorization=`Bearer ${o}`),$w(e),e});let Cu=0;const wC=2;function _C(){if(Cu++,Cu>=wC&&Vy().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function CC(){Cu=0}function Bd(){Cu=0}function LC(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),n=e.headers?.Authorization||e.headers?.authorization;if(n&&t&&n.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const o=window.location.hash||"";return!!(o.match(/#\/event\/[^/?]+/)||o==="#/marshal"||o.startsWith("#/marshal?"))}et.interceptors.response.use(e=>{const t=tv(e.config);t&&ev(t),qh=!1,CC();const n=e.config.url,s=_v(n);return e.config.method,e},async e=>{const t=e.config,n=tv(t);if(n&&ev(n),e.response&&(e.response.status===401||e.response.status===403))return LC(t)||_C(),Promise.reject(e);if(kC(e)&&(qh=!0,t.method==="get")){const s=_v(t.url);if(s){const o=await li(s);if(o)return console.log("Returning cached data for:",t.url),Promise.resolve({data:o,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Ro(e,t,n){return await mC({type:e,payload:t,eventId:t.eventId}),await yC(),{data:n,status:200,statusText:"OK (queued)",queued:!0}}function Zn(){return qh||!navigator.onLine}const SC={check:()=>et.head("/health")},jh=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),qs={requestLogin:e=>et.post("/auth/request-login",{email:e,frontendUrl:jh()}),verifyToken:e=>et.post("/auth/verify-token",{token:e}),instantLogin:e=>et.post("/auth/instant-login",{email:e}),createAdmin:e=>et.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>et.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>et.get("/auth/me",{params:{eventId:e}}),logout:()=>et.post("/auth/logout")},Fc={getProfile:()=>et.get("/auth/profile"),updateProfile:e=>et.put("/auth/profile",e),getPerson:(e,t)=>et.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,n)=>et.put(`/people/${e}`,n,{params:{eventId:t}})},ni={create:e=>et.post("/events",e),getAll:()=>et.get("/events"),getById:e=>et.get(`/events/${e}`),update:(e,t)=>et.put(`/events/${e}`,t),delete:e=>et.delete(`/events/${e}`),uploadGpx:(e,t)=>{const n=new FormData;return n.append("gpx",t),et.post(`/events/${e}/upload-gpx`,n,{headers:{"Content-Type":"multipart/form-data"}})}},Kn={create:e=>et.post("/locations",e),getById:(e,t)=>et.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>et.get(`/events/${e}/locations`,t),update:(e,t,n)=>et.put(`/locations/${e}/${t}`,n),delete:(e,t)=>et.delete(`/locations/${e}/${t}`),importCsv:(e,t,n)=>{const s=new FormData;return s.append("csv",t),et.post(`/locations/import/${e}?deleteExisting=${n}`,s,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>et.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,n,s={})=>et.post(`/locations/${e}/${t}/update-position`,n,s),getDynamicCheckpoints:(e,t={})=>et.get(`/events/${e}/dynamic-checkpoints`,t)},$r={create:e=>et.post("/assignments",e),getById:(e,t)=>et.get(`/assignments/${e}/${t}`),getByEvent:e=>et.get(`/assignments/event/${e}`),delete:(e,t)=>et.delete(`/assignments/${e}/${t}`),getEventStatus:e=>et.get(`/events/${e}/status`)},ri={checkIn:e=>et.post("/checkin",e),toggleCheckIn:(e,t,{latitude:n,longitude:s,action:o}={})=>et.post(`/checkin/${e}/${t}/toggle`,{latitude:n??null,longitude:s??null,action:o??null}),adminCheckIn:(e,t)=>et.post(`/checkin/admin/${e}/${t}`)},Fd={getAdmins:e=>et.get(`/events/${e}/admins`),addAdmin:(e,t)=>et.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>et.delete(`/events/${e}/admins/${t}`)},_s={create:e=>et.post("/marshals",e),getByEvent:e=>et.get(`/events/${e}/marshals`),getById:(e,t)=>et.get(`/marshals/${e}/${t}`),update:(e,t,n)=>et.put(`/marshals/${e}/${t}`,n),delete:(e,t)=>et.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>et.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:jh()}}),sendMagicLink:(e,t)=>et.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:jh()}),importCsv:(e,t)=>{const n=new FormData;return n.append("csv",t),et.post(`/marshals/import/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}})}},ma={create:e=>et.post("/areas",e),getByEvent:e=>et.get(`/events/${e}/areas`),getById:(e,t)=>et.get(`/areas/${e}/${t}`),update:(e,t,n)=>et.put(`/areas/${e}/${t}`,n),delete:(e,t)=>et.delete(`/areas/${e}/${t}`),recalculate:e=>et.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>et.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>et.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>et.post(`/events/${e}/checklist-items`,t),getByEvent:e=>et.get(`/events/${e}/checklist-items`),getById:(e,t)=>et.get(`/checklist-items/${e}/${t}`),update:(e,t,n)=>et.put(`/checklist-items/${e}/${t}`,n),delete:(e,t)=>et.delete(`/checklist-items/${e}/${t}`),getReport:e=>et.get(`/events/${e}/checklist-report`),getDetailedReport:e=>et.get(`/events/${e}/checklist-report/detailed`),getMarshalChecklist:(e,t)=>et.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>et.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>et.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/complete`,n),uncomplete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/uncomplete`,n),reorder:(e,t)=>et.post(`/events/${e}/checklist-items/reorder`,{items:t})},bs={create:(e,t)=>et.post(`/events/${e}/notes`,t),getByEvent:e=>et.get(`/events/${e}/notes`),getById:(e,t)=>et.get(`/events/${e}/notes/${t}`),update:(e,t,n)=>et.put(`/events/${e}/notes/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>et.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>et.get(`/events/${e}/my-notes`),reorder:(e,t)=>et.post(`/events/${e}/notes/reorder`,{items:t})},ua={create:(e,t)=>et.post(`/events/${e}/contacts`,t),getByEvent:e=>et.get(`/events/${e}/contacts`),getById:(e,t)=>et.get(`/events/${e}/contacts/${t}`),update:(e,t,n)=>et.put(`/events/${e}/contacts/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/contacts/${t}`),getRoles:e=>et.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>et.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>et.get(`/events/${e}/my-contacts`),reorder:(e,t)=>et.post(`/events/${e}/contacts/reorder`,{items:t})},Ka={getAll:e=>et.get(`/events/${e}/role-definitions`),create:(e,t)=>et.post(`/events/${e}/role-definitions`,t),update:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/role-definitions/${t}`),getPeople:(e,t)=>et.get(`/events/${e}/role-definitions/${t}/people`),updatePeople:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}/people`,n),reorder:(e,t)=>et.post(`/events/${e}/role-definitions/reorder`,{items:t}),getMyRoles:e=>et.get(`/events/${e}/my-roles`)},Gs={create:(e,t)=>et.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>et.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>et.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>et.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,n)=>et.patch(`/events/${e}/incidents/${t}`,n),addNote:(e,t,n)=>et.post(`/events/${e}/incidents/${t}/notes`,{note:n})},IC={class:"hero-animation-container"},xC={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,n=D(!1);return un(()=>{t.animate?requestAnimationFrame(()=>{n.value=!0}):n.value=!0}),(s,o)=>(p(),g("div",IC,[(p(),g("svg",{viewBox:"0 0 400 350",class:le(["hero-map-svg",{animate:n.value&&e.animate,"no-animate":n.value&&!e.animate}])},[...o[0]||(o[0]=[ui(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},$C=Ke(xC,[["__scopeId","data-v-cec8ae43"]]),TC={class:"hero-header"},MC={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=D(!1);return un(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(n,s)=>(p(),g("div",TC,[Ee($C,{animate:t.value},null,8,["animate"]),e.title?(p(),g("div",{key:0,class:le(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,w(e.title),1)],2)):P("",!0)]))}},Gy=Ke(MC,[["__scopeId","data-v-c824ab01"]]),mc=Lf("auth",()=>{const e=D(localStorage.getItem("adminEmail")||null),t=D(!!e.value),n=D(!1);return{adminEmail:e,isAuthenticated:t,loginPending:n,requestLogin:async c=>{const d=await qs.requestLogin(c);return d.data.success&&(n.value=!0),d.data},verifyToken:async c=>{const d=await qs.verifyToken(c);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,n.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),Oo("admin")),d.data},instantLogin:async c=>{const d=await qs.instantLogin(c);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),Oo("admin")),d.data},logout:async()=>{try{await qs.logout()}catch{}e.value=null,t.value=!1,n.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),Oo(null)}}}),AC={class:"modal-card"},EC={key:0,class:"email-sent"},PC={key:1},DC={class:"form-group"},RC=["disabled"],OC={key:0,class:"error"},NC={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const n=e,s=t,o=mc(),i=D(""),l=D(!1),c=D(null),d=D(!1);async function h(){l.value=!0,c.value=null;try{const y=await o.requestLogin(i.value);y.success?(d.value=!0,s("success",i.value)):c.value=y.message||"Failed to send login link. Please try again."}catch{c.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,c.value=null}function m(){s("close")}return Ye(()=>n.show,y=>{y||setTimeout(()=>{f()},200)}),(y,k)=>(p(),qe(ec,{to:"body"},[Ee(Is,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",style:tt({zIndex:e.zIndex}),onClick:ct(m,["self"])},[r("div",AC,[r("button",{class:"modal-close",onClick:m},""),d.value?(p(),g("div",EC,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Je("We've sent a login link to ",-1)),r("strong",null,w(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(p(),g("div",PC,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(h,["prevent"])},[r("div",DC,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>i.value=b),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},w(l.value?"Sending...":"Send login link"),9,RC)],32),c.value?(p(),g("div",OC,w(c.value),1)):P("",!0)]))])],4)):P("",!0)]),_:1})]))}},qy=Ke(NC,[["__scopeId","data-v-7c646305"]]),BC={class:"home"},FC={class:"hero-section"},UC={class:"content-section"},zC={class:"container"},HC={class:"carousel"},VC={class:"carousel-indicators"},GC=["onClick"],qC={__name:"Home",setup(e){const t=Qu(),n=rr();function s(){const y=!!localStorage.getItem("adminEmail"),k=vy();return y||k}function o(){s()?n.push("/sessions"):f.value=!0}const i=D(0);let l=null;function c(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=D(!1);function m(){f.value=!1,t.query.login&&n.replace({query:{}})}return un(()=>{h(),t.query.login&&(s()?n.replace("/sessions"):f.value=!0)}),Ln(()=>{l&&clearInterval(l)}),(y,k)=>(p(),g("div",BC,[r("section",FC,[Ee(Gy,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:o}," Join us or login ")]),r("section",UC,[r("div",zC,[k[2]||(k[2]=ui('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",HC,[r("div",{class:"carousel-track",style:tt({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[ui('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",VC,[(p(),g(Se,null,je(2,(b,I)=>r("button",{key:I,class:le(["indicator",{active:i.value===I}]),onClick:T=>c(I)},null,10,GC)),64))])])])]),Ee(qy,{show:f.value,onClose:m},null,8,["show"])]))}},jC=Ke(qC,[["__scopeId","data-v-aaecbd22"]]),WC={class:"admin-login"},ZC={class:"login-card"},KC={key:0,class:"email-sent"},YC={class:"form-group"},JC=["disabled"],XC={key:0,class:"error"},QC={__name:"AdminLogin",setup(e){const t=mc(),n=D(""),s=D(!1),o=D(null),i=D(!1),l=async()=>{s.value=!0,o.value=null;try{const d=await t.requestLogin(n.value);d.success?i.value=!0:o.value=d.message||"Failed to send login link. Please try again."}catch{o.value="Failed to send login link. Please try again."}finally{s.value=!1}},c=()=>{n.value="",i.value=!1,o.value=null};return(d,h)=>{const f=gf("router-link");return p(),g("div",WC,[r("div",ZC,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(p(),g("div",KC,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Je("We've sent a login link to ",-1)),r("strong",null,w(n.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:c,class:"btn btn-secondary"}," Use a different email ")])):(p(),g(Se,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",YC,[We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=m=>n.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,n.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:s.value},w(s.value?"Sending...":"Send login link"),9,JC)],32),o.value?(p(),g("div",XC,w(o.value),1)):P("",!0)],64)),Ee(f,{to:"/",class:"back-link"},{default:Ve(()=>[...h[6]||(h[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},e2=Ke(QC,[["__scopeId","data-v-5d0a88c2"]]),t2={class:"admin-verify"},n2={class:"verify-card"},o2={key:0,class:"status"},s2={key:1,class:"status error"},a2={key:2,class:"status success"},i2={__name:"AdminVerify",setup(e){const t=rr(),n=Qu(),s=mc(),o=D(!0),i=D(null);return un(async()=>{const l=n.query.token;if(!l){i.value="No login token provided. Please request a new login link.",o.value=!1;return}try{const c=await s.verifyToken(l);c.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=c.message||"Invalid or expired login link. Please request a new one."}catch(c){console.error("Verification error:",c),i.value="Failed to verify login. Please try again."}finally{o.value=!1}}),(l,c)=>{const d=gf("router-link");return p(),g("div",t2,[r("div",n2,[o.value?(p(),g("div",o2,[...c[0]||(c[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(p(),g("div",s2,[c[2]||(c[2]=r("h2",null,"Login failed",-1)),r("p",null,w(i.value),1),Ee(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ve(()=>[...c[1]||(c[1]=[Je(" Try again ",-1)])]),_:1})])):(p(),g("div",a2,[...c[3]||(c[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},l2=Ke(i2,[["__scopeId","data-v-b2435a84"]]),jy=Lf("events",()=>{const e=D([]),t=D(null),n=D([]),s=D([]),o=D(null),i=D(!1),l=D(null),c=async()=>{i.value=!0,l.value=null;try{const R=await ni.getAll();e.value=R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},d=async R=>{i.value=!0,l.value=null;try{const M=await ni.getById(R);t.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},h=async R=>{i.value=!0,l.value=null;try{const M=await ni.create(R);return e.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},f=async(R,M)=>{i.value=!0,l.value=null;try{const O=await ni.update(R,M),A=e.value.findIndex(U=>U.id===R);return A!==-1&&(e.value[A]=O.data),t.value?.id===R&&(t.value=O.data),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},m=async R=>{i.value=!0,l.value=null;try{await ni.delete(R),e.value=e.value.filter(M=>M.id!==R)}catch(M){throw l.value=M.message,M}finally{i.value=!1}},y=async R=>{i.value=!0,l.value=null;try{const M=await Kn.getByEvent(R);n.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}};return{events:e,currentEvent:t,locations:n,assignments:s,eventStatus:o,loading:i,error:l,fetchEvents:c,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async R=>{i.value=!0,l.value=null;try{const M=await Kn.create(R);return n.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateLocation:async(R,M,O)=>{i.value=!0,l.value=null;try{const A=await Kn.update(R,M,O),U=n.value.findIndex(F=>F.id===M);return U!==-1&&(n.value[U]=A.data),A.data}catch(A){throw l.value=A.message,A}finally{i.value=!1}},deleteLocation:async(R,M)=>{i.value=!0,l.value=null;try{await Kn.delete(R,M),n.value=n.value.filter(O=>O.id!==M)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},bulkUpdateLocationTimes:async(R,M)=>{i.value=!0,l.value=null;try{const O=await Kn.bulkUpdateTimes(R,M);return await y(R),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchAssignments:async R=>{i.value=!0,l.value=null;try{const M=await $r.getByEvent(R);s.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},createAssignment:async R=>{i.value=!0,l.value=null;try{const M=await $r.create(R);return s.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},deleteAssignment:async(R,M)=>{i.value=!0,l.value=null;try{await $r.delete(R,M),s.value=s.value.filter(O=>O.id!==M)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchEventStatus:async R=>{i.value=!0,l.value=null;try{const M=await $r.getEventStatus(R);return o.value=M.data,M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateAssignmentCheckIn:R=>{const M=s.value.findIndex(O=>O.id===R.id);M!==-1&&(s.value[M]=R),o.value&&o.value.locations.forEach(O=>{const A=O.assignments.findIndex(U=>U.id===R.id);A!==-1&&(O.assignments[A]=R,O.checkedInCount=O.assignments.filter(U=>U.isCheckedIn).length)})}}});function Wy(e="details",t=[]){const n=D(e),s=m=>{n.value=m},o=()=>{n.value=e},i=m=>n.value===m,l=z(()=>t.length===0?-1:t.indexOf(n.value)),c=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?n.value=t[k]:m&&(n.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?n.value=t[k]:m&&(n.value=t[t.length-1])},h=z(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=z(()=>t.length===0?!1:l.value>0);return{activeTab:n,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:s,resetTab:o,isActiveTab:i,nextTab:c,previousTab:d}}function r2(){const e=D(!1),t=D(""),n=D(""),s=D(null),o=D(!1),i=D("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:n,confirmModalIsDanger:o,confirmModalConfirmText:i,showConfirm:(f,m,y,k={})=>{t.value=f,n.value=m,s.value=y,o.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,s.value&&(s.value(),s.value=null)},handleConfirmModalCancel:()=>{e.value=!1,s.value=null},closeConfirmModal:()=>{e.value=!1,s.value=null}}}const Gl=D({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),ya={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},ga={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Wi(e,t,n="Marshals"){if(!t)return"";const s=ya[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${ya.people[n]?.singular||"Person"} point`:s?.singular?s.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Zy(e,t,n="Marshals"){if(!t)return"";const s=ya[e]?.[t];return t==="Person points"?`${ya.people[n]?.singular||"Person"} points`:s?.plural?s.plural:t}function Wh(e,t){return e==="Person points"?`${ya.people[t]?.singular||"Person"} points`:e}function Zh(e){e&&(Gl.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const gs=e=>e.toLowerCase(),ys=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ht(){const e=f=>{const m=Gl.value[f],y=ya[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Gl.value.people;return`${ya.people[k]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=Gl.value[f],y=ya[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Gl.value.people;return`${ya.people[k]?.singular||"Person"} points`}return y?.plural||m},n=z(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),s=z(()=>({person:gs(e("people")),checkpoint:gs(e("checkpoint")),area:gs(e("area")),checklist:gs(e("checklist")),course:gs(e("course")),people:gs(t("people")),checkpoints:gs(t("checkpoint")),areas:gs(t("area")),checklists:gs(t("checklist")),courses:gs(t("course"))})),o=z(()=>({person:ys(e("people")),checkpoint:ys(e("checkpoint")),area:ys(e("area")),checklist:ys(e("checklist")),course:ys(e("course")),people:ys(t("people")),checkpoints:ys(t("checkpoint")),areas:ys(t("area")),checklists:ys(t("checklist")),courses:ys(t("course"))})),i=z(()=>({course:n.value.course,checkpoints:n.value.checkpoints,areas:n.value.areas,marshals:n.value.people,checklists:n.value.checklists,notes:"Notes",details:"Event details"}));return{terms:n,termsLower:s,termsSentence:o,tabLabels:i,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>gs(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>ys(m?t(f):e(f)),terminology:Gl}}function c2(){const e=D(!1),t=D(null),n=D({}),s=D(null),o=D(null),i=D([]),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(1),m=z(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value!==null:t.value==="draw-area"?o.value&&o.value.length>=3:t.value==="add-multiple"),y=Z=>{if(Z){const X=Z.getMapCenter?.(),re=Z.getMapZoom?.();X&&re!==null&&(l.value=X,c.value=re)}},k=(Z={})=>{s.value=null,e.value=!0,t.value="place-checkpoint",n.value={title:Z.title||"Select checkpoint location",description:Z.description||"Click on the map to set the location. Click again to reposition."}},b=(Z,X="checkpoint")=>{s.value=null,e.value=!0,t.value="move-checkpoint",n.value={title:`Move ${X}: ${Z}`,description:"Click on the map to set the new location"}},I=(Z={})=>{e.value=!0,t.value="draw-area",d.value=!0,n.value={title:Z.title||"Draw area boundary",description:Z.description||"Click to add points. Click Done when finished to complete the area."}},T=(Z=1)=>{f.value=Z,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,n.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=Z=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value=Z:t.value==="add-multiple"&&x(Z)},x=Z=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Z.lat,longitude:Z.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,n.value={...n.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},C=Z=>{o.value=Z},_=()=>o.value&&o.value.length>=3?o.value.map(Z=>({lat:Z.lat,lng:Z.lng})):null,$=()=>{e.value=!1,t.value=null,n.value={},s.value=null,l.value=null,c.value=null,o.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:n,tempLocationCoords:s,currentDrawingPolygon:o,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:c,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:b,enterDrawAreaMode:I,enterAddMultipleMode:T,handleFullscreenMapClick:E,handlePolygonDrawing:C,getCompletedPolygon:_,exitFullscreen:$,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,o.value=null),$()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>s.value,createDisplayCheckpoints:(Z,X,re)=>z(()=>{const K=[...Z.value];return t.value==="place-checkpoint"&&s.value&&K.push({id:"temp-single",name:X.value?.name||"New Checkpoint",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:X.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&s.value&&re.value&&K.push({id:"temp-move",name:re.value.name+" (new position)",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:re.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&K.push(...i.value),K}),createDisplayAreas:(Z,X)=>z(()=>{const re=[...Z.value];if(t.value==="draw-area"&&X.value?.polygon?.length>0){const K=re.findIndex(ae=>ae.id===X.value.id);K>=0?re[K]={...X.value}:re.push({...X.value,id:X.value.id||"temp-area"})}return re}),calculateStartingNumber:Z=>{const X=Z.value.map(re=>{const K=re.name.match(/^Checkpoint (\d+)$/);return K?parseInt(K[1]):0}).filter(re=>re>0);return X.length>0?Math.max(...X)+1:1}}}function u2(e){const t=D([]),n=D(!1);return{eventAdmins:t,showAddAdmin:n,loadEventAdmins:async()=>{try{const d=await Fd.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{n.value=!0},closeAddAdminModal:()=>{n.value=!1},addAdmin:async d=>{await Fd.addAdmin(e.value,d)},removeAdmin:async d=>{await Fd.removeAdmin(e.value,d)}}}function d2(e){const t=D(!1),n=D(!1),s=D(!1),o=D(!1),i=D(!1),l=D(!1),c=D(null),d=D(null),h=D(null),f=D(null);return{showUploadRoute:t,showImportLocations:n,showImportMarshals:s,uploading:o,importing:i,importingMarshals:l,uploadError:c,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{c.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,c.value=null},uploadRoute:async $=>{if(!$)return c.value="Please select a GPX file",null;o.value=!0,c.value=null;try{return await ni.uploadGpx(e.value,$),!0}catch(R){return console.error("Failed to upload route:",R),c.value=R.response?.data?.message||"Failed to upload route. Please try again.",null}finally{o.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,n.value=!0},closeImportLocationsModal:()=>{n.value=!1,d.value=null,h.value=null},importLocations:async($,R)=>{if(!$)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const M=await Kn.importCsv(e.value,$,R);return h.value=M.data,M.data}catch(M){return console.error("Failed to import locations:",M),d.value=M.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,s.value=!0},closeImportMarshalsModal:()=>{s.value=!1,d.value=null,f.value=null},importMarshals:async $=>{if(!$)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const R=await _s.importCsv(e.value,$);return f.value=R.data,R.data}catch(R){return console.error("Failed to import marshals:",R),d.value=R.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:($,R="location")=>{const M=R==="location"?"location(s)":"marshal(s)";let A=`<p>Created <strong>${$[R==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${M} and <strong>${$.assignmentsCreated}</strong> assignment(s)</p>`;return $.errors&&$.errors.length>0&&(A+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',$.errors.forEach(U=>{A+=`<li>${U}</li>`}),A+="</ul>"),A}}}const Ky="admin-theme-preference",Ui=D(h2());function h2(){return typeof window>"u"?"system":localStorage.getItem(Ky)||"system"}function f2(e){localStorage.setItem(Ky,e)}function Yy(){const e=z(()=>Ui.value==="system"?"light dark":Ui.value),t=(o,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Ui.value=o,f2(o)},n=()=>{const o=["system","light","dark"],l=(o.indexOf(Ui.value)+1)%o.length;t(o[l])},s=z(()=>Ui.value==="dark"?!0:Ui.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Ui,colorScheme:e,isDark:s,setTheme:t,cycleTheme:n}}const Jy=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",rc=e=>{if(!e)return"";const t=new Date(e),n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${n}-${s}-${o}T${i}:${l}`},Lu=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const n=e.includes("."),s=e.includes("/");return n!==s},al=(e,t,n,s)=>{const i=e*Math.PI/180,l=n*Math.PI/180,c=(n-e)*Math.PI/180,d=(s-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},p2=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ud(e,{areas:t=[],locations:n=[],marshals:s=[]}){if(!e||e.length===0)return e;const o=new Set(t.map(h=>h.id)),i=new Set(n.map(h=>h.id)),l=new Set(s.map(h=>h.id)),c=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,m=h.ids||[];if(!f||m.length===0)return h;const y=m.filter(k=>c.has(k)?!0:f==="Area"?o.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:y}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function Xy({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:n=[],areaLeadAreaIds:s=[],locationId:o,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const c=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(c){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(n.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(o))&&n.includes(o)||d.some(f=>n.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(n.length>0)return!0}else if(d.some(f=>i.includes(f))&&n.includes(o))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(s.length>0)return!0}else if(d.some(f=>s.includes(f)))return!0;break}}return!1}function Qy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tr={exports:{}};var v2=Tr.exports,Cv;function m2(){return Cv||(Cv=1,(function(e,t){(function(n,s){s(t)})(v2,(function(n){var s="1.9.4";function o(a){var u,v,S,N;for(v=1,S=arguments.length;v<S;v++){N=arguments[v];for(u in N)a[u]=N[u]}return a}var i=Object.create||(function(){function a(){}return function(u){return a.prototype=u,new a}})();function l(a,u){var v=Array.prototype.slice;if(a.bind)return a.bind.apply(a,v.call(arguments,1));var S=v.call(arguments,2);return function(){return a.apply(u,S.length?S.concat(v.call(arguments)):arguments)}}var c=0;function d(a){return"_leaflet_id"in a||(a._leaflet_id=++c),a._leaflet_id}function h(a,u,v){var S,N,W,he;return he=function(){S=!1,N&&(W.apply(v,N),N=!1)},W=function(){S?N=arguments:(a.apply(v,arguments),setTimeout(he,u),S=!0)},W}function f(a,u,v){var S=u[1],N=u[0],W=S-N;return a===S&&v?a:((a-N)%W+W)%W+N}function m(){return!1}function y(a,u){if(u===!1)return a;var v=Math.pow(10,u===void 0?6:u);return Math.round(a*v)/v}function k(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function b(a){return k(a).split(/\s+/)}function I(a,u){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?i(a.options):{});for(var v in u)a.options[v]=u[v];return a.options}function T(a,u,v){var S=[];for(var N in a)S.push(encodeURIComponent(v?N.toUpperCase():N)+"="+encodeURIComponent(a[N]));return(!u||u.indexOf("?")===-1?"?":"&")+S.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function x(a,u){return a.replace(E,function(v,S){var N=u[S];if(N===void 0)throw new Error("No value provided for variable "+v);return typeof N=="function"&&(N=N(u)),N})}var C=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function _(a,u){for(var v=0;v<a.length;v++)if(a[v]===u)return v;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var M=0;function O(a){var u=+new Date,v=Math.max(0,16-(u-M));return M=u+v,window.setTimeout(a,v)}var A=window.requestAnimationFrame||R("RequestAnimationFrame")||O,U=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,u,v){if(v&&A===O)a.call(u);else return A.call(window,l(a,u))}function j(a){a&&U.call(window,a)}var Z={__proto__:null,extend:o,create:i,bind:l,get lastId(){return c},stamp:d,throttle:h,wrapNum:f,falseFn:m,formatNum:y,trim:k,splitWords:b,setOptions:I,getParamString:T,template:x,isArray:C,indexOf:_,emptyImageUrl:$,requestFn:A,cancelFn:U,requestAnimFrame:F,cancelAnimFrame:j};function X(){}X.extend=function(a){var u=function(){I(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=u.__super__=this.prototype,S=i(v);S.constructor=u,u.prototype=S;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(u[N]=this[N]);return a.statics&&o(u,a.statics),a.includes&&(re(a.includes),o.apply(null,[S].concat(a.includes))),o(S,a),delete S.statics,delete S.includes,S.options&&(S.options=v.options?i(v.options):{},o(S.options,a.options)),S._initHooks=[],S.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,he=S._initHooks.length;W<he;W++)S._initHooks[W].call(this)}},u},X.include=function(a){var u=this.prototype.options;return o(this.prototype,a),a.options&&(this.prototype.options=u,this.mergeOptions(a.options)),this},X.mergeOptions=function(a){return o(this.prototype.options,a),this},X.addInitHook=function(a){var u=Array.prototype.slice.call(arguments,1),v=typeof a=="function"?a:function(){this[a].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function re(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=C(a)?a:[a];for(var u=0;u<a.length;u++)a[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(a,u,v){if(typeof a=="object")for(var S in a)this._on(S,a[S],u);else{a=b(a);for(var N=0,W=a.length;N<W;N++)this._on(a[N],u,v)}return this},off:function(a,u,v){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var S in a)this._off(S,a[S],u);else{a=b(a);for(var N=arguments.length===1,W=0,he=a.length;W<he;W++)N?this._off(a[W]):this._off(a[W],u,v)}return this},_on:function(a,u,v,S){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(a,u,v)===!1){v===this&&(v=void 0);var N={fn:u,ctx:v};S&&(N.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(N)}},_off:function(a,u,v){var S,N,W;if(this._events&&(S=this._events[a],!!S)){if(arguments.length===1){if(this._firingCount)for(N=0,W=S.length;N<W;N++)S[N].fn=m;delete this._events[a];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var he=this._listens(a,u,v);if(he!==!1){var Me=S[he];this._firingCount&&(Me.fn=m,this._events[a]=S=S.slice()),S.splice(he,1)}}},fire:function(a,u,v){if(!this.listens(a,v))return this;var S=o({},u,{type:a,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var N=this._events[a];if(N){this._firingCount=this._firingCount+1||1;for(var W=0,he=N.length;W<he;W++){var Me=N[W],Fe=Me.fn;Me.once&&this.off(a,Fe,Me.ctx),Fe.call(Me.ctx||this,S)}this._firingCount--}}return v&&this._propagateEvent(S),this},listens:function(a,u,v,S){typeof a!="string"&&console.warn('"string" type argument expected');var N=u;typeof u!="function"&&(S=!!u,N=void 0,v=void 0);var W=this._events&&this._events[a];if(W&&W.length&&this._listens(a,N,v)!==!1)return!0;if(S){for(var he in this._eventParents)if(this._eventParents[he].listens(a,u,v,S))return!0}return!1},_listens:function(a,u,v){if(!this._events)return!1;var S=this._events[a]||[];if(!u)return!!S.length;v===this&&(v=void 0);for(var N=0,W=S.length;N<W;N++)if(S[N].fn===u&&S[N].ctx===v)return N;return!1},once:function(a,u,v){if(typeof a=="object")for(var S in a)this._on(S,a[S],u,!0);else{a=b(a);for(var N=0,W=a.length;N<W;N++)this._on(a[N],u,v,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d(a)],this},_propagateEvent:function(a){for(var u in this._eventParents)this._eventParents[u].fire(a.type,o({layer:a.target,propagatedFrom:a.target},a),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var ae=X.extend(K);function q(a,u,v){this.x=v?Math.round(a):a,this.y=v?Math.round(u):u}var Y=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(a){return this.clone()._add(te(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(te(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new q(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new q(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Y(this.x),this.y=Y(this.y),this},distanceTo:function(a){a=te(a);var u=a.x-this.x,v=a.y-this.y;return Math.sqrt(u*u+v*v)},equals:function(a){return a=te(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=te(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function te(a,u,v){return a instanceof q?a:C(a)?new q(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new q(a.x,a.y):new q(a,u,v)}function ue(a,u){if(a)for(var v=u?[a,u]:a,S=0,N=v.length;S<N;S++)this.extend(v[S])}ue.prototype={extend:function(a){var u,v;if(!a)return this;if(a instanceof q||typeof a[0]=="number"||"x"in a)u=v=te(a);else if(a=_e(a),u=a.min,v=a.max,!u||!v)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=v.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(a){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var u,v;return typeof a[0]=="number"||a instanceof q?a=te(a):a=_e(a),a instanceof ue?(u=a.min,v=a.max):u=v=a,u.x>=this.min.x&&v.x<=this.max.x&&u.y>=this.min.y&&v.y<=this.max.y},intersects:function(a){a=_e(a);var u=this.min,v=this.max,S=a.min,N=a.max,W=N.x>=u.x&&S.x<=v.x,he=N.y>=u.y&&S.y<=v.y;return W&&he},overlaps:function(a){a=_e(a);var u=this.min,v=this.max,S=a.min,N=a.max,W=N.x>u.x&&S.x<v.x,he=N.y>u.y&&S.y<v.y;return W&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var u=this.min,v=this.max,S=Math.abs(u.x-v.x)*a,N=Math.abs(u.y-v.y)*a;return _e(te(u.x-S,u.y-N),te(v.x+S,v.y+N))},equals:function(a){return a?(a=_e(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function _e(a,u){return!a||a instanceof ue?a:new ue(a,u)}function Te(a,u){if(a)for(var v=u?[a,u]:a,S=0,N=v.length;S<N;S++)this.extend(v[S])}Te.prototype={extend:function(a){var u=this._southWest,v=this._northEast,S,N;if(a instanceof De)S=a,N=a;else if(a instanceof Te){if(S=a._southWest,N=a._northEast,!S||!N)return this}else return a?this.extend(ke(a)||Pe(a)):this;return!u&&!v?(this._southWest=new De(S.lat,S.lng),this._northEast=new De(N.lat,N.lng)):(u.lat=Math.min(S.lat,u.lat),u.lng=Math.min(S.lng,u.lng),v.lat=Math.max(N.lat,v.lat),v.lng=Math.max(N.lng,v.lng)),this},pad:function(a){var u=this._southWest,v=this._northEast,S=Math.abs(u.lat-v.lat)*a,N=Math.abs(u.lng-v.lng)*a;return new Te(new De(u.lat-S,u.lng-N),new De(v.lat+S,v.lng+N))},getCenter:function(){return new De((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new De(this.getNorth(),this.getWest())},getSouthEast:function(){return new De(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof De||"lat"in a?a=ke(a):a=Pe(a);var u=this._southWest,v=this._northEast,S,N;return a instanceof Te?(S=a.getSouthWest(),N=a.getNorthEast()):S=N=a,S.lat>=u.lat&&N.lat<=v.lat&&S.lng>=u.lng&&N.lng<=v.lng},intersects:function(a){a=Pe(a);var u=this._southWest,v=this._northEast,S=a.getSouthWest(),N=a.getNorthEast(),W=N.lat>=u.lat&&S.lat<=v.lat,he=N.lng>=u.lng&&S.lng<=v.lng;return W&&he},overlaps:function(a){a=Pe(a);var u=this._southWest,v=this._northEast,S=a.getSouthWest(),N=a.getNorthEast(),W=N.lat>u.lat&&S.lat<v.lat,he=N.lng>u.lng&&S.lng<v.lng;return W&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,u){return a?(a=Pe(a),this._southWest.equals(a.getSouthWest(),u)&&this._northEast.equals(a.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Pe(a,u){return a instanceof Te?a:new Te(a,u)}function De(a,u,v){if(isNaN(a)||isNaN(u))throw new Error("Invalid LatLng object: ("+a+", "+u+")");this.lat=+a,this.lng=+u,v!==void 0&&(this.alt=+v)}De.prototype={equals:function(a,u){if(!a)return!1;a=ke(a);var v=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return v<=(u===void 0?1e-9:u)},toString:function(a){return"LatLng("+y(this.lat,a)+", "+y(this.lng,a)+")"},distanceTo:function(a){return J.distance(this,ke(a))},wrap:function(){return J.wrapLatLng(this)},toBounds:function(a){var u=180*a/40075017,v=u/Math.cos(Math.PI/180*this.lat);return Pe([this.lat-u,this.lng-v],[this.lat+u,this.lng+v])},clone:function(){return new De(this.lat,this.lng,this.alt)}};function ke(a,u,v){return a instanceof De?a:C(a)&&typeof a[0]!="object"?a.length===3?new De(a[0],a[1],a[2]):a.length===2?new De(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new De(a.lat,"lng"in a?a.lng:a.lon,a.alt):u===void 0?null:new De(a,u,v)}var H={latLngToPoint:function(a,u){var v=this.projection.project(a),S=this.scale(u);return this.transformation._transform(v,S)},pointToLatLng:function(a,u){var v=this.scale(u),S=this.transformation.untransform(a,v);return this.projection.unproject(S)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var u=this.projection.bounds,v=this.scale(a),S=this.transformation.transform(u.min,v),N=this.transformation.transform(u.max,v);return new ue(S,N)},infinite:!1,wrapLatLng:function(a){var u=this.wrapLng?f(a.lng,this.wrapLng,!0):a.lng,v=this.wrapLat?f(a.lat,this.wrapLat,!0):a.lat,S=a.alt;return new De(v,u,S)},wrapLatLngBounds:function(a){var u=a.getCenter(),v=this.wrapLatLng(u),S=u.lat-v.lat,N=u.lng-v.lng;if(S===0&&N===0)return a;var W=a.getSouthWest(),he=a.getNorthEast(),Me=new De(W.lat-S,W.lng-N),Fe=new De(he.lat-S,he.lng-N);return new Te(Me,Fe)}},J=o({},H,{wrapLng:[-180,180],R:6371e3,distance:function(a,u){var v=Math.PI/180,S=a.lat*v,N=u.lat*v,W=Math.sin((u.lat-a.lat)*v/2),he=Math.sin((u.lng-a.lng)*v/2),Me=W*W+Math.cos(S)*Math.cos(N)*he*he,Fe=2*Math.atan2(Math.sqrt(Me),Math.sqrt(1-Me));return this.R*Fe}}),de=6378137,ie={R:de,MAX_LATITUDE:85.0511287798,project:function(a){var u=Math.PI/180,v=this.MAX_LATITUDE,S=Math.max(Math.min(v,a.lat),-v),N=Math.sin(S*u);return new q(this.R*a.lng*u,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(a){var u=180/Math.PI;return new De((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*u,a.x*u/this.R)},bounds:(function(){var a=de*Math.PI;return new ue([-a,-a],[a,a])})()};function Re(a,u,v,S){if(C(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=u,this._c=v,this._d=S}Re.prototype={transform:function(a,u){return this._transform(a.clone(),u)},_transform:function(a,u){return u=u||1,a.x=u*(this._a*a.x+this._b),a.y=u*(this._c*a.y+this._d),a},untransform:function(a,u){return u=u||1,new q((a.x/u-this._b)/this._a,(a.y/u-this._d)/this._c)}};function G(a,u,v,S){return new Re(a,u,v,S)}var Q=o({},J,{code:"EPSG:3857",projection:ie,transformation:(function(){var a=.5/(Math.PI*ie.R);return G(a,.5,-a,.5)})()}),ee=o({},Q,{code:"EPSG:900913"});function Ce(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function Be(a,u){var v="",S,N,W,he,Me,Fe;for(S=0,W=a.length;S<W;S++){for(Me=a[S],N=0,he=Me.length;N<he;N++)Fe=Me[N],v+=(N?"L":"M")+Fe.x+" "+Fe.y;v+=u?Qe.svg?"z":"x":""}return v||"M0 0"}var ze=document.documentElement.style,Ae="ActiveXObject"in window,oe=Ae&&!document.addEventListener,ge="msLaunchUri"in navigator&&!("documentMode"in document),Ne=lt("webkit"),Oe=lt("android"),$e=lt("android 2")||lt("android 3"),me=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=Oe&&lt("Google")&&me<537&&!("AudioNode"in window),Ge=!!window.opera,fe=!ge&&lt("chrome"),be=lt("gecko")&&!Ne&&!Ge&&!Ae,ne=!fe&&lt("safari"),ye=lt("phantom"),He="OTransition"in ze,rt=navigator.platform.indexOf("Win")===0,kt=Ae&&"transition"in ze,Ot="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!$e,Lt="MozPerspective"in ze,xt=!window.L_DISABLE_3D&&(kt||Ot||Lt)&&!He&&!ye,Kt=typeof orientation<"u"||lt("mobile"),no=Kt&&Ne,Mo=Kt&&Ot,ft=!window.PointerEvent&&window.MSPointerEvent,Ct=!!(window.PointerEvent||ft),Mt="ontouchstart"in window||!!window.TouchEvent,Mn=!window.L_NO_TOUCH&&(Mt||Ct),go=Kt&&Ge,oo=Kt&&be,An=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,tn=(function(){var a=!1;try{var u=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",m,u),window.removeEventListener("testPassiveEventSupport",m,u)}catch{}return a})(),Ps=(function(){return!!document.createElement("canvas").getContext})(),yo=!!(document.createElementNS&&Ce("svg").createSVGRect),Uo=!!yo&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),pe=!yo&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var u=a.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),ve=navigator.platform.indexOf("Mac")===0,Ie=navigator.platform.indexOf("Linux")===0;function lt(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var Qe={ie:Ae,ielt9:oe,edge:ge,webkit:Ne,android:Oe,android23:$e,androidStock:Ze,opera:Ge,chrome:fe,gecko:be,safari:ne,phantom:ye,opera12:He,win:rt,ie3d:kt,webkit3d:Ot,gecko3d:Lt,any3d:xt,mobile:Kt,mobileWebkit:no,mobileWebkit3d:Mo,msPointer:ft,pointer:Ct,touch:Mn,touchNative:Mt,mobileOpera:go,mobileGecko:oo,retina:An,passiveEvents:tn,canvas:Ps,svg:yo,vml:pe,inlineSvg:Uo,mac:ve,linux:Ie},Nt=Qe.msPointer?"MSPointerDown":"pointerdown",on=Qe.msPointer?"MSPointerMove":"pointermove",mn=Qe.msPointer?"MSPointerUp":"pointerup",gn=Qe.msPointer?"MSPointerCancel":"pointercancel",Vn={touchstart:Nt,touchmove:on,touchend:mn,touchcancel:gn},Zs={touchstart:bo,touchmove:Vo,touchend:Vo,touchcancel:Vo},ko={},hl=!1;function fl(a,u,v){return u==="touchstart"&&Ta(),Zs[u]?(v=Zs[u].bind(this,v),a.addEventListener(Vn[u],v,!1),v):(console.warn("wrong event specified:",u),m)}function pl(a,u,v){if(!Vn[u]){console.warn("wrong event specified:",u);return}a.removeEventListener(Vn[u],v,!1)}function vi(a){ko[a.pointerId]=a}function zo(a){ko[a.pointerId]&&(ko[a.pointerId]=a)}function Ho(a){delete ko[a.pointerId]}function Ta(){hl||(document.addEventListener(Nt,vi,!0),document.addEventListener(on,zo,!0),document.addEventListener(mn,Ho,!0),document.addEventListener(gn,Ho,!0),hl=!0)}function Vo(a,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var v in ko)u.touches.push(ko[v]);u.changedTouches=[u],a(u)}}function bo(a,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&an(u),Vo(a,u)}function mi(a){var u={},v,S;for(S in a)v=a[S],u[S]=v&&v.bind?v.bind(a):v;return a=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var En=200;function Ao(a,u){a.addEventListener("dblclick",u);var v=0,S;function N(W){if(W.detail!==1){S=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var he=Lo(W);if(!(he.some(function(Fe){return Fe instanceof HTMLLabelElement&&Fe.attributes.for})&&!he.some(function(Fe){return Fe instanceof HTMLInputElement||Fe instanceof HTMLSelectElement}))){var Me=Date.now();Me-v<=En?(S++,S===2&&u(mi(W))):S=1,v=Me}}}return a.addEventListener("click",N),{dblclick:u,simDblclick:N}}function Ma(a,u){a.removeEventListener("dblclick",u.dblclick),a.removeEventListener("click",u.simDblclick)}var Ks=qo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),so=qo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ss=so==="webkitTransition"||so==="OTransition"?so+"End":"transitionend";function ao(a){return typeof a=="string"?document.getElementById(a):a}function as(a,u){var v=a.style[u]||a.currentStyle&&a.currentStyle[u];if((!v||v==="auto")&&document.defaultView){var S=document.defaultView.getComputedStyle(a,null);v=S?S[u]:null}return v==="auto"?null:v}function vt(a,u,v){var S=document.createElement(a);return S.className=u||"",v&&v.appendChild(S),S}function Bt(a){var u=a.parentNode;u&&u.removeChild(a)}function Pn(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function Sn(a){var u=a.parentNode;u&&u.lastChild!==a&&u.appendChild(a)}function io(a){var u=a.parentNode;u&&u.firstChild!==a&&u.insertBefore(a,u.firstChild)}function is(a,u){if(a.classList!==void 0)return a.classList.contains(u);var v=wo(a);return v.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(v)}function dt(a,u){if(a.classList!==void 0)for(var v=b(u),S=0,N=v.length;S<N;S++)a.classList.add(v[S]);else if(!is(a,u)){var W=wo(a);Eo(a,(W?W+" ":"")+u)}}function Yt(a,u){a.classList!==void 0?a.classList.remove(u):Eo(a,k((" "+wo(a)+" ").replace(" "+u+" "," ")))}function Eo(a,u){a.className.baseVal===void 0?a.className=u:a.className.baseVal=u}function wo(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function bn(a,u){"opacity"in a.style?a.style.opacity=u:"filter"in a.style&&Go(a,u)}function Go(a,u){var v=!1,S="DXImageTransform.Microsoft.Alpha";try{v=a.filters.item(S)}catch{if(u===1)return}u=Math.round(u*100),v?(v.Enabled=u!==100,v.Opacity=u):a.style.filter+=" progid:"+S+"(opacity="+u+")"}function qo(a){for(var u=document.documentElement.style,v=0;v<a.length;v++)if(a[v]in u)return a[v];return!1}function _o(a,u,v){var S=u||new q(0,0);a.style[Ks]=(Qe.ie3d?"translate("+S.x+"px,"+S.y+"px)":"translate3d("+S.x+"px,"+S.y+"px,0)")+(v?" scale("+v+")":"")}function Jt(a,u){a._leaflet_pos=u,Qe.any3d?_o(a,u):(a.style.left=u.x+"px",a.style.top=u.y+"px")}function Gn(a){return a._leaflet_pos||new q(0,0)}var ls,Ys,Aa;if("onselectstart"in document)ls=function(){bt(window,"selectstart",an)},Ys=function(){zt(window,"selectstart",an)};else{var Js=qo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ls=function(){if(Js){var a=document.documentElement.style;Aa=a[Js],a[Js]="none"}},Ys=function(){Js&&(document.documentElement.style[Js]=Aa,Aa=void 0)}}function Ea(){bt(window,"dragstart",an)}function gi(){zt(window,"dragstart",an)}var rs,Pa;function Xs(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Qs(),rs=a,Pa=a.style.outlineStyle,a.style.outlineStyle="none",bt(window,"keydown",Qs))}function Qs(){rs&&(rs.style.outlineStyle=Pa,rs=void 0,Pa=void 0,zt(window,"keydown",Qs))}function vl(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function yi(a){var u=a.getBoundingClientRect();return{x:u.width/a.offsetWidth||1,y:u.height/a.offsetHeight||1,boundingClientRect:u}}var hr={__proto__:null,TRANSFORM:Ks,TRANSITION:so,TRANSITION_END:ss,get:ao,getStyle:as,create:vt,remove:Bt,empty:Pn,toFront:Sn,toBack:io,hasClass:is,addClass:dt,removeClass:Yt,setClass:Eo,getClass:wo,setOpacity:bn,testProp:qo,setTransform:_o,setPosition:Jt,getPosition:Gn,get disableTextSelection(){return ls},get enableTextSelection(){return Ys},disableImageDrag:Ea,enableImageDrag:gi,preventOutline:Xs,restoreOutline:Qs,getSizedParentNode:vl,getScale:yi};function bt(a,u,v,S){if(u&&typeof u=="object")for(var N in u)ea(a,N,u[N],v);else{u=b(u);for(var W=0,he=u.length;W<he;W++)ea(a,u[W],v,S)}return this}var Dt="_leaflet_events";function zt(a,u,v,S){if(arguments.length===1)Co(a),delete a[Dt];else if(u&&typeof u=="object")for(var N in u)ki(a,N,u[N],v);else if(u=b(u),arguments.length===2)Co(a,function(Me){return _(u,Me)!==-1});else for(var W=0,he=u.length;W<he;W++)ki(a,u[W],v,S);return this}function Co(a,u){for(var v in a[Dt]){var S=v.split(/\d/)[0];(!u||u(S))&&ki(a,S,null,null,v)}}var Da={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ea(a,u,v,S){var N=u+d(v)+(S?"_"+d(S):"");if(a[Dt]&&a[Dt][N])return this;var W=function(Me){return v.call(S||a,Me||window.event)},he=W;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?W=fl(a,u,W):Qe.touch&&u==="dblclick"?W=Ao(a,W):"addEventListener"in a?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?a.addEventListener(Da[u]||u,W,Qe.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(W=function(Me){Me=Me||window.event,Ra(a,Me)&&he(Me)},a.addEventListener(Da[u],W,!1)):a.addEventListener(u,he,!1):a.attachEvent("on"+u,W),a[Dt]=a[Dt]||{},a[Dt][N]=W}function ki(a,u,v,S,N){N=N||u+d(v)+(S?"_"+d(S):"");var W=a[Dt]&&a[Dt][N];if(!W)return this;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?pl(a,u,W):Qe.touch&&u==="dblclick"?Ma(a,W):"removeEventListener"in a?a.removeEventListener(Da[u]||u,W,!1):a.detachEvent("on"+u,W),a[Dt][N]=null}function cs(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function sn(a){return ea(a,"wheel",cs),this}function wn(a){return bt(a,"mousedown touchstart dblclick contextmenu",cs),a._leaflet_disable_click=!0,this}function an(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function lo(a){return an(a),cs(a),this}function Lo(a){if(a.composedPath)return a.composedPath();for(var u=[],v=a.target;v;)u.push(v),v=v.parentNode;return u}function Ds(a,u){if(!u)return new q(a.clientX,a.clientY);var v=yi(u),S=v.boundingClientRect;return new q((a.clientX-S.left)/v.x-u.clientLeft,(a.clientY-S.top)/v.y-u.clientTop)}var ta=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Rs(a){return Qe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/ta:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function Ra(a,u){var v=u.relatedTarget;if(!v)return!0;try{for(;v&&v!==a;)v=v.parentNode}catch{return!1}return v!==a}var ml={__proto__:null,on:bt,off:zt,stopPropagation:cs,disableScrollPropagation:sn,disableClickPropagation:wn,preventDefault:an,stop:lo,getPropagationPath:Lo,getMousePosition:Ds,getWheelDelta:Rs,isExternalTarget:Ra,addListener:bt,removeListener:zt},bi=ae.extend({run:function(a,u,v,S){this.stop(),this._el=a,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(S||.5,.2),this._startPos=Gn(a),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var u=+new Date-this._startTime,v=this._duration*1e3;u<v?this._runFrame(this._easeOut(u/v),a):(this._runFrame(1),this._complete())},_runFrame:function(a,u){var v=this._startPos.add(this._offset.multiplyBy(a));u&&v._round(),Jt(this._el,v),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),At=ae.extend({options:{crs:Q,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,u){u=I(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(ke(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=so&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),bt(this._proxy,ss,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,u,v){if(u=u===void 0?this._zoom:this._limitZoom(u),a=this._limitCenter(ke(a),u,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=o({animate:v.animate},v.zoom),v.pan=o({animate:v.animate,duration:v.duration},v.pan));var S=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,u,v.zoom):this._tryAnimatedPan(a,v.pan);if(S)return clearTimeout(this._sizeTimer),this}return this._resetView(a,u,v.pan&&v.pan.noMoveStart),this},setZoom:function(a,u){return this._loaded?this.setView(this.getCenter(),a,{zoom:u}):(this._zoom=a,this)},zoomIn:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,u)},zoomOut:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,u)},setZoomAround:function(a,u,v){var S=this.getZoomScale(u),N=this.getSize().divideBy(2),W=a instanceof q?a:this.latLngToContainerPoint(a),he=W.subtract(N).multiplyBy(1-1/S),Me=this.containerPointToLatLng(N.add(he));return this.setView(Me,u,{zoom:v})},_getBoundsCenterZoom:function(a,u){u=u||{},a=a.getBounds?a.getBounds():Pe(a);var v=te(u.paddingTopLeft||u.padding||[0,0]),S=te(u.paddingBottomRight||u.padding||[0,0]),N=this.getBoundsZoom(a,!1,v.add(S));if(N=typeof u.maxZoom=="number"?Math.min(u.maxZoom,N):N,N===1/0)return{center:a.getCenter(),zoom:N};var W=S.subtract(v).divideBy(2),he=this.project(a.getSouthWest(),N),Me=this.project(a.getNorthEast(),N),Fe=this.unproject(he.add(Me).divideBy(2).add(W),N);return{center:Fe,zoom:N}},fitBounds:function(a,u){if(a=Pe(a),!a.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(a,u);return this.setView(v.center,v.zoom,u)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,u){return this.setView(a,this._zoom,{pan:u})},panBy:function(a,u){if(a=te(a).round(),u=u||{},!a.x&&!a.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new bi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){dt(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,v,u.duration||.25,u.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,u,v){if(v=v||{},v.animate===!1||!Qe.any3d)return this.setView(a,u,v);this._stop();var S=this.project(this.getCenter()),N=this.project(a),W=this.getSize(),he=this._zoom;a=ke(a),u=u===void 0?he:u;var Me=Math.max(W.x,W.y),Fe=Me*this.getZoomScale(he,u),Xe=N.distanceTo(S)||1,it=1.42,pt=it*it;function Et(_n){var Ec=_n?-1:1,P1=_n?Fe:Me,D1=Fe*Fe-Me*Me+Ec*pt*pt*Xe*Xe,R1=2*P1*pt*Xe,yd=D1/R1,jf=Math.sqrt(yd*yd+1)-yd,O1=jf<1e-9?-18:Math.log(jf);return O1}function co(_n){return(Math.exp(_n)-Math.exp(-_n))/2}function Dn(_n){return(Math.exp(_n)+Math.exp(-_n))/2}function Yo(_n){return co(_n)/Dn(_n)}var So=Et(0);function Ol(_n){return Me*(Dn(So)/Dn(So+it*_n))}function T1(_n){return Me*(Dn(So)*Yo(So+it*_n)-co(So))/pt}function M1(_n){return 1-Math.pow(1-_n,1.5)}var A1=Date.now(),Gf=(Et(1)-So)/it,E1=v.duration?1e3*v.duration:1e3*Gf*.8;function qf(){var _n=(Date.now()-A1)/E1,Ec=M1(_n)*Gf;_n<=1?(this._flyToFrame=F(qf,this),this._move(this.unproject(S.add(N.subtract(S).multiplyBy(T1(Ec)/Xe)),he),this.getScaleZoom(Me/Ol(Ec),he),{flyTo:!0})):this._move(a,u)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),qf.call(this),this},flyToBounds:function(a,u){var v=this._getBoundsCenterZoom(a,u);return this.flyTo(v.center,v.zoom,u)},setMaxBounds:function(a){return a=Pe(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var u=this.options.minZoom;return this.options.minZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var u=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,u){this._enforcingBounds=!0;var v=this.getCenter(),S=this._limitCenter(v,this._zoom,Pe(a));return v.equals(S)||this.panTo(S,u),this._enforcingBounds=!1,this},panInside:function(a,u){u=u||{};var v=te(u.paddingTopLeft||u.padding||[0,0]),S=te(u.paddingBottomRight||u.padding||[0,0]),N=this.project(this.getCenter()),W=this.project(a),he=this.getPixelBounds(),Me=_e([he.min.add(v),he.max.subtract(S)]),Fe=Me.getSize();if(!Me.contains(W)){this._enforcingBounds=!0;var Xe=W.subtract(Me.getCenter()),it=Me.extend(W).getSize().subtract(Fe);N.x+=Xe.x<0?-it.x:it.x,N.y+=Xe.y<0?-it.y:it.y,this.panTo(this.unproject(N),u),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=o({animate:!1,pan:!0},a===!0?{animate:!0}:a);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),S=u.divideBy(2).round(),N=v.divideBy(2).round(),W=S.subtract(N);return!W.x&&!W.y?this:(a.animate&&a.pan?this.panBy(W):(a.pan&&this._rawPanBy(W),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=o({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,v,a):navigator.geolocation.getCurrentPosition(u,v,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var u=a.code,v=a.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var u=a.coords.latitude,v=a.coords.longitude,S=new De(u,v),N=S.toBounds(a.coords.accuracy*2),W=this._locateOptions;if(W.setView){var he=this.getBoundsZoom(N);this.setView(S,W.maxZoom?Math.min(he,W.maxZoom):he)}var Me={latlng:S,bounds:N,timestamp:a.timestamp};for(var Fe in a.coords)typeof a.coords[Fe]=="number"&&(Me[Fe]=a.coords[Fe]);this.fire("locationfound",Me)}},addHandler:function(a,u){if(!u)return this;var v=this[a]=new u(this);return this._handlers.push(v),this.options[a]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Bt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Bt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,u){var v="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),S=vt("div",v,u||this._mapPane);return a&&(this._panes[a]=S),S},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),u=this.unproject(a.getBottomLeft()),v=this.unproject(a.getTopRight());return new Te(u,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,u,v){a=Pe(a),v=te(v||[0,0]);var S=this.getZoom()||0,N=this.getMinZoom(),W=this.getMaxZoom(),he=a.getNorthWest(),Me=a.getSouthEast(),Fe=this.getSize().subtract(v),Xe=_e(this.project(Me,S),this.project(he,S)).getSize(),it=Qe.any3d?this.options.zoomSnap:1,pt=Fe.x/Xe.x,Et=Fe.y/Xe.y,co=u?Math.max(pt,Et):Math.min(pt,Et);return S=this.getScaleZoom(co,S),it&&(S=Math.round(S/(it/100))*(it/100),S=u?Math.ceil(S/it)*it:Math.floor(S/it)*it),Math.max(N,Math.min(W,S))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,u){var v=this._getTopLeftPoint(a,u);return new ue(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,u){var v=this.options.crs;return u=u===void 0?this._zoom:u,v.scale(a)/v.scale(u)},getScaleZoom:function(a,u){var v=this.options.crs;u=u===void 0?this._zoom:u;var S=v.zoom(a*v.scale(u));return isNaN(S)?1/0:S},project:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(ke(a),u)},unproject:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(te(a),u)},layerPointToLatLng:function(a){var u=te(a).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(a){var u=this.project(ke(a))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(ke(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(Pe(a))},distance:function(a,u){return this.options.crs.distance(ke(a),ke(u))},containerPointToLayerPoint:function(a){return te(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return te(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var u=this.containerPointToLayerPoint(te(a));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ke(a)))},mouseEventToContainerPoint:function(a){return Ds(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var u=this._container=ao(a);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");bt(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,dt(a,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=as(a,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Jt(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dt(a.markerPane,"leaflet-zoom-hide"),dt(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,u,v){Jt(this._mapPane,new q(0,0));var S=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var N=this._zoom!==u;this._moveStart(N,v)._move(a,u)._moveEnd(N),this.fire("viewreset"),S&&this.fire("load")},_moveStart:function(a,u){return a&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(a,u,v,S){u===void 0&&(u=this._zoom);var N=this._zoom!==u;return this._zoom=u,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),S?v&&v.pinch&&this.fire("zoom",v):((N||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){Jt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[d(this._container)]=this;var u=a?zt:bt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,u){for(var v=[],S,N=u==="mouseout"||u==="mouseover",W=a.target||a.srcElement,he=!1;W;){if(S=this._targets[d(W)],S&&(u==="click"||u==="preclick")&&this._draggableMoved(S)){he=!0;break}if(S&&S.listens(u,!0)&&(N&&!Ra(W,a)||(v.push(S),N))||W===this._container)break;W=W.parentNode}return!v.length&&!he&&!N&&this.listens(u,!0)&&(v=[this]),v},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var u=a.target||a.srcElement;if(!(!this._loaded||u._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(u))){var v=a.type;v==="mousedown"&&Xs(u),this._fireDOMEvent(a,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,u,v){if(a.type==="click"){var S=o({},a);S.type="preclick",this._fireDOMEvent(S,S.type,v)}var N=this._findEventTargets(a,u);if(v){for(var W=[],he=0;he<v.length;he++)v[he].listens(u,!0)&&W.push(v[he]);N=W.concat(N)}if(N.length){u==="contextmenu"&&an(a);var Me=N[0],Fe={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var Xe=Me.getLatLng&&(!Me._radius||Me._radius<=10);Fe.containerPoint=Xe?this.latLngToContainerPoint(Me.getLatLng()):this.mouseEventToContainerPoint(a),Fe.layerPoint=this.containerPointToLayerPoint(Fe.containerPoint),Fe.latlng=Xe?Me.getLatLng():this.layerPointToLatLng(Fe.layerPoint)}for(he=0;he<N.length;he++)if(N[he].fire(u,Fe,!0),Fe.originalEvent._stopped||N[he].options.bubblingMouseEvents===!1&&_(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,u=this._handlers.length;a<u;a++)this._handlers[a].disable()},whenReady:function(a,u){return this._loaded?a.call(u||this,{target:this}):this.on("load",a,u),this},_getMapPanePos:function(){return Gn(this._mapPane)||new q(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,u){var v=a&&u!==void 0?this._getNewPixelOrigin(a,u):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,u){var v=this.getSize()._divideBy(2);return this.project(a,u)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,u,v){var S=this._getNewPixelOrigin(v,u);return this.project(a,u)._subtract(S)},_latLngBoundsToNewLayerBounds:function(a,u,v){var S=this._getNewPixelOrigin(v,u);return _e([this.project(a.getSouthWest(),u)._subtract(S),this.project(a.getNorthWest(),u)._subtract(S),this.project(a.getSouthEast(),u)._subtract(S),this.project(a.getNorthEast(),u)._subtract(S)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,u,v){if(!v)return a;var S=this.project(a,u),N=this.getSize().divideBy(2),W=new ue(S.subtract(N),S.add(N)),he=this._getBoundsOffset(W,v,u);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?a:this.unproject(S.add(he),u)},_limitOffset:function(a,u){if(!u)return a;var v=this.getPixelBounds(),S=new ue(v.min.add(a),v.max.add(a));return a.add(this._getBoundsOffset(S,u))},_getBoundsOffset:function(a,u,v){var S=_e(this.project(u.getNorthEast(),v),this.project(u.getSouthWest(),v)),N=S.min.subtract(a.min),W=S.max.subtract(a.max),he=this._rebound(N.x,-W.x),Me=this._rebound(N.y,-W.y);return new q(he,Me)},_rebound:function(a,u){return a+u>0?Math.round(a-u)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(u))},_limitZoom:function(a){var u=this.getMinZoom(),v=this.getMaxZoom(),S=Qe.any3d?this.options.zoomSnap:1;return S&&(a=Math.round(a/S)*S),Math.max(u,Math.min(v,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Yt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,u){var v=this._getCenterOffset(a)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,u),!0)},_createAnimProxy:function(){var a=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(u){var v=Ks,S=this._proxy.style[v];_o(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),S===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Bt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),u=this.getZoom();_o(this._proxy,this.project(a,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,u,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var S=this.getZoomScale(u),N=this._getCenterOffset(a)._divideBy(1-1/S);return v.animate!==!0&&!this.getSize().contains(N)?!1:(F(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(a,u,!0)},this),!0)},_animateZoom:function(a,u,v,S){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=u,dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:u,noUpdate:S}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Yt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function wi(a,u){return new At(a,u)}var In=X.extend({options:{position:"topright"},initialize:function(a){I(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var u=this._map;return u&&u.removeControl(this),this.options.position=a,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var u=this._container=this.onAdd(a),v=this.getPosition(),S=a._controlCorners[v];return dt(u,"leaflet-control"),v.indexOf("bottom")!==-1?S.insertBefore(u,S.firstChild):S.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Bt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),na=function(a){return new In(a)};At.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},u="leaflet-",v=this._controlContainer=vt("div",u+"control-container",this._container);function S(N,W){var he=u+N+" "+u+W;a[N+W]=vt("div",he,v)}S("top","left"),S("top","right"),S("bottom","left"),S("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Bt(this._controlCorners[a]);Bt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var gl=In.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,u,v,S){return v<S?-1:S<v?1:0}},initialize:function(a,u,v){I(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var S in a)this._addLayer(a[S],S);for(S in u)this._addLayer(u[S],S,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return In.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,u){return this._addLayer(a,u),this._map?this._update():this},addOverlay:function(a,u){return this._addLayer(a,u,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(a));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Yt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Yt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",u=this._container=vt("div",a),v=this.options.collapsed;u.setAttribute("aria-haspopup",!0),wn(u),sn(u);var S=this._section=vt("section",a+"-list");v&&(this._map.on("click",this.collapse,this),bt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=vt("a",a+"-toggle",u);N.href="#",N.title="Layers",N.setAttribute("role","button"),bt(N,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){an(W),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=vt("div",a+"-base",S),this._separator=vt("div",a+"-separator",S),this._overlaysList=vt("div",a+"-overlays",S),u.appendChild(S)},_getLayer:function(a){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===a)return this._layers[u]},_addLayer:function(a,u,v){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:u,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(S,N){return this.options.sortFunction(S.layer,N.layer,S.name,N.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Pn(this._baseLayersList),Pn(this._overlaysList),this._layerControlInputs=[];var a,u,v,S,N=0;for(v=0;v<this._layers.length;v++)S=this._layers[v],this._addItem(S),u=u||S.overlay,a=a||!S.overlay,N+=S.overlay?0:1;return this.options.hideSingleBase&&(a=a&&N>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=u&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var u=this._getLayer(d(a.target)),v=u.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;v&&this._map.fire(v,u)},_createRadioElement:function(a,u){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(u?' checked="checked"':"")+"/>",S=document.createElement("div");return S.innerHTML=v,S.firstChild},_addItem:function(a){var u=document.createElement("label"),v=this._map.hasLayer(a.layer),S;a.overlay?(S=document.createElement("input"),S.type="checkbox",S.className="leaflet-control-layers-selector",S.defaultChecked=v):S=this._createRadioElement("leaflet-base-layers_"+d(this),v),this._layerControlInputs.push(S),S.layerId=d(a.layer),bt(S,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+a.name;var W=document.createElement("span");u.appendChild(W),W.appendChild(S),W.appendChild(N);var he=a.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,u,v,S=[],N=[];this._handlingClick=!0;for(var W=a.length-1;W>=0;W--)u=a[W],v=this._getLayer(u.layerId).layer,u.checked?S.push(v):u.checked||N.push(v);for(W=0;W<N.length;W++)this._map.hasLayer(N[W])&&this._map.removeLayer(N[W]);for(W=0;W<S.length;W++)this._map.hasLayer(S[W])||this._map.addLayer(S[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,u,v,S=this._map.getZoom(),N=a.length-1;N>=0;N--)u=a[N],v=this._getLayer(u.layerId).layer,u.disabled=v.options.minZoom!==void 0&&S<v.options.minZoom||v.options.maxZoom!==void 0&&S>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,bt(a,"click",an),this.expand();var u=this;setTimeout(function(){zt(a,"click",an),u._preventClick=!1})}}),us=function(a,u,v){return new gl(a,u,v)},oa=In.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var u="leaflet-control-zoom",v=vt("div",u+" leaflet-bar"),S=this.options;return this._zoomInButton=this._createButton(S.zoomInText,S.zoomInTitle,u+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(S.zoomOutText,S.zoomOutTitle,u+"-out",v,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,u,v,S,N){var W=vt("a",v,S);return W.innerHTML=a,W.href="#",W.title=u,W.setAttribute("role","button"),W.setAttribute("aria-label",u),wn(W),bt(W,"click",lo),bt(W,"click",N,this),bt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var a=this._map,u="leaflet-disabled";Yt(this._zoomInButton,u),Yt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(dt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(dt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});At.mergeOptions({zoomControl:!0}),At.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new oa,this.addControl(this.zoomControl))});var fr=function(a){return new oa(a)},yl=In.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var u="leaflet-control-scale",v=vt("div",u),S=this.options;return this._addScales(S,u+"-line",v),a.on(S.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),v},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,u,v){a.metric&&(this._mScale=vt("div",u,v)),a.imperial&&(this._iScale=vt("div",u,v))},_update:function(){var a=this._map,u=a.getSize().y/2,v=a.distance(a.containerPointToLatLng([0,u]),a.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(v)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var u=this._getRoundNum(a),v=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,v,u/a)},_updateImperial:function(a){var u=a*3.2808399,v,S,N;u>5280?(v=u/5280,S=this._getRoundNum(v),this._updateScale(this._iScale,S+" mi",S/v)):(N=this._getRoundNum(u),this._updateScale(this._iScale,N+" ft",N/u))},_updateScale:function(a,u,v){a.style.width=Math.round(this.options.maxWidth*v)+"px",a.innerHTML=u},_getRoundNum:function(a){var u=Math.pow(10,(Math.floor(a)+"").length-1),v=a/u;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,u*v}}),sa=function(a){return new yl(a)},_i='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',jo=In.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?_i+" ":"")+"Leaflet</a>"},initialize:function(a){I(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),wn(this._container);for(var u in a._layers)a._layers[u].getAttribution&&this.addAttribution(a._layers[u].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var u in this._attributions)this._attributions[u]&&a.push(u);var v=[];this.options.prefix&&v.push(this.options.prefix),a.length&&v.push(a.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});At.mergeOptions({attributionControl:!0}),At.addInitHook(function(){this.options.attributionControl&&new jo().addTo(this)});var Ci=function(a){return new jo(a)};In.Layers=gl,In.Zoom=oa,In.Scale=yl,In.Attribution=jo,na.layers=us,na.zoom=fr,na.scale=sa,na.attribution=Ci;var On=X.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});On.addTo=function(a,u){return a.addHandler(u,this),this};var kl={Events:K},Li=Qe.touch?"touchstart mousedown":"mousedown",Wo=ae.extend({options:{clickTolerance:3},initialize:function(a,u,v,S){I(this,S),this._element=a,this._dragStartTarget=u||a,this._preventOutline=v},enable:function(){this._enabled||(bt(this._dragStartTarget,Li,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Wo._dragging===this&&this.finishDrag(!0),zt(this._dragStartTarget,Li,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!is(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Wo._dragging===this&&this.finishDrag();return}if(!(Wo._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Wo._dragging=this,this._preventOutline&&Xs(this._element),Ea(),ls(),!this._moving)){this.fire("down");var u=a.touches?a.touches[0]:a,v=vl(this._element);this._startPoint=new q(u.clientX,u.clientY),this._startPos=Gn(this._element),this._parentScale=yi(v);var S=a.type==="mousedown";bt(document,S?"mousemove":"touchmove",this._onMove,this),bt(document,S?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var u=a.touches&&a.touches.length===1?a.touches[0]:a,v=new q(u.clientX,u.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,an(a),this._moved||(this.fire("dragstart"),this._moved=!0,dt(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Jt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Yt(document.body,"leaflet-dragging"),this._lastTarget&&(Yt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zt(document,"mousemove touchmove",this._onMove,this),zt(document,"mouseup touchend touchcancel",this._onUp,this),gi(),Ys();var u=this._moved&&this._moving;this._moving=!1,Wo._dragging=!1,u&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function bl(a,u,v){var S,N=[1,4,2,8],W,he,Me,Fe,Xe,it,pt,Et;for(W=0,it=a.length;W<it;W++)a[W]._code=ds(a[W],u);for(Me=0;Me<4;Me++){for(pt=N[Me],S=[],W=0,it=a.length,he=it-1;W<it;he=W++)Fe=a[W],Xe=a[he],Fe._code&pt?Xe._code&pt||(Et=Fa(Xe,Fe,pt,u,v),Et._code=ds(Et,u),S.push(Et)):(Xe._code&pt&&(Et=Fa(Xe,Fe,pt,u,v),Et._code=ds(Et,u),S.push(Et)),S.push(Fe));a=S}return a}function Si(a,u){var v,S,N,W,he,Me,Fe,Xe,it;if(!a||a.length===0)throw new Error("latlngs not passed");Nn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var pt=ke([0,0]),Et=Pe(a),co=Et.getNorthWest().distanceTo(Et.getSouthWest())*Et.getNorthEast().distanceTo(Et.getNorthWest());co<1700&&(pt=aa(a));var Dn=a.length,Yo=[];for(v=0;v<Dn;v++){var So=ke(a[v]);Yo.push(u.project(ke([So.lat-pt.lat,So.lng-pt.lng])))}for(Me=Fe=Xe=0,v=0,S=Dn-1;v<Dn;S=v++)N=Yo[v],W=Yo[S],he=N.y*W.x-W.y*N.x,Fe+=(N.x+W.x)*he,Xe+=(N.y+W.y)*he,Me+=he*3;Me===0?it=Yo[0]:it=[Fe/Me,Xe/Me];var Ol=u.unproject(te(it));return ke([Ol.lat+pt.lat,Ol.lng+pt.lng])}function aa(a){for(var u=0,v=0,S=0,N=0;N<a.length;N++){var W=ke(a[N]);u+=W.lat,v+=W.lng,S++}return ke([u/S,v/S])}var Oa={__proto__:null,clipPolygon:bl,polygonCenter:Si,centroid:aa};function Na(a,u){if(!u||!a.length)return a.slice();var v=u*u;return a=xi(a,v),a=Cl(a,v),a}function wl(a,u,v){return Math.sqrt(Os(a,u,v,!0))}function _l(a,u,v){return Os(a,u,v)}function Cl(a,u){var v=a.length,S=typeof Uint8Array<"u"?Uint8Array:Array,N=new S(v);N[0]=N[v-1]=1,Ii(a,N,u,0,v-1);var W,he=[];for(W=0;W<v;W++)N[W]&&he.push(a[W]);return he}function Ii(a,u,v,S,N){var W=0,he,Me,Fe;for(Me=S+1;Me<=N-1;Me++)Fe=Os(a[Me],a[S],a[N],!0),Fe>W&&(he=Me,W=Fe);W>v&&(u[he]=1,Ii(a,u,v,S,he),Ii(a,u,v,he,N))}function xi(a,u){for(var v=[a[0]],S=1,N=0,W=a.length;S<W;S++)pr(a[S],a[N])>u&&(v.push(a[S]),N=S);return N<W-1&&v.push(a[W-1]),v}var $i;function Ba(a,u,v,S,N){var W=S?$i:ds(a,v),he=ds(u,v),Me,Fe,Xe;for($i=he;;){if(!(W|he))return[a,u];if(W&he)return!1;Me=W||he,Fe=Fa(a,u,Me,v,N),Xe=ds(Fe,v),Me===W?(a=Fe,W=Xe):(u=Fe,he=Xe)}}function Fa(a,u,v,S,N){var W=u.x-a.x,he=u.y-a.y,Me=S.min,Fe=S.max,Xe,it;return v&8?(Xe=a.x+W*(Fe.y-a.y)/he,it=Fe.y):v&4?(Xe=a.x+W*(Me.y-a.y)/he,it=Me.y):v&2?(Xe=Fe.x,it=a.y+he*(Fe.x-a.x)/W):v&1&&(Xe=Me.x,it=a.y+he*(Me.x-a.x)/W),new q(Xe,it,N)}function ds(a,u){var v=0;return a.x<u.min.x?v|=1:a.x>u.max.x&&(v|=2),a.y<u.min.y?v|=4:a.y>u.max.y&&(v|=8),v}function pr(a,u){var v=u.x-a.x,S=u.y-a.y;return v*v+S*S}function Os(a,u,v,S){var N=u.x,W=u.y,he=v.x-N,Me=v.y-W,Fe=he*he+Me*Me,Xe;return Fe>0&&(Xe=((a.x-N)*he+(a.y-W)*Me)/Fe,Xe>1?(N=v.x,W=v.y):Xe>0&&(N+=he*Xe,W+=Me*Xe)),he=a.x-N,Me=a.y-W,S?he*he+Me*Me:new q(N,W)}function Nn(a){return!C(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function ia(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Nn(a)}function Ti(a,u){var v,S,N,W,he,Me,Fe,Xe;if(!a||a.length===0)throw new Error("latlngs not passed");Nn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var it=ke([0,0]),pt=Pe(a),Et=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());Et<1700&&(it=aa(a));var co=a.length,Dn=[];for(v=0;v<co;v++){var Yo=ke(a[v]);Dn.push(u.project(ke([Yo.lat-it.lat,Yo.lng-it.lng])))}for(v=0,S=0;v<co-1;v++)S+=Dn[v].distanceTo(Dn[v+1])/2;if(S===0)Xe=Dn[0];else for(v=0,W=0;v<co-1;v++)if(he=Dn[v],Me=Dn[v+1],N=he.distanceTo(Me),W+=N,W>S){Fe=(W-S)/N,Xe=[Me.x-Fe*(Me.x-he.x),Me.y-Fe*(Me.y-he.y)];break}var So=u.unproject(te(Xe));return ke([So.lat+it.lat,So.lng+it.lng])}var xe={__proto__:null,simplify:Na,pointToSegmentDistance:wl,closestPointOnSegment:_l,clipSegment:Ba,_getEdgeIntersection:Fa,_getBitCode:ds,_sqClosestPointOnSegment:Os,isFlat:Nn,_flat:ia,polylineCenter:Ti},Le={project:function(a){return new q(a.lng,a.lat)},unproject:function(a){return new De(a.y,a.x)},bounds:new ue([-180,-90],[180,90])},nt={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var u=Math.PI/180,v=this.R,S=a.lat*u,N=this.R_MINOR/v,W=Math.sqrt(1-N*N),he=W*Math.sin(S),Me=Math.tan(Math.PI/4-S/2)/Math.pow((1-he)/(1+he),W/2);return S=-v*Math.log(Math.max(Me,1e-10)),new q(a.lng*u*v,S)},unproject:function(a){for(var u=180/Math.PI,v=this.R,S=this.R_MINOR/v,N=Math.sqrt(1-S*S),W=Math.exp(-a.y/v),he=Math.PI/2-2*Math.atan(W),Me=0,Fe=.1,Xe;Me<15&&Math.abs(Fe)>1e-7;Me++)Xe=N*Math.sin(he),Xe=Math.pow((1-Xe)/(1+Xe),N/2),Fe=Math.PI/2-2*Math.atan(W*Xe)-he,he+=Fe;return new De(he*u,a.x*u/v)}},mt={__proto__:null,LonLat:Le,Mercator:nt,SphericalMercator:ie},$t=o({},J,{code:"EPSG:3395",projection:nt,transformation:(function(){var a=.5/(Math.PI*nt.R);return G(a,.5,-a,.5)})()}),Ht=o({},J,{code:"EPSG:4326",projection:Le,transformation:G(1/180,1,-1/180,.5)}),Bn=o({},H,{projection:Le,transformation:G(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,u){var v=u.lng-a.lng,S=u.lat-a.lat;return Math.sqrt(v*v+S*S)},infinite:!0});H.Earth=J,H.EPSG3395=$t,H.EPSG3857=Q,H.EPSG900913=ee,H.EPSG4326=Ht,H.Simple=Bn;var Vt=ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var u=a.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var v=this.getEvents();u.on(v,this),this.once("remove",function(){u.off(v,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});At.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(a);return this._layers[u]?this:(this._layers[u]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var u=d(a);return this._layers[u]?(this._loaded&&a.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return d(a)in this._layers},eachLayer:function(a,u){for(var v in this._layers)a.call(u,this._layers[v]);return this},_addLayers:function(a){a=a?C(a)?a:[a]:[];for(var u=0,v=a.length;u<v;u++)this.addLayer(a[u])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[d(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var u=d(a);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,u=-1/0,v=this._getZoomSpan();for(var S in this._zoomBoundLayers){var N=this._zoomBoundLayers[S].options;a=N.minZoom===void 0?a:Math.min(a,N.minZoom),u=N.maxZoom===void 0?u:Math.max(u,N.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=a===1/0?void 0:a,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ln=Vt.extend({initialize:function(a,u){I(this,u),this._layers={};var v,S;if(a)for(v=0,S=a.length;v<S;v++)this.addLayer(a[v])},addLayer:function(a){var u=this.getLayerId(a);return this._layers[u]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var u=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(a){var u=typeof a=="number"?a:this.getLayerId(a);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var u=Array.prototype.slice.call(arguments,1),v,S;for(v in this._layers)S=this._layers[v],S[a]&&S[a].apply(S,u);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,u){for(var v in this._layers)a.call(u,this._layers[v]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d(a)}}),ro=function(a,u){return new ln(a,u)},wt=ln.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),ln.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),ln.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new Te;for(var u in this._layers){var v=this._layers[u];a.extend(v.getBounds?v.getBounds():v.getLatLng())}return a}}),qn=function(a,u){return new wt(a,u)},Zo=X.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){I(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,u){var v=this._getIconUrl(a);if(!v){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var S=this._createImg(v,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(S,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),S},_setIconStyles:function(a,u){var v=this.options,S=v[u+"Size"];typeof S=="number"&&(S=[S,S]);var N=te(S),W=te(u==="shadow"&&v.shadowAnchor||v.iconAnchor||N&&N.divideBy(2,!0));a.className="leaflet-marker-"+u+" "+(v.className||""),W&&(a.style.marginLeft=-W.x+"px",a.style.marginTop=-W.y+"px"),N&&(a.style.width=N.x+"px",a.style.height=N.y+"px")},_createImg:function(a,u){return u=u||document.createElement("img"),u.src=a,u},_getIconUrl:function(a){return Qe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function vr(a){return new Zo(a)}var Mi=Zo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Mi.imagePath!="string"&&(Mi.imagePath=this._detectIconPath()),(this.options.imagePath||Mi.imagePath)+Zo.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var u=function(v,S,N){var W=S.exec(v);return W&&W[N]};return a=u(a,/^url\((['"])?(.+)\1\)$/,2),a&&u(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=vt("div","leaflet-default-icon-path",document.body),u=as(a,"background-image")||as(a,"backgroundImage");if(document.body.removeChild(a),u=this._stripUrl(u),u)return u;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),mr=On.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Wo(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dt(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Yt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var u=this._marker,v=u._map,S=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,W=Gn(u._icon),he=v.getPixelBounds(),Me=v.getPixelOrigin(),Fe=_e(he.min._subtract(Me).add(N),he.max._subtract(Me).subtract(N));if(!Fe.contains(W)){var Xe=te((Math.max(Fe.max.x,W.x)-Fe.max.x)/(he.max.x-Fe.max.x)-(Math.min(Fe.min.x,W.x)-Fe.min.x)/(he.min.x-Fe.min.x),(Math.max(Fe.max.y,W.y)-Fe.max.y)/(he.max.y-Fe.max.y)-(Math.min(Fe.min.y,W.y)-Fe.min.y)/(he.min.y-Fe.min.y)).multiplyBy(S);v.panBy(Xe,{animate:!1}),this._draggable._newPos._add(Xe),this._draggable._startPos._add(Xe),Jt(u._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var u=this._marker,v=u._shadow,S=Gn(u._icon),N=u._map.layerPointToLatLng(S);v&&Jt(v,S),u._latlng=N,a.latlng=N,a.oldLatLng=this._oldLatLng,u.fire("move",a).fire("drag",a)},_onDragEnd:function(a){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Ll=Vt.extend({options:{icon:new Mi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,u){I(this,u),this._latlng=ke(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var u=this._latlng;return this._latlng=ke(a),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=a.icon.createIcon(this._icon),S=!1;v!==this._icon&&(this._icon&&this._removeIcon(),S=!0,a.title&&(v.title=a.title),v.tagName==="IMG"&&(v.alt=a.alt||"")),dt(v,u),a.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(v,"focus",this._panOnFocus,this);var N=a.icon.createShadow(this._shadow),W=!1;N!==this._shadow&&(this._removeShadow(),W=!0),N&&(dt(N,u),N.alt=""),this._shadow=N,a.opacity<1&&this._updateOpacity(),S&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&W&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(this._icon,"focus",this._panOnFocus,this),Bt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Bt(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&Jt(this._icon,a),this._shadow&&Jt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mr)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mr(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&bn(this._icon,a),this._shadow&&bn(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var u=this.options.icon.options,v=u.iconSize?te(u.iconSize):te(0,0),S=u.iconAnchor?te(u.iconAnchor):te(0,0);a.panInside(this._latlng,{paddingTopLeft:S,paddingBottomRight:v.subtract(S)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _c(a,u){return new Ll(a,u)}var Ns=Vt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return I(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ai=Ns.extend({options:{fill:!0,radius:10},initialize:function(a,u){I(this,u),this._latlng=ke(a),this._radius=this.options.radius},setLatLng:function(a){var u=this._latlng;return this._latlng=ke(a),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var u=a&&a.radius||this._radius;return Ns.prototype.setStyle.call(this,a),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,u=this._radiusY||a,v=this._clickTolerance(),S=[a+v,u+v];this._pxBounds=new ue(this._point.subtract(S),this._point.add(S))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function rd(a,u){return new Ai(a,u)}var gr=Ai.extend({initialize:function(a,u,v){if(typeof u=="number"&&(u=o({},v,{radius:u})),I(this,u),this._latlng=ke(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new Te(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ns.prototype.setStyle,_project:function(){var a=this._latlng.lng,u=this._latlng.lat,v=this._map,S=v.options.crs;if(S.distance===J.distance){var N=Math.PI/180,W=this._mRadius/J.R/N,he=v.project([u+W,a]),Me=v.project([u-W,a]),Fe=he.add(Me).divideBy(2),Xe=v.unproject(Fe).lat,it=Math.acos((Math.cos(W*N)-Math.sin(u*N)*Math.sin(Xe*N))/(Math.cos(u*N)*Math.cos(Xe*N)))/N;(isNaN(it)||it===0)&&(it=W/Math.cos(Math.PI/180*u)),this._point=Fe.subtract(v.getPixelOrigin()),this._radius=isNaN(it)?0:Fe.x-v.project([Xe,a-it]).x,this._radiusY=Fe.y-he.y}else{var pt=S.unproject(S.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(pt).x}this._updateBounds()}});function cd(a,u,v){return new gr(a,u,v)}var hs=Ns.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,u){I(this,u),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var u=1/0,v=null,S=Os,N,W,he=0,Me=this._parts.length;he<Me;he++)for(var Fe=this._parts[he],Xe=1,it=Fe.length;Xe<it;Xe++){N=Fe[Xe-1],W=Fe[Xe];var pt=S(a,N,W,!0);pt<u&&(u=pt,v=S(a,N,W))}return v&&(v.distance=Math.sqrt(u)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ti(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,u){return u=u||this._defaultShape(),a=ke(a),u.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new Te,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Nn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var u=[],v=Nn(a),S=0,N=a.length;S<N;S++)v?(u[S]=ke(a[S]),this._bounds.extend(u[S])):u[S]=this._convertLatLngs(a[S]);return u},_project:function(){var a=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),u=new q(a,a);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(a,u,v){var S=a[0]instanceof De,N=a.length,W,he;if(S){for(he=[],W=0;W<N;W++)he[W]=this._map.latLngToLayerPoint(a[W]),v.extend(he[W]);u.push(he)}else for(W=0;W<N;W++)this._projectLatlngs(a[W],u,v)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,v,S,N,W,he,Me,Fe;for(v=0,N=0,W=this._rings.length;v<W;v++)for(Fe=this._rings[v],S=0,he=Fe.length;S<he-1;S++)Me=Ba(Fe[S],Fe[S+1],a,S,!0),Me&&(u[N]=u[N]||[],u[N].push(Me[0]),(Me[1]!==Fe[S+1]||S===he-2)&&(u[N].push(Me[1]),N++))}},_simplifyPoints:function(){for(var a=this._parts,u=this.options.smoothFactor,v=0,S=a.length;v<S;v++)a[v]=Na(a[v],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,u){var v,S,N,W,he,Me,Fe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(v=0,W=this._parts.length;v<W;v++)for(Me=this._parts[v],S=0,he=Me.length,N=he-1;S<he;N=S++)if(!(!u&&S===0)&&wl(a,Me[N],Me[S])<=Fe)return!0;return!1}});function ud(a,u){return new hs(a,u)}hs._flat=ia;var Ua=hs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Si(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var u=hs.prototype._convertLatLngs.call(this,a),v=u.length;return v>=2&&u[0]instanceof De&&u[0].equals(u[v-1])&&u.pop(),u},_setLatLngs:function(a){hs.prototype._setLatLngs.call(this,a),Nn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Nn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,u=this.options.weight,v=new q(u,u);if(a=new ue(a.min.subtract(v),a.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var S=0,N=this._rings.length,W;S<N;S++)W=bl(this._rings[S],a,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var u=!1,v,S,N,W,he,Me,Fe,Xe;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(W=0,Fe=this._parts.length;W<Fe;W++)for(v=this._parts[W],he=0,Xe=v.length,Me=Xe-1;he<Xe;Me=he++)S=v[he],N=v[Me],S.y>a.y!=N.y>a.y&&a.x<(N.x-S.x)*(a.y-S.y)/(N.y-S.y)+S.x&&(u=!u);return u||hs.prototype._containsPoint.call(this,a,!0)}});function dd(a,u){return new Ua(a,u)}var fs=wt.extend({initialize:function(a,u){I(this,u),this._layers={},a&&this.addData(a)},addData:function(a){var u=C(a)?a:a.features,v,S,N;if(u){for(v=0,S=u.length;v<S;v++)N=u[v],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var W=this.options;if(W.filter&&!W.filter(a))return this;var he=Sl(a,W);return he?(he.feature=$l(a),he.defaultOptions=he.options,this.resetStyle(he),W.onEachFeature&&W.onEachFeature(a,he),this.addLayer(he)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=o({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(u){this._setLayerStyle(u,a)},this)},_setLayerStyle:function(a,u){a.setStyle&&(typeof u=="function"&&(u=u(a.feature)),a.setStyle(u))}});function Sl(a,u){var v=a.type==="Feature"?a.geometry:a,S=v?v.coordinates:null,N=[],W=u&&u.pointToLayer,he=u&&u.coordsToLatLng||yr,Me,Fe,Xe,it;if(!S&&!v)return null;switch(v.type){case"Point":return Me=he(S),Cc(W,a,Me,u);case"MultiPoint":for(Xe=0,it=S.length;Xe<it;Xe++)Me=he(S[Xe]),N.push(Cc(W,a,Me,u));return new wt(N);case"LineString":case"MultiLineString":return Fe=Il(S,v.type==="LineString"?0:1,he),new hs(Fe,u);case"Polygon":case"MultiPolygon":return Fe=Il(S,v.type==="Polygon"?1:2,he),new Ua(Fe,u);case"GeometryCollection":for(Xe=0,it=v.geometries.length;Xe<it;Xe++){var pt=Sl({geometry:v.geometries[Xe],type:"Feature",properties:a.properties},u);pt&&N.push(pt)}return new wt(N);case"FeatureCollection":for(Xe=0,it=v.features.length;Xe<it;Xe++){var Et=Sl(v.features[Xe],u);Et&&N.push(Et)}return new wt(N);default:throw new Error("Invalid GeoJSON object.")}}function Cc(a,u,v,S){return a?a(u,v):new Ll(v,S&&S.markersInheritOptions&&S)}function yr(a){return new De(a[1],a[0],a[2])}function Il(a,u,v){for(var S=[],N=0,W=a.length,he;N<W;N++)he=u?Il(a[N],u-1,v):(v||yr)(a[N]),S.push(he);return S}function za(a,u){return a=ke(a),a.alt!==void 0?[y(a.lng,u),y(a.lat,u),y(a.alt,u)]:[y(a.lng,u),y(a.lat,u)]}function xl(a,u,v,S){for(var N=[],W=0,he=a.length;W<he;W++)N.push(u?xl(a[W],Nn(a[W])?0:u-1,v,S):za(a[W],S));return!u&&v&&N.length>0&&N.push(N[0].slice()),N}function ps(a,u){return a.feature?o({},a.feature,{geometry:u}):$l(u)}function $l(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var Tl={toGeoJSON:function(a){return ps(this,{type:"Point",coordinates:za(this.getLatLng(),a)})}};Ll.include(Tl),gr.include(Tl),Ai.include(Tl),hs.include({toGeoJSON:function(a){var u=!Nn(this._latlngs),v=xl(this._latlngs,u?1:0,!1,a);return ps(this,{type:(u?"Multi":"")+"LineString",coordinates:v})}}),Ua.include({toGeoJSON:function(a){var u=!Nn(this._latlngs),v=u&&!Nn(this._latlngs[0]),S=xl(this._latlngs,v?2:u?1:0,!0,a);return u||(S=[S]),ps(this,{type:(v?"Multi":"")+"Polygon",coordinates:S})}}),ln.include({toMultiPoint:function(a){var u=[];return this.eachLayer(function(v){u.push(v.toGeoJSON(a).geometry.coordinates)}),ps(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(a){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(a);var v=u==="GeometryCollection",S=[];return this.eachLayer(function(N){if(N.toGeoJSON){var W=N.toGeoJSON(a);if(v)S.push(W.geometry);else{var he=$l(W);he.type==="FeatureCollection"?S.push.apply(S,he.features):S.push(he)}}}),v?ps(this,{geometries:S,type:"GeometryCollection"}):{type:"FeatureCollection",features:S}}});function Ml(a,u){return new fs(a,u)}var kr=Ml,Al=Vt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,u,v){this._url=a,this._bounds=Pe(u),I(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Bt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&Sn(this._image),this},bringToBack:function(){return this._map&&io(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=Pe(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",u=this._image=a?this._url:vt("img");if(dt(u,"leaflet-image-layer"),this._zoomAnimated&&dt(u,"leaflet-zoom-animated"),this.options.className&&dt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(a){var u=this._map.getZoomScale(a.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;_o(this._image,v,u)},_reset:function(){var a=this._image,u=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=u.getSize();Jt(a,u.min),a.style.width=v.x+"px",a.style.height=v.y+"px"},_updateOpacity:function(){bn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),hd=function(a,u,v){return new Al(a,u,v)},Lc=Al.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",u=this._image=a?this._url:vt("video");if(dt(u,"leaflet-image-layer"),this._zoomAnimated&&dt(u,"leaflet-zoom-animated"),this.options.className&&dt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onloadeddata=l(this.fire,this,"load"),a){for(var v=u.getElementsByTagName("source"),S=[],N=0;N<v.length;N++)S.push(v[N].src);this._url=v.length>0?S:[u.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var he=vt("source");he.src=this._url[W],u.appendChild(he)}}});function fd(a,u,v){return new Lc(a,u,v)}var Sc=Al.extend({_initImage:function(){var a=this._image=this._url;dt(a,"leaflet-image-layer"),this._zoomAnimated&&dt(a,"leaflet-zoom-animated"),this.options.className&&dt(a,this.options.className),a.onselectstart=m,a.onmousemove=m}});function pd(a,u,v){return new Sc(a,u,v)}var Ko=Vt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,u){a&&(a instanceof De||C(a))?(this._latlng=ke(a),I(this,u)):(I(this,a),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&bn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&bn(this._container,1),this.bringToFront(),this.options.interactive&&(dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(bn(this._container,0),this._removeTimeout=setTimeout(l(Bt,void 0,this._container),200)):Bt(this._container),this.options.interactive&&(Yt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=ke(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Sn(this._container),this},bringToBack:function(){return this._map&&io(this._container),this},_prepareOpen:function(a){var u=this._source;if(!u._map)return!1;if(u instanceof wt){u=null;var v=this._source._layers;for(var S in v)if(v[S]._map){u=v[S];break}if(!u)return!1;this._source=u}if(!a)if(u.getCenter)a=u.getCenter();else if(u.getLatLng)a=u.getLatLng();else if(u.getBounds)a=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")a.innerHTML=u;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),u=te(this.options.offset),v=this._getAnchor();this._zoomAnimated?Jt(this._container,a.add(v)):u=u.add(a).add(v);var S=this._containerBottom=-u.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=S+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});At.include({_initOverlay:function(a,u,v,S){var N=u;return N instanceof a||(N=new a(S).setContent(u)),v&&N.setLatLng(v),N}}),Vt.include({_initOverlay:function(a,u,v,S){var N=v;return N instanceof a?(I(N,S),N._source=this):(N=u&&!S?u:new a(S,this),N.setContent(v)),N}});var El=Ko.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Ko.prototype.openOn.call(this,a)},onAdd:function(a){Ko.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ns||this._source.on("preclick",cs))},onRemove:function(a){Ko.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ns||this._source.off("preclick",cs))},getEvents:function(){var a=Ko.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",u=this._container=vt("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=vt("div",a+"-content-wrapper",u);if(this._contentNode=vt("div",a+"-content",v),wn(u),sn(this._contentNode),bt(u,"contextmenu",cs),this._tipContainer=vt("div",a+"-tip-container",u),this._tip=vt("div",a+"-tip",this._tipContainer),this.options.closeButton){var S=this._closeButton=vt("a",a+"-close-button",u);S.setAttribute("role","button"),S.setAttribute("aria-label","Close popup"),S.href="#close",S.innerHTML='<span aria-hidden="true">&#215;</span>',bt(S,"click",function(N){an(N),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,u=a.style;u.width="",u.whiteSpace="nowrap";var v=a.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),u.width=v+1+"px",u.whiteSpace="",u.height="";var S=a.offsetHeight,N=this.options.maxHeight,W="leaflet-popup-scrolled";N&&S>N?(u.height=N+"px",dt(a,W)):Yt(a,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),v=this._getAnchor();Jt(this._container,u.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,u=parseInt(as(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+u,S=this._containerWidth,N=new q(this._containerLeft,-v-this._containerBottom);N._add(Gn(this._container));var W=a.layerPointToContainerPoint(N),he=te(this.options.autoPanPadding),Me=te(this.options.autoPanPaddingTopLeft||he),Fe=te(this.options.autoPanPaddingBottomRight||he),Xe=a.getSize(),it=0,pt=0;W.x+S+Fe.x>Xe.x&&(it=W.x+S-Xe.x+Fe.x),W.x-it-Me.x<0&&(it=W.x-Me.x),W.y+v+Fe.y>Xe.y&&(pt=W.y+v-Xe.y+Fe.y),W.y-pt-Me.y<0&&(pt=W.y-Me.y),(it||pt)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([it,pt]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),vd=function(a,u){return new El(a,u)};At.mergeOptions({closePopupOnClick:!0}),At.include({openPopup:function(a,u,v){return this._initOverlay(El,a,u,v).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Vt.include({bindPopup:function(a,u){return this._popup=this._initOverlay(El,this._popup,a,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof wt||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){lo(a);var u=a.layer||a.target;if(this._popup._source===u&&!(u instanceof Ns)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=u,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Pl=Ko.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Ko.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Ko.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Ko.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",u=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var u,v,S=this._map,N=this._container,W=S.latLngToContainerPoint(S.getCenter()),he=S.layerPointToContainerPoint(a),Me=this.options.direction,Fe=N.offsetWidth,Xe=N.offsetHeight,it=te(this.options.offset),pt=this._getAnchor();Me==="top"?(u=Fe/2,v=Xe):Me==="bottom"?(u=Fe/2,v=0):Me==="center"?(u=Fe/2,v=Xe/2):Me==="right"?(u=0,v=Xe/2):Me==="left"?(u=Fe,v=Xe/2):he.x<W.x?(Me="right",u=0,v=Xe/2):(Me="left",u=Fe+(it.x+pt.x)*2,v=Xe/2),a=a.subtract(te(u,v,!0)).add(it).add(pt),Yt(N,"leaflet-tooltip-right"),Yt(N,"leaflet-tooltip-left"),Yt(N,"leaflet-tooltip-top"),Yt(N,"leaflet-tooltip-bottom"),dt(N,"leaflet-tooltip-"+Me),Jt(N,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&bn(this._container,a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(u)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ic=function(a,u){return new Pl(a,u)};At.include({openTooltip:function(a,u,v){return this._initOverlay(Pl,a,u,v).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Vt.include({bindTooltip:function(a,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Pl,this._tooltip,a,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var u=a?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[u](v),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof wt||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&(bt(u,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),bt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var u=a.latlng,v,S;this._tooltip.options.sticky&&a.originalEvent&&(v=this._map.mouseEventToContainerPoint(a.originalEvent),S=this._map.containerPointToLayerPoint(v),u=this._map.layerPointToLatLng(S)),this._tooltip.setLatLng(u)}});var xc=Zo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var u=a&&a.tagName==="DIV"?a:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Pn(u),u.appendChild(v.html)):u.innerHTML=v.html!==!1?v.html:"",v.bgPos){var S=te(v.bgPos);u.style.backgroundPosition=-S.x+"px "+-S.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function $c(a){return new xc(a)}Zo.Default=Mi;var Ei=Vt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){I(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Bt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Sn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(io(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof q?a:new q(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var u=this.getPane().children,v=-a(-1/0,1/0),S=0,N=u.length,W;S<N;S++)W=u[S].style.zIndex,u[S]!==this._container&&W&&(v=a(v,+W));isFinite(v)&&(this.options.zIndex=v+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){bn(this._container,this.options.opacity);var a=+new Date,u=!1,v=!1;for(var S in this._tiles){var N=this._tiles[S];if(!(!N.current||!N.loaded)){var W=Math.min(1,(a-N.loaded)/200);bn(N.el,W),W<1?u=!0:(N.active?v=!0:this._onOpaqueTile(N),N.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),u&&(j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,u=this.options.maxZoom;if(a!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===a?(this._levels[v].el.style.zIndex=u-Math.abs(a-v),this._onUpdateLevel(v)):(Bt(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var S=this._levels[a],N=this._map;return S||(S=this._levels[a]={},S.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),S.el.style.zIndex=u,S.origin=N.project(N.unproject(N.getPixelOrigin()),a).round(),S.zoom=a,this._setZoomTransform(S,N.getCenter(),N.getZoom()),m(S.el.offsetWidth),this._onCreateLevel(S)),this._level=S,S}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var a,u,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)u=this._tiles[a],u.retain=u.current;for(a in this._tiles)if(u=this._tiles[a],u.current&&!u.active){var S=u.coords;this._retainParent(S.x,S.y,S.z,S.z-5)||this._retainChildren(S.x,S.y,S.z,S.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var u in this._tiles)this._tiles[u].coords.z===a&&this._removeTile(u)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Bt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,u,v,S){var N=Math.floor(a/2),W=Math.floor(u/2),he=v-1,Me=new q(+N,+W);Me.z=+he;var Fe=this._tileCoordsToKey(Me),Xe=this._tiles[Fe];return Xe&&Xe.active?(Xe.retain=!0,!0):(Xe&&Xe.loaded&&(Xe.retain=!0),he>S?this._retainParent(N,W,he,S):!1)},_retainChildren:function(a,u,v,S){for(var N=2*a;N<2*a+2;N++)for(var W=2*u;W<2*u+2;W++){var he=new q(N,W);he.z=v+1;var Me=this._tileCoordsToKey(he),Fe=this._tiles[Me];if(Fe&&Fe.active){Fe.retain=!0;continue}else Fe&&Fe.loaded&&(Fe.retain=!0);v+1<S&&this._retainChildren(N,W,v+1,S)}},_resetView:function(a){var u=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var u=this.options;return u.minNativeZoom!==void 0&&a<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<a?u.maxNativeZoom:a},_setView:function(a,u,v,S){var N=Math.round(u);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var W=this.options.updateWhenZooming&&N!==this._tileZoom;(!S||W)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(a),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(a,u)},_setZoomTransforms:function(a,u){for(var v in this._levels)this._setZoomTransform(this._levels[v],a,u)},_setZoomTransform:function(a,u,v){var S=this._map.getZoomScale(v,a.zoom),N=a.origin.multiplyBy(S).subtract(this._map._getNewPixelOrigin(u,v)).round();Qe.any3d?_o(a.el,N,S):Jt(a.el,N)},_resetGrid:function(){var a=this._map,u=a.options.crs,v=this._tileSize=this.getTileSize(),S=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,u.wrapLng[0]],S).x/v.x),Math.ceil(a.project([0,u.wrapLng[1]],S).x/v.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([u.wrapLat[0],0],S).y/v.x),Math.ceil(a.project([u.wrapLat[1],0],S).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var u=this._map,v=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),S=u.getZoomScale(v,this._tileZoom),N=u.project(a,this._tileZoom).floor(),W=u.getSize().divideBy(S*2);return new ue(N.subtract(W),N.add(W))},_update:function(a){var u=this._map;if(u){var v=this._clampZoom(u.getZoom());if(a===void 0&&(a=u.getCenter()),this._tileZoom!==void 0){var S=this._getTiledPixelBounds(a),N=this._pxBoundsToTileRange(S),W=N.getCenter(),he=[],Me=this.options.keepBuffer,Fe=new ue(N.getBottomLeft().subtract([Me,-Me]),N.getTopRight().add([Me,-Me]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Xe in this._tiles){var it=this._tiles[Xe].coords;(it.z!==this._tileZoom||!Fe.contains(new q(it.x,it.y)))&&(this._tiles[Xe].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(a,v);return}for(var pt=N.min.y;pt<=N.max.y;pt++)for(var Et=N.min.x;Et<=N.max.x;Et++){var co=new q(Et,pt);if(co.z=this._tileZoom,!!this._isValidTile(co)){var Dn=this._tiles[this._tileCoordsToKey(co)];Dn?Dn.current=!0:he.push(co)}}if(he.sort(function(So,Ol){return So.distanceTo(W)-Ol.distanceTo(W)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Yo=document.createDocumentFragment();for(Et=0;Et<he.length;Et++)this._addTile(he[Et],Yo);this._level.el.appendChild(Yo)}}}},_isValidTile:function(a){var u=this._map.options.crs;if(!u.infinite){var v=this._globalTileRange;if(!u.wrapLng&&(a.x<v.min.x||a.x>v.max.x)||!u.wrapLat&&(a.y<v.min.y||a.y>v.max.y))return!1}if(!this.options.bounds)return!0;var S=this._tileCoordsToBounds(a);return Pe(this.options.bounds).overlaps(S)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var u=this._map,v=this.getTileSize(),S=a.scaleBy(v),N=S.add(v),W=u.unproject(S,a.z),he=u.unproject(N,a.z);return[W,he]},_tileCoordsToBounds:function(a){var u=this._tileCoordsToNwSe(a),v=new Te(u[0],u[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var u=a.split(":"),v=new q(+u[0],+u[1]);return v.z=+u[2],v},_removeTile:function(a){var u=this._tiles[a];u&&(Bt(u.el),delete this._tiles[a],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){dt(a,"leaflet-tile");var u=this.getTileSize();a.style.width=u.x+"px",a.style.height=u.y+"px",a.onselectstart=m,a.onmousemove=m,Qe.ielt9&&this.options.opacity<1&&bn(a,this.options.opacity)},_addTile:function(a,u){var v=this._getTilePos(a),S=this._tileCoordsToKey(a),N=this.createTile(this._wrapCoords(a),l(this._tileReady,this,a));this._initTile(N),this.createTile.length<2&&F(l(this._tileReady,this,a,null,N)),Jt(N,v),this._tiles[S]={el:N,coords:a,current:!0},u.appendChild(N),this.fire("tileloadstart",{tile:N,coords:a})},_tileReady:function(a,u,v){u&&this.fire("tileerror",{error:u,tile:v,coords:a});var S=this._tileCoordsToKey(a);v=this._tiles[S],v&&(v.loaded=+new Date,this._map._fadeAnimated?(bn(v.el,0),j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),u||(dt(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var u=new q(this._wrapX?f(a.x,this._wrapX):a.x,this._wrapY?f(a.y,this._wrapY):a.y);return u.z=a.z,u},_pxBoundsToTileRange:function(a){var u=this.getTileSize();return new ue(a.min.unscaleBy(u).floor(),a.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function md(a){return new Ei(a)}var Ha=Ei.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,u){this._url=a,u=I(this,u),u.detectRetina&&Qe.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,u){return this._url===a&&u===void 0&&(u=!0),this._url=a,u||this.redraw(),this},createTile:function(a,u){var v=document.createElement("img");return bt(v,"load",l(this._tileOnLoad,this,u,v)),bt(v,"error",l(this._tileOnError,this,u,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(a),v},getTileUrl:function(a){var u={r:Qe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-a.y;this.options.tms&&(u.y=v),u["-y"]=v}return x(this._url,o(u,this.options))},_tileOnLoad:function(a,u){Qe.ielt9?setTimeout(l(a,this,null,u),0):a(null,u)},_tileOnError:function(a,u,v){var S=this.options.errorTileUrl;S&&u.getAttribute("src")!==S&&(u.src=S),a(v,u)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,u=this.options.maxZoom,v=this.options.zoomReverse,S=this.options.zoomOffset;return v&&(a=u-a),a+S},_getSubdomain:function(a){var u=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var a,u;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(u=this._tiles[a].el,u.onload=m,u.onerror=m,!u.complete)){u.src=$;var v=this._tiles[a].coords;Bt(u),delete this._tiles[a],this.fire("tileabort",{tile:u,coords:v})}},_removeTile:function(a){var u=this._tiles[a];if(u)return u.el.setAttribute("src",$),Ei.prototype._removeTile.call(this,a)},_tileReady:function(a,u,v){if(!(!this._map||v&&v.getAttribute("src")===$))return Ei.prototype._tileReady.call(this,a,u,v)}});function Dl(a,u){return new Ha(a,u)}var Tc=Ha.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,u){this._url=a;var v=o({},this.defaultWmsParams);for(var S in u)S in this.options||(v[S]=u[S]);u=I(this,u);var N=u.detectRetina&&Qe.retina?2:1,W=this.getTileSize();v.width=W.x*N,v.height=W.y*N,this.wmsParams=v},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Ha.prototype.onAdd.call(this,a)},getTileUrl:function(a){var u=this._tileCoordsToNwSe(a),v=this._crs,S=_e(v.project(u[0]),v.project(u[1])),N=S.min,W=S.max,he=(this._wmsVersion>=1.3&&this._crs===Ht?[N.y,N.x,W.y,W.x]:[N.x,N.y,W.x,W.y]).join(","),Me=Ha.prototype.getTileUrl.call(this,a);return Me+T(this.wmsParams,Me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(a,u){return o(this.wmsParams,a),u||this.redraw(),this}});function gd(a,u){return new Tc(a,u)}Ha.WMS=Tc,Dl.wms=gd;var vs=Vt.extend({options:{padding:.1},initialize:function(a){I(this,a),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,u){var v=this._map.getZoomScale(u,this._zoom),S=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,u),W=S.multiplyBy(-v).add(N).subtract(this._map._getNewPixelOrigin(a,u));Qe.any3d?_o(this._container,W,v):Jt(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,u=this._map.getSize(),v=this._map.containerPointToLayerPoint(u.multiplyBy(-a)).round();this._bounds=new ue(v,v.add(u.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),br=vs.extend({options:{tolerance:0},getEvents:function(){var a=vs.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){vs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");bt(a,"mousemove",this._onMouseMove,this),bt(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),bt(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Bt(this._container),zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var u in this._layers)a=this._layers[u],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vs.prototype._update.call(this);var a=this._bounds,u=this._container,v=a.getSize(),S=Qe.retina?2:1;Jt(u,a.min),u.width=S*v.x,u.height=S*v.y,u.style.width=v.x+"px",u.style.height=v.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){vs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[d(a)]=a;var u=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var u=a._order,v=u.next,S=u.prev;v?v.prev=S:this._drawLast=S,S?S.next=v:this._drawFirst=v,delete a._order,delete this._layers[d(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var u=a.options.dashArray.split(/[, ]+/),v=[],S,N;for(N=0;N<u.length;N++){if(S=Number(u[N]),isNaN(S))return;v.push(S)}a.options._dashArray=v}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var u=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(a._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(a._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var u=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,u=this._redrawBounds;if(this._ctx.save(),u){var v=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var S=this._drawFirst;S;S=S.next)a=S.layer,(!u||a._pxBounds&&a._pxBounds.intersects(u))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,u){if(this._drawing){var v,S,N,W,he=a._parts,Me=he.length,Fe=this._ctx;if(Me){for(Fe.beginPath(),v=0;v<Me;v++){for(S=0,N=he[v].length;S<N;S++)W=he[v][S],Fe[S?"lineTo":"moveTo"](W.x,W.y);u&&Fe.closePath()}this._fillStroke(Fe,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var u=a._point,v=this._ctx,S=Math.max(Math.round(a._radius),1),N=(Math.max(Math.round(a._radiusY),1)||S)/S;N!==1&&(v.save(),v.scale(1,N)),v.beginPath(),v.arc(u.x,u.y/N,S,0,Math.PI*2,!1),N!==1&&v.restore(),this._fillStroke(v,a)}},_fillStroke:function(a,u){var v=u.options;v.fill&&(a.globalAlpha=v.fillOpacity,a.fillStyle=v.fillColor||v.color,a.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(a.setLineDash&&a.setLineDash(u.options&&u.options._dashArray||[]),a.globalAlpha=v.opacity,a.lineWidth=v.weight,a.strokeStyle=v.color,a.lineCap=v.lineCap,a.lineJoin=v.lineJoin,a.stroke())},_onClick:function(a){for(var u=this._map.mouseEventToLayerPoint(a),v,S,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(u)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(v))&&(S=v);this._fireEvent(S?[S]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,u)}},_handleMouseOut:function(a){var u=this._hoveredLayer;u&&(Yt(this._container,"leaflet-interactive"),this._fireEvent([u],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,u){if(!this._mouseHoverThrottled){for(var v,S,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(u)&&(S=v);S!==this._hoveredLayer&&(this._handleMouseOut(a),S&&(dt(this._container,"leaflet-interactive"),this._fireEvent([S],a,"mouseover"),this._hoveredLayer=S)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,u,v){this._map._fireDOMEvent(u,v||u.type,a)},_bringToFront:function(a){var u=a._order;if(u){var v=u.next,S=u.prev;if(v)v.prev=S;else return;S?S.next=v:v&&(this._drawFirst=v),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(a)}},_bringToBack:function(a){var u=a._order;if(u){var v=u.next,S=u.prev;if(S)S.next=v;else return;v?v.prev=S:S&&(this._drawLast=S),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(a)}}});function Mc(a){return Qe.canvas?new br(a):null}var ms=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ac={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(vs.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var u=a._container=ms("shape");dt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",a._path=ms("path"),u.appendChild(a._path),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){var u=a._container;this._container.appendChild(u),a.options.interactive&&a.addInteractiveTarget(u)},_removePath:function(a){var u=a._container;Bt(u),a.removeInteractiveTarget(u),delete this._layers[d(a)]},_updateStyle:function(a){var u=a._stroke,v=a._fill,S=a.options,N=a._container;N.stroked=!!S.stroke,N.filled=!!S.fill,S.stroke?(u||(u=a._stroke=ms("stroke")),N.appendChild(u),u.weight=S.weight+"px",u.color=S.color,u.opacity=S.opacity,S.dashArray?u.dashStyle=C(S.dashArray)?S.dashArray.join(" "):S.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=S.lineCap.replace("butt","flat"),u.joinstyle=S.lineJoin):u&&(N.removeChild(u),a._stroke=null),S.fill?(v||(v=a._fill=ms("fill")),N.appendChild(v),v.color=S.fillColor||S.color,v.opacity=S.fillOpacity):v&&(N.removeChild(v),a._fill=null)},_updateCircle:function(a){var u=a._point.round(),v=Math.round(a._radius),S=Math.round(a._radiusY||v);this._setPath(a,a._empty()?"M0 0":"AL "+u.x+","+u.y+" "+v+","+S+" 0,"+65535*360)},_setPath:function(a,u){a._path.v=u},_bringToFront:function(a){Sn(a._container)},_bringToBack:function(a){io(a._container)}},Pi=Qe.vml?ms:Ce,Va=vs.extend({_initContainer:function(){this._container=Pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Bt(this._container),zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vs.prototype._update.call(this);var a=this._bounds,u=a.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,v.setAttribute("width",u.x),v.setAttribute("height",u.y)),Jt(v,a.min),v.setAttribute("viewBox",[a.min.x,a.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(a){var u=a._path=Pi("path");a.options.className&&dt(u,a.options.className),a.options.interactive&&dt(u,"leaflet-interactive"),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Bt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[d(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var u=a._path,v=a.options;u&&(v.stroke?(u.setAttribute("stroke",v.color),u.setAttribute("stroke-opacity",v.opacity),u.setAttribute("stroke-width",v.weight),u.setAttribute("stroke-linecap",v.lineCap),u.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?u.setAttribute("stroke-dasharray",v.dashArray):u.removeAttribute("stroke-dasharray"),v.dashOffset?u.setAttribute("stroke-dashoffset",v.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),v.fill?(u.setAttribute("fill",v.fillColor||v.color),u.setAttribute("fill-opacity",v.fillOpacity),u.setAttribute("fill-rule",v.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(a,u){this._setPath(a,Be(a._parts,u))},_updateCircle:function(a){var u=a._point,v=Math.max(Math.round(a._radius),1),S=Math.max(Math.round(a._radiusY),1)||v,N="a"+v+","+S+" 0 1,0 ",W=a._empty()?"M0 0":"M"+(u.x-v)+","+u.y+N+v*2+",0 "+N+-v*2+",0 ";this._setPath(a,W)},_setPath:function(a,u){a._path.setAttribute("d",u)},_bringToFront:function(a){Sn(a._path)},_bringToBack:function(a){io(a._path)}});Qe.vml&&Va.include(Ac);function V(a){return Qe.svg||Qe.vml?new Va(a):null}At.include({getRenderer:function(a){var u=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var u=this._paneRenderers[a];return u===void 0&&(u=this._createRenderer({pane:a}),this._paneRenderers[a]=u),u},_createRenderer:function(a){return this.options.preferCanvas&&Mc(a)||V(a)}});var se=Ua.extend({initialize:function(a,u){Ua.prototype.initialize.call(this,this._boundsToLatLngs(a),u)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=Pe(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function ce(a,u){return new se(a,u)}Va.create=Pi,Va.pointsToPath=Be,fs.geometryToLayer=Sl,fs.coordsToLatLng=yr,fs.coordsToLatLngs=Il,fs.latLngToCoords=za,fs.latLngsToCoords=xl,fs.getFeature=ps,fs.asFeature=$l,At.mergeOptions({boxZoom:!0});var we=On.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Bt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ls(),Ea(),this._startPoint=this._map.mouseEventToContainerPoint(a),bt(document,{contextmenu:lo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var u=new ue(this._point,this._startPoint),v=u.getSize();Jt(this._box,u.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Bt(this._box),Yt(this._container,"leaflet-crosshair")),Ys(),gi(),zt(document,{contextmenu:lo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new Te(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});At.addInitHook("addHandler","boxZoom",we),At.mergeOptions({doubleClickZoom:!0});var at=On.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var u=this._map,v=u.getZoom(),S=u.options.zoomDelta,N=a.originalEvent.shiftKey?v-S:v+S;u.options.doubleClickZoom==="center"?u.setZoom(N):u.setZoomAround(a.containerPoint,N)}});At.addInitHook("addHandler","doubleClickZoom",at),At.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Tt=On.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Wo(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Yt(this._map._container,"leaflet-grab"),Yt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=Pe(this._map.options.maxBounds);this._offsetLimit=_e(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var u=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(u),this._prunePositions(u)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,u){return a-(a-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;a.x<u.min.x&&(a.x=this._viscousLimit(a.x,u.min.x)),a.y<u.min.y&&(a.y=this._viscousLimit(a.y,u.min.y)),a.x>u.max.x&&(a.x=this._viscousLimit(a.x,u.max.x)),a.y>u.max.y&&(a.y=this._viscousLimit(a.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,u=Math.round(a/2),v=this._initialWorldOffset,S=this._draggable._newPos.x,N=(S-u+v)%a+u-v,W=(S+u+v)%a-u-v,he=Math.abs(N+v)<Math.abs(W+v)?N:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(a){var u=this._map,v=u.options,S=!v.inertia||a.noInertia||this._times.length<2;if(u.fire("dragend",a),S)u.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,he=v.easeLinearity,Me=N.multiplyBy(he/W),Fe=Me.distanceTo([0,0]),Xe=Math.min(v.inertiaMaxSpeed,Fe),it=Me.multiplyBy(Xe/Fe),pt=Xe/(v.inertiaDeceleration*he),Et=it.multiplyBy(-pt/2).round();!Et.x&&!Et.y?u.fire("moveend"):(Et=u._limitOffset(Et,u.options.maxBounds),F(function(){u.panBy(Et,{duration:pt,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});At.addInitHook("addHandler","dragging",Tt),At.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Gt=On.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),bt(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,u=document.documentElement,v=a.scrollTop||u.scrollTop,S=a.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(S,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var u=this._panKeys={},v=this.keyCodes,S,N;for(S=0,N=v.left.length;S<N;S++)u[v.left[S]]=[-1*a,0];for(S=0,N=v.right.length;S<N;S++)u[v.right[S]]=[a,0];for(S=0,N=v.down.length;S<N;S++)u[v.down[S]]=[0,a];for(S=0,N=v.up.length;S<N;S++)u[v.up[S]]=[0,-1*a]},_setZoomDelta:function(a){var u=this._zoomKeys={},v=this.keyCodes,S,N;for(S=0,N=v.zoomIn.length;S<N;S++)u[v.zoomIn[S]]=a;for(S=0,N=v.zoomOut.length;S<N;S++)u[v.zoomOut[S]]=-a},_addHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var u=a.keyCode,v=this._map,S;if(u in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(S=this._panKeys[u],a.shiftKey&&(S=te(S).multiplyBy(3)),v.options.maxBounds&&(S=v._limitOffset(te(S),v.options.maxBounds)),v.options.worldCopyJump){var N=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(S)));v.panTo(N)}else v.panBy(S)}else if(u in this._zoomKeys)v.setZoom(v.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;lo(a)}}});At.addInitHook("addHandler","keyboard",Gt),At.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var xn=On.extend({addHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var u=Rs(a),v=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var S=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),S),lo(a)},_performZoom:function(){var a=this._map,u=a.getZoom(),v=this._map.options.zoomSnap||0;a._stop();var S=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(S))))/Math.LN2,W=v?Math.ceil(N/v)*v:N,he=a._limitZoom(u+(this._delta>0?W:-W))-u;this._delta=0,this._startTime=null,he&&(a.options.scrollWheelZoom==="center"?a.setZoom(u+he):a.setZoomAround(this._lastMousePos,u+he))}});At.addInitHook("addHandler","scrollWheelZoom",xn);var Di=600;At.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var Ri=On.extend({addHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var u=a.touches[0];this._startPos=this._newPos=new q(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(bt(document,"touchend",an),bt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Di),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){zt(document,"touchend",an),zt(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)},_onMove:function(a){var u=a.touches[0];this._newPos=new q(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,u){var v=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});v._simulated=!0,u.target.dispatchEvent(v)}});At.addInitHook("addHandler","tapHold",Ri),At.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var Rl=On.extend({addHooks:function(){dt(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Yt(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var u=this._map;if(!(!a.touches||a.touches.length!==2||u._animatingZoom||this._zooming)){var v=u.mouseEventToContainerPoint(a.touches[0]),S=u.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(v.add(S)._divideBy(2))),this._startDist=v.distanceTo(S),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),an(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var u=this._map,v=u.mouseEventToContainerPoint(a.touches[0]),S=u.mouseEventToContainerPoint(a.touches[1]),N=v.distanceTo(S)/this._startDist;if(this._zoom=u.getScaleZoom(N,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&N<1||this._zoom>u.getMaxZoom()&&N>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var W=v._add(S)._divideBy(2)._subtract(this._centerPoint);if(N===1&&W.x===0&&W.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var he=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(he,this,!0),an(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});At.addInitHook("addHandler","touchZoom",Rl),At.BoxZoom=we,At.DoubleClickZoom=at,At.Drag=Tt,At.Keyboard=Gt,At.ScrollWheelZoom=xn,At.TapHold=Ri,At.TouchZoom=Rl,n.Bounds=ue,n.Browser=Qe,n.CRS=H,n.Canvas=br,n.Circle=gr,n.CircleMarker=Ai,n.Class=X,n.Control=In,n.DivIcon=xc,n.DivOverlay=Ko,n.DomEvent=ml,n.DomUtil=hr,n.Draggable=Wo,n.Evented=ae,n.FeatureGroup=wt,n.GeoJSON=fs,n.GridLayer=Ei,n.Handler=On,n.Icon=Zo,n.ImageOverlay=Al,n.LatLng=De,n.LatLngBounds=Te,n.Layer=Vt,n.LayerGroup=ln,n.LineUtil=xe,n.Map=At,n.Marker=Ll,n.Mixin=kl,n.Path=Ns,n.Point=q,n.PolyUtil=Oa,n.Polygon=Ua,n.Polyline=hs,n.Popup=El,n.PosAnimation=bi,n.Projection=mt,n.Rectangle=se,n.Renderer=vs,n.SVG=Va,n.SVGOverlay=Sc,n.TileLayer=Ha,n.Tooltip=Pl,n.Transformation=Re,n.Util=Z,n.VideoOverlay=Lc,n.bind=l,n.bounds=_e,n.canvas=Mc,n.circle=cd,n.circleMarker=rd,n.control=na,n.divIcon=$c,n.extend=o,n.featureGroup=qn,n.geoJSON=Ml,n.geoJson=kr,n.gridLayer=md,n.icon=vr,n.imageOverlay=hd,n.latLng=ke,n.latLngBounds=Pe,n.layerGroup=ro,n.map=wi,n.marker=_c,n.point=te,n.polygon=dd,n.polyline=ud,n.popup=vd,n.rectangle=ce,n.setOptions=I,n.stamp=d,n.svg=V,n.svgOverlay=pd,n.tileLayer=Dl,n.tooltip=Ic,n.transformation=G,n.version=s,n.videoOverlay=fd;var Ga=window.L;n.noConflict=function(){return window.L=Ga,this},window.L=n}))})(Tr,Tr.exports)),Tr.exports}var g2=m2();const Xt=Qy(g2);(function(e,t,n){function s(o,i){for(;(o=o.parentElement)&&!o.classList.contains(i););return o}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(o,i){this._map=o,this._container=o._container,this._overlayPane=o._panes.overlayPane,this._popupPane=o._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(L.DomUtil.disableTextSelection(),o.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(o){L.setOptions(this,o)},_fireCreatedEvent:function(o){this._map.fire(L.Draw.Event.CREATED,{layer:o,layerType:this.type})},_cancelDrawing:function(o){o.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(o,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var o=this._markers.pop(),i=this._poly,l=i.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(o),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(c,!1)}},addVertex:function(o){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(o))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(o)),this._poly.addLatLng(o),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(o,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var o=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(o[o.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(o.originalEvent)},_vertexChanged:function(o,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(o,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(o){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(o),this._clickHandled=!0,this._disableNewMarkers();var i=o.originalEvent,l=i.clientX,c=i.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(o,i){this._mouseDownOrigin=L.point(o,i)},_onMouseUp:function(o){var i=o.originalEvent,l=i.clientX,c=i.clientY;this._endPoint.call(this,l,c,o),this._clickHandled=null},_endPoint:function(o,i,l){if(this._mouseDownOrigin){var c=L.point(o,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(o){var i,l,c=o.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,o),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(o){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=c.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_createMarker:function(o){var i=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(o){var i=this._markers?this._markers.length:0;i>0&&(o=o||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),o))},_updateTooltip:function(o){var i=this._getTooltipText();o&&this._tooltip.updatePosition(o),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(o,i){var l,c,d,h=Math.floor(Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=h>m?h-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)l=y/h,c={x:Math.floor(o.x*(1-l)+l*i.x),y:Math.floor(o.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(o){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=o},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var o,i,l=this.options.showLength;return this._markers.length===0?o={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",o=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),o},_updateRunningMeasure:function(o,i){var l,c,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),c=L.GeometryUtil.isVersion07x()?o.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(o,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(i?1:-1))},_getMeasurementString:function(){var o,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return o=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(o,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var o=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(o,i){L.Draw.Polyline.prototype.initialize.call(this,o,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var o=this._markers.length;o===1&&this._markers[0].on("click",this._finishShape,this),o>2&&(this._markers[o-1].on("dblclick",this._finishShape,this),o>3&&this._markers[o-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var o,i;return this._markers.length===0?o=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(o=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(o=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:o,subtext:i}},_getMeasurementString:function(){var o=this._area,i="";return o||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),o&&(i+="<br>"+L.GeometryUtil.readableArea(o,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(o,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,o,i)},_cleanUpShape:function(){var o=this._markers.length;o>0&&(this._markers[0].off("click",this._finishShape,this),o>2&&this._markers[o-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(o,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(o){this._isDrawing=!0,this._startLatLng=o.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(o.originalEvent)},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(o,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(o){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!s(o.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(o){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,o)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,o),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_getTooltipText:function(){var o,i,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(o),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(o){return new L.Marker(o,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(o){this._onMouseMove(o),this._onClick()},_fireCreatedEvent:function(){var o=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},_fireCreatedEvent:function(){var o=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)},_createMarker:function(o){return new L.CircleMarker(o,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(o,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},_drawShape:function(o){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(o);else var i=this._map.distance(this._startLatLng,o);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_onMouseMove:function(o){var i,l=o.latlng,c=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";c&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(o,i){this._marker=o,L.setOptions(this,i)},addHooks:function(){var o=this._marker;o.dragging.enable(),o.on("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},removeHooks:function(){var o=this._marker;o.dragging.disable(),o.off("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},_onDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var o=this._marker._icon;o&&(o.style.display="none",L.DomUtil.hasClass(o,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,-4)):(L.DomUtil.addClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,4)),o.style.display="")},_offsetMarker:function(o,i){var l=parseInt(o.style.marginTop,10)-i,c=parseInt(o.style.marginLeft,10)-i;o.style.marginTop=l+"px",o.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(o){this.latlngs=[o._latlngs],o._holes&&(this.latlngs=this.latlngs.concat(o._holes)),this._poly=o,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(o){for(var i=0;i<this._verticesHandlers.length;i++)o(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(o){o.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(o){o.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(o){o.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var o=0;o<this.latlngs.length;o++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[o],this._poly.options.poly))},_updateLatLngs:function(o){this.latlngs=[o.layer._latlngs],o.layer._holes&&(this.latlngs=this.latlngs.concat(o.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(o,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=o,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var o=this._poly,i=o._path;o instanceof L.Polygon||(o.options.fill=!1,o.options.editing&&(o.options.editing.fill=!1)),i&&o.options.editing&&o.options.editing.className&&(o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var o=this._poly,i=o._path;i&&o.options.editing&&o.options.editing.className&&(o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.original),o._map&&(o._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var o,i,l,c,d=this._defaultShape();for(o=0,l=d.length;o<l;o++)c=this._createMarker(d[o],o),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var h,f;for(o=0,i=l-1;o<l;i=o++)(o!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[o],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:this.options.icon});return l._origLatLng=o,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var o=this._defaultShape(),i=[].splice.apply(o,arguments);return this._poly._convertLatLngs(o,!0),this._poly.redraw(),i},_removeMarker:function(o){var i=o._index;this._markerGroup.removeLayer(o),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(o){var i=o.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,c),i.setLatLng(c);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(o){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=o.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(o){var i=o.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),c=o.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(o,i){this._markerGroup.eachLayer(function(l){l._index>o&&(l._index+=i)})},_createMiddleMarker:function(o,i){var l,c,d,h=this._getMiddleLatLng(o,i),f=this._createMarker(h);f.setOpacity(.6),o._middleRight=i._middleLeft=f,c=function(){f.off("touchmove",c,this);var m=i._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,h),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),i._index++,this._updatePrevNext(o,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",c,this),f.off("dragend",d,this),f.off("touchmove",c,this),this._createMiddleMarker(o,f),this._createMiddleMarker(f,i)},l=function(){c.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",c,this).on("dragend",d,this).on("touchmove",c,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(o,i){o&&(o._next=i),i&&(i._prev=o)},_getMiddleLatLng:function(o,i){var l=this._poly._map,c=l.project(o.getLatLng()),d=l.project(i.getLatLng());return l.unproject(c._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(o,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=o,L.Util.setOptions(this,i)},addHooks:function(){var o=this._shape;this._shape._map&&(this._map=this._shape._map,o.setStyle(o.options.editing),o._map&&(this._map=o._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var o=this._shape;if(o.setStyle(o.options.original),o._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(o){o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(o){o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(o){o.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(o){var i=o.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(o){o.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(o){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o),typeof this._getCorners=="function"){var i=this._getCorners(),l=o.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return o.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(o){o.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds(),i=o.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var o=this._getCorners();this._resizeMarkers=[];for(var i=0,l=o.length;i<l;i++)this._resizeMarkers.push(this._createMarker(o[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(o){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o);var i=this._getCorners(),l=o.target,c=l._cornerIndex;this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(o){var i,l,c=o.target;c===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,o)},_move:function(o){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),d=c.getCenter(),h=[],f=0,m=l.length;f<m;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([o.lat+i[0],o.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(o){var i;this._shape.setBounds(L.latLngBounds(o,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var o=this._shape.getBounds();return[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()]},_toggleCornerMarkers:function(o){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(o)},_repositionCornerMarkers:function(){for(var o=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(o[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getLatLng();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(o){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(o);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(o),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var o=this._shape.getLatLng(),i=this._getResizeMarkerPoint(o);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(o){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(o);return this._map.unproject([l.x+i,l.y-i])},_resize:function(o){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(o):radius=this._map.distance(i,o),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(o,i){var l={};if(o.touches!==void 0){if(!o.touches.length)return;l=o.touches[0]}else if(o.pointerType!=="touch"||(l=o,!this._filterClick(o)))return;var c=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:o})},_filterClick:function(o){var i=o.timeStamp||o.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||o.target._simulatedClick&&!o._simulated?(L.DomEvent.stop(o),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(o){this._map._loaded&&this._touchEvent(o,"touchstart")},_onTouchEnd:function(o){this._map._loaded&&this._touchEvent(o,"touchend")},_onTouchCancel:function(o){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(o,i)}},_onTouchLeave:function(o){this._map._loaded&&this._touchEvent(o,"touchleave")},_onTouchMove:function(o){this._map._loaded&&this._touchEvent(o,"touchmove")},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var o=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(o,"leaflet-clickable"),L.DomEvent.on(o,"click",this._onMouseClick,this),L.DomEvent.on(o,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(o,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(o){for(var i=[],l=0,c=o.length;l<c;l++)Array.isArray(o[l])?i.push(L.LatLngUtil.cloneLatLngs(o[l])):i.push(this.cloneLatLng(o[l]));return i},cloneLatLng:function(o){return L.latLng(o.lat,o.lng)}},(function(){var o={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,c,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=i[m],c=i[(m+1)%d],h+=(c.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(c.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var c=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,m=h&&h.decimal;if(f||m){var y=c.split(".");c=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(c=c+m+y[1])}return c},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},o,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,c,d,m){var f,m=L.Util.extend({},o,m);switch(l?typeof l=="string"?l:"metric":c?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(i,m.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,m.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,m.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(i,m.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(o,i,l,c){return this._checkCounterclockwise(o,l,c)!==this._checkCounterclockwise(i,l,c)&&this._checkCounterclockwise(o,i,l)!==this._checkCounterclockwise(o,i,c)},_checkCounterclockwise:function(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}}),L.Polyline.include({intersects:function(){var o,i,l,c=this._getProjectedPoints(),d=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(o=d-1;o>=3;o--)if(i=c[o-1],l=c[o],this._lineSegmentsIntersectsRange(i,l,o-2))return!0;return!1},newLatLngIntersects:function(o,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(o),i)},newPointIntersects:function(o,i){var l=this._getProjectedPoints(),c=l?l.length:0,d=l?l[c-1]:null,h=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,o,h,i?1:0)},_tooFewPointsForIntersection:function(o){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=o||0,!i||l<=3},_lineSegmentsIntersectsRange:function(o,i,l,c){var d,h,f=this._getProjectedPoints();c=c||0;for(var m=l;m>c;m--)if(d=f[m-1],h=f[m],L.LineUtil.segmentsIntersect(o,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var o=[],i=this._defaultShape(),l=0;l<i.length;l++)o.push(this._map.latLngToLayerPoint(i[l]));return o}}),L.Polygon.include({intersects:function(){var o,i,l,c,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(o=d.length,i=d[0],l=d[o-1],c=o-2,this._lineSegmentsIntersectsRange(l,i,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(o){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,o);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(o){var i,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(o))&&(c||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(i));return l},onRemove:function(){for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&this._toolbars[o].removeToolbar()},setDrawingOptions:function(o){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(o)},_toolbarEnabled:function(o){var i=o.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(o){L.setOptions(this,o),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(o){var i,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,d=this._toolbarClass||"",h=this.getModeHandlers(o);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=o,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,c++,d,h[i].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var o in this._modes)this._modes.hasOwnProperty(o)&&(this._disposeButton(this._modes[o].button,this._modes[o].handler.enable,this._modes[o].handler),this._modes[o].handler.disable(),this._modes[o].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(o,i,l,c,d){var h=o.type;this._modes[h]={},this._modes[h].handler=o,this._modes[h].button=this._createButton({type:h,title:d,className:c+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(o){var i=L.DomUtil.create("a",o.className||"",o.container),l=L.DomUtil.create("span","sr-only",o.container);i.href="#",i.appendChild(l),o.title&&(i.title=o.title,l.innerHTML=o.title),o.text&&(i.innerHTML=o.text,l.innerHTML=o.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,c,o.callback,o.context),i},_disposeButton:function(o,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(o,"click",L.DomEvent.stopPropagation).off(o,"mousedown",L.DomEvent.stopPropagation).off(o,"dblclick",L.DomEvent.stopPropagation).off(o,"touchstart",L.DomEvent.stopPropagation).off(o,"click",L.DomEvent.preventDefault).off(o,l,i)},_handlerActivated:function(o){this.disable(),this._activeMode=this._modes[o.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(o){var i,l,c,d,h=this._actionsContainer,f=this.getActions(o),m=f.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var o=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",o===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),o===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(o){this._map=o,this._popupPane=o._panes.popupPane,this._visible=!1,this._container=o.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(o){return this._container?(o.subtext=o.subtext||"",o.subtext.length!==0||this._singleLineLabel?o.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(o.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+o.subtext+"</span><br />":"")+"<span>"+o.text+"</span>",o.text||o.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(o){var i=this._map.latLngToLayerPoint(o),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(o){for(var i in this.options)this.options.hasOwnProperty(i)&&o[i]&&(o[i]=L.extend({},this.options[i],o[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,o)},getModeHandlers:function(o){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(o,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(o,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(o,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(o,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(o,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(o,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(o){return[{enabled:o.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:o.completeShape,context:o},{enabled:o.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:o.deleteLastVertex,context:o},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(o){L.setOptions(this,o);for(var i in this._modes)this._modes.hasOwnProperty(i)&&o.hasOwnProperty(i)&&this._modes[i].handler.setOptions(o[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(o){o.edit&&(o.edit.selectedPathOptions===void 0&&(o.edit.selectedPathOptions=this.options.edit.selectedPathOptions),o.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,o.edit.selectedPathOptions)),o.remove&&(o.remove=L.extend({},this.options.remove,o.remove)),o.poly&&(o.poly=L.extend({},this.options.poly,o.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,o),this._selectedFeatureCount=0},getModeHandlers:function(o){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(o,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(o,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(o){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return o.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(o){var i=L.Toolbar.prototype.addToolbar.call(this,o);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var o,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(o=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(o=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),o._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(o){this._revertLayer(o)},this)},save:function(){var o=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(o.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:o})},_backupLayer:function(o){var i=L.Util.stamp(o);this._uneditedLayerProps[i]||(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(o.getLatLngs())}:o instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng()),radius:o.getRadius()}:(o instanceof L.Marker||o instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(o){var i=L.Util.stamp(o);o.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?o.setLatLngs(this._uneditedLayerProps[i].latlngs):o instanceof L.Circle?(o.setLatLng(this._uneditedLayerProps[i].latlng),o.setRadius(this._uneditedLayerProps[i].radius)):(o instanceof L.Marker||o instanceof L.CircleMarker)&&o.setLatLng(this._uneditedLayerProps[i].latlng),o.fire("revert-edited",{layer:o}))},_enableLayerEdit:function(o){var i,l,c=o.layer||o.target||o;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=c.options.color,i.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=i),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(o){var i=o.layer||o.target||o;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_onMarkerDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(o){var i=o.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(l);o.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(o){this._deletableLayers.addLayer(o),o.fire("revert-deleted",{layer:o})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(o){this._removeLayer({layer:o})},this),this.save()},_enableLayerDelete:function(o){(o.layer||o.target||o).on("click",this._removeLayer,this)},_disableLayerDelete:function(o){var i=o.layer||o.target||o;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(o){var i=o.layer||o.target||o;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const e1=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Lv=e=>e.length*6+12,zd=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),y2=(e,t)=>{if(!e||t.length===0)return new Set;const n=[],s=e.getBounds();t.forEach(l=>{if(s.contains(l.getLatLng())){const c=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&n.push({marker:l,pixelPos:c,location:d})}});const o=n.map(({marker:l,pixelPos:c,location:d})=>{const m=Lv(d.name),y=d.description?Lv(`${d.name}: ${e1(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:c.x-15,right:c.x+15,top:c.y-15,bottom:c.y+15},baseLabelBox:{left:c.x-m/2,right:c.x+m/2,top:c.y+15+2,bottom:c.y+15+2+20},descLabelBox:d.description?{left:c.x-y/2,right:c.x+y/2,top:c.y+15+2,bottom:c.y+15+2+20}:null}}),i=new Set;return o.forEach(({marker:l,location:c,markerBox:d,baseLabelBox:h,descLabelBox:f},m)=>{if(!c.description)return;let y=!1;for(let k=0;k<o.length;k++){if(m===k)continue;const b=o[k];if(zd(f,b.markerBox)||zd(f,b.baseLabelBox)){y=!0;break}if(b.descLabelBox&&i.has(b.location.id)&&zd(f,b.descLabelBox)){y=!0;break}}y||i.add(c.id)}),i},Uc=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],k2=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Su=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function el(e){return Su.find(t=>t.value===e)||Su[0]}function b2(e){return el(e).defaultColor||"#667eea"}function w2(e,t){return t||b2(e)}const Kh={dot:(e,t=32)=>{const n=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const n=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const n=t/2,s=4,o=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s} ${l},${o} ${i},${o}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s-o} ${n+o},${s} ${n},${s+o} ${n-o},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-3,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${n+o*Math.cos(d)},${s+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${n+i*Math.cos(h)},${s+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<6;l++){const c=Math.PI/6+l*Math.PI/3;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<5;l++){const c=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Sv={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},jl={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=13,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${16+o*Math.cos(d)},${16+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Iv={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function zn({type:e,backgroundShape:t="circle",backgroundColor:n,borderColor:s,iconColor:o,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(n||s||o||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const c=el(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(c.isShapeOnly){const m=n||c.defaultColor||"#667eea",y=s||"#fff";if(jl[e])f=jl[e]({backgroundColor:m,borderColor:y});else return Kh[e]?.(m,h)||null}else{const m=n||"#667eea",y=s||"#fff",k=o||"#fff",b=t||"circle";b!=="none"&&jl[b]&&(f+=jl[b]({backgroundColor:m,borderColor:y})),Iv[e]&&(f+=Iv[e](k,m))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const _2={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function C2(e,t){return e===0?"missing":e>=t?"full":"partial"}function Yh(e,t){const n=C2(e,t);return _2[n]}function L2(e,t,n=32){if(e==="default")return null;if(Sv[e])return Sv[e](n);if(Kh[e]){const s=t||"#667eea";return Kh[e](s,n)}return null}const S2=["circle","square","hexagon","pentagon"];function I2(e){return S2.includes(e)}function x2(e,t,n,s,o=32,i=!0){const l=L2(e,t,o),c=Yh(n,s);if(!l)return null;const d=i&&I2(e),h=w2(e,t),f=T2(h),m=t1(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=o>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${n}/${s}</div>
  `:"";return`
    <div style="position: relative; width: ${o}px; height: ${o}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${c}
      </div>
    </div>
  `}function $2(e){const t=e.replace("#",""),n=parseInt(t.substr(0,2),16)/255,s=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function t1(e){return!e||e.length<6?!1:$2(e)>.4}function T2(e){return t1(e)?"#1F2937":"#FFFFFF"}const M2={class:"map-container-wrapper"},A2="#667eea",E2={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null);let l=null;const c=D([]),d=D([]),h=D([]);let f=null,m=null;const y=D([]);let k=null,b=null,I=!1;const T=D(!1),E=()=>{if(l){const Oe=l.getCenter();return{lat:Oe.lat,lng:Oe.lng}}return null},x=()=>l?l.getZoom():null,C=()=>{if(c.value.length>0){h.value.push([...c.value]);const Oe=d.value.pop()||[];c.value=Oe,Ce(),o("polygon-drawing",c.value)}},_=()=>{if(h.value.length>0){d.value.push([...c.value]);const Oe=h.value.pop();c.value=Oe,Ce(),o("polygon-drawing",c.value)}},$=()=>c.value.length>0,R=()=>h.value.length>0,M=()=>c.value.length,O=()=>{c.value.length>=3&&(o("polygon-complete",[...c.value]),A())},A=()=>{c.value=[],d.value=[],h.value=[],Ce()},U=()=>{!l||!s.userLocation||(l.setView([s.userLocation.lat,s.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),T.value=!0)},F=(Oe,$e,me=null)=>{if(!l||Oe==null||$e==null)return;l.setView([Oe,$e],me??l.getZoom(),{animate:!0,duration:.5});const Ze=s.center&&Math.abs(s.center.lat-Oe)<1e-4&&Math.abs(s.center.lng-$e)<1e-4;T.value=!Ze},j=D(!0),Z=D(!0),X=(Oe,$e)=>{if(!l||Oe==null||$e==null)return!0;const me=l.getBounds(),Ze=Xt.latLng(Oe,$e);return me.contains(Ze)};t({getMapCenter:E,getMapZoom:x,undoPolygonPoint:C,redoPolygonPoint:_,canUndo:$,canRedo:R,getPolygonPointCount:M,completePolygon:O,clearPolygonDrawing:A,recenterOnUserLocation:U,recenterOnLocation:F,isLocationInView:X,userLocationInView:Z,highlightedLocationInView:j});const re=D([]);let K=null;const ae=D(!0),q=D(!1),Y=D(new Set),te=D([]);let ue=null,_e=null;const Te=z(()=>s.hideRecenterButton||!s.highlightLocationId||!T.value?!1:!j.value),Pe=D({}),De=()=>{const Oe={};if(s.highlightLocationId){const $e=s.locations.find(me=>me.id===s.highlightLocationId);if($e?.latitude&&$e?.longitude){const me=X($e.latitude,$e.longitude);j.value=me,Oe[s.highlightLocationId]=me,Pe.value=Oe;return}}if(s.highlightLocationIds&&s.highlightLocationIds.length>0){let $e=!0;for(const me of s.highlightLocationIds){const Ze=s.locations.find(Ge=>Ge.id===me);if(Ze?.latitude&&Ze?.longitude){const Ge=X(Ze.latitude,Ze.longitude);Oe[me]=Ge,Ge||($e=!1)}else Oe[me]=!0}j.value=$e,Pe.value=Oe;return}if(!l){j.value=!0,Pe.value={};return}j.value=!0,Pe.value={}},ke=()=>{if(!l||!s.userLocation){Z.value=!0;return}Z.value=X(s.userLocation.lat,s.userLocation.lng)},H=()=>{De(),ke(),o("visibility-change",{userLocationInView:Z.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:Pe.value})},J=()=>{if(!l||!s.highlightLocationId)return;const Oe=s.locations.find($e=>$e.id===s.highlightLocationId);!Oe||!Oe.latitude||!Oe.longitude||(l.setView([Oe.latitude,Oe.longitude],l.getZoom(),{animate:!0,duration:.5}),T.value=!1,j.value=!0)},de=(Oe,$e,me,Ze,Ge=!1)=>{const fe=me?"36px":Ze?"20px":"30px",be=me?"#667eea":"white",ne=Ge?"":Yh(Oe,$e);return`
    <div style="position: relative; width: ${fe}; height: ${fe};">
      <div style="
        background-color: ${A2};
        width: ${fe};
        height: ${fe};
        border-radius: 50%;
        border: 3px solid ${be};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${Ge?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ne}
      </div>`}
    </div>
  `},ie=()=>{if(!l)return;const Oe=y2(l,re.value),$e=Array.from(Y.value).sort().join(","),me=Array.from(Oe).sort().join(",");$e!==me&&(Y.value=Oe,Ne())},Re=()=>{if(_e&&(_e.remove(),_e=null),!l||!s.userLocation)return;const Oe=Xt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});_e=Xt.marker([s.userLocation.lat,s.userLocation.lng],{icon:Oe}).addTo(l).bindPopup("Your location")},G=()=>{if(!i.value)return;let Oe=51.505,$e=-.09,me=13;const Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,Ge=(be,ne)=>be!=null&&ne!=null&&!(be===0&&ne===0),fe=[];Ze.length>0&&fe.push(...Ze.filter(be=>Ge(be.latitude,be.longitude)).map(be=>({lat:be.latitude,lng:be.longitude}))),s.route&&s.route.length>0&&fe.push(...s.route.filter(be=>Ge(be.lat,be.lng)).map(be=>({lat:be.lat,lng:be.lng}))),s.center?(Oe=s.center.lat,$e=s.center.lng,me=s.zoom??13):fe.length>0&&(Oe=fe.reduce((be,ne)=>be+ne.lat,0)/fe.length,$e=fe.reduce((be,ne)=>be+ne.lng,0)/fe.length,me=10),l=Xt.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([Oe,$e],me),Xt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),s.clickable&&l.on("click",be=>{s.drawingMode||o("map-click",{lat:be.latlng.lat,lng:be.latlng.lng})}),l.on("zoomstart",()=>{ge=!0}),l.on("zoomend moveend",()=>{ge=!1,oe?Ne():ie(),H()}),l.on("dragstart",()=>{T.value=!0}),Ne(),Q(),ee(),Re(),Ae(),ze(),l.whenReady(()=>{H()})},Q=()=>{if(K&&(K.remove(),K=null),!l||s.route.length===0)return;const Oe=s.route.map(fe=>[fe.lat,fe.lng]),$e=s.routeColor||"#3388ff",me=s.routeWeight||4;let Ze=null,Ge="butt";switch(s.routeStyle){case"dash":Ze="10, 10";break;case"dash-long":Ze="20, 12";break;case"dash-short":Ze="6, 6";break;case"dash-dense":Ze="6, 3";break;case"dot":Ze="2, 8",Ge="round";break;case"dot-sparse":Ze="2, 14",Ge="round";break;case"dot-dense":Ze="2, 2",Ge="round";break;case"dash-dot":Ze="16, 8, 4, 8";break;case"dash-dot-dot":Ze="16, 6, 4, 6, 4, 6";break;case"long-short":Ze="16, 4, 6, 4";break;case"double-dash":Ze="8, 3, 8, 8";break}K=Xt.polyline(Oe,{color:$e,weight:me,opacity:.7,dashArray:Ze,lineCap:Ge}).addTo(l)},ee=()=>{te.value.forEach(Oe=>Oe.remove()),te.value=[],!(!l||s.areas.length===0)&&s.areas.forEach(Oe=>{const $e=typeof Oe.polygon=="string"?JSON.parse(Oe.polygon):Oe.polygon;if(!$e||$e.length===0)return;const me=$e.map(be=>[be.lat,be.lng]),Ze=Oe.id===s.selectedAreaId,Ge=Oe.color||"#667eea",fe=Xt.polygon(me,{color:Ge,fillColor:Ge,fillOpacity:Ze?.4:.2,weight:Ze?3:2,opacity:.8}).addTo(l);fe.setStyle({pane:"overlayPane"}),s.drawingMode||(fe.on("click",()=>o("area-click",Oe)),fe.on("mouseover",()=>{fe.setStyle({fillOpacity:.4})}),fe.on("mouseout",()=>{fe.setStyle({fillOpacity:Ze?.4:.2})})),te.value.push(fe)})},Ce=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),c.value.length!==0&&(m=Xt.layerGroup().addTo(l),c.value.forEach((Oe,$e)=>{const me=$e===0,Ze=$e===c.value.length-1,Ge=Xt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${me?"16px":"12px"};
        height: ${me?"16px":"12px"};
        background-color: ${me?"#667eea":Ze?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[me?16:12,me?16:12],iconAnchor:[me?8:6,me?8:6]});Xt.marker([Oe.lat,Oe.lng],{icon:Ge,interactive:!1}).addTo(m)}),c.value.length>=2))){const Oe=c.value.map($e=>[$e.lat,$e.lng]);c.value.length>=3&&Oe.push(Oe[0]),f=Xt.polyline(Oe,{color:"#667eea",weight:3,opacity:.8,dashArray:c.value.length<3?"10, 10":null}).addTo(l)}},Be=()=>{if(!l||(k&&(k.remove(),k=null),b&&(b.remove(),b=null),y.value.length===0))return;const Oe=y.value.map(me=>[me.lat,me.lng]);k=Xt.polygon(Oe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),b=Xt.layerGroup({pane:"markerPane"}).addTo(l);const $e=me=>{y.value.length<=3||(y.value.splice(me,1),I=!0,o("polygon-update",[...y.value]),Be())};y.value.forEach((me,Ze)=>{const Ge=y.value.length>3,fe=Xt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),be=Xt.marker([me.lat,me.lng],{icon:fe,draggable:!0}).addTo(b);if(be.on("drag",ne=>{const ye=ne.target.getLatLng();y.value[Ze]={lat:ye.lat,lng:ye.lng};const He=y.value.map(rt=>[rt.lat,rt.lng]);k.setLatLngs(He)}),be.on("dragend",()=>{I=!0,o("polygon-update",[...y.value])}),be.on("contextmenu",ne=>{Xt.DomEvent.preventDefault(ne),Ge&&$e(Ze)}),Ge){const ne=document.createElement("div"),ye=document.createElement("button");ye.textContent="Delete point",ye.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const He=rt=>{rt.preventDefault(),rt.stopPropagation(),be.closePopup(),$e(Ze)};ye.addEventListener("click",He),ye.addEventListener("touchend",He),ne.appendChild(ye),be.bindPopup(ne,{closeButton:!1,className:"vertex-popup"})}})},ze=(Oe=!0)=>{if(l){if(!s.editingPolygon||s.editingPolygon.length===0){k&&(k.remove(),k=null),b&&(b.remove(),b=null),y.value=[];return}if(y.value=s.editingPolygon.map($e=>({lat:$e.lat,lng:$e.lng})),Be(),Oe&&y.value.length>=3){const $e=Xt.latLngBounds(y.value.map(me=>[me.lat,me.lng]));l.fitBounds($e,{padding:[50,50]})}}},Ae=()=>{if(!l)return;if(ue||(ue=new Xt.FeatureGroup,l.addLayer(ue)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!s.drawingMode){A(),ue&&ue.clearLayers();return}let Oe=0,$e=null,me=!1,Ze=!1;const Ge=300,fe=15,be=kt=>{d.value.push([...c.value]),h.value=[],c.value.push({lat:kt.lat,lng:kt.lng}),Ce(),o("polygon-drawing",c.value)},ne=kt=>{kt.originalEvent&&kt.originalEvent.sourceCapabilities?.firesTouchEvents||be(kt.latlng)},ye=kt=>{if(kt.touches.length>1){Ze=!0;return}Ze=!1,Oe=Date.now(),$e={x:kt.touches[0].clientX,y:kt.touches[0].clientY},me=!1},He=kt=>{if(!$e||Ze)return;const Ot=kt.touches[0].clientX-$e.x,Lt=kt.touches[0].clientY-$e.y;Math.sqrt(Ot*Ot+Lt*Lt)>fe&&(me=!0)},rt=kt=>{if(Ze){Ze=!1,$e=null;return}if(Date.now()-Oe<Ge&&!me&&$e){const Lt=kt.changedTouches[0],xt=Xt.point(Lt.clientX-l.getContainer().getBoundingClientRect().left,Lt.clientY-l.getContainer().getBoundingClientRect().top),Kt=l.containerPointToLatLng(xt);kt.preventDefault(),kt.stopPropagation(),be(Kt)}$e=null,me=!1};l.on("click",ne),l.getContainer().addEventListener("touchstart",ye,{passive:!0}),l.getContainer().addEventListener("touchmove",He,{passive:!0}),l.getContainer().addEventListener("touchend",rt,{passive:!1}),l._customDrawingHandlers={handleClick:ne,handleTouchStart:ye,handleTouchMove:He,handleTouchEnd:rt},Ce()};let oe=!1,ge=!1;const Ne=()=>{if(l&&(l._animatingZoom||ge)){oe=!0;return}if(oe=!1,re.value.forEach(me=>{me._map&&(me.off(),me.remove())}),re.value=[],!l)return;const Oe=i.value?.clientWidth||400,$e=Math.floor(Oe*.75);if(s.locations.forEach(me=>{const Ze=me.latitude??me.Latitude,Ge=me.longitude??me.Longitude;if(Ze==null||Ge==null||Ze===0&&Ge===0)return;const fe=me.checkedInCount||0,be=me.requiredMarshals||1,ne=s.highlightLocationId===me.id||s.highlightLocationIds.includes(me.id),ye=me.isDynamic||me.IsDynamic,He=s.simplifyNonHighlighted&&!ne&&!ye,rt=me.resolvedStyleType||me.ResolvedStyleType,kt=me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor,Ot=me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor,Lt=me.resolvedStyleIconColor||me.ResolvedStyleIconColor,xt=me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape,Kt=rt&&rt!=="default"||kt||Ot||Lt||xt&&xt!=="circle"&&xt!=="default",no=me.resolvedStyleMapRotation??me.ResolvedStyleMapRotation??me.styleMapRotation??me.StyleMapRotation??0,Mo=parseInt(no,10)||0,ft=me.areaColor||"#999",Ct=me.areaId&&!s.marshalMode,Mn=Y.value.has(me.id)&&me.description?`${me.name}: ${e1(me.description,50)}`:me.name,go=ne?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",oo=ne?"#667eea":He?"#e0e0e0":"white",An=ne?"white":He?"#888":"#333";let tn;if(He){const Qe="20px";tn=`
        <div style="
          background-color: #999;
          width: ${Qe};
          height: ${Qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Ps=!s.marshalMode,yo=Yh(fe,be),Uo=Ps?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${fe}/${be}</div>`:"";if(!He&&Kt){const Qe=ne?40:32,Nt=me.resolvedStyleSize||me.ResolvedStyleSize||"100",on=zn({type:me.resolvedStyleType||me.ResolvedStyleType,backgroundShape:me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape||"circle",backgroundColor:me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor||"",borderColor:me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor||"",iconColor:me.resolvedStyleIconColor||me.ResolvedStyleIconColor||"",size:Nt});on?tn=on:tn=x2(me.resolvedStyleType,me.resolvedStyleColor,fe,be,Qe,Ps)||de(fe,be,ne,s.marshalMode,!0)}else He||(tn=de(fe,be,ne,s.marshalMode,!0));const pe=Mo!==0?`transform: rotate(${Mo}deg);`:"",ve=Xt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${go}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Ct?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ft};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${pe}">
                ${tn}
              </div>
              ${He||s.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${yo}
              </div>`}
              ${He?"":Uo}
            </div>
          </div>
          <div style="
            background-color: ${oo};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ne?"12px":"11px"};
            font-weight: bold;
            color: ${An};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${$e}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${Mn}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Ie=s.marshalMode?`<b>${me.name}</b>${me.description?`<br>${me.description}`:""}`:`<b>${me.name}</b><br>${me.description||""}<br>Checked in: ${fe}/${be}`,lt=Xt.marker([me.latitude,me.longitude],{icon:ve}).addTo(l).bindPopup(Ie);lt.on("click",()=>{o("location-click",me)}),lt.locationData=me,re.value.push(lt)}),l&&ae.value&&!s.center&&!q.value){const me=[],Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,Ge=(fe,be)=>fe!=null&&be!=null&&!(fe===0&&be===0);if(Ze.length>0&&me.push(...Ze.filter(fe=>Ge(fe.latitude,fe.longitude)).map(fe=>[fe.latitude,fe.longitude])),s.route.length>0&&me.push(...s.route.filter(fe=>Ge(fe.lat,fe.lng)).map(fe=>[fe.lat,fe.lng])),me.length>0){const fe=Xt.latLngBounds(me);l.fitBounds(fe,{padding:[50,50]}),ae.value=!1,q.value=!0}}else s.center&&(ae.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&ie()},100)};return un(()=>{q.value=!1,ae.value=!0,G();let Oe,$e=0,me=0;const Ze=new ResizeObserver(Ge=>{if(l&&Ge.length>0){const{width:fe,height:be}=Ge[0].contentRect;(Math.abs(fe-$e)>10||Math.abs(be-me)>10)&&($e=fe,me=be,clearTimeout(Oe),Oe=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&Ze.observe(i.value),Ln(()=>{clearTimeout(Oe),Ze.disconnect()})}),Ye(()=>s.locations,Oe=>{if(Ne(),l&&!q.value&&Oe.length>0&&!s.center){const $e=Oe.map(fe=>fe.latitude),me=Oe.map(fe=>fe.longitude),Ze=$e.reduce((fe,be)=>fe+be,0)/$e.length,Ge=me.reduce((fe,be)=>fe+be,0)/me.length;l.setView([Ze,Ge],10),q.value=!0,ae.value=!1}l&&setTimeout(()=>H(),50)},{deep:!0}),Ye(()=>s.route,Oe=>{if(Q(),Ne(),l&&!q.value&&Oe&&Oe.length>0&&!s.center){const $e=Oe.map(fe=>fe.lat),me=Oe.map(fe=>fe.lng),Ze=$e.reduce((fe,be)=>fe+be,0)/$e.length,Ge=me.reduce((fe,be)=>fe+be,0)/me.length;l.setView([Ze,Ge],10),q.value=!0,ae.value=!1}},{deep:!0}),Ye(()=>[s.routeColor,s.routeStyle,s.routeWeight],()=>{Q()}),Ye(()=>s.center,(Oe,$e)=>{l&&!T.value&&(!$e||Math.abs(Oe.lat-$e.lat)>1e-6||Math.abs(Oe.lng-$e.lng)>1e-6)&&l.setView([Oe.lat,Oe.lng],s.zoom)}),Ye(()=>s.areas,()=>{ee()},{deep:!0}),Ye(()=>s.selectedAreaId,()=>{ee()}),Ye(()=>s.drawingMode,()=>{Ae()}),Ye(()=>s.editingPolygon,()=>{if(I){I=!1;return}ze()},{deep:!0}),Ye(()=>s.userLocation,()=>{Re()},{deep:!0}),Ye(()=>s.highlightLocationId,()=>{Ne()}),Ye(()=>s.highlightLocationIds,()=>{Ne(),l&&setTimeout(()=>H(),50)},{deep:!0}),Ye(()=>s.marshalMode,()=>{Ne()}),Ye(()=>s.simplifyNonHighlighted,()=>{Ne()}),Ye(()=>s.clickable,Oe=>{l&&(l.off("click"),Oe&&l.on("click",$e=>{s.drawingMode||o("map-click",{lat:$e.latlng.lat,lng:$e.latlng.lng})}))}),(Oe,$e)=>(p(),g("div",M2,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),Te.value?(p(),g("button",{key:0,class:"recenter-btn",onClick:J,title:"Recenter on checkpoint"},[...$e[0]||($e[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):P("",!0)]))}},Jh=Ke(E2,[["__scopeId","data-v-59e540e9"]]);function es(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const P2={class:"areas-selection"},D2={key:0,class:"areas-selection-header"},R2={class:"areas-list"},O2=["checked","onChange"],N2={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>[...n.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:es(d.name,h.name))),i=z(()=>n.areas.length>0&&n.selectedAreaIds.length===n.areas.length),l=d=>{const h=[...n.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),s("update:selectedAreaIds",h)},c=()=>{i.value?s("update:selectedAreaIds",[]):s("update:selectedAreaIds",n.areas.map(d=>d.id))};return(d,h)=>(p(),g("div",P2,[e.areas.length>1?(p(),g("div",D2,[r("button",{onClick:c,class:"toggle-all-btn"},w(i.value?"Deselect all":"Select all"),1)])):P("",!0),r("div",R2,[(p(!0),g(Se,null,je(o.value,f=>(p(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,O2),r("span",{class:"area-color-dot",style:tt({backgroundColor:f.color||"#667eea"})},null,4),Je(" "+w(f.name),1)]))),128))])]))}},B2=Ke(N2,[["__scopeId","data-v-ba19009b"]]),F2={key:1,class:"toolbar-btn-wrapper filters-wrapper"},U2={key:1,class:"dropdown-content filters-dropdown"},z2={class:"filters-header"},H2={class:"filter-section"},V2={class:"filter-checkbox"},G2=["checked"],q2={key:0,class:"filter-checkbox"},j2=["checked"],W2={class:"filter-section"},Z2={class:"filter-checkbox"},K2=["checked"],Y2={class:"filter-checkbox"},J2=["checked"],X2={class:"filter-checkbox"},Q2=["checked"],eL={key:0,class:"filter-section"},tL=["onClick","title"],nL={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},oL={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},sL=["innerHTML"],aL={key:0,class:"dropdown-content action-dropdown"},iL=["onClick"],lL={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:n}){const{terms:s}=ht(),o=e,i=n,l=D(!1),c=D(null),d=z(()=>c.value!==null),h=()=>{l.value=!l.value,l.value&&(c.value=null)},f=(b,I)=>{i("filter-change",{...o.filters,[b]:I})},m=b=>{b.items&&b.items.length>0?c.value===b.id?c.value=null:(c.value=b.id,l.value=!1):i("action-click",{actionId:b.id})},y=(b,I)=>{c.value=null,i("action-click",{actionId:b,itemId:I})};return t({closeDropdowns:()=>{l.value=!1,c.value=null}}),(b,I)=>(p(),g("div",{class:le(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(p(),g("button",{key:0,class:"toolbar-btn",onClick:I[0]||(I[0]=T=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...I[9]||(I[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(p(),g("div",F2,[l.value?(p(),g("div",{key:0,class:"mobile-backdrop",onClick:I[1]||(I[1]=T=>l.value=!1)})):P("",!0),r("button",{class:le(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...I[10]||(I[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(p(),g("div",U2,[r("div",z2,[I[12]||(I[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:I[2]||(I[2]=T=>l.value=!1),title:"Close"},[...I[11]||(I[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",H2,[I[13]||(I[13]=r("h4",null,"Display",-1)),r("label",V2,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:I[3]||(I[3]=T=>f("showRoute",T.target.checked))},null,40,G2),r("span",null,w(B(s).course)+" line",1)]),e.areas.length>0?(p(),g("label",q2,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:I[4]||(I[4]=T=>f("showAreaOverlays",T.target.checked))},null,40,j2),r("span",null,w(B(s).area)+" overlays",1)])):P("",!0)]),r("div",W2,[r("h4",null,w(B(s).checkpoints),1),r("label",Z2,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:I[5]||(I[5]=T=>f("showUncheckedIn",T.target.checked))},null,40,K2),I[14]||(I[14]=r("span",{class:"status-indicator unchecked"},null,-1)),I[15]||(I[15]=r("span",null,"Unchecked-in",-1))]),r("label",Y2,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:I[6]||(I[6]=T=>f("showPartiallyCheckedIn",T.target.checked))},null,40,J2),I[16]||(I[16]=r("span",{class:"status-indicator partial"},null,-1)),I[17]||(I[17]=r("span",null,"Partially checked-in",-1))]),r("label",X2,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:I[7]||(I[7]=T=>f("showFullyCheckedIn",T.target.checked))},null,40,Q2),I[18]||(I[18]=r("span",{class:"status-indicator full"},null,-1)),I[19]||(I[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(p(),g("div",eL,[r("h4",null,w(B(s).areas),1),Ee(B2,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":I[8]||(I[8]=T=>f("selectedAreaIds",T))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(p(!0),g(Se,null,je(e.actions,T=>(p(),g("div",{key:T.id,class:le(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:le(["toolbar-btn",{active:c.value===T.id}]),onClick:E=>m(T),title:T.label||T.id},[T.icon==="plus"?(p(),g("svg",nL,[...I[20]||(I[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):T.icon==="edit"?(p(),g("svg",oL,[...I[21]||(I[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):T.icon==="custom"?(p(),g("span",{key:2,innerHTML:T.customIcon},null,8,sL)):P("",!0)],10,tL),T.items&&c.value===T.id?(p(),g("div",aL,[(p(!0),g(Se,null,je(T.items,E=>(p(),g("button",{key:E.id,onClick:x=>y(T.id,E.id),class:"dropdown-item"},w(E.label),9,iL))),128))])):P("",!0)],2))),128))],2))}},xv=Ke(lL,[["__scopeId","data-v-adedd545"]]),rL={key:0,class:"drawing-controls"},cL={class:"point-count"},uL={class:"undo-redo-buttons"},dL=["disabled"],hL=["disabled"],fL={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>n.show&&n.pointCount>0),i=l=>{if(!o.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),n.canUndo&&s("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),n.canRedo&&s("redo"))};return un(()=>{document.addEventListener("keydown",i)}),Ln(()=>{document.removeEventListener("keydown",i)}),(l,c)=>o.value?(p(),g("div",rL,[r("div",cL,w(e.pointCount)+" point"+w(e.pointCount!==1?"s":""),1),r("div",uL,[r("button",{onClick:c[0]||(c[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,dL),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,hL)])])):P("",!0)}},$v=Ke(fL,[["__scopeId","data-v-6cd009cb"]]),pL={class:"context-info"},vL={class:"action-buttons"},mL=["disabled"],gL={key:0,class:"fullscreen-map-banner"},yL={class:"fullscreen-map-container"},kL={key:1,class:"fullscreen-map-footer"},bL={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const n=e,s=z(()=>n.headerTextColor?{color:n.headerTextColor}:{}),o=t,i=()=>{o("done")},l=()=>{o("cancel")},c=()=>{o("close")},d=h=>{h.key==="Escape"&&n.show&&(n.mode==="view"?c():l())};return Ye(()=>n.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),un(()=>{document.addEventListener("keydown",d)}),Ln(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(p(),qe(ec,{to:"body"},[e.show?(p(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=ct(()=>{},["prevent","self"]))},[r("div",{class:le(["fullscreen-map-header",{compact:e.mode==="view"}]),style:tt(e.headerStyle)},[r("div",pL,[r("h3",{style:tt({color:e.headerTextColor})},w(e.title),5),e.description?(p(),g("p",{key:0,style:tt({color:e.headerTextColor,opacity:.85})},w(e.description),5)):P("",!0)]),r("div",vL,[mo(h.$slots,"actions",{},void 0,!0),e.mode==="view"?(p(),g("button",{key:0,type:"button",onClick:ct(c,["stop"]),class:"btn btn-close-x",style:tt(s.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(p(),g(Se,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,mL)],64))])],6),h.$slots.banner?(p(),g("div",gL,[mo(h.$slots,"banner",{},void 0,!0)])):P("",!0),r("div",yL,[mo(h.$slots,"default",{},void 0,!0)]),h.$slots.footer?(p(),g("div",kL,[mo(h.$slots,"footer",{},void 0,!0)])):P("",!0)],32)):P("",!0)]))}},wL=Ke(bL,[["__scopeId","data-v-a1e3e36c"]]),_L={class:"map-wrapper"},CL={class:"fullscreen-map-wrapper"},LL={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(!1),f=D(0),m=D(!1),y=D(!1),k=D({...s.filters});Ye(()=>s.filters,K=>{k.value={...K}},{deep:!0}),Ye(()=>s.areas,K=>{s.showFilters&&K.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=K.map(ae=>ae.id))},{immediate:!0});const b=z(()=>s.showFilters?s.locations.filter(K=>{const ae=K.checkedInCount||0,q=K.requiredMarshals||1,Y=ae===0,te=ae>0&&ae<q,ue=ae>=q;if(Y&&!k.value.showUncheckedIn||te&&!k.value.showPartiallyCheckedIn||ue&&!k.value.showFullyCheckedIn)return!1;const _e=K.areaIds||K.AreaIds||[];return!(s.areas.length>0&&_e.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!_e.some(Pe=>k.value.selectedAreaIds.includes(Pe))))}):s.locations),I=z(()=>s.showFilters?k.value.showRoute?s.route:[]:s.route),T=z(()=>s.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?s.areas.filter(K=>k.value.selectedAreaIds.includes(K.id)):s.areas.length>0?[]:s.areas:s.areas),E=z(()=>s.mode==="select-point"?!0:s.mode==="draw-polygon"?f.value>=3:!0),x=()=>h.value?l.value:i.value,C=()=>{h.value=!0,o("fullscreen-change",!0)},_=()=>{h.value=!1,o("fullscreen-change",!1)},$=()=>{if(s.mode==="draw-polygon"){const K=x();K&&K.clearPolygonDrawing(),f.value=0,m.value=!1,y.value=!1}h.value=!1,o("fullscreen-cancel"),o("fullscreen-change",!1)},R=()=>{if(s.mode==="draw-polygon"&&f.value>=3){const K=x();K&&K.completePolygon()}h.value=!1,o("fullscreen-done"),o("fullscreen-change",!1)},M=K=>{k.value=K,o("filter-change",K)},O=K=>{s.mode==="select-point"&&o("point-selected",K),o("map-click",K)},A=K=>{f.value=K?.length||0,j(),o("polygon-drawing",K)},U=K=>{o("polygon-complete",K),f.value=0,m.value=!1,y.value=!1},F=K=>{o("polygon-update",K)},j=()=>{const K=x();K&&(m.value=K.canUndo?K.canUndo():!1,y.value=K.canRedo?K.canRedo():!1)},Z=()=>{const K=x();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),j())},X=()=>{const K=x();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),j())};return t({getMapCenter:()=>x()?.getMapCenter?.(),getMapZoom:()=>x()?.getMapZoom?.(),undoPolygonPoint:Z,redoPolygonPoint:X,canUndo:()=>m.value,canRedo:()=>y.value,getPolygonPointCount:()=>f.value,completePolygon:()=>x()?.completePolygon?.(),clearPolygonDrawing:()=>{x()?.clearPolygonDrawing?.(),f.value=0,m.value=!1,y.value=!1},recenterOnUserLocation:()=>x()?.recenterOnUserLocation?.(),recenterOnLocation:(K,ae,q)=>x()?.recenterOnLocation?.(K,ae,q),isLocationInView:(K,ae)=>x()?.isLocationInView?.(K,ae)??!0,getUserLocationInView:()=>x()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>x()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,o("fullscreen-change",!0)},closeFullscreen:_,closeDropdowns:()=>{c.value&&c.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(K,ae)=>(p(),g("div",{class:"common-map",style:tt({height:e.height})},[r("div",_L,[Ee(Jh,{ref_key:"mapViewRef",ref:i,locations:b.value,route:I.value,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,areas:T.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[0]||(ae[0]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[1]||(ae[1]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:A,onPolygonUpdate:F,onVisibilityChange:ae[2]||(ae[2]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","route-weight","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(xv,{ref_key:"toolbarRef",ref:c,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:C,onFilterChange:M,onActionClick:ae[3]||(ae[3]=q=>K.$emit("action-click",q))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ee($v,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:X},null,8,["show","point-count","can-undo","can-redo"])]),Ee(wL,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":E.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:$,onClose:_},yf({default:Ve(()=>[r("div",CL,[Ee(Jh,{ref_key:"fullscreenMapViewRef",ref:l,locations:b.value,route:I.value,"route-color":e.routeColor,"route-style":e.routeStyle,areas:T.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[4]||(ae[4]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[5]||(ae[5]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:A,onPolygonUpdate:F,onVisibilityChange:ae[6]||(ae[6]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(xv,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:M,onActionClick:ae[7]||(ae[7]=q=>K.$emit("action-click",q))},null,8,["show-filters","filters","areas","actions","position"]),Ee($v,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:X},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[K.$slots["fullscreen-actions"]?{name:"actions",fn:Ve(()=>[mo(K.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,K.$slots["fullscreen-banner"]?{name:"banner",fn:Ve(()=>[mo(K.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,K.$slots["fullscreen-footer"]?{name:"footer",fn:Ve(()=>[mo(K.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},il=Ke(LL,[["__scopeId","data-v-b4c73381"]]),Un=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],tu="#667eea";function SL(e){const t=e.map(s=>s.color);return Un.find(s=>!t.includes(s.hex))?.hex||tu}function Xh(e){const t=e.replace("#",""),n=parseInt(t.slice(0,2),16)/255,s=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Iu(e){return!e||e===""?"#ffffff":Xh(e)>.179?"#333333":"#ffffff"}function n1(e,t){const n=e||yn.headerGradientStart,s=t||yn.headerGradientEnd,o=Xh(n),i=Xh(s);return(o+i)/2>.35?"#333333":"#ffffff"}const yn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},IL={class:"branding-color-picker"},xL={key:0,class:"picker-label"},$L={class:"color-name"},TL={key:1,class:"color-popup"},ML={class:"popup-header"},AL={class:"color-grid"},EL=["title","onClick"],PL={key:0,class:"check-mark"},DL={key:0,class:"check-mark"},RL={key:0,class:"custom-hex-input"},OL={class:"hex-input-row"},NL=["disabled"],BL={key:0,class:"hex-error"},FL={key:1,class:"contrast-preview"},UL={__name:"BrandingColorPicker",props:{modelValue:{type:String,default:""},label:{type:String,default:""},defaultColor:{type:String,default:""},showDefault:{type:Boolean,default:!0},showContrastPreview:{type:Boolean,default:!0},colors:{type:Array,default:()=>Un}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(!1),l=D(""),c=D(null),d=z(()=>n.modelValue&&n.modelValue!=="default"?n.modelValue:n.defaultColor||yn.headerGradientStart),h=z(()=>{if(!n.modelValue||n.modelValue===""||n.modelValue==="default")return"Default";const C=n.colors.find(_=>_.hex.toLowerCase()===n.modelValue.toLowerCase());return C?C.name:n.modelValue}),f=z(()=>Iu(d.value));function m(C){return n.modelValue&&n.modelValue.toLowerCase()===C.toLowerCase()}const y=z(()=>!n.modelValue||n.modelValue===""||n.modelValue==="default"?!1:!n.colors.some(C=>C.hex.toLowerCase()===n.modelValue.toLowerCase())),k=z(()=>{if(!l.value)return!1;const C=l.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(C)||/^[0-9A-Fa-f]{3}$/.test(C)});function b(){o.value=!o.value,o.value||(i.value=!1)}function I(C){i.value=!1,s("update:modelValue",C),o.value=!1}function T(){i.value=!i.value,i.value&&(y.value?l.value=n.modelValue.replace(/^#/,""):l.value="",cn(()=>{c.value?.focus()}))}function E(){l.value=l.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()}function x(){if(!k.value)return;let C=l.value;C.length===3&&(C=C[0]+C[0]+C[1]+C[1]+C[2]+C[2]),s("update:modelValue","#"+C),i.value=!1,o.value=!1}return(C,_)=>(p(),g("div",IL,[e.label?(p(),g("label",xL,w(e.label),1)):P("",!0),r("button",{type:"button",class:le(["color-button",{active:o.value}]),onClick:b},[r("span",{class:"color-swatch",style:tt({backgroundColor:d.value})},null,4),r("span",$L,w(h.value),1),_[3]||(_[3]=r("span",{class:"arrow"},"",-1))],2),o.value?(p(),g("div",TL,[r("div",ML,[r("span",null,w(e.label||"Select colour"),1),r("button",{type:"button",class:"popup-close",onClick:_[0]||(_[0]=$=>o.value=!1)},"")]),r("div",AL,[e.showDefault?(p(),g("button",{key:0,type:"button",class:le(["color-option default-option",{selected:e.modelValue===""||e.modelValue==="default"}]),onClick:_[1]||(_[1]=$=>I(""))},[..._[4]||(_[4]=[r("span",{class:"default-icon"},"",-1),r("span",null,"Default",-1)])],2)):P("",!0),(p(!0),g(Se,null,je(e.colors,$=>(p(),g("button",{key:$.hex,type:"button",class:le(["color-option",{selected:m($.hex)}]),style:tt({backgroundColor:$.hex}),title:$.name,onClick:R=>I($.hex)},[m($.hex)?(p(),g("span",PL,"")):P("",!0)],14,EL))),128)),r("button",{type:"button",class:le(["color-option custom-option",{selected:y.value}]),style:tt(y.value?{backgroundColor:e.modelValue}:{}),title:"Custom colour",onClick:T},[_[5]||(_[5]=r("svg",{class:"custom-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"})],-1)),y.value?(p(),g("span",DL,"")):P("",!0)],6)]),i.value?(p(),g("div",RL,[_[7]||(_[7]=r("label",null,"Enter hex code",-1)),r("div",OL,[_[6]||(_[6]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInput",ref:c,"onUpdate:modelValue":_[2]||(_[2]=$=>l.value=$),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:l.value&&!k.value}]),onInput:E,onKeydown:Qo(x,["enter"])},null,34),[[st,l.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:k.value?"#"+l.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!k.value,onClick:x}," Apply ",8,NL)]),l.value&&!k.value?(p(),g("span",BL," Invalid hex code ")):P("",!0)])):P("",!0),e.showContrastPreview?(p(),g("div",FL,[_[8]||(_[8]=r("span",{class:"preview-label"},"Text will appear:",-1)),r("span",{class:"preview-text",style:tt({backgroundColor:d.value,color:f.value})}," Sample Text ",4)])):P("",!0)])):P("",!0)]))}},zL=Ke(UL,[["__scopeId","data-v-713a193b"]]),HL={class:"course-areas-tab"},VL={key:0,class:"route-settings-bar"},GL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},qL=["stroke","stroke-dasharray","stroke-linecap"],jL=["onClick"],WL={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},ZL=["stroke","stroke-dasharray","stroke-linecap"],KL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},YL=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],JL=["onClick"],XL={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},QL=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],eS=["disabled"],Tv="#3388ff",tS={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map","update:routeSettings"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=ht(),i=e,l=n,c=D(null),d=D(null),h=D(null),f=D(null),m=D(0),y=D(!1),k=D(!1),b=D(i.routeColor),I=D(i.routeStyle),T=D(i.routeWeight);Ye(()=>i.routeColor,Te=>{b.value=Te},{immediate:!0}),Ye(()=>i.routeStyle,Te=>{I.value=Te},{immediate:!0}),Ye(()=>i.routeWeight,Te=>{T.value=Te},{immediate:!0});const E=z(()=>{const Te=b.value!==i.routeColor,Pe=I.value!==i.routeStyle,De=T.value!==i.routeWeight;return Te||Pe||De}),x=[{value:"line",label:"Solid"},{value:"dash",label:"Dashed"},{value:"dash-long",label:"Long dash"},{value:"dash-short",label:"Short dash"},{value:"dash-dense",label:"Dense dash"},{value:"dot",label:"Dotted"},{value:"dot-sparse",label:"Sparse dots"},{value:"dot-dense",label:"Dense dots"},{value:"dash-dot",label:"Dash-dot"},{value:"dash-dot-dot",label:"Dash-dot-dot"},{value:"long-short",label:"Long-short"},{value:"double-dash",label:"Double dash"}],C=[{value:2,label:"Thin"},{value:4,label:"Normal"},{value:6,label:"Thick"},{value:8,label:"Extra thick"}],_=z(()=>b.value||Tv),$=Te=>{const Pe=Te.replace("#",""),De=parseInt(Pe.substr(0,2),16)/255,ke=parseInt(Pe.substr(2,2),16)/255,H=parseInt(Pe.substr(4,2),16)/255,J=de=>de<=.03928?de/12.92:Math.pow((de+.055)/1.055,2.4);return .2126*J(De)+.7152*J(ke)+.0722*J(H)},R=z(()=>{const Te=_.value;return $(Te)>.5?{backgroundColor:"#333",borderColor:"#555"}:{}}),M=Te=>{switch(Te){case"dash":return"8, 6";case"dash-long":return"16, 8";case"dash-short":return"4, 4";case"dash-dense":return"6, 3";case"dot":return"2, 4";case"dot-sparse":return"2, 8";case"dot-dense":return"2, 2";case"dash-dot":return"12, 4, 2, 4";case"dash-dot-dot":return"12, 4, 2, 4, 2, 4";case"long-short":return"16, 4, 6, 4";case"double-dash":return"8, 3, 8, 8";default:return"none"}},O=Te=>Te==="dot"||Te==="dot-sparse"||Te==="dot-dense"?"round":"butt",A=()=>{y.value=!y.value,k.value=!1},U=()=>{k.value=!k.value,y.value=!1},F=Te=>{I.value=Te,y.value=!1},j=Te=>{T.value=Te,k.value=!1},Z=()=>{l("update:routeSettings",{routeColor:b.value,routeStyle:I.value,routeWeight:T.value})},X=Te=>{h.value&&!h.value.contains(Te.target)&&(y.value=!1),f.value&&!f.value.contains(Te.target)&&(k.value=!1)};Ye([y,k],([Te,Pe])=>{Te||Pe?document.addEventListener("click",X,!0):document.removeEventListener("click",X,!0)}),Ln(()=>{document.removeEventListener("click",X,!0)});const re=D({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),K=z(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:s.value.checkpoint},{id:"many-checkpoints",label:`Many ${o.value.checkpoints}`},{id:"area",label:s.value.area},{id:"import",label:`Import ${o.value.checkpoints}...`},{id:"upload",label:`Upload ${o.value.course}...`}]}]),ae=({actionId:Te,itemId:Pe})=>{Te==="add"&&(Pe==="checkpoint"?(l("add-checkpoint-from-map"),te()):Pe==="many-checkpoints"?(l("add-many-checkpoints-from-map"),te()):Pe==="area"?(l("add-area-from-map"),te()):Pe==="import"?l("import-checkpoints"):Pe==="upload"&&l("upload-route"))},q=Te=>{re.value=Te},Y=Te=>{m.value=Te?.length||0},te=()=>{c.value&&c.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:te,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ye(()=>i.areas,Te=>{if(Te.length>0){const Pe=new Set(re.value.selectedAreaIds);Te.forEach(De=>{Pe.has(De.id)||re.value.selectedAreaIds.push(De.id)}),re.value.selectedAreaIds=re.value.selectedAreaIds.filter(De=>Te.some(ke=>ke.id===De))}},{immediate:!0}),Ye(()=>i.drawingMode,Te=>{Te||(m.value=0)}),(Te,Pe)=>(p(),g("div",HL,[e.route.length>0?(p(),g("div",VL,[Pe[7]||(Pe[7]=r("span",{class:"route-settings-label"},"Route style:",-1)),Ee(zL,{"model-value":b.value,"default-color":Tv,"show-contrast-preview":!1,"show-default":!0,"onUpdate:modelValue":Pe[0]||(Pe[0]=De=>b.value=De)},null,8,["model-value"]),r("div",{class:"style-selector",ref_key:"styleSelectorRef",ref:h},[r("button",{type:"button",class:"style-selector-button",onClick:A},[(p(),g("svg",GL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:_.value,"stroke-width":"3","stroke-dasharray":M(I.value||"line"),"stroke-linecap":O(I.value||"line")},null,8,qL)])),Pe[5]||(Pe[5]=r("span",{class:"style-selector-arrow"},"",-1))]),y.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),g(Se,null,je(x,De=>r("button",{key:De.value,type:"button",class:le(["style-option",{selected:(I.value||"line")===De.value}]),onClick:ke=>F(De.value)},[(p(),g("svg",WL,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:_.value,"stroke-width":"3","stroke-dasharray":M(De.value),"stroke-linecap":O(De.value)},null,8,ZL)]))],10,jL)),64))],4)):P("",!0)],512),r("div",{class:"style-selector",ref_key:"weightSelectorRef",ref:f},[r("button",{type:"button",class:"style-selector-button",onClick:U},[(p(),g("svg",KL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:_.value,"stroke-width":T.value||4,"stroke-dasharray":M(I.value||"line"),"stroke-linecap":O(I.value||"line")},null,8,YL)])),Pe[6]||(Pe[6]=r("span",{class:"style-selector-arrow"},"",-1))]),k.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),g(Se,null,je(C,De=>r("button",{key:De.value,type:"button",class:le(["style-option",{selected:(T.value||4)===De.value}]),onClick:ke=>j(De.value)},[(p(),g("svg",XL,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:_.value,"stroke-width":De.value,"stroke-dasharray":M(I.value||"line"),"stroke-linecap":O(I.value||"line")},null,8,QL)]))],10,JL)),64))],4)):P("",!0)],512),r("button",{type:"button",class:"btn-save-style",disabled:!E.value,onClick:Z}," Save ",8,eS)])):P("",!0),r("div",{class:"map-section",ref_key:"mapSection",ref:c},[Ee(il,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,"route-color":b.value,"route-style":I.value,"route-weight":T.value,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:re.value,"toolbar-actions":K.value,"fullscreen-title":e.drawingMode?`Draw ${B(o).area} boundary`:B(s).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:Pe[1]||(Pe[1]=De=>Te.$emit("map-click",De)),onLocationClick:Pe[2]||(Pe[2]=De=>Te.$emit("location-click",De)),onAreaClick:Pe[3]||(Pe[3]=De=>Te.$emit("area-click",De)),onPolygonComplete:Pe[4]||(Pe[4]=De=>Te.$emit("polygon-complete",De)),onPolygonDrawing:Y,onFilterChange:q,onActionClick:ae},null,8,["locations","route","route-color","route-style","route-weight","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},nS=Ke(tS,[["__scopeId","data-v-4903e5fa"]]),oS=(e,t)=>{const n=String(e).trim(),s=String(t).trim(),o=parseFloat(n),i=parseFloat(s),l=!isNaN(o)&&String(o)===n,c=!isNaN(i)&&String(i)===s;return l&&c?o-i:n.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})},sS={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,n)=>(p(),g("button",{class:le(["status-pill",[e.variant,{active:e.active}]]),onClick:n[0]||(n[0]=s=>t.$emit("click"))},[mo(t.$slots,"default",{},void 0,!0)],2))}},Pt=Ke(sS,[["__scopeId","data-v-a94deea5"]]),aS={class:"check-in-toggle-container"},iS=["disabled"],lS={key:0,class:"toggle-spinner"},rS={key:1,class:"toggle-icon"},cS={class:"toggle-label"},uS={key:0,class:"check-in-details"},dS={key:0,class:"check-in-method"},hS={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,n=z(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),s=z(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),o=z(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=z(()=>{const{checkedInBy:c,checkInMethod:d,marshalName:h}=t;return c&&c!==h?c:d||""}),l=c=>{if(!c)return"";const d=new Date(c),f=(new Date-d)/(1e3*60*60),m=d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return f>24?`${d.toLocaleDateString([],{day:"numeric",month:"short"})}, ${m}`:m};return(c,d)=>(p(),g("div",aS,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[e.isLoading?(p(),g("span",lS)):e.isCheckedIn?(p(),g("span",rS,"")):P("",!0),r("span",cS,w(o.value),1)],10,iS),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(p(),g("span",uS,[Je(w(l(e.checkInTime))+" ",1),i.value?(p(),g("span",dS,"("+w(i.value)+")",1)):P("",!0),n.value?(p(),g("span",{key:1,class:le(["check-in-distance",s.value]),onClick:d[1]||(d[1]=ct(h=>c.$emit("distance-click"),["stop"]))},w(n.value),3)):P("",!0)])):P("",!0)]))}},xu=Ke(hS,[["__scopeId","data-v-cc97f986"]]),fS={class:"confirm-modal"},pS={class:"confirm-actions"},vS={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const n=t,s=()=>{n("confirm")},o=()=>{n("cancel")};return(i,l)=>e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(o,["self"])},[r("div",fS,[r("h3",null,w(e.title),1),r("p",null,w(e.message),1),r("div",pS,[e.showCancel?(p(),g("button",{key:0,onClick:o,class:"btn btn-secondary"},w(e.cancelText),1)):P("",!0),r("button",{onClick:s,class:le(["btn",e.isDanger?"btn-danger":"btn-primary"])},w(e.confirmText),3)])])])):P("",!0)}},hi=Ke(vS,[["__scopeId","data-v-b3f01e55"]]),mS={class:"base-modal-header"},gS={class:"base-modal-header-content"},yS={key:0,class:"base-modal-title"},kS={key:0,class:"base-modal-tab-header"},bS={key:1,class:"base-modal-footer"},wS={key:0,class:"base-modal-actions"},_S={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=()=>{const C=document.documentElement,_=getComputedStyle(C).getPropertyValue("--modal-resize-duration").trim();return _.endsWith("s")?parseFloat(_)*1e3:300},s=e,o=t,i=D(!1),l=D(!1),c=D(null),d=D(null);let h=null,f=!1,m=0;const y=()=>{if(!d.value||!c.value||f)return;const C=d.value.scrollHeight,_=m;if(_===C||m===0){m=C;return}f=!0,d.value.style.height=`${_}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${C}px`;const $=n();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=C},$)},k=()=>{!c.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),h=new MutationObserver(()=>{cn(()=>{y()})}),h.observe(c.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{h&&(h.disconnect(),h=null)};un(()=>{cn(()=>{s.show&&k()})}),Ln(()=>{b()}),Ye(()=>s.show,C=>{C?cn(()=>{m=0,k()}):b()});const I=()=>{s.closeOnOverlay&&T()},T=()=>{s.confirmOnClose&&s.isDirty?i.value=!0:o("close")},E=()=>{i.value=!1,o("close")},x=()=>{i.value=!1};return(C,_)=>(p(),qe(Is,{name:"modal",appear:""},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"base-modal-overlay",style:tt({zIndex:e.zIndex}),onClick:ct(I,["self"])},[r("div",{class:le(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",mS,[r("div",gS,[mo(C.$slots,"header",{},()=>[e.title?(p(),g("h2",yS,w(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(p(),g("button",{key:0,onClick:T,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),C.$slots["tab-header"]?(p(),g("div",kS,[mo(C.$slots,"tab-header",{},void 0,!0)])):P("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:c},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[mo(C.$slots,"default",{},void 0,!0)],512)],512),C.$slots.footer||C.$slots.actions?(p(),g("div",bS,[mo(C.$slots,"footer",{},()=>[C.$slots.actions?(p(),g("div",wS,[mo(C.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!l.value?(p(),qe(hi,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:E,onCancel:x},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},Zt=Ke(_S,[["__scopeId","data-v-141bdab1"]]),CS={class:"map-modal-content"},LS={class:"location-info"},SS={key:0,class:"info-row"},IS={class:"info-value"},xS={key:1,class:"info-row"},$S={class:"info-label"},TS={class:"info-value"},MS={key:2,class:"info-row distance-row"},AS={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=ht(),n=e,s=D(null);let o=null,i=null,l=null;const c=z(()=>t.value.checkpoint),d=z(()=>n.marshalName&&n.checkpointName?`${n.marshalName} - ${n.checkpointName}`:n.marshalName?n.marshalName:"Check-in location"),h=z(()=>n.distance===null?"":n.distance<1e3?`${Math.round(n.distance)} m`:`${(n.distance/1e3).toFixed(2)} km`),f=z(()=>n.distance===null?"":n.distance<=50?"distance-close":n.distance<=100?"distance-medium":"distance-far"),m=(I,T)=>I==null||T==null?"Unknown":`${I.toFixed(6)}, ${T.toFixed(6)}`,y=()=>{if(!s.value||o)return;let I=[51.505,-.09],T=15;n.checkInLocation&&(I=[n.checkInLocation.lat,n.checkInLocation.lng]),o=Xt.map(s.value).setView(I,T),Xt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(o),k()},k=()=>{if(!o)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const I=[];if(n.checkInLocation){const T=Xt.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Xt.marker([n.checkInLocation.lat,n.checkInLocation.lng],{icon:T}).addTo(o).bindPopup(`<b>${n.marshalName||"Marshal"}</b><br>Check-in location`),I.push([n.checkInLocation.lat,n.checkInLocation.lng])}if(n.checkpointLocation&&n.checkpointLocation.lat&&n.checkpointLocation.lng){const T=Xt.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${n.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Xt.marker([n.checkpointLocation.lat,n.checkpointLocation.lng],{icon:T}).addTo(o).bindPopup(`<b>${n.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),I.push([n.checkpointLocation.lat,n.checkpointLocation.lng])}if(I.length===2){const T=Xt.latLngBounds(I);o.fitBounds(T,{padding:[50,50],maxZoom:17})}else I.length===1&&o.setView(I[0],16)},b=()=>{o&&(o.remove(),o=null,i=null,l=null)};return Ye(()=>n.show,async I=>{I?(await cn(),setTimeout(()=>{y()},100)):b()}),Ye([()=>n.checkInLocation,()=>n.checkpointLocation],()=>{o&&k()},{deep:!0}),un(()=>{n.show&&cn(()=>{setTimeout(()=>{y()},100)})}),Ln(()=>{b()}),(I,T)=>(p(),qe(Zt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:T[0]||(T[0]=E=>I.$emit("close"))},{default:Ve(()=>[r("div",CS,[r("div",{class:"map-container",ref_key:"mapContainer",ref:s},null,512),r("div",LS,[e.checkInLocation?(p(),g("div",SS,[T[1]||(T[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",IS,w(m(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):P("",!0),e.checkpointLocation?(p(),g("div",xS,[r("span",$S,w(c.value)+" location:",1),r("span",TS,w(m(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):P("",!0),e.distance!==null?(p(),g("div",MS,[T[2]||(T[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:le(["info-value distance-value",f.value])},w(h.value),3)])):P("",!0)])])]),_:1},8,["show","title","z-index"]))}},Pf=Ke(AS,[["__scopeId","data-v-011fa479"]]),ES={class:"marshals-tab"},PS={class:"tab-header"},DS={class:"button-group"},RS={key:0,class:"status-pills"},OS={class:"filters-section"},NS={class:"search-group"},BS={class:"marshals-grid"},FS={class:"marshals-table"},US={key:0,class:"sort-indicator"},zS={key:0,class:"sort-indicator"},HS={key:0,class:"sort-indicator"},VS={key:0,class:"sort-indicator"},GS=["onClick"],qS=["rowspan"],jS={class:"checkpoint-cell"},WS={class:"checkpoint-name"},ZS={key:0,class:"checkpoint-description"},KS=["rowspan"],YS={key:0,class:"last-active-text"},JS={key:1,class:"last-active-never"},XS=["onClick"],QS={class:"no-checkpoint-text"},eI={class:"hide-on-mobile last-active-cell"},tI={key:0,class:"last-active-text"},nI={key:1,class:"last-active-never"},oI={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:n}){const{terms:s}=ht(),o=e,i=n,l=D(null),c=D(!1),d=D(null),h=H=>{l.value=H},f=H=>{d.value=H,c.value=!0},m=()=>{c.value=!1,d.value=null},y=z(()=>d.value?_e(d.value.marshalId):""),k=z(()=>d.value?te(d.value.locationId):""),b=z(()=>{if(!d.value)return null;const{checkInLatitude:H,checkInLongitude:J}=d.value;return!H||!J?null:{lat:H,lng:J}}),I=z(()=>{if(!d.value)return null;const H=Y(d.value.locationId);return!H?.latitude||!H?.longitude?null:{lat:H.latitude,lng:H.longitude}}),T=z(()=>d.value?Te(d.value):null),E=D(!1),x=D(null),C=H=>{H.isCheckedIn?(x.value=H,E.value=!0):i("toggle-check-in",H)},_=()=>{x.value&&i("toggle-check-in",x.value),E.value=!1,x.value=null},$=()=>{E.value=!1,x.value=null},R=z(()=>x.value?`Are you sure you want to undo ${_e(x.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const M=D("name"),O=D("asc"),A=D(""),U=D("all"),F=H=>{U.value=H},j=H=>{M.value===H?O.value=O.value==="asc"?"desc":"asc":(M.value=H,O.value="asc")},Z=H=>o.assignments.filter(J=>J.marshalId===H),X=z(()=>new Set(o.assignments.filter(H=>H.isCheckedIn).map(H=>H.marshalId))),re=z(()=>new Set(o.assignments.map(H=>H.marshalId))),K=z(()=>X.value.size),ae=z(()=>o.marshals.filter(H=>!re.value.has(H.id)).length),q=z(()=>o.marshals.filter(H=>re.value.has(H.id)&&!X.value.has(H.id)).length),Y=H=>o.locations.find(J=>J.id===H),te=H=>{const J=Y(H);return J?J.name:"Unknown"},ue=H=>{const J=Y(H);return J?J.description:""},_e=H=>{const J=o.marshals.find(de=>de.id===H);return J?J.name:""},Te=H=>{const{checkInLatitude:J,checkInLongitude:de,locationId:ie}=H,Re=Y(ie);return!J||!de||!Re?.latitude||!Re?.longitude?null:al(J,de,Re.latitude,Re.longitude)},Pe=H=>{if(!H)return"";const J=new Date(H),ie=new Date-J,Re=Math.floor(ie/6e4),G=Math.floor(Re/60),Q=Math.floor(G/24);return Re<1?"just now":Re<60?`${Re}m ago`:G<24?`${G}h ago`:Q===1?"yesterday":Q<7?`${Q}d ago`:J.toLocaleDateString()},De=z(()=>{let H=o.marshals;if(U.value==="unassigned"?H=H.filter(J=>!re.value.has(J.id)):U.value==="checked-in"?H=H.filter(J=>X.value.has(J.id)):U.value==="not-checked-in"&&(H=H.filter(J=>re.value.has(J.id)&&!X.value.has(J.id))),A.value.trim()){const J=A.value.toLowerCase().trim().split(/\s+/);H=H.filter(de=>{const Re=Z(de.id).map(Q=>{const ee=Y(Q.locationId);return ee?`${ee.name||""} ${ee.description||""}`:""}).join(" "),G=`${de.name} ${Re}`.toLowerCase();return J.every(Q=>G.includes(Q))})}return H}),ke=z(()=>{const H=[...De.value];return H.sort((J,de)=>{let ie=0;if(M.value==="name")ie=J.name.localeCompare(de.name);else if(M.value==="checkpoint"){const Re=Z(J.id),G=Z(de.id),Q=Re.length>0?te(Re[0].locationId):"",ee=G.length>0?te(G[0].locationId):"";ie=oS(Q,ee)}else if(M.value==="status"){const Re=Z(J.id),G=Z(de.id),Q=Re.length>0&&Re[0].isCheckedIn?1:0;ie=(G.length>0&&G[0].isCheckedIn?1:0)-Q}else if(M.value==="lastActive"){const Re=J.lastAccessedDate?new Date(J.lastAccessedDate).getTime():0;ie=(de.lastAccessedDate?new Date(de.lastAccessedDate).getTime():0)-Re}return O.value==="asc"?ie:-ie}),H});return(H,J)=>(p(),g("div",ES,[r("div",PS,[r("div",DS,[r("button",{onClick:J[0]||(J[0]=de=>H.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(B(s).person.toLowerCase()),1),r("button",{onClick:J[1]||(J[1]=de=>H.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(p(),g("div",RS,[Ee(Pt,{variant:"neutral",active:U.value==="all",onClick:J[2]||(J[2]=de=>F("all"))},{default:Ve(()=>[Je(w(e.marshals.length)+" total ",1)]),_:1},8,["active"]),ae.value>0&&ae.value<e.marshals.length?(p(),qe(Pt,{key:0,variant:"warning",active:U.value==="unassigned",onClick:J[3]||(J[3]=de=>F("unassigned"))},{default:Ve(()=>[Je(w(ae.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),K.value>0&&K.value<e.marshals.length?(p(),qe(Pt,{key:1,variant:"success",active:U.value==="checked-in",onClick:J[4]||(J[4]=de=>F("checked-in"))},{default:Ve(()=>[Je(w(K.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),q.value>0&&q.value<e.marshals.length?(p(),qe(Pt,{key:2,variant:"danger",active:U.value==="not-checked-in",onClick:J[5]||(J[5]=de=>F("not-checked-in"))},{default:Ve(()=>[Je(w(q.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",OS,[r("div",NS,[We(r("input",{"onUpdate:modelValue":J[6]||(J[6]=de=>A.value=de),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,A.value]])])]),r("div",BS,[r("table",FS,[r("thead",null,[r("tr",null,[r("th",{onClick:J[7]||(J[7]=de=>j("name")),class:"sortable"},[J[12]||(J[12]=Je(" Name ",-1)),M.value==="name"?(p(),g("span",US,w(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[8]||(J[8]=de=>j("checkpoint")),class:"sortable"},[Je(w(B(s).checkpoint)+" ",1),M.value==="checkpoint"?(p(),g("span",zS,w(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[9]||(J[9]=de=>j("status")),class:"sortable"},[J[13]||(J[13]=Je(" Status ",-1)),M.value==="status"?(p(),g("span",HS,w(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:J[10]||(J[10]=de=>j("lastActive")),class:"sortable hide-on-mobile"},[J[14]||(J[14]=Je(" Last active ",-1)),M.value==="lastActive"?(p(),g("span",VS,w(O.value==="asc"?"":""),1)):P("",!0)])])]),r("tbody",null,[(p(!0),g(Se,null,je(ke.value,de=>(p(),g(Se,{key:de.id},[Z(de.id).length>0?(p(!0),g(Se,{key:0},je(Z(de.id),(ie,Re)=>(p(),g("tr",{key:`${de.id}-${ie.id}`,class:"marshal-row",onClick:G=>H.$emit("select-marshal",de)},[Re===0?(p(),g("td",{key:0,rowspan:Z(de.id).length},w(de.name),9,qS)):P("",!0),r("td",jS,[r("div",WS,w(te(ie.locationId)),1),ue(ie.locationId)?(p(),g("div",ZS,w(ue(ie.locationId)),1)):P("",!0)]),r("td",{onClick:J[11]||(J[11]=ct(()=>{},["stop"])),class:"check-in-cell"},[Ee(xu,{"is-checked-in":ie.isCheckedIn,"check-in-time":ie.checkInTime,"check-in-method":ie.checkInMethod,"checked-in-by":ie.checkedInBy,"marshal-name":_e(ie.marshalId),"is-loading":l.value===ie.id,distance:Te(ie),onToggle:G=>C(ie),onDistanceClick:G=>f(ie)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),Re===0?(p(),g("td",{key:1,rowspan:Z(de.id).length,class:"hide-on-mobile last-active-cell"},[de.lastAccessedDate?(p(),g("span",YS,w(Pe(de.lastAccessedDate)),1)):(p(),g("span",JS,"Never"))],8,KS)):P("",!0)],8,GS))),128)):(p(),g("tr",{key:1,class:"marshal-row",onClick:ie=>H.$emit("select-marshal",de)},[r("td",null,w(de.name),1),r("td",QS,"No "+w(B(s).checkpoint.toLowerCase())+" assigned",1),J[15]||(J[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",eI,[de.lastAccessedDate?(p(),g("span",tI,w(Pe(de.lastAccessedDate)),1)):(p(),g("span",nI,"Never"))])],8,XS))],64))),128))])])]),Ee(Pf,{show:c.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":b.value,"checkpoint-location":I.value,distance:T.value,onClose:m},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Ee(hi,{show:E.value,title:"Confirm check-out",message:R.value,"confirm-text":"Check out","is-danger":!0,onConfirm:_,onCancel:$},null,8,["show","message"])]))}},sI=Ke(oI,[["__scopeId","data-v-bdb66e38"]]),aI={class:"assignment-pills"},iI={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:n}=ht(),s=e,o=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${n.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${n.value.checkpoints}`,SpecificPeople:`Specific ${n.value.people}`,EveryAreaLead:`Every ${n.value.area} lead`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,OnePerArea:`One per ${n.value.area}`,OneLeadPerArea:`One lead per ${n.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${n.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?s.areas.find(y=>y.id===h)?.name||null:f==="Checkpoint"?s.locations.find(y=>y.id===h)?.name||null:f==="Marshal"&&s.marshals.find(y=>y.id===h)?.name||null,c=h=>{if(!h)return[];const f=o(h.scope),m=h.ids||[];if(h.itemType===null||m.length===0)return[f];if(m.includes("ALL_MARSHALS"))return["Everyone"];if(m.includes("ALL_AREAS"))return[`${f} (All ${n.value.areas})`];if(m.includes("ALL_CHECKPOINTS"))return[`${f} (All ${n.value.checkpoints})`];const y=m.filter(b=>l(b,h.itemType)!==null);if(y.length===0)return[];if(y.length>s.maxExpandedItems)return[`${f} (${y.length})`];const k=i(h.scope);return y.map(b=>{const I=l(b,h.itemType);return k?`${k} ${I}`:I})},d=z(()=>{if(!s.scopeConfigurations||s.scopeConfigurations.length===0)return[];const h=[];for(const f of s.scopeConfigurations)h.push(...c(f));return h});return(h,f)=>(p(),g("div",aI,[(p(!0),g(Se,null,je(d.value,(m,y)=>(p(),g("span",{key:y,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},w(m),1))),128))]))}},ol=Ke(iI,[["__scopeId","data-v-82c305e5"]]);function Mv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Ws(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mv(Object(n),!0).forEach(function(s){lI(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function nu(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nu=function(t){return typeof t}:nu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function lI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sa(){return Sa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Sa.apply(this,arguments)}function rI(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,i;for(i=0;i<s.length;i++)o=s[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function cI(e,t){if(e==null)return{};var n=rI(e,t),s,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)s=i[o],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}var uI="1.14.0";function wa(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var $a=wa(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),gc=wa(/Edge/i),Av=wa(/firefox/i),jr=wa(/safari/i)&&!wa(/chrome/i)&&!wa(/android/i),o1=wa(/iP(ad|od|hone)/i),dI=wa(/chrome/i)&&wa(/android/i),s1={capture:!1,passive:!1};function qt(e,t,n){e.addEventListener(t,n,!$a&&s1)}function Ft(e,t,n){e.removeEventListener(t,n,!$a&&s1)}function $u(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function hI(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Hs(e,t,n,s){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&$u(e,t):$u(e,t))||s&&e===n)return e;if(e===n)break}while(e=hI(e))}return null}var Ev=/\s+/g;function Po(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var s=(" "+e.className+" ").replace(Ev," ").replace(" "+t+" "," ");e.className=(s+(n?" "+t:"")).replace(Ev," ")}}function gt(e,t,n){var s=e&&e.style;if(s){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in s)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),s[t]=n+(typeof n=="string"?"":"px")}}function Ql(e,t){var n="";if(typeof e=="string")n=e;else do{var s=gt(e,"transform");s&&s!=="none"&&(n=s+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function a1(e,t,n){if(e){var s=e.getElementsByTagName(t),o=0,i=s.length;if(n)for(;o<i;o++)n(s[o],o);return s}return[]}function js(){var e=document.scrollingElement;return e||document.documentElement}function Tn(e,t,n,s,o){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,c,d,h,f,m;if(e!==window&&e.parentNode&&e!==js()?(i=e.getBoundingClientRect(),l=i.top,c=i.left,d=i.bottom,h=i.right,f=i.height,m=i.width):(l=0,c=0,d=window.innerHeight,h=window.innerWidth,f=window.innerHeight,m=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!$a))do if(o&&o.getBoundingClientRect&&(gt(o,"transform")!=="none"||n&&gt(o,"position")!=="static")){var y=o.getBoundingClientRect();l-=y.top+parseInt(gt(o,"border-top-width")),c-=y.left+parseInt(gt(o,"border-left-width")),d=l+i.height,h=c+i.width;break}while(o=o.parentNode);if(s&&e!==window){var k=Ql(o||e),b=k&&k.a,I=k&&k.d;k&&(l/=I,c/=b,m/=b,f/=I,d=l+f,h=c+m)}return{top:l,left:c,bottom:d,right:h,width:m,height:f}}}function Pv(e,t,n){for(var s=si(e,!0),o=Tn(e)[t];s;){var i=Tn(s)[n],l=void 0;if(l=o>=i,!l)return s;if(s===js())break;s=si(s,!1)}return!1}function ir(e,t,n,s){for(var o=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==yt.ghost&&(s||l[i]!==yt.dragged)&&Hs(l[i],n.draggable,e,!1)){if(o===t)return l[i];o++}i++}return null}function Df(e,t){for(var n=e.lastElementChild;n&&(n===yt.ghost||gt(n,"display")==="none"||t&&!$u(n,t));)n=n.previousElementSibling;return n||null}function Xo(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==yt.clone&&(!t||$u(e,t))&&n++;return n}function Dv(e){var t=0,n=0,s=js();if(e)do{var o=Ql(e),i=o.a,l=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*l}while(e!==s&&(e=e.parentNode));return[t,n]}function fI(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e[n][s])return Number(n)}return-1}function si(e,t){if(!e||!e.getBoundingClientRect)return js();var n=e,s=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=gt(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return js();if(s||t)return n;s=!0}}while(n=n.parentNode);return js()}function pI(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Hd(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Wr;function i1(e,t){return function(){if(!Wr){var n=arguments,s=this;n.length===1?e.call(s,n[0]):e.apply(s,n),Wr=setTimeout(function(){Wr=void 0},t)}}}function vI(){clearTimeout(Wr),Wr=void 0}function l1(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function r1(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var No="Sortable"+new Date().getTime();function mI(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var s=[].slice.call(this.el.children);s.forEach(function(o){if(!(gt(o,"display")==="none"||o===yt.ghost)){e.push({target:o,rect:Tn(o)});var i=Ws({},e[e.length-1].rect);if(o.thisAnimationDuration){var l=Ql(o,!0);l&&(i.top-=l.f,i.left-=l.e)}o.fromRect=i}})}},addAnimationState:function(s){e.push(s)},removeAnimationState:function(s){e.splice(fI(e,{target:s}),1)},animateAll:function(s){var o=this;if(!this.options.animation){clearTimeout(t),typeof s=="function"&&s();return}var i=!1,l=0;e.forEach(function(c){var d=0,h=c.target,f=h.fromRect,m=Tn(h),y=h.prevFromRect,k=h.prevToRect,b=c.rect,I=Ql(h,!0);I&&(m.top-=I.f,m.left-=I.e),h.toRect=m,h.thisAnimationDuration&&Hd(y,m)&&!Hd(f,m)&&(b.top-m.top)/(b.left-m.left)===(f.top-m.top)/(f.left-m.left)&&(d=yI(b,y,k,o.options)),Hd(m,f)||(h.prevFromRect=f,h.prevToRect=m,d||(d=o.options.animation),o.animate(h,b,m,d)),d&&(i=!0,l=Math.max(l,d),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},d),h.thisAnimationDuration=d)}),clearTimeout(t),i?t=setTimeout(function(){typeof s=="function"&&s()},l):typeof s=="function"&&s(),e=[]},animate:function(s,o,i,l){if(l){gt(s,"transition",""),gt(s,"transform","");var c=Ql(this.el),d=c&&c.a,h=c&&c.d,f=(o.left-i.left)/(d||1),m=(o.top-i.top)/(h||1);s.animatingX=!!f,s.animatingY=!!m,gt(s,"transform","translate3d("+f+"px,"+m+"px,0)"),this.forRepaintDummy=gI(s),gt(s,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),gt(s,"transform","translate3d(0,0,0)"),typeof s.animated=="number"&&clearTimeout(s.animated),s.animated=setTimeout(function(){gt(s,"transition",""),gt(s,"transform",""),s.animated=!1,s.animatingX=!1,s.animatingY=!1},l)}}}}function gI(e){return e.offsetWidth}function yI(e,t,n,s){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*s.animation}var Fl=[],Vd={initializeByDefault:!0},yc={mount:function(t){for(var n in Vd)Vd.hasOwnProperty(n)&&!(n in t)&&(t[n]=Vd[n]);Fl.forEach(function(s){if(s.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Fl.push(t)},pluginEvent:function(t,n,s){var o=this;this.eventCanceled=!1,s.cancel=function(){o.eventCanceled=!0};var i=t+"Global";Fl.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][i]&&n[l.pluginName][i](Ws({sortable:n},s)),n.options[l.pluginName]&&n[l.pluginName][t]&&n[l.pluginName][t](Ws({sortable:n},s)))})},initializePlugins:function(t,n,s,o){Fl.forEach(function(c){var d=c.pluginName;if(!(!t.options[d]&&!c.initializeByDefault)){var h=new c(t,n,t.options);h.sortable=t,h.options=t.options,t[d]=h,Sa(s,h.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,n){var s={};return Fl.forEach(function(o){typeof o.eventProperties=="function"&&Sa(s,o.eventProperties.call(n[o.pluginName],t))}),s},modifyOption:function(t,n,s){var o;return Fl.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(t[i.pluginName],s))}),o}};function kI(e){var t=e.sortable,n=e.rootEl,s=e.name,o=e.targetEl,i=e.cloneEl,l=e.toEl,c=e.fromEl,d=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,m=e.newDraggableIndex,y=e.originalEvent,k=e.putSortable,b=e.extraEventProperties;if(t=t||n&&n[No],!!t){var I,T=t.options,E="on"+s.charAt(0).toUpperCase()+s.substr(1);window.CustomEvent&&!$a&&!gc?I=new CustomEvent(s,{bubbles:!0,cancelable:!0}):(I=document.createEvent("Event"),I.initEvent(s,!0,!0)),I.to=l||n,I.from=c||n,I.item=o||n,I.clone=i,I.oldIndex=d,I.newIndex=h,I.oldDraggableIndex=f,I.newDraggableIndex=m,I.originalEvent=y,I.pullMode=k?k.lastPutMode:void 0;var x=Ws(Ws({},b),yc.getEventProperties(s,t));for(var C in x)I[C]=x[C];n&&n.dispatchEvent(I),T[E]&&T[E].call(t,I)}}var bI=["evt"],Io=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.evt,i=cI(s,bI);yc.pluginEvent.bind(yt)(t,n,Ws({dragEl:ot,parentEl:fn,ghostEl:St,rootEl:rn,nextEl:Gi,lastDownEl:ou,cloneEl:pn,cloneHidden:oi,dragStarted:Mr,putSortable:Fn,activeSortable:yt.active,originalEvent:o,oldIndex:Wl,oldDraggableIndex:Zr,newIndex:Do,newDraggableIndex:ei,hideGhostForTarget:h1,unhideGhostForTarget:f1,cloneNowHidden:function(){oi=!0},cloneNowShown:function(){oi=!1},dispatchSortableEvent:function(c){ho({sortable:n,name:c,originalEvent:o})}},i))};function ho(e){kI(Ws({putSortable:Fn,cloneEl:pn,targetEl:ot,rootEl:rn,oldIndex:Wl,oldDraggableIndex:Zr,newIndex:Do,newDraggableIndex:ei},e))}var ot,fn,St,rn,Gi,ou,pn,oi,Wl,Do,Zr,ei,zc,Fn,ql=!1,Tu=!1,Mu=[],zi,ks,Gd,qd,Rv,Ov,Mr,Ul,Kr,Yr=!1,Hc=!1,su,jn,jd=[],Qh=!1,Au=[],ad=typeof document<"u",Vc=o1,Nv=gc||$a?"cssFloat":"float",wI=ad&&!dI&&!o1&&"draggable"in document.createElement("div"),c1=(function(){if(ad){if($a)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),u1=function(t,n){var s=gt(t),o=parseInt(s.width)-parseInt(s.paddingLeft)-parseInt(s.paddingRight)-parseInt(s.borderLeftWidth)-parseInt(s.borderRightWidth),i=ir(t,0,n),l=ir(t,1,n),c=i&&gt(i),d=l&&gt(l),h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Tn(i).width,f=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Tn(l).width;if(s.display==="flex")return s.flexDirection==="column"||s.flexDirection==="column-reverse"?"vertical":"horizontal";if(s.display==="grid")return s.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&c.float&&c.float!=="none"){var m=c.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===m)?"vertical":"horizontal"}return i&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||h>=o&&s[Nv]==="none"||l&&s[Nv]==="none"&&h+f>o)?"vertical":"horizontal"},_I=function(t,n,s){var o=s?t.left:t.top,i=s?t.right:t.bottom,l=s?t.width:t.height,c=s?n.left:n.top,d=s?n.right:n.bottom,h=s?n.width:n.height;return o===c||i===d||o+l/2===c+h/2},CI=function(t,n){var s;return Mu.some(function(o){var i=o[No].options.emptyInsertThreshold;if(!(!i||Df(o))){var l=Tn(o),c=t>=l.left-i&&t<=l.right+i,d=n>=l.top-i&&n<=l.bottom+i;if(c&&d)return s=o}}),s},d1=function(t){function n(i,l){return function(c,d,h,f){var m=c.options.group.name&&d.options.group.name&&c.options.group.name===d.options.group.name;if(i==null&&(l||m))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return n(i(c,d,h,f),l)(c,d,h,f);var y=(l?c:d).options.group.name;return i===!0||typeof i=="string"&&i===y||i.join&&i.indexOf(y)>-1}}var s={},o=t.group;(!o||nu(o)!="object")&&(o={name:o}),s.name=o.name,s.checkPull=n(o.pull,!0),s.checkPut=n(o.put),s.revertClone=o.revertClone,t.group=s},h1=function(){!c1&&St&&gt(St,"display","none")},f1=function(){!c1&&St&&gt(St,"display","")};ad&&document.addEventListener("click",function(e){if(Tu)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tu=!1,!1},!0);var Hi=function(t){if(ot){t=t.touches?t.touches[0]:t;var n=CI(t.clientX,t.clientY);if(n){var s={};for(var o in t)t.hasOwnProperty(o)&&(s[o]=t[o]);s.target=s.rootEl=n,s.preventDefault=void 0,s.stopPropagation=void 0,n[No]._onDragOver(s)}}},LI=function(t){ot&&ot.parentNode[No]._isOutsideThisEl(t.target)};function yt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Sa({},t),e[No]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return u1(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:yt.supportPointer!==!1&&"PointerEvent"in window&&!jr,emptyInsertThreshold:5};yc.initializePlugins(this,e,n);for(var s in n)!(s in t)&&(t[s]=n[s]);d1(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:wI,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?qt(e,"pointerdown",this._onTapStart):(qt(e,"mousedown",this._onTapStart),qt(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(qt(e,"dragover",this),qt(e,"dragenter",this)),Mu.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Sa(this,mI())}yt.prototype={constructor:yt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ul=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,ot):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,s=this.el,o=this.options,i=o.preventOnFilter,l=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(c||t).target,h=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,f=o.filter;if(EI(s),!ot&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||o.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&jr&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=Hs(d,o.draggable,s,!1),!(d&&d.animated)&&ou!==d)){if(Wl=Xo(d),Zr=Xo(d,o.draggable),typeof f=="function"){if(f.call(this,t,d,this)){ho({sortable:n,rootEl:h,name:"filter",targetEl:d,toEl:s,fromEl:s}),Io("filter",n,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(f&&(f=f.split(",").some(function(m){if(m=Hs(h,m.trim(),s,!1),m)return ho({sortable:n,rootEl:m,name:"filter",targetEl:d,fromEl:s,toEl:s}),Io("filter",n,{evt:t}),!0}),f)){i&&t.cancelable&&t.preventDefault();return}o.handle&&!Hs(h,o.handle,s,!1)||this._prepareDragStart(t,c,d)}}},_prepareDragStart:function(t,n,s){var o=this,i=o.el,l=o.options,c=i.ownerDocument,d;if(s&&!ot&&s.parentNode===i){var h=Tn(s);if(rn=i,ot=s,fn=ot.parentNode,Gi=ot.nextSibling,ou=s,zc=l.group,yt.dragged=ot,zi={target:ot,clientX:(n||t).clientX,clientY:(n||t).clientY},Rv=zi.clientX-h.left,Ov=zi.clientY-h.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,ot.style["will-change"]="all",d=function(){if(Io("delayEnded",o,{evt:t}),yt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Av&&o.nativeDraggable&&(ot.draggable=!0),o._triggerDragStart(t,n),ho({sortable:o,name:"choose",originalEvent:t}),Po(ot,l.chosenClass,!0)},l.ignore.split(",").forEach(function(f){a1(ot,f.trim(),Wd)}),qt(c,"dragover",Hi),qt(c,"mousemove",Hi),qt(c,"touchmove",Hi),qt(c,"mouseup",o._onDrop),qt(c,"touchend",o._onDrop),qt(c,"touchcancel",o._onDrop),Av&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ot.draggable=!0),Io("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(gc||$a))){if(yt.eventCanceled){this._onDrop();return}qt(c,"mouseup",o._disableDelayedDrag),qt(c,"touchend",o._disableDelayedDrag),qt(c,"touchcancel",o._disableDelayedDrag),qt(c,"mousemove",o._delayedDragTouchMoveHandler),qt(c,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&qt(c,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ot&&Wd(ot),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;Ft(t,"mouseup",this._disableDelayedDrag),Ft(t,"touchend",this._disableDelayedDrag),Ft(t,"touchcancel",this._disableDelayedDrag),Ft(t,"mousemove",this._delayedDragTouchMoveHandler),Ft(t,"touchmove",this._delayedDragTouchMoveHandler),Ft(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?qt(document,"pointermove",this._onTouchMove):n?qt(document,"touchmove",this._onTouchMove):qt(document,"mousemove",this._onTouchMove):(qt(ot,"dragend",this),qt(rn,"dragstart",this._onDragStart));try{document.selection?au(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(ql=!1,rn&&ot){Io("dragStarted",this,{evt:n}),this.nativeDraggable&&qt(document,"dragover",LI);var s=this.options;!t&&Po(ot,s.dragClass,!1),Po(ot,s.ghostClass,!0),yt.active=this,t&&this._appendGhost(),ho({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(ks){this._lastX=ks.clientX,this._lastY=ks.clientY,h1();for(var t=document.elementFromPoint(ks.clientX,ks.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ks.clientX,ks.clientY),t!==n);)n=t;if(ot.parentNode[No]._isOutsideThisEl(t),n)do{if(n[No]){var s=void 0;if(s=n[No]._onDragOver({clientX:ks.clientX,clientY:ks.clientY,target:t,rootEl:n}),s&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);f1()}},_onTouchMove:function(t){if(zi){var n=this.options,s=n.fallbackTolerance,o=n.fallbackOffset,i=t.touches?t.touches[0]:t,l=St&&Ql(St,!0),c=St&&l&&l.a,d=St&&l&&l.d,h=Vc&&jn&&Dv(jn),f=(i.clientX-zi.clientX+o.x)/(c||1)+(h?h[0]-jd[0]:0)/(c||1),m=(i.clientY-zi.clientY+o.y)/(d||1)+(h?h[1]-jd[1]:0)/(d||1);if(!yt.active&&!ql){if(s&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<s)return;this._onDragStart(t,!0)}if(St){l?(l.e+=f-(Gd||0),l.f+=m-(qd||0)):l={a:1,b:0,c:0,d:1,e:f,f:m};var y="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");gt(St,"webkitTransform",y),gt(St,"mozTransform",y),gt(St,"msTransform",y),gt(St,"transform",y),Gd=f,qd=m,ks=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!St){var t=this.options.fallbackOnBody?document.body:rn,n=Tn(ot,!0,Vc,!0,t),s=this.options;if(Vc){for(jn=t;gt(jn,"position")==="static"&&gt(jn,"transform")==="none"&&jn!==document;)jn=jn.parentNode;jn!==document.body&&jn!==document.documentElement?(jn===document&&(jn=js()),n.top+=jn.scrollTop,n.left+=jn.scrollLeft):jn=js(),jd=Dv(jn)}St=ot.cloneNode(!0),Po(St,s.ghostClass,!1),Po(St,s.fallbackClass,!0),Po(St,s.dragClass,!0),gt(St,"transition",""),gt(St,"transform",""),gt(St,"box-sizing","border-box"),gt(St,"margin",0),gt(St,"top",n.top),gt(St,"left",n.left),gt(St,"width",n.width),gt(St,"height",n.height),gt(St,"opacity","0.8"),gt(St,"position",Vc?"absolute":"fixed"),gt(St,"zIndex","100000"),gt(St,"pointerEvents","none"),yt.ghost=St,t.appendChild(St),gt(St,"transform-origin",Rv/parseInt(St.style.width)*100+"% "+Ov/parseInt(St.style.height)*100+"%")}},_onDragStart:function(t,n){var s=this,o=t.dataTransfer,i=s.options;if(Io("dragStart",this,{evt:t}),yt.eventCanceled){this._onDrop();return}Io("setupClone",this),yt.eventCanceled||(pn=r1(ot),pn.draggable=!1,pn.style["will-change"]="",this._hideClone(),Po(pn,this.options.chosenClass,!1),yt.clone=pn),s.cloneId=au(function(){Io("clone",s),!yt.eventCanceled&&(s.options.removeCloneOnHide||rn.insertBefore(pn,ot),s._hideClone(),ho({sortable:s,name:"clone"}))}),!n&&Po(ot,i.dragClass,!0),n?(Tu=!0,s._loopId=setInterval(s._emulateDragOver,50)):(Ft(document,"mouseup",s._onDrop),Ft(document,"touchend",s._onDrop),Ft(document,"touchcancel",s._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(s,o,ot)),qt(document,"drop",s),gt(ot,"transform","translateZ(0)")),ql=!0,s._dragStartId=au(s._dragStarted.bind(s,n,t)),qt(document,"selectstart",s),Mr=!0,jr&&gt(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,s=t.target,o,i,l,c=this.options,d=c.group,h=yt.active,f=zc===d,m=c.sort,y=Fn||h,k,b=this,I=!1;if(Qh)return;function T(q,Y){Io(q,b,Ws({evt:t,isOwner:f,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:i,canSort:m,fromSortable:y,target:s,completed:x,onMove:function(ue,_e){return Gc(rn,n,ot,o,ue,Tn(ue),t,_e)},changed:C},Y))}function E(){T("dragOverAnimationCapture"),b.captureAnimationState(),b!==y&&y.captureAnimationState()}function x(q){return T("dragOverCompleted",{insertion:q}),q&&(f?h._hideClone():h._showClone(b),b!==y&&(Po(ot,Fn?Fn.options.ghostClass:h.options.ghostClass,!1),Po(ot,c.ghostClass,!0)),Fn!==b&&b!==yt.active?Fn=b:b===yt.active&&Fn&&(Fn=null),y===b&&(b._ignoreWhileAnimating=s),b.animateAll(function(){T("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(s===ot&&!ot.animated||s===n&&!s.animated)&&(Ul=null),!c.dragoverBubble&&!t.rootEl&&s!==document&&(ot.parentNode[No]._isOutsideThisEl(t.target),!q&&Hi(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),I=!0}function C(){Do=Xo(ot),ei=Xo(ot,c.draggable),ho({sortable:b,name:"change",toEl:n,newIndex:Do,newDraggableIndex:ei,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),s=Hs(s,c.draggable,n,!0),T("dragOver"),yt.eventCanceled)return I;if(ot.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||b._ignoreWhileAnimating===s)return x(!1);if(Tu=!1,h&&!c.disabled&&(f?m||(l=fn!==rn):Fn===this||(this.lastPutMode=zc.checkPull(this,h,ot,t))&&d.checkPut(this,h,ot,t))){if(k=this._getDirection(t,s)==="vertical",o=Tn(ot),T("dragOverValid"),yt.eventCanceled)return I;if(l)return fn=rn,E(),this._hideClone(),T("revert"),yt.eventCanceled||(Gi?rn.insertBefore(ot,Gi):rn.appendChild(ot)),x(!0);var _=Df(n,c.draggable);if(!_||$I(t,k,this)&&!_.animated){if(_===ot)return x(!1);if(_&&n===t.target&&(s=_),s&&(i=Tn(s)),Gc(rn,n,ot,o,s,i,t,!!s)!==!1)return E(),n.appendChild(ot),fn=n,C(),x(!0)}else if(_&&xI(t,k,this)){var $=ir(n,0,c,!0);if($===ot)return x(!1);if(s=$,i=Tn(s),Gc(rn,n,ot,o,s,i,t,!1)!==!1)return E(),n.insertBefore(ot,$),fn=n,C(),x(!0)}else if(s.parentNode===n){i=Tn(s);var R=0,M,O=ot.parentNode!==n,A=!_I(ot.animated&&ot.toRect||o,s.animated&&s.toRect||i,k),U=k?"top":"left",F=Pv(s,"top","top")||Pv(ot,"top","top"),j=F?F.scrollTop:void 0;Ul!==s&&(M=i[U],Yr=!1,Hc=!A&&c.invertSwap||O),R=TI(t,s,i,k,A?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,Hc,Ul===s);var Z;if(R!==0){var X=Xo(ot);do X-=R,Z=fn.children[X];while(Z&&(gt(Z,"display")==="none"||Z===St))}if(R===0||Z===s)return x(!1);Ul=s,Kr=R;var re=s.nextElementSibling,K=!1;K=R===1;var ae=Gc(rn,n,ot,o,s,i,t,K);if(ae!==!1)return(ae===1||ae===-1)&&(K=ae===1),Qh=!0,setTimeout(II,30),E(),K&&!re?n.appendChild(ot):s.parentNode.insertBefore(ot,K?re:s),F&&l1(F,0,j-F.scrollTop),fn=ot.parentNode,M!==void 0&&!Hc&&(su=Math.abs(M-Tn(s)[U])),C(),x(!0)}if(n.contains(ot))return x(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Ft(document,"mousemove",this._onTouchMove),Ft(document,"touchmove",this._onTouchMove),Ft(document,"pointermove",this._onTouchMove),Ft(document,"dragover",Hi),Ft(document,"mousemove",Hi),Ft(document,"touchmove",Hi)},_offUpEvents:function(){var t=this.el.ownerDocument;Ft(t,"mouseup",this._onDrop),Ft(t,"touchend",this._onDrop),Ft(t,"pointerup",this._onDrop),Ft(t,"touchcancel",this._onDrop),Ft(document,"selectstart",this)},_onDrop:function(t){var n=this.el,s=this.options;if(Do=Xo(ot),ei=Xo(ot,s.draggable),Io("drop",this,{evt:t}),fn=ot&&ot.parentNode,Do=Xo(ot),ei=Xo(ot,s.draggable),yt.eventCanceled){this._nulling();return}ql=!1,Hc=!1,Yr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ef(this.cloneId),ef(this._dragStartId),this.nativeDraggable&&(Ft(document,"drop",this),Ft(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),jr&&gt(document.body,"user-select",""),gt(ot,"transform",""),t&&(Mr&&(t.cancelable&&t.preventDefault(),!s.dropBubble&&t.stopPropagation()),St&&St.parentNode&&St.parentNode.removeChild(St),(rn===fn||Fn&&Fn.lastPutMode!=="clone")&&pn&&pn.parentNode&&pn.parentNode.removeChild(pn),ot&&(this.nativeDraggable&&Ft(ot,"dragend",this),Wd(ot),ot.style["will-change"]="",Mr&&!ql&&Po(ot,Fn?Fn.options.ghostClass:this.options.ghostClass,!1),Po(ot,this.options.chosenClass,!1),ho({sortable:this,name:"unchoose",toEl:fn,newIndex:null,newDraggableIndex:null,originalEvent:t}),rn!==fn?(Do>=0&&(ho({rootEl:fn,name:"add",toEl:fn,fromEl:rn,originalEvent:t}),ho({sortable:this,name:"remove",toEl:fn,originalEvent:t}),ho({rootEl:fn,name:"sort",toEl:fn,fromEl:rn,originalEvent:t}),ho({sortable:this,name:"sort",toEl:fn,originalEvent:t})),Fn&&Fn.save()):Do!==Wl&&Do>=0&&(ho({sortable:this,name:"update",toEl:fn,originalEvent:t}),ho({sortable:this,name:"sort",toEl:fn,originalEvent:t})),yt.active&&((Do==null||Do===-1)&&(Do=Wl,ei=Zr),ho({sortable:this,name:"end",toEl:fn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Io("nulling",this),rn=ot=fn=St=Gi=pn=ou=oi=zi=ks=Mr=Do=ei=Wl=Zr=Ul=Kr=Fn=zc=yt.dragged=yt.ghost=yt.clone=yt.active=null,Au.forEach(function(t){t.checked=!0}),Au.length=Gd=qd=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":ot&&(this._onDragOver(t),SI(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,s=this.el.children,o=0,i=s.length,l=this.options;o<i;o++)n=s[o],Hs(n,l.draggable,this.el,!1)&&t.push(n.getAttribute(l.dataIdAttr)||AI(n));return t},sort:function(t,n){var s={},o=this.el;this.toArray().forEach(function(i,l){var c=o.children[l];Hs(c,this.options.draggable,o,!1)&&(s[i]=c)},this),n&&this.captureAnimationState(),t.forEach(function(i){s[i]&&(o.removeChild(s[i]),o.appendChild(s[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Hs(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var s=this.options;if(n===void 0)return s[t];var o=yc.modifyOption(this,t,n);typeof o<"u"?s[t]=o:s[t]=n,t==="group"&&d1(s)},destroy:function(){Io("destroy",this);var t=this.el;t[No]=null,Ft(t,"mousedown",this._onTapStart),Ft(t,"touchstart",this._onTapStart),Ft(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ft(t,"dragover",this),Ft(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Mu.splice(Mu.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!oi){if(Io("hideClone",this),yt.eventCanceled)return;gt(pn,"display","none"),this.options.removeCloneOnHide&&pn.parentNode&&pn.parentNode.removeChild(pn),oi=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(oi){if(Io("showClone",this),yt.eventCanceled)return;ot.parentNode==rn&&!this.options.group.revertClone?rn.insertBefore(pn,ot):Gi?rn.insertBefore(pn,Gi):rn.appendChild(pn),this.options.group.revertClone&&this.animate(ot,pn),gt(pn,"display",""),oi=!1}}};function SI(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Gc(e,t,n,s,o,i,l,c){var d,h=e[No],f=h.options.onMove,m;return window.CustomEvent&&!$a&&!gc?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=e,d.dragged=n,d.draggedRect=s,d.related=o||t,d.relatedRect=i||Tn(t),d.willInsertAfter=c,d.originalEvent=l,e.dispatchEvent(d),f&&(m=f.call(h,d,l)),m}function Wd(e){e.draggable=!1}function II(){Qh=!1}function xI(e,t,n){var s=Tn(ir(n.el,0,n.options,!0)),o=10;return t?e.clientX<s.left-o||e.clientY<s.top&&e.clientX<s.right:e.clientY<s.top-o||e.clientY<s.bottom&&e.clientX<s.left}function $I(e,t,n){var s=Tn(Df(n.el,n.options.draggable)),o=10;return t?e.clientX>s.right+o||e.clientX<=s.right&&e.clientY>s.bottom&&e.clientX>=s.left:e.clientX>s.right&&e.clientY>s.top||e.clientX<=s.right&&e.clientY>s.bottom+o}function TI(e,t,n,s,o,i,l,c){var d=s?e.clientY:e.clientX,h=s?n.height:n.width,f=s?n.top:n.left,m=s?n.bottom:n.right,y=!1;if(!l){if(c&&su<h*o){if(!Yr&&(Kr===1?d>f+h*i/2:d<m-h*i/2)&&(Yr=!0),Yr)y=!0;else if(Kr===1?d<f+su:d>m-su)return-Kr}else if(d>f+h*(1-o)/2&&d<m-h*(1-o)/2)return MI(t)}return y=y||l,y&&(d<f+h*i/2||d>m-h*i/2)?d>f+h/2?1:-1:0}function MI(e){return Xo(ot)<Xo(e)?1:-1}function AI(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,s=0;n--;)s+=t.charCodeAt(n);return s.toString(36)}function EI(e){Au.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var s=t[n];s.checked&&Au.push(s)}}function au(e){return setTimeout(e,0)}function ef(e){return clearTimeout(e)}ad&&qt(document,"touchmove",function(e){(yt.active||ql)&&e.cancelable&&e.preventDefault()});yt.utils={on:qt,off:Ft,css:gt,find:a1,is:function(t,n){return!!Hs(t,n,t,!1)},extend:pI,throttle:i1,closest:Hs,toggleClass:Po,clone:r1,index:Xo,nextTick:au,cancelNextTick:ef,detectDirection:u1,getChild:ir};yt.get=function(e){return e[No]};yt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(s){if(!s.prototype||!s.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(s));s.utils&&(yt.utils=Ws(Ws({},yt.utils),s.utils)),yc.mount(s)})};yt.create=function(e,t){return new yt(e,t)};yt.version=uI;var Cn=[],Ar,tf,nf=!1,Zd,Kd,Eu,Er;function PI(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var s=n.originalEvent;this.sortable.nativeDraggable?qt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?qt(document,"pointermove",this._handleFallbackAutoScroll):s.touches?qt(document,"touchmove",this._handleFallbackAutoScroll):qt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var s=n.originalEvent;!this.options.dragOverBubble&&!s.rootEl&&this._handleAutoScroll(s)},drop:function(){this.sortable.nativeDraggable?Ft(document,"dragover",this._handleAutoScroll):(Ft(document,"pointermove",this._handleFallbackAutoScroll),Ft(document,"touchmove",this._handleFallbackAutoScroll),Ft(document,"mousemove",this._handleFallbackAutoScroll)),Bv(),iu(),vI()},nulling:function(){Eu=tf=Ar=nf=Er=Zd=Kd=null,Cn.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,s){var o=this,i=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(i,l);if(Eu=n,s||this.options.forceAutoScrollFallback||gc||$a||jr){Yd(n,this.options,c,s);var d=si(c,!0);nf&&(!Er||i!==Zd||l!==Kd)&&(Er&&Bv(),Er=setInterval(function(){var h=si(document.elementFromPoint(i,l),!0);h!==d&&(d=h,iu()),Yd(n,o.options,h,s)},10),Zd=i,Kd=l)}else{if(!this.options.bubbleScroll||si(c,!0)===js()){iu();return}Yd(n,this.options,si(c,!1),!1)}}},Sa(e,{pluginName:"scroll",initializeByDefault:!0})}function iu(){Cn.forEach(function(e){clearInterval(e.pid)}),Cn=[]}function Bv(){clearInterval(Er)}var Yd=i1(function(e,t,n,s){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,c=t.scrollSpeed,d=js(),h=!1,f;tf!==n&&(tf=n,iu(),Ar=t.scroll,f=t.scrollFn,Ar===!0&&(Ar=si(n,!0)));var m=0,y=Ar;do{var k=y,b=Tn(k),I=b.top,T=b.bottom,E=b.left,x=b.right,C=b.width,_=b.height,$=void 0,R=void 0,M=k.scrollWidth,O=k.scrollHeight,A=gt(k),U=k.scrollLeft,F=k.scrollTop;k===d?($=C<M&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),R=_<O&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):($=C<M&&(A.overflowX==="auto"||A.overflowX==="scroll"),R=_<O&&(A.overflowY==="auto"||A.overflowY==="scroll"));var j=$&&(Math.abs(x-o)<=l&&U+C<M)-(Math.abs(E-o)<=l&&!!U),Z=R&&(Math.abs(T-i)<=l&&F+_<O)-(Math.abs(I-i)<=l&&!!F);if(!Cn[m])for(var X=0;X<=m;X++)Cn[X]||(Cn[X]={});(Cn[m].vx!=j||Cn[m].vy!=Z||Cn[m].el!==k)&&(Cn[m].el=k,Cn[m].vx=j,Cn[m].vy=Z,clearInterval(Cn[m].pid),(j!=0||Z!=0)&&(h=!0,Cn[m].pid=setInterval((function(){s&&this.layer===0&&yt.active._onTouchMove(Eu);var re=Cn[this.layer].vy?Cn[this.layer].vy*c:0,K=Cn[this.layer].vx?Cn[this.layer].vx*c:0;typeof f=="function"&&f.call(yt.dragged.parentNode[No],K,re,e,Eu,Cn[this.layer].el)!=="continue"||l1(Cn[this.layer].el,K,re)}).bind({layer:m}),24))),m++}while(t.bubbleScroll&&y!==d&&(y=si(y,!1)));nf=h}},30),p1=function(t){var n=t.originalEvent,s=t.putSortable,o=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,c=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(n){var h=s||i;c();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(f.clientX,f.clientY);d(),h&&!h.el.contains(m)&&(l("spill"),this.onSpill({dragEl:o,putSortable:s}))}};function Rf(){}Rf.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,s=t.putSortable;this.sortable.captureAnimationState(),s&&s.captureAnimationState();var o=ir(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),s&&s.animateAll()},drop:p1};Sa(Rf,{pluginName:"revertOnSpill"});function Of(){}Of.prototype={onSpill:function(t){var n=t.dragEl,s=t.putSortable,o=s||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:p1};Sa(Of,{pluginName:"removeOnSpill"});yt.mount(new PI);yt.mount(Of,Rf);const DI=["data-id"],RI={key:0,class:"order-overlay"},ll={__name:"DraggableList",props:{items:{type:Array,required:!0},itemKey:{type:String,default:"id"},pinnedKey:{type:String,default:null},disabled:{type:Boolean,default:!1},layout:{type:String,default:"list"},showOrderOverlay:{type:Boolean,default:!0}},emits:["reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(!1);let l=null;const c=D([...n.items]);Ye(()=>n.items,k=>{c.value=[...k]},{deep:!0}),Ye(()=>n.disabled,k=>{l&&l.option("disabled",k)});const d=k=>{i.value=!1;const{oldIndex:b,newIndex:I}=k;if(b===I)return;const T=c.value.splice(b,1)[0];c.value.splice(I,0,T);const E=c.value.map((x,C)=>({id:x[n.itemKey],displayOrder:C+1}));s("reorder",{items:c.value,changes:E})},h=()=>{i.value=!0},f=k=>{if(!n.pinnedKey)return!0;const b=k.dragged.dataset.id,I=c.value.find(_=>String(_[n.itemKey])===b);if(!I)return!0;const T=I[n.pinnedKey],E=k.related.dataset.id,x=c.value.find(_=>String(_[n.itemKey])===E);if(!x)return!0;const C=x[n.pinnedKey];return T===C},m=()=>{o.value&&(l=yt.create(o.value,{animation:200,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",disabled:n.disabled,onMove:f,onStart:h,onEnd:d}))},y=()=>{l&&(l.destroy(),l=null)};return un(()=>{cn(()=>{m()})}),Ln(()=>{y()}),(k,b)=>(p(),g("div",{ref_key:"listRef",ref:o,class:le(["draggable-list",{"draggable-grid":e.layout==="grid","is-dragging":i.value}])},[(p(!0),g(Se,null,je(c.value,(I,T)=>(p(),g("div",{key:I[e.itemKey],"data-id":I[e.itemKey],class:"draggable-item"},[mo(k.$slots,"item",{element:I,index:T}),i.value&&e.showOrderOverlay?(p(),g("div",RI,w(T+1),1)):P("",!0)],8,DI))),128))],2))}},OI=["title"],rl={__name:"DragHandle",props:{disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(p(),g("span",{class:le(["drag-handle",{disabled:e.disabled}]),title:e.disabled?"":"Drag to reorder"},[...n[0]||(n[0]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><circle cx="5" cy="3" r="1.5"></circle><circle cx="11" cy="3" r="1.5"></circle><circle cx="5" cy="8" r="1.5"></circle><circle cx="11" cy="8" r="1.5"></circle><circle cx="5" cy="13" r="1.5"></circle><circle cx="11" cy="13" r="1.5"></circle></svg>',1)])],10,OI))}},NI={class:"checklists-tab"},BI={class:"tab-header"},FI={class:"button-group"},UI={class:"view-toggle"},zI={key:0,class:"status-pills"},HI={key:1,class:"status-pills"},VI={key:2,class:"status-pills"},GI={key:3,class:"status-pills"},qI={class:"filters-section"},jI={class:"search-group"},WI=["placeholder"],ZI={class:"checklist-items-list"},KI={key:0,class:"empty-state"},YI={class:"checklist-item-card"},JI={class:"checklist-item-content"},XI=["onClick"],QI={key:0,class:"loading-state"},ex={key:1,class:"empty-state"},tx={class:"filters-section"},nx={class:"search-group"},ox=["placeholder"],sx={class:"report-list"},ax={key:0,class:"empty-state"},ix=["onClick"],lx={class:"report-card-title"},rx={class:"expand-icon"},cx={class:"report-card-stats"},ux={key:0,class:"report-card-body"},dx={class:"task-text"},hx={key:0,class:"task-completed-by"},fx={key:0,class:"loading-state"},px={key:1,class:"empty-state"},vx={class:"filters-section"},mx={class:"search-group"},gx=["placeholder"],yx={class:"report-list"},kx={key:0,class:"empty-state"},bx=["onClick"],wx={class:"report-card-title"},_x={class:"expand-icon"},Cx={class:"report-card-stats"},Lx={key:0,class:"report-card-body"},Sx={key:0,class:"empty-state small"},Ix={class:"task-text"},xx={key:0,class:"task-completed-by"},$x={key:0,class:"loading-state"},Tx={key:1,class:"empty-state"},Mx={class:"filters-section"},Ax={class:"search-group"},Ex=["placeholder"],Px={class:"report-list"},Dx={key:0,class:"empty-state"},Rx=["onClick"],Ox={class:"report-card-title"},Nx={class:"expand-icon"},Bx={class:"report-card-stats"},Fx={class:"stat-badge secondary"},Ux={key:0,class:"report-card-body nested-body"},zx=["onClick"],Hx={class:"nested-card-title"},Vx={class:"expand-icon"},Gx={class:"nested-card-stats"},qx={key:0,class:"nested-card-body"},jx={class:"task-text"},Wx={key:0,class:"task-completed-by"},Zx={key:0,class:"loading-state"},Kx={key:1,class:"empty-state"},Yx={class:"filters-section"},Jx={class:"search-group"},Xx=["placeholder"],Qx={class:"report-list"},e$={key:0,class:"empty-state"},t$=["onClick"],n$={class:"report-card-title"},o$={class:"expand-icon"},s$={class:"report-card-title-text"},a$={key:0,class:"report-card-description"},i$={class:"report-card-stats"},l$={class:"stat-badge secondary"},r$={key:0,class:"report-card-body nested-body"},c$=["onClick"],u$={class:"nested-card-title"},d$={class:"expand-icon"},h$={class:"nested-card-stats"},f$={key:0,class:"nested-card-body"},p$={class:"task-text"},v$={key:0,class:"task-completed-by"},m$={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null},detailedReport:{type:Object,default:null},isLoadingDetailedReport:{type:Boolean,default:!1}},emits:["add-checklist-item","select-checklist-item","reorder","load-detailed-report"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D("define"),l=D(""),c=D(""),d=D(""),h=D(""),f=D(""),m=D("all"),y=D("all"),k=D("all"),b=D("all"),I=D(new Set),T=D(new Set),E=D(new Set),x=D(new Set),C=D(new Set),_=D(new Set),$=ke=>{i.value=ke,(ke==="byPerson"||ke==="byTask"||ke==="byCheckpoint"||ke==="byArea")&&!s.detailedReport&&!s.isLoadingDetailedReport&&o("load-detailed-report")},R=ke=>{I.value.has(ke)?I.value.delete(ke):(I.value.clear(),I.value.add(ke)),I.value=new Set(I.value)},M=ke=>{T.value.has(ke)?T.value.delete(ke):(T.value.clear(),T.value.add(ke)),T.value=new Set(T.value)},O=ke=>{E.value.has(ke)?(E.value.delete(ke),C.value.clear()):(E.value.clear(),C.value.clear(),E.value.add(ke)),E.value=new Set(E.value),C.value=new Set(C.value)},A=ke=>{x.value.has(ke)?(x.value.delete(ke),_.value.clear()):(x.value.clear(),_.value.clear(),x.value.add(ke)),x.value=new Set(x.value),_.value=new Set(_.value)},U=(ke,H)=>{const J=`${ke}:${H}`;C.value.has(J)?C.value.delete(J):([...C.value].filter(ie=>ie.startsWith(`${ke}:`)).forEach(ie=>C.value.delete(ie)),C.value.add(J)),C.value=new Set(C.value)},F=(ke,H)=>{const J=`${ke}:${H}`;_.value.has(J)?_.value.delete(J):([..._.value].filter(ie=>ie.startsWith(`${ke}:`)).forEach(ie=>_.value.delete(ie)),_.value.add(J)),_.value=new Set(_.value)},j=z(()=>{if(!l.value.trim())return s.checklistItems;const ke=l.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(H=>{const J=(H.text||"").toLowerCase();return ke.every(de=>J.includes(de))})}),Z=z(()=>[...j.value].sort((ke,H)=>ke.displayOrder!==H.displayOrder?ke.displayOrder-H.displayOrder:es(ke.text,H.text))),X=(ke,H)=>ke===0?"incomplete":ke===H?"complete":"partial",re=(ke,H)=>ke===0?"not-started":ke===H?"complete":"partial",K=z(()=>{if(!s.detailedReport?.detailedByPerson)return{total:0,incomplete:0,partial:0,complete:0};const ke=s.detailedReport.detailedByPerson;return{total:ke.length,incomplete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="incomplete").length,partial:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="partial").length,complete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="complete").length}}),ae=z(()=>{if(!s.detailedReport?.detailedByTask)return{total:0,incomplete:0,partial:0,complete:0};const ke=s.detailedReport.detailedByTask;return{total:ke.length,incomplete:ke.filter(H=>X(H.completedCount,H.applicableCount)==="incomplete").length,partial:ke.filter(H=>X(H.completedCount,H.applicableCount)==="partial").length,complete:ke.filter(H=>X(H.completedCount,H.applicableCount)==="complete").length}}),q=z(()=>{if(!s.detailedReport?.detailedByCheckpoint)return{total:0,incomplete:0,partial:0,complete:0};const ke=s.detailedReport.detailedByCheckpoint;return{total:ke.length,incomplete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="incomplete").length,partial:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="partial").length,complete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="complete").length}}),Y=z(()=>{if(!s.detailedReport?.detailedByArea)return{total:0,incomplete:0,partial:0,complete:0};const ke=s.detailedReport.detailedByArea;return{total:ke.length,incomplete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="incomplete").length,partial:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="partial").length,complete:ke.filter(H=>X(H.completedTasks,H.totalTasks)==="complete").length}}),te=z(()=>{if(!s.detailedReport?.detailedByPerson)return[];let ke=s.detailedReport.detailedByPerson;if(m.value!=="all"&&(ke=ke.filter(H=>X(H.completedTasks,H.totalTasks)===m.value)),c.value.trim()){const H=c.value.toLowerCase().trim().split(/\s+/);ke=ke.filter(J=>{const de=(J.marshalName||"").toLowerCase();return H.every(ie=>de.includes(ie))})}return ke}),ue=z(()=>{if(!s.detailedReport?.detailedByTask)return[];let ke=s.detailedReport.detailedByTask;if(y.value!=="all"&&(ke=ke.filter(H=>X(H.completedCount,H.applicableCount)===y.value)),d.value.trim()){const H=d.value.toLowerCase().trim().split(/\s+/);ke=ke.filter(J=>{const de=(J.text||"").toLowerCase();return H.every(ie=>de.includes(ie))})}return ke}),_e=z(()=>{if(!s.detailedReport?.detailedByCheckpoint)return[];let ke=[...s.detailedReport.detailedByCheckpoint];if(k.value!=="all"&&(ke=ke.filter(H=>X(H.completedTasks,H.totalTasks)===k.value)),h.value.trim()){const H=h.value.toLowerCase().trim().split(/\s+/);ke=ke.filter(J=>{const de=(J.checkpointName||"").toLowerCase();return H.every(ie=>de.includes(ie))})}return ke.sort((H,J)=>es(H.checkpointName,J.checkpointName)),ke}),Te=z(()=>{if(!s.detailedReport?.detailedByArea)return[];let ke=[...s.detailedReport.detailedByArea];if(b.value!=="all"&&(ke=ke.filter(H=>X(H.completedTasks,H.totalTasks)===b.value)),f.value.trim()){const H=f.value.toLowerCase().trim().split(/\s+/);ke=ke.filter(J=>{const de=(J.areaName||"").toLowerCase();return H.every(ie=>de.includes(ie))})}return ke.sort((H,J)=>es(H.areaName,J.areaName)),ke}),Pe=ke=>[...ke].sort((H,J)=>H.displayOrder!==J.displayOrder?H.displayOrder-J.displayOrder:es(H.text,J.text)),De=({changes:ke})=>{o("reorder",ke)};return(ke,H)=>(p(),g("div",NI,[r("div",BI,[r("div",FI,[r("div",UI,[r("button",{class:le(["view-toggle-btn",{active:i.value==="define"}]),onClick:H[0]||(H[0]=J=>$("define"))}," Define ",2),r("button",{class:le(["view-toggle-btn",{active:i.value==="byArea"}]),onClick:H[1]||(H[1]=J=>$("byArea"))}," By "+w(B(n).area),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byCheckpoint"}]),onClick:H[2]||(H[2]=J=>$("byCheckpoint"))}," By "+w(B(n).checkpoint),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byPerson"}]),onClick:H[3]||(H[3]=J=>$("byPerson"))}," By "+w(B(n).person),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byTask"}]),onClick:H[4]||(H[4]=J=>$("byTask"))}," By "+w(B(n).checklist),3)]),i.value==="define"?(p(),g("button",{key:0,onClick:H[5]||(H[5]=J=>ke.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(B(n).checklist),1)):P("",!0)]),i.value==="byArea"&&Y.value.total>0?(p(),g("div",zI,[Ee(Pt,{variant:"neutral",active:b.value==="all",onClick:H[6]||(H[6]=J=>b.value="all")},{default:Ve(()=>[Je(w(Y.value.total)+" total ",1)]),_:1},8,["active"]),Y.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:b.value==="incomplete",onClick:H[7]||(H[7]=J=>b.value="incomplete")},{default:Ve(()=>[Je(w(Y.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),Y.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:b.value==="partial",onClick:H[8]||(H[8]=J=>b.value="partial")},{default:Ve(()=>[Je(w(Y.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),Y.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:b.value==="complete",onClick:H[9]||(H[9]=J=>b.value="complete")},{default:Ve(()=>[Je(w(Y.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byCheckpoint"&&q.value.total>0?(p(),g("div",HI,[Ee(Pt,{variant:"neutral",active:k.value==="all",onClick:H[10]||(H[10]=J=>k.value="all")},{default:Ve(()=>[Je(w(q.value.total)+" total ",1)]),_:1},8,["active"]),q.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:k.value==="incomplete",onClick:H[11]||(H[11]=J=>k.value="incomplete")},{default:Ve(()=>[Je(w(q.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),q.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:k.value==="partial",onClick:H[12]||(H[12]=J=>k.value="partial")},{default:Ve(()=>[Je(w(q.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),q.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:k.value==="complete",onClick:H[13]||(H[13]=J=>k.value="complete")},{default:Ve(()=>[Je(w(q.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byPerson"&&K.value.total>0?(p(),g("div",VI,[Ee(Pt,{variant:"neutral",active:m.value==="all",onClick:H[14]||(H[14]=J=>m.value="all")},{default:Ve(()=>[Je(w(K.value.total)+" total ",1)]),_:1},8,["active"]),K.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:m.value==="incomplete",onClick:H[15]||(H[15]=J=>m.value="incomplete")},{default:Ve(()=>[Je(w(K.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),K.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:m.value==="partial",onClick:H[16]||(H[16]=J=>m.value="partial")},{default:Ve(()=>[Je(w(K.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),K.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:m.value==="complete",onClick:H[17]||(H[17]=J=>m.value="complete")},{default:Ve(()=>[Je(w(K.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byTask"&&ae.value.total>0?(p(),g("div",GI,[Ee(Pt,{variant:"neutral",active:y.value==="all",onClick:H[18]||(H[18]=J=>y.value="all")},{default:Ve(()=>[Je(w(ae.value.total)+" total ",1)]),_:1},8,["active"]),ae.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:y.value==="incomplete",onClick:H[19]||(H[19]=J=>y.value="incomplete")},{default:Ve(()=>[Je(w(ae.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),ae.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:y.value==="partial",onClick:H[20]||(H[20]=J=>y.value="partial")},{default:Ve(()=>[Je(w(ae.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),ae.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:y.value==="complete",onClick:H[21]||(H[21]=J=>y.value="complete")},{default:Ve(()=>[Je(w(ae.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),i.value==="define"?(p(),g(Se,{key:0},[r("div",qI,[r("div",jI,[We(r("input",{"onUpdate:modelValue":H[22]||(H[22]=J=>l.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checklists}...`},null,8,WI),[[st,l.value]])])]),r("div",ZI,[j.value.length===0?(p(),g("div",KI,[r("p",null,w(l.value?`No ${B(n).checklists} match your search.`:`No ${B(n).checklists} yet. Create one to get started!`),1)])):(p(),qe(ll,{key:1,items:Z.value,"item-key":"itemId",disabled:!!l.value,onReorder:De},{item:Ve(({element:J})=>[r("div",YI,[l.value?P("",!0):(p(),qe(rl,{key:0})),r("div",JI,[r("div",{class:"checklist-item-title",onClick:de=>ke.$emit("select-checklist-item",J,"details")},[r("strong",null,w(J.text),1)],8,XI),Ee(ol,{class:"checklist-item-scopes","scope-configurations":J.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:de=>ke.$emit("select-checklist-item",J,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])])]),_:1},8,["items","disabled"]))])],64)):i.value==="byPerson"?(p(),g(Se,{key:1},[e.isLoadingDetailedReport?(p(),g("div",QI,[...H[27]||(H[27]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",tx,[r("div",nx,[We(r("input",{"onUpdate:modelValue":H[23]||(H[23]=J=>c.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).people}...`},null,8,ox),[[st,c.value]])])]),r("div",sx,[te.value.length===0?(p(),g("div",ax,[r("p",null,w(c.value||m.value!=="all"?`No ${B(n).people} match your filters.`:`No ${B(n).people} with ${B(n).checklists}.`),1)])):P("",!0),(p(!0),g(Se,null,je(te.value,J=>(p(),g("div",{key:J.marshalId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>R(J.marshalId)},[r("div",lx,[r("span",rx,w(I.value.has(J.marshalId)?"":""),1),r("strong",null,w(J.marshalName),1)]),r("div",cx,[r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},w(J.completedTasks)+" / "+w(J.totalTasks),3)])],8,ix),I.value.has(J.marshalId)?(p(),g("div",ux,[(p(!0),g(Se,null,je(Pe(J.tasks),de=>(p(),g("div",{key:de.itemId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},w(de.isCompleted?"":""),3),r("span",dx,w(de.text),1),de.isCompleted&&de.completedBy?(p(),g("span",hx," by "+w(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",ex,[...H[28]||(H[28]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byTask"?(p(),g(Se,{key:2},[e.isLoadingDetailedReport?(p(),g("div",fx,[...H[29]||(H[29]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",vx,[r("div",mx,[We(r("input",{"onUpdate:modelValue":H[24]||(H[24]=J=>d.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checklists}...`},null,8,gx),[[st,d.value]])])]),r("div",yx,[ue.value.length===0?(p(),g("div",kx,[r("p",null,w(d.value||y.value!=="all"?`No ${B(n).checklists} match your filters.`:`No ${B(n).checklists} defined.`),1)])):P("",!0),(p(!0),g(Se,null,je(ue.value,J=>(p(),g("div",{key:J.itemId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>M(J.itemId)},[r("div",wx,[r("span",_x,w(T.value.has(J.itemId)?"":""),1),r("strong",null,w(J.text),1)]),r("div",Cx,[r("span",{class:le(["stat-badge",re(J.completedCount,J.applicableCount)])},w(J.completedCount)+" / "+w(J.applicableCount),3)])],8,bx),T.value.has(J.itemId)?(p(),g("div",Lx,[J.marshals.length===0?(p(),g("div",Sx,[r("p",null,"No "+w(B(n).people)+" assigned to this "+w(B(n).checklist)+".",1)])):P("",!0),(p(!0),g(Se,null,je(J.marshals,de=>(p(),g("div",{key:de.marshalId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},w(de.isCompleted?"":""),3),r("span",Ix,w(de.marshalName),1),de.isCompleted&&de.completedBy?(p(),g("span",xx," by "+w(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",px,[...H[30]||(H[30]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byArea"?(p(),g(Se,{key:3},[e.isLoadingDetailedReport?(p(),g("div",$x,[...H[31]||(H[31]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",Mx,[r("div",Ax,[We(r("input",{"onUpdate:modelValue":H[25]||(H[25]=J=>f.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).areas}...`},null,8,Ex),[[st,f.value]])])]),r("div",Px,[Te.value.length===0?(p(),g("div",Dx,[r("p",null,w(f.value||b.value!=="all"?`No ${B(n).areas} match your filters.`:`No ${B(n).areas} with ${B(n).people}.`),1)])):P("",!0),(p(!0),g(Se,null,je(Te.value,J=>(p(),g("div",{key:J.areaId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>A(J.areaId)},[r("div",Ox,[r("span",Nx,w(x.value.has(J.areaId)?"":""),1),r("strong",null,w(J.areaName),1)]),r("div",Bx,[r("span",Fx,w(J.totalPeople)+" "+w(J.totalPeople===1?B(n).person:B(n).people),1),r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},w(J.completedTasks)+" / "+w(J.totalTasks),3)])],8,Rx),x.value.has(J.areaId)?(p(),g("div",Ux,[(p(!0),g(Se,null,je(J.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(ie=>F(J.areaId,de.marshalId),["stop"])},[r("div",Hx,[r("span",Vx,w(_.value.has(`${J.areaId}:${de.marshalId}`)?"":""),1),r("strong",null,w(de.marshalName),1)]),r("div",Gx,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},w(de.completedTasks)+" / "+w(de.totalTasks),3)])],8,zx),_.value.has(`${J.areaId}:${de.marshalId}`)?(p(),g("div",qx,[(p(!0),g(Se,null,je(Pe(de.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},w(ie.isCompleted?"":""),3),r("span",jx,w(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",Wx," by "+w(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",Tx,[...H[32]||(H[32]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byCheckpoint"?(p(),g(Se,{key:4},[e.isLoadingDetailedReport?(p(),g("div",Zx,[...H[33]||(H[33]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Se,{key:2},[r("div",Yx,[r("div",Jx,[We(r("input",{"onUpdate:modelValue":H[26]||(H[26]=J=>h.value=J),type:"text",class:"search-input",placeholder:`Search ${B(n).checkpoints}...`},null,8,Xx),[[st,h.value]])])]),r("div",Qx,[_e.value.length===0?(p(),g("div",e$,[r("p",null,w(h.value||k.value!=="all"?`No ${B(n).checkpoints} match your filters.`:`No ${B(n).checkpoints} with ${B(n).people}.`),1)])):P("",!0),(p(!0),g(Se,null,je(_e.value,J=>(p(),g("div",{key:J.checkpointId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>O(J.checkpointId)},[r("div",n$,[r("span",o$,w(E.value.has(J.checkpointId)?"":""),1),r("div",s$,[r("strong",null,w(J.checkpointName),1),J.checkpointDescription?(p(),g("span",a$,w(J.checkpointDescription),1)):P("",!0)])]),r("div",i$,[r("span",l$,w(J.totalPeople)+" "+w(J.totalPeople===1?B(n).person:B(n).people),1),r("span",{class:le(["stat-badge",re(J.completedTasks,J.totalTasks)])},w(J.completedTasks)+" / "+w(J.totalTasks),3)])],8,t$),E.value.has(J.checkpointId)?(p(),g("div",r$,[(p(!0),g(Se,null,je(J.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(ie=>U(J.checkpointId,de.marshalId),["stop"])},[r("div",u$,[r("span",d$,w(C.value.has(`${J.checkpointId}:${de.marshalId}`)?"":""),1),r("strong",null,w(de.marshalName),1)]),r("div",h$,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},w(de.completedTasks)+" / "+w(de.totalTasks),3)])],8,c$),C.value.has(`${J.checkpointId}:${de.marshalId}`)?(p(),g("div",f$,[(p(!0),g(Se,null,je(Pe(de.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},w(ie.isCompleted?"":""),3),r("span",p$,w(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",v$," by "+w(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",Kx,[...H[34]||(H[34]=[r("p",null,"No report data available.",-1)])]))],64)):P("",!0)]))}},g$=Ke(m$,[["__scopeId","data-v-48e233e8"]]),y$={class:"notes-tab"},k$={class:"tab-header"},b$={class:"button-group"},w$={class:"filters-section"},_$={class:"search-group"},C$={class:"notes-list"},L$={key:0,class:"empty-state"},S$=["onClick"],I$={class:"note-header"},x$={class:"note-title-row"},$$={key:0,class:"pin-icon",title:"Pinned"},T$={key:1,class:"emergency-indicator",title:"Shown in emergency info"},M$={class:"note-meta"},A$={key:0,class:"category-badge"},E$={class:"created-info"},P$={key:0,class:"note-preview"},D$={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=z(()=>{if(!o.value.trim())return n.notes;const f=o.value.toLowerCase().trim().split(/\s+/);return n.notes.filter(m=>{const y=`${m.title||""} ${m.content||""} ${m.priority||""}`.toLowerCase();return f.every(k=>y.includes(k))})}),l=z(()=>{const f={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((m,y)=>{if(m.isPinned!==y.isPinned)return m.isPinned?-1:1;const k=f[m.priority]??2,b=f[y.priority]??2;return k!==b?k-b:m.displayOrder!==y.displayOrder?m.displayOrder-y.displayOrder:es(m.title,y.title)})}),c=({changes:f})=>{const m=f.map(y=>({id:y.id,displayOrder:y.displayOrder}));s("reorder",m)},d=f=>{if(!f)return"";const m=150;return f.length<=m?f:f.substring(0,m)+"..."},h=f=>{if(!f)return"";const m=new Date(f),k=new Date-m,b=Math.floor(k/6e4),I=Math.floor(k/36e5),T=Math.floor(k/864e5);return b<1?"Just now":b<60?`${b}m ago`:I<24?`${I}h ago`:T<7?`${T}d ago`:m.toLocaleDateString()};return(f,m)=>(p(),g("div",y$,[r("div",k$,[r("div",b$,[r("button",{onClick:m[0]||(m[0]=y=>f.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",w$,[r("div",_$,[We(r("input",{"onUpdate:modelValue":m[1]||(m[1]=y=>o.value=y),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,o.value]])])]),r("div",C$,[i.value.length===0?(p(),g("div",L$,[r("p",null,w(o.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):(p(),qe(ll,{key:1,items:l.value,"item-key":"noteId","pinned-key":"isPinned",disabled:!!o.value,onReorder:c},{item:Ve(({element:y})=>[r("div",{class:le(["note-card",{pinned:y.isPinned}])},[o.value?P("",!0):(p(),qe(rl,{key:0})),r("div",{class:"note-content",onClick:k=>f.$emit("select-note",y)},[r("div",I$,[r("div",x$,[y.isPinned?(p(),g("span",$$,"")):P("",!0),r("span",{class:le(["priority-indicator",y.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,w(y.title),1),y.showInEmergencyInfo?(p(),g("span",T$,"")):P("",!0)]),r("div",M$,[y.category?(p(),g("span",A$,w(y.category),1)):P("",!0),r("span",E$,w(h(y.createdAt)),1)])]),y.content?(p(),g("div",P$,w(d(y.content)),1)):P("",!0),Ee(ol,{"scope-configurations":y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],8,S$)],2)]),_:1},8,["items","disabled"]))])]))}},R$=Ke(D$,[["__scopeId","data-v-715ffc72"]]),O$={class:"contacts-tab"},N$={class:"tab-header"},B$={class:"button-group"},F$={key:0,class:"status-pills"},U$={class:"filters-section"},z$={class:"search-group"},H$={class:"contacts-list"},V$={key:0,class:"empty-state"},G$=["onClick"],q$={class:"contact-header"},j$={class:"contact-name-row"},W$={key:0,class:"pin-icon",title:"Pinned"},Z$={key:1,class:"primary-badge",title:"Primary contact"},K$={key:2,class:"emergency-indicator",title:"Shown in emergency info"},Y$={class:"contact-roles"},J$={class:"contact-details"},X$={key:0,class:"contact-detail"},Q$={key:1,class:"contact-detail"},eT={key:0,class:"contact-notes"},tT={key:2,class:"no-scope-warning"},nT={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]}},emits:["add-contact","select-contact","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=D("all"),l=z(()=>n.contacts.filter(C=>!C.scopeConfigurations||C.scopeConfigurations.length===0).length),c=z(()=>n.contacts.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0).length),d=C=>{i.value=C},h=C=>C?C.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=z(()=>{const C=new Map;for(const _ of n.roleDefinitions)C.set(_.roleId,_.name),C.set(_.name,_.name);return C}),m=C=>{if(!C)return"";const _=f.value.get(C);return _||C.replace(/([A-Z])/g," $1").replace(/^./,$=>$.toUpperCase()).trim()},y=C=>C.roles&&Array.isArray(C.roles)&&C.roles.length>0?C.roles:C.role?[C.role]:[],k=C=>y(C).map(m).join(" "),b=C=>{if(!C)return"";const _=100;return C.length<=_?C:C.substring(0,_)+"..."},I=z(()=>{let C=n.contacts;if(i.value==="no-scope"?C=C.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0):i.value==="with-scope"&&(C=C.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0)),o.value.trim()){const $=h(o.value).split(" ").filter(R=>R.length>0);C=C.filter(R=>{const M=k(R),O=h(`${R.name||""} ${M} ${R.email||""} ${R.phone||""}`);return $.every(A=>O.includes(A))})}return C}),T=z(()=>[...I.value].sort((C,_)=>{if(C.isPinned!==_.isPinned)return C.isPinned?-1:1;const $=C.displayOrder||0,R=_.displayOrder||0;return $!==R?$-R:(C.name||"").localeCompare(_.name||"",void 0,{sensitivity:"base"})})),E=z(()=>{const C=o.value.trim();return i.value==="no-scope"?C?"No unassigned contacts match your search.":"All contacts are assigned.":i.value==="with-scope"?C?"No assigned contacts match your search.":"No contacts are assigned yet.":C?"No contacts match your search.":"No contacts yet. Create one to get started!"}),x=({changes:C})=>{s("reorder",C)};return(C,_)=>(p(),g("div",O$,[r("div",N$,[r("div",B$,[r("button",{onClick:_[0]||(_[0]=$=>C.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(p(),g("div",F$,[Ee(Pt,{variant:"neutral",active:i.value==="all",onClick:_[1]||(_[1]=$=>d("all"))},{default:Ve(()=>[Je(w(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0&&c.value<e.contacts.length?(p(),qe(Pt,{key:0,variant:"success",active:i.value==="with-scope",onClick:_[2]||(_[2]=$=>d("with-scope"))},{default:Ve(()=>[Je(w(c.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),l.value>0&&l.value<e.contacts.length?(p(),qe(Pt,{key:1,variant:"danger",active:i.value==="no-scope",onClick:_[3]||(_[3]=$=>d("no-scope"))},{default:Ve(()=>[Je(w(l.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",U$,[r("div",z$,[We(r("input",{"onUpdate:modelValue":_[4]||(_[4]=$=>o.value=$),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,o.value]])])]),r("div",H$,[I.value.length===0?(p(),g("div",V$,[r("p",null,w(E.value),1)])):(p(),qe(ll,{key:1,items:T.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!!o.value||i.value!=="all",onReorder:x},{item:Ve(({element:$})=>[r("div",{class:le(["contact-card",{pinned:$.isPinned,primary:$.isPrimary}])},[!o.value&&i.value==="all"?(p(),qe(rl,{key:0})):P("",!0),r("div",{class:"contact-content",onClick:R=>C.$emit("select-contact",$)},[r("div",q$,[r("div",j$,[$.isPinned?(p(),g("span",W$,"")):P("",!0),$.isPrimary?(p(),g("span",Z$,"")):P("",!0),r("strong",null,w($.name),1),$.showInEmergencyInfo?(p(),g("span",K$,"")):P("",!0)]),r("div",Y$,[(p(!0),g(Se,null,je(y($),R=>(p(),g("span",{key:R,class:le(["role-badge",{"emergency-role":R==="Emergency"}])},w(m(R)),3))),128))])]),r("div",J$,[$.phone?(p(),g("span",X$,w($.phone),1)):P("",!0),$.email?(p(),g("span",Q$,w($.email),1)):P("",!0)]),$.notes?(p(),g("div",eT,w(b($.notes)),1)):P("",!0),$.scopeConfigurations&&$.scopeConfigurations.length>0?(p(),qe(ol,{key:1,"scope-configurations":$.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("div",tT," No visibility scope configured "))],8,G$)],2)]),_:1},8,["items","disabled"]))])]))}},oT=Ke(nT,[["__scopeId","data-v-83f433bf"]]),sT={class:"roles-tab"},aT={class:"tab-header"},iT={class:"button-group"},lT={key:0,class:"status-pills"},rT={class:"filters-section"},cT={class:"search-group"},uT={class:"roles-list"},dT={key:0,class:"empty-state"},hT=["onClick"],fT={class:"role-header"},pT={class:"role-name-row"},vT={key:0,class:"built-in-badge",title:"Built-in role"},mT={class:"role-usage"},gT={key:0,class:"role-notes"},yT={key:1,class:"role-notes empty"},kT={__name:"RolesTab",props:{roleDefinitions:{type:Array,required:!0}},emits:["add-role","select-role","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=z(()=>n.roleDefinitions.reduce((y,k)=>y+(k.usageCount||0),0)),l=y=>y?y.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",c=y=>{if(!y)return"";const k=150;return y.length<=k?y:y.substring(0,k)+"..."},d=z(()=>{if(!o.value.trim())return n.roleDefinitions;const k=l(o.value).split(" ").filter(b=>b.length>0);return n.roleDefinitions.filter(b=>{const I=l(`${b.name||""} ${b.notes||""}`);return k.every(T=>I.includes(T))})}),h=z(()=>[...d.value].sort((y,k)=>{const b=y.displayOrder||0,I=k.displayOrder||0;return b!==I?b-I:(y.name||"").localeCompare(k.name||"",void 0,{numeric:!0,sensitivity:"base"})})),f=z(()=>o.value.trim()?"No roles match your search.":"No roles defined yet. Create one to get started!"),m=({changes:y})=>{s("reorder",y)};return(y,k)=>(p(),g("div",sT,[r("div",aT,[r("div",iT,[r("button",{onClick:k[0]||(k[0]=b=>y.$emit("add-role")),class:"btn btn-primary"}," Add role ")]),e.roleDefinitions.length>0?(p(),g("div",lT,[Ee(Pt,{variant:"neutral"},{default:Ve(()=>[Je(w(e.roleDefinitions.length)+" "+w(e.roleDefinitions.length===1?"role":"roles"),1)]),_:1}),i.value>0?(p(),qe(Pt,{key:0,variant:"success"},{default:Ve(()=>[Je(w(i.value)+" "+w(i.value===1?"assignment":"assignments"),1)]),_:1})):P("",!0)])):P("",!0)]),r("div",rT,[r("div",cT,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>o.value=b),type:"text",class:"search-input",placeholder:"Search by name or notes..."},null,512),[[st,o.value]])])]),r("div",uT,[d.value.length===0?(p(),g("div",dT,[r("p",null,w(f.value),1)])):(p(),qe(ll,{key:1,items:h.value,"item-key":"roleId",disabled:!!o.value,onReorder:m},{item:Ve(({element:b})=>[r("div",{class:le(["role-card",{"built-in":b.isBuiltIn}])},[o.value?P("",!0):(p(),qe(rl,{key:0})),r("div",{class:"role-content",onClick:I=>y.$emit("select-role",b)},[r("div",fT,[r("div",pT,[r("strong",null,w(b.name),1),b.isBuiltIn?(p(),g("span",vT,"Built-in")):P("",!0)]),r("div",mT,[r("span",{class:le(["usage-badge",{"has-usage":b.usageCount>0}])},w(b.usageCount)+" "+w(b.usageCount===1?"person":"people"),3)])]),b.notes?(p(),g("div",gT,w(c(b.notes)),1)):(p(),g("div",yT," No notes "))],8,hT)],2)]),_:1},8,["items","disabled"]))])]))}},bT=Ke(kT,[["__scopeId","data-v-634d49c0"]]),v1=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],wT={class:"event-details-tab"},_T={class:"event-info-card"},CT={class:"form-group"},LT={class:"form-group"},ST={class:"form-row"},IT={class:"form-group"},xT={class:"form-group"},$T=["value"],TT={class:"form-actions"},MT=["disabled"],AT={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const n=e,s=t,o=D({...n.eventData});Ye(()=>n.eventData,c=>{o.value={...c}},{deep:!0});const i=()=>{s("update:formDirty",!0)},l=()=>{s("submit",{...o.value})};return(c,d)=>(p(),g("div",wT,[r("div",_T,[r("form",{onSubmit:ct(l,["prevent"]),class:"event-details-form"},[r("div",CT,[d[4]||(d[4]=r("label",null,"Event name",-1)),We(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>o.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.name]])]),r("div",LT,[d[5]||(d[5]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>o.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[st,o.value.description]])]),r("div",ST,[r("div",IT,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),We(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>o.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.eventDate]])]),r("div",xT,[d[7]||(d[7]=r("label",null,"Time zone",-1)),We(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(p(!0),g(Se,null,je(B(v1),h=>(p(),g("option",{key:h.value,value:h.value},w(h.label),9,$T))),128))],544),[[Qn,o.value.timeZoneId]])])]),r("div",TT,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,MT)])],32)])]))}},ET=Ke(AT,[["__scopeId","data-v-2754c3cc"]]),PT={class:"admins-list"},DT={class:"admin-info"},RT={class:"admin-role"},OT=["onClick"],NT={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,n)=>(p(),g("div",null,[r("button",{onClick:n[0]||(n[0]=s=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",PT,[(p(!0),g(Se,null,je(e.admins,s=>(p(),g("div",{key:s.userEmail,class:"admin-item"},[r("div",DT,[r("strong",null,w(s.userEmail),1),r("span",RT,w(s.role),1)]),e.admins.length>1?(p(),g("button",{key:0,onClick:o=>t.$emit("remove-admin",s.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,OT)):P("",!0)]))),128))])]))}},BT=Ke(NT,[["__scopeId","data-v-e526860b"]]),FT={class:"modal-content"},UT={class:"modal-body"},zT={class:"preview-section"},HT={class:"map-preview"},VT=["innerHTML"],GT={class:"options-grid"},qT={class:"option-button-content"},jT={class:"option-button-value icon-value"},WT=["innerHTML"],ZT={class:"option-button-content"},KT={class:"option-button-value color-value"},YT=["disabled"],JT={class:"option-button-content"},XT={class:"option-button-value color-value"},QT={class:"option-button-content"},eM={class:"option-button-value icon-value"},tM=["innerHTML"],nM=["disabled"],oM={class:"option-button-content"},sM={class:"option-button-value color-value"},aM={class:"option-button-content"},iM={class:"option-button-value"},lM={class:"option-button-content"},rM={class:"option-button-value"},cM={key:0,class:"centered-popup"},uM={class:"popup-grid"},dM=["onClick"],hM=["innerHTML"],fM={key:0},pM={key:1,class:"centered-popup"},vM={class:"popup-grid"},mM=["title","onClick"],gM=["innerHTML"],yM={key:0},kM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},bM={key:1,class:"custom-check-mark"},wM={key:0,class:"custom-hex-input"},_M={class:"hex-input-row"},CM=["disabled"],LM={key:0,class:"hex-error"},SM={key:2,class:"centered-popup"},IM={class:"popup-grid"},xM=["title","onClick"],$M=["innerHTML"],TM={key:0},MM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},AM={key:1,class:"custom-check-mark"},EM={key:0,class:"custom-hex-input"},PM={class:"hex-input-row"},DM=["disabled"],RM={key:0,class:"hex-error"},OM={key:3,class:"centered-popup icon-popup"},NM={class:"popup-grid"},BM=["onClick"],FM=["innerHTML"],UM={key:0},zM={key:4,class:"centered-popup"},HM={class:"popup-grid"},VM=["title","onClick"],GM=["innerHTML"],qM={key:0},jM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},WM={key:1,class:"custom-check-mark"},ZM={key:0,class:"custom-hex-input"},KM={class:"hex-input-row"},YM=["disabled"],JM={key:0,class:"hex-error"},XM={key:5,class:"centered-popup"},QM={class:"size-grid"},eA=["onClick"],tA=["innerHTML"],nA={key:6,class:"centered-popup"},oA={class:"rotation-content"},sA={class:"rotation-preview-container"},aA=["innerHTML"],iA={class:"rotation-control"},lA={class:"rotation-slider-container"},rA=["value"],cA={class:"rotation-value"},uA={class:"rotation-presets"},dA="#667eea",hA={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const n=e,s=t,o=D(n.backgroundShape||"circle"),i=D(n.iconType||"none"),l=D(n.backgroundColor||""),c=D(n.borderColor||""),d=D(n.iconColor||""),h=D(n.size||"100"),f=D(n.mapRotation??""),m=D(null),y=D(!1),k=D(!1),b=D(!1),I=D(""),T=D(""),E=D(""),x=D(null),C=D(null),_=D(null),$=pe=>pe==="default"?n.inheritedBackgroundShape||"circle":pe==="none"?"none":pe||"circle",R=pe=>pe==="default"||!pe?q():pe==="none"?"transparent":pe,M=pe=>pe==="default"?n.inheritedBorderColor||"#ffffff":pe==="none"||!pe?"transparent":pe,O=pe=>{if(pe==="default"){const ve=n.inheritedType;return ve&&ve!=="default"&&el(ve).category==="content"?ve:"none"}return pe==="none"||!pe?"none":pe},A=pe=>pe==="default"||!pe?n.inheritedIconColor||"#ffffff":pe==="none"?"transparent":pe,U=pe=>pe==="default"?n.inheritedSize||"100":pe||"100",F=pe=>{if(pe==="default"||pe===""){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null&&parseInt(ve,10)||0}return parseInt(pe,10)||0},j=z(()=>{const pe=n.inheritedBackgroundShape||"circle",ve=Uc.find(Ie=>Ie.value===pe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ve})`,showLabel:!0},...Uc.filter(Ie=>Ie.value!=="none").map(Ie=>({...Ie,showLabel:!1}))]}),Z=z(()=>{const pe=Su.filter(lt=>lt.category==="content"),ve=[{value:"none",label:"None",category:"content",showLabel:!0}],Ie=n.inheritedType;if(Ie&&Ie!=="default"){const lt=el(Ie);lt.category==="content"&&ve.push({value:"default",label:`Default (${lt.label||Ie})`,category:"content",showLabel:!0})}return ve.push(...pe.map(lt=>({...lt,showLabel:!1}))),ve}),X=z(()=>{const pe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${pe[n.inheritedSize]||"Normal"})`},...k2.map(Ie=>({value:Ie.value,label:pe[Ie.value]||Ie.label}))]}),re=z(()=>$(o.value)!=="none"),K=z(()=>O(i.value)!=="none"),ae=z(()=>{const pe=n.inheritedBackgroundColor;return pe&&pe!=="default"&&pe.startsWith("#")?pe:dA}),q=()=>ae.value,Y=z(()=>l.value&&l.value!=="default"?l.value:q()),te=z(()=>c.value==="none"?"transparent":c.value?c.value:n.inheritedBorderColor&&n.inheritedBorderColor!=="none"?n.inheritedBorderColor:"#ffffff"),ue=z(()=>d.value?d.value:n.inheritedIconColor?n.inheritedIconColor:"#ffffff"),_e=z(()=>{const pe=ae.value,ve=Un.find(Ie=>Ie.hex.toLowerCase()===pe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},...Un.map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),Te=z(()=>{const pe=n.inheritedBorderColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Ie=>Ie.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Ie=>Ie.hex!=="#ffffff").map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),Pe=z(()=>{const pe=n.inheritedIconColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Ie=>Ie.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Ie=>Ie.hex!=="#ffffff").map(Ie=>({hex:Ie.hex,name:Ie.name,showLabel:!1}))]}),De=pe=>pe==="default"?!l.value||l.value==="default":l.value===pe,ke=pe=>pe==="#ffffff"?!d.value||d.value==="#ffffff":d.value===pe,H=z(()=>{const pe=l.value;return!pe||pe==="default"||pe==="none"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),J=z(()=>{const pe=c.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),de=z(()=>{const pe=d.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),ie=z(()=>{if(!I.value)return!1;const pe=I.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Re=z(()=>{if(!T.value)return!1;const pe=T.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),G=z(()=>{if(!E.value)return!1;const pe=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Q=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedBackgroundShape;return Ie?`Default (${Uc.find(Qe=>Qe.value===Ie)?.label||"Circle"})`:"Default (Circle)"}const ve=Uc.find(Ie=>Ie.value===pe);return ve?ve.label:"Circle"},ee=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedType;if(Ie&&Ie!=="default"){const lt=el(Ie);if(lt.category==="content")return`Default (${lt.label||Ie})`}return"Default"}const ve=Su.find(Ie=>Ie.value===pe);return ve?ve.label:"None"},Ce=pe=>{if(pe==="none")return"None";if(!pe||pe==="default"){const Ie=ae.value;return`Default (${Un.find(Qe=>Qe.hex.toLowerCase()===Ie.toLowerCase())?.name||"Custom"})`}const ve=[...Un].find(Ie=>Ie.hex.toLowerCase()===pe.toLowerCase());return ve?ve.name:pe},Be=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedBorderColor;return Ie&&Ie!=="none"?`Default (${Ie==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Ie)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...Te.value].find(Ie=>Ie.hex===pe);return ve?ve.name:pe},ze=pe=>{if(pe==="none")return"None";if(pe==="default"){const Ie=n.inheritedIconColor;return Ie?`Default (${Ie==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Ie)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...Pe.value].find(Ie=>Ie.hex===pe);return ve?ve.name:pe},Ae=pe=>{const ve={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(pe==="default"){const Ie=n.inheritedSize;return`Default (${ve[Ie]||"Normal"})`}return ve[pe]||"Normal"},oe=pe=>{if(pe==="default"||pe===""||pe===void 0||pe===null){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null?`Default (${ve})`:"Default (0)"}return`${pe}`},ge=pe=>{if(pe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ve=$(pe),Ie=R(l.value),lt=M(c.value);return jl[ve]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${jl[ve]({backgroundColor:Ie,borderColor:lt==="transparent"?"none":lt})}</svg>`:""},Ne=pe=>{const ve=O(pe);return ve==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:zn({type:ve,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Oe=pe=>{const ve=$(pe);if(ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Ie=R(l.value),lt=M(c.value),Qe=O(i.value),Nt=A(d.value);return zn({type:Qe!=="none"?Qe:ve,backgroundShape:ve,backgroundColor:Ie,borderColor:lt==="transparent"?"none":lt,iconColor:Nt,size:"100",outputSize:28})},$e=pe=>{const ve=R(pe),Ie=$(o.value),lt=M(c.value),Qe=O(i.value),Nt=A(d.value);return Ie==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Ie,backgroundShape:Ie,backgroundColor:ve==="transparent"?"#e2e8f0":ve,borderColor:lt==="transparent"?"none":lt,iconColor:Nt,size:"100",outputSize:28})},me=pe=>{const ve=M(pe),Ie=$(o.value),lt=R(l.value),Qe=O(i.value),Nt=A(d.value);return Ie==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ve}" stroke-width="2"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Ie,backgroundShape:Ie,backgroundColor:lt,borderColor:ve==="transparent"?"none":ve,iconColor:Nt,size:"100",outputSize:28})},Ze=pe=>{const ve=O(pe),Ie=$(o.value),lt=R(l.value),Qe=M(c.value),Nt=A(d.value);if(ve==="none"&&Ie==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const on=Ie!=="none"?Ie:"circle";return zn({type:ve!=="none"?ve:on,backgroundShape:on,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:Nt,size:"100",outputSize:42})},Ge=pe=>{const ve=A(pe),Ie=$(o.value),lt=R(l.value),Qe=M(c.value),Nt=O(i.value);return Nt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Nt,backgroundShape:Ie!=="none"?Ie:"circle",backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:ve==="transparent"?"#e2e8f0":ve,size:"100",outputSize:28})},fe=pe=>{const ve=U(pe),Ie=$(o.value),lt=R(l.value),Qe=M(c.value),Nt=O(i.value),on=A(d.value);if(Ie==="none"&&Nt==="none")return"";const mn=Ie!=="none"?Ie:"circle";return zn({type:Nt!=="none"?Nt:mn,backgroundShape:mn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:on,size:ve})},be=z(()=>{const pe=$(o.value),ve=R(l.value),Ie=M(c.value),lt=O(i.value),Qe=A(d.value),Nt=U(h.value);return pe==="none"&&lt==="none"?"":zn(pe==="none"&&lt!=="none"?{type:lt,backgroundShape:"none",backgroundColor:ve,borderColor:"none",iconColor:Qe,size:Nt}:{type:lt!=="none"?lt:pe,backgroundShape:pe,backgroundColor:ve,borderColor:Ie==="transparent"?"none":Ie,iconColor:Qe,size:Nt})}),ne=pe=>{m.value=m.value===pe?null:pe},ye=()=>{m.value=null,y.value=!1,k.value=!1,b.value=!1},He=pe=>{o.value=pe,ye()},rt=pe=>{l.value=pe,ye()},kt=pe=>{c.value=pe,ye()},Ot=pe=>{i.value=pe,ye()},Lt=pe=>{d.value=pe,ye()},xt=pe=>{h.value=pe,ye()},Kt=pe=>{f.value=pe,ye()},no=()=>{y.value=!y.value,y.value&&(H.value?I.value=l.value.replace(/^#/,""):I.value="",cn(()=>x.value?.focus()))},Mo=()=>{k.value=!k.value,k.value&&(J.value?T.value=c.value.replace(/^#/,""):T.value="",cn(()=>C.value?.focus()))},ft=()=>{b.value=!b.value,b.value&&(de.value?E.value=d.value.replace(/^#/,""):E.value="",cn(()=>_.value?.focus()))},Ct=()=>{I.value=I.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Mt=()=>{T.value=T.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Mn=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},go=pe=>pe.length===3?pe[0]+pe[0]+pe[1]+pe[1]+pe[2]+pe[2]:pe,oo=()=>{if(!ie.value)return;const pe=go(I.value);l.value="#"+pe,y.value=!1,ye()},An=()=>{if(!Re.value)return;const pe=go(T.value);c.value="#"+pe,k.value=!1,ye()},tn=()=>{if(!G.value)return;const pe=go(E.value);d.value="#"+pe,b.value=!1,ye()},Ps=pe=>{f.value=pe};Ye(()=>n.isOpen,pe=>{if(pe){const ve=n.backgroundShape&&n.backgroundShape!=="default"&&n.backgroundShape!=="circle",Ie=n.iconType&&n.iconType!=="none"&&n.iconType!=="default",lt=n.backgroundColor&&n.backgroundColor!=="",Qe=n.borderColor&&n.borderColor!=="",Nt=n.iconColor&&n.iconColor!=="",on=n.size&&n.size!==""&&n.size!=="100",mn=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null&&n.mapRotation!==0;ve||Ie||lt||Qe||Nt||on||mn?(o.value=n.backgroundShape||"default",i.value=n.iconType||"default",l.value=n.backgroundColor||"default",c.value=n.borderColor||"default",d.value=n.iconColor||"default",h.value=n.size||"default",f.value=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null?n.mapRotation:"default"):(o.value="default",i.value="default",l.value="default",c.value="default",d.value="default",h.value="default",f.value="default"),m.value=null}});const yo=()=>{ye(),s("update:isOpen",!1),s("cancel")},Uo=()=>{ye();const pe=lt=>lt==="default"?"":lt;let ve="";i.value==="none"?ve="none":i.value&&i.value!=="default"&&(ve=i.value);let Ie="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Ie=parseInt(f.value,10)||0),s("apply",{iconType:ve,backgroundShape:pe(o.value),backgroundColor:pe(l.value),borderColor:pe(c.value),iconColor:pe(d.value),size:pe(h.value),mapRotation:Ie}),s("update:isOpen",!1)};return(pe,ve)=>e.isOpen?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(yo,["self"])},[r("div",FT,[r("div",{class:"modal-header"},[ve[18]||(ve[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:yo},"")]),r("div",UT,[r("div",zT,[r("div",HT,[ve[19]||(ve[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:be.value},null,12,VT)])]),r("div",GT,[r("button",{type:"button",class:le(["option-button",{active:m.value==="shape"}]),onClick:ve[0]||(ve[0]=Ie=>ne("shape"))},[r("div",qT,[ve[20]||(ve[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",jT,[r("div",{class:"icon-preview-small",innerHTML:ge(o.value)},null,8,WT),r("span",null,w(Q(o.value)),1)])]),ve[21]||(ve[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="bgColor"}]),onClick:ve[1]||(ve[1]=Ie=>ne("bgColor"))},[r("div",ZT,[ve[22]||(ve[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",KT,[r("span",{class:"color-swatch",style:tt({backgroundColor:Y.value})},null,4),r("span",null,w(Ce(l.value)),1)])]),ve[23]||(ve[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="borderColor",disabled:!re.value}]),disabled:!re.value,onClick:ve[2]||(ve[2]=Ie=>ne("borderColor"))},[r("div",JT,[ve[24]||(ve[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",XT,[r("span",{class:le(["color-swatch",{"no-border":c.value==="none"}]),style:tt(c.value!=="none"?{backgroundColor:te.value}:{})},null,6),r("span",null,w(Be(c.value)),1)])]),ve[25]||(ve[25]=r("span",{class:"option-button-arrow"},"",-1))],10,YT),r("button",{type:"button",class:le(["option-button",{active:m.value==="icon"}]),onClick:ve[3]||(ve[3]=Ie=>ne("icon"))},[r("div",QT,[ve[26]||(ve[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",eM,[r("div",{class:"icon-preview-small",innerHTML:Ne(i.value)},null,8,tM),r("span",null,w(ee(i.value)),1)])]),ve[27]||(ve[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="iconColor",disabled:!K.value}]),disabled:!K.value,onClick:ve[4]||(ve[4]=Ie=>ne("iconColor"))},[r("div",oM,[ve[28]||(ve[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",sM,[r("span",{class:"color-swatch",style:tt({backgroundColor:ue.value})},null,4),r("span",null,w(ze(d.value)),1)])]),ve[29]||(ve[29]=r("span",{class:"option-button-arrow"},"",-1))],10,nM),r("button",{type:"button",class:le(["option-button",{active:m.value==="size"}]),onClick:ve[5]||(ve[5]=Ie=>ne("size"))},[r("div",aM,[ve[30]||(ve[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",iM,w(Ae(h.value)),1)]),ve[31]||(ve[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:ve[6]||(ve[6]=Ie=>ne("mapRotation"))},[r("div",lM,[ve[32]||(ve[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",rM,w(oe(f.value)),1)]),ve[33]||(ve[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(p(),g("div",cM,[r("div",{class:"popup-header"},[ve[34]||(ve[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",uM,[(p(!0),g(Se,null,je(j.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["popup-grid-item",{selected:o.value===Ie.value}]),onClick:lt=>He(Ie.value)},[r("div",{class:"popup-item-preview",innerHTML:Oe(Ie.value)},null,8,hM),Ie.showLabel?(p(),g("span",fM,w(Ie.label),1)):P("",!0)],10,dM))),128))])])):P("",!0),m.value==="bgColor"?(p(),g("div",pM,[r("div",{class:"popup-header"},[ve[35]||(ve[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",vM,[(p(!0),g(Se,null,je(_e.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:De(Ie.hex)}]),title:Ie.name,onClick:lt=>rt(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:$e(Ie.hex)},null,8,gM),Ie.showLabel?(p(),g("span",yM,w(Ie.name),1)):P("",!0)],10,mM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:H.value}]),style:tt(H.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:no},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(H.value?{backgroundColor:l.value}:{})},[H.value?P("",!0):(p(),g("svg",kM,[...ve[36]||(ve[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),H.value?(p(),g("span",bM,"")):P("",!0)],4),ve[37]||(ve[37]=r("span",null,"Custom",-1))],6)]),y.value?(p(),g("div",wM,[ve[39]||(ve[39]=r("label",null,"Enter hex code",-1)),r("div",_M,[ve[38]||(ve[38]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"bgHexInput",ref:x,"onUpdate:modelValue":ve[7]||(ve[7]=Ie=>I.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:I.value&&!ie.value}]),onInput:Ct,onKeydown:Qo(oo,["enter"])},null,34),[[st,I.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:ie.value?"#"+I.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!ie.value,onClick:oo}," Apply ",8,CM)]),I.value&&!ie.value?(p(),g("span",LM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="borderColor"?(p(),g("div",SM,[r("div",{class:"popup-header"},[ve[40]||(ve[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",IM,[(p(!0),g(Se,null,je(Te.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:c.value===Ie.hex}]),title:Ie.name,onClick:lt=>kt(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(Ie.hex)},null,8,$M),Ie.showLabel?(p(),g("span",TM,w(Ie.name),1)):P("",!0)],10,xM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:J.value}]),style:tt(J.value?{"--custom-color":c.value}:{}),title:"Custom colour",onClick:Mo},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(J.value?{backgroundColor:c.value}:{})},[J.value?P("",!0):(p(),g("svg",MM,[...ve[41]||(ve[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),J.value?(p(),g("span",AM,"")):P("",!0)],4),ve[42]||(ve[42]=r("span",null,"Custom",-1))],6)]),k.value?(p(),g("div",EM,[ve[44]||(ve[44]=r("label",null,"Enter hex code",-1)),r("div",PM,[ve[43]||(ve[43]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"borderHexInput",ref:C,"onUpdate:modelValue":ve[8]||(ve[8]=Ie=>T.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!Re.value}]),onInput:Mt,onKeydown:Qo(An,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:Re.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Re.value,onClick:An}," Apply ",8,DM)]),T.value&&!Re.value?(p(),g("span",RM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="icon"?(p(),g("div",OM,[r("div",{class:"popup-header"},[ve[45]||(ve[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",NM,[(p(!0),g(Se,null,je(Z.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["popup-grid-item",{selected:i.value===Ie.value}]),onClick:lt=>Ot(Ie.value)},[r("div",{class:"popup-item-preview",innerHTML:Ze(Ie.value)},null,8,FM),Ie.showLabel?(p(),g("span",UM,w(Ie.label),1)):P("",!0)],10,BM))),128))])])):P("",!0),m.value==="iconColor"?(p(),g("div",zM,[r("div",{class:"popup-header"},[ve[46]||(ve[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",HM,[(p(!0),g(Se,null,je(Pe.value,Ie=>(p(),g("button",{key:Ie.hex,type:"button",class:le(["popup-grid-item",{selected:ke(Ie.hex)}]),title:Ie.name,onClick:lt=>Lt(Ie.hex)},[r("div",{class:"popup-item-preview",innerHTML:Ge(Ie.hex)},null,8,GM),Ie.showLabel?(p(),g("span",qM,w(Ie.name),1)):P("",!0)],10,VM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:de.value}]),style:tt(de.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:ft},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(de.value?{backgroundColor:d.value}:{})},[de.value?P("",!0):(p(),g("svg",jM,[...ve[47]||(ve[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),de.value?(p(),g("span",WM,"")):P("",!0)],4),ve[48]||(ve[48]=r("span",null,"Custom",-1))],6)]),b.value?(p(),g("div",ZM,[ve[50]||(ve[50]=r("label",null,"Enter hex code",-1)),r("div",KM,[ve[49]||(ve[49]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"iconHexInput",ref:_,"onUpdate:modelValue":ve[9]||(ve[9]=Ie=>E.value=Ie),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!G.value}]),onInput:Mn,onKeydown:Qo(tn,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:G.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!G.value,onClick:tn}," Apply ",8,YM)]),E.value&&!G.value?(p(),g("span",JM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="size"?(p(),g("div",XM,[r("div",{class:"popup-header"},[ve[51]||(ve[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",QM,[(p(!0),g(Se,null,je(X.value,Ie=>(p(),g("button",{key:Ie.value,type:"button",class:le(["size-grid-item",{selected:h.value===Ie.value}]),onClick:lt=>xt(Ie.value)},[r("div",{class:"size-preview",innerHTML:fe(Ie.value)},null,8,tA),r("span",null,w(Ie.label),1)],10,eA))),128))])])):P("",!0),m.value==="mapRotation"?(p(),g("div",nA,[r("div",{class:"popup-header"},[ve[52]||(ve[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",oA,[r("div",sA,[r("div",{class:"rotation-preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:be.value},null,12,aA)]),ve[53]||(ve[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",iA,[r("button",{type:"button",class:le(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ve[10]||(ve[10]=Ie=>Kt("default"))}," Default ",2),r("div",lA,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ve[11]||(ve[11]=Ie=>Ps(parseInt(Ie.target.value,10)))},null,40,rA),r("div",cA,w(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",uA,[r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ve[12]||(ve[12]=Ie=>Kt(-90))},"-90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ve[13]||(ve[13]=Ie=>Kt(-45))},"-45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===0}]),onClick:ve[14]||(ve[14]=Ie=>Kt(0))},"0",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===45}]),onClick:ve[15]||(ve[15]=Ie=>Kt(45))},"+45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===90}]),onClick:ve[16]||(ve[16]=Ie=>Kt(90))},"+90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===180}]),onClick:ve[17]||(ve[17]=Ie=>Kt(180))},"180",2)])])])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:yo},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:Uo},"Apply")])])])):P("",!0)}},fA=Ke(hA,[["__scopeId","data-v-bbab1a46"]]),pA={class:"checkpoint-style-picker"},vA={class:"form-group"},mA={class:"style-options"},gA=["innerHTML"],yA={class:"option-label"},kA=["innerHTML"],bA="#667eea",wA={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const n=e,s=t,o=D(n.styleType),i=D(n.styleColor||""),l=D(n.styleBackgroundShape||"default"),c=D(n.styleBackgroundColor||""),d=D(n.styleBorderColor||""),h=D(n.styleIconColor||""),f=D(n.styleSize||"default"),m=D(n.styleMapRotation||""),y=F=>!F||F==="default"?!1:el(F).category==="content",k=D(n.styleType&&n.styleType!=="default"&&n.styleType!=="custom"&&y(n.styleType)?n.styleType:"default"),b=D(!1),I=z(()=>!!(o.value&&o.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||c.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),T=F=>F&&F!==""&&F!=="default",E=F=>F&&F.startsWith("#"),x=z(()=>{const j=T(n.inheritedStyleType),Z=T(n.inheritedBackgroundShape),X=E(n.inheritedBackgroundColor)||E(n.inheritedStyleColor),re=E(n.inheritedBorderColor),K=E(n.inheritedIconColor),ae=T(n.inheritedSize);if(j||Z||X||re||K||ae){const Y=j?n.inheritedStyleType:Z?n.inheritedBackgroundShape:"circle",te=(E(n.inheritedBackgroundColor)?n.inheritedBackgroundColor:null)||(E(n.inheritedStyleColor)?n.inheritedStyleColor:null)||bA;return zn({type:Y,backgroundShape:n.inheritedBackgroundShape||"circle",backgroundColor:te,borderColor:n.inheritedBorderColor||"#ffffff",iconColor:n.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=z(()=>{const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),_=z(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const j=parseInt(m.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),$=z(()=>{if(I.value){const F=k.value&&k.value!=="none"&&k.value!=="default";let j=null;n.inheritedStyleType&&n.inheritedStyleType!=="default"&&n.inheritedStyleType!=="custom"&&el(n.inheritedStyleType).category==="content"&&(j=n.inheritedStyleType);const Z=k.value==="default"&&j,X=F||Z,re=F?k.value:Z?j:null,K=l.value&&l.value!=="default"?l.value:n.inheritedBackgroundShape||"circle",ae=X?re:K,q=c.value||n.inheritedBackgroundColor||n.inheritedStyleColor||"#667eea",Y=d.value||n.inheritedBorderColor||"#ffffff",te=h.value||n.inheritedIconColor||"#ffffff";return zn({type:ae,backgroundShape:K,backgroundColor:q,borderColor:Y,iconColor:te,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),R=()=>{o.value="default",k.value="default",s("update:styleType","default"),l.value="default",c.value="",i.value="",d.value="",h.value="",f.value="default",m.value="",s("update:styleBackgroundShape",""),s("update:styleBackgroundColor",""),s("update:styleColor",""),s("update:styleBorderColor",""),s("update:styleIconColor",""),s("update:styleSize",""),s("update:styleMapRotation",""),U()},M=()=>{b.value=!0},O=F=>{F.iconType==="none"?k.value="none":F.iconType?k.value=F.iconType:k.value="default",l.value=F.backgroundShape||"default",c.value=F.backgroundColor||"",d.value=F.borderColor||"",h.value=F.iconColor||"",f.value=F.size||"default",m.value=F.mapRotation??"";const j=F.iconType==="none"||F.iconType&&F.iconType!==""||F.backgroundShape||F.backgroundColor||F.borderColor||F.iconColor||F.size||F.mapRotation!==""&&F.mapRotation!==0;F.iconType&&F.iconType!=="none"?o.value=F.iconType:j?o.value="custom":o.value="default",s("update:styleType",o.value),s("update:styleBackgroundShape",F.backgroundShape),s("update:styleBackgroundColor",F.backgroundColor),s("update:styleBorderColor",F.borderColor),s("update:styleIconColor",F.iconColor),s("update:styleSize",F.size),s("update:styleMapRotation",F.mapRotation??""),U()},A=()=>{},U=()=>{s("change",{styleType:o.value,styleColor:c.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:c.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:m.value})};return Ye(()=>n.styleType,F=>{o.value=F,F&&F!=="default"&&F!=="custom"&&y(F)?k.value=F:k.value="default"}),Ye(()=>n.styleColor,F=>{i.value=F||""}),Ye(()=>n.styleBackgroundShape,F=>{l.value=F||"default"}),Ye(()=>n.styleBackgroundColor,F=>{c.value=F||""}),Ye(()=>n.styleBorderColor,F=>{d.value=F||""}),Ye(()=>n.styleIconColor,F=>{h.value=F||""}),Ye(()=>n.styleSize,F=>{f.value=F||"default"}),Ye(()=>n.styleMapRotation,F=>{m.value=F??""}),(F,j)=>(p(),g("div",pA,[r("div",vA,[r("label",null,w(e.iconLabel),1),r("div",mA,[r("button",{type:"button",class:le(["style-option-button",{selected:!I.value}]),onClick:R},[r("div",{class:"option-preview",style:tt(C.value),innerHTML:x.value},null,12,gA),r("span",yA,w(e.defaultLabel),1)],2),r("button",{type:"button",class:le(["style-option-button",{selected:I.value}]),onClick:M},[r("div",{class:"option-preview",style:tt(_.value),innerHTML:$.value},null,12,kA),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Ee(fA,{isOpen:b.value,"onUpdate:isOpen":j[0]||(j[0]=Z=>b.value=Z),"icon-type":k.value,"background-shape":l.value,"background-color":c.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:O,onCancel:A},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Nf=Ke(wA,[["__scopeId","data-v-c066da64"]]),_A={class:"logo-uploader"},CA={key:0,class:"logo-preview"},LA=["src"],SA=["disabled"],IA={key:0,class:"upload-progress"},xA={key:1,class:"upload-prompt"},$A={key:2,class:"error-message"},Fv=5*1024*1024,TA={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:n}){const s=K=>K?K.startsWith("/api")?ti+K.substring(4):K:"",o=e;function i(){const K={},ae=localStorage.getItem("adminEmail");ae&&(K["X-Admin-Email"]=ae);const q=localStorage.getItem("sessionToken");return q&&(K.Authorization=`Bearer ${q}`),K}const l=n;function c(){l("staged-change",{hasPendingChanges:k.value!==null||I.value,isPendingDelete:I.value,displayUrl:b.value||(I.value?"":o.modelValue)||""})}const d=D(null),h=D(!1),f=D(!1),m=D(""),y=D(Date.now()),k=D(null),b=D(""),I=D(!1),T=z(()=>{if(o.staged){if(b.value)return!0;if(I.value)return!1}return!!o.modelValue}),E=z(()=>{if(o.staged&&I.value)return"";if(o.staged&&b.value)return b.value;if(!o.modelValue)return"";const K=s(o.modelValue),ae=K.includes("?")?"&":"?";return`${K}${ae}_t=${y.value}`});function x(){b.value&&(URL.revokeObjectURL(b.value),b.value="")}Ln(()=>{x()});const C=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function _(){h.value||d.value?.click()}function $(K){const ae=K.target.files?.[0];ae&&M(ae),d.value&&(d.value.value="")}function R(K){f.value=!1;const ae=K.dataTransfer?.files?.[0];ae&&M(ae)}async function M(K){if(m.value="",!C.includes(K.type)){m.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>Fv){m.value=`File too large. Maximum size is ${Fv/(1024*1024)}MB.`;return}if(o.staged){x(),k.value=K,b.value=URL.createObjectURL(K),I.value=!1,c();return}h.value=!0;try{const ae=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...i()},body:K});if(!ae.ok){const Y=await ae.text().catch(()=>"");let te=`Upload failed (${ae.status})`;try{te=JSON.parse(Y).message||te}catch{Y&&(te=Y)}throw new Error(te)}const q=await ae.json();y.value=Date.now(),l("update:modelValue",q.logoUrl)}catch(ae){console.error("Logo upload error:",ae),ae.name==="TypeError"&&ae.message==="Failed to fetch"?m.value="Network error. Check your connection or try a smaller file.":ae.message?.includes("401")||ae.message?.includes("403")?m.value="Not authorized. Please refresh the page and try again.":m.value=ae.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function O(){if(m.value="",o.staged){k.value?(x(),k.value=null):o.modelValue&&(I.value=!0),c();return}h.value=!0;try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}l("update:modelValue","")}catch(K){console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function A(){if(!k.value)return{success:!0,logoUrl:I.value?"":o.modelValue};h.value=!0,m.value="";try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!K.ok){const q=await K.text().catch(()=>"");let Y=`Upload failed (${K.status})`;try{Y=JSON.parse(q).message||Y}catch{q&&(Y=q)}throw new Error(Y)}const ae=await K.json();return y.value=Date.now(),x(),k.value=null,I.value=!1,{success:!0,logoUrl:ae.logoUrl}}catch(K){return console.error("Logo upload error:",K),m.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}async function U(){if(!I.value)return{success:!0};h.value=!0,m.value="";try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}return I.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}function F(){return k.value!==null||I.value}function j(){return k.value}function Z(){return I.value}function X(){return b.value?b.value:I.value?"":s(o.modelValue)||""}function re(){x(),k.value=null,I.value=!1}return t({uploadStagedFile:A,deleteStagedLogo:U,hasPendingChanges:F,getStagedFile:j,isPendingDelete:Z,getDisplayUrl:X,resetStagedState:re}),(K,ae)=>(p(),g("div",_A,[ae[4]||(ae[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),T.value?(p(),g("div",CA,[r("img",{src:E.value,alt:"Event logo",class:"logo-image"},null,8,LA),r("button",{type:"button",class:"remove-btn",onClick:O,disabled:h.value}," Remove ",8,SA)])):(p(),g("div",{key:1,class:le(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:ae[0]||(ae[0]=ct(q=>f.value=!0,["prevent"])),onDragleave:ae[1]||(ae[1]=ct(q=>f.value=!1,["prevent"])),onDrop:ct(R,["prevent"]),onClick:_},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:$},null,544),h.value?(p(),g("div",IA,[...ae[2]||(ae[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(p(),g("div",xA,[...ae[3]||(ae[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),m.value?(p(),g("div",$A,w(m.value),1)):P("",!0)]))}},MA=Ke(TA,[["__scopeId","data-v-bfb1b332"]]),m1=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function AA(){return{...m1[0]}}function EA(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}const PA={class:"marshal-mockup-container"},DA={class:"presets-section"},RA={class:"presets-row"},OA=["title","onClick"],NA={class:"preset-name"},BA={class:"mockup-frame"},FA={key:0,class:"logo-cover-bg"},UA=["src"],zA=["src"],HA={class:"header-center"},VA={class:"event-name"},GA={class:"mockup-buttons"},qA=["src"],jA={class:"mockup-body"},WA={class:"mockup-card"},ZA={class:"card-content"},KA={class:"editor-header"},YA={class:"editor-content"},JA={class:"color-grid-inline"},XA={class:"color-field"},QA={class:"color-swatches"},eE=["title","onClick"],tE={key:0,class:"check"},nE={class:"custom-color-wrapper"},oE={class:"hex-popup-header"},sE={class:"hex-input-row"},aE=["disabled"],iE={key:0,class:"hex-error"},lE={class:"gradient-toggle"},rE={key:0,class:"color-field"},cE={class:"color-swatches"},uE=["title","onClick"],dE={key:0,class:"check"},hE={class:"custom-color-wrapper"},fE={class:"hex-popup-header"},pE={class:"hex-input-row"},vE=["disabled"],mE={key:0,class:"hex-error"},gE={key:1,class:"logo-position-section"},yE={class:"position-buttons"},kE={class:"color-swatches"},bE=["title","onClick"],wE={key:0,class:"check"},_E={class:"custom-color-wrapper"},CE={class:"hex-popup-header"},LE={class:"hex-input-row"},SE=["disabled"],IE={key:0,class:"hex-error"},xE={class:"color-grid-inline"},$E={class:"color-field"},TE={class:"color-swatches"},ME=["title","onClick"],AE={key:0,class:"check"},EE={class:"custom-color-wrapper"},PE={class:"hex-popup-header"},DE={class:"hex-input-row"},RE=["disabled"],OE={key:0,class:"hex-error"},NE={class:"gradient-toggle"},BE={key:0,class:"color-field"},FE={class:"color-swatches"},UE=["title","onClick"],zE={key:0,class:"check"},HE={class:"custom-color-wrapper"},VE={class:"hex-popup-header"},GE={class:"hex-input-row"},qE=["disabled"],jE={key:0,class:"hex-error"},WE={class:"editor-footer"},ZE={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:n}){const s=Ae=>Ae?Ae.startsWith("/api")?ti+Ae.substring(4):Ae:"",o=Un,i=e,l=n,c=D(null),d=m1,h=D(!1),f=D(!1),m=D(null),y=D(!1),k=D(""),b=Ae=>{typeof Ae=="object"&&Ae!==null?(y.value=Ae.isPendingDelete,k.value=Ae.displayUrl||"",l("logo-staged-change",Ae.hasPendingChanges)):(m.value&&(y.value=m.value.isPendingDelete(),k.value=m.value.getDisplayUrl()||""),l("logo-staged-change",!!Ae))},I=D(null),T=D(""),E=D(null),x=D(null),C=D({left:"50%",right:"auto",transform:"translateX(-50%)"}),_=Ae=>Ae?!o.some(oe=>oe.hex.toLowerCase()===Ae.toLowerCase()):!1,$=Ae=>!Ae||!_(Ae)?"#666666":Iu(Ae),R=Ae=>!Ae||!_(Ae)?"#e0e0e0":Ae,M=z(()=>{if(!T.value)return!1;const Ae=T.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Ae)||/^[0-9A-Fa-f]{3}$/.test(Ae)}),O=(Ae,oe)=>{if(I.value===Ae)I.value=null;else{I.value=Ae;let ge="";switch(Ae){case"headerStart":ge=i.branding.headerGradientStart;break;case"headerEnd":ge=i.branding.headerGradientEnd;break;case"pageStart":ge=i.branding.pageGradientStart;break;case"pageEnd":ge=i.branding.pageGradientEnd;break;case"accent":ge=i.branding.accentColor;break}if(ge&&_(ge)?T.value=ge.replace(/^#/,""):T.value="",oe&&x.value){const Ne=oe.currentTarget,Oe=x.value,$e=Ne.getBoundingClientRect(),me=Oe.getBoundingClientRect(),Ze=220,Ge=12,fe=$e.left+$e.width/2-me.left,be=me.width,ne=fe-Ze/2;fe+Ze/2>be-Ge?C.value={left:"auto",right:"0",transform:"none"}:ne<Ge?C.value={left:"0",right:"auto",transform:"none"}:C.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>E.value?.focus())}},A=()=>{T.value=T.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},U=()=>{if(!M.value||!I.value)return;let Ae=T.value;Ae.length===3&&(Ae=Ae[0]+Ae[0]+Ae[1]+Ae[1]+Ae[2]+Ae[2]);const oe="#"+Ae;switch(I.value){case"headerStart":J("start",oe);break;case"headerEnd":H("headerGradientEnd",oe);break;case"pageStart":de("start",oe);break;case"pageEnd":H("pageGradientEnd",oe);break;case"accent":H("accentColor",oe);break}I.value=null};Ye(c,Ae=>{if(I.value=null,T.value="",Ae==="header"){const oe=i.branding.headerGradientStart||yn.headerGradientStart,ge=i.branding.headerGradientEnd||yn.headerGradientEnd;h.value=oe!==ge}else if(Ae==="page"){const oe=i.branding.pageGradientStart||yn.pageGradientStart,ge=i.branding.pageGradientEnd||yn.pageGradientEnd;f.value=oe!==ge}});const F={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=z(()=>i.branding.headerGradientStart||yn.headerGradientStart),Z=z(()=>i.branding.headerGradientEnd||yn.headerGradientEnd),X=z(()=>i.branding.accentColor||yn.accentColor),re=z(()=>i.branding.pageGradientStart||yn.pageGradientStart),K=z(()=>i.branding.pageGradientEnd||yn.pageGradientEnd),ae=z(()=>i.branding.logoPosition||"left"),q=D(Date.now());Ye(()=>i.branding.logoUrl,()=>{q.value=Date.now(),y.value=!1,k.value=""});const Y=z(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),te=z(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const ge=s(k.value),Ne=ge.includes("?")?"&":"?";return`${ge}${Ne}_t=${q.value}`}if(!i.branding.logoUrl)return"";const Ae=s(i.branding.logoUrl),oe=Ae.includes("?")?"&":"?";return`${Ae}${oe}_t=${q.value}`}),ue=z(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Z.value} 100%)`})),_e=z(()=>n1(j.value,Z.value)),Te=z(()=>({background:X.value,color:Iu(X.value)})),Pe=z(()=>({background:`linear-gradient(135deg, ${re.value} 0%, ${K.value} 100%)`}));function De(Ae){c.value=c.value===Ae?null:Ae}function ke(Ae){!Y.value&&Ae&&H("logoPosition",Ae),De("logo")}function H(Ae,oe){l("update:branding",{...i.branding,[Ae]:oe})}function J(Ae,oe){h.value?H("headerGradientStart",oe):l("update:branding",{...i.branding,headerGradientStart:oe,headerGradientEnd:oe})}function de(Ae,oe){f.value?H("pageGradientStart",oe):l("update:branding",{...i.branding,pageGradientStart:oe,pageGradientEnd:oe})}function ie(){if(!h.value){const Ae=i.branding.headerGradientStart||yn.headerGradientStart;H("headerGradientEnd",Ae)}}function Re(){if(!f.value){const Ae=i.branding.pageGradientStart||yn.pageGradientStart;H("pageGradientEnd",Ae)}}function G(Ae){l("update:branding",EA(i.branding,Ae)),c.value=null}async function Q(){return m.value?await m.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ee(){return m.value?await m.value.deleteStagedLogo():{success:!0}}function Ce(){return m.value?.hasPendingChanges()||!1}function Be(){return m.value?.isPendingDelete()||!1}function ze(){m.value&&m.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:Q,deleteStagedLogo:ee,hasLogoChanges:Ce,isLogoPendingDelete:Be,resetLogo:ze}),(Ae,oe)=>(p(),g("div",PA,[r("div",DA,[oe[32]||(oe[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",RA,[(p(!0),g(Se,null,je(B(d),ge=>(p(),g("button",{key:ge.name,type:"button",class:"preset-btn",title:ge.name,onClick:Ne=>G(ge)},[r("span",{class:"preset-preview",style:tt({background:`linear-gradient(135deg, ${ge.pageGradientStart} 0%, ${ge.pageGradientEnd} 100%)`})},null,4),r("span",NA,w(ge.name),1)],8,OA))),128))])]),r("div",BA,[r("div",{class:le(["mockup-page",{"region-active":c.value==="page"}]),style:tt(Pe.value),onClick:oe[7]||(oe[7]=ge=>De("page"))},[r("div",{class:le(["mockup-header",[{"region-active":c.value==="header"},Y.value?`logo-${ae.value}`:"logo-none"]]),style:tt(ue.value),onClick:oe[5]||(oe[5]=ct(ge=>De("header"),["stop"]))},[Y.value&&ae.value==="cover"?(p(),g("div",FA,[r("img",{src:te.value,alt:"Logo",class:"logo-cover-img"},null,8,UA)])):P("",!0),Y.value&&ae.value==="cover"?(p(),g("button",{key:1,type:"button",class:le(["logo-cover-edit-btn",{"region-active":c.value==="logo"}]),onClick:oe[0]||(oe[0]=ct(ge=>De("logo"),["stop"])),title:"Edit logo"},[...oe[33]||(oe[33]=[r("span",null,"",-1)])],2)):P("",!0),Y.value&&ae.value==="left"?(p(),g("div",{key:2,class:le(["mockup-logo logo-left",{"region-active":c.value==="logo"}]),onClick:oe[1]||(oe[1]=ct(ge=>De("logo"),["stop"]))},[r("img",{src:te.value,alt:"Logo",class:"logo-img"},null,8,zA)],2)):P("",!0),Y.value?P("",!0):(p(),g("div",{key:3,class:le(["logo-add-area logo-add-left",{"region-active":c.value==="logo"}]),onClick:oe[2]||(oe[2]=ct(ge=>ke("left"),["stop"]))},[...oe[34]||(oe[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",HA,[r("div",{class:"mockup-title",style:tt({color:_e.value})},[r("span",VA,w(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:tt({color:_e.value})},w(e.eventDate||"Event Date"),5),r("div",GA,[oe[35]||(oe[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:tt({color:_e.value})},"Logout",4)])]),Y.value&&ae.value==="right"?(p(),g("div",{key:4,class:le(["mockup-logo logo-right",{"region-active":c.value==="logo"}]),onClick:oe[3]||(oe[3]=ct(ge=>De("logo"),["stop"]))},[r("img",{src:te.value,alt:"Logo",class:"logo-img"},null,8,qA)],2)):P("",!0),Y.value?P("",!0):(p(),g("div",{key:5,class:le(["logo-add-area logo-add-right",{"region-active":c.value==="logo"}]),onClick:oe[4]||(oe[4]=ct(ge=>ke("right"),["stop"]))},[...oe[36]||(oe[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",jA,[r("div",WA,[oe[37]||(oe[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",ZA,[r("div",{class:le(["mockup-checkin-btn",{"region-active":c.value==="accent"}]),style:tt(Te.value),onClick:oe[6]||(oe[6]=ct(ge=>De("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),We(r("div",{class:"editor-overlay",onClick:oe[31]||(oe[31]=ct(ge=>c.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:x,class:"editor-modal"},[r("div",KA,[r("span",null,w(F[c.value]),1),r("button",{type:"button",class:"editor-close",onClick:oe[8]||(oe[8]=ge=>c.value=null)},"")]),r("div",YA,[c.value==="header"?(p(),g(Se,{key:0},[oe[46]||(oe[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",JA,[r("div",XA,[r("label",null,w(h.value?"Start colour":"Colour"),1),r("div",QA,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"hs-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>J("start",ge.hex)},[e.branding.headerGradientStart===ge.hex?(p(),g("span",tE,"")):P("",!0)],14,eE))),128)),r("div",nE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:_(e.branding.headerGradientStart)}]),style:tt({backgroundColor:R(e.branding.headerGradientStart)}),title:"Custom colour",onClick:oe[9]||(oe[9]=ge=>O("headerStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[38]||(oe[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),I.value==="headerStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",oE,[oe[39]||(oe[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[10]||(oe[10]=ge=>I.value=null)},"")]),r("div",sE,[oe[40]||(oe[40]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[11]||(oe[11]=ge=>T.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!M.value}]),onInput:A,onKeydown:Qo(U,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,aE)]),T.value&&!M.value?(p(),g("span",iE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",lE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[12]||(oe[12]=ge=>h.value=ge),onChange:ie},null,544),[[Ms,h.value]]),oe[41]||(oe[41]=r("span",null,"Use gradient",-1))])]),h.value?(p(),g("div",rE,[oe[45]||(oe[45]=r("label",null,"End colour",-1)),r("div",cE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"he-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>H("headerGradientEnd",ge.hex)},[e.branding.headerGradientEnd===ge.hex?(p(),g("span",dE,"")):P("",!0)],14,uE))),128)),r("div",hE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:_(e.branding.headerGradientEnd)}]),style:tt({backgroundColor:R(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:oe[13]||(oe[13]=ge=>O("headerEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[42]||(oe[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),I.value==="headerEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",fE,[oe[43]||(oe[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[14]||(oe[14]=ge=>I.value=null)},"")]),r("div",pE,[oe[44]||(oe[44]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[15]||(oe[15]=ge=>T.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!M.value}]),onInput:A,onKeydown:Qo(U,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,vE)]),T.value&&!M.value?(p(),g("span",mE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0),c.value==="logo"?(p(),g("div",gE,[oe[47]||(oe[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",yE,[r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="left"}]),onClick:oe[16]||(oe[16]=ge=>H("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="cover"}]),onClick:oe[17]||(oe[17]=ge=>H("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="right"}]),onClick:oe[18]||(oe[18]=ge=>H("logoPosition","right"))}," Right ",2)])])):P("",!0),We(Ee(MA,{ref_key:"logoUploaderRef",ref:m,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":oe[19]||(oe[19]=ge=>H("logoUrl",ge)),onStagedChange:b},null,8,["model-value","event-id","admin-email"]),[[os,c.value==="logo"]]),c.value==="accent"?(p(),g(Se,{key:2},[oe[51]||(oe[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",kE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"ac-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.accentColor===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>H("accentColor",ge.hex)},[e.branding.accentColor===ge.hex?(p(),g("span",wE,"")):P("",!0)],14,bE))),128)),r("div",_E,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:_(e.branding.accentColor)}]),style:tt({backgroundColor:R(e.branding.accentColor)}),title:"Custom colour",onClick:oe[20]||(oe[20]=ge=>O("accent",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[48]||(oe[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),I.value==="accent"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",CE,[oe[49]||(oe[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[21]||(oe[21]=ge=>I.value=null)},"")]),r("div",LE,[oe[50]||(oe[50]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[22]||(oe[22]=ge=>T.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!M.value}]),onInput:A,onKeydown:Qo(U,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,SE)]),T.value&&!M.value?(p(),g("span",IE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])],64)):P("",!0),c.value==="page"?(p(),g(Se,{key:3},[oe[60]||(oe[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",xE,[r("div",$E,[r("label",null,w(f.value?"Start colour":"Colour"),1),r("div",TE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"ps-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>de("start",ge.hex)},[e.branding.pageGradientStart===ge.hex?(p(),g("span",AE,"")):P("",!0)],14,ME))),128)),r("div",EE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:_(e.branding.pageGradientStart)}]),style:tt({backgroundColor:R(e.branding.pageGradientStart)}),title:"Custom colour",onClick:oe[23]||(oe[23]=ge=>O("pageStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[52]||(oe[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),I.value==="pageStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",PE,[oe[53]||(oe[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[24]||(oe[24]=ge=>I.value=null)},"")]),r("div",DE,[oe[54]||(oe[54]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[25]||(oe[25]=ge=>T.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!M.value}]),onInput:A,onKeydown:Qo(U,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,RE)]),T.value&&!M.value?(p(),g("span",OE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",NE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[26]||(oe[26]=ge=>f.value=ge),onChange:Re},null,544),[[Ms,f.value]]),oe[55]||(oe[55]=r("span",null,"Use gradient",-1))])]),f.value?(p(),g("div",BE,[oe[59]||(oe[59]=r("label",null,"End colour",-1)),r("div",FE,[(p(!0),g(Se,null,je(B(o),ge=>(p(),g("button",{key:"pe-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Ne=>H("pageGradientEnd",ge.hex)},[e.branding.pageGradientEnd===ge.hex?(p(),g("span",zE,"")):P("",!0)],14,UE))),128)),r("div",HE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:_(e.branding.pageGradientEnd)}]),style:tt({backgroundColor:R(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:oe[27]||(oe[27]=ge=>O("pageEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[56]||(oe[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),I.value==="pageEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",VE,[oe[57]||(oe[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[28]||(oe[28]=ge=>I.value=null)},"")]),r("div",GE,[oe[58]||(oe[58]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":oe[29]||(oe[29]=ge=>T.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!M.value}]),onInput:A,onKeydown:Qo(U,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,qE)]),T.value&&!M.value?(p(),g("span",jE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0)]),r("div",WE,[r("button",{type:"button",class:"btn-done",onClick:oe[30]||(oe[30]=ge=>c.value=null)},"Done")])],512)],512),[[os,c.value]]),oe[61]||(oe[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},KE=Ke(ZE,[["__scopeId","data-v-01af4f2d"]]),YE={class:"settings-tab"},JE={class:"accordion"},XE={class:"accordion-section"},QE={class:"accordion-title"},e4={class:"accordion-icon"},t4={key:0,class:"accordion-content"},n4={class:"accordion-section"},o4={class:"accordion-icon"},s4={key:0,class:"accordion-content"},a4={class:"terminology-grid"},i4={class:"term-group"},l4=["value"],r4={class:"term-group"},c4=["value"],u4={class:"term-group"},d4=["value"],h4={class:"term-group"},f4=["value"],p4={class:"term-group"},v4=["value"],m4={class:"form-actions"},g4=["disabled"],y4={class:"accordion-section"},k4={class:"accordion-title"},b4={class:"accordion-icon"},w4={key:0,class:"accordion-content"},_4={class:"section-description"},C4={class:"form-actions"},L4=["disabled"],S4={class:"accordion-section"},I4={class:"accordion-title"},x4={class:"accordion-icon"},$4={key:0,class:"accordion-content"},T4={class:"section-description"},M4={class:"form-actions"},A4=["disabled"],E4=["disabled"],Uv="admin_settings_accordion",P4={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=mc(),i=z(()=>o.adminEmail||""),l=e,c=t,d=D({...l.eventData}),h=D(null),f=D(!1),m=()=>l.eventId?`${Uv}_${l.eventId}`:Uv,y=D(null);un(()=>{const M=localStorage.getItem(m());M&&(y.value=M)});const k=z(()=>{const M=d.value.peopleTerm||"Marshals";return ga.checkpoint.map(O=>({value:O,label:Wh(O,M)}))}),b=M=>{const O=y.value===M?null:M;y.value=O,O?localStorage.setItem(m(),O):localStorage.removeItem(m())};Ye(()=>l.eventData,M=>{d.value={...M},x.value=!1},{deep:!0});const I=()=>{c("update:formDirty",!0)},T=(M,O)=>{d.value[M]=O,I()},E=z(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),x=D(!1),C=M=>{x.value=M},_=M=>{d.value.brandingHeaderGradientStart=M.headerGradientStart,d.value.brandingHeaderGradientEnd=M.headerGradientEnd,d.value.brandingLogoUrl=M.logoUrl,d.value.brandingLogoPosition=M.logoPosition,d.value.brandingAccentColor=M.accentColor,d.value.brandingPageGradientStart=M.pageGradientStart,d.value.brandingPageGradientEnd=M.pageGradientEnd,I()},$=()=>{AA(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",x.value=!1,h.value?.resetLogo(),I()},R=async()=>{if(!f.value){f.value=!0;try{if(x.value&&h.value){if(h.value.isLogoPendingDelete()){const O=await h.value.deleteStagedLogo();if(!O.success){console.error("Failed to delete logo:",O.error);return}d.value.brandingLogoUrl=""}else{const O=await h.value.uploadStagedLogo();if(!O.success){console.error("Failed to upload logo:",O.error);return}O.logoUrl&&!O.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=O.logoUrl)}x.value=!1}c("submit",{...d.value})}finally{f.value=!1}}};return(M,O)=>(p(),g("div",YE,[r("div",JE,[r("div",XE,[r("button",{class:le(["accordion-header",{active:y.value==="admins"}]),onClick:O[0]||(O[0]=A=>b("admins"))},[r("span",QE,"Administrators ("+w(e.admins.length)+")",1),r("span",e4,w(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(p(),g("div",t4,[Ee(BT,{admins:e.admins,onAddAdmin:O[1]||(O[1]=A=>M.$emit("add-admin")),onRemoveAdmin:O[2]||(O[2]=A=>M.$emit("remove-admin",A))},null,8,["admins"])])):P("",!0)]),r("div",n4,[r("button",{class:le(["accordion-header",{active:y.value==="terminology"}]),onClick:O[3]||(O[3]=A=>b("terminology"))},[O[19]||(O[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",o4,w(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(p(),g("div",s4,[O[20]||(O[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",a4,[r("div",i4,[r("label",null,w(B(n).people)+" are called",1),We(r("select",{"onUpdate:modelValue":O[4]||(O[4]=A=>d.value.peopleTerm=A),class:"form-input",onChange:I},[(p(!0),g(Se,null,je(B(ga).people,A=>(p(),g("option",{key:A,value:A},w(A),9,l4))),128))],544),[[Qn,d.value.peopleTerm]])]),r("div",r4,[r("label",null,w(B(n).checkpoints)+" are called",1),We(r("select",{"onUpdate:modelValue":O[5]||(O[5]=A=>d.value.checkpointTerm=A),class:"form-input",onChange:I},[(p(!0),g(Se,null,je(k.value,A=>(p(),g("option",{key:A.value,value:A.value},w(A.label),9,c4))),128))],544),[[Qn,d.value.checkpointTerm]])]),r("div",u4,[r("label",null,w(B(n).areas)+" are called",1),We(r("select",{"onUpdate:modelValue":O[6]||(O[6]=A=>d.value.areaTerm=A),class:"form-input",onChange:I},[(p(!0),g(Se,null,je(B(ga).area,A=>(p(),g("option",{key:A,value:A},w(A),9,d4))),128))],544),[[Qn,d.value.areaTerm]])]),r("div",h4,[r("label",null,w(B(n).checklists)+" are called",1),We(r("select",{"onUpdate:modelValue":O[7]||(O[7]=A=>d.value.checklistTerm=A),class:"form-input",onChange:I},[(p(!0),g(Se,null,je(B(ga).checklist,A=>(p(),g("option",{key:A,value:A},w(A),9,f4))),128))],544),[[Qn,d.value.checklistTerm]])]),r("div",p4,[r("label",null,w(B(n).course)+" is called",1),We(r("select",{"onUpdate:modelValue":O[8]||(O[8]=A=>d.value.courseTerm=A),class:"form-input",onChange:I},[(p(!0),g(Se,null,je(B(ga).course,A=>(p(),g("option",{key:A,value:A},w(A),9,v4))),128))],544),[[Qn,d.value.courseTerm]])])]),r("div",m4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,g4)])])):P("",!0)]),r("div",y4,[r("button",{class:le(["accordion-header",{active:y.value==="appearance"}]),onClick:O[9]||(O[9]=A=>b("appearance"))},[r("span",k4,w(B(n).checkpoint)+" appearance",1),r("span",b4,w(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(p(),g("div",w4,[r("p",_4," Set the default marker style for all "+w(B(s).checkpoints)+" in this event. Individual "+w(B(s).areas)+" and "+w(B(s).checkpoints)+" can override this setting. ",1),Ee(Nf,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":O[10]||(O[10]=A=>T("defaultCheckpointStyleType",A)),"onUpdate:styleColor":O[11]||(O[11]=A=>T("defaultCheckpointStyleColor",A)),"onUpdate:styleBackgroundShape":O[12]||(O[12]=A=>T("defaultCheckpointStyleBackgroundShape",A)),"onUpdate:styleBackgroundColor":O[13]||(O[13]=A=>T("defaultCheckpointStyleBackgroundColor",A)),"onUpdate:styleBorderColor":O[14]||(O[14]=A=>T("defaultCheckpointStyleBorderColor",A)),"onUpdate:styleIconColor":O[15]||(O[15]=A=>T("defaultCheckpointStyleIconColor",A)),"onUpdate:styleSize":O[16]||(O[16]=A=>T("defaultCheckpointStyleSize",A)),"onUpdate:styleMapRotation":O[17]||(O[17]=A=>T("defaultCheckpointStyleMapRotation",A))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",C4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,L4)])])):P("",!0)]),r("div",S4,[r("button",{class:le(["accordion-header",{active:y.value==="branding"}]),onClick:O[18]||(O[18]=A=>b("branding"))},[r("span",I4,w(B(n).person)+" branding",1),r("span",x4,w(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(p(),g("div",$4,[r("p",T4," Customise the appearance of the "+w(B(s).person)+" view to match your organisation's branding. ",1),Ee(KE,{ref_key:"brandingMockupRef",ref:h,branding:E.value,"event-name":d.value.name,"event-date":B(Jy)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":_,onLogoStagedChange:C},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",M4,[r("button",{onClick:$,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,A4),r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty&&!x.value||f.value},w(f.value?"Saving...":"Save"),9,E4)])])):P("",!0)])])]))}},D4=Ke(P4,[["__scopeId","data-v-bb7e241a"]]),R4={class:"incident-header"},O4={class:"incident-title-row"},N4={class:"incident-title"},B4={class:"incident-badges"},F4={key:0,class:"incident-description"},U4={class:"incident-context"},z4={key:0,class:"context-item"},H4={key:1,class:"context-item"},V4={key:2,class:"context-item"},G4={class:"incident-footer"},q4={class:"reporter-info"},j4={class:"time-info"},W4={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,n=z(()=>{if(t.incident.title)return t.incident.title;const c=t.incident.description||"";return c.length<=60?c:c.substring(0,57).trim()+"..."}),s=c=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[c]||c,o=c=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[c]||c,i=(c,d=120)=>!c||c.length<=d?c:c.substring(0,d).trim()+"...",l=c=>{if(!c)return"";const d=new Date(c),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),k=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(c,d)=>(p(),g("div",{class:le(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>c.$emit("select",e.incident))},[r("div",R4,[r("div",O4,[r("span",{class:le(["severity-indicator",e.incident.severity])},null,2),r("strong",N4,w(n.value),1)]),r("div",B4,[r("span",{class:le(["severity-badge",e.incident.severity])},w(s(e.incident.severity)),3),r("span",{class:le(["status-badge",e.incident.status])},w(o(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(p(),g("div",F4,w(i(e.incident.description)),1)):P("",!0),r("div",U4,[e.incident.context?.checkpoint?(p(),g("div",z4,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,w(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(p(),g("div",H4,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(p(),g("div",V4,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,w(e.incident.area.areaName),1)])):P("",!0)]),r("div",G4,[r("span",q4," Reported by "+w(e.incident.reportedBy?.name||"Unknown"),1),r("span",j4,w(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},kc=Ke(W4,[["__scopeId","data-v-690fd385"]]),Z4={class:"incidents-tab"},K4={class:"tab-header"},Y4={class:"button-group"},J4={key:0,class:"status-pills"},X4={class:"filters-section"},Q4={class:"search-group"},e3={class:"incidents-list"},t3={key:0,class:"loading-state"},n3={key:1,class:"empty-state"},o3={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const n=e,s=D(""),o=D("all"),i=y=>{o.value=y},l=z(()=>n.incidents.filter(y=>y.status==="open").length),c=z(()=>n.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=z(()=>n.incidents.filter(y=>y.status==="resolved").length),h=z(()=>n.incidents.filter(y=>y.status==="closed").length),f=z(()=>{let y=n.incidents;if(o.value==="open"?y=y.filter(k=>k.status==="open"):o.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):o.value==="resolved"?y=y.filter(k=>k.status==="resolved"):o.value==="closed"&&(y=y.filter(k=>k.status==="closed")),s.value.trim()){const k=s.value.toLowerCase().trim().split(/\s+/);y=y.filter(b=>{const I=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,T=b.area?.areaName||"",E=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map(_=>_.name||"")].join(" "),x=(b.updates||[]).map(_=>_.note||"").join(" "),C=`${b.title||""} ${b.description||""} ${I} ${T} ${E} ${x}`.toLowerCase();return k.every(_=>C.includes(_))})}return y}),m=z(()=>[...f.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(p(),g("div",Z4,[r("div",K4,[r("div",Y4,[r("button",{onClick:k[0]||(k[0]=b=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(p(),g("div",J4,[Ee(Pt,{variant:"neutral",active:o.value==="all",onClick:k[1]||(k[1]=b=>i("all"))},{default:Ve(()=>[Je(w(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(p(),qe(Pt,{key:0,variant:"info",active:o.value==="open",onClick:k[2]||(k[2]=b=>i("open"))},{default:Ve(()=>[Je(w(l.value)+" open ",1)]),_:1},8,["active"])):P("",!0),c.value>0&&c.value<e.incidents.length?(p(),qe(Pt,{key:1,variant:"purple",active:o.value==="in-progress",onClick:k[3]||(k[3]=b=>i("in-progress"))},{default:Ve(()=>[Je(w(c.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0&&d.value<e.incidents.length?(p(),qe(Pt,{key:2,variant:"success",active:o.value==="resolved",onClick:k[4]||(k[4]=b=>i("resolved"))},{default:Ve(()=>[Je(w(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.incidents.length?(p(),qe(Pt,{key:3,variant:"neutral",active:o.value==="closed",onClick:k[5]||(k[5]=b=>i("closed"))},{default:Ve(()=>[Je(w(h.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",X4,[r("div",Q4,[We(r("input",{"onUpdate:modelValue":k[6]||(k[6]=b=>s.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,s.value]])])]),r("div",e3,[e.loading?(p(),g("div",t3," Loading incidents... ")):f.value.length===0?(p(),g("div",n3,[r("p",null,w(s.value||o.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(p(!0),g(Se,null,je(m.value,b=>(p(),qe(kc,{key:b.incidentId,incident:b,onSelect:I=>y.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},s3=Ke(o3,[["__scopeId","data-v-f24c84f4"]]),a3={key:0,class:"empty-state"},i3={key:0,class:"empty-hint"},l3={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,n)=>e.isEmpty?(p(),g("div",a3,[r("p",null,w(e.emptyMessage),1),e.emptyHint?(p(),g("p",i3,w(e.emptyHint),1)):P("",!0)])):(p(),g("div",{key:1,class:le(["cards-grid",e.gridClass])},[mo(t.$slots,"default",{},void 0,!0)],2))}},bc=Ke(l3,[["__scopeId","data-v-a842b7b1"]]),r3={class:"checkpoint-card-header"},c3={class:"checkpoint-name-row"},u3=["innerHTML"],d3={class:"checkpoint-name"},h3={key:0,class:"checkpoint-description"},f3={key:0,class:"checkpoint-card-areas"},p3={class:"checkpoint-card-stats"},v3={key:1,class:"checkpoint-card-marshals"},m3={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>n.checkpoint.areaIds||n.checkpoint.AreaIds||[]),i=T=>{const E=n.areas.find(x=>x.id===T);return E?E.name:null},l=T=>{const E=n.areas.find(x=>x.id===T);return E?E.color:"#999"},c=z(()=>{const T=n.checkpoint,E=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor;return E||(o.value.length>0?l(o.value[0]):"#667eea")}),d=z(()=>{const T=n.checkpoint,E=(T.assignments||[]).length;return T.requiredMarshals===0?null:E>=T.requiredMarshals?"full":E>0?"partial":"none"}),h=z(()=>[...n.checkpoint.assignments||[]].sort((E,x)=>(E.marshalName||"").localeCompare(x.marshalName||"",void 0,{sensitivity:"base"}))),f=z(()=>(n.checkpoint.assignments||[]).length),m=z(()=>(n.checkpoint.assignments||[]).filter(T=>T.isCheckedIn).length),y=z(()=>d.value?`staffing-${d.value}`:""),k=z(()=>{const T=f.value,E=m.value;return T===0?"":E===0?"checkin-none":E>=T?"checkin-full":"checkin-partial"}),b=z(()=>{const T=n.checkpoint,E=T.resolvedStyleType||T.ResolvedStyleType,x=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor,C=T.resolvedStyleBorderColor||T.ResolvedStyleBorderColor,_=T.resolvedStyleIconColor||T.ResolvedStyleIconColor,$=T.resolvedStyleBackgroundShape||T.ResolvedStyleBackgroundShape;return E&&E!=="default"||x||C||_||$&&$!=="circle"?zn({type:E||"circle",backgroundShape:$||"circle",backgroundColor:x||"#667eea",borderColor:C||"#ffffff",iconColor:_||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),I=()=>{n.clickable&&s("click",n.checkpoint)};return(T,E)=>(p(),g("div",{class:le(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:tt({borderLeftColor:c.value}),onClick:I},[r("div",r3,[r("div",{class:le(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",c3,[r("span",{class:"checkpoint-icon",innerHTML:b.value},null,8,u3),r("span",d3,w(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",h3,"  "+w(e.checkpoint.description),1)):P("",!0)])],2)]),o.value.length>0?(p(),g("div",f3,[(p(!0),g(Se,null,je(o.value,x=>(p(),g("span",{key:x,class:"area-badge",style:tt({backgroundColor:l(x)})},w(i(x)),5))),128))])):P("",!0),r("div",p3,[r("span",{class:le(["stat-badge staffing-badge",y.value])},w(f.value)+"/"+w(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(p(),g("span",{key:0,class:le(["stat-badge",k.value])},w(m.value)+"/"+w(f.value)+" checked in ",3)):P("",!0)]),h.value.length>0?(p(),g("div",v3,[(p(!0),g(Se,null,je(h.value,x=>(p(),g("span",{key:x.id,class:le(["marshal-badge",{"checked-in":x.isCheckedIn}])},w(x.marshalName),3))),128))])):P("",!0)],6))}},g3=Ke(m3,[["__scopeId","data-v-7ae260df"]]),g1={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),qe(bc,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Se,null,je(e.checkpoints,s=>(p(),qe(g3,{key:s.id,checkpoint:s,areas:e.areas,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},y3={class:"checkpoints-tab"},k3={class:"tab-header"},b3={class:"button-group"},w3={key:0,class:"status-pills"},_3={class:"filters-section"},C3={class:"search-group"},L3=["placeholder"],S3={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ht(),n=e,s=D(""),o=D("all"),i=x=>{o.value=x},l=x=>(x.assignments||[]).length,c=x=>(x.assignments||[]).filter(C=>C.isCheckedIn).length,d=z(()=>n.locations.filter(x=>l(x)>=x.requiredMarshals&&x.requiredMarshals>0).length),h=z(()=>n.locations.filter(x=>l(x)>0&&l(x)<x.requiredMarshals).length),f=z(()=>n.locations.filter(x=>l(x)===0&&x.requiredMarshals>0).length),m=z(()=>n.locations.filter(x=>{const C=l(x),_=c(x);return C>0&&_>=C}).length),y=z(()=>n.locations.filter(x=>{const C=l(x),_=c(x);return C>0&&_>0&&_<C}).length),k=z(()=>n.locations.filter(x=>{const C=l(x),_=c(x);return C>0&&_===0}).length),b=x=>{const C=n.areas.find(_=>_.id===x);return C?C.name:null},I=z(()=>{let x=n.locations;if(o.value==="full"?x=x.filter(C=>l(C)>=C.requiredMarshals&&C.requiredMarshals>0):o.value==="partial"?x=x.filter(C=>l(C)>0&&l(C)<C.requiredMarshals):o.value==="missing"?x=x.filter(C=>l(C)===0&&C.requiredMarshals>0):o.value==="checkin-full"?x=x.filter(C=>{const _=l(C),$=c(C);return _>0&&$>=_}):o.value==="checkin-partial"?x=x.filter(C=>{const _=l(C),$=c(C);return _>0&&$>0&&$<_}):o.value==="checkin-none"&&(x=x.filter(C=>{const _=l(C),$=c(C);return _>0&&$===0})),s.value.trim()){const C=s.value.toLowerCase().trim().split(/\s+/);x=x.filter(_=>{const R=(_.areaIds||_.AreaIds||[]).map(A=>b(A)||"").join(" "),M=(_.assignments||[]).map(A=>A.marshalName||"").join(" "),O=`${_.name||""} ${_.description||""} ${R} ${M}`.toLowerCase();return C.every(A=>O.includes(A))})}return x}),T=z(()=>[...I.value].sort((x,C)=>es(x.name,C.name))),E=z(()=>{const x=s.value.trim();return o.value==="full"?x?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:o.value==="partial"?x?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:o.value==="missing"?x?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:o.value==="checkin-full"?x?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:o.value==="checkin-partial"?x?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:o.value==="checkin-none"?x?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:x?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(x,C)=>(p(),g("div",y3,[r("div",k3,[r("div",b3,[r("button",{onClick:C[0]||(C[0]=_=>x.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+w(B(t).checkpoint),1),r("button",{onClick:C[1]||(C[1]=_=>x.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(p(),g("div",w3,[Ee(Pt,{variant:"neutral",active:o.value==="all",onClick:C[2]||(C[2]=_=>i("all"))},{default:Ve(()=>[Je(w(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(p(),qe(Pt,{key:0,variant:"success",active:o.value==="full",onClick:C[3]||(C[3]=_=>i("full"))},{default:Ve(()=>[Je(w(d.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.locations.length?(p(),qe(Pt,{key:1,variant:"warning",active:o.value==="partial",onClick:C[4]||(C[4]=_=>i("partial"))},{default:Ve(()=>[Je(w(h.value)+" partially staffed ",1)]),_:1},8,["active"])):P("",!0),f.value>0&&f.value<e.locations.length?(p(),qe(Pt,{key:2,variant:"danger",active:o.value==="missing",onClick:C[5]||(C[5]=_=>i("missing"))},{default:Ve(()=>[Je(w(f.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0),m.value>0&&m.value<e.locations.length?(p(),qe(Pt,{key:3,variant:"success",active:o.value==="checkin-full",onClick:C[6]||(C[6]=_=>i("checkin-full"))},{default:Ve(()=>[Je(w(m.value)+" fully checked in ",1)]),_:1},8,["active"])):P("",!0),y.value>0&&y.value<e.locations.length?(p(),qe(Pt,{key:4,variant:"warning",active:o.value==="checkin-partial",onClick:C[7]||(C[7]=_=>i("checkin-partial"))},{default:Ve(()=>[Je(w(y.value)+" partially checked in ",1)]),_:1},8,["active"])):P("",!0),k.value>0&&k.value<e.locations.length?(p(),qe(Pt,{key:5,variant:"danger",active:o.value==="checkin-none",onClick:C[8]||(C[8]=_=>i("checkin-none"))},{default:Ve(()=>[Je(w(k.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",_3,[r("div",C3,[We(r("input",{"onUpdate:modelValue":C[9]||(C[9]=_=>s.value=_),type:"text",class:"search-input",placeholder:`Search by name, description, ${B(t).area}, or ${B(t).person}...`},null,8,L3),[[st,s.value]])])]),Ee(g1,{checkpoints:T.value,areas:e.areas,"empty-message":E.value,onSelect:C[10]||(C[10]=_=>x.$emit("select-location",_))},null,8,["checkpoints","areas","empty-message"])]))}},I3=Ke(S3,[["__scopeId","data-v-846aa906"]]),x3={class:"area-card-header"},$3={class:"area-name-row"},T3={class:"area-name"},M3={key:0,class:"default-badge"},A3={key:0,class:"area-description"},E3={class:"area-card-stats"},P3={class:"stat-badge"},D3={class:"stat-badge"},R3={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>n.area.checkpointCount!==void 0?n.area.checkpointCount:n.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(n.area.id)||f.areaId===n.area.id).length),i=z(()=>n.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(n.area.id):!1):!1).length),l=z(()=>n.area.peopleTerm||n.eventPeopleTerm||"Marshals"),c=z(()=>{const f=n.area.checkpointTerm||n.eventCheckpointTerm||"Checkpoints";return o.value===1?Wi("checkpoint",f,l.value):Zy("checkpoint",f,l.value)}),d=z(()=>`${o.value} ${c.value.toLowerCase()}`),h=()=>{n.clickable&&s("click",n.area)};return(f,m)=>(p(),g("div",{class:le(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:tt({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",x3,[r("div",{class:le(["area-card-title",{clickable:e.clickable}])},[r("div",$3,[r("span",T3,w(e.area.name),1),e.area.isDefault?(p(),g("span",M3,"Default")):P("",!0)]),e.area.description?(p(),g("span",A3,w(e.area.description),1)):P("",!0)],2)]),r("div",E3,[r("span",P3,w(d.value),1),r("span",D3,w(i.value)+" contact"+w(i.value===1?"":"s"),1)])],6))}},O3=Ke(R3,[["__scopeId","data-v-8ac20bf2"]]),N3={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),qe(bc,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Se,null,je(e.areas,s=>(p(),qe(O3,{key:s.id,area:s,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},B3={class:"areas-tab"},F3={class:"tab-header"},U3={class:"button-group"},z3={key:0,class:"status-pills"},H3={class:"filters-section"},V3={class:"search-group"},G3=["placeholder"],q3={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ht(),n=e,s=D(""),o=d=>n.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=z(()=>{if(!s.value.trim())return n.areas;const d=s.value.toLowerCase().trim().split(/\s+/);return n.areas.filter(h=>{const m=o(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${m}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=z(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:es(d.name,h.name))),c=z(()=>s.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(p(),g("div",B3,[r("div",F3,[r("div",U3,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+w(B(t).area),1)]),e.areas.length>0?(p(),g("div",z3,[Ee(Pt,{variant:"neutral",active:!1},{default:Ve(()=>[Je(w(e.areas.length)+" "+w(e.areas.length===1?B(t).area:B(t).areas),1)]),_:1})])):P("",!0)]),r("div",H3,[r("div",V3,[We(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>s.value=f),type:"text",class:"search-input",placeholder:`Search by ${B(t).area} name or ${B(t).checkpoint} name...`},null,8,G3),[[st,s.value]])])]),Ee(N3,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":c.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},j3=Ke(q3,[["__scopeId","data-v-203f9606"]]),W3={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',roles:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15c0-4 3.5-7 8-7s8 3 8 7"/><path d="M4 15c0 1.5 3.5 3 8 3s8-1.5 8-3"/><path d="M20 15h2c.5 0 1-.5 1-1v-1c0-1-1-2-2.5-2H20"/><circle cx="12" cy="8" r="1"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},to=e=>W3[e]||"",Z3={class:"responsive-tabs"},K3=["onClick"],Y3=["innerHTML"],J3=["innerHTML"],X3={class:"hamburger-label"},Q3=["onClick"],eP=["innerHTML"],tP={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D({}),h=D(!1),f=z(()=>n.tabs.find(E=>E.value===n.modelValue)),m=z(()=>f.value?f.value.label:"Menu"),y=()=>{if(c.value=!c.value,c.value&&i.value){const E=i.value.getBoundingClientRect();d.value={top:`${E.bottom+4}px`}}},k=E=>{s("update:modelValue",E),c.value=!1},b=E=>{if(!o.value)return;const x=o.value.contains(E.target);c.value&&!x&&(c.value=!1)},I=()=>{if(!l.value)return;const E=l.value,x=h.value;x&&(E.style.visibility="visible",E.style.position="static");const C=E.scrollWidth>E.clientWidth;x&&(E.style.visibility="",E.style.position=""),h.value=C};let T=null;return un(()=>{document.addEventListener("click",b),cn(()=>{I()}),cn(()=>{const E=l.value?.parentElement;E&&(T=new ResizeObserver(()=>{I()}),T.observe(E))})}),Ln(()=>{document.removeEventListener("click",b),T&&T.disconnect()}),Ye(()=>n.tabs,()=>{cn(()=>{I()})},{deep:!0}),(E,x)=>(p(),g("div",Z3,[r("div",{ref_key:"visibleTabsRef",ref:l,class:le(["visible-tabs",{"is-hidden":h.value}])},[(p(!0),g(Se,null,je(e.tabs,C=>(p(),g("button",{key:C.value,class:le(["tab-button",{active:e.modelValue===C.value}]),onClick:_=>E.$emit("update:modelValue",C.value),type:"button"},[C.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(to)(C.icon)},null,8,Y3)):P("",!0),Je(" "+w(C.label),1)],10,K3))),128))],2),r("div",{class:le(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:o},[r("button",{ref_key:"hamburgerButton",ref:i,class:le(["hamburger-button",{active:c.value}]),onClick:ct(y,["stop"]),type:"button"},[x[1]||(x[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(to)(f.value.icon)},null,8,J3)):P("",!0),r("span",X3,w(m.value),1)],2),c.value?(p(),g("div",{key:0,class:"hamburger-dropdown",style:tt(d.value),onClick:x[0]||(x[0]=ct(()=>{},["stop"]))},[(p(!0),g(Se,null,je(e.tabs,C=>(p(),g("button",{key:C.value,class:le(["dropdown-item",{active:e.modelValue===C.value}]),onClick:ct(_=>k(C.value),["stop"]),type:"button"},[C.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(to)(C.icon)},null,8,eP)):P("",!0),Je(" "+w(C.label),1)],10,Q3))),128))],4)):P("",!0)],512)],2)]))}},nP=Ke(tP,[["__scopeId","data-v-2467c6fc"]]),oP={class:"instruction"},sP={class:"share-link-container"},aP=["value"],iP={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=t,i=D(!1),l=D(null),c=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{o("close")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:`${B(n).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[r("p",oP,"Share this link with "+w(B(s).peoplePlural)+" so they can check in:",1),r("div",sP,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,aP),r("button",{onClick:c,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},lP=Ke(iP,[["__scopeId","data-v-b037c39b"]]);var zl={},Jd,zv;function rP(){return zv||(zv=1,Jd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Jd}var Xd={},Wa={},Hv;function cl(){if(Hv)return Wa;Hv=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Wa.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17},Wa.getSymbolTotalCodewords=function(s){return t[s]},Wa.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s},Wa.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');e=s},Wa.isKanjiModeEnabled=function(){return typeof e<"u"},Wa.toSJIS=function(s){return e(s)},Wa}var Qd={},Vv;function Bf(){return Vv||(Vv=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},e.from=function(s,o){if(e.isValid(s))return s;try{return t(s)}catch{return o}}})(Qd)),Qd}var eh,Gv;function cP(){if(Gv)return eh;Gv=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let s=0;s<n;s++)this.putBit((t>>>n-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},eh=e,eh}var th,qv;function uP(){if(qv)return th;qv=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,s,o){const i=t*this.size+n;this.data[i]=s,o&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,s){this.data[t*this.size+n]^=s},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},th=e,th}var nh={},jv;function dP(){return jv||(jv=1,(function(e){const t=cl().getSymbolSize;e.getRowColCoords=function(s){if(s===1)return[];const o=Math.floor(s/7)+2,i=t(s),l=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let d=1;d<o-1;d++)c[d]=c[d-1]-l;return c.push(6),c.reverse()},e.getPositions=function(s){const o=[],i=e.getRowColCoords(s),l=i.length;for(let c=0;c<l;c++)for(let d=0;d<l;d++)c===0&&d===0||c===0&&d===l-1||c===l-1&&d===0||o.push([i[c],i[d]]);return o}})(nh)),nh}var oh={},Wv;function hP(){if(Wv)return oh;Wv=1;const e=cl().getSymbolSize,t=7;return oh.getPositions=function(s){const o=e(s);return[[0,0],[o-t,0],[0,o-t]]},oh}var sh={},Zv;function fP(){return Zv||(Zv=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const i=o.size;let l=0,c=0,d=0,h=null,f=null;for(let m=0;m<i;m++){c=d=0,h=f=null;for(let y=0;y<i;y++){let k=o.get(m,y);k===h?c++:(c>=5&&(l+=t.N1+(c-5)),h=k,c=1),k=o.get(y,m),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}c>=5&&(l+=t.N1+(c-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(o){const i=o.size;let l=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=o.get(c,d)+o.get(c,d+1)+o.get(c+1,d)+o.get(c+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const i=o.size;let l=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let f=0;f<i;f++)c=c<<1&2047|o.get(h,f),f>=10&&(c===1488||c===93)&&l++,d=d<<1&2047|o.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let i=0;const l=o.data.length;for(let d=0;d<l;d++)i+=o.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function n(s,o,i){switch(s){case e.Patterns.PATTERN000:return(o+i)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(o+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return o*i%2+o*i%3===0;case e.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case e.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}e.applyMask=function(o,i){const l=i.size;for(let c=0;c<l;c++)for(let d=0;d<l;d++)i.isReserved(d,c)||i.xor(d,c,n(o,d,c))},e.getBestMask=function(o,i){const l=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,o);const f=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(h,o),f<d&&(d=f,c=h)}return c}})(sh)),sh}var qc={},Kv;function y1(){if(Kv)return qc;Kv=1;const e=Bf(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return qc.getBlocksCount=function(o,i){switch(i){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},qc.getTotalCodewordsCount=function(o,i){switch(i){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},qc}var ah={},Ir={},Yv;function pP(){if(Yv)return Ir;Yv=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let s=1;for(let o=0;o<255;o++)e[o]=s,t[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),Ir.log=function(s){if(s<1)throw new Error("log("+s+")");return t[s]},Ir.exp=function(s){return e[s]},Ir.mul=function(s,o){return s===0||o===0?0:e[t[s]+t[o]]},Ir}var Jv;function vP(){return Jv||(Jv=1,(function(e){const t=pP();e.mul=function(s,o){const i=new Uint8Array(s.length+o.length-1);for(let l=0;l<s.length;l++)for(let c=0;c<o.length;c++)i[l+c]^=t.mul(s[l],o[c]);return i},e.mod=function(s,o){let i=new Uint8Array(s);for(;i.length-o.length>=0;){const l=i[0];for(let d=0;d<o.length;d++)i[d]^=t.mul(o[d],l);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(s){let o=new Uint8Array([1]);for(let i=0;i<s;i++)o=e.mul(o,new Uint8Array([1,t.exp(i)]));return o}})(ah)),ah}var ih,Xv;function mP(){if(Xv)return ih;Xv=1;const e=vP();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(s){this.degree=s,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const i=e.mod(o,this.genPoly),l=this.degree-i.length;if(l>0){const c=new Uint8Array(this.degree);return c.set(i,l),c}return i},ih=t,ih}var lh={},rh={},ch={},Qv;function k1(){return Qv||(Qv=1,ch.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),ch}var Us={},em;function b1(){if(em)return Us;em=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Us.KANJI=new RegExp(n,"g"),Us.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Us.BYTE=new RegExp(s,"g"),Us.NUMERIC=new RegExp(e,"g"),Us.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Us.testKanji=function(d){return o.test(d)},Us.testNumeric=function(d){return i.test(d)},Us.testAlphanumeric=function(d){return l.test(d)},Us}var tm;function ul(){return tm||(tm=1,(function(e){const t=k1(),n=b1();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return n.testNumeric(i)?e.NUMERIC:n.testAlphanumeric(i)?e.ALPHANUMERIC:n.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(i,l){if(e.isValid(i))return i;try{return s(i)}catch{return l}}})(rh)),rh}var nm;function gP(){return nm||(nm=1,(function(e){const t=cl(),n=y1(),s=Bf(),o=ul(),i=k1(),l=7973,c=t.getBCHDigit(l);function d(y,k,b){for(let I=1;I<=40;I++)if(k<=e.getCapacity(I,b,y))return I}function h(y,k){return o.getCharCountIndicator(y,k)+4}function f(y,k){let b=0;return y.forEach(function(I){const T=h(I.mode,k);b+=T+I.getBitsLength()}),b}function m(y,k){for(let b=1;b<=40;b++)if(f(y,b)<=e.getCapacity(b,k,o.MIXED))return b}e.from=function(k,b){return i.isValid(k)?parseInt(k,10):b},e.getCapacity=function(k,b,I){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof I>"u"&&(I=o.BYTE);const T=t.getSymbolTotalCodewords(k),E=n.getTotalCodewordsCount(k,b),x=(T-E)*8;if(I===o.MIXED)return x;const C=x-h(I,k);switch(I){case o.NUMERIC:return Math.floor(C/10*3);case o.ALPHANUMERIC:return Math.floor(C/11*2);case o.KANJI:return Math.floor(C/13);case o.BYTE:default:return Math.floor(C/8)}},e.getBestVersionForData=function(k,b){let I;const T=s.from(b,s.M);if(Array.isArray(k)){if(k.length>1)return m(k,T);if(k.length===0)return 1;I=k[0]}else I=k;return d(I.mode,I.getLength(),T)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let b=k<<12;for(;t.getBCHDigit(b)-c>=0;)b^=l<<t.getBCHDigit(b)-c;return k<<12|b}})(lh)),lh}var uh={},om;function yP(){if(om)return uh;om=1;const e=cl(),t=1335,n=21522,s=e.getBCHDigit(t);return uh.getEncodedBits=function(i,l){const c=i.bit<<3|l;let d=c<<10;for(;e.getBCHDigit(d)-s>=0;)d^=t<<e.getBCHDigit(d)-s;return(c<<10|d)^n},uh}var dh={},hh,sm;function kP(){if(sm)return hh;sm=1;const e=ul();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){let o,i,l;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),l=parseInt(i,10),s.put(l,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),l=parseInt(i,10),s.put(l,c*3+1))},hh=t,hh}var fh,am;function bP(){if(am)return fh;am=1;const e=ul(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(s){this.mode=e.ALPHANUMERIC,this.data=s}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[i]),6)},fh=n,fh}var ph,im;function wP(){if(im)return ph;im=1;const e=ul();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(s){return s*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)},ph=t,ph}var vh,lm;function _P(){if(lm)return vh;lm=1;const e=ul(),t=cl();function n(s){this.mode=e.KANJI,this.data=s}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let o;for(o=0;o<this.data.length;o++){let i=t.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),s.put(i,13)}},vh=n,vh}var mh={exports:{}},rm;function CP(){return rm||(rm=1,(function(e){var t={single_source_shortest_paths:function(n,s,o){var i={},l={};l[s]=0;var c=t.PriorityQueue.make();c.push(s,0);for(var d,h,f,m,y,k,b,I,T;!c.empty();){d=c.pop(),h=d.value,m=d.cost,y=n[h]||{};for(f in y)y.hasOwnProperty(f)&&(k=y[f],b=m+k,I=l[f],T=typeof l[f]>"u",(T||I>b)&&(l[f]=b,c.push(f,b),i[f]=h))}if(typeof o<"u"&&typeof l[o]>"u"){var E=["Could not find a path from ",s," to ",o,"."].join("");throw new Error(E)}return i},extract_shortest_path_from_predecessor_list:function(n,s){for(var o=[],i=s;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,s,o){var i=t.single_source_shortest_paths(n,s,o);return t.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var s=t.PriorityQueue,o={},i;n=n||{};for(i in s)s.hasOwnProperty(i)&&(o[i]=s[i]);return o.queue=[],o.sorter=n.sorter||s.default_sorter,o},default_sorter:function(n,s){return n.cost-s.cost},push:function(n,s){var o={value:n,cost:s};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(mh)),mh.exports}var cm;function LP(){return cm||(cm=1,(function(e){const t=ul(),n=kP(),s=bP(),o=wP(),i=_P(),l=b1(),c=cl(),d=CP();function h(E){return unescape(encodeURIComponent(E)).length}function f(E,x,C){const _=[];let $;for(;($=E.exec(C))!==null;)_.push({data:$[0],index:$.index,mode:x,length:$[0].length});return _}function m(E){const x=f(l.NUMERIC,t.NUMERIC,E),C=f(l.ALPHANUMERIC,t.ALPHANUMERIC,E);let _,$;return c.isKanjiModeEnabled()?(_=f(l.BYTE,t.BYTE,E),$=f(l.KANJI,t.KANJI,E)):(_=f(l.BYTE_KANJI,t.BYTE,E),$=[]),x.concat(C,_,$).sort(function(M,O){return M.index-O.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function y(E,x){switch(x){case t.NUMERIC:return n.getBitsLength(E);case t.ALPHANUMERIC:return s.getBitsLength(E);case t.KANJI:return i.getBitsLength(E);case t.BYTE:return o.getBitsLength(E)}}function k(E){return E.reduce(function(x,C){const _=x.length-1>=0?x[x.length-1]:null;return _&&_.mode===C.mode?(x[x.length-1].data+=C.data,x):(x.push(C),x)},[])}function b(E){const x=[];for(let C=0;C<E.length;C++){const _=E[C];switch(_.mode){case t.NUMERIC:x.push([_,{data:_.data,mode:t.ALPHANUMERIC,length:_.length},{data:_.data,mode:t.BYTE,length:_.length}]);break;case t.ALPHANUMERIC:x.push([_,{data:_.data,mode:t.BYTE,length:_.length}]);break;case t.KANJI:x.push([_,{data:_.data,mode:t.BYTE,length:h(_.data)}]);break;case t.BYTE:x.push([{data:_.data,mode:t.BYTE,length:h(_.data)}])}}return x}function I(E,x){const C={},_={start:{}};let $=["start"];for(let R=0;R<E.length;R++){const M=E[R],O=[];for(let A=0;A<M.length;A++){const U=M[A],F=""+R+A;O.push(F),C[F]={node:U,lastCount:0},_[F]={};for(let j=0;j<$.length;j++){const Z=$[j];C[Z]&&C[Z].node.mode===U.mode?(_[Z][F]=y(C[Z].lastCount+U.length,U.mode)-y(C[Z].lastCount,U.mode),C[Z].lastCount+=U.length):(C[Z]&&(C[Z].lastCount=U.length),_[Z][F]=y(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,x))}}$=O}for(let R=0;R<$.length;R++)_[$[R]].end=0;return{map:_,table:C}}function T(E,x){let C;const _=t.getBestModeForData(E);if(C=t.from(x,_),C!==t.BYTE&&C.bit<_.bit)throw new Error('"'+E+'" cannot be encoded with mode '+t.toString(C)+`.
 Suggested mode is: `+t.toString(_));switch(C===t.KANJI&&!c.isKanjiModeEnabled()&&(C=t.BYTE),C){case t.NUMERIC:return new n(E);case t.ALPHANUMERIC:return new s(E);case t.KANJI:return new i(E);case t.BYTE:return new o(E)}}e.fromArray=function(x){return x.reduce(function(C,_){return typeof _=="string"?C.push(T(_,null)):_.data&&C.push(T(_.data,_.mode)),C},[])},e.fromString=function(x,C){const _=m(x,c.isKanjiModeEnabled()),$=b(_),R=I($,C),M=d.find_path(R.map,"start","end"),O=[];for(let A=1;A<M.length-1;A++)O.push(R.table[M[A]].node);return e.fromArray(k(O))},e.rawSplit=function(x){return e.fromArray(m(x,c.isKanjiModeEnabled()))}})(dh)),dh}var um;function SP(){if(um)return Xd;um=1;const e=cl(),t=Bf(),n=cP(),s=uP(),o=dP(),i=hP(),l=fP(),c=y1(),d=mP(),h=gP(),f=yP(),m=ul(),y=LP();function k(R,M){const O=R.size,A=i.getPositions(M);for(let U=0;U<A.length;U++){const F=A[U][0],j=A[U][1];for(let Z=-1;Z<=7;Z++)if(!(F+Z<=-1||O<=F+Z))for(let X=-1;X<=7;X++)j+X<=-1||O<=j+X||(Z>=0&&Z<=6&&(X===0||X===6)||X>=0&&X<=6&&(Z===0||Z===6)||Z>=2&&Z<=4&&X>=2&&X<=4?R.set(F+Z,j+X,!0,!0):R.set(F+Z,j+X,!1,!0))}}function b(R){const M=R.size;for(let O=8;O<M-8;O++){const A=O%2===0;R.set(O,6,A,!0),R.set(6,O,A,!0)}}function I(R,M){const O=o.getPositions(M);for(let A=0;A<O.length;A++){const U=O[A][0],F=O[A][1];for(let j=-2;j<=2;j++)for(let Z=-2;Z<=2;Z++)j===-2||j===2||Z===-2||Z===2||j===0&&Z===0?R.set(U+j,F+Z,!0,!0):R.set(U+j,F+Z,!1,!0)}}function T(R,M){const O=R.size,A=h.getEncodedBits(M);let U,F,j;for(let Z=0;Z<18;Z++)U=Math.floor(Z/3),F=Z%3+O-8-3,j=(A>>Z&1)===1,R.set(U,F,j,!0),R.set(F,U,j,!0)}function E(R,M,O){const A=R.size,U=f.getEncodedBits(M,O);let F,j;for(F=0;F<15;F++)j=(U>>F&1)===1,F<6?R.set(F,8,j,!0):F<8?R.set(F+1,8,j,!0):R.set(A-15+F,8,j,!0),F<8?R.set(8,A-F-1,j,!0):F<9?R.set(8,15-F-1+1,j,!0):R.set(8,15-F-1,j,!0);R.set(A-8,8,1,!0)}function x(R,M){const O=R.size;let A=-1,U=O-1,F=7,j=0;for(let Z=O-1;Z>0;Z-=2)for(Z===6&&Z--;;){for(let X=0;X<2;X++)if(!R.isReserved(U,Z-X)){let re=!1;j<M.length&&(re=(M[j]>>>F&1)===1),R.set(U,Z-X,re),F--,F===-1&&(j++,F=7)}if(U+=A,U<0||O<=U){U-=A,A=-A;break}}}function C(R,M,O){const A=new n;O.forEach(function(X){A.put(X.mode.bit,4),A.put(X.getLength(),m.getCharCountIndicator(X.mode,R)),X.write(A)});const U=e.getSymbolTotalCodewords(R),F=c.getTotalCodewordsCount(R,M),j=(U-F)*8;for(A.getLengthInBits()+4<=j&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const Z=(j-A.getLengthInBits())/8;for(let X=0;X<Z;X++)A.put(X%2?17:236,8);return _(A,R,M)}function _(R,M,O){const A=e.getSymbolTotalCodewords(M),U=c.getTotalCodewordsCount(M,O),F=A-U,j=c.getBlocksCount(M,O),Z=A%j,X=j-Z,re=Math.floor(A/j),K=Math.floor(F/j),ae=K+1,q=re-K,Y=new d(q);let te=0;const ue=new Array(j),_e=new Array(j);let Te=0;const Pe=new Uint8Array(R.buffer);for(let de=0;de<j;de++){const ie=de<X?K:ae;ue[de]=Pe.slice(te,te+ie),_e[de]=Y.encode(ue[de]),te+=ie,Te=Math.max(Te,ie)}const De=new Uint8Array(A);let ke=0,H,J;for(H=0;H<Te;H++)for(J=0;J<j;J++)H<ue[J].length&&(De[ke++]=ue[J][H]);for(H=0;H<q;H++)for(J=0;J<j;J++)De[ke++]=_e[J][H];return De}function $(R,M,O,A){let U;if(Array.isArray(R))U=y.fromArray(R);else if(typeof R=="string"){let re=M;if(!re){const K=y.rawSplit(R);re=h.getBestVersionForData(K,O)}U=y.fromString(R,re||40)}else throw new Error("Invalid data");const F=h.getBestVersionForData(U,O);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!M)M=F;else if(M<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const j=C(M,O,U),Z=e.getSymbolSize(M),X=new s(Z);return k(X,M),b(X),I(X,M),E(X,O,0),M>=7&&T(X,M),x(X,j),isNaN(A)&&(A=l.getBestMask(X,E.bind(null,X,O))),l.applyMask(A,X),E(X,O,A),{modules:X,version:M,errorCorrectionLevel:O,maskPattern:A,segments:U}}return Xd.create=function(M,O){if(typeof M>"u"||M==="")throw new Error("No input text");let A=t.M,U,F;return typeof O<"u"&&(A=t.from(O.errorCorrectionLevel,t.M),U=h.from(O.version),F=l.from(O.maskPattern),O.toSJISFunc&&e.setToSJISFunction(O.toSJISFunc)),$(M,U,A,F)},Xd}var gh={},yh={},dm;function w1(){return dm||(dm=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let s=n.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+n);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const o=parseInt(s.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+s.slice(0,6).join("")}}e.getOptions=function(s){s||(s={}),s.color||(s.color={});const o=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,l=s.scale||4;return{width:i,scale:i?4:l,margin:o,color:{dark:t(s.color.dark||"#000000ff"),light:t(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},e.getScale=function(s,o){return o.width&&o.width>=s+o.margin*2?o.width/(s+o.margin*2):o.scale},e.getImageWidth=function(s,o){const i=e.getScale(s,o);return Math.floor((s+o.margin*2)*i)},e.qrToImageData=function(s,o,i){const l=o.modules.size,c=o.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,m=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let k=0;k<h;k++){let b=(y*h+k)*4,I=i.color.light;if(y>=f&&k>=f&&y<h-f&&k<h-f){const T=Math.floor((y-f)/d),E=Math.floor((k-f)/d);I=m[c[T*l+E]?1:0]}s[b++]=I.r,s[b++]=I.g,s[b++]=I.b,s[b]=I.a}}})(yh)),yh}var hm;function IP(){return hm||(hm=1,(function(e){const t=w1();function n(o,i,l){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,c){let d=c,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=s()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),m=h.getContext("2d"),y=m.createImageData(f,f);return t.qrToImageData(y.data,i,d),n(m,h,f),m.putImageData(y,0,0),h},e.renderToDataURL=function(i,l,c){let d=c;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",m=d.rendererOpts||{};return h.toDataURL(f,m.quality)}})(gh)),gh}var kh={},fm;function xP(){if(fm)return kh;fm=1;const e=w1();function t(o,i){const l=o.a/255,c=i+'="'+o.hex+'"';return l<1?c+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':c}function n(o,i,l){let c=o+i;return typeof l<"u"&&(c+=" "+l),c}function s(o,i,l){let c="",d=0,h=!1,f=0;for(let m=0;m<o.length;m++){const y=Math.floor(m%i),k=Math.floor(m/i);!y&&!h&&(h=!0),o[m]?(f++,m>0&&y>0&&o[m-1]||(c+=h?n("M",y+l,.5+k+l):n("m",d,0),d=0,h=!1),y+1<i&&o[m+1]||(c+=n("h",f),f=0)):d++}return c}return kh.render=function(i,l,c){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,m=h+d.margin*2,y=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+s(f,h,d.margin)+'"/>',b='viewBox="0 0 '+m+" "+m+'"',T='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+b+' shape-rendering="crispEdges">'+y+k+`</svg>
`;return typeof c=="function"&&c(null,T),T},kh}var pm;function $P(){if(pm)return zl;pm=1;const e=rP(),t=SP(),n=IP(),s=xP();function o(i,l,c,d,h){const f=[].slice.call(arguments,1),m=f.length,y=typeof f[m-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(m<2)throw new Error("Too few arguments provided");m===2?(h=c,c=l,l=d=void 0):m===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=c,c=l,l=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(c=l,l=d=void 0):m===2&&!l.getContext&&(d=c,c=l,l=void 0),new Promise(function(k,b){try{const I=t.create(c,d);k(i(I,l,d))}catch(I){b(I)}})}try{const k=t.create(c,d);h(null,i(k,l,d))}catch(k){h(k)}}return zl.create=t.create,zl.toCanvas=o.bind(null,n.render),zl.toDataURL=o.bind(null,n.renderToDataURL),zl.toString=o.bind(null,function(i,l,c){return s.render(i,c)}),zl}var TP=$P();const MP=Qy(TP),AP={class:"qr-container"},EP={key:0,class:"qr-warning"},PP={key:1,class:"error-text"},DP={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3},warning:{type:String,default:""}},emits:["close"],setup(e){const t=e,n=D(null),s=D(""),o=async()=>{if(!(!n.value||!t.url)){s.value="";try{await MP.toCanvas(n.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),s.value="Failed to generate QR code"}}};return Ye(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(o,50)},{immediate:!0}),(i,l)=>(p(),qe(Zt,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=c=>i.$emit("close"))},{actions:Ve(()=>[r("button",{onClick:l[0]||(l[0]=c=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",AP,[e.warning?(p(),g("p",EP,w(e.warning),1)):P("",!0),r("canvas",{ref_key:"canvasRef",ref:n,class:"qr-canvas"},null,512),s.value?(p(),g("p",PP,w(s.value),1)):P("",!0)])]),_:1},8,["show","title","z-index"]))}},Ff=Ke(DP,[["__scopeId","data-v-401727ed"]]),RP={class:"success-content"},OP={class:"success-message"},NP={class:"link-section"},BP={class:"help-text"},FP={key:0,class:"loading-text"},UP={key:1,class:"magic-link-container"},zP=["value"],HP={class:"magic-link-actions"},VP=["disabled"],GP={key:0,class:"success-text"},qP={key:1,class:"error-text"},jP={key:2,class:"error-text"},WP={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=D(""),l=D(!1),c=D(!1),d=D(""),h=D(!1),f=D(!1),m=D(!1),y=D(""),k=D(!1),b=async()=>{if(!(!s.eventId||!s.marshalId)){c.value=!0,d.value="";try{const x=await _s.getMagicLink(s.eventId,s.marshalId);i.value=x.data.magicLink,l.value=x.data.hasEmail}catch(x){console.error("Failed to fetch magic link:",x),d.value="Failed to load login link"}finally{c.value=!1}}},I=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const x=document.createElement("textarea");x.value=i.value,x.style.position="fixed",x.style.left="-9999px",document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(x){console.error("Failed to copy:",x)}},T=async()=>{if(!(!s.eventId||!s.marshalId)){f.value=!0,m.value=!1,y.value="";try{await _s.sendMagicLink(s.eventId,s.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(x){console.error("Failed to send email:",x),y.value=x.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},E=()=>{o("close")};return Ye(()=>s.show,x=>{x&&s.marshalId?b():(i.value="",l.value=!1,d.value="",h.value=!1,m.value=!1,y.value="",k.value=!1)},{immediate:!0}),(x,C)=>(p(),g(Se,null,[Ee(Zt,{show:e.show,title:`${B(n).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:E},{actions:Ve(()=>[r("button",{onClick:E,class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",RP,[C[4]||(C[4]=r("div",{class:"success-icon"},"",-1)),r("p",OP,[r("strong",null,w(e.marshalName),1),C[3]||(C[3]=Je(" has been added successfully. ",-1))])]),r("div",NP,[C[6]||(C[6]=r("label",null,"Login link",-1)),r("p",BP," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),c.value?(p(),g("div",FP,"Loading link...")):i.value?(p(),g("div",UP,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:C[0]||(C[0]=_=>_.target.select())},null,40,zP),r("div",HP,[r("button",{type:"button",class:"btn btn-secondary",onClick:I},w(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:C[1]||(C[1]=_=>k.value=!0),title:"Show QR code"},[...C[5]||(C[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(p(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:T},w(f.value?"Sending...":"Send via email"),9,VP)):P("",!0)]),m.value?(p(),g("p",GP,"Email sent successfully!")):P("",!0),y.value?(p(),g("p",qP,w(y.value),1)):P("",!0)])):d.value?(p(),g("div",jP,w(d.value),1)):P("",!0)])]),_:1},8,["show","title"]),Ee(Ff,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:C[2]||(C[2]=_=>k.value=!1)},null,8,["show","url"])],64))}},ZP=Ke(WP,[["__scopeId","data-v-9aa97b04"]]),KP={class:"form-group"},YP={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D("");Ye(()=>n.show,d=>{d||(o.value="")});const i=()=>{s("update:isDirty",!0)},l=()=>{s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),qe(Zt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ve(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",KP,[h[1]||(h[1]=r("label",null,"Email address",-1)),We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,o.value]])])],32)]),_:1},8,["show","is-dirty"]))}},JP=Ke(YP,[["__scopeId","data-v-a82da194"]]),XP={class:"form-group"},QP={key:0,class:"error"},e6=["disabled"],t6={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(null);Ye(()=>n.show,d=>{d||(o.value=null)});const i=d=>{o.value=d.target.files[0],s("update:isDirty",!0)},l=()=>{o.value&&s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),qe(Zt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,e6)]),default:Ve(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",XP,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",QP,w(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},n6=Ke(t6,[["__scopeId","data-v-317975db"]]),o6={class:"instruction"},s6={class:"form-group"},a6={class:"form-group"},i6={class:"checkbox-label"},l6={key:0,class:"error"},r6={key:1,class:"import-result"},c6={key:0,class:"import-errors"},u6=["disabled"],d6={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=e,i=t,l=D(null),c=D(!1);Ye(()=>o.show,y=>{y||(l.value=null,c.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:c.value})},m=()=>{i("close")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:`Import ${B(s).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${B(s).checkpoints}`),9,u6)]),default:Ve(()=>[r("p",o6,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(B(n).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:ct(f,["prevent"])},[r("div",s6,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",a6,[r("label",i6,[We(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=b=>c.value=b),onChange:h},null,544),[[Ms,c.value]]),Je(" Delete existing "+w(B(s).checkpoints)+" before import ",1)])]),e.error?(p(),g("div",l6,w(e.error),1)):P("",!0),e.result?(p(),g("div",r6,[r("p",null,"Created "+w(e.result.locationsCreated)+" "+w(B(s).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",c6,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Se,null,je(e.result.errors,(b,I)=>(p(),g("li",{key:I},w(b),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},h6=Ke(d6,[["__scopeId","data-v-75c79d31"]]),f6={class:"instruction"},p6={class:"form-group"},v6={key:0,class:"error"},m6={key:1,class:"import-result"},g6={key:0,class:"import-errors"},y6=["disabled"],k6={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=e,i=t,l=D(null);Ye(()=>o.show,f=>{f||(l.value=null)});const c=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,m)=>(p(),qe(Zt,{show:e.show,title:`Import ${B(s).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Ve(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${B(s).people}`),9,y6)]),default:Ve(()=>[r("p",f6,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(B(n).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:ct(d,["prevent"])},[r("div",p6,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:c,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",v6,w(e.error),1)):P("",!0),e.result?(p(),g("div",m6,[r("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(B(s).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",g6,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Se,null,je(e.result.errors,(y,k)=>(p(),g("li",{key:k},w(y),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},b6=Ke(k6,[["__scopeId","data-v-be89bf1f"]]),w6=["onClick"],_6=["innerHTML"],C6={class:"hamburger-nav"},L6=["disabled"],S6=["innerHTML"],I6={class:"current-tab-label"},x6=["disabled"],$6={key:0,class:"hamburger-menu"},T6=["onClick"],M6=["innerHTML"],A6=400,E6={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D(!1),h=z(()=>{const $=n.tabs.find(R=>R.value===n.modelValue);return $?$.label:""}),f=z(()=>n.tabs.find(R=>R.value===n.modelValue)?.icon||null),m=z(()=>n.tabs.findIndex($=>$.value===n.modelValue)),y=z(()=>m.value>0),k=z(()=>m.value<n.tabs.length-1),b=()=>{y.value&&s("update:modelValue",n.tabs[m.value-1].value)},I=()=>{k.value&&s("update:modelValue",n.tabs[m.value+1].value)},T=()=>{if(!o.value)return;const $=o.value.clientWidth;if($<A6){c.value=!0;return}if(i.value&&!c.value){i.value.scrollWidth>$&&(c.value=!0);return}const R=n.tabs.some(A=>A.icon)?110:90,M=n.tabs.length*R,O=(n.tabs.length-1)*8;M+O<=$&&(c.value=!1,cn(()=>{i.value&&i.value.scrollWidth>$&&(c.value=!0)}))},E=()=>{d.value=!d.value},x=$=>{s("update:modelValue",$),d.value=!1},C=$=>{l.value&&!l.value.contains($.target)&&(d.value=!1)};let _=null;return un(()=>{cn(()=>{T(),o.value&&typeof ResizeObserver<"u"&&(_=new ResizeObserver(()=>{T()}),_.observe(o.value)),document.addEventListener("click",C)})}),Ln(()=>{_&&_.disconnect(),document.removeEventListener("click",C)}),Ye(()=>n.tabs,()=>{cn(()=>{T()})},{deep:!0}),($,R)=>(p(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:o},[c.value?(p(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",C6,[r("button",{class:le(["nav-arrow",{invisible:!y.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,L6),r("button",{class:"hamburger-button",onClick:E,type:"button","aria-label":"Tab menu"},[f.value?(p(),g("span",{key:0,class:"current-tab-icon",innerHTML:B(to)(f.value)},null,8,S6)):P("",!0),r("span",I6,w(h.value),1),R[0]||(R[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:le(["nav-arrow",{invisible:!k.value}]),onClick:I,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,x6)]),d.value?(p(),g("div",$6,[(p(!0),g(Se,null,je(e.tabs,M=>(p(),g("button",{key:M.value,class:le(["menu-item",{active:e.modelValue===M.value}]),onClick:O=>x(M.value),type:"button"},[M.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(to)(M.icon)},null,8,M6)):P("",!0),Je(" "+w(M.label),1)],10,T6))),128))])):P("",!0)],512)):(p(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(p(!0),g(Se,null,je(e.tabs,M=>(p(),g("button",{key:M.value,class:le(["tab-button",{active:e.modelValue===M.value}]),onClick:O=>$.$emit("update:modelValue",M.value),type:"button"},[M.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:B(to)(M.icon)},null,8,_6)):P("",!0),Je(" "+w(M.label),1)],10,w6))),128))],512))],512))}},dl=Ke(E6,[["__scopeId","data-v-736c5d0a"]]),P6={class:"tab-content"},D6={class:"form-group"},R6=["value"],O6={class:"form-group"},N6=["value"],B6={class:"form-group"},F6={class:"area-display"},U6={key:0,class:"no-area"},z6={class:"form-help"},H6={class:"form-group checkbox-group"},V6={class:"checkbox-label"},G6=["checked"],q6={class:"form-help"},j6={key:0,class:"custom-times-section"},W6={class:"form-group"},Z6=["value"],K6={class:"form-help"},Y6={class:"form-group"},J6=["value"],X6={class:"form-help"},Q6={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>(n.form.areaIds||n.form.AreaIds||[]).map(d=>n.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(c,d)=>{s("update:form",{...n.form,[c]:d}),s("input")},l=c=>{const d={...n.form,useCustomTimes:c};if(!c)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&n.eventDate){const h=rc(n.eventDate);d.startTime=h,d.endTime=h}s("update:form",d),s("input")};return(c,d)=>(p(),g("div",P6,[r("form",{onSubmit:d[5]||(d[5]=ct(h=>c.$emit("save"),["prevent"]))},[r("div",D6,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,R6)]),r("div",O6,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,N6)]),r("div",B6,[r("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",F6,[o.value.length===0?(p(),g("span",U6," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(p(!0),g(Se,null,je(o.value,h=>(p(),g("span",{key:h.id,class:"area-badge",style:tt({backgroundColor:h.color||"var(--brand-primary)"})},w(h.name),5))),128))]),r("small",z6,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",H6,[r("label",V6,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,G6),r("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),r("small",q6," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(p(),g("div",j6,[r("div",W6,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,Z6),r("small",K6," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),r("div",Y6,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,J6),r("small",X6," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},e8=Ke(Q6,[["__scopeId","data-v-aa628901"]]),t8={class:"scope-configuration-editor"},n8={class:"editor-header"},o8={class:"scope-types-list"},s8=["onClick"],a8={class:"scope-type-label"},i8={class:"scope-type-pill"},l8={class:"expand-label"},r8={class:"expand-icon"},c8={class:"modal-content"},u8={class:"modal-header"},d8={class:"modal-body"},h8={class:"scope-help"},f8={key:0,class:"form-group"},p8={class:"checkbox-label special-option"},v8=["checked"],m8={key:0,class:"specific-selection"},g8=["placeholder"],y8={class:"checkbox-group scrollable"},k8=["checked","onChange"],b8={key:1,class:"form-group"},w8={class:"checkbox-label special-option"},_8=["checked"],C8={key:0,class:"specific-selection"},L8={class:"checkbox-group scrollable"},S8=["checked","onChange"],I8={key:2,class:"form-group"},x8={class:"checkbox-label special-option"},$8=["checked"],T8={key:0,class:"specific-selection"},M8=["placeholder"],A8={class:"checkbox-group scrollable"},E8={key:0,class:"checkbox-label this-checkpoint-option"},P8=["checked"],D8={class:"checkpoint-info"},R8={class:"checkpoint-name"},O8=["checked","onChange"],N8={class:"checkpoint-info"},B8={class:"checkpoint-name"},F8={key:0,class:"checkpoint-description"},U8={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=z(()=>[{scope:"SpecificPeople",label:`Specific ${n.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${n.value.person} at specified ${n.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${n.value.person} at each specified ${n.value.checkpoint}`},{scope:"OnePerArea",label:`One ${n.value.person} in specified ${n.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${n.value.areas}`},{scope:"EveryAreaLead",label:`Every ${n.value.area} lead at specified ${n.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${n.value.area}`}]),l=D({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),c=D(null),d=D(""),h=D(""),f=D(!s.isEditing);let m=!0,y=!1;const k=z(()=>i.value.filter(ie=>!s.excludeScopes.includes(ie.scope))),b=z(()=>f.value?k.value:k.value.filter(ie=>U(ie.scope))),I=z(()=>k.value.filter(Re=>U(Re.scope)).length<k.value.length),T=z(()=>{const ie=k.value.filter(Re=>U(Re.scope)).length;return k.value.length-ie}),E=z(()=>!s.currentCheckpointId&&s.intent==="location-update");Ye(()=>s.modelValue,ie=>{if(ie){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach(Re=>{l.value[Re]={enabled:!1,ids:[]}}),ie.forEach(Re=>{Re.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Re.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Re.ids]}:l.value[Re.scope]&&(l.value[Re.scope]={enabled:!0,ids:[...Re.ids]})}),m=!1}},{immediate:!0});const x=()=>{const ie=[];return Object.keys(l.value).forEach(Re=>{const G=l.value[Re];if(G.enabled){const Q={scope:Re,itemType:C(Re),ids:[...G.ids]};ie.push(Q)}}),ie};Ye(l,()=>{if(m)return;if(Object.keys(l.value).some(G=>G!=="SpecificPeople"&&l.value[G].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const G=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(G,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Re=x();o("update:modelValue",Re),o("user-changed")},{deep:!0});const C=ie=>_(ie)?"Area":$(ie)?"Checkpoint":R(ie)?"Marshal":null,_=ie=>ie==="EveryoneInAreas"||ie==="OnePerArea"||ie==="EveryAreaLead"||ie==="OneLeadPerArea",$=ie=>ie==="EveryoneAtCheckpoints"||ie==="OnePerCheckpoint",R=ie=>ie==="SpecificPeople",M=ie=>{const Re=i.value.find(G=>G.scope===ie);return Re?Re.label:ie},O=z(()=>s.headerText?s.headerText:s.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${n.value.checklist}?`),A=ie=>s.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${n.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${n.value.person} at each selected ${n.value.checkpoint} can update the location`,OnePerArea:`Any ${n.value.person} in each selected ${n.value.area} can update the location`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} can update the location`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} can update the location`,OneLeadPerArea:`Any ${n.value.area} lead at the selected ${n.value.areas} can update the location`}[ie]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${n.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${n.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${n.value.area} (shared completion)`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${n.value.area}, only ${n.value.area} leads can complete (shared among leads)`}[ie]||"",U=ie=>l.value[ie]?.enabled||!1,F=ie=>{const Re=l.value[ie];if(!Re||!Re.enabled)return"No";const G=Re.ids||[];if(_(ie)){if(G.includes("ALL_AREAS"))return`All ${n.value.areas}`;const Q=G.length;return Q>0?`${Q} ${Q!==1?n.value.areas:n.value.area}`:`Select ${n.value.areas}...`}if($(ie)){if(G.includes("ALL_CHECKPOINTS"))return`All ${n.value.checkpoints}`;if(G.length===1&&G[0]==="THIS_CHECKPOINT")return`This ${n.value.checkpoint}`;const Q=G.length;return Q>0?`${Q} ${Q!==1?n.value.checkpoints:n.value.checkpoint}`:`Select ${n.value.checkpoints}...`}if(R(ie)){if(G.includes("ALL_MARSHALS"))return"Everyone";const Q=G.length;return Q>0?`${Q} ${Q!==1?n.value.people:n.value.person}`:`Select ${n.value.people}...`}return"Configured"},j=ie=>{c.value=ie,d.value="",h.value=""},Z=()=>{c.value=null},X=()=>{c.value&&(l.value[c.value]={enabled:!1,ids:[]}),Z()},re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_MARSHALS"),K=()=>{if(!c.value)return;const ie=l.value[c.value];re()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_MARSHALS"],ie.enabled=!0)},ae=ie=>c.value&&l.value[c.value]?.ids.includes(ie),q=ie=>{if(!c.value)return;const Re=l.value[c.value],G=Re.ids.indexOf(ie);G>=0?(Re.ids.splice(G,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(ie),Re.enabled=!0)},Y=()=>{let ie=s.marshals;if(h.value){const G=h.value.toLowerCase();ie=ie.filter(Q=>Q.name.toLowerCase().includes(G)||Q.email&&Q.email.toLowerCase().includes(G))}const Re=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,Q)=>{const ee=Re.includes(G.id),Ce=Re.includes(Q.id);return ee&&!Ce?-1:!ee&&Ce?1:G.name.localeCompare(Q.name,void 0,{sensitivity:"base"})})},te=()=>c.value&&l.value[c.value]?.ids.includes("ALL_AREAS"),ue=()=>{if(!c.value)return;const ie=l.value[c.value];te()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_AREAS"],ie.enabled=!0)},_e=ie=>c.value&&l.value[c.value]?.ids.includes(ie),Te=()=>{const ie=c.value?l.value[c.value]?.ids||[]:[];return[...s.areas].sort((Re,G)=>{const Q=ie.includes(Re.id),ee=ie.includes(G.id);return Q&&!ee?-1:!Q&&ee?1:Re.name.localeCompare(G.name,void 0,{sensitivity:"base"})})},Pe=ie=>{if(!c.value)return;const Re=l.value[c.value],G=Re.ids.indexOf(ie);G>=0?(Re.ids.splice(G,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(ie),Re.enabled=!0)},De=()=>c.value&&l.value[c.value]?.ids.includes("ALL_CHECKPOINTS"),ke=()=>{if(!c.value)return;const ie=l.value[c.value];De()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_CHECKPOINTS"],ie.enabled=!0)},H=ie=>c.value&&l.value[c.value]?.ids.includes(ie),J=ie=>{if(!c.value)return;const Re=l.value[c.value],G=Re.ids.indexOf(ie);G>=0?(Re.ids.splice(G,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(ie),Re.enabled=!0)},de=()=>{let ie=s.locations;if(d.value){const G=d.value.toLowerCase();ie=ie.filter(Q=>Q.name.toLowerCase().includes(G)||Q.description&&Q.description.toLowerCase().includes(G))}const Re=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,Q)=>{const ee=Re.includes(G.id),Ce=Re.includes(Q.id);return ee&&!Ce?-1:!ee&&Ce?1:es(G.name,Q.name)})};return(ie,Re)=>(p(),g("div",t8,[r("div",n8,[r("h4",null,w(O.value),1)]),r("div",o8,[(p(!0),g(Se,null,je(b.value,G=>(p(),g("div",{key:G.scope,class:le(["scope-type-row",{active:U(G.scope)}]),onClick:Q=>j(G.scope)},[r("div",a8,w(G.label),1),r("div",i8,w(F(G.scope)),1)],10,s8))),128)),I.value?(p(),g("div",{key:0,class:"expand-row",onClick:Re[0]||(Re[0]=G=>f.value=!f.value)},[r("div",l8,w(f.value?"Show less":`Show ${T.value} more option${T.value!==1?"s":""}...`),1),r("div",r8,w(f.value?"":""),1)])):P("",!0)]),c.value?(p(),g("div",{key:0,class:"scope-config-modal",onClick:ct(Z,["self"])},[r("div",c8,[r("div",u8,[r("h5",null,w(M(c.value)),1),r("button",{onClick:Z,class:"btn-close",type:"button"},"")]),r("div",d8,[r("p",h8,w(A(c.value)),1),R(c.value)?(p(),g("div",f8,[r("label",p8,[r("input",{type:"checkbox",checked:re(),onChange:K},null,40,v8),r("span",null,[Re[4]||(Re[4]=r("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+w(B(n).people)+")",1)])]),re()?P("",!0):(p(),g("div",m8,[We(r("input",{"onUpdate:modelValue":Re[1]||(Re[1]=G=>h.value=G),type:"text",placeholder:`Search ${B(n).people}...`,class:"search-input"},null,8,g8),[[st,h.value]]),r("div",y8,[(p(!0),g(Se,null,je(Y(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:ae(G.id),onChange:Q=>q(G.id)},null,40,k8),r("span",null,w(G.name),1)]))),128))])]))])):P("",!0),_(c.value)?(p(),g("div",b8,[r("label",w8,[r("input",{type:"checkbox",checked:te(),onChange:ue},null,40,_8),r("span",null,[r("strong",null,"All "+w(B(n).areas),1),Je(" (includes future "+w(B(n).areas)+")",1)])]),te()?P("",!0):(p(),g("div",C8,[r("div",L8,[(p(!0),g(Se,null,je(Te(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:_e(G.id),onChange:Q=>Pe(G.id)},null,40,S8),r("span",{class:"area-color-dot",style:tt({backgroundColor:G.color||"#667eea"})},null,4),r("span",null,w(G.name),1)]))),128))])]))])):P("",!0),$(c.value)?(p(),g("div",I8,[r("label",x8,[r("input",{type:"checkbox",checked:De(),onChange:ke},null,40,$8),r("span",null,[r("strong",null,"All "+w(B(n).checkpoints),1),Je(" (includes future "+w(B(n).checkpoints)+")",1)])]),De()?P("",!0):(p(),g("div",T8,[We(r("input",{"onUpdate:modelValue":Re[2]||(Re[2]=G=>d.value=G),type:"text",placeholder:`Search ${B(n).checkpoints}...`,class:"search-input"},null,8,M8),[[st,d.value]]),r("div",A8,[E.value?(p(),g("label",E8,[r("input",{type:"checkbox",checked:H("THIS_CHECKPOINT"),onChange:Re[3]||(Re[3]=G=>J("THIS_CHECKPOINT"))},null,40,P8),r("div",D8,[r("span",R8,[r("strong",null,"This "+w(B(n).checkpoint),1)])])])):P("",!0),(p(!0),g(Se,null,je(de(),G=>(p(),g("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:H(G.id),onChange:Q=>J(G.id)},null,40,O8),r("div",N8,[r("span",B8,w(G.name),1),G.description?(p(),g("span",F8," - "+w(G.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:X,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:Z,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},id=Ke(U8,[["__scopeId","data-v-d465703e"]]),z8={class:"tab-content"},H8={class:"form-group"},V8=["value"],G8={key:0,class:"form-error"},q8={class:"form-row"},j8={class:"form-group"},W8=["disabled"],Z8={class:"form-group"},K8=["disabled"],Y8={class:"form-group"},J8={class:"accordion-item"},X8={class:"accordion-preview"},Q8={class:"accordion-arrow"},eD={key:0,class:"accordion-content"},tD={class:"section-description"},nD={class:"dynamic-checkbox"},oD=["checked"],sD={key:0,class:"dynamic-settings"},aD={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D(""),c=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ye(()=>n.form.longitude,k=>{i.value=c(k)},{immediate:!0}),Ye(()=>n.form.latitude,k=>{l.value=c(k)},{immediate:!0});const d=k=>{const b=k==="longitude"?i:l,I=parseFloat(b.value);isNaN(I)?b.value.trim()===""&&(s("update:form",{...n.form,[k]:0}),s("input"),b.value=c(0)):(s("update:form",{...n.form,[k]:I}),s("input"),b.value=c(I))},h=(k,b)=>{s("update:form",{...n.form,[k]:b}),s("input")},f=k=>{if(k){const I=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[n.form.id||"THIS_CHECKPOINT"]}];s("update:form",{...n.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:I})}else s("update:form",{...n.form,isDynamic:!1});s("input")},m=k=>{s("update:form",{...n.form,locationUpdateScopeConfigurations:k}),s("input")},y=k=>{if(!k)return!0;const b=k.includes(".")?k.split("."):k.split("/");if(b.length!==3)return!1;const I=/^[a-z]{1,20}$/;return b.every(T=>I.test(T))};return(k,b)=>(p(),g("div",z8,[r("form",{onSubmit:b[6]||(b[6]=ct(I=>k.$emit("save"),["prevent"]))},[r("div",H8,[b[10]||(b[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=I=>h("what3Words",I.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,V8),e.form.what3Words&&!y(e.form.what3Words)?(p(),g("small",G8," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(p(),g(Se,{key:0},[r("div",q8,[r("div",j8,[b[11]||(b[11]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":b[1]||(b[1]=I=>i.value=I),onBlur:b[2]||(b[2]=I=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,W8),[[st,i.value]])]),r("div",Z8,[b[12]||(b[12]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":b[3]||(b[3]=I=>l.value=I),onBlur:b[4]||(b[4]=I=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,K8),[[st,l.value]])])]),r("div",Y8,[r("button",{type:"button",onClick:b[5]||(b[5]=I=>k.$emit("move-location")),class:le(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",J8,[r("button",{type:"button",class:le(["accordion-header",{expanded:o.value}]),onClick:b[7]||(b[7]=I=>o.value=!o.value)},[b[14]||(b[14]=ui('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",X8,w(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",Q8,w(o.value?"":""),1)],2),o.value?(p(),g("div",eD,[r("p",tD," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",nD,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=I=>f(I.target.checked))},null,40,oD),r("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(p(),g("div",sD,[Ee(id,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:b[9]||(b[9]=I=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},iD=Ke(aD,[["__scopeId","data-v-bd432637"]]);function _1(e){const t=D(new Map),n=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:n,handleToggleCheckIn:f=>{const y=!n(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>n(f)?"":"",getStatusColor:f=>n(f)?"#28a745":"#dc3545",getStatusText:f=>n(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const lD={class:"card-main"},rD={class:"card-title"},cD={class:"marshal-name"},uD={key:0,class:"card-check-in"},dD={class:"toggle-icon"},hD={class:"toggle-label"},fD={key:0,class:"check-in-time"},pD={key:0,class:"check-in-method"},vD={key:1,class:"unsaved-indicator"},mD={key:1,class:"card-status-readonly"},gD={class:"status-icon"},yD={key:0,class:"check-in-time"},kD={key:0,class:"check-in-method"},bD={key:2,class:"card-badge"},wD={key:3,class:"card-badge"},_D={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const n=e,s=t,o=()=>{s("distance-click",n.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=z(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:b}=n.assignment;return y&&y!==b?y:k||""}),c=z(()=>!n.assignment.isPending&&!n.isMarkedForRemoval&&!n.readOnly),d=z(()=>{const{checkInLatitude:y,checkInLongitude:k}=n.assignment,b=n.location;return!y||!k||!b?.latitude||!b?.longitude?null:al(y,k,b.latitude,b.longitude)}),h=z(()=>d.value===null?null:p2(d.value)),f=z(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),m=()=>{c.value&&s("click",n.assignment)};return(y,k)=>(p(),g("div",{class:le(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":c.value}]),onClick:m},[r("div",lD,[r("div",rD,[r("span",cD,w(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(p(),g("div",uD,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=ct(b=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",dD,w(e.effectiveCheckInStatus?"":""),1),r("span",hD,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",fD,[Je(w(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",pD,"("+w(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},w(h.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",vD," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(p(),g("div",mD,[r("span",{class:le(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",gD,w(e.effectiveCheckInStatus?"":""),1),Je(" "+w(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(p(),g("span",yD,[Je(w(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",kD,"("+w(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},w(h.value),3)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(p(),g("div",bD,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",wD,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=ct(b=>y.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=ct(b=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},CD=Ke(_D,[["__scopeId","data-v-85a18d73"]]),LD={class:"tab-content"},SD={key:0,class:"read-only-notice"},ID={key:1,class:"form-group"},xD=["value"],$D={class:"section-title"},TD={key:2,class:"assign-section"},MD={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:n}){const s=e,o=z(()=>s.peopleTerm.toLowerCase()),i=z(()=>s.personTerm.toLowerCase()),l=z(()=>s.checkpointTerm.toLowerCase()),c=n,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=_1(()=>c("input")),m=D(new Set),y=z(()=>s.assignments?.length||0),k=z(()=>s.assignments?[...s.assignments].sort((A,U)=>(A.marshalName||"").localeCompare(U.marshalName||"",void 0,{sensitivity:"base"})):[]),b=A=>m.value.has(A),I=A=>{A.isPending||c("select-marshal",A)},T=D(!1),E=D(null),x=A=>{h(A)?(E.value=A,T.value=!0):f(A)},C=()=>{E.value&&f(E.value),T.value=!1,E.value=null},_=()=>{T.value=!1,E.value=null},$=z(()=>E.value?`Are you sure you want to undo ${E.value.marshalName||"this marshal"}'s check-in?`:""),R=A=>{A.isPending?c("remove-assignment",A):(m.value.add(A.id),c("input"))},M=A=>{m.value.delete(A.id),c("input")},O=(A,U)=>{c("update:form",{...s.form,[A]:Number(U)}),c("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([A,U])=>({assignmentId:A,shouldBeCheckedIn:U})),getMarkedForRemoval:()=>Array.from(m.value)}),(A,U)=>(p(),g("div",LD,[e.readOnly?(p(),g("div",SD," Viewing from "+w(i.value)+" - "+w(o.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(p(),g("div",ID,[r("label",null,"Required "+w(o.value),1),r("input",{value:e.form.requiredMarshals,onInput:U[0]||(U[0]=F=>O("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,xD)])),r("h3",$D,"Assigned "+w(o.value)+" ("+w(y.value)+")",1),Ee(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${o.value} assigned yet.`,"empty-hint":`Use the button below to assign ${o.value} to this ${l.value}.`},{default:Ve(()=>[(p(!0),g(Se,null,je(k.value,F=>(p(),qe(CD,{key:F.id,assignment:F,"effective-check-in-status":B(h)(F),"has-unsaved-changes":B(d).has(F.id),"is-marked-for-removal":b(F.id),"read-only":e.readOnly,location:e.form,onClick:I,onToggleCheckIn:x,onRemove:R,onUndoRemove:M,onDistanceClick:U[1]||(U[1]=j=>A.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(p(),g("div",TD,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:U[2]||(U[2]=F=>A.$emit("open-assign-modal"))}," + Assign "+w(i.value)+"... ",1)])),Ee(hi,{show:T.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:_},null,8,["show","message"])]))}},AD=Ke(MD,[["__scopeId","data-v-7124720e"]]),ED={class:"grouped-tasks-list"},PD={key:0,class:"empty-state"},DD={class:"task-group-header-row"},RD=["onClick"],OD={class:"task-header-content"},ND={class:"task-checkbox-area"},BD={class:"task-info"},FD={class:"task-name"},UD={class:"task-summary"},zD={key:0,class:"modified-badge"},HD={class:"task-scope"},VD=["title"],GD={class:"expand-arrow"},qD={key:0,class:"task-group-details"},jD={class:"sub-group-header"},WD={class:"detail-checkbox"},ZD=["name","checked","disabled","onChange"],KD=["checked","disabled","onChange"],YD={class:"detail-content"},JD={class:"detail-context"},XD={key:0,class:"detail-completion"},QD={key:0,class:"pending-text"},e5={class:"completion-text"},t5={class:"completion-time"},n5={key:1,class:"detail-uncomplete"},o5={key:2,class:"detail-disabled"},s5={class:"detail-checkbox"},a5=["checked","disabled","onChange"],i5={class:"detail-content"},l5={class:"detail-context"},r5={key:0,class:"detail-completion"},c5={key:0,class:"pending-text"},u5={class:"completion-text"},d5={class:"completion-time"},h5={key:1,class:"detail-uncomplete"},f5={key:2,class:"detail-disabled"},p5={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["toggle-complete","reorder"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=e,i=t,l=D(new Set),c=(_,$)=>{if(_==="Checkpoint"){const R=o.locations.find(M=>M.id===$);if(!R)return`${n.value.checkpoint} (unknown)`;if(R.description){const O=R.description.length>40?R.description.substring(0,40)+"...":R.description;return`${R.name} - ${O}`}return R.name}return _==="Area"?o.areas.find(M=>M.id===$)?.name||`${n.value.area} (unknown)`:$},d=(_,$)=>_==="Checkpoint"?o.locations.find(M=>M.id===$)?.name||"":_==="Area"?o.areas.find(M=>M.id===$)?.name||"":$,h=z(()=>{const _=new Map;for(const $ of o.items){_.has($.itemId)||_.set($.itemId,{itemId:$.itemId,text:$.text,displayOrder:$.displayOrder||0,matchedScope:$.matchedScope,items:[],subGroups:null,totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1,contextIds:new Set,completedContextIds:new Set});const R=_.get($.itemId);R.items.push($),T.includes($.matchedScope)&&$.completionContextId?(R.contextIds.add($.completionContextId),$.localIsCompleted&&R.completedContextIds.add($.completionContextId)):(R.totalCount++,$.localIsCompleted&&R.completedCount++),$.isModified&&(R.hasModified=!0)}for(const $ of _.values()){if(T.includes($.matchedScope)){$.totalCount=$.contextIds.size,$.completedCount=$.completedContextIds.size;const M=new Map;for(const O of $.items){const A=O.completionContextId;M.has(A)||M.set(A,{contextId:A,contextType:O.completionContextType,contextName:c(O.completionContextType,A),sortKey:d(O.completionContextType,A),items:[],isContextCompleted:!1});const U=M.get(A);U.items.push(O),O.localIsCompleted&&(U.isContextCompleted=!0)}$.subGroups=Array.from(M.values()).sort((O,A)=>O.sortKey.localeCompare(A.sortKey,void 0,{numeric:!0,sensitivity:"base"}));for(const O of $.subGroups)O.items.sort((A,U)=>{const F=A.contextOwnerName||"",j=U.contextOwnerName||"";return F.localeCompare(j,void 0,{sensitivity:"base"})})}else $.items.sort((M,O)=>{const A=E(M),U=E(O);return A.localeCompare(U,void 0,{numeric:!0,sensitivity:"base"})});$.allCompleted=$.totalCount>0&&$.completedCount===$.totalCount}return Array.from(_.values()).sort(($,R)=>{const M=$.displayOrder||0,O=R.displayOrder||0;return M!==O?M-O:$.text.localeCompare(R.text,void 0,{sensitivity:"base"})})}),f=_=>{l.value.has(_)?l.value.delete(_):l.value.add(_),l.value=new Set(l.value)},m=({changes:_})=>{i("reorder",_)},y=_=>_.hasModified?"status-modified":_.allCompleted?"status-completed":_.completedCount>0?"status-partial":"status-pending",k=_=>_.allCompleted?"":_.completedCount>0?"":"",b=_=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${s.value.area}`,EveryoneAtCheckpoints:`Per ${s.value.checkpoint}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[_.matchedScope]||_.matchedScope,I=_=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This task is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[_.matchedScope]||"",T=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],E=_=>{if(!_.completionContextType||!_.completionContextId)return"Everyone";if(T.includes(_.matchedScope)&&_.contextOwnerName)return _.contextOwnerName;if(_.completionContextType==="Checkpoint"){if(_.linksToCheckIn&&_.contextOwnerName){const M=o.locations.find(O=>O.id===_.completionContextId)?.name||_.linkedCheckpointName;return M?`${_.contextOwnerName} (${M})`:_.contextOwnerName}const $=o.locations.find(R=>R.id===_.completionContextId);return $?$.description?`${$.name} - ${$.description}`:$.name:`${n.value.checkpoint} (unknown)`}if(_.completionContextType==="Area"){const $=o.areas.find(R=>R.id===_.completionContextId);return $?$.name:`${n.value.area} (unknown)`}if(_.completionContextType==="Personal"){if(_.contextOwnerName)return _.contextOwnerName;if(_.completionContextId&&o.marshals.length>0){const $=o.marshals.find(R=>R.id===_.completionContextId||R.marshalId===_.completionContextId);if($)return $.name||$.marshalName}return"Assigned individually"}return _.completionContextType},x=_=>{if(!_)return"";const $=new Date(_),O=(new Date-$)/(1e3*60*60);return O<24&&O>=0?$.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):$.toLocaleString()},C=_=>_.completedByActorName&&_.contextOwnerName&&_.completedByActorName!==_.contextOwnerName?`${_.completedByActorName} on behalf of ${_.contextOwnerName}`:_.completedByActorName||_.contextOwnerName||"Unknown";return(_,$)=>(p(),g("div",ED,[h.value.length===0?(p(),g("div",PD,[...$[0]||($[0]=[r("p",null,"No tasks available.",-1)])])):(p(),qe(ll,{key:1,items:h.value,"item-key":"itemId",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:m},{item:Ve(({element:R})=>[r("div",{class:le(["task-group",{"all-completed":R.allCompleted,"has-modified":R.hasModified}])},[r("div",DD,[e.allowReorder?(p(),qe(rl,{key:0,class:"task-drag-handle"})):P("",!0),r("button",{type:"button",class:"task-group-header",onClick:M=>f(R.itemId)},[r("div",OD,[r("div",ND,[r("span",{class:le(["task-status-icon",y(R)])},w(k(R)),3)]),r("div",BD,[r("div",FD,w(R.text),1),r("div",UD,[r("span",{class:le(["completion-count",{"all-done":R.allCompleted}])},w(R.completedCount)+"/"+w(R.totalCount)+" completed ",3),R.hasModified?(p(),g("span",zD," Modified ")):P("",!0)])]),r("div",HD,[R.items[0]?.scopeConfigurations?.length?(p(),qe(ol,{key:0,"scope-configurations":R.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("span",{key:1,class:"scope-pill",title:I(R.items[0])},w(b(R.items[0])),9,VD))])]),r("span",GD,w(l.value.has(R.itemId)?"":""),1)],8,RD)]),l.value.has(R.itemId)?(p(),g("div",qD,[R.subGroups&&R.subGroups.length>0?(p(!0),g(Se,{key:0},je(R.subGroups,M=>(p(),g("div",{key:M.contextId,class:"task-sub-group"},[r("div",jD,w(M.contextName),1),(p(!0),g(Se,null,je(M.items,O=>(p(),g("div",{key:`${O.itemId}-${O.completionContextId}-${O.contextOwnerMarshalId}`,class:le(["task-detail-item",{"item-completed":O.localIsCompleted,"item-modified":O.isModified}])},[r("div",WD,[M.isContextCompleted?(p(),g("input",{key:1,type:"checkbox",checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe&&!O.localIsCompleted,onChange:A=>_.$emit("toggle-complete",O)},null,40,KD)):(p(),g("input",{key:0,type:"radio",name:`shared-${O.itemId}-${M.contextId}`,checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe,onChange:A=>_.$emit("toggle-complete",O)},null,40,ZD))]),r("div",YD,[r("div",JD,w(O.contextOwnerName||"Unknown marshal"),1),O.localIsCompleted?(p(),g("div",XD,[O.isModified&&!O.isCompleted?(p(),g("span",QD," Will be marked as completed ")):(p(),g(Se,{key:1},[r("span",e5,w(C(O)),1),r("span",t5,w(x(O.completedAt)),1)],64))])):O.isModified&&O.isCompleted?(p(),g("div",n5,[...$[1]||($[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):O.canBeCompletedByMe?P("",!0):(p(),g("div",o5," Already completed by someone else "))])],2))),128))]))),128)):(p(!0),g(Se,{key:1},je(R.items,M=>(p(),g("div",{key:`${M.itemId}-${M.completionContextId}`,class:le(["task-detail-item",{"item-completed":M.localIsCompleted,"item-modified":M.isModified}])},[r("div",s5,[r("input",{type:"checkbox",checked:M.localIsCompleted,disabled:!M.canBeCompletedByMe&&!M.localIsCompleted,onChange:O=>_.$emit("toggle-complete",M)},null,40,a5)]),r("div",i5,[r("div",l5,w(E(M)),1),M.localIsCompleted?(p(),g("div",r5,[M.isModified&&!M.isCompleted?(p(),g("span",c5," Will be marked as completed ")):(p(),g(Se,{key:1},[r("span",u5,w(C(M)),1),r("span",d5,w(x(M.completedAt)),1)],64))])):M.isModified&&M.isCompleted?(p(),g("div",h5,[...$[2]||($[2]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):M.canBeCompletedByMe?P("",!0):(p(),g("div",f5," Already completed by someone else "))])],2))),128))])):P("",!0)],2)]),_:1},8,["items","disabled","show-order-overlay"]))]))}},Uf=Ke(p5,[["__scopeId","data-v-06c0c2c6"]]),v5={class:"checkpoint-checklist-view"},m5={key:0,class:"loading-state"},g5={key:1,class:"error-state"},y5={key:2,class:"empty-state"},k5={class:"help-text"},b5={key:3,class:"empty-state"},w5={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=ht(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=z(()=>o.assignments.length===0),m=z(()=>l.value.map(E=>{const x=h.value.get(`${E.itemId}|||${E.completionContextId}`),C=x!==void 0?x.complete:E.isCompleted,_=x!==void 0&&x.complete!==E.isCompleted;return{...E,localIsCompleted:C,isModified:_}})),y=async()=>{if(!(!o.eventId||!o.locationId&&!o.areaId)){c.value=!0,d.value=null;try{const E=o.locationId?await Rt.getCheckpointChecklist(o.eventId,o.locationId):await Rt.getAreaChecklist(o.eventId,o.areaId);if(l.value=E.data||[],o.modelValue&&o.modelValue.length>0){const x=new Map;o.modelValue.forEach(C=>{x.set(`${C.itemId}|||${C.contextId}`,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),h.value=x}}catch(E){console.error("Failed to load checklist:",E),d.value=E.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},k=E=>{const x=E.contextOwnerMarshalId||(o.assignments.length>0?o.assignments[0].marshalId:null);if(!x)return;const C=`${E.itemId}|||${E.completionContextId}`,_=h.value.get(C),$=_!==void 0?_.complete:E.isCompleted;h.value.set(C,{complete:!$,contextType:E.completionContextType,contextId:E.completionContextId,marshalId:x}),b()},b=()=>{const E=[];for(const[x,C]of h.value.entries()){const[_,$]=x.split("|||"),R=l.value.find(M=>M.itemId===_&&M.completionContextId===$);R&&C.complete!==R.isCompleted&&E.push({itemId:_,complete:C.complete,contextType:C.contextType,contextId:C.contextId,marshalId:C.marshalId})}i("update:modelValue",E),i("change",E)},I=E=>{i("reorder",E)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const E=new Map;o.modelValue.forEach(x=>{E.set(`${x.itemId}|||${x.contextId}`,{complete:x.complete,contextType:x.contextType,contextId:x.contextId,marshalId:x.marshalId})}),h.value=E}},loadChecklist:y}),Ye(()=>[o.eventId,o.locationId,o.areaId],()=>{y()},{immediate:!0}),(E,x)=>(p(),g("div",v5,[c.value?(p(),g("div",m5," Loading checklist... ")):d.value?(p(),g("div",g5,[r("p",null,w(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(p(),g("div",y5,[r("p",null,"No "+w(B(s).peoplePlural)+" assigned to this "+w(B(s).checkpoint)+" yet.",1),r("p",k5,"Assign "+w(B(s).peoplePlural)+" to enable "+w(B(s).checklist)+" completion.",1)])):l.value.length===0?(p(),g("div",b5,[r("p",null,"No checklist items for this "+w(B(s).checkpoint)+".",1)])):(p(),qe(Uf,{key:4,items:m.value,locations:e.locations,areas:e.areas,marshals:e.marshals,"allow-reorder":e.allowReorder,onToggleComplete:k,onReorder:I},null,8,["items","locations","areas","marshals","allow-reorder"]))]))}},C1=Ke(w5,[["__scopeId","data-v-d3deb94b"]]),_5={class:"notes-view"},C5={key:0,class:"loading-state"},L5={key:1,class:"error-state"},S5={key:2,class:"empty-state"},I5={class:"note-item-content"},x5={class:"note-header"},$5={class:"note-title-row"},T5={key:0,class:"pin-icon",title:"Pinned"},M5={class:"note-title"},A5={class:"note-meta"},E5={key:0,class:"category-badge"},P5={key:0,class:"note-content"},D5={class:"note-footer"},R5={class:"created-info"},O5={key:1,class:"scope-info"},N5={key:1,class:"notes-list"},B5={class:"note-item-content"},F5={class:"note-header"},U5={class:"note-title-row"},z5={key:0,class:"pin-icon",title:"Pinned"},H5={class:"note-title"},V5={class:"note-meta"},G5={key:0,class:"category-badge"},q5={key:0,class:"note-content"},j5={class:"note-footer"},W5={class:"created-info"},Z5={key:1,class:"scope-info"},K5={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0},allowReorder:{type:Boolean,default:!1}},emits:["reorder"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D([]),l=D(!1),c=D(null),d=z(()=>s.marshalId?"No notes for this marshal.":s.areaId?"No notes for this area.":s.locationId?"No notes for this checkpoint.":"No notes available."),h=z(()=>s.areaId?s.locations.filter(_=>_.areaIds&&_.areaIds.includes(s.areaId)):[]),f=z(()=>h.value.map(_=>_.id)),m=z(()=>{if(!s.areaId)return[];const _=new Set;return s.assignments.filter($=>f.value.includes($.locationId)).forEach($=>_.add($.marshalId)),Array.from(_)}),y=_=>s.assignments.filter($=>$.marshalId===_).map($=>$.locationId),k=_=>{const $=y(_),R=new Set;for(const M of $){const O=s.locations.find(A=>A.id===M);O?.areaIds&&O.areaIds.forEach(A=>R.add(A))}return Array.from(R)},b=(_,$)=>{if(!_.scopeConfigurations)return null;for(const R of _.scopeConfigurations){if(R.itemType==="Area"){if($.type==="area"&&(R.ids.includes($.areaId)||R.ids.includes("ALL_AREAS")))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"};if($.type==="checkpoint"){const O=s.locations.find(A=>A.id===$.locationId)?.areaIds||[];if(R.ids.includes("ALL_AREAS")||O.some(A=>R.ids.includes(A)))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(R.itemType==="Checkpoint"){if($.type==="checkpoint"&&(R.ids.includes($.locationId)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if($.type==="area"&&$.checkpointIds.some(O=>R.ids.includes(O)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(R.itemType==="Marshal"){if($.type==="marshal"&&(R.ids.includes($.marshalId)||R.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if($.type==="checkpoint"){const M=s.assignments.filter(A=>A.locationId===$.locationId).map(A=>A.marshalId);if(R.ids.includes("ALL_MARSHALS")||M.some(A=>R.ids.includes(A)))return{matched:!0,scope:"Marshal at checkpoint"}}if($.type==="area"&&(R.ids.includes("ALL_MARSHALS")||$.marshalIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Marshal in area"}}if($.type==="marshal"&&$.checkpointIds&&$.areaIds){if(R.itemType==="Checkpoint"&&(R.ids.includes("ALL_CHECKPOINTS")||$.checkpointIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Assigned checkpoint"};if(R.itemType==="Area"&&(R.ids.includes("ALL_AREAS")||$.areaIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},I=z(()=>{const _=s.allNotes||i.value;if(!_||_.length===0)return[];if(s.areaId&&s.allNotes){const $={type:"area",areaId:s.areaId,checkpointIds:f.value,marshalIds:m.value},R=[],M=new Set;for(const O of _){if(M.has(O.noteId))continue;const A=b(O,$);A&&(M.add(O.noteId),R.push({...O,matchedScope:A.scope}))}return R}if(s.locationId&&s.allNotes){const $={type:"checkpoint",locationId:s.locationId},R=[],M=new Set;for(const O of _){if(M.has(O.noteId))continue;const A=b(O,$);A&&(M.add(O.noteId),R.push({...O,matchedScope:A.scope}))}return R}if(s.marshalId&&s.allNotes){const $=y(s.marshalId),R=k(s.marshalId),M={type:"marshal",marshalId:s.marshalId,checkpointIds:$,areaIds:R},O=[],A=new Set;for(const U of _){if(A.has(U.noteId))continue;const F=b(U,M);F&&(A.add(U.noteId),O.push({...U,matchedScope:F.scope}))}return O}return _}),T=z(()=>{const _={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...I.value].sort(($,R)=>{if($.isPinned!==R.isPinned)return $.isPinned?-1:1;const M=_[$.priority]??2,O=_[R.priority]??2;return M!==O?M-O:$.displayOrder!==R.displayOrder?$.displayOrder-R.displayOrder:new Date(R.createdAt)-new Date($.createdAt)})}),E=({changes:_})=>{o("reorder",_)},x=async()=>{if(s.allNotes===null&&s.eventId){l.value=!0,c.value=null;try{let _;s.marshalId?_=await bs.getMarshalNotes(s.eventId,s.marshalId):_=await bs.getByEvent(s.eventId),i.value=_.data||[]}catch(_){console.error("Failed to load notes:",_),c.value=_.response?.data?.message||"Failed to load notes"}finally{l.value=!1}}};Ye(()=>[s.eventId,s.locationId,s.areaId,s.marshalId],()=>{s.allNotes===null&&x()},{immediate:!0});const C=_=>{if(!_)return"";const $=new Date(_),M=new Date-$,O=Math.floor(M/6e4),A=Math.floor(M/36e5),U=Math.floor(M/864e5);return O<1?"just now":O<60?`${O}m ago`:A<24?`${A}h ago`:U<7?`${U}d ago`:$.toLocaleDateString()};return t({loadNotes:x}),(_,$)=>(p(),g("div",_5,[l.value?(p(),g("div",C5," Loading notes... ")):c.value?(p(),g("div",L5,[r("p",null,w(c.value),1),r("button",{onClick:x,class:"btn btn-secondary btn-small"}," Retry ")])):I.value.length===0?(p(),g("div",S5,[r("p",null,w(d.value),1)])):(p(),g(Se,{key:3},[e.allowReorder?(p(),qe(ll,{key:0,items:T.value,"item-key":"noteId","pinned-key":"isPinned",onReorder:E,class:"notes-list"},{item:Ve(({element:R})=>[r("div",{class:le(["note-item",{pinned:R.isPinned}])},[Ee(rl),r("div",I5,[r("div",x5,[r("div",$5,[R.isPinned?(p(),g("span",T5,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",M5,w(R.title),1)]),r("div",A5,[R.category?(p(),g("span",E5,w(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},w(R.priority||"Normal"),3)])]),R.content?(p(),g("div",P5,w(R.content),1)):P("",!0),r("div",D5,[r("span",R5," Created by "+w(R.createdByName||"Unknown")+"  "+w(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),qe(ol,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),g("span",O5,w(R.matchedScope),1)):P("",!0)])])],2)]),_:1},8,["items"])):(p(),g("div",N5,[(p(!0),g(Se,null,je(T.value,R=>(p(),g("div",{key:R.noteId,class:le(["note-item",{pinned:R.isPinned}])},[r("div",B5,[r("div",F5,[r("div",U5,[R.isPinned?(p(),g("span",z5,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",H5,w(R.title),1)]),r("div",V5,[R.category?(p(),g("span",G5,w(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},w(R.priority||"Normal"),3)])]),R.content?(p(),g("div",q5,w(R.content),1)):P("",!0),r("div",j5,[r("span",W5," Created by "+w(R.createdByName||"Unknown")+"  "+w(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),qe(ol,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),g("span",Z5,w(R.matchedScope),1)):P("",!0)])])],2))),128))]))],64))]))}},ld=Ke(K5,[["__scopeId","data-v-cd3c899d"]]),Y5={class:"checklist-preview"},J5={class:"preview-actions"},X5={class:"preview-header"},Q5={key:0,class:"add-item-form"},eR=["placeholder"],tR=["disabled"],nR={key:1,class:"pending-items"},oR={class:"item-content"},sR={class:"item-header"},aR={class:"item-text"},iR={class:"item-scope"},lR=["onClick"],rR={key:2,class:"empty-state"},cR={key:0,class:"help-text"},uR={key:3,class:"checklist-items"},dR={class:"item-content"},hR={class:"item-header"},fR={class:"item-text"},pR={class:"item-scope"},vR=["title"],mR={key:0,class:"item-context"},gR={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=e,i=z(()=>o.checkpointTermSingular?o.checkpointTermSingular.toLowerCase():s.value.checkpoint),l=t,c=D(!1),d=D(""),h=D([...o.modelValue]);Ye(()=>o.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",c.value=!1,y())},m=C=>{h.value.splice(C,1),y()},y=()=>{l("update:modelValue",[...h.value]),l("change")},k=C=>{const _=C.scope,$=C.itemType,R=C.ids||[];return(_==="EveryoneAtCheckpoints"||_==="OnePerCheckpoint")&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):_==="OnePerCheckpoint"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>o.pendingAreaIds.includes(M)):(_==="EveryoneInAreas"||_==="OnePerArea"||_==="EveryAreaLead"||_==="OneLeadPerArea")&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>o.pendingAreaIds.includes(M)):!1},b=z(()=>o.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(_=>k(_)):!1)),I=C=>({EveryoneAtCheckpoints:`All at ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,EveryoneInAreas:`All in ${s.value.areas}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${s.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const _=C.scopeConfigurations.find(R=>k(R));if(!_)return I(C.scopeConfigurations[0].scope);const $=_.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${s.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${s.value.areas}`:I(_.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const _=C.scopeConfigurations.find(R=>k(R));return _&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${s.value.checkpoints}`,OnePerCheckpoint:`One person at each ${s.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${s.value.areas}`,OnePerArea:`One person in each ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`}[_.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const _=C.scopeConfigurations.find(M=>k(M));if(!_)return null;const $=_.itemType,R=_.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const M=o.areas.filter(O=>R.includes(O.id)&&o.pendingAreaIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,_)=>(p(),g("div",Y5,[r("div",J5,[r("p",X5,w(e.isEditing?`Add new ${B(s).checklist} for this ${i.value}:`:`${B(n).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=$=>c.value=!c.value)},w(c.value?"Cancel":`Add ${B(s).checklist}`),1)]),c.value?(p(),g("div",Q5,[We(r("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>d.value=$),type:"text",placeholder:`Enter ${B(s).checklist} text...`,class:"add-item-input",onKeyup:Qo(f,["enter"])},null,40,eR),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,tR)])):P("",!0),h.value.length>0?(p(),g("div",nR,[(p(!0),g(Se,null,je(h.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"checklist-item pending"},[_[3]||(_[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",oR,[r("div",sR,[r("div",aR,w($.text),1),r("div",iR,[_[2]||(_[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>m(R),title:"Remove"},"  ",8,lR)])])])]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(p(),g("div",rR,[r("p",null,"No "+w(B(s).checklists)+" will apply based on the current "+w(B(s).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",cR," Assign "+w(B(s).areas)+" to see relevant "+w(B(s).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),g("div",uR,[(p(!0),g(Se,null,je(b.value,$=>(p(),g("div",{key:$.id,class:"checklist-item"},[_[4]||(_[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",dR,[r("div",hR,[r("div",fR,w($.text),1),r("div",pR,[r("span",{class:"scope-pill",title:E($)},w(T($)),9,vR)])]),x($)?(p(),g("div",mR,w(x($)),1)):P("",!0)])]))),128))])):P("",!0)]))}},yR=Ke(gR,[["__scopeId","data-v-7d943b21"]]),kR={class:"notes-preview"},bR={class:"preview-actions"},wR={class:"preview-header"},_R={key:0,class:"add-item-form"},CR={class:"add-form-fields"},LR=["disabled"],SR={key:1,class:"pending-items"},IR={class:"note-header"},xR={class:"note-title"},$R={class:"note-actions"},TR=["onClick"],MR={key:0,class:"note-content"},AR={key:2,class:"empty-state"},ER={key:0,class:"help-text"},PR={key:3,class:"notes-list"},DR={class:"note-header"},RR={class:"note-title"},OR=["title"],NR={key:0,class:"note-content"},BR={key:1,class:"note-context"},FR={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=z(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():n.value.checkpoint),l=D(!1),c=D(""),d=D(""),h=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{!c.value.trim()&&!d.value.trim()||(h.value.push({title:c.value.trim(),content:d.value.trim(),isNew:!0}),c.value="",d.value="",l.value=!1,y())},m=C=>{h.value.splice(C,1),y()},y=()=>{o("update:modelValue",[...h.value]),o("change")},k=C=>{const _=C.scope,$=C.itemType,R=C.ids||[];return _==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):_==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>s.pendingAreaIds.includes(M)):!1},b=z(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(_=>k(_)):!1)),I=C=>({EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const _=C.scopeConfigurations.find(R=>k(R));if(!_)return I(C.scopeConfigurations[0].scope);const $=_.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:I(_.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const _=C.scopeConfigurations.find(R=>k(R));return _&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[_.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const _=C.scopeConfigurations.find(M=>k(M));if(!_)return null;const $=_.itemType,R=_.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const M=s.areas.filter(O=>R.includes(O.id)&&s.pendingAreaIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,_)=>(p(),g("div",kR,[r("div",bR,[r("p",wR,w(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=$=>l.value=!l.value)},w(l.value?"Cancel":"Add note"),1)]),l.value?(p(),g("div",_R,[r("div",CR,[We(r("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>c.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,c.value]]),We(r("textarea",{"onUpdate:modelValue":_[2]||(_[2]=$=>d.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,LR)])):P("",!0),h.value.length>0?(p(),g("div",SR,[(p(!0),g(Se,null,je(h.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",IR,[r("span",xR,w($.title||"Untitled"),1),r("div",$R,[_[3]||(_[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>m(R),title:"Remove"},"  ",8,TR)])]),$.content?(p(),g("div",MR,w($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(p(),g("div",AR,[r("p",null,"No notes will apply based on the current "+w(B(n).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",ER," Assign "+w(B(n).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),g("div",PR,[(p(!0),g(Se,null,je(b.value,$=>(p(),g("div",{key:$.id,class:"note-item"},[r("div",DR,[r("span",RR,w($.title||"Untitled"),1),r("span",{class:"scope-pill",title:E($)},w(T($)),9,OR)]),$.content?(p(),g("div",NR,w($.content),1)):P("",!0),x($)?(p(),g("div",BR,w(x($)),1)):P("",!0)]))),128))])):P("",!0)]))}},UR=Ke(FR,[["__scopeId","data-v-71646c3f"]]),zR={class:"base-modal-title modal-title-with-icon"},HR=["innerHTML"],VR={key:7,class:"tab-content appearance-tab"},GR={class:"accordion-item"},qR=["innerHTML"],jR={class:"accordion-title"},WR={class:"accordion-arrow"},ZR={key:0,class:"accordion-content"},KR={class:"section-description"},YR={class:"accordion-item"},JR={class:"accordion-preview"},XR={class:"accordion-arrow"},QR={key:0,class:"accordion-content"},eO={class:"section-description"},tO={class:"terminology-row"},nO={class:"terminology-field"},oO=["value"],sO={value:""},aO=["value"],iO={class:"terminology-field"},lO=["value"],rO={value:""},cO=["value"],uO={key:8,class:"tab-content incidents-tab"},dO={class:"incidents-list"},hO={class:"custom-footer"},fO={class:"footer-left"},vm="edit_location_accordion",pO={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal","reorder-notes","reorder-checklists"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=D("details"),l=D(!1),c=D(null),d=D(null),h=D([]),f=D([]),m=D([]),y=D({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=D(!1),b=D(null),I=fe=>{b.value=fe,k.value=!0},T=()=>{k.value=!1,b.value=null},E=z(()=>b.value&&b.value.marshalName||""),x=z(()=>y.value.name||s.location?.name||""),C=z(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:be}=b.value;return!fe||!be?null:{lat:fe,lng:be}}),_=z(()=>{const fe=y.value.latitude,be=y.value.longitude;return!fe||!be?null:{lat:fe,lng:be}}),$=z(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:be}=b.value,ne=y.value.latitude,ye=y.value.longitude;return!fe||!be||!ne||!ye?null:al(fe,be,ne,ye)}),R=()=>s.eventId?`${vm}_${s.eventId}`:vm,M=D({iconStyle:!1,terminology:!1});un(()=>{const fe=localStorage.getItem(R());if(fe)try{const be=JSON.parse(fe);M.value={...M.value,...be}}catch{}});const O=fe=>{M.value[fe]=!M.value[fe],localStorage.setItem(R(),JSON.stringify(M.value))},A=z(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const be=s.areas.filter(ne=>fe.includes(ne.id)&&ne.peopleTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(be.length>0)return be[0].peopleTerm}return s.eventPeopleTerm||"Marshals"}),U=z(()=>y.value.peopleTerm?y.value.peopleTerm:A.value),F=z(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const be=s.areas.filter(ne=>fe.includes(ne.id)&&ne.checkpointTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(be.length>0)return be[0].checkpointTerm}return n.value.checkpoint});z(()=>F.value.toLowerCase());const j=z(()=>{const fe=y.value.checkpointTerm||s.location?.checkpointTerm||s.location?.CheckpointTerm;if(fe)return Wi("checkpoint",fe,U.value);const be=y.value.areaIds||[];let ne=null;if(be.length>0){const ye=s.areas.filter(He=>be.includes(He.id)&&He.checkpointTerm).sort((He,rt)=>(He.checkpointCount||0)-(rt.checkpointCount||0));ye.length>0&&(ne=ye[0].checkpointTerm)}return ne?Wi("checkpoint",ne,U.value):n.value.checkpoint}),Z=z(()=>j.value.toLowerCase()),X=z(()=>{const fe=U.value;return Wi("people",fe)});z(()=>X.value.toLowerCase());const re=z(()=>n.value.area);z(()=>re.value.toLowerCase());const K=z(()=>n.value.area),ae=z(()=>K.value.toLowerCase()),q=z(()=>n.value.areas),Y=z(()=>!!(s.location&&s.location.id)),te=z(()=>Y.value?`Edit ${Z.value}: ${s.location?.name||""}`:`Add ${Z.value}`),ue=z(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:U.value,icon:"marshal"},{value:"checklists",label:n.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return s.incidents&&s.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),_e=z(()=>ue.value.findIndex(fe=>fe.value===i.value)),Te=z(()=>_e.value===ue.value.length-1),Pe=z(()=>{const fe=y.value.areaIds||[],be=s.areas.filter(ft=>fe.includes(ft.id)).sort((ft,Ct)=>(ft.checkpointCount||0)-(Ct.checkpointCount||0)),ne=(ft,Ct)=>{for(const Mt of be){const Mn=ft(Mt);if(Mn&&Mn!=="default")return{value:Mn,source:"area"}}return Ct&&Ct!=="default"?{value:Ct,source:"event"}:{value:"",source:"none"}},ye=ne(ft=>ft.checkpointStyleType||ft.CheckpointStyleType,s.eventDefaultStyleType),He=ne(ft=>ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleColor),rt=ne(ft=>ft.checkpointStyleBackgroundShape||ft.CheckpointStyleBackgroundShape,s.eventDefaultStyleBackgroundShape),kt=ne(ft=>ft.checkpointStyleBackgroundColor||ft.CheckpointStyleBackgroundColor||ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleBackgroundColor||s.eventDefaultStyleColor),Ot=ne(ft=>ft.checkpointStyleBorderColor||ft.CheckpointStyleBorderColor,s.eventDefaultStyleBorderColor),Lt=ne(ft=>ft.checkpointStyleIconColor||ft.CheckpointStyleIconColor,s.eventDefaultStyleIconColor),xt=ne(ft=>ft.checkpointStyleSize||ft.CheckpointStyleSize,s.eventDefaultStyleSize),Kt=ne(ft=>ft.checkpointStyleMapRotation??ft.CheckpointStyleMapRotation,s.eventDefaultStyleMapRotation),Mo=[ye,rt,kt,Ot,Lt,xt,Kt].some(ft=>ft.source==="area");return{type:ye.value||"default",color:He.value,backgroundShape:rt.value,backgroundColor:kt.value,borderColor:Ot.value,iconColor:Lt.value,size:xt.value,mapRotation:Kt.value,source:Mo?"area":ye.value?"event":"none"}}),De=z(()=>Pe.value.source==="area"?`${K.value} default`:"Event default"),ke=z(()=>{const fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Pe.value.type,be=y.value.styleBackgroundShape||Pe.value.backgroundShape||"circle",ne=y.value.styleBackgroundColor||Pe.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||Pe.value.borderColor||"#ffffff",He=y.value.styleIconColor||Pe.value.iconColor||"#ffffff";return zn({type:fe||"circle",backgroundShape:be,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100"})}),H=z(()=>{let fe,be,ne,ye,He;return Y.value&&s.location?(fe=s.location.resolvedStyleType||s.location.ResolvedStyleType,be=s.location.resolvedStyleBackgroundShape||s.location.ResolvedStyleBackgroundShape||"circle",ne=s.location.resolvedStyleBackgroundColor||s.location.ResolvedStyleBackgroundColor||s.location.resolvedStyleColor||s.location.ResolvedStyleColor||"#667eea",ye=s.location.resolvedStyleBorderColor||s.location.ResolvedStyleBorderColor||"#ffffff",He=s.location.resolvedStyleIconColor||s.location.ResolvedStyleIconColor||"#ffffff"):(fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Pe.value.type,be=y.value.styleBackgroundShape||Pe.value.backgroundShape||"circle",ne=y.value.styleBackgroundColor||Pe.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||Pe.value.borderColor||"#ffffff",He=y.value.styleIconColor||Pe.value.iconColor||"#ffffff"),zn({type:fe||"circle",backgroundShape:be,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100",outputSize:28})}),J=z(()=>{const fe=!!y.value.checkpointTerm,be=!!y.value.peopleTerm;return fe&&be?`${Wi("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:fe?Wi("checkpoint",y.value.checkpointTerm,U.value):be?y.value.peopleTerm:"Using defaults"}),de=z(()=>Te.value?null:ue.value[_e.value+1]),ie=z(()=>de.value?`${de.value.label}...`:""),Re=D(!1),G=D(null);Ye(()=>s.location,fe=>{if(fe){const be=fe.id||"new";if(G.value!==be){G.value=be,Re.value=!0;let ne="",ye="";fe.startTime&&(ne=rc(fe.startTime)),fe.endTime&&(ye=rc(fe.endTime)),y.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:ne,endTime:ye,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ye(()=>s.show,fe=>{fe?(i.value="details",l.value=!1,h.value=[],f.value=[],m.value=[],c.value?.clearPendingChanges&&c.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(G.value=null,Re.value=!1)});const Q=fe=>{y.value=fe},ee=()=>{o("update:isDirty",!0)},Ce=()=>{l.value=!l.value,o("move-location",{isMoving:l.value,formData:{...y.value}})},Be=fe=>{h.value=fe,ee()},ze=()=>{de.value&&(i.value=de.value.value)},Ae=()=>{const fe={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:c.value?.getPendingChanges?.()||[],assignmentsToRemove:c.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:s.assignments.filter(be=>be.isPending).map(be=>({marshalId:be.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};o("save",fe)},oe=()=>{s.location&&s.location.id&&o("delete",s.location.id)},ge=fe=>{o("remove-assignment",fe)},Ne=()=>{o("open-assign-modal")},Oe=fe=>{o("select-marshal",fe)},$e=()=>{o("close")},me=(fe,be)=>{y.value[fe]=be,ee()},Ze=fe=>{o("reorder-notes",fe)},Ge=fe=>{o("reorder-checklists",fe)};return(fe,be)=>(p(),qe(Zt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:$e},{header:Ve(()=>[r("h2",zR,[H.value?(p(),g("span",{key:0,class:"modal-title-icon",innerHTML:H.value},null,8,HR)):P("",!0),Je(" "+w(te.value),1)])]),"tab-header":Ve(()=>[Ee(dl,{modelValue:i.value,"onUpdate:modelValue":be[0]||(be[0]=ne=>i.value=ne),tabs:ue.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",hO,[r("div",fO,[Y.value&&!e.lockedFromMarshal?(p(),g("button",{key:0,type:"button",onClick:oe,class:"btn btn-danger"}," Delete ")):P("",!0),!Y.value&&!Te.value?(p(),g("button",{key:1,type:"button",onClick:ze,class:"btn btn-secondary mobile-only"},w(ie.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ae,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[i.value==="details"?(p(),qe(e8,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":K.value,"area-term-plural":q.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,"onUpdate:form":Q,onInput:ee,onSave:Ae},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),i.value==="location"?(p(),qe(iD,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":Y.value,"onUpdate:form":Q,onInput:ee,onSave:Ae,onMoveLocation:Ce},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),i.value==="marshals"?(p(),qe(AD,{key:2,ref_key:"assignmentsTabRef",ref:c,form:y.value,assignments:e.assignments,"people-term":U.value,"person-term":X.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":Q,onInput:ee,onRemoveAssignment:ge,onOpenAssignModal:Ne,onSelectMarshal:Oe,onDistanceClick:I},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),i.value==="checklists"&&Y.value?(p(),qe(C1,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":be[1]||(be[1]=ne=>h.value=ne),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onChange:Be,onReorder:Ge},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):P("",!0),i.value==="checklists"?(p(),qe(yR,{key:4,modelValue:f.value,"onUpdate:modelValue":be[2]||(be[2]=ne=>f.value=ne),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="notes"&&Y.value?(p(),qe(ld,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Ze},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),i.value==="notes"?(p(),qe(UR,{key:6,modelValue:m.value,"onUpdate:modelValue":be[3]||(be[3]=ne=>m.value=ne),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="appearance"?(p(),g("div",VR,[r("div",GR,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.iconStyle}]),onClick:be[4]||(be[4]=ne=>O("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:ke.value},null,8,qR),r("span",jR,w(j.value)+" marker style",1),r("span",WR,w(M.value.iconStyle?"":""),1)],2),M.value.iconStyle?(p(),g("div",ZR,[r("p",KR," Choose a custom icon for this "+w(Z.value)+", or leave as Default to inherit from "+w(ae.value)+" or event settings. ",1),Ee(Nf,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":Pe.value.type,"inherited-style-color":Pe.value.color,"inherited-background-shape":Pe.value.backgroundShape||"","inherited-background-color":Pe.value.backgroundColor||Pe.value.color||"","inherited-border-color":Pe.value.borderColor||"","inherited-icon-color":Pe.value.iconColor||"","inherited-size":Pe.value.size||"","inherited-map-rotation":Pe.value.mapRotation??"","default-label":De.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":be[5]||(be[5]=ne=>me("styleType",ne)),"onUpdate:styleColor":be[6]||(be[6]=ne=>me("styleColor",ne)),"onUpdate:styleBackgroundShape":be[7]||(be[7]=ne=>me("styleBackgroundShape",ne)),"onUpdate:styleBackgroundColor":be[8]||(be[8]=ne=>me("styleBackgroundColor",ne)),"onUpdate:styleBorderColor":be[9]||(be[9]=ne=>me("styleBorderColor",ne)),"onUpdate:styleIconColor":be[10]||(be[10]=ne=>me("styleIconColor",ne)),"onUpdate:styleSize":be[11]||(be[11]=ne=>me("styleSize",ne)),"onUpdate:styleMapRotation":be[12]||(be[12]=ne=>me("styleMapRotation",ne))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),r("div",YR,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.terminology}]),onClick:be[13]||(be[13]=ne=>O("terminology"))},[be[17]||(be[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),be[18]||(be[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",JR,w(J.value),1),r("span",XR,w(M.value.terminology?"":""),1)],2),M.value.terminology?(p(),g("div",QR,[r("p",eO," Customise what this "+w(Z.value)+" and its "+w(U.value.toLowerCase())+" are called. ",1),r("div",tO,[r("div",nO,[r("label",null,"What is this "+w(Z.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:be[14]||(be[14]=ne=>{Q({...y.value,checkpointTerm:ne.target.value}),ee()})},[r("option",sO,"Use "+w(ae.value)+" default ("+w(j.value)+")",1),be[19]||(be[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),be[20]||(be[20]=r("option",{value:"Car"},"Car",-1)),be[21]||(be[21]=r("option",{value:"Bike"},"Bike",-1)),(p(!0),g(Se,null,je(B(ga).checkpoint,ne=>(p(),g("option",{key:ne,value:ne},w(ne),9,aO))),128))],40,oO)]),r("div",iO,[r("label",null,"What are "+w(U.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:be[15]||(be[15]=ne=>{Q({...y.value,peopleTerm:ne.target.value}),ee()})},[r("option",rO,"Use "+w(ae.value)+" default ("+w(A.value)+")",1),(p(!0),g(Se,null,je(B(ga).people,ne=>(p(),g("option",{key:ne,value:ne},w(ne),9,cO))),128))],40,lO)])])])):P("",!0)])])):P("",!0),i.value==="incidents"?(p(),g("div",uO,[r("div",dO,[(p(!0),g(Se,null,je(e.incidents,ne=>(p(),qe(kc,{key:ne.incidentId,incident:ne,onSelect:be[16]||(be[16]=ye=>fe.$emit("select-incident",ye))},null,8,["incident"]))),128))])])):P("",!0),Ee(Pf,{show:k.value,"marshal-name":E.value,"checkpoint-name":x.value,"check-in-location":C.value,"checkpoint-location":_.value,distance:$.value,"z-index":e.zIndex+100,onClose:T},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},vO=Ke(pO,[["__scopeId","data-v-221a28c2"]]),mO={class:"tab-content"},gO={key:0,class:"error-banner"},yO=["value"],kO={key:0,class:"field-error"},bO={class:"contact-row"},wO=["value"],_O={key:0,class:"field-error"},CO=["value"],LO={key:0,class:"field-error"},SO=["value"],IO={key:0,class:"field-error"},xO={key:1,class:"magic-link-section"},$O={key:0,class:"loading-text"},TO={key:1,class:"magic-link-container"},MO={class:"magic-link-row"},AO=["value"],EO={key:0,class:"error-text"},PO={key:1,class:"magic-link-actions"},DO=["disabled"],RO={key:2,class:"success-text"},OO={key:3,class:"error-text"},NO={key:2,class:"error-text"},BO={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(""),f=D(!1),m=D(!1),y=D(""),k=D(!1),b=D(!1),I=D(!1),T=D(""),E=D(!1),x=(O,A)=>{o("update:form",{...s.form,[O]:A}),o("input")},C=async()=>{if(!(!s.eventId||!s.marshalId)){m.value=!0,y.value="";try{const O=await _s.getMagicLink(s.eventId,s.marshalId);h.value=O.data.magicLink,f.value=O.data.hasEmail}catch(O){console.error("Failed to fetch magic link:",O),y.value="Failed to load login link"}finally{m.value=!1}}},_=D(""),$=async()=>{_.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(O){console.warn("Clipboard API failed, trying fallback:",O)}try{const O=document.createElement("textarea");O.value=h.value,O.style.position="fixed",O.style.left="-9999px",O.style.top="0",document.body.appendChild(O),O.focus(),O.select();const A=document.execCommand("copy");document.body.removeChild(O),A?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(_.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{_.value=""},4e3))}catch(O){console.error("Fallback copy failed:",O),_.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{_.value=""},4e3)}},R=async()=>{if(!(!s.eventId||!s.marshalId)){b.value=!0,I.value=!1,T.value="";try{await _s.sendMagicLink(s.eventId,s.marshalId),I.value=!0,setTimeout(()=>{I.value=!1},3e3)}catch(O){console.error("Failed to send email:",O),T.value=O.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ye(()=>s.marshalId,O=>{O?C():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:O=>{cn(()=>{const U={name:i,email:l,phoneNumber:c,notes:d}[O];U?.value&&(U.value.focus(),U.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(O,A)=>(p(),g("div",mO,[e.validationErrors.general?(p(),g("div",gO,w(e.validationErrors.general),1)):P("",!0),r("div",{class:le(["form-group",{"has-error":e.validationErrors.name}])},[A[7]||(A[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:A[0]||(A[0]=U=>x("name",U.target.value)),type:"text",required:"",class:le(["form-input",{"input-error":e.validationErrors.name}])},null,42,yO),e.validationErrors.name?(p(),g("span",kO,w(e.validationErrors.name),1)):P("",!0)],2),r("div",bO,[r("div",{class:le(["form-group contact-email",{"has-error":e.validationErrors.email}])},[A[8]||(A[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:A[1]||(A[1]=U=>x("email",U.target.value)),type:"email",class:le(["form-input",{"input-error":e.validationErrors.email}])},null,42,wO),e.validationErrors.email?(p(),g("span",_O,w(e.validationErrors.email),1)):P("",!0)],2),r("div",{class:le(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[A[9]||(A[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:c,value:e.form.phoneNumber,onInput:A[2]||(A[2]=U=>x("phoneNumber",U.target.value)),type:"tel",class:le(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,CO),e.validationErrors.phoneNumber?(p(),g("span",LO,w(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),r("div",{class:le(["form-group",{"has-error":e.validationErrors.notes}])},[A[10]||(A[10]=r("label",null,"Additional details",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:A[3]||(A[3]=U=>x("notes",U.target.value)),class:le(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,SO),e.validationErrors.notes?(p(),g("span",IO,w(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(p(),g("div",xO,[A[12]||(A[12]=r("label",null,"Login link",-1)),A[13]||(A[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(p(),g("div",$O,"Loading link...")):h.value?(p(),g("div",TO,[r("div",MO,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:A[4]||(A[4]=U=>U.target.select())},null,40,AO),r("button",{type:"button",class:"btn btn-secondary",onClick:$},w(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:A[5]||(A[5]=U=>E.value=!0),title:"Show QR code"},[...A[11]||(A[11]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6c3801fd><rect x="3" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="3" y="14" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="14" width="3" height="3" data-v-6c3801fd></rect><rect x="19" y="14" width="2" height="2" data-v-6c3801fd></rect><rect x="14" y="19" width="2" height="2" data-v-6c3801fd></rect><rect x="19" y="19" width="2" height="2" data-v-6c3801fd></rect></svg>',1)])])]),_.value?(p(),g("p",EO,w(_.value),1)):P("",!0),f.value?(p(),g("div",PO,[r("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:R},w(b.value?"Sending...":"Send via email"),9,DO)])):P("",!0),I.value?(p(),g("p",RO,"Email sent successfully!")):P("",!0),T.value?(p(),g("p",OO,w(T.value),1)):P("",!0)])):y.value?(p(),g("div",NO,w(y.value),1)):P("",!0)])):P("",!0),Ee(Ff,{show:E.value,url:h.value,title:"Scan to log in",onClose:A[6]||(A[6]=U=>E.value=!1)},null,8,["show","url"])]))}},FO=Ke(BO,[["__scopeId","data-v-6c3801fd"]]),UO={class:"card-header"},zO={class:"checkpoint-name-row"},HO=["innerHTML"],VO={class:"checkpoint-name"},GO={key:0,class:"checkpoint-description"},qO={key:0,class:"card-areas"},jO={key:1,class:"card-check-in"},WO={key:0,class:"check-in-time"},ZO={key:0,class:"check-in-method"},KO={key:1,class:"unsaved-indicator"},YO={key:2,class:"card-locked"},JO={class:"locked-badge"},XO={key:3,class:"card-badge"},QO={key:4,class:"card-badge"},eN={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=z(()=>s.location?s.location.areaIds||s.location.AreaIds||[]:[]),l=z(()=>i.value.map(E=>{const x=s.areas.find(C=>C.id===E);return x?x.name:null}).filter(Boolean)),c=z(()=>i.value.map(E=>{const x=s.areas.find(C=>C.id===E);return x?x.color:"#999"})),d=z(()=>{if(!s.location)return"#667eea";const E=s.location,x=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor;if(x)return x;if(i.value.length>0){const C=s.areas.find(_=>_.id===i.value[0]);if(C)return C.color}return"#667eea"}),h=z(()=>{if(!s.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const E=s.location,x=E.resolvedStyleType||E.ResolvedStyleType,C=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor,_=E.resolvedStyleBorderColor||E.ResolvedStyleBorderColor,$=E.resolvedStyleIconColor||E.ResolvedStyleIconColor,R=E.resolvedStyleBackgroundShape||E.ResolvedStyleBackgroundShape;return x&&x!=="default"||C||_||$||R&&R!=="circle"?zn({type:x||"circle",backgroundShape:R||"circle",backgroundColor:C||"#667eea",borderColor:_||"#ffffff",iconColor:$||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=E=>E?new Date(E).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=z(()=>{const{checkedInBy:E,checkInMethod:x,marshalName:C}=s.assignment;return E&&E!==C?E:x||""}),y=z(()=>{const{checkInLatitude:E,checkInLongitude:x}=s.assignment,C=s.location;return!E||!x||!C?.latitude||!C?.longitude?null:al(E,x,C.latitude,C.longitude)}),k=z(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),b=z(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),I=()=>{!s.assignment.isPending&&!s.isMarkedForRemoval&&!s.isLocked&&o("click",s.assignment)},T=()=>{o("distance-click",s.assignment)};return(E,x)=>(p(),g("div",{class:le(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:tt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",UO,[r("div",{class:"card-title",onClick:I},[r("span",zO,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,HO),r("span",VO,w(e.assignment.locationName),1),e.assignment.locationDescription?(p(),g("span",GO,"  "+w(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:x[0]||(x[0]=ct(C=>E.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:x[1]||(x[1]=ct(C=>E.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(p(),g("div",qO,[(p(!0),g(Se,null,je(l.value,(C,_)=>(p(),g("span",{key:_,class:"area-badge",style:tt({backgroundColor:c.value[_]})},w(C),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(p(),g("div",jO,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:x[2]||(x[2]=C=>E.$emit("toggle-check-in",e.assignment))},[...x[3]||(x[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",WO,[Je(w(f(e.assignment.checkInTime))+" ",1),m.value?(p(),g("span",ZO,"("+w(m.value)+")",1)):P("",!0),k.value?(p(),g("span",{key:1,class:le(["check-in-distance",b.value]),onClick:ct(T,["stop"])},w(k.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",KO," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(p(),g("div",YO,[r("span",JO,"Viewing from this "+w(B(n).checkpoint),1)])):P("",!0),e.assignment.isPending?(p(),g("div",XO,[...x[4]||(x[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",QO,[...x[5]||(x[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},tN=Ke(eN,[["__scopeId","data-v-d3de6925"]]),nN={class:"tab-content"},oN={key:0,class:"read-only-notice"},sN={class:"section-title"},aN={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},iN={value:""},lN=["value"],rN={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:n}){const{termsLower:s}=ht(),o=e,i=n,{pendingCheckInChanges:l,getEffectiveCheckInStatus:c,handleToggleCheckIn:d}=_1(()=>i("input")),h=D(""),f=D(new Set),m=z(()=>o.assignments?.length||0),y=U=>o.allLocations&&o.allLocations.find(F=>F.id===U)||null,k=z(()=>[...o.assignments].sort((U,F)=>(U.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=U=>f.value.has(U),I=U=>{U.isPending||i("select-checkpoint",U)},T=D(!1),E=D(null),x=U=>{c(U)?(E.value=U,T.value=!0):d(U)},C=()=>{E.value&&d(E.value),T.value=!1,E.value=null},_=()=>{T.value=!1,E.value=null},$=z(()=>E.value?`Are you sure you want to undo ${E.value.marshalName||"this marshal"}'s check-in?`:""),R=U=>{U.isPending?i("remove-assignment",U):(f.value.add(U.id),i("input"))},M=U=>{f.value.delete(U.id),i("input")},O=z(()=>{const U=[...o.availableLocations];return U.sort((F,j)=>F.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),U}),A=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([U,F])=>({assignmentId:U,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(U,F)=>(p(),g("div",nN,[e.lockedCheckpointId?(p(),g("div",oN," Viewing from "+w(B(s).checkpoint)+" - "+w(B(s).checkpoints)+" cannot be modified here. ",1)):P("",!0),r("h3",sN,"Assigned "+w(B(s).checkpoints)+" ("+w(m.value)+")",1),Ee(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${B(s).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${B(s).person} to ${B(s).checkpoints}.`},{default:Ve(()=>[(p(!0),g(Se,null,je(k.value,j=>(p(),qe(tN,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":B(c)(j),"has-unsaved-changes":B(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b(j.id),onClick:I,onToggleCheckIn:x,onRemove:R,onUndoRemove:M,onDistanceClick:F[0]||(F[0]=Z=>U.$emit("distance-click",Z))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&O.value.length>0?(p(),g("div",aN,[r("label",null,"Assign to "+w(B(s).checkpoint),1),We(r("select",{"onUpdate:modelValue":F[1]||(F[1]=j=>h.value=j),class:"form-input",onChange:A},[r("option",iN,"Select a "+w(B(s).checkpoint)+"...",1),(p(!0),g(Se,null,je(O.value,j=>(p(),g("option",{key:j.id,value:j.id},[Je(w(j.name),1),j.description?(p(),g(Se,{key:0},[Je(" - "+w(j.description),1)],64)):P("",!0)],8,lN))),128))],544),[[Qn,h.value]])])):P("",!0),Ee(hi,{show:T.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:_},null,8,["show","message"])]))}},cN=Ke(rN,[["__scopeId","data-v-07754949"]]),uN={class:"tab-content roles-tab"},dN={key:0,class:"empty-state"},hN={class:"help-text"},fN={key:1,class:"roles-list"},pN={class:"roles-label"},vN={class:"available-roles"},mN=["onClick"],gN={class:"role-checkbox"},yN=["checked","onChange"],kN={class:"role-info"},bN={class:"role-name"},wN={__name:"MarshalRolesTab",props:{roles:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["update:roles","input"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=z(()=>s.roles||[]),l=D(new Set);Ye(()=>s.roles,f=>{l.value.size===0&&f&&f.length>0&&(l.value=new Set(f))},{immediate:!0});const c=z(()=>[...s.roleDefinitions].sort((f,m)=>{const y=l.value.has(f.roleId),k=l.value.has(m.roleId);return y!==k?y?-1:1:f.displayOrder!==m.displayOrder?(f.displayOrder||0)-(m.displayOrder||0):(f.name||"").localeCompare(m.name||"",void 0,{numeric:!0,sensitivity:"base"})})),d=z(()=>c.value),h=f=>{const m=i.value.includes(f);let y;m?y=i.value.filter(k=>k!==f):y=[...i.value,f],o("update:roles",y),o("input")};return(f,m)=>(p(),g("div",uN,[e.roleDefinitions.length===0?(p(),g("div",dN,[m[1]||(m[1]=r("p",null,"No roles have been defined for this event yet.",-1)),r("p",hN,"Create roles in the Roles tab to assign them to "+w(B(n).people)+".",1)])):(p(),g("div",fN,[r("label",pN,"Select roles for this "+w(B(n).person),1),r("div",vN,[(p(!0),g(Se,null,je(d.value,y=>(p(),g("div",{key:y.roleId,class:le(["role-option",{selected:i.value.includes(y.roleId)}]),onClick:k=>h(y.roleId)},[r("div",gN,[r("input",{type:"checkbox",checked:i.value.includes(y.roleId),onClick:m[0]||(m[0]=ct(()=>{},["stop"])),onChange:k=>h(y.roleId)},null,40,yN)]),r("div",kN,[r("span",bN,w(y.name),1)])],10,mN))),128))])]))]))}},_N=Ke(wN,[["__scopeId","data-v-f56e155c"]]),CN={class:"marshal-checklist-view"},LN={key:0,class:"loading-state"},SN={key:1,class:"error-state"},IN={key:2,class:"empty-state"},xN={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=ht(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=z(()=>l.value.map(T=>{const E=h.value.get(T.itemId),x=E!==void 0?E.complete:T.isCompleted,C=E!==void 0&&E.complete!==T.isCompleted;return{...T,localIsCompleted:x,isModified:C}})),m=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,d.value=null;try{const T=await Rt.getMarshalChecklist(o.eventId,o.marshalId);if(l.value=T.data||[],o.modelValue&&o.modelValue.length>0){const E=new Map;o.modelValue.forEach(x=>{E.set(x.itemId,{complete:x.complete,contextType:x.contextType,contextId:x.contextId})}),h.value=E}}catch(T){console.error("Failed to load checklist:",T),d.value=T.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},y=T=>{const E=h.value.get(T.itemId),x=E!==void 0?E.complete:T.isCompleted;h.value.set(T.itemId,{complete:!x,contextType:T.completionContextType,contextId:T.completionContextId}),k()},k=()=>{const T=[];for(const[E,x]of h.value.entries()){const C=l.value.find(_=>_.itemId===E);C&&x.complete!==C.isCompleted&&T.push({itemId:E,complete:x.complete,contextType:x.contextType,contextId:x.contextId})}i("update:modelValue",T),i("change",T)},b=T=>{i("reorder",T)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const T=new Map;o.modelValue.forEach(E=>{T.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),h.value=T}},loadChecklist:m}),Ye(()=>[o.eventId,o.marshalId],()=>{m()},{immediate:!0}),(T,E)=>(p(),g("div",CN,[c.value?(p(),g("div",LN," Loading checklist... ")):d.value?(p(),g("div",SN,[r("p",null,w(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(p(),g("div",IN,[r("p",null,"No checklist items for this "+w(B(s).person)+".",1)])):(p(),qe(Uf,{key:3,items:f.value,locations:e.locations,areas:e.areas,"allow-reorder":e.allowReorder,onToggleComplete:y,onReorder:b},null,8,["items","locations","areas","allow-reorder"]))]))}},$N=Ke(xN,[["__scopeId","data-v-38a322f4"]]),TN={class:"checklist-preview"},MN={class:"preview-actions"},AN={class:"preview-header"},EN={key:0,class:"add-item-form"},PN=["placeholder"],DN=["disabled"],RN={key:1,class:"pending-items"},ON={class:"item-content"},NN={class:"item-header"},BN={class:"item-text"},FN={class:"item-scope"},UN=["onClick"],zN={key:2,class:"empty-state"},HN={key:0,class:"help-text"},VN={key:3,class:"checklist-items"},GN={class:"item-content"},qN={class:"item-header"},jN={class:"item-text"},WN={class:"item-scope"},ZN=["title"],KN={key:0,class:"item-context"},YN={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,x=>{c.value=[...x]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=x=>{c.value.splice(x,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")},m=z(()=>{const x=new Set;for(const C of s.pendingLocationIds){const _=s.allLocations.find($=>$.id===C);_&&(_.areaIds||_.AreaIds||[]).forEach(R=>x.add(R))}return[...x]}),y=x=>{const C=x.scope,_=x.itemType,$=x.ids||[];return C==="SpecificPeople"&&_==="Marshal"?$.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&_==="Checkpoint"?$.includes("ALL_CHECKPOINTS")?!0:$.some(R=>s.pendingLocationIds.includes(R)):C==="OnePerCheckpoint"&&_==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>m.value.includes(R)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&_==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>m.value.includes(R)):!1},k=z(()=>s.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(C=>y(C)):!1)),b=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,EveryoneInAreas:`All in ${n.value.areas}`,OnePerArea:`One per ${n.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${n.value.area}`})[x]||x,I=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const C=x.scopeConfigurations.find($=>y($));if(!C)return b(x.scopeConfigurations[0].scope);const _=C.ids||[];return _.includes("ALL_MARSHALS")?"Everyone":_.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:_.includes("ALL_AREAS")?`All ${n.value.areas}`:b(C.scope)},T=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const C=x.scopeConfigurations.find($=>y($));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${n.value.checkpoints}`,OnePerCheckpoint:`One person at each ${n.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${n.value.areas}`,OnePerArea:`One person in each ${n.value.area} needs to complete this`,EveryAreaLead:`This item is for ${n.value.area} leads only`,OneLeadPerArea:`One ${n.value.area} lead needs to complete this`}[C.scope]||""},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const C=x.scopeConfigurations.find(R=>y(R));if(!C)return null;const _=C.itemType,$=C.ids||[];if($.includes("ALL_MARSHALS")||$.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(_==="Checkpoint"){const R=s.allLocations.filter(M=>$.includes(M.id)&&s.pendingLocationIds.includes(M.id)).map(M=>M.name);if(R.length>0)return`At: ${R.join(", ")}`}if(_==="Area"){const R=s.areas.filter(M=>$.includes(M.id)&&m.value.includes(M.id)).map(M=>M.name);if(R.length>0)return`In: ${R.join(", ")}`}return null};return(x,C)=>(p(),g("div",TN,[r("div",MN,[r("p",AN,w(e.isEditing?`Add new ${B(n).checklist} for this ${B(n).person}:`:`${B(n).checklists} that will apply to this ${B(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=_=>i.value=!i.value)},w(i.value?"Cancel":`Add ${B(n).checklist}`),1)]),i.value?(p(),g("div",EN,[We(r("input",{"onUpdate:modelValue":C[1]||(C[1]=_=>l.value=_),type:"text",placeholder:`Enter ${B(n).checklist} text...`,class:"add-item-input",onKeyup:Qo(d,["enter"])},null,40,PN),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,DN)])):P("",!0),c.value.length>0?(p(),g("div",RN,[(p(!0),g(Se,null,je(c.value,(_,$)=>(p(),g("div",{key:`pending-${$}`,class:"checklist-item pending"},[C[3]||(C[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",ON,[r("div",NN,[r("div",BN,w(_.text),1),r("div",FN,[C[2]||(C[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:R=>h($),title:"Remove"},"  ",8,UN)])])])]))),128))])):P("",!0),!e.isEditing&&k.value.length===0&&c.value.length===0?(p(),g("div",zN,[r("p",null,"No "+w(B(n).checklists)+" will apply based on the current "+w(B(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",HN," Assign "+w(B(n).checkpoints)+" to see relevant "+w(B(n).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&k.value.length>0?(p(),g("div",VN,[(p(!0),g(Se,null,je(k.value,_=>(p(),g("div",{key:_.id,class:"checklist-item"},[C[4]||(C[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",GN,[r("div",qN,[r("div",jN,w(_.text),1),r("div",WN,[r("span",{class:"scope-pill",title:T(_)},w(I(_)),9,ZN)])]),E(_)?(p(),g("div",KN,w(E(_)),1)):P("",!0)])]))),128))])):P("",!0)]))}},JN=Ke(YN,[["__scopeId","data-v-6deaacc2"]]),XN={class:"notes-preview"},QN={class:"preview-actions"},eB={class:"preview-header"},tB={key:0,class:"add-item-form"},nB={class:"add-form-fields"},oB=["disabled"],sB={key:1,class:"pending-items"},aB={class:"note-header"},iB={class:"note-title"},lB={class:"note-actions"},rB=["onClick"],cB={key:0,class:"note-content"},uB={key:2,class:"empty-state"},dB={key:0,class:"help-text"},hB={key:3,class:"notes-list"},fB={class:"note-header"},pB={class:"note-title"},vB=["title"],mB={key:0,class:"note-content"},gB={key:1,class:"note-context"},yB={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{d.value=[...C]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=C=>{d.value.splice(C,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")},y=z(()=>{const C=new Set;for(const _ of s.pendingLocationIds){const $=s.allLocations.find(R=>R.id===_);$&&($.areaIds||$.AreaIds||[]).forEach(M=>C.add(M))}return[...C]}),k=C=>{const _=C.scope,$=C.itemType,R=C.ids||[];return _==="SpecificPeople"&&$==="Marshal"?R.includes("ALL_MARSHALS"):_==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(M=>s.pendingLocationIds.includes(M)):_==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>y.value.includes(M)):!1},b=z(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(_=>k(_)):!1)),I=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const _=C.scopeConfigurations.find(R=>k(R));if(!_)return I(C.scopeConfigurations[0].scope);const $=_.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:I(_.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const _=C.scopeConfigurations.find(R=>k(R));return _&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[_.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const _=C.scopeConfigurations.find(M=>k(M));if(!_)return null;const $=_.itemType,R=_.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const M=s.allLocations.filter(O=>R.includes(O.id)&&s.pendingLocationIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`At: ${M.join(", ")}`}if($==="Area"){const M=s.areas.filter(O=>R.includes(O.id)&&y.value.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,_)=>(p(),g("div",XN,[r("div",QN,[r("p",eB,w(e.isEditing?`Add new note for this ${B(n).person}:`:`Notes that will be visible to this ${B(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=$=>i.value=!i.value)},w(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",tB,[r("div",nB,[We(r("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>l.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":_[2]||(_[2]=$=>c.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,oB)])):P("",!0),d.value.length>0?(p(),g("div",sB,[(p(!0),g(Se,null,je(d.value,($,R)=>(p(),g("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",aB,[r("span",iB,w($.title||"Untitled"),1),r("div",lB,[_[3]||(_[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>f(R),title:"Remove"},"  ",8,rB)])]),$.content?(p(),g("div",cB,w($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(p(),g("div",uB,[r("p",null,"No notes will be visible based on the current "+w(B(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",dB," Assign "+w(B(n).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),g("div",hB,[(p(!0),g(Se,null,je(b.value,$=>(p(),g("div",{key:$.id,class:"note-item"},[r("div",fB,[r("span",pB,w($.title||"Untitled"),1),r("span",{class:"scope-pill",title:E($)},w(T($)),9,vB)]),$.content?(p(),g("div",mB,w($.content),1)):P("",!0),x($)?(p(),g("div",gB,w(x($)),1)):P("",!0)]))),128))])):P("",!0)]))}},kB=Ke(yB,[["__scopeId","data-v-e8e0946a"]]),bB={key:6,class:"tab-content incidents-tab"},wB={class:"incidents-list"},_B={class:"custom-footer"},CB={class:"footer-left"},LB={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3},roleDefinitions:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint","reorder-notes","reorder-checklists"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=ht(),i=e,l=n,c=D("details"),d=D(null),h=D(null),f=D(null),m=D([]),y=D([]),k=D([]),b=D([]),I=D({name:"",email:"",phoneNumber:"",notes:"",roles:[]}),T=D(!1),E=D(null),x=ee=>{E.value=ee,T.value=!0},C=()=>{T.value=!1,E.value=null},_=ee=>i.allLocations.find(Ce=>Ce.id===ee),$=z(()=>I.value.name||i.marshal?.name||""),R=z(()=>E.value&&_(E.value.locationId)?.name||""),M=z(()=>{if(!E.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce}=E.value;return!ee||!Ce?null:{lat:ee,lng:Ce}}),O=z(()=>{if(!E.value)return null;const ee=_(E.value.locationId);return!ee?.latitude||!ee?.longitude?null:{lat:ee.latitude,lng:ee.longitude}}),A=z(()=>{if(!E.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce,locationId:Be}=E.value,ze=_(Be);return!ee||!Ce||!ze?.latitude||!ze?.longitude?null:al(ee,Ce,ze.latitude,ze.longitude)}),U=z(()=>{const ee=i.isEditing?`Edit ${o.value.person}`:`Create ${o.value.person}`,Ce=I.value.name?.trim();return Ce?`${ee} - ${Ce}`:ee}),F=z(()=>{const ee=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:s.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ee.push({value:"incidents",label:"Incidents",icon:"incidents"}),ee.push({value:"roles",label:"Roles",icon:"roles"}),ee}),j=z(()=>F.value.findIndex(ee=>ee.value===c.value)),Z=z(()=>j.value===F.value.length-1),X=z(()=>Z.value?null:F.value[j.value+1]),re=z(()=>X.value?`${X.value.label}...`:""),K=z(()=>y.value.map(ee=>ee.locationId)),ae=z(()=>i.isEditing?i.assignments:y.value.map(ee=>({id:`pending-${ee.locationId}`,locationId:ee.locationId,locationName:i.allLocations.find(Ce=>Ce.id===ee.locationId)?.name||"Unknown",isPending:!0}))),q=z(()=>{if(i.isEditing)return i.availableLocations;const ee=y.value.map(Ce=>Ce.locationId);return i.allLocations.filter(Ce=>!ee.includes(Ce.id))});Ye(()=>i.marshal,ee=>{ee?I.value={name:ee.name||"",email:ee.email||"",phoneNumber:ee.phoneNumber||"",notes:ee.notes||"",roles:ee.roles||[]}:I.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}},{immediate:!0,deep:!0}),Ye(()=>i.show,ee=>{ee&&(c.value="details",m.value=[],y.value=[],k.value=[],b.value=[],i.isEditing||(I.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const Y=ee=>{I.value=ee},te=ee=>{I.value={...I.value,roles:ee}},ue=()=>{l("update:isDirty",!0)},_e=()=>{l("update:isDirty",!0)},Te=()=>{X.value&&(c.value=X.value.value)},Pe=ee=>{l("reorder-notes",ee)},De=ee=>{l("reorder-checklists",ee)},ke=()=>{const ee={...I.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:b.value};l("save",ee)},H=()=>{l("delete")},J=ee=>{!i.isEditing&&ee.isPending?y.value=y.value.filter(Ce=>Ce.locationId!==ee.locationId):l("remove-assignment",ee)},de=ee=>{i.isEditing?l("assign-to-location",ee):(y.value.push({locationId:ee}),l("update:isDirty",!0))},ie=ee=>{l("select-checkpoint",ee)},Re=()=>{l("close")};return t({switchToTab:ee=>{c.value=ee},focusField:ee=>{d.value?.focusField&&d.value.focusField(ee)}}),(ee,Ce)=>(p(),qe(Zt,{show:e.show,title:U.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:Re},{"tab-header":Ve(()=>[Ee(dl,{modelValue:c.value,"onUpdate:modelValue":Ce[0]||(Ce[0]=Be=>c.value=Be),tabs:F.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",_B,[r("div",CB,[e.isEditing&&!e.lockedCheckpointId?(p(),g("button",{key:0,type:"button",onClick:H,class:"btn btn-danger"}," Delete ")):P("",!0),!e.isEditing&&!Z.value?(p(),g("button",{key:1,type:"button",onClick:Te,class:"btn btn-secondary mobile-only"},w(re.value),1)):P("",!0)]),r("button",{type:"button",onClick:ke,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[c.value==="details"?(p(),qe(FO,{key:0,ref_key:"detailsTabRef",ref:d,form:I.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Y,onInput:ue},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),c.value==="checkpoints"?(p(),qe(cN,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:ae.value,"available-locations":q.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:ue,onRemoveAssignment:J,onAssignToLocation:de,onSelectCheckpoint:ie,onDistanceClick:x},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),c.value==="checklists"&&e.isEditing?(p(),qe($N,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":Ce[1]||(Ce[1]=Be=>m.value=Be),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,"allow-reorder":!0,onChange:_e,onReorder:De},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),c.value==="checklists"?(p(),qe(JN,{key:3,modelValue:k.value,"onUpdate:modelValue":Ce[2]||(Ce[2]=Be=>k.value=Be),"all-checklist-items":e.allChecklistItems,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="notes"&&e.isEditing?(p(),qe(ld,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Pe},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),c.value==="notes"?(p(),qe(kB,{key:5,modelValue:b.value,"onUpdate:modelValue":Ce[3]||(Ce[3]=Be=>b.value=Be),"all-notes":e.eventNotes,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="incidents"?(p(),g("div",bB,[r("div",wB,[(p(!0),g(Se,null,je(e.incidents,Be=>(p(),qe(kc,{key:Be.incidentId,incident:Be,onSelect:Ce[4]||(Ce[4]=ze=>ee.$emit("select-incident",ze))},null,8,["incident"]))),128))])])):P("",!0),c.value==="roles"?(p(),qe(_N,{key:7,roles:I.value.roles,"role-definitions":e.roleDefinitions,"onUpdate:roles":te,onInput:ue},null,8,["roles","role-definitions"])):P("",!0),Ee(Pf,{show:T.value,"marshal-name":$.value,"checkpoint-name":R.value,"check-in-location":M.value,"checkpoint-location":O.value,distance:A.value,"z-index":e.zIndex+100,onClose:C},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},SB=Ke(LB,[["__scopeId","data-v-131580b5"]]),IB={class:"locations-list"},xB={class:"conflict-actions"},$B={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=t,i=c=>{o("choice",c)},l=()=>{o("close")};return(c,d)=>(p(),qe(Zt,{show:e.show,title:`${B(n).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ve(()=>[r("div",xB,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+w(B(s).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ve(()=>[r("p",null,[r("strong",null,w(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),r("ul",IB,[(p(!0),g(Se,null,je(e.conflictData.locations,h=>(p(),g("li",{key:h},w(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},TB=Ke($B,[["__scopeId","data-v-997e8aaa"]]),MB={key:0,class:"assign-marshal-section"},AB={value:""},EB=["value"],PB=["disabled"],DB={key:1,class:"assign-marshal-section create-mode"},RB={class:"form-group"},OB={class:"form-group"},NB={class:"form-group"},BB={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D({name:"",email:"",phoneNumber:""});Ye(()=>s.show,k=>{k||(i.value=!1,l.value="",c.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&o("assign-existing",l.value)},f=()=>{c.value.name&&o("create-and-assign",{...c.value})},m=()=>{i.value=!1,c.value={name:"",email:"",phoneNumber:""}},y=()=>{o("close")};return(k,b)=>(p(),qe(Zt,{show:e.show,title:i.value?`Create new ${B(n).person}`:`Assign ${B(n).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ve(()=>[i.value?(p(),g(Se,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ve(()=>[i.value?(p(),g("div",DB,[r("h3",null,"Create new "+w(B(n).person),1),r("div",RB,[b[5]||(b[5]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":b[1]||(b[1]=I=>c.value.name=I),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",OB,[b[6]||(b[6]=r("label",null,"Email",-1)),We(r("input",{"onUpdate:modelValue":b[2]||(b[2]=I=>c.value.email=I),type:"email",class:"form-input"},null,512),[[st,c.value.email]])]),r("div",NB,[b[7]||(b[7]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":b[3]||(b[3]=I=>c.value.phoneNumber=I),type:"tel",class:"form-input"},null,512),[[st,c.value.phoneNumber]])])])):(p(),g("div",MB,[r("h3",null,"Select existing "+w(B(n).person),1),We(r("select",{"onUpdate:modelValue":b[0]||(b[0]=I=>l.value=I),class:"form-input"},[r("option",AB,"Choose a "+w(B(n).person)+"...",1),(p(!0),g(Se,null,je(e.marshals,I=>(p(),g("option",{key:I.id,value:I.id},[Je(w(I.name)+" ",1),I.assignedLocationIds&&I.assignedLocationIds.length>0?(p(),g(Se,{key:0},[Je(" (assigned to "+w(I.assignedLocationIds.length)+" "+w(I.assignedLocationIds.length>1?B(n).checkpoints:B(n).checkpoint)+") ",1)],64)):P("",!0)],8,EB))),128))],512),[[Qn,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+w(B(n).person),9,PB),b[4]||(b[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+w(B(n).person),1)]))]),_:1},8,["show","title"]))}},FB=Ke(BB,[["__scopeId","data-v-fa70b913"]]),UB={class:"shift-times-content"},zB={class:"info-text"},HB={class:"time-delta-info"},VB={class:"delta-detail"},GB={class:"delta-detail"},qB={class:"delta-summary"},jB={class:"affected-checkpoints"},WB={class:"option-selection"},ZB={class:"radio-option"},KB={class:"radio-option"},YB={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:n,termsLower:s}=ht(),o=e,i=t,l=D("shift"),c=z(()=>{const y=new Date(o.oldEventDate);return new Date(o.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const k=Math.abs(y),b=y>=0?"+":"-",I=Math.floor(k/(1e3*60*60*24)),T=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(k%(1e3*60*60)/(1e3*60)),x=[];return I>0&&x.push(`${I}d`),T>0&&x.push(`${T}h`),E>0&&x.push(`${E}m`),`${b}${x.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:c.value})},m=()=>{i("cancel")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:`Shift ${B(n).checkpoint} Times?`,size:"medium",onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},w(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ve(()=>[r("div",UB,[r("p",zB," You've changed the event date/time. Some "+w(B(s).checkpoints)+" have custom times set. ",1),r("div",HB,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",VB," Old: "+w(d(e.oldEventDate)),1),r("div",GB," New: "+w(d(e.newEventDate)),1),r("div",qB," Delta: "+w(h(c.value)),1)]),r("p",jB,[r("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?B(s).checkpoint:B(s).checkpoints),1),k[3]||(k[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),r("div",WB,[r("label",ZB,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>l.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Shift all "+w(B(s).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",KB,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>l.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Keep "+w(B(s).checkpoint)+" times unchanged",1),r("small",null,w(B(n).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},JB=Ke(YB,[["__scopeId","data-v-a6454aff"]]),XB={class:"checklist-preview"},QB={class:"preview-actions"},e9={class:"preview-header"},t9={key:0,class:"add-item-form"},n9=["placeholder"],o9=["disabled"],s9={key:1,class:"pending-items"},a9={class:"item-content"},i9={class:"item-header"},l9={class:"item-text"},r9={class:"item-scope"},c9=["onClick"],u9={key:2,class:"empty-state"},d9={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,m=>{c.value=[...m]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=m=>{c.value.splice(m,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")};return(m,y)=>(p(),g("div",XB,[r("div",QB,[r("p",e9," Add new "+w(B(n).checklist)+" for this "+w(B(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=k=>i.value=!i.value)},w(i.value?"Cancel":`Add ${B(n).checklist}`),1)]),i.value?(p(),g("div",t9,[We(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),type:"text",placeholder:`Enter ${B(n).checklist} text...`,class:"add-item-input",onKeyup:Qo(d,["enter"])},null,40,n9),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,o9)])):P("",!0),c.value.length>0?(p(),g("div",s9,[(p(!0),g(Se,null,je(c.value,(k,b)=>(p(),g("div",{key:`pending-${b}`,class:"checklist-item pending"},[y[3]||(y[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",a9,[r("div",i9,[r("div",l9,w(k.text),1),r("div",r9,[y[2]||(y[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:I=>h(b),title:"Remove"},"  ",8,c9)])])])]))),128))])):P("",!0),c.value.length===0&&!i.value?(p(),g("div",u9,[r("p",null,"No new "+w(B(n).checklists)+" to add. Click the button above to create one.",1)])):P("",!0)]))}},h9=Ke(d9,[["__scopeId","data-v-a394c400"]]),f9={class:"notes-preview"},p9={class:"preview-actions"},v9={class:"preview-header"},m9={key:0,class:"add-item-form"},g9={class:"add-form-fields"},y9=["disabled"],k9={key:1,class:"pending-items"},b9={class:"note-header"},w9={class:"note-title"},_9={class:"note-actions"},C9=["onClick"],L9={key:0,class:"note-content"},S9={key:2,class:"empty-state"},I9={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=y=>{d.value.splice(y,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")};return(y,k)=>(p(),g("div",f9,[r("div",p9,[r("p",v9," Add new note for this "+w(B(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=b=>i.value=!i.value)},w(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",m9,[r("div",g9,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>l.value=b),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=b=>c.value=b),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,y9)])):P("",!0),d.value.length>0?(p(),g("div",k9,[(p(!0),g(Se,null,je(d.value,(b,I)=>(p(),g("div",{key:`pending-${I}`,class:"note-item pending"},[r("div",b9,[r("span",w9,w(b.title||"Untitled"),1),r("div",_9,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>f(I),title:"Remove"},"  ",8,C9)])]),b.content?(p(),g("div",L9,w(b.content),1)):P("",!0)]))),128))])):P("",!0),d.value.length===0&&!i.value?(p(),g("div",S9,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):P("",!0)]))}},x9=Ke(I9,[["__scopeId","data-v-5e6bdcab"]]),$9={class:"search-section"},T9={class:"form-group"},M9={class:"suggestions-list"},A9={class:"suggestion-content"},E9={key:0,class:"suggestion-detail"},P9=["onClick"],D9={class:"suggestion-content"},R9={class:"suggestion-name"},O9={key:0,class:"suggestion-detail"},N9=["onClick"],B9={class:"suggestion-content"},F9={class:"suggestion-name"},U9={key:0,class:"suggestion-detail"},z9={key:1,class:"no-results"},H9={key:2,class:"no-results"},V9={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=D(""),l=D(null),c=z(()=>s.contacts.filter(M=>s.excludeContactIds.includes(M.contactId)&&M.marshalId).map(M=>M.marshalId)),d=z(()=>s.contacts.filter(M=>M.marshalId).map(M=>M.marshalId)),h=z(()=>s.contacts.filter(M=>!s.excludeContactIds.includes(M.contactId))),f=z(()=>s.marshals.filter(M=>!c.value.includes(M.id)&&!d.value.includes(M.id))),m=M=>M?M.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=z(()=>{const M=m(i.value);return M?M.split(" ").filter(O=>O.length>0):[]}),k=(M,O)=>{if(O.length===0)return{score:1,isPartial:!1};const A=m(M);let U=0;for(const F of O)A.includes(F)&&U++;return{score:U,isPartial:U>0&&U<O.length,isFullMatch:U===O.length}},b=z(()=>{const M=y.value,O=[];return h.value.forEach(A=>{const U=`${A.name||""} ${A.role||""}`,F=k(U,M);(M.length===0||F.score>0)&&O.push({key:`contact-${A.contactId}`,type:"contact",name:A.name,detail:A.role?R(A.role):null,data:A,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),f.value.forEach(A=>{const U=`${A.name||""} ${A.email||""}`,F=k(U,M);(M.length===0||F.score>0)&&O.push({key:`marshal-${A.id}`,type:"marshal",name:A.name,detail:A.email||A.phoneNumber||null,data:A,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),O.sort((A,U)=>U.matchScore!==A.matchScore?U.matchScore-A.matchScore:A.name.localeCompare(U.name,void 0,{sensitivity:"base"})),O}),I=z(()=>y.value.length===0?b.value:b.value.filter(M=>M.isFullMatch)),T=z(()=>y.value.length===0?[]:b.value.filter(M=>M.isPartial)),E=z(()=>T.value.length>0);Ye(()=>s.show,async M=>{M&&(i.value="",await cn(),l.value?.focus())});const x=M=>{const O=s.contacts.find(A=>A.marshalId===M.id);if(O){if(s.excludeContactIds.includes(O.contactId))return;o("select-contact",O)}else o("create-from-marshal",M)},C=M=>{o("select-contact",M)},_=()=>{o("create-new",i.value.trim())},$=()=>{o("close")},R=M=>M?M.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"";return(M,O)=>(p(),qe(Zt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:$},{actions:Ve(()=>[r("button",{onClick:$,class:"btn btn-secondary"}," Cancel ")]),default:Ve(()=>[r("div",$9,[r("div",T9,[O[1]||(O[1]=r("label",null,"Search or create",-1)),We(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":O[0]||(O[0]=A=>i.value=A),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",M9,[r("div",{class:"suggestion-item create-new",onClick:_},[O[3]||(O[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",A9,[O[2]||(O[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(p(),g("span",E9,'"'+w(i.value.trim())+'"',1)):P("",!0)])]),(p(!0),g(Se,null,je(I.value,A=>(p(),g("div",{key:A.key,class:"suggestion-item",onClick:U=>A.type==="marshal"?x(A.data):C(A.data)},[r("span",{class:le(["suggestion-icon",A.type==="marshal"?"marshal-icon":"contact-icon"])},w(A.type==="marshal"?"M":"C"),3),r("div",D9,[r("span",R9,w(A.name),1),A.detail?(p(),g("span",O9,w(A.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":A.type==="contact"}])},w(A.type==="marshal"?B(n).person:"Contact"),3)],8,P9))),128)),E.value?(p(),g(Se,{key:0},[O[4]||(O[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(p(!0),g(Se,null,je(T.value,A=>(p(),g("div",{key:A.key,class:"suggestion-item",onClick:U=>A.type==="marshal"?x(A.data):C(A.data)},[r("span",{class:le(["suggestion-icon",A.type==="marshal"?"marshal-icon":"contact-icon"])},w(A.type==="marshal"?"M":"C"),3),r("div",B9,[r("span",F9,w(A.name),1),A.detail?(p(),g("span",U9,w(A.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":A.type==="contact"}])},w(A.type==="marshal"?B(n).person:"Contact"),3)],8,N9))),128))],64)):P("",!0),i.value.trim()&&I.value.length===0&&T.value.length===0?(p(),g("div",z9," No matching "+w(B(n).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!i.value.trim()&&I.value.length===0?(p(),g("div",H9," No "+w(B(n).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},G9=Ke(V9,[["__scopeId","data-v-e25ca97b"]]),q9={class:"contact-card-header"},j9={class:"contact-name-row"},W9={key:0,class:"pin-icon",title:"Pinned"},Z9={key:1,class:"primary-badge",title:"Primary contact"},K9={class:"contact-name"},Y9={key:0,class:"contact-role"},J9={key:0,class:"emergency-indicator",title:"Shown in emergency info"},X9={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},Q9=["title"],eF={key:0,class:"contact-card-details"},tF={key:0,class:"contact-phone"},nF={key:1,class:"contact-email"},oF={key:1,class:"contact-card-notes"},sF={key:3,class:"contact-card-badge"},aF={key:4,class:"contact-card-badge"},iF={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=z(()=>{const m=new Map;for(const y of s.roleDefinitions)m.set(y.roleId,y.name),m.set(y.name,y.name);return m}),l=z(()=>s.contact.roles&&Array.isArray(s.contact.roles)&&s.contact.roles.length>0?s.contact.roles:s.contact.role?[s.contact.role]:[]),c=z(()=>{const m=s.contact.scopeConfigurations;return!m||m.length===0}),d=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&o("click",s.contact)},h=m=>{if(!m)return"";const y=i.value.get(m);return y||(m==="AreaLead"?`${n.value.area} Lead`:m.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim())},f=m=>{if(!m)return"";const y=100;return m.length<=y?m:m.substring(0,y)+"..."};return(m,y)=>(p(),g("div",{class:le(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:d},[r("div",q9,[r("div",{class:le(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",j9,[e.contact.isPinned&&!e.isMarkedForRemoval?(p(),g("span",W9,"")):P("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(p(),g("span",Z9,"")):P("",!0),r("span",K9,w(e.contact.name),1)]),l.value.length>0?(p(),g("span",Y9,w(l.value.map(h).join(", ")),1)):P("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(p(),g("span",J9,"")):P("",!0),c.value&&!e.isMarkedForRemoval&&!e.isPending?(p(),g("span",X9,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(p(),g("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:y[0]||(y[0]=ct(k=>m.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,Q9)):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:y[1]||(y[1]=ct(k=>m.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(p(),g("div",eF,[e.contact.phone?(p(),g("span",tF,w(e.contact.phone),1)):P("",!0),e.contact.email?(p(),g("span",nF,w(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(p(),g("div",oF,w(f(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(p(),qe(ol,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):P("",!0),e.isPending?(p(),g("div",sF,[...y[2]||(y[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",aF,[...y[3]||(y[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},lF=Ke(iF,[["__scopeId","data-v-9a194a03"]]),rF={class:"contact-card-wrapper"},cF={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["select","remove","undo-remove","reorder"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>[...n.contacts].sort((d,h)=>{if(d.isPinned!==h.isPinned)return d.isPinned?-1:1;const f=d.displayOrder||0,m=h.displayOrder||0;return f!==m?f-m:(d.name||"").localeCompare(h.name||"",void 0,{sensitivity:"base"})})),i=d=>typeof n.removeTitle=="function"?n.removeTitle(d):n.removeTitle,l=d=>!d.isPending,c=({changes:d})=>{s("reorder",d)};return(d,h)=>(p(),qe(bc,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[e.contacts.length>0?(p(),qe(ll,{key:0,items:o.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:c},{item:Ve(({element:f})=>[r("div",rF,[e.allowReorder?(p(),qe(rl,{key:0})):P("",!0),Ee(lF,{contact:f,"is-pending":f.isPending,"is-marked-for-removal":f.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":i(f),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:l(f),areas:e.areas,locations:e.locations,marshals:e.marshals,"role-definitions":e.roleDefinitions,onClick:m=>d.$emit("select",f),onRemove:h[0]||(h[0]=m=>d.$emit("remove",m)),onUndoRemove:h[1]||(h[1]=m=>d.$emit("undo-remove",m))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","role-definitions","onClick"])])]),_:1},8,["items","disabled","show-order-overlay"])):P("",!0)]),_:1},8,["is-empty","empty-message","empty-hint"]))}},uF=Ke(cF,[["__scopeId","data-v-4c025463"]]),dF={key:0,class:"tab-content"},hF={class:"form-group"},fF=["disabled"],pF={class:"form-group"},vF={key:1,class:"tab-content"},mF={class:"boundary-section"},gF={key:0,class:"boundary-preview"},yF={class:"boundary-actions"},kF={key:2,class:"tab-content"},bF={class:"contacts-header"},wF={class:"section-title"},_F={key:3,class:"tab-content"},CF={class:"section-title"},LF={key:4,class:"placeholder-message"},SF={key:7,class:"placeholder-message"},IF={key:10,class:"placeholder-message"},xF={key:11,class:"tab-content appearance-tab"},$F={class:"accordion-item"},TF=["innerHTML"],MF={class:"accordion-title"},AF={class:"accordion-arrow"},EF={key:0,class:"accordion-content"},PF={class:"section-description"},DF={class:"color-picker"},RF=["title","onClick"],OF={class:"accordion-item"},NF=["innerHTML"],BF={class:"accordion-title"},FF={class:"accordion-arrow"},UF={key:0,class:"accordion-content"},zF={class:"section-description"},HF={class:"accordion-item"},VF={class:"accordion-title"},GF={class:"accordion-preview"},qF={class:"accordion-arrow"},jF={key:0,class:"accordion-content"},WF={class:"section-description"},ZF={class:"form-group"},KF={value:""},YF=["value"],JF={class:"accordion-item"},XF={class:"accordion-title"},QF={class:"accordion-preview"},e7={class:"accordion-arrow"},t7={key:0,class:"accordion-content"},n7={class:"section-description"},o7={class:"form-group"},s7={value:""},a7=["value"],i7={key:12,class:"tab-content incidents-tab"},l7={class:"incidents-list"},r7={class:"custom-footer"},c7={class:"footer-left"},mm="edit_area_accordion",u7={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident","reorder-notes","reorder-checklists","reorder-contacts"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=ht(),i=()=>$.value.peopleTerm?$.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(ne=!0)=>{const ye=$.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",He=i();return ne?Zy("checkpoint",ye,He):Wi("checkpoint",ye,He)},c=(ne=!0)=>l(ne).toLowerCase(),d=e,h=n,f=D("details"),m=D(null),y=D([]),k=D({}),b=D({}),I=D(!1),T=D(!1),E=D([]),x=D([]),C=D([]),_=D([]),$=D({name:"",description:"",color:tu,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>({name:"",description:"",color:SL(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),M=()=>d.eventId?`${mm}_${d.eventId}`:mm,O=D({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});un(()=>{const ne=localStorage.getItem(M());if(ne)try{const ye=JSON.parse(ne);O.value={...O.value,...ye}}catch{}});const A=ne=>{O.value[ne]=!O.value[ne],localStorage.setItem(M(),JSON.stringify(O.value))},U=z(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${$.value.color||tu}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),F=z(()=>{const ne=$.value.checkpointStyleType!=="default"||$.value.checkpointStyleBackgroundShape||$.value.checkpointStyleBackgroundColor||$.value.checkpointStyleBorderColor||$.value.checkpointStyleIconColor||$.value.checkpointStyleSize,ye=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!ne&&!ye)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const He=$.value.checkpointStyleType&&$.value.checkpointStyleType!=="default"?$.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",rt=$.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",kt=$.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Ot=$.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Lt=$.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",xt=$.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return zn({type:He!=="default"?He:rt,backgroundShape:rt,backgroundColor:kt,borderColor:Ot,iconColor:Lt,size:xt,outputSize:24})}),j=z(()=>d.area&&d.area.id),Z=z(()=>!$.value.polygon||$.value.polygon.length===0?[]:$.value.polygon.map((ne,ye)=>({id:`polygon-point-${ye}`,latitude:ne.lat,longitude:ne.lng}))),X=z(()=>d.area?.id?d.areas.filter(ne=>ne.id!==d.area.id).map(ne=>({...ne,color:"#999999"})):d.areas.map(ne=>({...ne,color:"#999999"})));z(()=>ue.value.map(ne=>ne.id));const re=z(()=>{const ne=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&ne.push({value:"incidents",label:"Incidents",icon:"incidents"}),ne}),K=z(()=>re.value.findIndex(ne=>ne.value===f.value)),ae=z(()=>K.value===re.value.length-1),q=z(()=>ae.value?null:re.value[K.value+1]),Y=z(()=>q.value?`${q.value.label}...`:""),te=z(()=>{if(!d.area||!d.area.id)return[];const ne=d.checkpoints.filter(ye=>ye.areaIds&&ye.areaIds.includes(d.area.id)).map(ye=>ye.id);return d.assignments.filter(ye=>ne.includes(ye.locationId))}),ue=z(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(ne=>ne.areaIds&&ne.areaIds.includes(d.area.id))),_e=z(()=>{const ne=[...ue.value];return ne.sort((ye,He)=>{const rt=ye.name.match(/^(\d+)/),kt=He.name.match(/^(\d+)/);if(rt&&kt){const Ot=parseInt(rt[1]),Lt=parseInt(kt[1]);if(Ot!==Lt)return Ot-Lt}return ye.name.localeCompare(He.name,void 0,{numeric:!0,sensitivity:"base"})}),ne}),Te=z(()=>!d.area||!d.area.id?[]:d.contacts.filter(ne=>ne.scopeConfigurations?ne.scopeConfigurations.some(ye=>ye.scope==="EveryoneInAreas"&&ye.itemType==="Area"?ye.ids?.includes("ALL_AREAS")?!0:ye.ids?.includes(d.area.id):!1):!1)),Pe=z(()=>{const ne=new Set(Te.value.map(rt=>rt.contactId)),ye=Te.value.map(rt=>({...rt,isPending:!1,isExisting:!0,isMarkedForRemoval:x.value.includes(rt.contactId)})),He=E.value.filter(rt=>!ne.has(rt.contactId)).map(rt=>({...rt,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...ye,...He].sort((rt,kt)=>rt.name.localeCompare(kt.name,void 0,{sensitivity:"base"}))}),De=z(()=>{const ne=Te.value.map(He=>He.contactId),ye=E.value.map(He=>He.contactId);return[...ne,...ye]}),ke=async ne=>{if(!(k.value[ne]||b.value[ne])){b.value[ne]=!0;try{const He=(await Rt.getCheckpointChecklist(d.eventId,ne)).data||[];k.value[ne]={total:He.length,completed:He.filter(rt=>rt.isCompleted).length}}catch(ye){console.error("Failed to load checklist status for checkpoint:",ne,ye),k.value[ne]={total:0,completed:0}}finally{b.value[ne]=!1}}};Ye(()=>d.area,ne=>{if(ne){const ye=ne.polygon?typeof ne.polygon=="string"?JSON.parse(ne.polygon):ne.polygon:[];$.value={name:ne.name||"",description:ne.description||"",color:ne.color||tu,displayOrder:ne.displayOrder||0,isDefault:ne.isDefault||!1,polygon:ye,checkpointStyleType:ne.checkpointStyleType||"default",checkpointStyleColor:ne.checkpointStyleColor||"",checkpointStyleBackgroundShape:ne.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:ne.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:ne.checkpointStyleBorderColor||"",checkpointStyleIconColor:ne.checkpointStyleIconColor||"",checkpointStyleSize:ne.checkpointStyleSize||"",checkpointStyleMapRotation:ne.checkpointStyleMapRotation??"",peopleTerm:ne.peopleTerm||"",checkpointTerm:ne.checkpointTerm||""}}else $.value=R()},{immediate:!0,deep:!0}),Ye(()=>d.show,ne=>{ne&&(f.value=d.initialTab||"details",y.value=[],k.value={},b.value={},E.value=[],x.value=[],C.value=[],_.value=[],T.value=!1,j.value||($.value=R()),m.value?.resetLocalState&&m.value.resetLocalState())}),Ye(f,ne=>{ne==="checkpoints"&&d.area&&d.area.id&&ue.value.forEach(ye=>{setTimeout(()=>ke(ye.id),0)})});const H=()=>{h("update:isDirty",!0)},J=ne=>{$.value.color=ne,H()},de=(ne,ye)=>{$.value[ne]=ye,H()},ie=()=>{h("draw-boundary",$.value)},Re=ne=>{$.value.polygon=ne,H()},G=()=>{$.value.polygon=[],I.value=!1,H()},Q=ne=>{T.value=!1,h("create-contact-from-marshal",{marshal:ne,area:d.area})},ee=ne=>{T.value=!1,h("create-new-contact",{name:ne,area:d.area})},Ce=ne=>{E.value.find(ye=>ye.contactId===ne.contactId)||(E.value.push(ne),H()),T.value=!1},Be=ne=>{E.value=E.value.filter(ye=>ye.contactId!==ne),H()},ze=ne=>{x.value.includes(ne)||(x.value.push(ne),H())},Ae=ne=>ne.isPending?"Remove pending contact":`Remove from ${o.value.area}`,oe=ne=>{Pe.value.find(He=>He.contactId===ne)?.isPending?Be(ne):ze(ne)},ge=ne=>{x.value=x.value.filter(ye=>ye!==ne),H()},Ne=ne=>{y.value=ne,H()},Oe=()=>{q.value&&(f.value=q.value.value)},$e=ne=>{h("reorder-notes",ne)},me=ne=>{h("reorder-checklists",ne)},Ze=ne=>{h("reorder-contacts",ne)},Ge=()=>{const ne=d.area?{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,displayOrder:$.value.displayOrder,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:E.value||[],contactsToRemove:x.value||[],pendingNewChecklistItems:C.value||[],pendingNewNotes:_.value||[]}:{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,pendingContacts:E.value||[]};h("save",ne)},fe=()=>{h("delete",d.area.id)},be=()=>{h("close")};return t({addPendingContact:ne=>{ne&&!E.value.find(ye=>ye.contactId===ne.contactId)&&(E.value.push(ne),H())},removeContactById:ne=>{const ye=E.value.some(He=>He.contactId===ne);E.value=E.value.filter(He=>He.contactId!==ne),x.value=x.value.filter(He=>He!==ne),ye&&H()}}),(ne,ye)=>(p(),qe(Zt,{show:e.show,title:e.area&&e.area.id?`Edit ${B(o).area}: ${e.area.name}`:`Create new ${B(o).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:be},{"tab-header":Ve(()=>[Ee(dl,{modelValue:f.value,"onUpdate:modelValue":ye[0]||(ye[0]=He=>f.value=He),tabs:re.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",r7,[r("div",c7,[j.value&&!$.value.isDefault?(p(),g("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete ")):P("",!0),!j.value&&!ae.value?(p(),g("button",{key:1,type:"button",onClick:Oe,class:"btn btn-secondary mobile-only"},w(Y.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ge,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[f.value==="details"?(p(),g("div",dF,[r("form",{onSubmit:ct(Ge,["prevent"])},[r("div",hF,[ye[27]||(ye[27]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":ye[1]||(ye[1]=He=>$.value.name=He),type:"text",required:"",class:"form-input",disabled:$.value.isDefault,onInput:H},null,40,fF),[[st,$.value.name]])]),r("div",pF,[ye[28]||(ye[28]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":ye[2]||(ye[2]=He=>$.value.description=He),class:"form-input",rows:"3",onInput:H},null,544),[[st,$.value.description]])])],32)])):P("",!0),f.value==="boundary"?(p(),g("div",vF,[r("div",mF,[$.value.polygon&&$.value.polygon.length>0?(p(),g("div",gF,[Ee(il,{mode:"edit-polygon","editing-polygon":$.value.polygon,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,locations:e.checkpoints,areas:X.value,"all-locations-for-bounds":Z.value,height:"300px",onPolygonUpdate:Re},null,8,["editing-polygon","route","route-color","route-style","route-weight","locations","areas","all-locations-for-bounds"]),ye[29]||(ye[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),r("div",yF,[!$.value.polygon||$.value.polygon.length===0?(p(),g("button",{key:0,onClick:ie,class:"btn btn-primary btn-full"}," Draw on map ")):(p(),g(Se,{key:1},[r("button",{onClick:ie,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:ye[3]||(ye[3]=He=>I.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Ee(hi,{show:I.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:G,onCancel:ye[4]||(ye[4]=He=>I.value=!1)},null,8,["show"]),f.value==="contacts"?(p(),g("div",kF,[r("div",bF,[r("h3",wF,w(B(s).area)+" contacts ("+w(Pe.value.length)+")",1),r("button",{onClick:ye[5]||(ye[5]=He=>T.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ee(uF,{contacts:Pe.value,"show-remove-button":!0,"remove-title":Ae,"empty-message":`No contacts assigned to this ${B(o).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${B(o).people} in this ${B(o).area}.`,"allow-reorder":j.value,"role-definitions":e.roleDefinitions,onSelect:ye[6]||(ye[6]=He=>ne.$emit("edit-contact",He)),onRemove:oe,onUndoRemove:ge,onReorder:Ze},null,8,["contacts","empty-message","empty-hint","allow-reorder","role-definitions"])])):P("",!0),Ee(G9,{show:T.value,"area-name":$.value.name||"this "+B(o).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":De.value,onClose:ye[7]||(ye[7]=He=>T.value=!1),onSelectContact:Ce,onCreateFromMarshal:Q,onCreateNew:ee},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(p(),g("div",_F,[r("h3",CF,w(l())+" in "+w(e.area?.name)+" ("+w(ue.value.length)+")",1),Ee(g1,{checkpoints:_e.value,areas:e.areas,"empty-message":`No ${c()} in this ${B(o).area} yet.`,onSelect:ye[8]||(ye[8]=He=>ne.$emit("select-checkpoint",He))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),f.value==="checkpoints"&&!j.value?(p(),g("div",LF,[r("p",null,w(l())+" will be automatically assigned based on boundaries after the "+w(B(o).area)+" is created.",1)])):P("",!0),f.value==="checklists"&&j.value?(p(),qe(C1,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":ye[9]||(ye[9]=He=>y.value=He),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:te.value,marshals:e.marshals,"allow-reorder":!0,onChange:Ne,onReorder:me},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):P("",!0),f.value==="checklists"&&j.value?(p(),qe(h9,{key:6,modelValue:C.value,"onUpdate:modelValue":ye[10]||(ye[10]=He=>C.value=He),onChange:H},null,8,["modelValue"])):P("",!0),f.value==="checklists"&&!j.value?(p(),g("div",SF,[r("p",null,w(B(s).checklists)+" can be assigned after the "+w(B(o).area)+" is created.",1)])):P("",!0),f.value==="notes"&&j.value?(p(),qe(ld,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals,"allow-reorder":!0,onReorder:$e},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),f.value==="notes"&&j.value?(p(),qe(x9,{key:9,modelValue:_.value,"onUpdate:modelValue":ye[11]||(ye[11]=He=>_.value=He),onChange:H},null,8,["modelValue"])):P("",!0),f.value==="notes"&&!j.value?(p(),g("div",IF,[r("p",null,"Notes can be viewed after the "+w(B(o).area)+" is created.",1)])):P("",!0),f.value==="appearance"?(p(),g("div",xF,[r("div",$F,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.polygonColor}]),onClick:ye[12]||(ye[12]=He=>A("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:U.value},null,8,TF),r("span",MF,w(B(s).area)+" polygon colour",1),r("span",AF,w(O.value.polygonColor?"":""),1)],2),O.value.polygonColor?(p(),g("div",EF,[r("p",PF," Choose a colour for this "+w(B(o).area)+"'s boundary on the map. ",1),r("div",DF,[(p(!0),g(Se,null,je(B(Un),He=>(p(),g("div",{key:He.hex,class:le(["color-swatch",{selected:$.value.color===He.hex}]),style:tt({backgroundColor:He.hex}),title:He.name,onClick:rt=>J(He.hex)},null,14,RF))),128))])])):P("",!0)]),r("div",OF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.iconStyle}]),onClick:ye[13]||(ye[13]=He=>A("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:F.value},null,8,NF),r("span",BF,w(l(!1))+" marker style",1),r("span",FF,w(O.value.iconStyle?"":""),1)],2),O.value.iconStyle?(p(),g("div",UF,[r("p",zF," Set a default marker style for all "+w(c())+" in this "+w(B(o).area)+". Individual "+w(c())+" can override this setting. ",1),Ee(Nf,{"style-type":$.value.checkpointStyleType||"default","style-color":$.value.checkpointStyleColor||"","style-background-shape":$.value.checkpointStyleBackgroundShape||"","style-background-color":$.value.checkpointStyleBackgroundColor||"","style-border-color":$.value.checkpointStyleBorderColor||"","style-icon-color":$.value.checkpointStyleIconColor||"","style-size":$.value.checkpointStyleSize||"","style-map-rotation":$.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":ye[14]||(ye[14]=He=>de("checkpointStyleType",He)),"onUpdate:styleColor":ye[15]||(ye[15]=He=>de("checkpointStyleColor",He)),"onUpdate:styleBackgroundShape":ye[16]||(ye[16]=He=>de("checkpointStyleBackgroundShape",He)),"onUpdate:styleBackgroundColor":ye[17]||(ye[17]=He=>de("checkpointStyleBackgroundColor",He)),"onUpdate:styleBorderColor":ye[18]||(ye[18]=He=>de("checkpointStyleBorderColor",He)),"onUpdate:styleIconColor":ye[19]||(ye[19]=He=>de("checkpointStyleIconColor",He)),"onUpdate:styleSize":ye[20]||(ye[20]=He=>de("checkpointStyleSize",He)),"onUpdate:styleMapRotation":ye[21]||(ye[21]=He=>de("checkpointStyleMapRotation",He))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),r("div",HF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.peopleTerm}]),onClick:ye[22]||(ye[22]=He=>A("peopleTerm"))},[ye[30]||(ye[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",VF,w(i())+" terminology",1),r("span",GF,w($.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",qF,w(O.value.peopleTerm?"":""),1)],2),O.value.peopleTerm?(p(),g("div",jF,[r("p",WF," Choose what "+w(i().toLowerCase())+" are called in this "+w(B(o).area)+". This will be inherited by "+w(c())+" unless they override it. ",1),r("div",ZF,[ye[31]||(ye[31]=r("label",null,"What are people called?",-1)),We(r("select",{"onUpdate:modelValue":ye[23]||(ye[23]=He=>$.value.peopleTerm=He),class:"form-input",onChange:H},[r("option",KF,"Use event default ("+w(e.eventPeopleTerm)+")",1),(p(!0),g(Se,null,je(B(ga).people,He=>(p(),g("option",{key:He,value:He},w(He),9,YF))),128))],544),[[Qn,$.value.peopleTerm]])])])):P("",!0)]),r("div",JF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.checkpointTerm}]),onClick:ye[24]||(ye[24]=He=>A("checkpointTerm"))},[ye[32]||(ye[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",XF,w(l(!1))+" terminology",1),r("span",QF,w($.value.checkpointTerm?B(Wh)($.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",e7,w(O.value.checkpointTerm?"":""),1)],2),O.value.checkpointTerm?(p(),g("div",t7,[r("p",n7," Choose what "+w(c())+" are called in this "+w(B(o).area)+". ",1),r("div",o7,[r("label",null,"What are "+w(c())+" called?",1),We(r("select",{"onUpdate:modelValue":ye[25]||(ye[25]=He=>$.value.checkpointTerm=He),class:"form-input",onChange:H},[r("option",s7,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(p(!0),g(Se,null,je(B(ga).checkpoint,He=>(p(),g("option",{key:He,value:He},w(B(Wh)(He,i())),9,a7))),128))],544),[[Qn,$.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),f.value==="incidents"?(p(),g("div",i7,[r("div",l7,[(p(!0),g(Se,null,je(e.incidents,He=>(p(),qe(kc,{key:He.incidentId,incident:He,onSelect:ye[26]||(ye[26]=rt=>ne.$emit("select-incident",rt))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},d7=Ke(u7,[["__scopeId","data-v-562b692e"]]),h7=["innerHTML"],f7={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const n=t,s=()=>{n("close")};return(o,i)=>(p(),qe(Zt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:s},{actions:Ve(()=>[r("button",{onClick:s,class:"btn btn-primary"},w(e.okText),1)]),default:Ve(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,h7)]),_:1},8,["show","title"]))}},wc=Ke(f7,[["__scopeId","data-v-a6e7148c"]]),p7={class:"tab-content"},v7={class:"form-group"},m7={for:"text"},g7=["placeholder"],y7={key:0,class:"checkbox-label-inline create-separate-items"},k7={key:0,class:"form-group link-to-checkin"},b7={class:"checkbox-label-inline"},w7={class:"help-text"},_7={key:1,class:"form-group link-to-checkin-warning"},C7={class:"help-text warning"},L7={class:"tab-content"},S7={class:"custom-footer"},I7={class:"footer-left"},x7={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},nextDisplayOrder:{type:Number,default:0}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:n,termsSentence:s}=ht(),o=e,i=t,l=D(!1),c=D(""),d=D("details"),h=D({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1}),f=z(()=>!!o.checklistItem),m=z(()=>{const O=h.value.scopeConfigurations.filter(A=>A.scope&&(A.ids?.length>0||A.scope==="Everyone"||A.scope==="EveryoneAtCheckpoints"||A.scope==="SpecificPeople"));return O.length===0?!1:O.every(A=>A.scope==="EveryoneAtCheckpoints"||A.scope==="SpecificPeople")}),y=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=z(()=>y.findIndex(O=>O.value===d.value)),b=z(()=>k.value===y.length-1),I=z(()=>b.value?"":y[k.value+1]?.label||"");Ye(()=>o.show,O=>{O&&(d.value=o.initialTab,o.checklistItem?h.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?T(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?T(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?T(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1,linksToCheckIn:o.checklistItem.linksToCheckIn||!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.nextDisplayOrder,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1},i("update:isDirty",!1))});const T=O=>{if(!O)return null;const A=new Date(O),U=A.getTimezoneOffset();return new Date(A.getTime()-U*60*1e3).toISOString().slice(0,16)},E=O=>O?new Date(O).toISOString():null,x=()=>{i("update:isDirty",!0)},C=()=>{i("close")},_=()=>{b.value||(d.value=y[k.value+1].value)},$=O=>{c.value=O,l.value=!0},R=()=>{if(!h.value.text||!h.value.text.trim()){$(`Please enter ${n.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){$("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(U=>!(U.itemType!==null&&(!U.ids||U.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const A={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:E(h.value.visibleFrom),visibleUntil:E(h.value.visibleUntil),mustCompleteBy:E(h.value.mustCompleteBy),linksToCheckIn:h.value.linksToCheckIn};f.value||(A.createSeparateItems=h.value.createSeparateItems),i("save",A)},M=()=>{i("delete",o.checklistItem.itemId)};return(O,A)=>(p(),g(Se,null,[Ee(Zt,{show:e.show,title:f.value?`Edit ${B(n).checklist}`:`Create ${B(n).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":Ve(()=>[Ee(dl,{modelValue:d.value,"onUpdate:modelValue":A[0]||(A[0]=U=>d.value=U),tabs:y},null,8,["modelValue"])]),footer:Ve(()=>[r("div",S7,[r("div",I7,[f.value?(p(),g("button",{key:0,type:"button",onClick:M,class:"btn btn-danger"}," Delete ")):P("",!0),!f.value&&!b.value?(p(),g("button",{key:1,type:"button",onClick:_,class:"btn btn-secondary mobile-only"},w(I.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(R,["prevent"]),class:"checklist-form"},[We(r("div",p7,[r("div",v7,[r("label",m7,w(B(s).checklist)+" text: *",1),We(r("textarea",{id:"text","onUpdate:modelValue":A[1]||(A[1]=U=>h.value.text=U),onInput:x,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${B(n).checklists}, one per line...`:`Enter the ${B(n).checklist} text...`},null,40,g7),[[st,h.value.text]]),f.value?P("",!0):(p(),g("label",y7,[We(r("input",{type:"checkbox","onUpdate:modelValue":A[2]||(A[2]=U=>h.value.createSeparateItems=U),onChange:x},null,544),[[Ms,h.value.createSeparateItems]]),A[6]||(A[6]=r("span",null,"Each line creates a new item",-1))]))]),m.value?(p(),g("div",k7,[r("label",b7,[We(r("input",{type:"checkbox","onUpdate:modelValue":A[3]||(A[3]=U=>h.value.linksToCheckIn=U),onChange:x},null,544),[[Ms,h.value.linksToCheckIn]]),A[7]||(A[7]=r("span",null,"Link to check-in status",-1))]),r("p",w7," Completing this "+w(B(n).checklist)+" will check the "+w(B(n).person)+" in at the "+w(B(n).checkpoint)+". Checking in will complete this "+w(B(n).checklist)+". ",1)])):h.value.linksToCheckIn?(p(),g("div",_7,[r("p",C7,[A[8]||(A[8]=r("strong",null,"Note:",-1)),Je(' Link to check-in is currently enabled but the visibility settings are incompatible. Change visibility to "Everyone at specific '+w(B(n).checkpoints)+'" or "Specific '+w(B(n).people)+'" to use this feature. ',1)])])):P("",!0)],512),[[os,d.value==="details"]]),We(r("div",L7,[Ee(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":A[4]||(A[4]=U=>h.value.scopeConfigurations=U),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:x},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[os,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(wc,{show:l.value,title:"Validation error",message:c.value,onClose:A[5]||(A[5]=U=>l.value=!1)},null,8,["show","message"])],64))}},$7=Ke(x7,[["__scopeId","data-v-6f300b9a"]]),T7={class:"tab-content"},M7={class:"form-group"},A7={class:"form-group"},E7={class:"form-row"},P7={class:"form-group"},D7={class:"checkbox-label-inline show-emergency-checkbox"},R7={class:"form-group"},O7={class:"form-row"},N7={class:"form-group"},B7={class:"form-group checkbox-group-inline"},F7={class:"checkbox-label-inline"},U7={class:"tab-content"},z7={class:"custom-footer"},H7={class:"footer-left"},V7={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D("details"),c=D({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=_=>_==="Urgent"||_==="Emergency",h=z(()=>!!n.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],m=z(()=>f.findIndex(_=>_.value===l.value)),y=z(()=>m.value===f.length-1),k=z(()=>y.value?"":f[m.value+1]?.label||"");Ye(()=>n.show,_=>{_&&(l.value=n.initialTab,n.note?c.value={title:n.note.title||"",content:n.note.content||"",scopeConfigurations:n.note.scopeConfigurations?JSON.parse(JSON.stringify(n.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:n.note.displayOrder||0,priority:n.note.priority||"Normal",category:n.note.category||"",isPinned:n.note.isPinned||!1,showInEmergencyInfo:n.note.showInEmergencyInfo??d(n.note.priority)}:c.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},s("update:isDirty",!1))}),Ye(()=>c.value.priority,(_,$)=>{!h.value&&_!==$&&(d(_)?c.value.showInEmergencyInfo=!0:d($)&&(c.value.showInEmergencyInfo=!1))});const b=()=>{s("update:isDirty",!0)},I=()=>{s("close")},T=()=>{y.value||(l.value=f[m.value+1].value)},E=_=>{i.value=_,o.value=!0},x=()=>{if(!c.value.title||!c.value.title.trim()){E("Please enter a note title");return}if(!c.value.scopeConfigurations||c.value.scopeConfigurations.length===0){E("Please select at least one visibility scope");return}if(!c.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){E("Please configure at least one scope with valid selections");return}const $={title:c.value.title.trim(),content:c.value.content||"",scopeConfigurations:c.value.scopeConfigurations,displayOrder:c.value.displayOrder||0,priority:c.value.priority||"Normal",category:c.value.category?.trim()||null,isPinned:c.value.isPinned||!1,showInEmergencyInfo:c.value.showInEmergencyInfo};s("save",$)},C=()=>{s("delete",n.note.noteId)};return(_,$)=>(p(),g(Se,null,[Ee(Zt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:I},{"tab-header":Ve(()=>[Ee(dl,{modelValue:l.value,"onUpdate:modelValue":$[0]||($[0]=R=>l.value=R),tabs:f},null,8,["modelValue"])]),footer:Ve(()=>[r("div",z7,[r("div",H7,[h.value?(p(),g("button",{key:0,type:"button",onClick:C,class:"btn btn-danger"}," Delete ")):P("",!0),!h.value&&!y.value?(p(),g("button",{key:1,type:"button",onClick:T,class:"btn btn-secondary mobile-only"},w(k.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:x,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(x,["prevent"]),class:"note-form"},[We(r("div",T7,[r("div",M7,[$[10]||($[10]=r("label",{for:"title"},"Title: *",-1)),We(r("input",{id:"title","onUpdate:modelValue":$[1]||($[1]=R=>c.value.title=R),type:"text",onInput:b,required:"",placeholder:"Enter note title..."},null,544),[[st,c.value.title]])]),r("div",A7,[$[11]||($[11]=r("label",{for:"content"},"Content:",-1)),We(r("textarea",{id:"content","onUpdate:modelValue":$[2]||($[2]=R=>c.value.content=R),onInput:b,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,c.value.content]])]),r("div",E7,[r("div",P7,[$[14]||($[14]=r("label",{for:"priority"},"Priority:",-1)),We(r("select",{id:"priority","onUpdate:modelValue":$[3]||($[3]=R=>c.value.priority=R),onChange:b},[...$[12]||($[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[Qn,c.value.priority]]),r("label",D7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[4]||($[4]=R=>c.value.showInEmergencyInfo=R),onChange:b},null,544),[[Ms,c.value.showInEmergencyInfo]]),$[13]||($[13]=r("span",null,"Show in emergency info",-1))])]),r("div",R7,[$[15]||($[15]=r("label",{for:"category"},"Category:",-1)),We(r("input",{id:"category","onUpdate:modelValue":$[5]||($[5]=R=>c.value.category=R),type:"text",onInput:b,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,c.value.category]])])]),r("div",O7,[r("div",N7,[$[16]||($[16]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":$[6]||($[6]=R=>c.value.displayOrder=R),type:"number",onInput:b,min:"0"},null,544),[[st,c.value.displayOrder,void 0,{number:!0}]]),$[17]||($[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",B7,[r("label",F7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[7]||($[7]=R=>c.value.isPinned=R),onChange:b},null,544),[[Ms,c.value.isPinned]]),$[18]||($[18]=r("span",null,"Pin to top",-1))]),$[19]||($[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[os,l.value==="details"]]),We(r("div",U7,[Ee(id,{modelValue:c.value.scopeConfigurations,"onUpdate:modelValue":$[8]||($[8]=R=>c.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:b},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[os,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(wc,{show:o.value,title:"Validation error",message:i.value,onClose:$[9]||($[9]=R=>o.value=!1)},null,8,["show","message"])],64))}},G7=Ke(V7,[["__scopeId","data-v-e8488047"]]),q7={class:"incident-detail-header"},j7={class:"header-title-row"},W7={class:"modal-title"},Z7={class:"header-badges"},K7=["disabled"],Y7={key:0,class:"status-dropdown-menu"},J7=["onClick","disabled"],X7={key:0,class:"incident-detail-content"},Q7={class:"accordion-section"},eU={class:"accordion-arrow"},tU={key:0,class:"accordion-content"},nU={class:"description-text"},oU={class:"accordion-section"},sU={class:"accordion-arrow"},aU={key:0,class:"accordion-content"},iU={class:"info-grid"},lU={class:"info-item"},rU={class:"info-value"},cU={class:"info-item"},uU={class:"info-value"},dU={key:0,class:"info-item"},hU={class:"info-label"},fU={class:"info-value"},pU={key:1,class:"info-item"},vU={class:"info-label"},mU={class:"info-value"},gU={key:2,class:"info-item"},yU={class:"info-value"},kU={key:0,class:"incident-map-container"},bU={class:"accordion-section"},wU={class:"accordion-preview"},_U={class:"accordion-arrow"},CU={key:0,class:"accordion-content"},LU={class:"reporter-info"},SU={class:"reporter-name"},IU={key:0,class:"accordion-section"},xU={class:"accordion-title"},$U={class:"accordion-preview"},TU={class:"accordion-arrow"},MU={key:0,class:"accordion-content"},AU={class:"marshals-list"},EU={class:"marshal-name"},PU={key:0,class:"checkin-badge success"},DU={key:1,class:"checkin-badge not-checked-in"},RU={class:"accordion-section"},OU={key:0,class:"accordion-preview"},NU={class:"accordion-arrow"},BU={key:0,class:"accordion-content"},FU={key:0,class:"notes-timeline"},UU={class:"note-header"},zU={class:"note-author"},HU={class:"note-time"},VU={key:0,class:"note-status-change"},GU={key:1,class:"note-text"},qU={key:1,class:"no-notes"},jU={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:n,termsSentence:s}=ht(),o=e,i=t,l=D(!1),c=D(!1),d=D(null),h=D({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ye(()=>o.show,U=>{U&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},c.value=!1)});const f=U=>{d.value&&!d.value.contains(U.target)&&(c.value=!1)};Ye(c,U=>{U?document.addEventListener("click",f):document.removeEventListener("click",f)});const m=()=>{c.value=!c.value},y=U=>{o.incident?.status!==U&&(c.value=!1,A(U))},k=U=>{const F=h.value[U];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),F||(h.value[U]=!0)},b=z(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),I=z(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),T=z(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),E=z(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const U=o.incident.description||"";return U.length<=50?U:U.substring(0,47)+"..."}),x=z(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((F,j)=>(F.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),C=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],_=U=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[U]||U,$=U=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[U]||U,R=U=>{if(!U)return"";let F=U.name||"";if(U.description){const j=U.description,Z=40,X=j.length>Z?j.substring(0,Z-3)+"...":j;F+=` - ${X}`}return F},M=U=>U?new Date(U).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",O=U=>{if(!U)return"";const F=new Date(U),Z=new Date-F,X=Math.floor(Z/6e4),re=Math.floor(Z/36e5),K=Math.floor(Z/864e5);return X<1?"just now":X<60?`${X}m ago`:re<24?`${re}h ago`:K<7?`${K}d ago`:F.toLocaleDateString()},A=async U=>{if(o.incident?.status!==U){l.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:U})}finally{l.value=!1}}};return(U,F)=>(p(),qe(Zt,{show:e.show,title:E.value,size:"large",onClose:F[7]||(F[7]=j=>U.$emit("close"))},{header:Ve(()=>[r("div",q7,[r("div",j7,[r("span",{class:le(["severity-indicator",e.incident?.severity])},null,2),r("h2",W7,w(E.value),1)]),r("div",Z7,[r("span",{class:le(["severity-badge",e.incident?.severity])},w(_(e.incident?.severity)),3),e.canManage?(p(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:le(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:m,disabled:l.value},[Je(w($(e.incident?.status))+" ",1),F[8]||(F[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,K7),c.value?(p(),g("div",Y7,[(p(),g(Se,null,je(C,j=>r("button",{key:j.value,type:"button",class:le(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Z=>y(j.value),disabled:e.incident?.status===j.value},[r("span",{class:le(["status-dot",j.value])},null,2),Je(" "+w(j.label),1)],10,J7)),64))])):P("",!0)],512)):(p(),g("span",{key:1,class:le(["status-badge",e.incident?.status])},w($(e.incident?.status)),3))])])]),footer:Ve(()=>[r("button",{class:"btn btn-secondary",onClick:F[6]||(F[6]=j=>U.$emit("close"))},"Close")]),default:Ve(()=>[e.incident?(p(),g("div",X7,[r("div",Q7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.description}]),onClick:F[0]||(F[0]=j=>k("description"))},[F[9]||(F[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",eU,w(h.value.description?"":""),1)],2),h.value.description?(p(),g("div",tU,[r("p",nU,w(e.incident.description),1)])):P("",!0)]),r("div",oU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.timeLocation}]),onClick:F[1]||(F[1]=j=>k("timeLocation"))},[F[10]||(F[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",sU,w(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(p(),g("div",aU,[r("div",iU,[r("div",lU,[F[11]||(F[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",rU,w(M(e.incident.incidentTime)),1)]),r("div",cU,[F[12]||(F[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",uU,w(M(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(p(),g("div",dU,[r("span",hU,w(B(s).checkpoint),1),r("span",fU,w(R(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(p(),g("div",pU,[r("span",vU,w(B(s).area),1),r("span",mU,w(e.incident.area.areaName),1)])):P("",!0),b.value?(p(),g("div",gU,[F[13]||(F[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",yU,w(e.incident.latitude.toFixed(6))+", "+w(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),b.value?(p(),g("div",kU,[Ee(il,{locations:e.checkpoints,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:I.value,zoom:15,"user-location":T.value,height:"200px"},null,8,["locations","route","route-color","route-style","route-weight","center","user-location"])])):P("",!0)])):P("",!0)]),r("div",bU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.reporter}]),onClick:F[2]||(F[2]=j=>k("reporter"))},[F[14]||(F[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",wU,w(e.incident.reportedBy?.name||"Unknown"),1),r("span",_U,w(h.value.reporter?"":""),1)],2),h.value.reporter?(p(),g("div",CU,[r("div",LU,[r("span",SU,w(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),x.value.length?(p(),g("div",IU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.marshals}]),onClick:F[3]||(F[3]=j=>k("marshals"))},[r("span",xU,w(B(n).peoplePlural)+" at "+w(B(n).checkpoint.toLowerCase()),1),r("span",$U,w(x.value.length),1),r("span",TU,w(h.value.marshals?"":""),1)],2),h.value.marshals?(p(),g("div",MU,[r("div",AU,[(p(!0),g(Se,null,je(x.value,j=>(p(),g("div",{key:j.marshalId,class:le(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",EU,w(j.name),1),j.wasCheckedIn?(p(),g("span",PU," Checked in "+w(O(j.checkInTime)),1)):(p(),g("span",DU," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),r("div",RU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.notes}]),onClick:F[4]||(F[4]=j=>k("notes"))},[F[15]||(F[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(p(),g("span",OU,w(e.incident.updates.length),1)):P("",!0),r("span",NU,w(h.value.notes?"":""),1)],2),h.value.notes?(p(),g("div",BU,[e.incident.updates?.length?(p(),g("div",FU,[(p(!0),g(Se,null,je(e.incident.updates,(j,Z)=>(p(),g("div",{key:Z,class:"note-item"},[r("div",UU,[r("span",zU,w(j.authorName||"System"),1),r("span",HU,w(O(j.timestamp)),1)]),j.statusChange?(p(),g("div",VU,[F[16]||(F[16]=Je(" Status changed to ",-1)),r("span",{class:le(["status-badge",j.statusChange])},w($(j.statusChange)),3)])):j.note?(p(),g("p",GU,w(j.note),1)):P("",!0)]))),128))])):(p(),g("div",qU," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:F[5]||(F[5]=j=>U.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},L1=Ke(jU,[["__scopeId","data-v-cc8f343d"]]),WU={class:"form-group"},ZU={class:"form-group"},KU={class:"form-row"},YU={class:"form-group form-group-half"},JU=["value"],XU={class:"form-group form-group-half"},QU={key:0,class:"form-group"},ez={for:"checkpoint",class:"form-label"},tz=["value"],nz={key:1,class:"form-group"},oz={class:"form-label"},sz={class:"checkpoint-toggle"},az={class:"checkbox-label"},iz={class:"checkpoint-name"},lz={key:0,class:"checkpoint-description"},rz={class:"form-group"},cz={class:"location-options"},uz={class:"location-buttons"},dz={key:0,class:"location-status"},hz={key:0,class:"location-getting"},fz={key:1,class:"location-display"},pz={key:0,class:"location-accuracy"},vz={key:2,class:"location-error"},mz={key:1,class:"map-picker-container"},gz={key:0,class:"map-picker-hint"},yz={key:2,class:"location-display"},kz={key:2,class:"error-message"},bz={class:"modal-actions"},wz=["disabled"],_z={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:n}=ht(),s=e,o=t,i=D({title:"",description:"",severity:"medium",incidentTime:""}),l=D(""),c=D(!0),d=D("none"),h=D(!1),f=D(null),m=D(null),y=D(null),k=D(!1),b=D(!1),I=D(null),T=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],E=()=>{const j=new Date,Z=j.getFullYear(),X=String(j.getMonth()+1).padStart(2,"0"),re=String(j.getDate()).padStart(2,"0"),K=String(j.getHours()).padStart(2,"0"),ae=String(j.getMinutes()).padStart(2,"0");return`${Z}-${X}-${re}T${K}:${ae}`},x=j=>j?new Date(j).toISOString():null,C=z(()=>s.checkpoints||[]),_=z(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=C.value.find(Z=>Z.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.initialLocation?.latitude!=null)return{lat:s.initialLocation.latitude,lng:s.initialLocation.longitude};if(s.checkpoint?.latitude!=null)return{lat:s.checkpoint.latitude,lng:s.checkpoint.longitude};if(C.value.length>0){const j=C.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.route?.length>0){const j=s.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),$=z(()=>i.value.description.trim()!==""),R=z(()=>i.value.description.trim()!=="");Ye(()=>s.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:E()},l.value="",c.value=!0,b.value=!1,I.value=null,y.value=null,f.value=null,m.value=null,s.initialLocation&&s.initialLocation.latitude!=null?(f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},m.value=s.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),s.checkpoint&&(l.value=s.checkpoint.locationId||s.checkpoint.id||""))});const M=j=>{y.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,m.value=null):j==="gps"?(d.value="gps",h.value=!1,A()):(d.value="none",h.value=!1,f.value=null,m.value=null)},O=j=>{f.value={latitude:j.lat,longitude:j.lng},m.value=null,h.value=!1},A=()=>{if(s.initialLocation&&s.initialLocation.latitude!=null){f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},m.value=s.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},m.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},U=async()=>{if(!(!R.value||b.value)){b.value=!0,I.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let Z=null,X=!1;C.value.length>0?l.value?Z=l.value:X=!0:s.checkpoint&&(c.value?Z=s.checkpoint.locationId||s.checkpoint.id||null:X=!0);const re={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:x(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:Z,skipCheckpointAutoAssign:X};o("submit",re)}catch(j){I.value=j.message||"Failed to report incident. Please try again.",b.value=!1}}},F=()=>{o("close")};return(j,Z)=>(p(),qe(Zt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":$.value,onClose:F},{footer:Ve(()=>[r("div",bz,[r("button",{type:"button",class:"btn btn-secondary",onClick:F}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:U,disabled:!R.value||b.value},w(b.value?"Reporting...":"Report Incident"),9,wz)])]),default:Ve(()=>[r("form",{onSubmit:ct(U,["prevent"]),class:"incident-form"},[r("div",WU,[Z[10]||(Z[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),We(r("input",{id:"title","onUpdate:modelValue":Z[0]||(Z[0]=X=>i.value.title=X),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),r("div",ZU,[Z[11]||(Z[11]=r("label",{for:"description",class:"form-label"},[Je("Description "),r("span",{class:"required"},"*")],-1)),We(r("textarea",{id:"description","onUpdate:modelValue":Z[1]||(Z[1]=X=>i.value.description=X),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),r("div",KU,[r("div",YU,[Z[12]||(Z[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),We(r("select",{id:"severity","onUpdate:modelValue":Z[2]||(Z[2]=X=>i.value.severity=X),class:"form-input form-select"},[(p(),g(Se,null,je(T,X=>r("option",{key:X.value,value:X.value},w(X.label),9,JU)),64))],512),[[Qn,i.value.severity]])]),r("div",XU,[Z[13]||(Z[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),We(r("input",{id:"incidentTime","onUpdate:modelValue":Z[3]||(Z[3]=X=>i.value.incidentTime=X),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),C.value.length>0?(p(),g("div",QU,[r("label",ez,w(B(n).checkpoint),1),We(r("select",{id:"checkpoint","onUpdate:modelValue":Z[4]||(Z[4]=X=>l.value=X),class:"form-input form-select"},[Z[14]||(Z[14]=r("option",{value:""},"-- None / Unknown --",-1)),(p(!0),g(Se,null,je(C.value,X=>(p(),g("option",{key:X.id,value:X.id},w(X.name)+w(X.description?` - ${X.description}`:""),9,tz))),128))],512),[[Qn,l.value]])])):e.checkpoint?(p(),g("div",nz,[r("label",oz,w(B(n).checkpoint),1),r("div",sz,[r("label",az,[We(r("input",{type:"checkbox","onUpdate:modelValue":Z[5]||(Z[5]=X=>c.value=X)},null,512),[[Ms,c.value]]),r("span",iz,w(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",lz," - "+w(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),r("div",rz,[Z[15]||(Z[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",cz,[r("div",uz,[r("button",{type:"button",class:le(["location-btn",{active:d.value==="gps"}]),onClick:Z[6]||(Z[6]=X=>M("gps"))}," GPS ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="map"}]),onClick:Z[7]||(Z[7]=X=>M("map"))}," Pick on map ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="none"}]),onClick:Z[8]||(Z[8]=X=>M("none"))}," None ",2)]),d.value==="gps"?(p(),g("div",dz,[k.value?(p(),g("div",hz," Getting location... ")):f.value&&f.value.latitude!=null?(p(),g("div",fz,[r("span",null,w(f.value.latitude.toFixed(5))+", "+w(f.value.longitude.toFixed(5)),1),m.value?(p(),g("span",pz,"("+w(Math.round(m.value))+"m)",1)):P("",!0)])):y.value?(p(),g("div",vz,w(y.value),1)):P("",!0)])):P("",!0),d.value==="map"?(p(),g("div",mz,[h.value?(p(),g("div",gz,"Tap to select location")):P("",!0),h.value?(p(),qe(il,{key:1,locations:C.value,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:_.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:O},null,8,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id"])):P("",!0),f.value&&f.value.latitude!=null?(p(),g("div",yz,[r("span",null,w(f.value.latitude.toFixed(5))+", "+w(f.value.longitude.toFixed(5)),1),h.value?P("",!0):(p(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:Z[9]||(Z[9]=X=>h.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),I.value?(p(),g("div",kz,w(I.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},S1=Ke(_z,[["__scopeId","data-v-8a211d20"]]),Cz={class:"tab-content"},Lz={key:0,class:"form-group"},Sz={for:"marshalId"},Iz=["value"],xz={class:"help-text"},$z={key:1,class:"form-group"},Tz={class:"linked-marshal-info"},Mz={class:"linked-marshal-name"},Az={class:"linked-marshal-hint"},Ez={key:2,class:"form-group"},Pz={class:"form-group"},Dz={key:0,class:"selected-roles"},Rz=["onClick"],Oz={class:"role-input-group"},Nz=["value"],Bz={class:"checkbox-label-inline show-emergency-checkbox"},Fz={class:"form-row"},Uz={class:"form-group"},zz={class:"form-group"},Hz={class:"form-group"},Vz={class:"form-row"},Gz={class:"form-group"},qz={class:"form-group checkbox-group-inline"},jz={class:"checkbox-label-inline"},Wz={class:"tab-content"},Zz={class:"custom-footer"},Kz={class:"footer-left"},Yz=["disabled"],Jz={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D("details"),d=D(""),h=D({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=z(()=>[...s.roleDefinitions].sort((X,re)=>X.isBuiltIn!==re.isBuiltIn?X.isBuiltIn?-1:1:X.displayOrder!==re.displayOrder?(X.displayOrder||0)-(re.displayOrder||0):(X.name||"").localeCompare(re.name||"",void 0,{numeric:!0,sensitivity:"base"}))),m=z(()=>{const X=h.value.roles||[];return f.value.filter(re=>!X.includes(re.roleId))}),y=X=>s.roleDefinitions.find(K=>K.roleId===X)?.name||X,k=X=>s.roleDefinitions.find(K=>K.roleId===X)?.name==="EmergencyContact",b=()=>{d.value&&!h.value.roles.includes(d.value)&&(h.value.roles.push(d.value),k(d.value)&&(h.value.showInEmergencyInfo=!0),M()),d.value=""},I=X=>{const re=h.value.roles.indexOf(X);re>-1&&(h.value.roles.splice(re,1),k(X)&&!h.value.roles.some(K=>k(K))&&(h.value.showInEmergencyInfo=!1),M())},T=z(()=>!!s.contact),E=z(()=>s.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),x=z(()=>!!h.value.marshalId),C=z(()=>!T.value&&!!s.prefilledMarshalId),_=z(()=>T.value&&!!s.contact?.marshalId),$=z(()=>s.contact?.marshalId?s.marshals.find(re=>re.id===s.contact.marshalId)?.name||"Unknown":""),R=z(()=>[...s.marshals].sort((X,re)=>es(X.name,re.name)));Ye(()=>s.show,X=>{if(X){if(c.value=s.initialTab,d.value="",s.contact){let re=[];s.contact.roles&&Array.isArray(s.contact.roles)&&(re=[...s.contact.roles]),h.value={roles:re,name:s.contact.name||"",phone:s.contact.phone||"",email:s.contact.email||"",notes:s.contact.notes||"",marshalId:s.contact.marshalId||null,showInEmergencyInfo:s.contact.showInEmergencyInfo??re.some(K=>k(K)),displayOrder:s.contact.displayOrder||0,isPinned:s.contact.isPinned||!1,scopeConfigurations:s.contact.scopeConfigurations?JSON.parse(JSON.stringify(s.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{let re;s.createFromAreaContext?re=[]:s.preselectedArea?re=[{scope:"EveryoneInAreas",itemType:"Area",ids:[s.preselectedArea.id]}]:re=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let K={name:s.prefilledName||"",phone:"",email:"",roles:[]};if(s.prefilledMarshalId){const ae=s.marshals.find(q=>q.id===s.prefilledMarshalId);ae&&(K={name:ae.name||"",phone:ae.phoneNumber||"",email:ae.email||"",roles:ae.roles||[]})}h.value={roles:[...K.roles],name:K.name,phone:K.phone,email:K.email,notes:"",marshalId:s.prefilledMarshalId||null,showInEmergencyInfo:K.roles.some(ae=>k(ae)),displayOrder:0,isPinned:!1,scopeConfigurations:re}}o("update:isDirty",!1)}});const M=()=>{o("update:isDirty",!0)},O=()=>{if(h.value.marshalId){const X=s.marshals.find(re=>re.id===h.value.marshalId);X&&(h.value.name=X.name,!h.value.phone&&X.phoneNumber&&(h.value.phone=X.phoneNumber),!h.value.email&&X.email&&(h.value.email=X.email),h.value.roles=X.roles?[...X.roles]:[],h.value.showInEmergencyInfo=h.value.roles.some(re=>k(re)))}else h.value.name="";M()},A=()=>{o("close")},U=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}c.value="visibility"},F=X=>{l.value=X,i.value=!0},j=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}if(!s.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){F("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(K=>!(K.itemType!==null&&(!K.ids||K.ids.length===0)))){F("Please configure at least one scope with valid selections");return}}const X={roles:h.value.roles,name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};o("save",X)},Z=()=>{o("delete",s.contact.contactId)};return(X,re)=>(p(),g(Se,null,[Ee(Zt,{show:e.show,title:T.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:A},{"tab-header":Ve(()=>[Ee(dl,{modelValue:c.value,"onUpdate:modelValue":re[0]||(re[0]=K=>c.value=K),tabs:E.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",Zz,[r("div",Kz,[T.value?(p(),g("button",{key:0,type:"button",onClick:Z,class:"btn btn-danger"}," Delete ")):P("",!0),!T.value&&c.value==="details"?(p(),g("button",{key:1,type:"button",onClick:U,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),r("button",{type:"button",onClick:j,class:"btn btn-success",disabled:T.value&&!e.isDirty}," Save ",8,Yz)])]),default:Ve(()=>[r("form",{onSubmit:ct(j,["prevent"]),class:"contact-form"},[We(r("div",Cz,[!C.value&&!_.value?(p(),g("div",Lz,[r("label",Sz,"Link to "+w(B(n).person.toLowerCase())+":",1),We(r("select",{id:"marshalId","onUpdate:modelValue":re[1]||(re[1]=K=>h.value.marshalId=K),onChange:O},[re[12]||(re[12]=r("option",{value:null},"-- Not linked --",-1)),(p(!0),g(Se,null,je(R.value,K=>(p(),g("option",{key:K.id,value:K.id},w(K.name),9,Iz))),128))],544),[[Qn,h.value.marshalId]]),r("span",xz,"Optionally link to an existing "+w(B(n).person.toLowerCase())+" in the system",1)])):P("",!0),_.value?(p(),g("div",$z,[r("label",null,"Linked "+w(B(n).person.toLowerCase())+":",1),r("div",Tz,[r("span",Mz,w($.value),1),r("span",Az,"Contact details are synced with this "+w(B(n).person.toLowerCase()),1)])])):P("",!0),x.value?P("",!0):(p(),g("div",Ez,[re[13]||(re[13]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":re[2]||(re[2]=K=>h.value.name=K),type:"text",onInput:M,placeholder:"Contact name..."},null,544),[[st,h.value.name]])])),r("div",Pz,[re[16]||(re[16]=r("label",null,"Roles: *",-1)),h.value.roles.length>0?(p(),g("div",Dz,[(p(!0),g(Se,null,je(h.value.roles,K=>(p(),g("span",{key:K,class:"role-pill"},[Je(w(y(K))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:ae=>I(K),title:"Remove role"},"",8,Rz)]))),128))])):P("",!0),r("div",Oz,[We(r("select",{id:"role","onUpdate:modelValue":re[3]||(re[3]=K=>d.value=K),onChange:b},[re[14]||(re[14]=r("option",{value:"",disabled:""},"Add a role...",-1)),(p(!0),g(Se,null,je(m.value,K=>(p(),g("option",{key:K.roleId,value:K.roleId},w(K.name),9,Nz))),128))],544),[[Qn,d.value]])]),r("label",Bz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[4]||(re[4]=K=>h.value.showInEmergencyInfo=K),onChange:M},null,544),[[Ms,h.value.showInEmergencyInfo]]),re[15]||(re[15]=r("span",null,"Show in emergency info",-1))])]),r("div",Fz,[r("div",Uz,[re[17]||(re[17]=r("label",{for:"phone"},"Phone:",-1)),We(r("input",{id:"phone","onUpdate:modelValue":re[5]||(re[5]=K=>h.value.phone=K),type:"tel",onInput:M,placeholder:"Phone number..."},null,544),[[st,h.value.phone]])]),r("div",zz,[re[18]||(re[18]=r("label",{for:"email"},"Email:",-1)),We(r("input",{id:"email","onUpdate:modelValue":re[6]||(re[6]=K=>h.value.email=K),type:"email",onInput:M,placeholder:"Email address..."},null,544),[[st,h.value.email]])])]),r("div",Hz,[re[19]||(re[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":re[7]||(re[7]=K=>h.value.notes=K),onInput:M,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,h.value.notes]])]),r("div",Vz,[r("div",Gz,[re[20]||(re[20]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":re[8]||(re[8]=K=>h.value.displayOrder=K),type:"number",onInput:M,min:"0"},null,544),[[st,h.value.displayOrder,void 0,{number:!0}]]),re[21]||(re[21]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",qz,[r("label",jz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[9]||(re[9]=K=>h.value.isPinned=K),onChange:M},null,544),[[Ms,h.value.isPinned]]),re[22]||(re[22]=r("span",null,"Pin to top",-1))]),re[23]||(re[23]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[os,c.value==="details"]]),We(r("div",Wz,[Ee(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":re[10]||(re[10]=K=>h.value.scopeConfigurations=K),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":T.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:M},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[os,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(wc,{show:i.value,title:"Validation error",message:l.value,onClose:re[11]||(re[11]=K=>i.value=!1)},null,8,["show","message"])],64))}},Xz=Ke(Jz,[["__scopeId","data-v-300a990f"]]),Qz={class:"tab-content"},eH={class:"form-group"},tH={class:"form-group"},nH={class:"form-group checkbox-group"},oH={class:"checkbox-label"},sH={class:"checkbox-text"},aH={class:"help-text"},iH={class:"tab-content"},lH={key:0,class:"loading-state"},rH={key:1,class:"empty-state"},cH={key:2,class:"people-list"},uH={class:"search-row"},dH={class:"people-items"},hH=["checked","onChange"],fH={class:"person-name"},pH={class:"person-type-badge marshal"},vH={key:0,class:"empty-search"},mH={class:"custom-footer"},gH={class:"footer-left"},yH={__name:"EditRoleDefinitionModal",props:{show:{type:Boolean,default:!1},role:{type:Object,default:null},initialTab:{type:String,default:"details"},people:{type:Array,default:()=>[]},loadingPeople:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty","load-people"],setup(e,{emit:t}){const{terms:n}=ht(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D(new Map),h=D([]),f=D({marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set}),m=[{value:"details",label:"Details"},{value:"assignments",label:"Assignments"}],y=D(s.initialTab),k=D({name:"",notes:"",canManageAreaCheckpoints:!1}),b=z(()=>!!s.role?.roleId);Ye(()=>[s.show,s.role],([A,U])=>{A&&(y.value=s.initialTab,c.value="",d.value=new Map,h.value=[],f.value={marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set},U?k.value={name:U.name||"",notes:U.notes||"",canManageAreaCheckpoints:U.canManageAreaCheckpoints||!1}:k.value={name:"",notes:"",canManageAreaCheckpoints:!1},o("update:isDirty",!1))},{immediate:!0}),Ye(y,A=>{A==="assignments"&&b.value&&s.people.length===0&&o("load-people",s.role.roleId)}),Ye(()=>s.people,A=>{if(A.length>0&&(h.value=A.map(U=>({...U})),d.value.size===0)){const U=new Map;for(const F of A)U.set(F.id,F.hasRole);d.value=U}},{immediate:!0});const I=()=>{o("update:isDirty",!0)},T=A=>A==="Linked"?"Linked":A==="Marshal"?n.value.person:A==="Contact"?"Contact":A,E=z(()=>{let A=[...h.value];if(c.value.trim()){const U=c.value.toLowerCase();A=A.filter(F=>F.name.toLowerCase().includes(U))}return A.sort((U,F)=>{const j=d.value.get(U.id)??!1,Z=d.value.get(F.id)??!1;return j!==Z?j?-1:1:U.name.localeCompare(F.name,void 0,{sensitivity:"base"})})}),x=z(()=>h.value.length>0&&h.value.every(A=>A.hasRole));z(()=>f.value.marshalIdsToAdd.size>0||f.value.marshalIdsToRemove.size>0||f.value.contactIdsToAdd.size>0||f.value.contactIdsToRemove.size>0);const C=()=>{const A=!x.value;for(const U of h.value)U.hasRole!==A&&_(U,A)},_=(A,U)=>{const F=h.value.find(j=>j.id===A.id);F&&(F.hasRole=U),A.personType==="Marshal"||A.personType==="Linked"?U?f.value.marshalIdsToRemove.has(A.marshalId)?f.value.marshalIdsToRemove.delete(A.marshalId):f.value.marshalIdsToAdd.add(A.marshalId):f.value.marshalIdsToAdd.has(A.marshalId)?f.value.marshalIdsToAdd.delete(A.marshalId):f.value.marshalIdsToRemove.add(A.marshalId):A.personType==="Contact"&&(U?f.value.contactIdsToRemove.has(A.contactId)?f.value.contactIdsToRemove.delete(A.contactId):f.value.contactIdsToAdd.add(A.contactId):f.value.contactIdsToAdd.has(A.contactId)?f.value.contactIdsToAdd.delete(A.contactId):f.value.contactIdsToRemove.add(A.contactId)),o("update:isDirty",!0)},$=A=>{_(A,!A.hasRole)},R=()=>{if(!k.value.name.trim()){l.value="Role name is required.",i.value=!0;return}o("save",{name:k.value.name.trim(),notes:k.value.notes.trim(),canManageAreaCheckpoints:k.value.canManageAreaCheckpoints,assignmentChanges:{marshalIdsToAdd:Array.from(f.value.marshalIdsToAdd),marshalIdsToRemove:Array.from(f.value.marshalIdsToRemove),contactIdsToAdd:Array.from(f.value.contactIdsToAdd),contactIdsToRemove:Array.from(f.value.contactIdsToRemove)}})},M=()=>{o("delete",s.role.roleId)},O=()=>{o("close")};return(A,U)=>(p(),g(Se,null,[Ee(Zt,{show:e.show,title:b.value?"Edit role":"Create role",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:O},{"tab-header":Ve(()=>[Ee(dl,{modelValue:y.value,"onUpdate:modelValue":U[0]||(U[0]=F=>y.value=F),tabs:m},null,8,["modelValue"])]),footer:Ve(()=>[r("div",mH,[r("div",gH,[b.value?(p(),g("button",{key:0,type:"button",onClick:M,class:"btn btn-danger",title:"Delete this role"}," Delete ")):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(R,["prevent"]),class:"role-form"},[We(r("div",Qz,[r("div",eH,[U[6]||(U[6]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":U[1]||(U[1]=F=>k.value.name=F),type:"text",onInput:I,required:"",placeholder:"Enter role name..."},null,544),[[st,k.value.name]])]),r("div",tH,[U[7]||(U[7]=r("label",{for:"notes"},"Notes:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":U[2]||(U[2]=F=>k.value.notes=F),onInput:I,rows:"6",placeholder:"Enter role description or notes..."},null,544),[[st,k.value.notes]]),U[8]||(U[8]=r("span",{class:"help-text"},"Describe what this role is responsible for",-1))]),r("div",nH,[r("label",oH,[We(r("input",{type:"checkbox","onUpdate:modelValue":U[3]||(U[3]=F=>k.value.canManageAreaCheckpoints=F),onChange:I},null,544),[[Ms,k.value.canManageAreaCheckpoints]]),r("span",sH,"Is "+w(B(n).area.toLowerCase())+" lead",1)]),r("span",aH,"When enabled, "+w(B(n).people.toLowerCase())+" with this role can view all other "+w(B(n).checkpoints.toLowerCase())+" and "+w(B(n).people.toLowerCase())+" in their "+w(B(n).area.toLowerCase())+".",1)])],512),[[os,y.value==="details"]]),We(r("div",iH,[U[11]||(U[11]=r("div",{class:"assignments-header"},[r("h4",null,"Who has this role?"),r("p",{class:"help-text"},"Select the people who should have this role assigned.")],-1)),e.loadingPeople?(p(),g("div",lH," Loading people... ")):e.people.length===0?(p(),g("div",rH,[...U[9]||(U[9]=[r("p",null,"No marshals or contacts to assign.",-1)])])):(p(),g("div",cH,[r("div",uH,[We(r("input",{"onUpdate:modelValue":U[4]||(U[4]=F=>c.value=F),type:"text",class:"search-input",placeholder:"Search by name..."},null,512),[[st,c.value]]),r("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C},w(x.value?"Deselect all":"Select all"),1)]),r("div",dH,[(p(!0),g(Se,null,je(E.value,F=>(p(),g("label",{key:F.id,class:le(["person-item",{checked:F.hasRole}])},[r("input",{type:"checkbox",checked:F.hasRole,onChange:j=>$(F)},null,40,hH),r("span",fH,w(F.name),1),F.personType==="Linked"?(p(),g(Se,{key:0},[r("span",pH,w(B(n).person),1),U[10]||(U[10]=r("span",{class:"person-type-badge contact"},"Contact",-1))],64)):(p(),g("span",{key:1,class:le(["person-type-badge",F.personType.toLowerCase()])},w(T(F.personType)),3))],2))),128))]),E.value.length===0?(p(),g("div",vH," No people match your search. ")):P("",!0)]))],512),[[os,y.value==="assignments"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(wc,{show:i.value,title:"Validation error",message:l.value,onClose:U[5]||(U[5]=F=>i.value=!1)},null,8,["show","message"])],64))}},kH=Ke(yH,[["__scopeId","data-v-4a0e6d84"]]),bH={key:0,class:"fullscreen-map-overlay"},wH={class:"fullscreen-map-header"},_H={class:"context-info"},CH={key:0},LH={class:"action-buttons"},SH=["disabled"],IH={class:"fullscreen-map-container"},xH={key:0,class:"drawing-controls"},$H={class:"point-count"},TH={class:"undo-redo-buttons"},MH=["disabled"],AH=["disabled"],EH=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(0),l=D(!1),c=D(!1),d=()=>{s("done")},h=()=>{s("cancel")},f=I=>{i.value=I?.length||0,m(),s("polygon-drawing",I)},m=()=>{o.value&&(l.value=o.value.canUndo(),c.value=o.value.canRedo())},y=()=>{o.value&&(o.value.undoPolygonPoint(),m())},k=()=>{o.value&&(o.value.redoPolygonPoint(),m())};Ye(()=>n.show,I=>{I||(i.value=0,l.value=!1,c.value=!1)});const b=I=>{I.key==="Escape"&&n.show&&h(),n.show&&n.drawingMode&&((I.ctrlKey||I.metaKey)&&I.key==="z"&&!I.shiftKey?(I.preventDefault(),y()):(I.ctrlKey||I.metaKey)&&(I.key==="y"||I.key==="z"&&I.shiftKey)&&(I.preventDefault(),k()))};return un(()=>{document.addEventListener("keydown",b)}),Ln(()=>{document.removeEventListener("keydown",b)}),(I,T)=>(p(),qe(ec,{to:"body"},[e.show?(p(),g("div",bH,[r("div",wH,[r("div",_H,[r("h3",null,w(e.contextTitle),1),e.contextDescription?(p(),g("p",CH,w(e.contextDescription),1)):P("",!0)]),r("div",LH,[e.mode==="view"?(p(),g("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(p(),g(Se,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,SH)],64))])]),r("div",IH,[Ee(Jh,zg({ref_key:"mapViewRef",ref:o,"drawing-mode":e.drawingMode},I.$attrs,{onMapClick:T[0]||(T[0]=E=>I.$emit("map-click",E)),onPolygonComplete:T[1]||(T[1]=E=>I.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:T[2]||(T[2]=E=>I.$emit("location-click",E)),onAreaClick:T[3]||(T[3]=E=>I.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(p(),g("div",xH,[r("div",$H,w(i.value)+" point"+w(i.value!==1?"s":""),1),r("div",TH,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,MH),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!c.value,title:"Redo point"}," Redo  ",8,AH)])])):P("",!0)])])):P("",!0)]))}}),PH=Ke(EH,[["__scopeId","data-v-9ce62b55"]]),DH={class:"form-group"},RH={class:"form-group"},OH={class:"form-group"},NH={key:0,class:"form-error"},BH={class:"form-row"},FH={class:"form-group",style:{flex:"1"}},UH={class:"form-group",style:{flex:"1"}},zH={class:"form-group",style:{flex:"0 0 auto"}},HH={class:"form-group"},VH={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:n}=ht(),s=e,o=t,i=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ye(()=>s.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{o("update:isDirty",!0),o("update:location",{...i.value})},c=()=>{if(!Lu(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}o("save",i.value)},d=()=>{o("close")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:`Add ${B(n).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add "+w(B(n).checkpoint),1)]),default:Ve(()=>[r("form",{onSubmit:ct(c,["prevent"])},[r("div",DH,[f[7]||(f[7]=r("label",null,"Name",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>i.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",RH,[f[8]||(f[8]=r("label",null,"Description",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>i.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",OH,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>i.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!B(Lu)(i.value.what3Words)?(p(),g("small",NH," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),r("div",BH,[r("div",FH,[f[10]||(f[10]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>i.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",UH,[f[11]||(f[11]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",zH,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>h.$emit("set-on-map"))},"  ")])]),r("div",HH,[r("label",null,"Required "+w(B(n).people),1),We(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>i.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},GH=Ke(VH,[["__scopeId","data-v-fb51fed0"]]),qH=["aria-expanded","title"],jH=["innerHTML"],WH={key:0,class:"dropdown-menu"},ZH=["onClick"],KH=["innerHTML"],YH={__name:"ThemeToggle",setup(e){const{theme:t,isDark:n,setTheme:s}=Yy(),o=D(!1),i=D(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=z(()=>n.value?l.dark:l.light),h=()=>{o.value=!o.value},f=y=>{s(y),o.value=!1},m=y=>{i.value&&!i.value.contains(y.target)&&(o.value=!1)};return un(()=>{document.addEventListener("click",m)}),Ln(()=>{document.removeEventListener("click",m)}),(y,k)=>(p(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":o.value,title:B(n)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,jH)],8,qH),o.value?(p(),g("div",WH,[(p(),g(Se,null,je(c,b=>r("button",{key:b.value,class:le(["dropdown-item",{active:B(t)===b.value}]),onClick:I=>f(b.value)},[r("span",{class:"option-icon",innerHTML:b.icon},null,8,KH),r("span",null,w(b.label),1)],10,ZH)),64))])):P("",!0)],512))}},JH=Ke(YH,[["__scopeId","data-v-969124a4"]]),XH={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},QH=["id"],eV=["filter"],tV={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){z0(n=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=z(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(n,s)=>(p(),g("svg",XH,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...s[0]||(s[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,QH)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,eV),s[2]||(s[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:le({"marshal-figure":e.animate})},[...s[1]||(s[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},nV=Ke(tV,[["__scopeId","data-v-3e647831"]]),oV={class:"header"},sV={class:"header-left"},aV={key:0},iV={class:"event-date"},lV={class:"header-actions"},rV={class:"container"},cV={class:"tabs-nav"},uV={class:"tab-content-wrapper"},dV={class:"add-note-form"},hV={class:"modal-footer-actions"},fV=["disabled"],pV=6e4,vV={__name:"AdminEventManage",setup(e){const t=Qu(),n=rr(),s=jy(),o=z(()=>t.params.eventId),{activeTab:i,switchTab:l}=Wy("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","roles","settings"]),{showConfirmModal:c,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:b}=r2(),{tabLabels:I,terms:T,termsLower:E}=ht(),x=c2(),C=d2(o),_=u2(o),{colorScheme:$}=Yy(),R=z(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:I.value.course,icon:"course"},{value:"areas",label:I.value.areas,icon:"area"},{value:"checkpoints",label:I.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:I.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:I.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"roles",label:"Roles",icon:"roles"},{value:"settings",label:"Settings",icon:"settings"}]),M=D(null),O=D([]),A=D([]),U=D({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0,roles:0}),F=D(null),j=D(!1),Z=D(!1),X=D(null),re=D(null),K=D(!1),ae=D(!1),q=D(null),Y=D(""),te=_.eventAdmins,ue=_.showAddAdmin,_e=C.showUploadRoute,Te=C.uploading,Pe=C.uploadError,De=C.showImportLocations,ke=C.showImportMarshals,H=C.importing,J=C.importingMarshals,de=C.importError,ie=C.importResult,Re=C.importMarshalsResult,G=D(!1),Q=D(!1),ee=D({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ce=D(!1),Be=D(!1),ze=D({marshalName:"",locations:[],marshal:null}),Ae=D(null),oe=D([]),ge=D(!1),Ne=D(null),Oe=D(null),$e=D(null),me=D({}),Ze=D({id:"",name:"",email:"",phoneNumber:"",notes:""}),Ge=D(!1),fe=D([]),be=D([]),ne=D([]),ye=D([]),He=D(!1),rt=D(""),kt=D(""),Ot=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Lt=D(!1),xt=D(!1),Kt=D(""),no=D(""),Mo=D(0),ft=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ct=D([]),Mt=D(null),Mn=D(!1),go=D("details"),oo=D(null),An=D(null),tn=D(null),Ps=x.isAddingMultipleCheckpoints,yo=x.multiCheckpointCounter,Uo=x.isFullscreenMapActive,pe=x.fullscreenMode,ve=x.fullscreenContext,Ie=x.tempLocationCoords,lt=x.tempCheckpoints,Qe=x.savedMapCenter,Nt=x.savedMapZoom,on=x.isDrawingAreaBoundary,mn=D(null),gn=D([]),Vn=D(null),Zs=D(!1),ko=D("details"),hl=z(()=>!gn.value||gn.value.length===0?0:Math.max(...gn.value.map(se=>se.displayOrder||0))+1),fl=D(null),pl=D(null),vi=D(!1),zo=D([]),Ho=D(null),Ta=D(!1),Vo=D("details"),bo=D([]),mi=D(!1),En=D(null),Ao=D(!1),Ma=D(!1),Ks=D(!1),so=D(""),ss=D(!1),ao=D([]),as=D({builtInRoles:[],customRoles:[]}),vt=D(null),Bt=D(!1),Pn=D([]),Sn=D(null),io=D(!1),is=D("details"),dt=D([]),Yt=D(!1),Eo=D("details"),wo=D(null),bn=D(""),Go=D(null),qo=D(null),_o=z(()=>qo.value?.marshalId!=null),Jt=()=>{n.push(`/event/${t.params.eventId}`)},Gn=z(()=>`${window.location.origin}/#/event/${t.params.eventId}`),ls=z(()=>{const V=[];return A.value.forEach(se=>{se.assignments&&V.push(...se.assignments)}),V}),Ys=z(()=>{if(!Ne.value)return A.value;const V=Ne.value.assignedLocationIds||[],se=ne.value.map(we=>we.locationId),ce=ye.value;return A.value.filter(we=>!V.includes(we.id)&&!se.includes(we.id)||ce.includes(we.id))}),Aa=z(()=>{let V=oe.value;if(F.value){const se=F.value.assignments.map(we=>we.marshalName),ce=fe.value.map(we=>we.marshalName);V=oe.value.filter(we=>!se.includes(we.name)&&!ce.includes(we.name))}return V.slice().sort((se,ce)=>se.name.localeCompare(ce.name))}),Js=z(()=>pe.value==="draw-area"&&Mt.value?.polygon?.length>0||x.canCompleteFullscreen.value),Ea=z(()=>pe.value==="move-checkpoint"&&F.value?.id?F.value.id:null),gi=z(()=>{const V=[...A.value];return pe.value==="place-checkpoint"&&Ie.value&&V.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Ie.value.lat,longitude:Ie.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),pe.value==="move-checkpoint"&&Ie.value&&F.value&&V.push({id:"temp-move",name:F.value.name+" (new position)",latitude:Ie.value.lat,longitude:Ie.value.lng,requiredMarshals:F.value.requiredMarshals,assignments:[],isTemporary:!0}),pe.value==="add-multiple"&&V.push(...lt.value),V}),rs=z(()=>{let V=[...Ct.value];return pe.value==="draw-area"&&Mt.value?.id&&(V=V.filter(se=>se.id!==Mt.value.id)),pe.value==="draw-area"&&Mt.value?.polygon?.length>0&&V.push({...Mt.value,id:Mt.value.id||"temp-area"}),V}),Pa=z(()=>{if(!Ne.value||!bo.value.length)return[];const V=Ne.value.id,se=Ne.value.assignedLocationIds||[];return bo.value.filter(ce=>{if(ce.reportedBy?.marshalId===V)return!0;const we=ce.context?.checkpoint?.checkpointId;return!!(we&&se.includes(we))}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),Xs=z(()=>{if(!F.value||!bo.value.length)return[];const V=F.value.id;return bo.value.filter(se=>se.context?.checkpoint?.checkpointId===V).sort((se,ce)=>new Date(ce.incidentTime||ce.createdAt)-new Date(se.incidentTime||se.createdAt))}),Qs=z(()=>{if(!Mt.value||!bo.value.length)return[];const V=Mt.value.id,se=A.value.filter(ce=>ce.areaIds&&ce.areaIds.includes(V)).map(ce=>ce.id);return bo.value.filter(ce=>{const we=ce.context?.checkpoint?.checkpointId;return we&&se.includes(we)}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),vl=V=>{En.value=V,Ao.value=!0},yi=V=>{En.value=V,Ao.value=!0},hr=V=>{En.value=V,Ao.value=!0},bt=()=>{n.push("/sessions")},Dt=(V=!0)=>{Ge.value=V},zt=()=>{Lt.value=!0},Co=async V=>{try{V&&(Ot.value={...V});const se=rc(M.value.eventDate),ce=Ot.value.eventDate;if(se!==ce){const we=O.value.filter(at=>at.startTime||at.endTime);if(we.length>0){Kt.value=se,no.value=ce,Mo.value=we.length,xt.value=!0;return}}await Da(!1,null)}catch(se){console.error("Failed to update event:",se),alert("Failed to update event. Please try again.")}},Da=async(V,se)=>{try{if(await s.updateEvent(t.params.eventId,{...Ot.value,defaultCheckpointStyleMapRotation:Ot.value.defaultCheckpointStyleMapRotation!=null?String(Ot.value.defaultCheckpointStyleMapRotation):null}),V&&se!==null){const ce=Math.floor(Math.abs(se)/1e3),we=se<0,at=Math.floor(ce/3600),Tt=Math.floor(ce%3600/60),Gt=ce%60,xn=`${we?"-":""}${at.toString().padStart(2,"0")}:${Tt.toString().padStart(2,"0")}:${Gt.toString().padStart(2,"0")}`;await s.bulkUpdateLocationTimes(t.params.eventId,xn)}await sn(),Lt.value=!1}catch(ce){console.error("Failed to update event:",ce),alert("Failed to update event. Please try again.")}},ea=async({shouldShift:V,timeDelta:se})=>{xt.value=!1,await Da(V,se)},ki=()=>{xt.value=!1,sn()},cs=async({routeColor:V,routeStyle:se,routeWeight:ce})=>{if(M.value)try{await s.updateEvent(t.params.eventId,{name:M.value.name,description:M.value.description,eventDate:M.value.eventDate,timeZoneId:M.value.timeZoneId,routeColor:V,routeStyle:se,routeWeight:ce}),M.value={...M.value,routeColor:V,routeStyle:se,routeWeight:ce}}catch(we){console.error("Failed to update route settings:",we)}},sn=async()=>{try{await s.fetchEvent(t.params.eventId),M.value=s.currentEvent,M.value&&(Ot.value={name:M.value.name||"",description:M.value.description||"",eventDate:rc(M.value.eventDate),timeZoneId:M.value.timeZoneId||"UTC",peopleTerm:M.value.peopleTerm||"Marshals",checkpointTerm:M.value.checkpointTerm||"Checkpoints",areaTerm:M.value.areaTerm||"Areas",checklistTerm:M.value.checklistTerm||"Checklists",courseTerm:M.value.courseTerm||"Course",defaultCheckpointStyleType:M.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:M.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:M.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:M.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:M.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:M.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:M.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:M.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:M.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:M.value.brandingHeaderGradientEnd||"",brandingLogoUrl:M.value.brandingLogoUrl||"",brandingLogoPosition:M.value.brandingLogoPosition||"",brandingAccentColor:M.value.brandingAccentColor||"",brandingPageGradientStart:M.value.brandingPageGradientStart||"",brandingPageGradientEnd:M.value.brandingPageGradientEnd||""},Lt.value=!1,Zh(M.value));const V=await Promise.allSettled([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),Zo(),wn(),an(),lo(),Ds(),ta(),Rs(),xe()]);O.value=s.locations,A.value=s.eventStatus.locations,V.forEach((se,ce)=>{se.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts","roles"][ce]}:`,se.reason)})}catch(V){console.error("Failed to load event data:",V)}},wn=async()=>{try{const V=await _s.getByEvent(t.params.eventId);oe.value=V.data,U.value.marshals=Date.now()}catch(V){console.error("Failed to load marshals:",V)}},an=async()=>{try{const V=await ma.getByEvent(t.params.eventId);Ct.value=V.data,U.value.areas=Date.now()}catch(V){console.error("Failed to load areas:",V)}},lo=async()=>{try{const[V,se]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);gn.value=V.data,fl.value=se.data,U.value.checklists=Date.now()}catch(V){console.error("Failed to load checklists:",V)}},Lo=async()=>{try{vi.value=!0;const V=await Rt.getDetailedReport(t.params.eventId);pl.value=V.data}catch(V){console.error("Failed to load detailed report:",V)}finally{vi.value=!1}},Ds=async()=>{try{const V=await bs.getByEvent(t.params.eventId);zo.value=V.data,U.value.notes=Date.now()}catch(V){console.error("Failed to load notes:",V)}},ta=async()=>{mi.value=!0;try{const V=await Gs.getAll(t.params.eventId);bo.value=V.data.incidents||[],U.value.incidents=Date.now()}catch(V){console.error("Failed to load incidents:",V)}finally{mi.value=!1}},Rs=async()=>{try{const[V,se]=await Promise.all([ua.getByEvent(t.params.eventId),ua.getRoles(t.params.eventId)]);ao.value=V.data,as.value=se.data,U.value.contacts=Date.now()}catch(V){console.error("Failed to load contacts:",V)}},Ra=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId)]),O.value=s.locations,U.value.checkpoints=Date.now(),A.value=s.eventStatus.locations},ml=async()=>{await Promise.all([wn(),s.fetchEventStatus(t.params.eventId)]),A.value=s.eventStatus.locations},bi=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),an()]),O.value=s.locations,A.value=s.eventStatus.locations},At=async()=>{await s.fetchEventStatus(t.params.eventId),A.value=s.eventStatus.locations},wi=()=>{Mt.value=null,go.value="details",Ge.value=!1,Mn.value=!0},In=V=>{Mt.value=V,An.value=V.id,go.value="details",Ge.value=!1,Mn.value=!0},na=async V=>{try{let se;if(Mt.value&&Mt.value.id){if(se=Mt.value.id,await ma.update(t.params.eventId,se,V),V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Rt.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Rt.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}}else se=(await ma.create({eventId:t.params.eventId,...V})).data.id;if(V.pendingContacts&&V.pendingContacts.length>0&&se)for(const ce of V.pendingContacts)try{const we=ce.scopeConfigurations?JSON.parse(JSON.stringify(ce.scopeConfigurations)):[],at=we.find(Tt=>Tt.scope==="EveryoneInAreas"&&Tt.itemType==="Area");at?(at.ids||(at.ids=[]),at.ids.includes(se)||at.ids.push(se)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[se]}),await ua.update(t.params.eventId,ce.contactId,{...ce,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",ce,we)}if(V.contactsToRemove&&V.contactsToRemove.length>0&&se)for(const ce of V.contactsToRemove)try{const we=ao.value.find(Gt=>Gt.contactId===ce);if(!we)continue;const at=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],Tt=at.find(Gt=>Gt.scope==="EveryoneInAreas"&&Gt.itemType==="Area");if(Tt&&Tt.ids){Tt.ids=Tt.ids.filter(xn=>xn!==se);const Gt=Tt.ids.length>0?at:at.filter(xn=>!(xn.scope==="EveryoneInAreas"&&xn.itemType==="Area"));await ua.update(t.params.eventId,ce,{...we,scopeConfigurations:Gt})}}catch(we){console.error("Failed to remove area from contact:",ce,we)}if((V.pendingContacts&&V.pendingContacts.length>0||V.contactsToRemove&&V.contactsToRemove.length>0)&&await Rs(),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0&&se){for(const ce of V.pendingNewChecklistItems)if(ce.text?.trim())try{await Rt.create(t.params.eventId,{text:ce.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,isRequired:!1})}catch(we){console.error("Failed to create checklist item:",ce,we)}await lo()}if(V.pendingNewNotes&&V.pendingNewNotes.length>0&&se){for(const ce of V.pendingNewNotes)if(!(!ce.title?.trim()&&!ce.content?.trim()))try{await bs.create(t.params.eventId,{title:ce.title||"Untitled",content:ce.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(we){console.error("Failed to create note:",ce,we)}await Ds()}await an(),await sn(),us()}catch(se){console.error("Failed to save area:",se),alert(se.response?.data?.message||"Failed to save area. Please try again.")}},gl=async V=>{y(`Delete ${E.value.area}`,`Are you sure you want to delete this ${E.value.area}? ${T.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ma.delete(t.params.eventId,V),await ma.recalculate(t.params.eventId),await an(),await sn(),us()}catch(se){console.error(`Failed to delete ${E.value.area}:`,se),alert(se.response?.data?.message||`Failed to delete ${E.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},us=()=>{Mn.value=!1,Mt.value=null,An.value=null,Ge.value=!1,on.value=!1,tn.value=null},oa=({marshal:V,area:se})=>{vt.value=null,Eo.value="details",Ge.value=!1,wo.value=se,bn.value="",Go.value=V.id,Bt.value=!0},fr=({name:V,area:se})=>{vt.value=null,Eo.value="details",Ge.value=!1,wo.value=se,bn.value=V,Go.value=null,Bt.value=!0},yl=V=>{vt.value=V,Eo.value="details",Ge.value=!1,Bt.value=!0},sa=()=>{Vn.value=null,ko.value="details",Ge.value=!1,Zs.value=!0},_i=(V,se="details")=>{Vn.value=V,ko.value=se,Ge.value=!1,Zs.value=!0},jo=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Ct.value,locations:A.value,marshals:oe.value})};if(Vn.value&&Vn.value.itemId)await Rt.update(t.params.eventId,Vn.value.itemId,se);else{const ce=await Rt.create(t.params.eventId,se);ce.data.count&&ce.data.count>1&&(rt.value="Checklist Items Created",kt.value=`Successfully created ${ce.data.count} checklist items.`,He.value=!0)}await lo(),On()}catch(se){console.error("Failed to save checklist item:",se);const ce=se.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ce)}},Ci=async V=>{y(`Delete ${E.value.checklist}`,`Are you sure you want to delete this ${E.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,V),await lo(),On()}catch(se){console.error(`Failed to delete ${E.value.checklist}:`,se),alert(se.response?.data?.message||`Failed to delete ${E.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},On=()=>{Zs.value=!1,Vn.value=null,Ge.value=!1},kl=async V=>{const se=[...gn.value];V.forEach(ce=>{const we=gn.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Rt.reorder(t.params.eventId,V)}catch(ce){gn.value=se,console.error("Failed to reorder checklist items:",ce),alert("Failed to save order. Changes have been reverted.")}},Li=()=>{Ho.value=null,Vo.value="details",Ge.value=!1,Ta.value=!0},Wo=V=>{Ho.value=V,Vo.value="details",Ge.value=!1,Ta.value=!0},bl=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Ct.value,locations:A.value,marshals:oe.value})};Ho.value&&Ho.value.noteId?await bs.update(t.params.eventId,Ho.value.noteId,se):await bs.create(t.params.eventId,se),await Ds(),aa()}catch(se){console.error("Failed to save note:",se);const ce=se.response?.data?.message||"Failed to save note. Please try again.";alert(ce)}},Si=async V=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await bs.delete(t.params.eventId,V),await Ds(),aa()}catch(se){console.error("Failed to delete note:",se),alert(se.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},aa=()=>{Ta.value=!1,Ho.value=null,Ge.value=!1},Oa=async V=>{const se=[...zo.value];V.forEach(ce=>{const we=zo.value.find(at=>at.noteId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await bs.reorder(t.params.eventId,V)}catch(ce){zo.value=se,console.error("Failed to reorder notes:",ce),alert("Failed to save order. Changes have been reverted.")}},Na=async V=>{const se=[...gn.value];V.forEach(ce=>{const we=gn.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Rt.reorder(t.params.eventId,V)}catch(ce){gn.value=se,console.error("Failed to reorder checklists:",ce),alert("Failed to save order. Changes have been reverted.")}},wl=()=>{Ma.value=!0},_l=async V=>{try{await Gs.create(t.params.eventId,V),Ma.value=!1,await ta()}catch(se){console.error("Failed to report incident:",se),alert(se.response?.data?.message||"Failed to report incident. Please try again.")}},Cl=V=>{En.value=V,Ao.value=!0},Ii=()=>{Ao.value=!1,En.value=null},xi=async({incidentId:V,status:se})=>{try{if(await Gs.updateStatus(t.params.eventId,V,{status:se}),await ta(),En.value?.incidentId===V){const ce=bo.value.find(we=>we.incidentId===V);ce&&(En.value=ce)}}catch(ce){console.error("Failed to update incident status:",ce),alert(ce.response?.data?.message||"Failed to update status. Please try again.")}},$i=()=>{so.value="",Ks.value=!0},Ba=()=>{Ks.value=!1,so.value=""},Fa=async()=>{if(!(!so.value.trim()||!En.value)){ss.value=!0;try{await Gs.addNote(t.params.eventId,En.value.incidentId,so.value.trim()),Ba(),await ta();const V=bo.value.find(se=>se.incidentId===En.value.incidentId);V&&(En.value=V)}catch(V){console.error("Failed to add note to incident:",V),alert(V.response?.data?.message||"Failed to add note. Please try again.")}finally{ss.value=!1}}},ds=()=>{vt.value=null,Eo.value="details",wo.value=null,Ge.value=!1,Bt.value=!0},pr=V=>{vt.value=V,Eo.value="details",Ge.value=!1,Bt.value=!0},Os=async V=>{try{const se={...V,scopeConfigurations:Ud(V.scopeConfigurations,{areas:Ct.value,locations:A.value,marshals:oe.value})};let ce=null;const we=!vt.value||!vt.value.contactId,at=!!wo.value;if(vt.value&&vt.value.contactId)await ua.update(t.params.eventId,vt.value.contactId,se);else{const Tt=await ua.create(t.params.eventId,se);ce=Tt.data?.contactId||Tt.data?.id}if(await Rs(),we&&at&&ce&&oo.value){const Tt=ao.value.find(Gt=>Gt.contactId===ce);Tt&&oo.value.addPendingContact(Tt)}ia()}catch(se){console.error("Failed to save contact:",se);const ce=se.response?.data?.message||"Failed to save contact. Please try again.";alert(ce)}},Nn=async V=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await ua.delete(t.params.eventId,V),await Rs(),oo.value&&oo.value.removeContactById(V),ia()}catch(se){console.error("Failed to delete contact:",se),alert(se.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},ia=()=>{Bt.value=!1,vt.value=null,wo.value=null,bn.value="",Go.value=null,Ge.value=!1},Ti=async V=>{const se=[...ao.value];V.forEach(ce=>{const we=ao.value.find(at=>at.contactId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await ua.reorder(t.params.eventId,V)}catch(ce){ao.value=se,console.error("Failed to reorder contacts:",ce),alert("Failed to save order. Changes have been reverted.")}},xe=async()=>{try{const V=await Ka.getAll(t.params.eventId);Pn.value=V.data,U.value.roles=Date.now()}catch(V){console.error("Failed to load role definitions:",V)}},Le=()=>{Sn.value=null,is.value="details",dt.value=[],Ge.value=!1,io.value=!0},nt=V=>{Sn.value=V,is.value="details",dt.value=[],Ge.value=!1,io.value=!0},mt=async V=>{try{const se=Sn.value?.roleId,{assignmentChanges:ce,...we}=V;se?(await Ka.update(t.params.eventId,se,we),ce&&(ce.marshalIdsToAdd.length>0||ce.marshalIdsToRemove.length>0||ce.contactIdsToAdd.length>0||ce.contactIdsToRemove.length>0)&&await Ka.updatePeople(t.params.eventId,se,ce)):await Ka.create(t.params.eventId,we),await xe(),Ht()}catch(se){console.error("Failed to save role:",se);const ce=se.response?.data?.message||"Failed to save role. Please try again.";alert(ce)}},$t=async V=>{const se=Sn.value?.usageCount||0;let ce="Are you sure you want to delete this role?";if(se>0){const we=se===1?E.value.person:E.value.people;ce=`This role is assigned to ${se} ${we}. They will all be unassigned from this role. Are you sure you want to delete it?`}y("Delete role",ce,async()=>{try{await Ka.delete(t.params.eventId,V),await xe(),Ht()}catch(we){console.error("Failed to delete role:",we),alert(we.response?.data?.message||"Failed to delete role. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ht=()=>{io.value=!1,Sn.value=null,dt.value=[],Ge.value=!1},Bn=async V=>{Yt.value=!0;try{const se=await Ka.getPeople(t.params.eventId,V);dt.value=se.data}catch(se){console.error("Failed to load people for role:",se)}finally{Yt.value=!1}},Vt=async V=>{const se=[...Pn.value];V.forEach(ce=>{const we=Pn.value.find(at=>at.roleId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ka.reorder(t.params.eventId,V)}catch(ce){Pn.value=se,console.error("Failed to reorder roles:",ce),alert("Failed to save order. Changes have been reverted.")}},ln=V=>{tn.value={...V,id:Mt.value?.id};const se={...V,id:Mt.value?.id,polygon:[]};Mt.value=se;let ce=!1;if(V.polygon&&V.polygon.length>0){const we=V.polygon.map(a=>a.lat||a[0]),at=V.polygon.map(a=>a.lng||a[1]),Tt=Math.min(...we),Gt=Math.max(...we),xn=Math.min(...at),Di=Math.max(...at);Qe.value={lat:(Tt+Gt)/2,lng:(xn+Di)/2};const Ri=Gt-Tt,Rl=Di-xn,Ga=Math.max(Ri,Rl);Nt.value=Ga<.005?17:Ga<.01?16:Ga<.02?15:Ga<.05?14:13,ce=!0}if(!ce&&V.checkpointIds&&V.checkpointIds.length>0){const we=A.value.filter(at=>V.checkpointIds.includes(at.id));if(we.length>0){const at=we.map(Gt=>Gt.latitude).filter(Boolean),Tt=we.map(Gt=>Gt.longitude).filter(Boolean);if(at.length>0&&Tt.length>0){const Gt=Math.min(...at),xn=Math.max(...at),Di=Math.min(...Tt),Ri=Math.max(...Tt);Qe.value={lat:(Gt+xn)/2,lng:(Di+Ri)/2};const Rl=xn-Gt,Ga=Ri-Di,a=Math.max(Rl,Ga);Nt.value=a<.005?16:a<.01?15:a<.02?14:a<.05?13:12,ce=!0}}}if(!ce&&X.value){const we=X.value.getMapCenter(),at=X.value.getMapZoom();we&&at!==null&&(Qe.value=we,Nt.value=at)}Uo.value=!0,pe.value="draw-area",on.value=!0,ve.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},ro=V=>{tn.value?Mt.value={...Mt.value||{},...tn.value,polygon:V}:Mt.value={...Mt.value,polygon:V}},wt=V=>{x.handlePolygonDrawing(V)},qn=()=>{on.value=!1,tn.value&&(Mt.value=tn.value,Mn.value=!0,tn.value=null)},Zo=()=>_.loadEventAdmins(),vr=async V=>{try{await _.addAdmin(V),await Zo(),mr()}catch(se){console.error("Failed to add admin:",se),alert(se.response?.data?.message||"Failed to add administrator. Please try again.")}},Mi=async V=>{y("Remove administrator",`Remove ${V} as an administrator?`,async()=>{try{await _.removeAdmin(V),await Zo()}catch(se){console.error("Failed to remove admin:",se),alert(se.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},mr=()=>{_.closeAddAdminModal(),Ge.value=!1},Ll=async V=>{await C.uploadRoute(V)&&(await Ra(),_c())},_c=()=>{C.closeUploadRouteModal()},Ns=async({file:V,deleteExisting:se})=>{const ce=await C.importLocations(V,se);if(ce){await bi(),Ai();const we=C.formatImportResultMessage(ce,"location");rt.value="Import Complete",kt.value=we,He.value=!0}},Ai=()=>{C.closeImportLocationsModal()},rd=async V=>{if(Z.value)ft.value.latitude=V.lat,ft.value.longitude=V.lng;else if(Q.value)ee.value.latitude=V.lat,ee.value.longitude=V.lng,F.value&&(F.value={...F.value,latitude:V.lat,longitude:V.lng}),Q.value=!1,G.value=!0,Dt();else if(Ps.value)try{await s.createLocation({eventId:t.params.eventId,name:`Checkpoint ${yo.value}`,description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""}),yo.value++,await sn()}catch(se){console.error("Failed to create checkpoint:",se),alert("Failed to create checkpoint. Please try again.")}},gr=V=>{x.handleFullscreenMapClick(V)},cd=V=>{ft.value={...V}},hs=()=>{Z.value=!1,x.enterPlaceCheckpointMode()},ud=()=>{x.saveMapState(X.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},x.enterPlaceCheckpointMode()},Ua=()=>{x.saveMapState(X.value),Uo.value=!0,pe.value="view",ve.value={title:"Course map",description:""}},dd=()=>{x.saveMapState(X.value),Mt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Ct.value.length},x.enterDrawAreaMode()},fs=()=>{F.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],be.value=[],Ge.value=!1,G.value=!0},Sl=()=>{const V=x.calculateStartingNumber(A);x.saveMapState(X.value),x.enterAddMultipleMode(V)},Cc=()=>{if(pe.value==="place-checkpoint"){const V=x.getPlacedCoords()||{lat:0,lng:0};F.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""},fe.value=[],be.value=[],Ge.value=!1,za(),G.value=!0}else if(pe.value==="move-checkpoint"){const V=x.getPlacedCoords();V&&(ee.value.latitude=V.lat,ee.value.longitude=V.lng,F.value&&(F.value={...F.value,...mn.value||{},latitude:V.lat,longitude:V.lng}),Dt()),mn.value=null,za(),G.value=!0}else if(pe.value==="draw-area"){const V=x.getCompletedPolygon();V&&(tn.value?Mt.value={...Mt.value||{},...tn.value,polygon:V}:Mt.value={...Mt.value||{},polygon:V}),tn.value=null,za()}else pe.value==="add-multiple"&&yr()},yr=async()=>{const V=x.getTempCheckpoints();try{for(const se of V)await s.createLocation({eventId:t.params.eventId,name:se.name,description:se.description,latitude:se.latitude,longitude:se.longitude,requiredMarshals:se.requiredMarshals,what3Words:se.what3Words});x.clearTempCheckpoints(),za(),await sn()}catch(se){console.error("Failed to create checkpoints:",se),alert("Failed to create checkpoints. Please try again.")}},Il=()=>{pe.value==="draw-area"?tn.value&&(Mt.value=tn.value,tn.value=null):pe.value==="move-checkpoint"&&(mn.value&&F.value&&Object.assign(F.value,mn.value),G.value=!0,Q.value=!1),x.cancelFullscreen()},za=()=>{x.exitFullscreen()},xl=V=>{ps(V)},ps=V=>{F.value=V,ee.value={id:V.id,name:V.name,description:V.description||"",latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||""},fe.value=[],be.value=[],Ge.value=!1,G.value=!0,setTimeout(()=>{X.value?.scrollMapIntoView()},100)},$l=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await s.createLocation({eventId:t.params.eventId,...V}),await sn(),Tl()}catch(se){console.error("Failed to save location:",se),alert("Failed to save location. Please try again.")}},Tl=()=>{Z.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Ge.value=!1,Ge.value=!1},Ml=()=>{G.value=!1,F.value=null,j.value=!1,Q.value=!1,Ce.value=!1,mn.value=null,ee.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],be.value=[],Ge.value=!1},kr=()=>{Ce.value=!1},Al=()=>{Ce.value=!0},hd=V=>{V?.formData&&(mn.value=V.formData),G.value=!1,Ie.value=null;const se=mn.value?.latitude??F.value?.latitude,ce=mn.value?.longitude??F.value?.longitude;if(se&&ce)Qe.value={lat:se,lng:ce},Nt.value=16;else if(X.value){const at=X.value.getMapCenter(),Tt=X.value.getMapZoom();at&&Tt!==null&&(Qe.value=at,Nt.value=Tt)}const we=mn.value?.name||F.value?.name;Uo.value=!0,pe.value="move-checkpoint",ve.value={title:`Move ${E.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},Lc=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format.");return}try{const se=!F.value.id;if(se){const ce=await s.createLocation({eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:ce.id,marshalId:we.marshalId})}else{const ce=F.value.id;if(await Kn.update(t.params.eventId,ce,{eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Rt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await bs.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of be.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of fe.value)await s.createAssignment({eventId:t.params.eventId,locationId:F.value.id,marshalId:we.marshalId});if(V.checkInChanges&&V.checkInChanges.length>0)for(const we of V.checkInChanges){const at=F.value.assignments.find(Tt=>Tt.id===we.assignmentId);at&&at.isCheckedIn!==we.shouldBeCheckedIn&&await ri.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!se&&V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Rt.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Rt.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}await sn(),Ml()}catch(se){console.error("Failed to update location:",se),alert("Failed to update location. Please try again.")}},fd=async V=>{y(`Delete ${E.value.checkpoint}`,`Are you sure you want to delete this ${E.value.checkpoint}?`,async()=>{try{await Kn.delete(t.params.eventId,V),await bi(),Ml()}catch(se){console.error(`Failed to delete ${E.value.checkpoint}:`,se),alert(`Failed to delete ${E.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Sc=async V=>{try{if(re.value&&re.value.setCheckingIn(V.id),await ri.adminCheckIn(t.params.eventId,V.id),await At(),F.value){const se=A.value.find(ce=>ce.id===F.value.id);se&&(F.value=se)}}catch(se){console.error("Failed to toggle check-in:",se),alert("Failed to toggle check-in. Please try again.")}finally{re.value&&re.value.setCheckingIn(null)}},pd=V=>{const se=V?.id??V;if(se?.toString().startsWith("temp-")){const ce=F.value.assignments.find(we=>we.id===se);ce&&(fe.value=fe.value.filter(we=>we.marshalId!==ce.marshalId)),F.value.assignments=F.value.assignments.filter(we=>we.id!==se),Dt()}else be.value.includes(se)||(be.value.push(se),F.value.assignments=F.value.assignments.filter(ce=>ce.id!==se),Dt())},Ko=async V=>{const se=oe.value.find(we=>we.id===V);if(!se)return;const ce=A.value.filter(we=>we.assignments?.some(at=>at.marshalId===V&&we.id!==F.value.id));if(ce.length>0){ze.value={marshalName:se.name,locations:ce.map(at=>at.name),marshal:se};const we=await new Promise(at=>{Ae.value=at,Be.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const at of ce){const Tt=at.assignments.find(Gt=>Gt.marshalId===V);if(Tt){be.value.push(Tt.id);const Gt=A.value.findIndex(xn=>xn.id===at.id);Gt!==-1&&(A.value[Gt].assignments=A.value[Gt].assignments.filter(xn=>xn.id!==Tt.id))}}}fe.value.push({marshalId:se.id,marshalName:se.name}),F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:se.id,marshalName:se.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0}),Dt(),kr()},El=async V=>{try{const ce=(await _s.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber})).data;await wn(),fe.value.push({marshalId:ce.id,marshalName:ce.name}),F.value&&(F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ce.id,marshalName:ce.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0})),Dt(),kr()}catch(se){console.error("Failed to create marshal:",se),alert("Failed to create marshal. Please try again.")}},vd=()=>{Ne.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],Ge.value=!1,ge.value=!0},Pl=V=>{Ne.value=V,me.value={},Ze.value={id:V.id,name:V.name,email:V.email||"",phoneNumber:V.phoneNumber||"",notes:V.notes||""},ne.value=[],ye.value=[],Ge.value=!1,ge.value=!0},Ic=z(()=>{if(!Ne.value)return[];const V=[];return A.value.forEach(se=>{se.assignments.filter(we=>we.marshalName===Ne.value.name&&!ye.value.includes(we.id)).forEach(we=>{V.push({...we,locationName:se.name,locationDescription:se.description||""})})}),ne.value.forEach((se,ce)=>{const we=A.value.find(at=>at.id===se.locationId);we&&V.push({id:`pending-${ce}`,locationId:se.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:Ne.value.id,marshalName:Ne.value.name,isCheckedIn:!1,isPending:!0})}),V}),xc=async V=>{try{let se=Ne.value?.id,ce=!1;if(Ne.value){if(await _s.update(t.params.eventId,Ne.value.id,{name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Rt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await bs.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}else se=(await _s.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]})).data.id,ce=!0;for(const we of ye.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of ne.value)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.checkInChanges&&V.checkInChanges.length>0){const we=Ic.value;for(const at of V.checkInChanges){const Tt=we.find(Gt=>Gt.id===at.assignmentId);Tt&&Tt.isCheckedIn!==at.shouldBeCheckedIn&&await ri.adminCheckIn(t.params.eventId,at.assignmentId)}}if(V.checklistChanges&&V.checklistChanges.length>0)for(const we of V.checklistChanges)try{const at={marshalId:se};we.contextType&&we.contextId&&(at.contextType=we.contextType,at.contextId=we.contextId),we.complete?await Rt.complete(t.params.eventId,we.itemId,at):await Rt.uncomplete(t.params.eventId,we.itemId,at)}catch(at){console.error("Failed to process checklist change:",at);const Tt=at.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Tt}`)}if(await sn(),F.value){const we=A.value.find(at=>at.id===F.value.id);we&&(F.value=we)}Dl(),ce&&(q.value=se,Y.value=V.name,ae.value=!0)}catch(se){console.error("Failed to save marshal:",se);const ce=se.response?.data?.message||"Failed to save marshal. Please try again.";if(se.response?.status===400){const we=ce.toLowerCase();we.includes("name")?(me.value={name:ce},$e.value&&($e.value.switchToTab("details"),$e.value.focusField("name"))):we.includes("email")?(me.value={email:ce},$e.value&&($e.value.switchToTab("details"),$e.value.focusField("email"))):(me.value={general:ce},$e.value&&$e.value.switchToTab("details"))}else me.value={general:ce},$e.value&&$e.value.switchToTab("details")}},$c=async V=>{const se=V||Ne.value?.id;if(!se){console.error("No marshal ID to delete");return}const ce=E.value.person;y(`Delete ${ce}`,`Are you sure you want to delete this ${ce}?`,async()=>{try{await _s.delete(t.params.eventId,se),await ml(),Dl()}catch(we){console.error(`Failed to delete ${ce}:`,we),alert(`Failed to delete ${ce}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ei=V=>{$c(V.id)},md=V=>{const se=V?.id??V;if(se?.toString().startsWith("pending-")){const ce=V?.locationId;ce&&(ne.value=ne.value.filter(we=>we.locationId!==ce)),Dt()}else ye.value.includes(se)||(ye.value.push(se),Dt())},Ha=V=>{ne.value.push({locationId:V}),Dt()},Dl=()=>{ge.value=!1,Ne.value=null,Oe.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],Ge.value=!1},Tc=async V=>{const se=oe.value.find(ce=>ce.id===V.marshalId);if(!se){console.error("Marshal not found:",V.marshalId);return}Oe.value=F.value?.id||null,Ge.value=!1,Ne.value=se,ge.value=!0},gd=V=>{const se=A.value.find(ce=>ce.id===V.locationId);if(!se){console.error("Location not found:",V.locationId);return}j.value=!0,Ge.value=!1,F.value=se,G.value=!0},vs=async({file:V})=>{const se=await C.importMarshals(V);if(se){await ml(),br();const ce=C.formatImportResultMessage(se,"marshal");rt.value="Import Complete",kt.value=ce,He.value=!0}},br=()=>{C.closeImportMarshalsModal()},Mc=V=>{Ae.value&&(Ae.value(V),Ae.value=null),Be.value=!1};let ms=null;const Ac=async()=>{try{const V=t.params.eventId,se=await Kn.getDynamicCheckpoints(V);if(se.data&&Array.isArray(se.data))for(const ce of se.data){const we=A.value.find(at=>at.id===ce.checkpointId);we&&(we.latitude=ce.latitude,we.longitude=ce.longitude,we.lastLocationUpdate=ce.lastLocationUpdate)}}catch(V){console.warn("Failed to poll dynamic checkpoints:",V)}},Pi=()=>{ms||!A.value.some(se=>se.isDynamic||se.IsDynamic)||(Ac(),ms=setInterval(Ac,6e4))},Va=()=>{ms&&(clearInterval(ms),ms=null)};return Ye(i,V=>{V==="course"?Pi():Va();const se=Date.now(),ce=we=>se-U.value[we]>pV;switch(V){case"marshals":ce("marshals")&&wn(),ce("roles")&&xe();break;case"areas":ce("areas")&&an(),ce("roles")&&xe();break;case"checkpoints":ce("checkpoints")&&Ra();break;case"checklists":ce("checklists")&&lo();break;case"notes":ce("notes")&&Ds();break;case"incidents":ce("incidents")&&ta();break;case"contacts":ce("contacts")&&Rs(),ce("roles")&&xe();break;case"roles":ce("roles")&&xe();break}}),un(async()=>{await sn();try{const V=await qs.getMe(t.params.eventId);qo.value=V.data}catch(V){console.warn("Failed to fetch user claims:",V)}i.value==="course"&&Pi()}),Ye(M,V=>{V&&(document.title="OnTheDay App - Admin")},{immediate:!0}),Ln(()=>{Va()}),(V,se)=>(p(),g("div",{class:"admin-event-manage",style:tt({colorScheme:B($)})},[r("header",oV,[r("div",sV,[r("button",{onClick:bt,class:"btn-back",title:"Back to sessions"},[Ee(nV,{size:48,animate:""})]),M.value?(p(),g("div",aV,[r("h1",null,w(M.value.name),1),r("p",iV,w(B(Jy)(M.value.eventDate)),1)])):P("",!0)]),r("div",lV,[_o.value?(p(),g("button",{key:0,onClick:Jt,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Ee(JH,{class:"theme-toggle-fixed"})]),r("div",rV,[r("div",cV,[Ee(nP,{tabs:R.value,"model-value":B(i),"onUpdate:modelValue":B(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",uV,[B(i)==="course"?(p(),qe(nS,{key:0,ref_key:"courseAreasTab",ref:X,checkpoints:A.value,areas:Ct.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"selected-area-id":An.value,"drawing-mode":B(on),onMapClick:rd,onLocationClick:xl,onAreaClick:In,onImportCheckpoints:se[0]||(se[0]=ce=>De.value=!0),onUploadRoute:se[1]||(se[1]=ce=>_e.value=!0),onSelectLocation:ps,onAddArea:wi,onSelectArea:In,onPolygonComplete:ro,onCancelDrawing:qn,onAddCheckpointFromMap:ud,onAddManyCheckpointsFromMap:Sl,onAddAreaFromMap:dd,onFullscreen:Ua,"onUpdate:routeSettings":cs},null,8,["checkpoints","areas","route","route-color","route-style","route-weight","selected-area-id","drawing-mode"])):P("",!0),B(i)==="checkpoints"?(p(),qe(I3,{key:1,locations:A.value,areas:Ct.value,onAddCheckpointManually:fs,onImportCheckpoints:se[2]||(se[2]=ce=>De.value=!0),onSelectLocation:ps},null,8,["locations","areas"])):P("",!0),B(i)==="areas"?(p(),qe(j3,{key:2,areas:Ct.value,checkpoints:A.value,contacts:ao.value,"event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onAddArea:wi,onSelectArea:In},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),B(i)==="marshals"?(p(),qe(sI,{key:3,ref_key:"marshalsTabRef",ref:re,marshals:oe.value,assignments:ls.value,locations:A.value,onAddMarshal:vd,onImportMarshals:se[3]||(se[3]=ce=>ke.value=!0),onSelectMarshal:Pl,onDeleteMarshal:Ei,onToggleCheckIn:Sc},null,8,["marshals","assignments","locations"])):P("",!0),B(i)==="checklists"?(p(),qe(g$,{key:4,"checklist-items":gn.value,areas:Ct.value,locations:A.value,marshals:oe.value,"completion-report":fl.value,"detailed-report":pl.value,"is-loading-detailed-report":vi.value,onAddChecklistItem:sa,onSelectChecklistItem:_i,onReorder:kl,onLoadDetailedReport:Lo},null,8,["checklist-items","areas","locations","marshals","completion-report","detailed-report","is-loading-detailed-report"])):P("",!0),B(i)==="notes"?(p(),qe(R$,{key:5,notes:zo.value,areas:Ct.value,locations:A.value,marshals:oe.value,onAddNote:Li,onSelectNote:Wo,onReorder:Oa},null,8,["notes","areas","locations","marshals"])):P("",!0),B(i)==="incidents"?(p(),qe(s3,{key:6,incidents:bo.value,areas:Ct.value,loading:mi.value,onSelectIncident:Cl,onReportIncident:wl},null,8,["incidents","areas","loading"])):P("",!0),B(i)==="contacts"?(p(),qe(oT,{key:7,contacts:ao.value,areas:Ct.value,locations:A.value,marshals:oe.value,"available-roles":as.value,"role-definitions":Pn.value,onAddContact:ds,onSelectContact:pr,onReorder:Ti},null,8,["contacts","areas","locations","marshals","available-roles","role-definitions"])):P("",!0),B(i)==="roles"?(p(),qe(bT,{key:8,"role-definitions":Pn.value,onAddRole:Le,onSelectRole:nt,onReorder:Vt},null,8,["role-definitions"])):P("",!0),B(i)==="details"?(p(),qe(ET,{key:9,"event-data":Ot.value,"form-dirty":Lt.value,onSubmit:Co,"onUpdate:formDirty":zt},null,8,["event-data","form-dirty"])):P("",!0),B(i)==="settings"?(p(),qe(D4,{key:10,"event-data":Ot.value,"event-id":B(t).params.eventId,admins:B(te),"form-dirty":Lt.value,onSubmit:Co,onAddAdmin:se[4]||(se[4]=ce=>ue.value=!0),onRemoveAdmin:Mi,"onUpdate:formDirty":zt},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Ee(GH,{show:Z.value,location:ft.value,"is-dirty":Ge.value,onClose:Tl,onSave:$l,onSetOnMap:hs,"onUpdate:isDirty":Dt,"onUpdate:location":cd},null,8,["show","location","is-dirty"]),Ee(vO,{show:G.value,location:F.value,assignments:F.value?.assignments||[],"event-date":M.value?.eventDate||"",areas:Ct.value,"event-id":B(t).params.eventId,"all-locations":A.value,notes:zo.value,"available-marshals":Aa.value,"all-marshals":oe.value,"all-checklist-items":gn.value,incidents:Xs.value,"is-dirty":Ge.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","z-index":Mn.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:Ml,onSave:Lc,onDelete:fd,onMoveLocation:hd,onRemoveAssignment:pd,onOpenAssignModal:Al,"onUpdate:isDirty":Dt,onSelectIncident:yi,onSelectMarshal:Tc,onReorderNotes:Oa,onReorderChecklists:Na},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ee(lP,{show:K.value,link:Gn.value,"is-dirty":!1,onClose:se[5]||(se[5]=ce=>K.value=!1)},null,8,["show","link"]),Ee(ZP,{show:ae.value,"event-id":B(t).params.eventId,"marshal-id":q.value,"marshal-name":Y.value,onClose:se[6]||(se[6]=ce=>ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ee(JP,{show:B(ue),"is-dirty":Ge.value,onClose:mr,onSubmit:vr,"onUpdate:isDirty":Dt},null,8,["show","is-dirty"]),Ee(n6,{show:B(_e),uploading:B(Te),error:B(Pe),"is-dirty":Ge.value,onClose:_c,onSubmit:Ll,"onUpdate:isDirty":Dt},null,8,["show","uploading","error","is-dirty"]),Ee(h6,{show:B(De),importing:B(H),error:B(de),result:B(ie),"is-dirty":Ge.value,onClose:Ai,onSubmit:Ns,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Ee(SB,{ref_key:"editMarshalModalRef",ref:$e,show:ge.value,marshal:Ne.value,"event-id":B(t).params.eventId,assignments:Ic.value,"available-locations":Ys.value,"all-locations":A.value,areas:Ct.value,"is-editing":!!Ne.value,"event-notes":zo.value,"all-checklist-items":gn.value,incidents:Pa.value,"all-marshals":oe.value,"is-dirty":Ge.value,"validation-errors":me.value,"locked-checkpoint-id":Oe.value,"z-index":Oe.value?1100:1e3,"role-definitions":Pn.value,onClose:Dl,onSave:xc,onDelete:$c,onRemoveAssignment:md,onAssignToLocation:Ha,"onUpdate:isDirty":Dt,onSelectIncident:vl,onSelectCheckpoint:gd,onReorderNotes:Oa,onReorderChecklists:Na},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index","role-definitions"]),Ee(b6,{show:B(ke),importing:B(J),error:B(de),result:B(Re),"is-dirty":Ge.value,onClose:br,onSubmit:vs,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Ee(TB,{show:Be.value,"conflict-data":ze.value,onClose:se[7]||(se[7]=ce=>Be.value=!1),onChoice:Mc},null,8,["show","conflict-data"]),Ee(FB,{show:Ce.value,"location-name":F.value?.name||"",marshals:Aa.value,onClose:kr,onAssignExisting:Ko,onCreateAndAssign:El},null,8,["show","location-name","marshals"]),Ee(JB,{show:xt.value,"old-event-date":Kt.value,"new-event-date":no.value,"affected-checkpoints-count":Mo.value,onConfirm:ea,onCancel:ki},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ee(d7,{ref_key:"editAreaModalRef",ref:oo,show:Mn.value,area:Mt.value,"initial-tab":go.value,checkpoints:A.value,marshals:oe.value,areas:Ct.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"is-dirty":Ge.value,"event-id":B(t).params.eventId,"all-locations":A.value,assignments:ls.value,notes:zo.value,contacts:ao.value,incidents:Qs.value,"role-definitions":Pn.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onClose:us,onSave:na,onDelete:gl,onDrawBoundary:ln,"onUpdate:isDirty":Dt,onSelectCheckpoint:ps,onCreateContactFromMarshal:oa,onCreateNewContact:fr,onEditContact:yl,onSelectIncident:hr,onReorderNotes:Oa,onReorderChecklists:Na,onReorderContacts:Ti},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","route-color","route-style","route-weight","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","role-definitions","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ee($7,{show:Zs.value,"checklist-item":Vn.value,"initial-tab":ko.value,areas:Ct.value,locations:A.value,marshals:oe.value,"is-dirty":Ge.value,"next-display-order":hl.value,onClose:On,onSave:jo,onDelete:Ci,"onUpdate:isDirty":Dt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty","next-display-order"]),Ee(G7,{show:Ta.value,note:Ho.value,"initial-tab":Vo.value,areas:Ct.value,locations:A.value,marshals:oe.value,"is-dirty":Ge.value,onClose:aa,onSave:bl,onDelete:Si,"onUpdate:isDirty":Dt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ee(L1,{show:Ao.value,incident:En.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,checkpoints:A.value,"can-manage":!0,onClose:Ii,onStatusChange:xi,onOpenAddNote:$i},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints"]),Ee(Zt,{show:Ks.value,title:"Add update",size:"small",onClose:Ba},{footer:Ve(()=>[r("div",hV,[r("button",{type:"button",class:"btn btn-secondary",onClick:Ba}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Fa,disabled:!so.value.trim()||ss.value},w(ss.value?"Adding...":"Add update"),9,fV)])]),default:Ve(()=>[r("div",dV,[We(r("textarea",{"onUpdate:modelValue":se[8]||(se[8]=ce=>so.value=ce),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,so.value]])])]),_:1},8,["show"]),Ee(S1,{show:Ma.value,"event-id":B(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:A.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,onClose:se[9]||(se[9]=ce=>Ma.value=!1),onSubmit:_l},null,8,["show","event-id","checkpoints","route","route-color","route-style","route-weight"]),Ee(Xz,{show:Bt.value,contact:vt.value,"initial-tab":Eo.value,areas:Ct.value,locations:A.value,marshals:oe.value,"available-roles":as.value,"role-definitions":Pn.value,"is-dirty":Ge.value,"prefilled-name":bn.value,"prefilled-marshal-id":Go.value,"create-from-area-context":!!wo.value,onClose:ia,onSave:Os,onDelete:Nn,"onUpdate:isDirty":Dt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","role-definitions","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ee(kH,{show:io.value,role:Sn.value,"initial-tab":is.value,people:dt.value,"loading-people":Yt.value,"is-dirty":Ge.value,onClose:Ht,onSave:mt,onDelete:$t,"onUpdate:isDirty":Dt,onLoadPeople:Bn},null,8,["show","role","initial-tab","people","loading-people","is-dirty"]),Ee(PH,{show:B(Uo),mode:B(pe),"context-title":B(ve).title,"context-description":B(ve).description,"can-complete":Js.value,clickable:B(pe)!=="draw-area","drawing-mode":B(pe)==="draw-area"&&B(on),locations:gi.value,areas:rs.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"selected-area-id":An.value,center:B(Qe),zoom:B(Nt),"highlight-location-id":Ea.value,onMapClick:gr,onPolygonComplete:ro,onPolygonDrawing:wt,onDone:Cc,onCancel:Il},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","route-color","route-style","route-weight","selected-area-id","center","zoom","highlight-location-id"]),Ee(wc,{show:He.value,title:rt.value,message:kt.value,onClose:se[10]||(se[10]=ce=>He.value=!1)},null,8,["show","title","message"]),Ee(hi,{show:B(c),title:B(d),message:B(h),"is-danger":B(f),"confirm-text":B(m),onConfirm:B(k),onCancel:B(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},mV=Ke(vV,[["__scopeId","data-v-efdf1f23"]]),gV={key:0,class:"emergency-notes-section"},yV={class:"emergency-notes-list"},kV={class:"note-header"},bV={key:0,class:"note-content"},wV={key:1,class:"emergency-contacts-section"},_V={class:"emergency-contacts-list"},CV={class:"contact-header"},LV={key:0,class:"role-badge"},SV={class:"contact-details"},IV={key:0,class:"info-section"},xV=["href"],$V={key:1,class:"info-section"},TV=["href"],MV={key:2,class:"info-section"},AV=["href"],EV={key:2,class:"no-contacts"},PV={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,s=t,o=z(()=>n.notes?[...n.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,b=f.displayOrder||f.DisplayOrder||0;if(k!==b)return k-b;const I=h.priority||h.Priority,T=f.priority||f.Priority;return I==="Emergency"&&T!=="Emergency"?-1:T==="Emergency"&&I!=="Emergency"?1:0}):[]),i=z(()=>n.contacts?n.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,b=f.displayOrder||f.DisplayOrder||0;if(k!==b)return k-b;const I=h.name||h.Name||"",T=f.name||f.Name||"";return I.localeCompare(T,void 0,{sensitivity:"base"})}):[]),l=()=>{s("close")},c=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(p(),qe(Zt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Ve(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[o.value.length>0?(p(),g("div",gV,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",yV,[(p(!0),g(Se,null,je(o.value,m=>(p(),g("div",{key:m.noteId||m.NoteId,class:le(["emergency-note-item",{"is-emergency":(m.priority||m.Priority)==="Emergency"}])},[r("div",kV,[r("h3",null,w(m.title||m.Title),1),r("span",{class:le(["priority-badge",(m.priority||m.Priority).toLowerCase()])},w(m.priority||m.Priority),3)]),m.content||m.Content?(p(),g("div",bV,w(m.content||m.Content),1)):P("",!0)],2))),128))])])):P("",!0),i.value&&i.value.length>0?(p(),g("div",wV,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",_V,[(p(!0),g(Se,null,je(i.value,m=>(p(),g("div",{key:m.contactId||m.name,class:"emergency-contact-item"},[r("div",CV,[r("h3",null,w(m.name),1),d(m).length>0?(p(),g("span",LV,w(d(m).map(c).join(", ")),1)):P("",!0)]),r("div",SV,[m.phone?(p(),g("div",IV,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${m.phone}`,class:"phone-link"},w(m.phone),9,xV)])):P("",!0),m.email?(p(),g("div",$V,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${m.email}`,class:"email-link"},w(m.email),9,TV)])):P("",!0),m.notes||m.details?(p(),g("div",MV,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,w(m.notes||m.details),1)])):P("",!0)]),m.phone?(p(),g("a",{key:0,href:`tel:${m.phone}`,class:"btn btn-danger btn-full"}," Call "+w(m.name),9,AV)):P("",!0)]))),128))])])):P("",!0),i.value.length===0&&o.value.length===0?(p(),g("div",EV,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},DV=Ke(PV,[["__scopeId","data-v-6ae197f1"]]),Pr=D(navigator.onLine),ka=D(!0),ai=D(0),jc=D(null),Zi=D("idle"),er=D(null),of=D(!1);let gm=null,bh=!1,ws=null,ym=0;function RV(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Pu(){ws&&(clearTimeout(ws),ws=null);const e=RV(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),ws=setTimeout(async()=>{if(ws=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await _u()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Du();const n=await _u();n>0&&navigator.onLine&&(console.log(`${n} actions remaining, scheduling retry...`),Pu())},e)}async function Zl(){if(!navigator.onLine)return ka.value=!1,!1;try{return await SC.check(),ka.value=!0,!0}catch(e){return e.response?.status===404?(ka.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),ka.value=!1,!1)}}async function zf(){const e=Date.now();if(e-ym<2e3)return;ym=e;const t=navigator.onLine;if(Pr.value=t,!t){ka.value=!1;return}of.value=!0;try{await Zl()&&ai.value>0&&Pu()}finally{of.value=!1}}function km(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),zf())}function bm(){console.log("Window focused, checking connectivity..."),zf()}async function OV(e){try{switch(e.type){case"checkin":await ri.checkIn(e.payload);break;case"checkin_toggle":await ri.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await ri.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const n=t.response.data?.message||t.response.data||"",s=typeof n=="string"?n.toLowerCase():"";if(s.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(s.includes("already completed")||s.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Du(){if(!bh&&navigator.onLine){bh=!0,Zi.value="syncing",er.value=null;try{const e=await zy();if(e.length===0){Zi.value="success",ai.value=0;return}let t=0,n=0;for(const s of e){const o=await OV(s);if(o===!0)await wv(s.id),t++;else if(o==="permanent_failure")await wv(s.id),n++;else{const i=(s.attempts||0)+1;i>=5?(await bv(s.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),n++):await bv(s.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ai.value=await _u(),n>0?(Zi.value="error",er.value=`${n} action(s) failed to sync`):Zi.value="success"}catch(e){console.error("Sync error:",e),Zi.value="error",er.value="Failed to sync pending actions"}finally{bh=!1}}}function NV(){gm||(gm=setInterval(async()=>{navigator.onLine&&(await Zl(),ka.value&&ai.value>0&&await Du())},3e4))}function Hf(){const e=z(()=>Pr.value&&ka.value);async function t(){ai.value=await _u()}async function n(){Pr.value=!0,await Zl()&&ai.value>0&&Pu()}function s(){Pr.value=!1,ka.value=!1,ws&&(clearTimeout(ws),ws=null)}un(async()=>{await xa(),await t(),window.addEventListener("online",n),window.addEventListener("offline",s),document.addEventListener("visibilitychange",km),window.addEventListener("focus",bm),navigator.onLine&&await Zl()&&ai.value>0&&Pu(),NV()}),Ln(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s),document.removeEventListener("visibilitychange",km),window.removeEventListener("focus",bm),ws&&(clearTimeout(ws),ws=null)});async function o(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await lc(d,f),jc.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await li(d);return h&&(jc.value=h.cachedAt),h}async function l(d){jc.value=await gC(d)}async function c(){return navigator.onLine?await Zl()?(await Du(),Zi.value==="success"):(er.value="Server is not responding",!1):(er.value="Cannot sync while offline",!1)}return{isOnline:Pr,isServerHealthy:ka,isFullyOnline:e,isCheckingStatus:of,pendingActionsCount:ai,lastSyncTime:jc,syncStatus:Zi,syncError:er,checkServerHealth:Zl,quickConnectivityCheck:zf,syncPendingActions:Du,updatePendingCount:t,refreshCache:o,getCachedData:i,loadLastSyncTime:l,forcSync:c}}const BV={class:"offline-indicator-container"},FV={class:"offline-icon"},UV={key:0,viewBox:"0 0 24 24",fill:"currentColor"},zV={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},HV={class:"offline-text"},VV={key:0,class:"last-sync"},GV={class:"pending-text"},qV={key:0,class:"pending-subtext"},jV={key:1,class:"syncing-text"},WV={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:n,isCheckingStatus:s,pendingActionsCount:o,lastSyncTime:i,syncStatus:l,syncError:c,forcSync:d}=Hf(),h=D(!1),f=D(""),m=D(""),y=z(()=>{if(!i.value)return"";const b=new Date(i.value),T=new Date-b,E=Math.floor(T/6e4),x=Math.floor(E/60);return E<1?"just now":E<60?`${E}m ago`:x<24?`${x}h ago`:b.toLocaleDateString()}),k=async()=>{await d()};return Ye(l,b=>{b==="success"&&o.value===0?(f.value="All actions synced successfully!",m.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):b==="error"&&(f.value=c.value||"Sync failed",m.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(b,I)=>(p(),g("div",BV,[Ee(Is,{name:"slide"},{default:Ve(()=>[B(n)?P("",!0):(p(),g("div",{key:0,class:le(["offline-banner",{checking:B(s)}])},[r("span",FV,[B(s)?(p(),g("svg",zV,[...I[1]||(I[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(p(),g("svg",UV,[...I[0]||(I[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",HV,w(B(s)?"Checking connection...":B(t)?"Server unavailable":"You're offline"),1),B(i)&&!B(s)?(p(),g("span",VV," Last synced: "+w(y.value),1)):P("",!0)],2))]),_:1}),Ee(Is,{name:"fade"},{default:Ve(()=>[B(o)>0?(p(),g("div",{key:0,class:le(["pending-banner",{"offline-pending":!B(n)}])},[I[2]||(I[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",GV,[Je(w(B(o))+" pending action"+w(B(o)!==1?"s":"")+" ",1),B(n)?P("",!0):(p(),g("span",qV,"(will sync when online)"))]),B(n)&&B(l)!=="syncing"?(p(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):B(l)==="syncing"?(p(),g("span",jV,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Ee(Is,{name:"fade"},{default:Ve(()=>[h.value?(p(),g("div",{key:0,class:le(["sync-toast",m.value])},w(f.value),3)):P("",!0)]),_:1})]))}},ZV=Ke(WV,[["__scopeId","data-v-9c1e58f4"]]),KV={class:"modal-content check-in-reminder-modal"},YV={class:"modal-header warning"},JV={class:"modal-body"},XV={class:"reminder-message"},QV={key:0},eG={class:"reminder-hint"},tG={class:"modal-footer"},nG={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ht();return(n,s)=>(p(),qe(Is,{name:"modal"},{default:Ve(()=>[e.show&&e.checkpoint?(p(),g("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=ct(o=>n.$emit("dismiss"),["self"]))},[r("div",KV,[r("div",YV,[s[4]||(s[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:s[0]||(s[0]=o=>n.$emit("dismiss"))},"")]),r("div",JV,[s[6]||(s[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",XV,[Je(" You have not checked in yet to "+w(B(t).checkpoint)+" ",1),r("strong",null,w(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(p(),g("span",QV," - "+w(e.checkpoint.location.description),1)):P("",!0),s[5]||(s[5]=Je(". ",-1))]),r("p",eG," Please check in when you arrive at your "+w(B(t).checkpoint)+". ",1)]),r("div",tG,[r("button",{onClick:s[1]||(s[1]=o=>n.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:s[2]||(s[2]=o=>n.$emit("go-to-checkpoint")),class:"btn btn-primary",style:tt(e.accentButtonStyle)}," Go to "+w(B(t).checkpoint),5)])])])):P("",!0)]),_:1}))}},oG=Ke(nG,[["__scopeId","data-v-4761fdb9"]]),sG={class:"modal-content location-update-modal"},aG={class:"modal-header"},iG={class:"modal-body"},lG={key:0,class:"success-message"},rG={key:1},cG={class:"modal-description"},uG={key:0,class:"last-update-info"},dG={key:1,class:"gps-status active"},hG={class:"update-option"},fG=["disabled"],pG={class:"update-option auto-update-option"},vG={class:"checkbox-label"},mG=["checked"],gG={class:"option-hint"},yG={class:"update-option"},kG=["disabled"],bG={class:"update-option"},wG={class:"option-label"},_G={key:0,class:"checkpoint-list"},CG=["onClick","disabled"],LG={class:"checkpoint-name"},SG={key:0,class:"checkpoint-description"},IG={key:1,class:"no-checkpoints"},xG={key:2,class:"error"},$G={class:"modal-footer"},TG={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ht(),n=o=>o?new Date(o).toLocaleString():"",s=(o,i=50)=>o?o.length<=i?o:o.substring(0,i).trim()+"...":"";return(o,i)=>(p(),qe(Is,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=ct(l=>o.$emit("close"),["self"]))},[r("div",sG,[r("div",aG,[r("h3",null,"Update "+w(B(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>o.$emit("close"))},"")]),r("div",iG,[e.success?(p(),g("div",lG,w(e.success),1)):(p(),g("div",rG,[r("p",cG,[i[6]||(i[6]=Je(" Update the position of ",-1)),r("strong",null,w(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(p(),g("div",uG," Last updated: "+w(n(e.assignment.location.lastLocationUpdate)),1)):P("",!0),e.userLocation?(p(),g("div",dG,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):P("",!0),r("div",hG,[r("button",{onClick:i[1]||(i[1]=l=>o.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:tt(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+w(e.updating?"Updating...":"Use current GPS location"),1)],12,fG)]),r("div",pG,[r("label",vG,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>o.$emit("toggle-auto-update"))},null,40,mG),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",gG,"Automatically updates the "+w(B(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",yG,[r("button",{onClick:i[3]||(i[3]=l=>o.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,kG)]),r("div",bG,[r("label",wG,"Or copy location from another "+w(B(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(p(),g("div",_G,[(p(!0),g(Se,null,je(e.availableCheckpoints,l=>(p(),g("button",{key:l.id,onClick:c=>o.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",LG,w(l.name),1),l.description?(p(),g("span",SG,w(s(l.description)),1)):P("",!0)],8,CG))),128))])):(p(),g("p",IG," No other "+w(B(t).checkpoints)+" available to copy from. ",1))]),e.error?(p(),g("div",xG,w(e.error),1)):P("",!0)]))]),r("div",$G,[r("button",{onClick:i[4]||(i[4]=l=>o.$emit("close")),class:"btn btn-secondary"},w(e.success?"Ok":"Cancel"),1)])])])):P("",!0)]),_:1}))}},MG=Ke(TG,[["__scopeId","data-v-b3924a32"]]),AG={class:"contact-info"},EG={class:"contact-name-row"},PG={key:0,class:"primary-badge"},DG={class:"contact-name"},RG={key:0,class:"contact-notes-text"},OG={key:1,class:"contact-detail"},NG={key:2,class:"contact-detail"},BG={class:"contact-actions"},FG=["href"],UG=["href"],zG=["href"],HG={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,n=z(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),s=["Emergency","Safety","Medical","First Aid"],o=z(()=>n.value.length===0?!1:n.value.some(c=>s.some(d=>c.toLowerCase().includes(d.toLowerCase())))),i=c=>c?c.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=z(()=>n.value.length===0?"":n.value.map(i).join(", "));return(c,d)=>(p(),g("div",{class:le(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",AG,[r("div",EG,[e.isPrimary?(p(),g("span",PG,"")):P("",!0),r("span",DG,w(e.name),1),n.value.length>0?(p(),g("span",{key:1,class:le(["contact-role-badge",{"emergency-role":o.value}])},w(l.value),3)):P("",!0)]),e.notes?(p(),g("div",RG,w(e.notes),1)):P("",!0),e.phone?(p(),g("div",OG,w(e.phone),1)):P("",!0),e.email?(p(),g("div",NG,w(e.email),1)):P("",!0)]),r("div",BG,[e.phone?(p(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,FG)):P("",!0),e.phone?(p(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,UG)):P("",!0),e.email?(p(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,zG)):P("",!0)])],2))}},I1=Ke(HG,[["__scopeId","data-v-2fdc8dea"]]),VG={key:0,class:"accordion-section"},GG={class:"accordion-title"},qG=["innerHTML"],jG={key:0,class:"header-count"},WG={class:"accordion-icon"},ZG={key:0,class:"accordion-content"},KG={key:0,class:"loading"},YG={key:1,class:"contact-list"},JG={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.contacts.length>0||e.loading?(p(),g("div",VG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",GG,[r("span",{class:"section-icon",innerHTML:B(to)("contacts")},null,8,qG),Je(" Your "+w(e.contacts.length===1?"contact":"contacts"),1),e.contacts.length>1?(p(),g("span",jG," ("+w(e.contacts.length)+")",1)):P("",!0)]),r("span",WG,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",ZG,[e.loading?(p(),g("div",KG,"Loading contacts...")):(p(),g("div",YG,[(p(!0),g(Se,null,je(e.contacts,s=>(p(),qe(I1,{key:s.contactId,name:s.name,roles:s.roles,role:s.role,phone:s.phone,email:s.email,notes:s.notes,"is-primary":s.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):P("",!0)])):P("",!0)}},XG=Ke(JG,[["__scopeId","data-v-87bba6dd"]]),QG={key:0,class:"accordion-section"},eq={class:"accordion-title"},tq=["innerHTML"],nq={key:0,class:"header-count"},oq={class:"accordion-icon"},sq={key:0,class:"accordion-content"},aq={key:0,class:"loading-state"},iq={key:1,class:"empty-state"},lq={key:2,class:"incidents-list"},rq={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,n)=>e.incidents.length>0||e.loading?(p(),g("div",QG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",eq,[r("span",{class:"section-icon",innerHTML:B(to)("incidents")},null,8,tq),Je(" Your "+w(e.incidents.length===1?"incident":"incidents"),1),e.incidents.length>1?(p(),g("span",nq," ("+w(e.incidents.length)+")",1)):P("",!0)]),r("span",oq,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",sq,[e.loading?(p(),g("div",aq," Loading incidents... ")):e.incidents.length===0?(p(),g("div",iq,[...n[1]||(n[1]=[r("p",null,"No incidents to show.",-1)])])):(p(),g("div",lq,[(p(!0),g(Se,null,je(e.incidents,s=>(p(),qe(kc,{key:s.incidentId,incident:s,onSelect:o=>t.$emit("select-incident",s)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0)}},cq=Ke(rq,[["__scopeId","data-v-8a5966fd"]]),uq={key:0,class:"accordion-section"},dq={class:"accordion-title"},hq=["innerHTML"],fq={class:"accordion-icon"},pq={key:0,class:"accordion-content"},vq={class:"event-details"},mq={key:0,class:"event-detail-row"},gq={class:"detail-value"},yq={key:1,class:"event-description"},kq={class:"detail-value"},bq={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=n=>n?new Date(n).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(n,s)=>e.eventDate||e.description?(p(),g("div",uq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:s[0]||(s[0]=o=>n.$emit("toggle"))},[r("span",dq,[r("span",{class:"section-icon",innerHTML:B(to)("event")},null,8,hq),s[1]||(s[1]=Je(" Event details ",-1))]),r("span",fq,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",pq,[r("div",vq,[e.eventDate?(p(),g("div",mq,[s[2]||(s[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",gq,w(t(e.eventDate)),1)])):P("",!0),e.description?(p(),g("div",yq,[s[3]||(s[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",kq,w(e.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)}},wq=Ke(bq,[["__scopeId","data-v-7c880ad1"]]),_q={class:"accordion-section"},Cq={class:"accordion-title"},Lq=["innerHTML"],Sq={class:"header-count"},Iq={class:"header-count"},xq={class:"accordion-icon"},$q={key:0,class:"accordion-content"},Tq={key:0,class:"loading"},Mq={key:1,class:"error"},Aq={key:2,class:"empty-state"},Eq={class:"checklist-section"},Pq={key:0,class:"empty-state small"},Dq={key:1,class:"my-jobs-list"},Rq=["checked","disabled","onChange"],Oq={class:"my-job-content"},Nq={key:0,class:"context-info"},Bq={key:1,class:"completion-info"},Fq={class:"completion-text"},Uq={class:"completion-time"},zq={key:0,class:"checklist-section"},Hq={class:"checklist-section-title"},Vq={key:0,class:"checklist-items"},Gq={class:"item-checkbox"},qq=["checked","disabled","onChange"],jq={class:"item-content"},Wq={key:0,class:"item-context"},Zq={key:1,class:"completion-info"},Kq={class:"completion-text"},Yq={class:"completion-time"},Jq={key:1,class:"checklist-groups"},Xq=["onClick"],Qq={class:"group-title"},ej={class:"group-status"},tj={class:"group-count"},nj={class:"group-expand-icon"},oj={key:0,class:"checklist-group-items"},sj={class:"item-checkbox"},aj=["checked","disabled","onChange"],ij={class:"item-content"},lj={key:0,class:"completion-info"},rj={class:"completion-text"},cj={class:"completion-time"},uj={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ht(),n=e,s=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],o=z(()=>{let b=0;const I=new Set;for(const T of n.myItems)if(s.includes(T.matchedScope)&&T.completionContextId){const E=`${T.itemId}_${T.completionContextId}`;I.has(E)||(I.add(E),b++)}else b++;return b}),i=z(()=>{let b=0;const I=new Set;for(const T of n.myItems)if(s.includes(T.matchedScope)&&T.completionContextId){const E=`${T.itemId}_${T.completionContextId}`;I.has(E)||(I.add(E),T.isCompleted&&b++)}else T.isCompleted&&b++;return b}),l=z(()=>o.value-i.value),c=z(()=>{let b=0;const I=new Set;for(const T of n.visibleItems)if(s.includes(T.matchedScope)&&T.completionContextId){const E=`${T.itemId}_${T.completionContextId}`;I.has(E)||(I.add(E),T.isCompleted||b++)}else T.isCompleted||b++;return b}),d=z(()=>{let b=0;const I=new Set;for(const T of n.areaItems)if(s.includes(T.matchedScope)&&T.completionContextId){const E=`${T.itemId}_${T.completionContextId}`;I.has(E)||(I.add(E),n.areaItems.some(C=>C.itemId===T.itemId&&C.completionContextId===T.completionContextId&&C.isCompleted)||b++)}else T.isCompleted||b++;return b}),h=b=>{if(!b)return"";const I=new Date(b),x=(new Date-I)/(1e3*60*60);return x<24&&x>=0?I.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):I.toLocaleString()},f=b=>b.completedByActorName&&b.contextOwnerName&&b.completedByActorName!==b.contextOwnerName?`${b.completedByActorName} on behalf of ${b.contextOwnerName}`:b.completedByActorName||"Unknown",m=b=>{if(b.completionContextType==="Checkpoint"&&b.completionContextId){const I=n.locations.find(T=>T.id===b.completionContextId);if(I){if(I.description){const E=I.description.length>50?I.description.substring(0,50)+"...":I.description;return`${I.name} - ${E}`}return I.name}}if(b.completionContextType==="Area"&&b.completionContextId){const I=n.areas.find(T=>T.id===b.completionContextId);if(I)return I.name}return""},y=b=>b.completionContextType==="Checkpoint"&&b.completionContextId?n.locations.find(T=>T.id===b.completionContextId)?.name||"":b.completionContextType==="Area"&&b.completionContextId&&n.areas.find(T=>T.id===b.completionContextId)?.name||"",k=z(()=>{if(!n.myItems||n.myItems.length===0)return[];const b=new Map;for(const T of n.myItems)b.set(T.text,(b.get(T.text)||0)+1);return[...n.myItems].sort((T,E)=>{const x=T.text.localeCompare(E.text,void 0,{sensitivity:"base"});if(x!==0)return x;const C=y(T),_=y(E);return C.localeCompare(_,void 0,{numeric:!0,sensitivity:"base"})}).map(T=>({...T,needsDisambiguation:b.get(T.text)>1,contextDisplayName:m(T)}))});return(b,I)=>(p(),g("div",_q,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:I[0]||(I[0]=T=>b.$emit("toggle"))},[r("span",Cq,[r("span",{class:"section-icon",innerHTML:B(to)("checklist")},null,8,Lq),e.isAreaLead?(p(),g(Se,{key:0},[Je(" Your "+w(B(t).checklists)+" ",1),r("span",Sq,"(You: "+w(l.value)+", Your "+w(B(t).area)+": "+w(d.value)+")",1)],64)):(p(),g(Se,{key:1},[Je(" Your "+w(B(t).checklists)+" ",1),r("span",Iq,"("+w(c.value)+")",1)],64))]),r("span",xq,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",$q,[e.loading?(p(),g("div",Tq,"Loading checklist...")):e.error?(p(),g("div",Mq,w(e.error),1)):o.value===0&&(!e.isAreaLead||e.areaItems.length===0)?(p(),g("div",Aq,[r("p",null,"No "+w(B(t).checklists)+" for you.",1)])):e.isAreaLead?(p(),g(Se,{key:3},[r("div",Eq,[I[3]||(I[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),k.value.length===0?(p(),g("div",Pq,[...I[2]||(I[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(p(),g("div",Dq,[(p(!0),g(Se,null,je(k.value,T=>(p(),g("div",{key:`${T.itemId}_${T.completionContextType}_${T.completionContextId}`,class:le(["my-job-item",{"item-completed":T.isCompleted}])},[r("input",{type:"checkbox",checked:T.isCompleted,disabled:e.saving||!T.canBeCompletedByMe,onChange:E=>b.$emit("toggle-item",T)},null,40,Rq),r("div",Oq,[r("span",{class:le(["my-job-text",{completed:T.isCompleted}])},w(T.text),3),T.needsDisambiguation&&T.contextDisplayName?(p(),g("div",Nq,w(T.contextDisplayName),1)):P("",!0),T.isCompleted&&T.completedByActorName?(p(),g("div",Bq,[r("span",Fq,w(f(T)),1),r("span",Uq,w(h(T.completedAt)),1)])):P("",!0)])],2))),128))]))]),e.areaItems.length>0?(p(),g("div",zq,[r("h4",Hq,"Your "+w(B(t).area)+"'s jobs",1),Ee(Uf,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:I[1]||(I[1]=T=>b.$emit("toggle-item",T))},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(p(),g(Se,{key:4},[e.effectiveGroupBy==="none"?(p(),g("div",Vq,[(p(!0),g(Se,null,je(e.visibleItems,T=>(p(),g("div",{key:`${T.itemId}_${T.completionContextType}_${T.completionContextId}`,class:le(["checklist-item",{"item-completed":T.isCompleted}])},[r("div",Gq,[r("input",{type:"checkbox",checked:T.isCompleted,disabled:!T.canBeCompletedByMe||e.saving,onChange:E=>b.$emit("toggle-item",T)},null,40,qq)]),r("div",jq,[r("div",{class:le(["item-text",{"text-completed":T.isCompleted}])},w(T.text),3),e.getContextName(T)?(p(),g("div",Wq,w(e.getContextName(T)),1)):P("",!0),T.isCompleted?(p(),g("div",Zq,[r("span",Kq,w(f(T)),1),r("span",Yq,w(h(T.completedAt)),1)])):P("",!0)])],2))),128))])):(p(),g("div",Jq,[(p(!0),g(Se,null,je(e.groupedItems,T=>(p(),g("div",{key:T.key,class:"checklist-group"},[r("button",{class:le(["checklist-group-header",{expanded:e.expandedGroup===T.key,"all-complete":T.completedCount===T.items.length}]),onClick:E=>b.$emit("toggle-group",T.key)},[r("span",Qq,w(T.name),1),r("span",ej,[r("span",tj,w(T.completedCount)+"/"+w(T.items.length),1),r("span",nj,w(e.expandedGroup===T.key?"":"+"),1)])],10,Xq),e.expandedGroup===T.key?(p(),g("div",oj,[(p(!0),g(Se,null,je(T.items,E=>(p(),g("div",{key:`${E.itemId}_${E.completionContextType}_${E.completionContextId}`,class:le(["checklist-item",{"item-completed":E.isCompleted}])},[r("div",sj,[r("input",{type:"checkbox",checked:E.isCompleted,disabled:!E.canBeCompletedByMe||e.saving,onChange:x=>b.$emit("toggle-item",E)},null,40,aj)]),r("div",ij,[r("div",{class:le(["item-text",{"text-completed":E.isCompleted}])},w(E.text),3),E.isCompleted?(p(),g("div",lj,[r("span",rj,w(f(E)),1),r("span",cj,w(h(E.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]))}},dj=Ke(uj,[["__scopeId","data-v-61ed0a0d"]]),hj={class:"accordion-section"},fj={class:"accordion-title"},pj=["innerHTML"],vj={key:0,class:"header-count"},mj={class:"accordion-icon"},gj={key:0,class:"accordion-content"},yj={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,n)=>(p(),g("div",hj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",fj,[r("span",{class:"section-icon",innerHTML:B(to)("notes")},null,8,pj),Je(" Your "+w(e.notes.length===1?"note":"notes"),1),e.notes.length>1?(p(),g("span",vj," ("+w(e.notes.length)+")",1)):P("",!0)]),r("span",mj,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",gj,[Ee(ld,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:n[1]||(n[1]=s=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]))}},kj=Ke(yj,[["__scopeId","data-v-ef145eb9"]]),bj={class:"accordion-section"},wj={class:"accordion-title"},_j=["innerHTML"],Cj={key:0,class:"location-status active"},Lj={key:1,class:"location-status"},Sj={class:"accordion-icon"},Ij={key:0,class:"accordion-content map-content"},xj={key:0,class:"map-selection-banner"},$j={class:"map-wrapper"},Tj={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:n}=ht(),s=xo("marshalBranding",{headerStyle:{},headerTextColor:""}),o=sl({headerStyle:z(()=>ru(s.headerStyle)),headerTextColor:z(()=>ru(s.headerTextColor))}),i=D(null);return t({mapRef:i,recenterOnLocation:(l,c,d)=>i.value?.recenterOnLocation?.(l,c,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,c)=>(p(),g("div",bj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:c[0]||(c[0]=d=>l.$emit("toggle"))},[r("span",wj,[r("span",{class:"section-icon",innerHTML:B(to)("course")},null,8,_j),Je(" "+w(B(n).course)+" ",1),e.userLocation?(p(),g("span",Cj,"GPS Active")):(p(),g("span",Lj,"GPS Inactive"))]),r("span",Sj,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Ij,[e.selectingLocation?(p(),g("div",xj,[r("span",null,[c[7]||(c[7]=Je("Click on the map to set the new location for ",-1)),r("strong",null,w(e.selectingLocationName),1)]),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),r("div",$j,[Ee(il,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!1,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":B(n).course,"fullscreen-header-style":o.headerStyle,"fullscreen-header-text-color":o.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:le({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:c[3]||(c[3]=d=>l.$emit("map-click",d)),onLocationClick:c[4]||(c[4]=d=>l.$emit("location-click",d)),onActionClick:c[5]||(c[5]=d=>l.$emit("action-click",d)),onVisibilityChange:c[6]||(c[6]=d=>l.$emit("visibility-change",d))},yf({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ve(()=>[r("span",null,[c[8]||(c[8]=Je("Click on the map to set the new location for ",-1)),r("strong",null,w(e.selectingLocationName),1)]),r("button",{onClick:c[2]||(c[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]))}},Mj=Ke(Tj,[["__scopeId","data-v-ff7cc2e4"]]),Aj={class:"area-lead-content"},Ej={key:0,class:"loading-state"},Pj={key:1,class:"error-state"},Dj={key:2,class:"empty-state"},Rj={key:3,class:"checkpoint-accordion"},Oj=["onClick"],Nj={class:"checkpoint-header-content"},Bj={class:"checkpoint-title-row"},Fj={class:"checkpoint-name"},Uj={key:0,class:"area-badge"},zj={key:0,class:"checkpoint-description-preview"},Hj={class:"checkpoint-status-row"},Vj={class:"status-badge marshals-status"},Gj={key:0,class:"status-badge tasks-status"},qj={class:"accordion-icon"},jj={key:0,class:"checkpoint-accordion-content"},Wj={class:"checkpoint-mini-map"},Zj={class:"checkpoint-marshals-section"},Kj={class:"marshals-label"},Yj={key:0,class:"empty-state"},Jj={key:1,class:"marshals-list"},Xj=["onClick"],Qj={class:"marshal-header"},eW={class:"marshal-name-row"},tW={class:"marshal-name"},nW={key:0,class:"task-count"},oW={class:"check-status-row"},sW=["onClick","disabled"],aW={key:0,class:"check-in-time"},iW={key:0},lW={key:1,class:"last-access-time"},rW={key:0,class:"checkpoint-tasks-section"},cW={class:"marshals-label"},uW={class:"tasks-list"},dW=["disabled","onChange"],hW={class:"task-text"},fW=["disabled","onChange"],pW={class:"task-text"},vW={key:0,class:"marshal-details-modal"},mW={class:"details-section"},gW={class:"contact-info"},yW={key:0,class:"contact-row"},kW=["href"],bW={key:1,class:"contact-row"},wW=["href"],_W={key:2,class:"no-contact"},CW={class:"details-section"},LW={key:0,class:"checked-in-section"},SW={class:"checked-in-details"},IW={class:"check-time-detail"},xW={key:0,class:"check-method"},$W=["disabled"],TW={key:1,class:"not-checked-in-section"},MW=["disabled"],AW={key:2,class:"last-access-detail"},EW={class:"details-section"},PW={key:0,class:"no-tasks"},DW={key:1,class:"tasks-list modal-tasks"},RW=["disabled","onChange"],OW={class:"task-text"},NW={class:"details-section contact-actions-section"},BW={class:"contact-buttons"},FW=["href"],UW=["href"],zW=["href"],HW={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=ht(),{updatePendingCount:i}=Hf(),l=e,c=n,d=D(!1),h=D(null),f=D([]),m=D([]),y=D(null),k=D(!1),b=D(null),I=z(()=>{const q=new Set(l.areaIds);return q.size===0?[...m.value].sort((Y,te)=>es(Y.name,te.name)):m.value.filter(Y=>(Y.areaIds||[]).some(ue=>q.has(ue))).sort((Y,te)=>es(Y.name,te.name))}),T=(q,Y=60)=>q?q.length<=Y?q:q.substring(0,Y).trim()+"...":"",E=D(!1),x=D(null),C=D(null),_=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,Zn()){try{const q=await li(l.eventId);if(q?.areaLeadDashboard){f.value=q.areaLeadDashboard.areas||[],m.value=q.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(q){console.warn("Failed to load cached dashboard:",q)}h.value="Offline - no cached data available",d.value=!1;return}try{const q=await ma.getAreaLeadDashboard(l.eventId);f.value=q.data.areas||[],m.value=q.data.checkpoints||[];try{const Y=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await li(l.eventId)?await eu(l.eventId,"areaLeadDashboard",Y):await lc(l.eventId,{areaLeadDashboard:Y})}catch(Y){console.warn("Failed to cache dashboard:",Y)}}catch(q){console.error("Failed to load area lead dashboard:",q);try{const Y=await li(l.eventId);if(Y?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Y.areaLeadDashboard.areas||[],m.value=Y.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Y){console.warn("Failed to load cached dashboard:",Y)}h.value=q.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},$=q=>{y.value=y.value===q?null:q},R=q=>q.marshals.filter(Y=>Y.isCheckedIn).length,M=q=>{const Y=q.marshals.reduce((te,ue)=>te+ue.outstandingTaskCount,0);return q.outstandingTaskCount+Y},O=(q,Y)=>{x.value=q,C.value=Y,E.value=!0},A=()=>{E.value=!1,x.value=null,C.value=null},U=async(q,Y)=>{if(b.value)return;const te=q.assignmentId||q.id;if(!te){console.error("No assignment ID found for marshal:",q);return}b.value=q.marshalId;try{if(Zn())await Ro("checkin_toggle",{eventId:l.eventId,assignmentId:te}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated");else if(await ri.toggleCheckIn(l.eventId,te),await _(),c("checkin-updated"),x.value?.marshalId===q.marshalId&&C.value){const ue=m.value.find(_e=>_e.checkpointId===C.value.checkpointId);if(ue){const _e=ue.marshals.find(Te=>Te.marshalId===q.marshalId);_e&&(x.value=_e)}}}catch(ue){console.error("Failed to check in marshal:",ue),(Zn()||!ue.response)&&(await Ro("checkin_toggle",{eventId:l.eventId,assignmentId:te}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated"))}finally{b.value=null}},F=async(q,Y)=>{if(k.value)return;k.value=!0;const ue={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId};try{Zn()?(await Ro("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.outstandingTasks=Y.outstandingTasks.filter(_e=>_e.itemId!==q.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),c("checklist-updated")):(await Rt.complete(l.eventId,q.itemId,ue),await _(),c("checklist-updated"))}catch(_e){console.error("Failed to complete task:",_e),(Zn()||!_e.response)&&(await Ro("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.outstandingTasks=Y.outstandingTasks.filter(Te=>Te.itemId!==q.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},j=async(q,Y)=>{if(k.value)return;k.value=!0;const ue={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId,actorMarshalId:l.marshalId};try{Zn()?(await Ro("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(_e=>_e.itemId!==q.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(q),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),c("checklist-updated")):(await Rt.uncomplete(l.eventId,q.itemId,ue),await _(),c("checklist-updated"))}catch(_e){console.error("Failed to uncomplete task:",_e),(Zn()||!_e.response)&&(await Ro("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(Te=>Te.itemId!==q.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(q),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),c("checklist-updated"))}finally{k.value=!1}},Z=async q=>{if(k.value||!x.value)return;k.value=!0;const Y={marshalId:x.value.marshalId,contextType:q.contextType,contextId:q.contextId};try{if(Zn())await Ro("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:Y}),x.value.outstandingTasks=x.value.outstandingTasks.filter(te=>te.itemId!==q.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await i(),c("checklist-updated");else{if(await Rt.complete(l.eventId,q.itemId,Y),await _(),x.value&&C.value){const te=m.value.find(ue=>ue.checkpointId===C.value.checkpointId);if(te){const ue=te.marshals.find(_e=>_e.marshalId===x.value.marshalId);ue&&(x.value=ue)}}c("checklist-updated")}}catch(te){console.error("Failed to complete task:",te),(Zn()||!te.response)&&(await Ro("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:Y}),x.value.outstandingTasks=x.value.outstandingTasks.filter(ue=>ue.itemId!==q.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},X=q=>q?new Date(q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",re=q=>{if(!q)return"";const Y=new Date(q),_e=(new Date-Y)/(1e3*60*60);return _e<24&&_e>=0?Y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Y.toLocaleString()},K=q=>{if(!q)return"";const Y=new Date(q),ue=new Date-Y,_e=Math.floor(ue/6e4),Te=Math.floor(_e/60),Pe=Math.floor(Te/24);return _e<1?"just now":_e<60?`${_e}m ago`:Te<24?`${Te}h ago`:Pe===1?"yesterday":Pe<7?`${Pe}d ago`:Y.toLocaleDateString()},ae=q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${s.value.area} Lead`})[q]||q;return t({areas:f,checkpoints:m,loading:d,loadDashboard:_}),Ye(()=>l.eventId,()=>{_()},{immediate:!0}),(q,Y)=>(p(),g("div",Aj,[d.value?(p(),g("div",Ej," Loading dashboard... ")):h.value?(p(),g("div",Pj,[r("p",null,w(h.value),1),r("button",{onClick:_,class:"btn btn-secondary"},"Retry")])):I.value.length===0?(p(),g("div",Dj,[r("p",null,"No "+w(B(o).checkpoints)+" in your "+w(B(o).areas)+".",1)])):(p(),g("div",Rj,[(p(!0),g(Se,null,je(I.value,te=>(p(),g("div",{key:te.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:le(["checkpoint-accordion-header",{active:y.value===te.checkpointId}]),onClick:ue=>$(te.checkpointId)},[r("div",Nj,[r("div",Bj,[r("span",Fj,w(te.name),1),te.areaName?(p(),g("span",Uj,w(te.areaName),1)):P("",!0)]),te.description?(p(),g("div",zj,w(T(te.description)),1)):P("",!0),r("div",Hj,[r("span",Vj,w(R(te))+" / "+w(te.marshals.length)+" checked in ",1),M(te)>0?(p(),g("span",Gj,w(M(te))+" tasks ",1)):P("",!0)])]),r("span",qj,w(y.value===te.checkpointId?"":"+"),1)],10,Oj),y.value===te.checkpointId?(p(),g("div",jj,[r("div",Wj,[Ee(il,{locations:[{id:te.checkpointId,name:te.name,description:te.description,latitude:te.latitude,longitude:te.longitude}],route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:te.latitude,lng:te.longitude},zoom:16,"highlight-location-id":te.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","route-color","route-style","route-weight","center","highlight-location-id"])]),r("div",Zj,[r("div",Kj,w(B(s).people)+" ("+w(te.marshals.length)+")",1),te.marshals.length===0?(p(),g("div",Yj," No "+w(B(o).people)+" assigned to this "+w(B(o).checkpoint)+". ",1)):(p(),g("div",Jj,[(p(!0),g(Se,null,je(te.marshals,ue=>(p(),g("div",{key:ue.marshalId,class:le(["marshal-card",{"is-checked-in":ue.isCheckedIn}]),onClick:_e=>O(ue,te)},[r("div",Qj,[r("div",eW,[r("span",tW,w(ue.name),1),ue.outstandingTaskCount>0?(p(),g("span",nW,w(ue.outstandingTaskCount)+" tasks ",1)):P("",!0)]),r("div",oW,[r("div",{class:le(["check-status",{"checked-in":ue.isCheckedIn}])},w(ue.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:ct(_e=>U(ue),["stop"]),class:le(["quick-checkin-btn",{"undo-btn":ue.isCheckedIn}]),disabled:b.value===ue.marshalId},w(b.value===ue.marshalId?"...":ue.isCheckedIn?"Undo":"Check In"),11,sW)])]),ue.isCheckedIn&&ue.checkInTime?(p(),g("div",aW,[Je(w(X(ue.checkInTime))+" ",1),ue.checkInMethod?(p(),g("span",iW," ("+w(ae(ue.checkInMethod))+")",1)):P("",!0)])):P("",!0),ue.lastAccessedAt?(p(),g("div",lW," Last active: "+w(K(ue.lastAccessedAt)),1)):P("",!0)],10,Xj))),128))]))]),te.outstandingTaskCount>0||te.completedTasks&&te.completedTasks.length>0?(p(),g("div",rW,[r("div",cW,w(B(s).checkpoint)+" tasks",1),r("div",uW,[(p(!0),g(Se,null,je(te.outstandingTasks,ue=>(p(),g("div",{key:ue.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:_e=>F(ue,te)},null,40,dW),r("span",hW,w(ue.text),1)]))),128)),(p(!0),g(Se,null,je(te.completedTasks||[],ue=>(p(),g("div",{key:`completed-${ue.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:_e=>j(ue,te)},null,40,fW),r("span",pW,w(ue.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Ee(Zt,{show:E.value,title:x.value?.name||"Marshal Details",size:"large",onClose:A},{actions:Ve(()=>[r("button",{onClick:A,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[x.value?(p(),g("div",vW,[r("div",mW,[Y[4]||(Y[4]=r("h4",null,"Contact Details",-1)),r("div",gW,[x.value.email?(p(),g("div",yW,[Y[2]||(Y[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${x.value.email}`},w(x.value.email),9,kW)])):P("",!0),x.value.phoneNumber?(p(),g("div",bW,[Y[3]||(Y[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${x.value.phoneNumber}`},w(x.value.phoneNumber),9,wW)])):P("",!0),!x.value.email&&!x.value.phoneNumber?(p(),g("div",_W," No contact details available. ")):P("",!0)])]),r("div",CW,[Y[8]||(Y[8]=r("h4",null,"Check-in Status",-1)),x.value.isCheckedIn?(p(),g("div",LW,[r("div",SW,[Y[6]||(Y[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[Y[5]||(Y[5]=r("strong",null,"Checked In",-1)),r("p",IW,w(re(x.value.checkInTime)),1),x.value.checkInMethod?(p(),g("p",xW," Method: "+w(ae(x.value.checkInMethod)),1)):P("",!0)])]),r("button",{onClick:Y[0]||(Y[0]=te=>U(x.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===x.value.marshalId},w(b.value===x.value.marshalId?"Undoing...":"Undo Check-in"),9,$W)])):(p(),g("div",TW,[Y[7]||(Y[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:Y[1]||(Y[1]=te=>U(x.value,C.value)),class:"btn btn-primary check-in-btn",disabled:b.value===x.value.marshalId},w(b.value===x.value.marshalId?"Checking in...":"Check In"),9,MW)])),x.value.lastAccessedAt?(p(),g("div",AW," Last active: "+w(K(x.value.lastAccessedAt)),1)):P("",!0)]),r("div",EW,[r("h4",null,w(B(s).checklists)+" ("+w(x.value.outstandingTasks?.length||0)+" outstanding)",1),!x.value.outstandingTasks||x.value.outstandingTasks.length===0?(p(),g("div",PW," No outstanding tasks. ")):(p(),g("div",DW,[(p(!0),g(Se,null,je(x.value.outstandingTasks,te=>(p(),g("div",{key:te.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:ue=>Z(te)},null,40,RW),r("span",OW,w(te.text),1)]))),128))]))]),r("div",NW,[r("div",BW,[x.value.phoneNumber?(p(),g("a",{key:0,href:`tel:${x.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,FW)):P("",!0),x.value.phoneNumber?(p(),g("a",{key:1,href:`sms:${x.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,UW)):P("",!0),x.value.email?(p(),g("a",{key:2,href:`mailto:${x.value.email}`,class:"btn btn-secondary"}," Email ",8,zW)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},VW=Ke(HW,[["__scopeId","data-v-cdab7802"]]),GW={key:0,class:"accordion-section"},qW={class:"accordion-title"},jW=["innerHTML"],WW={key:0,class:"header-count"},ZW={class:"accordion-icon"},KW={key:0,class:"accordion-content area-lead-accordion-content"},YW={key:0,class:"area-filter-pills"},JW=["onClick"],XW={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:n}=ht(),s=D(null);return t({areaLeadRef:s}),(o,i)=>e.isAreaLead?(p(),g("div",GW,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",qW,[r("span",{class:"section-icon",innerHTML:B(to)("area")},null,8,jW),Je(" Your "+w(e.areas.length===1?B(n).area:B(n).areas),1),e.areas.length>1?(p(),g("span",WW," ("+w(e.areas.length)+")",1)):P("",!0)]),r("span",ZW,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",KW,[e.areas.length>1?(p(),g("div",YW,[(p(!0),g(Se,null,je(e.areas,l=>(p(),g("button",{key:l.areaId,class:le(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:tt(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:c=>o.$emit("toggle-filter",l.areaId)},w(l.name),15,JW))),128))])):P("",!0),Ee(VW,{ref_key:"areaLeadRef",ref:s,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,onChecklistUpdated:i[1]||(i[1]=l=>o.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route","route-color","route-style","route-weight"])])):P("",!0)])):P("",!0)}},QW=Ke(XW,[["__scopeId","data-v-dfc09e28"]]),eZ={key:0,class:"accordion-section"},tZ={class:"accordion-title"},nZ=["innerHTML"],oZ={key:0,class:"header-count"},sZ={class:"accordion-icon"},aZ={key:0,class:"accordion-content area-lead-marshals-content"},iZ={class:"area-lead-marshals-list"},lZ=["onClick"],rZ={class:"marshal-header-info"},cZ={class:"marshal-name-row"},uZ={class:"marshal-name"},dZ={class:"marshal-meta"},hZ={class:"marshal-checkpoint"},fZ={key:0,class:"marshal-task-count"},pZ={class:"accordion-icon"},vZ={key:0,class:"area-lead-marshal-content"},mZ={key:0,class:"marshal-actions-row"},gZ=["onClick"],yZ={key:1,class:"marshal-contact-section"},kZ=["href"],bZ=["href"],wZ={key:2,class:"marshal-tasks-section"},_Z={class:"tasks-label"},CZ={class:"tasks-list"},LZ=["checked","disabled","onChange"],SZ={class:"task-content"},IZ={class:"task-text"},xZ={key:0,class:"task-context"},$Z={key:1,class:"task-completion-info"},TZ={key:0,class:"completion-by"},MZ={key:1,class:"completion-time"},AZ={key:3,class:"no-tasks-message"},EZ={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1},currentMarshalId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]}},emits:["toggle","toggle-marshal","check-in","toggle-task","show-qr"],setup(e){const{terms:t,termsLower:n}=ht(),s=e,o=m=>{if(!m||m.length===0)return"";const y=k=>k.description?`${k.name} - ${k.description}`:k.name;return m.length===1?y(m[0]):m.map(y).join(", ")},i=(m,y)=>{const k=m.completionContextType||m.contextType,b=m.completionContextId||m.contextId;if(k==="Checkpoint"&&b){const I=y.checkpoints?.find(E=>E.checkpointId===b);if(I){if(I.description){const x=I.description.length>50?I.description.substring(0,50)+"...":I.description;return`${I.name} - ${x}`}return I.name}const T=s.locations.find(E=>E.id===b);if(T){if(T.description){const x=T.description.length>50?T.description.substring(0,50)+"...":T.description;return`${T.name} - ${x}`}return T.name}}if(k==="Area"&&b){const I=s.areas.find(T=>T.id===b);if(I)return I.name}return""},l=(m,y)=>{const k=m.completionContextType||m.contextType,b=m.completionContextId||m.contextId;if(k==="Checkpoint"&&b){const I=y.checkpoints?.find(E=>E.checkpointId===b);return I?I.name||"":s.locations.find(E=>E.id===b)?.name||""}return k==="Area"&&b&&s.areas.find(T=>T.id===b)?.name||""},c=m=>{if(!m.allTasks||m.allTasks.length===0)return[];const y=new Map;for(const T of m.allTasks){const E=T.completionContextType||T.contextType,x=T.completionContextId||T.contextId,C=`${T.itemId}_${E}_${x}`;if(!y.has(C))y.set(C,{...T});else{const _=y.get(C);T.isCompleted&&!_.isCompleted&&y.set(C,{..._,isCompleted:!0,completedAt:T.completedAt||_.completedAt,completedByActorName:T.completedByActorName||_.completedByActorName,contextOwnerName:T.contextOwnerName||_.contextOwnerName})}}const k=Array.from(y.values()),b=new Map;for(const T of k)b.set(T.text,(b.get(T.text)||0)+1);return[...k].sort((T,E)=>{const x=T.text.localeCompare(E.text,void 0,{sensitivity:"base"});if(x!==0)return x;const C=l(T,m),_=l(E,m);return C.localeCompare(_,void 0,{numeric:!0,sensitivity:"base"})}).map(T=>({...T,needsDisambiguation:b.get(T.text)>1,contextDisplayName:i(T,m)}))},d=m=>m.completedByActorName&&m.contextOwnerName&&m.completedByActorName!==m.contextOwnerName?`${m.completedByActorName} on behalf of ${m.contextOwnerName}`:m.completedByActorName||"",h=m=>{if(!m)return"";const y=new Date(m),I=(new Date-y)/(1e3*60*60);return I<24&&I>=0?y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):y.toLocaleString()},f=m=>{const y=c(m),k=y.length,b=y.filter(I=>I.isCompleted).length;return{total:k,completed:b}};return(m,y)=>e.isAreaLead&&e.marshals.length>0?(p(),g("div",eZ,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:y[0]||(y[0]=k=>m.$emit("toggle"))},[r("span",tZ,[r("span",{class:"section-icon",innerHTML:B(to)("marshal")},null,8,nZ),Je(" Your "+w(e.marshals.length===1?B(n).person:B(n).people),1),e.marshals.length>1?(p(),g("span",oZ," ("+w(e.marshals.length)+")",1)):P("",!0)]),r("span",sZ,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",aZ,[r("div",iZ,[(p(!0),g(Se,null,je(e.marshals,k=>(p(),g("div",{key:k.marshalId,class:"area-lead-marshal-item"},[r("button",{class:le(["area-lead-marshal-header",{active:e.expandedMarshalId===k.marshalId,"is-checked-in":k.isCheckedIn}]),onClick:b=>m.$emit("toggle-marshal",k.marshalId)},[r("div",rZ,[r("div",cZ,[r("span",uZ,w(k.name),1),r("span",{class:le(["check-status-badge",{"checked-in":k.isCheckedIn}])},w(k.isCheckedIn?"":""),3)]),r("div",dZ,[r("span",hZ,w(o(k.checkpoints)),1),f(k).total>0?(p(),g("span",fZ,w(f(k).completed)+" / "+w(f(k).total)+" "+w(B(n).checklists)+" complete ",1)):P("",!0)])]),r("span",pZ,w(e.expandedMarshalId===k.marshalId?"":"+"),1)],10,lZ),e.expandedMarshalId===k.marshalId?(p(),g("div",vZ,[k.marshalId!==e.currentMarshalId?(p(),g("div",mZ,[Ee(xu,{"is-checked-in":k.isCheckedIn,"check-in-time":k.checkInTime,"check-in-method":k.checkInMethod,"checked-in-by":k.checkedInBy,"marshal-name":k.marshalName,"is-loading":e.checkingInMarshalId===k.id,onToggle:b=>m.$emit("check-in",k)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct(b=>m.$emit("show-qr",k),["stop"]),title:"Show QR code for magic link"},[...y[1]||(y[1]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-0e0ce8c7><rect x="3" y="3" width="7" height="7" data-v-0e0ce8c7></rect><rect x="14" y="3" width="7" height="7" data-v-0e0ce8c7></rect><rect x="3" y="14" width="7" height="7" data-v-0e0ce8c7></rect><rect x="14" y="14" width="3" height="3" data-v-0e0ce8c7></rect><rect x="19" y="14" width="2" height="2" data-v-0e0ce8c7></rect><rect x="14" y="19" width="2" height="2" data-v-0e0ce8c7></rect><rect x="19" y="19" width="2" height="2" data-v-0e0ce8c7></rect></svg>',1)])],8,gZ)])):P("",!0),k.email||k.phoneNumber?(p(),g("div",yZ,[k.phoneNumber?(p(),g("a",{key:0,href:`tel:${k.phoneNumber}`,class:"contact-link"},w(k.phoneNumber),9,kZ)):P("",!0),k.email?(p(),g("a",{key:1,href:`mailto:${k.email}`,class:"contact-link"},w(k.email),9,bZ)):P("",!0)])):P("",!0),c(k).length>0?(p(),g("div",wZ,[r("div",_Z,w(B(t).checklists),1),r("div",CZ,[(p(!0),g(Se,null,je(c(k),b=>(p(),g("div",{key:`${b.itemId}-${b.completionContextType||b.contextType}-${b.completionContextId||b.contextId}`,class:le(["task-item",{"task-completed":b.isCompleted}])},[r("input",{type:"checkbox",checked:b.isCompleted,disabled:e.savingTask,onChange:I=>m.$emit("toggle-task",b,k)},null,40,LZ),r("div",SZ,[r("span",IZ,w(b.text),1),b.needsDisambiguation&&b.contextDisplayName?(p(),g("div",xZ,w(b.contextDisplayName),1)):P("",!0),b.isCompleted&&(b.completedByActorName||b.completedAt)?(p(),g("div",$Z,[d(b)?(p(),g("span",TZ,w(d(b)),1)):P("",!0),b.completedAt?(p(),g("span",MZ,w(h(b.completedAt)),1)):P("",!0)])):P("",!0)])],2))),128))])])):(p(),g("div",AZ," No "+w(B(n).checklists)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0)}},PZ=Ke(EZ,[["__scopeId","data-v-0e0ce8c7"]]),DZ={class:"checkpoint-note-header"},RZ={key:0,class:"pin-icon",title:"Pinned"},OZ={class:"checkpoint-note-title"},NZ={key:0,class:"checkpoint-note-content"},BZ={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,n=z(()=>(t.priority||"Normal").toLowerCase());return(s,o)=>(p(),g("div",{class:le(["checkpoint-note-item",n.value])},[r("div",DZ,[e.isPinned?(p(),g("span",RZ,"")):P("",!0),r("span",{class:le(["priority-indicator",n.value])},null,2),r("strong",OZ,w(e.title),1),r("span",{class:le(["priority-badge",n.value])},w(e.priority),3)]),e.content?(p(),g("div",NZ,w(e.content),1)):P("",!0)],2))}},FZ=Ke(BZ,[["__scopeId","data-v-5f2df920"]]),UZ={class:"checkpoint-accordion-section"},zZ={class:"checkpoint-header-content"},HZ={class:"checkpoint-title-row"},VZ=["innerHTML"],GZ={key:0,class:"checkpoint-check-icon"},qZ={class:"checkpoint-name"},jZ={key:1,class:"area-badge"},WZ={key:2,class:"checkpoint-time-badge"},ZZ={key:3,class:"checkpoint-distance-badge"},KZ={key:0,class:"checkpoint-description-preview"},YZ={class:"accordion-icon"},JZ={key:0,class:"checkpoint-accordion-content"},XZ={key:0,class:"checkpoint-mini-map"},QZ={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},eK={class:"my-checkin-section"},tK={key:0,class:"check-in-error"},nK={key:1,class:"dynamic-location-section"},oK={class:"dynamic-location-header"},sK={class:"dynamic-badge"},aK={key:0,class:"last-update"},iK={key:0,class:"dynamic-location-actions"},lK=["disabled"],rK=["title"],cK={class:"checkpoint-marshals"},uK={class:"marshals-label"},dK={key:0,class:"marshals-list"},hK={key:0,class:"check-badge"},fK={key:1,class:"marshals-list-expanded"},pK=["onClick"],vK={class:"marshal-name-text"},mK={class:"marshal-status-icons"},gK={key:0,class:"check-badge"},yK={class:"expand-icon"},kK={key:0,class:"marshal-details-panel"},bK={class:"detail-row"},wK={key:0,class:"detail-row"},_K={key:1,class:"detail-row"},CK={key:2,class:"detail-row"},LK=["href"],SK={key:3,class:"detail-row"},IK=["href"],xK={key:4,class:"contact-buttons-mini"},$K=["href"],TK=["href"],MK=["href"],AK={key:5,class:"checkpoint-marshal-actions"},EK=["onClick"],PK={key:2,class:"checkpoint-area-contacts"},DK={class:"marshals-label"},RK={class:"contact-list"},OK={key:3,class:"checkpoint-notes"},NK={class:"checkpoint-notes-list"},BK={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{terms:n,termsLower:s}=ht(),o=xo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=sl({headerStyle:z(()=>ru(o.headerStyle)),headerTextColor:z(()=>ru(o.headerTextColor))}),l=e,c=D(null),d=z(()=>l.assignment.location?.isDynamic),h=z(()=>{const x=l.assignment.location?.name||l.assignment.locationName,C=l.assignment.location?.description;return C?`${x}  ${C}`:x}),f=z(()=>{if(!d.value)return!1;const x=l.assignment.location,C=x?.locationUpdateScopeConfigurations||x?.LocationUpdateScopeConfigurations||[];return Xy({scopeConfigurations:C,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),m=z(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const x=l.assignment.location;return!x?.latitude||!x?.longitude?null:al(l.userLocation.lat,l.userLocation.lng,x.latitude,x.longitude)}),y=z(()=>{const x=m.value;return x==null?null:x<1e3?`${Math.round(x/10)*10} m`:`${(Math.round(x/100)/10).toFixed(1)} km`});t({mapRef:c});const k=x=>{const C=x?.iconType||"checkpoint",_=x?.iconColor||"#667eea",$={checkpoint:`<svg viewBox="0 0 24 24" fill="${_}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${_}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${_}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${_}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${_}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return $[C]||$.checkpoint},b=(x,C)=>{const _=$=>$?new Date($).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return x&&C?`${_(x)} - ${_(C)}`:x?`from ${_(x)}`:C?`until ${_(C)}`:""},I=x=>x?new Date(x).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",T=x=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[x]||x,E=x=>{if(!x)return"";const C=new Date(x),R=(new Date-C)/(1e3*60*60);return R<24&&R>=0?C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):C.toLocaleString()};return(x,C)=>(p(),g("div",UZ,[r("button",{class:le(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:C[0]||(C[0]=_=>x.$emit("toggle"))},[r("div",zZ,[r("div",HZ,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,VZ),e.assignment.effectiveIsCheckedIn?(p(),g("span",GZ,"")):P("",!0),r("span",qZ,w(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(p(),g("span",jZ,w(e.assignment.areaName),1)):P("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(p(),g("span",WZ,w(b(e.assignment.location.startTime,e.assignment.location.endTime)),1)):P("",!0),y.value?(p(),g("span",ZZ,w(y.value),1)):P("",!0)]),e.assignment.location?.description?(p(),g("div",KZ,w(e.assignment.location.description),1)):P("",!0)]),r("span",YZ,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",JZ,[e.assignment.location?(p(),g("div",XZ,[Ee(il,{ref_key:"mapRef",ref:c,locations:e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:C[2]||(C[2]=_=>x.$emit("map-click",_)),onLocationClick:C[3]||(C[3]=_=>x.$emit("location-click",_)),onActionClick:C[4]||(C[4]=_=>x.$emit("action-click",_)),onVisibilityChange:C[5]||(C[5]=_=>x.$emit("visibility-change",_))},yf({_:2},[f.value?{name:"fullscreen-footer",fn:Ve(()=>[r("button",{class:"btn btn-primary",onClick:C[1]||(C[1]=_=>x.$emit("update-location"))},[(p(),g("svg",QZ,[...C[9]||(C[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),C[10]||(C[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):P("",!0),r("div",eK,[Ee(xu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:C[6]||(C[6]=_=>x.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(p(),g("div",tK,w(e.checkInError),1)):P("",!0)]),d.value?(p(),g("div",nK,[r("div",oK,[r("span",sK,"Dynamic "+w(e.assignment.location.resolvedCheckpointTerm||B(s).checkpoint),1),e.assignment.location.lastLocationUpdate?(p(),g("span",aK," Last updated: "+w(E(e.assignment.location.lastLocationUpdate)),1)):P("",!0)]),f.value?(p(),g("div",iK,[r("button",{onClick:C[7]||(C[7]=_=>x.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...C[11]||(C[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,lK),r("button",{onClick:C[8]||(C[8]=_=>x.$emit("toggle-auto-update")),class:le(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[C[12]||(C[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+w(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,rK)])):P("",!0)])):P("",!0),r("div",cK,[r("div",uK,w(B(n).people)+":",1),e.isAreaLeadForCheckpoint?(p(),g("div",fK,[(p(!0),g(Se,null,je(e.assignment.allMarshals,_=>(p(),g("div",{key:_.marshalId,class:le(["marshal-card-mini",{"is-you":_.marshalId===e.currentMarshalId,"checked-in":_.effectiveIsCheckedIn,expanded:e.expandedMarshalId===_.marshalId}])},[r("button",{class:"marshal-card-header",onClick:$=>x.$emit("toggle-marshal",_.marshalId)},[r("span",vK,w(_.marshalName)+w(_.marshalId===e.currentMarshalId?" (you)":""),1),r("span",mK,[_.effectiveIsCheckedIn?(p(),g("span",gK,"")):P("",!0),r("span",yK,w(e.expandedMarshalId===_.marshalId?"":"+"),1)])],8,pK),e.expandedMarshalId===_.marshalId?(p(),g("div",kK,[r("div",bK,[C[13]||(C[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:le(_.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},w(_.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),_.effectiveIsCheckedIn&&_.checkInTime?(p(),g("div",wK,[C[14]||(C[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,w(I(_.checkInTime)),1)])):P("",!0),_.checkInMethod?(p(),g("div",_K,[C[15]||(C[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,w(T(_.checkInMethod)),1)])):P("",!0),_.email?(p(),g("div",CK,[C[16]||(C[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+_.email},w(_.email),9,LK)])):P("",!0),_.phoneNumber?(p(),g("div",SK,[C[17]||(C[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+_.phoneNumber},w(_.phoneNumber),9,IK)])):P("",!0),_.email||_.phoneNumber?(p(),g("div",xK,[_.phoneNumber?(p(),g("a",{key:0,href:"tel:"+_.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,$K)):P("",!0),_.phoneNumber?(p(),g("a",{key:1,href:"sms:"+_.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,TK)):P("",!0),_.email?(p(),g("a",{key:2,href:"mailto:"+_.email,class:"btn btn-sm btn-secondary"},"Email",8,MK)):P("",!0)])):P("",!0),_.marshalId!==e.currentMarshalId?(p(),g("div",AK,[Ee(xu,{"is-checked-in":_.effectiveIsCheckedIn,"check-in-time":_.checkInTime,"check-in-method":_.checkInMethod,"checked-in-by":_.checkedInBy,"marshal-name":_.marshalName,"is-loading":e.checkingInMarshalId===_.id,onToggle:$=>x.$emit("marshal-check-in",_)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct($=>x.$emit("show-marshal-qr",_),["stop"]),title:"Show QR code for magic link"},[...C[18]||(C[18]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-bbde95f8><rect x="3" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="3" y="14" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="14" width="3" height="3" data-v-bbde95f8></rect><rect x="19" y="14" width="2" height="2" data-v-bbde95f8></rect><rect x="14" y="19" width="2" height="2" data-v-bbde95f8></rect><rect x="19" y="19" width="2" height="2" data-v-bbde95f8></rect></svg>',1)])],8,EK)])):P("",!0)])):P("",!0)],2))),128))])):(p(),g("div",dK,[(p(!0),g(Se,null,je(e.assignment.allMarshals,_=>(p(),g("span",{key:_.marshalId,class:le(["marshal-tag",{"is-you":_.marshalId===e.currentMarshalId,"checked-in":_.effectiveIsCheckedIn}])},[Je(w(_.marshalName)+w(_.marshalId===e.currentMarshalId?" (you)":"")+" ",1),_.effectiveIsCheckedIn?(p(),g("span",hK,"")):P("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(p(),g("div",PK,[r("div",DK,w(B(n).area)+" contacts:",1),r("div",RK,[(p(!0),g(Se,null,je(e.assignment.areaContacts,_=>(p(),qe(I1,{key:_.marshalId,name:_.marshalName,role:_.role,phone:_.phone,email:_.email},null,8,["name","role","phone","email"]))),128))])])):P("",!0),e.notes.length>0?(p(),g("div",OK,[C[19]||(C[19]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",NK,[(p(!0),g(Se,null,je(e.notes,_=>(p(),qe(FZ,{key:_.noteId,title:_.title,content:_.content,priority:_.priority,"is-pinned":_.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):P("",!0)])):P("",!0)]))}},FK=Ke(BK,[["__scopeId","data-v-bbde95f8"]]),UK={class:"accordion-section"},zK={class:"accordion-title"},HK=["innerHTML"],VK={key:0,class:"header-count"},GK={class:"accordion-icon"},qK={key:0,class:"accordion-content assignments-accordion-content"},jK={key:0,class:"empty-state"},WK={key:1,class:"checkpoint-accordion"},ZK={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{termsLower:n}=ht(),s=e,o=z(()=>s.assignments.map(c=>c.locationId)),i={},l=(c,d)=>{d?i[c]=d:delete i[c]};return t({checkpointRefs:i}),(c,d)=>(p(),g("div",UK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[r("span",zK,[r("span",{class:"section-icon",innerHTML:B(to)("checkpoint")},null,8,HK),Je(" Your "+w(e.assignments.length===1?B(n).checkpoint:B(n).checkpoints),1),e.assignments.length>1?(p(),g("span",VK," ("+w(e.assignments.length)+")",1)):P("",!0)]),r("span",GK,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",qK,[e.assignments.length===0?(p(),g("div",jK,[r("p",null,"You don't have any "+w(B(n).checkpoint)+" assignments yet.",1)])):(p(),g("div",WK,[(p(!0),g(Se,null,je(e.assignments,h=>(p(),qe(FK,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":o.value,onToggle:f=>c.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>c.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>c.$emit("location-click",f)),onActionClick:f=>c.$emit("action-click",h,f),onVisibilityChange:f=>c.$emit("visibility-change",h.id,f),onUpdateLocation:f=>c.$emit("update-location",h),onCheckIn:f=>c.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>c.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>c.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>c.$emit("toggle-auto-update",h),onShowMarshalQr:d[4]||(d[4]=f=>c.$emit("show-marshal-qr",f))},null,8,["assignment","is-expanded","all-locations","route","route-color","route-style","route-weight","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):P("",!0)]))}},KK=Ke(ZK,[["__scopeId","data-v-e4d1cee8"]]),YK={key:0,class:"accordion-section"},JK={class:"accordion-title"},XK=["innerHTML"],QK={key:0,class:"header-count"},eY={class:"accordion-icon"},tY={key:0,class:"accordion-content"},nY={class:"roles-list"},oY={class:"role-title"},sY={class:"role-notes"},aY={__name:"MarshalRolesSection",props:{roles:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.roles.length>0?(p(),g("div",YK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",JK,[r("span",{class:"section-icon",innerHTML:B(to)("user")},null,8,XK),Je(" Your "+w(e.roles.length===1?"role":"roles"),1),e.roles.length>1?(p(),g("span",QK," ("+w(e.roles.length)+")",1)):P("",!0)]),r("span",eY,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",tY,[r("div",nY,[(p(!0),g(Se,null,je(e.roles,s=>(p(),g("div",{key:s.roleId,class:"role-card"},[r("div",oY,w(s.name),1),r("div",sY,w(s.notes),1)]))),128))])])):P("",!0)])):P("",!0)}},iY=Ke(aY,[["__scopeId","data-v-c6ef5d00"]]),x1="marshal-branding-cache";function lY(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${x1}-${e}`);return t?JSON.parse(t):null}catch{return null}}function rY(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${x1}-${e}`,JSON.stringify(t))}catch{}}function cY(e,t=null){const n=D(t?lY(t):null);Ye(()=>e.value,y=>{if(y&&t){const k={brandingPageGradientStart:y.brandingPageGradientStart,brandingPageGradientEnd:y.brandingPageGradientEnd,brandingHeaderGradientStart:y.brandingHeaderGradientStart,brandingHeaderGradientEnd:y.brandingHeaderGradientEnd,brandingAccentColor:y.brandingAccentColor,brandingLogoUrl:y.brandingLogoUrl,brandingLogoPosition:y.brandingLogoPosition};rY(t,k),n.value=k}},{immediate:!0});const s=(y,k)=>e.value?.[y]||n.value?.[y]||k,o=z(()=>{const y=s("brandingPageGradientStart",yn.pageGradientStart),k=s("brandingPageGradientEnd",yn.pageGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),i=z(()=>{const y=s("brandingHeaderGradientStart",yn.headerGradientStart),k=s("brandingHeaderGradientEnd",yn.headerGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),l=z(()=>{const y=s("brandingHeaderGradientStart",yn.headerGradientStart),k=s("brandingHeaderGradientEnd",yn.headerGradientEnd);return n1(y,k)}),c=z(()=>s("brandingAccentColor",yn.accentColor)),d=z(()=>Iu(c.value)),h=z(()=>({background:c.value,color:d.value})),f=z(()=>{const y=s("brandingLogoUrl","");return y?y.startsWith("/api")?ti+y.substring(4):y:""}),m=z(()=>s("brandingLogoPosition","left"));return{pageBackgroundStyle:o,headerStyle:i,headerTextColor:l,accentColor:c,accentTextColor:d,accentButtonStyle:h,brandingLogoUrl:f,brandingLogoPosition:m}}function uY(){const e=D(null),t=D(null);let n=null;const s=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),n=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},o=()=>{n!==null&&(navigator.geolocation.clearWatch(n),n=null)};return Ln(()=>{o()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:s,stopLocationTracking:o}}function dY({eventId:e,currentMarshalId:t,currentPerson:n,assignments:s,areaLeadAreaIds:o,isAreaLead:i,allLocations:l,areas:c,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:m,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:b}){const I=D([]),T=D(!1),E=D(null),x=D(!1),C=D("person"),_=D(null),$=z(()=>I.value.slice().sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),R=z(()=>$.value.filter(Y=>Y.isCompleted).length),M=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],O=z(()=>{const Y=s.value.map(te=>te.locationId);return $.value.filter(te=>M.includes(te.matchedScope)?te.contextOwnerMarshalId!=null?!1:te.completionContextType==="Checkpoint"?Y.includes(te.completionContextId):te.completionContextType==="Area"?o.value.includes(te.completionContextId):!0:te.completionContextType==="Personal"?te.contextOwnerMarshalId===t.value:te.completionContextType==="Checkpoint"?te.linksToCheckIn?te.contextOwnerMarshalId===t.value:Y.includes(te.completionContextId):te.completionContextType==="Area"?o.value.includes(te.completionContextId):!0)}),A=z(()=>i.value?$.value.filter(Y=>M.includes(Y.matchedScope)?Y.contextOwnerMarshalId!=null:Y.completionContextType==="Personal"?Y.contextOwnerMarshalId!==t.value:Y.completionContextType==="Checkpoint"?Y.linksToCheckIn?Y.contextOwnerMarshalId!==t.value:!1:(Y.completionContextType==="Area",!1)):[]),U=z(()=>O.value.map(Y=>({...Y,localIsCompleted:Y.isCompleted,isModified:!1})).sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),F=z(()=>A.value.map(Y=>({...Y,localIsCompleted:Y.isCompleted,isModified:!1})).sort((Y,te)=>(Y.displayOrder||0)-(te.displayOrder||0))),j=z(()=>{const Y=f.value?.checkpoints||m.value||[];if(Y.length===0)return[];const te=[],ue=new Set;for(const _e of Y)for(const Te of _e.marshals||[])ue.has(Te.marshalId)||(ue.add(Te.marshalId),te.push(Te));return te}),Z=z(()=>{if(i.value)return"none";const Y=$.value,te=new Set;for(const ue of Y)ue.completionContextType==="Checkpoint"&&ue.completionContextId&&te.add(ue.completionContextId);return te.size>1?"checkpoint":"none"}),X=z(()=>{const Y=$.value,te={};for(const ue of Y){let _e,Te;ue.completionContextType==="Checkpoint"&&ue.completionContextId?(_e=`checkpoint_${ue.completionContextId}`,Te=l.value.find(De=>De.id===ue.completionContextId)?.name||"Unknown "+d.value.checkpoint):ue.completionContextType==="Area"&&ue.completionContextId?(_e=`area_${ue.completionContextId}`,Te=c.value.find(De=>De.id===ue.completionContextId)?.name||"Unknown "+d.value.area):(_e="personal",Te="Personal"),te[_e]||(te[_e]={key:_e,name:Te,items:[],completedCount:0}),te[_e].items.push(ue),ue.isCompleted&&te[_e].completedCount++}for(const ue of Object.values(te))ue.items.sort((_e,Te)=>{const Pe=_e.displayOrder||0,De=Te.displayOrder||0;return Pe-De});return Object.values(te).sort((ue,_e)=>ue.name.localeCompare(_e.name,void 0,{numeric:!0,sensitivity:"base"}))}),re=Y=>{_.value=_.value===Y?null:Y},K=Y=>{if(!Y.completionContextType||!Y.completionContextId)return null;if(Y.completionContextType==="Checkpoint"){const te=l.value.find(_e=>_e.id===Y.completionContextId);if(!te)return null;const ue=te.description?` - ${te.description}`:"";return`At ${h.value.checkpoint} ${te.name}${ue}`}if(Y.completionContextType==="Area"){const te=c.value.find(ue=>ue.id===Y.completionContextId);return te?`At ${h.value.area} ${te.name}`:null}return Y.completionContextType==="Personal"?"Personal item":null},ae=async(Y=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}Y||(T.value=!0),E.value=null;try{const te=e.value;let _e=(await Rt.getMarshalChecklist(te,t.value)).data||[];if(i.value&&o.value.length>0){const Te=o.value.map(H=>Rt.getAreaChecklist(te,H).catch(J=>(console.warn(`Failed to fetch checklist for area ${H}:`,J),{data:[]}))),Pe=await Promise.all(Te),De=new Map,ke=H=>{const J=`${H.itemId}_${H.completionContextType}_${H.completionContextId}`;return H.contextOwnerMarshalId?`${J}_${H.contextOwnerMarshalId}`:J};for(const H of _e)De.set(ke(H),H);for(const H of Pe)for(const J of H.data||[]){const de=ke(J);De.has(de)||De.set(de,J)}_e=Array.from(De.values())}I.value=_e,y?.value&&(y.value.checklist=Date.now())}catch(te){console.error("Failed to load checklist:",te.response?.status,te.response?.data),E.value=te.response?.data?.message||"Failed to load checklist"}finally{Y||(T.value=!1)}};return{checklistItems:I,checklistLoading:T,checklistError:E,savingChecklist:x,checklistGroupBy:C,expandedChecklistGroup:_,visibleChecklistItems:$,completedChecklistCount:R,myChecklistItems:O,areaChecklistItems:A,myChecklistItemsWithLocalState:U,areaChecklistItemsWithLocalState:F,areaMarshalsForChecklist:j,effectiveChecklistGroupBy:Z,groupedChecklistItems:X,loadChecklist:ae,handleToggleChecklist:async Y=>{if(x.value)return;x.value=!0;const te=e.value,ue={marshalId:Y.contextOwnerMarshalId||t.value,contextType:Y.completionContextType,contextId:Y.completionContextId,actorMarshalId:t.value};try{if(Y.isCompleted)if(Zn())await Ro("checklist_uncomplete",{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted=!1,Y.completedAt=null,Y.completedByActorName=null,b&&await b();else{if(await Rt.uncomplete(te,Y.itemId,ue),Y.linksToCheckIn&&Y.linkedCheckpointId){const _e=s.value.find(Te=>Te.locationId===Y.linkedCheckpointId);_e&&(_e.isCheckedIn=!1,_e.checkedInAt=null)}await ae(!0)}else if(Zn())await Ro("checklist_complete",{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted=!0,Y.completedAt=new Date().toISOString(),Y.completedByActorName=n.value?.name||"You",b&&await b();else{const _e=await Rt.complete(te,Y.itemId,ue),Te=Y.linkedCheckpointId||_e.data?.linkedCheckIn?.locationId;if(Y.linksToCheckIn&&Te){const Pe=s.value.find(De=>De.locationId===Te);if(Pe){const De=_e.data?.linkedCheckIn?.checkedInAt||new Date().toISOString();Pe.isCheckedIn=!0,Pe.checkedInAt=De}}await ae(!0)}k&&await k(te,"checklist",JSON.parse(JSON.stringify(I.value)))}catch(_e){if(console.error("Failed to toggle checklist item:",_e),Zn()||!_e.response){const Te=Y.isCompleted?"checklist_uncomplete":"checklist_complete";await Ro(Te,{eventId:te,itemId:Y.itemId,data:ue}),Y.isCompleted?(Y.isCompleted=!1,Y.completedAt=null,Y.completedByActorName=null):(Y.isCompleted=!0,Y.completedAt=new Date().toISOString(),Y.completedByActorName=n.value?.name||"You"),b&&await b(),k&&await k(te,"checklist",JSON.parse(JSON.stringify(I.value)))}}finally{x.value=!1}},toggleChecklistGroup:re,getContextName:K}}function hY({eventId:e,allLocations:t,userLocation:n,locationLastUpdated:s}){const o=D(!1),i=D(null),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(!1);let m=null,y=null,k=null;const b=q=>q?.isDynamic===!0||q?.IsDynamic===!0,I=(q,Y,te,ue)=>{const _e=t.value.find(Te=>Te.id===q);_e&&(_e.latitude=Y,_e.longitude=te,_e.lastLocationUpdate=ue)},T=q=>{i.value=q,l.value=null,c.value=null,o.value=!0},E=()=>{o.value=!1,i.value=null,l.value=null,c.value=null,f.value=!1},x=()=>{o.value=!1,f.value=!0},C=()=>{f.value=!1,o.value=!0},_=async(q,Y,te,ue,_e=null)=>{d.value=!0;try{const Te=e.value,Pe={latitude:Y,longitude:te,sourceType:ue};_e&&(Pe.sourceCheckpointId=_e);const De=await Kn.updatePosition(Te,q,Pe);De.data.success&&(h.value&&U(),I(q,De.data.latitude,De.data.longitude,De.data.lastLocationUpdate))}catch(Te){console.error("Failed to update location:",Te),Te.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},$=async()=>{if(i.value){d.value=!0,l.value=null;try{let q,Y;if(n.value&&s?.value&&Date.now()-s.value<3e4&&(q=n.value.lat,Y=n.value.lng),!q||!Y){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Te=await new Promise((Pe,De)=>{navigator.geolocation.getCurrentPosition(Pe,De,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});q=Te.coords.latitude,Y=Te.coords.longitude}const te=e.value,ue=i.value.locationId,_e=await Kn.updatePosition(te,ue,{latitude:q,longitude:Y,sourceType:"gps"});_e.data.success&&(c.value="Location updated successfully!",I(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(q){console.error("Failed to update location with GPS:",q),q.response?.status===403?l.value="You do not have permission to update this location.":q.code===1?l.value="Location access denied. Please enable location permissions.":q.code===2?l.value="Unable to determine your location. Please try again.":q.code===3||q.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async q=>{if(!i.value)return;const Y=t.value.find(te=>te.id===q);if(!Y){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const te=e.value,ue=i.value.locationId,_e=await Kn.updatePosition(te,ue,{latitude:Y.latitude,longitude:Y.longitude,sourceType:"checkpoint",sourceCheckpointId:q});_e.data.success&&(h.value&&U(),c.value=`Location copied from ${Y.name}!`,I(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(te){console.error("Failed to copy location from checkpoint:",te),te.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},M=async(q,Y)=>{if(i.value){d.value=!0,l.value=null;try{const te=e.value,ue=i.value.locationId,_e=await Kn.updatePosition(te,ue,{latitude:q,longitude:Y,sourceType:"manual"});_e.data.success&&(c.value="Location updated successfully!",I(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>E(),1500))}catch(te){console.error("Failed to update location manually:",te),te.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},O=async q=>{if(!(!q||!("geolocation"in navigator)))try{const Y=await new Promise((_e,Te)=>{navigator.geolocation.getCurrentPosition(_e,Te,{enableHighAccuracy:!0,timeout:15e3})}),te=e.value,ue=q.locationId;await Kn.updatePosition(te,ue,{latitude:Y.coords.latitude,longitude:Y.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),I(ue,Y.coords.latitude,Y.coords.longitude,new Date().toISOString())}catch(Y){console.warn("Auto-update location failed:",Y)}},A=q=>{h.value=!0,O(q),m=setInterval(()=>{O(q)},6e4)},U=()=>{h.value=!1,m&&(clearInterval(m),m=null)},F=q=>{h.value?U():A(q)},j=()=>{y||!t.value.some(Y=>Y.isDynamic||Y.IsDynamic)||(y=setInterval(async()=>{try{const Y=e.value,te=await Kn.getDynamicCheckpoints(Y,{skipLoadingOverlay:!0});if(te.data&&Array.isArray(te.data))for(const ue of te.data){const _e=t.value.find(Te=>Te.id===ue.checkpointId);_e&&(_e.latitude=ue.latitude,_e.longitude=ue.longitude,_e.lastLocationUpdate=ue.lastLocationUpdate)}}catch(Y){console.warn("Failed to poll dynamic checkpoints:",Y)}},6e4))},Z=()=>{y&&(clearInterval(y),y=null)},X=async()=>{try{const q=e.value,Y=await Kn.getByEvent(q,{skipLoadingOverlay:!0});if(Y.data&&Array.isArray(Y.data))for(const te of Y.data){const ue=t.value.find(_e=>_e.id===te.id);ue&&(ue.latitude=te.latitude,ue.longitude=te.longitude,te.lastLocationUpdate&&(ue.lastLocationUpdate=te.lastLocationUpdate))}}catch(q){console.warn("Failed to poll all checkpoint locations:",q)}};return{showLocationUpdateModal:o,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:c,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:b,openLocationUpdateModal:T,closeLocationUpdateModal:E,startMapLocationSelect:x,cancelMapLocationSelect:C,updateDynamicCheckpointLocation:_,updateLocationWithGps:$,updateLocationFromCheckpoint:R,updateLocationManually:M,toggleAutoUpdate:F,startAutoUpdate:A,stopAutoUpdate:U,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:Z,startAllCheckpointsPolling:()=>{k||(X(),k=setInterval(X,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:q=>{f.value&&i.value&&(_(i.value.locationId,q.lat,q.lng,"manual"),f.value=!1)}}}function fY({eventId:e,assignments:t,allLocations:n,areaLeadRef:s,areaLeadCheckpoints:o,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:c,reloadChecklist:d,checklistItems:h,currentMarshalId:f}){const{termsLower:m}=ht(),y=D(null),k=D(null),b=D(null),I=D(!1),T=D(null),E=D(new Set),x=D(!1),C=D(""),_=()=>!1,$=Z=>{if(!Z)return"";const X=new Date(Z),K=(new Date-X)/(1e3*60*60),ae=X.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K>24?`${X.toLocaleDateString([],{day:"numeric",month:"short"})}, ${ae}`:ae},R=Z=>{if(!Z)return"";switch(Z){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return Z}},M=Z=>{E.value.add(Z),I.value=!1,T.value=null},O=()=>{x.value=!1,C.value=""},A=Z=>Z<1e3?`${Math.round(Z/10)*10} m`:`${(Math.round(Z/100)/10).toFixed(1)} km`,U=(Z,X,re)=>{if(Z==null||X==null)return;const K=n.value?.find(te=>te.id===re);if(!K)return;const ae=K.latitude,q=K.longitude;if(ae==null||q==null)return;const Y=al(Z,X,ae,q);if(Y>50){const te=A(Y);C.value=`Thanks for checking in. Just so you know, it's possible you are more than ${te} from your ${m.value.checkpoint} area.`,x.value=!0}},F=async(Z,X=!0,re=null)=>{if(!Z?.id){b.value="Cannot check in: Assignment ID is missing";return}y.value=Z.id,k.value=Z.id,b.value=null;const K=e.value;if(!K){b.value="Cannot check in: Event ID is missing",y.value=null,k.value=null;return}const ae=Z.effectiveIsCheckedIn!==void 0?Z.effectiveIsCheckedIn:Z.isCheckedIn&&!_(Z.checkInTime),q=Z.isCheckedIn&&!ae,Y=ae?"check-out":q?"refresh":"check-in",te=!ae;let ue=null,_e=null,Te="Manual";if(X&&!ae&&"geolocation"in navigator)try{const De=await new Promise((ke,H)=>{navigator.geolocation.getCurrentPosition(ke,H,{enableHighAccuracy:!0,timeout:5e3})});ue=De.coords.latitude,_e=De.coords.longitude,Te="GPS"}catch{}const Pe={latitude:ue,longitude:_e,action:Y};try{if(Zn()){await Ro("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:Pe});const De=t.value.findIndex(ke=>ke.id===Z.id);if(De!==-1&&(t.value[De]={...t.value[De],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?`${Te} (pending)`:null,checkInLatitude:ue,checkInLongitude:_e}),re){const ke=n.value.find(H=>H.id===re);if(ke?.assignments){const H=ke.assignments.find(J=>J.id===Z.id||J.marshalId===Z.marshalId);H&&(H.isCheckedIn=te,H.checkInTime=te?new Date().toISOString():null)}}l&&await l(),c&&await c(K,"locations",n.value)}else{const De=await ri.toggleCheckIn(K,Z.id,Pe),ke=De.data?.assignment||De.data,H=De.data?.linkedTasksCompleted||[],J=De.data?.linkedTasksUncompleted||0,de=t.value.findIndex(ie=>ie.id===Z.id);if(de!==-1&&(t.value[de]=ke),re){const ie=n.value.find(Re=>Re.id===re);if(ie?.assignments){const Re=ie.assignments.find(G=>G.id===Z.id||G.marshalId===Z.marshalId);Re&&Object.assign(Re,ke)}}d&&(H.length>0||J>0)&&await d(!0)}if(re&&s?.value?.loadDashboard&&(await s.value.loadDashboard(),o&&s?.value?.checkpoints&&(o.value=s.value.checkpoints)),i&&i.value++,te&&ue!=null&&_e!=null){const De=re||Z.locationId;De&&U(ue,_e,De)}}catch(De){if(Zn()||!De.response){await Ro("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:Pe});const ke=t.value.findIndex(H=>H.id===Z.id);ke!==-1&&(t.value[ke]={...t.value[ke],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?"Manual (pending)":null}),l&&await l()}else De.response?.data?.message?b.value=De.response.data.message:De.message?b.value=De.message:b.value=`Failed to ${Y}. Please try again.`}finally{y.value=null,k.value=null}};return{checkingIn:y,checkingInAssignment:k,checkInError:b,showCheckInReminderModal:I,checkInReminderCheckpoint:T,dismissedCheckInReminders:E,showDistanceWarning:x,distanceWarningMessage:C,isCheckInStale:_,formatCheckInTime:$,formatCheckInMethod:R,handleCheckInToggle:F,handleAreaLeadMarshalCheckIn:async Z=>{const re=(s?.value?.checkpoints||o?.value||[]).find(_e=>_e.marshals?.some(Te=>Te.marshalId===Z.marshalId));if(!re){console.error("Could not find checkpoint for marshal:",Z);return}const K=re.marshals.find(_e=>_e.marshalId===Z.marshalId);if(!K)return;const ae=K.assignmentId||K.id;if(!ae){console.error("No assignment ID found for marshal:",K);return}const q=!Z.isCheckedIn,Y=re.checkpointId||re.locationId,te={id:ae,marshalId:Z.marshalId,isCheckedIn:Z.isCheckedIn,effectiveIsCheckedIn:Z.isCheckedIn};await F(te,!1,Y);const ue=[s?.value?.checkpoints,o?.value].filter(Boolean);for(const _e of ue)for(const Te of _e){const Pe=Te.marshals?.find(De=>De.marshalId===Z.marshalId);Pe&&(Pe.isCheckedIn=q,Pe.checkInTime=q?new Date().toISOString():null,Pe.checkInMethod=q?"AreaLead":null)}if(i&&i.value++,h?.value&&e?.value&&f?.value){const _e=h.value.filter(Te=>Te.linksToCheckIn&&Te.linkedCheckpointId===Y&&(Te.contextOwnerMarshalId===Z.marshalId||Te.completionContextType==="Checkpoint"&&Te.completionContextId===Y));if(_e.length>0){for(const Te of _e)try{const Pe={marshalId:Te.contextOwnerMarshalId||Z.marshalId,contextType:Te.completionContextType,contextId:Te.completionContextId,actorMarshalId:f.value};q&&!Te.isCompleted?await Rt.complete(e.value,Te.itemId,Pe):!q&&Te.isCompleted&&await Rt.uncomplete(e.value,Te.itemId,Pe)}catch(Pe){console.error("Failed to toggle linked task:",Pe)}d&&await d(!0)}}},dismissCheckInReminder:M,dismissDistanceWarning:O}}function pY({eventId:e,currentMarshalId:t,isAreaLead:n,areaLeadAreaIds:s,sectionLastLoadedAt:o,showMessage:i}){const l=D([]),c=D(!1),d=D(null),h=D(!1),f=D(!1),m=D(""),y=D(!1),k=D(!1),b=D(!1),I=z(()=>l.value.filter(O=>O.status==="open"||O.status==="acknowledged"||O.status==="in_progress").length),T=async()=>{const O=e.value;c.value=!0;try{const A=new Map;if(n.value&&s.value.length>0)for(const U of s.value)try{const j=(await Gs.getForArea(O,U)).data.incidents||[];for(const Z of j)A.set(Z.incidentId,Z)}catch(F){console.warn(`Failed to load incidents for area ${U}:`,F)}try{const F=(await Gs.getAll(O)).data.incidents||[];for(const j of F)j.reportedBy?.marshalId===t.value&&A.set(j.incidentId,j)}catch(U){console.debug("Could not load all incidents:",U)}l.value=Array.from(A.values()).sort((U,F)=>new Date(F.incidentTime||F.createdAt)-new Date(U.incidentTime||U.createdAt)),o?.value&&(o.value.incidents=Date.now())}catch(A){console.error("Failed to load incidents:",A)}finally{c.value=!1}},E=async O=>{b.value=!0;try{await Gs.create(e.value,O),k.value=!1,T(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(A){console.error("Failed to report incident:",A),i&&i("Error",A.response?.data?.message||"Failed to report incident. Please try again.")}finally{b.value=!1}},x=O=>{d.value=O,h.value=!0},C=()=>{h.value=!1,d.value=null},_=async({incidentId:O,status:A})=>{try{await Gs.updateStatus(e.value,O,{status:A});const U=l.value.find(F=>F.incidentId===O);U&&(U.status=A),d.value?.incidentId===O&&(d.value.status=A)}catch(U){console.error("Failed to update incident status:",U),i&&i("Error","Failed to update status. Please try again.")}},$=()=>{m.value="",f.value=!0},R=()=>{f.value=!1,m.value=""};return{myIncidents:l,incidentsLoading:c,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:f,incidentNoteText:m,submittingIncidentNote:y,showReportIncident:k,reportingIncident:b,openIncidentsCount:I,loadMyIncidents:T,handleReportIncident:E,openIncidentDetail:x,closeIncidentDetail:C,handleIncidentStatusChange:_,openAddIncidentNoteModal:$,closeAddIncidentNoteModal:R,submitIncidentNote:async()=>{if(!(!m.value.trim()||!d.value)){y.value=!0;try{await Gs.addNote(e.value,d.value.incidentId,m.value.trim()),R(),T();const O=await Gs.get(e.value,d.value.incidentId);d.value=O.data}catch(O){console.error("Failed to add note:",O),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const wm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',_m='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',vY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',mY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function gY({userLocation:e,assignmentsWithDetails:t,courseMapRef:n}){const{termsLower:s}=ht(),o=D({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=D(!1),l=D(-1),c=D({}),d={},h=z(()=>t.value.filter(E=>E.location?.latitude&&E.location?.longitude&&!(E.location.latitude===0&&E.location.longitude===0))),f=z(()=>{const E=[];return E.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+s.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?vY:mY}),e.value&&!o.value.userLocationInView&&E.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:wm}),h.value.length>0&&!o.value.highlightedLocationInView&&E.push({id:"recenter-checkpoint",label:"My "+s.value.checkpoint,icon:"custom",customIcon:_m}),E}),m=E=>{const x=o.value,C=x.userLocationInView!==E.userLocationInView||x.highlightedLocationInView!==E.highlightedLocationInView,_=JSON.stringify(x.highlightedLocationsVisibility)!==JSON.stringify(E.highlightedLocationsVisibility||{});(C||_)&&(o.value={...E,highlightedLocationsVisibility:E.highlightedLocationsVisibility||{}})},y=()=>{const E=h.value;if(E.length===0)return null;if(E.length===1)return l.value=0,E[0];const x=o.value.highlightedLocationsVisibility||{},C=[];for(let R=0;R<E.length;R++){const M=E[R].locationId;x[M]===!1&&C.push(R)}if(C.length===0)return l.value=0,E[0];if(C.length===1)return l.value=C[0],E[C[0]];const _=l.value;let $=-1;for(const R of C)if(R>_){$=R;break}return $===-1&&($=C[0]),l.value=$,E[$]};return{courseMapVisibility:o,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:m,handleCourseMapAction:({actionId:E})=>{if(E==="toggle-other-checkpoints")i.value=!i.value;else if(E==="recenter-user"&&e.value)n.value?.recenterOnUserLocation();else if(E==="recenter-checkpoint"){const x=y();x?.location&&n.value?.recenterOnLocation(x.location.latitude,x.location.longitude)}},checkpointMapVisibility:c,checkpointMapRefs:d,getCheckpointMapActions:E=>{const x=[],C=c.value[E]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!C.userLocationInView&&x.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:wm}),C.highlightedLocationInView||x.push({id:"recenter-checkpoint",label:s.value.checkpoint.charAt(0).toUpperCase()+s.value.checkpoint.slice(1),icon:"custom",customIcon:_m}),x},handleCheckpointMapVisibilityChange:(E,x)=>{const C=c.value[E];(!C||C.userLocationInView!==x.userLocationInView||C.highlightedLocationInView!==x.highlightedLocationInView)&&(c.value={...c.value,[E]:x})},handleCheckpointMapAction:(E,{actionId:x})=>{const C=d[E.id];x==="recenter-user"&&e.value?C?.recenterOnUserLocation():x==="recenter-checkpoint"&&E.location&&C?.recenterOnLocation(E.location.latitude,E.location.longitude)}}}function yY({eventId:e,currentMarshalId:t,areaLeadRef:n,areaLeadCheckpoints:s,areaChecklistItems:o,myChecklistItems:i,areaLeadAreaIds:l,loadChecklist:c}){const d=D(null),h=D(!1),f=D(0),m=b=>{d.value=d.value===b?null:b},y=z(()=>{f.value;const b=n?.value?.checkpoints,I=s?.value,T=b?.length>0?b:I||[],E=o?.value||[],x=i?.value||[],C=[...E,...x],_=new Map;for(const R of T){const M=R.marshals||R.Marshals||[],O=R.checkpointId||R.CheckpointId,A=R.name||R.Name,U=R.description||R.Description,F=R.areaIds||R.AreaIds||[];for(const j of M){const Z=j.marshalId||j.MarshalId;if(!Z)continue;_.has(Z)||_.set(Z,{...j,marshalId:Z,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const X=_.get(Z);X.checkpoints.push({checkpointId:O,name:A,description:U}),X.checkpointIds.add(O);for(const re of F)X.areaIds.add(re)}}for(const R of C){const M=R.completionContextType,O=R.completionContextId,A=R.contextOwnerMarshalId;let U=[];if(A)_.has(A)&&(U=[_.get(A)]);else{if(M==="Personal")continue;if(M==="Checkpoint")for(const F of _.values())F.checkpointIds.has(O)&&U.push(F);else if(M==="Area")for(const F of _.values())F.areaIds.has(O)&&U.push(F);else U=Array.from(_.values())}for(const F of U)F.allTasks.push({...R,isCompleted:R.isCompleted||R.localIsCompleted}),F.totalTaskCount++,(R.isCompleted||R.localIsCompleted)&&F.completedTaskCount++}return Array.from(_.values()).map(R=>({...R,checkpointIds:Array.from(R.checkpointIds),areaIds:Array.from(R.areaIds)})).sort((R,M)=>(R.name||"").localeCompare(M.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:d,savingAreaLeadMarshalTask:h,areaLeadMarshalDataVersion:f,allAreaLeadMarshals:y,toggleAreaLeadMarshalExpansion:m,toggleAreaLeadMarshalTask:async(b,I)=>{if(h.value)return;h.value=!0;const T={marshalId:I.marshalId,contextType:b.completionContextType||b.contextType,contextId:b.completionContextId||b.contextId,actorMarshalId:t.value},E=!b.isCompleted;try{if(b.isCompleted?await Rt.uncomplete(e.value,b.itemId,T):await Rt.complete(e.value,b.itemId,T),b.linksToCheckIn){const x=n?.value?.checkpoints||s?.value||[];for(const C of x){const _=C.marshals?.find($=>$.marshalId===I.marshalId);_&&(_.isCheckedIn=E,_.checkInTime=E?new Date().toISOString():null,_.checkInMethod=E?"Task":null)}}n?.value?.loadDashboard&&(await n.value.loadDashboard(),s&&n?.value?.checkpoints&&(s.value=n.value.checkpoints)),f.value++,c&&await c(!0)}catch(x){console.error("Failed to toggle area lead marshal task:",x),console.error("Error response data:",x.response?.data)}finally{h.value=!1}}}}function kY({router:e,route:t,onAuthSuccess:n}){const s=D(!1),o=D(!1),i=D(null),l=D(null),c=D(null),d=D(null),h=z(()=>l.value?.name||null),f=z(()=>d.value?.eventRoles?d.value.eventRoles.filter(A=>A.role==="EventAreaLead").flatMap(A=>A.areaIds||[]):[]),m=z(()=>f.value.length>0),y=z(()=>d.value?.eventRoles?d.value.eventRoles.some(O=>O.role==="EventAdmin"):!1),k=z(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),b=z(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let I=null;const T=()=>{I||(I=setInterval(async()=>{if(d.value?.marshalId)try{await qs.getMe(t.params.eventId)}catch(O){console.debug("Heartbeat failed:",O)}},300*1e3))},E=()=>{I&&(clearInterval(I),I=null)},x=async(O,A,U=!1)=>{o.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:O,code:A,isReauth:U}),Bd();try{Oo("marshal",O);const F=await qs.marshalLogin(O,A);if(console.log("Auth response:",F.data),F.data.success){ov(O,{token:F.data.sessionToken,marshalId:F.data.marshalId,marshalName:F.data.person?.name||null}),Bw(O,F.data.marshalId,A),l.value=F.data.person,c.value=F.data.marshalId,s.value=!0,console.log("Authenticated as marshal:",c.value,l.value?.name);try{const j=await qs.getMe(O);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),T(),n&&await n()}else i.value=F.data.message||"Authentication failed"}catch(F){console.error("Authentication failed:",F),i.value=F.response?.data?.message||"Invalid or expired login link"}finally{o.value=!1}};return{isAuthenticated:s,authenticating:o,loginError:i,currentPerson:l,currentMarshalId:c,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:m,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:b,authenticateWithMagicCode:x,checkExistingSession:async O=>{Oo("marshal",O);const A=bu(O),U=A?.marshalId,F=U?my(O,U):null;if(!A?.token)return F?(console.log("No session but have stored code, attempting re-authentication..."),Bd(),await x(O,F,!0),s.value):!1;try{const j=await qs.getMe(O);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},c.value=j.data.marshalId,s.value=!0,hy(O,j.data.marshalId),T(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),F)try{if(Bd(),await x(O,F,!0),s.value)return console.log("Re-authentication successful"),!0}catch(Z){console.error("Re-authentication failed:",Z)}A?.sessionKey&&Uh(A.sessionKey)}return!1},handleClose:O=>{E(),Oo(null),s.value=!1,l.value=null,c.value=null,d.value=null,O&&O(),e.push("/marshal")},handleRemoveSession:async O=>{const[A]=O.split(":");Oo("marshal",A);try{await qs.logout()}catch{}Uh(O),Oo(null)},updateSessionEventInfo:(O,A,U)=>{const F=bu(O);F&&F.marshalId&&ov(O,{marshalId:F.marshalId,marshalName:F.marshalName,token:F.token,eventName:A,eventDate:U})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:T,stopHeartbeat:E}}function bY({eventDate:e,latitude:t,longitude:n}){const s=D(null),o=D(!1),i=D(null),l=["US","LR","MM"],c=z(()=>{try{const x=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(x)}catch{return!1}}),d=z(()=>c.value?"fahrenheit":"celsius"),h=z(()=>{if(!e.value)return null;const E=new Date,x=new Date(e.value);return E.setHours(0,0,0,0),x.setHours(0,0,0,0),Math.floor((x-E)/(1e3*60*60*24))}),f=z(()=>{const E=h.value;return E===null?!1:E>=-1&&E<=7}),m=E=>E>3?720*60*1e3:E>1?10800*1e3:3600*1e3,y=(E,x,C)=>`weather_${E.toFixed(2)}_${x.toFixed(2)}_${C}`,k=(E,x,C,_)=>{try{const $=y(E,x,C),R=localStorage.getItem($);if(!R)return null;const{data:M,timestamp:O}=JSON.parse(R),A=m(_);return Date.now()-O<A?M:(localStorage.removeItem($),null)}catch{return null}},b=(E,x,C,_)=>{try{const $=y(E,x,C);localStorage.setItem($,JSON.stringify({data:_,timestamp:Date.now()}))}catch{}},I={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},T=async()=>{const E=t.value,x=n.value,C=e.value,_=h.value;if(!E||!x||!C||!f.value){s.value=null;return}const $=new Date(C).toISOString().split("T")[0],R=k(E,x,$,_);if(R){s.value=R;return}o.value=!0,i.value=null;try{const M=c.value?"fahrenheit":"celsius",O=`https://api.open-meteo.com/v1/forecast?latitude=${E}&longitude=${x}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${M}&timezone=auto`,A=await fetch(O);if(!A.ok)throw new Error("Weather API request failed");const U=await A.json(),F=U.daily.time.indexOf($);if(F===-1){s.value=null;return}const j=U.daily.weathercode[F],Z=Math.round(U.daily.temperature_2m_max[F]),X=Math.round(U.daily.temperature_2m_min[F]),re=I[j]||{icon:"cloud",description:"Unknown"},K={tempMax:Z,tempMin:X,unit:c.value?"F":"C",icon:re.icon,description:re.description,weatherCode:j};b(E,x,$,K),s.value=K}catch(M){console.warn("Failed to fetch weather:",M),i.value=M.message,s.value=null}finally{o.value=!1}};return Ye([e,t,n,f],()=>{f.value&&t.value&&n.value?T():s.value=null},{immediate:!0}),{weather:s,loading:o,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:T}}const wY=["aria-label"],_Y={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,n={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},s=z(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${n[t.icon]||"cloudy"}.svg`),o=z(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=z(()=>({width:o.value,height:o.value,backgroundColor:t.color,maskImage:`url(${s.value})`,WebkitMaskImage:`url(${s.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,c)=>(p(),g("span",{class:"weather-icon",style:tt(i.value),role:"img","aria-label":e.alt},null,12,wY))}},CY=Ke(_Y,[["__scopeId","data-v-9861a237"]]),LY={key:0,class:"header-logo-cover"},SY=["src"],IY={key:2,class:"header-logo header-logo-left"},xY=["src"],$Y={class:"header-center"},TY={key:0},MY={key:1,class:"header-event-date"},AY=["title"],EY={class:"weather-temp"},PY={key:0,class:"header-actions"},DY={key:3,class:"header-logo header-logo-right"},RY=["src"],OY={class:"container"},NY={key:0,class:"selection-card"},BY={key:1,class:"selection-card"},FY={key:0,class:"loading"},UY={key:2,class:"selection-card error-card"},zY={class:"error"},HY={key:3,class:"dashboard"},VY={key:0,class:"welcome-bar"},GY={class:"welcome-info"},qY={key:0,class:"welcome-email"},jY={key:0,class:"mode-switch"},WY={key:1,class:"mode-switch"},ZY={class:"accordion"},KY={key:1,class:"refresh-indicator"},YY={class:"add-note-form"},JY={class:"modal-actions"},XY=["disabled"],QY={key:0,class:"qr-loading-state"},eJ={key:1,class:"qr-error-state"},tJ=6e4,nJ={__name:"MarshalView",setup(e){const{terms:t,termsLower:n}=ht(),{updatePendingCount:s}=Hf(),o=Qu(),i=rr(),l=z(()=>o.params.eventId),c={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:m,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:b,isAreaLead:I,canSwitchToAdmin:T,isAdminButNeedsReauth:E,authenticateWithMagicCode:x,checkExistingSession:C,handleClose:_,updateSessionEventInfo:$,switchToAdminMode:R,stopHeartbeat:M}=kY({router:i,route:o,onAuthSuccess:()=>c.onAuthSuccess?.()}),O=D(new Set),A=z(()=>b.value.length?K.value.filter(xe=>b.value.includes(xe.id)).map(xe=>({areaId:xe.id,name:xe.name,color:xe.color})).sort((xe,Le)=>(xe.name||"").localeCompare(Le.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ye(A,xe=>{xe.length>0&&O.value.size===0&&(O.value=new Set(xe.map(Le=>Le.areaId)))},{immediate:!0});const U=z(()=>b.value.filter(xe=>O.value.has(xe))),F=xe=>{const Le=new Set(O.value);Le.has(xe)?Le.delete(xe):Le.add(xe),O.value=Le},j=z(()=>{const xe=Lo.value.find(nt=>nt.isCheckedIn&&!ss(nt.checkInTime)&&nt.location);if(xe?.location)return{id:xe.location.id,locationId:xe.location.id,name:xe.location.name,description:xe.location.description};if(wn.value){const nt=Lo.value.find(mt=>mt.id===wn.value);if(nt?.location)return{id:nt.location.id,locationId:nt.location.id,name:nt.location.name,description:nt.location.description}}const Le=Lo.value[0];return Le?.location?{id:Le.location.id,locationId:Le.location.id,name:Le.location.name,description:Le.location.description}:null}),Z=D(null),X=D([]),re=D([]),K=D([]),ae=D(!0),q=D(!1),{pageBackgroundStyle:Y,headerStyle:te,headerTextColor:ue,accentColor:_e,accentTextColor:Te,accentButtonStyle:Pe,brandingLogoUrl:De,brandingLogoPosition:ke}=cY(Z,o.params.eventId);Nr("marshalBranding",{headerStyle:te,headerTextColor:ue,accentButtonStyle:Pe,accentColor:_e,accentTextColor:Te});const H=z(()=>{if(!X.value.length)return null;const xe=X.value.filter(Le=>Le.latitude&&Le.longitude);return xe.length?xe.reduce((Le,nt)=>Le+nt.latitude,0)/xe.length:null}),J=z(()=>{if(!X.value.length)return null;const xe=X.value.filter(Le=>Le.latitude&&Le.longitude);return xe.length?xe.reduce((Le,nt)=>Le+nt.longitude,0)/xe.length:null}),de=z(()=>Z.value?.eventDate||null),{weather:ie,shouldShowWeather:Re}=bY({eventDate:de,latitude:H,longitude:J}),G=D(null),Q=D({checklist:0,notes:0,incidents:0,eventContacts:0}),ee=D([]),Ce=D([]),Be=D([]),ze=D(null),Ae=z(()=>ze.value?.areaLeadRef?.value),{checklistItems:oe,checklistLoading:ge,checklistError:Ne,savingChecklist:Oe,expandedChecklistGroup:$e,visibleChecklistItems:me,completedChecklistCount:Ze,myChecklistItems:Ge,areaChecklistItems:fe,areaChecklistItemsWithLocalState:be,areaMarshalsForChecklist:ne,effectiveChecklistGroupBy:ye,groupedChecklistItems:He,loadChecklist:rt,handleToggleChecklist:kt,toggleChecklistGroup:Ot,getContextName:Lt}=dY({eventId:l,currentMarshalId:y,currentPerson:m,assignments:re,areaLeadAreaIds:b,isAreaLead:I,allLocations:X,areas:K,terms:t,termsLower:n,areaLeadRef:Ae,areaLeadCheckpoints:ee,sectionLastLoadedAt:Q,updateCachedField:eu,updatePendingCount:s}),{userLocation:xt,locationLastUpdated:Kt,startLocationTracking:no,stopLocationTracking:Mo}=uY(),{showLocationUpdateModal:ft,updatingLocationFor:Ct,locationUpdateError:Mt,locationUpdateSuccess:Mn,updatingLocation:go,autoUpdateEnabled:oo,selectingLocationOnMap:An,openLocationUpdateModal:tn,closeLocationUpdateModal:Ps,startMapLocationSelect:yo,cancelMapLocationSelect:Uo,updateDynamicCheckpointLocation:pe,updateLocationWithGps:ve,updateLocationFromCheckpoint:Ie,toggleAutoUpdate:lt,stopAutoUpdate:Qe,startDynamicCheckpointPolling:Nt,stopDynamicCheckpointPolling:on,startAllCheckpointsPolling:mn,stopAllCheckpointsPolling:gn}=hY({eventId:l,allLocations:X,userLocation:xt,locationLastUpdated:Kt});let Vn=null;const Zs=async()=>{yo(),Vn=G.value,G.value="map",await cn(),Co.value?.openFullscreen?.()},ko=()=>{Vn&&(G.value=Vn,Vn=null)},hl=()=>{Uo(),Co.value?.mapRef?.closeFullscreen?.(),ko()},{expandedAreaLeadMarshal:fl,savingAreaLeadMarshalTask:pl,areaLeadMarshalDataVersion:vi,allAreaLeadMarshals:zo,toggleAreaLeadMarshalExpansion:Ho,toggleAreaLeadMarshalTask:Ta}=yY({eventId:l,currentMarshalId:y,areaLeadRef:Ae,areaLeadCheckpoints:ee,areaChecklistItems:fe,myChecklistItems:Ge,areaLeadAreaIds:b,loadChecklist:rt}),{checkingIn:Vo,checkingInAssignment:bo,checkInError:mi,showCheckInReminderModal:En,checkInReminderCheckpoint:Ao,dismissedCheckInReminders:Ma,showDistanceWarning:Ks,distanceWarningMessage:so,isCheckInStale:ss,handleCheckInToggle:ao,handleAreaLeadMarshalCheckIn:as,dismissCheckInReminder:vt,dismissDistanceWarning:Bt}=fY({eventId:l,assignments:re,allLocations:X,areaLeadRef:Ae,areaLeadCheckpoints:ee,areaLeadMarshalDataVersion:vi,updatePendingCount:s,updateCachedField:eu,reloadChecklist:rt,checklistItems:oe,currentMarshalId:y}),Pn=D(!1),Sn=D(!1),io=D(""),is=D(""),dt=D(null),Yt=D(!1),Eo=D(""),wo=D(""),bn=(xe,Le)=>{Eo.value=xe,wo.value=Le,Yt.value=!0},Go=D(!1),qo=D(""),_o=D(""),Jt=D(!1),Gn=D(""),ls=async xe=>{_o.value=xe.name||xe.marshalName||"",qo.value="",Gn.value="",Jt.value=!0,Go.value=!0;try{const Le=await _s.getMagicLink(l.value,xe.marshalId);qo.value=Le.data.magicLink,Jt.value=!1}catch(Le){Jt.value=!1,Gn.value=Le.response?.data?.message||"Failed to load magic link"}},{myIncidents:Ys,incidentsLoading:Aa,selectedIncident:Js,showIncidentDetail:Ea,showAddIncidentNoteModal:gi,incidentNoteText:rs,submittingIncidentNote:Pa,showReportIncident:Xs,loadMyIncidents:Qs,handleReportIncident:vl,openIncidentDetail:yi,handleIncidentStatusChange:hr,openAddIncidentNoteModal:bt,closeAddIncidentNoteModal:Dt,submitIncidentNote:zt}=pY({eventId:l,currentMarshalId:y,isAreaLead:I,areaLeadAreaIds:b,sectionLastLoadedAt:Q,showMessage:bn}),Co=D(null),Da=z(()=>Co.value),ea=D(null),ki=xe=>!xe||xe.length===0?!1:xe.some(Le=>b.value.includes(Le)),cs=xe=>{ea.value=ea.value===xe?null:xe},sn=xe=>{const Le=G.value===xe;if(G.value=Le?null:xe,!Le){const nt=Date.now(),mt=$t=>nt-Q.value[$t]>tJ;switch(xe){case"checklist":mt("checklist")&&rt();break;case"notes":mt("notes")&&xi();break;case"incidents":mt("incidents")&&Qs();break;case"eventContacts":mt("eventContacts")&&$i();break}}},wn=D(null),an=xe=>{wn.value=wn.value===xe?null:xe};Ye(()=>re.value,xe=>{xe.length===1&&wn.value===null&&(wn.value=xe[0].id)},{immediate:!0});const lo=z(()=>G.value==="map"||G.value==="assignments"&&wn.value!==null);Ye(lo,xe=>{xe?mn():gn()});const Lo=z(()=>re.value.map(xe=>{const Le=X.value.find(wt=>wt.id===xe.locationId),nt=Le?.areaIds||Le?.AreaIds||[];let mt=null;nt.length>0&&K.value.length>0&&(mt=K.value.find(qn=>nt.includes(qn.id))?.name);const Ht=(Le?.assignments||[]).map(wt=>({...wt,effectiveIsCheckedIn:wt.isCheckedIn&&!ss(wt.checkInTime)})).sort((wt,qn)=>(wt.marshalName||"").localeCompare(qn.marshalName||"",void 0,{sensitivity:"base"})),Bn=Si.value.filter(wt=>nt.includes(wt.areaId)&&(!wt.marshalId||wt.marshalId!==y.value)),Vt=new Set,ln=Bn.filter(wt=>{const qn=JSON.stringify({name:wt.name||"",marshalId:wt.marshalId||"",role:wt.role||"",phone:wt.phone||"",email:wt.email||"",notes:wt.notes||""});return Vt.has(qn)?!1:(Vt.add(qn),!0)}).sort((wt,qn)=>(wt.marshalName||wt.name||"").localeCompare(qn.marshalName||qn.name||"",void 0,{sensitivity:"base"})),ro=xe.isCheckedIn&&!ss(xe.checkInTime);return{...xe,location:Le,areaName:mt,areaIds:nt,allMarshals:Ht,areaContacts:ln,locationName:Le?.name||"Unknown Location",effectiveIsCheckedIn:ro}})),{courseMapActions:Ds,hideOtherCheckpoints:ta,handleCourseMapVisibilityChange:Rs,handleCourseMapAction:Ra,getCheckpointMapActions:ml,handleCheckpointMapVisibilityChange:bi,handleCheckpointMapAction:At}=gY({userLocation:xt,assignmentsWithDetails:Lo,courseMapRef:Da}),wi=z(()=>re.value.length>0?re.value[0]:null),In=z(()=>re.value.map(xe=>xe.locationId)),na=z(()=>ta.value?X.value.filter(xe=>{const Le=In.value.includes(xe.id),nt=xe.isDynamic||xe.IsDynamic;return Le||nt}):X.value),gl=z(()=>Lo.value.some(xe=>xe.location?.isDynamic||xe.location?.IsDynamic)),us=z(()=>Lo.value.find(xe=>xe.location?.isDynamic||xe.location?.IsDynamic)),oa=z(()=>{const xe=us.value;if(!xe)return!1;const Le=xe.location,nt=Le?.locationUpdateScopeConfigurations||Le?.LocationUpdateScopeConfigurations||[];return Xy({scopeConfigurations:nt,marshalId:y.value,marshalAssignmentLocationIds:In.value,areaLeadAreaIds:b.value,locationId:xe.locationId,locationAreaIds:xe.areaIds||[]})}),fr=z(()=>{if(!Z.value||!Lo.value.length)return[];const xe=new Date,Le=Z.value.eventDate?new Date(Z.value.eventDate):null;return Lo.value.filter(nt=>{if(nt.effectiveIsCheckedIn||Ma.value.has(nt.id))return!1;const mt=nt.location;if(!mt)return!1;const $t=mt.startTime?new Date(mt.startTime):Le;if(!$t)return!1;let Ht;if(mt.endTime)Ht=new Date(mt.endTime);else if(Le)Ht=new Date(Le.getTime()+7200*1e3);else return!1;return xe>=$t&&xe<Ht})});Ye(fr,xe=>{xe.length>0&&!En.value&&(Ao.value=xe[0],En.value=!0)},{immediate:!0}),Ye(Ks,xe=>{xe&&(bn("Distance notice",so.value),Bt())});const yl=()=>{const xe=Ao.value;xe&&(vt(xe.id),G.value="assignments",wn.value=xe.id)},sa=z(()=>Z.value?.route?(typeof Z.value.route=="string"?JSON.parse(Z.value.route):Z.value.route)||[]:[]),_i=z(()=>!wi.value||!X.value.length?null:X.value.find(xe=>xe.id===wi.value.locationId)),jo=D([]),Ci=D(!1),On=z(()=>{const xe=jo.value.filter(mt=>!mt.marshalId||mt.marshalId!==y.value),Le=new Set;return xe.filter(mt=>{const $t=JSON.stringify({name:mt.name||"",marshalId:mt.marshalId||"",role:mt.role||"",phone:mt.phone||"",email:mt.email||"",notes:mt.notes||""});return Le.has($t)?!1:(Le.add($t),!0)}).sort((mt,$t)=>{if(mt.isPinned!==$t.isPinned)return mt.isPinned?-1:1;const Ht=mt.displayOrder||0,Bn=$t.displayOrder||0;return Ht!==Bn?Ht-Bn:(mt.name||"").localeCompare($t.name||"",void 0,{sensitivity:"base"})})}),kl=z(()=>On.value.filter(xe=>xe.showInEmergencyInfo)),Li=z(()=>Ce.value.filter(xe=>xe.showInEmergencyInfo)),Wo=z(()=>kl.value.length>0||Li.value.length>0),bl=xe=>{if(!Ce.value||Ce.value.length===0)return[];const Le=[],nt=new Set;for(const $t of Ce.value){const Ht=$t.noteId||$t.NoteId||$t.id;if(nt.has(Ht))continue;const Bn=$t.scopeConfigurations||$t.ScopeConfigurations||[];let Vt=!1;if(Bn.length>0)for(const ln of Bn){const ro=ln.itemType||ln.ItemType,wt=ln.ids||ln.Ids||[];if(ro==="Checkpoint"&&(wt.includes(xe)||wt.includes("ALL_CHECKPOINTS"))){Vt=!0;break}}else{const ln=$t.matchedScope||$t.MatchedScope||"";["EveryoneAtCheckpoints","Checkpoint"].some(wt=>ln.includes(wt)||ln===wt)&&(Vt=!0)}Vt&&(nt.add(Ht),Le.push($t))}const mt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Le.sort(($t,Ht)=>{const Bn=$t.isPinned||$t.IsPinned,Vt=Ht.isPinned||Ht.IsPinned;if(Bn&&!Vt)return-1;if(!Bn&&Vt)return 1;const ln=mt[$t.priority||$t.Priority||"Normal"]??3,ro=mt[Ht.priority||Ht.Priority||"Normal"]??3;if(ln!==ro)return ln-ro;const wt=$t.displayOrder||$t.DisplayOrder||0,qn=Ht.displayOrder||Ht.DisplayOrder||0;if(wt!==qn)return wt-qn;const Zo=$t.createdAt||$t.CreatedAt,vr=Ht.createdAt||Ht.CreatedAt;return new Date(vr)-new Date(Zo)})},Si=D([]),aa=(xe,Le)=>xe.localeCompare(Le,void 0,{numeric:!0,sensitivity:"base"}),Oa=z(()=>{if(!Ct.value)return[];const xe=Ct.value.locationId;return X.value.filter(Le=>Le.id!==xe&&Le.latitude!==0&&Le.longitude!==0).sort((Le,nt)=>aa(Le.name,nt.name))}),Na=z(()=>_i.value?{lat:_i.value.latitude,lng:_i.value.longitude}:xt.value?xt.value:X.value.length>0?{lat:X.value[0].latitude,lng:X.value[0].longitude}:{lat:51.505,lng:-.09}),wl=xe=>{if(Z.value=xe.event,K.value=xe.areas||[],X.value=xe.locations||[],oe.value=xe.checklist||[],jo.value=xe.contacts||[],Ce.value=xe.notes||[],Be.value=xe.roles||[],xe.areaLeadDashboard?.checkpoints&&(ee.value=xe.areaLeadDashboard.checkpoints),Z.value&&Zh(Z.value),y.value){const Le=[];for(const nt of X.value){const mt=nt.assignments?.find($t=>$t.marshalId===y.value);mt&&Le.push(mt)}re.value=Le}},_l=async()=>{const xe=o.params.eventId;console.log("Loading event data for:",{eventId:xe,marshalId:y.value});const Le=await li(xe);let nt=!1;if(Le&&(console.log("Loaded cached data from:",Le.cachedAt),wl(Le),nt=!0,ae.value=!1),Zn())if(nt){console.log("Offline mode - using cached data");return}else{console.warn("No cached data available while offline");return}nt&&(q.value=!0),console.log("Fetching fresh event data in parallel...");const[mt,$t,Ht]=await Promise.allSettled([ni.getById(xe),ma.getByEvent(xe),$r.getEventStatus(xe)]);if(mt.status==="fulfilled"?(Z.value=mt.value.data,console.log("Event loaded:",Z.value?.name),Z.value&&(Zh(Z.value),$(xe,Z.value.name,Z.value.eventDate))):console.error("Failed to load event:",mt.reason),$t.status==="fulfilled"?(K.value=$t.value.data||[],console.log("Areas loaded:",K.value.length)):console.error("Failed to load areas:",$t.reason),Ht.status==="fulfilled"){if(X.value=Ht.value.data?.locations||[],console.log("Locations loaded:",X.value.length),y.value){const Vt=[];for(const ln of X.value){const ro=ln.assignments?.find(wt=>wt.marshalId===y.value);ro&&Vt.push(ro)}re.value=Vt,console.log("Total assignments found:",re.value.length)}}else console.error("Failed to load event status:",Ht.reason);const Bn=[rt(),$i(),xi(),Qs(),Ba()];I.value&&Bn.push(Ii()),await Promise.allSettled(Bn);try{const Vt={event:Z.value,areas:K.value,locations:X.value,checklist:oe.value,contacts:jo.value,notes:Ce.value,roles:Be.value,marshalId:y.value};ee.value.length>0&&(Vt.areaLeadDashboard={checkpoints:ee.value});const ln=JSON.parse(JSON.stringify(Vt));await lc(xe,ln),console.log("Event data cached for offline access")}catch(Vt){console.warn("Failed to cache event data:",Vt)}Nt(),q.value=!1};c.onAuthSuccess=_l;const Cl=async()=>{const xe=o.params.eventId;if(Zn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Le=await ma.getAreaLeadDashboard(xe);if(Le.data){ee.value=Le.data.checkpoints||[];const nt=JSON.parse(JSON.stringify({areas:Le.data.areas||[],checkpoints:Le.data.checkpoints||[]}));await li(xe)?await eu(xe,"areaLeadDashboard",nt):await lc(xe,{areaLeadDashboard:nt}),console.log("Area lead dashboard cached for offline access")}}catch(Le){Le.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Le)}console.log("Background preload complete")},Ii=async()=>{const xe=o.params.eventId;try{const Le=await ma.getAreaLeadDashboard(xe);Le.data?.checkpoints&&(ee.value=Le.data.checkpoints,console.log("Area lead dashboard loaded:",ee.value.length,"checkpoints"))}catch(Le){Le.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Le)}},xi=async()=>{const xe=o.params.eventId;try{const Le=await bs.getMyNotes(xe);Ce.value=Le.data||[],Q.value.notes=Date.now(),console.log("Notes loaded:",Ce.value.length)}catch(Le){console.error("Failed to load notes:",Le)}},$i=async()=>{const xe=o.params.eventId;Ci.value=!0;try{const Le=await ua.getMyContacts(xe);jo.value=Le.data||[],Q.value.eventContacts=Date.now(),console.log("Contacts loaded:",jo.value.length)}catch(Le){console.warn("Failed to load contacts:",Le),jo.value=[]}finally{Ci.value=!1}},Ba=async()=>{const xe=o.params.eventId;try{const Le=await Ka.getMyRoles(xe);Be.value=Le.data||[],console.log("Roles loaded:",Be.value.length)}catch(Le){console.warn("Failed to load roles:",Le),Be.value=[]}},Fa=()=>{Sn.value=!1,dt.value&&(dt.value(),dt.value=null)},ds=()=>{Sn.value=!1,dt.value=null},pr=()=>{Yt.value=!1},Os=async xe=>{if(An.value&&Ct.value){await pe(Ct.value.locationId,xe.lat,xe.lng,"manual"),An.value=!1,Ct.value=null,Co.value?.mapRef?.closeFullscreen?.(),ko();return}if(oa.value&&us.value){const Le=us.value;io.value="Update location",is.value=`Update ${Le.location?.name||"dynamic checkpoint"} to this location?`,dt.value=async()=>{await pe(Le.locationId,xe.lat,xe.lng,"manual"),Co.value?.mapRef?.closeFullscreen?.()},Sn.value=!0}},Nn=async xe=>{if(An.value&&Ct.value){if(xe.id===Ct.value.locationId)return;await pe(Ct.value.locationId,xe.latitude,xe.longitude,"checkpoint",xe.id),An.value=!1,Co.value?.mapRef?.closeFullscreen?.(),ko();return}if(oa.value&&us.value){const Le=us.value;if(xe.id===Le.locationId)return;io.value="Copy location",is.value=`Copy location from "${xe.name}" to ${Le.location?.name||"your dynamic checkpoint"}?`,dt.value=async()=>{await pe(Le.locationId,xe.latitude,xe.longitude,"checkpoint",xe.id),Co.value?.mapRef?.closeFullscreen?.()},Sn.value=!0}},ia=()=>{_(()=>{re.value=[],oe.value=[],Si.value=[]})},Ti=xe=>xe?new Date(xe).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return un(async()=>{nv(!0);const xe=o.params.eventId,Le=o.query.code;ae.value=!0;try{Le?await x(xe,Le):await C(xe)&&await _l()}finally{ae.value=!1}d.value&&(no(),"requestIdleCallback"in window?requestIdleCallback(()=>{Cl()},{timeout:5e3}):setTimeout(()=>{Cl()},2e3))}),Ye(d,xe=>{xe?no():Mo()}),Ye(()=>o.query.code,async xe=>{if(xe&&d.value){ae.value=!0;try{await x(o.params.eventId,xe)}finally{ae.value=!1}}}),Ye(Z,xe=>{xe&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),Ln(()=>{M(),Qe(),on(),gn(),nv(!1)}),(xe,Le)=>(p(),g("div",{class:"marshal-view",style:tt(B(Y))},[Ee(ZV),r("header",{class:le(["header",`logo-${B(ke)}`]),style:tt(B(te))},[B(De)&&B(ke)==="cover"?(p(),g("div",LY,[r("img",{src:B(De),alt:"Event logo",class:"header-logo-cover-img"},null,8,SY)])):P("",!0),B(d)&&B(ke)==="right"?(p(),g("button",{key:1,onClick:ia,class:"btn-close-session btn-close-left",style:tt({color:B(ue)}),title:"Close session"},"  ",4)):P("",!0),B(De)&&B(ke)==="left"?(p(),g("div",IY,[r("img",{src:B(De),alt:"Event logo",class:"header-logo-img"},null,8,xY)])):P("",!0),r("div",$Y,[r("div",{class:"header-title",style:tt({color:B(ue)})},[Z.value?(p(),g("h1",TY,w(Z.value.name),1)):P("",!0),Z.value?.eventDate?(p(),g("div",MY,[Je(w(Ti(Z.value.eventDate))+" ",1),B(Re)&&B(ie)?(p(),g("span",{key:0,class:"header-weather",title:B(ie).description},[Ee(CY,{icon:B(ie).icon,size:18,alt:B(ie).description,color:B(ue)},null,8,["icon","alt","color"]),r("span",EY,w(B(ie).tempMax)+""+w(B(ie).unit),1)],8,AY)):P("",!0)])):P("",!0)],4),B(d)?(p(),g("div",PY,[r("button",{onClick:Le[0]||(Le[0]=nt=>Xs.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),Wo.value?(p(),g("button",{key:0,onClick:Le[1]||(Le[1]=nt=>Pn.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):P("",!0)])):P("",!0)]),B(De)&&B(ke)==="right"?(p(),g("div",DY,[r("img",{src:B(De),alt:"Event logo",class:"header-logo-img"},null,8,RY)])):P("",!0),B(d)&&B(ke)!=="right"?(p(),g("button",{key:4,onClick:ia,class:"btn-close-session btn-close-right",style:tt({color:B(ue)}),title:"Close session"},"  ",4)):P("",!0)],6),r("div",OY,[ae.value?(p(),g("div",NY,[...Le[25]||(Le[25]=[r("div",{class:"loading"},"Loading...",-1)])])):!B(d)&&!B(f)?(p(),g("div",BY,[Le[26]||(Le[26]=r("h2",null,"Welcome",-1)),Le[27]||(Le[27]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),B(h)?(p(),g("p",FY,"Authenticating...")):P("",!0)])):B(f)?(p(),g("div",UY,[Le[28]||(Le[28]=r("h2",null,"Login failed",-1)),r("p",zY,w(B(f)),1),Le[29]||(Le[29]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(p(),g("div",HY,[B(T)||B(E)?(p(),g("div",VY,[r("div",GY,[B(m)?.email?(p(),g("span",qY,w(B(m).email),1)):P("",!0)]),B(T)?(p(),g("div",jY,[r("button",{onClick:Le[2]||(Le[2]=(...nt)=>B(R)&&B(R)(...nt)),class:"btn-mode-switch"}," Switch to Admin ")])):B(E)?(p(),g("div",WY,[...Le[30]||(Le[30]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),r("div",ZY,[Ee(iY,{roles:Be.value,"is-expanded":G.value==="roles",onToggle:Le[3]||(Le[3]=nt=>sn("roles"))},null,8,["roles","is-expanded"]),Ee(KK,{ref:"assignmentsSectionRef","is-expanded":G.value==="assignments",assignments:Lo.value,"expanded-checkpoint-id":wn.value,"all-locations":X.value,route:sa.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,"user-location":B(xt),"has-dynamic-assignment":gl.value,"current-marshal-id":B(y),"current-marshal-name":B(k),"checking-in-id":B(Vo),"checking-in-assignment-id":B(bo),"check-in-error":B(mi),"checking-in-marshal-id":B(Vo),"expanded-marshal-id":ea.value,"updating-location":B(go),"auto-update-enabled":B(oo),"get-toolbar-actions":B(ml),"is-area-lead-for-areas":ki,"get-notes-for-checkpoint":bl,"area-lead-area-ids":B(b),onToggle:Le[4]||(Le[4]=nt=>sn("assignments")),onToggleCheckpoint:an,onMapClick:Os,onLocationClick:Nn,onActionClick:B(At),onVisibilityChange:B(bi),onUpdateLocation:B(tn),onCheckIn:Le[5]||(Le[5]=nt=>B(ao)(nt,!0)),onToggleMarshal:cs,onMarshalCheckIn:Le[6]||(Le[6]=(nt,mt)=>B(ao)(nt,!1,mt)),onToggleAutoUpdate:B(lt),onShowMarshalQr:ls},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","route-color","route-style","route-weight","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ee(dj,{loading:B(ge),error:B(Ne),"is-expanded":G.value==="checklist","is-area-lead":B(I),"my-items":B(Ge),"area-items":B(fe),"area-items-with-local-state":B(be),"visible-items":B(me),"grouped-items":B(He),"completed-count":B(Ze),saving:B(Oe),"effective-group-by":B(ye),"expanded-group":B($e),locations:X.value,areas:K.value,marshals:B(ne),"get-context-name":B(Lt),onToggle:Le[7]||(Le[7]=nt=>sn("checklist")),onToggleItem:B(kt),onToggleGroup:B(Ot)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ee(kj,{"event-id":B(o).params.eventId,notes:Ce.value,locations:X.value,areas:K.value,assignments:re.value,"is-expanded":G.value==="notes",onToggle:Le[8]||(Le[8]=nt=>sn("notes")),onNotesChanged:xi},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ee(XG,{contacts:On.value,loading:Ci.value,"is-expanded":G.value==="eventContacts",onToggle:Le[9]||(Le[9]=nt=>sn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ee(cq,{incidents:B(Ys),loading:B(Aa),"is-expanded":G.value==="incidents",onToggle:Le[10]||(Le[10]=nt=>sn("incidents")),onSelectIncident:B(yi)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ee(QW,{ref_key:"areaLeadSectionRef",ref:ze,"is-area-lead":B(I),"is-expanded":G.value==="areaLead",areas:A.value,"selected-filters":O.value,"filtered-area-ids":U.value,"event-id":B(o).params.eventId,"marshal-id":B(y),route:sa.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onToggle:Le[11]||(Le[11]=nt=>sn("areaLead")),onToggleFilter:F,onChecklistUpdated:B(rt)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","route-color","route-style","route-weight","onChecklistUpdated"]),Ee(PZ,{"is-area-lead":B(I),"is-expanded":G.value==="areaLeadMarshals",marshals:B(zo),"expanded-marshal-id":B(fl),"checking-in-marshal-id":B(Vo),"saving-task":B(pl),"current-marshal-id":B(y),locations:X.value,areas:K.value,onToggle:Le[12]||(Le[12]=nt=>sn("areaLeadMarshals")),onToggleMarshal:B(Ho),onCheckIn:B(as),onToggleTask:B(Ta),onShowQr:ls},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","current-marshal-id","locations","areas","onToggleMarshal","onCheckIn","onToggleTask"]),Ee(Mj,{ref_key:"routeSectionRef",ref:Co,"is-expanded":G.value==="map","user-location":B(xt),"selecting-location":B(An),"selecting-location-name":B(Ct)?.location?.name||"",locations:na.value,route:sa.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,center:Na.value,"highlight-location-ids":In.value,clickable:B(An)||oa.value,"toolbar-actions":B(Ds),onToggle:Le[13]||(Le[13]=nt=>sn("map")),onCancelSelect:hl,onMapClick:Os,onLocationClick:Nn,onActionClick:B(Ra),onVisibilityChange:B(Rs)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","route-color","route-style","route-weight","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Ee(wq,{"event-date":Z.value?.eventDate,description:Z.value?.description,"is-expanded":G.value==="eventDetails",onToggle:Le[14]||(Le[14]=nt=>sn("eventDetails"))},null,8,["event-date","description","is-expanded"])]),q.value?(p(),g("div",KY,[...Le[31]||(Le[31]=[r("span",{class:"refresh-spinner"},null,-1),r("span",null,"Updating...",-1)])])):P("",!0)]))]),Ee(DV,{show:Pn.value,contacts:kl.value,notes:Li.value,onClose:Le[15]||(Le[15]=nt=>Pn.value=!1)},null,8,["show","contacts","notes"]),Ee(S1,{show:B(Xs),"event-id":l.value||"",checkpoint:j.value,"initial-location":B(xt),checkpoints:X.value,route:sa.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onClose:Le[16]||(Le[16]=nt=>Xs.value=!1),onSubmit:B(vl)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","route-color","route-style","route-weight","onSubmit"]),Ee(L1,{show:B(Ea),incident:B(Js),route:sa.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,checkpoints:X.value,"can-manage":B(I),onClose:Le[17]||(Le[17]=nt=>Ea.value=!1),onStatusChange:B(hr),onOpenAddNote:B(bt)},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ee(Zt,{show:B(gi),title:"Add update",size:"small",onClose:B(Dt)},{footer:Ve(()=>[r("div",JY,[r("button",{type:"button",class:"btn btn-secondary",onClick:Le[19]||(Le[19]=(...nt)=>B(Dt)&&B(Dt)(...nt))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Le[20]||(Le[20]=(...nt)=>B(zt)&&B(zt)(...nt)),disabled:!B(rs).trim()||B(Pa)},w(B(Pa)?"Adding...":"Add update"),9,XY)])]),default:Ve(()=>[r("div",YY,[We(r("textarea",{"onUpdate:modelValue":Le[18]||(Le[18]=nt=>dn(rs)?rs.value=nt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,B(rs)]])])]),_:1},8,["show","onClose"]),Ee(hi,{show:Sn.value,title:io.value,message:is.value,onConfirm:Fa,onCancel:ds},null,8,["show","title","message"]),Ee(hi,{show:Yt.value,title:Eo.value,message:wo.value,"show-cancel":!1,onConfirm:pr},null,8,["show","title","message"]),Ee(oG,{show:B(En),checkpoint:B(Ao),"accent-button-style":B(Pe),onDismiss:Le[21]||(Le[21]=nt=>B(vt)(B(Ao)?.id)),onGoToCheckpoint:yl},null,8,["show","checkpoint","accent-button-style"]),Ee(MG,{show:B(ft),assignment:B(Ct),"user-location":B(xt),"auto-update-enabled":B(oo),updating:B(go),error:B(Mt),success:B(Mn),"available-checkpoints":Oa.value,"accent-button-style":B(Pe),onClose:B(Ps),onUpdateGps:B(ve),onToggleAutoUpdate:Le[22]||(Le[22]=nt=>B(lt)(B(Ct))),onSelectOnMap:Zs,onCopyFromCheckpoint:B(Ie)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"]),!Jt.value&&!Gn.value&&qo.value?(p(),qe(Ff,{key:0,show:Go.value,url:qo.value,title:`Magic link for ${_o.value}`,warning:`Only share this QR code with ${_o.value}. This link provides full access to their ${B(n).person} dashboard.`,"z-index":1100,onClose:Le[23]||(Le[23]=nt=>Go.value=!1)},null,8,["show","url","title","warning"])):P("",!0),Jt.value||Gn.value?(p(),qe(Zt,{key:1,show:Go.value,title:`Magic link for ${_o.value}`,size:"small","z-index":1100,onClose:Le[24]||(Le[24]=nt=>Go.value=!1)},{default:Ve(()=>[Jt.value?(p(),g("div",QY,[...Le[32]||(Le[32]=[r("p",null,"Loading magic link...",-1)])])):Gn.value?(p(),g("div",eJ,[r("p",null,w(Gn.value),1)])):P("",!0)]),_:1},8,["show","title"])):P("",!0)],4))}},oJ=Ke(nJ,[["__scopeId","data-v-804a5717"]]),sJ={class:"form-group"},aJ={class:"form-group"},iJ={class:"form-group"},lJ={class:"actions-left"},rJ={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const n=e,s=t,o=D({name:"",email:"",phone:""});Ye(()=>n.profile,h=>{h&&(o.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ye(()=>n.show,h=>{h&&n.profile&&(o.value={name:n.profile.name||"",email:n.profile.email||"",phone:n.profile.phone||""})});const i=()=>{s("update:isDirty",!0)},l=()=>{if(!o.value.name.trim()){alert("Name is required");return}if(!o.value.email.trim()){alert("Email is required");return}s("submit",{name:o.value.name.trim(),email:o.value.email.trim(),phone:o.value.phone?.trim()||""})},c=()=>{s("close")},d=()=>{s("logout")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("div",lJ,[e.showLogout?(p(),g("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):P("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:ct(l,["prevent"])},[r("div",sJ,[f[3]||(f[3]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>o.value.name=m),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,o.value.name]])]),r("div",aJ,[f[4]||(f[4]=r("label",null,"Email *",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>o.value.email=m),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,o.value.email]])]),r("div",iJ,[f[5]||(f[5]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>o.value.phone=m),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,o.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},cJ=Ke(rJ,[["__scopeId","data-v-178e5f48"]]),uJ={class:"tabs"},dJ={class:"tab-content"},hJ={class:"form-group"},fJ={class:"form-group"},pJ={class:"form-group"},vJ={class:"form-group"},mJ=["value"],gJ={class:"tab-content"},yJ={class:"emergency-contacts-section"},kJ={key:0,class:"empty-state"},bJ={class:"card-header"},wJ=["onClick"],_J={class:"form-group"},CJ=["onUpdate:modelValue"],LJ={class:"form-group"},SJ=["onUpdate:modelValue"],IJ={class:"form-group"},xJ=["onUpdate:modelValue"],$J={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const n=e,s=t,{activeTab:o,switchTab:i,resetTab:l}=Wy("basic",["basic","emergency"]),c=D({...n.eventData});Ye(()=>n.eventData,y=>{c.value={...y},c.value.emergencyContacts||(c.value.emergencyContacts=[])},{deep:!0}),Ye(()=>n.show,y=>{y&&l()});const d=()=>{c.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{c.value.emergencyContacts.splice(y,1)},f=()=>{s("submit",{...c.value})},m=()=>{s("close")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Ve(()=>[r("div",uJ,[r("button",{type:"button",onClick:k[0]||(k[0]=b=>B(i)("basic")),class:le(["tab-button",{active:B(o)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=b=>B(i)("emergency")),class:le(["tab-button",{active:B(o)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:ct(f,["prevent"])},[We(r("div",dJ,[r("div",hJ,[k[6]||(k[6]=r("label",null,"Event name *",-1)),We(r("input",{"onUpdate:modelValue":k[2]||(k[2]=b=>c.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",fJ,[k[7]||(k[7]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=b=>c.value.description=b),rows:"3",class:"form-input"},null,512),[[st,c.value.description]])]),r("div",pJ,[k[8]||(k[8]=r("label",null,"Event date *",-1)),We(r("input",{"onUpdate:modelValue":k[4]||(k[4]=b=>c.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,c.value.eventDate]])]),r("div",vJ,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),We(r("select",{"onUpdate:modelValue":k[5]||(k[5]=b=>c.value.timeZoneId=b),required:"",class:"form-input"},[(p(!0),g(Se,null,je(B(v1),b=>(p(),g("option",{key:b.value,value:b.value},w(b.label),9,mJ))),128))],512),[[Qn,c.value.timeZoneId]])])],512),[[os,B(o)==="basic"]]),We(r("div",gJ,[r("div",yJ,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),c.value.emergencyContacts.length===0?(p(),g("div",kJ,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(p(!0),g(Se,null,je(c.value.emergencyContacts,(b,I)=>(p(),g("div",{key:I,class:"emergency-contact-card"},[r("div",bJ,[r("h4",null,"Contact "+w(I+1),1),r("button",{type:"button",onClick:T=>h(I),class:"btn-remove"},"  ",8,wJ)]),r("div",_J,[k[12]||(k[12]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":T=>b.name=T,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,CJ),[[st,b.name]])]),r("div",LJ,[k[13]||(k[13]=r("label",null,"Phone *",-1)),We(r("input",{"onUpdate:modelValue":T=>b.phone=T,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,SJ),[[st,b.phone]])]),r("div",IJ,[k[14]||(k[14]=r("label",null,"Additional details",-1)),We(r("textarea",{"onUpdate:modelValue":T=>b.details=T,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,xJ),[[st,b.details]])])]))),128))])],512),[[os,B(o)==="emergency"]])],32)]),_:1},8,["show","title"]))}},TJ=Ke($J,[["__scopeId","data-v-d820eb4f"]]),MJ=Lf("profile",()=>{const e=D(null),t=D(!1),n=D(null);return{profile:e,loading:t,error:n,fetchProfile:async()=>{t.value=!0,n.value=null;try{const d=await Fc.getProfile();return e.value=d.data,d.data}catch(d){throw n.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,n.value=null;try{const h=await Fc.updateProfile(d);return e.value=h.data,h.data}catch(h){throw n.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,n.value=null;try{return(await Fc.getPerson(d,h)).data}catch(f){throw n.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,n.value=null;try{return(await Fc.updatePerson(d,h,f)).data}catch(m){throw n.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,n.value=null}}}),AJ={class:"sessions-view"},EJ={class:"sessions-container"},PJ={key:0,class:"loading-state"},DJ={key:1,class:"empty-state"},RJ={key:2,class:"sessions-list"},OJ={class:"section-header"},NJ={class:"section-actions"},BJ=["onClick"],FJ={class:"session-info"},UJ={class:"event-name"},zJ={key:0,class:"event-date"},HJ={key:1,class:"sign-in-section"},VJ={key:2,class:"section-header"},GJ=["onClick"],qJ={class:"session-info"},jJ={class:"event-name"},WJ={class:"role-name"},ZJ={key:0,class:"event-date"},KJ=["onClick"],YJ={class:"modal-card"},JJ={class:"modal-actions"},XJ={class:"modal-card"},QJ={class:"modal-actions"},eX={__name:"SessionsView",setup(e){const t=rr(),n=mc(),s=jy(),o=MJ(),i=D([]),l=D([]),c=D(!0),d=D(!1),h=D(!1),f=D(!1),m=D(!1),y=D(null),k=D(!1),b=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),I=z(()=>localStorage.getItem("adminEmail")),T=z(()=>!!I.value),E=()=>{i.value=Nw()},x=ae=>{hy(ae.eventId,ae.marshalId),t.push(`/event/${ae.eventId}`)},C=ae=>{y.value=ae,f.value=!0},_=async()=>{if(!y.value)return;const{sessionKey:ae,eventId:q}=y.value;try{Oo("marshal",q),await authApi.logout()}catch{}Uh(ae),Oo(null),E(),f.value=!1,y.value=null},$=()=>{m.value=!0},R=async()=>{await n.logout(),l.value=[],m.value=!1},M=async()=>{if(h.value=!0,!o.profile)try{await o.fetchProfile()}catch(ae){console.error("Failed to load profile:",ae)}},O=async ae=>{try{await o.updateProfile(ae),h.value=!1}catch(q){console.error("Failed to save profile:",q),alert("Failed to save profile. Please try again.")}},A=async()=>{await n.logout(),l.value=[],h.value=!1},U=ae=>ae?new Date(ae).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",F=async()=>{if(T.value)try{Oo("admin");const ae=await ni.getAll();l.value=ae.data||[]}catch(ae){console.error("Failed to load admin events:",ae),l.value=[]}},j=ae=>{t.push(`/admin/event/${ae}`)},Z=()=>{t.push("/")},X=()=>{},re=()=>{k.value=!1,b.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},K=async ae=>{try{const q={...ae,adminEmail:n.adminEmail};await s.createEvent(q),re(),await F()}catch(q){console.error("Failed to create event:",q),alert("Failed to create event. Please try again.")}};return un(async()=>{document.title="OnTheDay App - Sessions",py(),fy(),E(),await F(),c.value=!1}),(ae,q)=>(p(),g("div",AJ,[r("div",EJ,[Ee(Gy,{title:"Your sessions"}),c.value?(p(),g("div",PJ,[...q[9]||(q[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(p(),g("div",DJ,[q[10]||(q[10]=r("p",null,"No active sessions.",-1)),q[11]||(q[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:q[0]||(q[0]=Y=>d.value=!0)}," Sign in ")])):(p(),g("div",RJ,[T.value?(p(),g(Se,{key:0},[r("div",OJ,[q[12]||(q[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",NJ,[r("button",{class:"btn btn-small btn-primary",onClick:M}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:q[1]||(q[1]=Y=>k.value=!0)}," Create event ")])]),(p(!0),g(Se,null,je(l.value,Y=>(p(),g("div",{key:"admin-"+Y.id,class:"session-card admin-card",onClick:te=>j(Y.id)},[q[14]||(q[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",FJ,[r("div",UJ,w(Y.name),1),q[13]||(q[13]=r("div",{class:"role-name"},"Admin",-1)),Y.eventDate?(p(),g("div",zJ,w(U(Y.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:ct($,["stop"]),title:"Log out as admin"},"  ")],8,BJ))),128))],64)):(p(),g("div",HJ,[r("button",{class:"btn btn-primary",onClick:q[2]||(q[2]=Y=>d.value=!0)}," Sign in ")])),i.value.length>0?(p(),g("div",VJ,[...q[15]||(q[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):P("",!0),(p(!0),g(Se,null,je(i.value,Y=>(p(),g("div",{key:Y.sessionKey,class:"session-card",onClick:te=>x(Y)},[q[16]||(q[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",qJ,[r("div",jJ,w(Y.eventName||"Event"),1),r("div",WJ,w(Y.marshalName||"Marshal"),1),Y.eventDate?(p(),g("div",ZJ,w(U(Y.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:ct(te=>C(Y),["stop"]),title:"Log out from this session"},"  ",8,KJ)],8,GJ))),128))])),r("button",{class:"btn-back-home",onClick:Z,title:"Back to home"},"  ")]),Ee(qy,{show:d.value,onClose:q[3]||(q[3]=Y=>d.value=!1),onSuccess:X},null,8,["show"]),Ee(cJ,{show:h.value,profile:B(o).profile,"show-logout":!0,onClose:q[4]||(q[4]=Y=>h.value=!1),onSubmit:O,onLogout:A},null,8,["show","profile"]),Ee(TJ,{show:k.value,"event-data":b.value,"is-editing":!1,onClose:re,onSubmit:K},null,8,["show","event-data"]),(p(),qe(ec,{to:"body"},[Ee(Is,{name:"modal"},{default:Ve(()=>[m.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:q[6]||(q[6]=ct(Y=>m.value=!1,["self"]))},[r("div",YJ,[q[17]||(q[17]=r("h3",null,"Log out as admin?",-1)),q[18]||(q[18]=r("p",null,"This will log you out from all admin events.",-1)),q[19]||(q[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",JJ,[r("button",{class:"btn btn-secondary",onClick:q[5]||(q[5]=Y=>m.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:R},"Log out")])])])):P("",!0)]),_:1})])),(p(),qe(ec,{to:"body"},[Ee(Is,{name:"modal"},{default:Ve(()=>[f.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:q[8]||(q[8]=ct(Y=>f.value=!1,["self"]))},[r("div",XJ,[q[22]||(q[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[q[20]||(q[20]=Je("This will log you out from ",-1)),r("strong",null,w(y.value?.eventName||"this event"),1),q[21]||(q[21]=Je(".",-1))]),q[23]||(q[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",QJ,[r("button",{class:"btn btn-secondary",onClick:q[7]||(q[7]=Y=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:_},"Log out")])])])):P("",!0)]),_:1})]))]))}},tX=Ke(eX,[["__scopeId","data-v-add55e1c"]]);let Cm=!1;function nX(){Cm||(Cm=!0,py(),fy())}const oX=[{path:"/",name:"Home",component:jC},{path:"/admin/login",name:"AdminLogin",component:e2},{path:"/admin/verify",name:"AdminVerify",component:l2},{path:"/sessions",name:"Sessions",component:tX},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:mV,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:oJ},{path:"/:pathMatch(.*)*",redirect:"/"}],$1=ww({history:Qb("/VolunteerCheckin/testing/"),routes:oX});$1.beforeEach((e,t,n)=>{nX();const s=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!s){n({name:"AdminLogin"});return}if(e.meta.requiresAuth?Oo("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&Oo(null),e.name==="MarshalView"){const o=e.params.eventId,i=!!e.query.code,l=bu(o),c=l?.marshalId?my(o,l.marshalId):null;if(i){n();return}if(l?.token){n();return}if(c){n();return}if(vy()){n({name:"Sessions"});return}}n()});xa().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Vf=ib(Rw);Vf.use(cb());Vf.use($1);Vf.mount("#app");
