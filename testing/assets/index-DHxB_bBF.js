(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function af(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const en={},Kl=[],La=()=>{},Cm=()=>!1,Ru=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),sf=e=>e.startsWith("onUpdate:"),Rn=Object.assign,lf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},R1=Object.prototype.hasOwnProperty,Wt=(e,t)=>R1.call(e,t),ut=Array.isArray,Yl=e=>cc(e)==="[object Map]",lr=e=>cc(e)==="[object Set]",Wf=e=>cc(e)==="[object Date]",_t=e=>typeof e=="function",hn=e=>typeof e=="string",xa=e=>typeof e=="symbol",Qt=e=>e!==null&&typeof e=="object",Lm=e=>(Qt(e)||_t(e))&&_t(e.then)&&_t(e.catch),Sm=Object.prototype.toString,cc=e=>Sm.call(e),O1=e=>cc(e).slice(8,-1),Im=e=>cc(e)==="[object Object]",Ou=e=>hn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dr=af(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Bu=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},B1=/-\w/g,na=Bu(e=>e.replace(B1,t=>t.slice(1).toUpperCase())),N1=/\B([A-Z])/g,fi=Bu(e=>e.replace(N1,"-$1").toLowerCase()),Nu=Bu(e=>e.charAt(0).toUpperCase()+e.slice(1)),kd=Bu(e=>e?`on${Nu(e)}`:""),ii=(e,t)=>!Object.is(e,t),Wc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},xm=(e,t,n,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:n})},Fu=e=>{const t=parseFloat(e);return isNaN(t)?e:t},F1=e=>{const t=hn(e)?Number(e):NaN;return isNaN(t)?e:t};let Zf;const Uu=()=>Zf||(Zf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++){const a=e[n],o=hn(a)?V1(a):tt(a);if(o)for(const i in o)t[i]=o[i]}return t}else if(hn(e)||Qt(e))return e}const U1=/;(?![^(]*\))/g,z1=/:([^]+)/,H1=/\/\*[^]*?\*\//g;function V1(e){const t={};return e.replace(H1,"").split(U1).forEach(n=>{if(n){const a=n.split(z1);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function le(e){let t="";if(hn(e))t=e;else if(ut(e))for(let n=0;n<e.length;n++){const a=le(e[n]);a&&(t+=a+" ")}else if(Qt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const G1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",q1=af(G1);function $m(e){return!!e||e===""}function j1(e,t){if(e.length!==t.length)return!1;let n=!0;for(let a=0;n&&a<e.length;a++)n=tl(e[a],t[a]);return n}function tl(e,t){if(e===t)return!0;let n=Wf(e),a=Wf(t);if(n||a)return n&&a?e.getTime()===t.getTime():!1;if(n=xa(e),a=xa(t),n||a)return e===t;if(n=ut(e),a=ut(t),n||a)return n&&a?j1(e,t):!1;if(n=Qt(e),a=Qt(t),n||a){if(!n||!a)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const l in e){const c=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(c&&!d||!c&&d||!tl(e[l],t[l]))return!1}}return String(e)===String(t)}function rf(e,t){return e.findIndex(n=>tl(n,t))}const Tm=e=>!!(e&&e.__v_isRef===!0),b=e=>hn(e)?e:e==null?"":ut(e)||Qt(e)&&(e.toString===Sm||!_t(e.toString))?Tm(e)?b(e.value):JSON.stringify(e,Mm,2):String(e),Mm=(e,t)=>Tm(t)?Mm(e,t.value):Yl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[a,o],i)=>(n[bd(a,i)+" =>"]=o,n),{})}:lr(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>bd(n))}:xa(t)?bd(t):Qt(t)&&!ut(t)&&!Im(t)?String(t):t,bd=(e,t="")=>{var n;return xa(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function W1(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Wn;class Am{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wn,!t&&Wn&&(this.index=(Wn.scopes||(Wn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Wn;try{return Wn=this,t()}finally{Wn=n}}}on(){++this._on===1&&(this.prevScope=Wn,Wn=this)}off(){this._on>0&&--this._on===0&&(Wn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,a;for(n=0,a=this.effects.length;n<a;n++)this.effects[n].stop();for(this.effects.length=0,n=0,a=this.cleanups.length;n<a;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Em(e){return new Am(e)}function Pm(){return Wn}function Z1(e,t=!1){Wn&&Wn.cleanups.push(e)}let nn;const wd=new WeakSet;class Dm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wn&&Wn.active&&Wn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wd.has(this)&&(wd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Om(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Kf(this),Bm(this);const t=nn,n=Sa;nn=this,Sa=!0;try{return this.fn()}finally{Nm(this),nn=t,Sa=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)df(t);this.deps=this.depsTail=void 0,Kf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){wh(this)&&this.run()}get dirty(){return wh(this)}}let Rm=0,Rr,Or;function Om(e,t=!1){if(e.flags|=8,t){e.next=Or,Or=e;return}e.next=Rr,Rr=e}function cf(){Rm++}function uf(){if(--Rm>0)return;if(Or){let t=Or;for(Or=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Rr;){let t=Rr;for(Rr=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=n}}if(e)throw e}function Bm(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Nm(e){let t,n=e.depsTail,a=n;for(;a;){const o=a.prevDep;a.version===-1?(a===n&&(n=o),df(a),K1(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=o}e.deps=t,e.depsTail=n}function wh(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Fm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Fm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Jr)||(e.globalVersion=Jr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!wh(e))))return;e.flags|=2;const t=e.dep,n=nn,a=Sa;nn=e,Sa=!0;try{Bm(e);const o=e.fn(e._value);(t.version===0||ii(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{nn=n,Sa=a,Nm(e),e.flags&=-3}}function df(e,t=!1){const{dep:n,prevSub:a,nextSub:o}=e;if(a&&(a.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=a,e.nextSub=void 0),n.subs===e&&(n.subs=a,!a&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)df(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function K1(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Sa=!0;const Um=[];function _s(){Um.push(Sa),Sa=!1}function Cs(){const e=Um.pop();Sa=e===void 0?!0:e}function Kf(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=nn;nn=void 0;try{t()}finally{nn=n}}}let Jr=0;class Y1{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class hf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!nn||!Sa||nn===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==nn)n=this.activeLink=new Y1(nn,this),nn.deps?(n.prevDep=nn.depsTail,nn.depsTail.nextDep=n,nn.depsTail=n):nn.deps=nn.depsTail=n,zm(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const a=n.nextDep;a.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=a),n.prevDep=nn.depsTail,n.nextDep=void 0,nn.depsTail.nextDep=n,nn.depsTail=n,nn.deps===n&&(nn.deps=a)}return n}trigger(t){this.version++,Jr++,this.notify(t)}notify(t){cf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{uf()}}}function zm(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)zm(a)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const lu=new WeakMap,Ji=Symbol(""),_h=Symbol(""),Xr=Symbol("");function Yn(e,t,n){if(Sa&&nn){let a=lu.get(e);a||lu.set(e,a=new Map);let o=a.get(n);o||(a.set(n,o=new hf),o.map=a,o.key=n),o.track()}}function fs(e,t,n,a,o,i){const l=lu.get(e);if(!l){Jr++;return}const c=d=>{d&&d.trigger()};if(cf(),t==="clear")l.forEach(c);else{const d=ut(e),h=d&&Ou(n);if(d&&n==="length"){const f=Number(a);l.forEach((m,y)=>{(y==="length"||y===Xr||!xa(y)&&y>=f)&&c(m)})}else switch((n!==void 0||l.has(void 0))&&c(l.get(n)),h&&c(l.get(Xr)),t){case"add":d?h&&c(l.get("length")):(c(l.get(Ji)),Yl(e)&&c(l.get(_h)));break;case"delete":d||(c(l.get(Ji)),Yl(e)&&c(l.get(_h)));break;case"set":Yl(e)&&c(l.get(Ji));break}}uf()}function J1(e,t){const n=lu.get(e);return n&&n.get(t)}function Bl(e){const t=Ft(e);return t===e?t:(Yn(t,"iterate",Xr),Fo(e)?t:t.map($a))}function zu(e){return Yn(e=Ft(e),"iterate",Xr),e}function Ys(e,t){return Ls(e)?bs(e)?tr($a(t)):tr(t):$a(t)}const X1={__proto__:null,[Symbol.iterator](){return _d(this,Symbol.iterator,e=>Ys(this,e))},concat(...e){return Bl(this).concat(...e.map(t=>ut(t)?Bl(t):t))},entries(){return _d(this,"entries",e=>(e[1]=Ys(this,e[1]),e))},every(e,t){return ls(this,"every",e,t,void 0,arguments)},filter(e,t){return ls(this,"filter",e,t,n=>n.map(a=>Ys(this,a)),arguments)},find(e,t){return ls(this,"find",e,t,n=>Ys(this,n),arguments)},findIndex(e,t){return ls(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return ls(this,"findLast",e,t,n=>Ys(this,n),arguments)},findLastIndex(e,t){return ls(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return ls(this,"forEach",e,t,void 0,arguments)},includes(...e){return Cd(this,"includes",e)},indexOf(...e){return Cd(this,"indexOf",e)},join(e){return Bl(this).join(e)},lastIndexOf(...e){return Cd(this,"lastIndexOf",e)},map(e,t){return ls(this,"map",e,t,void 0,arguments)},pop(){return wr(this,"pop")},push(...e){return wr(this,"push",e)},reduce(e,...t){return Yf(this,"reduce",e,t)},reduceRight(e,...t){return Yf(this,"reduceRight",e,t)},shift(){return wr(this,"shift")},some(e,t){return ls(this,"some",e,t,void 0,arguments)},splice(...e){return wr(this,"splice",e)},toReversed(){return Bl(this).toReversed()},toSorted(e){return Bl(this).toSorted(e)},toSpliced(...e){return Bl(this).toSpliced(...e)},unshift(...e){return wr(this,"unshift",e)},values(){return _d(this,"values",e=>Ys(this,e))}};function _d(e,t,n){const a=zu(e),o=a[t]();return a!==e&&!Fo(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=n(i.value)),i}),o}const Q1=Array.prototype;function ls(e,t,n,a,o,i){const l=zu(e),c=l!==e&&!Fo(e),d=l[t];if(d!==Q1[t]){const m=d.apply(e,i);return c?$a(m):m}let h=n;l!==e&&(c?h=function(m,y){return n.call(this,Ys(e,m),y,e)}:n.length>2&&(h=function(m,y){return n.call(this,m,y,e)}));const f=d.call(l,h,a);return c&&o?o(f):f}function Yf(e,t,n,a){const o=zu(e);let i=n;return o!==e&&(Fo(e)?n.length>3&&(i=function(l,c,d){return n.call(this,l,c,d,e)}):i=function(l,c,d){return n.call(this,l,Ys(e,c),d,e)}),o[t](i,...a)}function Cd(e,t,n){const a=Ft(e);Yn(a,"iterate",Xr);const o=a[t](...n);return(o===-1||o===!1)&&Hu(n[0])?(n[0]=Ft(n[0]),a[t](...n)):o}function wr(e,t,n=[]){_s(),cf();const a=Ft(e)[t].apply(e,n);return uf(),Cs(),a}const ek=af("__proto__,__v_isRef,__isVue"),Hm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(xa));function tk(e){xa(e)||(e=String(e));const t=Ft(this);return Yn(t,"has",e),t.hasOwnProperty(e)}class Vm{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,a){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return a===(o?i?dk:Wm:i?jm:qm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const l=ut(t);if(!o){let d;if(l&&(d=X1[n]))return d;if(n==="hasOwnProperty")return tk}const c=Reflect.get(t,n,dn(t)?t:a);if((xa(n)?Hm.has(n):ek(n))||(o||Yn(t,"get",n),i))return c;if(dn(c)){const d=l&&Ou(n)?c:c.value;return o&&Qt(d)?Lh(d):d}return Qt(c)?o?Lh(c):al(c):c}}class Gm extends Vm{constructor(t=!1){super(!1,t)}set(t,n,a,o){let i=t[n];const l=ut(t)&&Ou(n);if(!this._isShallow){const h=Ls(i);if(!Fo(a)&&!Ls(a)&&(i=Ft(i),a=Ft(a)),!l&&dn(i)&&!dn(a))return h||(i.value=a),!0}const c=l?Number(n)<t.length:Wt(t,n),d=Reflect.set(t,n,a,dn(t)?t:o);return t===Ft(o)&&(c?ii(a,i)&&fs(t,"set",n,a):fs(t,"add",n,a)),d}deleteProperty(t,n){const a=Wt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&a&&fs(t,"delete",n,void 0),o}has(t,n){const a=Reflect.has(t,n);return(!xa(n)||!Hm.has(n))&&Yn(t,"has",n),a}ownKeys(t){return Yn(t,"iterate",ut(t)?"length":Ji),Reflect.ownKeys(t)}}class nk extends Vm{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const ok=new Gm,ak=new nk,sk=new Gm(!0);const Ch=e=>e,Pc=e=>Reflect.getPrototypeOf(e);function ik(e,t,n){return function(...a){const o=this.__v_raw,i=Ft(o),l=Yl(i),c=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=o[e](...a),f=n?Ch:t?tr:$a;return!t&&Yn(i,"iterate",d?_h:Ji),{next(){const{value:m,done:y}=h.next();return y?{value:m,done:y}:{value:c?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Dc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function lk(e,t){const n={get(o){const i=this.__v_raw,l=Ft(i),c=Ft(o);e||(ii(o,c)&&Yn(l,"get",o),Yn(l,"get",c));const{has:d}=Pc(l),h=t?Ch:e?tr:$a;if(d.call(l,o))return h(i.get(o));if(d.call(l,c))return h(i.get(c));i!==l&&i.get(o)},get size(){const o=this.__v_raw;return!e&&Yn(Ft(o),"iterate",Ji),o.size},has(o){const i=this.__v_raw,l=Ft(i),c=Ft(o);return e||(ii(o,c)&&Yn(l,"has",o),Yn(l,"has",c)),o===c?i.has(o):i.has(o)||i.has(c)},forEach(o,i){const l=this,c=l.__v_raw,d=Ft(c),h=t?Ch:e?tr:$a;return!e&&Yn(d,"iterate",Ji),c.forEach((f,m)=>o.call(i,h(f),h(m),l))}};return Rn(n,e?{add:Dc("add"),set:Dc("set"),delete:Dc("delete"),clear:Dc("clear")}:{add(o){!t&&!Fo(o)&&!Ls(o)&&(o=Ft(o));const i=Ft(this);return Pc(i).has.call(i,o)||(i.add(o),fs(i,"add",o,o)),this},set(o,i){!t&&!Fo(i)&&!Ls(i)&&(i=Ft(i));const l=Ft(this),{has:c,get:d}=Pc(l);let h=c.call(l,o);h||(o=Ft(o),h=c.call(l,o));const f=d.call(l,o);return l.set(o,i),h?ii(i,f)&&fs(l,"set",o,i):fs(l,"add",o,i),this},delete(o){const i=Ft(this),{has:l,get:c}=Pc(i);let d=l.call(i,o);d||(o=Ft(o),d=l.call(i,o)),c&&c.call(i,o);const h=i.delete(o);return d&&fs(i,"delete",o,void 0),h},clear(){const o=Ft(this),i=o.size!==0,l=o.clear();return i&&fs(o,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=ik(o,e,t)}),n}function ff(e,t){const n=lk(e,t);return(a,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?a:Reflect.get(Wt(n,o)&&o in a?n:a,o,i)}const rk={get:ff(!1,!1)},ck={get:ff(!1,!0)},uk={get:ff(!0,!1)};const qm=new WeakMap,jm=new WeakMap,Wm=new WeakMap,dk=new WeakMap;function hk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fk(e){return e.__v_skip||!Object.isExtensible(e)?0:hk(O1(e))}function al(e){return Ls(e)?e:pf(e,!1,ok,rk,qm)}function Zm(e){return pf(e,!1,sk,ck,jm)}function Lh(e){return pf(e,!0,ak,uk,Wm)}function pf(e,t,n,a,o){if(!Qt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=fk(e);if(i===0)return e;const l=o.get(e);if(l)return l;const c=new Proxy(e,i===2?a:n);return o.set(e,c),c}function bs(e){return Ls(e)?bs(e.__v_raw):!!(e&&e.__v_isReactive)}function Ls(e){return!!(e&&e.__v_isReadonly)}function Fo(e){return!!(e&&e.__v_isShallow)}function Hu(e){return e?!!e.__v_raw:!1}function Ft(e){const t=e&&e.__v_raw;return t?Ft(t):e}function vf(e){return!Wt(e,"__v_skip")&&Object.isExtensible(e)&&xm(e,"__v_skip",!0),e}const $a=e=>Qt(e)?al(e):e,tr=e=>Qt(e)?Lh(e):e;function dn(e){return e?e.__v_isRef===!0:!1}function A(e){return Km(e,!1)}function pk(e){return Km(e,!0)}function Km(e,t){return dn(e)?e:new vk(e,t)}class vk{constructor(t,n){this.dep=new hf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Ft(t),this._value=n?t:$a(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,a=this.__v_isShallow||Fo(t)||Ls(t);t=a?t:Ft(t),ii(t,n)&&(this._rawValue=t,this._value=a?t:$a(t),this.dep.trigger())}}function F(e){return dn(e)?e.value:e}function ru(e){return _t(e)?e():F(e)}const mk={get:(e,t,n)=>t==="__v_raw"?e:F(Reflect.get(e,t,n)),set:(e,t,n,a)=>{const o=e[t];return dn(o)&&!dn(n)?(o.value=n,!0):Reflect.set(e,t,n,a)}};function Ym(e){return bs(e)?e:new Proxy(e,mk)}function gk(e){const t=ut(e)?new Array(e.length):{};for(const n in e)t[n]=kk(e,n);return t}class yk{constructor(t,n,a){this._object=t,this._key=n,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Ft(t);let o=!0,i=t;if(!ut(t)||!Ou(String(n)))do o=!Hu(i)||Fo(i);while(o&&(i=i.__v_raw));this._shallow=o}get value(){let t=this._object[this._key];return this._shallow&&(t=F(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&dn(this._raw[this._key])){const n=this._object[this._key];if(dn(n)){n.value=t;return}}this._object[this._key]=t}get dep(){return J1(this._raw,this._key)}}function kk(e,t,n){return new yk(e,t,n)}class bk{constructor(t,n,a){this.fn=t,this.setter=n,this._value=void 0,this.dep=new hf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Jr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&nn!==this)return Om(this,!0),!0}get value(){const t=this.dep.track();return Fm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function wk(e,t,n=!1){let a,o;return _t(e)?a=e:(a=e.get,o=e.set),new bk(a,o,n)}const Rc={},cu=new WeakMap;let Vi;function _k(e,t=!1,n=Vi){if(n){let a=cu.get(n);a||cu.set(n,a=[]),a.push(e)}}function Ck(e,t,n=en){const{immediate:a,deep:o,once:i,scheduler:l,augmentJob:c,call:d}=n,h=I=>o?I:Fo(I)||o===!1||o===0?ps(I,1):ps(I);let f,m,y,k,_=!1,x=!1;if(dn(e)?(m=()=>e.value,_=Fo(e)):bs(e)?(m=()=>h(e),_=!0):ut(e)?(x=!0,_=e.some(I=>bs(I)||Fo(I)),m=()=>e.map(I=>{if(dn(I))return I.value;if(bs(I))return h(I);if(_t(I))return d?d(I,2):I()})):_t(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){_s();try{y()}finally{Cs()}}const I=Vi;Vi=f;try{return d?d(e,3,[k]):e(k)}finally{Vi=I}}:m=La,t&&o){const I=m,T=o===!0?1/0:o;m=()=>ps(I(),T)}const D=Pm(),M=()=>{f.stop(),D&&D.active&&lf(D.effects,f)};if(i&&t){const I=t;t=(...T)=>{I(...T),M()}}let S=x?new Array(e.length).fill(Rc):Rc;const w=I=>{if(!(!(f.flags&1)||!f.dirty&&!I))if(t){const T=f.run();if(o||_||(x?T.some((B,E)=>ii(B,S[E])):ii(T,S))){y&&y();const B=Vi;Vi=f;try{const E=[T,S===Rc?void 0:x&&S[0]===Rc?[]:S,k];S=T,d?d(t,3,E):t(...E)}finally{Vi=B}}}else f.run()};return c&&c(w),f=new Dm(m),f.scheduler=l?()=>l(w,!1):w,k=I=>_k(I,!1,f),y=f.onStop=()=>{const I=cu.get(f);if(I){if(d)d(I,4);else for(const T of I)T();cu.delete(f)}},t?a?w(!0):S=f.run():l?l(w.bind(null,!0),!0):f.run(),M.pause=f.pause.bind(f),M.resume=f.resume.bind(f),M.stop=M,M}function ps(e,t=1/0,n){if(t<=0||!Qt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,dn(e))ps(e.value,t,n);else if(ut(e))for(let a=0;a<e.length;a++)ps(e[a],t,n);else if(lr(e)||Yl(e))e.forEach(a=>{ps(a,t,n)});else if(Im(e)){for(const a in e)ps(e[a],t,n);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&ps(e[a],t,n)}return e}function uc(e,t,n,a){try{return a?e(...a):e()}catch(o){Vu(o,t,n)}}function Ta(e,t,n,a){if(_t(e)){const o=uc(e,t,n,a);return o&&Lm(o)&&o.catch(i=>{Vu(i,t,n)}),o}if(ut(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Ta(e[i],t,n,a));return o}}function Vu(e,t,n,a=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||en;if(t){let c=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${n}`;for(;c;){const f=c.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,h)===!1)return}c=c.parent}if(i){_s(),uc(i,null,10,[e,d,h]),Cs();return}}Lk(e,n,o,a,l)}function Lk(e,t,n,a=!0,o=!1){if(o)throw e;console.error(e)}const vo=[];let za=-1;const Jl=[];let Js=null,Hl=0;const Jm=Promise.resolve();let uu=null;function cn(e){const t=uu||Jm;return e?t.then(this?e.bind(this):e):t}function Sk(e){let t=za+1,n=vo.length;for(;t<n;){const a=t+n>>>1,o=vo[a],i=Qr(o);i<e||i===e&&o.flags&2?t=a+1:n=a}return t}function mf(e){if(!(e.flags&1)){const t=Qr(e),n=vo[vo.length-1];!n||!(e.flags&2)&&t>=Qr(n)?vo.push(e):vo.splice(Sk(t),0,e),e.flags|=1,Xm()}}function Xm(){uu||(uu=Jm.then(tg))}function Qm(e){ut(e)?Jl.push(...e):Js&&e.id===-1?Js.splice(Hl+1,0,e):e.flags&1||(Jl.push(e),e.flags|=1),Xm()}function Jf(e,t,n=za+1){for(;n<vo.length;n++){const a=vo[n];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;vo.splice(n,1),n--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function eg(e){if(Jl.length){const t=[...new Set(Jl)].sort((n,a)=>Qr(n)-Qr(a));if(Jl.length=0,Js){Js.push(...t);return}for(Js=t,Hl=0;Hl<Js.length;Hl++){const n=Js[Hl];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Js=null,Hl=0}}const Qr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function tg(e){try{for(za=0;za<vo.length;za++){const t=vo[za];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),uc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;za<vo.length;za++){const t=vo[za];t&&(t.flags&=-2)}za=-1,vo.length=0,eg(),uu=null,(vo.length||Jl.length)&&tg()}}let Hn=null,ng=null;function du(e){const t=Hn;return Hn=e,ng=e&&e.type.__scopeId||null,t}function Ve(e,t=Hn,n){if(!t||e._n)return e;const a=(...o)=>{a._d&&pu(-1);const i=du(t);let l;try{l=e(...o)}finally{du(i),a._d&&pu(1)}return l};return a._n=!0,a._c=!0,a._d=!0,a}function We(e,t){if(Hn===null)return e;const n=Ku(Hn),a=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,l,c,d=en]=t[o];i&&(_t(i)&&(i={mounted:i,updated:i}),i.deep&&ps(l),a.push({dir:i,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d}))}return e}function Oi(e,t,n,a){const o=e.dirs,i=t&&t.dirs;for(let l=0;l<o.length;l++){const c=o[l];i&&(c.oldValue=i[l].value);let d=c.dir[a];d&&(_s(),Ta(d,n,8,[e.el,c,e,t]),Cs())}}function Br(e,t){if(Xn){let n=Xn.provides;const a=Xn.parent&&Xn.parent.provides;a===n&&(n=Xn.provides=Object.create(a)),n[e]=t}}function xo(e,t,n=!1){const a=Zu();if(a||Xi){let o=Xi?Xi._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&_t(t)?t.call(a&&a.proxy):t}}function Ik(){return!!(Zu()||Xi)}const xk=Symbol.for("v-scx"),$k=()=>xo(xk);function Ye(e,t,n){return og(e,t,n)}function og(e,t,n=en){const{immediate:a,deep:o,flush:i,once:l}=n,c=Rn({},n),d=t&&a||!t&&i!=="post";let h;if(ac){if(i==="sync"){const k=$k();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=La,k.resume=La,k.pause=La,k}}const f=Xn;c.call=(k,_,x)=>Ta(k,f,_,x);let m=!1;i==="post"?c.scheduler=k=>{fo(k,f&&f.suspense)}:i!=="sync"&&(m=!0,c.scheduler=(k,_)=>{_?k():mf(k)}),c.augmentJob=k=>{t&&(k.flags|=4),m&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const y=Ck(e,t,c);return ac&&(h?h.push(y):d&&y()),y}function Tk(e,t,n){const a=this.proxy,o=hn(e)?e.includes(".")?ag(a,e):()=>a[e]:e.bind(a,a);let i;_t(t)?i=t:(i=t.handler,n=t);const l=dc(this),c=og(o,i.bind(a),n);return l(),c}function ag(e,t){const n=t.split(".");return()=>{let a=e;for(let o=0;o<n.length&&a;o++)a=a[n[o]];return a}}const sg=Symbol("_vte"),ig=e=>e.__isTeleport,Nr=e=>e&&(e.disabled||e.disabled===""),Xf=e=>e&&(e.defer||e.defer===""),Qf=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ep=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Sh=(e,t)=>{const n=e&&e.to;return hn(n)?t?t(n):null:n},lg={name:"Teleport",__isTeleport:!0,process(e,t,n,a,o,i,l,c,d,h){const{mc:f,pc:m,pbc:y,o:{insert:k,querySelector:_,createText:x,createComment:D}}=h,M=Nr(t.props);let{shapeFlag:S,children:w,dynamicChildren:I}=t;if(e==null){const T=t.el=x(""),B=t.anchor=x("");k(T,n,a),k(B,n,a);const E=($,z)=>{S&16&&f(w,$,z,o,i,l,c,d)},N=()=>{const $=t.target=Sh(t.props,_),z=rg($,t,x,k);$&&(l!=="svg"&&Qf($)?l="svg":l!=="mathml"&&ep($)&&(l="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add($),M||(E($,z),Zc(t,!1)))};M&&(E(n,B),Zc(t,!0)),Xf(t.props)?(t.el.__isMounted=!1,fo(()=>{N(),delete t.el.__isMounted},i)):N()}else{if(Xf(t.props)&&e.el.__isMounted===!1){fo(()=>{lg.process(e,t,n,a,o,i,l,c,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const T=t.anchor=e.anchor,B=t.target=e.target,E=t.targetAnchor=e.targetAnchor,N=Nr(e.props),$=N?n:B,z=N?T:E;if(l==="svg"||Qf(B)?l="svg":(l==="mathml"||ep(B))&&(l="mathml"),I?(y(e.dynamicChildren,I,$,o,i,l,c),wf(e,t,!0)):d||m(e,t,$,z,o,i,l,c,!1),M)N?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Oc(t,n,T,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const O=t.target=Sh(t.props,_);O&&Oc(t,O,null,h,0)}else N&&Oc(t,B,E,h,1);Zc(t,M)}},remove(e,t,n,{um:a,o:{remove:o}},i){const{shapeFlag:l,children:c,anchor:d,targetStart:h,targetAnchor:f,target:m,props:y}=e;if(m&&(o(h),o(f)),i&&o(d),l&16){const k=i||!Nr(y);for(let _=0;_<c.length;_++){const x=c[_];a(x,t,n,k,!!x.dynamicChildren)}}},move:Oc,hydrate:Mk};function Oc(e,t,n,{o:{insert:a},m:o},i=2){i===0&&a(e.targetAnchor,t,n);const{el:l,anchor:c,shapeFlag:d,children:h,props:f}=e,m=i===2;if(m&&a(l,t,n),(!m||Nr(f))&&d&16)for(let y=0;y<h.length;y++)o(h[y],t,n,2);m&&a(c,t,n)}function Mk(e,t,n,a,o,i,{o:{nextSibling:l,parentNode:c,querySelector:d,insert:h,createText:f}},m){function y(x,D,M,S){D.anchor=m(l(x),D,c(x),n,a,o,i),D.targetStart=M,D.targetAnchor=S}const k=t.target=Sh(t.props,d),_=Nr(t.props);if(k){const x=k._lpa||k.firstChild;if(t.shapeFlag&16)if(_)y(e,t,x,x&&l(x));else{t.anchor=l(e);let D=x;for(;D;){if(D&&D.nodeType===8){if(D.data==="teleport start anchor")t.targetStart=D;else if(D.data==="teleport anchor"){t.targetAnchor=D,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}D=l(D)}t.targetAnchor||rg(k,t,f,h),m(x&&l(x),t,k,n,a,o,i)}Zc(t,_)}else _&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const ec=lg;function Zc(e,t){const n=e.ctx;if(n&&n.ut){let a,o;for(t?(a=e.el,o=e.anchor):(a=e.targetStart,o=e.targetAnchor);a&&a!==o;)a.nodeType===1&&a.setAttribute("data-v-owner",n.uid),a=a.nextSibling;n.ut()}}function rg(e,t,n,a){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[sg]=i,e&&(a(o,e),a(i,e)),i}const hs=Symbol("_leaveCb"),Bc=Symbol("_enterCb");function Ak(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return un(()=>{e.isMounted=!0}),yg(()=>{e.isUnmounting=!0}),e}const Jo=[Function,Array],cg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Jo,onEnter:Jo,onAfterEnter:Jo,onEnterCancelled:Jo,onBeforeLeave:Jo,onLeave:Jo,onAfterLeave:Jo,onLeaveCancelled:Jo,onBeforeAppear:Jo,onAppear:Jo,onAfterAppear:Jo,onAppearCancelled:Jo},ug=e=>{const t=e.subTree;return t.component?ug(t.component):t},Ek={name:"BaseTransition",props:cg,setup(e,{slots:t}){const n=Zu(),a=Ak();return()=>{const o=t.default&&fg(t.default(),!0);if(!o||!o.length)return;const i=dg(o),l=Ft(e),{mode:c}=l;if(a.isLeaving)return Ld(i);const d=tp(i);if(!d)return Ld(i);let h=Ih(d,l,a,n,m=>h=m);d.type!==Jn&&tc(d,h);let f=n.subTree&&tp(n.subTree);if(f&&f.type!==Jn&&!qi(f,d)&&ug(n).type!==Jn){let m=Ih(f,l,a,n);if(tc(f,m),c==="out-in"&&d.type!==Jn)return a.isLeaving=!0,m.afterLeave=()=>{a.isLeaving=!1,n.job.flags&8||n.update(),delete m.afterLeave,f=void 0},Ld(i);c==="in-out"&&d.type!==Jn?m.delayLeave=(y,k,_)=>{const x=hg(a,f);x[String(f.key)]=f,y[hs]=()=>{k(),y[hs]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{_(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function dg(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Jn){t=n;break}}return t}const Pk=Ek;function hg(e,t){const{leavingVNodes:n}=e;let a=n.get(t.type);return a||(a=Object.create(null),n.set(t.type,a)),a}function Ih(e,t,n,a,o){const{appear:i,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:k,onAfterLeave:_,onLeaveCancelled:x,onBeforeAppear:D,onAppear:M,onAfterAppear:S,onAppearCancelled:w}=t,I=String(e.key),T=hg(n,e),B=($,z)=>{$&&Ta($,a,9,z)},E=($,z)=>{const O=z[1];B($,z),ut($)?$.every(j=>j.length<=1)&&O():$.length<=1&&O()},N={mode:l,persisted:c,beforeEnter($){let z=d;if(!n.isMounted)if(i)z=D||d;else return;$[hs]&&$[hs](!0);const O=T[I];O&&qi(e,O)&&O.el[hs]&&O.el[hs](),B(z,[$])},enter($){let z=h,O=f,j=m;if(!n.isMounted)if(i)z=M||h,O=S||f,j=w||m;else return;let Z=!1;const J=$[Bc]=re=>{Z||(Z=!0,re?B(j,[$]):B(O,[$]),N.delayedLeave&&N.delayedLeave(),$[Bc]=void 0)};z?E(z,[$,J]):J()},leave($,z){const O=String(e.key);if($[Bc]&&$[Bc](!0),n.isUnmounting)return z();B(y,[$]);let j=!1;const Z=$[hs]=J=>{j||(j=!0,z(),J?B(x,[$]):B(_,[$]),$[hs]=void 0,T[O]===e&&delete T[O])};T[O]=e,k?E(k,[$,Z]):Z()},clone($){const z=Ih($,t,n,a,o);return o&&o(z),z}};return N}function Ld(e){if(Gu(e))return e=ci(e),e.children=null,e}function tp(e){if(!Gu(e))return ig(e.type)&&e.children?dg(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&_t(n.default))return n.default()}}function tc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,tc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function fg(e,t=!1,n){let a=[],o=0;for(let i=0;i<e.length;i++){let l=e[i];const c=n==null?l.key:String(n)+String(l.key!=null?l.key:i);l.type===Ie?(l.patchFlag&128&&o++,a=a.concat(fg(l.children,t,c))):(t||l.type!==Jn)&&a.push(c!=null?ci(l,{key:c}):l)}if(o>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function pg(e,t){return _t(e)?Rn({name:e.name},t,{setup:e}):e}function vg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const hu=new WeakMap;function Fr(e,t,n,a,o=!1){if(ut(e)){e.forEach((_,x)=>Fr(_,t&&(ut(t)?t[x]:t),n,a,o));return}if(Xl(a)&&!o){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&Fr(e,t,n,a.component.subTree);return}const i=a.shapeFlag&4?Ku(a.component):a.el,l=o?null:i,{i:c,r:d}=e,h=t&&t.r,f=c.refs===en?c.refs={}:c.refs,m=c.setupState,y=Ft(m),k=m===en?Cm:_=>Wt(y,_);if(h!=null&&h!==d){if(np(t),hn(h))f[h]=null,k(h)&&(m[h]=null);else if(dn(h)){h.value=null;const _=t;_.k&&(f[_.k]=null)}}if(_t(d))uc(d,c,12,[l,f]);else{const _=hn(d),x=dn(d);if(_||x){const D=()=>{if(e.f){const M=_?k(d)?m[d]:f[d]:d.value;if(o)ut(M)&&lf(M,i);else if(ut(M))M.includes(i)||M.push(i);else if(_)f[d]=[i],k(d)&&(m[d]=f[d]);else{const S=[i];d.value=S,e.k&&(f[e.k]=S)}}else _?(f[d]=l,k(d)&&(m[d]=l)):x&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const M=()=>{D(),hu.delete(e)};M.id=-1,hu.set(e,M),fo(M,n)}else np(e),D()}}}function np(e){const t=hu.get(e);t&&(t.flags|=8,hu.delete(e))}Uu().requestIdleCallback;Uu().cancelIdleCallback;const Xl=e=>!!e.type.__asyncLoader,Gu=e=>e.type.__isKeepAlive;function Dk(e,t){mg(e,"a",t)}function Rk(e,t){mg(e,"da",t)}function mg(e,t,n=Xn){const a=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(qu(t,a,n),n){let o=n.parent;for(;o&&o.parent;)Gu(o.parent.vnode)&&Ok(a,t,n,o),o=o.parent}}function Ok(e,t,n,a){const o=qu(t,e,a,!0);Ln(()=>{lf(a[t],o)},n)}function qu(e,t,n=Xn,a=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...l)=>{_s();const c=dc(n),d=Ta(t,n,e,l);return c(),Cs(),d});return a?o.unshift(i):o.push(i),i}}const Is=e=>(t,n=Xn)=>{(!ac||e==="sp")&&qu(e,(...a)=>t(...a),n)},Bk=Is("bm"),un=Is("m"),gg=Is("bu"),Nk=Is("u"),yg=Is("bum"),Ln=Is("um"),Fk=Is("sp"),Uk=Is("rtg"),zk=Is("rtc");function Hk(e,t=Xn){qu("ec",e,t)}const kg="components";function gf(e,t){return wg(kg,e,!0,t)||e}const bg=Symbol.for("v-ndc");function Vk(e){return hn(e)?wg(kg,e,!1)||e:e||bg}function wg(e,t,n=!0,a=!1){const o=Hn||Xn;if(o){const i=o.type;{const c=I0(i,!1);if(c&&(c===t||c===na(t)||c===Nu(na(t))))return i}const l=op(o[e]||i[e],t)||op(o.appContext[e],t);return!l&&a?i:l}}function op(e,t){return e&&(e[t]||e[na(t)]||e[Nu(na(t))])}function je(e,t,n,a){let o;const i=n,l=ut(e);if(l||hn(e)){const c=l&&bs(e);let d=!1,h=!1;c&&(d=!Fo(e),h=Ls(e),e=zu(e)),o=new Array(e.length);for(let f=0,m=e.length;f<m;f++)o[f]=t(d?h?tr($a(e[f])):$a(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let c=0;c<e;c++)o[c]=t(c+1,c,void 0,i)}else if(Qt(e))if(e[Symbol.iterator])o=Array.from(e,(c,d)=>t(c,d,void 0,i));else{const c=Object.keys(e);o=new Array(c.length);for(let d=0,h=c.length;d<h;d++){const f=c[d];o[d]=t(e[f],f,d,i)}}else o=[];return o}function yf(e,t){for(let n=0;n<t.length;n++){const a=t[n];if(ut(a))for(let o=0;o<a.length;o++)e[a[o].name]=a[o].fn;else a&&(e[a.name]=a.key?(...o)=>{const i=a.fn(...o);return i&&(i.key=a.key),i}:a.fn)}return e}function mo(e,t,n={},a,o){if(Hn.ce||Hn.parent&&Xl(Hn.parent)&&Hn.parent.ce){const h=Object.keys(n).length>0;return t!=="default"&&(n.name=t),p(),qe(Ie,null,[Pe("slot",n,a&&a())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),p();const l=i&&_g(i(n)),c=n.key||l&&l.key,d=qe(Ie,{key:(c&&!xa(c)?c:`_${t}`)+(!l&&a?"_fb":"")},l||(a?a():[]),l&&e._===1?64:-2);return!o&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function _g(e){return e.some(t=>oc(t)?!(t.type===Jn||t.type===Ie&&!_g(t.children)):!0)?e:null}const xh=e=>e?zg(e)?Ku(e):xh(e.parent):null,Ur=Rn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>xh(e.parent),$root:e=>xh(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Lg(e),$forceUpdate:e=>e.f||(e.f=()=>{mf(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>Tk.bind(e)}),Sd=(e,t)=>e!==en&&!e.__isScriptSetup&&Wt(e,t),Gk={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:a,data:o,props:i,accessCache:l,type:c,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(Sd(a,t))return l[t]=1,a[t];if(o!==en&&Wt(o,t))return l[t]=2,o[t];if(Wt(i,t))return l[t]=3,i[t];if(n!==en&&Wt(n,t))return l[t]=4,n[t];$h&&(l[t]=0)}}const h=Ur[t];let f,m;if(h)return t==="$attrs"&&Yn(e.attrs,"get",""),h(e);if((f=c.__cssModules)&&(f=f[t]))return f;if(n!==en&&Wt(n,t))return l[t]=4,n[t];if(m=d.config.globalProperties,Wt(m,t))return m[t]},set({_:e},t,n){const{data:a,setupState:o,ctx:i}=e;return Sd(o,t)?(o[t]=n,!0):a!==en&&Wt(a,t)?(a[t]=n,!0):Wt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:a,appContext:o,props:i,type:l}},c){let d;return!!(n[c]||e!==en&&c[0]!=="$"&&Wt(e,c)||Sd(t,c)||Wt(i,c)||Wt(a,c)||Wt(Ur,c)||Wt(o.config.globalProperties,c)||(d=l.__cssModules)&&d[c])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Wt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function ap(e){return ut(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let $h=!0;function qk(e){const t=Lg(e),n=e.proxy,a=e.ctx;$h=!1,t.beforeCreate&&sp(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:l,watch:c,provide:d,inject:h,created:f,beforeMount:m,mounted:y,beforeUpdate:k,updated:_,activated:x,deactivated:D,beforeDestroy:M,beforeUnmount:S,destroyed:w,unmounted:I,render:T,renderTracked:B,renderTriggered:E,errorCaptured:N,serverPrefetch:$,expose:z,inheritAttrs:O,components:j,directives:Z,filters:J}=t;if(h&&jk(h,a,null),l)for(const ie in l){const U=l[ie];_t(U)&&(a[ie]=U.bind(n))}if(o){const ie=o.call(n,n);Qt(ie)&&(e.data=al(ie))}if($h=!0,i)for(const ie in i){const U=i[ie],X=_t(U)?U.bind(n,n):_t(U.get)?U.get.bind(n,n):La,ae=!_t(U)&&_t(U.set)?U.set.bind(n):La,he=H({get:X,set:ae});Object.defineProperty(a,ie,{enumerable:!0,configurable:!0,get:()=>he.value,set:$e=>he.value=$e})}if(c)for(const ie in c)Cg(c[ie],a,n,ie);if(d){const ie=_t(d)?d.call(n):d;Reflect.ownKeys(ie).forEach(U=>{Br(U,ie[U])})}f&&sp(f,e,"c");function K(ie,U){ut(U)?U.forEach(X=>ie(X.bind(n))):U&&ie(U.bind(n))}if(K(Bk,m),K(un,y),K(gg,k),K(Nk,_),K(Dk,x),K(Rk,D),K(Hk,N),K(zk,B),K(Uk,E),K(yg,S),K(Ln,I),K(Fk,$),ut(z))if(z.length){const ie=e.exposed||(e.exposed={});z.forEach(U=>{Object.defineProperty(ie,U,{get:()=>n[U],set:X=>n[U]=X,enumerable:!0})})}else e.exposed||(e.exposed={});T&&e.render===La&&(e.render=T),O!=null&&(e.inheritAttrs=O),j&&(e.components=j),Z&&(e.directives=Z),$&&vg(e)}function jk(e,t,n=La){ut(e)&&(e=Th(e));for(const a in e){const o=e[a];let i;Qt(o)?"default"in o?i=xo(o.from||a,o.default,!0):i=xo(o.from||a):i=xo(o),dn(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[a]=i}}function sp(e,t,n){Ta(ut(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,n)}function Cg(e,t,n,a){let o=a.includes(".")?ag(n,a):()=>n[a];if(hn(e)){const i=t[e];_t(i)&&Ye(o,i)}else if(_t(e))Ye(o,e.bind(n));else if(Qt(e))if(ut(e))e.forEach(i=>Cg(i,t,n,a));else{const i=_t(e.handler)?e.handler.bind(n):t[e.handler];_t(i)&&Ye(o,i,e)}}function Lg(e){const t=e.type,{mixins:n,extends:a}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,c=i.get(t);let d;return c?d=c:!o.length&&!n&&!a?d=t:(d={},o.length&&o.forEach(h=>fu(d,h,l,!0)),fu(d,t,l)),Qt(t)&&i.set(t,d),d}function fu(e,t,n,a=!1){const{mixins:o,extends:i}=t;i&&fu(e,i,n,!0),o&&o.forEach(l=>fu(e,l,n,!0));for(const l in t)if(!(a&&l==="expose")){const c=Wk[l]||n&&n[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const Wk={data:ip,props:lp,emits:lp,methods:xr,computed:xr,beforeCreate:uo,created:uo,beforeMount:uo,mounted:uo,beforeUpdate:uo,updated:uo,beforeDestroy:uo,beforeUnmount:uo,destroyed:uo,unmounted:uo,activated:uo,deactivated:uo,errorCaptured:uo,serverPrefetch:uo,components:xr,directives:xr,watch:Kk,provide:ip,inject:Zk};function ip(e,t){return t?e?function(){return Rn(_t(e)?e.call(this,this):e,_t(t)?t.call(this,this):t)}:t:e}function Zk(e,t){return xr(Th(e),Th(t))}function Th(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function uo(e,t){return e?[...new Set([].concat(e,t))]:t}function xr(e,t){return e?Rn(Object.create(null),e,t):t}function lp(e,t){return e?ut(e)&&ut(t)?[...new Set([...e,...t])]:Rn(Object.create(null),ap(e),ap(t??{})):t}function Kk(e,t){if(!e)return t;if(!t)return e;const n=Rn(Object.create(null),e);for(const a in t)n[a]=uo(e[a],t[a]);return n}function Sg(){return{app:null,config:{isNativeTag:Cm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Yk=0;function Jk(e,t){return function(a,o=null){_t(a)||(a=Rn({},a)),o!=null&&!Qt(o)&&(o=null);const i=Sg(),l=new WeakSet,c=[];let d=!1;const h=i.app={_uid:Yk++,_component:a,_props:o,_container:null,_context:i,_instance:null,version:$0,get config(){return i.config},set config(f){},use(f,...m){return l.has(f)||(f&&_t(f.install)?(l.add(f),f.install(h,...m)):_t(f)&&(l.add(f),f(h,...m))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,m){return m?(i.components[f]=m,h):i.components[f]},directive(f,m){return m?(i.directives[f]=m,h):i.directives[f]},mount(f,m,y){if(!d){const k=h._ceVNode||Pe(a,o);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,f,y),d=!0,h._container=f,f.__vue_app__=h,Ku(k.component)}},onUnmount(f){c.push(f)},unmount(){d&&(Ta(c,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,m){return i.provides[f]=m,h},runWithContext(f){const m=Xi;Xi=h;try{return f()}finally{Xi=m}}};return h}}let Xi=null;const Xk=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${na(t)}Modifiers`]||e[`${fi(t)}Modifiers`];function Qk(e,t,...n){if(e.isUnmounted)return;const a=e.vnode.props||en;let o=n;const i=t.startsWith("update:"),l=i&&Xk(a,t.slice(7));l&&(l.trim&&(o=n.map(f=>hn(f)?f.trim():f)),l.number&&(o=n.map(Fu)));let c,d=a[c=kd(t)]||a[c=kd(na(t))];!d&&i&&(d=a[c=kd(fi(t))]),d&&Ta(d,e,6,o);const h=a[c+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,Ta(h,e,6,o)}}const e0=new WeakMap;function Ig(e,t,n=!1){const a=n?e0:t.emitsCache,o=a.get(e);if(o!==void 0)return o;const i=e.emits;let l={},c=!1;if(!_t(e)){const d=h=>{const f=Ig(h,t,!0);f&&(c=!0,Rn(l,f))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!c?(Qt(e)&&a.set(e,null),null):(ut(i)?i.forEach(d=>l[d]=null):Rn(l,i),Qt(e)&&a.set(e,l),l)}function ju(e,t){return!e||!Ru(t)?!1:(t=t.slice(2).replace(/Once$/,""),Wt(e,t[0].toLowerCase()+t.slice(1))||Wt(e,fi(t))||Wt(e,t))}function rp(e){const{type:t,vnode:n,proxy:a,withProxy:o,propsOptions:[i],slots:l,attrs:c,emit:d,render:h,renderCache:f,props:m,data:y,setupState:k,ctx:_,inheritAttrs:x}=e,D=du(e);let M,S;try{if(n.shapeFlag&4){const I=o||a,T=I;M=Va(h.call(T,I,f,m,k,y,_)),S=c}else{const I=t;M=Va(I.length>1?I(m,{attrs:c,slots:l,emit:d}):I(m,null)),S=t.props?c:t0(c)}}catch(I){Hr.length=0,Vu(I,e,1),M=Pe(Jn)}let w=M;if(S&&x!==!1){const I=Object.keys(S),{shapeFlag:T}=w;I.length&&T&7&&(i&&I.some(sf)&&(S=n0(S,i)),w=ci(w,S,!1,!0))}return n.dirs&&(w=ci(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&tc(w,n.transition),M=w,du(D),M}const t0=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ru(n))&&((t||(t={}))[n]=e[n]);return t},n0=(e,t)=>{const n={};for(const a in e)(!sf(a)||!(a.slice(9)in t))&&(n[a]=e[a]);return n};function o0(e,t,n){const{props:a,children:o,component:i}=e,{props:l,children:c,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return a?cp(a,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==a[y]&&!ju(h,y))return!0}}}else return(o||c)&&(!c||!c.$stable)?!0:a===l?!1:a?l?cp(a,l,h):!0:!!l;return!1}function cp(e,t,n){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let o=0;o<a.length;o++){const i=a[o];if(t[i]!==e[i]&&!ju(n,i))return!0}return!1}function a0({vnode:e,parent:t},n){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=n,t=t.parent;else break}}const xg={},$g=()=>Object.create(xg),Tg=e=>Object.getPrototypeOf(e)===xg;function s0(e,t,n,a=!1){const o={},i=$g();e.propsDefaults=Object.create(null),Mg(e,t,o,i);for(const l in e.propsOptions[0])l in o||(o[l]=void 0);n?e.props=a?o:Zm(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function i0(e,t,n,a){const{props:o,attrs:i,vnode:{patchFlag:l}}=e,c=Ft(o),[d]=e.propsOptions;let h=!1;if((a||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(ju(e.emitsOptions,y))continue;const k=t[y];if(d)if(Wt(i,y))k!==i[y]&&(i[y]=k,h=!0);else{const _=na(y);o[_]=Mh(d,c,_,k,e,!1)}else k!==i[y]&&(i[y]=k,h=!0)}}}else{Mg(e,t,o,i)&&(h=!0);let f;for(const m in c)(!t||!Wt(t,m)&&((f=fi(m))===m||!Wt(t,f)))&&(d?n&&(n[m]!==void 0||n[f]!==void 0)&&(o[m]=Mh(d,c,m,void 0,e,!0)):delete o[m]);if(i!==c)for(const m in i)(!t||!Wt(t,m))&&(delete i[m],h=!0)}h&&fs(e.attrs,"set","")}function Mg(e,t,n,a){const[o,i]=e.propsOptions;let l=!1,c;if(t)for(let d in t){if(Dr(d))continue;const h=t[d];let f;o&&Wt(o,f=na(d))?!i||!i.includes(f)?n[f]=h:(c||(c={}))[f]=h:ju(e.emitsOptions,d)||(!(d in a)||h!==a[d])&&(a[d]=h,l=!0)}if(i){const d=Ft(n),h=c||en;for(let f=0;f<i.length;f++){const m=i[f];n[m]=Mh(o,d,m,h[m],e,!Wt(h,m))}}return l}function Mh(e,t,n,a,o,i){const l=e[n];if(l!=null){const c=Wt(l,"default");if(c&&a===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&_t(d)){const{propsDefaults:h}=o;if(n in h)a=h[n];else{const f=dc(o);a=h[n]=d.call(null,t),f()}}else a=d;o.ce&&o.ce._setProp(n,a)}l[0]&&(i&&!c?a=!1:l[1]&&(a===""||a===fi(n))&&(a=!0))}return a}const l0=new WeakMap;function Ag(e,t,n=!1){const a=n?l0:t.propsCache,o=a.get(e);if(o)return o;const i=e.props,l={},c=[];let d=!1;if(!_t(e)){const f=m=>{d=!0;const[y,k]=Ag(m,t,!0);Rn(l,y),k&&c.push(...k)};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Qt(e)&&a.set(e,Kl),Kl;if(ut(i))for(let f=0;f<i.length;f++){const m=na(i[f]);up(m)&&(l[m]=en)}else if(i)for(const f in i){const m=na(f);if(up(m)){const y=i[f],k=l[m]=ut(y)||_t(y)?{type:y}:Rn({},y),_=k.type;let x=!1,D=!0;if(ut(_))for(let M=0;M<_.length;++M){const S=_[M],w=_t(S)&&S.name;if(w==="Boolean"){x=!0;break}else w==="String"&&(D=!1)}else x=_t(_)&&_.name==="Boolean";k[0]=x,k[1]=D,(x||Wt(k,"default"))&&c.push(m)}}const h=[l,c];return Qt(e)&&a.set(e,h),h}function up(e){return e[0]!=="$"&&!Dr(e)}const kf=e=>e==="_"||e==="_ctx"||e==="$stable",bf=e=>ut(e)?e.map(Va):[Va(e)],r0=(e,t,n)=>{if(t._n)return t;const a=Ve((...o)=>bf(t(...o)),n);return a._c=!1,a},Eg=(e,t,n)=>{const a=e._ctx;for(const o in e){if(kf(o))continue;const i=e[o];if(_t(i))t[o]=r0(o,i,a);else if(i!=null){const l=bf(i);t[o]=()=>l}}},Pg=(e,t)=>{const n=bf(t);e.slots.default=()=>n},Dg=(e,t,n)=>{for(const a in t)(n||!kf(a))&&(e[a]=t[a])},c0=(e,t,n)=>{const a=e.slots=$g();if(e.vnode.shapeFlag&32){const o=t._;o?(Dg(a,t,n),n&&xm(a,"_",o,!0)):Eg(t,a)}else t&&Pg(e,t)},u0=(e,t,n)=>{const{vnode:a,slots:o}=e;let i=!0,l=en;if(a.shapeFlag&32){const c=t._;c?n&&c===1?i=!1:Dg(o,t,n):(i=!t.$stable,Eg(t,o)),l=t}else t&&(Pg(e,t),l={default:1});if(i)for(const c in o)!kf(c)&&l[c]==null&&delete o[c]},fo=v0;function d0(e){return h0(e)}function h0(e,t){const n=Uu();n.__VUE__=!0;const{insert:a,remove:o,patchProp:i,createElement:l,createText:c,createComment:d,setText:h,setElementText:f,parentNode:m,nextSibling:y,setScopeId:k=La,insertStaticContent:_}=e,x=(q,Q,ee,_e=null,Be=null,Ue=null,Ae=void 0,ne=null,ge=!!Q.dynamicChildren)=>{if(q===Q)return;q&&!qi(q,Q)&&(_e=V(q),$e(q,Be,Ue,!0),q=null),Q.patchFlag===-2&&(ge=!1,Q.dynamicChildren=null);const{type:Oe,ref:De,shapeFlag:xe}=Q;switch(Oe){case Wu:D(q,Q,ee,_e);break;case Jn:M(q,Q,ee,_e);break;case zr:q==null&&S(Q,ee,_e,Ae);break;case Ie:j(q,Q,ee,_e,Be,Ue,Ae,ne,ge);break;default:xe&1?T(q,Q,ee,_e,Be,Ue,Ae,ne,ge):xe&6?Z(q,Q,ee,_e,Be,Ue,Ae,ne,ge):(xe&64||xe&128)&&Oe.process(q,Q,ee,_e,Be,Ue,Ae,ne,ge,se)}De!=null&&Be?Fr(De,q&&q.ref,Ue,Q||q,!Q):De==null&&q&&q.ref!=null&&Fr(q.ref,null,Ue,q,!0)},D=(q,Q,ee,_e)=>{if(q==null)a(Q.el=c(Q.children),ee,_e);else{const Be=Q.el=q.el;Q.children!==q.children&&h(Be,Q.children)}},M=(q,Q,ee,_e)=>{q==null?a(Q.el=d(Q.children||""),ee,_e):Q.el=q.el},S=(q,Q,ee,_e)=>{[q.el,q.anchor]=_(q.children,Q,ee,_e,q.el,q.anchor)},w=({el:q,anchor:Q},ee,_e)=>{let Be;for(;q&&q!==Q;)Be=y(q),a(q,ee,_e),q=Be;a(Q,ee,_e)},I=({el:q,anchor:Q})=>{let ee;for(;q&&q!==Q;)ee=y(q),o(q),q=ee;o(Q)},T=(q,Q,ee,_e,Be,Ue,Ae,ne,ge)=>{if(Q.type==="svg"?Ae="svg":Q.type==="math"&&(Ae="mathml"),q==null)B(Q,ee,_e,Be,Ue,Ae,ne,ge);else{const Oe=q.el&&q.el._isVueCE?q.el:null;try{Oe&&Oe._beginPatch(),$(q,Q,Be,Ue,Ae,ne,ge)}finally{Oe&&Oe._endPatch()}}},B=(q,Q,ee,_e,Be,Ue,Ae,ne)=>{let ge,Oe;const{props:De,shapeFlag:xe,transition:me,dirs:Ze}=q;if(ge=q.el=l(q.type,Ue,De&&De.is,De),xe&8?f(ge,q.children):xe&16&&N(q.children,ge,null,_e,Be,Id(q,Ue),Ae,ne),Ze&&Oi(q,null,_e,"created"),E(ge,q,q.scopeId,Ae,_e),De){for(const fe in De)fe!=="value"&&!Dr(fe)&&i(ge,fe,null,De[fe],Ue,_e);"value"in De&&i(ge,"value",null,De.value,Ue),(Oe=De.onVnodeBeforeMount)&&Na(Oe,_e,q)}Ze&&Oi(q,null,_e,"beforeMount");const Ge=f0(Be,me);Ge&&me.beforeEnter(ge),a(ge,Q,ee),((Oe=De&&De.onVnodeMounted)||Ge||Ze)&&fo(()=>{Oe&&Na(Oe,_e,q),Ge&&me.enter(ge),Ze&&Oi(q,null,_e,"mounted")},Be)},E=(q,Q,ee,_e,Be)=>{if(ee&&k(q,ee),_e)for(let Ue=0;Ue<_e.length;Ue++)k(q,_e[Ue]);if(Be){let Ue=Be.subTree;if(Q===Ue||Bg(Ue.type)&&(Ue.ssContent===Q||Ue.ssFallback===Q)){const Ae=Be.vnode;E(q,Ae,Ae.scopeId,Ae.slotScopeIds,Be.parent)}}},N=(q,Q,ee,_e,Be,Ue,Ae,ne,ge=0)=>{for(let Oe=ge;Oe<q.length;Oe++){const De=q[Oe]=ne?Xs(q[Oe]):Va(q[Oe]);x(null,De,Q,ee,_e,Be,Ue,Ae,ne)}},$=(q,Q,ee,_e,Be,Ue,Ae)=>{const ne=Q.el=q.el;let{patchFlag:ge,dynamicChildren:Oe,dirs:De}=Q;ge|=q.patchFlag&16;const xe=q.props||en,me=Q.props||en;let Ze;if(ee&&Bi(ee,!1),(Ze=me.onVnodeBeforeUpdate)&&Na(Ze,ee,Q,q),De&&Oi(Q,q,ee,"beforeUpdate"),ee&&Bi(ee,!0),(xe.innerHTML&&me.innerHTML==null||xe.textContent&&me.textContent==null)&&f(ne,""),Oe?z(q.dynamicChildren,Oe,ne,ee,_e,Id(Q,Be),Ue):Ae||U(q,Q,ne,null,ee,_e,Id(Q,Be),Ue,!1),ge>0){if(ge&16)O(ne,xe,me,ee,Be);else if(ge&2&&xe.class!==me.class&&i(ne,"class",null,me.class,Be),ge&4&&i(ne,"style",xe.style,me.style,Be),ge&8){const Ge=Q.dynamicProps;for(let fe=0;fe<Ge.length;fe++){const ke=Ge[fe],te=xe[ke],ye=me[ke];(ye!==te||ke==="value")&&i(ne,ke,te,ye,Be,ee)}}ge&1&&q.children!==Q.children&&f(ne,Q.children)}else!Ae&&Oe==null&&O(ne,xe,me,ee,Be);((Ze=me.onVnodeUpdated)||De)&&fo(()=>{Ze&&Na(Ze,ee,Q,q),De&&Oi(Q,q,ee,"updated")},_e)},z=(q,Q,ee,_e,Be,Ue,Ae)=>{for(let ne=0;ne<Q.length;ne++){const ge=q[ne],Oe=Q[ne],De=ge.el&&(ge.type===Ie||!qi(ge,Oe)||ge.shapeFlag&198)?m(ge.el):ee;x(ge,Oe,De,null,_e,Be,Ue,Ae,!0)}},O=(q,Q,ee,_e,Be)=>{if(Q!==ee){if(Q!==en)for(const Ue in Q)!Dr(Ue)&&!(Ue in ee)&&i(q,Ue,Q[Ue],null,Be,_e);for(const Ue in ee){if(Dr(Ue))continue;const Ae=ee[Ue],ne=Q[Ue];Ae!==ne&&Ue!=="value"&&i(q,Ue,ne,Ae,Be,_e)}"value"in ee&&i(q,"value",Q.value,ee.value,Be)}},j=(q,Q,ee,_e,Be,Ue,Ae,ne,ge)=>{const Oe=Q.el=q?q.el:c(""),De=Q.anchor=q?q.anchor:c("");let{patchFlag:xe,dynamicChildren:me,slotScopeIds:Ze}=Q;Ze&&(ne=ne?ne.concat(Ze):Ze),q==null?(a(Oe,ee,_e),a(De,ee,_e),N(Q.children||[],ee,De,Be,Ue,Ae,ne,ge)):xe>0&&xe&64&&me&&q.dynamicChildren&&q.dynamicChildren.length===me.length?(z(q.dynamicChildren,me,ee,Be,Ue,Ae,ne),(Q.key!=null||Be&&Q===Be.subTree)&&wf(q,Q,!0)):U(q,Q,ee,De,Be,Ue,Ae,ne,ge)},Z=(q,Q,ee,_e,Be,Ue,Ae,ne,ge)=>{Q.slotScopeIds=ne,q==null?Q.shapeFlag&512?Be.ctx.activate(Q,ee,_e,Ae,ge):J(Q,ee,_e,Be,Ue,Ae,ge):re(q,Q,ge)},J=(q,Q,ee,_e,Be,Ue,Ae)=>{const ne=q.component=w0(q,_e,Be);if(Gu(q)&&(ne.ctx.renderer=se),_0(ne,!1,Ae),ne.asyncDep){if(Be&&Be.registerDep(ne,K,Ae),!q.el){const ge=ne.subTree=Pe(Jn);M(null,ge,Q,ee),q.placeholder=ge.el}}else K(ne,q,Q,ee,Be,Ue,Ae)},re=(q,Q,ee)=>{const _e=Q.component=q.component;if(o0(q,Q,ee))if(_e.asyncDep&&!_e.asyncResolved){ie(_e,Q,ee);return}else _e.next=Q,_e.update();else Q.el=q.el,_e.vnode=Q},K=(q,Q,ee,_e,Be,Ue,Ae)=>{const ne=()=>{if(q.isMounted){let{next:xe,bu:me,u:Ze,parent:Ge,vnode:fe}=q;{const rt=Rg(q);if(rt){xe&&(xe.el=fe.el,ie(q,xe,Ae)),rt.asyncDep.then(()=>{q.isUnmounted||ne()});return}}let ke=xe,te;Bi(q,!1),xe?(xe.el=fe.el,ie(q,xe,Ae)):xe=fe,me&&Wc(me),(te=xe.props&&xe.props.onVnodeBeforeUpdate)&&Na(te,Ge,xe,fe),Bi(q,!0);const ye=rp(q),He=q.subTree;q.subTree=ye,x(He,ye,m(He.el),V(He),q,Be,Ue),xe.el=ye.el,ke===null&&a0(q,ye.el),Ze&&fo(Ze,Be),(te=xe.props&&xe.props.onVnodeUpdated)&&fo(()=>Na(te,Ge,xe,fe),Be)}else{let xe;const{el:me,props:Ze}=Q,{bm:Ge,m:fe,parent:ke,root:te,type:ye}=q,He=Xl(Q);Bi(q,!1),Ge&&Wc(Ge),!He&&(xe=Ze&&Ze.onVnodeBeforeMount)&&Na(xe,ke,Q),Bi(q,!0);{te.ce&&te.ce._def.shadowRoot!==!1&&te.ce._injectChildStyle(ye);const rt=q.subTree=rp(q);x(null,rt,ee,_e,q,Be,Ue),Q.el=rt.el}if(fe&&fo(fe,Be),!He&&(xe=Ze&&Ze.onVnodeMounted)){const rt=Q;fo(()=>Na(xe,ke,rt),Be)}(Q.shapeFlag&256||ke&&Xl(ke.vnode)&&ke.vnode.shapeFlag&256)&&q.a&&fo(q.a,Be),q.isMounted=!0,Q=ee=_e=null}};q.scope.on();const ge=q.effect=new Dm(ne);q.scope.off();const Oe=q.update=ge.run.bind(ge),De=q.job=ge.runIfDirty.bind(ge);De.i=q,De.id=q.uid,ge.scheduler=()=>mf(De),Bi(q,!0),Oe()},ie=(q,Q,ee)=>{Q.component=q;const _e=q.vnode.props;q.vnode=Q,q.next=null,i0(q,Q.props,_e,ee),u0(q,Q.children,ee),_s(),Jf(q),Cs()},U=(q,Q,ee,_e,Be,Ue,Ae,ne,ge=!1)=>{const Oe=q&&q.children,De=q?q.shapeFlag:0,xe=Q.children,{patchFlag:me,shapeFlag:Ze}=Q;if(me>0){if(me&128){ae(Oe,xe,ee,_e,Be,Ue,Ae,ne,ge);return}else if(me&256){X(Oe,xe,ee,_e,Be,Ue,Ae,ne,ge);return}}Ze&8?(De&16&&be(Oe,Be,Ue),xe!==Oe&&f(ee,xe)):De&16?Ze&16?ae(Oe,xe,ee,_e,Be,Ue,Ae,ne,ge):be(Oe,Be,Ue,!0):(De&8&&f(ee,""),Ze&16&&N(xe,ee,_e,Be,Ue,Ae,ne,ge))},X=(q,Q,ee,_e,Be,Ue,Ae,ne,ge)=>{q=q||Kl,Q=Q||Kl;const Oe=q.length,De=Q.length,xe=Math.min(Oe,De);let me;for(me=0;me<xe;me++){const Ze=Q[me]=ge?Xs(Q[me]):Va(Q[me]);x(q[me],Ze,ee,null,Be,Ue,Ae,ne,ge)}Oe>De?be(q,Be,Ue,!0,!1,xe):N(Q,ee,_e,Be,Ue,Ae,ne,ge,xe)},ae=(q,Q,ee,_e,Be,Ue,Ae,ne,ge)=>{let Oe=0;const De=Q.length;let xe=q.length-1,me=De-1;for(;Oe<=xe&&Oe<=me;){const Ze=q[Oe],Ge=Q[Oe]=ge?Xs(Q[Oe]):Va(Q[Oe]);if(qi(Ze,Ge))x(Ze,Ge,ee,null,Be,Ue,Ae,ne,ge);else break;Oe++}for(;Oe<=xe&&Oe<=me;){const Ze=q[xe],Ge=Q[me]=ge?Xs(Q[me]):Va(Q[me]);if(qi(Ze,Ge))x(Ze,Ge,ee,null,Be,Ue,Ae,ne,ge);else break;xe--,me--}if(Oe>xe){if(Oe<=me){const Ze=me+1,Ge=Ze<De?Q[Ze].el:_e;for(;Oe<=me;)x(null,Q[Oe]=ge?Xs(Q[Oe]):Va(Q[Oe]),ee,Ge,Be,Ue,Ae,ne,ge),Oe++}}else if(Oe>me)for(;Oe<=xe;)$e(q[Oe],Be,Ue,!0),Oe++;else{const Ze=Oe,Ge=Oe,fe=new Map;for(Oe=Ge;Oe<=me;Oe++){const Lt=Q[Oe]=ge?Xs(Q[Oe]):Va(Q[Oe]);Lt.key!=null&&fe.set(Lt.key,Oe)}let ke,te=0;const ye=me-Ge+1;let He=!1,rt=0;const kt=new Array(ye);for(Oe=0;Oe<ye;Oe++)kt[Oe]=0;for(Oe=Ze;Oe<=xe;Oe++){const Lt=q[Oe];if(te>=ye){$e(Lt,Be,Ue,!0);continue}let xt;if(Lt.key!=null)xt=fe.get(Lt.key);else for(ke=Ge;ke<=me;ke++)if(kt[ke-Ge]===0&&qi(Lt,Q[ke])){xt=ke;break}xt===void 0?$e(Lt,Be,Ue,!0):(kt[xt-Ge]=Oe+1,xt>=rt?rt=xt:He=!0,x(Lt,Q[xt],ee,null,Be,Ue,Ae,ne,ge),te++)}const Rt=He?p0(kt):Kl;for(ke=Rt.length-1,Oe=ye-1;Oe>=0;Oe--){const Lt=Ge+Oe,xt=Q[Lt],Kt=Q[Lt+1],no=Lt+1<De?Kt.el||Og(Kt):_e;kt[Oe]===0?x(null,xt,ee,no,Be,Ue,Ae,ne,ge):He&&(ke<0||Oe!==Rt[ke]?he(xt,ee,no,2):ke--)}}},he=(q,Q,ee,_e,Be=null)=>{const{el:Ue,type:Ae,transition:ne,children:ge,shapeFlag:Oe}=q;if(Oe&6){he(q.component.subTree,Q,ee,_e);return}if(Oe&128){q.suspense.move(Q,ee,_e);return}if(Oe&64){Ae.move(q,Q,ee,se);return}if(Ae===Ie){a(Ue,Q,ee);for(let xe=0;xe<ge.length;xe++)he(ge[xe],Q,ee,_e);a(q.anchor,Q,ee);return}if(Ae===zr){w(q,Q,ee);return}if(_e!==2&&Oe&1&&ne)if(_e===0)ne.beforeEnter(Ue),a(Ue,Q,ee),fo(()=>ne.enter(Ue),Be);else{const{leave:xe,delayLeave:me,afterLeave:Ze}=ne,Ge=()=>{q.ctx.isUnmounted?o(Ue):a(Ue,Q,ee)},fe=()=>{Ue._isLeaving&&Ue[hs](!0),xe(Ue,()=>{Ge(),Ze&&Ze()})};me?me(Ue,Ge,fe):fe()}else a(Ue,Q,ee)},$e=(q,Q,ee,_e=!1,Be=!1)=>{const{type:Ue,props:Ae,ref:ne,children:ge,dynamicChildren:Oe,shapeFlag:De,patchFlag:xe,dirs:me,cacheIndex:Ze}=q;if(xe===-2&&(Be=!1),ne!=null&&(_s(),Fr(ne,null,ee,q,!0),Cs()),Ze!=null&&(Q.renderCache[Ze]=void 0),De&256){Q.ctx.deactivate(q);return}const Ge=De&1&&me,fe=!Xl(q);let ke;if(fe&&(ke=Ae&&Ae.onVnodeBeforeUnmount)&&Na(ke,Q,q),De&6)ze(q.component,ee,_e);else{if(De&128){q.suspense.unmount(ee,_e);return}Ge&&Oi(q,null,Q,"beforeUnmount"),De&64?q.type.remove(q,Q,ee,se,_e):Oe&&!Oe.hasOnce&&(Ue!==Ie||xe>0&&xe&64)?be(Oe,Q,ee,!1,!0):(Ue===Ie&&xe&384||!Be&&De&16)&&be(ge,Q,ee),_e&&Ee(q)}(fe&&(ke=Ae&&Ae.onVnodeUnmounted)||Ge)&&fo(()=>{ke&&Na(ke,Q,q),Ge&&Oi(q,null,Q,"unmounted")},ee)},Ee=q=>{const{type:Q,el:ee,anchor:_e,transition:Be}=q;if(Q===Ie){Me(ee,_e);return}if(Q===zr){I(q);return}const Ue=()=>{o(ee),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(q.shapeFlag&1&&Be&&!Be.persisted){const{leave:Ae,delayLeave:ne}=Be,ge=()=>Ae(ee,Ue);ne?ne(q.el,Ue,ge):ge()}else Ue()},Me=(q,Q)=>{let ee;for(;q!==Q;)ee=y(q),o(q),q=ee;o(Q)},ze=(q,Q,ee)=>{const{bum:_e,scope:Be,job:Ue,subTree:Ae,um:ne,m:ge,a:Oe}=q;dp(ge),dp(Oe),_e&&Wc(_e),Be.stop(),Ue&&(Ue.flags|=8,$e(Ae,q,Q,ee)),ne&&fo(ne,Q),fo(()=>{q.isUnmounted=!0},Q)},be=(q,Q,ee,_e=!1,Be=!1,Ue=0)=>{for(let Ae=Ue;Ae<q.length;Ae++)$e(q[Ae],Q,ee,_e,Be)},V=q=>{if(q.shapeFlag&6)return V(q.component.subTree);if(q.shapeFlag&128)return q.suspense.next();const Q=y(q.anchor||q.el),ee=Q&&Q[sg];return ee?y(ee):Q};let Y=!1;const de=(q,Q,ee)=>{let _e;q==null?Q._vnode&&($e(Q._vnode,null,null,!0),_e=Q._vnode.component):x(Q._vnode||null,q,Q,null,null,null,ee),Q._vnode=q,Y||(Y=!0,Jf(_e),eg(),Y=!1)},se={p:x,um:$e,m:he,r:Ee,mt:J,mc:N,pc:U,pbc:z,n:V,o:e};return{render:de,hydrate:void 0,createApp:Jk(de)}}function Id({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Bi({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function f0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function wf(e,t,n=!1){const a=e.children,o=t.children;if(ut(a)&&ut(o))for(let i=0;i<a.length;i++){const l=a[i];let c=o[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=o[i]=Xs(o[i]),c.el=l.el),!n&&c.patchFlag!==-2&&wf(l,c)),c.type===Wu&&(c.patchFlag!==-1?c.el=l.el:c.__elIndex=i+(e.type===Ie?1:0)),c.type===Jn&&!c.el&&(c.el=l.el)}}function p0(e){const t=e.slice(),n=[0];let a,o,i,l,c;const d=e.length;for(a=0;a<d;a++){const h=e[a];if(h!==0){if(o=n[n.length-1],e[o]<h){t[a]=o,n.push(a);continue}for(i=0,l=n.length-1;i<l;)c=i+l>>1,e[n[c]]<h?i=c+1:l=c;h<e[n[i]]&&(i>0&&(t[a]=n[i-1]),n[i]=a)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}function Rg(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Rg(t)}function dp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Og(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Og(t.subTree):null}const Bg=e=>e.__isSuspense;function v0(e,t){t&&t.pendingBranch?ut(e)?t.effects.push(...e):t.effects.push(e):Qm(e)}const Ie=Symbol.for("v-fgt"),Wu=Symbol.for("v-txt"),Jn=Symbol.for("v-cmt"),zr=Symbol.for("v-stc"),Hr=[];let No=null;function p(e=!1){Hr.push(No=e?null:[])}function m0(){Hr.pop(),No=Hr[Hr.length-1]||null}let nc=1;function pu(e,t=!1){nc+=e,e<0&&No&&t&&(No.hasOnce=!0)}function Ng(e){return e.dynamicChildren=nc>0?No||Kl:null,m0(),nc>0&&No&&No.push(e),e}function g(e,t,n,a,o,i){return Ng(r(e,t,n,a,o,i,!0))}function qe(e,t,n,a,o){return Ng(Pe(e,t,n,a,o,!0))}function oc(e){return e?e.__v_isVNode===!0:!1}function qi(e,t){return e.type===t.type&&e.key===t.key}const Fg=({key:e})=>e??null,Kc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?hn(e)||dn(e)||_t(e)?{i:Hn,r:e,k:t,f:!!n}:e:null);function r(e,t=null,n=null,a=0,o=null,i=e===Ie?0:1,l=!1,c=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Fg(t),ref:t&&Kc(t),scopeId:ng,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Hn};return c?(_f(d,n),i&128&&e.normalize(d)):n&&(d.shapeFlag|=hn(n)?8:16),nc>0&&!l&&No&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&No.push(d),d}const Pe=g0;function g0(e,t=null,n=null,a=0,o=null,i=!1){if((!e||e===bg)&&(e=Jn),oc(e)){const c=ci(e,t,!0);return n&&_f(c,n),nc>0&&!i&&No&&(c.shapeFlag&6?No[No.indexOf(e)]=c:No.push(c)),c.patchFlag=-2,c}if(x0(e)&&(e=e.__vccOpts),t){t=y0(t);let{class:c,style:d}=t;c&&!hn(c)&&(t.class=le(c)),Qt(d)&&(Hu(d)&&!ut(d)&&(d=Rn({},d)),t.style=tt(d))}const l=hn(e)?1:Bg(e)?128:ig(e)?64:Qt(e)?4:_t(e)?2:0;return r(e,t,n,a,o,l,i,!0)}function y0(e){return e?Hu(e)||Tg(e)?Rn({},e):e:null}function ci(e,t,n=!1,a=!1){const{props:o,ref:i,patchFlag:l,children:c,transition:d}=e,h=t?Ug(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Fg(h),ref:t&&t.ref?n&&i?ut(i)?i.concat(Kc(t)):[i,Kc(t)]:Kc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ie?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ci(e.ssContent),ssFallback:e.ssFallback&&ci(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&tc(f,d.clone(f)),f}function Je(e=" ",t=0){return Pe(Wu,null,e,t)}function ui(e,t){const n=Pe(zr,null,e);return n.staticCount=t,n}function P(e="",t=!1){return t?(p(),qe(Jn,null,e)):Pe(Jn,null,e)}function Va(e){return e==null||typeof e=="boolean"?Pe(Jn):ut(e)?Pe(Ie,null,e.slice()):oc(e)?Xs(e):Pe(Wu,null,String(e))}function Xs(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ci(e)}function _f(e,t){let n=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(ut(t))n=16;else if(typeof t=="object")if(a&65){const o=t.default;o&&(o._c&&(o._d=!1),_f(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!Tg(t)?t._ctx=Hn:o===3&&Hn&&(Hn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else _t(t)?(t={default:t,_ctx:Hn},n=32):(t=String(t),a&64?(n=16,t=[Je(t)]):n=8);e.children=t,e.shapeFlag|=n}function Ug(...e){const t={};for(let n=0;n<e.length;n++){const a=e[n];for(const o in a)if(o==="class")t.class!==a.class&&(t.class=le([t.class,a.class]));else if(o==="style")t.style=tt([t.style,a.style]);else if(Ru(o)){const i=t[o],l=a[o];l&&i!==l&&!(ut(i)&&i.includes(l))&&(t[o]=i?[].concat(i,l):l)}else o!==""&&(t[o]=a[o])}return t}function Na(e,t,n,a=null){Ta(e,t,7,[n,a])}const k0=Sg();let b0=0;function w0(e,t,n){const a=e.type,o=(t?t.appContext:e.appContext)||k0,i={uid:b0++,vnode:e,type:a,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Am(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ag(a,o),emitsOptions:Ig(a,o),emit:null,emitted:null,propsDefaults:en,inheritAttrs:a.inheritAttrs,ctx:en,data:en,props:en,attrs:en,slots:en,refs:en,setupState:en,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Qk.bind(null,i),e.ce&&e.ce(i),i}let Xn=null;const Zu=()=>Xn||Hn;let vu,Ah;{const e=Uu(),t=(n,a)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(a),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};vu=t("__VUE_INSTANCE_SETTERS__",n=>Xn=n),Ah=t("__VUE_SSR_SETTERS__",n=>ac=n)}const dc=e=>{const t=Xn;return vu(e),e.scope.on(),()=>{e.scope.off(),vu(t)}},hp=()=>{Xn&&Xn.scope.off(),vu(null)};function zg(e){return e.vnode.shapeFlag&4}let ac=!1;function _0(e,t=!1,n=!1){t&&Ah(t);const{props:a,children:o}=e.vnode,i=zg(e);s0(e,a,i,t),c0(e,o,n||t);const l=i?C0(e,t):void 0;return t&&Ah(!1),l}function C0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Gk);const{setup:a}=n;if(a){_s();const o=e.setupContext=a.length>1?S0(e):null,i=dc(e),l=uc(a,e,0,[e.props,o]),c=Lm(l);if(Cs(),i(),(c||e.sp)&&!Xl(e)&&vg(e),c){if(l.then(hp,hp),t)return l.then(d=>{fp(e,d)}).catch(d=>{Vu(d,e,0)});e.asyncDep=l}else fp(e,l)}else Hg(e)}function fp(e,t,n){_t(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qt(t)&&(e.setupState=Ym(t)),Hg(e)}function Hg(e,t,n){const a=e.type;e.render||(e.render=a.render||La);{const o=dc(e);_s();try{qk(e)}finally{Cs(),o()}}}const L0={get(e,t){return Yn(e,"get",""),e[t]}};function S0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,L0),slots:e.slots,emit:e.emit,expose:t}}function Ku(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Ym(vf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ur)return Ur[n](e)},has(t,n){return n in t||n in Ur}})):e.proxy}function I0(e,t=!0){return _t(e)?e.displayName||e.name:e.name||t&&e.__name}function x0(e){return _t(e)&&"__vccOpts"in e}const H=(e,t)=>wk(e,t,ac);function Cf(e,t,n){try{pu(-1);const a=arguments.length;return a===2?Qt(t)&&!ut(t)?oc(t)?Pe(e,null,[t]):Pe(e,t):Pe(e,null,t):(a>3?n=Array.prototype.slice.call(arguments,2):a===3&&oc(n)&&(n=[n]),Pe(e,t,n))}finally{pu(1)}}const $0="3.5.26";let Eh;const pp=typeof window<"u"&&window.trustedTypes;if(pp)try{Eh=pp.createPolicy("vue",{createHTML:e=>e})}catch{}const Vg=Eh?e=>Eh.createHTML(e):e=>e,T0="http://www.w3.org/2000/svg",M0="http://www.w3.org/1998/Math/MathML",ds=typeof document<"u"?document:null,vp=ds&&ds.createElement("template"),A0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,a)=>{const o=t==="svg"?ds.createElementNS(T0,e):t==="mathml"?ds.createElementNS(M0,e):n?ds.createElement(e,{is:n}):ds.createElement(e);return e==="select"&&a&&a.multiple!=null&&o.setAttribute("multiple",a.multiple),o},createText:e=>ds.createTextNode(e),createComment:e=>ds.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ds.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,a,o,i){const l=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{vp.innerHTML=Vg(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const c=vp.content;if(a==="svg"||a==="mathml"){const d=c.firstChild;for(;d.firstChild;)c.appendChild(d.firstChild);c.removeChild(d)}t.insertBefore(c,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},qs="transition",_r="animation",sc=Symbol("_vtc"),Gg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},E0=Rn({},cg,Gg),P0=e=>(e.displayName="Transition",e.props=E0,e),Ia=P0((e,{slots:t})=>Cf(Pk,D0(e),t)),Ni=(e,t=[])=>{ut(e)?e.forEach(n=>n(...t)):e&&e(...t)},mp=e=>e?ut(e)?e.some(t=>t.length>1):e.length>1:!1;function D0(e){const t={};for(const j in e)j in Gg||(t[j]=e[j]);if(e.css===!1)return t;const{name:n="v",type:a,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=c,leaveFromClass:m=`${n}-leave-from`,leaveActiveClass:y=`${n}-leave-active`,leaveToClass:k=`${n}-leave-to`}=e,_=R0(o),x=_&&_[0],D=_&&_[1],{onBeforeEnter:M,onEnter:S,onEnterCancelled:w,onLeave:I,onLeaveCancelled:T,onBeforeAppear:B=M,onAppear:E=S,onAppearCancelled:N=w}=t,$=(j,Z,J,re)=>{j._enterCancelled=re,Fi(j,Z?f:c),Fi(j,Z?h:l),J&&J()},z=(j,Z)=>{j._isLeaving=!1,Fi(j,m),Fi(j,k),Fi(j,y),Z&&Z()},O=j=>(Z,J)=>{const re=j?E:S,K=()=>$(Z,j,J);Ni(re,[Z,K]),gp(()=>{Fi(Z,j?d:i),rs(Z,j?f:c),mp(re)||yp(Z,a,x,K)})};return Rn(t,{onBeforeEnter(j){Ni(M,[j]),rs(j,i),rs(j,l)},onBeforeAppear(j){Ni(B,[j]),rs(j,d),rs(j,h)},onEnter:O(!1),onAppear:O(!0),onLeave(j,Z){j._isLeaving=!0;const J=()=>z(j,Z);rs(j,m),j._enterCancelled?(rs(j,y),wp(j)):(wp(j),rs(j,y)),gp(()=>{j._isLeaving&&(Fi(j,m),rs(j,k),mp(I)||yp(j,a,D,J))}),Ni(I,[j,J])},onEnterCancelled(j){$(j,!1,void 0,!0),Ni(w,[j])},onAppearCancelled(j){$(j,!0,void 0,!0),Ni(N,[j])},onLeaveCancelled(j){z(j),Ni(T,[j])}})}function R0(e){if(e==null)return null;if(Qt(e))return[xd(e.enter),xd(e.leave)];{const t=xd(e);return[t,t]}}function xd(e){return F1(e)}function rs(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[sc]||(e[sc]=new Set)).add(t)}function Fi(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const n=e[sc];n&&(n.delete(t),n.size||(e[sc]=void 0))}function gp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let O0=0;function yp(e,t,n,a){const o=e._endId=++O0,i=()=>{o===e._endId&&a()};if(n!=null)return setTimeout(i,n);const{type:l,timeout:c,propCount:d}=B0(e,t);if(!l)return a();const h=l+"end";let f=0;const m=()=>{e.removeEventListener(h,y),i()},y=k=>{k.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},c+1),e.addEventListener(h,y)}function B0(e,t){const n=window.getComputedStyle(e),a=_=>(n[_]||"").split(", "),o=a(`${qs}Delay`),i=a(`${qs}Duration`),l=kp(o,i),c=a(`${_r}Delay`),d=a(`${_r}Duration`),h=kp(c,d);let f=null,m=0,y=0;t===qs?l>0&&(f=qs,m=l,y=i.length):t===_r?h>0&&(f=_r,m=h,y=d.length):(m=Math.max(l,h),f=m>0?l>h?qs:_r:null,y=f?f===qs?i.length:d.length:0);const k=f===qs&&/\b(?:transform|all)(?:,|$)/.test(a(`${qs}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:k}}function kp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,a)=>bp(n)+bp(e[a])))}function bp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function wp(e){return(e?e.ownerDocument:document).body.offsetHeight}function N0(e,t,n){const a=e[sc];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const mu=Symbol("_vod"),qg=Symbol("_vsh"),oa={name:"show",beforeMount(e,{value:t},{transition:n}){e[mu]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Cr(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:a}){!t!=!n&&(a?t?(a.beforeEnter(e),Cr(e,!0),a.enter(e)):a.leave(e,()=>{Cr(e,!1)}):Cr(e,t))},beforeUnmount(e,{value:t}){Cr(e,t)}};function Cr(e,t){e.style.display=t?e[mu]:"none",e[qg]=!t}const jg=Symbol("");function F0(e){const t=Zu();if(!t)return;const n=t.ut=(o=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>gu(i,o))},a=()=>{const o=e(t.proxy);t.ce?gu(t.ce,o):Ph(t.subTree,o),n(o)};gg(()=>{Qm(a)}),un(()=>{Ye(a,La,{flush:"post"});const o=new MutationObserver(a);o.observe(t.subTree.el.parentNode,{childList:!0}),Ln(()=>o.disconnect())})}function Ph(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Ph(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)gu(e.el,t);else if(e.type===Ie)e.children.forEach(n=>Ph(n,t));else if(e.type===zr){let{el:n,anchor:a}=e;for(;n&&(gu(n,t),n!==a);)n=n.nextSibling}}function gu(e,t){if(e.nodeType===1){const n=e.style;let a="";for(const o in t){const i=W1(t[o]);n.setProperty(`--${o}`,i),a+=`--${o}: ${i};`}n[jg]=a}}const U0=/(?:^|;)\s*display\s*:/;function z0(e,t,n){const a=e.style,o=hn(n);let i=!1;if(n&&!o){if(t)if(hn(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();n[c]==null&&Yc(a,c,"")}else for(const l in t)n[l]==null&&Yc(a,l,"");for(const l in n)l==="display"&&(i=!0),Yc(a,l,n[l])}else if(o){if(t!==n){const l=a[jg];l&&(n+=";"+l),a.cssText=n,i=U0.test(n)}}else t&&e.removeAttribute("style");mu in e&&(e[mu]=i?a.display:"",e[qg]&&(a.display="none"))}const _p=/\s*!important$/;function Yc(e,t,n){if(ut(n))n.forEach(a=>Yc(e,t,a));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const a=H0(e,t);_p.test(n)?e.setProperty(fi(a),n.replace(_p,""),"important"):e[a]=n}}const Cp=["Webkit","Moz","ms"],$d={};function H0(e,t){const n=$d[t];if(n)return n;let a=na(t);if(a!=="filter"&&a in e)return $d[t]=a;a=Nu(a);for(let o=0;o<Cp.length;o++){const i=Cp[o]+a;if(i in e)return $d[t]=i}return t}const Lp="http://www.w3.org/1999/xlink";function Sp(e,t,n,a,o,i=q1(t)){a&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Lp,t.slice(6,t.length)):e.setAttributeNS(Lp,t,n):n==null||i&&!$m(n)?e.removeAttribute(t):e.setAttribute(t,i?"":xa(n)?String(n):n)}function Ip(e,t,n,a,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Vg(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(c!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=$m(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(o||t)}function vs(e,t,n,a){e.addEventListener(t,n,a)}function V0(e,t,n,a){e.removeEventListener(t,n,a)}const xp=Symbol("_vei");function G0(e,t,n,a,o=null){const i=e[xp]||(e[xp]={}),l=i[t];if(a&&l)l.value=a;else{const[c,d]=q0(t);if(a){const h=i[t]=Z0(a,o);vs(e,c,h,d)}else l&&(V0(e,c,l,d),i[t]=void 0)}}const $p=/(?:Once|Passive|Capture)$/;function q0(e){let t;if($p.test(e)){t={};let a;for(;a=e.match($p);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):fi(e.slice(2)),t]}let Td=0;const j0=Promise.resolve(),W0=()=>Td||(j0.then(()=>Td=0),Td=Date.now());function Z0(e,t){const n=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=n.attached)return;Ta(K0(a,n.value),t,5,[a])};return n.value=e,n.attached=W0(),n}function K0(e,t){if(ut(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(a=>o=>!o._stopped&&a&&a(o))}else return t}const Tp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Y0=(e,t,n,a,o,i)=>{const l=o==="svg";t==="class"?N0(e,a,l):t==="style"?z0(e,n,a):Ru(t)?sf(t)||G0(e,t,n,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):J0(e,t,a,l))?(Ip(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Sp(e,t,a,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!hn(a))?Ip(e,na(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),Sp(e,t,a,l))};function J0(e,t,n,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&Tp(t)&&_t(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Tp(t)&&hn(n)?!1:t in e}const di=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ut(t)?n=>Wc(t,n):t};function X0(e){e.target.composing=!0}function Mp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ta=Symbol("_assign");function Ap(e,t,n){return t&&(e=e.trim()),n&&(e=Fu(e)),e}const at={created(e,{modifiers:{lazy:t,trim:n,number:a}},o){e[ta]=di(o);const i=a||o.props&&o.props.type==="number";vs(e,t?"change":"input",l=>{l.target.composing||e[ta](Ap(e.value,n,i))}),(n||i)&&vs(e,"change",()=>{e.value=Ap(e.value,n,i)}),t||(vs(e,"compositionstart",X0),vs(e,"compositionend",Mp),vs(e,"change",Mp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:a,trim:o,number:i}},l){if(e[ta]=di(l),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Fu(e.value):e.value,d=t??"";c!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===n||o&&e.value.trim()===d)||(e.value=d))}},Ma={deep:!0,created(e,t,n){e[ta]=di(n),vs(e,"change",()=>{const a=e._modelValue,o=nr(e),i=e.checked,l=e[ta];if(ut(a)){const c=rf(a,o),d=c!==-1;if(i&&!d)l(a.concat(o));else if(!i&&d){const h=[...a];h.splice(c,1),l(h)}}else if(lr(a)){const c=new Set(a);i?c.add(o):c.delete(o),l(c)}else l(Wg(e,i))})},mounted:Ep,beforeUpdate(e,t,n){e[ta]=di(n),Ep(e,t,n)}};function Ep(e,{value:t,oldValue:n},a){e._modelValue=t;let o;if(ut(t))o=rf(t,a.props.value)>-1;else if(lr(t))o=t.has(a.props.value);else{if(t===n)return;o=tl(t,Wg(e,!0))}e.checked!==o&&(e.checked=o)}const Pp={created(e,{value:t},n){e.checked=tl(t,n.props.value),e[ta]=di(n),vs(e,"change",()=>{e[ta](nr(e))})},beforeUpdate(e,{value:t,oldValue:n},a){e[ta]=di(a),t!==n&&(e.checked=tl(t,a.props.value))}},Qn={deep:!0,created(e,{value:t,modifiers:{number:n}},a){const o=lr(t);vs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?Fu(nr(l)):nr(l));e[ta](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[ta]=di(a)},mounted(e,{value:t}){Dp(e,t)},beforeUpdate(e,t,n){e[ta]=di(n)},updated(e,{value:t}){e._assigning||Dp(e,t)}};function Dp(e,t){const n=e.multiple,a=ut(t);if(!(n&&!a&&!lr(t))){for(let o=0,i=e.options.length;o<i;o++){const l=e.options[o],c=nr(l);if(n)if(a){const d=typeof c;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(c)):l.selected=rf(t,c)>-1}else l.selected=t.has(c);else if(tl(nr(l),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function nr(e){return"_value"in e?e._value:e.value}function Wg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Q0=["ctrl","shift","alt","meta"],eb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Q0.some(n=>e[`${n}Key`]&&!t.includes(n))},ct=(e,t)=>{const n=e._withMods||(e._withMods={}),a=t.join(".");return n[a]||(n[a]=((o,...i)=>{for(let l=0;l<t.length;l++){const c=eb[t[l]];if(c&&c(o,t))return}return e(o,...i)}))},tb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qo=(e,t)=>{const n=e._withKeys||(e._withKeys={}),a=t.join(".");return n[a]||(n[a]=(o=>{if(!("key"in o))return;const i=fi(o.key);if(t.some(l=>l===i||tb[l]===i))return e(o)}))},nb=Rn({patchProp:Y0},A0);let Rp;function ob(){return Rp||(Rp=d0(nb))}const ab=((...e)=>{const t=ob().createApp(...e),{mount:n}=t;return t.mount=a=>{const o=ib(a);if(!o)return;const i=t._component;!_t(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const l=n(o,!1,sb(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),l},t});function sb(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ib(e){return hn(e)?document.querySelector(e):e}let Zg;const Yu=e=>Zg=e,Kg=Symbol();function Dh(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Vr;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Vr||(Vr={}));function lb(){const e=Em(!0),t=e.run(()=>A({}));let n=[],a=[];const o=vf({install(i){Yu(o),o._a=i,i.provide(Kg,o),i.config.globalProperties.$pinia=o,a.forEach(l=>n.push(l)),a=[]},use(i){return this._a?n.push(i):a.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const Yg=()=>{};function Op(e,t,n,a=Yg){e.add(t);const o=()=>{e.delete(t)&&a()};return!n&&Pm()&&Z1(o),o}function Nl(e,...t){e.forEach(n=>{n(...t)})}const rb=e=>e(),Bp=Symbol(),Md=Symbol();function Rh(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,a)=>e.set(a,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const a=t[n],o=e[n];Dh(o)&&Dh(a)&&e.hasOwnProperty(n)&&!dn(a)&&!bs(a)?e[n]=Rh(o,a):e[n]=a}return e}const cb=Symbol();function ub(e){return!Dh(e)||!Object.prototype.hasOwnProperty.call(e,cb)}const{assign:Zs}=Object;function db(e){return!!(dn(e)&&e.effect)}function hb(e,t,n,a){const{state:o,actions:i,getters:l}=t,c=n.state.value[e];let d;function h(){c||(n.state.value[e]=o?o():{});const f=gk(n.state.value[e]);return Zs(f,i,Object.keys(l||{}).reduce((m,y)=>(m[y]=vf(H(()=>{Yu(n);const k=n._s.get(e);return l[y].call(k,k)})),m),{}))}return d=Jg(e,h,t,n,a,!0),d}function Jg(e,t,n={},a,o,i){let l;const c=Zs({actions:{}},n),d={deep:!0};let h,f,m=new Set,y=new Set,k;const _=a.state.value[e];!i&&!_&&(a.state.value[e]={}),A({});let x;function D(N){let $;h=f=!1,typeof N=="function"?(N(a.state.value[e]),$={type:Vr.patchFunction,storeId:e,events:k}):(Rh(a.state.value[e],N),$={type:Vr.patchObject,payload:N,storeId:e,events:k});const z=x=Symbol();cn().then(()=>{x===z&&(h=!0)}),f=!0,Nl(m,$,a.state.value[e])}const M=i?function(){const{state:$}=n,z=$?$():{};this.$patch(O=>{Zs(O,z)})}:Yg;function S(){l.stop(),m.clear(),y.clear(),a._s.delete(e)}const w=(N,$="")=>{if(Bp in N)return N[Md]=$,N;const z=function(){Yu(a);const O=Array.from(arguments),j=new Set,Z=new Set;function J(ie){j.add(ie)}function re(ie){Z.add(ie)}Nl(y,{args:O,name:z[Md],store:T,after:J,onError:re});let K;try{K=N.apply(this&&this.$id===e?this:T,O)}catch(ie){throw Nl(Z,ie),ie}return K instanceof Promise?K.then(ie=>(Nl(j,ie),ie)).catch(ie=>(Nl(Z,ie),Promise.reject(ie))):(Nl(j,K),K)};return z[Bp]=!0,z[Md]=$,z},I={_p:a,$id:e,$onAction:Op.bind(null,y),$patch:D,$reset:M,$subscribe(N,$={}){const z=Op(m,N,$.detached,()=>O()),O=l.run(()=>Ye(()=>a.state.value[e],j=>{($.flush==="sync"?f:h)&&N({storeId:e,type:Vr.direct,events:k},j)},Zs({},d,$)));return z},$dispose:S},T=al(I);a._s.set(e,T);const E=(a._a&&a._a.runWithContext||rb)(()=>a._e.run(()=>(l=Em()).run(()=>t({action:w}))));for(const N in E){const $=E[N];if(dn($)&&!db($)||bs($))i||(_&&ub($)&&(dn($)?$.value=_[N]:Rh($,_[N])),a.state.value[e][N]=$);else if(typeof $=="function"){const z=w($,N);E[N]=z,c.actions[N]=$}}return Zs(T,E),Zs(Ft(T),E),Object.defineProperty(T,"$state",{get:()=>a.state.value[e],set:N=>{D($=>{Zs($,N)})}}),a._p.forEach(N=>{Zs(T,l.run(()=>N({store:T,app:a._a,pinia:a,options:c})))}),_&&i&&n.hydrate&&n.hydrate(T.$state,_),h=!0,f=!0,T}function Lf(e,t,n){let a;const o=typeof t=="function";a=o?n:t;function i(l,c){const d=Ik();return l=l||(d?xo(Kg,null):null),l&&Yu(l),l=Zg,l._s.has(e)||(o?Jg(e,t,a,l):hb(e,a,l)),l._s.get(e)}return i.$id=e,i}const Vl=typeof document<"u";function Xg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function fb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Xg(e.default)}const jt=Object.assign;function Ad(e,t){const n={};for(const a in t){const o=t[a];n[a]=Aa(o)?o.map(e):e(o)}return n}const Gr=()=>{},Aa=Array.isArray;function Np(e,t){const n={};for(const a in e)n[a]=a in t?t[a]:e[a];return n}const Qg=/#/g,pb=/&/g,vb=/\//g,mb=/=/g,gb=/\?/g,ey=/\+/g,yb=/%5B/g,kb=/%5D/g,ty=/%5E/g,bb=/%60/g,ny=/%7B/g,wb=/%7C/g,oy=/%7D/g,_b=/%20/g;function Sf(e){return e==null?"":encodeURI(""+e).replace(wb,"|").replace(yb,"[").replace(kb,"]")}function Cb(e){return Sf(e).replace(ny,"{").replace(oy,"}").replace(ty,"^")}function Oh(e){return Sf(e).replace(ey,"%2B").replace(_b,"+").replace(Qg,"%23").replace(pb,"%26").replace(bb,"`").replace(ny,"{").replace(oy,"}").replace(ty,"^")}function Lb(e){return Oh(e).replace(mb,"%3D")}function Sb(e){return Sf(e).replace(Qg,"%23").replace(gb,"%3F")}function Ib(e){return Sb(e).replace(vb,"%2F")}function ic(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const xb=/\/$/,$b=e=>e.replace(xb,"");function Ed(e,t,n="/"){let a,o={},i="",l="";const c=t.indexOf("#");let d=t.indexOf("?");return d=c>=0&&d>c?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,c>0?c:t.length),o=e(i.slice(1))),c>=0&&(a=a||t.slice(0,c),l=t.slice(c,t.length)),a=Eb(a??t,n),{fullPath:a+i+l,path:a,query:o,hash:ic(l)}}function Tb(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Fp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Mb(e,t,n){const a=t.matched.length-1,o=n.matched.length-1;return a>-1&&a===o&&or(t.matched[a],n.matched[o])&&ay(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function or(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ay(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!Ab(e[n],t[n]))return!1;return!0}function Ab(e,t){return Aa(e)?Up(e,t):Aa(t)?Up(t,e):e?.valueOf()===t?.valueOf()}function Up(e,t){return Aa(t)?e.length===t.length&&e.every((n,a)=>n===t[a]):e.length===1&&e[0]===t}function Eb(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),a=e.split("/"),o=a[a.length-1];(o===".."||o===".")&&a.push("");let i=n.length-1,l,c;for(l=0;l<a.length;l++)if(c=a[l],c!==".")if(c==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+a.slice(l).join("/")}const js={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Bh=(function(e){return e.pop="pop",e.push="push",e})({}),Pd=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Pb(e){if(!e)if(Vl){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),$b(e)}const Db=/^[^#]+#/;function Rb(e,t){return e.replace(Db,"#")+t}function Ob(e,t){const n=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-n.left-(t.left||0),top:a.top-n.top-(t.top||0)}}const Ju=()=>({left:window.scrollX,top:window.scrollY});function Bb(e){let t;if("el"in e){const n=e.el,a=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?a?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=Ob(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function zp(e,t){return(history.state?history.state.position-t:-1)+e}const Nh=new Map;function Nb(e,t){Nh.set(e,t)}function Fb(e){const t=Nh.get(e);return Nh.delete(e),t}function Ub(e){return typeof e=="string"||e&&typeof e=="object"}function sy(e){return typeof e=="string"||typeof e=="symbol"}let vn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const iy=Symbol("");vn.MATCHER_NOT_FOUND+"",vn.NAVIGATION_GUARD_REDIRECT+"",vn.NAVIGATION_ABORTED+"",vn.NAVIGATION_CANCELLED+"",vn.NAVIGATION_DUPLICATED+"";function ar(e,t){return jt(new Error,{type:e,[iy]:!0},t)}function cs(e,t){return e instanceof Error&&iy in e&&(t==null||!!(e.type&t))}const zb=["params","query","hash"];function Hb(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of zb)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function Vb(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const o=n[a].replace(ey," "),i=o.indexOf("="),l=ic(i<0?o:o.slice(0,i)),c=i<0?null:ic(o.slice(i+1));if(l in t){let d=t[l];Aa(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function Hp(e){let t="";for(let n in e){const a=e[n];if(n=Lb(n),a==null){a!==void 0&&(t+=(t.length?"&":"")+n);continue}(Aa(a)?a.map(o=>o&&Oh(o)):[a&&Oh(a)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function Gb(e){const t={};for(const n in e){const a=e[n];a!==void 0&&(t[n]=Aa(a)?a.map(o=>o==null?null:""+o):a==null?a:""+a)}return t}const qb=Symbol(""),Vp=Symbol(""),Xu=Symbol(""),If=Symbol(""),Fh=Symbol("");function Lr(){let e=[];function t(a){return e.push(a),()=>{const o=e.indexOf(a);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function Qs(e,t,n,a,o,i=l=>l()){const l=a&&(a.enterCallbacks[o]=a.enterCallbacks[o]||[]);return()=>new Promise((c,d)=>{const h=y=>{y===!1?d(ar(vn.NAVIGATION_ABORTED,{from:n,to:t})):y instanceof Error?d(y):Ub(y)?d(ar(vn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&a.enterCallbacks[o]===l&&typeof y=="function"&&l.push(y),c())},f=i(()=>e.call(a&&a.instances[o],t,n,h));let m=Promise.resolve(f);e.length<3&&(m=m.then(h)),m.catch(y=>d(y))})}function Dd(e,t,n,a,o=i=>i()){const i=[];for(const l of e)for(const c in l.components){let d=l.components[c];if(!(t!=="beforeRouteEnter"&&!l.instances[c]))if(Xg(d)){const h=(d.__vccOpts||d)[t];h&&i.push(Qs(h,n,a,l,c,o))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${l.path}"`);const m=fb(f)?f.default:f;l.mods[c]=f,l.components[c]=m;const y=(m.__vccOpts||m)[t];return y&&Qs(y,n,a,l,c,o)()}))}}return i}function jb(e,t){const n=[],a=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const c=t.matched[l];c&&(e.matched.find(h=>or(h,c))?a.push(c):n.push(c));const d=e.matched[l];d&&(t.matched.find(h=>or(h,d))||o.push(d))}return[n,a,o]}let Wb=()=>location.protocol+"//"+location.host;function ly(e,t){const{pathname:n,search:a,hash:o}=t,i=e.indexOf("#");if(i>-1){let l=o.includes(e.slice(i))?e.slice(i).length:1,c=o.slice(l);return c[0]!=="/"&&(c="/"+c),Fp(c,"")}return Fp(n,e)+a+o}function Zb(e,t,n,a){let o=[],i=[],l=null;const c=({state:y})=>{const k=ly(e,location),_=n.value,x=t.value;let D=0;if(y){if(n.value=k,t.value=y,l&&l===_){l=null;return}D=x?y.position-x.position:0}else a(k);o.forEach(M=>{M(n.value,_,{delta:D,type:Bh.pop,direction:D?D>0?Pd.forward:Pd.back:Pd.unknown})})};function d(){l=n.value}function h(y){o.push(y);const k=()=>{const _=o.indexOf(y);_>-1&&o.splice(_,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(jt({},y.state,{scroll:Ju()}),"")}}function m(){for(const y of i)y();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:m}}function Gp(e,t,n,a=!1,o=!1){return{back:e,current:t,forward:n,replaced:a,position:window.history.length,scroll:o?Ju():null}}function Kb(e){const{history:t,location:n}=window,a={value:ly(e,n)},o={value:t.state};o.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const m=e.indexOf("#"),y=m>-1?(n.host&&document.querySelector("base")?e:e.slice(m))+d:Wb()+e+d;try{t[f?"replaceState":"pushState"](h,"",y),o.value=h}catch(k){console.error(k),n[f?"replace":"assign"](y)}}function l(d,h){i(d,jt({},t.state,Gp(o.value.back,d,o.value.forward,!0),h,{position:o.value.position}),!0),a.value=d}function c(d,h){const f=jt({},o.value,t.state,{forward:d,scroll:Ju()});i(f.current,f,!0),i(d,jt({},Gp(a.value,d,null),{position:f.position+1},h),!1),a.value=d}return{location:a,state:o,push:c,replace:l}}function Yb(e){e=Pb(e);const t=Kb(e),n=Zb(e,t.state,t.location,t.replace);function a(i,l=!0){l||n.pauseListeners(),history.go(i)}const o=jt({location:"",base:e,go:a,createHref:Rb.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function Jb(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Yb(e)}let Ki=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var $n=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})($n||{});const Xb={type:Ki.Static,value:""},Qb=/[a-zA-Z0-9_]/;function ew(e){if(!e)return[[]];if(e==="/")return[[Xb]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${n})/"${h}": ${k}`)}let n=$n.Static,a=n;const o=[];let i;function l(){i&&o.push(i),i=[]}let c=0,d,h="",f="";function m(){h&&(n===$n.Static?i.push({type:Ki.Static,value:h}):n===$n.Param||n===$n.ParamRegExp||n===$n.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Ki.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;c<e.length;){if(d=e[c++],d==="\\"&&n!==$n.ParamRegExp){a=n,n=$n.EscapeNext;continue}switch(n){case $n.Static:d==="/"?(h&&m(),l()):d===":"?(m(),n=$n.Param):y();break;case $n.EscapeNext:y(),n=a;break;case $n.Param:d==="("?n=$n.ParamRegExp:Qb.test(d)?y():(m(),n=$n.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--);break;case $n.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:n=$n.ParamRegExpEnd:f+=d;break;case $n.ParamRegExpEnd:m(),n=$n.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--,f="";break;default:t("Unknown state");break}}return n===$n.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),m(),l(),o}const qp="[^/]+?",tw={sensitive:!1,strict:!1,start:!0,end:!0};var po=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(po||{});const nw=/[.+*?^${}()[\]/\\]/g;function ow(e,t){const n=jt({},tw,t),a=[];let o=n.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[po.Root];n.strict&&!h.length&&(o+="/");for(let m=0;m<h.length;m++){const y=h[m];let k=po.Segment+(n.sensitive?po.BonusCaseSensitive:0);if(y.type===Ki.Static)m||(o+="/"),o+=y.value.replace(nw,"\\$&"),k+=po.Static;else if(y.type===Ki.Param){const{value:_,repeatable:x,optional:D,regexp:M}=y;i.push({name:_,repeatable:x,optional:D});const S=M||qp;if(S!==qp){k+=po.BonusCustomRegExp;try{`${S}`}catch(I){throw new Error(`Invalid custom RegExp for param "${_}" (${S}): `+I.message)}}let w=x?`((?:${S})(?:/(?:${S}))*)`:`(${S})`;m||(w=D&&h.length<2?`(?:/${w})`:"/"+w),D&&(w+="?"),o+=w,k+=po.Dynamic,D&&(k+=po.BonusOptional),x&&(k+=po.BonusRepeatable),S===".*"&&(k+=po.BonusWildcard)}f.push(k)}a.push(f)}if(n.strict&&n.end){const h=a.length-1;a[h][a[h].length-1]+=po.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const l=new RegExp(o,n.sensitive?"":"i");function c(h){const f=h.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const k=f[y]||"",_=i[y-1];m[_.name]=k&&_.repeatable?k.split("/"):k}return m}function d(h){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const k of y)if(k.type===Ki.Static)f+=k.value;else if(k.type===Ki.Param){const{value:_,repeatable:x,optional:D}=k,M=_ in h?h[_]:"";if(Aa(M)&&!x)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const S=Aa(M)?M.join("/"):M;if(!S)if(D)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${_}"`);f+=S}}return f||"/"}return{re:l,score:a,keys:i,parse:c,stringify:d}}function aw(e,t){let n=0;for(;n<e.length&&n<t.length;){const a=t[n]-e[n];if(a)return a;n++}return e.length<t.length?e.length===1&&e[0]===po.Static+po.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===po.Static+po.Segment?1:-1:0}function ry(e,t){let n=0;const a=e.score,o=t.score;for(;n<a.length&&n<o.length;){const i=aw(a[n],o[n]);if(i)return i;n++}if(Math.abs(o.length-a.length)===1){if(jp(a))return 1;if(jp(o))return-1}return o.length-a.length}function jp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const sw={strict:!1,end:!0,sensitive:!1};function iw(e,t,n){const a=ow(ew(e.path),n),o=jt(a,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function lw(e,t){const n=[],a=new Map;t=Np(sw,t);function o(m){return a.get(m)}function i(m,y,k){const _=!k,x=Zp(m);x.aliasOf=k&&k.record;const D=Np(t,m),M=[x];if("alias"in m){const I=typeof m.alias=="string"?[m.alias]:m.alias;for(const T of I)M.push(Zp(jt({},x,{components:k?k.record.components:x.components,path:T,aliasOf:k?k.record:x})))}let S,w;for(const I of M){const{path:T}=I;if(y&&T[0]!=="/"){const B=y.record.path,E=B[B.length-1]==="/"?"":"/";I.path=y.record.path+(T&&E+T)}if(S=iw(I,y,D),k?k.alias.push(S):(w=w||S,w!==S&&w.alias.push(S),_&&m.name&&!Kp(S)&&l(m.name)),cy(S)&&d(S),x.children){const B=x.children;for(let E=0;E<B.length;E++)i(B[E],S,k&&k.children[E])}k=k||S}return w?()=>{l(w)}:Gr}function l(m){if(sy(m)){const y=a.get(m);y&&(a.delete(m),n.splice(n.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=n.indexOf(m);y>-1&&(n.splice(y,1),m.record.name&&a.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function c(){return n}function d(m){const y=uw(m,n);n.splice(y,0,m),m.record.name&&!Kp(m)&&a.set(m.record.name,m)}function h(m,y){let k,_={},x,D;if("name"in m&&m.name){if(k=a.get(m.name),!k)throw ar(vn.MATCHER_NOT_FOUND,{location:m});D=k.record.name,_=jt(Wp(y.params,k.keys.filter(w=>!w.optional).concat(k.parent?k.parent.keys.filter(w=>w.optional):[]).map(w=>w.name)),m.params&&Wp(m.params,k.keys.map(w=>w.name))),x=k.stringify(_)}else if(m.path!=null)x=m.path,k=n.find(w=>w.re.test(x)),k&&(_=k.parse(x),D=k.record.name);else{if(k=y.name?a.get(y.name):n.find(w=>w.re.test(y.path)),!k)throw ar(vn.MATCHER_NOT_FOUND,{location:m,currentLocation:y});D=k.record.name,_=jt({},y.params,m.params),x=k.stringify(_)}const M=[];let S=k;for(;S;)M.unshift(S.record),S=S.parent;return{name:D,path:x,params:_,matched:M,meta:cw(M)}}e.forEach(m=>i(m));function f(){n.length=0,a.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:c,getRecordMatcher:o}}function Wp(e,t){const n={};for(const a of t)a in e&&(n[a]=e[a]);return n}function Zp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:rw(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function rw(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const a in e.components)t[a]=typeof n=="object"?n[a]:n;return t}function Kp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function cw(e){return e.reduce((t,n)=>jt(t,n.meta),{})}function uw(e,t){let n=0,a=t.length;for(;n!==a;){const i=n+a>>1;ry(e,t[i])<0?a=i:n=i+1}const o=dw(e);return o&&(a=t.lastIndexOf(o,a-1)),a}function dw(e){let t=e;for(;t=t.parent;)if(cy(t)&&ry(e,t)===0)return t}function cy({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Yp(e){const t=xo(Xu),n=xo(If),a=H(()=>{const d=F(e.to);return t.resolve(d)}),o=H(()=>{const{matched:d}=a.value,{length:h}=d,f=d[h-1],m=n.matched;if(!f||!m.length)return-1;const y=m.findIndex(or.bind(null,f));if(y>-1)return y;const k=Jp(d[h-2]);return h>1&&Jp(f)===k&&m[m.length-1].path!==k?m.findIndex(or.bind(null,d[h-2])):y}),i=H(()=>o.value>-1&&mw(n.params,a.value.params)),l=H(()=>o.value>-1&&o.value===n.matched.length-1&&ay(n.params,a.value.params));function c(d={}){if(vw(d)){const h=t[F(e.replace)?"replace":"push"](F(e.to)).catch(Gr);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:a,href:H(()=>a.value.href),isActive:i,isExactActive:l,navigate:c}}function hw(e){return e.length===1?e[0]:e}const fw=pg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Yp,setup(e,{slots:t}){const n=al(Yp(e)),{options:a}=xo(Xu),o=H(()=>({[Xp(e.activeClass,a.linkActiveClass,"router-link-active")]:n.isActive,[Xp(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&hw(t.default(n));return e.custom?i:Cf("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),pw=fw;function vw(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function mw(e,t){for(const n in t){const a=t[n],o=e[n];if(typeof a=="string"){if(a!==o)return!1}else if(!Aa(o)||o.length!==a.length||a.some((i,l)=>i.valueOf()!==o[l].valueOf()))return!1}return!0}function Jp(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Xp=(e,t,n)=>e??t??n,gw=pg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const a=xo(Fh),o=H(()=>e.route||a.value),i=xo(Vp,0),l=H(()=>{let h=F(i);const{matched:f}=o.value;let m;for(;(m=f[h])&&!m.components;)h++;return h}),c=H(()=>o.value.matched[l.value]);Br(Vp,H(()=>l.value+1)),Br(qb,c),Br(Fh,o);const d=A();return Ye(()=>[d.value,c.value,e.name],([h,f,m],[y,k,_])=>{f&&(f.instances[m]=h,k&&k!==f&&h&&h===y&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!or(f,k)||!y)&&(f.enterCallbacks[m]||[]).forEach(x=>x(h))},{flush:"post"}),()=>{const h=o.value,f=e.name,m=c.value,y=m&&m.components[f];if(!y)return Qp(n.default,{Component:y,route:h});const k=m.props[f],_=k?k===!0?h.params:typeof k=="function"?k(h):k:null,D=Cf(y,jt({},_,t,{onVnodeUnmounted:M=>{M.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return Qp(n.default,{Component:D,route:h})||D}}});function Qp(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const yw=gw;function kw(e){const t=lw(e.routes,e),n=e.parseQuery||Vb,a=e.stringifyQuery||Hp,o=e.history,i=Lr(),l=Lr(),c=Lr(),d=pk(js);let h=js;Vl&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ad.bind(null,V=>""+V),m=Ad.bind(null,Ib),y=Ad.bind(null,ic);function k(V,Y){let de,se;return sy(V)?(de=t.getRecordMatcher(V),se=Y):se=V,t.addRoute(se,de)}function _(V){const Y=t.getRecordMatcher(V);Y&&t.removeRoute(Y)}function x(){return t.getRoutes().map(V=>V.record)}function D(V){return!!t.getRecordMatcher(V)}function M(V,Y){if(Y=jt({},Y||d.value),typeof V=="string"){const ee=Ed(n,V,Y.path),_e=t.resolve({path:ee.path},Y),Be=o.createHref(ee.fullPath);return jt(ee,_e,{params:y(_e.params),hash:ic(ee.hash),redirectedFrom:void 0,href:Be})}let de;if(V.path!=null)de=jt({},V,{path:Ed(n,V.path,Y.path).path});else{const ee=jt({},V.params);for(const _e in ee)ee[_e]==null&&delete ee[_e];de=jt({},V,{params:m(ee)}),Y.params=m(Y.params)}const se=t.resolve(de,Y),Re=V.hash||"";se.params=f(y(se.params));const q=Tb(a,jt({},V,{hash:Cb(Re),path:se.path})),Q=o.createHref(q);return jt({fullPath:q,hash:Re,query:a===Hp?Gb(V.query):V.query||{}},se,{redirectedFrom:void 0,href:Q})}function S(V){return typeof V=="string"?Ed(n,V,d.value.path):jt({},V)}function w(V,Y){if(h!==V)return ar(vn.NAVIGATION_CANCELLED,{from:Y,to:V})}function I(V){return E(V)}function T(V){return I(jt(S(V),{replace:!0}))}function B(V,Y){const de=V.matched[V.matched.length-1];if(de&&de.redirect){const{redirect:se}=de;let Re=typeof se=="function"?se(V,Y):se;return typeof Re=="string"&&(Re=Re.includes("?")||Re.includes("#")?Re=S(Re):{path:Re},Re.params={}),jt({query:V.query,hash:V.hash,params:Re.path!=null?{}:V.params},Re)}}function E(V,Y){const de=h=M(V),se=d.value,Re=V.state,q=V.force,Q=V.replace===!0,ee=B(de,se);if(ee)return E(jt(S(ee),{state:typeof ee=="object"?jt({},Re,ee.state):Re,force:q,replace:Q}),Y||de);const _e=de;_e.redirectedFrom=Y;let Be;return!q&&Mb(a,se,de)&&(Be=ar(vn.NAVIGATION_DUPLICATED,{to:_e,from:se}),he(se,se,!0,!1)),(Be?Promise.resolve(Be):z(_e,se)).catch(Ue=>cs(Ue)?cs(Ue,vn.NAVIGATION_GUARD_REDIRECT)?Ue:ae(Ue):U(Ue,_e,se)).then(Ue=>{if(Ue){if(cs(Ue,vn.NAVIGATION_GUARD_REDIRECT))return E(jt({replace:Q},S(Ue.to),{state:typeof Ue.to=="object"?jt({},Re,Ue.to.state):Re,force:q}),Y||_e)}else Ue=j(_e,se,!0,Q,Re);return O(_e,se,Ue),Ue})}function N(V,Y){const de=w(V,Y);return de?Promise.reject(de):Promise.resolve()}function $(V){const Y=Me.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(V):V()}function z(V,Y){let de;const[se,Re,q]=jb(V,Y);de=Dd(se.reverse(),"beforeRouteLeave",V,Y);for(const ee of se)ee.leaveGuards.forEach(_e=>{de.push(Qs(_e,V,Y))});const Q=N.bind(null,V,Y);return de.push(Q),be(de).then(()=>{de=[];for(const ee of i.list())de.push(Qs(ee,V,Y));return de.push(Q),be(de)}).then(()=>{de=Dd(Re,"beforeRouteUpdate",V,Y);for(const ee of Re)ee.updateGuards.forEach(_e=>{de.push(Qs(_e,V,Y))});return de.push(Q),be(de)}).then(()=>{de=[];for(const ee of q)if(ee.beforeEnter)if(Aa(ee.beforeEnter))for(const _e of ee.beforeEnter)de.push(Qs(_e,V,Y));else de.push(Qs(ee.beforeEnter,V,Y));return de.push(Q),be(de)}).then(()=>(V.matched.forEach(ee=>ee.enterCallbacks={}),de=Dd(q,"beforeRouteEnter",V,Y,$),de.push(Q),be(de))).then(()=>{de=[];for(const ee of l.list())de.push(Qs(ee,V,Y));return de.push(Q),be(de)}).catch(ee=>cs(ee,vn.NAVIGATION_CANCELLED)?ee:Promise.reject(ee))}function O(V,Y,de){c.list().forEach(se=>$(()=>se(V,Y,de)))}function j(V,Y,de,se,Re){const q=w(V,Y);if(q)return q;const Q=Y===js,ee=Vl?history.state:{};de&&(se||Q?o.replace(V.fullPath,jt({scroll:Q&&ee&&ee.scroll},Re)):o.push(V.fullPath,Re)),d.value=V,he(V,Y,de,Q),ae()}let Z;function J(){Z||(Z=o.listen((V,Y,de)=>{if(!ze.listening)return;const se=M(V),Re=B(se,ze.currentRoute.value);if(Re){E(jt(Re,{replace:!0,force:!0}),se).catch(Gr);return}h=se;const q=d.value;Vl&&Nb(zp(q.fullPath,de.delta),Ju()),z(se,q).catch(Q=>cs(Q,vn.NAVIGATION_ABORTED|vn.NAVIGATION_CANCELLED)?Q:cs(Q,vn.NAVIGATION_GUARD_REDIRECT)?(E(jt(S(Q.to),{force:!0}),se).then(ee=>{cs(ee,vn.NAVIGATION_ABORTED|vn.NAVIGATION_DUPLICATED)&&!de.delta&&de.type===Bh.pop&&o.go(-1,!1)}).catch(Gr),Promise.reject()):(de.delta&&o.go(-de.delta,!1),U(Q,se,q))).then(Q=>{Q=Q||j(se,q,!1),Q&&(de.delta&&!cs(Q,vn.NAVIGATION_CANCELLED)?o.go(-de.delta,!1):de.type===Bh.pop&&cs(Q,vn.NAVIGATION_ABORTED|vn.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),O(se,q,Q)}).catch(Gr)}))}let re=Lr(),K=Lr(),ie;function U(V,Y,de){ae(V);const se=K.list();return se.length?se.forEach(Re=>Re(V,Y,de)):console.error(V),Promise.reject(V)}function X(){return ie&&d.value!==js?Promise.resolve():new Promise((V,Y)=>{re.add([V,Y])})}function ae(V){return ie||(ie=!V,J(),re.list().forEach(([Y,de])=>V?de(V):Y()),re.reset()),V}function he(V,Y,de,se){const{scrollBehavior:Re}=e;if(!Vl||!Re)return Promise.resolve();const q=!de&&Fb(zp(V.fullPath,0))||(se||!de)&&history.state&&history.state.scroll||null;return cn().then(()=>Re(V,Y,q)).then(Q=>Q&&Bb(Q)).catch(Q=>U(Q,V,Y))}const $e=V=>o.go(V);let Ee;const Me=new Set,ze={currentRoute:d,listening:!0,addRoute:k,removeRoute:_,clearRoutes:t.clearRoutes,hasRoute:D,getRoutes:x,resolve:M,options:e,push:I,replace:T,go:$e,back:()=>$e(-1),forward:()=>$e(1),beforeEach:i.add,beforeResolve:l.add,afterEach:c.add,onError:K.add,isReady:X,install(V){V.component("RouterLink",pw),V.component("RouterView",yw),V.config.globalProperties.$router=ze,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>F(d)}),Vl&&!Ee&&d.value===js&&(Ee=!0,I(o.location).catch(se=>{}));const Y={};for(const se in js)Object.defineProperty(Y,se,{get:()=>d.value[se],enumerable:!0});V.provide(Xu,ze),V.provide(If,Zm(Y)),V.provide(Fh,d);const de=V.unmount;Me.add(V),V.unmount=function(){Me.delete(V),Me.size<1&&(h=js,Z&&Z(),Z=null,d.value=js,Ee=!1,ie=!1),de()}}};function be(V){return V.reduce((Y,de)=>Y.then(()=>$(de)),Promise.resolve())}return ze}function rr(){return xo(Xu)}function Qu(e){return xo(If)}const bw=500,ww=3e3,_w=500,ji=A(new Map),xf=A(!1),yu=A("");let Cw=0,qr=null;function Lw(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:bw}:{message:"Loading...",delay:ww}}function Sw(){qr&&(clearTimeout(qr),qr=null)}function Iw(e){if(e.skipLoadingOverlay)return null;Sw();const t=++Cw,{message:n,delay:a}=Lw(e.method),o=setTimeout(()=>{ji.value.has(t)&&(yu.value=n,xf.value=!0)},a);return ji.value.set(t,{config:e,message:n,timeoutId:o}),e._loadingRequestId=t,t}function ev(e){if(e===null)return;const t=ji.value.get(e);if(t)if(clearTimeout(t.timeoutId),ji.value.delete(e),ji.value.size===0)qr=setTimeout(()=>{ji.value.size===0&&(xf.value=!1,yu.value=""),qr=null},_w);else{const n=ji.value.values().next().value;n&&(yu.value=n.message)}}function tv(e){return e?._loadingRequestId}function xw(){return{showOverlay:xf,overlayMessage:yu}}const Ke=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n},$w={key:0,class:"loading-overlay"},Tw={class:"loading-content"},Mw={class:"loading-message"},Aw={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:n}=xw();return(a,o)=>(p(),qe(Ia,{name:"fade"},{default:Ve(()=>[F(t)?(p(),g("div",$w,[r("div",Tw,[o[0]||(o[0]=r("div",{class:"spinner"},null,-1)),r("p",Mw,b(F(n)||"Loading..."),1)])])):P("",!0)]),_:1}))}},Ew=Ke(Aw,[["__scopeId","data-v-fdee3530"]]),Pw={__name:"App",setup(e){const t=rr(),n=A(""),a=["/","/sessions"];return Ye(()=>t.currentRoute.value,(o,i)=>{if(!i?.path){n.value="";return}const l=a.indexOf(o.path),c=a.indexOf(i.path);l!==-1&&c!==-1?n.value=l>c?"slide-left":"slide-right":n.value=""},{immediate:!0}),(o,i)=>{const l=gf("router-view");return p(),g(Ie,null,[Pe(l,null,{default:Ve(({Component:c,route:d})=>[Pe(Ia,{name:n.value,mode:"out-in"},{default:Ve(()=>[(p(),qe(Vk(c),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Pe(Ew)],64)}}},cr="marshalSessions",Dw=30;function ku(e,t){return`${e}:${t}`}function $f(e){const[t,n]=e.split(":");return{eventId:t,marshalId:n}}function pi(){try{return JSON.parse(localStorage.getItem(cr)||"{}")}catch{return{}}}function bu(e){const t=pi(),n=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,o])=>({sessionKey:a,...o}));return n.length===0?null:(n.sort((a,o)=>new Date(o.lastAccessed)-new Date(a.lastAccessed)),n[0])}function nv(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const n=pi(),a=ku(e,t.marshalId);n[a]={...n[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(cr,JSON.stringify(n))}function Uh(e){const t=pi(),{eventId:n,marshalId:a}=$f(e);delete t[e],localStorage.setItem(cr,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${n}_${a}`)}function uy(e,t){const n=pi(),a=ku(e,t);n[a]&&(n[a].lastAccessed=new Date().toISOString(),localStorage.setItem(cr,JSON.stringify(n)))}function dy(){const e=pi(),t=new Date;t.setDate(t.getDate()-Dw);let n=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:l}=$f(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${l}`),n=!0}n&&localStorage.setItem(cr,JSON.stringify(e))}function hy(){const e=pi(),t=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith("marshal_")&&!o.startsWith("marshalCode_")&&!o.startsWith("marshalSessions")){const i=o.replace("marshal_",""),l=localStorage.getItem(o);if(l){const c=ku(i,l);e[c]||(e[c]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(o)}}const n=Object.keys(e).filter(a=>!a.includes(":"));for(const a of n){const o=e[a];if(o&&o.marshalId){const i=ku(a,o.marshalId);e[i]||(e[i]={...o,eventId:a}),delete e[a]}}(t.length>0||n.length>0)&&(localStorage.setItem(cr,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function Rw(){const e=pi();return Object.entries(e).map(([t,n])=>{const{eventId:a,marshalId:o}=$f(t);return{sessionKey:t,eventId:a,marshalId:o,...n}}).filter(t=>t.token).sort((t,n)=>t.eventDate&&n.eventDate?new Date(t.eventDate)-new Date(n.eventDate):new Date(n.lastAccessed)-new Date(t.lastAccessed))}function fy(){const e=pi();return Object.values(e).some(t=>t.token)}function py(e,t){const n=`marshalCode_${e}_${t}`,a=localStorage.getItem(n);return a||localStorage.getItem(`marshalCode_${e}`)}function Ow(e,t,n){localStorage.setItem(`marshalCode_${e}_${t}`,n)}function vy(e,t){return function(){return e.apply(t,arguments)}}const{toString:Bw}=Object.prototype,{getPrototypeOf:Tf}=Object,{iterator:ed,toStringTag:my}=Symbol,td=(e=>t=>{const n=Bw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ea=e=>(e=e.toLowerCase(),t=>td(t)===e),nd=e=>t=>typeof t===e,{isArray:ur}=Array,sr=nd("undefined");function hc(e){return e!==null&&!sr(e)&&e.constructor!==null&&!sr(e.constructor)&&$o(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const gy=Ea("ArrayBuffer");function Nw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&gy(e.buffer),t}const Fw=nd("string"),$o=nd("function"),yy=nd("number"),fc=e=>e!==null&&typeof e=="object",Uw=e=>e===!0||e===!1,Jc=e=>{if(td(e)!=="object")return!1;const t=Tf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(my in e)&&!(ed in e)},zw=e=>{if(!fc(e)||hc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Hw=Ea("Date"),Vw=Ea("File"),Gw=Ea("Blob"),qw=Ea("FileList"),jw=e=>fc(e)&&$o(e.pipe),Ww=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||$o(e.append)&&((t=td(e))==="formdata"||t==="object"&&$o(e.toString)&&e.toString()==="[object FormData]"))},Zw=Ea("URLSearchParams"),[Kw,Yw,Jw,Xw]=["ReadableStream","Request","Response","Headers"].map(Ea),Qw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let a,o;if(typeof e!="object"&&(e=[e]),ur(e))for(a=0,o=e.length;a<o;a++)t.call(null,e[a],a,e);else{if(hc(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let c;for(a=0;a<l;a++)c=i[a],t.call(null,e[c],c,e)}}function ky(e,t){if(hc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let a=n.length,o;for(;a-- >0;)if(o=n[a],t===o.toLowerCase())return o;return null}const Yi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,by=e=>!sr(e)&&e!==Yi;function zh(){const{caseless:e,skipUndefined:t}=by(this)&&this||{},n={},a=(o,i)=>{const l=e&&ky(n,i)||i;Jc(n[l])&&Jc(o)?n[l]=zh(n[l],o):Jc(o)?n[l]=zh({},o):ur(o)?n[l]=o.slice():(!t||!sr(o))&&(n[l]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&pc(arguments[o],a);return n}const e_=(e,t,n,{allOwnKeys:a}={})=>(pc(t,(o,i)=>{n&&$o(o)?e[i]=vy(o,n):e[i]=o},{allOwnKeys:a}),e),t_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),n_=(e,t,n,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},o_=(e,t,n,a)=>{let o,i,l;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)l=o[i],(!a||a(l,e,t))&&!c[l]&&(t[l]=e[l],c[l]=!0);e=n!==!1&&Tf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},a_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const a=e.indexOf(t,n);return a!==-1&&a===n},s_=e=>{if(!e)return null;if(ur(e))return e;let t=e.length;if(!yy(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},i_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Tf(Uint8Array)),l_=(e,t)=>{const a=(e&&e[ed]).call(e);let o;for(;(o=a.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},r_=(e,t)=>{let n;const a=[];for(;(n=e.exec(t))!==null;)a.push(n);return a},c_=Ea("HTMLFormElement"),u_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,o){return a.toUpperCase()+o}),ov=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),d_=Ea("RegExp"),wy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),a={};pc(n,(o,i)=>{let l;(l=t(o,i,e))!==!1&&(a[i]=l||o)}),Object.defineProperties(e,a)},h_=e=>{wy(e,(t,n)=>{if($o(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=e[n];if($o(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},f_=(e,t)=>{const n={},a=o=>{o.forEach(i=>{n[i]=!0})};return ur(e)?a(e):a(String(e).split(t)),n},p_=()=>{},v_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function m_(e){return!!(e&&$o(e.append)&&e[my]==="FormData"&&e[ed])}const g_=e=>{const t=new Array(10),n=(a,o)=>{if(fc(a)){if(t.indexOf(a)>=0)return;if(hc(a))return a;if(!("toJSON"in a)){t[o]=a;const i=ur(a)?[]:{};return pc(a,(l,c)=>{const d=n(l,o+1);!sr(d)&&(i[c]=d)}),t[o]=void 0,i}}return a};return n(e,0)},y_=Ea("AsyncFunction"),k_=e=>e&&(fc(e)||$o(e))&&$o(e.then)&&$o(e.catch),_y=((e,t)=>e?setImmediate:t?((n,a)=>(Yi.addEventListener("message",({source:o,data:i})=>{o===Yi&&i===n&&a.length&&a.shift()()},!1),o=>{a.push(o),Yi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",$o(Yi.postMessage)),b_=typeof queueMicrotask<"u"?queueMicrotask.bind(Yi):typeof process<"u"&&process.nextTick||_y,w_=e=>e!=null&&$o(e[ed]),Fe={isArray:ur,isArrayBuffer:gy,isBuffer:hc,isFormData:Ww,isArrayBufferView:Nw,isString:Fw,isNumber:yy,isBoolean:Uw,isObject:fc,isPlainObject:Jc,isEmptyObject:zw,isReadableStream:Kw,isRequest:Yw,isResponse:Jw,isHeaders:Xw,isUndefined:sr,isDate:Hw,isFile:Vw,isBlob:Gw,isRegExp:d_,isFunction:$o,isStream:jw,isURLSearchParams:Zw,isTypedArray:i_,isFileList:qw,forEach:pc,merge:zh,extend:e_,trim:Qw,stripBOM:t_,inherits:n_,toFlatObject:o_,kindOf:td,kindOfTest:Ea,endsWith:a_,toArray:s_,forEachEntry:l_,matchAll:r_,isHTMLForm:c_,hasOwnProperty:ov,hasOwnProp:ov,reduceDescriptors:wy,freezeMethods:h_,toObjectSet:f_,toCamelCase:u_,noop:p_,toFiniteNumber:v_,findKey:ky,global:Yi,isContextDefined:by,isSpecCompliantForm:m_,toJSONObject:g_,isAsyncFn:y_,isThenable:k_,setImmediate:_y,asap:b_,isIterable:w_};function It(e,t,n,a,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),a&&(this.request=a),o&&(this.response=o,this.status=o.status?o.status:null)}Fe.inherits(It,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Fe.toJSONObject(this.config),code:this.code,status:this.status}}});const Cy=It.prototype,Ly={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ly[e]={value:e}});Object.defineProperties(It,Ly);Object.defineProperty(Cy,"isAxiosError",{value:!0});It.from=(e,t,n,a,o,i)=>{const l=Object.create(Cy);Fe.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const c=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return It.call(l,c,d,n,a,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const __=null;function Hh(e){return Fe.isPlainObject(e)||Fe.isArray(e)}function Sy(e){return Fe.endsWith(e,"[]")?e.slice(0,-2):e}function av(e,t,n){return e?e.concat(t).map(function(o,i){return o=Sy(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function C_(e){return Fe.isArray(e)&&!e.some(Hh)}const L_=Fe.toFlatObject(Fe,{},null,function(t){return/^is[A-Z]/.test(t)});function od(e,t,n){if(!Fe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Fe.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,D){return!Fe.isUndefined(D[x])});const a=n.metaTokens,o=n.visitor||f,i=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&Fe.isSpecCompliantForm(t);if(!Fe.isFunction(o))throw new TypeError("visitor must be a function");function h(_){if(_===null)return"";if(Fe.isDate(_))return _.toISOString();if(Fe.isBoolean(_))return _.toString();if(!d&&Fe.isBlob(_))throw new It("Blob is not supported. Use a Buffer instead.");return Fe.isArrayBuffer(_)||Fe.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function f(_,x,D){let M=_;if(_&&!D&&typeof _=="object"){if(Fe.endsWith(x,"{}"))x=a?x:x.slice(0,-2),_=JSON.stringify(_);else if(Fe.isArray(_)&&C_(_)||(Fe.isFileList(_)||Fe.endsWith(x,"[]"))&&(M=Fe.toArray(_)))return x=Sy(x),M.forEach(function(w,I){!(Fe.isUndefined(w)||w===null)&&t.append(l===!0?av([x],I,i):l===null?x:x+"[]",h(w))}),!1}return Hh(_)?!0:(t.append(av(D,x,i),h(_)),!1)}const m=[],y=Object.assign(L_,{defaultVisitor:f,convertValue:h,isVisitable:Hh});function k(_,x){if(!Fe.isUndefined(_)){if(m.indexOf(_)!==-1)throw Error("Circular reference detected in "+x.join("."));m.push(_),Fe.forEach(_,function(M,S){(!(Fe.isUndefined(M)||M===null)&&o.call(t,M,Fe.isString(S)?S.trim():S,x,y))===!0&&k(M,x?x.concat(S):[S])}),m.pop()}}if(!Fe.isObject(e))throw new TypeError("data must be an object");return k(e),t}function sv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Mf(e,t){this._pairs=[],e&&od(e,this,t)}const Iy=Mf.prototype;Iy.append=function(t,n){this._pairs.push([t,n])};Iy.toString=function(t){const n=t?function(a){return t.call(this,a,sv)}:sv;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function S_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function xy(e,t,n){if(!t)return e;const a=n&&n.encode||S_;Fe.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(t,n):i=Fe.isURLSearchParams(t)?t.toString():new Mf(t,n).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class iv{constructor(){this.handlers=[]}use(t,n,a){return this.handlers.push({fulfilled:t,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Fe.forEach(this.handlers,function(a){a!==null&&t(a)})}}const $y={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},I_=typeof URLSearchParams<"u"?URLSearchParams:Mf,x_=typeof FormData<"u"?FormData:null,$_=typeof Blob<"u"?Blob:null,T_={isBrowser:!0,classes:{URLSearchParams:I_,FormData:x_,Blob:$_},protocols:["http","https","file","blob","url","data"]},Af=typeof window<"u"&&typeof document<"u",Vh=typeof navigator=="object"&&navigator||void 0,M_=Af&&(!Vh||["ReactNative","NativeScript","NS"].indexOf(Vh.product)<0),A_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",E_=Af&&window.location.href||"http://localhost",P_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Af,hasStandardBrowserEnv:M_,hasStandardBrowserWebWorkerEnv:A_,navigator:Vh,origin:E_},Symbol.toStringTag,{value:"Module"})),eo={...P_,...T_};function D_(e,t){return od(e,new eo.classes.URLSearchParams,{visitor:function(n,a,o,i){return eo.isNode&&Fe.isBuffer(n)?(this.append(a,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function R_(e){return Fe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function O_(e){const t={},n=Object.keys(e);let a;const o=n.length;let i;for(a=0;a<o;a++)i=n[a],t[i]=e[i];return t}function Ty(e){function t(n,a,o,i){let l=n[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=i>=n.length;return l=!l&&Fe.isArray(o)?o.length:l,d?(Fe.hasOwnProp(o,l)?o[l]=[o[l],a]:o[l]=a,!c):((!o[l]||!Fe.isObject(o[l]))&&(o[l]=[]),t(n,a,o[l],i)&&Fe.isArray(o[l])&&(o[l]=O_(o[l])),!c)}if(Fe.isFormData(e)&&Fe.isFunction(e.entries)){const n={};return Fe.forEachEntry(e,(a,o)=>{t(R_(a),o,n,0)}),n}return null}function B_(e,t,n){if(Fe.isString(e))try{return(t||JSON.parse)(e),Fe.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(e)}const vc={transitional:$y,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const a=n.getContentType()||"",o=a.indexOf("application/json")>-1,i=Fe.isObject(t);if(i&&Fe.isHTMLForm(t)&&(t=new FormData(t)),Fe.isFormData(t))return o?JSON.stringify(Ty(t)):t;if(Fe.isArrayBuffer(t)||Fe.isBuffer(t)||Fe.isStream(t)||Fe.isFile(t)||Fe.isBlob(t)||Fe.isReadableStream(t))return t;if(Fe.isArrayBufferView(t))return t.buffer;if(Fe.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return D_(t,this.formSerializer).toString();if((c=Fe.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return od(c?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),B_(t)):t}],transformResponse:[function(t){const n=this.transitional||vc.transitional,a=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Fe.isResponse(t)||Fe.isReadableStream(t))return t;if(t&&Fe.isString(t)&&(a&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?It.from(c,It.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:eo.classes.FormData,Blob:eo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Fe.forEach(["delete","get","head","post","put","patch"],e=>{vc.headers[e]={}});const N_=Fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),F_=e=>{const t={};let n,a,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),a=l.substring(o+1).trim(),!(!n||t[n]&&N_[n])&&(n==="set-cookie"?t[n]?t[n].push(a):t[n]=[a]:t[n]=t[n]?t[n]+", "+a:a)}),t},lv=Symbol("internals");function Sr(e){return e&&String(e).trim().toLowerCase()}function Xc(e){return e===!1||e==null?e:Fe.isArray(e)?e.map(Xc):String(e)}function U_(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(e);)t[a[1]]=a[2];return t}const z_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Rd(e,t,n,a,o){if(Fe.isFunction(a))return a.call(this,t,n);if(o&&(t=n),!!Fe.isString(t)){if(Fe.isString(a))return t.indexOf(a)!==-1;if(Fe.isRegExp(a))return a.test(t)}}function H_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,a)=>n.toUpperCase()+a)}function V_(e,t){const n=Fe.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+n,{value:function(o,i,l){return this[a].call(this,t,o,i,l)},configurable:!0})})}let To=class{constructor(t){t&&this.set(t)}set(t,n,a){const o=this;function i(c,d,h){const f=Sr(d);if(!f)throw new Error("header name must be a non-empty string");const m=Fe.findKey(o,f);(!m||o[m]===void 0||h===!0||h===void 0&&o[m]!==!1)&&(o[m||d]=Xc(c))}const l=(c,d)=>Fe.forEach(c,(h,f)=>i(h,f,d));if(Fe.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Fe.isString(t)&&(t=t.trim())&&!z_(t))l(F_(t),n);else if(Fe.isObject(t)&&Fe.isIterable(t)){let c={},d,h;for(const f of t){if(!Fe.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[h=f[0]]=(d=c[h])?Fe.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(c,n)}else t!=null&&i(n,t,a);return this}get(t,n){if(t=Sr(t),t){const a=Fe.findKey(this,t);if(a){const o=this[a];if(!n)return o;if(n===!0)return U_(o);if(Fe.isFunction(n))return n.call(this,o,a);if(Fe.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Sr(t),t){const a=Fe.findKey(this,t);return!!(a&&this[a]!==void 0&&(!n||Rd(this,this[a],a,n)))}return!1}delete(t,n){const a=this;let o=!1;function i(l){if(l=Sr(l),l){const c=Fe.findKey(a,l);c&&(!n||Rd(a,a[c],c,n))&&(delete a[c],o=!0)}}return Fe.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let a=n.length,o=!1;for(;a--;){const i=n[a];(!t||Rd(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,a={};return Fe.forEach(this,(o,i)=>{const l=Fe.findKey(a,i);if(l){n[l]=Xc(o),delete n[i];return}const c=t?H_(i):String(i).trim();c!==i&&delete n[i],n[c]=Xc(o),a[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Fe.forEach(this,(a,o)=>{a!=null&&a!==!1&&(n[o]=t&&Fe.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const a=new this(t);return n.forEach(o=>a.set(o)),a}static accessor(t){const a=(this[lv]=this[lv]={accessors:{}}).accessors,o=this.prototype;function i(l){const c=Sr(l);a[c]||(V_(o,l),a[c]=!0)}return Fe.isArray(t)?t.forEach(i):i(t),this}};To.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Fe.reduceDescriptors(To.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[n]=a}}});Fe.freezeMethods(To);function Od(e,t){const n=this||vc,a=t||n,o=To.from(a.headers);let i=a.data;return Fe.forEach(e,function(c){i=c.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function My(e){return!!(e&&e.__CANCEL__)}function dr(e,t,n){It.call(this,e??"canceled",It.ERR_CANCELED,t,n),this.name="CanceledError"}Fe.inherits(dr,It,{__CANCEL__:!0});function Ay(e,t,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?e(n):t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function G_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function q_(e,t){e=e||10;const n=new Array(e),a=new Array(e);let o=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=a[i];l||(l=h),n[o]=d,a[o]=h;let m=i,y=0;for(;m!==o;)y+=n[m++],m=m%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(y*1e3/k):void 0}}function j_(e,t){let n=0,a=1e3/t,o,i;const l=(h,f=Date.now())=>{n=f,o=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),m=f-n;m>=a?l(h,f):(o=h,i||(i=setTimeout(()=>{i=null,l(o)},a-m)))},()=>o&&l(o)]}const wu=(e,t,n=3)=>{let a=0;const o=q_(50,250);return j_(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,d=l-a,h=o(d),f=l<=c;a=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:h||void 0,estimated:h&&c&&f?(c-l)/h:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(m)},n)},rv=(e,t)=>{const n=e!=null;return[a=>t[0]({lengthComputable:n,total:e,loaded:a}),t[1]]},cv=e=>(...t)=>Fe.asap(()=>e(...t)),W_=eo.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,eo.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(eo.origin),eo.navigator&&/(msie|trident)/i.test(eo.navigator.userAgent)):()=>!0,Z_=eo.hasStandardBrowserEnv?{write(e,t,n,a,o,i,l){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];Fe.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),Fe.isString(a)&&c.push(`path=${a}`),Fe.isString(o)&&c.push(`domain=${o}`),i===!0&&c.push("secure"),Fe.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function K_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Y_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ey(e,t,n){let a=!K_(t);return e&&(a||n==!1)?Y_(e,t):t}const uv=e=>e instanceof To?{...e}:e;function nl(e,t){t=t||{};const n={};function a(h,f,m,y){return Fe.isPlainObject(h)&&Fe.isPlainObject(f)?Fe.merge.call({caseless:y},h,f):Fe.isPlainObject(f)?Fe.merge({},f):Fe.isArray(f)?f.slice():f}function o(h,f,m,y){if(Fe.isUndefined(f)){if(!Fe.isUndefined(h))return a(void 0,h,m,y)}else return a(h,f,m,y)}function i(h,f){if(!Fe.isUndefined(f))return a(void 0,f)}function l(h,f){if(Fe.isUndefined(f)){if(!Fe.isUndefined(h))return a(void 0,h)}else return a(void 0,f)}function c(h,f,m){if(m in t)return a(h,f);if(m in e)return a(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(h,f,m)=>o(uv(h),uv(f),m,!0)};return Fe.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||o,y=m(e[f],t[f],f);Fe.isUndefined(y)&&m!==c||(n[f]=y)}),n}const Py=e=>{const t=nl({},e);let{data:n,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:i,headers:l,auth:c}=t;if(t.headers=l=To.from(l),t.url=xy(Ey(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Fe.isFormData(n)){if(eo.hasStandardBrowserEnv||eo.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Fe.isFunction(n.getHeaders)){const d=n.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{h.includes(f.toLowerCase())&&l.set(f,m)})}}if(eo.hasStandardBrowserEnv&&(a&&Fe.isFunction(a)&&(a=a(t)),a||a!==!1&&W_(t.url))){const d=o&&i&&Z_.read(i);d&&l.set(o,d)}return t},J_=typeof XMLHttpRequest<"u",X_=J_&&function(e){return new Promise(function(n,a){const o=Py(e);let i=o.data;const l=To.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:h}=o,f,m,y,k,_;function x(){k&&k(),_&&_(),o.cancelToken&&o.cancelToken.unsubscribe(f),o.signal&&o.signal.removeEventListener("abort",f)}let D=new XMLHttpRequest;D.open(o.method.toUpperCase(),o.url,!0),D.timeout=o.timeout;function M(){if(!D)return;const w=To.from("getAllResponseHeaders"in D&&D.getAllResponseHeaders()),T={data:!c||c==="text"||c==="json"?D.responseText:D.response,status:D.status,statusText:D.statusText,headers:w,config:e,request:D};Ay(function(E){n(E),x()},function(E){a(E),x()},T),D=null}"onloadend"in D?D.onloadend=M:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(M)},D.onabort=function(){D&&(a(new It("Request aborted",It.ECONNABORTED,e,D)),D=null)},D.onerror=function(I){const T=I&&I.message?I.message:"Network Error",B=new It(T,It.ERR_NETWORK,e,D);B.event=I||null,a(B),D=null},D.ontimeout=function(){let I=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||$y;o.timeoutErrorMessage&&(I=o.timeoutErrorMessage),a(new It(I,T.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,D)),D=null},i===void 0&&l.setContentType(null),"setRequestHeader"in D&&Fe.forEach(l.toJSON(),function(I,T){D.setRequestHeader(T,I)}),Fe.isUndefined(o.withCredentials)||(D.withCredentials=!!o.withCredentials),c&&c!=="json"&&(D.responseType=o.responseType),h&&([y,_]=wu(h,!0),D.addEventListener("progress",y)),d&&D.upload&&([m,k]=wu(d),D.upload.addEventListener("progress",m),D.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(f=w=>{D&&(a(!w||w.type?new dr(null,e,D):w),D.abort(),D=null)},o.cancelToken&&o.cancelToken.subscribe(f),o.signal&&(o.signal.aborted?f():o.signal.addEventListener("abort",f)));const S=G_(o.url);if(S&&eo.protocols.indexOf(S)===-1){a(new It("Unsupported protocol "+S+":",It.ERR_BAD_REQUEST,e));return}D.send(i||null)})},Q_=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let a=new AbortController,o;const i=function(h){if(!o){o=!0,c();const f=h instanceof Error?h:this.reason;a.abort(f instanceof It?f:new dr(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new It(`timeout ${t} of ms exceeded`,It.ETIMEDOUT))},t);const c=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Fe.asap(c),d}},eC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let a=0,o;for(;a<n;)o=a+t,yield e.slice(a,o),a=o},tC=async function*(e,t){for await(const n of nC(e))yield*eC(n,t)},nC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:a}=await t.read();if(n)break;yield a}}finally{await t.cancel()}},dv=(e,t,n,a)=>{const o=tC(e,t);let i=0,l,c=d=>{l||(l=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await o.next();if(h){c(),d.close();return}let m=f.byteLength;if(n){let y=i+=m;n(y)}d.enqueue(new Uint8Array(f))}catch(h){throw c(h),h}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},hv=64*1024,{isFunction:Nc}=Fe,oC=(({Request:e,Response:t})=>({Request:e,Response:t}))(Fe.global),{ReadableStream:fv,TextEncoder:pv}=Fe.global,vv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},aC=e=>{e=Fe.merge.call({skipUndefined:!0},oC,e);const{fetch:t,Request:n,Response:a}=e,o=t?Nc(t):typeof fetch=="function",i=Nc(n),l=Nc(a);if(!o)return!1;const c=o&&Nc(fv),d=o&&(typeof pv=="function"?(_=>x=>_.encode(x))(new pv):async _=>new Uint8Array(await new n(_).arrayBuffer())),h=i&&c&&vv(()=>{let _=!1;const x=new n(eo.origin,{body:new fv,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!x}),f=l&&c&&vv(()=>Fe.isReadableStream(new a("").body)),m={stream:f&&(_=>_.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!m[_]&&(m[_]=(x,D)=>{let M=x&&x[_];if(M)return M.call(x);throw new It(`Response type '${_}' is not supported`,It.ERR_NOT_SUPPORT,D)})});const y=async _=>{if(_==null)return 0;if(Fe.isBlob(_))return _.size;if(Fe.isSpecCompliantForm(_))return(await new n(eo.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(Fe.isArrayBufferView(_)||Fe.isArrayBuffer(_))return _.byteLength;if(Fe.isURLSearchParams(_)&&(_=_+""),Fe.isString(_))return(await d(_)).byteLength},k=async(_,x)=>{const D=Fe.toFiniteNumber(_.getContentLength());return D??y(x)};return async _=>{let{url:x,method:D,data:M,signal:S,cancelToken:w,timeout:I,onDownloadProgress:T,onUploadProgress:B,responseType:E,headers:N,withCredentials:$="same-origin",fetchOptions:z}=Py(_),O=t||fetch;E=E?(E+"").toLowerCase():"text";let j=Q_([S,w&&w.toAbortSignal()],I),Z=null;const J=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let re;try{if(B&&h&&D!=="get"&&D!=="head"&&(re=await k(N,M))!==0){let he=new n(x,{method:"POST",body:M,duplex:"half"}),$e;if(Fe.isFormData(M)&&($e=he.headers.get("content-type"))&&N.setContentType($e),he.body){const[Ee,Me]=rv(re,wu(cv(B)));M=dv(he.body,hv,Ee,Me)}}Fe.isString($)||($=$?"include":"omit");const K=i&&"credentials"in n.prototype,ie={...z,signal:j,method:D.toUpperCase(),headers:N.normalize().toJSON(),body:M,duplex:"half",credentials:K?$:void 0};Z=i&&new n(x,ie);let U=await(i?O(Z,z):O(x,ie));const X=f&&(E==="stream"||E==="response");if(f&&(T||X&&J)){const he={};["status","statusText","headers"].forEach(ze=>{he[ze]=U[ze]});const $e=Fe.toFiniteNumber(U.headers.get("content-length")),[Ee,Me]=T&&rv($e,wu(cv(T),!0))||[];U=new a(dv(U.body,hv,Ee,()=>{Me&&Me(),J&&J()}),he)}E=E||"text";let ae=await m[Fe.findKey(m,E)||"text"](U,_);return!X&&J&&J(),await new Promise((he,$e)=>{Ay(he,$e,{data:ae,headers:To.from(U.headers),status:U.status,statusText:U.statusText,config:_,request:Z})})}catch(K){throw J&&J(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new It("Network Error",It.ERR_NETWORK,_,Z),{cause:K.cause||K}):It.from(K,K&&K.code,_,Z)}}},sC=new Map,Dy=e=>{let t=e&&e.env||{};const{fetch:n,Request:a,Response:o}=t,i=[a,o,n];let l=i.length,c=l,d,h,f=sC;for(;c--;)d=i[c],h=f.get(d),h===void 0&&f.set(d,h=c?new Map:aC(t)),f=h;return h};Dy();const Ef={http:__,xhr:X_,fetch:{get:Dy}};Fe.forEach(Ef,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const mv=e=>`- ${e}`,iC=e=>Fe.isFunction(e)||e===null||e===!1;function lC(e,t){e=Fe.isArray(e)?e:[e];const{length:n}=e;let a,o;const i={};for(let l=0;l<n;l++){a=e[l];let c;if(o=a,!iC(a)&&(o=Ef[(c=String(a)).toLowerCase()],o===void 0))throw new It(`Unknown adapter '${c}'`);if(o&&(Fe.isFunction(o)||(o=o.get(t))))break;i[c||"#"+l]=o}if(!o){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=n?l.length>1?`since :
`+l.map(mv).join(`
`):" "+mv(l[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const Ry={getAdapter:lC,adapters:Ef};function Bd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new dr(null,e)}function gv(e){return Bd(e),e.headers=To.from(e.headers),e.data=Od.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ry.getAdapter(e.adapter||vc.adapter,e)(e).then(function(a){return Bd(e),a.data=Od.call(e,e.transformResponse,a),a.headers=To.from(a.headers),a},function(a){return My(a)||(Bd(e),a&&a.response&&(a.response.data=Od.call(e,e.transformResponse,a.response),a.response.headers=To.from(a.response.headers))),Promise.reject(a)})}const Oy="1.13.2",ad={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ad[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const yv={};ad.transitional=function(t,n,a){function o(i,l){return"[Axios v"+Oy+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,c)=>{if(t===!1)throw new It(o(l," has been removed"+(n?" in "+n:"")),It.ERR_DEPRECATED);return n&&!yv[l]&&(yv[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,c):!0}};ad.spelling=function(t){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function rC(e,t,n){if(typeof e!="object")throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let o=a.length;for(;o-- >0;){const i=a[o],l=t[i];if(l){const c=e[i],d=c===void 0||l(c,i,e);if(d!==!0)throw new It("option "+i+" must be "+d,It.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new It("Unknown option "+i,It.ERR_BAD_OPTION)}}const Qc={assertOptions:rC,validators:ad},Fa=Qc.validators;let Qi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new iv,response:new iv}}async request(t,n){try{return await this._request(t,n)}catch(a){if(a instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=nl(this.defaults,n);const{transitional:a,paramsSerializer:o,headers:i}=n;a!==void 0&&Qc.assertOptions(a,{silentJSONParsing:Fa.transitional(Fa.boolean),forcedJSONParsing:Fa.transitional(Fa.boolean),clarifyTimeoutError:Fa.transitional(Fa.boolean)},!1),o!=null&&(Fe.isFunction(o)?n.paramsSerializer={serialize:o}:Qc.assertOptions(o,{encode:Fa.function,serialize:Fa.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Qc.assertOptions(n,{baseUrl:Fa.spelling("baseURL"),withXsrfToken:Fa.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&Fe.merge(i.common,i[n.method]);i&&Fe.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),n.headers=To.concat(l,i);const c=[];let d=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(d=d&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let f,m=0,y;if(!d){const _=[gv.bind(this),void 0];for(_.unshift(...c),_.push(...h),y=_.length,f=Promise.resolve(n);m<y;)f=f.then(_[m++],_[m++]);return f}y=c.length;let k=n;for(;m<y;){const _=c[m++],x=c[m++];try{k=_(k)}catch(D){x.call(this,D);break}}try{f=gv.call(this,k)}catch(_){return Promise.reject(_)}for(m=0,y=h.length;m<y;)f=f.then(h[m++],h[m++]);return f}getUri(t){t=nl(this.defaults,t);const n=Ey(t.baseURL,t.url,t.allowAbsoluteUrls);return xy(n,t.params,t.paramsSerializer)}};Fe.forEach(["delete","get","head","options"],function(t){Qi.prototype[t]=function(n,a){return this.request(nl(a||{},{method:t,url:n,data:(a||{}).data}))}});Fe.forEach(["post","put","patch"],function(t){function n(a){return function(i,l,c){return this.request(nl(c||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Qi.prototype[t]=n(),Qi.prototype[t+"Form"]=n(!0)});let cC=class By{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const a=this;this.promise.then(o=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](o);a._listeners=null}),this.promise.then=o=>{let i;const l=new Promise(c=>{a.subscribe(c),i=c}).then(o);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,c){a.reason||(a.reason=new dr(i,l,c),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=a=>{t.abort(a)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new By(function(o){t=o}),cancel:t}}};function uC(e){return function(n){return e.apply(null,n)}}function dC(e){return Fe.isObject(e)&&e.isAxiosError===!0}const Gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Gh).forEach(([e,t])=>{Gh[t]=e});function Ny(e){const t=new Qi(e),n=vy(Qi.prototype.request,t);return Fe.extend(n,Qi.prototype,t,{allOwnKeys:!0}),Fe.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Ny(nl(e,o))},n}const kn=Ny(vc);kn.Axios=Qi;kn.CanceledError=dr;kn.CancelToken=cC;kn.isCancel=My;kn.VERSION=Oy;kn.toFormData=od;kn.AxiosError=It;kn.Cancel=kn.CanceledError;kn.all=function(t){return Promise.all(t)};kn.spread=uC;kn.isAxiosError=dC;kn.mergeConfig=nl;kn.AxiosHeaders=To;kn.formToJSON=e=>Ty(Fe.isHTMLForm(e)?new FormData(e):e);kn.getAdapter=Ry.getAdapter;kn.HttpStatusCode=Gh;kn.default=kn;const{Axios:xJ,AxiosError:$J,CanceledError:TJ,isCancel:MJ,CancelToken:AJ,VERSION:EJ,all:PJ,Cancel:DJ,isAxiosError:RJ,spread:OJ,toFormData:BJ,AxiosHeaders:NJ,HttpStatusCode:FJ,formToJSON:UJ,getAdapter:zJ,mergeConfig:HJ}=kn,ti="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",hC="VolunteerCheckinOffline",fC=1;let Ca=null;async function xs(){return Ca||new Promise((e,t)=>{const n=indexedDB.open(hC,fC);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{Ca=n.result,e(Ca)},n.onupgradeneeded=a=>{const o=a.target.result;o.objectStoreNames.contains("eventData")||o.createObjectStore("eventData",{keyPath:"eventId"}),o.objectStoreNames.contains("pendingActions")||o.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),o.objectStoreNames.contains("syncMeta")||o.createObjectStore("syncMeta",{keyPath:"key"})}})}async function lc(e,t){return await xs(),new Promise((n,a)=>{const o=Ca.transaction(["eventData","syncMeta"],"readwrite"),i=o.objectStore("eventData"),l=o.objectStore("syncMeta"),c={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(c),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),o.oncomplete=()=>n(),o.onerror=()=>a(o.error)})}async function li(e){return await xs(),new Promise((t,n)=>{const i=Ca.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}async function eu(e,t,n){const a=await li(e);a&&(a[t]=n,a.cachedAt=new Date().toISOString(),await lc(e,a))}async function pC(e){return await xs(),new Promise((t,n)=>{const o=Ca.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=o.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function Fy(){return await xs(),new Promise((e,t)=>{const i=Ca.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(c=>c.status==="pending"||c.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function _u(){return(await Fy()).length}async function kv(e,t){return await xs(),new Promise((n,a)=>{const o=Ca.transaction(["pendingActions"],"readwrite"),i=o.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const c=l.result;c&&(Object.assign(c,t),i.put(c))},o.oncomplete=()=>n(),o.onerror=()=>a(o.error)})}async function bv(e){return await xs(),new Promise((t,n)=>{const i=Ca.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}async function vC(e){return await xs(),new Promise((t,n)=>{const i=Ca.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>n(i.error)})}const et=kn.create({baseURL:ti,headers:{"Content-Type":"application/json"},timeout:15e3});let qh=!1,Uy={type:null,eventId:null};function Oo(e,t=null){Uy={type:e,eventId:t}}async function mC(){}function wv(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const n of t){const a=e.match(n);if(a)return a[1]}return null}function gC(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function zy(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Uy}const yC=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];et.interceptors.request.use(e=>{if(yC.some(i=>e.url?.includes(i)))return e;const n=localStorage.getItem("adminEmail");n&&(e.headers["X-Admin-Email"]=n);const a=zy();let o=null;if(a.type==="marshal"&&a.eventId){const i=bu(a.eventId);i?.token&&(o=i.token)}return o||(o=localStorage.getItem("sessionToken")),o&&(e.headers.Authorization=`Bearer ${o}`),Iw(e),e});let Cu=0;const kC=2;function bC(){if(Cu++,Cu>=kC&&zy().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function wC(){Cu=0}function Nd(){Cu=0}function _C(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),n=e.headers?.Authorization||e.headers?.authorization;if(n&&t&&n.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const o=window.location.hash||"";return!!(o.match(/#\/event\/[^/?]+/)||o==="#/marshal"||o.startsWith("#/marshal?"))}et.interceptors.response.use(e=>{const t=tv(e.config);t&&ev(t),qh=!1,wC();const n=e.config.url,a=wv(n);return e.config.method,e},async e=>{const t=e.config,n=tv(t);if(n&&ev(n),e.response&&(e.response.status===401||e.response.status===403))return _C(t)||bC(),Promise.reject(e);if(gC(e)&&(qh=!0,t.method==="get")){const a=wv(t.url);if(a){const o=await li(a);if(o)return console.log("Returning cached data for:",t.url),Promise.resolve({data:o,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Ro(e,t,n){return await pC({type:e,payload:t,eventId:t.eventId}),await mC(),{data:n,status:200,statusText:"OK (queued)",queued:!0}}function Zn(){return qh||!navigator.onLine}const CC={check:()=>et.head("/health")},jh=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),qa={requestLogin:e=>et.post("/auth/request-login",{email:e,frontendUrl:jh()}),verifyToken:e=>et.post("/auth/verify-token",{token:e}),instantLogin:e=>et.post("/auth/instant-login",{email:e}),createAdmin:e=>et.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>et.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>et.get("/auth/me",{params:{eventId:e}}),logout:()=>et.post("/auth/logout")},Fc={getProfile:()=>et.get("/auth/profile"),updateProfile:e=>et.put("/auth/profile",e),getPerson:(e,t)=>et.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,n)=>et.put(`/people/${e}`,n,{params:{eventId:t}})},ni={create:e=>et.post("/events",e),getAll:()=>et.get("/events"),getById:e=>et.get(`/events/${e}`),update:(e,t)=>et.put(`/events/${e}`,t),delete:e=>et.delete(`/events/${e}`),uploadGpx:(e,t)=>{const n=new FormData;return n.append("gpx",t),et.post(`/events/${e}/upload-gpx`,n,{headers:{"Content-Type":"multipart/form-data"}})}},Kn={create:e=>et.post("/locations",e),getById:(e,t)=>et.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>et.get(`/events/${e}/locations`,t),update:(e,t,n)=>et.put(`/locations/${e}/${t}`,n),delete:(e,t)=>et.delete(`/locations/${e}/${t}`),importCsv:(e,t,n)=>{const a=new FormData;return a.append("csv",t),et.post(`/locations/import/${e}?deleteExisting=${n}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>et.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,n,a={})=>et.post(`/locations/${e}/${t}/update-position`,n,a),getDynamicCheckpoints:(e,t={})=>et.get(`/events/${e}/dynamic-checkpoints`,t)},$r={create:e=>et.post("/assignments",e),getById:(e,t)=>et.get(`/assignments/${e}/${t}`),getByEvent:e=>et.get(`/assignments/event/${e}`),delete:(e,t)=>et.delete(`/assignments/${e}/${t}`),getEventStatus:e=>et.get(`/events/${e}/status`)},ri={checkIn:e=>et.post("/checkin",e),toggleCheckIn:(e,t,{latitude:n,longitude:a,action:o}={})=>et.post(`/checkin/${e}/${t}/toggle`,{latitude:n??null,longitude:a??null,action:o??null}),adminCheckIn:(e,t)=>et.post(`/checkin/admin/${e}/${t}`)},Fd={getAdmins:e=>et.get(`/events/${e}/admins`),addAdmin:(e,t)=>et.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>et.delete(`/events/${e}/admins/${t}`)},_a={create:e=>et.post("/marshals",e),getByEvent:e=>et.get(`/events/${e}/marshals`),getById:(e,t)=>et.get(`/marshals/${e}/${t}`),update:(e,t,n)=>et.put(`/marshals/${e}/${t}`,n),delete:(e,t)=>et.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>et.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:jh()}}),sendMagicLink:(e,t)=>et.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:jh()}),importCsv:(e,t)=>{const n=new FormData;return n.append("csv",t),et.post(`/marshals/import/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}})}},ms={create:e=>et.post("/areas",e),getByEvent:e=>et.get(`/events/${e}/areas`),getById:(e,t)=>et.get(`/areas/${e}/${t}`),update:(e,t,n)=>et.put(`/areas/${e}/${t}`,n),delete:(e,t)=>et.delete(`/areas/${e}/${t}`),recalculate:e=>et.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>et.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>et.get(`/events/${e}/area-lead-dashboard`)},zt={create:(e,t)=>et.post(`/events/${e}/checklist-items`,t),getByEvent:e=>et.get(`/events/${e}/checklist-items`),getById:(e,t)=>et.get(`/checklist-items/${e}/${t}`),update:(e,t,n)=>et.put(`/checklist-items/${e}/${t}`,n),delete:(e,t)=>et.delete(`/checklist-items/${e}/${t}`),getReport:e=>et.get(`/events/${e}/checklist-report`),getDetailedReport:e=>et.get(`/events/${e}/checklist-report/detailed`),getMarshalChecklist:(e,t)=>et.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>et.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>et.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/complete`,n),uncomplete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/uncomplete`,n),reorder:(e,t)=>et.post(`/events/${e}/checklist-items/reorder`,{items:t})},ba={create:(e,t)=>et.post(`/events/${e}/notes`,t),getByEvent:e=>et.get(`/events/${e}/notes`),getById:(e,t)=>et.get(`/events/${e}/notes/${t}`),update:(e,t,n)=>et.put(`/events/${e}/notes/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>et.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>et.get(`/events/${e}/my-notes`),reorder:(e,t)=>et.post(`/events/${e}/notes/reorder`,{items:t})},us={create:(e,t)=>et.post(`/events/${e}/contacts`,t),getByEvent:e=>et.get(`/events/${e}/contacts`),getById:(e,t)=>et.get(`/events/${e}/contacts/${t}`),update:(e,t,n)=>et.put(`/events/${e}/contacts/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/contacts/${t}`),getRoles:e=>et.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>et.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>et.get(`/events/${e}/my-contacts`),reorder:(e,t)=>et.post(`/events/${e}/contacts/reorder`,{items:t})},Ks={getAll:e=>et.get(`/events/${e}/role-definitions`),create:(e,t)=>et.post(`/events/${e}/role-definitions`,t),update:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/role-definitions/${t}`),getPeople:(e,t)=>et.get(`/events/${e}/role-definitions/${t}/people`),updatePeople:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}/people`,n),reorder:(e,t)=>et.post(`/events/${e}/role-definitions/reorder`,{items:t}),getMyRoles:e=>et.get(`/events/${e}/my-roles`)},Ga={create:(e,t)=>et.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>et.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>et.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>et.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,n)=>et.patch(`/events/${e}/incidents/${t}`,n),addNote:(e,t,n)=>et.post(`/events/${e}/incidents/${t}/notes`,{note:n})},LC={class:"hero-animation-container"},SC={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,n=A(!1);return un(()=>{t.animate?requestAnimationFrame(()=>{n.value=!0}):n.value=!0}),(a,o)=>(p(),g("div",LC,[(p(),g("svg",{viewBox:"0 0 400 350",class:le(["hero-map-svg",{animate:n.value&&e.animate,"no-animate":n.value&&!e.animate}])},[...o[0]||(o[0]=[ui(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},IC=Ke(SC,[["__scopeId","data-v-cec8ae43"]]),xC={class:"hero-header"},$C={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=A(!1);return un(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(n,a)=>(p(),g("div",xC,[Pe(IC,{animate:t.value},null,8,["animate"]),e.title?(p(),g("div",{key:0,class:le(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,b(e.title),1)],2)):P("",!0)]))}},Hy=Ke($C,[["__scopeId","data-v-c824ab01"]]),mc=Lf("auth",()=>{const e=A(localStorage.getItem("adminEmail")||null),t=A(!!e.value),n=A(!1);return{adminEmail:e,isAuthenticated:t,loginPending:n,requestLogin:async c=>{const d=await qa.requestLogin(c);return d.data.success&&(n.value=!0),d.data},verifyToken:async c=>{const d=await qa.verifyToken(c);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,n.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),Oo("admin")),d.data},instantLogin:async c=>{const d=await qa.instantLogin(c);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),Oo("admin")),d.data},logout:async()=>{try{await qa.logout()}catch{}e.value=null,t.value=!1,n.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),Oo(null)}}}),TC={class:"modal-card"},MC={key:0,class:"email-sent"},AC={key:1},EC={class:"form-group"},PC=["disabled"],DC={key:0,class:"error"},RC={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const n=e,a=t,o=mc(),i=A(""),l=A(!1),c=A(null),d=A(!1);async function h(){l.value=!0,c.value=null;try{const y=await o.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):c.value=y.message||"Failed to send login link. Please try again."}catch{c.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,c.value=null}function m(){a("close")}return Ye(()=>n.show,y=>{y||setTimeout(()=>{f()},200)}),(y,k)=>(p(),qe(ec,{to:"body"},[Pe(Ia,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",style:tt({zIndex:e.zIndex}),onClick:ct(m,["self"])},[r("div",TC,[r("button",{class:"modal-close",onClick:m},""),d.value?(p(),g("div",MC,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(p(),g("div",AC,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(h,["prevent"])},[r("div",EC,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=_=>i.value=_),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[at,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},b(l.value?"Sending...":"Send login link"),9,PC)],32),c.value?(p(),g("div",DC,b(c.value),1)):P("",!0)]))])],4)):P("",!0)]),_:1})]))}},Vy=Ke(RC,[["__scopeId","data-v-7c646305"]]),OC={class:"home"},BC={class:"hero-section"},NC={class:"content-section"},FC={class:"container"},UC={class:"carousel"},zC={class:"carousel-indicators"},HC=["onClick"],VC={__name:"Home",setup(e){const t=Qu(),n=rr();function a(){const y=!!localStorage.getItem("adminEmail"),k=fy();return y||k}function o(){a()?n.push("/sessions"):f.value=!0}const i=A(0);let l=null;function c(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=A(!1);function m(){f.value=!1,t.query.login&&n.replace({query:{}})}return un(()=>{h(),t.query.login&&(a()?n.replace("/sessions"):f.value=!0)}),Ln(()=>{l&&clearInterval(l)}),(y,k)=>(p(),g("div",OC,[r("section",BC,[Pe(Hy,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:o}," Join us or login ")]),r("section",NC,[r("div",FC,[k[2]||(k[2]=ui('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",UC,[r("div",{class:"carousel-track",style:tt({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[ui('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",zC,[(p(),g(Ie,null,je(2,(_,x)=>r("button",{key:x,class:le(["indicator",{active:i.value===x}]),onClick:D=>c(x)},null,10,HC)),64))])])])]),Pe(Vy,{show:f.value,onClose:m},null,8,["show"])]))}},GC=Ke(VC,[["__scopeId","data-v-aaecbd22"]]),qC={class:"admin-login"},jC={class:"login-card"},WC={key:0,class:"email-sent"},ZC={class:"form-group"},KC=["disabled"],YC={key:0,class:"error"},JC={__name:"AdminLogin",setup(e){const t=mc(),n=A(""),a=A(!1),o=A(null),i=A(!1),l=async()=>{a.value=!0,o.value=null;try{const d=await t.requestLogin(n.value);d.success?i.value=!0:o.value=d.message||"Failed to send login link. Please try again."}catch{o.value="Failed to send login link. Please try again."}finally{a.value=!1}},c=()=>{n.value="",i.value=!1,o.value=null};return(d,h)=>{const f=gf("router-link");return p(),g("div",qC,[r("div",jC,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(p(),g("div",WC,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(n.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:c,class:"btn btn-secondary"}," Use a different email ")])):(p(),g(Ie,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",ZC,[We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=m=>n.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[at,n.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:a.value},b(a.value?"Sending...":"Send login link"),9,KC)],32),o.value?(p(),g("div",YC,b(o.value),1)):P("",!0)],64)),Pe(f,{to:"/",class:"back-link"},{default:Ve(()=>[...h[6]||(h[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},XC=Ke(JC,[["__scopeId","data-v-5d0a88c2"]]),QC={class:"admin-verify"},e2={class:"verify-card"},t2={key:0,class:"status"},n2={key:1,class:"status error"},o2={key:2,class:"status success"},a2={__name:"AdminVerify",setup(e){const t=rr(),n=Qu(),a=mc(),o=A(!0),i=A(null);return un(async()=>{const l=n.query.token;if(!l){i.value="No login token provided. Please request a new login link.",o.value=!1;return}try{const c=await a.verifyToken(l);c.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=c.message||"Invalid or expired login link. Please request a new one."}catch(c){console.error("Verification error:",c),i.value="Failed to verify login. Please try again."}finally{o.value=!1}}),(l,c)=>{const d=gf("router-link");return p(),g("div",QC,[r("div",e2,[o.value?(p(),g("div",t2,[...c[0]||(c[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(p(),g("div",n2,[c[2]||(c[2]=r("h2",null,"Login failed",-1)),r("p",null,b(i.value),1),Pe(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ve(()=>[...c[1]||(c[1]=[Je(" Try again ",-1)])]),_:1})])):(p(),g("div",o2,[...c[3]||(c[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},s2=Ke(a2,[["__scopeId","data-v-b2435a84"]]),Gy=Lf("events",()=>{const e=A([]),t=A(null),n=A([]),a=A([]),o=A(null),i=A(!1),l=A(null),c=async()=>{i.value=!0,l.value=null;try{const B=await ni.getAll();e.value=B.data}catch(B){throw l.value=B.message,B}finally{i.value=!1}},d=async B=>{i.value=!0,l.value=null;try{const E=await ni.getById(B);t.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},h=async B=>{i.value=!0,l.value=null;try{const E=await ni.create(B);return e.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},f=async(B,E)=>{i.value=!0,l.value=null;try{const N=await ni.update(B,E),$=e.value.findIndex(z=>z.id===B);return $!==-1&&(e.value[$]=N.data),t.value?.id===B&&(t.value=N.data),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},m=async B=>{i.value=!0,l.value=null;try{await ni.delete(B),e.value=e.value.filter(E=>E.id!==B)}catch(E){throw l.value=E.message,E}finally{i.value=!1}},y=async B=>{i.value=!0,l.value=null;try{const E=await Kn.getByEvent(B);n.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}};return{events:e,currentEvent:t,locations:n,assignments:a,eventStatus:o,loading:i,error:l,fetchEvents:c,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async B=>{i.value=!0,l.value=null;try{const E=await Kn.create(B);return n.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateLocation:async(B,E,N)=>{i.value=!0,l.value=null;try{const $=await Kn.update(B,E,N),z=n.value.findIndex(O=>O.id===E);return z!==-1&&(n.value[z]=$.data),$.data}catch($){throw l.value=$.message,$}finally{i.value=!1}},deleteLocation:async(B,E)=>{i.value=!0,l.value=null;try{await Kn.delete(B,E),n.value=n.value.filter(N=>N.id!==E)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},bulkUpdateLocationTimes:async(B,E)=>{i.value=!0,l.value=null;try{const N=await Kn.bulkUpdateTimes(B,E);return await y(B),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchAssignments:async B=>{i.value=!0,l.value=null;try{const E=await $r.getByEvent(B);a.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},createAssignment:async B=>{i.value=!0,l.value=null;try{const E=await $r.create(B);return a.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},deleteAssignment:async(B,E)=>{i.value=!0,l.value=null;try{await $r.delete(B,E),a.value=a.value.filter(N=>N.id!==E)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchEventStatus:async B=>{i.value=!0,l.value=null;try{const E=await $r.getEventStatus(B);return o.value=E.data,E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateAssignmentCheckIn:B=>{const E=a.value.findIndex(N=>N.id===B.id);E!==-1&&(a.value[E]=B),o.value&&o.value.locations.forEach(N=>{const $=N.assignments.findIndex(z=>z.id===B.id);$!==-1&&(N.assignments[$]=B,N.checkedInCount=N.assignments.filter(z=>z.isCheckedIn).length)})}}});function qy(e="details",t=[]){const n=A(e),a=m=>{n.value=m},o=()=>{n.value=e},i=m=>n.value===m,l=H(()=>t.length===0?-1:t.indexOf(n.value)),c=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?n.value=t[k]:m&&(n.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?n.value=t[k]:m&&(n.value=t[t.length-1])},h=H(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=H(()=>t.length===0?!1:l.value>0);return{activeTab:n,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:a,resetTab:o,isActiveTab:i,nextTab:c,previousTab:d}}function i2(){const e=A(!1),t=A(""),n=A(""),a=A(null),o=A(!1),i=A("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:n,confirmModalIsDanger:o,confirmModalConfirmText:i,showConfirm:(f,m,y,k={})=>{t.value=f,n.value=m,a.value=y,o.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Gl=A({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),ys={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},gs={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Wi(e,t,n="Marshals"){if(!t)return"";const a=ys[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${ys.people[n]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function jy(e,t,n="Marshals"){if(!t)return"";const a=ys[e]?.[t];return t==="Person points"?`${ys.people[n]?.singular||"Person"} points`:a?.plural?a.plural:t}function Wh(e,t){return e==="Person points"?`${ys.people[t]?.singular||"Person"} points`:e}function Zh(e){e&&(Gl.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const ga=e=>e.toLowerCase(),ya=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ht(){const e=f=>{const m=Gl.value[f],y=ys[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Gl.value.people;return`${ys.people[k]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=Gl.value[f],y=ys[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Gl.value.people;return`${ys.people[k]?.singular||"Person"} points`}return y?.plural||m},n=H(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=H(()=>({person:ga(e("people")),checkpoint:ga(e("checkpoint")),area:ga(e("area")),checklist:ga(e("checklist")),course:ga(e("course")),people:ga(t("people")),checkpoints:ga(t("checkpoint")),areas:ga(t("area")),checklists:ga(t("checklist")),courses:ga(t("course"))})),o=H(()=>({person:ya(e("people")),checkpoint:ya(e("checkpoint")),area:ya(e("area")),checklist:ya(e("checklist")),course:ya(e("course")),people:ya(t("people")),checkpoints:ya(t("checkpoint")),areas:ya(t("area")),checklists:ya(t("checklist")),courses:ya(t("course"))})),i=H(()=>({course:n.value.course,checkpoints:n.value.checkpoints,areas:n.value.areas,marshals:n.value.people,checklists:n.value.checklists,notes:"Notes",details:"Event details"}));return{terms:n,termsLower:a,termsSentence:o,tabLabels:i,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>ga(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>ya(m?t(f):e(f)),terminology:Gl}}function l2(){const e=A(!1),t=A(null),n=A({}),a=A(null),o=A(null),i=A([]),l=A(null),c=A(null),d=A(!1),h=A(!1),f=A(1),m=H(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?o.value&&o.value.length>=3:t.value==="add-multiple"),y=Z=>{if(Z){const J=Z.getMapCenter?.(),re=Z.getMapZoom?.();J&&re!==null&&(l.value=J,c.value=re)}},k=(Z={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",n.value={title:Z.title||"Select checkpoint location",description:Z.description||"Click on the map to set the location. Click again to reposition."}},_=(Z,J="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",n.value={title:`Move ${J}: ${Z}`,description:"Click on the map to set the new location"}},x=(Z={})=>{e.value=!0,t.value="draw-area",d.value=!0,n.value={title:Z.title||"Draw area boundary",description:Z.description||"Click to add points. Click Done when finished to complete the area."}},D=(Z=1)=>{f.value=Z,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,n.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},M=Z=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=Z:t.value==="add-multiple"&&S(Z)},S=Z=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Z.lat,longitude:Z.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,n.value={...n.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},w=Z=>{o.value=Z},I=()=>o.value&&o.value.length>=3?o.value.map(Z=>({lat:Z.lat,lng:Z.lng})):null,T=()=>{e.value=!1,t.value=null,n.value={},a.value=null,l.value=null,c.value=null,o.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:n,tempLocationCoords:a,currentDrawingPolygon:o,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:c,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:_,enterDrawAreaMode:x,enterAddMultipleMode:D,handleFullscreenMapClick:M,handlePolygonDrawing:w,getCompletedPolygon:I,exitFullscreen:T,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,o.value=null),T()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(Z,J,re)=>H(()=>{const K=[...Z.value];return t.value==="place-checkpoint"&&a.value&&K.push({id:"temp-single",name:J.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:J.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&re.value&&K.push({id:"temp-move",name:re.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:re.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&K.push(...i.value),K}),createDisplayAreas:(Z,J)=>H(()=>{const re=[...Z.value];if(t.value==="draw-area"&&J.value?.polygon?.length>0){const K=re.findIndex(ie=>ie.id===J.value.id);K>=0?re[K]={...J.value}:re.push({...J.value,id:J.value.id||"temp-area"})}return re}),calculateStartingNumber:Z=>{const J=Z.value.map(re=>{const K=re.name.match(/^Checkpoint (\d+)$/);return K?parseInt(K[1]):0}).filter(re=>re>0);return J.length>0?Math.max(...J)+1:1}}}function r2(e){const t=A([]),n=A(!1);return{eventAdmins:t,showAddAdmin:n,loadEventAdmins:async()=>{try{const d=await Fd.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{n.value=!0},closeAddAdminModal:()=>{n.value=!1},addAdmin:async d=>{await Fd.addAdmin(e.value,d)},removeAdmin:async d=>{await Fd.removeAdmin(e.value,d)}}}function c2(e){const t=A(!1),n=A(!1),a=A(!1),o=A(!1),i=A(!1),l=A(!1),c=A(null),d=A(null),h=A(null),f=A(null);return{showUploadRoute:t,showImportLocations:n,showImportMarshals:a,uploading:o,importing:i,importingMarshals:l,uploadError:c,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{c.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,c.value=null},uploadRoute:async T=>{if(!T)return c.value="Please select a GPX file",null;o.value=!0,c.value=null;try{return await ni.uploadGpx(e.value,T),!0}catch(B){return console.error("Failed to upload route:",B),c.value=B.response?.data?.message||"Failed to upload route. Please try again.",null}finally{o.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,n.value=!0},closeImportLocationsModal:()=>{n.value=!1,d.value=null,h.value=null},importLocations:async(T,B)=>{if(!T)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const E=await Kn.importCsv(e.value,T,B);return h.value=E.data,E.data}catch(E){return console.error("Failed to import locations:",E),d.value=E.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,f.value=null},importMarshals:async T=>{if(!T)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const B=await _a.importCsv(e.value,T);return f.value=B.data,B.data}catch(B){return console.error("Failed to import marshals:",B),d.value=B.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(T,B="location")=>{const E=B==="location"?"location(s)":"marshal(s)";let $=`<p>Created <strong>${T[B==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${E} and <strong>${T.assignmentsCreated}</strong> assignment(s)</p>`;return T.errors&&T.errors.length>0&&($+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',T.errors.forEach(z=>{$+=`<li>${z}</li>`}),$+="</ul>"),$}}}const Wy="admin-theme-preference",Ui=A(u2());function u2(){return typeof window>"u"?"system":localStorage.getItem(Wy)||"system"}function d2(e){localStorage.setItem(Wy,e)}function Zy(){const e=H(()=>Ui.value==="system"?"light dark":Ui.value),t=(o,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Ui.value=o,d2(o)},n=()=>{const o=["system","light","dark"],l=(o.indexOf(Ui.value)+1)%o.length;t(o[l])},a=H(()=>Ui.value==="dark"?!0:Ui.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Ui,colorScheme:e,isDark:a,setTheme:t,cycleTheme:n}}const Ky=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",rc=e=>{if(!e)return"";const t=new Date(e),n=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${n}-${a}-${o}T${i}:${l}`},Lu=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const n=e.includes("."),a=e.includes("/");return n!==a},sl=(e,t,n,a)=>{const i=e*Math.PI/180,l=n*Math.PI/180,c=(n-e)*Math.PI/180,d=(a-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},h2=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ud(e,{areas:t=[],locations:n=[],marshals:a=[]}){if(!e||e.length===0)return e;const o=new Set(t.map(h=>h.id)),i=new Set(n.map(h=>h.id)),l=new Set(a.map(h=>h.id)),c=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,m=h.ids||[];if(!f||m.length===0)return h;const y=m.filter(k=>c.has(k)?!0:f==="Area"?o.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:y}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function Yy({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:n=[],areaLeadAreaIds:a=[],locationId:o,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const c=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(c){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(n.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(o))&&n.includes(o)||d.some(f=>n.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(n.length>0)return!0}else if(d.some(f=>i.includes(f))&&n.includes(o))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(a.length>0)return!0}else if(d.some(f=>a.includes(f)))return!0;break}}return!1}function Jy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tr={exports:{}};var f2=Tr.exports,_v;function p2(){return _v||(_v=1,(function(e,t){(function(n,a){a(t)})(f2,(function(n){var a="1.9.4";function o(s){var u,v,C,R;for(v=1,C=arguments.length;v<C;v++){R=arguments[v];for(u in R)s[u]=R[u]}return s}var i=Object.create||(function(){function s(){}return function(u){return s.prototype=u,new s}})();function l(s,u){var v=Array.prototype.slice;if(s.bind)return s.bind.apply(s,v.call(arguments,1));var C=v.call(arguments,2);return function(){return s.apply(u,C.length?C.concat(v.call(arguments)):arguments)}}var c=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++c),s._leaflet_id}function h(s,u,v){var C,R,W,ue;return ue=function(){C=!1,R&&(W.apply(v,R),R=!1)},W=function(){C?R=arguments:(s.apply(v,arguments),setTimeout(ue,u),C=!0)},W}function f(s,u,v){var C=u[1],R=u[0],W=C-R;return s===C&&v?s:((s-R)%W+W)%W+R}function m(){return!1}function y(s,u){if(u===!1)return s;var v=Math.pow(10,u===void 0?6:u);return Math.round(s*v)/v}function k(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function _(s){return k(s).split(/\s+/)}function x(s,u){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var v in u)s.options[v]=u[v];return s.options}function D(s,u,v){var C=[];for(var R in s)C.push(encodeURIComponent(v?R.toUpperCase():R)+"="+encodeURIComponent(s[R]));return(!u||u.indexOf("?")===-1?"?":"&")+C.join("&")}var M=/\{ *([\w_ -]+) *\}/g;function S(s,u){return s.replace(M,function(v,C){var R=u[C];if(R===void 0)throw new Error("No value provided for variable "+v);return typeof R=="function"&&(R=R(u)),R})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function I(s,u){for(var v=0;v<s.length;v++)if(s[v]===u)return v;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var E=0;function N(s){var u=+new Date,v=Math.max(0,16-(u-E));return E=u+v,window.setTimeout(s,v)}var $=window.requestAnimationFrame||B("RequestAnimationFrame")||N,z=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function O(s,u,v){if(v&&$===N)s.call(u);else return $.call(window,l(s,u))}function j(s){s&&z.call(window,s)}var Z={__proto__:null,extend:o,create:i,bind:l,get lastId(){return c},stamp:d,throttle:h,wrapNum:f,falseFn:m,formatNum:y,trim:k,splitWords:_,setOptions:x,getParamString:D,template:S,isArray:w,indexOf:I,emptyImageUrl:T,requestFn:$,cancelFn:z,requestAnimFrame:O,cancelAnimFrame:j};function J(){}J.extend=function(s){var u=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=u.__super__=this.prototype,C=i(v);C.constructor=u,u.prototype=C;for(var R in this)Object.prototype.hasOwnProperty.call(this,R)&&R!=="prototype"&&R!=="__super__"&&(u[R]=this[R]);return s.statics&&o(u,s.statics),s.includes&&(re(s.includes),o.apply(null,[C].concat(s.includes))),o(C,s),delete C.statics,delete C.includes,C.options&&(C.options=v.options?i(v.options):{},o(C.options,s.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,ue=C._initHooks.length;W<ue;W++)C._initHooks[W].call(this)}},u},J.include=function(s){var u=this.prototype.options;return o(this.prototype,s),s.options&&(this.prototype.options=u,this.mergeOptions(s.options)),this},J.mergeOptions=function(s){return o(this.prototype.options,s),this},J.addInitHook=function(s){var u=Array.prototype.slice.call(arguments,1),v=typeof s=="function"?s:function(){this[s].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function re(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var u=0;u<s.length;u++)s[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(s,u,v){if(typeof s=="object")for(var C in s)this._on(C,s[C],u);else{s=_(s);for(var R=0,W=s.length;R<W;R++)this._on(s[R],u,v)}return this},off:function(s,u,v){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var C in s)this._off(C,s[C],u);else{s=_(s);for(var R=arguments.length===1,W=0,ue=s.length;W<ue;W++)R?this._off(s[W]):this._off(s[W],u,v)}return this},_on:function(s,u,v,C){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(s,u,v)===!1){v===this&&(v=void 0);var R={fn:u,ctx:v};C&&(R.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(R)}},_off:function(s,u,v){var C,R,W;if(this._events&&(C=this._events[s],!!C)){if(arguments.length===1){if(this._firingCount)for(R=0,W=C.length;R<W;R++)C[R].fn=m;delete this._events[s];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var ue=this._listens(s,u,v);if(ue!==!1){var Te=C[ue];this._firingCount&&(Te.fn=m,this._events[s]=C=C.slice()),C.splice(ue,1)}}},fire:function(s,u,v){if(!this.listens(s,v))return this;var C=o({},u,{type:s,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var R=this._events[s];if(R){this._firingCount=this._firingCount+1||1;for(var W=0,ue=R.length;W<ue;W++){var Te=R[W],Ne=Te.fn;Te.once&&this.off(s,Ne,Te.ctx),Ne.call(Te.ctx||this,C)}this._firingCount--}}return v&&this._propagateEvent(C),this},listens:function(s,u,v,C){typeof s!="string"&&console.warn('"string" type argument expected');var R=u;typeof u!="function"&&(C=!!u,R=void 0,v=void 0);var W=this._events&&this._events[s];if(W&&W.length&&this._listens(s,R,v)!==!1)return!0;if(C){for(var ue in this._eventParents)if(this._eventParents[ue].listens(s,u,v,C))return!0}return!1},_listens:function(s,u,v){if(!this._events)return!1;var C=this._events[s]||[];if(!u)return!!C.length;v===this&&(v=void 0);for(var R=0,W=C.length;R<W;R++)if(C[R].fn===u&&C[R].ctx===v)return R;return!1},once:function(s,u,v){if(typeof s=="object")for(var C in s)this._on(C,s[C],u,!0);else{s=_(s);for(var R=0,W=s.length;R<W;R++)this._on(s[R],u,v,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var u in this._eventParents)this._eventParents[u].fire(s.type,o({layer:s.target,propagatedFrom:s.target},s),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var ie=J.extend(K);function U(s,u,v){this.x=v?Math.round(s):s,this.y=v?Math.round(u):u}var X=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(s){return this.clone()._add(ae(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ae(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new U(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new U(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=X(this.x),this.y=X(this.y),this},distanceTo:function(s){s=ae(s);var u=s.x-this.x,v=s.y-this.y;return Math.sqrt(u*u+v*v)},equals:function(s){return s=ae(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ae(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ae(s,u,v){return s instanceof U?s:w(s)?new U(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new U(s.x,s.y):new U(s,u,v)}function he(s,u){if(s)for(var v=u?[s,u]:s,C=0,R=v.length;C<R;C++)this.extend(v[C])}he.prototype={extend:function(s){var u,v;if(!s)return this;if(s instanceof U||typeof s[0]=="number"||"x"in s)u=v=ae(s);else if(s=$e(s),u=s.min,v=s.max,!u||!v)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=v.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(s){return ae((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ae(this.min.x,this.max.y)},getTopRight:function(){return ae(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var u,v;return typeof s[0]=="number"||s instanceof U?s=ae(s):s=$e(s),s instanceof he?(u=s.min,v=s.max):u=v=s,u.x>=this.min.x&&v.x<=this.max.x&&u.y>=this.min.y&&v.y<=this.max.y},intersects:function(s){s=$e(s);var u=this.min,v=this.max,C=s.min,R=s.max,W=R.x>=u.x&&C.x<=v.x,ue=R.y>=u.y&&C.y<=v.y;return W&&ue},overlaps:function(s){s=$e(s);var u=this.min,v=this.max,C=s.min,R=s.max,W=R.x>u.x&&C.x<v.x,ue=R.y>u.y&&C.y<v.y;return W&&ue},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var u=this.min,v=this.max,C=Math.abs(u.x-v.x)*s,R=Math.abs(u.y-v.y)*s;return $e(ae(u.x-C,u.y-R),ae(v.x+C,v.y+R))},equals:function(s){return s?(s=$e(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function $e(s,u){return!s||s instanceof he?s:new he(s,u)}function Ee(s,u){if(s)for(var v=u?[s,u]:s,C=0,R=v.length;C<R;C++)this.extend(v[C])}Ee.prototype={extend:function(s){var u=this._southWest,v=this._northEast,C,R;if(s instanceof ze)C=s,R=s;else if(s instanceof Ee){if(C=s._southWest,R=s._northEast,!C||!R)return this}else return s?this.extend(be(s)||Me(s)):this;return!u&&!v?(this._southWest=new ze(C.lat,C.lng),this._northEast=new ze(R.lat,R.lng)):(u.lat=Math.min(C.lat,u.lat),u.lng=Math.min(C.lng,u.lng),v.lat=Math.max(R.lat,v.lat),v.lng=Math.max(R.lng,v.lng)),this},pad:function(s){var u=this._southWest,v=this._northEast,C=Math.abs(u.lat-v.lat)*s,R=Math.abs(u.lng-v.lng)*s;return new Ee(new ze(u.lat-C,u.lng-R),new ze(v.lat+C,v.lng+R))},getCenter:function(){return new ze((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ze(this.getNorth(),this.getWest())},getSouthEast:function(){return new ze(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof ze||"lat"in s?s=be(s):s=Me(s);var u=this._southWest,v=this._northEast,C,R;return s instanceof Ee?(C=s.getSouthWest(),R=s.getNorthEast()):C=R=s,C.lat>=u.lat&&R.lat<=v.lat&&C.lng>=u.lng&&R.lng<=v.lng},intersects:function(s){s=Me(s);var u=this._southWest,v=this._northEast,C=s.getSouthWest(),R=s.getNorthEast(),W=R.lat>=u.lat&&C.lat<=v.lat,ue=R.lng>=u.lng&&C.lng<=v.lng;return W&&ue},overlaps:function(s){s=Me(s);var u=this._southWest,v=this._northEast,C=s.getSouthWest(),R=s.getNorthEast(),W=R.lat>u.lat&&C.lat<v.lat,ue=R.lng>u.lng&&C.lng<v.lng;return W&&ue},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,u){return s?(s=Me(s),this._southWest.equals(s.getSouthWest(),u)&&this._northEast.equals(s.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Me(s,u){return s instanceof Ee?s:new Ee(s,u)}function ze(s,u,v){if(isNaN(s)||isNaN(u))throw new Error("Invalid LatLng object: ("+s+", "+u+")");this.lat=+s,this.lng=+u,v!==void 0&&(this.alt=+v)}ze.prototype={equals:function(s,u){if(!s)return!1;s=be(s);var v=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return v<=(u===void 0?1e-9:u)},toString:function(s){return"LatLng("+y(this.lat,s)+", "+y(this.lng,s)+")"},distanceTo:function(s){return Y.distance(this,be(s))},wrap:function(){return Y.wrapLatLng(this)},toBounds:function(s){var u=180*s/40075017,v=u/Math.cos(Math.PI/180*this.lat);return Me([this.lat-u,this.lng-v],[this.lat+u,this.lng+v])},clone:function(){return new ze(this.lat,this.lng,this.alt)}};function be(s,u,v){return s instanceof ze?s:w(s)&&typeof s[0]!="object"?s.length===3?new ze(s[0],s[1],s[2]):s.length===2?new ze(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new ze(s.lat,"lng"in s?s.lng:s.lon,s.alt):u===void 0?null:new ze(s,u,v)}var V={latLngToPoint:function(s,u){var v=this.projection.project(s),C=this.scale(u);return this.transformation._transform(v,C)},pointToLatLng:function(s,u){var v=this.scale(u),C=this.transformation.untransform(s,v);return this.projection.unproject(C)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var u=this.projection.bounds,v=this.scale(s),C=this.transformation.transform(u.min,v),R=this.transformation.transform(u.max,v);return new he(C,R)},infinite:!1,wrapLatLng:function(s){var u=this.wrapLng?f(s.lng,this.wrapLng,!0):s.lng,v=this.wrapLat?f(s.lat,this.wrapLat,!0):s.lat,C=s.alt;return new ze(v,u,C)},wrapLatLngBounds:function(s){var u=s.getCenter(),v=this.wrapLatLng(u),C=u.lat-v.lat,R=u.lng-v.lng;if(C===0&&R===0)return s;var W=s.getSouthWest(),ue=s.getNorthEast(),Te=new ze(W.lat-C,W.lng-R),Ne=new ze(ue.lat-C,ue.lng-R);return new Ee(Te,Ne)}},Y=o({},V,{wrapLng:[-180,180],R:6371e3,distance:function(s,u){var v=Math.PI/180,C=s.lat*v,R=u.lat*v,W=Math.sin((u.lat-s.lat)*v/2),ue=Math.sin((u.lng-s.lng)*v/2),Te=W*W+Math.cos(C)*Math.cos(R)*ue*ue,Ne=2*Math.atan2(Math.sqrt(Te),Math.sqrt(1-Te));return this.R*Ne}}),de=6378137,se={R:de,MAX_LATITUDE:85.0511287798,project:function(s){var u=Math.PI/180,v=this.MAX_LATITUDE,C=Math.max(Math.min(v,s.lat),-v),R=Math.sin(C*u);return new U(this.R*s.lng*u,this.R*Math.log((1+R)/(1-R))/2)},unproject:function(s){var u=180/Math.PI;return new ze((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*u,s.x*u/this.R)},bounds:(function(){var s=de*Math.PI;return new he([-s,-s],[s,s])})()};function Re(s,u,v,C){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=u,this._c=v,this._d=C}Re.prototype={transform:function(s,u){return this._transform(s.clone(),u)},_transform:function(s,u){return u=u||1,s.x=u*(this._a*s.x+this._b),s.y=u*(this._c*s.y+this._d),s},untransform:function(s,u){return u=u||1,new U((s.x/u-this._b)/this._a,(s.y/u-this._d)/this._c)}};function q(s,u,v,C){return new Re(s,u,v,C)}var Q=o({},Y,{code:"EPSG:3857",projection:se,transformation:(function(){var s=.5/(Math.PI*se.R);return q(s,.5,-s,.5)})()}),ee=o({},Q,{code:"EPSG:900913"});function _e(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Be(s,u){var v="",C,R,W,ue,Te,Ne;for(C=0,W=s.length;C<W;C++){for(Te=s[C],R=0,ue=Te.length;R<ue;R++)Ne=Te[R],v+=(R?"L":"M")+Ne.x+" "+Ne.y;v+=u?Qe.svg?"z":"x":""}return v||"M0 0"}var Ue=document.documentElement.style,Ae="ActiveXObject"in window,ne=Ae&&!document.addEventListener,ge="msLaunchUri"in navigator&&!("documentMode"in document),Oe=lt("webkit"),De=lt("android"),xe=lt("android 2")||lt("android 3"),me=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=De&&lt("Google")&&me<537&&!("AudioNode"in window),Ge=!!window.opera,fe=!ge&&lt("chrome"),ke=lt("gecko")&&!Oe&&!Ge&&!Ae,te=!fe&&lt("safari"),ye=lt("phantom"),He="OTransition"in Ue,rt=navigator.platform.indexOf("Win")===0,kt=Ae&&"transition"in Ue,Rt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,Lt="MozPerspective"in Ue,xt=!window.L_DISABLE_3D&&(kt||Rt||Lt)&&!He&&!ye,Kt=typeof orientation<"u"||lt("mobile"),no=Kt&&Oe,Mo=Kt&&Rt,ft=!window.PointerEvent&&window.MSPointerEvent,Ct=!!(window.PointerEvent||ft),Mt="ontouchstart"in window||!!window.TouchEvent,Mn=!window.L_NO_TOUCH&&(Mt||Ct),go=Kt&&Ge,oo=Kt&&ke,An=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,tn=(function(){var s=!1;try{var u=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,u),window.removeEventListener("testPassiveEventSupport",m,u)}catch{}return s})(),Pa=(function(){return!!document.createElement("canvas").getContext})(),yo=!!(document.createElementNS&&_e("svg").createSVGRect),Uo=!!yo&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),pe=!yo&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var u=s.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),ve=navigator.platform.indexOf("Mac")===0,Le=navigator.platform.indexOf("Linux")===0;function lt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Qe={ie:Ae,ielt9:ne,edge:ge,webkit:Oe,android:De,android23:xe,androidStock:Ze,opera:Ge,chrome:fe,gecko:ke,safari:te,phantom:ye,opera12:He,win:rt,ie3d:kt,webkit3d:Rt,gecko3d:Lt,any3d:xt,mobile:Kt,mobileWebkit:no,mobileWebkit3d:Mo,msPointer:ft,pointer:Ct,touch:Mn,touchNative:Mt,mobileOpera:go,mobileGecko:oo,retina:An,passiveEvents:tn,canvas:Pa,svg:yo,vml:pe,inlineSvg:Uo,mac:ve,linux:Le},Ot=Qe.msPointer?"MSPointerDown":"pointerdown",on=Qe.msPointer?"MSPointerMove":"pointermove",mn=Qe.msPointer?"MSPointerUp":"pointerup",gn=Qe.msPointer?"MSPointerCancel":"pointercancel",Vn={touchstart:Ot,touchmove:on,touchend:mn,touchcancel:gn},Za={touchstart:bo,touchmove:Vo,touchend:Vo,touchcancel:Vo},ko={},hl=!1;function fl(s,u,v){return u==="touchstart"&&Ts(),Za[u]?(v=Za[u].bind(this,v),s.addEventListener(Vn[u],v,!1),v):(console.warn("wrong event specified:",u),m)}function pl(s,u,v){if(!Vn[u]){console.warn("wrong event specified:",u);return}s.removeEventListener(Vn[u],v,!1)}function vi(s){ko[s.pointerId]=s}function zo(s){ko[s.pointerId]&&(ko[s.pointerId]=s)}function Ho(s){delete ko[s.pointerId]}function Ts(){hl||(document.addEventListener(Ot,vi,!0),document.addEventListener(on,zo,!0),document.addEventListener(mn,Ho,!0),document.addEventListener(gn,Ho,!0),hl=!0)}function Vo(s,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var v in ko)u.touches.push(ko[v]);u.changedTouches=[u],s(u)}}function bo(s,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&sn(u),Vo(s,u)}function mi(s){var u={},v,C;for(C in s)v=s[C],u[C]=v&&v.bind?v.bind(s):v;return s=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var En=200;function Ao(s,u){s.addEventListener("dblclick",u);var v=0,C;function R(W){if(W.detail!==1){C=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var ue=Lo(W);if(!(ue.some(function(Ne){return Ne instanceof HTMLLabelElement&&Ne.attributes.for})&&!ue.some(function(Ne){return Ne instanceof HTMLInputElement||Ne instanceof HTMLSelectElement}))){var Te=Date.now();Te-v<=En?(C++,C===2&&u(mi(W))):C=1,v=Te}}}return s.addEventListener("click",R),{dblclick:u,simDblclick:R}}function Ms(s,u){s.removeEventListener("dblclick",u.dblclick),s.removeEventListener("click",u.simDblclick)}var Ka=qo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ao=qo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),aa=ao==="webkitTransition"||ao==="OTransition"?ao+"End":"transitionend";function so(s){return typeof s=="string"?document.getElementById(s):s}function sa(s,u){var v=s.style[u]||s.currentStyle&&s.currentStyle[u];if((!v||v==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(s,null);v=C?C[u]:null}return v==="auto"?null:v}function vt(s,u,v){var C=document.createElement(s);return C.className=u||"",v&&v.appendChild(C),C}function Bt(s){var u=s.parentNode;u&&u.removeChild(s)}function Pn(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Sn(s){var u=s.parentNode;u&&u.lastChild!==s&&u.appendChild(s)}function io(s){var u=s.parentNode;u&&u.firstChild!==s&&u.insertBefore(s,u.firstChild)}function ia(s,u){if(s.classList!==void 0)return s.classList.contains(u);var v=wo(s);return v.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(v)}function dt(s,u){if(s.classList!==void 0)for(var v=_(u),C=0,R=v.length;C<R;C++)s.classList.add(v[C]);else if(!ia(s,u)){var W=wo(s);Eo(s,(W?W+" ":"")+u)}}function Yt(s,u){s.classList!==void 0?s.classList.remove(u):Eo(s,k((" "+wo(s)+" ").replace(" "+u+" "," ")))}function Eo(s,u){s.className.baseVal===void 0?s.className=u:s.className.baseVal=u}function wo(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function bn(s,u){"opacity"in s.style?s.style.opacity=u:"filter"in s.style&&Go(s,u)}function Go(s,u){var v=!1,C="DXImageTransform.Microsoft.Alpha";try{v=s.filters.item(C)}catch{if(u===1)return}u=Math.round(u*100),v?(v.Enabled=u!==100,v.Opacity=u):s.style.filter+=" progid:"+C+"(opacity="+u+")"}function qo(s){for(var u=document.documentElement.style,v=0;v<s.length;v++)if(s[v]in u)return s[v];return!1}function _o(s,u,v){var C=u||new U(0,0);s.style[Ka]=(Qe.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(v?" scale("+v+")":"")}function Jt(s,u){s._leaflet_pos=u,Qe.any3d?_o(s,u):(s.style.left=u.x+"px",s.style.top=u.y+"px")}function Gn(s){return s._leaflet_pos||new U(0,0)}var la,Ya,As;if("onselectstart"in document)la=function(){bt(window,"selectstart",sn)},Ya=function(){Ut(window,"selectstart",sn)};else{var Ja=qo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);la=function(){if(Ja){var s=document.documentElement.style;As=s[Ja],s[Ja]="none"}},Ya=function(){Ja&&(document.documentElement.style[Ja]=As,As=void 0)}}function Es(){bt(window,"dragstart",sn)}function gi(){Ut(window,"dragstart",sn)}var ra,Ps;function Xa(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Qa(),ra=s,Ps=s.style.outlineStyle,s.style.outlineStyle="none",bt(window,"keydown",Qa))}function Qa(){ra&&(ra.style.outlineStyle=Ps,ra=void 0,Ps=void 0,Ut(window,"keydown",Qa))}function vl(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function yi(s){var u=s.getBoundingClientRect();return{x:u.width/s.offsetWidth||1,y:u.height/s.offsetHeight||1,boundingClientRect:u}}var hr={__proto__:null,TRANSFORM:Ka,TRANSITION:ao,TRANSITION_END:aa,get:so,getStyle:sa,create:vt,remove:Bt,empty:Pn,toFront:Sn,toBack:io,hasClass:ia,addClass:dt,removeClass:Yt,setClass:Eo,getClass:wo,setOpacity:bn,testProp:qo,setTransform:_o,setPosition:Jt,getPosition:Gn,get disableTextSelection(){return la},get enableTextSelection(){return Ya},disableImageDrag:Es,enableImageDrag:gi,preventOutline:Xa,restoreOutline:Qa,getSizedParentNode:vl,getScale:yi};function bt(s,u,v,C){if(u&&typeof u=="object")for(var R in u)es(s,R,u[R],v);else{u=_(u);for(var W=0,ue=u.length;W<ue;W++)es(s,u[W],v,C)}return this}var Dt="_leaflet_events";function Ut(s,u,v,C){if(arguments.length===1)Co(s),delete s[Dt];else if(u&&typeof u=="object")for(var R in u)ki(s,R,u[R],v);else if(u=_(u),arguments.length===2)Co(s,function(Te){return I(u,Te)!==-1});else for(var W=0,ue=u.length;W<ue;W++)ki(s,u[W],v,C);return this}function Co(s,u){for(var v in s[Dt]){var C=v.split(/\d/)[0];(!u||u(C))&&ki(s,C,null,null,v)}}var Ds={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function es(s,u,v,C){var R=u+d(v)+(C?"_"+d(C):"");if(s[Dt]&&s[Dt][R])return this;var W=function(Te){return v.call(C||s,Te||window.event)},ue=W;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?W=fl(s,u,W):Qe.touch&&u==="dblclick"?W=Ao(s,W):"addEventListener"in s?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?s.addEventListener(Ds[u]||u,W,Qe.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(W=function(Te){Te=Te||window.event,Rs(s,Te)&&ue(Te)},s.addEventListener(Ds[u],W,!1)):s.addEventListener(u,ue,!1):s.attachEvent("on"+u,W),s[Dt]=s[Dt]||{},s[Dt][R]=W}function ki(s,u,v,C,R){R=R||u+d(v)+(C?"_"+d(C):"");var W=s[Dt]&&s[Dt][R];if(!W)return this;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?pl(s,u,W):Qe.touch&&u==="dblclick"?Ms(s,W):"removeEventListener"in s?s.removeEventListener(Ds[u]||u,W,!1):s.detachEvent("on"+u,W),s[Dt][R]=null}function ca(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function an(s){return es(s,"wheel",ca),this}function wn(s){return bt(s,"mousedown touchstart dblclick contextmenu",ca),s._leaflet_disable_click=!0,this}function sn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function lo(s){return sn(s),ca(s),this}function Lo(s){if(s.composedPath)return s.composedPath();for(var u=[],v=s.target;v;)u.push(v),v=v.parentNode;return u}function Da(s,u){if(!u)return new U(s.clientX,s.clientY);var v=yi(u),C=v.boundingClientRect;return new U((s.clientX-C.left)/v.x-u.clientLeft,(s.clientY-C.top)/v.y-u.clientTop)}var ts=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ra(s){return Qe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/ts:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Rs(s,u){var v=u.relatedTarget;if(!v)return!0;try{for(;v&&v!==s;)v=v.parentNode}catch{return!1}return v!==s}var ml={__proto__:null,on:bt,off:Ut,stopPropagation:ca,disableScrollPropagation:an,disableClickPropagation:wn,preventDefault:sn,stop:lo,getPropagationPath:Lo,getMousePosition:Da,getWheelDelta:Ra,isExternalTarget:Rs,addListener:bt,removeListener:Ut},bi=ie.extend({run:function(s,u,v,C){this.stop(),this._el=s,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=Gn(s),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(s){var u=+new Date-this._startTime,v=this._duration*1e3;u<v?this._runFrame(this._easeOut(u/v),s):(this._runFrame(1),this._complete())},_runFrame:function(s,u){var v=this._startPos.add(this._offset.multiplyBy(s));u&&v._round(),Jt(this._el,v),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),At=ie.extend({options:{crs:Q,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,u){u=x(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(be(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ao&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),bt(this._proxy,aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,u,v){if(u=u===void 0?this._zoom:this._limitZoom(u),s=this._limitCenter(be(s),u,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=o({animate:v.animate},v.zoom),v.pan=o({animate:v.animate,duration:v.duration},v.pan));var C=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,u,v.zoom):this._tryAnimatedPan(s,v.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(s,u,v.pan&&v.pan.noMoveStart),this},setZoom:function(s,u){return this._loaded?this.setView(this.getCenter(),s,{zoom:u}):(this._zoom=s,this)},zoomIn:function(s,u){return s=s||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,u)},zoomOut:function(s,u){return s=s||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,u)},setZoomAround:function(s,u,v){var C=this.getZoomScale(u),R=this.getSize().divideBy(2),W=s instanceof U?s:this.latLngToContainerPoint(s),ue=W.subtract(R).multiplyBy(1-1/C),Te=this.containerPointToLatLng(R.add(ue));return this.setView(Te,u,{zoom:v})},_getBoundsCenterZoom:function(s,u){u=u||{},s=s.getBounds?s.getBounds():Me(s);var v=ae(u.paddingTopLeft||u.padding||[0,0]),C=ae(u.paddingBottomRight||u.padding||[0,0]),R=this.getBoundsZoom(s,!1,v.add(C));if(R=typeof u.maxZoom=="number"?Math.min(u.maxZoom,R):R,R===1/0)return{center:s.getCenter(),zoom:R};var W=C.subtract(v).divideBy(2),ue=this.project(s.getSouthWest(),R),Te=this.project(s.getNorthEast(),R),Ne=this.unproject(ue.add(Te).divideBy(2).add(W),R);return{center:Ne,zoom:R}},fitBounds:function(s,u){if(s=Me(s),!s.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(s,u);return this.setView(v.center,v.zoom,u)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,u){return this.setView(s,this._zoom,{pan:u})},panBy:function(s,u){if(s=ae(s).round(),u=u||{},!s.x&&!s.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new bi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){dt(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,v,u.duration||.25,u.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,u,v){if(v=v||{},v.animate===!1||!Qe.any3d)return this.setView(s,u,v);this._stop();var C=this.project(this.getCenter()),R=this.project(s),W=this.getSize(),ue=this._zoom;s=be(s),u=u===void 0?ue:u;var Te=Math.max(W.x,W.y),Ne=Te*this.getZoomScale(ue,u),Xe=R.distanceTo(C)||1,it=1.42,pt=it*it;function Et(_n){var Ec=_n?-1:1,A1=_n?Ne:Te,E1=Ne*Ne-Te*Te+Ec*pt*pt*Xe*Xe,P1=2*A1*pt*Xe,yd=E1/P1,jf=Math.sqrt(yd*yd+1)-yd,D1=jf<1e-9?-18:Math.log(jf);return D1}function co(_n){return(Math.exp(_n)-Math.exp(-_n))/2}function Dn(_n){return(Math.exp(_n)+Math.exp(-_n))/2}function Yo(_n){return co(_n)/Dn(_n)}var So=Et(0);function Ol(_n){return Te*(Dn(So)/Dn(So+it*_n))}function x1(_n){return Te*(Dn(So)*Yo(So+it*_n)-co(So))/pt}function $1(_n){return 1-Math.pow(1-_n,1.5)}var T1=Date.now(),Gf=(Et(1)-So)/it,M1=v.duration?1e3*v.duration:1e3*Gf*.8;function qf(){var _n=(Date.now()-T1)/M1,Ec=$1(_n)*Gf;_n<=1?(this._flyToFrame=O(qf,this),this._move(this.unproject(C.add(R.subtract(C).multiplyBy(x1(Ec)/Xe)),ue),this.getScaleZoom(Te/Ol(Ec),ue),{flyTo:!0})):this._move(s,u)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),qf.call(this),this},flyToBounds:function(s,u){var v=this._getBoundsCenterZoom(s,u);return this.flyTo(v.center,v.zoom,u)},setMaxBounds:function(s){return s=Me(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var u=this.options.minZoom;return this.options.minZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var u=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,u){this._enforcingBounds=!0;var v=this.getCenter(),C=this._limitCenter(v,this._zoom,Me(s));return v.equals(C)||this.panTo(C,u),this._enforcingBounds=!1,this},panInside:function(s,u){u=u||{};var v=ae(u.paddingTopLeft||u.padding||[0,0]),C=ae(u.paddingBottomRight||u.padding||[0,0]),R=this.project(this.getCenter()),W=this.project(s),ue=this.getPixelBounds(),Te=$e([ue.min.add(v),ue.max.subtract(C)]),Ne=Te.getSize();if(!Te.contains(W)){this._enforcingBounds=!0;var Xe=W.subtract(Te.getCenter()),it=Te.extend(W).getSize().subtract(Ne);R.x+=Xe.x<0?-it.x:it.x,R.y+=Xe.y<0?-it.y:it.y,this.panTo(this.unproject(R),u),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=o({animate:!1,pan:!0},s===!0?{animate:!0}:s);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),C=u.divideBy(2).round(),R=v.divideBy(2).round(),W=C.subtract(R);return!W.x&&!W.y?this:(s.animate&&s.pan?this.panBy(W):(s.pan&&this._rawPanBy(W),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=o({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,v,s):navigator.geolocation.getCurrentPosition(u,v,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var u=s.code,v=s.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var u=s.coords.latitude,v=s.coords.longitude,C=new ze(u,v),R=C.toBounds(s.coords.accuracy*2),W=this._locateOptions;if(W.setView){var ue=this.getBoundsZoom(R);this.setView(C,W.maxZoom?Math.min(ue,W.maxZoom):ue)}var Te={latlng:C,bounds:R,timestamp:s.timestamp};for(var Ne in s.coords)typeof s.coords[Ne]=="number"&&(Te[Ne]=s.coords[Ne]);this.fire("locationfound",Te)}},addHandler:function(s,u){if(!u)return this;var v=this[s]=new u(this);return this._handlers.push(v),this.options[s]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Bt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Bt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,u){var v="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),C=vt("div",v,u||this._mapPane);return s&&(this._panes[s]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),u=this.unproject(s.getBottomLeft()),v=this.unproject(s.getTopRight());return new Ee(u,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,u,v){s=Me(s),v=ae(v||[0,0]);var C=this.getZoom()||0,R=this.getMinZoom(),W=this.getMaxZoom(),ue=s.getNorthWest(),Te=s.getSouthEast(),Ne=this.getSize().subtract(v),Xe=$e(this.project(Te,C),this.project(ue,C)).getSize(),it=Qe.any3d?this.options.zoomSnap:1,pt=Ne.x/Xe.x,Et=Ne.y/Xe.y,co=u?Math.max(pt,Et):Math.min(pt,Et);return C=this.getScaleZoom(co,C),it&&(C=Math.round(C/(it/100))*(it/100),C=u?Math.ceil(C/it)*it:Math.floor(C/it)*it),Math.max(R,Math.min(W,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,u){var v=this._getTopLeftPoint(s,u);return new he(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,u){var v=this.options.crs;return u=u===void 0?this._zoom:u,v.scale(s)/v.scale(u)},getScaleZoom:function(s,u){var v=this.options.crs;u=u===void 0?this._zoom:u;var C=v.zoom(s*v.scale(u));return isNaN(C)?1/0:C},project:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(be(s),u)},unproject:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(ae(s),u)},layerPointToLatLng:function(s){var u=ae(s).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(s){var u=this.project(be(s))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(be(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(Me(s))},distance:function(s,u){return this.options.crs.distance(be(s),be(u))},containerPointToLayerPoint:function(s){return ae(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ae(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var u=this.containerPointToLayerPoint(ae(s));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(be(s)))},mouseEventToContainerPoint:function(s){return Da(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var u=this._container=so(s);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");bt(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,dt(s,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=sa(s,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Jt(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dt(s.markerPane,"leaflet-zoom-hide"),dt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,u,v){Jt(this._mapPane,new U(0,0));var C=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var R=this._zoom!==u;this._moveStart(R,v)._move(s,u)._moveEnd(R),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(s,u){return s&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(s,u,v,C){u===void 0&&(u=this._zoom);var R=this._zoom!==u;return this._zoom=u,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),C?v&&v.pinch&&this.fire("zoom",v):((R||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Jt(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var u=s?Ut:bt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,u){for(var v=[],C,R=u==="mouseout"||u==="mouseover",W=s.target||s.srcElement,ue=!1;W;){if(C=this._targets[d(W)],C&&(u==="click"||u==="preclick")&&this._draggableMoved(C)){ue=!0;break}if(C&&C.listens(u,!0)&&(R&&!Rs(W,s)||(v.push(C),R))||W===this._container)break;W=W.parentNode}return!v.length&&!ue&&!R&&this.listens(u,!0)&&(v=[this]),v},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var u=s.target||s.srcElement;if(!(!this._loaded||u._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(u))){var v=s.type;v==="mousedown"&&Xa(u),this._fireDOMEvent(s,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,u,v){if(s.type==="click"){var C=o({},s);C.type="preclick",this._fireDOMEvent(C,C.type,v)}var R=this._findEventTargets(s,u);if(v){for(var W=[],ue=0;ue<v.length;ue++)v[ue].listens(u,!0)&&W.push(v[ue]);R=W.concat(R)}if(R.length){u==="contextmenu"&&sn(s);var Te=R[0],Ne={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Xe=Te.getLatLng&&(!Te._radius||Te._radius<=10);Ne.containerPoint=Xe?this.latLngToContainerPoint(Te.getLatLng()):this.mouseEventToContainerPoint(s),Ne.layerPoint=this.containerPointToLayerPoint(Ne.containerPoint),Ne.latlng=Xe?Te.getLatLng():this.layerPointToLatLng(Ne.layerPoint)}for(ue=0;ue<R.length;ue++)if(R[ue].fire(u,Ne,!0),Ne.originalEvent._stopped||R[ue].options.bubblingMouseEvents===!1&&I(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,u=this._handlers.length;s<u;s++)this._handlers[s].disable()},whenReady:function(s,u){return this._loaded?s.call(u||this,{target:this}):this.on("load",s,u),this},_getMapPanePos:function(){return Gn(this._mapPane)||new U(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,u){var v=s&&u!==void 0?this._getNewPixelOrigin(s,u):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,u){var v=this.getSize()._divideBy(2);return this.project(s,u)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,u,v){var C=this._getNewPixelOrigin(v,u);return this.project(s,u)._subtract(C)},_latLngBoundsToNewLayerBounds:function(s,u,v){var C=this._getNewPixelOrigin(v,u);return $e([this.project(s.getSouthWest(),u)._subtract(C),this.project(s.getNorthWest(),u)._subtract(C),this.project(s.getSouthEast(),u)._subtract(C),this.project(s.getNorthEast(),u)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,u,v){if(!v)return s;var C=this.project(s,u),R=this.getSize().divideBy(2),W=new he(C.subtract(R),C.add(R)),ue=this._getBoundsOffset(W,v,u);return Math.abs(ue.x)<=1&&Math.abs(ue.y)<=1?s:this.unproject(C.add(ue),u)},_limitOffset:function(s,u){if(!u)return s;var v=this.getPixelBounds(),C=new he(v.min.add(s),v.max.add(s));return s.add(this._getBoundsOffset(C,u))},_getBoundsOffset:function(s,u,v){var C=$e(this.project(u.getNorthEast(),v),this.project(u.getSouthWest(),v)),R=C.min.subtract(s.min),W=C.max.subtract(s.max),ue=this._rebound(R.x,-W.x),Te=this._rebound(R.y,-W.y);return new U(ue,Te)},_rebound:function(s,u){return s+u>0?Math.round(s-u)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(u))},_limitZoom:function(s){var u=this.getMinZoom(),v=this.getMaxZoom(),C=Qe.any3d?this.options.zoomSnap:1;return C&&(s=Math.round(s/C)*C),Math.max(u,Math.min(v,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Yt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,u){var v=this._getCenterOffset(s)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,u),!0)},_createAnimProxy:function(){var s=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(u){var v=Ka,C=this._proxy.style[v];_o(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),C===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Bt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),u=this.getZoom();_o(this._proxy,this.project(s,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,u,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(u),R=this._getCenterOffset(s)._divideBy(1-1/C);return v.animate!==!0&&!this.getSize().contains(R)?!1:(O(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(s,u,!0)},this),!0)},_animateZoom:function(s,u,v,C){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=u,dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:u,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Yt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function wi(s,u){return new At(s,u)}var In=J.extend({options:{position:"topright"},initialize:function(s){x(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var u=this._map;return u&&u.removeControl(this),this.options.position=s,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var u=this._container=this.onAdd(s),v=this.getPosition(),C=s._controlCorners[v];return dt(u,"leaflet-control"),v.indexOf("bottom")!==-1?C.insertBefore(u,C.firstChild):C.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Bt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),ns=function(s){return new In(s)};At.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},u="leaflet-",v=this._controlContainer=vt("div",u+"control-container",this._container);function C(R,W){var ue=u+R+" "+u+W;s[R+W]=vt("div",ue,v)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Bt(this._controlCorners[s]);Bt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var gl=In.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,u,v,C){return v<C?-1:C<v?1:0}},initialize:function(s,u,v){x(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in s)this._addLayer(s[C],C);for(C in u)this._addLayer(u[C],C,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return In.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,u){return this._addLayer(s,u),this._map?this._update():this},addOverlay:function(s,u){return this._addLayer(s,u,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(s));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Yt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Yt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",u=this._container=vt("div",s),v=this.options.collapsed;u.setAttribute("aria-haspopup",!0),wn(u),an(u);var C=this._section=vt("section",s+"-list");v&&(this._map.on("click",this.collapse,this),bt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var R=this._layersLink=vt("a",s+"-toggle",u);R.href="#",R.title="Layers",R.setAttribute("role","button"),bt(R,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){sn(W),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=vt("div",s+"-base",C),this._separator=vt("div",s+"-separator",C),this._overlaysList=vt("div",s+"-overlays",C),u.appendChild(C)},_getLayer:function(s){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===s)return this._layers[u]},_addLayer:function(s,u,v){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:u,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(C,R){return this.options.sortFunction(C.layer,R.layer,C.name,R.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Pn(this._baseLayersList),Pn(this._overlaysList),this._layerControlInputs=[];var s,u,v,C,R=0;for(v=0;v<this._layers.length;v++)C=this._layers[v],this._addItem(C),u=u||C.overlay,s=s||!C.overlay,R+=C.overlay?0:1;return this.options.hideSingleBase&&(s=s&&R>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=u&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var u=this._getLayer(d(s.target)),v=u.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;v&&this._map.fire(v,u)},_createRadioElement:function(s,u){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(u?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=v,C.firstChild},_addItem:function(s){var u=document.createElement("label"),v=this._map.hasLayer(s.layer),C;s.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=v):C=this._createRadioElement("leaflet-base-layers_"+d(this),v),this._layerControlInputs.push(C),C.layerId=d(s.layer),bt(C,"click",this._onInputClick,this);var R=document.createElement("span");R.innerHTML=" "+s.name;var W=document.createElement("span");u.appendChild(W),W.appendChild(C),W.appendChild(R);var ue=s.overlay?this._overlaysList:this._baseLayersList;return ue.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,u,v,C=[],R=[];this._handlingClick=!0;for(var W=s.length-1;W>=0;W--)u=s[W],v=this._getLayer(u.layerId).layer,u.checked?C.push(v):u.checked||R.push(v);for(W=0;W<R.length;W++)this._map.hasLayer(R[W])&&this._map.removeLayer(R[W]);for(W=0;W<C.length;W++)this._map.hasLayer(C[W])||this._map.addLayer(C[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,u,v,C=this._map.getZoom(),R=s.length-1;R>=0;R--)u=s[R],v=this._getLayer(u.layerId).layer,u.disabled=v.options.minZoom!==void 0&&C<v.options.minZoom||v.options.maxZoom!==void 0&&C>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,bt(s,"click",sn),this.expand();var u=this;setTimeout(function(){Ut(s,"click",sn),u._preventClick=!1})}}),ua=function(s,u,v){return new gl(s,u,v)},os=In.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var u="leaflet-control-zoom",v=vt("div",u+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,u+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,u+"-out",v,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,u,v,C,R){var W=vt("a",v,C);return W.innerHTML=s,W.href="#",W.title=u,W.setAttribute("role","button"),W.setAttribute("aria-label",u),wn(W),bt(W,"click",lo),bt(W,"click",R,this),bt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var s=this._map,u="leaflet-disabled";Yt(this._zoomInButton,u),Yt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(dt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(dt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});At.mergeOptions({zoomControl:!0}),At.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new os,this.addControl(this.zoomControl))});var fr=function(s){return new os(s)},yl=In.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var u="leaflet-control-scale",v=vt("div",u),C=this.options;return this._addScales(C,u+"-line",v),s.on(C.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),v},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,u,v){s.metric&&(this._mScale=vt("div",u,v)),s.imperial&&(this._iScale=vt("div",u,v))},_update:function(){var s=this._map,u=s.getSize().y/2,v=s.distance(s.containerPointToLatLng([0,u]),s.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(v)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var u=this._getRoundNum(s),v=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,v,u/s)},_updateImperial:function(s){var u=s*3.2808399,v,C,R;u>5280?(v=u/5280,C=this._getRoundNum(v),this._updateScale(this._iScale,C+" mi",C/v)):(R=this._getRoundNum(u),this._updateScale(this._iScale,R+" ft",R/u))},_updateScale:function(s,u,v){s.style.width=Math.round(this.options.maxWidth*v)+"px",s.innerHTML=u},_getRoundNum:function(s){var u=Math.pow(10,(Math.floor(s)+"").length-1),v=s/u;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,u*v}}),as=function(s){return new yl(s)},_i='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',jo=In.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?_i+" ":"")+"Leaflet</a>"},initialize:function(s){x(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),wn(this._container);for(var u in s._layers)s._layers[u].getAttribution&&this.addAttribution(s._layers[u].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var u in this._attributions)this._attributions[u]&&s.push(u);var v=[];this.options.prefix&&v.push(this.options.prefix),s.length&&v.push(s.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});At.mergeOptions({attributionControl:!0}),At.addInitHook(function(){this.options.attributionControl&&new jo().addTo(this)});var Ci=function(s){return new jo(s)};In.Layers=gl,In.Zoom=os,In.Scale=yl,In.Attribution=jo,ns.layers=ua,ns.zoom=fr,ns.scale=as,ns.attribution=Ci;var On=J.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});On.addTo=function(s,u){return s.addHandler(u,this),this};var kl={Events:K},Li=Qe.touch?"touchstart mousedown":"mousedown",Wo=ie.extend({options:{clickTolerance:3},initialize:function(s,u,v,C){x(this,C),this._element=s,this._dragStartTarget=u||s,this._preventOutline=v},enable:function(){this._enabled||(bt(this._dragStartTarget,Li,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Wo._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,Li,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ia(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Wo._dragging===this&&this.finishDrag();return}if(!(Wo._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Wo._dragging=this,this._preventOutline&&Xa(this._element),Es(),la(),!this._moving)){this.fire("down");var u=s.touches?s.touches[0]:s,v=vl(this._element);this._startPoint=new U(u.clientX,u.clientY),this._startPos=Gn(this._element),this._parentScale=yi(v);var C=s.type==="mousedown";bt(document,C?"mousemove":"touchmove",this._onMove,this),bt(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var u=s.touches&&s.touches.length===1?s.touches[0]:s,v=new U(u.clientX,u.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,sn(s),this._moved||(this.fire("dragstart"),this._moved=!0,dt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Jt(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Yt(document.body,"leaflet-dragging"),this._lastTarget&&(Yt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),gi(),Ya();var u=this._moved&&this._moving;this._moving=!1,Wo._dragging=!1,u&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function bl(s,u,v){var C,R=[1,4,2,8],W,ue,Te,Ne,Xe,it,pt,Et;for(W=0,it=s.length;W<it;W++)s[W]._code=da(s[W],u);for(Te=0;Te<4;Te++){for(pt=R[Te],C=[],W=0,it=s.length,ue=it-1;W<it;ue=W++)Ne=s[W],Xe=s[ue],Ne._code&pt?Xe._code&pt||(Et=Fs(Xe,Ne,pt,u,v),Et._code=da(Et,u),C.push(Et)):(Xe._code&pt&&(Et=Fs(Xe,Ne,pt,u,v),Et._code=da(Et,u),C.push(Et)),C.push(Ne));s=C}return s}function Si(s,u){var v,C,R,W,ue,Te,Ne,Xe,it;if(!s||s.length===0)throw new Error("latlngs not passed");Bn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var pt=be([0,0]),Et=Me(s),co=Et.getNorthWest().distanceTo(Et.getSouthWest())*Et.getNorthEast().distanceTo(Et.getNorthWest());co<1700&&(pt=ss(s));var Dn=s.length,Yo=[];for(v=0;v<Dn;v++){var So=be(s[v]);Yo.push(u.project(be([So.lat-pt.lat,So.lng-pt.lng])))}for(Te=Ne=Xe=0,v=0,C=Dn-1;v<Dn;C=v++)R=Yo[v],W=Yo[C],ue=R.y*W.x-W.y*R.x,Ne+=(R.x+W.x)*ue,Xe+=(R.y+W.y)*ue,Te+=ue*3;Te===0?it=Yo[0]:it=[Ne/Te,Xe/Te];var Ol=u.unproject(ae(it));return be([Ol.lat+pt.lat,Ol.lng+pt.lng])}function ss(s){for(var u=0,v=0,C=0,R=0;R<s.length;R++){var W=be(s[R]);u+=W.lat,v+=W.lng,C++}return be([u/C,v/C])}var Os={__proto__:null,clipPolygon:bl,polygonCenter:Si,centroid:ss};function Bs(s,u){if(!u||!s.length)return s.slice();var v=u*u;return s=xi(s,v),s=Cl(s,v),s}function wl(s,u,v){return Math.sqrt(Oa(s,u,v,!0))}function _l(s,u,v){return Oa(s,u,v)}function Cl(s,u){var v=s.length,C=typeof Uint8Array<"u"?Uint8Array:Array,R=new C(v);R[0]=R[v-1]=1,Ii(s,R,u,0,v-1);var W,ue=[];for(W=0;W<v;W++)R[W]&&ue.push(s[W]);return ue}function Ii(s,u,v,C,R){var W=0,ue,Te,Ne;for(Te=C+1;Te<=R-1;Te++)Ne=Oa(s[Te],s[C],s[R],!0),Ne>W&&(ue=Te,W=Ne);W>v&&(u[ue]=1,Ii(s,u,v,C,ue),Ii(s,u,v,ue,R))}function xi(s,u){for(var v=[s[0]],C=1,R=0,W=s.length;C<W;C++)pr(s[C],s[R])>u&&(v.push(s[C]),R=C);return R<W-1&&v.push(s[W-1]),v}var $i;function Ns(s,u,v,C,R){var W=C?$i:da(s,v),ue=da(u,v),Te,Ne,Xe;for($i=ue;;){if(!(W|ue))return[s,u];if(W&ue)return!1;Te=W||ue,Ne=Fs(s,u,Te,v,R),Xe=da(Ne,v),Te===W?(s=Ne,W=Xe):(u=Ne,ue=Xe)}}function Fs(s,u,v,C,R){var W=u.x-s.x,ue=u.y-s.y,Te=C.min,Ne=C.max,Xe,it;return v&8?(Xe=s.x+W*(Ne.y-s.y)/ue,it=Ne.y):v&4?(Xe=s.x+W*(Te.y-s.y)/ue,it=Te.y):v&2?(Xe=Ne.x,it=s.y+ue*(Ne.x-s.x)/W):v&1&&(Xe=Te.x,it=s.y+ue*(Te.x-s.x)/W),new U(Xe,it,R)}function da(s,u){var v=0;return s.x<u.min.x?v|=1:s.x>u.max.x&&(v|=2),s.y<u.min.y?v|=4:s.y>u.max.y&&(v|=8),v}function pr(s,u){var v=u.x-s.x,C=u.y-s.y;return v*v+C*C}function Oa(s,u,v,C){var R=u.x,W=u.y,ue=v.x-R,Te=v.y-W,Ne=ue*ue+Te*Te,Xe;return Ne>0&&(Xe=((s.x-R)*ue+(s.y-W)*Te)/Ne,Xe>1?(R=v.x,W=v.y):Xe>0&&(R+=ue*Xe,W+=Te*Xe)),ue=s.x-R,Te=s.y-W,C?ue*ue+Te*Te:new U(R,W)}function Bn(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function is(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Bn(s)}function Ti(s,u){var v,C,R,W,ue,Te,Ne,Xe;if(!s||s.length===0)throw new Error("latlngs not passed");Bn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var it=be([0,0]),pt=Me(s),Et=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());Et<1700&&(it=ss(s));var co=s.length,Dn=[];for(v=0;v<co;v++){var Yo=be(s[v]);Dn.push(u.project(be([Yo.lat-it.lat,Yo.lng-it.lng])))}for(v=0,C=0;v<co-1;v++)C+=Dn[v].distanceTo(Dn[v+1])/2;if(C===0)Xe=Dn[0];else for(v=0,W=0;v<co-1;v++)if(ue=Dn[v],Te=Dn[v+1],R=ue.distanceTo(Te),W+=R,W>C){Ne=(W-C)/R,Xe=[Te.x-Ne*(Te.x-ue.x),Te.y-Ne*(Te.y-ue.y)];break}var So=u.unproject(ae(Xe));return be([So.lat+it.lat,So.lng+it.lng])}var Se={__proto__:null,simplify:Bs,pointToSegmentDistance:wl,closestPointOnSegment:_l,clipSegment:Ns,_getEdgeIntersection:Fs,_getBitCode:da,_sqClosestPointOnSegment:Oa,isFlat:Bn,_flat:is,polylineCenter:Ti},Ce={project:function(s){return new U(s.lng,s.lat)},unproject:function(s){return new ze(s.y,s.x)},bounds:new he([-180,-90],[180,90])},nt={R:6378137,R_MINOR:6356752314245179e-9,bounds:new he([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var u=Math.PI/180,v=this.R,C=s.lat*u,R=this.R_MINOR/v,W=Math.sqrt(1-R*R),ue=W*Math.sin(C),Te=Math.tan(Math.PI/4-C/2)/Math.pow((1-ue)/(1+ue),W/2);return C=-v*Math.log(Math.max(Te,1e-10)),new U(s.lng*u*v,C)},unproject:function(s){for(var u=180/Math.PI,v=this.R,C=this.R_MINOR/v,R=Math.sqrt(1-C*C),W=Math.exp(-s.y/v),ue=Math.PI/2-2*Math.atan(W),Te=0,Ne=.1,Xe;Te<15&&Math.abs(Ne)>1e-7;Te++)Xe=R*Math.sin(ue),Xe=Math.pow((1-Xe)/(1+Xe),R/2),Ne=Math.PI/2-2*Math.atan(W*Xe)-ue,ue+=Ne;return new ze(ue*u,s.x*u/v)}},mt={__proto__:null,LonLat:Ce,Mercator:nt,SphericalMercator:se},$t=o({},Y,{code:"EPSG:3395",projection:nt,transformation:(function(){var s=.5/(Math.PI*nt.R);return q(s,.5,-s,.5)})()}),Ht=o({},Y,{code:"EPSG:4326",projection:Ce,transformation:q(1/180,1,-1/180,.5)}),Nn=o({},V,{projection:Ce,transformation:q(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,u){var v=u.lng-s.lng,C=u.lat-s.lat;return Math.sqrt(v*v+C*C)},infinite:!0});V.Earth=Y,V.EPSG3395=$t,V.EPSG3857=Q,V.EPSG900913=ee,V.EPSG4326=Ht,V.Simple=Nn;var Vt=ie.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var u=s.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var v=this.getEvents();u.on(v,this),this.once("remove",function(){u.off(v,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});At.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(s);return this._layers[u]?this:(this._layers[u]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var u=d(s);return this._layers[u]?(this._loaded&&s.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,u){for(var v in this._layers)s.call(u,this._layers[v]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var u=0,v=s.length;u<v;u++)this.addLayer(s[u])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var u=d(s);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,u=-1/0,v=this._getZoomSpan();for(var C in this._zoomBoundLayers){var R=this._zoomBoundLayers[C].options;s=R.minZoom===void 0?s:Math.min(s,R.minZoom),u=R.maxZoom===void 0?u:Math.max(u,R.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=s===1/0?void 0:s,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ln=Vt.extend({initialize:function(s,u){x(this,u),this._layers={};var v,C;if(s)for(v=0,C=s.length;v<C;v++)this.addLayer(s[v])},addLayer:function(s){var u=this.getLayerId(s);return this._layers[u]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var u=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(s){var u=typeof s=="number"?s:this.getLayerId(s);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var u=Array.prototype.slice.call(arguments,1),v,C;for(v in this._layers)C=this._layers[v],C[s]&&C[s].apply(C,u);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,u){for(var v in this._layers)s.call(u,this._layers[v]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),ro=function(s,u){return new ln(s,u)},wt=ln.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),ln.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),ln.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ee;for(var u in this._layers){var v=this._layers[u];s.extend(v.getBounds?v.getBounds():v.getLatLng())}return s}}),qn=function(s,u){return new wt(s,u)},Zo=J.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){x(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,u){var v=this._getIconUrl(s);if(!v){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(v,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(C,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(s,u){var v=this.options,C=v[u+"Size"];typeof C=="number"&&(C=[C,C]);var R=ae(C),W=ae(u==="shadow"&&v.shadowAnchor||v.iconAnchor||R&&R.divideBy(2,!0));s.className="leaflet-marker-"+u+" "+(v.className||""),W&&(s.style.marginLeft=-W.x+"px",s.style.marginTop=-W.y+"px"),R&&(s.style.width=R.x+"px",s.style.height=R.y+"px")},_createImg:function(s,u){return u=u||document.createElement("img"),u.src=s,u},_getIconUrl:function(s){return Qe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function vr(s){return new Zo(s)}var Mi=Zo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Mi.imagePath!="string"&&(Mi.imagePath=this._detectIconPath()),(this.options.imagePath||Mi.imagePath)+Zo.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var u=function(v,C,R){var W=C.exec(v);return W&&W[R]};return s=u(s,/^url\((['"])?(.+)\1\)$/,2),s&&u(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=vt("div","leaflet-default-icon-path",document.body),u=sa(s,"background-image")||sa(s,"backgroundImage");if(document.body.removeChild(s),u=this._stripUrl(u),u)return u;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),mr=On.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Wo(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Yt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var u=this._marker,v=u._map,C=this._marker.options.autoPanSpeed,R=this._marker.options.autoPanPadding,W=Gn(u._icon),ue=v.getPixelBounds(),Te=v.getPixelOrigin(),Ne=$e(ue.min._subtract(Te).add(R),ue.max._subtract(Te).subtract(R));if(!Ne.contains(W)){var Xe=ae((Math.max(Ne.max.x,W.x)-Ne.max.x)/(ue.max.x-Ne.max.x)-(Math.min(Ne.min.x,W.x)-Ne.min.x)/(ue.min.x-Ne.min.x),(Math.max(Ne.max.y,W.y)-Ne.max.y)/(ue.max.y-Ne.max.y)-(Math.min(Ne.min.y,W.y)-Ne.min.y)/(ue.min.y-Ne.min.y)).multiplyBy(C);v.panBy(Xe,{animate:!1}),this._draggable._newPos._add(Xe),this._draggable._startPos._add(Xe),Jt(u._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=O(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,s)))},_onDrag:function(s){var u=this._marker,v=u._shadow,C=Gn(u._icon),R=u._map.layerPointToLatLng(C);v&&Jt(v,C),u._latlng=R,s.latlng=R,s.oldLatLng=this._oldLatLng,u.fire("move",s).fire("drag",s)},_onDragEnd:function(s){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ll=Vt.extend({options:{icon:new Mi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,u){x(this,u),this._latlng=be(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var u=this._latlng;return this._latlng=be(s),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=s.icon.createIcon(this._icon),C=!1;v!==this._icon&&(this._icon&&this._removeIcon(),C=!0,s.title&&(v.title=s.title),v.tagName==="IMG"&&(v.alt=s.alt||"")),dt(v,u),s.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(v,"focus",this._panOnFocus,this);var R=s.icon.createShadow(this._shadow),W=!1;R!==this._shadow&&(this._removeShadow(),W=!0),R&&(dt(R,u),R.alt=""),this._shadow=R,s.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),R&&W&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Bt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Bt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Jt(this._icon,s),this._shadow&&Jt(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mr)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mr(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&bn(this._icon,s),this._shadow&&bn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var u=this.options.icon.options,v=u.iconSize?ae(u.iconSize):ae(0,0),C=u.iconAnchor?ae(u.iconAnchor):ae(0,0);s.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:v.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _c(s,u){return new Ll(s,u)}var Ba=Vt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return x(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ai=Ba.extend({options:{fill:!0,radius:10},initialize:function(s,u){x(this,u),this._latlng=be(s),this._radius=this.options.radius},setLatLng:function(s){var u=this._latlng;return this._latlng=be(s),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var u=s&&s.radius||this._radius;return Ba.prototype.setStyle.call(this,s),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,u=this._radiusY||s,v=this._clickTolerance(),C=[s+v,u+v];this._pxBounds=new he(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function rd(s,u){return new Ai(s,u)}var gr=Ai.extend({initialize:function(s,u,v){if(typeof u=="number"&&(u=o({},v,{radius:u})),x(this,u),this._latlng=be(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Ba.prototype.setStyle,_project:function(){var s=this._latlng.lng,u=this._latlng.lat,v=this._map,C=v.options.crs;if(C.distance===Y.distance){var R=Math.PI/180,W=this._mRadius/Y.R/R,ue=v.project([u+W,s]),Te=v.project([u-W,s]),Ne=ue.add(Te).divideBy(2),Xe=v.unproject(Ne).lat,it=Math.acos((Math.cos(W*R)-Math.sin(u*R)*Math.sin(Xe*R))/(Math.cos(u*R)*Math.cos(Xe*R)))/R;(isNaN(it)||it===0)&&(it=W/Math.cos(Math.PI/180*u)),this._point=Ne.subtract(v.getPixelOrigin()),this._radius=isNaN(it)?0:Ne.x-v.project([Xe,s-it]).x,this._radiusY=Ne.y-ue.y}else{var pt=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(pt).x}this._updateBounds()}});function cd(s,u,v){return new gr(s,u,v)}var ha=Ba.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,u){x(this,u),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var u=1/0,v=null,C=Oa,R,W,ue=0,Te=this._parts.length;ue<Te;ue++)for(var Ne=this._parts[ue],Xe=1,it=Ne.length;Xe<it;Xe++){R=Ne[Xe-1],W=Ne[Xe];var pt=C(s,R,W,!0);pt<u&&(u=pt,v=C(s,R,W))}return v&&(v.distance=Math.sqrt(u)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ti(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,u){return u=u||this._defaultShape(),s=be(s),u.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ee,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Bn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var u=[],v=Bn(s),C=0,R=s.length;C<R;C++)v?(u[C]=be(s[C]),this._bounds.extend(u[C])):u[C]=this._convertLatLngs(s[C]);return u},_project:function(){var s=new he;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),u=new U(s,s);this._rawPxBounds&&(this._pxBounds=new he([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(s,u,v){var C=s[0]instanceof ze,R=s.length,W,ue;if(C){for(ue=[],W=0;W<R;W++)ue[W]=this._map.latLngToLayerPoint(s[W]),v.extend(ue[W]);u.push(ue)}else for(W=0;W<R;W++)this._projectLatlngs(s[W],u,v)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,v,C,R,W,ue,Te,Ne;for(v=0,R=0,W=this._rings.length;v<W;v++)for(Ne=this._rings[v],C=0,ue=Ne.length;C<ue-1;C++)Te=Ns(Ne[C],Ne[C+1],s,C,!0),Te&&(u[R]=u[R]||[],u[R].push(Te[0]),(Te[1]!==Ne[C+1]||C===ue-2)&&(u[R].push(Te[1]),R++))}},_simplifyPoints:function(){for(var s=this._parts,u=this.options.smoothFactor,v=0,C=s.length;v<C;v++)s[v]=Bs(s[v],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,u){var v,C,R,W,ue,Te,Ne=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(v=0,W=this._parts.length;v<W;v++)for(Te=this._parts[v],C=0,ue=Te.length,R=ue-1;C<ue;R=C++)if(!(!u&&C===0)&&wl(s,Te[R],Te[C])<=Ne)return!0;return!1}});function ud(s,u){return new ha(s,u)}ha._flat=is;var Us=ha.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Si(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var u=ha.prototype._convertLatLngs.call(this,s),v=u.length;return v>=2&&u[0]instanceof ze&&u[0].equals(u[v-1])&&u.pop(),u},_setLatLngs:function(s){ha.prototype._setLatLngs.call(this,s),Bn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Bn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,u=this.options.weight,v=new U(u,u);if(s=new he(s.min.subtract(v),s.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,R=this._rings.length,W;C<R;C++)W=bl(this._rings[C],s,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var u=!1,v,C,R,W,ue,Te,Ne,Xe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(W=0,Ne=this._parts.length;W<Ne;W++)for(v=this._parts[W],ue=0,Xe=v.length,Te=Xe-1;ue<Xe;Te=ue++)C=v[ue],R=v[Te],C.y>s.y!=R.y>s.y&&s.x<(R.x-C.x)*(s.y-C.y)/(R.y-C.y)+C.x&&(u=!u);return u||ha.prototype._containsPoint.call(this,s,!0)}});function dd(s,u){return new Us(s,u)}var fa=wt.extend({initialize:function(s,u){x(this,u),this._layers={},s&&this.addData(s)},addData:function(s){var u=w(s)?s:s.features,v,C,R;if(u){for(v=0,C=u.length;v<C;v++)R=u[v],(R.geometries||R.geometry||R.features||R.coordinates)&&this.addData(R);return this}var W=this.options;if(W.filter&&!W.filter(s))return this;var ue=Sl(s,W);return ue?(ue.feature=$l(s),ue.defaultOptions=ue.options,this.resetStyle(ue),W.onEachFeature&&W.onEachFeature(s,ue),this.addLayer(ue)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=o({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(u){this._setLayerStyle(u,s)},this)},_setLayerStyle:function(s,u){s.setStyle&&(typeof u=="function"&&(u=u(s.feature)),s.setStyle(u))}});function Sl(s,u){var v=s.type==="Feature"?s.geometry:s,C=v?v.coordinates:null,R=[],W=u&&u.pointToLayer,ue=u&&u.coordsToLatLng||yr,Te,Ne,Xe,it;if(!C&&!v)return null;switch(v.type){case"Point":return Te=ue(C),Cc(W,s,Te,u);case"MultiPoint":for(Xe=0,it=C.length;Xe<it;Xe++)Te=ue(C[Xe]),R.push(Cc(W,s,Te,u));return new wt(R);case"LineString":case"MultiLineString":return Ne=Il(C,v.type==="LineString"?0:1,ue),new ha(Ne,u);case"Polygon":case"MultiPolygon":return Ne=Il(C,v.type==="Polygon"?1:2,ue),new Us(Ne,u);case"GeometryCollection":for(Xe=0,it=v.geometries.length;Xe<it;Xe++){var pt=Sl({geometry:v.geometries[Xe],type:"Feature",properties:s.properties},u);pt&&R.push(pt)}return new wt(R);case"FeatureCollection":for(Xe=0,it=v.features.length;Xe<it;Xe++){var Et=Sl(v.features[Xe],u);Et&&R.push(Et)}return new wt(R);default:throw new Error("Invalid GeoJSON object.")}}function Cc(s,u,v,C){return s?s(u,v):new Ll(v,C&&C.markersInheritOptions&&C)}function yr(s){return new ze(s[1],s[0],s[2])}function Il(s,u,v){for(var C=[],R=0,W=s.length,ue;R<W;R++)ue=u?Il(s[R],u-1,v):(v||yr)(s[R]),C.push(ue);return C}function zs(s,u){return s=be(s),s.alt!==void 0?[y(s.lng,u),y(s.lat,u),y(s.alt,u)]:[y(s.lng,u),y(s.lat,u)]}function xl(s,u,v,C){for(var R=[],W=0,ue=s.length;W<ue;W++)R.push(u?xl(s[W],Bn(s[W])?0:u-1,v,C):zs(s[W],C));return!u&&v&&R.length>0&&R.push(R[0].slice()),R}function pa(s,u){return s.feature?o({},s.feature,{geometry:u}):$l(u)}function $l(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Tl={toGeoJSON:function(s){return pa(this,{type:"Point",coordinates:zs(this.getLatLng(),s)})}};Ll.include(Tl),gr.include(Tl),Ai.include(Tl),ha.include({toGeoJSON:function(s){var u=!Bn(this._latlngs),v=xl(this._latlngs,u?1:0,!1,s);return pa(this,{type:(u?"Multi":"")+"LineString",coordinates:v})}}),Us.include({toGeoJSON:function(s){var u=!Bn(this._latlngs),v=u&&!Bn(this._latlngs[0]),C=xl(this._latlngs,v?2:u?1:0,!0,s);return u||(C=[C]),pa(this,{type:(v?"Multi":"")+"Polygon",coordinates:C})}}),ln.include({toMultiPoint:function(s){var u=[];return this.eachLayer(function(v){u.push(v.toGeoJSON(s).geometry.coordinates)}),pa(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(s){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(s);var v=u==="GeometryCollection",C=[];return this.eachLayer(function(R){if(R.toGeoJSON){var W=R.toGeoJSON(s);if(v)C.push(W.geometry);else{var ue=$l(W);ue.type==="FeatureCollection"?C.push.apply(C,ue.features):C.push(ue)}}}),v?pa(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function Ml(s,u){return new fa(s,u)}var kr=Ml,Al=Vt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,u,v){this._url=s,this._bounds=Me(u),x(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Bt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Sn(this._image),this},bringToBack:function(){return this._map&&io(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=Me(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",u=this._image=s?this._url:vt("img");if(dt(u,"leaflet-image-layer"),this._zoomAnimated&&dt(u,"leaflet-zoom-animated"),this.options.className&&dt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(s){var u=this._map.getZoomScale(s.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;_o(this._image,v,u)},_reset:function(){var s=this._image,u=new he(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=u.getSize();Jt(s,u.min),s.style.width=v.x+"px",s.style.height=v.y+"px"},_updateOpacity:function(){bn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),hd=function(s,u,v){return new Al(s,u,v)},Lc=Al.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",u=this._image=s?this._url:vt("video");if(dt(u,"leaflet-image-layer"),this._zoomAnimated&&dt(u,"leaflet-zoom-animated"),this.options.className&&dt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onloadeddata=l(this.fire,this,"load"),s){for(var v=u.getElementsByTagName("source"),C=[],R=0;R<v.length;R++)C.push(v[R].src);this._url=v.length>0?C:[u.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var ue=vt("source");ue.src=this._url[W],u.appendChild(ue)}}});function fd(s,u,v){return new Lc(s,u,v)}var Sc=Al.extend({_initImage:function(){var s=this._image=this._url;dt(s,"leaflet-image-layer"),this._zoomAnimated&&dt(s,"leaflet-zoom-animated"),this.options.className&&dt(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function pd(s,u,v){return new Sc(s,u,v)}var Ko=Vt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,u){s&&(s instanceof ze||w(s))?(this._latlng=be(s),x(this,u)):(x(this,s),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&bn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&bn(this._container,1),this.bringToFront(),this.options.interactive&&(dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(bn(this._container,0),this._removeTimeout=setTimeout(l(Bt,void 0,this._container),200)):Bt(this._container),this.options.interactive&&(Yt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=be(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Sn(this._container),this},bringToBack:function(){return this._map&&io(this._container),this},_prepareOpen:function(s){var u=this._source;if(!u._map)return!1;if(u instanceof wt){u=null;var v=this._source._layers;for(var C in v)if(v[C]._map){u=v[C];break}if(!u)return!1;this._source=u}if(!s)if(u.getCenter)s=u.getCenter();else if(u.getLatLng)s=u.getLatLng();else if(u.getBounds)s=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")s.innerHTML=u;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),u=ae(this.options.offset),v=this._getAnchor();this._zoomAnimated?Jt(this._container,s.add(v)):u=u.add(s).add(v);var C=this._containerBottom=-u.y,R=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=C+"px",this._container.style.left=R+"px"}},_getAnchor:function(){return[0,0]}});At.include({_initOverlay:function(s,u,v,C){var R=u;return R instanceof s||(R=new s(C).setContent(u)),v&&R.setLatLng(v),R}}),Vt.include({_initOverlay:function(s,u,v,C){var R=v;return R instanceof s?(x(R,C),R._source=this):(R=u&&!C?u:new s(C,this),R.setContent(v)),R}});var El=Ko.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Ko.prototype.openOn.call(this,s)},onAdd:function(s){Ko.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ba||this._source.on("preclick",ca))},onRemove:function(s){Ko.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ba||this._source.off("preclick",ca))},getEvents:function(){var s=Ko.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",u=this._container=vt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=vt("div",s+"-content-wrapper",u);if(this._contentNode=vt("div",s+"-content",v),wn(u),an(this._contentNode),bt(u,"contextmenu",ca),this._tipContainer=vt("div",s+"-tip-container",u),this._tip=vt("div",s+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=vt("a",s+"-close-button",u);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',bt(C,"click",function(R){sn(R),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,u=s.style;u.width="",u.whiteSpace="nowrap";var v=s.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),u.width=v+1+"px",u.whiteSpace="",u.height="";var C=s.offsetHeight,R=this.options.maxHeight,W="leaflet-popup-scrolled";R&&C>R?(u.height=R+"px",dt(s,W)):Yt(s,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),v=this._getAnchor();Jt(this._container,u.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,u=parseInt(sa(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+u,C=this._containerWidth,R=new U(this._containerLeft,-v-this._containerBottom);R._add(Gn(this._container));var W=s.layerPointToContainerPoint(R),ue=ae(this.options.autoPanPadding),Te=ae(this.options.autoPanPaddingTopLeft||ue),Ne=ae(this.options.autoPanPaddingBottomRight||ue),Xe=s.getSize(),it=0,pt=0;W.x+C+Ne.x>Xe.x&&(it=W.x+C-Xe.x+Ne.x),W.x-it-Te.x<0&&(it=W.x-Te.x),W.y+v+Ne.y>Xe.y&&(pt=W.y+v-Xe.y+Ne.y),W.y-pt-Te.y<0&&(pt=W.y-Te.y),(it||pt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([it,pt]))}},_getAnchor:function(){return ae(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),vd=function(s,u){return new El(s,u)};At.mergeOptions({closePopupOnClick:!0}),At.include({openPopup:function(s,u,v){return this._initOverlay(El,s,u,v).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Vt.include({bindPopup:function(s,u){return this._popup=this._initOverlay(El,this._popup,s,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof wt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){lo(s);var u=s.layer||s.target;if(this._popup._source===u&&!(u instanceof Ba)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=u,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Pl=Ko.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Ko.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Ko.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Ko.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",u=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var u,v,C=this._map,R=this._container,W=C.latLngToContainerPoint(C.getCenter()),ue=C.layerPointToContainerPoint(s),Te=this.options.direction,Ne=R.offsetWidth,Xe=R.offsetHeight,it=ae(this.options.offset),pt=this._getAnchor();Te==="top"?(u=Ne/2,v=Xe):Te==="bottom"?(u=Ne/2,v=0):Te==="center"?(u=Ne/2,v=Xe/2):Te==="right"?(u=0,v=Xe/2):Te==="left"?(u=Ne,v=Xe/2):ue.x<W.x?(Te="right",u=0,v=Xe/2):(Te="left",u=Ne+(it.x+pt.x)*2,v=Xe/2),s=s.subtract(ae(u,v,!0)).add(it).add(pt),Yt(R,"leaflet-tooltip-right"),Yt(R,"leaflet-tooltip-left"),Yt(R,"leaflet-tooltip-top"),Yt(R,"leaflet-tooltip-bottom"),dt(R,"leaflet-tooltip-"+Te),Jt(R,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&bn(this._container,s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(u)},_getAnchor:function(){return ae(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ic=function(s,u){return new Pl(s,u)};At.include({openTooltip:function(s,u,v){return this._initOverlay(Pl,s,u,v).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Vt.include({bindTooltip:function(s,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Pl,this._tooltip,s,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var u=s?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[u](v),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof wt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&(bt(u,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),bt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var u=s.latlng,v,C;this._tooltip.options.sticky&&s.originalEvent&&(v=this._map.mouseEventToContainerPoint(s.originalEvent),C=this._map.containerPointToLayerPoint(v),u=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(u)}});var xc=Zo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var u=s&&s.tagName==="DIV"?s:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Pn(u),u.appendChild(v.html)):u.innerHTML=v.html!==!1?v.html:"",v.bgPos){var C=ae(v.bgPos);u.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function $c(s){return new xc(s)}Zo.Default=Mi;var Ei=Vt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){x(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Bt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Sn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(io(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof U?s:new U(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var u=this.getPane().children,v=-s(-1/0,1/0),C=0,R=u.length,W;C<R;C++)W=u[C].style.zIndex,u[C]!==this._container&&W&&(v=s(v,+W));isFinite(v)&&(this.options.zIndex=v+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){bn(this._container,this.options.opacity);var s=+new Date,u=!1,v=!1;for(var C in this._tiles){var R=this._tiles[C];if(!(!R.current||!R.loaded)){var W=Math.min(1,(s-R.loaded)/200);bn(R.el,W),W<1?u=!0:(R.active?v=!0:this._onOpaqueTile(R),R.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),u&&(j(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,u=this.options.maxZoom;if(s!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===s?(this._levels[v].el.style.zIndex=u-Math.abs(s-v),this._onUpdateLevel(v)):(Bt(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var C=this._levels[s],R=this._map;return C||(C=this._levels[s]={},C.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=u,C.origin=R.project(R.unproject(R.getPixelOrigin()),s).round(),C.zoom=s,this._setZoomTransform(C,R.getCenter(),R.getZoom()),m(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,u,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)u=this._tiles[s],u.retain=u.current;for(s in this._tiles)if(u=this._tiles[s],u.current&&!u.active){var C=u.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var u in this._tiles)this._tiles[u].coords.z===s&&this._removeTile(u)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Bt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,u,v,C){var R=Math.floor(s/2),W=Math.floor(u/2),ue=v-1,Te=new U(+R,+W);Te.z=+ue;var Ne=this._tileCoordsToKey(Te),Xe=this._tiles[Ne];return Xe&&Xe.active?(Xe.retain=!0,!0):(Xe&&Xe.loaded&&(Xe.retain=!0),ue>C?this._retainParent(R,W,ue,C):!1)},_retainChildren:function(s,u,v,C){for(var R=2*s;R<2*s+2;R++)for(var W=2*u;W<2*u+2;W++){var ue=new U(R,W);ue.z=v+1;var Te=this._tileCoordsToKey(ue),Ne=this._tiles[Te];if(Ne&&Ne.active){Ne.retain=!0;continue}else Ne&&Ne.loaded&&(Ne.retain=!0);v+1<C&&this._retainChildren(R,W,v+1,C)}},_resetView:function(s){var u=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var u=this.options;return u.minNativeZoom!==void 0&&s<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<s?u.maxNativeZoom:s},_setView:function(s,u,v,C){var R=Math.round(u);this.options.maxZoom!==void 0&&R>this.options.maxZoom||this.options.minZoom!==void 0&&R<this.options.minZoom?R=void 0:R=this._clampZoom(R);var W=this.options.updateWhenZooming&&R!==this._tileZoom;(!C||W)&&(this._tileZoom=R,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),R!==void 0&&this._update(s),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(s,u)},_setZoomTransforms:function(s,u){for(var v in this._levels)this._setZoomTransform(this._levels[v],s,u)},_setZoomTransform:function(s,u,v){var C=this._map.getZoomScale(v,s.zoom),R=s.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(u,v)).round();Qe.any3d?_o(s.el,R,C):Jt(s.el,R)},_resetGrid:function(){var s=this._map,u=s.options.crs,v=this._tileSize=this.getTileSize(),C=this._tileZoom,R=this._map.getPixelWorldBounds(this._tileZoom);R&&(this._globalTileRange=this._pxBoundsToTileRange(R)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,u.wrapLng[0]],C).x/v.x),Math.ceil(s.project([0,u.wrapLng[1]],C).x/v.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([u.wrapLat[0],0],C).y/v.x),Math.ceil(s.project([u.wrapLat[1],0],C).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var u=this._map,v=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),C=u.getZoomScale(v,this._tileZoom),R=u.project(s,this._tileZoom).floor(),W=u.getSize().divideBy(C*2);return new he(R.subtract(W),R.add(W))},_update:function(s){var u=this._map;if(u){var v=this._clampZoom(u.getZoom());if(s===void 0&&(s=u.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(s),R=this._pxBoundsToTileRange(C),W=R.getCenter(),ue=[],Te=this.options.keepBuffer,Ne=new he(R.getBottomLeft().subtract([Te,-Te]),R.getTopRight().add([Te,-Te]));if(!(isFinite(R.min.x)&&isFinite(R.min.y)&&isFinite(R.max.x)&&isFinite(R.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Xe in this._tiles){var it=this._tiles[Xe].coords;(it.z!==this._tileZoom||!Ne.contains(new U(it.x,it.y)))&&(this._tiles[Xe].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(s,v);return}for(var pt=R.min.y;pt<=R.max.y;pt++)for(var Et=R.min.x;Et<=R.max.x;Et++){var co=new U(Et,pt);if(co.z=this._tileZoom,!!this._isValidTile(co)){var Dn=this._tiles[this._tileCoordsToKey(co)];Dn?Dn.current=!0:ue.push(co)}}if(ue.sort(function(So,Ol){return So.distanceTo(W)-Ol.distanceTo(W)}),ue.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Yo=document.createDocumentFragment();for(Et=0;Et<ue.length;Et++)this._addTile(ue[Et],Yo);this._level.el.appendChild(Yo)}}}},_isValidTile:function(s){var u=this._map.options.crs;if(!u.infinite){var v=this._globalTileRange;if(!u.wrapLng&&(s.x<v.min.x||s.x>v.max.x)||!u.wrapLat&&(s.y<v.min.y||s.y>v.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(s);return Me(this.options.bounds).overlaps(C)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var u=this._map,v=this.getTileSize(),C=s.scaleBy(v),R=C.add(v),W=u.unproject(C,s.z),ue=u.unproject(R,s.z);return[W,ue]},_tileCoordsToBounds:function(s){var u=this._tileCoordsToNwSe(s),v=new Ee(u[0],u[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var u=s.split(":"),v=new U(+u[0],+u[1]);return v.z=+u[2],v},_removeTile:function(s){var u=this._tiles[s];u&&(Bt(u.el),delete this._tiles[s],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){dt(s,"leaflet-tile");var u=this.getTileSize();s.style.width=u.x+"px",s.style.height=u.y+"px",s.onselectstart=m,s.onmousemove=m,Qe.ielt9&&this.options.opacity<1&&bn(s,this.options.opacity)},_addTile:function(s,u){var v=this._getTilePos(s),C=this._tileCoordsToKey(s),R=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(R),this.createTile.length<2&&O(l(this._tileReady,this,s,null,R)),Jt(R,v),this._tiles[C]={el:R,coords:s,current:!0},u.appendChild(R),this.fire("tileloadstart",{tile:R,coords:s})},_tileReady:function(s,u,v){u&&this.fire("tileerror",{error:u,tile:v,coords:s});var C=this._tileCoordsToKey(s);v=this._tiles[C],v&&(v.loaded=+new Date,this._map._fadeAnimated?(bn(v.el,0),j(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),u||(dt(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var u=new U(this._wrapX?f(s.x,this._wrapX):s.x,this._wrapY?f(s.y,this._wrapY):s.y);return u.z=s.z,u},_pxBoundsToTileRange:function(s){var u=this.getTileSize();return new he(s.min.unscaleBy(u).floor(),s.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function md(s){return new Ei(s)}var Hs=Ei.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,u){this._url=s,u=x(this,u),u.detectRetina&&Qe.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,u){return this._url===s&&u===void 0&&(u=!0),this._url=s,u||this.redraw(),this},createTile:function(s,u){var v=document.createElement("img");return bt(v,"load",l(this._tileOnLoad,this,u,v)),bt(v,"error",l(this._tileOnError,this,u,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(s),v},getTileUrl:function(s){var u={r:Qe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-s.y;this.options.tms&&(u.y=v),u["-y"]=v}return S(this._url,o(u,this.options))},_tileOnLoad:function(s,u){Qe.ielt9?setTimeout(l(s,this,null,u),0):s(null,u)},_tileOnError:function(s,u,v){var C=this.options.errorTileUrl;C&&u.getAttribute("src")!==C&&(u.src=C),s(v,u)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,u=this.options.maxZoom,v=this.options.zoomReverse,C=this.options.zoomOffset;return v&&(s=u-s),s+C},_getSubdomain:function(s){var u=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var s,u;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(u=this._tiles[s].el,u.onload=m,u.onerror=m,!u.complete)){u.src=T;var v=this._tiles[s].coords;Bt(u),delete this._tiles[s],this.fire("tileabort",{tile:u,coords:v})}},_removeTile:function(s){var u=this._tiles[s];if(u)return u.el.setAttribute("src",T),Ei.prototype._removeTile.call(this,s)},_tileReady:function(s,u,v){if(!(!this._map||v&&v.getAttribute("src")===T))return Ei.prototype._tileReady.call(this,s,u,v)}});function Dl(s,u){return new Hs(s,u)}var Tc=Hs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,u){this._url=s;var v=o({},this.defaultWmsParams);for(var C in u)C in this.options||(v[C]=u[C]);u=x(this,u);var R=u.detectRetina&&Qe.retina?2:1,W=this.getTileSize();v.width=W.x*R,v.height=W.y*R,this.wmsParams=v},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Hs.prototype.onAdd.call(this,s)},getTileUrl:function(s){var u=this._tileCoordsToNwSe(s),v=this._crs,C=$e(v.project(u[0]),v.project(u[1])),R=C.min,W=C.max,ue=(this._wmsVersion>=1.3&&this._crs===Ht?[R.y,R.x,W.y,W.x]:[R.x,R.y,W.x,W.y]).join(","),Te=Hs.prototype.getTileUrl.call(this,s);return Te+D(this.wmsParams,Te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ue},setParams:function(s,u){return o(this.wmsParams,s),u||this.redraw(),this}});function gd(s,u){return new Tc(s,u)}Hs.WMS=Tc,Dl.wms=gd;var va=Vt.extend({options:{padding:.1},initialize:function(s){x(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,u){var v=this._map.getZoomScale(u,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),R=this._map.project(this._center,u),W=C.multiplyBy(-v).add(R).subtract(this._map._getNewPixelOrigin(s,u));Qe.any3d?_o(this._container,W,v):Jt(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,u=this._map.getSize(),v=this._map.containerPointToLayerPoint(u.multiplyBy(-s)).round();this._bounds=new he(v,v.add(u.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),br=va.extend({options:{tolerance:0},getEvents:function(){var s=va.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){va.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");bt(s,"mousemove",this._onMouseMove,this),bt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),bt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Bt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var u in this._layers)s=this._layers[u],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){va.prototype._update.call(this);var s=this._bounds,u=this._container,v=s.getSize(),C=Qe.retina?2:1;Jt(u,s.min),u.width=C*v.x,u.height=C*v.y,u.style.width=v.x+"px",u.style.height=v.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){va.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var u=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var u=s._order,v=u.next,C=u.prev;v?v.prev=C:this._drawLast=C,C?C.next=v:this._drawFirst=v,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var u=s.options.dashArray.split(/[, ]+/),v=[],C,R;for(R=0;R<u.length;R++){if(C=Number(u[R]),isNaN(C))return;v.push(C)}s.options._dashArray=v}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var u=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new he,this._redrawBounds.extend(s._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(s._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var u=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,u=this._redrawBounds;if(this._ctx.save(),u){var v=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)s=C.layer,(!u||s._pxBounds&&s._pxBounds.intersects(u))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,u){if(this._drawing){var v,C,R,W,ue=s._parts,Te=ue.length,Ne=this._ctx;if(Te){for(Ne.beginPath(),v=0;v<Te;v++){for(C=0,R=ue[v].length;C<R;C++)W=ue[v][C],Ne[C?"lineTo":"moveTo"](W.x,W.y);u&&Ne.closePath()}this._fillStroke(Ne,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var u=s._point,v=this._ctx,C=Math.max(Math.round(s._radius),1),R=(Math.max(Math.round(s._radiusY),1)||C)/C;R!==1&&(v.save(),v.scale(1,R)),v.beginPath(),v.arc(u.x,u.y/R,C,0,Math.PI*2,!1),R!==1&&v.restore(),this._fillStroke(v,s)}},_fillStroke:function(s,u){var v=u.options;v.fill&&(s.globalAlpha=v.fillOpacity,s.fillStyle=v.fillColor||v.color,s.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(s.setLineDash&&s.setLineDash(u.options&&u.options._dashArray||[]),s.globalAlpha=v.opacity,s.lineWidth=v.weight,s.strokeStyle=v.color,s.lineCap=v.lineCap,s.lineJoin=v.lineJoin,s.stroke())},_onClick:function(s){for(var u=this._map.mouseEventToLayerPoint(s),v,C,R=this._drawFirst;R;R=R.next)v=R.layer,v.options.interactive&&v._containsPoint(u)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(v))&&(C=v);this._fireEvent(C?[C]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,u)}},_handleMouseOut:function(s){var u=this._hoveredLayer;u&&(Yt(this._container,"leaflet-interactive"),this._fireEvent([u],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,u){if(!this._mouseHoverThrottled){for(var v,C,R=this._drawFirst;R;R=R.next)v=R.layer,v.options.interactive&&v._containsPoint(u)&&(C=v);C!==this._hoveredLayer&&(this._handleMouseOut(s),C&&(dt(this._container,"leaflet-interactive"),this._fireEvent([C],s,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,u,v){this._map._fireDOMEvent(u,v||u.type,s)},_bringToFront:function(s){var u=s._order;if(u){var v=u.next,C=u.prev;if(v)v.prev=C;else return;C?C.next=v:v&&(this._drawFirst=v),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(s)}},_bringToBack:function(s){var u=s._order;if(u){var v=u.next,C=u.prev;if(C)C.next=v;else return;v?v.prev=C:C&&(this._drawLast=C),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(s)}}});function Mc(s){return Qe.canvas?new br(s):null}var ma=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ac={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(va.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var u=s._container=ma("shape");dt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",s._path=ma("path"),u.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var u=s._container;this._container.appendChild(u),s.options.interactive&&s.addInteractiveTarget(u)},_removePath:function(s){var u=s._container;Bt(u),s.removeInteractiveTarget(u),delete this._layers[d(s)]},_updateStyle:function(s){var u=s._stroke,v=s._fill,C=s.options,R=s._container;R.stroked=!!C.stroke,R.filled=!!C.fill,C.stroke?(u||(u=s._stroke=ma("stroke")),R.appendChild(u),u.weight=C.weight+"px",u.color=C.color,u.opacity=C.opacity,C.dashArray?u.dashStyle=w(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=C.lineCap.replace("butt","flat"),u.joinstyle=C.lineJoin):u&&(R.removeChild(u),s._stroke=null),C.fill?(v||(v=s._fill=ma("fill")),R.appendChild(v),v.color=C.fillColor||C.color,v.opacity=C.fillOpacity):v&&(R.removeChild(v),s._fill=null)},_updateCircle:function(s){var u=s._point.round(),v=Math.round(s._radius),C=Math.round(s._radiusY||v);this._setPath(s,s._empty()?"M0 0":"AL "+u.x+","+u.y+" "+v+","+C+" 0,"+65535*360)},_setPath:function(s,u){s._path.v=u},_bringToFront:function(s){Sn(s._container)},_bringToBack:function(s){io(s._container)}},Pi=Qe.vml?ma:_e,Vs=va.extend({_initContainer:function(){this._container=Pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Bt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){va.prototype._update.call(this);var s=this._bounds,u=s.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,v.setAttribute("width",u.x),v.setAttribute("height",u.y)),Jt(v,s.min),v.setAttribute("viewBox",[s.min.x,s.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(s){var u=s._path=Pi("path");s.options.className&&dt(u,s.options.className),s.options.interactive&&dt(u,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Bt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var u=s._path,v=s.options;u&&(v.stroke?(u.setAttribute("stroke",v.color),u.setAttribute("stroke-opacity",v.opacity),u.setAttribute("stroke-width",v.weight),u.setAttribute("stroke-linecap",v.lineCap),u.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?u.setAttribute("stroke-dasharray",v.dashArray):u.removeAttribute("stroke-dasharray"),v.dashOffset?u.setAttribute("stroke-dashoffset",v.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),v.fill?(u.setAttribute("fill",v.fillColor||v.color),u.setAttribute("fill-opacity",v.fillOpacity),u.setAttribute("fill-rule",v.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(s,u){this._setPath(s,Be(s._parts,u))},_updateCircle:function(s){var u=s._point,v=Math.max(Math.round(s._radius),1),C=Math.max(Math.round(s._radiusY),1)||v,R="a"+v+","+C+" 0 1,0 ",W=s._empty()?"M0 0":"M"+(u.x-v)+","+u.y+R+v*2+",0 "+R+-v*2+",0 ";this._setPath(s,W)},_setPath:function(s,u){s._path.setAttribute("d",u)},_bringToFront:function(s){Sn(s._path)},_bringToBack:function(s){io(s._path)}});Qe.vml&&Vs.include(Ac);function G(s){return Qe.svg||Qe.vml?new Vs(s):null}At.include({getRenderer:function(s){var u=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var u=this._paneRenderers[s];return u===void 0&&(u=this._createRenderer({pane:s}),this._paneRenderers[s]=u),u},_createRenderer:function(s){return this.options.preferCanvas&&Mc(s)||G(s)}});var oe=Us.extend({initialize:function(s,u){Us.prototype.initialize.call(this,this._boundsToLatLngs(s),u)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=Me(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function ce(s,u){return new oe(s,u)}Vs.create=Pi,Vs.pointsToPath=Be,fa.geometryToLayer=Sl,fa.coordsToLatLng=yr,fa.coordsToLatLngs=Il,fa.latLngToCoords=zs,fa.latLngsToCoords=xl,fa.getFeature=pa,fa.asFeature=$l,At.mergeOptions({boxZoom:!0});var we=On.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Bt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),la(),Es(),this._startPoint=this._map.mouseEventToContainerPoint(s),bt(document,{contextmenu:lo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var u=new he(this._point,this._startPoint),v=u.getSize();Jt(this._box,u.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Bt(this._box),Yt(this._container,"leaflet-crosshair")),Ya(),gi(),Ut(document,{contextmenu:lo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});At.addInitHook("addHandler","boxZoom",we),At.mergeOptions({doubleClickZoom:!0});var st=On.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var u=this._map,v=u.getZoom(),C=u.options.zoomDelta,R=s.originalEvent.shiftKey?v-C:v+C;u.options.doubleClickZoom==="center"?u.setZoom(R):u.setZoomAround(s.containerPoint,R)}});At.addInitHook("addHandler","doubleClickZoom",st),At.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Tt=On.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Wo(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Yt(this._map._container,"leaflet-grab"),Yt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=Me(this._map.options.maxBounds);this._offsetLimit=$e(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var u=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(u),this._prunePositions(u)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,u){return s-(s-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;s.x<u.min.x&&(s.x=this._viscousLimit(s.x,u.min.x)),s.y<u.min.y&&(s.y=this._viscousLimit(s.y,u.min.y)),s.x>u.max.x&&(s.x=this._viscousLimit(s.x,u.max.x)),s.y>u.max.y&&(s.y=this._viscousLimit(s.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,u=Math.round(s/2),v=this._initialWorldOffset,C=this._draggable._newPos.x,R=(C-u+v)%s+u-v,W=(C+u+v)%s-u-v,ue=Math.abs(R+v)<Math.abs(W+v)?R:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ue},_onDragEnd:function(s){var u=this._map,v=u.options,C=!v.inertia||s.noInertia||this._times.length<2;if(u.fire("dragend",s),C)u.fire("moveend");else{this._prunePositions(+new Date);var R=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,ue=v.easeLinearity,Te=R.multiplyBy(ue/W),Ne=Te.distanceTo([0,0]),Xe=Math.min(v.inertiaMaxSpeed,Ne),it=Te.multiplyBy(Xe/Ne),pt=Xe/(v.inertiaDeceleration*ue),Et=it.multiplyBy(-pt/2).round();!Et.x&&!Et.y?u.fire("moveend"):(Et=u._limitOffset(Et,u.options.maxBounds),O(function(){u.panBy(Et,{duration:pt,easeLinearity:ue,noMoveStart:!0,animate:!0})}))}}});At.addInitHook("addHandler","dragging",Tt),At.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Gt=On.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),bt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,u=document.documentElement,v=s.scrollTop||u.scrollTop,C=s.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(C,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var u=this._panKeys={},v=this.keyCodes,C,R;for(C=0,R=v.left.length;C<R;C++)u[v.left[C]]=[-1*s,0];for(C=0,R=v.right.length;C<R;C++)u[v.right[C]]=[s,0];for(C=0,R=v.down.length;C<R;C++)u[v.down[C]]=[0,s];for(C=0,R=v.up.length;C<R;C++)u[v.up[C]]=[0,-1*s]},_setZoomDelta:function(s){var u=this._zoomKeys={},v=this.keyCodes,C,R;for(C=0,R=v.zoomIn.length;C<R;C++)u[v.zoomIn[C]]=s;for(C=0,R=v.zoomOut.length;C<R;C++)u[v.zoomOut[C]]=-s},_addHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var u=s.keyCode,v=this._map,C;if(u in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(C=this._panKeys[u],s.shiftKey&&(C=ae(C).multiplyBy(3)),v.options.maxBounds&&(C=v._limitOffset(ae(C),v.options.maxBounds)),v.options.worldCopyJump){var R=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(C)));v.panTo(R)}else v.panBy(C)}else if(u in this._zoomKeys)v.setZoom(v.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;lo(s)}}});At.addInitHook("addHandler","keyboard",Gt),At.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var xn=On.extend({addHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var u=Ra(s),v=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var C=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),C),lo(s)},_performZoom:function(){var s=this._map,u=s.getZoom(),v=this._map.options.zoomSnap||0;s._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),R=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,W=v?Math.ceil(R/v)*v:R,ue=s._limitZoom(u+(this._delta>0?W:-W))-u;this._delta=0,this._startTime=null,ue&&(s.options.scrollWheelZoom==="center"?s.setZoom(u+ue):s.setZoomAround(this._lastMousePos,u+ue))}});At.addInitHook("addHandler","scrollWheelZoom",xn);var Di=600;At.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var Ri=On.extend({addHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var u=s.touches[0];this._startPos=this._newPos=new U(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(bt(document,"touchend",sn),bt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Di),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Ut(document,"touchend",sn),Ut(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(s){var u=s.touches[0];this._newPos=new U(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,u){var v=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});v._simulated=!0,u.target.dispatchEvent(v)}});At.addInitHook("addHandler","tapHold",Ri),At.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var Rl=On.extend({addHooks:function(){dt(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Yt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var u=this._map;if(!(!s.touches||s.touches.length!==2||u._animatingZoom||this._zooming)){var v=u.mouseEventToContainerPoint(s.touches[0]),C=u.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(v.add(C)._divideBy(2))),this._startDist=v.distanceTo(C),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),sn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var u=this._map,v=u.mouseEventToContainerPoint(s.touches[0]),C=u.mouseEventToContainerPoint(s.touches[1]),R=v.distanceTo(C)/this._startDist;if(this._zoom=u.getScaleZoom(R,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&R<1||this._zoom>u.getMaxZoom()&&R>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,R===1)return}else{var W=v._add(C)._divideBy(2)._subtract(this._centerPoint);if(R===1&&W.x===0&&W.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var ue=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(ue,this,!0),sn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});At.addInitHook("addHandler","touchZoom",Rl),At.BoxZoom=we,At.DoubleClickZoom=st,At.Drag=Tt,At.Keyboard=Gt,At.ScrollWheelZoom=xn,At.TapHold=Ri,At.TouchZoom=Rl,n.Bounds=he,n.Browser=Qe,n.CRS=V,n.Canvas=br,n.Circle=gr,n.CircleMarker=Ai,n.Class=J,n.Control=In,n.DivIcon=xc,n.DivOverlay=Ko,n.DomEvent=ml,n.DomUtil=hr,n.Draggable=Wo,n.Evented=ie,n.FeatureGroup=wt,n.GeoJSON=fa,n.GridLayer=Ei,n.Handler=On,n.Icon=Zo,n.ImageOverlay=Al,n.LatLng=ze,n.LatLngBounds=Ee,n.Layer=Vt,n.LayerGroup=ln,n.LineUtil=Se,n.Map=At,n.Marker=Ll,n.Mixin=kl,n.Path=Ba,n.Point=U,n.PolyUtil=Os,n.Polygon=Us,n.Polyline=ha,n.Popup=El,n.PosAnimation=bi,n.Projection=mt,n.Rectangle=oe,n.Renderer=va,n.SVG=Vs,n.SVGOverlay=Sc,n.TileLayer=Hs,n.Tooltip=Pl,n.Transformation=Re,n.Util=Z,n.VideoOverlay=Lc,n.bind=l,n.bounds=$e,n.canvas=Mc,n.circle=cd,n.circleMarker=rd,n.control=ns,n.divIcon=$c,n.extend=o,n.featureGroup=qn,n.geoJSON=Ml,n.geoJson=kr,n.gridLayer=md,n.icon=vr,n.imageOverlay=hd,n.latLng=be,n.latLngBounds=Me,n.layerGroup=ro,n.map=wi,n.marker=_c,n.point=ae,n.polygon=dd,n.polyline=ud,n.popup=vd,n.rectangle=ce,n.setOptions=x,n.stamp=d,n.svg=G,n.svgOverlay=pd,n.tileLayer=Dl,n.tooltip=Ic,n.transformation=q,n.version=a,n.videoOverlay=fd;var Gs=window.L;n.noConflict=function(){return window.L=Gs,this},window.L=n}))})(Tr,Tr.exports)),Tr.exports}var v2=p2();const Xt=Jy(v2);(function(e,t,n){function a(o,i){for(;(o=o.parentElement)&&!o.classList.contains(i););return o}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(o,i){this._map=o,this._container=o._container,this._overlayPane=o._panes.overlayPane,this._popupPane=o._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(L.DomUtil.disableTextSelection(),o.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(o){L.setOptions(this,o)},_fireCreatedEvent:function(o){this._map.fire(L.Draw.Event.CREATED,{layer:o,layerType:this.type})},_cancelDrawing:function(o){o.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(o,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var o=this._markers.pop(),i=this._poly,l=i.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(o),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(c,!1)}},addVertex:function(o){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(o))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(o)),this._poly.addLatLng(o),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(o,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var o=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(o[o.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(o.originalEvent)},_vertexChanged:function(o,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(o,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(o){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(o),this._clickHandled=!0,this._disableNewMarkers();var i=o.originalEvent,l=i.clientX,c=i.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(o,i){this._mouseDownOrigin=L.point(o,i)},_onMouseUp:function(o){var i=o.originalEvent,l=i.clientX,c=i.clientY;this._endPoint.call(this,l,c,o),this._clickHandled=null},_endPoint:function(o,i,l){if(this._mouseDownOrigin){var c=L.point(o,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(o){var i,l,c=o.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,o),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(o){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=c.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_createMarker:function(o){var i=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(o){var i=this._markers?this._markers.length:0;i>0&&(o=o||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),o))},_updateTooltip:function(o){var i=this._getTooltipText();o&&this._tooltip.updatePosition(o),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(o,i){var l,c,d,h=Math.floor(Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=h>m?h-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)l=y/h,c={x:Math.floor(o.x*(1-l)+l*i.x),y:Math.floor(o.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(o){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=o},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var o,i,l=this.options.showLength;return this._markers.length===0?o={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",o=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),o},_updateRunningMeasure:function(o,i){var l,c,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),c=L.GeometryUtil.isVersion07x()?o.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(o,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(i?1:-1))},_getMeasurementString:function(){var o,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return o=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(o,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var o=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(o,i){L.Draw.Polyline.prototype.initialize.call(this,o,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var o=this._markers.length;o===1&&this._markers[0].on("click",this._finishShape,this),o>2&&(this._markers[o-1].on("dblclick",this._finishShape,this),o>3&&this._markers[o-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var o,i;return this._markers.length===0?o=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(o=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(o=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:o,subtext:i}},_getMeasurementString:function(){var o=this._area,i="";return o||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),o&&(i+="<br>"+L.GeometryUtil.readableArea(o,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(o,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,o,i)},_cleanUpShape:function(){var o=this._markers.length;o>0&&(this._markers[0].off("click",this._finishShape,this),o>2&&this._markers[o-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(o,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(o){this._isDrawing=!0,this._startLatLng=o.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(o.originalEvent)},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(o,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(o){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(o.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(o){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,o)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,o),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_getTooltipText:function(){var o,i,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(o),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(o){return new L.Marker(o,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(o){this._onMouseMove(o),this._onClick()},_fireCreatedEvent:function(){var o=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},_fireCreatedEvent:function(){var o=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)},_createMarker:function(o){return new L.CircleMarker(o,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(o,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},_drawShape:function(o){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(o);else var i=this._map.distance(this._startLatLng,o);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_onMouseMove:function(o){var i,l=o.latlng,c=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";c&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(o,i){this._marker=o,L.setOptions(this,i)},addHooks:function(){var o=this._marker;o.dragging.enable(),o.on("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},removeHooks:function(){var o=this._marker;o.dragging.disable(),o.off("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},_onDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var o=this._marker._icon;o&&(o.style.display="none",L.DomUtil.hasClass(o,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,-4)):(L.DomUtil.addClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,4)),o.style.display="")},_offsetMarker:function(o,i){var l=parseInt(o.style.marginTop,10)-i,c=parseInt(o.style.marginLeft,10)-i;o.style.marginTop=l+"px",o.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(o){this.latlngs=[o._latlngs],o._holes&&(this.latlngs=this.latlngs.concat(o._holes)),this._poly=o,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(o){for(var i=0;i<this._verticesHandlers.length;i++)o(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(o){o.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(o){o.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(o){o.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var o=0;o<this.latlngs.length;o++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[o],this._poly.options.poly))},_updateLatLngs:function(o){this.latlngs=[o.layer._latlngs],o.layer._holes&&(this.latlngs=this.latlngs.concat(o.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(o,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=o,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var o=this._poly,i=o._path;o instanceof L.Polygon||(o.options.fill=!1,o.options.editing&&(o.options.editing.fill=!1)),i&&o.options.editing&&o.options.editing.className&&(o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var o=this._poly,i=o._path;i&&o.options.editing&&o.options.editing.className&&(o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.original),o._map&&(o._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var o,i,l,c,d=this._defaultShape();for(o=0,l=d.length;o<l;o++)c=this._createMarker(d[o],o),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var h,f;for(o=0,i=l-1;o<l;i=o++)(o!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[o],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:this.options.icon});return l._origLatLng=o,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var o=this._defaultShape(),i=[].splice.apply(o,arguments);return this._poly._convertLatLngs(o,!0),this._poly.redraw(),i},_removeMarker:function(o){var i=o._index;this._markerGroup.removeLayer(o),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(o){var i=o.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,c),i.setLatLng(c);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(o){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=o.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(o){var i=o.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),c=o.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(o,i){this._markerGroup.eachLayer(function(l){l._index>o&&(l._index+=i)})},_createMiddleMarker:function(o,i){var l,c,d,h=this._getMiddleLatLng(o,i),f=this._createMarker(h);f.setOpacity(.6),o._middleRight=i._middleLeft=f,c=function(){f.off("touchmove",c,this);var m=i._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,h),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),i._index++,this._updatePrevNext(o,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",c,this),f.off("dragend",d,this),f.off("touchmove",c,this),this._createMiddleMarker(o,f),this._createMiddleMarker(f,i)},l=function(){c.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",c,this).on("dragend",d,this).on("touchmove",c,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(o,i){o&&(o._next=i),i&&(i._prev=o)},_getMiddleLatLng:function(o,i){var l=this._poly._map,c=l.project(o.getLatLng()),d=l.project(i.getLatLng());return l.unproject(c._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(o,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=o,L.Util.setOptions(this,i)},addHooks:function(){var o=this._shape;this._shape._map&&(this._map=this._shape._map,o.setStyle(o.options.editing),o._map&&(this._map=o._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var o=this._shape;if(o.setStyle(o.options.original),o._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(o){o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(o){o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(o){o.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(o){var i=o.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(o){o.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(o){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o),typeof this._getCorners=="function"){var i=this._getCorners(),l=o.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return o.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(o){o.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds(),i=o.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var o=this._getCorners();this._resizeMarkers=[];for(var i=0,l=o.length;i<l;i++)this._resizeMarkers.push(this._createMarker(o[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(o){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o);var i=this._getCorners(),l=o.target,c=l._cornerIndex;this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(o){var i,l,c=o.target;c===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,o)},_move:function(o){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),d=c.getCenter(),h=[],f=0,m=l.length;f<m;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([o.lat+i[0],o.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(o){var i;this._shape.setBounds(L.latLngBounds(o,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var o=this._shape.getBounds();return[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()]},_toggleCornerMarkers:function(o){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(o)},_repositionCornerMarkers:function(){for(var o=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(o[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getLatLng();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(o){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(o);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(o),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var o=this._shape.getLatLng(),i=this._getResizeMarkerPoint(o);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(o){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(o);return this._map.unproject([l.x+i,l.y-i])},_resize:function(o){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(o):radius=this._map.distance(i,o),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(o,i){var l={};if(o.touches!==void 0){if(!o.touches.length)return;l=o.touches[0]}else if(o.pointerType!=="touch"||(l=o,!this._filterClick(o)))return;var c=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:o})},_filterClick:function(o){var i=o.timeStamp||o.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||o.target._simulatedClick&&!o._simulated?(L.DomEvent.stop(o),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(o){this._map._loaded&&this._touchEvent(o,"touchstart")},_onTouchEnd:function(o){this._map._loaded&&this._touchEvent(o,"touchend")},_onTouchCancel:function(o){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(o,i)}},_onTouchLeave:function(o){this._map._loaded&&this._touchEvent(o,"touchleave")},_onTouchMove:function(o){this._map._loaded&&this._touchEvent(o,"touchmove")},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var o=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(o,"leaflet-clickable"),L.DomEvent.on(o,"click",this._onMouseClick,this),L.DomEvent.on(o,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(o,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(o){for(var i=[],l=0,c=o.length;l<c;l++)Array.isArray(o[l])?i.push(L.LatLngUtil.cloneLatLngs(o[l])):i.push(this.cloneLatLng(o[l]));return i},cloneLatLng:function(o){return L.latLng(o.lat,o.lng)}},(function(){var o={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,c,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=i[m],c=i[(m+1)%d],h+=(c.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(c.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var c=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,m=h&&h.decimal;if(f||m){var y=c.split(".");c=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(c=c+m+y[1])}return c},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},o,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,c,d,m){var f,m=L.Util.extend({},o,m);switch(l?typeof l=="string"?l:"metric":c?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(i,m.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,m.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,m.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(i,m.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(o,i,l,c){return this._checkCounterclockwise(o,l,c)!==this._checkCounterclockwise(i,l,c)&&this._checkCounterclockwise(o,i,l)!==this._checkCounterclockwise(o,i,c)},_checkCounterclockwise:function(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}}),L.Polyline.include({intersects:function(){var o,i,l,c=this._getProjectedPoints(),d=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(o=d-1;o>=3;o--)if(i=c[o-1],l=c[o],this._lineSegmentsIntersectsRange(i,l,o-2))return!0;return!1},newLatLngIntersects:function(o,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(o),i)},newPointIntersects:function(o,i){var l=this._getProjectedPoints(),c=l?l.length:0,d=l?l[c-1]:null,h=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,o,h,i?1:0)},_tooFewPointsForIntersection:function(o){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=o||0,!i||l<=3},_lineSegmentsIntersectsRange:function(o,i,l,c){var d,h,f=this._getProjectedPoints();c=c||0;for(var m=l;m>c;m--)if(d=f[m-1],h=f[m],L.LineUtil.segmentsIntersect(o,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var o=[],i=this._defaultShape(),l=0;l<i.length;l++)o.push(this._map.latLngToLayerPoint(i[l]));return o}}),L.Polygon.include({intersects:function(){var o,i,l,c,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(o=d.length,i=d[0],l=d[o-1],c=o-2,this._lineSegmentsIntersectsRange(l,i,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(o){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,o);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(o){var i,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(o))&&(c||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(i));return l},onRemove:function(){for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&this._toolbars[o].removeToolbar()},setDrawingOptions:function(o){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(o)},_toolbarEnabled:function(o){var i=o.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(o){L.setOptions(this,o),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(o){var i,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,d=this._toolbarClass||"",h=this.getModeHandlers(o);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=o,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,c++,d,h[i].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var o in this._modes)this._modes.hasOwnProperty(o)&&(this._disposeButton(this._modes[o].button,this._modes[o].handler.enable,this._modes[o].handler),this._modes[o].handler.disable(),this._modes[o].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(o,i,l,c,d){var h=o.type;this._modes[h]={},this._modes[h].handler=o,this._modes[h].button=this._createButton({type:h,title:d,className:c+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(o){var i=L.DomUtil.create("a",o.className||"",o.container),l=L.DomUtil.create("span","sr-only",o.container);i.href="#",i.appendChild(l),o.title&&(i.title=o.title,l.innerHTML=o.title),o.text&&(i.innerHTML=o.text,l.innerHTML=o.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,c,o.callback,o.context),i},_disposeButton:function(o,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(o,"click",L.DomEvent.stopPropagation).off(o,"mousedown",L.DomEvent.stopPropagation).off(o,"dblclick",L.DomEvent.stopPropagation).off(o,"touchstart",L.DomEvent.stopPropagation).off(o,"click",L.DomEvent.preventDefault).off(o,l,i)},_handlerActivated:function(o){this.disable(),this._activeMode=this._modes[o.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(o){var i,l,c,d,h=this._actionsContainer,f=this.getActions(o),m=f.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var o=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",o===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),o===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(o){this._map=o,this._popupPane=o._panes.popupPane,this._visible=!1,this._container=o.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(o){return this._container?(o.subtext=o.subtext||"",o.subtext.length!==0||this._singleLineLabel?o.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(o.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+o.subtext+"</span><br />":"")+"<span>"+o.text+"</span>",o.text||o.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(o){var i=this._map.latLngToLayerPoint(o),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(o){for(var i in this.options)this.options.hasOwnProperty(i)&&o[i]&&(o[i]=L.extend({},this.options[i],o[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,o)},getModeHandlers:function(o){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(o,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(o,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(o,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(o,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(o,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(o,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(o){return[{enabled:o.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:o.completeShape,context:o},{enabled:o.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:o.deleteLastVertex,context:o},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(o){L.setOptions(this,o);for(var i in this._modes)this._modes.hasOwnProperty(i)&&o.hasOwnProperty(i)&&this._modes[i].handler.setOptions(o[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(o){o.edit&&(o.edit.selectedPathOptions===void 0&&(o.edit.selectedPathOptions=this.options.edit.selectedPathOptions),o.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,o.edit.selectedPathOptions)),o.remove&&(o.remove=L.extend({},this.options.remove,o.remove)),o.poly&&(o.poly=L.extend({},this.options.poly,o.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,o),this._selectedFeatureCount=0},getModeHandlers:function(o){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(o,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(o,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(o){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return o.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(o){var i=L.Toolbar.prototype.addToolbar.call(this,o);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var o,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(o=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(o=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),o._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(o){this._revertLayer(o)},this)},save:function(){var o=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(o.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:o})},_backupLayer:function(o){var i=L.Util.stamp(o);this._uneditedLayerProps[i]||(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(o.getLatLngs())}:o instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng()),radius:o.getRadius()}:(o instanceof L.Marker||o instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(o){var i=L.Util.stamp(o);o.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?o.setLatLngs(this._uneditedLayerProps[i].latlngs):o instanceof L.Circle?(o.setLatLng(this._uneditedLayerProps[i].latlng),o.setRadius(this._uneditedLayerProps[i].radius)):(o instanceof L.Marker||o instanceof L.CircleMarker)&&o.setLatLng(this._uneditedLayerProps[i].latlng),o.fire("revert-edited",{layer:o}))},_enableLayerEdit:function(o){var i,l,c=o.layer||o.target||o;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=c.options.color,i.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=i),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(o){var i=o.layer||o.target||o;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_onMarkerDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(o){var i=o.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(l);o.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(o){this._deletableLayers.addLayer(o),o.fire("revert-deleted",{layer:o})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(o){this._removeLayer({layer:o})},this),this.save()},_enableLayerDelete:function(o){(o.layer||o.target||o).on("click",this._removeLayer,this)},_disableLayerDelete:function(o){var i=o.layer||o.target||o;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(o){var i=o.layer||o.target||o;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Xy=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Cv=e=>e.length*6+12,zd=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),m2=(e,t)=>{if(!e||t.length===0)return new Set;const n=[],a=e.getBounds();t.forEach(l=>{if(a.contains(l.getLatLng())){const c=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&n.push({marker:l,pixelPos:c,location:d})}});const o=n.map(({marker:l,pixelPos:c,location:d})=>{const m=Cv(d.name),y=d.description?Cv(`${d.name}: ${Xy(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:c.x-15,right:c.x+15,top:c.y-15,bottom:c.y+15},baseLabelBox:{left:c.x-m/2,right:c.x+m/2,top:c.y+15+2,bottom:c.y+15+2+20},descLabelBox:d.description?{left:c.x-y/2,right:c.x+y/2,top:c.y+15+2,bottom:c.y+15+2+20}:null}}),i=new Set;return o.forEach(({marker:l,location:c,markerBox:d,baseLabelBox:h,descLabelBox:f},m)=>{if(!c.description)return;let y=!1;for(let k=0;k<o.length;k++){if(m===k)continue;const _=o[k];if(zd(f,_.markerBox)||zd(f,_.baseLabelBox)){y=!0;break}if(_.descLabelBox&&i.has(_.location.id)&&zd(f,_.descLabelBox)){y=!0;break}}y||i.add(c.id)}),i},Uc=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],g2=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Su=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function el(e){return Su.find(t=>t.value===e)||Su[0]}function y2(e){return el(e).defaultColor||"#667eea"}function k2(e,t){return t||y2(e)}const Kh={dot:(e,t=32)=>{const n=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const n=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const n=t/2,a=4,o=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${a} ${l},${o} ${i},${o}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${a-o} ${n+o},${a} ${n},${a+o} ${n-o},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-3,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${n+o*Math.cos(d)},${a+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${n+i*Math.cos(h)},${a+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4,i=[];for(let l=0;l<6;l++){const c=Math.PI/6+l*Math.PI/3;i.push(`${n+o*Math.cos(c)},${a+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4,i=[];for(let l=0;l<5;l++){const c=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${n+o*Math.cos(c)},${a+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Lv={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},jl={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=13,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${16+o*Math.cos(d)},${16+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Sv={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function zn({type:e,backgroundShape:t="circle",backgroundColor:n,borderColor:a,iconColor:o,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(n||a||o||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const c=el(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(c.isShapeOnly){const m=n||c.defaultColor||"#667eea",y=a||"#fff";if(jl[e])f=jl[e]({backgroundColor:m,borderColor:y});else return Kh[e]?.(m,h)||null}else{const m=n||"#667eea",y=a||"#fff",k=o||"#fff",_=t||"circle";_!=="none"&&jl[_]&&(f+=jl[_]({backgroundColor:m,borderColor:y})),Sv[e]&&(f+=Sv[e](k,m))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const b2={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function w2(e,t){return e===0?"missing":e>=t?"full":"partial"}function Yh(e,t){const n=w2(e,t);return b2[n]}function _2(e,t,n=32){if(e==="default")return null;if(Lv[e])return Lv[e](n);if(Kh[e]){const a=t||"#667eea";return Kh[e](a,n)}return null}const C2=["circle","square","hexagon","pentagon"];function L2(e){return C2.includes(e)}function S2(e,t,n,a,o=32,i=!0){const l=_2(e,t,o),c=Yh(n,a);if(!l)return null;const d=i&&L2(e),h=k2(e,t),f=x2(h),m=Qy(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=o>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${n}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${o}px; height: ${o}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${c}
      </div>
    </div>
  `}function I2(e){const t=e.replace("#",""),n=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Qy(e){return!e||e.length<6?!1:I2(e)>.4}function x2(e){return Qy(e)?"#1F2937":"#FFFFFF"}const $2={class:"map-container-wrapper"},T2="#667eea",M2={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=A(null);let l=null;const c=A([]),d=A([]),h=A([]);let f=null,m=null;const y=A([]);let k=null,_=null,x=!1;const D=A(!1),M=()=>{if(l){const De=l.getCenter();return{lat:De.lat,lng:De.lng}}return null},S=()=>l?l.getZoom():null,w=()=>{if(c.value.length>0){h.value.push([...c.value]);const De=d.value.pop()||[];c.value=De,_e(),o("polygon-drawing",c.value)}},I=()=>{if(h.value.length>0){d.value.push([...c.value]);const De=h.value.pop();c.value=De,_e(),o("polygon-drawing",c.value)}},T=()=>c.value.length>0,B=()=>h.value.length>0,E=()=>c.value.length,N=()=>{c.value.length>=3&&(o("polygon-complete",[...c.value]),$())},$=()=>{c.value=[],d.value=[],h.value=[],_e()},z=()=>{!l||!a.userLocation||(l.setView([a.userLocation.lat,a.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),D.value=!0)},O=(De,xe,me=null)=>{if(!l||De==null||xe==null)return;l.setView([De,xe],me??l.getZoom(),{animate:!0,duration:.5});const Ze=a.center&&Math.abs(a.center.lat-De)<1e-4&&Math.abs(a.center.lng-xe)<1e-4;D.value=!Ze},j=A(!0),Z=A(!0),J=(De,xe)=>{if(!l||De==null||xe==null)return!0;const me=l.getBounds(),Ze=Xt.latLng(De,xe);return me.contains(Ze)};t({getMapCenter:M,getMapZoom:S,undoPolygonPoint:w,redoPolygonPoint:I,canUndo:T,canRedo:B,getPolygonPointCount:E,completePolygon:N,clearPolygonDrawing:$,recenterOnUserLocation:z,recenterOnLocation:O,isLocationInView:J,userLocationInView:Z,highlightedLocationInView:j});const re=A([]);let K=null;const ie=A(!0),U=A(!1),X=A(new Set),ae=A([]);let he=null,$e=null;const Ee=H(()=>a.hideRecenterButton||!a.highlightLocationId||!D.value?!1:!j.value),Me=A({}),ze=()=>{const De={};if(a.highlightLocationId){const xe=a.locations.find(me=>me.id===a.highlightLocationId);if(xe?.latitude&&xe?.longitude){const me=J(xe.latitude,xe.longitude);j.value=me,De[a.highlightLocationId]=me,Me.value=De;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let xe=!0;for(const me of a.highlightLocationIds){const Ze=a.locations.find(Ge=>Ge.id===me);if(Ze?.latitude&&Ze?.longitude){const Ge=J(Ze.latitude,Ze.longitude);De[me]=Ge,Ge||(xe=!1)}else De[me]=!0}j.value=xe,Me.value=De;return}if(!l){j.value=!0,Me.value={};return}j.value=!0,Me.value={}},be=()=>{if(!l||!a.userLocation){Z.value=!0;return}Z.value=J(a.userLocation.lat,a.userLocation.lng)},V=()=>{ze(),be(),o("visibility-change",{userLocationInView:Z.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:Me.value})},Y=()=>{if(!l||!a.highlightLocationId)return;const De=a.locations.find(xe=>xe.id===a.highlightLocationId);!De||!De.latitude||!De.longitude||(l.setView([De.latitude,De.longitude],l.getZoom(),{animate:!0,duration:.5}),D.value=!1,j.value=!0)},de=(De,xe,me,Ze,Ge=!1)=>{const fe=me?"36px":Ze?"20px":"30px",ke=me?"#667eea":"white",te=Ge?"":Yh(De,xe);return`
    <div style="position: relative; width: ${fe}; height: ${fe};">
      <div style="
        background-color: ${T2};
        width: ${fe};
        height: ${fe};
        border-radius: 50%;
        border: 3px solid ${ke};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${Ge?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${te}
      </div>`}
    </div>
  `},se=()=>{if(!l)return;const De=m2(l,re.value),xe=Array.from(X.value).sort().join(","),me=Array.from(De).sort().join(",");xe!==me&&(X.value=De,Oe())},Re=()=>{if($e&&($e.remove(),$e=null),!l||!a.userLocation)return;const De=Xt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});$e=Xt.marker([a.userLocation.lat,a.userLocation.lng],{icon:De}).addTo(l).bindPopup("Your location")},q=()=>{if(!i.value)return;let De=51.505,xe=-.09,me=13;const Ze=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Ge=(ke,te)=>ke!=null&&te!=null&&!(ke===0&&te===0),fe=[];Ze.length>0&&fe.push(...Ze.filter(ke=>Ge(ke.latitude,ke.longitude)).map(ke=>({lat:ke.latitude,lng:ke.longitude}))),a.route&&a.route.length>0&&fe.push(...a.route.filter(ke=>Ge(ke.lat,ke.lng)).map(ke=>({lat:ke.lat,lng:ke.lng}))),a.center?(De=a.center.lat,xe=a.center.lng,me=a.zoom??13):fe.length>0&&(De=fe.reduce((ke,te)=>ke+te.lat,0)/fe.length,xe=fe.reduce((ke,te)=>ke+te.lng,0)/fe.length,me=10),l=Xt.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([De,xe],me),Xt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),a.clickable&&l.on("click",ke=>{a.drawingMode||o("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}),l.on("zoomstart",()=>{ge=!0}),l.on("zoomend moveend",()=>{ge=!1,ne?Oe():se(),V()}),l.on("dragstart",()=>{D.value=!0}),Oe(),Q(),ee(),Re(),Ae(),Ue(),l.whenReady(()=>{V()})},Q=()=>{if(K&&(K.remove(),K=null),!l||a.route.length===0)return;const De=a.route.map(fe=>[fe.lat,fe.lng]),xe=a.routeColor||"#3388ff",me=a.routeWeight||4;let Ze=null,Ge="butt";switch(a.routeStyle){case"dash":Ze="10, 10";break;case"dash-long":Ze="20, 12";break;case"dash-short":Ze="6, 6";break;case"dash-dense":Ze="6, 3";break;case"dot":Ze="2, 8",Ge="round";break;case"dot-sparse":Ze="2, 14",Ge="round";break;case"dot-dense":Ze="2, 2",Ge="round";break;case"dash-dot":Ze="16, 8, 4, 8";break;case"dash-dot-dot":Ze="16, 6, 4, 6, 4, 6";break;case"long-short":Ze="16, 4, 6, 4";break;case"double-dash":Ze="8, 3, 8, 8";break}K=Xt.polyline(De,{color:xe,weight:me,opacity:.7,dashArray:Ze,lineCap:Ge}).addTo(l)},ee=()=>{ae.value.forEach(De=>De.remove()),ae.value=[],!(!l||a.areas.length===0)&&a.areas.forEach(De=>{const xe=typeof De.polygon=="string"?JSON.parse(De.polygon):De.polygon;if(!xe||xe.length===0)return;const me=xe.map(ke=>[ke.lat,ke.lng]),Ze=De.id===a.selectedAreaId,Ge=De.color||"#667eea",fe=Xt.polygon(me,{color:Ge,fillColor:Ge,fillOpacity:Ze?.4:.2,weight:Ze?3:2,opacity:.8}).addTo(l);fe.setStyle({pane:"overlayPane"}),a.drawingMode||(fe.on("click",()=>o("area-click",De)),fe.on("mouseover",()=>{fe.setStyle({fillOpacity:.4})}),fe.on("mouseout",()=>{fe.setStyle({fillOpacity:Ze?.4:.2})})),ae.value.push(fe)})},_e=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),c.value.length!==0&&(m=Xt.layerGroup().addTo(l),c.value.forEach((De,xe)=>{const me=xe===0,Ze=xe===c.value.length-1,Ge=Xt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${me?"16px":"12px"};
        height: ${me?"16px":"12px"};
        background-color: ${me?"#667eea":Ze?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[me?16:12,me?16:12],iconAnchor:[me?8:6,me?8:6]});Xt.marker([De.lat,De.lng],{icon:Ge,interactive:!1}).addTo(m)}),c.value.length>=2))){const De=c.value.map(xe=>[xe.lat,xe.lng]);c.value.length>=3&&De.push(De[0]),f=Xt.polyline(De,{color:"#667eea",weight:3,opacity:.8,dashArray:c.value.length<3?"10, 10":null}).addTo(l)}},Be=()=>{if(!l||(k&&(k.remove(),k=null),_&&(_.remove(),_=null),y.value.length===0))return;const De=y.value.map(me=>[me.lat,me.lng]);k=Xt.polygon(De,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),_=Xt.layerGroup({pane:"markerPane"}).addTo(l);const xe=me=>{y.value.length<=3||(y.value.splice(me,1),x=!0,o("polygon-update",[...y.value]),Be())};y.value.forEach((me,Ze)=>{const Ge=y.value.length>3,fe=Xt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),ke=Xt.marker([me.lat,me.lng],{icon:fe,draggable:!0}).addTo(_);if(ke.on("drag",te=>{const ye=te.target.getLatLng();y.value[Ze]={lat:ye.lat,lng:ye.lng};const He=y.value.map(rt=>[rt.lat,rt.lng]);k.setLatLngs(He)}),ke.on("dragend",()=>{x=!0,o("polygon-update",[...y.value])}),ke.on("contextmenu",te=>{Xt.DomEvent.preventDefault(te),Ge&&xe(Ze)}),Ge){const te=document.createElement("div"),ye=document.createElement("button");ye.textContent="Delete point",ye.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const He=rt=>{rt.preventDefault(),rt.stopPropagation(),ke.closePopup(),xe(Ze)};ye.addEventListener("click",He),ye.addEventListener("touchend",He),te.appendChild(ye),ke.bindPopup(te,{closeButton:!1,className:"vertex-popup"})}})},Ue=(De=!0)=>{if(l){if(!a.editingPolygon||a.editingPolygon.length===0){k&&(k.remove(),k=null),_&&(_.remove(),_=null),y.value=[];return}if(y.value=a.editingPolygon.map(xe=>({lat:xe.lat,lng:xe.lng})),Be(),De&&y.value.length>=3){const xe=Xt.latLngBounds(y.value.map(me=>[me.lat,me.lng]));l.fitBounds(xe,{padding:[50,50]})}}},Ae=()=>{if(!l)return;if(he||(he=new Xt.FeatureGroup,l.addLayer(he)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!a.drawingMode){$(),he&&he.clearLayers();return}let De=0,xe=null,me=!1,Ze=!1;const Ge=300,fe=15,ke=kt=>{d.value.push([...c.value]),h.value=[],c.value.push({lat:kt.lat,lng:kt.lng}),_e(),o("polygon-drawing",c.value)},te=kt=>{kt.originalEvent&&kt.originalEvent.sourceCapabilities?.firesTouchEvents||ke(kt.latlng)},ye=kt=>{if(kt.touches.length>1){Ze=!0;return}Ze=!1,De=Date.now(),xe={x:kt.touches[0].clientX,y:kt.touches[0].clientY},me=!1},He=kt=>{if(!xe||Ze)return;const Rt=kt.touches[0].clientX-xe.x,Lt=kt.touches[0].clientY-xe.y;Math.sqrt(Rt*Rt+Lt*Lt)>fe&&(me=!0)},rt=kt=>{if(Ze){Ze=!1,xe=null;return}if(Date.now()-De<Ge&&!me&&xe){const Lt=kt.changedTouches[0],xt=Xt.point(Lt.clientX-l.getContainer().getBoundingClientRect().left,Lt.clientY-l.getContainer().getBoundingClientRect().top),Kt=l.containerPointToLatLng(xt);kt.preventDefault(),kt.stopPropagation(),ke(Kt)}xe=null,me=!1};l.on("click",te),l.getContainer().addEventListener("touchstart",ye,{passive:!0}),l.getContainer().addEventListener("touchmove",He,{passive:!0}),l.getContainer().addEventListener("touchend",rt,{passive:!1}),l._customDrawingHandlers={handleClick:te,handleTouchStart:ye,handleTouchMove:He,handleTouchEnd:rt},_e()};let ne=!1,ge=!1;const Oe=()=>{if(l&&(l._animatingZoom||ge)){ne=!0;return}if(ne=!1,re.value.forEach(me=>{me._map&&(me.off(),me.remove())}),re.value=[],!l)return;const De=i.value?.clientWidth||400,xe=Math.floor(De*.75);if(a.locations.forEach(me=>{const Ze=me.latitude??me.Latitude,Ge=me.longitude??me.Longitude;if(Ze==null||Ge==null||Ze===0&&Ge===0)return;const fe=me.checkedInCount||0,ke=me.requiredMarshals||1,te=a.highlightLocationId===me.id||a.highlightLocationIds.includes(me.id),ye=me.isDynamic||me.IsDynamic,He=a.simplifyNonHighlighted&&!te&&!ye,rt=me.resolvedStyleType||me.ResolvedStyleType,kt=me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor,Rt=me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor,Lt=me.resolvedStyleIconColor||me.ResolvedStyleIconColor,xt=me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape,Kt=rt&&rt!=="default"||kt||Rt||Lt||xt&&xt!=="circle"&&xt!=="default",no=me.resolvedStyleMapRotation??me.ResolvedStyleMapRotation??me.styleMapRotation??me.StyleMapRotation??0,Mo=parseInt(no,10)||0,ft=me.areaColor||"#999",Ct=me.areaId&&!a.marshalMode,Mn=X.value.has(me.id)&&me.description?`${me.name}: ${Xy(me.description,50)}`:me.name,go=te?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",oo=te?"#667eea":He?"#e0e0e0":"white",An=te?"white":He?"#888":"#333";let tn;if(He){const Qe="20px";tn=`
        <div style="
          background-color: #999;
          width: ${Qe};
          height: ${Qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Pa=!a.marshalMode,yo=Yh(fe,ke),Uo=Pa?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${fe}/${ke}</div>`:"";if(!He&&Kt){const Qe=te?40:32,Ot=me.resolvedStyleSize||me.ResolvedStyleSize||"100",on=zn({type:me.resolvedStyleType||me.ResolvedStyleType,backgroundShape:me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape||"circle",backgroundColor:me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor||"",borderColor:me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor||"",iconColor:me.resolvedStyleIconColor||me.ResolvedStyleIconColor||"",size:Ot});on?tn=on:tn=S2(me.resolvedStyleType,me.resolvedStyleColor,fe,ke,Qe,Pa)||de(fe,ke,te,a.marshalMode,!0)}else He||(tn=de(fe,ke,te,a.marshalMode,!0));const pe=Mo!==0?`transform: rotate(${Mo}deg);`:"",ve=Xt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${go}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Ct?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ft};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${pe}">
                ${tn}
              </div>
              ${He||a.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${yo}
              </div>`}
              ${He?"":Uo}
            </div>
          </div>
          <div style="
            background-color: ${oo};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${te?"12px":"11px"};
            font-weight: bold;
            color: ${An};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${xe}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${Mn}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Le=a.marshalMode?`<b>${me.name}</b>${me.description?`<br>${me.description}`:""}`:`<b>${me.name}</b><br>${me.description||""}<br>Checked in: ${fe}/${ke}`,lt=Xt.marker([me.latitude,me.longitude],{icon:ve}).addTo(l).bindPopup(Le);lt.on("click",()=>{o("location-click",me)}),lt.locationData=me,re.value.push(lt)}),l&&ie.value&&!a.center&&!U.value){const me=[],Ze=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Ge=(fe,ke)=>fe!=null&&ke!=null&&!(fe===0&&ke===0);if(Ze.length>0&&me.push(...Ze.filter(fe=>Ge(fe.latitude,fe.longitude)).map(fe=>[fe.latitude,fe.longitude])),a.route.length>0&&me.push(...a.route.filter(fe=>Ge(fe.lat,fe.lng)).map(fe=>[fe.lat,fe.lng])),me.length>0){const fe=Xt.latLngBounds(me);l.fitBounds(fe,{padding:[50,50]}),ie.value=!1,U.value=!0}}else a.center&&(ie.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&se()},100)};return un(()=>{U.value=!1,ie.value=!0,q();let De,xe=0,me=0;const Ze=new ResizeObserver(Ge=>{if(l&&Ge.length>0){const{width:fe,height:ke}=Ge[0].contentRect;(Math.abs(fe-xe)>10||Math.abs(ke-me)>10)&&(xe=fe,me=ke,clearTimeout(De),De=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&Ze.observe(i.value),Ln(()=>{clearTimeout(De),Ze.disconnect()})}),Ye(()=>a.locations,De=>{if(Oe(),l&&!U.value&&De.length>0&&!a.center){const xe=De.map(fe=>fe.latitude),me=De.map(fe=>fe.longitude),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,Ge=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,Ge],10),U.value=!0,ie.value=!1}l&&setTimeout(()=>V(),50)},{deep:!0}),Ye(()=>a.route,De=>{if(Q(),Oe(),l&&!U.value&&De&&De.length>0&&!a.center){const xe=De.map(fe=>fe.lat),me=De.map(fe=>fe.lng),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,Ge=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,Ge],10),U.value=!0,ie.value=!1}},{deep:!0}),Ye(()=>[a.routeColor,a.routeStyle,a.routeWeight],()=>{Q()}),Ye(()=>a.center,(De,xe)=>{l&&!D.value&&(!xe||Math.abs(De.lat-xe.lat)>1e-6||Math.abs(De.lng-xe.lng)>1e-6)&&l.setView([De.lat,De.lng],a.zoom)}),Ye(()=>a.areas,()=>{ee()},{deep:!0}),Ye(()=>a.selectedAreaId,()=>{ee()}),Ye(()=>a.drawingMode,()=>{Ae()}),Ye(()=>a.editingPolygon,()=>{if(x){x=!1;return}Ue()},{deep:!0}),Ye(()=>a.userLocation,()=>{Re()},{deep:!0}),Ye(()=>a.highlightLocationId,()=>{Oe()}),Ye(()=>a.highlightLocationIds,()=>{Oe(),l&&setTimeout(()=>V(),50)},{deep:!0}),Ye(()=>a.marshalMode,()=>{Oe()}),Ye(()=>a.simplifyNonHighlighted,()=>{Oe()}),Ye(()=>a.clickable,De=>{l&&(l.off("click"),De&&l.on("click",xe=>{a.drawingMode||o("map-click",{lat:xe.latlng.lat,lng:xe.latlng.lng})}))}),(De,xe)=>(p(),g("div",$2,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),Ee.value?(p(),g("button",{key:0,class:"recenter-btn",onClick:Y,title:"Recenter on checkpoint"},[...xe[0]||(xe[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):P("",!0)]))}},Jh=Ke(M2,[["__scopeId","data-v-59e540e9"]]);function ea(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const A2={class:"areas-selection"},E2={key:0,class:"areas-selection-header"},P2={class:"areas-list"},D2=["checked","onChange"],R2={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>[...n.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:ea(d.name,h.name))),i=H(()=>n.areas.length>0&&n.selectedAreaIds.length===n.areas.length),l=d=>{const h=[...n.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),a("update:selectedAreaIds",h)},c=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",n.areas.map(d=>d.id))};return(d,h)=>(p(),g("div",A2,[e.areas.length>1?(p(),g("div",E2,[r("button",{onClick:c,class:"toggle-all-btn"},b(i.value?"Deselect all":"Select all"),1)])):P("",!0),r("div",P2,[(p(!0),g(Ie,null,je(o.value,f=>(p(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,D2),r("span",{class:"area-color-dot",style:tt({backgroundColor:f.color||"#667eea"})},null,4),Je(" "+b(f.name),1)]))),128))])]))}},O2=Ke(R2,[["__scopeId","data-v-ba19009b"]]),B2={key:1,class:"toolbar-btn-wrapper filters-wrapper"},N2={key:1,class:"dropdown-content filters-dropdown"},F2={class:"filters-header"},U2={class:"filter-section"},z2={class:"filter-checkbox"},H2=["checked"],V2={key:0,class:"filter-checkbox"},G2=["checked"],q2={class:"filter-section"},j2={class:"filter-checkbox"},W2=["checked"],Z2={class:"filter-checkbox"},K2=["checked"],Y2={class:"filter-checkbox"},J2=["checked"],X2={key:0,class:"filter-section"},Q2=["onClick","title"],eL={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},tL={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},nL=["innerHTML"],oL={key:0,class:"dropdown-content action-dropdown"},aL=["onClick"],sL={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:n}){const{terms:a}=ht(),o=e,i=n,l=A(!1),c=A(null),d=H(()=>c.value!==null),h=()=>{l.value=!l.value,l.value&&(c.value=null)},f=(_,x)=>{i("filter-change",{...o.filters,[_]:x})},m=_=>{_.items&&_.items.length>0?c.value===_.id?c.value=null:(c.value=_.id,l.value=!1):i("action-click",{actionId:_.id})},y=(_,x)=>{c.value=null,i("action-click",{actionId:_,itemId:x})};return t({closeDropdowns:()=>{l.value=!1,c.value=null}}),(_,x)=>(p(),g("div",{class:le(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(p(),g("button",{key:0,class:"toolbar-btn",onClick:x[0]||(x[0]=D=>_.$emit("fullscreen-click")),title:"Fullscreen"},[...x[9]||(x[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(p(),g("div",B2,[l.value?(p(),g("div",{key:0,class:"mobile-backdrop",onClick:x[1]||(x[1]=D=>l.value=!1)})):P("",!0),r("button",{class:le(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...x[10]||(x[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(p(),g("div",N2,[r("div",F2,[x[12]||(x[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:x[2]||(x[2]=D=>l.value=!1),title:"Close"},[...x[11]||(x[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",U2,[x[13]||(x[13]=r("h4",null,"Display",-1)),r("label",z2,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:x[3]||(x[3]=D=>f("showRoute",D.target.checked))},null,40,H2),r("span",null,b(F(a).course)+" line",1)]),e.areas.length>0?(p(),g("label",V2,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:x[4]||(x[4]=D=>f("showAreaOverlays",D.target.checked))},null,40,G2),r("span",null,b(F(a).area)+" overlays",1)])):P("",!0)]),r("div",q2,[r("h4",null,b(F(a).checkpoints),1),r("label",j2,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:x[5]||(x[5]=D=>f("showUncheckedIn",D.target.checked))},null,40,W2),x[14]||(x[14]=r("span",{class:"status-indicator unchecked"},null,-1)),x[15]||(x[15]=r("span",null,"Unchecked-in",-1))]),r("label",Z2,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:x[6]||(x[6]=D=>f("showPartiallyCheckedIn",D.target.checked))},null,40,K2),x[16]||(x[16]=r("span",{class:"status-indicator partial"},null,-1)),x[17]||(x[17]=r("span",null,"Partially checked-in",-1))]),r("label",Y2,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:x[7]||(x[7]=D=>f("showFullyCheckedIn",D.target.checked))},null,40,J2),x[18]||(x[18]=r("span",{class:"status-indicator full"},null,-1)),x[19]||(x[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(p(),g("div",X2,[r("h4",null,b(F(a).areas),1),Pe(O2,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":x[8]||(x[8]=D=>f("selectedAreaIds",D))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(p(!0),g(Ie,null,je(e.actions,D=>(p(),g("div",{key:D.id,class:le(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:le(["toolbar-btn",{active:c.value===D.id}]),onClick:M=>m(D),title:D.label||D.id},[D.icon==="plus"?(p(),g("svg",eL,[...x[20]||(x[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):D.icon==="edit"?(p(),g("svg",tL,[...x[21]||(x[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):D.icon==="custom"?(p(),g("span",{key:2,innerHTML:D.customIcon},null,8,nL)):P("",!0)],10,Q2),D.items&&c.value===D.id?(p(),g("div",oL,[(p(!0),g(Ie,null,je(D.items,M=>(p(),g("button",{key:M.id,onClick:S=>y(D.id,M.id),class:"dropdown-item"},b(M.label),9,aL))),128))])):P("",!0)],2))),128))],2))}},Iv=Ke(sL,[["__scopeId","data-v-adedd545"]]),iL={key:0,class:"drawing-controls"},lL={class:"point-count"},rL={class:"undo-redo-buttons"},cL=["disabled"],uL=["disabled"],dL={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>n.show&&n.pointCount>0),i=l=>{if(!o.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),n.canUndo&&a("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),n.canRedo&&a("redo"))};return un(()=>{document.addEventListener("keydown",i)}),Ln(()=>{document.removeEventListener("keydown",i)}),(l,c)=>o.value?(p(),g("div",iL,[r("div",lL,b(e.pointCount)+" point"+b(e.pointCount!==1?"s":""),1),r("div",rL,[r("button",{onClick:c[0]||(c[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,cL),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,uL)])])):P("",!0)}},xv=Ke(dL,[["__scopeId","data-v-6cd009cb"]]),hL={class:"context-info"},fL={class:"action-buttons"},pL=["disabled"],vL={key:0,class:"fullscreen-map-banner"},mL={class:"fullscreen-map-container"},gL={key:1,class:"fullscreen-map-footer"},yL={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const n=e,a=H(()=>n.headerTextColor?{color:n.headerTextColor}:{}),o=t,i=()=>{o("done")},l=()=>{o("cancel")},c=()=>{o("close")},d=h=>{h.key==="Escape"&&n.show&&(n.mode==="view"?c():l())};return Ye(()=>n.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),un(()=>{document.addEventListener("keydown",d)}),Ln(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(p(),qe(ec,{to:"body"},[e.show?(p(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=ct(()=>{},["prevent","self"]))},[r("div",{class:le(["fullscreen-map-header",{compact:e.mode==="view"}]),style:tt(e.headerStyle)},[r("div",hL,[r("h3",{style:tt({color:e.headerTextColor})},b(e.title),5),e.description?(p(),g("p",{key:0,style:tt({color:e.headerTextColor,opacity:.85})},b(e.description),5)):P("",!0)]),r("div",fL,[mo(h.$slots,"actions",{},void 0,!0),e.mode==="view"?(p(),g("button",{key:0,type:"button",onClick:ct(c,["stop"]),class:"btn btn-close-x",style:tt(a.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(p(),g(Ie,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,pL)],64))])],6),h.$slots.banner?(p(),g("div",vL,[mo(h.$slots,"banner",{},void 0,!0)])):P("",!0),r("div",mL,[mo(h.$slots,"default",{},void 0,!0)]),h.$slots.footer?(p(),g("div",gL,[mo(h.$slots,"footer",{},void 0,!0)])):P("",!0)],32)):P("",!0)]))}},kL=Ke(yL,[["__scopeId","data-v-a1e3e36c"]]),bL={class:"map-wrapper"},wL={class:"fullscreen-map-wrapper"},_L={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=A(null),l=A(null),c=A(null),d=A(null),h=A(!1),f=A(0),m=A(!1),y=A(!1),k=A({...a.filters});Ye(()=>a.filters,K=>{k.value={...K}},{deep:!0}),Ye(()=>a.areas,K=>{a.showFilters&&K.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=K.map(ie=>ie.id))},{immediate:!0});const _=H(()=>a.showFilters?a.locations.filter(K=>{const ie=K.checkedInCount||0,U=K.requiredMarshals||1,X=ie===0,ae=ie>0&&ie<U,he=ie>=U;if(X&&!k.value.showUncheckedIn||ae&&!k.value.showPartiallyCheckedIn||he&&!k.value.showFullyCheckedIn)return!1;const $e=K.areaIds||K.AreaIds||[];return!(a.areas.length>0&&$e.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!$e.some(Me=>k.value.selectedAreaIds.includes(Me))))}):a.locations),x=H(()=>a.showFilters?k.value.showRoute?a.route:[]:a.route),D=H(()=>a.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?a.areas.filter(K=>k.value.selectedAreaIds.includes(K.id)):a.areas.length>0?[]:a.areas:a.areas),M=H(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),S=()=>h.value?l.value:i.value,w=()=>{h.value=!0,o("fullscreen-change",!0)},I=()=>{h.value=!1,o("fullscreen-change",!1)},T=()=>{if(a.mode==="draw-polygon"){const K=S();K&&K.clearPolygonDrawing(),f.value=0,m.value=!1,y.value=!1}h.value=!1,o("fullscreen-cancel"),o("fullscreen-change",!1)},B=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const K=S();K&&K.completePolygon()}h.value=!1,o("fullscreen-done"),o("fullscreen-change",!1)},E=K=>{k.value=K,o("filter-change",K)},N=K=>{a.mode==="select-point"&&o("point-selected",K),o("map-click",K)},$=K=>{f.value=K?.length||0,j(),o("polygon-drawing",K)},z=K=>{o("polygon-complete",K),f.value=0,m.value=!1,y.value=!1},O=K=>{o("polygon-update",K)},j=()=>{const K=S();K&&(m.value=K.canUndo?K.canUndo():!1,y.value=K.canRedo?K.canRedo():!1)},Z=()=>{const K=S();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),j())},J=()=>{const K=S();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),j())};return t({getMapCenter:()=>S()?.getMapCenter?.(),getMapZoom:()=>S()?.getMapZoom?.(),undoPolygonPoint:Z,redoPolygonPoint:J,canUndo:()=>m.value,canRedo:()=>y.value,getPolygonPointCount:()=>f.value,completePolygon:()=>S()?.completePolygon?.(),clearPolygonDrawing:()=>{S()?.clearPolygonDrawing?.(),f.value=0,m.value=!1,y.value=!1},recenterOnUserLocation:()=>S()?.recenterOnUserLocation?.(),recenterOnLocation:(K,ie,U)=>S()?.recenterOnLocation?.(K,ie,U),isLocationInView:(K,ie)=>S()?.isLocationInView?.(K,ie)??!0,getUserLocationInView:()=>S()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>S()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,o("fullscreen-change",!0)},closeFullscreen:I,closeDropdowns:()=>{c.value&&c.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(K,ie)=>(p(),g("div",{class:"common-map",style:tt({height:e.height})},[r("div",bL,[Pe(Jh,{ref_key:"mapViewRef",ref:i,locations:_.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,areas:D.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ie[0]||(ie[0]=U=>K.$emit("location-click",U)),onMapClick:N,onAreaClick:ie[1]||(ie[1]=U=>K.$emit("area-click",U)),onPolygonComplete:z,onPolygonDrawing:$,onPolygonUpdate:O,onVisibilityChange:ie[2]||(ie[2]=U=>K.$emit("visibility-change",U))},null,8,["locations","route","route-color","route-style","route-weight","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe(Iv,{ref_key:"toolbarRef",ref:c,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:w,onFilterChange:E,onActionClick:ie[3]||(ie[3]=U=>K.$emit("action-click",U))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Pe(xv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:J},null,8,["show","point-count","can-undo","can-redo"])]),Pe(kL,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":M.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:B,onCancel:T,onClose:I},yf({default:Ve(()=>[r("div",wL,[Pe(Jh,{ref_key:"fullscreenMapViewRef",ref:l,locations:_.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,areas:D.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ie[4]||(ie[4]=U=>K.$emit("location-click",U)),onMapClick:N,onAreaClick:ie[5]||(ie[5]=U=>K.$emit("area-click",U)),onPolygonComplete:z,onPolygonDrawing:$,onPolygonUpdate:O,onVisibilityChange:ie[6]||(ie[6]=U=>K.$emit("visibility-change",U))},null,8,["locations","route","route-color","route-style","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe(Iv,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:E,onActionClick:ie[7]||(ie[7]=U=>K.$emit("action-click",U))},null,8,["show-filters","filters","areas","actions","position"]),Pe(xv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Z,onRedo:J},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[K.$slots["fullscreen-actions"]?{name:"actions",fn:Ve(()=>[mo(K.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,K.$slots["fullscreen-banner"]?{name:"banner",fn:Ve(()=>[mo(K.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,K.$slots["fullscreen-footer"]?{name:"footer",fn:Ve(()=>[mo(K.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},il=Ke(_L,[["__scopeId","data-v-b4c73381"]]),Un=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],tu="#667eea";function CL(e){const t=e.map(a=>a.color);return Un.find(a=>!t.includes(a.hex))?.hex||tu}function Xh(e){const t=e.replace("#",""),n=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Iu(e){return!e||e===""?"#ffffff":Xh(e)>.179?"#333333":"#ffffff"}function e1(e,t){const n=e||yn.headerGradientStart,a=t||yn.headerGradientEnd,o=Xh(n),i=Xh(a);return(o+i)/2>.35?"#333333":"#ffffff"}const yn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},LL={class:"branding-color-picker"},SL={key:0,class:"picker-label"},IL={class:"color-name"},xL={key:1,class:"color-popup"},$L={class:"popup-header"},TL={class:"color-grid"},ML=["title","onClick"],AL={key:0,class:"check-mark"},EL={key:0,class:"check-mark"},PL={key:0,class:"custom-hex-input"},DL={class:"hex-input-row"},RL=["disabled"],OL={key:0,class:"hex-error"},BL={key:1,class:"contrast-preview"},NL={__name:"BrandingColorPicker",props:{modelValue:{type:String,default:""},label:{type:String,default:""},defaultColor:{type:String,default:""},showDefault:{type:Boolean,default:!0},showContrastPreview:{type:Boolean,default:!0},colors:{type:Array,default:()=>Un}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,o=A(!1),i=A(!1),l=A(""),c=A(null),d=H(()=>n.modelValue&&n.modelValue!=="default"?n.modelValue:n.defaultColor||yn.headerGradientStart),h=H(()=>{if(!n.modelValue||n.modelValue===""||n.modelValue==="default")return"Default";const w=n.colors.find(I=>I.hex.toLowerCase()===n.modelValue.toLowerCase());return w?w.name:n.modelValue}),f=H(()=>Iu(d.value));function m(w){return n.modelValue&&n.modelValue.toLowerCase()===w.toLowerCase()}const y=H(()=>!n.modelValue||n.modelValue===""||n.modelValue==="default"?!1:!n.colors.some(w=>w.hex.toLowerCase()===n.modelValue.toLowerCase())),k=H(()=>{if(!l.value)return!1;const w=l.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(w)||/^[0-9A-Fa-f]{3}$/.test(w)});function _(){o.value=!o.value,o.value||(i.value=!1)}function x(w){i.value=!1,a("update:modelValue",w),o.value=!1}function D(){i.value=!i.value,i.value&&(y.value?l.value=n.modelValue.replace(/^#/,""):l.value="",cn(()=>{c.value?.focus()}))}function M(){l.value=l.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()}function S(){if(!k.value)return;let w=l.value;w.length===3&&(w=w[0]+w[0]+w[1]+w[1]+w[2]+w[2]),a("update:modelValue","#"+w),i.value=!1,o.value=!1}return(w,I)=>(p(),g("div",LL,[e.label?(p(),g("label",SL,b(e.label),1)):P("",!0),r("button",{type:"button",class:le(["color-button",{active:o.value}]),onClick:_},[r("span",{class:"color-swatch",style:tt({backgroundColor:d.value})},null,4),r("span",IL,b(h.value),1),I[3]||(I[3]=r("span",{class:"arrow"},"",-1))],2),o.value?(p(),g("div",xL,[r("div",$L,[r("span",null,b(e.label||"Select colour"),1),r("button",{type:"button",class:"popup-close",onClick:I[0]||(I[0]=T=>o.value=!1)},"")]),r("div",TL,[e.showDefault?(p(),g("button",{key:0,type:"button",class:le(["color-option default-option",{selected:e.modelValue===""||e.modelValue==="default"}]),onClick:I[1]||(I[1]=T=>x(""))},[...I[4]||(I[4]=[r("span",{class:"default-icon"},"",-1),r("span",null,"Default",-1)])],2)):P("",!0),(p(!0),g(Ie,null,je(e.colors,T=>(p(),g("button",{key:T.hex,type:"button",class:le(["color-option",{selected:m(T.hex)}]),style:tt({backgroundColor:T.hex}),title:T.name,onClick:B=>x(T.hex)},[m(T.hex)?(p(),g("span",AL,"")):P("",!0)],14,ML))),128)),r("button",{type:"button",class:le(["color-option custom-option",{selected:y.value}]),style:tt(y.value?{backgroundColor:e.modelValue}:{}),title:"Custom colour",onClick:D},[I[5]||(I[5]=r("svg",{class:"custom-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"})],-1)),y.value?(p(),g("span",EL,"")):P("",!0)],6)]),i.value?(p(),g("div",PL,[I[7]||(I[7]=r("label",null,"Enter hex code",-1)),r("div",DL,[I[6]||(I[6]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInput",ref:c,"onUpdate:modelValue":I[2]||(I[2]=T=>l.value=T),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:l.value&&!k.value}]),onInput:M,onKeydown:Qo(S,["enter"])},null,34),[[at,l.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:k.value?"#"+l.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!k.value,onClick:S}," Apply ",8,RL)]),l.value&&!k.value?(p(),g("span",OL," Invalid hex code ")):P("",!0)])):P("",!0),e.showContrastPreview?(p(),g("div",BL,[I[8]||(I[8]=r("span",{class:"preview-label"},"Text will appear:",-1)),r("span",{class:"preview-text",style:tt({backgroundColor:d.value,color:f.value})}," Sample Text ",4)])):P("",!0)])):P("",!0)]))}},FL=Ke(NL,[["__scopeId","data-v-713a193b"]]),UL={class:"course-areas-tab"},zL={key:0,class:"route-settings-bar"},HL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},VL=["stroke","stroke-dasharray","stroke-linecap"],GL=["onClick"],qL={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},jL=["stroke","stroke-dasharray","stroke-linecap"],WL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},ZL=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],KL=["onClick"],YL={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},JL=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],XL=["disabled"],$v="#3388ff",QL={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map","update:routeSettings"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=e,l=n,c=A(null),d=A(null),h=A(null),f=A(null),m=A(0),y=A(!1),k=A(!1),_=A(i.routeColor),x=A(i.routeStyle),D=A(i.routeWeight);Ye(()=>i.routeColor,Ee=>{_.value=Ee},{immediate:!0}),Ye(()=>i.routeStyle,Ee=>{x.value=Ee},{immediate:!0}),Ye(()=>i.routeWeight,Ee=>{D.value=Ee},{immediate:!0});const M=H(()=>{const Ee=_.value!==i.routeColor,Me=x.value!==i.routeStyle,ze=D.value!==i.routeWeight;return Ee||Me||ze}),S=[{value:"line",label:"Solid"},{value:"dash",label:"Dashed"},{value:"dash-long",label:"Long dash"},{value:"dash-short",label:"Short dash"},{value:"dash-dense",label:"Dense dash"},{value:"dot",label:"Dotted"},{value:"dot-sparse",label:"Sparse dots"},{value:"dot-dense",label:"Dense dots"},{value:"dash-dot",label:"Dash-dot"},{value:"dash-dot-dot",label:"Dash-dot-dot"},{value:"long-short",label:"Long-short"},{value:"double-dash",label:"Double dash"}],w=[{value:2,label:"Thin"},{value:4,label:"Normal"},{value:6,label:"Thick"},{value:8,label:"Extra thick"}],I=H(()=>_.value||$v),T=Ee=>{const Me=Ee.replace("#",""),ze=parseInt(Me.substr(0,2),16)/255,be=parseInt(Me.substr(2,2),16)/255,V=parseInt(Me.substr(4,2),16)/255,Y=de=>de<=.03928?de/12.92:Math.pow((de+.055)/1.055,2.4);return .2126*Y(ze)+.7152*Y(be)+.0722*Y(V)},B=H(()=>{const Ee=I.value;return T(Ee)>.5?{backgroundColor:"#333",borderColor:"#555"}:{}}),E=Ee=>{switch(Ee){case"dash":return"8, 6";case"dash-long":return"16, 8";case"dash-short":return"4, 4";case"dash-dense":return"6, 3";case"dot":return"2, 4";case"dot-sparse":return"2, 8";case"dot-dense":return"2, 2";case"dash-dot":return"12, 4, 2, 4";case"dash-dot-dot":return"12, 4, 2, 4, 2, 4";case"long-short":return"16, 4, 6, 4";case"double-dash":return"8, 3, 8, 8";default:return"none"}},N=Ee=>Ee==="dot"||Ee==="dot-sparse"||Ee==="dot-dense"?"round":"butt",$=()=>{y.value=!y.value,k.value=!1},z=()=>{k.value=!k.value,y.value=!1},O=Ee=>{x.value=Ee,y.value=!1},j=Ee=>{D.value=Ee,k.value=!1},Z=()=>{l("update:routeSettings",{routeColor:_.value,routeStyle:x.value,routeWeight:D.value})},J=Ee=>{h.value&&!h.value.contains(Ee.target)&&(y.value=!1),f.value&&!f.value.contains(Ee.target)&&(k.value=!1)};Ye([y,k],([Ee,Me])=>{Ee||Me?document.addEventListener("click",J,!0):document.removeEventListener("click",J,!0)}),Ln(()=>{document.removeEventListener("click",J,!0)});const re=A({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),K=H(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${o.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${o.value.checkpoints}...`},{id:"upload",label:`Upload ${o.value.course}...`}]}]),ie=({actionId:Ee,itemId:Me})=>{Ee==="add"&&(Me==="checkpoint"?(l("add-checkpoint-from-map"),ae()):Me==="many-checkpoints"?(l("add-many-checkpoints-from-map"),ae()):Me==="area"?(l("add-area-from-map"),ae()):Me==="import"?l("import-checkpoints"):Me==="upload"&&l("upload-route"))},U=Ee=>{re.value=Ee},X=Ee=>{m.value=Ee?.length||0},ae=()=>{c.value&&c.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:ae,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ye(()=>i.areas,Ee=>{if(Ee.length>0){const Me=new Set(re.value.selectedAreaIds);Ee.forEach(ze=>{Me.has(ze.id)||re.value.selectedAreaIds.push(ze.id)}),re.value.selectedAreaIds=re.value.selectedAreaIds.filter(ze=>Ee.some(be=>be.id===ze))}},{immediate:!0}),Ye(()=>i.drawingMode,Ee=>{Ee||(m.value=0)}),(Ee,Me)=>(p(),g("div",UL,[e.route.length>0?(p(),g("div",zL,[Me[7]||(Me[7]=r("span",{class:"route-settings-label"},"Route style:",-1)),Pe(FL,{"model-value":_.value,"default-color":$v,"show-contrast-preview":!1,"show-default":!0,"onUpdate:modelValue":Me[0]||(Me[0]=ze=>_.value=ze)},null,8,["model-value"]),r("div",{class:"style-selector",ref_key:"styleSelectorRef",ref:h},[r("button",{type:"button",class:"style-selector-button",onClick:$},[(p(),g("svg",HL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:I.value,"stroke-width":"3","stroke-dasharray":E(x.value||"line"),"stroke-linecap":N(x.value||"line")},null,8,VL)])),Me[5]||(Me[5]=r("span",{class:"style-selector-arrow"},"",-1))]),y.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(B.value)},[(p(),g(Ie,null,je(S,ze=>r("button",{key:ze.value,type:"button",class:le(["style-option",{selected:(x.value||"line")===ze.value}]),onClick:be=>O(ze.value)},[(p(),g("svg",qL,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:I.value,"stroke-width":"3","stroke-dasharray":E(ze.value),"stroke-linecap":N(ze.value)},null,8,jL)]))],10,GL)),64))],4)):P("",!0)],512),r("div",{class:"style-selector",ref_key:"weightSelectorRef",ref:f},[r("button",{type:"button",class:"style-selector-button",onClick:z},[(p(),g("svg",WL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:I.value,"stroke-width":D.value||4,"stroke-dasharray":E(x.value||"line"),"stroke-linecap":N(x.value||"line")},null,8,ZL)])),Me[6]||(Me[6]=r("span",{class:"style-selector-arrow"},"",-1))]),k.value?(p(),g("div",{key:0,class:"style-dropdown",style:tt(B.value)},[(p(),g(Ie,null,je(w,ze=>r("button",{key:ze.value,type:"button",class:le(["style-option",{selected:(D.value||4)===ze.value}]),onClick:be=>j(ze.value)},[(p(),g("svg",YL,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:I.value,"stroke-width":ze.value,"stroke-dasharray":E(x.value||"line"),"stroke-linecap":N(x.value||"line")},null,8,JL)]))],10,KL)),64))],4)):P("",!0)],512),r("button",{type:"button",class:"btn-save-style",disabled:!M.value,onClick:Z}," Save ",8,XL)])):P("",!0),r("div",{class:"map-section",ref_key:"mapSection",ref:c},[Pe(il,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,"route-color":_.value,"route-style":x.value,"route-weight":D.value,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:re.value,"toolbar-actions":K.value,"fullscreen-title":e.drawingMode?`Draw ${F(o).area} boundary`:F(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:Me[1]||(Me[1]=ze=>Ee.$emit("map-click",ze)),onLocationClick:Me[2]||(Me[2]=ze=>Ee.$emit("location-click",ze)),onAreaClick:Me[3]||(Me[3]=ze=>Ee.$emit("area-click",ze)),onPolygonComplete:Me[4]||(Me[4]=ze=>Ee.$emit("polygon-complete",ze)),onPolygonDrawing:X,onFilterChange:U,onActionClick:ie},null,8,["locations","route","route-color","route-style","route-weight","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},eS=Ke(QL,[["__scopeId","data-v-4903e5fa"]]),tS=(e,t)=>{const n=String(e).trim(),a=String(t).trim(),o=parseFloat(n),i=parseFloat(a),l=!isNaN(o)&&String(o)===n,c=!isNaN(i)&&String(i)===a;return l&&c?o-i:n.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},nS={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,n)=>(p(),g("button",{class:le(["status-pill",[e.variant,{active:e.active}]]),onClick:n[0]||(n[0]=a=>t.$emit("click"))},[mo(t.$slots,"default",{},void 0,!0)],2))}},Pt=Ke(nS,[["__scopeId","data-v-a94deea5"]]),oS={class:"check-in-toggle-container"},aS=["disabled"],sS={key:0,class:"toggle-spinner"},iS={key:1,class:"toggle-icon"},lS={class:"toggle-label"},rS={key:0,class:"check-in-details"},cS={key:0,class:"check-in-method"},uS={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,n=H(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),a=H(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),o=H(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=H(()=>{const{checkedInBy:c,checkInMethod:d,marshalName:h}=t;return c&&c!==h?c:d||""}),l=c=>c?new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(c,d)=>(p(),g("div",oS,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[e.isLoading?(p(),g("span",sS)):e.isCheckedIn?(p(),g("span",iS,"")):P("",!0),r("span",lS,b(o.value),1)],10,aS),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(p(),g("span",rS,[Je(b(l(e.checkInTime))+" ",1),i.value?(p(),g("span",cS,"("+b(i.value)+")",1)):P("",!0),n.value?(p(),g("span",{key:1,class:le(["check-in-distance",a.value]),onClick:d[1]||(d[1]=ct(h=>c.$emit("distance-click"),["stop"]))},b(n.value),3)):P("",!0)])):P("",!0)]))}},xu=Ke(uS,[["__scopeId","data-v-f08ae7ff"]]),dS={class:"confirm-modal"},hS={class:"confirm-actions"},fS={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const n=t,a=()=>{n("confirm")},o=()=>{n("cancel")};return(i,l)=>e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(o,["self"])},[r("div",dS,[r("h3",null,b(e.title),1),r("p",null,b(e.message),1),r("div",hS,[e.showCancel?(p(),g("button",{key:0,onClick:o,class:"btn btn-secondary"},b(e.cancelText),1)):P("",!0),r("button",{onClick:a,class:le(["btn",e.isDanger?"btn-danger":"btn-primary"])},b(e.confirmText),3)])])])):P("",!0)}},hi=Ke(fS,[["__scopeId","data-v-b3f01e55"]]),pS={class:"base-modal-header"},vS={class:"base-modal-header-content"},mS={key:0,class:"base-modal-title"},gS={key:0,class:"base-modal-tab-header"},yS={key:1,class:"base-modal-footer"},kS={key:0,class:"base-modal-actions"},bS={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=()=>{const w=document.documentElement,I=getComputedStyle(w).getPropertyValue("--modal-resize-duration").trim();return I.endsWith("s")?parseFloat(I)*1e3:300},a=e,o=t,i=A(!1),l=A(!1),c=A(null),d=A(null);let h=null,f=!1,m=0;const y=()=>{if(!d.value||!c.value||f)return;const w=d.value.scrollHeight,I=m;if(I===w||m===0){m=w;return}f=!0,d.value.style.height=`${I}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${w}px`;const T=n();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=w},T)},k=()=>{!c.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),h=new MutationObserver(()=>{cn(()=>{y()})}),h.observe(c.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},_=()=>{h&&(h.disconnect(),h=null)};un(()=>{cn(()=>{a.show&&k()})}),Ln(()=>{_()}),Ye(()=>a.show,w=>{w?cn(()=>{m=0,k()}):_()});const x=()=>{a.closeOnOverlay&&D()},D=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:o("close")},M=()=>{i.value=!1,o("close")},S=()=>{i.value=!1};return(w,I)=>(p(),qe(Ia,{name:"modal",appear:""},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"base-modal-overlay",style:tt({zIndex:e.zIndex}),onClick:ct(x,["self"])},[r("div",{class:le(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",pS,[r("div",vS,[mo(w.$slots,"header",{},()=>[e.title?(p(),g("h2",mS,b(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(p(),g("button",{key:0,onClick:D,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),w.$slots["tab-header"]?(p(),g("div",gS,[mo(w.$slots,"tab-header",{},void 0,!0)])):P("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:c},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[mo(w.$slots,"default",{},void 0,!0)],512)],512),w.$slots.footer||w.$slots.actions?(p(),g("div",yS,[mo(w.$slots,"footer",{},()=>[w.$slots.actions?(p(),g("div",kS,[mo(w.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!l.value?(p(),qe(hi,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:M,onCancel:S},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},Zt=Ke(bS,[["__scopeId","data-v-141bdab1"]]),wS={class:"map-modal-content"},_S={class:"location-info"},CS={key:0,class:"info-row"},LS={class:"info-value"},SS={key:1,class:"info-row"},IS={class:"info-label"},xS={class:"info-value"},$S={key:2,class:"info-row distance-row"},TS={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=ht(),n=e,a=A(null);let o=null,i=null,l=null;const c=H(()=>t.value.checkpoint),d=H(()=>n.marshalName&&n.checkpointName?`${n.marshalName} - ${n.checkpointName}`:n.marshalName?n.marshalName:"Check-in location"),h=H(()=>n.distance===null?"":n.distance<1e3?`${Math.round(n.distance)} m`:`${(n.distance/1e3).toFixed(2)} km`),f=H(()=>n.distance===null?"":n.distance<=50?"distance-close":n.distance<=100?"distance-medium":"distance-far"),m=(x,D)=>x==null||D==null?"Unknown":`${x.toFixed(6)}, ${D.toFixed(6)}`,y=()=>{if(!a.value||o)return;let x=[51.505,-.09],D=15;n.checkInLocation&&(x=[n.checkInLocation.lat,n.checkInLocation.lng]),o=Xt.map(a.value).setView(x,D),Xt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(o),k()},k=()=>{if(!o)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const x=[];if(n.checkInLocation){const D=Xt.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Xt.marker([n.checkInLocation.lat,n.checkInLocation.lng],{icon:D}).addTo(o).bindPopup(`<b>${n.marshalName||"Marshal"}</b><br>Check-in location`),x.push([n.checkInLocation.lat,n.checkInLocation.lng])}if(n.checkpointLocation&&n.checkpointLocation.lat&&n.checkpointLocation.lng){const D=Xt.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${n.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Xt.marker([n.checkpointLocation.lat,n.checkpointLocation.lng],{icon:D}).addTo(o).bindPopup(`<b>${n.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),x.push([n.checkpointLocation.lat,n.checkpointLocation.lng])}if(x.length===2){const D=Xt.latLngBounds(x);o.fitBounds(D,{padding:[50,50],maxZoom:17})}else x.length===1&&o.setView(x[0],16)},_=()=>{o&&(o.remove(),o=null,i=null,l=null)};return Ye(()=>n.show,async x=>{x?(await cn(),setTimeout(()=>{y()},100)):_()}),Ye([()=>n.checkInLocation,()=>n.checkpointLocation],()=>{o&&k()},{deep:!0}),un(()=>{n.show&&cn(()=>{setTimeout(()=>{y()},100)})}),Ln(()=>{_()}),(x,D)=>(p(),qe(Zt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:D[0]||(D[0]=M=>x.$emit("close"))},{default:Ve(()=>[r("div",wS,[r("div",{class:"map-container",ref_key:"mapContainer",ref:a},null,512),r("div",_S,[e.checkInLocation?(p(),g("div",CS,[D[1]||(D[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",LS,b(m(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):P("",!0),e.checkpointLocation?(p(),g("div",SS,[r("span",IS,b(c.value)+" location:",1),r("span",xS,b(m(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):P("",!0),e.distance!==null?(p(),g("div",$S,[D[2]||(D[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:le(["info-value distance-value",f.value])},b(h.value),3)])):P("",!0)])])]),_:1},8,["show","title","z-index"]))}},Pf=Ke(TS,[["__scopeId","data-v-011fa479"]]),MS={class:"marshals-tab"},AS={class:"tab-header"},ES={class:"button-group"},PS={key:0,class:"status-pills"},DS={class:"filters-section"},RS={class:"search-group"},OS={class:"marshals-grid"},BS={class:"marshals-table"},NS={key:0,class:"sort-indicator"},FS={key:0,class:"sort-indicator"},US={key:0,class:"sort-indicator"},zS={key:0,class:"sort-indicator"},HS=["onClick"],VS=["rowspan"],GS={class:"checkpoint-cell"},qS={class:"checkpoint-name"},jS={key:0,class:"checkpoint-description"},WS=["rowspan"],ZS={key:0,class:"last-active-text"},KS={key:1,class:"last-active-never"},YS=["onClick"],JS={class:"no-checkpoint-text"},XS={class:"hide-on-mobile last-active-cell"},QS={key:0,class:"last-active-text"},eI={key:1,class:"last-active-never"},tI={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:n}){const{terms:a}=ht(),o=e,i=n,l=A(null),c=A(!1),d=A(null),h=V=>{l.value=V},f=V=>{d.value=V,c.value=!0},m=()=>{c.value=!1,d.value=null},y=H(()=>d.value?$e(d.value.marshalId):""),k=H(()=>d.value?ae(d.value.locationId):""),_=H(()=>{if(!d.value)return null;const{checkInLatitude:V,checkInLongitude:Y}=d.value;return!V||!Y?null:{lat:V,lng:Y}}),x=H(()=>{if(!d.value)return null;const V=X(d.value.locationId);return!V?.latitude||!V?.longitude?null:{lat:V.latitude,lng:V.longitude}}),D=H(()=>d.value?Ee(d.value):null),M=A(!1),S=A(null),w=V=>{V.isCheckedIn?(S.value=V,M.value=!0):i("toggle-check-in",V)},I=()=>{S.value&&i("toggle-check-in",S.value),M.value=!1,S.value=null},T=()=>{M.value=!1,S.value=null},B=H(()=>S.value?`Are you sure you want to undo ${$e(S.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const E=A("name"),N=A("asc"),$=A(""),z=A("all"),O=V=>{z.value=V},j=V=>{E.value===V?N.value=N.value==="asc"?"desc":"asc":(E.value=V,N.value="asc")},Z=V=>o.assignments.filter(Y=>Y.marshalId===V),J=H(()=>new Set(o.assignments.filter(V=>V.isCheckedIn).map(V=>V.marshalId))),re=H(()=>new Set(o.assignments.map(V=>V.marshalId))),K=H(()=>J.value.size),ie=H(()=>o.marshals.filter(V=>!re.value.has(V.id)).length),U=H(()=>o.marshals.filter(V=>re.value.has(V.id)&&!J.value.has(V.id)).length),X=V=>o.locations.find(Y=>Y.id===V),ae=V=>{const Y=X(V);return Y?Y.name:"Unknown"},he=V=>{const Y=X(V);return Y?Y.description:""},$e=V=>{const Y=o.marshals.find(de=>de.id===V);return Y?Y.name:""},Ee=V=>{const{checkInLatitude:Y,checkInLongitude:de,locationId:se}=V,Re=X(se);return!Y||!de||!Re?.latitude||!Re?.longitude?null:sl(Y,de,Re.latitude,Re.longitude)},Me=V=>{if(!V)return"";const Y=new Date(V),se=new Date-Y,Re=Math.floor(se/6e4),q=Math.floor(Re/60),Q=Math.floor(q/24);return Re<1?"just now":Re<60?`${Re}m ago`:q<24?`${q}h ago`:Q===1?"yesterday":Q<7?`${Q}d ago`:Y.toLocaleDateString()},ze=H(()=>{let V=o.marshals;if(z.value==="unassigned"?V=V.filter(Y=>!re.value.has(Y.id)):z.value==="checked-in"?V=V.filter(Y=>J.value.has(Y.id)):z.value==="not-checked-in"&&(V=V.filter(Y=>re.value.has(Y.id)&&!J.value.has(Y.id))),$.value.trim()){const Y=$.value.toLowerCase().trim().split(/\s+/);V=V.filter(de=>{const Re=Z(de.id).map(Q=>{const ee=X(Q.locationId);return ee?`${ee.name||""} ${ee.description||""}`:""}).join(" "),q=`${de.name} ${Re}`.toLowerCase();return Y.every(Q=>q.includes(Q))})}return V}),be=H(()=>{const V=[...ze.value];return V.sort((Y,de)=>{let se=0;if(E.value==="name")se=Y.name.localeCompare(de.name);else if(E.value==="checkpoint"){const Re=Z(Y.id),q=Z(de.id),Q=Re.length>0?ae(Re[0].locationId):"",ee=q.length>0?ae(q[0].locationId):"";se=tS(Q,ee)}else if(E.value==="status"){const Re=Z(Y.id),q=Z(de.id),Q=Re.length>0&&Re[0].isCheckedIn?1:0;se=(q.length>0&&q[0].isCheckedIn?1:0)-Q}else if(E.value==="lastActive"){const Re=Y.lastAccessedDate?new Date(Y.lastAccessedDate).getTime():0;se=(de.lastAccessedDate?new Date(de.lastAccessedDate).getTime():0)-Re}return N.value==="asc"?se:-se}),V});return(V,Y)=>(p(),g("div",MS,[r("div",AS,[r("div",ES,[r("button",{onClick:Y[0]||(Y[0]=de=>V.$emit("add-marshal")),class:"btn btn-primary"}," Add "+b(F(a).person.toLowerCase()),1),r("button",{onClick:Y[1]||(Y[1]=de=>V.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(p(),g("div",PS,[Pe(Pt,{variant:"neutral",active:z.value==="all",onClick:Y[2]||(Y[2]=de=>O("all"))},{default:Ve(()=>[Je(b(e.marshals.length)+" total ",1)]),_:1},8,["active"]),ie.value>0&&ie.value<e.marshals.length?(p(),qe(Pt,{key:0,variant:"warning",active:z.value==="unassigned",onClick:Y[3]||(Y[3]=de=>O("unassigned"))},{default:Ve(()=>[Je(b(ie.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),K.value>0&&K.value<e.marshals.length?(p(),qe(Pt,{key:1,variant:"success",active:z.value==="checked-in",onClick:Y[4]||(Y[4]=de=>O("checked-in"))},{default:Ve(()=>[Je(b(K.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),U.value>0&&U.value<e.marshals.length?(p(),qe(Pt,{key:2,variant:"danger",active:z.value==="not-checked-in",onClick:Y[5]||(Y[5]=de=>O("not-checked-in"))},{default:Ve(()=>[Je(b(U.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",DS,[r("div",RS,[We(r("input",{"onUpdate:modelValue":Y[6]||(Y[6]=de=>$.value=de),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[at,$.value]])])]),r("div",OS,[r("table",BS,[r("thead",null,[r("tr",null,[r("th",{onClick:Y[7]||(Y[7]=de=>j("name")),class:"sortable"},[Y[12]||(Y[12]=Je(" Name ",-1)),E.value==="name"?(p(),g("span",NS,b(N.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[8]||(Y[8]=de=>j("checkpoint")),class:"sortable"},[Je(b(F(a).checkpoint)+" ",1),E.value==="checkpoint"?(p(),g("span",FS,b(N.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[9]||(Y[9]=de=>j("status")),class:"sortable"},[Y[13]||(Y[13]=Je(" Status ",-1)),E.value==="status"?(p(),g("span",US,b(N.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[10]||(Y[10]=de=>j("lastActive")),class:"sortable hide-on-mobile"},[Y[14]||(Y[14]=Je(" Last active ",-1)),E.value==="lastActive"?(p(),g("span",zS,b(N.value==="asc"?"":""),1)):P("",!0)])])]),r("tbody",null,[(p(!0),g(Ie,null,je(be.value,de=>(p(),g(Ie,{key:de.id},[Z(de.id).length>0?(p(!0),g(Ie,{key:0},je(Z(de.id),(se,Re)=>(p(),g("tr",{key:`${de.id}-${se.id}`,class:"marshal-row",onClick:q=>V.$emit("select-marshal",de)},[Re===0?(p(),g("td",{key:0,rowspan:Z(de.id).length},b(de.name),9,VS)):P("",!0),r("td",GS,[r("div",qS,b(ae(se.locationId)),1),he(se.locationId)?(p(),g("div",jS,b(he(se.locationId)),1)):P("",!0)]),r("td",{onClick:Y[11]||(Y[11]=ct(()=>{},["stop"])),class:"check-in-cell"},[Pe(xu,{"is-checked-in":se.isCheckedIn,"check-in-time":se.checkInTime,"check-in-method":se.checkInMethod,"checked-in-by":se.checkedInBy,"marshal-name":$e(se.marshalId),"is-loading":l.value===se.id,distance:Ee(se),onToggle:q=>w(se),onDistanceClick:q=>f(se)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),Re===0?(p(),g("td",{key:1,rowspan:Z(de.id).length,class:"hide-on-mobile last-active-cell"},[de.lastAccessedDate?(p(),g("span",ZS,b(Me(de.lastAccessedDate)),1)):(p(),g("span",KS,"Never"))],8,WS)):P("",!0)],8,HS))),128)):(p(),g("tr",{key:1,class:"marshal-row",onClick:se=>V.$emit("select-marshal",de)},[r("td",null,b(de.name),1),r("td",JS,"No "+b(F(a).checkpoint.toLowerCase())+" assigned",1),Y[15]||(Y[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",XS,[de.lastAccessedDate?(p(),g("span",QS,b(Me(de.lastAccessedDate)),1)):(p(),g("span",eI,"Never"))])],8,YS))],64))),128))])])]),Pe(Pf,{show:c.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":_.value,"checkpoint-location":x.value,distance:D.value,onClose:m},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Pe(hi,{show:M.value,title:"Confirm check-out",message:B.value,"confirm-text":"Check out","is-danger":!0,onConfirm:I,onCancel:T},null,8,["show","message"])]))}},nI=Ke(tI,[["__scopeId","data-v-bdb66e38"]]),oI={class:"assignment-pills"},aI={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:n}=ht(),a=e,o=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${n.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${n.value.checkpoints}`,SpecificPeople:`Specific ${n.value.people}`,EveryAreaLead:`Every ${n.value.area} lead`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,OnePerArea:`One per ${n.value.area}`,OneLeadPerArea:`One lead per ${n.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${n.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?a.areas.find(y=>y.id===h)?.name||null:f==="Checkpoint"?a.locations.find(y=>y.id===h)?.name||null:f==="Marshal"&&a.marshals.find(y=>y.id===h)?.name||null,c=h=>{if(!h)return[];const f=o(h.scope),m=h.ids||[];if(h.itemType===null||m.length===0)return[f];if(m.includes("ALL_MARSHALS"))return["Everyone"];if(m.includes("ALL_AREAS"))return[`${f} (All ${n.value.areas})`];if(m.includes("ALL_CHECKPOINTS"))return[`${f} (All ${n.value.checkpoints})`];const y=m.filter(_=>l(_,h.itemType)!==null);if(y.length===0)return[];if(y.length>a.maxExpandedItems)return[`${f} (${y.length})`];const k=i(h.scope);return y.map(_=>{const x=l(_,h.itemType);return k?`${k} ${x}`:x})},d=H(()=>{if(!a.scopeConfigurations||a.scopeConfigurations.length===0)return[];const h=[];for(const f of a.scopeConfigurations)h.push(...c(f));return h});return(h,f)=>(p(),g("div",oI,[(p(!0),g(Ie,null,je(d.value,(m,y)=>(p(),g("span",{key:y,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},b(m),1))),128))]))}},ol=Ke(aI,[["__scopeId","data-v-82c305e5"]]);function Tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,a)}return n}function Wa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tv(Object(n),!0).forEach(function(a){sI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tv(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nu(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nu=function(t){return typeof t}:nu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function sI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ss(){return Ss=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ss.apply(this,arguments)}function iI(e,t){if(e==null)return{};var n={},a=Object.keys(e),o,i;for(i=0;i<a.length;i++)o=a[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function lI(e,t){if(e==null)return{};var n=iI(e,t),a,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var rI="1.14.0";function ws(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var $s=ws(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),gc=ws(/Edge/i),Mv=ws(/firefox/i),jr=ws(/safari/i)&&!ws(/chrome/i)&&!ws(/android/i),t1=ws(/iP(ad|od|hone)/i),cI=ws(/chrome/i)&&ws(/android/i),n1={capture:!1,passive:!1};function qt(e,t,n){e.addEventListener(t,n,!$s&&n1)}function Nt(e,t,n){e.removeEventListener(t,n,!$s&&n1)}function $u(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function uI(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Ha(e,t,n,a){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&$u(e,t):$u(e,t))||a&&e===n)return e;if(e===n)break}while(e=uI(e))}return null}var Av=/\s+/g;function Po(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(Av," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(Av," ")}}function gt(e,t,n){var a=e&&e.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=n+(typeof n=="string"?"":"px")}}function Ql(e,t){var n="";if(typeof e=="string")n=e;else do{var a=gt(e,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function o1(e,t,n){if(e){var a=e.getElementsByTagName(t),o=0,i=a.length;if(n)for(;o<i;o++)n(a[o],o);return a}return[]}function ja(){var e=document.scrollingElement;return e||document.documentElement}function Tn(e,t,n,a,o){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,c,d,h,f,m;if(e!==window&&e.parentNode&&e!==ja()?(i=e.getBoundingClientRect(),l=i.top,c=i.left,d=i.bottom,h=i.right,f=i.height,m=i.width):(l=0,c=0,d=window.innerHeight,h=window.innerWidth,f=window.innerHeight,m=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!$s))do if(o&&o.getBoundingClientRect&&(gt(o,"transform")!=="none"||n&&gt(o,"position")!=="static")){var y=o.getBoundingClientRect();l-=y.top+parseInt(gt(o,"border-top-width")),c-=y.left+parseInt(gt(o,"border-left-width")),d=l+i.height,h=c+i.width;break}while(o=o.parentNode);if(a&&e!==window){var k=Ql(o||e),_=k&&k.a,x=k&&k.d;k&&(l/=x,c/=_,m/=_,f/=x,d=l+f,h=c+m)}return{top:l,left:c,bottom:d,right:h,width:m,height:f}}}function Ev(e,t,n){for(var a=ai(e,!0),o=Tn(e)[t];a;){var i=Tn(a)[n],l=void 0;if(l=o>=i,!l)return a;if(a===ja())break;a=ai(a,!1)}return!1}function ir(e,t,n,a){for(var o=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==yt.ghost&&(a||l[i]!==yt.dragged)&&Ha(l[i],n.draggable,e,!1)){if(o===t)return l[i];o++}i++}return null}function Df(e,t){for(var n=e.lastElementChild;n&&(n===yt.ghost||gt(n,"display")==="none"||t&&!$u(n,t));)n=n.previousElementSibling;return n||null}function Xo(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==yt.clone&&(!t||$u(e,t))&&n++;return n}function Pv(e){var t=0,n=0,a=ja();if(e)do{var o=Ql(e),i=o.a,l=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*l}while(e!==a&&(e=e.parentNode));return[t,n]}function dI(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n)}return-1}function ai(e,t){if(!e||!e.getBoundingClientRect)return ja();var n=e,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=gt(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return ja();if(a||t)return n;a=!0}}while(n=n.parentNode);return ja()}function hI(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Hd(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Wr;function a1(e,t){return function(){if(!Wr){var n=arguments,a=this;n.length===1?e.call(a,n[0]):e.apply(a,n),Wr=setTimeout(function(){Wr=void 0},t)}}}function fI(){clearTimeout(Wr),Wr=void 0}function s1(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function i1(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var Bo="Sortable"+new Date().getTime();function pI(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(o){if(!(gt(o,"display")==="none"||o===yt.ghost)){e.push({target:o,rect:Tn(o)});var i=Wa({},e[e.length-1].rect);if(o.thisAnimationDuration){var l=Ql(o,!0);l&&(i.top-=l.f,i.left-=l.e)}o.fromRect=i}})}},addAnimationState:function(a){e.push(a)},removeAnimationState:function(a){e.splice(dI(e,{target:a}),1)},animateAll:function(a){var o=this;if(!this.options.animation){clearTimeout(t),typeof a=="function"&&a();return}var i=!1,l=0;e.forEach(function(c){var d=0,h=c.target,f=h.fromRect,m=Tn(h),y=h.prevFromRect,k=h.prevToRect,_=c.rect,x=Ql(h,!0);x&&(m.top-=x.f,m.left-=x.e),h.toRect=m,h.thisAnimationDuration&&Hd(y,m)&&!Hd(f,m)&&(_.top-m.top)/(_.left-m.left)===(f.top-m.top)/(f.left-m.left)&&(d=mI(_,y,k,o.options)),Hd(m,f)||(h.prevFromRect=f,h.prevToRect=m,d||(d=o.options.animation),o.animate(h,_,m,d)),d&&(i=!0,l=Math.max(l,d),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},d),h.thisAnimationDuration=d)}),clearTimeout(t),i?t=setTimeout(function(){typeof a=="function"&&a()},l):typeof a=="function"&&a(),e=[]},animate:function(a,o,i,l){if(l){gt(a,"transition",""),gt(a,"transform","");var c=Ql(this.el),d=c&&c.a,h=c&&c.d,f=(o.left-i.left)/(d||1),m=(o.top-i.top)/(h||1);a.animatingX=!!f,a.animatingY=!!m,gt(a,"transform","translate3d("+f+"px,"+m+"px,0)"),this.forRepaintDummy=vI(a),gt(a,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),gt(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){gt(a,"transition",""),gt(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},l)}}}}function vI(e){return e.offsetWidth}function mI(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var Fl=[],Vd={initializeByDefault:!0},yc={mount:function(t){for(var n in Vd)Vd.hasOwnProperty(n)&&!(n in t)&&(t[n]=Vd[n]);Fl.forEach(function(a){if(a.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Fl.push(t)},pluginEvent:function(t,n,a){var o=this;this.eventCanceled=!1,a.cancel=function(){o.eventCanceled=!0};var i=t+"Global";Fl.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][i]&&n[l.pluginName][i](Wa({sortable:n},a)),n.options[l.pluginName]&&n[l.pluginName][t]&&n[l.pluginName][t](Wa({sortable:n},a)))})},initializePlugins:function(t,n,a,o){Fl.forEach(function(c){var d=c.pluginName;if(!(!t.options[d]&&!c.initializeByDefault)){var h=new c(t,n,t.options);h.sortable=t,h.options=t.options,t[d]=h,Ss(a,h.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,n){var a={};return Fl.forEach(function(o){typeof o.eventProperties=="function"&&Ss(a,o.eventProperties.call(n[o.pluginName],t))}),a},modifyOption:function(t,n,a){var o;return Fl.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(t[i.pluginName],a))}),o}};function gI(e){var t=e.sortable,n=e.rootEl,a=e.name,o=e.targetEl,i=e.cloneEl,l=e.toEl,c=e.fromEl,d=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,m=e.newDraggableIndex,y=e.originalEvent,k=e.putSortable,_=e.extraEventProperties;if(t=t||n&&n[Bo],!!t){var x,D=t.options,M="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!$s&&!gc?x=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(x=document.createEvent("Event"),x.initEvent(a,!0,!0)),x.to=l||n,x.from=c||n,x.item=o||n,x.clone=i,x.oldIndex=d,x.newIndex=h,x.oldDraggableIndex=f,x.newDraggableIndex=m,x.originalEvent=y,x.pullMode=k?k.lastPutMode:void 0;var S=Wa(Wa({},_),yc.getEventProperties(a,t));for(var w in S)x[w]=S[w];n&&n.dispatchEvent(x),D[M]&&D[M].call(t,x)}}var yI=["evt"],Io=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.evt,i=lI(a,yI);yc.pluginEvent.bind(yt)(t,n,Wa({dragEl:ot,parentEl:fn,ghostEl:St,rootEl:rn,nextEl:Gi,lastDownEl:ou,cloneEl:pn,cloneHidden:oi,dragStarted:Mr,putSortable:Fn,activeSortable:yt.active,originalEvent:o,oldIndex:Wl,oldDraggableIndex:Zr,newIndex:Do,newDraggableIndex:ei,hideGhostForTarget:u1,unhideGhostForTarget:d1,cloneNowHidden:function(){oi=!0},cloneNowShown:function(){oi=!1},dispatchSortableEvent:function(c){ho({sortable:n,name:c,originalEvent:o})}},i))};function ho(e){gI(Wa({putSortable:Fn,cloneEl:pn,targetEl:ot,rootEl:rn,oldIndex:Wl,oldDraggableIndex:Zr,newIndex:Do,newDraggableIndex:ei},e))}var ot,fn,St,rn,Gi,ou,pn,oi,Wl,Do,Zr,ei,zc,Fn,ql=!1,Tu=!1,Mu=[],zi,ka,Gd,qd,Dv,Rv,Mr,Ul,Kr,Yr=!1,Hc=!1,au,jn,jd=[],Qh=!1,Au=[],sd=typeof document<"u",Vc=t1,Ov=gc||$s?"cssFloat":"float",kI=sd&&!cI&&!t1&&"draggable"in document.createElement("div"),l1=(function(){if(sd){if($s)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),r1=function(t,n){var a=gt(t),o=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),i=ir(t,0,n),l=ir(t,1,n),c=i&&gt(i),d=l&&gt(l),h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Tn(i).width,f=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Tn(l).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&c.float&&c.float!=="none"){var m=c.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===m)?"vertical":"horizontal"}return i&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||h>=o&&a[Ov]==="none"||l&&a[Ov]==="none"&&h+f>o)?"vertical":"horizontal"},bI=function(t,n,a){var o=a?t.left:t.top,i=a?t.right:t.bottom,l=a?t.width:t.height,c=a?n.left:n.top,d=a?n.right:n.bottom,h=a?n.width:n.height;return o===c||i===d||o+l/2===c+h/2},wI=function(t,n){var a;return Mu.some(function(o){var i=o[Bo].options.emptyInsertThreshold;if(!(!i||Df(o))){var l=Tn(o),c=t>=l.left-i&&t<=l.right+i,d=n>=l.top-i&&n<=l.bottom+i;if(c&&d)return a=o}}),a},c1=function(t){function n(i,l){return function(c,d,h,f){var m=c.options.group.name&&d.options.group.name&&c.options.group.name===d.options.group.name;if(i==null&&(l||m))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return n(i(c,d,h,f),l)(c,d,h,f);var y=(l?c:d).options.group.name;return i===!0||typeof i=="string"&&i===y||i.join&&i.indexOf(y)>-1}}var a={},o=t.group;(!o||nu(o)!="object")&&(o={name:o}),a.name=o.name,a.checkPull=n(o.pull,!0),a.checkPut=n(o.put),a.revertClone=o.revertClone,t.group=a},u1=function(){!l1&&St&&gt(St,"display","none")},d1=function(){!l1&&St&&gt(St,"display","")};sd&&document.addEventListener("click",function(e){if(Tu)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tu=!1,!1},!0);var Hi=function(t){if(ot){t=t.touches?t.touches[0]:t;var n=wI(t.clientX,t.clientY);if(n){var a={};for(var o in t)t.hasOwnProperty(o)&&(a[o]=t[o]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[Bo]._onDragOver(a)}}},_I=function(t){ot&&ot.parentNode[Bo]._isOutsideThisEl(t.target)};function yt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Ss({},t),e[Bo]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return r1(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:yt.supportPointer!==!1&&"PointerEvent"in window&&!jr,emptyInsertThreshold:5};yc.initializePlugins(this,e,n);for(var a in n)!(a in t)&&(t[a]=n[a]);c1(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:kI,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?qt(e,"pointerdown",this._onTapStart):(qt(e,"mousedown",this._onTapStart),qt(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(qt(e,"dragover",this),qt(e,"dragenter",this)),Mu.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Ss(this,pI())}yt.prototype={constructor:yt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ul=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,ot):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,a=this.el,o=this.options,i=o.preventOnFilter,l=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(c||t).target,h=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,f=o.filter;if(MI(a),!ot&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||o.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&jr&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=Ha(d,o.draggable,a,!1),!(d&&d.animated)&&ou!==d)){if(Wl=Xo(d),Zr=Xo(d,o.draggable),typeof f=="function"){if(f.call(this,t,d,this)){ho({sortable:n,rootEl:h,name:"filter",targetEl:d,toEl:a,fromEl:a}),Io("filter",n,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(f&&(f=f.split(",").some(function(m){if(m=Ha(h,m.trim(),a,!1),m)return ho({sortable:n,rootEl:m,name:"filter",targetEl:d,fromEl:a,toEl:a}),Io("filter",n,{evt:t}),!0}),f)){i&&t.cancelable&&t.preventDefault();return}o.handle&&!Ha(h,o.handle,a,!1)||this._prepareDragStart(t,c,d)}}},_prepareDragStart:function(t,n,a){var o=this,i=o.el,l=o.options,c=i.ownerDocument,d;if(a&&!ot&&a.parentNode===i){var h=Tn(a);if(rn=i,ot=a,fn=ot.parentNode,Gi=ot.nextSibling,ou=a,zc=l.group,yt.dragged=ot,zi={target:ot,clientX:(n||t).clientX,clientY:(n||t).clientY},Dv=zi.clientX-h.left,Rv=zi.clientY-h.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,ot.style["will-change"]="all",d=function(){if(Io("delayEnded",o,{evt:t}),yt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Mv&&o.nativeDraggable&&(ot.draggable=!0),o._triggerDragStart(t,n),ho({sortable:o,name:"choose",originalEvent:t}),Po(ot,l.chosenClass,!0)},l.ignore.split(",").forEach(function(f){o1(ot,f.trim(),Wd)}),qt(c,"dragover",Hi),qt(c,"mousemove",Hi),qt(c,"touchmove",Hi),qt(c,"mouseup",o._onDrop),qt(c,"touchend",o._onDrop),qt(c,"touchcancel",o._onDrop),Mv&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ot.draggable=!0),Io("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(gc||$s))){if(yt.eventCanceled){this._onDrop();return}qt(c,"mouseup",o._disableDelayedDrag),qt(c,"touchend",o._disableDelayedDrag),qt(c,"touchcancel",o._disableDelayedDrag),qt(c,"mousemove",o._delayedDragTouchMoveHandler),qt(c,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&qt(c,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ot&&Wd(ot),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;Nt(t,"mouseup",this._disableDelayedDrag),Nt(t,"touchend",this._disableDelayedDrag),Nt(t,"touchcancel",this._disableDelayedDrag),Nt(t,"mousemove",this._delayedDragTouchMoveHandler),Nt(t,"touchmove",this._delayedDragTouchMoveHandler),Nt(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?qt(document,"pointermove",this._onTouchMove):n?qt(document,"touchmove",this._onTouchMove):qt(document,"mousemove",this._onTouchMove):(qt(ot,"dragend",this),qt(rn,"dragstart",this._onDragStart));try{document.selection?su(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(ql=!1,rn&&ot){Io("dragStarted",this,{evt:n}),this.nativeDraggable&&qt(document,"dragover",_I);var a=this.options;!t&&Po(ot,a.dragClass,!1),Po(ot,a.ghostClass,!0),yt.active=this,t&&this._appendGhost(),ho({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(ka){this._lastX=ka.clientX,this._lastY=ka.clientY,u1();for(var t=document.elementFromPoint(ka.clientX,ka.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ka.clientX,ka.clientY),t!==n);)n=t;if(ot.parentNode[Bo]._isOutsideThisEl(t),n)do{if(n[Bo]){var a=void 0;if(a=n[Bo]._onDragOver({clientX:ka.clientX,clientY:ka.clientY,target:t,rootEl:n}),a&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);d1()}},_onTouchMove:function(t){if(zi){var n=this.options,a=n.fallbackTolerance,o=n.fallbackOffset,i=t.touches?t.touches[0]:t,l=St&&Ql(St,!0),c=St&&l&&l.a,d=St&&l&&l.d,h=Vc&&jn&&Pv(jn),f=(i.clientX-zi.clientX+o.x)/(c||1)+(h?h[0]-jd[0]:0)/(c||1),m=(i.clientY-zi.clientY+o.y)/(d||1)+(h?h[1]-jd[1]:0)/(d||1);if(!yt.active&&!ql){if(a&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}if(St){l?(l.e+=f-(Gd||0),l.f+=m-(qd||0)):l={a:1,b:0,c:0,d:1,e:f,f:m};var y="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");gt(St,"webkitTransform",y),gt(St,"mozTransform",y),gt(St,"msTransform",y),gt(St,"transform",y),Gd=f,qd=m,ka=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!St){var t=this.options.fallbackOnBody?document.body:rn,n=Tn(ot,!0,Vc,!0,t),a=this.options;if(Vc){for(jn=t;gt(jn,"position")==="static"&&gt(jn,"transform")==="none"&&jn!==document;)jn=jn.parentNode;jn!==document.body&&jn!==document.documentElement?(jn===document&&(jn=ja()),n.top+=jn.scrollTop,n.left+=jn.scrollLeft):jn=ja(),jd=Pv(jn)}St=ot.cloneNode(!0),Po(St,a.ghostClass,!1),Po(St,a.fallbackClass,!0),Po(St,a.dragClass,!0),gt(St,"transition",""),gt(St,"transform",""),gt(St,"box-sizing","border-box"),gt(St,"margin",0),gt(St,"top",n.top),gt(St,"left",n.left),gt(St,"width",n.width),gt(St,"height",n.height),gt(St,"opacity","0.8"),gt(St,"position",Vc?"absolute":"fixed"),gt(St,"zIndex","100000"),gt(St,"pointerEvents","none"),yt.ghost=St,t.appendChild(St),gt(St,"transform-origin",Dv/parseInt(St.style.width)*100+"% "+Rv/parseInt(St.style.height)*100+"%")}},_onDragStart:function(t,n){var a=this,o=t.dataTransfer,i=a.options;if(Io("dragStart",this,{evt:t}),yt.eventCanceled){this._onDrop();return}Io("setupClone",this),yt.eventCanceled||(pn=i1(ot),pn.draggable=!1,pn.style["will-change"]="",this._hideClone(),Po(pn,this.options.chosenClass,!1),yt.clone=pn),a.cloneId=su(function(){Io("clone",a),!yt.eventCanceled&&(a.options.removeCloneOnHide||rn.insertBefore(pn,ot),a._hideClone(),ho({sortable:a,name:"clone"}))}),!n&&Po(ot,i.dragClass,!0),n?(Tu=!0,a._loopId=setInterval(a._emulateDragOver,50)):(Nt(document,"mouseup",a._onDrop),Nt(document,"touchend",a._onDrop),Nt(document,"touchcancel",a._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(a,o,ot)),qt(document,"drop",a),gt(ot,"transform","translateZ(0)")),ql=!0,a._dragStartId=su(a._dragStarted.bind(a,n,t)),qt(document,"selectstart",a),Mr=!0,jr&&gt(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,a=t.target,o,i,l,c=this.options,d=c.group,h=yt.active,f=zc===d,m=c.sort,y=Fn||h,k,_=this,x=!1;if(Qh)return;function D(U,X){Io(U,_,Wa({evt:t,isOwner:f,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:i,canSort:m,fromSortable:y,target:a,completed:S,onMove:function(he,$e){return Gc(rn,n,ot,o,he,Tn(he),t,$e)},changed:w},X))}function M(){D("dragOverAnimationCapture"),_.captureAnimationState(),_!==y&&y.captureAnimationState()}function S(U){return D("dragOverCompleted",{insertion:U}),U&&(f?h._hideClone():h._showClone(_),_!==y&&(Po(ot,Fn?Fn.options.ghostClass:h.options.ghostClass,!1),Po(ot,c.ghostClass,!0)),Fn!==_&&_!==yt.active?Fn=_:_===yt.active&&Fn&&(Fn=null),y===_&&(_._ignoreWhileAnimating=a),_.animateAll(function(){D("dragOverAnimationComplete"),_._ignoreWhileAnimating=null}),_!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(a===ot&&!ot.animated||a===n&&!a.animated)&&(Ul=null),!c.dragoverBubble&&!t.rootEl&&a!==document&&(ot.parentNode[Bo]._isOutsideThisEl(t.target),!U&&Hi(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),x=!0}function w(){Do=Xo(ot),ei=Xo(ot,c.draggable),ho({sortable:_,name:"change",toEl:n,newIndex:Do,newDraggableIndex:ei,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),a=Ha(a,c.draggable,n,!0),D("dragOver"),yt.eventCanceled)return x;if(ot.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||_._ignoreWhileAnimating===a)return S(!1);if(Tu=!1,h&&!c.disabled&&(f?m||(l=fn!==rn):Fn===this||(this.lastPutMode=zc.checkPull(this,h,ot,t))&&d.checkPut(this,h,ot,t))){if(k=this._getDirection(t,a)==="vertical",o=Tn(ot),D("dragOverValid"),yt.eventCanceled)return x;if(l)return fn=rn,M(),this._hideClone(),D("revert"),yt.eventCanceled||(Gi?rn.insertBefore(ot,Gi):rn.appendChild(ot)),S(!0);var I=Df(n,c.draggable);if(!I||II(t,k,this)&&!I.animated){if(I===ot)return S(!1);if(I&&n===t.target&&(a=I),a&&(i=Tn(a)),Gc(rn,n,ot,o,a,i,t,!!a)!==!1)return M(),n.appendChild(ot),fn=n,w(),S(!0)}else if(I&&SI(t,k,this)){var T=ir(n,0,c,!0);if(T===ot)return S(!1);if(a=T,i=Tn(a),Gc(rn,n,ot,o,a,i,t,!1)!==!1)return M(),n.insertBefore(ot,T),fn=n,w(),S(!0)}else if(a.parentNode===n){i=Tn(a);var B=0,E,N=ot.parentNode!==n,$=!bI(ot.animated&&ot.toRect||o,a.animated&&a.toRect||i,k),z=k?"top":"left",O=Ev(a,"top","top")||Ev(ot,"top","top"),j=O?O.scrollTop:void 0;Ul!==a&&(E=i[z],Yr=!1,Hc=!$&&c.invertSwap||N),B=xI(t,a,i,k,$?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,Hc,Ul===a);var Z;if(B!==0){var J=Xo(ot);do J-=B,Z=fn.children[J];while(Z&&(gt(Z,"display")==="none"||Z===St))}if(B===0||Z===a)return S(!1);Ul=a,Kr=B;var re=a.nextElementSibling,K=!1;K=B===1;var ie=Gc(rn,n,ot,o,a,i,t,K);if(ie!==!1)return(ie===1||ie===-1)&&(K=ie===1),Qh=!0,setTimeout(LI,30),M(),K&&!re?n.appendChild(ot):a.parentNode.insertBefore(ot,K?re:a),O&&s1(O,0,j-O.scrollTop),fn=ot.parentNode,E!==void 0&&!Hc&&(au=Math.abs(E-Tn(a)[z])),w(),S(!0)}if(n.contains(ot))return S(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Nt(document,"mousemove",this._onTouchMove),Nt(document,"touchmove",this._onTouchMove),Nt(document,"pointermove",this._onTouchMove),Nt(document,"dragover",Hi),Nt(document,"mousemove",Hi),Nt(document,"touchmove",Hi)},_offUpEvents:function(){var t=this.el.ownerDocument;Nt(t,"mouseup",this._onDrop),Nt(t,"touchend",this._onDrop),Nt(t,"pointerup",this._onDrop),Nt(t,"touchcancel",this._onDrop),Nt(document,"selectstart",this)},_onDrop:function(t){var n=this.el,a=this.options;if(Do=Xo(ot),ei=Xo(ot,a.draggable),Io("drop",this,{evt:t}),fn=ot&&ot.parentNode,Do=Xo(ot),ei=Xo(ot,a.draggable),yt.eventCanceled){this._nulling();return}ql=!1,Hc=!1,Yr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ef(this.cloneId),ef(this._dragStartId),this.nativeDraggable&&(Nt(document,"drop",this),Nt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),jr&&gt(document.body,"user-select",""),gt(ot,"transform",""),t&&(Mr&&(t.cancelable&&t.preventDefault(),!a.dropBubble&&t.stopPropagation()),St&&St.parentNode&&St.parentNode.removeChild(St),(rn===fn||Fn&&Fn.lastPutMode!=="clone")&&pn&&pn.parentNode&&pn.parentNode.removeChild(pn),ot&&(this.nativeDraggable&&Nt(ot,"dragend",this),Wd(ot),ot.style["will-change"]="",Mr&&!ql&&Po(ot,Fn?Fn.options.ghostClass:this.options.ghostClass,!1),Po(ot,this.options.chosenClass,!1),ho({sortable:this,name:"unchoose",toEl:fn,newIndex:null,newDraggableIndex:null,originalEvent:t}),rn!==fn?(Do>=0&&(ho({rootEl:fn,name:"add",toEl:fn,fromEl:rn,originalEvent:t}),ho({sortable:this,name:"remove",toEl:fn,originalEvent:t}),ho({rootEl:fn,name:"sort",toEl:fn,fromEl:rn,originalEvent:t}),ho({sortable:this,name:"sort",toEl:fn,originalEvent:t})),Fn&&Fn.save()):Do!==Wl&&Do>=0&&(ho({sortable:this,name:"update",toEl:fn,originalEvent:t}),ho({sortable:this,name:"sort",toEl:fn,originalEvent:t})),yt.active&&((Do==null||Do===-1)&&(Do=Wl,ei=Zr),ho({sortable:this,name:"end",toEl:fn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Io("nulling",this),rn=ot=fn=St=Gi=pn=ou=oi=zi=ka=Mr=Do=ei=Wl=Zr=Ul=Kr=Fn=zc=yt.dragged=yt.ghost=yt.clone=yt.active=null,Au.forEach(function(t){t.checked=!0}),Au.length=Gd=qd=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":ot&&(this._onDragOver(t),CI(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,a=this.el.children,o=0,i=a.length,l=this.options;o<i;o++)n=a[o],Ha(n,l.draggable,this.el,!1)&&t.push(n.getAttribute(l.dataIdAttr)||TI(n));return t},sort:function(t,n){var a={},o=this.el;this.toArray().forEach(function(i,l){var c=o.children[l];Ha(c,this.options.draggable,o,!1)&&(a[i]=c)},this),n&&this.captureAnimationState(),t.forEach(function(i){a[i]&&(o.removeChild(a[i]),o.appendChild(a[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Ha(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var a=this.options;if(n===void 0)return a[t];var o=yc.modifyOption(this,t,n);typeof o<"u"?a[t]=o:a[t]=n,t==="group"&&c1(a)},destroy:function(){Io("destroy",this);var t=this.el;t[Bo]=null,Nt(t,"mousedown",this._onTapStart),Nt(t,"touchstart",this._onTapStart),Nt(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(Nt(t,"dragover",this),Nt(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Mu.splice(Mu.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!oi){if(Io("hideClone",this),yt.eventCanceled)return;gt(pn,"display","none"),this.options.removeCloneOnHide&&pn.parentNode&&pn.parentNode.removeChild(pn),oi=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(oi){if(Io("showClone",this),yt.eventCanceled)return;ot.parentNode==rn&&!this.options.group.revertClone?rn.insertBefore(pn,ot):Gi?rn.insertBefore(pn,Gi):rn.appendChild(pn),this.options.group.revertClone&&this.animate(ot,pn),gt(pn,"display",""),oi=!1}}};function CI(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Gc(e,t,n,a,o,i,l,c){var d,h=e[Bo],f=h.options.onMove,m;return window.CustomEvent&&!$s&&!gc?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=e,d.dragged=n,d.draggedRect=a,d.related=o||t,d.relatedRect=i||Tn(t),d.willInsertAfter=c,d.originalEvent=l,e.dispatchEvent(d),f&&(m=f.call(h,d,l)),m}function Wd(e){e.draggable=!1}function LI(){Qh=!1}function SI(e,t,n){var a=Tn(ir(n.el,0,n.options,!0)),o=10;return t?e.clientX<a.left-o||e.clientY<a.top&&e.clientX<a.right:e.clientY<a.top-o||e.clientY<a.bottom&&e.clientX<a.left}function II(e,t,n){var a=Tn(Df(n.el,n.options.draggable)),o=10;return t?e.clientX>a.right+o||e.clientX<=a.right&&e.clientY>a.bottom&&e.clientX>=a.left:e.clientX>a.right&&e.clientY>a.top||e.clientX<=a.right&&e.clientY>a.bottom+o}function xI(e,t,n,a,o,i,l,c){var d=a?e.clientY:e.clientX,h=a?n.height:n.width,f=a?n.top:n.left,m=a?n.bottom:n.right,y=!1;if(!l){if(c&&au<h*o){if(!Yr&&(Kr===1?d>f+h*i/2:d<m-h*i/2)&&(Yr=!0),Yr)y=!0;else if(Kr===1?d<f+au:d>m-au)return-Kr}else if(d>f+h*(1-o)/2&&d<m-h*(1-o)/2)return $I(t)}return y=y||l,y&&(d<f+h*i/2||d>m-h*i/2)?d>f+h/2?1:-1:0}function $I(e){return Xo(ot)<Xo(e)?1:-1}function TI(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;n--;)a+=t.charCodeAt(n);return a.toString(36)}function MI(e){Au.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var a=t[n];a.checked&&Au.push(a)}}function su(e){return setTimeout(e,0)}function ef(e){return clearTimeout(e)}sd&&qt(document,"touchmove",function(e){(yt.active||ql)&&e.cancelable&&e.preventDefault()});yt.utils={on:qt,off:Nt,css:gt,find:o1,is:function(t,n){return!!Ha(t,n,t,!1)},extend:hI,throttle:a1,closest:Ha,toggleClass:Po,clone:i1,index:Xo,nextTick:su,cancelNextTick:ef,detectDirection:r1,getChild:ir};yt.get=function(e){return e[Bo]};yt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(yt.utils=Wa(Wa({},yt.utils),a.utils)),yc.mount(a)})};yt.create=function(e,t){return new yt(e,t)};yt.version=rI;var Cn=[],Ar,tf,nf=!1,Zd,Kd,Eu,Er;function AI(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?qt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?qt(document,"pointermove",this._handleFallbackAutoScroll):a.touches?qt(document,"touchmove",this._handleFallbackAutoScroll):qt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?Nt(document,"dragover",this._handleAutoScroll):(Nt(document,"pointermove",this._handleFallbackAutoScroll),Nt(document,"touchmove",this._handleFallbackAutoScroll),Nt(document,"mousemove",this._handleFallbackAutoScroll)),Bv(),iu(),fI()},nulling:function(){Eu=tf=Ar=nf=Er=Zd=Kd=null,Cn.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var o=this,i=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(i,l);if(Eu=n,a||this.options.forceAutoScrollFallback||gc||$s||jr){Yd(n,this.options,c,a);var d=ai(c,!0);nf&&(!Er||i!==Zd||l!==Kd)&&(Er&&Bv(),Er=setInterval(function(){var h=ai(document.elementFromPoint(i,l),!0);h!==d&&(d=h,iu()),Yd(n,o.options,h,a)},10),Zd=i,Kd=l)}else{if(!this.options.bubbleScroll||ai(c,!0)===ja()){iu();return}Yd(n,this.options,ai(c,!1),!1)}}},Ss(e,{pluginName:"scroll",initializeByDefault:!0})}function iu(){Cn.forEach(function(e){clearInterval(e.pid)}),Cn=[]}function Bv(){clearInterval(Er)}var Yd=a1(function(e,t,n,a){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,c=t.scrollSpeed,d=ja(),h=!1,f;tf!==n&&(tf=n,iu(),Ar=t.scroll,f=t.scrollFn,Ar===!0&&(Ar=ai(n,!0)));var m=0,y=Ar;do{var k=y,_=Tn(k),x=_.top,D=_.bottom,M=_.left,S=_.right,w=_.width,I=_.height,T=void 0,B=void 0,E=k.scrollWidth,N=k.scrollHeight,$=gt(k),z=k.scrollLeft,O=k.scrollTop;k===d?(T=w<E&&($.overflowX==="auto"||$.overflowX==="scroll"||$.overflowX==="visible"),B=I<N&&($.overflowY==="auto"||$.overflowY==="scroll"||$.overflowY==="visible")):(T=w<E&&($.overflowX==="auto"||$.overflowX==="scroll"),B=I<N&&($.overflowY==="auto"||$.overflowY==="scroll"));var j=T&&(Math.abs(S-o)<=l&&z+w<E)-(Math.abs(M-o)<=l&&!!z),Z=B&&(Math.abs(D-i)<=l&&O+I<N)-(Math.abs(x-i)<=l&&!!O);if(!Cn[m])for(var J=0;J<=m;J++)Cn[J]||(Cn[J]={});(Cn[m].vx!=j||Cn[m].vy!=Z||Cn[m].el!==k)&&(Cn[m].el=k,Cn[m].vx=j,Cn[m].vy=Z,clearInterval(Cn[m].pid),(j!=0||Z!=0)&&(h=!0,Cn[m].pid=setInterval((function(){a&&this.layer===0&&yt.active._onTouchMove(Eu);var re=Cn[this.layer].vy?Cn[this.layer].vy*c:0,K=Cn[this.layer].vx?Cn[this.layer].vx*c:0;typeof f=="function"&&f.call(yt.dragged.parentNode[Bo],K,re,e,Eu,Cn[this.layer].el)!=="continue"||s1(Cn[this.layer].el,K,re)}).bind({layer:m}),24))),m++}while(t.bubbleScroll&&y!==d&&(y=ai(y,!1)));nf=h}},30),h1=function(t){var n=t.originalEvent,a=t.putSortable,o=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,c=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(n){var h=a||i;c();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(f.clientX,f.clientY);d(),h&&!h.el.contains(m)&&(l("spill"),this.onSpill({dragEl:o,putSortable:a}))}};function Rf(){}Rf.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,a=t.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var o=ir(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:h1};Ss(Rf,{pluginName:"revertOnSpill"});function Of(){}Of.prototype={onSpill:function(t){var n=t.dragEl,a=t.putSortable,o=a||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:h1};Ss(Of,{pluginName:"removeOnSpill"});yt.mount(new AI);yt.mount(Of,Rf);const EI=["data-id"],PI={key:0,class:"order-overlay"},ll={__name:"DraggableList",props:{items:{type:Array,required:!0},itemKey:{type:String,default:"id"},pinnedKey:{type:String,default:null},disabled:{type:Boolean,default:!1},layout:{type:String,default:"list"},showOrderOverlay:{type:Boolean,default:!0}},emits:["reorder"],setup(e,{emit:t}){const n=e,a=t,o=A(null),i=A(!1);let l=null;const c=A([...n.items]);Ye(()=>n.items,k=>{c.value=[...k]},{deep:!0}),Ye(()=>n.disabled,k=>{l&&l.option("disabled",k)});const d=k=>{i.value=!1;const{oldIndex:_,newIndex:x}=k;if(_===x)return;const D=c.value.splice(_,1)[0];c.value.splice(x,0,D);const M=c.value.map((S,w)=>({id:S[n.itemKey],displayOrder:w+1}));a("reorder",{items:c.value,changes:M})},h=()=>{i.value=!0},f=k=>{if(!n.pinnedKey)return!0;const _=k.dragged.dataset.id,x=c.value.find(I=>String(I[n.itemKey])===_);if(!x)return!0;const D=x[n.pinnedKey],M=k.related.dataset.id,S=c.value.find(I=>String(I[n.itemKey])===M);if(!S)return!0;const w=S[n.pinnedKey];return D===w},m=()=>{o.value&&(l=yt.create(o.value,{animation:200,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",disabled:n.disabled,onMove:f,onStart:h,onEnd:d}))},y=()=>{l&&(l.destroy(),l=null)};return un(()=>{cn(()=>{m()})}),Ln(()=>{y()}),(k,_)=>(p(),g("div",{ref_key:"listRef",ref:o,class:le(["draggable-list",{"draggable-grid":e.layout==="grid","is-dragging":i.value}])},[(p(!0),g(Ie,null,je(c.value,(x,D)=>(p(),g("div",{key:x[e.itemKey],"data-id":x[e.itemKey],class:"draggable-item"},[mo(k.$slots,"item",{element:x,index:D}),i.value&&e.showOrderOverlay?(p(),g("div",PI,b(D+1),1)):P("",!0)],8,EI))),128))],2))}},DI=["title"],rl={__name:"DragHandle",props:{disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(p(),g("span",{class:le(["drag-handle",{disabled:e.disabled}]),title:e.disabled?"":"Drag to reorder"},[...n[0]||(n[0]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><circle cx="5" cy="3" r="1.5"></circle><circle cx="11" cy="3" r="1.5"></circle><circle cx="5" cy="8" r="1.5"></circle><circle cx="11" cy="8" r="1.5"></circle><circle cx="5" cy="13" r="1.5"></circle><circle cx="11" cy="13" r="1.5"></circle></svg>',1)])],10,DI))}},RI={class:"checklists-tab"},OI={class:"tab-header"},BI={class:"button-group"},NI={class:"view-toggle"},FI={key:0,class:"status-pills"},UI={key:1,class:"status-pills"},zI={key:2,class:"status-pills"},HI={key:3,class:"status-pills"},VI={class:"filters-section"},GI={class:"search-group"},qI=["placeholder"],jI={class:"checklist-items-list"},WI={key:0,class:"empty-state"},ZI={class:"checklist-item-card"},KI={class:"checklist-item-content"},YI=["onClick"],JI={key:0,class:"loading-state"},XI={key:1,class:"empty-state"},QI={class:"filters-section"},ex={class:"search-group"},tx=["placeholder"],nx={class:"report-list"},ox={key:0,class:"empty-state"},ax=["onClick"],sx={class:"report-card-title"},ix={class:"expand-icon"},lx={class:"report-card-stats"},rx={key:0,class:"report-card-body"},cx={class:"task-text"},ux={key:0,class:"task-completed-by"},dx={key:0,class:"loading-state"},hx={key:1,class:"empty-state"},fx={class:"filters-section"},px={class:"search-group"},vx=["placeholder"],mx={class:"report-list"},gx={key:0,class:"empty-state"},yx=["onClick"],kx={class:"report-card-title"},bx={class:"expand-icon"},wx={class:"report-card-stats"},_x={key:0,class:"report-card-body"},Cx={key:0,class:"empty-state small"},Lx={class:"task-text"},Sx={key:0,class:"task-completed-by"},Ix={key:0,class:"loading-state"},xx={key:1,class:"empty-state"},$x={class:"filters-section"},Tx={class:"search-group"},Mx=["placeholder"],Ax={class:"report-list"},Ex={key:0,class:"empty-state"},Px=["onClick"],Dx={class:"report-card-title"},Rx={class:"expand-icon"},Ox={class:"report-card-stats"},Bx={class:"stat-badge secondary"},Nx={key:0,class:"report-card-body nested-body"},Fx=["onClick"],Ux={class:"nested-card-title"},zx={class:"expand-icon"},Hx={class:"nested-card-stats"},Vx={key:0,class:"nested-card-body"},Gx={class:"task-text"},qx={key:0,class:"task-completed-by"},jx={key:0,class:"loading-state"},Wx={key:1,class:"empty-state"},Zx={class:"filters-section"},Kx={class:"search-group"},Yx=["placeholder"],Jx={class:"report-list"},Xx={key:0,class:"empty-state"},Qx=["onClick"],e$={class:"report-card-title"},t$={class:"expand-icon"},n$={class:"report-card-title-text"},o$={key:0,class:"report-card-description"},a$={class:"report-card-stats"},s$={class:"stat-badge secondary"},i$={key:0,class:"report-card-body nested-body"},l$=["onClick"],r$={class:"nested-card-title"},c$={class:"expand-icon"},u$={class:"nested-card-stats"},d$={key:0,class:"nested-card-body"},h$={class:"task-text"},f$={key:0,class:"task-completed-by"},p$={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null},detailedReport:{type:Object,default:null},isLoadingDetailedReport:{type:Boolean,default:!1}},emits:["add-checklist-item","select-checklist-item","reorder","load-detailed-report"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A("define"),l=A(""),c=A(""),d=A(""),h=A(""),f=A(""),m=A("all"),y=A("all"),k=A("all"),_=A("all"),x=A(new Set),D=A(new Set),M=A(new Set),S=A(new Set),w=A(new Set),I=A(new Set),T=be=>{i.value=be,(be==="byPerson"||be==="byTask"||be==="byCheckpoint"||be==="byArea")&&!a.detailedReport&&!a.isLoadingDetailedReport&&o("load-detailed-report")},B=be=>{x.value.has(be)?x.value.delete(be):(x.value.clear(),x.value.add(be)),x.value=new Set(x.value)},E=be=>{D.value.has(be)?D.value.delete(be):(D.value.clear(),D.value.add(be)),D.value=new Set(D.value)},N=be=>{M.value.has(be)?(M.value.delete(be),w.value.clear()):(M.value.clear(),w.value.clear(),M.value.add(be)),M.value=new Set(M.value),w.value=new Set(w.value)},$=be=>{S.value.has(be)?(S.value.delete(be),I.value.clear()):(S.value.clear(),I.value.clear(),S.value.add(be)),S.value=new Set(S.value),I.value=new Set(I.value)},z=(be,V)=>{const Y=`${be}:${V}`;w.value.has(Y)?w.value.delete(Y):([...w.value].filter(se=>se.startsWith(`${be}:`)).forEach(se=>w.value.delete(se)),w.value.add(Y)),w.value=new Set(w.value)},O=(be,V)=>{const Y=`${be}:${V}`;I.value.has(Y)?I.value.delete(Y):([...I.value].filter(se=>se.startsWith(`${be}:`)).forEach(se=>I.value.delete(se)),I.value.add(Y)),I.value=new Set(I.value)},j=H(()=>{if(!l.value.trim())return a.checklistItems;const be=l.value.toLowerCase().trim().split(/\s+/);return a.checklistItems.filter(V=>{const Y=(V.text||"").toLowerCase();return be.every(de=>Y.includes(de))})}),Z=H(()=>[...j.value].sort((be,V)=>be.displayOrder!==V.displayOrder?be.displayOrder-V.displayOrder:ea(be.text,V.text))),J=(be,V)=>be===0?"incomplete":be===V?"complete":"partial",re=(be,V)=>be===0?"not-started":be===V?"complete":"partial",K=H(()=>{if(!a.detailedReport?.detailedByPerson)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByPerson;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),ie=H(()=>{if(!a.detailedReport?.detailedByTask)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByTask;return{total:be.length,incomplete:be.filter(V=>J(V.completedCount,V.applicableCount)==="incomplete").length,partial:be.filter(V=>J(V.completedCount,V.applicableCount)==="partial").length,complete:be.filter(V=>J(V.completedCount,V.applicableCount)==="complete").length}}),U=H(()=>{if(!a.detailedReport?.detailedByCheckpoint)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByCheckpoint;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),X=H(()=>{if(!a.detailedReport?.detailedByArea)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByArea;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),ae=H(()=>{if(!a.detailedReport?.detailedByPerson)return[];let be=a.detailedReport.detailedByPerson;if(m.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===m.value)),c.value.trim()){const V=c.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.marshalName||"").toLowerCase();return V.every(se=>de.includes(se))})}return be}),he=H(()=>{if(!a.detailedReport?.detailedByTask)return[];let be=a.detailedReport.detailedByTask;if(y.value!=="all"&&(be=be.filter(V=>J(V.completedCount,V.applicableCount)===y.value)),d.value.trim()){const V=d.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.text||"").toLowerCase();return V.every(se=>de.includes(se))})}return be}),$e=H(()=>{if(!a.detailedReport?.detailedByCheckpoint)return[];let be=[...a.detailedReport.detailedByCheckpoint];if(k.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===k.value)),h.value.trim()){const V=h.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.checkpointName||"").toLowerCase();return V.every(se=>de.includes(se))})}return be.sort((V,Y)=>ea(V.checkpointName,Y.checkpointName)),be}),Ee=H(()=>{if(!a.detailedReport?.detailedByArea)return[];let be=[...a.detailedReport.detailedByArea];if(_.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===_.value)),f.value.trim()){const V=f.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.areaName||"").toLowerCase();return V.every(se=>de.includes(se))})}return be.sort((V,Y)=>ea(V.areaName,Y.areaName)),be}),Me=be=>[...be].sort((V,Y)=>V.displayOrder!==Y.displayOrder?V.displayOrder-Y.displayOrder:ea(V.text,Y.text)),ze=({changes:be})=>{o("reorder",be)};return(be,V)=>(p(),g("div",RI,[r("div",OI,[r("div",BI,[r("div",NI,[r("button",{class:le(["view-toggle-btn",{active:i.value==="define"}]),onClick:V[0]||(V[0]=Y=>T("define"))}," Define ",2),r("button",{class:le(["view-toggle-btn",{active:i.value==="byArea"}]),onClick:V[1]||(V[1]=Y=>T("byArea"))}," By "+b(F(n).area),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byCheckpoint"}]),onClick:V[2]||(V[2]=Y=>T("byCheckpoint"))}," By "+b(F(n).checkpoint),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byPerson"}]),onClick:V[3]||(V[3]=Y=>T("byPerson"))}," By "+b(F(n).person),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byTask"}]),onClick:V[4]||(V[4]=Y=>T("byTask"))}," By "+b(F(n).checklist),3)]),i.value==="define"?(p(),g("button",{key:0,onClick:V[5]||(V[5]=Y=>be.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+b(F(n).checklist),1)):P("",!0)]),i.value==="byArea"&&X.value.total>0?(p(),g("div",FI,[Pe(Pt,{variant:"neutral",active:_.value==="all",onClick:V[6]||(V[6]=Y=>_.value="all")},{default:Ve(()=>[Je(b(X.value.total)+" total ",1)]),_:1},8,["active"]),X.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:_.value==="incomplete",onClick:V[7]||(V[7]=Y=>_.value="incomplete")},{default:Ve(()=>[Je(b(X.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),X.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:_.value==="partial",onClick:V[8]||(V[8]=Y=>_.value="partial")},{default:Ve(()=>[Je(b(X.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),X.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:_.value==="complete",onClick:V[9]||(V[9]=Y=>_.value="complete")},{default:Ve(()=>[Je(b(X.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byCheckpoint"&&U.value.total>0?(p(),g("div",UI,[Pe(Pt,{variant:"neutral",active:k.value==="all",onClick:V[10]||(V[10]=Y=>k.value="all")},{default:Ve(()=>[Je(b(U.value.total)+" total ",1)]),_:1},8,["active"]),U.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:k.value==="incomplete",onClick:V[11]||(V[11]=Y=>k.value="incomplete")},{default:Ve(()=>[Je(b(U.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),U.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:k.value==="partial",onClick:V[12]||(V[12]=Y=>k.value="partial")},{default:Ve(()=>[Je(b(U.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),U.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:k.value==="complete",onClick:V[13]||(V[13]=Y=>k.value="complete")},{default:Ve(()=>[Je(b(U.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byPerson"&&K.value.total>0?(p(),g("div",zI,[Pe(Pt,{variant:"neutral",active:m.value==="all",onClick:V[14]||(V[14]=Y=>m.value="all")},{default:Ve(()=>[Je(b(K.value.total)+" total ",1)]),_:1},8,["active"]),K.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:m.value==="incomplete",onClick:V[15]||(V[15]=Y=>m.value="incomplete")},{default:Ve(()=>[Je(b(K.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),K.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:m.value==="partial",onClick:V[16]||(V[16]=Y=>m.value="partial")},{default:Ve(()=>[Je(b(K.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),K.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:m.value==="complete",onClick:V[17]||(V[17]=Y=>m.value="complete")},{default:Ve(()=>[Je(b(K.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byTask"&&ie.value.total>0?(p(),g("div",HI,[Pe(Pt,{variant:"neutral",active:y.value==="all",onClick:V[18]||(V[18]=Y=>y.value="all")},{default:Ve(()=>[Je(b(ie.value.total)+" total ",1)]),_:1},8,["active"]),ie.value.incomplete>0?(p(),qe(Pt,{key:0,variant:"danger",active:y.value==="incomplete",onClick:V[19]||(V[19]=Y=>y.value="incomplete")},{default:Ve(()=>[Je(b(ie.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),ie.value.partial>0?(p(),qe(Pt,{key:1,variant:"warning",active:y.value==="partial",onClick:V[20]||(V[20]=Y=>y.value="partial")},{default:Ve(()=>[Je(b(ie.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),ie.value.complete>0?(p(),qe(Pt,{key:2,variant:"success",active:y.value==="complete",onClick:V[21]||(V[21]=Y=>y.value="complete")},{default:Ve(()=>[Je(b(ie.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),i.value==="define"?(p(),g(Ie,{key:0},[r("div",VI,[r("div",GI,[We(r("input",{"onUpdate:modelValue":V[22]||(V[22]=Y=>l.value=Y),type:"text",class:"search-input",placeholder:`Search ${F(n).checklists}...`},null,8,qI),[[at,l.value]])])]),r("div",jI,[j.value.length===0?(p(),g("div",WI,[r("p",null,b(l.value?`No ${F(n).checklists} match your search.`:`No ${F(n).checklists} yet. Create one to get started!`),1)])):(p(),qe(ll,{key:1,items:Z.value,"item-key":"itemId",disabled:!!l.value,onReorder:ze},{item:Ve(({element:Y})=>[r("div",ZI,[l.value?P("",!0):(p(),qe(rl,{key:0})),r("div",KI,[r("div",{class:"checklist-item-title",onClick:de=>be.$emit("select-checklist-item",Y,"details")},[r("strong",null,b(Y.text),1)],8,YI),Pe(ol,{class:"checklist-item-scopes","scope-configurations":Y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:de=>be.$emit("select-checklist-item",Y,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])])]),_:1},8,["items","disabled"]))])],64)):i.value==="byPerson"?(p(),g(Ie,{key:1},[e.isLoadingDetailedReport?(p(),g("div",JI,[...V[27]||(V[27]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Ie,{key:2},[r("div",QI,[r("div",ex,[We(r("input",{"onUpdate:modelValue":V[23]||(V[23]=Y=>c.value=Y),type:"text",class:"search-input",placeholder:`Search ${F(n).people}...`},null,8,tx),[[at,c.value]])])]),r("div",nx,[ae.value.length===0?(p(),g("div",ox,[r("p",null,b(c.value||m.value!=="all"?`No ${F(n).people} match your filters.`:`No ${F(n).people} with ${F(n).checklists}.`),1)])):P("",!0),(p(!0),g(Ie,null,je(ae.value,Y=>(p(),g("div",{key:Y.marshalId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>B(Y.marshalId)},[r("div",sx,[r("span",ix,b(x.value.has(Y.marshalId)?"":""),1),r("strong",null,b(Y.marshalName),1)]),r("div",lx,[r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,ax),x.value.has(Y.marshalId)?(p(),g("div",rx,[(p(!0),g(Ie,null,je(Me(Y.tasks),de=>(p(),g("div",{key:de.itemId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},b(de.isCompleted?"":""),3),r("span",cx,b(de.text),1),de.isCompleted&&de.completedBy?(p(),g("span",ux," by "+b(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",XI,[...V[28]||(V[28]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byTask"?(p(),g(Ie,{key:2},[e.isLoadingDetailedReport?(p(),g("div",dx,[...V[29]||(V[29]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Ie,{key:2},[r("div",fx,[r("div",px,[We(r("input",{"onUpdate:modelValue":V[24]||(V[24]=Y=>d.value=Y),type:"text",class:"search-input",placeholder:`Search ${F(n).checklists}...`},null,8,vx),[[at,d.value]])])]),r("div",mx,[he.value.length===0?(p(),g("div",gx,[r("p",null,b(d.value||y.value!=="all"?`No ${F(n).checklists} match your filters.`:`No ${F(n).checklists} defined.`),1)])):P("",!0),(p(!0),g(Ie,null,je(he.value,Y=>(p(),g("div",{key:Y.itemId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>E(Y.itemId)},[r("div",kx,[r("span",bx,b(D.value.has(Y.itemId)?"":""),1),r("strong",null,b(Y.text),1)]),r("div",wx,[r("span",{class:le(["stat-badge",re(Y.completedCount,Y.applicableCount)])},b(Y.completedCount)+" / "+b(Y.applicableCount),3)])],8,yx),D.value.has(Y.itemId)?(p(),g("div",_x,[Y.marshals.length===0?(p(),g("div",Cx,[r("p",null,"No "+b(F(n).people)+" assigned to this "+b(F(n).checklist)+".",1)])):P("",!0),(p(!0),g(Ie,null,je(Y.marshals,de=>(p(),g("div",{key:de.marshalId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},b(de.isCompleted?"":""),3),r("span",Lx,b(de.marshalName),1),de.isCompleted&&de.completedBy?(p(),g("span",Sx," by "+b(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",hx,[...V[30]||(V[30]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byArea"?(p(),g(Ie,{key:3},[e.isLoadingDetailedReport?(p(),g("div",Ix,[...V[31]||(V[31]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Ie,{key:2},[r("div",$x,[r("div",Tx,[We(r("input",{"onUpdate:modelValue":V[25]||(V[25]=Y=>f.value=Y),type:"text",class:"search-input",placeholder:`Search ${F(n).areas}...`},null,8,Mx),[[at,f.value]])])]),r("div",Ax,[Ee.value.length===0?(p(),g("div",Ex,[r("p",null,b(f.value||_.value!=="all"?`No ${F(n).areas} match your filters.`:`No ${F(n).areas} with ${F(n).people}.`),1)])):P("",!0),(p(!0),g(Ie,null,je(Ee.value,Y=>(p(),g("div",{key:Y.areaId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>$(Y.areaId)},[r("div",Dx,[r("span",Rx,b(S.value.has(Y.areaId)?"":""),1),r("strong",null,b(Y.areaName),1)]),r("div",Ox,[r("span",Bx,b(Y.totalPeople)+" "+b(Y.totalPeople===1?F(n).person:F(n).people),1),r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,Px),S.value.has(Y.areaId)?(p(),g("div",Nx,[(p(!0),g(Ie,null,je(Y.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(se=>O(Y.areaId,de.marshalId),["stop"])},[r("div",Ux,[r("span",zx,b(I.value.has(`${Y.areaId}:${de.marshalId}`)?"":""),1),r("strong",null,b(de.marshalName),1)]),r("div",Hx,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},b(de.completedTasks)+" / "+b(de.totalTasks),3)])],8,Fx),I.value.has(`${Y.areaId}:${de.marshalId}`)?(p(),g("div",Vx,[(p(!0),g(Ie,null,je(Me(de.tasks),se=>(p(),g("div",{key:se.itemId,class:"task-row"},[r("span",{class:le(["task-status",se.isCompleted?"completed":"pending"])},b(se.isCompleted?"":""),3),r("span",Gx,b(se.text),1),se.isCompleted&&se.completedBy?(p(),g("span",qx," by "+b(se.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",xx,[...V[32]||(V[32]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byCheckpoint"?(p(),g(Ie,{key:4},[e.isLoadingDetailedReport?(p(),g("div",jx,[...V[33]||(V[33]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(Ie,{key:2},[r("div",Zx,[r("div",Kx,[We(r("input",{"onUpdate:modelValue":V[26]||(V[26]=Y=>h.value=Y),type:"text",class:"search-input",placeholder:`Search ${F(n).checkpoints}...`},null,8,Yx),[[at,h.value]])])]),r("div",Jx,[$e.value.length===0?(p(),g("div",Xx,[r("p",null,b(h.value||k.value!=="all"?`No ${F(n).checkpoints} match your filters.`:`No ${F(n).checkpoints} with ${F(n).people}.`),1)])):P("",!0),(p(!0),g(Ie,null,je($e.value,Y=>(p(),g("div",{key:Y.checkpointId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>N(Y.checkpointId)},[r("div",e$,[r("span",t$,b(M.value.has(Y.checkpointId)?"":""),1),r("div",n$,[r("strong",null,b(Y.checkpointName),1),Y.checkpointDescription?(p(),g("span",o$,b(Y.checkpointDescription),1)):P("",!0)])]),r("div",a$,[r("span",s$,b(Y.totalPeople)+" "+b(Y.totalPeople===1?F(n).person:F(n).people),1),r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,Qx),M.value.has(Y.checkpointId)?(p(),g("div",i$,[(p(!0),g(Ie,null,je(Y.people,de=>(p(),g("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(se=>z(Y.checkpointId,de.marshalId),["stop"])},[r("div",r$,[r("span",c$,b(w.value.has(`${Y.checkpointId}:${de.marshalId}`)?"":""),1),r("strong",null,b(de.marshalName),1)]),r("div",u$,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},b(de.completedTasks)+" / "+b(de.totalTasks),3)])],8,l$),w.value.has(`${Y.checkpointId}:${de.marshalId}`)?(p(),g("div",d$,[(p(!0),g(Ie,null,je(Me(de.tasks),se=>(p(),g("div",{key:se.itemId,class:"task-row"},[r("span",{class:le(["task-status",se.isCompleted?"completed":"pending"])},b(se.isCompleted?"":""),3),r("span",h$,b(se.text),1),se.isCompleted&&se.completedBy?(p(),g("span",f$," by "+b(se.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),g("div",Wx,[...V[34]||(V[34]=[r("p",null,"No report data available.",-1)])]))],64)):P("",!0)]))}},v$=Ke(p$,[["__scopeId","data-v-48e233e8"]]),m$={class:"notes-tab"},g$={class:"tab-header"},y$={class:"button-group"},k$={class:"filters-section"},b$={class:"search-group"},w$={class:"notes-list"},_$={key:0,class:"empty-state"},C$=["onClick"],L$={class:"note-header"},S$={class:"note-title-row"},I$={key:0,class:"pin-icon",title:"Pinned"},x$={key:1,class:"emergency-indicator",title:"Shown in emergency info"},$$={class:"note-meta"},T$={key:0,class:"category-badge"},M$={class:"created-info"},A$={key:0,class:"note-preview"},E$={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note","reorder"],setup(e,{emit:t}){const n=e,a=t,o=A(""),i=H(()=>{if(!o.value.trim())return n.notes;const f=o.value.toLowerCase().trim().split(/\s+/);return n.notes.filter(m=>{const y=`${m.title||""} ${m.content||""} ${m.priority||""}`.toLowerCase();return f.every(k=>y.includes(k))})}),l=H(()=>{const f={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((m,y)=>{if(m.isPinned!==y.isPinned)return m.isPinned?-1:1;const k=f[m.priority]??2,_=f[y.priority]??2;return k!==_?k-_:m.displayOrder!==y.displayOrder?m.displayOrder-y.displayOrder:ea(m.title,y.title)})}),c=({changes:f})=>{const m=f.map(y=>({id:y.id,displayOrder:y.displayOrder}));a("reorder",m)},d=f=>{if(!f)return"";const m=150;return f.length<=m?f:f.substring(0,m)+"..."},h=f=>{if(!f)return"";const m=new Date(f),k=new Date-m,_=Math.floor(k/6e4),x=Math.floor(k/36e5),D=Math.floor(k/864e5);return _<1?"Just now":_<60?`${_}m ago`:x<24?`${x}h ago`:D<7?`${D}d ago`:m.toLocaleDateString()};return(f,m)=>(p(),g("div",m$,[r("div",g$,[r("div",y$,[r("button",{onClick:m[0]||(m[0]=y=>f.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",k$,[r("div",b$,[We(r("input",{"onUpdate:modelValue":m[1]||(m[1]=y=>o.value=y),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[at,o.value]])])]),r("div",w$,[i.value.length===0?(p(),g("div",_$,[r("p",null,b(o.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):(p(),qe(ll,{key:1,items:l.value,"item-key":"noteId","pinned-key":"isPinned",disabled:!!o.value,onReorder:c},{item:Ve(({element:y})=>[r("div",{class:le(["note-card",{pinned:y.isPinned}])},[o.value?P("",!0):(p(),qe(rl,{key:0})),r("div",{class:"note-content",onClick:k=>f.$emit("select-note",y)},[r("div",L$,[r("div",S$,[y.isPinned?(p(),g("span",I$,"")):P("",!0),r("span",{class:le(["priority-indicator",y.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,b(y.title),1),y.showInEmergencyInfo?(p(),g("span",x$,"")):P("",!0)]),r("div",$$,[y.category?(p(),g("span",T$,b(y.category),1)):P("",!0),r("span",M$,b(h(y.createdAt)),1)])]),y.content?(p(),g("div",A$,b(d(y.content)),1)):P("",!0),Pe(ol,{"scope-configurations":y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],8,C$)],2)]),_:1},8,["items","disabled"]))])]))}},P$=Ke(E$,[["__scopeId","data-v-715ffc72"]]),D$={class:"contacts-tab"},R$={class:"tab-header"},O$={class:"button-group"},B$={key:0,class:"status-pills"},N$={class:"filters-section"},F$={class:"search-group"},U$={class:"contacts-list"},z$={key:0,class:"empty-state"},H$=["onClick"],V$={class:"contact-header"},G$={class:"contact-name-row"},q$={key:0,class:"pin-icon",title:"Pinned"},j$={key:1,class:"primary-badge",title:"Primary contact"},W$={key:2,class:"emergency-indicator",title:"Shown in emergency info"},Z$={class:"contact-roles"},K$={class:"contact-details"},Y$={key:0,class:"contact-detail"},J$={key:1,class:"contact-detail"},X$={key:0,class:"contact-notes"},Q$={key:2,class:"no-scope-warning"},eT={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]}},emits:["add-contact","select-contact","reorder"],setup(e,{emit:t}){const n=e,a=t,o=A(""),i=A("all"),l=H(()=>n.contacts.filter(w=>!w.scopeConfigurations||w.scopeConfigurations.length===0).length),c=H(()=>n.contacts.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0).length),d=w=>{i.value=w},h=w=>w?w.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=H(()=>{const w=new Map;for(const I of n.roleDefinitions)w.set(I.roleId,I.name),w.set(I.name,I.name);return w}),m=w=>{if(!w)return"";const I=f.value.get(w);return I||w.replace(/([A-Z])/g," $1").replace(/^./,T=>T.toUpperCase()).trim()},y=w=>w.roles&&Array.isArray(w.roles)&&w.roles.length>0?w.roles:w.role?[w.role]:[],k=w=>y(w).map(m).join(" "),_=w=>{if(!w)return"";const I=100;return w.length<=I?w:w.substring(0,I)+"..."},x=H(()=>{let w=n.contacts;if(i.value==="no-scope"?w=w.filter(I=>!I.scopeConfigurations||I.scopeConfigurations.length===0):i.value==="with-scope"&&(w=w.filter(I=>I.scopeConfigurations&&I.scopeConfigurations.length>0)),o.value.trim()){const T=h(o.value).split(" ").filter(B=>B.length>0);w=w.filter(B=>{const E=k(B),N=h(`${B.name||""} ${E} ${B.email||""} ${B.phone||""}`);return T.every($=>N.includes($))})}return w}),D=H(()=>[...x.value].sort((w,I)=>{if(w.isPinned!==I.isPinned)return w.isPinned?-1:1;const T=w.displayOrder||0,B=I.displayOrder||0;return T!==B?T-B:(w.name||"").localeCompare(I.name||"",void 0,{sensitivity:"base"})})),M=H(()=>{const w=o.value.trim();return i.value==="no-scope"?w?"No unassigned contacts match your search.":"All contacts are assigned.":i.value==="with-scope"?w?"No assigned contacts match your search.":"No contacts are assigned yet.":w?"No contacts match your search.":"No contacts yet. Create one to get started!"}),S=({changes:w})=>{a("reorder",w)};return(w,I)=>(p(),g("div",D$,[r("div",R$,[r("div",O$,[r("button",{onClick:I[0]||(I[0]=T=>w.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(p(),g("div",B$,[Pe(Pt,{variant:"neutral",active:i.value==="all",onClick:I[1]||(I[1]=T=>d("all"))},{default:Ve(()=>[Je(b(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0&&c.value<e.contacts.length?(p(),qe(Pt,{key:0,variant:"success",active:i.value==="with-scope",onClick:I[2]||(I[2]=T=>d("with-scope"))},{default:Ve(()=>[Je(b(c.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),l.value>0&&l.value<e.contacts.length?(p(),qe(Pt,{key:1,variant:"danger",active:i.value==="no-scope",onClick:I[3]||(I[3]=T=>d("no-scope"))},{default:Ve(()=>[Je(b(l.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",N$,[r("div",F$,[We(r("input",{"onUpdate:modelValue":I[4]||(I[4]=T=>o.value=T),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[at,o.value]])])]),r("div",U$,[x.value.length===0?(p(),g("div",z$,[r("p",null,b(M.value),1)])):(p(),qe(ll,{key:1,items:D.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!!o.value||i.value!=="all",onReorder:S},{item:Ve(({element:T})=>[r("div",{class:le(["contact-card",{pinned:T.isPinned,primary:T.isPrimary}])},[!o.value&&i.value==="all"?(p(),qe(rl,{key:0})):P("",!0),r("div",{class:"contact-content",onClick:B=>w.$emit("select-contact",T)},[r("div",V$,[r("div",G$,[T.isPinned?(p(),g("span",q$,"")):P("",!0),T.isPrimary?(p(),g("span",j$,"")):P("",!0),r("strong",null,b(T.name),1),T.showInEmergencyInfo?(p(),g("span",W$,"")):P("",!0)]),r("div",Z$,[(p(!0),g(Ie,null,je(y(T),B=>(p(),g("span",{key:B,class:le(["role-badge",{"emergency-role":B==="Emergency"}])},b(m(B)),3))),128))])]),r("div",K$,[T.phone?(p(),g("span",Y$,b(T.phone),1)):P("",!0),T.email?(p(),g("span",J$,b(T.email),1)):P("",!0)]),T.notes?(p(),g("div",X$,b(_(T.notes)),1)):P("",!0),T.scopeConfigurations&&T.scopeConfigurations.length>0?(p(),qe(ol,{key:1,"scope-configurations":T.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("div",Q$," No visibility scope configured "))],8,H$)],2)]),_:1},8,["items","disabled"]))])]))}},tT=Ke(eT,[["__scopeId","data-v-83f433bf"]]),nT={class:"roles-tab"},oT={class:"tab-header"},aT={class:"button-group"},sT={key:0,class:"status-pills"},iT={class:"filters-section"},lT={class:"search-group"},rT={class:"roles-list"},cT={key:0,class:"empty-state"},uT=["onClick"],dT={class:"role-header"},hT={class:"role-name-row"},fT={key:0,class:"built-in-badge",title:"Built-in role"},pT={class:"role-usage"},vT={key:0,class:"role-notes"},mT={key:1,class:"role-notes empty"},gT={__name:"RolesTab",props:{roleDefinitions:{type:Array,required:!0}},emits:["add-role","select-role","reorder"],setup(e,{emit:t}){const n=e,a=t,o=A(""),i=H(()=>n.roleDefinitions.reduce((y,k)=>y+(k.usageCount||0),0)),l=y=>y?y.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",c=y=>{if(!y)return"";const k=150;return y.length<=k?y:y.substring(0,k)+"..."},d=H(()=>{if(!o.value.trim())return n.roleDefinitions;const k=l(o.value).split(" ").filter(_=>_.length>0);return n.roleDefinitions.filter(_=>{const x=l(`${_.name||""} ${_.notes||""}`);return k.every(D=>x.includes(D))})}),h=H(()=>[...d.value].sort((y,k)=>{const _=y.displayOrder||0,x=k.displayOrder||0;return _!==x?_-x:(y.name||"").localeCompare(k.name||"",void 0,{numeric:!0,sensitivity:"base"})})),f=H(()=>o.value.trim()?"No roles match your search.":"No roles defined yet. Create one to get started!"),m=({changes:y})=>{a("reorder",y)};return(y,k)=>(p(),g("div",nT,[r("div",oT,[r("div",aT,[r("button",{onClick:k[0]||(k[0]=_=>y.$emit("add-role")),class:"btn btn-primary"}," Add role ")]),e.roleDefinitions.length>0?(p(),g("div",sT,[Pe(Pt,{variant:"neutral"},{default:Ve(()=>[Je(b(e.roleDefinitions.length)+" "+b(e.roleDefinitions.length===1?"role":"roles"),1)]),_:1}),i.value>0?(p(),qe(Pt,{key:0,variant:"success"},{default:Ve(()=>[Je(b(i.value)+" "+b(i.value===1?"assignment":"assignments"),1)]),_:1})):P("",!0)])):P("",!0)]),r("div",iT,[r("div",lT,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>o.value=_),type:"text",class:"search-input",placeholder:"Search by name or notes..."},null,512),[[at,o.value]])])]),r("div",rT,[d.value.length===0?(p(),g("div",cT,[r("p",null,b(f.value),1)])):(p(),qe(ll,{key:1,items:h.value,"item-key":"roleId",disabled:!!o.value,onReorder:m},{item:Ve(({element:_})=>[r("div",{class:le(["role-card",{"built-in":_.isBuiltIn}])},[o.value?P("",!0):(p(),qe(rl,{key:0})),r("div",{class:"role-content",onClick:x=>y.$emit("select-role",_)},[r("div",dT,[r("div",hT,[r("strong",null,b(_.name),1),_.isBuiltIn?(p(),g("span",fT,"Built-in")):P("",!0)]),r("div",pT,[r("span",{class:le(["usage-badge",{"has-usage":_.usageCount>0}])},b(_.usageCount)+" "+b(_.usageCount===1?"person":"people"),3)])]),_.notes?(p(),g("div",vT,b(c(_.notes)),1)):(p(),g("div",mT," No notes "))],8,uT)],2)]),_:1},8,["items","disabled"]))])]))}},yT=Ke(gT,[["__scopeId","data-v-634d49c0"]]),f1=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],kT={class:"event-details-tab"},bT={class:"event-info-card"},wT={class:"form-group"},_T={class:"form-group"},CT={class:"form-row"},LT={class:"form-group"},ST={class:"form-group"},IT=["value"],xT={class:"form-actions"},$T=["disabled"],TT={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const n=e,a=t,o=A({...n.eventData});Ye(()=>n.eventData,c=>{o.value={...c}},{deep:!0});const i=()=>{a("update:formDirty",!0)},l=()=>{a("submit",{...o.value})};return(c,d)=>(p(),g("div",kT,[r("div",bT,[r("form",{onSubmit:ct(l,["prevent"]),class:"event-details-form"},[r("div",wT,[d[4]||(d[4]=r("label",null,"Event name",-1)),We(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>o.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[at,o.value.name]])]),r("div",_T,[d[5]||(d[5]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>o.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[at,o.value.description]])]),r("div",CT,[r("div",LT,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),We(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>o.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[at,o.value.eventDate]])]),r("div",ST,[d[7]||(d[7]=r("label",null,"Time zone",-1)),We(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(p(!0),g(Ie,null,je(F(f1),h=>(p(),g("option",{key:h.value,value:h.value},b(h.label),9,IT))),128))],544),[[Qn,o.value.timeZoneId]])])]),r("div",xT,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,$T)])],32)])]))}},MT=Ke(TT,[["__scopeId","data-v-2754c3cc"]]),AT={class:"admins-list"},ET={class:"admin-info"},PT={class:"admin-role"},DT=["onClick"],RT={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,n)=>(p(),g("div",null,[r("button",{onClick:n[0]||(n[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",AT,[(p(!0),g(Ie,null,je(e.admins,a=>(p(),g("div",{key:a.userEmail,class:"admin-item"},[r("div",ET,[r("strong",null,b(a.userEmail),1),r("span",PT,b(a.role),1)]),e.admins.length>1?(p(),g("button",{key:0,onClick:o=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,DT)):P("",!0)]))),128))])]))}},OT=Ke(RT,[["__scopeId","data-v-e526860b"]]),BT={class:"modal-content"},NT={class:"modal-body"},FT={class:"preview-section"},UT={class:"map-preview"},zT=["innerHTML"],HT={class:"options-grid"},VT={class:"option-button-content"},GT={class:"option-button-value icon-value"},qT=["innerHTML"],jT={class:"option-button-content"},WT={class:"option-button-value color-value"},ZT=["disabled"],KT={class:"option-button-content"},YT={class:"option-button-value color-value"},JT={class:"option-button-content"},XT={class:"option-button-value icon-value"},QT=["innerHTML"],eM=["disabled"],tM={class:"option-button-content"},nM={class:"option-button-value color-value"},oM={class:"option-button-content"},aM={class:"option-button-value"},sM={class:"option-button-content"},iM={class:"option-button-value"},lM={key:0,class:"centered-popup"},rM={class:"popup-grid"},cM=["onClick"],uM=["innerHTML"],dM={key:0},hM={key:1,class:"centered-popup"},fM={class:"popup-grid"},pM=["title","onClick"],vM=["innerHTML"],mM={key:0},gM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},yM={key:1,class:"custom-check-mark"},kM={key:0,class:"custom-hex-input"},bM={class:"hex-input-row"},wM=["disabled"],_M={key:0,class:"hex-error"},CM={key:2,class:"centered-popup"},LM={class:"popup-grid"},SM=["title","onClick"],IM=["innerHTML"],xM={key:0},$M={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},TM={key:1,class:"custom-check-mark"},MM={key:0,class:"custom-hex-input"},AM={class:"hex-input-row"},EM=["disabled"],PM={key:0,class:"hex-error"},DM={key:3,class:"centered-popup icon-popup"},RM={class:"popup-grid"},OM=["onClick"],BM=["innerHTML"],NM={key:0},FM={key:4,class:"centered-popup"},UM={class:"popup-grid"},zM=["title","onClick"],HM=["innerHTML"],VM={key:0},GM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},qM={key:1,class:"custom-check-mark"},jM={key:0,class:"custom-hex-input"},WM={class:"hex-input-row"},ZM=["disabled"],KM={key:0,class:"hex-error"},YM={key:5,class:"centered-popup"},JM={class:"size-grid"},XM=["onClick"],QM=["innerHTML"],eA={key:6,class:"centered-popup"},tA={class:"rotation-content"},nA={class:"rotation-preview-container"},oA=["innerHTML"],aA={class:"rotation-control"},sA={class:"rotation-slider-container"},iA=["value"],lA={class:"rotation-value"},rA={class:"rotation-presets"},cA="#667eea",uA={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const n=e,a=t,o=A(n.backgroundShape||"circle"),i=A(n.iconType||"none"),l=A(n.backgroundColor||""),c=A(n.borderColor||""),d=A(n.iconColor||""),h=A(n.size||"100"),f=A(n.mapRotation??""),m=A(null),y=A(!1),k=A(!1),_=A(!1),x=A(""),D=A(""),M=A(""),S=A(null),w=A(null),I=A(null),T=pe=>pe==="default"?n.inheritedBackgroundShape||"circle":pe==="none"?"none":pe||"circle",B=pe=>pe==="default"||!pe?U():pe==="none"?"transparent":pe,E=pe=>pe==="default"?n.inheritedBorderColor||"#ffffff":pe==="none"||!pe?"transparent":pe,N=pe=>{if(pe==="default"){const ve=n.inheritedType;return ve&&ve!=="default"&&el(ve).category==="content"?ve:"none"}return pe==="none"||!pe?"none":pe},$=pe=>pe==="default"||!pe?n.inheritedIconColor||"#ffffff":pe==="none"?"transparent":pe,z=pe=>pe==="default"?n.inheritedSize||"100":pe||"100",O=pe=>{if(pe==="default"||pe===""){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null&&parseInt(ve,10)||0}return parseInt(pe,10)||0},j=H(()=>{const pe=n.inheritedBackgroundShape||"circle",ve=Uc.find(Le=>Le.value===pe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ve})`,showLabel:!0},...Uc.filter(Le=>Le.value!=="none").map(Le=>({...Le,showLabel:!1}))]}),Z=H(()=>{const pe=Su.filter(lt=>lt.category==="content"),ve=[{value:"none",label:"None",category:"content",showLabel:!0}],Le=n.inheritedType;if(Le&&Le!=="default"){const lt=el(Le);lt.category==="content"&&ve.push({value:"default",label:`Default (${lt.label||Le})`,category:"content",showLabel:!0})}return ve.push(...pe.map(lt=>({...lt,showLabel:!1}))),ve}),J=H(()=>{const pe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${pe[n.inheritedSize]||"Normal"})`},...g2.map(Le=>({value:Le.value,label:pe[Le.value]||Le.label}))]}),re=H(()=>T(o.value)!=="none"),K=H(()=>N(i.value)!=="none"),ie=H(()=>{const pe=n.inheritedBackgroundColor;return pe&&pe!=="default"&&pe.startsWith("#")?pe:cA}),U=()=>ie.value,X=H(()=>l.value&&l.value!=="default"?l.value:U()),ae=H(()=>c.value==="none"?"transparent":c.value?c.value:n.inheritedBorderColor&&n.inheritedBorderColor!=="none"?n.inheritedBorderColor:"#ffffff"),he=H(()=>d.value?d.value:n.inheritedIconColor?n.inheritedIconColor:"#ffffff"),$e=H(()=>{const pe=ie.value,ve=Un.find(Le=>Le.hex.toLowerCase()===pe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},...Un.map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),Ee=H(()=>{const pe=n.inheritedBorderColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Le=>Le.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Le=>Le.hex!=="#ffffff").map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),Me=H(()=>{const pe=n.inheritedIconColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Le=>Le.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Le=>Le.hex!=="#ffffff").map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),ze=pe=>pe==="default"?!l.value||l.value==="default":l.value===pe,be=pe=>pe==="#ffffff"?!d.value||d.value==="#ffffff":d.value===pe,V=H(()=>{const pe=l.value;return!pe||pe==="default"||pe==="none"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),Y=H(()=>{const pe=c.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),de=H(()=>{const pe=d.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),se=H(()=>{if(!x.value)return!1;const pe=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Re=H(()=>{if(!D.value)return!1;const pe=D.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),q=H(()=>{if(!M.value)return!1;const pe=M.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Q=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedBackgroundShape;return Le?`Default (${Uc.find(Qe=>Qe.value===Le)?.label||"Circle"})`:"Default (Circle)"}const ve=Uc.find(Le=>Le.value===pe);return ve?ve.label:"Circle"},ee=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedType;if(Le&&Le!=="default"){const lt=el(Le);if(lt.category==="content")return`Default (${lt.label||Le})`}return"Default"}const ve=Su.find(Le=>Le.value===pe);return ve?ve.label:"None"},_e=pe=>{if(pe==="none")return"None";if(!pe||pe==="default"){const Le=ie.value;return`Default (${Un.find(Qe=>Qe.hex.toLowerCase()===Le.toLowerCase())?.name||"Custom"})`}const ve=[...Un].find(Le=>Le.hex.toLowerCase()===pe.toLowerCase());return ve?ve.name:pe},Be=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedBorderColor;return Le&&Le!=="none"?`Default (${Le==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Le)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...Ee.value].find(Le=>Le.hex===pe);return ve?ve.name:pe},Ue=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedIconColor;return Le?`Default (${Le==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Le)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...Me.value].find(Le=>Le.hex===pe);return ve?ve.name:pe},Ae=pe=>{const ve={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(pe==="default"){const Le=n.inheritedSize;return`Default (${ve[Le]||"Normal"})`}return ve[pe]||"Normal"},ne=pe=>{if(pe==="default"||pe===""||pe===void 0||pe===null){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null?`Default (${ve})`:"Default (0)"}return`${pe}`},ge=pe=>{if(pe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ve=T(pe),Le=B(l.value),lt=E(c.value);return jl[ve]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${jl[ve]({backgroundColor:Le,borderColor:lt==="transparent"?"none":lt})}</svg>`:""},Oe=pe=>{const ve=N(pe);return ve==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:zn({type:ve,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},De=pe=>{const ve=T(pe);if(ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Le=B(l.value),lt=E(c.value),Qe=N(i.value),Ot=$(d.value);return zn({type:Qe!=="none"?Qe:ve,backgroundShape:ve,backgroundColor:Le,borderColor:lt==="transparent"?"none":lt,iconColor:Ot,size:"100",outputSize:28})},xe=pe=>{const ve=B(pe),Le=T(o.value),lt=E(c.value),Qe=N(i.value),Ot=$(d.value);return Le==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Le,backgroundShape:Le,backgroundColor:ve==="transparent"?"#e2e8f0":ve,borderColor:lt==="transparent"?"none":lt,iconColor:Ot,size:"100",outputSize:28})},me=pe=>{const ve=E(pe),Le=T(o.value),lt=B(l.value),Qe=N(i.value),Ot=$(d.value);return Le==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ve}" stroke-width="2"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Le,backgroundShape:Le,backgroundColor:lt,borderColor:ve==="transparent"?"none":ve,iconColor:Ot,size:"100",outputSize:28})},Ze=pe=>{const ve=N(pe),Le=T(o.value),lt=B(l.value),Qe=E(c.value),Ot=$(d.value);if(ve==="none"&&Le==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const on=Le!=="none"?Le:"circle";return zn({type:ve!=="none"?ve:on,backgroundShape:on,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:Ot,size:"100",outputSize:42})},Ge=pe=>{const ve=$(pe),Le=T(o.value),lt=B(l.value),Qe=E(c.value),Ot=N(i.value);return Ot==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Ot,backgroundShape:Le!=="none"?Le:"circle",backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:ve==="transparent"?"#e2e8f0":ve,size:"100",outputSize:28})},fe=pe=>{const ve=z(pe),Le=T(o.value),lt=B(l.value),Qe=E(c.value),Ot=N(i.value),on=$(d.value);if(Le==="none"&&Ot==="none")return"";const mn=Le!=="none"?Le:"circle";return zn({type:Ot!=="none"?Ot:mn,backgroundShape:mn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:on,size:ve})},ke=H(()=>{const pe=T(o.value),ve=B(l.value),Le=E(c.value),lt=N(i.value),Qe=$(d.value),Ot=z(h.value);return pe==="none"&&lt==="none"?"":zn(pe==="none"&&lt!=="none"?{type:lt,backgroundShape:"none",backgroundColor:ve,borderColor:"none",iconColor:Qe,size:Ot}:{type:lt!=="none"?lt:pe,backgroundShape:pe,backgroundColor:ve,borderColor:Le==="transparent"?"none":Le,iconColor:Qe,size:Ot})}),te=pe=>{m.value=m.value===pe?null:pe},ye=()=>{m.value=null,y.value=!1,k.value=!1,_.value=!1},He=pe=>{o.value=pe,ye()},rt=pe=>{l.value=pe,ye()},kt=pe=>{c.value=pe,ye()},Rt=pe=>{i.value=pe,ye()},Lt=pe=>{d.value=pe,ye()},xt=pe=>{h.value=pe,ye()},Kt=pe=>{f.value=pe,ye()},no=()=>{y.value=!y.value,y.value&&(V.value?x.value=l.value.replace(/^#/,""):x.value="",cn(()=>S.value?.focus()))},Mo=()=>{k.value=!k.value,k.value&&(Y.value?D.value=c.value.replace(/^#/,""):D.value="",cn(()=>w.value?.focus()))},ft=()=>{_.value=!_.value,_.value&&(de.value?M.value=d.value.replace(/^#/,""):M.value="",cn(()=>I.value?.focus()))},Ct=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Mt=()=>{D.value=D.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Mn=()=>{M.value=M.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},go=pe=>pe.length===3?pe[0]+pe[0]+pe[1]+pe[1]+pe[2]+pe[2]:pe,oo=()=>{if(!se.value)return;const pe=go(x.value);l.value="#"+pe,y.value=!1,ye()},An=()=>{if(!Re.value)return;const pe=go(D.value);c.value="#"+pe,k.value=!1,ye()},tn=()=>{if(!q.value)return;const pe=go(M.value);d.value="#"+pe,_.value=!1,ye()},Pa=pe=>{f.value=pe};Ye(()=>n.isOpen,pe=>{if(pe){const ve=n.backgroundShape&&n.backgroundShape!=="default"&&n.backgroundShape!=="circle",Le=n.iconType&&n.iconType!=="none"&&n.iconType!=="default",lt=n.backgroundColor&&n.backgroundColor!=="",Qe=n.borderColor&&n.borderColor!=="",Ot=n.iconColor&&n.iconColor!=="",on=n.size&&n.size!==""&&n.size!=="100",mn=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null&&n.mapRotation!==0;ve||Le||lt||Qe||Ot||on||mn?(o.value=n.backgroundShape||"default",i.value=n.iconType||"default",l.value=n.backgroundColor||"default",c.value=n.borderColor||"default",d.value=n.iconColor||"default",h.value=n.size||"default",f.value=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null?n.mapRotation:"default"):(o.value="default",i.value="default",l.value="default",c.value="default",d.value="default",h.value="default",f.value="default"),m.value=null}});const yo=()=>{ye(),a("update:isOpen",!1),a("cancel")},Uo=()=>{ye();const pe=lt=>lt==="default"?"":lt;let ve="";i.value==="none"?ve="none":i.value&&i.value!=="default"&&(ve=i.value);let Le="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Le=parseInt(f.value,10)||0),a("apply",{iconType:ve,backgroundShape:pe(o.value),backgroundColor:pe(l.value),borderColor:pe(c.value),iconColor:pe(d.value),size:pe(h.value),mapRotation:Le}),a("update:isOpen",!1)};return(pe,ve)=>e.isOpen?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(yo,["self"])},[r("div",BT,[r("div",{class:"modal-header"},[ve[18]||(ve[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:yo},"")]),r("div",NT,[r("div",FT,[r("div",UT,[ve[19]||(ve[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:tt({transform:`rotate(${O(f.value)}deg)`}),innerHTML:ke.value},null,12,zT)])]),r("div",HT,[r("button",{type:"button",class:le(["option-button",{active:m.value==="shape"}]),onClick:ve[0]||(ve[0]=Le=>te("shape"))},[r("div",VT,[ve[20]||(ve[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",GT,[r("div",{class:"icon-preview-small",innerHTML:ge(o.value)},null,8,qT),r("span",null,b(Q(o.value)),1)])]),ve[21]||(ve[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="bgColor"}]),onClick:ve[1]||(ve[1]=Le=>te("bgColor"))},[r("div",jT,[ve[22]||(ve[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",WT,[r("span",{class:"color-swatch",style:tt({backgroundColor:X.value})},null,4),r("span",null,b(_e(l.value)),1)])]),ve[23]||(ve[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="borderColor",disabled:!re.value}]),disabled:!re.value,onClick:ve[2]||(ve[2]=Le=>te("borderColor"))},[r("div",KT,[ve[24]||(ve[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",YT,[r("span",{class:le(["color-swatch",{"no-border":c.value==="none"}]),style:tt(c.value!=="none"?{backgroundColor:ae.value}:{})},null,6),r("span",null,b(Be(c.value)),1)])]),ve[25]||(ve[25]=r("span",{class:"option-button-arrow"},"",-1))],10,ZT),r("button",{type:"button",class:le(["option-button",{active:m.value==="icon"}]),onClick:ve[3]||(ve[3]=Le=>te("icon"))},[r("div",JT,[ve[26]||(ve[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",XT,[r("div",{class:"icon-preview-small",innerHTML:Oe(i.value)},null,8,QT),r("span",null,b(ee(i.value)),1)])]),ve[27]||(ve[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="iconColor",disabled:!K.value}]),disabled:!K.value,onClick:ve[4]||(ve[4]=Le=>te("iconColor"))},[r("div",tM,[ve[28]||(ve[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",nM,[r("span",{class:"color-swatch",style:tt({backgroundColor:he.value})},null,4),r("span",null,b(Ue(d.value)),1)])]),ve[29]||(ve[29]=r("span",{class:"option-button-arrow"},"",-1))],10,eM),r("button",{type:"button",class:le(["option-button",{active:m.value==="size"}]),onClick:ve[5]||(ve[5]=Le=>te("size"))},[r("div",oM,[ve[30]||(ve[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",aM,b(Ae(h.value)),1)]),ve[31]||(ve[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:ve[6]||(ve[6]=Le=>te("mapRotation"))},[r("div",sM,[ve[32]||(ve[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",iM,b(ne(f.value)),1)]),ve[33]||(ve[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(p(),g("div",lM,[r("div",{class:"popup-header"},[ve[34]||(ve[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",rM,[(p(!0),g(Ie,null,je(j.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["popup-grid-item",{selected:o.value===Le.value}]),onClick:lt=>He(Le.value)},[r("div",{class:"popup-item-preview",innerHTML:De(Le.value)},null,8,uM),Le.showLabel?(p(),g("span",dM,b(Le.label),1)):P("",!0)],10,cM))),128))])])):P("",!0),m.value==="bgColor"?(p(),g("div",hM,[r("div",{class:"popup-header"},[ve[35]||(ve[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",fM,[(p(!0),g(Ie,null,je($e.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:ze(Le.hex)}]),title:Le.name,onClick:lt=>rt(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:xe(Le.hex)},null,8,vM),Le.showLabel?(p(),g("span",mM,b(Le.name),1)):P("",!0)],10,pM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:V.value}]),style:tt(V.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:no},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(V.value?{backgroundColor:l.value}:{})},[V.value?P("",!0):(p(),g("svg",gM,[...ve[36]||(ve[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),V.value?(p(),g("span",yM,"")):P("",!0)],4),ve[37]||(ve[37]=r("span",null,"Custom",-1))],6)]),y.value?(p(),g("div",kM,[ve[39]||(ve[39]=r("label",null,"Enter hex code",-1)),r("div",bM,[ve[38]||(ve[38]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"bgHexInput",ref:S,"onUpdate:modelValue":ve[7]||(ve[7]=Le=>x.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:x.value&&!se.value}]),onInput:Ct,onKeydown:Qo(oo,["enter"])},null,34),[[at,x.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:se.value?"#"+x.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!se.value,onClick:oo}," Apply ",8,wM)]),x.value&&!se.value?(p(),g("span",_M," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="borderColor"?(p(),g("div",CM,[r("div",{class:"popup-header"},[ve[40]||(ve[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",LM,[(p(!0),g(Ie,null,je(Ee.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:c.value===Le.hex}]),title:Le.name,onClick:lt=>kt(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(Le.hex)},null,8,IM),Le.showLabel?(p(),g("span",xM,b(Le.name),1)):P("",!0)],10,SM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:Y.value}]),style:tt(Y.value?{"--custom-color":c.value}:{}),title:"Custom colour",onClick:Mo},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(Y.value?{backgroundColor:c.value}:{})},[Y.value?P("",!0):(p(),g("svg",$M,[...ve[41]||(ve[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Y.value?(p(),g("span",TM,"")):P("",!0)],4),ve[42]||(ve[42]=r("span",null,"Custom",-1))],6)]),k.value?(p(),g("div",MM,[ve[44]||(ve[44]=r("label",null,"Enter hex code",-1)),r("div",AM,[ve[43]||(ve[43]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"borderHexInput",ref:w,"onUpdate:modelValue":ve[8]||(ve[8]=Le=>D.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!Re.value}]),onInput:Mt,onKeydown:Qo(An,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:Re.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Re.value,onClick:An}," Apply ",8,EM)]),D.value&&!Re.value?(p(),g("span",PM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="icon"?(p(),g("div",DM,[r("div",{class:"popup-header"},[ve[45]||(ve[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",RM,[(p(!0),g(Ie,null,je(Z.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["popup-grid-item",{selected:i.value===Le.value}]),onClick:lt=>Rt(Le.value)},[r("div",{class:"popup-item-preview",innerHTML:Ze(Le.value)},null,8,BM),Le.showLabel?(p(),g("span",NM,b(Le.label),1)):P("",!0)],10,OM))),128))])])):P("",!0),m.value==="iconColor"?(p(),g("div",FM,[r("div",{class:"popup-header"},[ve[46]||(ve[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",UM,[(p(!0),g(Ie,null,je(Me.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:be(Le.hex)}]),title:Le.name,onClick:lt=>Lt(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:Ge(Le.hex)},null,8,HM),Le.showLabel?(p(),g("span",VM,b(Le.name),1)):P("",!0)],10,zM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:de.value}]),style:tt(de.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:ft},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(de.value?{backgroundColor:d.value}:{})},[de.value?P("",!0):(p(),g("svg",GM,[...ve[47]||(ve[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),de.value?(p(),g("span",qM,"")):P("",!0)],4),ve[48]||(ve[48]=r("span",null,"Custom",-1))],6)]),_.value?(p(),g("div",jM,[ve[50]||(ve[50]=r("label",null,"Enter hex code",-1)),r("div",WM,[ve[49]||(ve[49]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"iconHexInput",ref:I,"onUpdate:modelValue":ve[9]||(ve[9]=Le=>M.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:M.value&&!q.value}]),onInput:Mn,onKeydown:Qo(tn,["enter"])},null,34),[[at,M.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:q.value?"#"+M.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!q.value,onClick:tn}," Apply ",8,ZM)]),M.value&&!q.value?(p(),g("span",KM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),m.value==="size"?(p(),g("div",YM,[r("div",{class:"popup-header"},[ve[51]||(ve[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",JM,[(p(!0),g(Ie,null,je(J.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["size-grid-item",{selected:h.value===Le.value}]),onClick:lt=>xt(Le.value)},[r("div",{class:"size-preview",innerHTML:fe(Le.value)},null,8,QM),r("span",null,b(Le.label),1)],10,XM))),128))])])):P("",!0),m.value==="mapRotation"?(p(),g("div",eA,[r("div",{class:"popup-header"},[ve[52]||(ve[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",tA,[r("div",nA,[r("div",{class:"rotation-preview-icon",style:tt({transform:`rotate(${O(f.value)}deg)`}),innerHTML:ke.value},null,12,oA)]),ve[53]||(ve[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",aA,[r("button",{type:"button",class:le(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ve[10]||(ve[10]=Le=>Kt("default"))}," Default ",2),r("div",sA,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ve[11]||(ve[11]=Le=>Pa(parseInt(Le.target.value,10)))},null,40,iA),r("div",lA,b(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",rA,[r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ve[12]||(ve[12]=Le=>Kt(-90))},"-90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ve[13]||(ve[13]=Le=>Kt(-45))},"-45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===0}]),onClick:ve[14]||(ve[14]=Le=>Kt(0))},"0",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===45}]),onClick:ve[15]||(ve[15]=Le=>Kt(45))},"+45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===90}]),onClick:ve[16]||(ve[16]=Le=>Kt(90))},"+90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===180}]),onClick:ve[17]||(ve[17]=Le=>Kt(180))},"180",2)])])])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:yo},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:Uo},"Apply")])])])):P("",!0)}},dA=Ke(uA,[["__scopeId","data-v-bbab1a46"]]),hA={class:"checkpoint-style-picker"},fA={class:"form-group"},pA={class:"style-options"},vA=["innerHTML"],mA={class:"option-label"},gA=["innerHTML"],yA="#667eea",kA={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const n=e,a=t,o=A(n.styleType),i=A(n.styleColor||""),l=A(n.styleBackgroundShape||"default"),c=A(n.styleBackgroundColor||""),d=A(n.styleBorderColor||""),h=A(n.styleIconColor||""),f=A(n.styleSize||"default"),m=A(n.styleMapRotation||""),y=O=>!O||O==="default"?!1:el(O).category==="content",k=A(n.styleType&&n.styleType!=="default"&&n.styleType!=="custom"&&y(n.styleType)?n.styleType:"default"),_=A(!1),x=H(()=>!!(o.value&&o.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||c.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),D=O=>O&&O!==""&&O!=="default",M=O=>O&&O.startsWith("#"),S=H(()=>{const j=D(n.inheritedStyleType),Z=D(n.inheritedBackgroundShape),J=M(n.inheritedBackgroundColor)||M(n.inheritedStyleColor),re=M(n.inheritedBorderColor),K=M(n.inheritedIconColor),ie=D(n.inheritedSize);if(j||Z||J||re||K||ie){const X=j?n.inheritedStyleType:Z?n.inheritedBackgroundShape:"circle",ae=(M(n.inheritedBackgroundColor)?n.inheritedBackgroundColor:null)||(M(n.inheritedStyleColor)?n.inheritedStyleColor:null)||yA;return zn({type:X,backgroundShape:n.inheritedBackgroundShape||"circle",backgroundColor:ae,borderColor:n.inheritedBorderColor||"#ffffff",iconColor:n.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),w=H(()=>{const O=n.inheritedMapRotation;return O!==""&&O!==void 0&&O!==null&&O!==0?{transform:`rotate(${O}deg)`}:{}}),I=H(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const j=parseInt(m.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const O=n.inheritedMapRotation;return O!==""&&O!==void 0&&O!==null&&O!==0?{transform:`rotate(${O}deg)`}:{}}),T=H(()=>{if(x.value){const O=k.value&&k.value!=="none"&&k.value!=="default";let j=null;n.inheritedStyleType&&n.inheritedStyleType!=="default"&&n.inheritedStyleType!=="custom"&&el(n.inheritedStyleType).category==="content"&&(j=n.inheritedStyleType);const Z=k.value==="default"&&j,J=O||Z,re=O?k.value:Z?j:null,K=l.value&&l.value!=="default"?l.value:n.inheritedBackgroundShape||"circle",ie=J?re:K,U=c.value||n.inheritedBackgroundColor||n.inheritedStyleColor||"#667eea",X=d.value||n.inheritedBorderColor||"#ffffff",ae=h.value||n.inheritedIconColor||"#ffffff";return zn({type:ie,backgroundShape:K,backgroundColor:U,borderColor:X,iconColor:ae,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),B=()=>{o.value="default",k.value="default",a("update:styleType","default"),l.value="default",c.value="",i.value="",d.value="",h.value="",f.value="default",m.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),z()},E=()=>{_.value=!0},N=O=>{O.iconType==="none"?k.value="none":O.iconType?k.value=O.iconType:k.value="default",l.value=O.backgroundShape||"default",c.value=O.backgroundColor||"",d.value=O.borderColor||"",h.value=O.iconColor||"",f.value=O.size||"default",m.value=O.mapRotation??"";const j=O.iconType==="none"||O.iconType&&O.iconType!==""||O.backgroundShape||O.backgroundColor||O.borderColor||O.iconColor||O.size||O.mapRotation!==""&&O.mapRotation!==0;O.iconType&&O.iconType!=="none"?o.value=O.iconType:j?o.value="custom":o.value="default",a("update:styleType",o.value),a("update:styleBackgroundShape",O.backgroundShape),a("update:styleBackgroundColor",O.backgroundColor),a("update:styleBorderColor",O.borderColor),a("update:styleIconColor",O.iconColor),a("update:styleSize",O.size),a("update:styleMapRotation",O.mapRotation??""),z()},$=()=>{},z=()=>{a("change",{styleType:o.value,styleColor:c.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:c.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:m.value})};return Ye(()=>n.styleType,O=>{o.value=O,O&&O!=="default"&&O!=="custom"&&y(O)?k.value=O:k.value="default"}),Ye(()=>n.styleColor,O=>{i.value=O||""}),Ye(()=>n.styleBackgroundShape,O=>{l.value=O||"default"}),Ye(()=>n.styleBackgroundColor,O=>{c.value=O||""}),Ye(()=>n.styleBorderColor,O=>{d.value=O||""}),Ye(()=>n.styleIconColor,O=>{h.value=O||""}),Ye(()=>n.styleSize,O=>{f.value=O||"default"}),Ye(()=>n.styleMapRotation,O=>{m.value=O??""}),(O,j)=>(p(),g("div",hA,[r("div",fA,[r("label",null,b(e.iconLabel),1),r("div",pA,[r("button",{type:"button",class:le(["style-option-button",{selected:!x.value}]),onClick:B},[r("div",{class:"option-preview",style:tt(w.value),innerHTML:S.value},null,12,vA),r("span",mA,b(e.defaultLabel),1)],2),r("button",{type:"button",class:le(["style-option-button",{selected:x.value}]),onClick:E},[r("div",{class:"option-preview",style:tt(I.value),innerHTML:T.value},null,12,gA),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Pe(dA,{isOpen:_.value,"onUpdate:isOpen":j[0]||(j[0]=Z=>_.value=Z),"icon-type":k.value,"background-shape":l.value,"background-color":c.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:N,onCancel:$},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Bf=Ke(kA,[["__scopeId","data-v-c066da64"]]),bA={class:"logo-uploader"},wA={key:0,class:"logo-preview"},_A=["src"],CA=["disabled"],LA={key:0,class:"upload-progress"},SA={key:1,class:"upload-prompt"},IA={key:2,class:"error-message"},Nv=5*1024*1024,xA={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:n}){const a=K=>K?K.startsWith("/api")?ti+K.substring(4):K:"",o=e;function i(){const K={},ie=localStorage.getItem("adminEmail");ie&&(K["X-Admin-Email"]=ie);const U=localStorage.getItem("sessionToken");return U&&(K.Authorization=`Bearer ${U}`),K}const l=n;function c(){l("staged-change",{hasPendingChanges:k.value!==null||x.value,isPendingDelete:x.value,displayUrl:_.value||(x.value?"":o.modelValue)||""})}const d=A(null),h=A(!1),f=A(!1),m=A(""),y=A(Date.now()),k=A(null),_=A(""),x=A(!1),D=H(()=>{if(o.staged){if(_.value)return!0;if(x.value)return!1}return!!o.modelValue}),M=H(()=>{if(o.staged&&x.value)return"";if(o.staged&&_.value)return _.value;if(!o.modelValue)return"";const K=a(o.modelValue),ie=K.includes("?")?"&":"?";return`${K}${ie}_t=${y.value}`});function S(){_.value&&(URL.revokeObjectURL(_.value),_.value="")}Ln(()=>{S()});const w=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function I(){h.value||d.value?.click()}function T(K){const ie=K.target.files?.[0];ie&&E(ie),d.value&&(d.value.value="")}function B(K){f.value=!1;const ie=K.dataTransfer?.files?.[0];ie&&E(ie)}async function E(K){if(m.value="",!w.includes(K.type)){m.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>Nv){m.value=`File too large. Maximum size is ${Nv/(1024*1024)}MB.`;return}if(o.staged){S(),k.value=K,_.value=URL.createObjectURL(K),x.value=!1,c();return}h.value=!0;try{const ie=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...i()},body:K});if(!ie.ok){const X=await ie.text().catch(()=>"");let ae=`Upload failed (${ie.status})`;try{ae=JSON.parse(X).message||ae}catch{X&&(ae=X)}throw new Error(ae)}const U=await ie.json();y.value=Date.now(),l("update:modelValue",U.logoUrl)}catch(ie){console.error("Logo upload error:",ie),ie.name==="TypeError"&&ie.message==="Failed to fetch"?m.value="Network error. Check your connection or try a smaller file.":ie.message?.includes("401")||ie.message?.includes("403")?m.value="Not authorized. Please refresh the page and try again.":m.value=ie.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function N(){if(m.value="",o.staged){k.value?(S(),k.value=null):o.modelValue&&(x.value=!0),c();return}h.value=!0;try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ie=await K.json().catch(()=>({}));throw new Error(ie.message||"Delete failed")}l("update:modelValue","")}catch(K){console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function $(){if(!k.value)return{success:!0,logoUrl:x.value?"":o.modelValue};h.value=!0,m.value="";try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!K.ok){const U=await K.text().catch(()=>"");let X=`Upload failed (${K.status})`;try{X=JSON.parse(U).message||X}catch{U&&(X=U)}throw new Error(X)}const ie=await K.json();return y.value=Date.now(),S(),k.value=null,x.value=!1,{success:!0,logoUrl:ie.logoUrl}}catch(K){return console.error("Logo upload error:",K),m.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}async function z(){if(!x.value)return{success:!0};h.value=!0,m.value="";try{const K=await fetch(`${ti}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ie=await K.json().catch(()=>({}));throw new Error(ie.message||"Delete failed")}return x.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),m.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}function O(){return k.value!==null||x.value}function j(){return k.value}function Z(){return x.value}function J(){return _.value?_.value:x.value?"":a(o.modelValue)||""}function re(){S(),k.value=null,x.value=!1}return t({uploadStagedFile:$,deleteStagedLogo:z,hasPendingChanges:O,getStagedFile:j,isPendingDelete:Z,getDisplayUrl:J,resetStagedState:re}),(K,ie)=>(p(),g("div",bA,[ie[4]||(ie[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),D.value?(p(),g("div",wA,[r("img",{src:M.value,alt:"Event logo",class:"logo-image"},null,8,_A),r("button",{type:"button",class:"remove-btn",onClick:N,disabled:h.value}," Remove ",8,CA)])):(p(),g("div",{key:1,class:le(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:ie[0]||(ie[0]=ct(U=>f.value=!0,["prevent"])),onDragleave:ie[1]||(ie[1]=ct(U=>f.value=!1,["prevent"])),onDrop:ct(B,["prevent"]),onClick:I},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:T},null,544),h.value?(p(),g("div",LA,[...ie[2]||(ie[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(p(),g("div",SA,[...ie[3]||(ie[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),m.value?(p(),g("div",IA,b(m.value),1)):P("",!0)]))}},$A=Ke(xA,[["__scopeId","data-v-bfb1b332"]]),p1=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function TA(){return{...p1[0]}}function MA(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}const AA={class:"marshal-mockup-container"},EA={class:"presets-section"},PA={class:"presets-row"},DA=["title","onClick"],RA={class:"preset-name"},OA={class:"mockup-frame"},BA={key:0,class:"logo-cover-bg"},NA=["src"],FA=["src"],UA={class:"header-center"},zA={class:"event-name"},HA={class:"mockup-buttons"},VA=["src"],GA={class:"mockup-body"},qA={class:"mockup-card"},jA={class:"card-content"},WA={class:"editor-header"},ZA={class:"editor-content"},KA={class:"color-grid-inline"},YA={class:"color-field"},JA={class:"color-swatches"},XA=["title","onClick"],QA={key:0,class:"check"},eE={class:"custom-color-wrapper"},tE={class:"hex-popup-header"},nE={class:"hex-input-row"},oE=["disabled"],aE={key:0,class:"hex-error"},sE={class:"gradient-toggle"},iE={key:0,class:"color-field"},lE={class:"color-swatches"},rE=["title","onClick"],cE={key:0,class:"check"},uE={class:"custom-color-wrapper"},dE={class:"hex-popup-header"},hE={class:"hex-input-row"},fE=["disabled"],pE={key:0,class:"hex-error"},vE={key:1,class:"logo-position-section"},mE={class:"position-buttons"},gE={class:"color-swatches"},yE=["title","onClick"],kE={key:0,class:"check"},bE={class:"custom-color-wrapper"},wE={class:"hex-popup-header"},_E={class:"hex-input-row"},CE=["disabled"],LE={key:0,class:"hex-error"},SE={class:"color-grid-inline"},IE={class:"color-field"},xE={class:"color-swatches"},$E=["title","onClick"],TE={key:0,class:"check"},ME={class:"custom-color-wrapper"},AE={class:"hex-popup-header"},EE={class:"hex-input-row"},PE=["disabled"],DE={key:0,class:"hex-error"},RE={class:"gradient-toggle"},OE={key:0,class:"color-field"},BE={class:"color-swatches"},NE=["title","onClick"],FE={key:0,class:"check"},UE={class:"custom-color-wrapper"},zE={class:"hex-popup-header"},HE={class:"hex-input-row"},VE=["disabled"],GE={key:0,class:"hex-error"},qE={class:"editor-footer"},jE={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:n}){const a=Ae=>Ae?Ae.startsWith("/api")?ti+Ae.substring(4):Ae:"",o=Un,i=e,l=n,c=A(null),d=p1,h=A(!1),f=A(!1),m=A(null),y=A(!1),k=A(""),_=Ae=>{typeof Ae=="object"&&Ae!==null?(y.value=Ae.isPendingDelete,k.value=Ae.displayUrl||"",l("logo-staged-change",Ae.hasPendingChanges)):(m.value&&(y.value=m.value.isPendingDelete(),k.value=m.value.getDisplayUrl()||""),l("logo-staged-change",!!Ae))},x=A(null),D=A(""),M=A(null),S=A(null),w=A({left:"50%",right:"auto",transform:"translateX(-50%)"}),I=Ae=>Ae?!o.some(ne=>ne.hex.toLowerCase()===Ae.toLowerCase()):!1,T=Ae=>!Ae||!I(Ae)?"#666666":Iu(Ae),B=Ae=>!Ae||!I(Ae)?"#e0e0e0":Ae,E=H(()=>{if(!D.value)return!1;const Ae=D.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Ae)||/^[0-9A-Fa-f]{3}$/.test(Ae)}),N=(Ae,ne)=>{if(x.value===Ae)x.value=null;else{x.value=Ae;let ge="";switch(Ae){case"headerStart":ge=i.branding.headerGradientStart;break;case"headerEnd":ge=i.branding.headerGradientEnd;break;case"pageStart":ge=i.branding.pageGradientStart;break;case"pageEnd":ge=i.branding.pageGradientEnd;break;case"accent":ge=i.branding.accentColor;break}if(ge&&I(ge)?D.value=ge.replace(/^#/,""):D.value="",ne&&S.value){const Oe=ne.currentTarget,De=S.value,xe=Oe.getBoundingClientRect(),me=De.getBoundingClientRect(),Ze=220,Ge=12,fe=xe.left+xe.width/2-me.left,ke=me.width,te=fe-Ze/2;fe+Ze/2>ke-Ge?w.value={left:"auto",right:"0",transform:"none"}:te<Ge?w.value={left:"0",right:"auto",transform:"none"}:w.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>M.value?.focus())}},$=()=>{D.value=D.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},z=()=>{if(!E.value||!x.value)return;let Ae=D.value;Ae.length===3&&(Ae=Ae[0]+Ae[0]+Ae[1]+Ae[1]+Ae[2]+Ae[2]);const ne="#"+Ae;switch(x.value){case"headerStart":Y("start",ne);break;case"headerEnd":V("headerGradientEnd",ne);break;case"pageStart":de("start",ne);break;case"pageEnd":V("pageGradientEnd",ne);break;case"accent":V("accentColor",ne);break}x.value=null};Ye(c,Ae=>{if(x.value=null,D.value="",Ae==="header"){const ne=i.branding.headerGradientStart||yn.headerGradientStart,ge=i.branding.headerGradientEnd||yn.headerGradientEnd;h.value=ne!==ge}else if(Ae==="page"){const ne=i.branding.pageGradientStart||yn.pageGradientStart,ge=i.branding.pageGradientEnd||yn.pageGradientEnd;f.value=ne!==ge}});const O={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=H(()=>i.branding.headerGradientStart||yn.headerGradientStart),Z=H(()=>i.branding.headerGradientEnd||yn.headerGradientEnd),J=H(()=>i.branding.accentColor||yn.accentColor),re=H(()=>i.branding.pageGradientStart||yn.pageGradientStart),K=H(()=>i.branding.pageGradientEnd||yn.pageGradientEnd),ie=H(()=>i.branding.logoPosition||"left"),U=A(Date.now());Ye(()=>i.branding.logoUrl,()=>{U.value=Date.now(),y.value=!1,k.value=""});const X=H(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),ae=H(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const ge=a(k.value),Oe=ge.includes("?")?"&":"?";return`${ge}${Oe}_t=${U.value}`}if(!i.branding.logoUrl)return"";const Ae=a(i.branding.logoUrl),ne=Ae.includes("?")?"&":"?";return`${Ae}${ne}_t=${U.value}`}),he=H(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Z.value} 100%)`})),$e=H(()=>e1(j.value,Z.value)),Ee=H(()=>({background:J.value,color:Iu(J.value)})),Me=H(()=>({background:`linear-gradient(135deg, ${re.value} 0%, ${K.value} 100%)`}));function ze(Ae){c.value=c.value===Ae?null:Ae}function be(Ae){!X.value&&Ae&&V("logoPosition",Ae),ze("logo")}function V(Ae,ne){l("update:branding",{...i.branding,[Ae]:ne})}function Y(Ae,ne){h.value?V("headerGradientStart",ne):l("update:branding",{...i.branding,headerGradientStart:ne,headerGradientEnd:ne})}function de(Ae,ne){f.value?V("pageGradientStart",ne):l("update:branding",{...i.branding,pageGradientStart:ne,pageGradientEnd:ne})}function se(){if(!h.value){const Ae=i.branding.headerGradientStart||yn.headerGradientStart;V("headerGradientEnd",Ae)}}function Re(){if(!f.value){const Ae=i.branding.pageGradientStart||yn.pageGradientStart;V("pageGradientEnd",Ae)}}function q(Ae){l("update:branding",MA(i.branding,Ae)),c.value=null}async function Q(){return m.value?await m.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ee(){return m.value?await m.value.deleteStagedLogo():{success:!0}}function _e(){return m.value?.hasPendingChanges()||!1}function Be(){return m.value?.isPendingDelete()||!1}function Ue(){m.value&&m.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:Q,deleteStagedLogo:ee,hasLogoChanges:_e,isLogoPendingDelete:Be,resetLogo:Ue}),(Ae,ne)=>(p(),g("div",AA,[r("div",EA,[ne[32]||(ne[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",PA,[(p(!0),g(Ie,null,je(F(d),ge=>(p(),g("button",{key:ge.name,type:"button",class:"preset-btn",title:ge.name,onClick:Oe=>q(ge)},[r("span",{class:"preset-preview",style:tt({background:`linear-gradient(135deg, ${ge.pageGradientStart} 0%, ${ge.pageGradientEnd} 100%)`})},null,4),r("span",RA,b(ge.name),1)],8,DA))),128))])]),r("div",OA,[r("div",{class:le(["mockup-page",{"region-active":c.value==="page"}]),style:tt(Me.value),onClick:ne[7]||(ne[7]=ge=>ze("page"))},[r("div",{class:le(["mockup-header",[{"region-active":c.value==="header"},X.value?`logo-${ie.value}`:"logo-none"]]),style:tt(he.value),onClick:ne[5]||(ne[5]=ct(ge=>ze("header"),["stop"]))},[X.value&&ie.value==="cover"?(p(),g("div",BA,[r("img",{src:ae.value,alt:"Logo",class:"logo-cover-img"},null,8,NA)])):P("",!0),X.value&&ie.value==="cover"?(p(),g("button",{key:1,type:"button",class:le(["logo-cover-edit-btn",{"region-active":c.value==="logo"}]),onClick:ne[0]||(ne[0]=ct(ge=>ze("logo"),["stop"])),title:"Edit logo"},[...ne[33]||(ne[33]=[r("span",null,"",-1)])],2)):P("",!0),X.value&&ie.value==="left"?(p(),g("div",{key:2,class:le(["mockup-logo logo-left",{"region-active":c.value==="logo"}]),onClick:ne[1]||(ne[1]=ct(ge=>ze("logo"),["stop"]))},[r("img",{src:ae.value,alt:"Logo",class:"logo-img"},null,8,FA)],2)):P("",!0),X.value?P("",!0):(p(),g("div",{key:3,class:le(["logo-add-area logo-add-left",{"region-active":c.value==="logo"}]),onClick:ne[2]||(ne[2]=ct(ge=>be("left"),["stop"]))},[...ne[34]||(ne[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",UA,[r("div",{class:"mockup-title",style:tt({color:$e.value})},[r("span",zA,b(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:tt({color:$e.value})},b(e.eventDate||"Event Date"),5),r("div",HA,[ne[35]||(ne[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:tt({color:$e.value})},"Logout",4)])]),X.value&&ie.value==="right"?(p(),g("div",{key:4,class:le(["mockup-logo logo-right",{"region-active":c.value==="logo"}]),onClick:ne[3]||(ne[3]=ct(ge=>ze("logo"),["stop"]))},[r("img",{src:ae.value,alt:"Logo",class:"logo-img"},null,8,VA)],2)):P("",!0),X.value?P("",!0):(p(),g("div",{key:5,class:le(["logo-add-area logo-add-right",{"region-active":c.value==="logo"}]),onClick:ne[4]||(ne[4]=ct(ge=>be("right"),["stop"]))},[...ne[36]||(ne[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",GA,[r("div",qA,[ne[37]||(ne[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",jA,[r("div",{class:le(["mockup-checkin-btn",{"region-active":c.value==="accent"}]),style:tt(Ee.value),onClick:ne[6]||(ne[6]=ct(ge=>ze("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),We(r("div",{class:"editor-overlay",onClick:ne[31]||(ne[31]=ct(ge=>c.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:S,class:"editor-modal"},[r("div",WA,[r("span",null,b(O[c.value]),1),r("button",{type:"button",class:"editor-close",onClick:ne[8]||(ne[8]=ge=>c.value=null)},"")]),r("div",ZA,[c.value==="header"?(p(),g(Ie,{key:0},[ne[46]||(ne[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",KA,[r("div",YA,[r("label",null,b(h.value?"Start colour":"Colour"),1),r("div",JA,[(p(!0),g(Ie,null,je(F(o),ge=>(p(),g("button",{key:"hs-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Oe=>Y("start",ge.hex)},[e.branding.headerGradientStart===ge.hex?(p(),g("span",QA,"")):P("",!0)],14,XA))),128)),r("div",eE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientStart)}]),style:tt({backgroundColor:B(e.branding.headerGradientStart)}),title:"Custom colour",onClick:ne[9]||(ne[9]=ge=>N("headerStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:T(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[38]||(ne[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(w.value)},[r("div",tE,[ne[39]||(ne[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[10]||(ne[10]=ge=>x.value=null)},"")]),r("div",nE,[ne[40]||(ne[40]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:M,"onUpdate:modelValue":ne[11]||(ne[11]=ge=>D.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!E.value}]),onInput:$,onKeydown:Qo(z,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:E.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:z}," Apply ",8,oE)]),D.value&&!E.value?(p(),g("span",aE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",sE,[We(r("input",{type:"checkbox","onUpdate:modelValue":ne[12]||(ne[12]=ge=>h.value=ge),onChange:se},null,544),[[Ma,h.value]]),ne[41]||(ne[41]=r("span",null,"Use gradient",-1))])]),h.value?(p(),g("div",iE,[ne[45]||(ne[45]=r("label",null,"End colour",-1)),r("div",lE,[(p(!0),g(Ie,null,je(F(o),ge=>(p(),g("button",{key:"he-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Oe=>V("headerGradientEnd",ge.hex)},[e.branding.headerGradientEnd===ge.hex?(p(),g("span",cE,"")):P("",!0)],14,rE))),128)),r("div",uE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientEnd)}]),style:tt({backgroundColor:B(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:ne[13]||(ne[13]=ge=>N("headerEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:T(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[42]||(ne[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(w.value)},[r("div",dE,[ne[43]||(ne[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[14]||(ne[14]=ge=>x.value=null)},"")]),r("div",hE,[ne[44]||(ne[44]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:M,"onUpdate:modelValue":ne[15]||(ne[15]=ge=>D.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!E.value}]),onInput:$,onKeydown:Qo(z,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:E.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:z}," Apply ",8,fE)]),D.value&&!E.value?(p(),g("span",pE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0),c.value==="logo"?(p(),g("div",vE,[ne[47]||(ne[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",mE,[r("button",{type:"button",class:le(["position-btn",{selected:ie.value==="left"}]),onClick:ne[16]||(ne[16]=ge=>V("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:le(["position-btn",{selected:ie.value==="cover"}]),onClick:ne[17]||(ne[17]=ge=>V("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:le(["position-btn",{selected:ie.value==="right"}]),onClick:ne[18]||(ne[18]=ge=>V("logoPosition","right"))}," Right ",2)])])):P("",!0),We(Pe($A,{ref_key:"logoUploaderRef",ref:m,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":ne[19]||(ne[19]=ge=>V("logoUrl",ge)),onStagedChange:_},null,8,["model-value","event-id","admin-email"]),[[oa,c.value==="logo"]]),c.value==="accent"?(p(),g(Ie,{key:2},[ne[51]||(ne[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",gE,[(p(!0),g(Ie,null,je(F(o),ge=>(p(),g("button",{key:"ac-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.accentColor===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Oe=>V("accentColor",ge.hex)},[e.branding.accentColor===ge.hex?(p(),g("span",kE,"")):P("",!0)],14,yE))),128)),r("div",bE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.accentColor)}]),style:tt({backgroundColor:B(e.branding.accentColor)}),title:"Custom colour",onClick:ne[20]||(ne[20]=ge=>N("accent",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:T(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[48]||(ne[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="accent"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(w.value)},[r("div",wE,[ne[49]||(ne[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[21]||(ne[21]=ge=>x.value=null)},"")]),r("div",_E,[ne[50]||(ne[50]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:M,"onUpdate:modelValue":ne[22]||(ne[22]=ge=>D.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!E.value}]),onInput:$,onKeydown:Qo(z,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:E.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:z}," Apply ",8,CE)]),D.value&&!E.value?(p(),g("span",LE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])],64)):P("",!0),c.value==="page"?(p(),g(Ie,{key:3},[ne[60]||(ne[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",SE,[r("div",IE,[r("label",null,b(f.value?"Start colour":"Colour"),1),r("div",xE,[(p(!0),g(Ie,null,je(F(o),ge=>(p(),g("button",{key:"ps-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Oe=>de("start",ge.hex)},[e.branding.pageGradientStart===ge.hex?(p(),g("span",TE,"")):P("",!0)],14,$E))),128)),r("div",ME,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientStart)}]),style:tt({backgroundColor:B(e.branding.pageGradientStart)}),title:"Custom colour",onClick:ne[23]||(ne[23]=ge=>N("pageStart",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:T(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[52]||(ne[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(w.value)},[r("div",AE,[ne[53]||(ne[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[24]||(ne[24]=ge=>x.value=null)},"")]),r("div",EE,[ne[54]||(ne[54]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:M,"onUpdate:modelValue":ne[25]||(ne[25]=ge=>D.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!E.value}]),onInput:$,onKeydown:Qo(z,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:E.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:z}," Apply ",8,PE)]),D.value&&!E.value?(p(),g("span",DE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",RE,[We(r("input",{type:"checkbox","onUpdate:modelValue":ne[26]||(ne[26]=ge=>f.value=ge),onChange:Re},null,544),[[Ma,f.value]]),ne[55]||(ne[55]=r("span",null,"Use gradient",-1))])]),f.value?(p(),g("div",OE,[ne[59]||(ne[59]=r("label",null,"End colour",-1)),r("div",BE,[(p(!0),g(Ie,null,je(F(o),ge=>(p(),g("button",{key:"pe-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Oe=>V("pageGradientEnd",ge.hex)},[e.branding.pageGradientEnd===ge.hex?(p(),g("span",FE,"")):P("",!0)],14,NE))),128)),r("div",UE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientEnd)}]),style:tt({backgroundColor:B(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:ne[27]||(ne[27]=ge=>N("pageEnd",ge))},[(p(),g("svg",{class:"custom-icon",style:tt({color:T(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[56]||(ne[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:tt(w.value)},[r("div",zE,[ne[57]||(ne[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[28]||(ne[28]=ge=>x.value=null)},"")]),r("div",HE,[ne[58]||(ne[58]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:M,"onUpdate:modelValue":ne[29]||(ne[29]=ge=>D.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:D.value&&!E.value}]),onInput:$,onKeydown:Qo(z,["enter"])},null,34),[[at,D.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:E.value?"#"+D.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:z}," Apply ",8,VE)]),D.value&&!E.value?(p(),g("span",GE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0)]),r("div",qE,[r("button",{type:"button",class:"btn-done",onClick:ne[30]||(ne[30]=ge=>c.value=null)},"Done")])],512)],512),[[oa,c.value]]),ne[61]||(ne[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},WE=Ke(jE,[["__scopeId","data-v-01af4f2d"]]),ZE={class:"settings-tab"},KE={class:"accordion"},YE={class:"accordion-section"},JE={class:"accordion-title"},XE={class:"accordion-icon"},QE={key:0,class:"accordion-content"},e4={class:"accordion-section"},t4={class:"accordion-icon"},n4={key:0,class:"accordion-content"},o4={class:"terminology-grid"},a4={class:"term-group"},s4=["value"],i4={class:"term-group"},l4=["value"],r4={class:"term-group"},c4=["value"],u4={class:"term-group"},d4=["value"],h4={class:"term-group"},f4=["value"],p4={class:"form-actions"},v4=["disabled"],m4={class:"accordion-section"},g4={class:"accordion-title"},y4={class:"accordion-icon"},k4={key:0,class:"accordion-content"},b4={class:"section-description"},w4={class:"form-actions"},_4=["disabled"],C4={class:"accordion-section"},L4={class:"accordion-title"},S4={class:"accordion-icon"},I4={key:0,class:"accordion-content"},x4={class:"section-description"},$4={class:"form-actions"},T4=["disabled"],M4=["disabled"],Fv="admin_settings_accordion",A4={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=mc(),i=H(()=>o.adminEmail||""),l=e,c=t,d=A({...l.eventData}),h=A(null),f=A(!1),m=()=>l.eventId?`${Fv}_${l.eventId}`:Fv,y=A(null);un(()=>{const E=localStorage.getItem(m());E&&(y.value=E)});const k=H(()=>{const E=d.value.peopleTerm||"Marshals";return gs.checkpoint.map(N=>({value:N,label:Wh(N,E)}))}),_=E=>{const N=y.value===E?null:E;y.value=N,N?localStorage.setItem(m(),N):localStorage.removeItem(m())};Ye(()=>l.eventData,E=>{d.value={...E},S.value=!1},{deep:!0});const x=()=>{c("update:formDirty",!0)},D=(E,N)=>{d.value[E]=N,x()},M=H(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),S=A(!1),w=E=>{S.value=E},I=E=>{d.value.brandingHeaderGradientStart=E.headerGradientStart,d.value.brandingHeaderGradientEnd=E.headerGradientEnd,d.value.brandingLogoUrl=E.logoUrl,d.value.brandingLogoPosition=E.logoPosition,d.value.brandingAccentColor=E.accentColor,d.value.brandingPageGradientStart=E.pageGradientStart,d.value.brandingPageGradientEnd=E.pageGradientEnd,x()},T=()=>{TA(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",S.value=!1,h.value?.resetLogo(),x()},B=async()=>{if(!f.value){f.value=!0;try{if(S.value&&h.value){if(h.value.isLogoPendingDelete()){const N=await h.value.deleteStagedLogo();if(!N.success){console.error("Failed to delete logo:",N.error);return}d.value.brandingLogoUrl=""}else{const N=await h.value.uploadStagedLogo();if(!N.success){console.error("Failed to upload logo:",N.error);return}N.logoUrl&&!N.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=N.logoUrl)}S.value=!1}c("submit",{...d.value})}finally{f.value=!1}}};return(E,N)=>(p(),g("div",ZE,[r("div",KE,[r("div",YE,[r("button",{class:le(["accordion-header",{active:y.value==="admins"}]),onClick:N[0]||(N[0]=$=>_("admins"))},[r("span",JE,"Administrators ("+b(e.admins.length)+")",1),r("span",XE,b(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(p(),g("div",QE,[Pe(OT,{admins:e.admins,onAddAdmin:N[1]||(N[1]=$=>E.$emit("add-admin")),onRemoveAdmin:N[2]||(N[2]=$=>E.$emit("remove-admin",$))},null,8,["admins"])])):P("",!0)]),r("div",e4,[r("button",{class:le(["accordion-header",{active:y.value==="terminology"}]),onClick:N[3]||(N[3]=$=>_("terminology"))},[N[19]||(N[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",t4,b(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(p(),g("div",n4,[N[20]||(N[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",o4,[r("div",a4,[r("label",null,b(F(n).people)+" are called",1),We(r("select",{"onUpdate:modelValue":N[4]||(N[4]=$=>d.value.peopleTerm=$),class:"form-input",onChange:x},[(p(!0),g(Ie,null,je(F(gs).people,$=>(p(),g("option",{key:$,value:$},b($),9,s4))),128))],544),[[Qn,d.value.peopleTerm]])]),r("div",i4,[r("label",null,b(F(n).checkpoints)+" are called",1),We(r("select",{"onUpdate:modelValue":N[5]||(N[5]=$=>d.value.checkpointTerm=$),class:"form-input",onChange:x},[(p(!0),g(Ie,null,je(k.value,$=>(p(),g("option",{key:$.value,value:$.value},b($.label),9,l4))),128))],544),[[Qn,d.value.checkpointTerm]])]),r("div",r4,[r("label",null,b(F(n).areas)+" are called",1),We(r("select",{"onUpdate:modelValue":N[6]||(N[6]=$=>d.value.areaTerm=$),class:"form-input",onChange:x},[(p(!0),g(Ie,null,je(F(gs).area,$=>(p(),g("option",{key:$,value:$},b($),9,c4))),128))],544),[[Qn,d.value.areaTerm]])]),r("div",u4,[r("label",null,b(F(n).checklists)+" are called",1),We(r("select",{"onUpdate:modelValue":N[7]||(N[7]=$=>d.value.checklistTerm=$),class:"form-input",onChange:x},[(p(!0),g(Ie,null,je(F(gs).checklist,$=>(p(),g("option",{key:$,value:$},b($),9,d4))),128))],544),[[Qn,d.value.checklistTerm]])]),r("div",h4,[r("label",null,b(F(n).course)+" is called",1),We(r("select",{"onUpdate:modelValue":N[8]||(N[8]=$=>d.value.courseTerm=$),class:"form-input",onChange:x},[(p(!0),g(Ie,null,je(F(gs).course,$=>(p(),g("option",{key:$,value:$},b($),9,f4))),128))],544),[[Qn,d.value.courseTerm]])])]),r("div",p4,[r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,v4)])])):P("",!0)]),r("div",m4,[r("button",{class:le(["accordion-header",{active:y.value==="appearance"}]),onClick:N[9]||(N[9]=$=>_("appearance"))},[r("span",g4,b(F(n).checkpoint)+" appearance",1),r("span",y4,b(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(p(),g("div",k4,[r("p",b4," Set the default marker style for all "+b(F(a).checkpoints)+" in this event. Individual "+b(F(a).areas)+" and "+b(F(a).checkpoints)+" can override this setting. ",1),Pe(Bf,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":N[10]||(N[10]=$=>D("defaultCheckpointStyleType",$)),"onUpdate:styleColor":N[11]||(N[11]=$=>D("defaultCheckpointStyleColor",$)),"onUpdate:styleBackgroundShape":N[12]||(N[12]=$=>D("defaultCheckpointStyleBackgroundShape",$)),"onUpdate:styleBackgroundColor":N[13]||(N[13]=$=>D("defaultCheckpointStyleBackgroundColor",$)),"onUpdate:styleBorderColor":N[14]||(N[14]=$=>D("defaultCheckpointStyleBorderColor",$)),"onUpdate:styleIconColor":N[15]||(N[15]=$=>D("defaultCheckpointStyleIconColor",$)),"onUpdate:styleSize":N[16]||(N[16]=$=>D("defaultCheckpointStyleSize",$)),"onUpdate:styleMapRotation":N[17]||(N[17]=$=>D("defaultCheckpointStyleMapRotation",$))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",w4,[r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,_4)])])):P("",!0)]),r("div",C4,[r("button",{class:le(["accordion-header",{active:y.value==="branding"}]),onClick:N[18]||(N[18]=$=>_("branding"))},[r("span",L4,b(F(n).person)+" branding",1),r("span",S4,b(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(p(),g("div",I4,[r("p",x4," Customise the appearance of the "+b(F(a).person)+" view to match your organisation's branding. ",1),Pe(WE,{ref_key:"brandingMockupRef",ref:h,branding:M.value,"event-name":d.value.name,"event-date":F(Ky)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":I,onLogoStagedChange:w},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",$4,[r("button",{onClick:T,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,T4),r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty&&!S.value||f.value},b(f.value?"Saving...":"Save"),9,M4)])])):P("",!0)])])]))}},E4=Ke(A4,[["__scopeId","data-v-bb7e241a"]]),P4={class:"incident-header"},D4={class:"incident-title-row"},R4={class:"incident-title"},O4={class:"incident-badges"},B4={key:0,class:"incident-description"},N4={class:"incident-context"},F4={key:0,class:"context-item"},U4={key:1,class:"context-item"},z4={key:2,class:"context-item"},H4={class:"incident-footer"},V4={class:"reporter-info"},G4={class:"time-info"},q4={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,n=H(()=>{if(t.incident.title)return t.incident.title;const c=t.incident.description||"";return c.length<=60?c:c.substring(0,57).trim()+"..."}),a=c=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[c]||c,o=c=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[c]||c,i=(c,d=120)=>!c||c.length<=d?c:c.substring(0,d).trim()+"...",l=c=>{if(!c)return"";const d=new Date(c),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),k=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(c,d)=>(p(),g("div",{class:le(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>c.$emit("select",e.incident))},[r("div",P4,[r("div",D4,[r("span",{class:le(["severity-indicator",e.incident.severity])},null,2),r("strong",R4,b(n.value),1)]),r("div",O4,[r("span",{class:le(["severity-badge",e.incident.severity])},b(a(e.incident.severity)),3),r("span",{class:le(["status-badge",e.incident.status])},b(o(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(p(),g("div",B4,b(i(e.incident.description)),1)):P("",!0),r("div",N4,[e.incident.context?.checkpoint?(p(),g("div",F4,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(p(),g("div",U4,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(p(),g("div",z4,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.area.areaName),1)])):P("",!0)]),r("div",H4,[r("span",V4," Reported by "+b(e.incident.reportedBy?.name||"Unknown"),1),r("span",G4,b(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},kc=Ke(q4,[["__scopeId","data-v-690fd385"]]),j4={class:"incidents-tab"},W4={class:"tab-header"},Z4={class:"button-group"},K4={key:0,class:"status-pills"},Y4={class:"filters-section"},J4={class:"search-group"},X4={class:"incidents-list"},Q4={key:0,class:"loading-state"},e3={key:1,class:"empty-state"},t3={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const n=e,a=A(""),o=A("all"),i=y=>{o.value=y},l=H(()=>n.incidents.filter(y=>y.status==="open").length),c=H(()=>n.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=H(()=>n.incidents.filter(y=>y.status==="resolved").length),h=H(()=>n.incidents.filter(y=>y.status==="closed").length),f=H(()=>{let y=n.incidents;if(o.value==="open"?y=y.filter(k=>k.status==="open"):o.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):o.value==="resolved"?y=y.filter(k=>k.status==="resolved"):o.value==="closed"&&(y=y.filter(k=>k.status==="closed")),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(_=>{const x=`${_.context?.checkpoint?.name||""} ${_.context?.checkpoint?.description||""}`,D=_.area?.areaName||"",M=[_.reportedBy?.name||"",...(_.context?.peopleAtCheckpoint||[]).map(I=>I.name||"")].join(" "),S=(_.updates||[]).map(I=>I.note||"").join(" "),w=`${_.title||""} ${_.description||""} ${x} ${D} ${M} ${S}`.toLowerCase();return k.every(I=>w.includes(I))})}return y}),m=H(()=>[...f.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(p(),g("div",j4,[r("div",W4,[r("div",Z4,[r("button",{onClick:k[0]||(k[0]=_=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(p(),g("div",K4,[Pe(Pt,{variant:"neutral",active:o.value==="all",onClick:k[1]||(k[1]=_=>i("all"))},{default:Ve(()=>[Je(b(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(p(),qe(Pt,{key:0,variant:"info",active:o.value==="open",onClick:k[2]||(k[2]=_=>i("open"))},{default:Ve(()=>[Je(b(l.value)+" open ",1)]),_:1},8,["active"])):P("",!0),c.value>0&&c.value<e.incidents.length?(p(),qe(Pt,{key:1,variant:"purple",active:o.value==="in-progress",onClick:k[3]||(k[3]=_=>i("in-progress"))},{default:Ve(()=>[Je(b(c.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0&&d.value<e.incidents.length?(p(),qe(Pt,{key:2,variant:"success",active:o.value==="resolved",onClick:k[4]||(k[4]=_=>i("resolved"))},{default:Ve(()=>[Je(b(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.incidents.length?(p(),qe(Pt,{key:3,variant:"neutral",active:o.value==="closed",onClick:k[5]||(k[5]=_=>i("closed"))},{default:Ve(()=>[Je(b(h.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",Y4,[r("div",J4,[We(r("input",{"onUpdate:modelValue":k[6]||(k[6]=_=>a.value=_),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[at,a.value]])])]),r("div",X4,[e.loading?(p(),g("div",Q4," Loading incidents... ")):f.value.length===0?(p(),g("div",e3,[r("p",null,b(a.value||o.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(p(!0),g(Ie,null,je(m.value,_=>(p(),qe(kc,{key:_.incidentId,incident:_,onSelect:x=>y.$emit("select-incident",_)},null,8,["incident","onSelect"]))),128))])]))}},n3=Ke(t3,[["__scopeId","data-v-f24c84f4"]]),o3={key:0,class:"empty-state"},a3={key:0,class:"empty-hint"},s3={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,n)=>e.isEmpty?(p(),g("div",o3,[r("p",null,b(e.emptyMessage),1),e.emptyHint?(p(),g("p",a3,b(e.emptyHint),1)):P("",!0)])):(p(),g("div",{key:1,class:le(["cards-grid",e.gridClass])},[mo(t.$slots,"default",{},void 0,!0)],2))}},bc=Ke(s3,[["__scopeId","data-v-a842b7b1"]]),i3={class:"checkpoint-card-header"},l3={class:"checkpoint-name-row"},r3=["innerHTML"],c3={class:"checkpoint-name"},u3={key:0,class:"checkpoint-description"},d3={key:0,class:"checkpoint-card-areas"},h3={class:"checkpoint-card-stats"},f3={key:1,class:"checkpoint-card-marshals"},p3={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>n.checkpoint.areaIds||n.checkpoint.AreaIds||[]),i=D=>{const M=n.areas.find(S=>S.id===D);return M?M.name:null},l=D=>{const M=n.areas.find(S=>S.id===D);return M?M.color:"#999"},c=H(()=>{const D=n.checkpoint,M=D.resolvedStyleBackgroundColor||D.ResolvedStyleBackgroundColor||D.resolvedStyleColor||D.ResolvedStyleColor;return M||(o.value.length>0?l(o.value[0]):"#667eea")}),d=H(()=>{const D=n.checkpoint,M=(D.assignments||[]).length;return D.requiredMarshals===0?null:M>=D.requiredMarshals?"full":M>0?"partial":"none"}),h=H(()=>[...n.checkpoint.assignments||[]].sort((M,S)=>(M.marshalName||"").localeCompare(S.marshalName||"",void 0,{sensitivity:"base"}))),f=H(()=>(n.checkpoint.assignments||[]).length),m=H(()=>(n.checkpoint.assignments||[]).filter(D=>D.isCheckedIn).length),y=H(()=>d.value?`staffing-${d.value}`:""),k=H(()=>{const D=f.value,M=m.value;return D===0?"":M===0?"checkin-none":M>=D?"checkin-full":"checkin-partial"}),_=H(()=>{const D=n.checkpoint,M=D.resolvedStyleType||D.ResolvedStyleType,S=D.resolvedStyleBackgroundColor||D.ResolvedStyleBackgroundColor||D.resolvedStyleColor||D.ResolvedStyleColor,w=D.resolvedStyleBorderColor||D.ResolvedStyleBorderColor,I=D.resolvedStyleIconColor||D.ResolvedStyleIconColor,T=D.resolvedStyleBackgroundShape||D.ResolvedStyleBackgroundShape;return M&&M!=="default"||S||w||I||T&&T!=="circle"?zn({type:M||"circle",backgroundShape:T||"circle",backgroundColor:S||"#667eea",borderColor:w||"#ffffff",iconColor:I||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),x=()=>{n.clickable&&a("click",n.checkpoint)};return(D,M)=>(p(),g("div",{class:le(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:tt({borderLeftColor:c.value}),onClick:x},[r("div",i3,[r("div",{class:le(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",l3,[r("span",{class:"checkpoint-icon",innerHTML:_.value},null,8,r3),r("span",c3,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",u3,"  "+b(e.checkpoint.description),1)):P("",!0)])],2)]),o.value.length>0?(p(),g("div",d3,[(p(!0),g(Ie,null,je(o.value,S=>(p(),g("span",{key:S,class:"area-badge",style:tt({backgroundColor:l(S)})},b(i(S)),5))),128))])):P("",!0),r("div",h3,[r("span",{class:le(["stat-badge staffing-badge",y.value])},b(f.value)+"/"+b(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(p(),g("span",{key:0,class:le(["stat-badge",k.value])},b(m.value)+"/"+b(f.value)+" checked in ",3)):P("",!0)]),h.value.length>0?(p(),g("div",f3,[(p(!0),g(Ie,null,je(h.value,S=>(p(),g("span",{key:S.id,class:le(["marshal-badge",{"checked-in":S.isCheckedIn}])},b(S.marshalName),3))),128))])):P("",!0)],6))}},v3=Ke(p3,[["__scopeId","data-v-7ae260df"]]),v1={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),qe(bc,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Ie,null,je(e.checkpoints,a=>(p(),qe(v3,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},m3={class:"checkpoints-tab"},g3={class:"tab-header"},y3={class:"button-group"},k3={key:0,class:"status-pills"},b3={class:"filters-section"},w3={class:"search-group"},_3=["placeholder"],C3={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ht(),n=e,a=A(""),o=A("all"),i=S=>{o.value=S},l=S=>(S.assignments||[]).length,c=S=>(S.assignments||[]).filter(w=>w.isCheckedIn).length,d=H(()=>n.locations.filter(S=>l(S)>=S.requiredMarshals&&S.requiredMarshals>0).length),h=H(()=>n.locations.filter(S=>l(S)>0&&l(S)<S.requiredMarshals).length),f=H(()=>n.locations.filter(S=>l(S)===0&&S.requiredMarshals>0).length),m=H(()=>n.locations.filter(S=>{const w=l(S),I=c(S);return w>0&&I>=w}).length),y=H(()=>n.locations.filter(S=>{const w=l(S),I=c(S);return w>0&&I>0&&I<w}).length),k=H(()=>n.locations.filter(S=>{const w=l(S),I=c(S);return w>0&&I===0}).length),_=S=>{const w=n.areas.find(I=>I.id===S);return w?w.name:null},x=H(()=>{let S=n.locations;if(o.value==="full"?S=S.filter(w=>l(w)>=w.requiredMarshals&&w.requiredMarshals>0):o.value==="partial"?S=S.filter(w=>l(w)>0&&l(w)<w.requiredMarshals):o.value==="missing"?S=S.filter(w=>l(w)===0&&w.requiredMarshals>0):o.value==="checkin-full"?S=S.filter(w=>{const I=l(w),T=c(w);return I>0&&T>=I}):o.value==="checkin-partial"?S=S.filter(w=>{const I=l(w),T=c(w);return I>0&&T>0&&T<I}):o.value==="checkin-none"&&(S=S.filter(w=>{const I=l(w),T=c(w);return I>0&&T===0})),a.value.trim()){const w=a.value.toLowerCase().trim().split(/\s+/);S=S.filter(I=>{const B=(I.areaIds||I.AreaIds||[]).map($=>_($)||"").join(" "),E=(I.assignments||[]).map($=>$.marshalName||"").join(" "),N=`${I.name||""} ${I.description||""} ${B} ${E}`.toLowerCase();return w.every($=>N.includes($))})}return S}),D=H(()=>[...x.value].sort((S,w)=>ea(S.name,w.name))),M=H(()=>{const S=a.value.trim();return o.value==="full"?S?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:o.value==="partial"?S?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:o.value==="missing"?S?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:o.value==="checkin-full"?S?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:o.value==="checkin-partial"?S?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:o.value==="checkin-none"?S?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:S?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(S,w)=>(p(),g("div",m3,[r("div",g3,[r("div",y3,[r("button",{onClick:w[0]||(w[0]=I=>S.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+b(F(t).checkpoint),1),r("button",{onClick:w[1]||(w[1]=I=>S.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(p(),g("div",k3,[Pe(Pt,{variant:"neutral",active:o.value==="all",onClick:w[2]||(w[2]=I=>i("all"))},{default:Ve(()=>[Je(b(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(p(),qe(Pt,{key:0,variant:"success",active:o.value==="full",onClick:w[3]||(w[3]=I=>i("full"))},{default:Ve(()=>[Je(b(d.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.locations.length?(p(),qe(Pt,{key:1,variant:"warning",active:o.value==="partial",onClick:w[4]||(w[4]=I=>i("partial"))},{default:Ve(()=>[Je(b(h.value)+" partially staffed ",1)]),_:1},8,["active"])):P("",!0),f.value>0&&f.value<e.locations.length?(p(),qe(Pt,{key:2,variant:"danger",active:o.value==="missing",onClick:w[5]||(w[5]=I=>i("missing"))},{default:Ve(()=>[Je(b(f.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0),m.value>0&&m.value<e.locations.length?(p(),qe(Pt,{key:3,variant:"success",active:o.value==="checkin-full",onClick:w[6]||(w[6]=I=>i("checkin-full"))},{default:Ve(()=>[Je(b(m.value)+" fully checked in ",1)]),_:1},8,["active"])):P("",!0),y.value>0&&y.value<e.locations.length?(p(),qe(Pt,{key:4,variant:"warning",active:o.value==="checkin-partial",onClick:w[7]||(w[7]=I=>i("checkin-partial"))},{default:Ve(()=>[Je(b(y.value)+" partially checked in ",1)]),_:1},8,["active"])):P("",!0),k.value>0&&k.value<e.locations.length?(p(),qe(Pt,{key:5,variant:"danger",active:o.value==="checkin-none",onClick:w[8]||(w[8]=I=>i("checkin-none"))},{default:Ve(()=>[Je(b(k.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",b3,[r("div",w3,[We(r("input",{"onUpdate:modelValue":w[9]||(w[9]=I=>a.value=I),type:"text",class:"search-input",placeholder:`Search by name, description, ${F(t).area}, or ${F(t).person}...`},null,8,_3),[[at,a.value]])])]),Pe(v1,{checkpoints:D.value,areas:e.areas,"empty-message":M.value,onSelect:w[10]||(w[10]=I=>S.$emit("select-location",I))},null,8,["checkpoints","areas","empty-message"])]))}},L3=Ke(C3,[["__scopeId","data-v-846aa906"]]),S3={class:"area-card-header"},I3={class:"area-name-row"},x3={class:"area-name"},$3={key:0,class:"default-badge"},T3={key:0,class:"area-description"},M3={class:"area-card-stats"},A3={class:"stat-badge"},E3={class:"stat-badge"},P3={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>n.area.checkpointCount!==void 0?n.area.checkpointCount:n.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(n.area.id)||f.areaId===n.area.id).length),i=H(()=>n.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(n.area.id):!1):!1).length),l=H(()=>n.area.peopleTerm||n.eventPeopleTerm||"Marshals"),c=H(()=>{const f=n.area.checkpointTerm||n.eventCheckpointTerm||"Checkpoints";return o.value===1?Wi("checkpoint",f,l.value):jy("checkpoint",f,l.value)}),d=H(()=>`${o.value} ${c.value.toLowerCase()}`),h=()=>{n.clickable&&a("click",n.area)};return(f,m)=>(p(),g("div",{class:le(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:tt({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",S3,[r("div",{class:le(["area-card-title",{clickable:e.clickable}])},[r("div",I3,[r("span",x3,b(e.area.name),1),e.area.isDefault?(p(),g("span",$3,"Default")):P("",!0)]),e.area.description?(p(),g("span",T3,b(e.area.description),1)):P("",!0)],2)]),r("div",M3,[r("span",A3,b(d.value),1),r("span",E3,b(i.value)+" contact"+b(i.value===1?"":"s"),1)])],6))}},D3=Ke(P3,[["__scopeId","data-v-8ac20bf2"]]),R3={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),qe(bc,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),g(Ie,null,je(e.areas,a=>(p(),qe(D3,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},O3={class:"areas-tab"},B3={class:"tab-header"},N3={class:"button-group"},F3={key:0,class:"status-pills"},U3={class:"filters-section"},z3={class:"search-group"},H3=["placeholder"],V3={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ht(),n=e,a=A(""),o=d=>n.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=H(()=>{if(!a.value.trim())return n.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return n.areas.filter(h=>{const m=o(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${m}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=H(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:ea(d.name,h.name))),c=H(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(p(),g("div",O3,[r("div",B3,[r("div",N3,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+b(F(t).area),1)]),e.areas.length>0?(p(),g("div",F3,[Pe(Pt,{variant:"neutral",active:!1},{default:Ve(()=>[Je(b(e.areas.length)+" "+b(e.areas.length===1?F(t).area:F(t).areas),1)]),_:1})])):P("",!0)]),r("div",U3,[r("div",z3,[We(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>a.value=f),type:"text",class:"search-input",placeholder:`Search by ${F(t).area} name or ${F(t).checkpoint} name...`},null,8,H3),[[at,a.value]])])]),Pe(R3,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":c.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},G3=Ke(V3,[["__scopeId","data-v-203f9606"]]),q3={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',roles:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15c0-4 3.5-7 8-7s8 3 8 7"/><path d="M4 15c0 1.5 3.5 3 8 3s8-1.5 8-3"/><path d="M20 15h2c.5 0 1-.5 1-1v-1c0-1-1-2-2.5-2H20"/><circle cx="12" cy="8" r="1"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},to=e=>q3[e]||"",j3={class:"responsive-tabs"},W3=["onClick"],Z3=["innerHTML"],K3=["innerHTML"],Y3={class:"hamburger-label"},J3=["onClick"],X3=["innerHTML"],Q3={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,o=A(null),i=A(null),l=A(null),c=A(!1),d=A({}),h=A(!1),f=H(()=>n.tabs.find(M=>M.value===n.modelValue)),m=H(()=>f.value?f.value.label:"Menu"),y=()=>{if(c.value=!c.value,c.value&&i.value){const M=i.value.getBoundingClientRect();d.value={top:`${M.bottom+4}px`}}},k=M=>{a("update:modelValue",M),c.value=!1},_=M=>{if(!o.value)return;const S=o.value.contains(M.target);c.value&&!S&&(c.value=!1)},x=()=>{if(!l.value)return;const M=l.value,S=h.value;S&&(M.style.visibility="visible",M.style.position="static");const w=M.scrollWidth>M.clientWidth;S&&(M.style.visibility="",M.style.position=""),h.value=w};let D=null;return un(()=>{document.addEventListener("click",_),cn(()=>{x()}),cn(()=>{const M=l.value?.parentElement;M&&(D=new ResizeObserver(()=>{x()}),D.observe(M))})}),Ln(()=>{document.removeEventListener("click",_),D&&D.disconnect()}),Ye(()=>n.tabs,()=>{cn(()=>{x()})},{deep:!0}),(M,S)=>(p(),g("div",j3,[r("div",{ref_key:"visibleTabsRef",ref:l,class:le(["visible-tabs",{"is-hidden":h.value}])},[(p(!0),g(Ie,null,je(e.tabs,w=>(p(),g("button",{key:w.value,class:le(["tab-button",{active:e.modelValue===w.value}]),onClick:I=>M.$emit("update:modelValue",w.value),type:"button"},[w.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:F(to)(w.icon)},null,8,Z3)):P("",!0),Je(" "+b(w.label),1)],10,W3))),128))],2),r("div",{class:le(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:o},[r("button",{ref_key:"hamburgerButton",ref:i,class:le(["hamburger-button",{active:c.value}]),onClick:ct(y,["stop"]),type:"button"},[S[1]||(S[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:F(to)(f.value.icon)},null,8,K3)):P("",!0),r("span",Y3,b(m.value),1)],2),c.value?(p(),g("div",{key:0,class:"hamburger-dropdown",style:tt(d.value),onClick:S[0]||(S[0]=ct(()=>{},["stop"]))},[(p(!0),g(Ie,null,je(e.tabs,w=>(p(),g("button",{key:w.value,class:le(["dropdown-item",{active:e.modelValue===w.value}]),onClick:ct(I=>k(w.value),["stop"]),type:"button"},[w.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:F(to)(w.icon)},null,8,X3)):P("",!0),Je(" "+b(w.label),1)],10,J3))),128))],4)):P("",!0)],512)],2)]))}},eP=Ke(Q3,[["__scopeId","data-v-2467c6fc"]]),tP={class:"instruction"},nP={class:"share-link-container"},oP=["value"],aP={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=t,i=A(!1),l=A(null),c=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{o("close")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:`${F(n).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[r("p",tP,"Share this link with "+b(F(a).peoplePlural)+" so they can check in:",1),r("div",nP,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,oP),r("button",{onClick:c,class:"btn btn-primary"},b(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},sP=Ke(aP,[["__scopeId","data-v-b037c39b"]]);var zl={},Jd,Uv;function iP(){return Uv||(Uv=1,Jd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Jd}var Xd={},Ws={},zv;function cl(){if(zv)return Ws;zv=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Ws.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},Ws.getSymbolTotalCodewords=function(a){return t[a]},Ws.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},Ws.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');e=a},Ws.isKanjiModeEnabled=function(){return typeof e<"u"},Ws.toSJIS=function(a){return e(a)},Ws}var Qd={},Hv;function Nf(){return Hv||(Hv=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,o){if(e.isValid(a))return a;try{return t(a)}catch{return o}}})(Qd)),Qd}var eh,Vv;function lP(){if(Vv)return eh;Vv=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},eh=e,eh}var th,Gv;function rP(){if(Gv)return th;Gv=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,a,o){const i=t*this.size+n;this.data[i]=a,o&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},th=e,th}var nh={},qv;function cP(){return qv||(qv=1,(function(e){const t=cl().getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const o=Math.floor(a/7)+2,i=t(a),l=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let d=1;d<o-1;d++)c[d]=c[d-1]-l;return c.push(6),c.reverse()},e.getPositions=function(a){const o=[],i=e.getRowColCoords(a),l=i.length;for(let c=0;c<l;c++)for(let d=0;d<l;d++)c===0&&d===0||c===0&&d===l-1||c===l-1&&d===0||o.push([i[c],i[d]]);return o}})(nh)),nh}var oh={},jv;function uP(){if(jv)return oh;jv=1;const e=cl().getSymbolSize,t=7;return oh.getPositions=function(a){const o=e(a);return[[0,0],[o-t,0],[0,o-t]]},oh}var ah={},Wv;function dP(){return Wv||(Wv=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const i=o.size;let l=0,c=0,d=0,h=null,f=null;for(let m=0;m<i;m++){c=d=0,h=f=null;for(let y=0;y<i;y++){let k=o.get(m,y);k===h?c++:(c>=5&&(l+=t.N1+(c-5)),h=k,c=1),k=o.get(y,m),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}c>=5&&(l+=t.N1+(c-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(o){const i=o.size;let l=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=o.get(c,d)+o.get(c,d+1)+o.get(c+1,d)+o.get(c+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const i=o.size;let l=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let f=0;f<i;f++)c=c<<1&2047|o.get(h,f),f>=10&&(c===1488||c===93)&&l++,d=d<<1&2047|o.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let i=0;const l=o.data.length;for(let d=0;d<l;d++)i+=o.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function n(a,o,i){switch(a){case e.Patterns.PATTERN000:return(o+i)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(o+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return o*i%2+o*i%3===0;case e.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case e.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(o,i){const l=i.size;for(let c=0;c<l;c++)for(let d=0;d<l;d++)i.isReserved(d,c)||i.xor(d,c,n(o,d,c))},e.getBestMask=function(o,i){const l=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,o);const f=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(h,o),f<d&&(d=f,c=h)}return c}})(ah)),ah}var qc={},Zv;function m1(){if(Zv)return qc;Zv=1;const e=Nf(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return qc.getBlocksCount=function(o,i){switch(i){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},qc.getTotalCodewordsCount=function(o,i){switch(i){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},qc}var sh={},Ir={},Kv;function hP(){if(Kv)return Ir;Kv=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let o=0;o<255;o++)e[o]=a,t[a]=o,a<<=1,a&256&&(a^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),Ir.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Ir.exp=function(a){return e[a]},Ir.mul=function(a,o){return a===0||o===0?0:e[t[a]+t[o]]},Ir}var Yv;function fP(){return Yv||(Yv=1,(function(e){const t=hP();e.mul=function(a,o){const i=new Uint8Array(a.length+o.length-1);for(let l=0;l<a.length;l++)for(let c=0;c<o.length;c++)i[l+c]^=t.mul(a[l],o[c]);return i},e.mod=function(a,o){let i=new Uint8Array(a);for(;i.length-o.length>=0;){const l=i[0];for(let d=0;d<o.length;d++)i[d]^=t.mul(o[d],l);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(a){let o=new Uint8Array([1]);for(let i=0;i<a;i++)o=e.mul(o,new Uint8Array([1,t.exp(i)]));return o}})(sh)),sh}var ih,Jv;function pP(){if(Jv)return ih;Jv=1;const e=fP();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(a.length+this.degree);o.set(a);const i=e.mod(o,this.genPoly),l=this.degree-i.length;if(l>0){const c=new Uint8Array(this.degree);return c.set(i,l),c}return i},ih=t,ih}var lh={},rh={},ch={},Xv;function g1(){return Xv||(Xv=1,ch.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),ch}var Ua={},Qv;function y1(){if(Qv)return Ua;Qv=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Ua.KANJI=new RegExp(n,"g"),Ua.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ua.BYTE=new RegExp(a,"g"),Ua.NUMERIC=new RegExp(e,"g"),Ua.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ua.testKanji=function(d){return o.test(d)},Ua.testNumeric=function(d){return i.test(d)},Ua.testAlphanumeric=function(d){return l.test(d)},Ua}var em;function ul(){return em||(em=1,(function(e){const t=g1(),n=y1();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return n.testNumeric(i)?e.NUMERIC:n.testAlphanumeric(i)?e.ALPHANUMERIC:n.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(i,l){if(e.isValid(i))return i;try{return a(i)}catch{return l}}})(rh)),rh}var tm;function vP(){return tm||(tm=1,(function(e){const t=cl(),n=m1(),a=Nf(),o=ul(),i=g1(),l=7973,c=t.getBCHDigit(l);function d(y,k,_){for(let x=1;x<=40;x++)if(k<=e.getCapacity(x,_,y))return x}function h(y,k){return o.getCharCountIndicator(y,k)+4}function f(y,k){let _=0;return y.forEach(function(x){const D=h(x.mode,k);_+=D+x.getBitsLength()}),_}function m(y,k){for(let _=1;_<=40;_++)if(f(y,_)<=e.getCapacity(_,k,o.MIXED))return _}e.from=function(k,_){return i.isValid(k)?parseInt(k,10):_},e.getCapacity=function(k,_,x){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=o.BYTE);const D=t.getSymbolTotalCodewords(k),M=n.getTotalCodewordsCount(k,_),S=(D-M)*8;if(x===o.MIXED)return S;const w=S-h(x,k);switch(x){case o.NUMERIC:return Math.floor(w/10*3);case o.ALPHANUMERIC:return Math.floor(w/11*2);case o.KANJI:return Math.floor(w/13);case o.BYTE:default:return Math.floor(w/8)}},e.getBestVersionForData=function(k,_){let x;const D=a.from(_,a.M);if(Array.isArray(k)){if(k.length>1)return m(k,D);if(k.length===0)return 1;x=k[0]}else x=k;return d(x.mode,x.getLength(),D)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let _=k<<12;for(;t.getBCHDigit(_)-c>=0;)_^=l<<t.getBCHDigit(_)-c;return k<<12|_}})(lh)),lh}var uh={},nm;function mP(){if(nm)return uh;nm=1;const e=cl(),t=1335,n=21522,a=e.getBCHDigit(t);return uh.getEncodedBits=function(i,l){const c=i.bit<<3|l;let d=c<<10;for(;e.getBCHDigit(d)-a>=0;)d^=t<<e.getBCHDigit(d)-a;return(c<<10|d)^n},uh}var dh={},hh,om;function gP(){if(om)return hh;om=1;const e=ul();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let o,i,l;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),l=parseInt(i,10),a.put(l,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),l=parseInt(i,10),a.put(l,c*3+1))},hh=t,hh}var fh,am;function yP(){if(am)return fh;am=1;const e=ul(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=e.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[i]),6)},fh=n,fh}var ph,sm;function kP(){if(sm)return ph;sm=1;const e=ul();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,o=this.data.length;a<o;a++)n.put(this.data[a],8)},ph=t,ph}var vh,im;function bP(){if(im)return vh;im=1;const e=ul(),t=cl();function n(a){this.mode=e.KANJI,this.data=a}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let o;for(o=0;o<this.data.length;o++){let i=t.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),a.put(i,13)}},vh=n,vh}var mh={exports:{}},lm;function wP(){return lm||(lm=1,(function(e){var t={single_source_shortest_paths:function(n,a,o){var i={},l={};l[a]=0;var c=t.PriorityQueue.make();c.push(a,0);for(var d,h,f,m,y,k,_,x,D;!c.empty();){d=c.pop(),h=d.value,m=d.cost,y=n[h]||{};for(f in y)y.hasOwnProperty(f)&&(k=y[f],_=m+k,x=l[f],D=typeof l[f]>"u",(D||x>_)&&(l[f]=_,c.push(f,_),i[f]=h))}if(typeof o<"u"&&typeof l[o]>"u"){var M=["Could not find a path from ",a," to ",o,"."].join("");throw new Error(M)}return i},extract_shortest_path_from_predecessor_list:function(n,a){for(var o=[],i=a;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,a,o){var i=t.single_source_shortest_paths(n,a,o);return t.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,o={},i;n=n||{};for(i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);return o.queue=[],o.sorter=n.sorter||a.default_sorter,o},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var o={value:n,cost:a};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(mh)),mh.exports}var rm;function _P(){return rm||(rm=1,(function(e){const t=ul(),n=gP(),a=yP(),o=kP(),i=bP(),l=y1(),c=cl(),d=wP();function h(M){return unescape(encodeURIComponent(M)).length}function f(M,S,w){const I=[];let T;for(;(T=M.exec(w))!==null;)I.push({data:T[0],index:T.index,mode:S,length:T[0].length});return I}function m(M){const S=f(l.NUMERIC,t.NUMERIC,M),w=f(l.ALPHANUMERIC,t.ALPHANUMERIC,M);let I,T;return c.isKanjiModeEnabled()?(I=f(l.BYTE,t.BYTE,M),T=f(l.KANJI,t.KANJI,M)):(I=f(l.BYTE_KANJI,t.BYTE,M),T=[]),S.concat(w,I,T).sort(function(E,N){return E.index-N.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function y(M,S){switch(S){case t.NUMERIC:return n.getBitsLength(M);case t.ALPHANUMERIC:return a.getBitsLength(M);case t.KANJI:return i.getBitsLength(M);case t.BYTE:return o.getBitsLength(M)}}function k(M){return M.reduce(function(S,w){const I=S.length-1>=0?S[S.length-1]:null;return I&&I.mode===w.mode?(S[S.length-1].data+=w.data,S):(S.push(w),S)},[])}function _(M){const S=[];for(let w=0;w<M.length;w++){const I=M[w];switch(I.mode){case t.NUMERIC:S.push([I,{data:I.data,mode:t.ALPHANUMERIC,length:I.length},{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.ALPHANUMERIC:S.push([I,{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.KANJI:S.push([I,{data:I.data,mode:t.BYTE,length:h(I.data)}]);break;case t.BYTE:S.push([{data:I.data,mode:t.BYTE,length:h(I.data)}])}}return S}function x(M,S){const w={},I={start:{}};let T=["start"];for(let B=0;B<M.length;B++){const E=M[B],N=[];for(let $=0;$<E.length;$++){const z=E[$],O=""+B+$;N.push(O),w[O]={node:z,lastCount:0},I[O]={};for(let j=0;j<T.length;j++){const Z=T[j];w[Z]&&w[Z].node.mode===z.mode?(I[Z][O]=y(w[Z].lastCount+z.length,z.mode)-y(w[Z].lastCount,z.mode),w[Z].lastCount+=z.length):(w[Z]&&(w[Z].lastCount=z.length),I[Z][O]=y(z.length,z.mode)+4+t.getCharCountIndicator(z.mode,S))}}T=N}for(let B=0;B<T.length;B++)I[T[B]].end=0;return{map:I,table:w}}function D(M,S){let w;const I=t.getBestModeForData(M);if(w=t.from(S,I),w!==t.BYTE&&w.bit<I.bit)throw new Error('"'+M+'" cannot be encoded with mode '+t.toString(w)+`.
 Suggested mode is: `+t.toString(I));switch(w===t.KANJI&&!c.isKanjiModeEnabled()&&(w=t.BYTE),w){case t.NUMERIC:return new n(M);case t.ALPHANUMERIC:return new a(M);case t.KANJI:return new i(M);case t.BYTE:return new o(M)}}e.fromArray=function(S){return S.reduce(function(w,I){return typeof I=="string"?w.push(D(I,null)):I.data&&w.push(D(I.data,I.mode)),w},[])},e.fromString=function(S,w){const I=m(S,c.isKanjiModeEnabled()),T=_(I),B=x(T,w),E=d.find_path(B.map,"start","end"),N=[];for(let $=1;$<E.length-1;$++)N.push(B.table[E[$]].node);return e.fromArray(k(N))},e.rawSplit=function(S){return e.fromArray(m(S,c.isKanjiModeEnabled()))}})(dh)),dh}var cm;function CP(){if(cm)return Xd;cm=1;const e=cl(),t=Nf(),n=lP(),a=rP(),o=cP(),i=uP(),l=dP(),c=m1(),d=pP(),h=vP(),f=mP(),m=ul(),y=_P();function k(B,E){const N=B.size,$=i.getPositions(E);for(let z=0;z<$.length;z++){const O=$[z][0],j=$[z][1];for(let Z=-1;Z<=7;Z++)if(!(O+Z<=-1||N<=O+Z))for(let J=-1;J<=7;J++)j+J<=-1||N<=j+J||(Z>=0&&Z<=6&&(J===0||J===6)||J>=0&&J<=6&&(Z===0||Z===6)||Z>=2&&Z<=4&&J>=2&&J<=4?B.set(O+Z,j+J,!0,!0):B.set(O+Z,j+J,!1,!0))}}function _(B){const E=B.size;for(let N=8;N<E-8;N++){const $=N%2===0;B.set(N,6,$,!0),B.set(6,N,$,!0)}}function x(B,E){const N=o.getPositions(E);for(let $=0;$<N.length;$++){const z=N[$][0],O=N[$][1];for(let j=-2;j<=2;j++)for(let Z=-2;Z<=2;Z++)j===-2||j===2||Z===-2||Z===2||j===0&&Z===0?B.set(z+j,O+Z,!0,!0):B.set(z+j,O+Z,!1,!0)}}function D(B,E){const N=B.size,$=h.getEncodedBits(E);let z,O,j;for(let Z=0;Z<18;Z++)z=Math.floor(Z/3),O=Z%3+N-8-3,j=($>>Z&1)===1,B.set(z,O,j,!0),B.set(O,z,j,!0)}function M(B,E,N){const $=B.size,z=f.getEncodedBits(E,N);let O,j;for(O=0;O<15;O++)j=(z>>O&1)===1,O<6?B.set(O,8,j,!0):O<8?B.set(O+1,8,j,!0):B.set($-15+O,8,j,!0),O<8?B.set(8,$-O-1,j,!0):O<9?B.set(8,15-O-1+1,j,!0):B.set(8,15-O-1,j,!0);B.set($-8,8,1,!0)}function S(B,E){const N=B.size;let $=-1,z=N-1,O=7,j=0;for(let Z=N-1;Z>0;Z-=2)for(Z===6&&Z--;;){for(let J=0;J<2;J++)if(!B.isReserved(z,Z-J)){let re=!1;j<E.length&&(re=(E[j]>>>O&1)===1),B.set(z,Z-J,re),O--,O===-1&&(j++,O=7)}if(z+=$,z<0||N<=z){z-=$,$=-$;break}}}function w(B,E,N){const $=new n;N.forEach(function(J){$.put(J.mode.bit,4),$.put(J.getLength(),m.getCharCountIndicator(J.mode,B)),J.write($)});const z=e.getSymbolTotalCodewords(B),O=c.getTotalCodewordsCount(B,E),j=(z-O)*8;for($.getLengthInBits()+4<=j&&$.put(0,4);$.getLengthInBits()%8!==0;)$.putBit(0);const Z=(j-$.getLengthInBits())/8;for(let J=0;J<Z;J++)$.put(J%2?17:236,8);return I($,B,E)}function I(B,E,N){const $=e.getSymbolTotalCodewords(E),z=c.getTotalCodewordsCount(E,N),O=$-z,j=c.getBlocksCount(E,N),Z=$%j,J=j-Z,re=Math.floor($/j),K=Math.floor(O/j),ie=K+1,U=re-K,X=new d(U);let ae=0;const he=new Array(j),$e=new Array(j);let Ee=0;const Me=new Uint8Array(B.buffer);for(let de=0;de<j;de++){const se=de<J?K:ie;he[de]=Me.slice(ae,ae+se),$e[de]=X.encode(he[de]),ae+=se,Ee=Math.max(Ee,se)}const ze=new Uint8Array($);let be=0,V,Y;for(V=0;V<Ee;V++)for(Y=0;Y<j;Y++)V<he[Y].length&&(ze[be++]=he[Y][V]);for(V=0;V<U;V++)for(Y=0;Y<j;Y++)ze[be++]=$e[Y][V];return ze}function T(B,E,N,$){let z;if(Array.isArray(B))z=y.fromArray(B);else if(typeof B=="string"){let re=E;if(!re){const K=y.rawSplit(B);re=h.getBestVersionForData(K,N)}z=y.fromString(B,re||40)}else throw new Error("Invalid data");const O=h.getBestVersionForData(z,N);if(!O)throw new Error("The amount of data is too big to be stored in a QR Code");if(!E)E=O;else if(E<O)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+O+`.
`);const j=w(E,N,z),Z=e.getSymbolSize(E),J=new a(Z);return k(J,E),_(J),x(J,E),M(J,N,0),E>=7&&D(J,E),S(J,j),isNaN($)&&($=l.getBestMask(J,M.bind(null,J,N))),l.applyMask($,J),M(J,N,$),{modules:J,version:E,errorCorrectionLevel:N,maskPattern:$,segments:z}}return Xd.create=function(E,N){if(typeof E>"u"||E==="")throw new Error("No input text");let $=t.M,z,O;return typeof N<"u"&&($=t.from(N.errorCorrectionLevel,t.M),z=h.from(N.version),O=l.from(N.maskPattern),N.toSJISFunc&&e.setToSJISFunction(N.toSJISFunc)),T(E,z,$,O)},Xd}var gh={},yh={},um;function k1(){return um||(um=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const o=parseInt(a.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const o=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,l=a.scale||4;return{width:i,scale:i?4:l,margin:o,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,o){return o.width&&o.width>=a+o.margin*2?o.width/(a+o.margin*2):o.scale},e.getImageWidth=function(a,o){const i=e.getScale(a,o);return Math.floor((a+o.margin*2)*i)},e.qrToImageData=function(a,o,i){const l=o.modules.size,c=o.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,m=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let k=0;k<h;k++){let _=(y*h+k)*4,x=i.color.light;if(y>=f&&k>=f&&y<h-f&&k<h-f){const D=Math.floor((y-f)/d),M=Math.floor((k-f)/d);x=m[c[D*l+M]?1:0]}a[_++]=x.r,a[_++]=x.g,a[_++]=x.b,a[_]=x.a}}})(yh)),yh}var dm;function LP(){return dm||(dm=1,(function(e){const t=k1();function n(o,i,l){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,c){let d=c,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=a()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),m=h.getContext("2d"),y=m.createImageData(f,f);return t.qrToImageData(y.data,i,d),n(m,h,f),m.putImageData(y,0,0),h},e.renderToDataURL=function(i,l,c){let d=c;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",m=d.rendererOpts||{};return h.toDataURL(f,m.quality)}})(gh)),gh}var kh={},hm;function SP(){if(hm)return kh;hm=1;const e=k1();function t(o,i){const l=o.a/255,c=i+'="'+o.hex+'"';return l<1?c+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':c}function n(o,i,l){let c=o+i;return typeof l<"u"&&(c+=" "+l),c}function a(o,i,l){let c="",d=0,h=!1,f=0;for(let m=0;m<o.length;m++){const y=Math.floor(m%i),k=Math.floor(m/i);!y&&!h&&(h=!0),o[m]?(f++,m>0&&y>0&&o[m-1]||(c+=h?n("M",y+l,.5+k+l):n("m",d,0),d=0,h=!1),y+1<i&&o[m+1]||(c+=n("h",f),f=0)):d++}return c}return kh.render=function(i,l,c){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,m=h+d.margin*2,y=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+a(f,h,d.margin)+'"/>',_='viewBox="0 0 '+m+" "+m+'"',D='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+_+' shape-rendering="crispEdges">'+y+k+`</svg>
`;return typeof c=="function"&&c(null,D),D},kh}var fm;function IP(){if(fm)return zl;fm=1;const e=iP(),t=CP(),n=LP(),a=SP();function o(i,l,c,d,h){const f=[].slice.call(arguments,1),m=f.length,y=typeof f[m-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(m<2)throw new Error("Too few arguments provided");m===2?(h=c,c=l,l=d=void 0):m===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=c,c=l,l=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(c=l,l=d=void 0):m===2&&!l.getContext&&(d=c,c=l,l=void 0),new Promise(function(k,_){try{const x=t.create(c,d);k(i(x,l,d))}catch(x){_(x)}})}try{const k=t.create(c,d);h(null,i(k,l,d))}catch(k){h(k)}}return zl.create=t.create,zl.toCanvas=o.bind(null,n.render),zl.toDataURL=o.bind(null,n.renderToDataURL),zl.toString=o.bind(null,function(i,l,c){return a.render(i,c)}),zl}var xP=IP();const $P=Jy(xP),TP={class:"qr-container"},MP={key:0,class:"qr-warning"},AP={key:1,class:"error-text"},EP={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3},warning:{type:String,default:""}},emits:["close"],setup(e){const t=e,n=A(null),a=A(""),o=async()=>{if(!(!n.value||!t.url)){a.value="";try{await $P.toCanvas(n.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),a.value="Failed to generate QR code"}}};return Ye(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(o,50)},{immediate:!0}),(i,l)=>(p(),qe(Zt,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=c=>i.$emit("close"))},{actions:Ve(()=>[r("button",{onClick:l[0]||(l[0]=c=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",TP,[e.warning?(p(),g("p",MP,b(e.warning),1)):P("",!0),r("canvas",{ref_key:"canvasRef",ref:n,class:"qr-canvas"},null,512),a.value?(p(),g("p",AP,b(a.value),1)):P("",!0)])]),_:1},8,["show","title","z-index"]))}},Ff=Ke(EP,[["__scopeId","data-v-401727ed"]]),PP={class:"success-content"},DP={class:"success-message"},RP={class:"link-section"},OP={class:"help-text"},BP={key:0,class:"loading-text"},NP={key:1,class:"magic-link-container"},FP=["value"],UP={class:"magic-link-actions"},zP=["disabled"],HP={key:0,class:"success-text"},VP={key:1,class:"error-text"},GP={key:2,class:"error-text"},qP={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=A(""),l=A(!1),c=A(!1),d=A(""),h=A(!1),f=A(!1),m=A(!1),y=A(""),k=A(!1),_=async()=>{if(!(!a.eventId||!a.marshalId)){c.value=!0,d.value="";try{const S=await _a.getMagicLink(a.eventId,a.marshalId);i.value=S.data.magicLink,l.value=S.data.hasEmail}catch(S){console.error("Failed to fetch magic link:",S),d.value="Failed to load login link"}finally{c.value=!1}}},x=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const S=document.createElement("textarea");S.value=i.value,S.style.position="fixed",S.style.left="-9999px",document.body.appendChild(S),S.select(),document.execCommand("copy"),document.body.removeChild(S)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(S){console.error("Failed to copy:",S)}},D=async()=>{if(!(!a.eventId||!a.marshalId)){f.value=!0,m.value=!1,y.value="";try{await _a.sendMagicLink(a.eventId,a.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(S){console.error("Failed to send email:",S),y.value=S.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},M=()=>{o("close")};return Ye(()=>a.show,S=>{S&&a.marshalId?_():(i.value="",l.value=!1,d.value="",h.value=!1,m.value=!1,y.value="",k.value=!1)},{immediate:!0}),(S,w)=>(p(),g(Ie,null,[Pe(Zt,{show:e.show,title:`${F(n).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:M},{actions:Ve(()=>[r("button",{onClick:M,class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",PP,[w[4]||(w[4]=r("div",{class:"success-icon"},"",-1)),r("p",DP,[r("strong",null,b(e.marshalName),1),w[3]||(w[3]=Je(" has been added successfully. ",-1))])]),r("div",RP,[w[6]||(w[6]=r("label",null,"Login link",-1)),r("p",OP," Share this unique link with "+b(e.marshalName)+" so they can access their dashboard and check in. ",1),c.value?(p(),g("div",BP,"Loading link...")):i.value?(p(),g("div",NP,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:w[0]||(w[0]=I=>I.target.select())},null,40,FP),r("div",UP,[r("button",{type:"button",class:"btn btn-secondary",onClick:x},b(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:w[1]||(w[1]=I=>k.value=!0),title:"Show QR code"},[...w[5]||(w[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(p(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:D},b(f.value?"Sending...":"Send via email"),9,zP)):P("",!0)]),m.value?(p(),g("p",HP,"Email sent successfully!")):P("",!0),y.value?(p(),g("p",VP,b(y.value),1)):P("",!0)])):d.value?(p(),g("div",GP,b(d.value),1)):P("",!0)])]),_:1},8,["show","title"]),Pe(Ff,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:w[2]||(w[2]=I=>k.value=!1)},null,8,["show","url"])],64))}},jP=Ke(qP,[["__scopeId","data-v-9aa97b04"]]),WP={class:"form-group"},ZP={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=A("");Ye(()=>n.show,d=>{d||(o.value="")});const i=()=>{a("update:isDirty",!0)},l=()=>{a("submit",o.value)},c=()=>{a("close")};return(d,h)=>(p(),qe(Zt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ve(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",WP,[h[1]||(h[1]=r("label",null,"Email address",-1)),We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[at,o.value]])])],32)]),_:1},8,["show","is-dirty"]))}},KP=Ke(ZP,[["__scopeId","data-v-a82da194"]]),YP={class:"form-group"},JP={key:0,class:"error"},XP=["disabled"],QP={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=A(null);Ye(()=>n.show,d=>{d||(o.value=null)});const i=d=>{o.value=d.target.files[0],a("update:isDirty",!0)},l=()=>{o.value&&a("submit",o.value)},c=()=>{a("close")};return(d,h)=>(p(),qe(Zt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},b(e.uploading?"Uploading...":"Upload route"),9,XP)]),default:Ve(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",YP,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",JP,b(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},e6=Ke(QP,[["__scopeId","data-v-317975db"]]),t6={class:"instruction"},n6={class:"form-group"},o6={class:"form-group"},a6={class:"checkbox-label"},s6={key:0,class:"error"},i6={key:1,class:"import-result"},l6={key:0,class:"import-errors"},r6=["disabled"],c6={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=A(null),c=A(!1);Ye(()=>o.show,y=>{y||(l.value=null,c.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:c.value})},m=()=>{i("close")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:`Import ${F(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${F(a).checkpoints}`),9,r6)]),default:Ve(()=>[r("p",t6,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+b(F(n).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:ct(f,["prevent"])},[r("div",n6,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",o6,[r("label",a6,[We(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=_=>c.value=_),onChange:h},null,544),[[Ma,c.value]]),Je(" Delete existing "+b(F(a).checkpoints)+" before import ",1)])]),e.error?(p(),g("div",s6,b(e.error),1)):P("",!0),e.result?(p(),g("div",i6,[r("p",null,"Created "+b(e.result.locationsCreated)+" "+b(F(a).checkpoints)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",l6,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Ie,null,je(e.result.errors,(_,x)=>(p(),g("li",{key:x},b(_),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},u6=Ke(c6,[["__scopeId","data-v-75c79d31"]]),d6={class:"instruction"},h6={class:"form-group"},f6={key:0,class:"error"},p6={key:1,class:"import-result"},v6={key:0,class:"import-errors"},m6=["disabled"],g6={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=A(null);Ye(()=>o.show,f=>{f||(l.value=null)});const c=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,m)=>(p(),qe(Zt,{show:e.show,title:`Import ${F(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Ve(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${F(a).people}`),9,m6)]),default:Ve(()=>[r("p",d6,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+b(F(n).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:ct(d,["prevent"])},[r("div",h6,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:c,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",f6,b(e.error),1)):P("",!0),e.result?(p(),g("div",p6,[r("p",null,"Imported "+b(e.result.marshalsCreated)+" "+b(F(a).people)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",v6,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(Ie,null,je(e.result.errors,(y,k)=>(p(),g("li",{key:k},b(y),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},y6=Ke(g6,[["__scopeId","data-v-be89bf1f"]]),k6=["onClick"],b6=["innerHTML"],w6={class:"hamburger-nav"},_6=["disabled"],C6=["innerHTML"],L6={class:"current-tab-label"},S6=["disabled"],I6={key:0,class:"hamburger-menu"},x6=["onClick"],$6=["innerHTML"],T6=400,M6={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,o=A(null),i=A(null),l=A(null),c=A(!1),d=A(!1),h=H(()=>{const T=n.tabs.find(B=>B.value===n.modelValue);return T?T.label:""}),f=H(()=>n.tabs.find(B=>B.value===n.modelValue)?.icon||null),m=H(()=>n.tabs.findIndex(T=>T.value===n.modelValue)),y=H(()=>m.value>0),k=H(()=>m.value<n.tabs.length-1),_=()=>{y.value&&a("update:modelValue",n.tabs[m.value-1].value)},x=()=>{k.value&&a("update:modelValue",n.tabs[m.value+1].value)},D=()=>{if(!o.value)return;const T=o.value.clientWidth;if(T<T6){c.value=!0;return}if(i.value&&!c.value){i.value.scrollWidth>T&&(c.value=!0);return}const B=n.tabs.some($=>$.icon)?110:90,E=n.tabs.length*B,N=(n.tabs.length-1)*8;E+N<=T&&(c.value=!1,cn(()=>{i.value&&i.value.scrollWidth>T&&(c.value=!0)}))},M=()=>{d.value=!d.value},S=T=>{a("update:modelValue",T),d.value=!1},w=T=>{l.value&&!l.value.contains(T.target)&&(d.value=!1)};let I=null;return un(()=>{cn(()=>{D(),o.value&&typeof ResizeObserver<"u"&&(I=new ResizeObserver(()=>{D()}),I.observe(o.value)),document.addEventListener("click",w)})}),Ln(()=>{I&&I.disconnect(),document.removeEventListener("click",w)}),Ye(()=>n.tabs,()=>{cn(()=>{D()})},{deep:!0}),(T,B)=>(p(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:o},[c.value?(p(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",w6,[r("button",{class:le(["nav-arrow",{invisible:!y.value}]),onClick:_,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,_6),r("button",{class:"hamburger-button",onClick:M,type:"button","aria-label":"Tab menu"},[f.value?(p(),g("span",{key:0,class:"current-tab-icon",innerHTML:F(to)(f.value)},null,8,C6)):P("",!0),r("span",L6,b(h.value),1),B[0]||(B[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:le(["nav-arrow",{invisible:!k.value}]),onClick:x,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,S6)]),d.value?(p(),g("div",I6,[(p(!0),g(Ie,null,je(e.tabs,E=>(p(),g("button",{key:E.value,class:le(["menu-item",{active:e.modelValue===E.value}]),onClick:N=>S(E.value),type:"button"},[E.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:F(to)(E.icon)},null,8,$6)):P("",!0),Je(" "+b(E.label),1)],10,x6))),128))])):P("",!0)],512)):(p(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(p(!0),g(Ie,null,je(e.tabs,E=>(p(),g("button",{key:E.value,class:le(["tab-button",{active:e.modelValue===E.value}]),onClick:N=>T.$emit("update:modelValue",E.value),type:"button"},[E.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:F(to)(E.icon)},null,8,b6)):P("",!0),Je(" "+b(E.label),1)],10,k6))),128))],512))],512))}},dl=Ke(M6,[["__scopeId","data-v-736c5d0a"]]),A6={class:"tab-content"},E6={class:"form-group"},P6=["value"],D6={class:"form-group"},R6=["value"],O6={class:"form-group"},B6={class:"area-display"},N6={key:0,class:"no-area"},F6={class:"form-help"},U6={class:"form-group checkbox-group"},z6={class:"checkbox-label"},H6=["checked"],V6={class:"form-help"},G6={key:0,class:"custom-times-section"},q6={class:"form-group"},j6=["value"],W6={class:"form-help"},Z6={class:"form-group"},K6=["value"],Y6={class:"form-help"},J6={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>(n.form.areaIds||n.form.AreaIds||[]).map(d=>n.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(c,d)=>{a("update:form",{...n.form,[c]:d}),a("input")},l=c=>{const d={...n.form,useCustomTimes:c};if(!c)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&n.eventDate){const h=rc(n.eventDate);d.startTime=h,d.endTime=h}a("update:form",d),a("input")};return(c,d)=>(p(),g("div",A6,[r("form",{onSubmit:d[5]||(d[5]=ct(h=>c.$emit("save"),["prevent"]))},[r("div",E6,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,P6)]),r("div",D6,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,R6)]),r("div",O6,[r("label",null,b(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",B6,[o.value.length===0?(p(),g("span",N6," Not in any "+b(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(p(!0),g(Ie,null,je(o.value,h=>(p(),g("span",{key:h.id,class:"area-badge",style:tt({backgroundColor:h.color||"var(--brand-primary)"})},b(h.name),5))),128))]),r("small",F6,b(e.areaTermPlural)+" are automatically assigned based on "+b(e.checkpointTermSingular.toLowerCase())+" location within "+b(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",U6,[r("label",z6,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,H6),r("span",null,"Use custom date/time for this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("small",V6," By default, "+b(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(p(),g("div",G6,[r("div",q6,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,j6),r("small",W6," When "+b(e.peopleTermPlural.toLowerCase())+" should arrive at this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("div",Z6,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,K6),r("small",Y6," When "+b(e.peopleTermPlural.toLowerCase())+" can leave this "+b(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},X6=Ke(J6,[["__scopeId","data-v-aa628901"]]),Q6={class:"scope-configuration-editor"},e5={class:"editor-header"},t5={class:"scope-types-list"},n5=["onClick"],o5={class:"scope-type-label"},a5={class:"scope-type-pill"},s5={class:"expand-label"},i5={class:"expand-icon"},l5={class:"modal-content"},r5={class:"modal-header"},c5={class:"modal-body"},u5={class:"scope-help"},d5={key:0,class:"form-group"},h5={class:"checkbox-label special-option"},f5=["checked"],p5={key:0,class:"specific-selection"},v5=["placeholder"],m5={class:"checkbox-group scrollable"},g5=["checked","onChange"],y5={key:1,class:"form-group"},k5={class:"checkbox-label special-option"},b5=["checked"],w5={key:0,class:"specific-selection"},_5={class:"checkbox-group scrollable"},C5=["checked","onChange"],L5={key:2,class:"form-group"},S5={class:"checkbox-label special-option"},I5=["checked"],x5={key:0,class:"specific-selection"},$5=["placeholder"],T5={class:"checkbox-group scrollable"},M5={key:0,class:"checkbox-label this-checkpoint-option"},A5=["checked"],E5={class:"checkpoint-info"},P5={class:"checkpoint-name"},D5=["checked","onChange"],R5={class:"checkpoint-info"},O5={class:"checkpoint-name"},B5={key:0,class:"checkpoint-description"},N5={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=H(()=>[{scope:"SpecificPeople",label:`Specific ${n.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${n.value.person} at specified ${n.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${n.value.person} at each specified ${n.value.checkpoint}`},{scope:"OnePerArea",label:`One ${n.value.person} in specified ${n.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${n.value.areas}`},{scope:"EveryAreaLead",label:`Every ${n.value.area} lead at specified ${n.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${n.value.area}`}]),l=A({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),c=A(null),d=A(""),h=A(""),f=A(!a.isEditing);let m=!0,y=!1;const k=H(()=>i.value.filter(se=>!a.excludeScopes.includes(se.scope))),_=H(()=>f.value?k.value:k.value.filter(se=>z(se.scope))),x=H(()=>k.value.filter(Re=>z(Re.scope)).length<k.value.length),D=H(()=>{const se=k.value.filter(Re=>z(Re.scope)).length;return k.value.length-se}),M=H(()=>!a.currentCheckpointId&&a.intent==="location-update");Ye(()=>a.modelValue,se=>{if(se){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach(Re=>{l.value[Re]={enabled:!1,ids:[]}}),se.forEach(Re=>{Re.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Re.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Re.ids]}:l.value[Re.scope]&&(l.value[Re.scope]={enabled:!0,ids:[...Re.ids]})}),m=!1}},{immediate:!0});const S=()=>{const se=[];return Object.keys(l.value).forEach(Re=>{const q=l.value[Re];if(q.enabled){const Q={scope:Re,itemType:w(Re),ids:[...q.ids]};se.push(Q)}}),se};Ye(l,()=>{if(m)return;if(Object.keys(l.value).some(q=>q!=="SpecificPeople"&&l.value[q].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const q=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(q,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Re=S();o("update:modelValue",Re),o("user-changed")},{deep:!0});const w=se=>I(se)?"Area":T(se)?"Checkpoint":B(se)?"Marshal":null,I=se=>se==="EveryoneInAreas"||se==="OnePerArea"||se==="EveryAreaLead"||se==="OneLeadPerArea",T=se=>se==="EveryoneAtCheckpoints"||se==="OnePerCheckpoint",B=se=>se==="SpecificPeople",E=se=>{const Re=i.value.find(q=>q.scope===se);return Re?Re.label:se},N=H(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${n.value.checklist}?`),$=se=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${n.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${n.value.person} at each selected ${n.value.checkpoint} can update the location`,OnePerArea:`Any ${n.value.person} in each selected ${n.value.area} can update the location`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} can update the location`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} can update the location`,OneLeadPerArea:`Any ${n.value.area} lead at the selected ${n.value.areas} can update the location`}[se]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${n.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${n.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${n.value.area} (shared completion)`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${n.value.area}, only ${n.value.area} leads can complete (shared among leads)`}[se]||"",z=se=>l.value[se]?.enabled||!1,O=se=>{const Re=l.value[se];if(!Re||!Re.enabled)return"No";const q=Re.ids||[];if(I(se)){if(q.includes("ALL_AREAS"))return`All ${n.value.areas}`;const Q=q.length;return Q>0?`${Q} ${Q!==1?n.value.areas:n.value.area}`:`Select ${n.value.areas}...`}if(T(se)){if(q.includes("ALL_CHECKPOINTS"))return`All ${n.value.checkpoints}`;if(q.length===1&&q[0]==="THIS_CHECKPOINT")return`This ${n.value.checkpoint}`;const Q=q.length;return Q>0?`${Q} ${Q!==1?n.value.checkpoints:n.value.checkpoint}`:`Select ${n.value.checkpoints}...`}if(B(se)){if(q.includes("ALL_MARSHALS"))return"Everyone";const Q=q.length;return Q>0?`${Q} ${Q!==1?n.value.people:n.value.person}`:`Select ${n.value.people}...`}return"Configured"},j=se=>{c.value=se,d.value="",h.value=""},Z=()=>{c.value=null},J=()=>{c.value&&(l.value[c.value]={enabled:!1,ids:[]}),Z()},re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_MARSHALS"),K=()=>{if(!c.value)return;const se=l.value[c.value];re()?(se.ids=[],se.enabled=!1):(se.ids=["ALL_MARSHALS"],se.enabled=!0)},ie=se=>c.value&&l.value[c.value]?.ids.includes(se),U=se=>{if(!c.value)return;const Re=l.value[c.value],q=Re.ids.indexOf(se);q>=0?(Re.ids.splice(q,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(se),Re.enabled=!0)},X=()=>{let se=a.marshals;if(h.value){const q=h.value.toLowerCase();se=se.filter(Q=>Q.name.toLowerCase().includes(q)||Q.email&&Q.email.toLowerCase().includes(q))}const Re=c.value?l.value[c.value]?.ids||[]:[];return[...se].sort((q,Q)=>{const ee=Re.includes(q.id),_e=Re.includes(Q.id);return ee&&!_e?-1:!ee&&_e?1:q.name.localeCompare(Q.name,void 0,{sensitivity:"base"})})},ae=()=>c.value&&l.value[c.value]?.ids.includes("ALL_AREAS"),he=()=>{if(!c.value)return;const se=l.value[c.value];ae()?(se.ids=[],se.enabled=!1):(se.ids=["ALL_AREAS"],se.enabled=!0)},$e=se=>c.value&&l.value[c.value]?.ids.includes(se),Ee=()=>{const se=c.value?l.value[c.value]?.ids||[]:[];return[...a.areas].sort((Re,q)=>{const Q=se.includes(Re.id),ee=se.includes(q.id);return Q&&!ee?-1:!Q&&ee?1:Re.name.localeCompare(q.name,void 0,{sensitivity:"base"})})},Me=se=>{if(!c.value)return;const Re=l.value[c.value],q=Re.ids.indexOf(se);q>=0?(Re.ids.splice(q,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(se),Re.enabled=!0)},ze=()=>c.value&&l.value[c.value]?.ids.includes("ALL_CHECKPOINTS"),be=()=>{if(!c.value)return;const se=l.value[c.value];ze()?(se.ids=[],se.enabled=!1):(se.ids=["ALL_CHECKPOINTS"],se.enabled=!0)},V=se=>c.value&&l.value[c.value]?.ids.includes(se),Y=se=>{if(!c.value)return;const Re=l.value[c.value],q=Re.ids.indexOf(se);q>=0?(Re.ids.splice(q,1),Re.ids.length===0&&(Re.enabled=!1)):(Re.ids.push(se),Re.enabled=!0)},de=()=>{let se=a.locations;if(d.value){const q=d.value.toLowerCase();se=se.filter(Q=>Q.name.toLowerCase().includes(q)||Q.description&&Q.description.toLowerCase().includes(q))}const Re=c.value?l.value[c.value]?.ids||[]:[];return[...se].sort((q,Q)=>{const ee=Re.includes(q.id),_e=Re.includes(Q.id);return ee&&!_e?-1:!ee&&_e?1:ea(q.name,Q.name)})};return(se,Re)=>(p(),g("div",Q6,[r("div",e5,[r("h4",null,b(N.value),1)]),r("div",t5,[(p(!0),g(Ie,null,je(_.value,q=>(p(),g("div",{key:q.scope,class:le(["scope-type-row",{active:z(q.scope)}]),onClick:Q=>j(q.scope)},[r("div",o5,b(q.label),1),r("div",a5,b(O(q.scope)),1)],10,n5))),128)),x.value?(p(),g("div",{key:0,class:"expand-row",onClick:Re[0]||(Re[0]=q=>f.value=!f.value)},[r("div",s5,b(f.value?"Show less":`Show ${D.value} more option${D.value!==1?"s":""}...`),1),r("div",i5,b(f.value?"":""),1)])):P("",!0)]),c.value?(p(),g("div",{key:0,class:"scope-config-modal",onClick:ct(Z,["self"])},[r("div",l5,[r("div",r5,[r("h5",null,b(E(c.value)),1),r("button",{onClick:Z,class:"btn-close",type:"button"},"")]),r("div",c5,[r("p",u5,b($(c.value)),1),B(c.value)?(p(),g("div",d5,[r("label",h5,[r("input",{type:"checkbox",checked:re(),onChange:K},null,40,f5),r("span",null,[Re[4]||(Re[4]=r("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+b(F(n).people)+")",1)])]),re()?P("",!0):(p(),g("div",p5,[We(r("input",{"onUpdate:modelValue":Re[1]||(Re[1]=q=>h.value=q),type:"text",placeholder:`Search ${F(n).people}...`,class:"search-input"},null,8,v5),[[at,h.value]]),r("div",m5,[(p(!0),g(Ie,null,je(X(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:ie(q.id),onChange:Q=>U(q.id)},null,40,g5),r("span",null,b(q.name),1)]))),128))])]))])):P("",!0),I(c.value)?(p(),g("div",y5,[r("label",k5,[r("input",{type:"checkbox",checked:ae(),onChange:he},null,40,b5),r("span",null,[r("strong",null,"All "+b(F(n).areas),1),Je(" (includes future "+b(F(n).areas)+")",1)])]),ae()?P("",!0):(p(),g("div",w5,[r("div",_5,[(p(!0),g(Ie,null,je(Ee(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:$e(q.id),onChange:Q=>Me(q.id)},null,40,C5),r("span",{class:"area-color-dot",style:tt({backgroundColor:q.color||"#667eea"})},null,4),r("span",null,b(q.name),1)]))),128))])]))])):P("",!0),T(c.value)?(p(),g("div",L5,[r("label",S5,[r("input",{type:"checkbox",checked:ze(),onChange:be},null,40,I5),r("span",null,[r("strong",null,"All "+b(F(n).checkpoints),1),Je(" (includes future "+b(F(n).checkpoints)+")",1)])]),ze()?P("",!0):(p(),g("div",x5,[We(r("input",{"onUpdate:modelValue":Re[2]||(Re[2]=q=>d.value=q),type:"text",placeholder:`Search ${F(n).checkpoints}...`,class:"search-input"},null,8,$5),[[at,d.value]]),r("div",T5,[M.value?(p(),g("label",M5,[r("input",{type:"checkbox",checked:V("THIS_CHECKPOINT"),onChange:Re[3]||(Re[3]=q=>Y("THIS_CHECKPOINT"))},null,40,A5),r("div",E5,[r("span",P5,[r("strong",null,"This "+b(F(n).checkpoint),1)])])])):P("",!0),(p(!0),g(Ie,null,je(de(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:V(q.id),onChange:Q=>Y(q.id)},null,40,D5),r("div",R5,[r("span",O5,b(q.name),1),q.description?(p(),g("span",B5," - "+b(q.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:J,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:Z,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},id=Ke(N5,[["__scopeId","data-v-d465703e"]]),F5={class:"tab-content"},U5={class:"form-group"},z5=["value"],H5={key:0,class:"form-error"},V5={class:"form-row"},G5={class:"form-group"},q5=["disabled"],j5={class:"form-group"},W5=["disabled"],Z5={class:"form-group"},K5={class:"accordion-item"},Y5={class:"accordion-preview"},J5={class:"accordion-arrow"},X5={key:0,class:"accordion-content"},Q5={class:"section-description"},e8={class:"dynamic-checkbox"},t8=["checked"],n8={key:0,class:"dynamic-settings"},o8={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const n=e,a=t,o=A(!1),i=A(""),l=A(""),c=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ye(()=>n.form.longitude,k=>{i.value=c(k)},{immediate:!0}),Ye(()=>n.form.latitude,k=>{l.value=c(k)},{immediate:!0});const d=k=>{const _=k==="longitude"?i:l,x=parseFloat(_.value);isNaN(x)?_.value.trim()===""&&(a("update:form",{...n.form,[k]:0}),a("input"),_.value=c(0)):(a("update:form",{...n.form,[k]:x}),a("input"),_.value=c(x))},h=(k,_)=>{a("update:form",{...n.form,[k]:_}),a("input")},f=k=>{if(k){const x=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[n.form.id||"THIS_CHECKPOINT"]}];a("update:form",{...n.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else a("update:form",{...n.form,isDynamic:!1});a("input")},m=k=>{a("update:form",{...n.form,locationUpdateScopeConfigurations:k}),a("input")},y=k=>{if(!k)return!0;const _=k.includes(".")?k.split("."):k.split("/");if(_.length!==3)return!1;const x=/^[a-z]{1,20}$/;return _.every(D=>x.test(D))};return(k,_)=>(p(),g("div",F5,[r("form",{onSubmit:_[6]||(_[6]=ct(x=>k.$emit("save"),["prevent"]))},[r("div",U5,[_[10]||(_[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:_[0]||(_[0]=x=>h("what3Words",x.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,z5),e.form.what3Words&&!y(e.form.what3Words)?(p(),g("small",H5," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(p(),g(Ie,{key:0},[r("div",V5,[r("div",G5,[_[11]||(_[11]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":_[1]||(_[1]=x=>i.value=x),onBlur:_[2]||(_[2]=x=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,q5),[[at,i.value]])]),r("div",j5,[_[12]||(_[12]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":_[3]||(_[3]=x=>l.value=x),onBlur:_[4]||(_[4]=x=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,W5),[[at,l.value]])])]),r("div",Z5,[r("button",{type:"button",onClick:_[5]||(_[5]=x=>k.$emit("move-location")),class:le(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[_[13]||(_[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+b(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",K5,[r("button",{type:"button",class:le(["accordion-header",{expanded:o.value}]),onClick:_[7]||(_[7]=x=>o.value=!o.value)},[_[14]||(_[14]=ui('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",Y5,b(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",J5,b(o.value?"":""),1)],2),o.value?(p(),g("div",X5,[r("p",Q5," Enable this for lead cars, sweep vehicles, or other moving "+b(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+b(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",e8,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:_[8]||(_[8]=x=>f(x.target.checked))},null,40,t8),r("span",null,"This "+b(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(p(),g("div",n8,[Pe(id,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:_[9]||(_[9]=x=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},a8=Ke(o8,[["__scopeId","data-v-bd432637"]]);function b1(e){const t=A(new Map),n=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:n,handleToggleCheckIn:f=>{const y=!n(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>n(f)?"":"",getStatusColor:f=>n(f)?"#28a745":"#dc3545",getStatusText:f=>n(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const s8={class:"card-main"},i8={class:"card-title"},l8={class:"marshal-name"},r8={key:0,class:"card-check-in"},c8={class:"toggle-icon"},u8={class:"toggle-label"},d8={key:0,class:"check-in-time"},h8={key:0,class:"check-in-method"},f8={key:1,class:"unsaved-indicator"},p8={key:1,class:"card-status-readonly"},v8={class:"status-icon"},m8={key:0,class:"check-in-time"},g8={key:0,class:"check-in-method"},y8={key:2,class:"card-badge"},k8={key:3,class:"card-badge"},b8={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const n=e,a=t,o=()=>{a("distance-click",n.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=H(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:_}=n.assignment;return y&&y!==_?y:k||""}),c=H(()=>!n.assignment.isPending&&!n.isMarkedForRemoval&&!n.readOnly),d=H(()=>{const{checkInLatitude:y,checkInLongitude:k}=n.assignment,_=n.location;return!y||!k||!_?.latitude||!_?.longitude?null:sl(y,k,_.latitude,_.longitude)}),h=H(()=>d.value===null?null:h2(d.value)),f=H(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),m=()=>{c.value&&a("click",n.assignment)};return(y,k)=>(p(),g("div",{class:le(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":c.value}]),onClick:m},[r("div",s8,[r("div",i8,[r("span",l8,b(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(p(),g("div",r8,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=ct(_=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",c8,b(e.effectiveCheckInStatus?"":""),1),r("span",u8,b(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",d8,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",h8,"("+b(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},b(h.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",f8," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(p(),g("div",p8,[r("span",{class:le(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",v8,b(e.effectiveCheckInStatus?"":""),1),Je(" "+b(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(p(),g("span",m8,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",g8,"("+b(l.value)+")",1)):P("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},b(h.value),3)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(p(),g("div",y8,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",k8,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=ct(_=>y.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=ct(_=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},w8=Ke(b8,[["__scopeId","data-v-85a18d73"]]),_8={class:"tab-content"},C8={key:0,class:"read-only-notice"},L8={key:1,class:"form-group"},S8=["value"],I8={class:"section-title"},x8={key:2,class:"assign-section"},$8={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:n}){const a=e,o=H(()=>a.peopleTerm.toLowerCase()),i=H(()=>a.personTerm.toLowerCase()),l=H(()=>a.checkpointTerm.toLowerCase()),c=n,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=b1(()=>c("input")),m=A(new Set),y=H(()=>a.assignments?.length||0),k=H(()=>a.assignments?[...a.assignments].sort(($,z)=>($.marshalName||"").localeCompare(z.marshalName||"",void 0,{sensitivity:"base"})):[]),_=$=>m.value.has($),x=$=>{$.isPending||c("select-marshal",$)},D=A(!1),M=A(null),S=$=>{h($)?(M.value=$,D.value=!0):f($)},w=()=>{M.value&&f(M.value),D.value=!1,M.value=null},I=()=>{D.value=!1,M.value=null},T=H(()=>M.value?`Are you sure you want to undo ${M.value.marshalName||"this marshal"}'s check-in?`:""),B=$=>{$.isPending?c("remove-assignment",$):(m.value.add($.id),c("input"))},E=$=>{m.value.delete($.id),c("input")},N=($,z)=>{c("update:form",{...a.form,[$]:Number(z)}),c("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([$,z])=>({assignmentId:$,shouldBeCheckedIn:z})),getMarkedForRemoval:()=>Array.from(m.value)}),($,z)=>(p(),g("div",_8,[e.readOnly?(p(),g("div",C8," Viewing from "+b(i.value)+" - "+b(o.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(p(),g("div",L8,[r("label",null,"Required "+b(o.value),1),r("input",{value:e.form.requiredMarshals,onInput:z[0]||(z[0]=O=>N("requiredMarshals",O.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,S8)])),r("h3",I8,"Assigned "+b(o.value)+" ("+b(y.value)+")",1),Pe(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${o.value} assigned yet.`,"empty-hint":`Use the button below to assign ${o.value} to this ${l.value}.`},{default:Ve(()=>[(p(!0),g(Ie,null,je(k.value,O=>(p(),qe(w8,{key:O.id,assignment:O,"effective-check-in-status":F(h)(O),"has-unsaved-changes":F(d).has(O.id),"is-marked-for-removal":_(O.id),"read-only":e.readOnly,location:e.form,onClick:x,onToggleCheckIn:S,onRemove:B,onUndoRemove:E,onDistanceClick:z[1]||(z[1]=j=>$.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(p(),g("div",x8,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:z[2]||(z[2]=O=>$.$emit("open-assign-modal"))}," + Assign "+b(i.value)+"... ",1)])),Pe(hi,{show:D.value,title:"Confirm check-out",message:T.value,"confirm-text":"Check out","is-danger":!0,onConfirm:w,onCancel:I},null,8,["show","message"])]))}},T8=Ke($8,[["__scopeId","data-v-7124720e"]]),M8={class:"grouped-tasks-list"},A8={key:0,class:"empty-state"},E8={class:"task-group-header-row"},P8=["onClick"],D8={class:"task-header-content"},R8={class:"task-checkbox-area"},O8={class:"task-info"},B8={class:"task-name"},N8={class:"task-summary"},F8={key:0,class:"modified-badge"},U8={class:"task-scope"},z8=["title"],H8={class:"expand-arrow"},V8={key:0,class:"task-group-details"},G8={class:"detail-checkbox"},q8=["checked","disabled","onChange"],j8={class:"detail-content"},W8={class:"detail-context"},Z8={key:0,class:"detail-completion"},K8={key:0,class:"pending-text"},Y8={class:"completion-text"},J8={class:"completion-time"},X8={key:1,class:"detail-uncomplete"},Q8={key:2,class:"detail-disabled"},eD={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["toggle-complete","reorder"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=A(new Set),c=H(()=>{const D=new Map;for(const M of o.items){D.has(M.itemId)||D.set(M.itemId,{itemId:M.itemId,text:M.text,displayOrder:M.displayOrder||0,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const S=D.get(M.itemId);S.items.push(M),S.totalCount++,M.localIsCompleted&&S.completedCount++,M.isModified&&(S.hasModified=!0)}for(const M of D.values())M.allCompleted=M.completedCount===M.totalCount,M.items.sort((S,w)=>{const I=_(S),T=_(w);return I.localeCompare(T,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(D.values()).sort((M,S)=>{const w=M.displayOrder||0,I=S.displayOrder||0;return w!==I?w-I:M.text.localeCompare(S.text,void 0,{sensitivity:"base"})})}),d=D=>{l.value.has(D)?l.value.delete(D):l.value.add(D),l.value=new Set(l.value)},h=({changes:D})=>{i("reorder",D)},f=D=>D.hasModified?"status-modified":D.allCompleted?"status-completed":D.completedCount>0?"status-partial":"status-pending",m=D=>D.allCompleted?"":D.completedCount>0?"":"",y=D=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[D.matchedScope]||D.matchedScope,k=D=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[D.matchedScope]||"",_=D=>{if(!D.completionContextType||!D.completionContextId)return"Everyone";if(D.completionContextType==="Checkpoint"){const M=o.locations.find(S=>S.id===D.completionContextId);return M?M.description?`${M.name} - ${M.description}`:M.name:`${n.value.checkpoint} (unknown)`}if(D.completionContextType==="Area"){const M=o.areas.find(S=>S.id===D.completionContextId);return M?M.name:`${n.value.area} (unknown)`}if(D.completionContextType==="Personal"){if(D.contextOwnerName)return D.contextOwnerName;if(D.completionContextId&&o.marshals.length>0){const M=o.marshals.find(S=>S.id===D.completionContextId||S.marshalId===D.completionContextId);if(M)return M.name||M.marshalName}return"Assigned individually"}return D.completionContextType},x=D=>D?new Date(D).toLocaleString():"";return(D,M)=>(p(),g("div",M8,[c.value.length===0?(p(),g("div",A8,[...M[0]||(M[0]=[r("p",null,"No tasks available.",-1)])])):(p(),qe(ll,{key:1,items:c.value,"item-key":"itemId",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:h},{item:Ve(({element:S})=>[r("div",{class:le(["task-group",{"all-completed":S.allCompleted,"has-modified":S.hasModified}])},[r("div",E8,[e.allowReorder?(p(),qe(rl,{key:0,class:"task-drag-handle"})):P("",!0),r("button",{type:"button",class:"task-group-header",onClick:w=>d(S.itemId)},[r("div",D8,[r("div",R8,[r("span",{class:le(["task-status-icon",f(S)])},b(m(S)),3)]),r("div",O8,[r("div",B8,b(S.text),1),r("div",N8,[r("span",{class:le(["completion-count",{"all-done":S.allCompleted}])},b(S.completedCount)+"/"+b(S.totalCount)+" completed ",3),S.hasModified?(p(),g("span",F8," Modified ")):P("",!0)])]),r("div",U8,[S.items[0]?.scopeConfigurations?.length?(p(),qe(ol,{key:0,"scope-configurations":S.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("span",{key:1,class:"scope-pill",title:k(S.items[0])},b(y(S.items[0])),9,z8))])]),r("span",H8,b(l.value.has(S.itemId)?"":""),1)],8,P8)]),l.value.has(S.itemId)?(p(),g("div",V8,[(p(!0),g(Ie,null,je(S.items,w=>(p(),g("div",{key:`${w.itemId}-${w.completionContextId}`,class:le(["task-detail-item",{"item-completed":w.localIsCompleted,"item-modified":w.isModified}])},[r("div",G8,[r("input",{type:"checkbox",checked:w.localIsCompleted,disabled:!w.canBeCompletedByMe&&!w.localIsCompleted,onChange:I=>D.$emit("toggle-complete",w)},null,40,q8)]),r("div",j8,[r("div",W8,b(_(w)),1),w.localIsCompleted?(p(),g("div",Z8,[w.isModified&&!w.isCompleted?(p(),g("span",K8," Will be marked as completed ")):(p(),g(Ie,{key:1},[r("span",Y8,b(w.completedByActorName||"Unknown"),1),r("span",J8,b(x(w.completedAt)),1)],64))])):w.isModified&&w.isCompleted?(p(),g("div",X8,[...M[1]||(M[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):w.canBeCompletedByMe?P("",!0):(p(),g("div",Q8," Already completed by someone else "))])],2))),128))])):P("",!0)],2)]),_:1},8,["items","disabled","show-order-overlay"]))]))}},Uf=Ke(eD,[["__scopeId","data-v-8651b001"]]),tD={class:"checkpoint-checklist-view"},nD={key:0,class:"loading-state"},oD={key:1,class:"error-state"},aD={key:2,class:"empty-state"},sD={class:"help-text"},iD={key:3,class:"empty-state"},lD={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,l=A([]),c=A(!1),d=A(null),h=A(new Map),f=H(()=>o.assignments.length===0),m=H(()=>l.value.map(M=>{const S=h.value.get(`${M.itemId}|||${M.completionContextId}`),w=S!==void 0?S.complete:M.isCompleted,I=S!==void 0&&S.complete!==M.isCompleted;return{...M,localIsCompleted:w,isModified:I}})),y=async()=>{if(!(!o.eventId||!o.locationId&&!o.areaId)){c.value=!0,d.value=null;try{const M=o.locationId?await zt.getCheckpointChecklist(o.eventId,o.locationId):await zt.getAreaChecklist(o.eventId,o.areaId);if(l.value=M.data||[],o.modelValue&&o.modelValue.length>0){const S=new Map;o.modelValue.forEach(w=>{S.set(`${w.itemId}|||${w.contextId}`,{complete:w.complete,contextType:w.contextType,contextId:w.contextId})}),h.value=S}}catch(M){console.error("Failed to load checklist:",M),d.value=M.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},k=M=>{const S=M.contextOwnerMarshalId||(o.assignments.length>0?o.assignments[0].marshalId:null);if(!S)return;const w=`${M.itemId}|||${M.completionContextId}`,I=h.value.get(w),T=I!==void 0?I.complete:M.isCompleted;h.value.set(w,{complete:!T,contextType:M.completionContextType,contextId:M.completionContextId,marshalId:S}),_()},_=()=>{const M=[];for(const[S,w]of h.value.entries()){const[I,T]=S.split("|||"),B=l.value.find(E=>E.itemId===I&&E.completionContextId===T);B&&w.complete!==B.isCompleted&&M.push({itemId:I,complete:w.complete,contextType:w.contextType,contextId:w.contextId,marshalId:w.marshalId})}i("update:modelValue",M),i("change",M)},x=M=>{i("reorder",M)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const M=new Map;o.modelValue.forEach(S=>{M.set(`${S.itemId}|||${S.contextId}`,{complete:S.complete,contextType:S.contextType,contextId:S.contextId,marshalId:S.marshalId})}),h.value=M}},loadChecklist:y}),Ye(()=>[o.eventId,o.locationId,o.areaId],()=>{y()},{immediate:!0}),(M,S)=>(p(),g("div",tD,[c.value?(p(),g("div",nD," Loading checklist... ")):d.value?(p(),g("div",oD,[r("p",null,b(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(p(),g("div",aD,[r("p",null,"No "+b(F(a).peoplePlural)+" assigned to this "+b(F(a).checkpoint)+" yet.",1),r("p",sD,"Assign "+b(F(a).peoplePlural)+" to enable "+b(F(a).checklist)+" completion.",1)])):l.value.length===0?(p(),g("div",iD,[r("p",null,"No checklist items for this "+b(F(a).checkpoint)+".",1)])):(p(),qe(Uf,{key:4,items:m.value,locations:e.locations,areas:e.areas,marshals:e.marshals,"allow-reorder":e.allowReorder,onToggleComplete:k,onReorder:x},null,8,["items","locations","areas","marshals","allow-reorder"]))]))}},w1=Ke(lD,[["__scopeId","data-v-d3deb94b"]]),rD={class:"notes-view"},cD={key:0,class:"loading-state"},uD={key:1,class:"error-state"},dD={key:2,class:"empty-state"},hD={class:"note-item-content"},fD={class:"note-header"},pD={class:"note-title-row"},vD={key:0,class:"pin-icon",title:"Pinned"},mD={class:"note-title"},gD={class:"note-meta"},yD={key:0,class:"category-badge"},kD={key:0,class:"note-content"},bD={class:"note-footer"},wD={class:"created-info"},_D={key:1,class:"scope-info"},CD={key:1,class:"notes-list"},LD={class:"note-item-content"},SD={class:"note-header"},ID={class:"note-title-row"},xD={key:0,class:"pin-icon",title:"Pinned"},$D={class:"note-title"},TD={class:"note-meta"},MD={key:0,class:"category-badge"},AD={key:0,class:"note-content"},ED={class:"note-footer"},PD={class:"created-info"},DD={key:1,class:"scope-info"},RD={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0},allowReorder:{type:Boolean,default:!1}},emits:["reorder"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=A([]),l=A(!1),c=A(null),d=H(()=>a.marshalId?"No notes for this marshal.":a.areaId?"No notes for this area.":a.locationId?"No notes for this checkpoint.":"No notes available."),h=H(()=>a.areaId?a.locations.filter(I=>I.areaIds&&I.areaIds.includes(a.areaId)):[]),f=H(()=>h.value.map(I=>I.id)),m=H(()=>{if(!a.areaId)return[];const I=new Set;return a.assignments.filter(T=>f.value.includes(T.locationId)).forEach(T=>I.add(T.marshalId)),Array.from(I)}),y=I=>a.assignments.filter(T=>T.marshalId===I).map(T=>T.locationId),k=I=>{const T=y(I),B=new Set;for(const E of T){const N=a.locations.find($=>$.id===E);N?.areaIds&&N.areaIds.forEach($=>B.add($))}return Array.from(B)},_=(I,T)=>{if(!I.scopeConfigurations)return null;for(const B of I.scopeConfigurations){if(B.itemType==="Area"){if(T.type==="area"&&(B.ids.includes(T.areaId)||B.ids.includes("ALL_AREAS")))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area leads":"Area"};if(T.type==="checkpoint"){const N=a.locations.find($=>$.id===T.locationId)?.areaIds||[];if(B.ids.includes("ALL_AREAS")||N.some($=>B.ids.includes($)))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(B.itemType==="Checkpoint"){if(T.type==="checkpoint"&&(B.ids.includes(T.locationId)||B.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(T.type==="area"&&T.checkpointIds.some(N=>B.ids.includes(N)||B.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(B.itemType==="Marshal"){if(T.type==="marshal"&&(B.ids.includes(T.marshalId)||B.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(T.type==="checkpoint"){const E=a.assignments.filter($=>$.locationId===T.locationId).map($=>$.marshalId);if(B.ids.includes("ALL_MARSHALS")||E.some($=>B.ids.includes($)))return{matched:!0,scope:"Marshal at checkpoint"}}if(T.type==="area"&&(B.ids.includes("ALL_MARSHALS")||T.marshalIds.some(N=>B.ids.includes(N))))return{matched:!0,scope:"Marshal in area"}}if(T.type==="marshal"&&T.checkpointIds&&T.areaIds){if(B.itemType==="Checkpoint"&&(B.ids.includes("ALL_CHECKPOINTS")||T.checkpointIds.some(N=>B.ids.includes(N))))return{matched:!0,scope:"Assigned checkpoint"};if(B.itemType==="Area"&&(B.ids.includes("ALL_AREAS")||T.areaIds.some(N=>B.ids.includes(N))))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},x=H(()=>{const I=a.allNotes||i.value;if(!I||I.length===0)return[];if(a.areaId&&a.allNotes){const T={type:"area",areaId:a.areaId,checkpointIds:f.value,marshalIds:m.value},B=[],E=new Set;for(const N of I){if(E.has(N.noteId))continue;const $=_(N,T);$&&(E.add(N.noteId),B.push({...N,matchedScope:$.scope}))}return B}if(a.locationId&&a.allNotes){const T={type:"checkpoint",locationId:a.locationId},B=[],E=new Set;for(const N of I){if(E.has(N.noteId))continue;const $=_(N,T);$&&(E.add(N.noteId),B.push({...N,matchedScope:$.scope}))}return B}if(a.marshalId&&a.allNotes){const T=y(a.marshalId),B=k(a.marshalId),E={type:"marshal",marshalId:a.marshalId,checkpointIds:T,areaIds:B},N=[],$=new Set;for(const z of I){if($.has(z.noteId))continue;const O=_(z,E);O&&($.add(z.noteId),N.push({...z,matchedScope:O.scope}))}return N}return I}),D=H(()=>{const I={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...x.value].sort((T,B)=>{if(T.isPinned!==B.isPinned)return T.isPinned?-1:1;const E=I[T.priority]??2,N=I[B.priority]??2;return E!==N?E-N:T.displayOrder!==B.displayOrder?T.displayOrder-B.displayOrder:new Date(B.createdAt)-new Date(T.createdAt)})}),M=({changes:I})=>{o("reorder",I)},S=async()=>{if(a.allNotes===null&&a.eventId){l.value=!0,c.value=null;try{let I;a.marshalId?I=await ba.getMarshalNotes(a.eventId,a.marshalId):I=await ba.getByEvent(a.eventId),i.value=I.data||[]}catch(I){console.error("Failed to load notes:",I),c.value=I.response?.data?.message||"Failed to load notes"}finally{l.value=!1}}};Ye(()=>[a.eventId,a.locationId,a.areaId,a.marshalId],()=>{a.allNotes===null&&S()},{immediate:!0});const w=I=>{if(!I)return"";const T=new Date(I),E=new Date-T,N=Math.floor(E/6e4),$=Math.floor(E/36e5),z=Math.floor(E/864e5);return N<1?"just now":N<60?`${N}m ago`:$<24?`${$}h ago`:z<7?`${z}d ago`:T.toLocaleDateString()};return t({loadNotes:S}),(I,T)=>(p(),g("div",rD,[l.value?(p(),g("div",cD," Loading notes... ")):c.value?(p(),g("div",uD,[r("p",null,b(c.value),1),r("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):x.value.length===0?(p(),g("div",dD,[r("p",null,b(d.value),1)])):(p(),g(Ie,{key:3},[e.allowReorder?(p(),qe(ll,{key:0,items:D.value,"item-key":"noteId","pinned-key":"isPinned",onReorder:M,class:"notes-list"},{item:Ve(({element:B})=>[r("div",{class:le(["note-item",{pinned:B.isPinned}])},[Pe(rl),r("div",hD,[r("div",fD,[r("div",pD,[B.isPinned?(p(),g("span",vD,"")):P("",!0),r("span",{class:le(["priority-indicator",(B.priority||"Normal").toLowerCase()])},null,2),r("strong",mD,b(B.title),1)]),r("div",gD,[B.category?(p(),g("span",yD,b(B.category),1)):P("",!0),r("span",{class:le(["priority-badge",(B.priority||"Normal").toLowerCase()])},b(B.priority||"Normal"),3)])]),B.content?(p(),g("div",kD,b(B.content),1)):P("",!0),r("div",bD,[r("span",wD," Created by "+b(B.createdByName||"Unknown")+"  "+b(w(B.createdAt)),1),B.scopeConfigurations?.length&&e.showScope?(p(),qe(ol,{key:0,class:"scope-pills","scope-configurations":B.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):B.matchedScope&&e.showScope?(p(),g("span",_D,b(B.matchedScope),1)):P("",!0)])])],2)]),_:1},8,["items"])):(p(),g("div",CD,[(p(!0),g(Ie,null,je(D.value,B=>(p(),g("div",{key:B.noteId,class:le(["note-item",{pinned:B.isPinned}])},[r("div",LD,[r("div",SD,[r("div",ID,[B.isPinned?(p(),g("span",xD,"")):P("",!0),r("span",{class:le(["priority-indicator",(B.priority||"Normal").toLowerCase()])},null,2),r("strong",$D,b(B.title),1)]),r("div",TD,[B.category?(p(),g("span",MD,b(B.category),1)):P("",!0),r("span",{class:le(["priority-badge",(B.priority||"Normal").toLowerCase()])},b(B.priority||"Normal"),3)])]),B.content?(p(),g("div",AD,b(B.content),1)):P("",!0),r("div",ED,[r("span",PD," Created by "+b(B.createdByName||"Unknown")+"  "+b(w(B.createdAt)),1),B.scopeConfigurations?.length&&e.showScope?(p(),qe(ol,{key:0,class:"scope-pills","scope-configurations":B.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):B.matchedScope&&e.showScope?(p(),g("span",DD,b(B.matchedScope),1)):P("",!0)])])],2))),128))]))],64))]))}},ld=Ke(RD,[["__scopeId","data-v-cd3c899d"]]),OD={class:"checklist-preview"},BD={class:"preview-actions"},ND={class:"preview-header"},FD={key:0,class:"add-item-form"},UD=["placeholder"],zD=["disabled"],HD={key:1,class:"pending-items"},VD={class:"item-content"},GD={class:"item-header"},qD={class:"item-text"},jD={class:"item-scope"},WD=["onClick"],ZD={key:2,class:"empty-state"},KD={key:0,class:"help-text"},YD={key:3,class:"checklist-items"},JD={class:"item-content"},XD={class:"item-header"},QD={class:"item-text"},eR={class:"item-scope"},tR=["title"],nR={key:0,class:"item-context"},oR={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=H(()=>o.checkpointTermSingular?o.checkpointTermSingular.toLowerCase():a.value.checkpoint),l=t,c=A(!1),d=A(""),h=A([...o.modelValue]);Ye(()=>o.modelValue,w=>{h.value=[...w]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",c.value=!1,y())},m=w=>{h.value.splice(w,1),y()},y=()=>{l("update:modelValue",[...h.value]),l("change")},k=w=>{const I=w.scope,T=w.itemType,B=w.ids||[];return(I==="EveryoneAtCheckpoints"||I==="OnePerCheckpoint")&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS"):I==="OnePerCheckpoint"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(E=>o.pendingAreaIds.includes(E)):(I==="EveryoneInAreas"||I==="OnePerArea"||I==="EveryAreaLead"||I==="OneLeadPerArea")&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(E=>o.pendingAreaIds.includes(E)):!1},_=H(()=>o.allChecklistItems.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0?w.scopeConfigurations.some(I=>k(I)):!1)),x=w=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[w]||w,D=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"Unknown";const I=w.scopeConfigurations.find(B=>k(B));if(!I)return x(w.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${a.value.areas}`:x(I.scope)},M=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"";const I=w.scopeConfigurations.find(B=>k(B));return I&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[I.scope]||""},S=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return null;const I=w.scopeConfigurations.find(E=>k(E));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Area"){const E=o.areas.filter(N=>B.includes(N.id)&&o.pendingAreaIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(w,I)=>(p(),g("div",OD,[r("div",BD,[r("p",ND,b(e.isEditing?`Add new ${F(a).checklist} for this ${i.value}:`:`${F(n).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>c.value=!c.value)},b(c.value?"Cancel":`Add ${F(a).checklist}`),1)]),c.value?(p(),g("div",FD,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>d.value=T),type:"text",placeholder:`Enter ${F(a).checklist} text...`,class:"add-item-input",onKeyup:Qo(f,["enter"])},null,40,UD),[[at,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,zD)])):P("",!0),h.value.length>0?(p(),g("div",HD,[(p(!0),g(Ie,null,je(h.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"checklist-item pending"},[I[3]||(I[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",VD,[r("div",GD,[r("div",qD,b(T.text),1),r("div",jD,[I[2]||(I[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>m(B),title:"Remove"},"  ",8,WD)])])])]))),128))])):P("",!0),!e.isEditing&&_.value.length===0&&h.value.length===0?(p(),g("div",ZD,[r("p",null,"No "+b(F(a).checklists)+" will apply based on the current "+b(F(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",KD," Assign "+b(F(a).areas)+" to see relevant "+b(F(a).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&_.value.length>0?(p(),g("div",YD,[(p(!0),g(Ie,null,je(_.value,T=>(p(),g("div",{key:T.id,class:"checklist-item"},[I[4]||(I[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",JD,[r("div",XD,[r("div",QD,b(T.text),1),r("div",eR,[r("span",{class:"scope-pill",title:M(T)},b(D(T)),9,tR)])]),S(T)?(p(),g("div",nR,b(S(T)),1)):P("",!0)])]))),128))])):P("",!0)]))}},aR=Ke(oR,[["__scopeId","data-v-7d943b21"]]),sR={class:"notes-preview"},iR={class:"preview-actions"},lR={class:"preview-header"},rR={key:0,class:"add-item-form"},cR={class:"add-form-fields"},uR=["disabled"],dR={key:1,class:"pending-items"},hR={class:"note-header"},fR={class:"note-title"},pR={class:"note-actions"},vR=["onClick"],mR={key:0,class:"note-content"},gR={key:2,class:"empty-state"},yR={key:0,class:"help-text"},kR={key:3,class:"notes-list"},bR={class:"note-header"},wR={class:"note-title"},_R=["title"],CR={key:0,class:"note-content"},LR={key:1,class:"note-context"},SR={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=H(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():n.value.checkpoint),l=A(!1),c=A(""),d=A(""),h=A([...a.modelValue]);Ye(()=>a.modelValue,w=>{h.value=[...w]},{deep:!0});const f=()=>{!c.value.trim()&&!d.value.trim()||(h.value.push({title:c.value.trim(),content:d.value.trim(),isNew:!0}),c.value="",d.value="",l.value=!1,y())},m=w=>{h.value.splice(w,1),y()},y=()=>{o("update:modelValue",[...h.value]),o("change")},k=w=>{const I=w.scope,T=w.itemType,B=w.ids||[];return I==="EveryoneAtCheckpoints"&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS"):I==="EveryoneInAreas"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(E=>a.pendingAreaIds.includes(E)):!1},_=H(()=>a.allNotes.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0?w.scopeConfigurations.some(I=>k(I)):!1)),x=w=>({EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[w]||w,D=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"Unknown";const I=w.scopeConfigurations.find(B=>k(B));if(!I)return x(w.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},M=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"";const I=w.scopeConfigurations.find(B=>k(B));return I&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},S=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return null;const I=w.scopeConfigurations.find(E=>k(E));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Area"){const E=a.areas.filter(N=>B.includes(N.id)&&a.pendingAreaIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(w,I)=>(p(),g("div",sR,[r("div",iR,[r("p",lR,b(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>l.value=!l.value)},b(l.value?"Cancel":"Add note"),1)]),l.value?(p(),g("div",rR,[r("div",cR,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>c.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,c.value]]),We(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=T=>d.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,uR)])):P("",!0),h.value.length>0?(p(),g("div",dR,[(p(!0),g(Ie,null,je(h.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"note-item pending"},[r("div",hR,[r("span",fR,b(T.title||"Untitled"),1),r("div",pR,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>m(B),title:"Remove"},"  ",8,vR)])]),T.content?(p(),g("div",mR,b(T.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&_.value.length===0&&h.value.length===0?(p(),g("div",gR,[r("p",null,"No notes will apply based on the current "+b(F(n).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",yR," Assign "+b(F(n).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&_.value.length>0?(p(),g("div",kR,[(p(!0),g(Ie,null,je(_.value,T=>(p(),g("div",{key:T.id,class:"note-item"},[r("div",bR,[r("span",wR,b(T.title||"Untitled"),1),r("span",{class:"scope-pill",title:M(T)},b(D(T)),9,_R)]),T.content?(p(),g("div",CR,b(T.content),1)):P("",!0),S(T)?(p(),g("div",LR,b(S(T)),1)):P("",!0)]))),128))])):P("",!0)]))}},IR=Ke(SR,[["__scopeId","data-v-71646c3f"]]),xR={class:"base-modal-title modal-title-with-icon"},$R=["innerHTML"],TR={key:7,class:"tab-content appearance-tab"},MR={class:"accordion-item"},AR=["innerHTML"],ER={class:"accordion-title"},PR={class:"accordion-arrow"},DR={key:0,class:"accordion-content"},RR={class:"section-description"},OR={class:"accordion-item"},BR={class:"accordion-preview"},NR={class:"accordion-arrow"},FR={key:0,class:"accordion-content"},UR={class:"section-description"},zR={class:"terminology-row"},HR={class:"terminology-field"},VR=["value"],GR={value:""},qR=["value"],jR={class:"terminology-field"},WR=["value"],ZR={value:""},KR=["value"],YR={key:8,class:"tab-content incidents-tab"},JR={class:"incidents-list"},XR={class:"custom-footer"},QR={class:"footer-left"},pm="edit_location_accordion",eO={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal","reorder-notes","reorder-checklists"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=A("details"),l=A(!1),c=A(null),d=A(null),h=A([]),f=A([]),m=A([]),y=A({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=A(!1),_=A(null),x=fe=>{_.value=fe,k.value=!0},D=()=>{k.value=!1,_.value=null},M=H(()=>_.value&&_.value.marshalName||""),S=H(()=>y.value.name||a.location?.name||""),w=H(()=>{if(!_.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=_.value;return!fe||!ke?null:{lat:fe,lng:ke}}),I=H(()=>{const fe=y.value.latitude,ke=y.value.longitude;return!fe||!ke?null:{lat:fe,lng:ke}}),T=H(()=>{if(!_.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=_.value,te=y.value.latitude,ye=y.value.longitude;return!fe||!ke||!te||!ye?null:sl(fe,ke,te,ye)}),B=()=>a.eventId?`${pm}_${a.eventId}`:pm,E=A({iconStyle:!1,terminology:!1});un(()=>{const fe=localStorage.getItem(B());if(fe)try{const ke=JSON.parse(fe);E.value={...E.value,...ke}}catch{}});const N=fe=>{E.value[fe]=!E.value[fe],localStorage.setItem(B(),JSON.stringify(E.value))},$=H(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const ke=a.areas.filter(te=>fe.includes(te.id)&&te.peopleTerm).sort((te,ye)=>(te.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),z=H(()=>y.value.peopleTerm?y.value.peopleTerm:$.value),O=H(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const ke=a.areas.filter(te=>fe.includes(te.id)&&te.checkpointTerm).sort((te,ye)=>(te.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].checkpointTerm}return n.value.checkpoint});H(()=>O.value.toLowerCase());const j=H(()=>{const fe=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(fe)return Wi("checkpoint",fe,z.value);const ke=y.value.areaIds||[];let te=null;if(ke.length>0){const ye=a.areas.filter(He=>ke.includes(He.id)&&He.checkpointTerm).sort((He,rt)=>(He.checkpointCount||0)-(rt.checkpointCount||0));ye.length>0&&(te=ye[0].checkpointTerm)}return te?Wi("checkpoint",te,z.value):n.value.checkpoint}),Z=H(()=>j.value.toLowerCase()),J=H(()=>{const fe=z.value;return Wi("people",fe)});H(()=>J.value.toLowerCase());const re=H(()=>n.value.area);H(()=>re.value.toLowerCase());const K=H(()=>n.value.area),ie=H(()=>K.value.toLowerCase()),U=H(()=>n.value.areas),X=H(()=>!!(a.location&&a.location.id)),ae=H(()=>X.value?`Edit ${Z.value}: ${a.location?.name||""}`:`Add ${Z.value}`),he=H(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:z.value,icon:"marshal"},{value:"checklists",label:n.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),$e=H(()=>he.value.findIndex(fe=>fe.value===i.value)),Ee=H(()=>$e.value===he.value.length-1),Me=H(()=>{const fe=y.value.areaIds||[],ke=a.areas.filter(ft=>fe.includes(ft.id)).sort((ft,Ct)=>(ft.checkpointCount||0)-(Ct.checkpointCount||0)),te=(ft,Ct)=>{for(const Mt of ke){const Mn=ft(Mt);if(Mn&&Mn!=="default")return{value:Mn,source:"area"}}return Ct&&Ct!=="default"?{value:Ct,source:"event"}:{value:"",source:"none"}},ye=te(ft=>ft.checkpointStyleType||ft.CheckpointStyleType,a.eventDefaultStyleType),He=te(ft=>ft.checkpointStyleColor||ft.CheckpointStyleColor,a.eventDefaultStyleColor),rt=te(ft=>ft.checkpointStyleBackgroundShape||ft.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),kt=te(ft=>ft.checkpointStyleBackgroundColor||ft.CheckpointStyleBackgroundColor||ft.checkpointStyleColor||ft.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),Rt=te(ft=>ft.checkpointStyleBorderColor||ft.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),Lt=te(ft=>ft.checkpointStyleIconColor||ft.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),xt=te(ft=>ft.checkpointStyleSize||ft.CheckpointStyleSize,a.eventDefaultStyleSize),Kt=te(ft=>ft.checkpointStyleMapRotation??ft.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Mo=[ye,rt,kt,Rt,Lt,xt,Kt].some(ft=>ft.source==="area");return{type:ye.value||"default",color:He.value,backgroundShape:rt.value,backgroundColor:kt.value,borderColor:Rt.value,iconColor:Lt.value,size:xt.value,mapRotation:Kt.value,source:Mo?"area":ye.value?"event":"none"}}),ze=H(()=>Me.value.source==="area"?`${K.value} default`:"Event default"),be=H(()=>{const fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Me.value.type,ke=y.value.styleBackgroundShape||Me.value.backgroundShape||"circle",te=y.value.styleBackgroundColor||Me.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||Me.value.borderColor||"#ffffff",He=y.value.styleIconColor||Me.value.iconColor||"#ffffff";return zn({type:fe||"circle",backgroundShape:ke,backgroundColor:te,borderColor:ye,iconColor:He,size:"100"})}),V=H(()=>{let fe,ke,te,ye,He;return X.value&&a.location?(fe=a.location.resolvedStyleType||a.location.ResolvedStyleType,ke=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",te=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",ye=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",He=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Me.value.type,ke=y.value.styleBackgroundShape||Me.value.backgroundShape||"circle",te=y.value.styleBackgroundColor||Me.value.backgroundColor||"#667eea",ye=y.value.styleBorderColor||Me.value.borderColor||"#ffffff",He=y.value.styleIconColor||Me.value.iconColor||"#ffffff"),zn({type:fe||"circle",backgroundShape:ke,backgroundColor:te,borderColor:ye,iconColor:He,size:"100",outputSize:28})}),Y=H(()=>{const fe=!!y.value.checkpointTerm,ke=!!y.value.peopleTerm;return fe&&ke?`${Wi("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:fe?Wi("checkpoint",y.value.checkpointTerm,z.value):ke?y.value.peopleTerm:"Using defaults"}),de=H(()=>Ee.value?null:he.value[$e.value+1]),se=H(()=>de.value?`${de.value.label}...`:""),Re=A(!1),q=A(null);Ye(()=>a.location,fe=>{if(fe){const ke=fe.id||"new";if(q.value!==ke){q.value=ke,Re.value=!0;let te="",ye="";fe.startTime&&(te=rc(fe.startTime)),fe.endTime&&(ye=rc(fe.endTime)),y.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:te,endTime:ye,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ye(()=>a.show,fe=>{fe?(i.value="details",l.value=!1,h.value=[],f.value=[],m.value=[],c.value?.clearPendingChanges&&c.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(q.value=null,Re.value=!1)});const Q=fe=>{y.value=fe},ee=()=>{o("update:isDirty",!0)},_e=()=>{l.value=!l.value,o("move-location",{isMoving:l.value,formData:{...y.value}})},Be=fe=>{h.value=fe,ee()},Ue=()=>{de.value&&(i.value=de.value.value)},Ae=()=>{const fe={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:c.value?.getPendingChanges?.()||[],assignmentsToRemove:c.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:a.assignments.filter(ke=>ke.isPending).map(ke=>({marshalId:ke.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};o("save",fe)},ne=()=>{a.location&&a.location.id&&o("delete",a.location.id)},ge=fe=>{o("remove-assignment",fe)},Oe=()=>{o("open-assign-modal")},De=fe=>{o("select-marshal",fe)},xe=()=>{o("close")},me=(fe,ke)=>{y.value[fe]=ke,ee()},Ze=fe=>{o("reorder-notes",fe)},Ge=fe=>{o("reorder-checklists",fe)};return(fe,ke)=>(p(),qe(Zt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:xe},{header:Ve(()=>[r("h2",xR,[V.value?(p(),g("span",{key:0,class:"modal-title-icon",innerHTML:V.value},null,8,$R)):P("",!0),Je(" "+b(ae.value),1)])]),"tab-header":Ve(()=>[Pe(dl,{modelValue:i.value,"onUpdate:modelValue":ke[0]||(ke[0]=te=>i.value=te),tabs:he.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",XR,[r("div",QR,[X.value&&!e.lockedFromMarshal?(p(),g("button",{key:0,type:"button",onClick:ne,class:"btn btn-danger"}," Delete ")):P("",!0),!X.value&&!Ee.value?(p(),g("button",{key:1,type:"button",onClick:Ue,class:"btn btn-secondary mobile-only"},b(se.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ae,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[i.value==="details"?(p(),qe(X6,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":K.value,"area-term-plural":U.value,"checkpoint-term-singular":j.value,"people-term-plural":z.value,"onUpdate:form":Q,onInput:ee,onSave:Ae},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),i.value==="location"?(p(),qe(a8,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":z.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":X.value,"onUpdate:form":Q,onInput:ee,onSave:Ae,onMoveLocation:_e},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),i.value==="marshals"?(p(),qe(T8,{key:2,ref_key:"assignmentsTabRef",ref:c,form:y.value,assignments:e.assignments,"people-term":z.value,"person-term":J.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":Q,onInput:ee,onRemoveAssignment:ge,onOpenAssignModal:Oe,onSelectMarshal:De,onDistanceClick:x},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),i.value==="checklists"&&X.value?(p(),qe(w1,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":ke[1]||(ke[1]=te=>h.value=te),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onChange:Be,onReorder:Ge},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):P("",!0),i.value==="checklists"?(p(),qe(aR,{key:4,modelValue:f.value,"onUpdate:modelValue":ke[2]||(ke[2]=te=>f.value=te),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":X.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="notes"&&X.value?(p(),qe(ld,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Ze},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),i.value==="notes"?(p(),qe(IR,{key:6,modelValue:m.value,"onUpdate:modelValue":ke[3]||(ke[3]=te=>m.value=te),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":X.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="appearance"?(p(),g("div",TR,[r("div",MR,[r("button",{type:"button",class:le(["accordion-header",{expanded:E.value.iconStyle}]),onClick:ke[4]||(ke[4]=te=>N("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:be.value},null,8,AR),r("span",ER,b(j.value)+" marker style",1),r("span",PR,b(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(p(),g("div",DR,[r("p",RR," Choose a custom icon for this "+b(Z.value)+", or leave as Default to inherit from "+b(ie.value)+" or event settings. ",1),Pe(Bf,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":Me.value.type,"inherited-style-color":Me.value.color,"inherited-background-shape":Me.value.backgroundShape||"","inherited-background-color":Me.value.backgroundColor||Me.value.color||"","inherited-border-color":Me.value.borderColor||"","inherited-icon-color":Me.value.iconColor||"","inherited-size":Me.value.size||"","inherited-map-rotation":Me.value.mapRotation??"","default-label":ze.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ke[5]||(ke[5]=te=>me("styleType",te)),"onUpdate:styleColor":ke[6]||(ke[6]=te=>me("styleColor",te)),"onUpdate:styleBackgroundShape":ke[7]||(ke[7]=te=>me("styleBackgroundShape",te)),"onUpdate:styleBackgroundColor":ke[8]||(ke[8]=te=>me("styleBackgroundColor",te)),"onUpdate:styleBorderColor":ke[9]||(ke[9]=te=>me("styleBorderColor",te)),"onUpdate:styleIconColor":ke[10]||(ke[10]=te=>me("styleIconColor",te)),"onUpdate:styleSize":ke[11]||(ke[11]=te=>me("styleSize",te)),"onUpdate:styleMapRotation":ke[12]||(ke[12]=te=>me("styleMapRotation",te))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),r("div",OR,[r("button",{type:"button",class:le(["accordion-header",{expanded:E.value.terminology}]),onClick:ke[13]||(ke[13]=te=>N("terminology"))},[ke[17]||(ke[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ke[18]||(ke[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",BR,b(Y.value),1),r("span",NR,b(E.value.terminology?"":""),1)],2),E.value.terminology?(p(),g("div",FR,[r("p",UR," Customise what this "+b(Z.value)+" and its "+b(z.value.toLowerCase())+" are called. ",1),r("div",zR,[r("div",HR,[r("label",null,"What is this "+b(Z.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:ke[14]||(ke[14]=te=>{Q({...y.value,checkpointTerm:te.target.value}),ee()})},[r("option",GR,"Use "+b(ie.value)+" default ("+b(j.value)+")",1),ke[19]||(ke[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),ke[20]||(ke[20]=r("option",{value:"Car"},"Car",-1)),ke[21]||(ke[21]=r("option",{value:"Bike"},"Bike",-1)),(p(!0),g(Ie,null,je(F(gs).checkpoint,te=>(p(),g("option",{key:te,value:te},b(te),9,qR))),128))],40,VR)]),r("div",jR,[r("label",null,"What are "+b(z.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:ke[15]||(ke[15]=te=>{Q({...y.value,peopleTerm:te.target.value}),ee()})},[r("option",ZR,"Use "+b(ie.value)+" default ("+b($.value)+")",1),(p(!0),g(Ie,null,je(F(gs).people,te=>(p(),g("option",{key:te,value:te},b(te),9,KR))),128))],40,WR)])])])):P("",!0)])])):P("",!0),i.value==="incidents"?(p(),g("div",YR,[r("div",JR,[(p(!0),g(Ie,null,je(e.incidents,te=>(p(),qe(kc,{key:te.incidentId,incident:te,onSelect:ke[16]||(ke[16]=ye=>fe.$emit("select-incident",ye))},null,8,["incident"]))),128))])])):P("",!0),Pe(Pf,{show:k.value,"marshal-name":M.value,"checkpoint-name":S.value,"check-in-location":w.value,"checkpoint-location":I.value,distance:T.value,"z-index":e.zIndex+100,onClose:D},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},tO=Ke(eO,[["__scopeId","data-v-221a28c2"]]),nO={class:"tab-content"},oO={key:0,class:"error-banner"},aO=["value"],sO={key:0,class:"field-error"},iO={class:"contact-row"},lO=["value"],rO={key:0,class:"field-error"},cO=["value"],uO={key:0,class:"field-error"},dO=["value"],hO={key:0,class:"field-error"},fO={key:1,class:"magic-link-section"},pO={key:0,class:"loading-text"},vO={key:1,class:"magic-link-container"},mO={class:"magic-link-row"},gO=["value"],yO={key:0,class:"error-text"},kO={key:1,class:"magic-link-actions"},bO=["disabled"],wO={key:2,class:"success-text"},_O={key:3,class:"error-text"},CO={key:2,class:"error-text"},LO={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=A(null),l=A(null),c=A(null),d=A(null),h=A(""),f=A(!1),m=A(!1),y=A(""),k=A(!1),_=A(!1),x=A(!1),D=A(""),M=A(!1),S=(N,$)=>{o("update:form",{...a.form,[N]:$}),o("input")},w=async()=>{if(!(!a.eventId||!a.marshalId)){m.value=!0,y.value="";try{const N=await _a.getMagicLink(a.eventId,a.marshalId);h.value=N.data.magicLink,f.value=N.data.hasEmail}catch(N){console.error("Failed to fetch magic link:",N),y.value="Failed to load login link"}finally{m.value=!1}}},I=A(""),T=async()=>{I.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(N){console.warn("Clipboard API failed, trying fallback:",N)}try{const N=document.createElement("textarea");N.value=h.value,N.style.position="fixed",N.style.left="-9999px",N.style.top="0",document.body.appendChild(N),N.focus(),N.select();const $=document.execCommand("copy");document.body.removeChild(N),$?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(I.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3))}catch(N){console.error("Fallback copy failed:",N),I.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3)}},B=async()=>{if(!(!a.eventId||!a.marshalId)){_.value=!0,x.value=!1,D.value="";try{await _a.sendMagicLink(a.eventId,a.marshalId),x.value=!0,setTimeout(()=>{x.value=!1},3e3)}catch(N){console.error("Failed to send email:",N),D.value=N.response?.data?.message||"Failed to send email"}finally{_.value=!1}}};return Ye(()=>a.marshalId,N=>{N?w():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:N=>{cn(()=>{const z={name:i,email:l,phoneNumber:c,notes:d}[N];z?.value&&(z.value.focus(),z.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(N,$)=>(p(),g("div",nO,[e.validationErrors.general?(p(),g("div",oO,b(e.validationErrors.general),1)):P("",!0),r("div",{class:le(["form-group",{"has-error":e.validationErrors.name}])},[$[7]||($[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:$[0]||($[0]=z=>S("name",z.target.value)),type:"text",required:"",class:le(["form-input",{"input-error":e.validationErrors.name}])},null,42,aO),e.validationErrors.name?(p(),g("span",sO,b(e.validationErrors.name),1)):P("",!0)],2),r("div",iO,[r("div",{class:le(["form-group contact-email",{"has-error":e.validationErrors.email}])},[$[8]||($[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:$[1]||($[1]=z=>S("email",z.target.value)),type:"email",class:le(["form-input",{"input-error":e.validationErrors.email}])},null,42,lO),e.validationErrors.email?(p(),g("span",rO,b(e.validationErrors.email),1)):P("",!0)],2),r("div",{class:le(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[$[9]||($[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:c,value:e.form.phoneNumber,onInput:$[2]||($[2]=z=>S("phoneNumber",z.target.value)),type:"tel",class:le(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,cO),e.validationErrors.phoneNumber?(p(),g("span",uO,b(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),r("div",{class:le(["form-group",{"has-error":e.validationErrors.notes}])},[$[10]||($[10]=r("label",null,"Additional details",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:$[3]||($[3]=z=>S("notes",z.target.value)),class:le(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,dO),e.validationErrors.notes?(p(),g("span",hO,b(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(p(),g("div",fO,[$[12]||($[12]=r("label",null,"Login link",-1)),$[13]||($[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(p(),g("div",pO,"Loading link...")):h.value?(p(),g("div",vO,[r("div",mO,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:$[4]||($[4]=z=>z.target.select())},null,40,gO),r("button",{type:"button",class:"btn btn-secondary",onClick:T},b(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:$[5]||($[5]=z=>M.value=!0),title:"Show QR code"},[...$[11]||($[11]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6c3801fd><rect x="3" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="3" y="14" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="14" width="3" height="3" data-v-6c3801fd></rect><rect x="19" y="14" width="2" height="2" data-v-6c3801fd></rect><rect x="14" y="19" width="2" height="2" data-v-6c3801fd></rect><rect x="19" y="19" width="2" height="2" data-v-6c3801fd></rect></svg>',1)])])]),I.value?(p(),g("p",yO,b(I.value),1)):P("",!0),f.value?(p(),g("div",kO,[r("button",{type:"button",class:"btn btn-primary",disabled:_.value,onClick:B},b(_.value?"Sending...":"Send via email"),9,bO)])):P("",!0),x.value?(p(),g("p",wO,"Email sent successfully!")):P("",!0),D.value?(p(),g("p",_O,b(D.value),1)):P("",!0)])):y.value?(p(),g("div",CO,b(y.value),1)):P("",!0)])):P("",!0),Pe(Ff,{show:M.value,url:h.value,title:"Scan to log in",onClose:$[6]||($[6]=z=>M.value=!1)},null,8,["show","url"])]))}},SO=Ke(LO,[["__scopeId","data-v-6c3801fd"]]),IO={class:"card-header"},xO={class:"checkpoint-name-row"},$O=["innerHTML"],TO={class:"checkpoint-name"},MO={key:0,class:"checkpoint-description"},AO={key:0,class:"card-areas"},EO={key:1,class:"card-check-in"},PO={key:0,class:"check-in-time"},DO={key:0,class:"check-in-method"},RO={key:1,class:"unsaved-indicator"},OO={key:2,class:"card-locked"},BO={class:"locked-badge"},NO={key:3,class:"card-badge"},FO={key:4,class:"card-badge"},UO={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=H(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),l=H(()=>i.value.map(M=>{const S=a.areas.find(w=>w.id===M);return S?S.name:null}).filter(Boolean)),c=H(()=>i.value.map(M=>{const S=a.areas.find(w=>w.id===M);return S?S.color:"#999"})),d=H(()=>{if(!a.location)return"#667eea";const M=a.location,S=M.resolvedStyleBackgroundColor||M.ResolvedStyleBackgroundColor||M.resolvedStyleColor||M.ResolvedStyleColor;if(S)return S;if(i.value.length>0){const w=a.areas.find(I=>I.id===i.value[0]);if(w)return w.color}return"#667eea"}),h=H(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const M=a.location,S=M.resolvedStyleType||M.ResolvedStyleType,w=M.resolvedStyleBackgroundColor||M.ResolvedStyleBackgroundColor||M.resolvedStyleColor||M.ResolvedStyleColor,I=M.resolvedStyleBorderColor||M.ResolvedStyleBorderColor,T=M.resolvedStyleIconColor||M.ResolvedStyleIconColor,B=M.resolvedStyleBackgroundShape||M.ResolvedStyleBackgroundShape;return S&&S!=="default"||w||I||T||B&&B!=="circle"?zn({type:S||"circle",backgroundShape:B||"circle",backgroundColor:w||"#667eea",borderColor:I||"#ffffff",iconColor:T||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=M=>M?new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=H(()=>{const{checkedInBy:M,checkInMethod:S,marshalName:w}=a.assignment;return M&&M!==w?M:S||""}),y=H(()=>{const{checkInLatitude:M,checkInLongitude:S}=a.assignment,w=a.location;return!M||!S||!w?.latitude||!w?.longitude?null:sl(M,S,w.latitude,w.longitude)}),k=H(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),_=H(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),x=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&o("click",a.assignment)},D=()=>{o("distance-click",a.assignment)};return(M,S)=>(p(),g("div",{class:le(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:tt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",IO,[r("div",{class:"card-title",onClick:x},[r("span",xO,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,$O),r("span",TO,b(e.assignment.locationName),1),e.assignment.locationDescription?(p(),g("span",MO,"  "+b(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:S[0]||(S[0]=ct(w=>M.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:S[1]||(S[1]=ct(w=>M.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(p(),g("div",AO,[(p(!0),g(Ie,null,je(l.value,(w,I)=>(p(),g("span",{key:I,class:"area-badge",style:tt({backgroundColor:c.value[I]})},b(w),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(p(),g("div",EO,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:S[2]||(S[2]=w=>M.$emit("toggle-check-in",e.assignment))},[...S[3]||(S[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",PO,[Je(b(f(e.assignment.checkInTime))+" ",1),m.value?(p(),g("span",DO,"("+b(m.value)+")",1)):P("",!0),k.value?(p(),g("span",{key:1,class:le(["check-in-distance",_.value]),onClick:ct(D,["stop"])},b(k.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),g("span",RO," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(p(),g("div",OO,[r("span",BO,"Viewing from this "+b(F(n).checkpoint),1)])):P("",!0),e.assignment.isPending?(p(),g("div",NO,[...S[4]||(S[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",FO,[...S[5]||(S[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},zO=Ke(UO,[["__scopeId","data-v-d3de6925"]]),HO={class:"tab-content"},VO={key:0,class:"read-only-notice"},GO={class:"section-title"},qO={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},jO={value:""},WO=["value"],ZO={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,{pendingCheckInChanges:l,getEffectiveCheckInStatus:c,handleToggleCheckIn:d}=b1(()=>i("input")),h=A(""),f=A(new Set),m=H(()=>o.assignments?.length||0),y=z=>o.allLocations&&o.allLocations.find(O=>O.id===z)||null,k=H(()=>[...o.assignments].sort((z,O)=>(z.locationName||"").localeCompare(O.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),_=z=>f.value.has(z),x=z=>{z.isPending||i("select-checkpoint",z)},D=A(!1),M=A(null),S=z=>{c(z)?(M.value=z,D.value=!0):d(z)},w=()=>{M.value&&d(M.value),D.value=!1,M.value=null},I=()=>{D.value=!1,M.value=null},T=H(()=>M.value?`Are you sure you want to undo ${M.value.marshalName||"this marshal"}'s check-in?`:""),B=z=>{z.isPending?i("remove-assignment",z):(f.value.add(z.id),i("input"))},E=z=>{f.value.delete(z.id),i("input")},N=H(()=>{const z=[...o.availableLocations];return z.sort((O,j)=>O.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),z}),$=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([z,O])=>({assignmentId:z,shouldBeCheckedIn:O})),getMarkedForRemoval:()=>Array.from(f.value)}),(z,O)=>(p(),g("div",HO,[e.lockedCheckpointId?(p(),g("div",VO," Viewing from "+b(F(a).checkpoint)+" - "+b(F(a).checkpoints)+" cannot be modified here. ",1)):P("",!0),r("h3",GO,"Assigned "+b(F(a).checkpoints)+" ("+b(m.value)+")",1),Pe(bc,{"is-empty":e.assignments.length===0,"empty-message":`No ${F(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${F(a).person} to ${F(a).checkpoints}.`},{default:Ve(()=>[(p(!0),g(Ie,null,je(k.value,j=>(p(),qe(zO,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":F(c)(j),"has-unsaved-changes":F(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":_(j.id),onClick:x,onToggleCheckIn:S,onRemove:B,onUndoRemove:E,onDistanceClick:O[0]||(O[0]=Z=>z.$emit("distance-click",Z))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&N.value.length>0?(p(),g("div",qO,[r("label",null,"Assign to "+b(F(a).checkpoint),1),We(r("select",{"onUpdate:modelValue":O[1]||(O[1]=j=>h.value=j),class:"form-input",onChange:$},[r("option",jO,"Select a "+b(F(a).checkpoint)+"...",1),(p(!0),g(Ie,null,je(N.value,j=>(p(),g("option",{key:j.id,value:j.id},[Je(b(j.name),1),j.description?(p(),g(Ie,{key:0},[Je(" - "+b(j.description),1)],64)):P("",!0)],8,WO))),128))],544),[[Qn,h.value]])])):P("",!0),Pe(hi,{show:D.value,title:"Confirm check-out",message:T.value,"confirm-text":"Check out","is-danger":!0,onConfirm:w,onCancel:I},null,8,["show","message"])]))}},KO=Ke(ZO,[["__scopeId","data-v-07754949"]]),YO={class:"tab-content roles-tab"},JO={key:0,class:"empty-state"},XO={class:"help-text"},QO={key:1,class:"roles-list"},eB={class:"roles-label"},tB={class:"available-roles"},nB=["onClick"],oB={class:"role-checkbox"},aB=["checked","onChange"],sB={class:"role-info"},iB={class:"role-name"},lB={__name:"MarshalRolesTab",props:{roles:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["update:roles","input"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=H(()=>a.roles||[]),l=A(new Set);Ye(()=>a.roles,f=>{l.value.size===0&&f&&f.length>0&&(l.value=new Set(f))},{immediate:!0});const c=H(()=>[...a.roleDefinitions].sort((f,m)=>{const y=l.value.has(f.roleId),k=l.value.has(m.roleId);return y!==k?y?-1:1:f.displayOrder!==m.displayOrder?(f.displayOrder||0)-(m.displayOrder||0):(f.name||"").localeCompare(m.name||"",void 0,{numeric:!0,sensitivity:"base"})})),d=H(()=>c.value),h=f=>{const m=i.value.includes(f);let y;m?y=i.value.filter(k=>k!==f):y=[...i.value,f],o("update:roles",y),o("input")};return(f,m)=>(p(),g("div",YO,[e.roleDefinitions.length===0?(p(),g("div",JO,[m[1]||(m[1]=r("p",null,"No roles have been defined for this event yet.",-1)),r("p",XO,"Create roles in the Roles tab to assign them to "+b(F(n).people)+".",1)])):(p(),g("div",QO,[r("label",eB,"Select roles for this "+b(F(n).person),1),r("div",tB,[(p(!0),g(Ie,null,je(d.value,y=>(p(),g("div",{key:y.roleId,class:le(["role-option",{selected:i.value.includes(y.roleId)}]),onClick:k=>h(y.roleId)},[r("div",oB,[r("input",{type:"checkbox",checked:i.value.includes(y.roleId),onClick:m[0]||(m[0]=ct(()=>{},["stop"])),onChange:k=>h(y.roleId)},null,40,aB)]),r("div",sB,[r("span",iB,b(y.name),1)])],10,nB))),128))])]))]))}},rB=Ke(lB,[["__scopeId","data-v-f56e155c"]]),cB={class:"marshal-checklist-view"},uB={key:0,class:"loading-state"},dB={key:1,class:"error-state"},hB={key:2,class:"empty-state"},fB={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,l=A([]),c=A(!1),d=A(null),h=A(new Map),f=H(()=>l.value.map(D=>{const M=h.value.get(D.itemId),S=M!==void 0?M.complete:D.isCompleted,w=M!==void 0&&M.complete!==D.isCompleted;return{...D,localIsCompleted:S,isModified:w}})),m=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,d.value=null;try{const D=await zt.getMarshalChecklist(o.eventId,o.marshalId);if(l.value=D.data||[],o.modelValue&&o.modelValue.length>0){const M=new Map;o.modelValue.forEach(S=>{M.set(S.itemId,{complete:S.complete,contextType:S.contextType,contextId:S.contextId})}),h.value=M}}catch(D){console.error("Failed to load checklist:",D),d.value=D.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},y=D=>{const M=h.value.get(D.itemId),S=M!==void 0?M.complete:D.isCompleted;h.value.set(D.itemId,{complete:!S,contextType:D.completionContextType,contextId:D.completionContextId}),k()},k=()=>{const D=[];for(const[M,S]of h.value.entries()){const w=l.value.find(I=>I.itemId===M);w&&S.complete!==w.isCompleted&&D.push({itemId:M,complete:S.complete,contextType:S.contextType,contextId:S.contextId})}i("update:modelValue",D),i("change",D)},_=D=>{i("reorder",D)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const D=new Map;o.modelValue.forEach(M=>{D.set(M.itemId,{complete:M.complete,contextType:M.contextType,contextId:M.contextId})}),h.value=D}},loadChecklist:m}),Ye(()=>[o.eventId,o.marshalId],()=>{m()},{immediate:!0}),(D,M)=>(p(),g("div",cB,[c.value?(p(),g("div",uB," Loading checklist... ")):d.value?(p(),g("div",dB,[r("p",null,b(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(p(),g("div",hB,[r("p",null,"No checklist items for this "+b(F(a).person)+".",1)])):(p(),qe(Uf,{key:3,items:f.value,locations:e.locations,areas:e.areas,"allow-reorder":e.allowReorder,onToggleComplete:y,onReorder:_},null,8,["items","locations","areas","allow-reorder"]))]))}},pB=Ke(fB,[["__scopeId","data-v-38a322f4"]]),vB={class:"checklist-preview"},mB={class:"preview-actions"},gB={class:"preview-header"},yB={key:0,class:"add-item-form"},kB=["placeholder"],bB=["disabled"],wB={key:1,class:"pending-items"},_B={class:"item-content"},CB={class:"item-header"},LB={class:"item-text"},SB={class:"item-scope"},IB=["onClick"],xB={key:2,class:"empty-state"},$B={key:0,class:"help-text"},TB={key:3,class:"checklist-items"},MB={class:"item-content"},AB={class:"item-header"},EB={class:"item-text"},PB={class:"item-scope"},DB=["title"],RB={key:0,class:"item-context"},OB={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A([...a.modelValue]);Ye(()=>a.modelValue,S=>{c.value=[...S]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=S=>{c.value.splice(S,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")},m=H(()=>{const S=new Set;for(const w of a.pendingLocationIds){const I=a.allLocations.find(T=>T.id===w);I&&(I.areaIds||I.AreaIds||[]).forEach(B=>S.add(B))}return[...S]}),y=S=>{const w=S.scope,I=S.itemType,T=S.ids||[];return w==="SpecificPeople"&&I==="Marshal"?T.includes("ALL_MARSHALS"):(w==="EveryoneAtCheckpoints"||w==="OnePerCheckpoint")&&I==="Checkpoint"?T.includes("ALL_CHECKPOINTS")?!0:T.some(B=>a.pendingLocationIds.includes(B)):w==="OnePerCheckpoint"&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(B=>m.value.includes(B)):(w==="EveryoneInAreas"||w==="OnePerArea"||w==="EveryAreaLead"||w==="OneLeadPerArea")&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(B=>m.value.includes(B)):!1},k=H(()=>a.allChecklistItems.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(w=>y(w)):!1)),_=S=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,EveryoneInAreas:`All in ${n.value.areas}`,OnePerArea:`One per ${n.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${n.value.area}`})[S]||S,x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const w=S.scopeConfigurations.find(T=>y(T));if(!w)return _(S.scopeConfigurations[0].scope);const I=w.ids||[];return I.includes("ALL_MARSHALS")?"Everyone":I.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${n.value.areas}`:_(w.scope)},D=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const w=S.scopeConfigurations.find(T=>y(T));return w&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${n.value.checkpoints}`,OnePerCheckpoint:`One person at each ${n.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${n.value.areas}`,OnePerArea:`One person in each ${n.value.area} needs to complete this`,EveryAreaLead:`This item is for ${n.value.area} leads only`,OneLeadPerArea:`One ${n.value.area} lead needs to complete this`}[w.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const w=S.scopeConfigurations.find(B=>y(B));if(!w)return null;const I=w.itemType,T=w.ids||[];if(T.includes("ALL_MARSHALS")||T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(I==="Checkpoint"){const B=a.allLocations.filter(E=>T.includes(E.id)&&a.pendingLocationIds.includes(E.id)).map(E=>E.name);if(B.length>0)return`At: ${B.join(", ")}`}if(I==="Area"){const B=a.areas.filter(E=>T.includes(E.id)&&m.value.includes(E.id)).map(E=>E.name);if(B.length>0)return`In: ${B.join(", ")}`}return null};return(S,w)=>(p(),g("div",vB,[r("div",mB,[r("p",gB,b(e.isEditing?`Add new ${F(n).checklist} for this ${F(n).person}:`:`${F(n).checklists} that will apply to this ${F(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:w[0]||(w[0]=I=>i.value=!i.value)},b(i.value?"Cancel":`Add ${F(n).checklist}`),1)]),i.value?(p(),g("div",yB,[We(r("input",{"onUpdate:modelValue":w[1]||(w[1]=I=>l.value=I),type:"text",placeholder:`Enter ${F(n).checklist} text...`,class:"add-item-input",onKeyup:Qo(d,["enter"])},null,40,kB),[[at,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,bB)])):P("",!0),c.value.length>0?(p(),g("div",wB,[(p(!0),g(Ie,null,je(c.value,(I,T)=>(p(),g("div",{key:`pending-${T}`,class:"checklist-item pending"},[w[3]||(w[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",_B,[r("div",CB,[r("div",LB,b(I.text),1),r("div",SB,[w[2]||(w[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:B=>h(T),title:"Remove"},"  ",8,IB)])])])]))),128))])):P("",!0),!e.isEditing&&k.value.length===0&&c.value.length===0?(p(),g("div",xB,[r("p",null,"No "+b(F(n).checklists)+" will apply based on the current "+b(F(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",$B," Assign "+b(F(n).checkpoints)+" to see relevant "+b(F(n).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&k.value.length>0?(p(),g("div",TB,[(p(!0),g(Ie,null,je(k.value,I=>(p(),g("div",{key:I.id,class:"checklist-item"},[w[4]||(w[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",MB,[r("div",AB,[r("div",EB,b(I.text),1),r("div",PB,[r("span",{class:"scope-pill",title:D(I)},b(x(I)),9,DB)])]),M(I)?(p(),g("div",RB,b(M(I)),1)):P("",!0)])]))),128))])):P("",!0)]))}},BB=Ke(OB,[["__scopeId","data-v-6deaacc2"]]),NB={class:"notes-preview"},FB={class:"preview-actions"},UB={class:"preview-header"},zB={key:0,class:"add-item-form"},HB={class:"add-form-fields"},VB=["disabled"],GB={key:1,class:"pending-items"},qB={class:"note-header"},jB={class:"note-title"},WB={class:"note-actions"},ZB=["onClick"],KB={key:0,class:"note-content"},YB={key:2,class:"empty-state"},JB={key:0,class:"help-text"},XB={key:3,class:"notes-list"},QB={class:"note-header"},eN={class:"note-title"},tN=["title"],nN={key:0,class:"note-content"},oN={key:1,class:"note-context"},aN={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A(""),d=A([...a.modelValue]);Ye(()=>a.modelValue,w=>{d.value=[...w]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=w=>{d.value.splice(w,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")},y=H(()=>{const w=new Set;for(const I of a.pendingLocationIds){const T=a.allLocations.find(B=>B.id===I);T&&(T.areaIds||T.AreaIds||[]).forEach(E=>w.add(E))}return[...w]}),k=w=>{const I=w.scope,T=w.itemType,B=w.ids||[];return I==="SpecificPeople"&&T==="Marshal"?B.includes("ALL_MARSHALS"):I==="EveryoneAtCheckpoints"&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS")?!0:B.some(E=>a.pendingLocationIds.includes(E)):I==="EveryoneInAreas"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(E=>y.value.includes(E)):!1},_=H(()=>a.allNotes.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0?w.scopeConfigurations.some(I=>k(I)):!1)),x=w=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[w]||w,D=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"Unknown";const I=w.scopeConfigurations.find(B=>k(B));if(!I)return x(w.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_MARSHALS")?"Everyone":T.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},M=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"";const I=w.scopeConfigurations.find(B=>k(B));return I&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},S=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return null;const I=w.scopeConfigurations.find(E=>k(E));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_MARSHALS")||B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Checkpoint"){const E=a.allLocations.filter(N=>B.includes(N.id)&&a.pendingLocationIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`At: ${E.join(", ")}`}if(T==="Area"){const E=a.areas.filter(N=>B.includes(N.id)&&y.value.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(w,I)=>(p(),g("div",NB,[r("div",FB,[r("p",UB,b(e.isEditing?`Add new note for this ${F(n).person}:`:`Notes that will be visible to this ${F(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",zB,[r("div",HB,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>l.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,l.value]]),We(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=T=>c.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,VB)])):P("",!0),d.value.length>0?(p(),g("div",GB,[(p(!0),g(Ie,null,je(d.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"note-item pending"},[r("div",qB,[r("span",jB,b(T.title||"Untitled"),1),r("div",WB,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>f(B),title:"Remove"},"  ",8,ZB)])]),T.content?(p(),g("div",KB,b(T.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&_.value.length===0&&d.value.length===0?(p(),g("div",YB,[r("p",null,"No notes will be visible based on the current "+b(F(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",JB," Assign "+b(F(n).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&_.value.length>0?(p(),g("div",XB,[(p(!0),g(Ie,null,je(_.value,T=>(p(),g("div",{key:T.id,class:"note-item"},[r("div",QB,[r("span",eN,b(T.title||"Untitled"),1),r("span",{class:"scope-pill",title:M(T)},b(D(T)),9,tN)]),T.content?(p(),g("div",nN,b(T.content),1)):P("",!0),S(T)?(p(),g("div",oN,b(S(T)),1)):P("",!0)]))),128))])):P("",!0)]))}},sN=Ke(aN,[["__scopeId","data-v-e8e0946a"]]),iN={key:6,class:"tab-content incidents-tab"},lN={class:"incidents-list"},rN={class:"custom-footer"},cN={class:"footer-left"},uN={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3},roleDefinitions:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint","reorder-notes","reorder-checklists"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=e,l=n,c=A("details"),d=A(null),h=A(null),f=A(null),m=A([]),y=A([]),k=A([]),_=A([]),x=A({name:"",email:"",phoneNumber:"",notes:"",roles:[]}),D=A(!1),M=A(null),S=ee=>{M.value=ee,D.value=!0},w=()=>{D.value=!1,M.value=null},I=ee=>i.allLocations.find(_e=>_e.id===ee),T=H(()=>x.value.name||i.marshal?.name||""),B=H(()=>M.value&&I(M.value.locationId)?.name||""),E=H(()=>{if(!M.value)return null;const{checkInLatitude:ee,checkInLongitude:_e}=M.value;return!ee||!_e?null:{lat:ee,lng:_e}}),N=H(()=>{if(!M.value)return null;const ee=I(M.value.locationId);return!ee?.latitude||!ee?.longitude?null:{lat:ee.latitude,lng:ee.longitude}}),$=H(()=>{if(!M.value)return null;const{checkInLatitude:ee,checkInLongitude:_e,locationId:Be}=M.value,Ue=I(Be);return!ee||!_e||!Ue?.latitude||!Ue?.longitude?null:sl(ee,_e,Ue.latitude,Ue.longitude)}),z=H(()=>{const ee=i.isEditing?`Edit ${o.value.person}`:`Create ${o.value.person}`,_e=x.value.name?.trim();return _e?`${ee} - ${_e}`:ee}),O=H(()=>{const ee=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ee.push({value:"incidents",label:"Incidents",icon:"incidents"}),ee.push({value:"roles",label:"Roles",icon:"roles"}),ee}),j=H(()=>O.value.findIndex(ee=>ee.value===c.value)),Z=H(()=>j.value===O.value.length-1),J=H(()=>Z.value?null:O.value[j.value+1]),re=H(()=>J.value?`${J.value.label}...`:""),K=H(()=>y.value.map(ee=>ee.locationId)),ie=H(()=>i.isEditing?i.assignments:y.value.map(ee=>({id:`pending-${ee.locationId}`,locationId:ee.locationId,locationName:i.allLocations.find(_e=>_e.id===ee.locationId)?.name||"Unknown",isPending:!0}))),U=H(()=>{if(i.isEditing)return i.availableLocations;const ee=y.value.map(_e=>_e.locationId);return i.allLocations.filter(_e=>!ee.includes(_e.id))});Ye(()=>i.marshal,ee=>{ee?x.value={name:ee.name||"",email:ee.email||"",phoneNumber:ee.phoneNumber||"",notes:ee.notes||"",roles:ee.roles||[]}:x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}},{immediate:!0,deep:!0}),Ye(()=>i.show,ee=>{ee&&(c.value="details",m.value=[],y.value=[],k.value=[],_.value=[],i.isEditing||(x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const X=ee=>{x.value=ee},ae=ee=>{x.value={...x.value,roles:ee}},he=()=>{l("update:isDirty",!0)},$e=()=>{l("update:isDirty",!0)},Ee=()=>{J.value&&(c.value=J.value.value)},Me=ee=>{l("reorder-notes",ee)},ze=ee=>{l("reorder-checklists",ee)},be=()=>{const ee={...x.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:_.value};l("save",ee)},V=()=>{l("delete")},Y=ee=>{!i.isEditing&&ee.isPending?y.value=y.value.filter(_e=>_e.locationId!==ee.locationId):l("remove-assignment",ee)},de=ee=>{i.isEditing?l("assign-to-location",ee):(y.value.push({locationId:ee}),l("update:isDirty",!0))},se=ee=>{l("select-checkpoint",ee)},Re=()=>{l("close")};return t({switchToTab:ee=>{c.value=ee},focusField:ee=>{d.value?.focusField&&d.value.focusField(ee)}}),(ee,_e)=>(p(),qe(Zt,{show:e.show,title:z.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:Re},{"tab-header":Ve(()=>[Pe(dl,{modelValue:c.value,"onUpdate:modelValue":_e[0]||(_e[0]=Be=>c.value=Be),tabs:O.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",rN,[r("div",cN,[e.isEditing&&!e.lockedCheckpointId?(p(),g("button",{key:0,type:"button",onClick:V,class:"btn btn-danger"}," Delete ")):P("",!0),!e.isEditing&&!Z.value?(p(),g("button",{key:1,type:"button",onClick:Ee,class:"btn btn-secondary mobile-only"},b(re.value),1)):P("",!0)]),r("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[c.value==="details"?(p(),qe(SO,{key:0,ref_key:"detailsTabRef",ref:d,form:x.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":X,onInput:he},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),c.value==="checkpoints"?(p(),qe(KO,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:ie.value,"available-locations":U.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:he,onRemoveAssignment:Y,onAssignToLocation:de,onSelectCheckpoint:se,onDistanceClick:S},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),c.value==="checklists"&&e.isEditing?(p(),qe(pB,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":_e[1]||(_e[1]=Be=>m.value=Be),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,"allow-reorder":!0,onChange:$e,onReorder:ze},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),c.value==="checklists"?(p(),qe(BB,{key:3,modelValue:k.value,"onUpdate:modelValue":_e[2]||(_e[2]=Be=>k.value=Be),"all-checklist-items":e.allChecklistItems,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:he},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="notes"&&e.isEditing?(p(),qe(ld,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Me},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),c.value==="notes"?(p(),qe(sN,{key:5,modelValue:_.value,"onUpdate:modelValue":_e[3]||(_e[3]=Be=>_.value=Be),"all-notes":e.eventNotes,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:he},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="incidents"?(p(),g("div",iN,[r("div",lN,[(p(!0),g(Ie,null,je(e.incidents,Be=>(p(),qe(kc,{key:Be.incidentId,incident:Be,onSelect:_e[4]||(_e[4]=Ue=>ee.$emit("select-incident",Ue))},null,8,["incident"]))),128))])])):P("",!0),c.value==="roles"?(p(),qe(rB,{key:7,roles:x.value.roles,"role-definitions":e.roleDefinitions,"onUpdate:roles":ae,onInput:he},null,8,["roles","role-definitions"])):P("",!0),Pe(Pf,{show:D.value,"marshal-name":T.value,"checkpoint-name":B.value,"check-in-location":E.value,"checkpoint-location":N.value,distance:$.value,"z-index":e.zIndex+100,onClose:w},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},dN=Ke(uN,[["__scopeId","data-v-131580b5"]]),hN={class:"locations-list"},fN={class:"conflict-actions"},pN={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=t,i=c=>{o("choice",c)},l=()=>{o("close")};return(c,d)=>(p(),qe(Zt,{show:e.show,title:`${F(n).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ve(()=>[r("div",fN,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+b(F(a).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ve(()=>[r("p",null,[r("strong",null,b(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),r("ul",hN,[(p(!0),g(Ie,null,je(e.conflictData.locations,h=>(p(),g("li",{key:h},b(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},vN=Ke(pN,[["__scopeId","data-v-997e8aaa"]]),mN={key:0,class:"assign-marshal-section"},gN={value:""},yN=["value"],kN=["disabled"],bN={key:1,class:"assign-marshal-section create-mode"},wN={class:"form-group"},_N={class:"form-group"},CN={class:"form-group"},LN={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A({name:"",email:"",phoneNumber:""});Ye(()=>a.show,k=>{k||(i.value=!1,l.value="",c.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&o("assign-existing",l.value)},f=()=>{c.value.name&&o("create-and-assign",{...c.value})},m=()=>{i.value=!1,c.value={name:"",email:"",phoneNumber:""}},y=()=>{o("close")};return(k,_)=>(p(),qe(Zt,{show:e.show,title:i.value?`Create new ${F(n).person}`:`Assign ${F(n).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ve(()=>[i.value?(p(),g(Ie,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ve(()=>[i.value?(p(),g("div",bN,[r("h3",null,"Create new "+b(F(n).person),1),r("div",wN,[_[5]||(_[5]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":_[1]||(_[1]=x=>c.value.name=x),type:"text",required:"",class:"form-input"},null,512),[[at,c.value.name]])]),r("div",_N,[_[6]||(_[6]=r("label",null,"Email",-1)),We(r("input",{"onUpdate:modelValue":_[2]||(_[2]=x=>c.value.email=x),type:"email",class:"form-input"},null,512),[[at,c.value.email]])]),r("div",CN,[_[7]||(_[7]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":_[3]||(_[3]=x=>c.value.phoneNumber=x),type:"tel",class:"form-input"},null,512),[[at,c.value.phoneNumber]])])])):(p(),g("div",mN,[r("h3",null,"Select existing "+b(F(n).person),1),We(r("select",{"onUpdate:modelValue":_[0]||(_[0]=x=>l.value=x),class:"form-input"},[r("option",gN,"Choose a "+b(F(n).person)+"...",1),(p(!0),g(Ie,null,je(e.marshals,x=>(p(),g("option",{key:x.id,value:x.id},[Je(b(x.name)+" ",1),x.assignedLocationIds&&x.assignedLocationIds.length>0?(p(),g(Ie,{key:0},[Je(" (assigned to "+b(x.assignedLocationIds.length)+" "+b(x.assignedLocationIds.length>1?F(n).checkpoints:F(n).checkpoint)+") ",1)],64)):P("",!0)],8,yN))),128))],512),[[Qn,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+b(F(n).person),9,kN),_[4]||(_[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+b(F(n).person),1)]))]),_:1},8,["show","title"]))}},SN=Ke(LN,[["__scopeId","data-v-fa70b913"]]),IN={class:"shift-times-content"},xN={class:"info-text"},$N={class:"time-delta-info"},TN={class:"delta-detail"},MN={class:"delta-detail"},AN={class:"delta-summary"},EN={class:"affected-checkpoints"},PN={class:"option-selection"},DN={class:"radio-option"},RN={class:"radio-option"},ON={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=A("shift"),c=H(()=>{const y=new Date(o.oldEventDate);return new Date(o.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const k=Math.abs(y),_=y>=0?"+":"-",x=Math.floor(k/(1e3*60*60*24)),D=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),M=Math.floor(k%(1e3*60*60)/(1e3*60)),S=[];return x>0&&S.push(`${x}d`),D>0&&S.push(`${D}h`),M>0&&S.push(`${M}m`),`${_}${S.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:c.value})},m=()=>{i("cancel")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:`Shift ${F(n).checkpoint} Times?`,size:"medium",onClose:m},{actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},b(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ve(()=>[r("div",IN,[r("p",xN," You've changed the event date/time. Some "+b(F(a).checkpoints)+" have custom times set. ",1),r("div",$N,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",TN," Old: "+b(d(e.oldEventDate)),1),r("div",MN," New: "+b(d(e.newEventDate)),1),r("div",AN," Delta: "+b(h(c.value)),1)]),r("p",EN,[r("strong",null,b(e.affectedCheckpointsCount)+" "+b(e.affectedCheckpointsCount===1?F(a).checkpoint:F(a).checkpoints),1),k[3]||(k[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),r("div",PN,[r("label",DN,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=_=>l.value=_),type:"radio",value:"shift",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Shift all "+b(F(a).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",RN,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>l.value=_),type:"radio",value:"keep",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Keep "+b(F(a).checkpoint)+" times unchanged",1),r("small",null,b(F(n).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},BN=Ke(ON,[["__scopeId","data-v-a6454aff"]]),NN={class:"checklist-preview"},FN={class:"preview-actions"},UN={class:"preview-header"},zN={key:0,class:"add-item-form"},HN=["placeholder"],VN=["disabled"],GN={key:1,class:"pending-items"},qN={class:"item-content"},jN={class:"item-header"},WN={class:"item-text"},ZN={class:"item-scope"},KN=["onClick"],YN={key:2,class:"empty-state"},JN={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A([...a.modelValue]);Ye(()=>a.modelValue,m=>{c.value=[...m]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=m=>{c.value.splice(m,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")};return(m,y)=>(p(),g("div",NN,[r("div",FN,[r("p",UN," Add new "+b(F(n).checklist)+" for this "+b(F(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=k=>i.value=!i.value)},b(i.value?"Cancel":`Add ${F(n).checklist}`),1)]),i.value?(p(),g("div",zN,[We(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),type:"text",placeholder:`Enter ${F(n).checklist} text...`,class:"add-item-input",onKeyup:Qo(d,["enter"])},null,40,HN),[[at,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,VN)])):P("",!0),c.value.length>0?(p(),g("div",GN,[(p(!0),g(Ie,null,je(c.value,(k,_)=>(p(),g("div",{key:`pending-${_}`,class:"checklist-item pending"},[y[3]||(y[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",qN,[r("div",jN,[r("div",WN,b(k.text),1),r("div",ZN,[y[2]||(y[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:x=>h(_),title:"Remove"},"  ",8,KN)])])])]))),128))])):P("",!0),c.value.length===0&&!i.value?(p(),g("div",YN,[r("p",null,"No new "+b(F(n).checklists)+" to add. Click the button above to create one.",1)])):P("",!0)]))}},XN=Ke(JN,[["__scopeId","data-v-a394c400"]]),QN={class:"notes-preview"},e9={class:"preview-actions"},t9={class:"preview-header"},n9={key:0,class:"add-item-form"},o9={class:"add-form-fields"},a9=["disabled"],s9={key:1,class:"pending-items"},i9={class:"note-header"},l9={class:"note-title"},r9={class:"note-actions"},c9=["onClick"],u9={key:0,class:"note-content"},d9={key:2,class:"empty-state"},h9={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A(""),d=A([...a.modelValue]);Ye(()=>a.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=y=>{d.value.splice(y,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")};return(y,k)=>(p(),g("div",QN,[r("div",e9,[r("p",t9," Add new note for this "+b(F(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=_=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",n9,[r("div",o9,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>l.value=_),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,l.value]]),We(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=_=>c.value=_),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,a9)])):P("",!0),d.value.length>0?(p(),g("div",s9,[(p(!0),g(Ie,null,je(d.value,(_,x)=>(p(),g("div",{key:`pending-${x}`,class:"note-item pending"},[r("div",i9,[r("span",l9,b(_.title||"Untitled"),1),r("div",r9,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:D=>f(x),title:"Remove"},"  ",8,c9)])]),_.content?(p(),g("div",u9,b(_.content),1)):P("",!0)]))),128))])):P("",!0),d.value.length===0&&!i.value?(p(),g("div",d9,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):P("",!0)]))}},f9=Ke(h9,[["__scopeId","data-v-5e6bdcab"]]),p9={class:"search-section"},v9={class:"form-group"},m9={class:"suggestions-list"},g9={class:"suggestion-content"},y9={key:0,class:"suggestion-detail"},k9=["onClick"],b9={class:"suggestion-content"},w9={class:"suggestion-name"},_9={key:0,class:"suggestion-detail"},C9=["onClick"],L9={class:"suggestion-content"},S9={class:"suggestion-name"},I9={key:0,class:"suggestion-detail"},x9={key:1,class:"no-results"},$9={key:2,class:"no-results"},T9={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=A(""),l=A(null),c=H(()=>a.contacts.filter(E=>a.excludeContactIds.includes(E.contactId)&&E.marshalId).map(E=>E.marshalId)),d=H(()=>a.contacts.filter(E=>E.marshalId).map(E=>E.marshalId)),h=H(()=>a.contacts.filter(E=>!a.excludeContactIds.includes(E.contactId))),f=H(()=>a.marshals.filter(E=>!c.value.includes(E.id)&&!d.value.includes(E.id))),m=E=>E?E.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=H(()=>{const E=m(i.value);return E?E.split(" ").filter(N=>N.length>0):[]}),k=(E,N)=>{if(N.length===0)return{score:1,isPartial:!1};const $=m(E);let z=0;for(const O of N)$.includes(O)&&z++;return{score:z,isPartial:z>0&&z<N.length,isFullMatch:z===N.length}},_=H(()=>{const E=y.value,N=[];return h.value.forEach($=>{const z=`${$.name||""} ${$.role||""}`,O=k(z,E);(E.length===0||O.score>0)&&N.push({key:`contact-${$.contactId}`,type:"contact",name:$.name,detail:$.role?B($.role):null,data:$,matchScore:O.score,isPartial:O.isPartial,isFullMatch:O.isFullMatch})}),f.value.forEach($=>{const z=`${$.name||""} ${$.email||""}`,O=k(z,E);(E.length===0||O.score>0)&&N.push({key:`marshal-${$.id}`,type:"marshal",name:$.name,detail:$.email||$.phoneNumber||null,data:$,matchScore:O.score,isPartial:O.isPartial,isFullMatch:O.isFullMatch})}),N.sort(($,z)=>z.matchScore!==$.matchScore?z.matchScore-$.matchScore:$.name.localeCompare(z.name,void 0,{sensitivity:"base"})),N}),x=H(()=>y.value.length===0?_.value:_.value.filter(E=>E.isFullMatch)),D=H(()=>y.value.length===0?[]:_.value.filter(E=>E.isPartial)),M=H(()=>D.value.length>0);Ye(()=>a.show,async E=>{E&&(i.value="",await cn(),l.value?.focus())});const S=E=>{const N=a.contacts.find($=>$.marshalId===E.id);if(N){if(a.excludeContactIds.includes(N.contactId))return;o("select-contact",N)}else o("create-from-marshal",E)},w=E=>{o("select-contact",E)},I=()=>{o("create-new",i.value.trim())},T=()=>{o("close")},B=E=>E?E.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"";return(E,N)=>(p(),qe(Zt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:T},{actions:Ve(()=>[r("button",{onClick:T,class:"btn btn-secondary"}," Cancel ")]),default:Ve(()=>[r("div",p9,[r("div",v9,[N[1]||(N[1]=r("label",null,"Search or create",-1)),We(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":N[0]||(N[0]=$=>i.value=$),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[at,i.value]])]),r("div",m9,[r("div",{class:"suggestion-item create-new",onClick:I},[N[3]||(N[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",g9,[N[2]||(N[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(p(),g("span",y9,'"'+b(i.value.trim())+'"',1)):P("",!0)])]),(p(!0),g(Ie,null,je(x.value,$=>(p(),g("div",{key:$.key,class:"suggestion-item",onClick:z=>$.type==="marshal"?S($.data):w($.data)},[r("span",{class:le(["suggestion-icon",$.type==="marshal"?"marshal-icon":"contact-icon"])},b($.type==="marshal"?"M":"C"),3),r("div",b9,[r("span",w9,b($.name),1),$.detail?(p(),g("span",_9,b($.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":$.type==="contact"}])},b($.type==="marshal"?F(n).person:"Contact"),3)],8,k9))),128)),M.value?(p(),g(Ie,{key:0},[N[4]||(N[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(p(!0),g(Ie,null,je(D.value,$=>(p(),g("div",{key:$.key,class:"suggestion-item",onClick:z=>$.type==="marshal"?S($.data):w($.data)},[r("span",{class:le(["suggestion-icon",$.type==="marshal"?"marshal-icon":"contact-icon"])},b($.type==="marshal"?"M":"C"),3),r("div",L9,[r("span",S9,b($.name),1),$.detail?(p(),g("span",I9,b($.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":$.type==="contact"}])},b($.type==="marshal"?F(n).person:"Contact"),3)],8,C9))),128))],64)):P("",!0),i.value.trim()&&x.value.length===0&&D.value.length===0?(p(),g("div",x9," No matching "+b(F(n).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!i.value.trim()&&x.value.length===0?(p(),g("div",$9," No "+b(F(n).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},M9=Ke(T9,[["__scopeId","data-v-e25ca97b"]]),A9={class:"contact-card-header"},E9={class:"contact-name-row"},P9={key:0,class:"pin-icon",title:"Pinned"},D9={key:1,class:"primary-badge",title:"Primary contact"},R9={class:"contact-name"},O9={key:0,class:"contact-role"},B9={key:0,class:"emergency-indicator",title:"Shown in emergency info"},N9={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},F9=["title"],U9={key:0,class:"contact-card-details"},z9={key:0,class:"contact-phone"},H9={key:1,class:"contact-email"},V9={key:1,class:"contact-card-notes"},G9={key:3,class:"contact-card-badge"},q9={key:4,class:"contact-card-badge"},j9={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=H(()=>{const m=new Map;for(const y of a.roleDefinitions)m.set(y.roleId,y.name),m.set(y.name,y.name);return m}),l=H(()=>a.contact.roles&&Array.isArray(a.contact.roles)&&a.contact.roles.length>0?a.contact.roles:a.contact.role?[a.contact.role]:[]),c=H(()=>{const m=a.contact.scopeConfigurations;return!m||m.length===0}),d=()=>{a.clickable&&!a.isPending&&!a.isMarkedForRemoval&&o("click",a.contact)},h=m=>{if(!m)return"";const y=i.value.get(m);return y||(m==="AreaLead"?`${n.value.area} Lead`:m.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim())},f=m=>{if(!m)return"";const y=100;return m.length<=y?m:m.substring(0,y)+"..."};return(m,y)=>(p(),g("div",{class:le(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:d},[r("div",A9,[r("div",{class:le(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",E9,[e.contact.isPinned&&!e.isMarkedForRemoval?(p(),g("span",P9,"")):P("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(p(),g("span",D9,"")):P("",!0),r("span",R9,b(e.contact.name),1)]),l.value.length>0?(p(),g("span",O9,b(l.value.map(h).join(", ")),1)):P("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(p(),g("span",B9,"")):P("",!0),c.value&&!e.isMarkedForRemoval&&!e.isPending?(p(),g("span",N9,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(p(),g("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:y[0]||(y[0]=ct(k=>m.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,F9)):P("",!0),e.isMarkedForRemoval?(p(),g("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:y[1]||(y[1]=ct(k=>m.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(p(),g("div",U9,[e.contact.phone?(p(),g("span",z9,b(e.contact.phone),1)):P("",!0),e.contact.email?(p(),g("span",H9,b(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(p(),g("div",V9,b(f(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(p(),qe(ol,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):P("",!0),e.isPending?(p(),g("div",G9,[...y[2]||(y[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),g("div",q9,[...y[3]||(y[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},W9=Ke(j9,[["__scopeId","data-v-9a194a03"]]),Z9={class:"contact-card-wrapper"},K9={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["select","remove","undo-remove","reorder"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>[...n.contacts].sort((d,h)=>{if(d.isPinned!==h.isPinned)return d.isPinned?-1:1;const f=d.displayOrder||0,m=h.displayOrder||0;return f!==m?f-m:(d.name||"").localeCompare(h.name||"",void 0,{sensitivity:"base"})})),i=d=>typeof n.removeTitle=="function"?n.removeTitle(d):n.removeTitle,l=d=>!d.isPending,c=({changes:d})=>{a("reorder",d)};return(d,h)=>(p(),qe(bc,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[e.contacts.length>0?(p(),qe(ll,{key:0,items:o.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:c},{item:Ve(({element:f})=>[r("div",Z9,[e.allowReorder?(p(),qe(rl,{key:0})):P("",!0),Pe(W9,{contact:f,"is-pending":f.isPending,"is-marked-for-removal":f.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":i(f),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:l(f),areas:e.areas,locations:e.locations,marshals:e.marshals,"role-definitions":e.roleDefinitions,onClick:m=>d.$emit("select",f),onRemove:h[0]||(h[0]=m=>d.$emit("remove",m)),onUndoRemove:h[1]||(h[1]=m=>d.$emit("undo-remove",m))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","role-definitions","onClick"])])]),_:1},8,["items","disabled","show-order-overlay"])):P("",!0)]),_:1},8,["is-empty","empty-message","empty-hint"]))}},Y9=Ke(K9,[["__scopeId","data-v-4c025463"]]),J9={key:0,class:"tab-content"},X9={class:"form-group"},Q9=["disabled"],eF={class:"form-group"},tF={key:1,class:"tab-content"},nF={class:"boundary-section"},oF={key:0,class:"boundary-preview"},aF={class:"boundary-actions"},sF={key:2,class:"tab-content"},iF={class:"contacts-header"},lF={class:"section-title"},rF={key:3,class:"tab-content"},cF={class:"section-title"},uF={key:4,class:"placeholder-message"},dF={key:7,class:"placeholder-message"},hF={key:10,class:"placeholder-message"},fF={key:11,class:"tab-content appearance-tab"},pF={class:"accordion-item"},vF=["innerHTML"],mF={class:"accordion-title"},gF={class:"accordion-arrow"},yF={key:0,class:"accordion-content"},kF={class:"section-description"},bF={class:"color-picker"},wF=["title","onClick"],_F={class:"accordion-item"},CF=["innerHTML"],LF={class:"accordion-title"},SF={class:"accordion-arrow"},IF={key:0,class:"accordion-content"},xF={class:"section-description"},$F={class:"accordion-item"},TF={class:"accordion-title"},MF={class:"accordion-preview"},AF={class:"accordion-arrow"},EF={key:0,class:"accordion-content"},PF={class:"section-description"},DF={class:"form-group"},RF={value:""},OF=["value"],BF={class:"accordion-item"},NF={class:"accordion-title"},FF={class:"accordion-preview"},UF={class:"accordion-arrow"},zF={key:0,class:"accordion-content"},HF={class:"section-description"},VF={class:"form-group"},GF={value:""},qF=["value"],jF={key:12,class:"tab-content incidents-tab"},WF={class:"incidents-list"},ZF={class:"custom-footer"},KF={class:"footer-left"},vm="edit_area_accordion",YF={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident","reorder-notes","reorder-checklists","reorder-contacts"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=()=>T.value.peopleTerm?T.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(te=!0)=>{const ye=T.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",He=i();return te?jy("checkpoint",ye,He):Wi("checkpoint",ye,He)},c=(te=!0)=>l(te).toLowerCase(),d=e,h=n,f=A("details"),m=A(null),y=A([]),k=A({}),_=A({}),x=A(!1),D=A(!1),M=A([]),S=A([]),w=A([]),I=A([]),T=A({name:"",description:"",color:tu,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),B=()=>({name:"",description:"",color:CL(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),E=()=>d.eventId?`${vm}_${d.eventId}`:vm,N=A({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});un(()=>{const te=localStorage.getItem(E());if(te)try{const ye=JSON.parse(te);N.value={...N.value,...ye}}catch{}});const $=te=>{N.value[te]=!N.value[te],localStorage.setItem(E(),JSON.stringify(N.value))},z=H(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${T.value.color||tu}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),O=H(()=>{const te=T.value.checkpointStyleType!=="default"||T.value.checkpointStyleBackgroundShape||T.value.checkpointStyleBackgroundColor||T.value.checkpointStyleBorderColor||T.value.checkpointStyleIconColor||T.value.checkpointStyleSize,ye=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!te&&!ye)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const He=T.value.checkpointStyleType&&T.value.checkpointStyleType!=="default"?T.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",rt=T.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",kt=T.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Rt=T.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Lt=T.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",xt=T.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return zn({type:He!=="default"?He:rt,backgroundShape:rt,backgroundColor:kt,borderColor:Rt,iconColor:Lt,size:xt,outputSize:24})}),j=H(()=>d.area&&d.area.id),Z=H(()=>!T.value.polygon||T.value.polygon.length===0?[]:T.value.polygon.map((te,ye)=>({id:`polygon-point-${ye}`,latitude:te.lat,longitude:te.lng}))),J=H(()=>d.area?.id?d.areas.filter(te=>te.id!==d.area.id).map(te=>({...te,color:"#999999"})):d.areas.map(te=>({...te,color:"#999999"})));H(()=>he.value.map(te=>te.id));const re=H(()=>{const te=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&te.push({value:"incidents",label:"Incidents",icon:"incidents"}),te}),K=H(()=>re.value.findIndex(te=>te.value===f.value)),ie=H(()=>K.value===re.value.length-1),U=H(()=>ie.value?null:re.value[K.value+1]),X=H(()=>U.value?`${U.value.label}...`:""),ae=H(()=>{if(!d.area||!d.area.id)return[];const te=d.checkpoints.filter(ye=>ye.areaIds&&ye.areaIds.includes(d.area.id)).map(ye=>ye.id);return d.assignments.filter(ye=>te.includes(ye.locationId))}),he=H(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(te=>te.areaIds&&te.areaIds.includes(d.area.id))),$e=H(()=>{const te=[...he.value];return te.sort((ye,He)=>{const rt=ye.name.match(/^(\d+)/),kt=He.name.match(/^(\d+)/);if(rt&&kt){const Rt=parseInt(rt[1]),Lt=parseInt(kt[1]);if(Rt!==Lt)return Rt-Lt}return ye.name.localeCompare(He.name,void 0,{numeric:!0,sensitivity:"base"})}),te}),Ee=H(()=>!d.area||!d.area.id?[]:d.contacts.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(ye=>ye.scope==="EveryoneInAreas"&&ye.itemType==="Area"?ye.ids?.includes("ALL_AREAS")?!0:ye.ids?.includes(d.area.id):!1):!1)),Me=H(()=>{const te=new Set(Ee.value.map(rt=>rt.contactId)),ye=Ee.value.map(rt=>({...rt,isPending:!1,isExisting:!0,isMarkedForRemoval:S.value.includes(rt.contactId)})),He=M.value.filter(rt=>!te.has(rt.contactId)).map(rt=>({...rt,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...ye,...He].sort((rt,kt)=>rt.name.localeCompare(kt.name,void 0,{sensitivity:"base"}))}),ze=H(()=>{const te=Ee.value.map(He=>He.contactId),ye=M.value.map(He=>He.contactId);return[...te,...ye]}),be=async te=>{if(!(k.value[te]||_.value[te])){_.value[te]=!0;try{const He=(await zt.getCheckpointChecklist(d.eventId,te)).data||[];k.value[te]={total:He.length,completed:He.filter(rt=>rt.isCompleted).length}}catch(ye){console.error("Failed to load checklist status for checkpoint:",te,ye),k.value[te]={total:0,completed:0}}finally{_.value[te]=!1}}};Ye(()=>d.area,te=>{if(te){const ye=te.polygon?typeof te.polygon=="string"?JSON.parse(te.polygon):te.polygon:[];T.value={name:te.name||"",description:te.description||"",color:te.color||tu,displayOrder:te.displayOrder||0,isDefault:te.isDefault||!1,polygon:ye,checkpointStyleType:te.checkpointStyleType||"default",checkpointStyleColor:te.checkpointStyleColor||"",checkpointStyleBackgroundShape:te.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:te.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:te.checkpointStyleBorderColor||"",checkpointStyleIconColor:te.checkpointStyleIconColor||"",checkpointStyleSize:te.checkpointStyleSize||"",checkpointStyleMapRotation:te.checkpointStyleMapRotation??"",peopleTerm:te.peopleTerm||"",checkpointTerm:te.checkpointTerm||""}}else T.value=B()},{immediate:!0,deep:!0}),Ye(()=>d.show,te=>{te&&(f.value=d.initialTab||"details",y.value=[],k.value={},_.value={},M.value=[],S.value=[],w.value=[],I.value=[],D.value=!1,j.value||(T.value=B()),m.value?.resetLocalState&&m.value.resetLocalState())}),Ye(f,te=>{te==="checkpoints"&&d.area&&d.area.id&&he.value.forEach(ye=>{setTimeout(()=>be(ye.id),0)})});const V=()=>{h("update:isDirty",!0)},Y=te=>{T.value.color=te,V()},de=(te,ye)=>{T.value[te]=ye,V()},se=()=>{h("draw-boundary",T.value)},Re=te=>{T.value.polygon=te,V()},q=()=>{T.value.polygon=[],x.value=!1,V()},Q=te=>{D.value=!1,h("create-contact-from-marshal",{marshal:te,area:d.area})},ee=te=>{D.value=!1,h("create-new-contact",{name:te,area:d.area})},_e=te=>{M.value.find(ye=>ye.contactId===te.contactId)||(M.value.push(te),V()),D.value=!1},Be=te=>{M.value=M.value.filter(ye=>ye.contactId!==te),V()},Ue=te=>{S.value.includes(te)||(S.value.push(te),V())},Ae=te=>te.isPending?"Remove pending contact":`Remove from ${o.value.area}`,ne=te=>{Me.value.find(He=>He.contactId===te)?.isPending?Be(te):Ue(te)},ge=te=>{S.value=S.value.filter(ye=>ye!==te),V()},Oe=te=>{y.value=te,V()},De=()=>{U.value&&(f.value=U.value.value)},xe=te=>{h("reorder-notes",te)},me=te=>{h("reorder-checklists",te)},Ze=te=>{h("reorder-contacts",te)},Ge=()=>{const te=d.area?{name:T.value.name,description:T.value.description,color:T.value.color,polygon:T.value.polygon.length>0?T.value.polygon:null,displayOrder:T.value.displayOrder,checkpointStyleType:T.value.checkpointStyleType,checkpointStyleColor:T.value.checkpointStyleColor,checkpointStyleBackgroundShape:T.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:T.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:T.value.checkpointStyleBorderColor,checkpointStyleIconColor:T.value.checkpointStyleIconColor,checkpointStyleSize:T.value.checkpointStyleSize,checkpointStyleMapRotation:T.value.checkpointStyleMapRotation!=null&&T.value.checkpointStyleMapRotation!==""?String(T.value.checkpointStyleMapRotation):null,peopleTerm:T.value.peopleTerm,checkpointTerm:T.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:M.value||[],contactsToRemove:S.value||[],pendingNewChecklistItems:w.value||[],pendingNewNotes:I.value||[]}:{name:T.value.name,description:T.value.description,color:T.value.color,polygon:T.value.polygon.length>0?T.value.polygon:null,checkpointStyleType:T.value.checkpointStyleType,checkpointStyleColor:T.value.checkpointStyleColor,checkpointStyleBackgroundShape:T.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:T.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:T.value.checkpointStyleBorderColor,checkpointStyleIconColor:T.value.checkpointStyleIconColor,checkpointStyleSize:T.value.checkpointStyleSize,checkpointStyleMapRotation:T.value.checkpointStyleMapRotation!=null&&T.value.checkpointStyleMapRotation!==""?String(T.value.checkpointStyleMapRotation):null,peopleTerm:T.value.peopleTerm,checkpointTerm:T.value.checkpointTerm,pendingContacts:M.value||[]};h("save",te)},fe=()=>{h("delete",d.area.id)},ke=()=>{h("close")};return t({addPendingContact:te=>{te&&!M.value.find(ye=>ye.contactId===te.contactId)&&(M.value.push(te),V())},removeContactById:te=>{const ye=M.value.some(He=>He.contactId===te);M.value=M.value.filter(He=>He.contactId!==te),S.value=S.value.filter(He=>He!==te),ye&&V()}}),(te,ye)=>(p(),qe(Zt,{show:e.show,title:e.area&&e.area.id?`Edit ${F(o).area}: ${e.area.name}`:`Create new ${F(o).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ke},{"tab-header":Ve(()=>[Pe(dl,{modelValue:f.value,"onUpdate:modelValue":ye[0]||(ye[0]=He=>f.value=He),tabs:re.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",ZF,[r("div",KF,[j.value&&!T.value.isDefault?(p(),g("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete ")):P("",!0),!j.value&&!ie.value?(p(),g("button",{key:1,type:"button",onClick:De,class:"btn btn-secondary mobile-only"},b(X.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ge,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[f.value==="details"?(p(),g("div",J9,[r("form",{onSubmit:ct(Ge,["prevent"])},[r("div",X9,[ye[27]||(ye[27]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":ye[1]||(ye[1]=He=>T.value.name=He),type:"text",required:"",class:"form-input",disabled:T.value.isDefault,onInput:V},null,40,Q9),[[at,T.value.name]])]),r("div",eF,[ye[28]||(ye[28]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":ye[2]||(ye[2]=He=>T.value.description=He),class:"form-input",rows:"3",onInput:V},null,544),[[at,T.value.description]])])],32)])):P("",!0),f.value==="boundary"?(p(),g("div",tF,[r("div",nF,[T.value.polygon&&T.value.polygon.length>0?(p(),g("div",oF,[Pe(il,{mode:"edit-polygon","editing-polygon":T.value.polygon,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,locations:e.checkpoints,areas:J.value,"all-locations-for-bounds":Z.value,height:"300px",onPolygonUpdate:Re},null,8,["editing-polygon","route","route-color","route-style","route-weight","locations","areas","all-locations-for-bounds"]),ye[29]||(ye[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),r("div",aF,[!T.value.polygon||T.value.polygon.length===0?(p(),g("button",{key:0,onClick:se,class:"btn btn-primary btn-full"}," Draw on map ")):(p(),g(Ie,{key:1},[r("button",{onClick:se,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:ye[3]||(ye[3]=He=>x.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Pe(hi,{show:x.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:q,onCancel:ye[4]||(ye[4]=He=>x.value=!1)},null,8,["show"]),f.value==="contacts"?(p(),g("div",sF,[r("div",iF,[r("h3",lF,b(F(a).area)+" contacts ("+b(Me.value.length)+")",1),r("button",{onClick:ye[5]||(ye[5]=He=>D.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Pe(Y9,{contacts:Me.value,"show-remove-button":!0,"remove-title":Ae,"empty-message":`No contacts assigned to this ${F(o).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${F(o).people} in this ${F(o).area}.`,"allow-reorder":j.value,"role-definitions":e.roleDefinitions,onSelect:ye[6]||(ye[6]=He=>te.$emit("edit-contact",He)),onRemove:ne,onUndoRemove:ge,onReorder:Ze},null,8,["contacts","empty-message","empty-hint","allow-reorder","role-definitions"])])):P("",!0),Pe(M9,{show:D.value,"area-name":T.value.name||"this "+F(o).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":ze.value,onClose:ye[7]||(ye[7]=He=>D.value=!1),onSelectContact:_e,onCreateFromMarshal:Q,onCreateNew:ee},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(p(),g("div",rF,[r("h3",cF,b(l())+" in "+b(e.area?.name)+" ("+b(he.value.length)+")",1),Pe(v1,{checkpoints:$e.value,areas:e.areas,"empty-message":`No ${c()} in this ${F(o).area} yet.`,onSelect:ye[8]||(ye[8]=He=>te.$emit("select-checkpoint",He))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),f.value==="checkpoints"&&!j.value?(p(),g("div",uF,[r("p",null,b(l())+" will be automatically assigned based on boundaries after the "+b(F(o).area)+" is created.",1)])):P("",!0),f.value==="checklists"&&j.value?(p(),qe(w1,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":ye[9]||(ye[9]=He=>y.value=He),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ae.value,marshals:e.marshals,"allow-reorder":!0,onChange:Oe,onReorder:me},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):P("",!0),f.value==="checklists"&&j.value?(p(),qe(XN,{key:6,modelValue:w.value,"onUpdate:modelValue":ye[10]||(ye[10]=He=>w.value=He),onChange:V},null,8,["modelValue"])):P("",!0),f.value==="checklists"&&!j.value?(p(),g("div",dF,[r("p",null,b(F(a).checklists)+" can be assigned after the "+b(F(o).area)+" is created.",1)])):P("",!0),f.value==="notes"&&j.value?(p(),qe(ld,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals,"allow-reorder":!0,onReorder:xe},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),f.value==="notes"&&j.value?(p(),qe(f9,{key:9,modelValue:I.value,"onUpdate:modelValue":ye[11]||(ye[11]=He=>I.value=He),onChange:V},null,8,["modelValue"])):P("",!0),f.value==="notes"&&!j.value?(p(),g("div",hF,[r("p",null,"Notes can be viewed after the "+b(F(o).area)+" is created.",1)])):P("",!0),f.value==="appearance"?(p(),g("div",fF,[r("div",pF,[r("button",{type:"button",class:le(["accordion-header",{expanded:N.value.polygonColor}]),onClick:ye[12]||(ye[12]=He=>$("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:z.value},null,8,vF),r("span",mF,b(F(a).area)+" polygon colour",1),r("span",gF,b(N.value.polygonColor?"":""),1)],2),N.value.polygonColor?(p(),g("div",yF,[r("p",kF," Choose a colour for this "+b(F(o).area)+"'s boundary on the map. ",1),r("div",bF,[(p(!0),g(Ie,null,je(F(Un),He=>(p(),g("div",{key:He.hex,class:le(["color-swatch",{selected:T.value.color===He.hex}]),style:tt({backgroundColor:He.hex}),title:He.name,onClick:rt=>Y(He.hex)},null,14,wF))),128))])])):P("",!0)]),r("div",_F,[r("button",{type:"button",class:le(["accordion-header",{expanded:N.value.iconStyle}]),onClick:ye[13]||(ye[13]=He=>$("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:O.value},null,8,CF),r("span",LF,b(l(!1))+" marker style",1),r("span",SF,b(N.value.iconStyle?"":""),1)],2),N.value.iconStyle?(p(),g("div",IF,[r("p",xF," Set a default marker style for all "+b(c())+" in this "+b(F(o).area)+". Individual "+b(c())+" can override this setting. ",1),Pe(Bf,{"style-type":T.value.checkpointStyleType||"default","style-color":T.value.checkpointStyleColor||"","style-background-shape":T.value.checkpointStyleBackgroundShape||"","style-background-color":T.value.checkpointStyleBackgroundColor||"","style-border-color":T.value.checkpointStyleBorderColor||"","style-icon-color":T.value.checkpointStyleIconColor||"","style-size":T.value.checkpointStyleSize||"","style-map-rotation":T.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":ye[14]||(ye[14]=He=>de("checkpointStyleType",He)),"onUpdate:styleColor":ye[15]||(ye[15]=He=>de("checkpointStyleColor",He)),"onUpdate:styleBackgroundShape":ye[16]||(ye[16]=He=>de("checkpointStyleBackgroundShape",He)),"onUpdate:styleBackgroundColor":ye[17]||(ye[17]=He=>de("checkpointStyleBackgroundColor",He)),"onUpdate:styleBorderColor":ye[18]||(ye[18]=He=>de("checkpointStyleBorderColor",He)),"onUpdate:styleIconColor":ye[19]||(ye[19]=He=>de("checkpointStyleIconColor",He)),"onUpdate:styleSize":ye[20]||(ye[20]=He=>de("checkpointStyleSize",He)),"onUpdate:styleMapRotation":ye[21]||(ye[21]=He=>de("checkpointStyleMapRotation",He))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),r("div",$F,[r("button",{type:"button",class:le(["accordion-header",{expanded:N.value.peopleTerm}]),onClick:ye[22]||(ye[22]=He=>$("peopleTerm"))},[ye[30]||(ye[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",TF,b(i())+" terminology",1),r("span",MF,b(T.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",AF,b(N.value.peopleTerm?"":""),1)],2),N.value.peopleTerm?(p(),g("div",EF,[r("p",PF," Choose what "+b(i().toLowerCase())+" are called in this "+b(F(o).area)+". This will be inherited by "+b(c())+" unless they override it. ",1),r("div",DF,[ye[31]||(ye[31]=r("label",null,"What are people called?",-1)),We(r("select",{"onUpdate:modelValue":ye[23]||(ye[23]=He=>T.value.peopleTerm=He),class:"form-input",onChange:V},[r("option",RF,"Use event default ("+b(e.eventPeopleTerm)+")",1),(p(!0),g(Ie,null,je(F(gs).people,He=>(p(),g("option",{key:He,value:He},b(He),9,OF))),128))],544),[[Qn,T.value.peopleTerm]])])])):P("",!0)]),r("div",BF,[r("button",{type:"button",class:le(["accordion-header",{expanded:N.value.checkpointTerm}]),onClick:ye[24]||(ye[24]=He=>$("checkpointTerm"))},[ye[32]||(ye[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",NF,b(l(!1))+" terminology",1),r("span",FF,b(T.value.checkpointTerm?F(Wh)(T.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",UF,b(N.value.checkpointTerm?"":""),1)],2),N.value.checkpointTerm?(p(),g("div",zF,[r("p",HF," Choose what "+b(c())+" are called in this "+b(F(o).area)+". ",1),r("div",VF,[r("label",null,"What are "+b(c())+" called?",1),We(r("select",{"onUpdate:modelValue":ye[25]||(ye[25]=He=>T.value.checkpointTerm=He),class:"form-input",onChange:V},[r("option",GF,"Use event default ("+b(e.eventCheckpointTerm)+")",1),(p(!0),g(Ie,null,je(F(gs).checkpoint,He=>(p(),g("option",{key:He,value:He},b(F(Wh)(He,i())),9,qF))),128))],544),[[Qn,T.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),f.value==="incidents"?(p(),g("div",jF,[r("div",WF,[(p(!0),g(Ie,null,je(e.incidents,He=>(p(),qe(kc,{key:He.incidentId,incident:He,onSelect:ye[26]||(ye[26]=rt=>te.$emit("select-incident",rt))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},JF=Ke(YF,[["__scopeId","data-v-562b692e"]]),XF=["innerHTML"],QF={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const n=t,a=()=>{n("close")};return(o,i)=>(p(),qe(Zt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:Ve(()=>[r("button",{onClick:a,class:"btn btn-primary"},b(e.okText),1)]),default:Ve(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,XF)]),_:1},8,["show","title"]))}},wc=Ke(QF,[["__scopeId","data-v-a6e7148c"]]),e7={class:"tab-content"},t7={class:"form-group"},n7={for:"text"},o7=["placeholder"],a7={key:0,class:"checkbox-label-inline create-separate-items"},s7={key:0,class:"form-group link-to-checkin"},i7={class:"checkbox-label-inline"},l7={class:"help-text"},r7={key:1,class:"form-group link-to-checkin-warning"},c7={class:"help-text warning"},u7={class:"tab-content"},d7={class:"custom-footer"},h7={class:"footer-left"},f7={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},nextDisplayOrder:{type:Number,default:0}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:n,termsSentence:a}=ht(),o=e,i=t,l=A(!1),c=A(""),d=A("details"),h=A({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1}),f=H(()=>!!o.checklistItem),m=H(()=>{const N=h.value.scopeConfigurations.filter($=>$.scope&&($.ids?.length>0||$.scope==="Everyone"||$.scope==="EveryoneAtCheckpoints"||$.scope==="SpecificPeople"));return N.length===0?!1:N.every($=>$.scope==="EveryoneAtCheckpoints"||$.scope==="SpecificPeople")}),y=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=H(()=>y.findIndex(N=>N.value===d.value)),_=H(()=>k.value===y.length-1),x=H(()=>_.value?"":y[k.value+1]?.label||"");Ye(()=>o.show,N=>{N&&(d.value=o.initialTab,o.checklistItem?h.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?D(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?D(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?D(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1,linksToCheckIn:o.checklistItem.linksToCheckIn||!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.nextDisplayOrder,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1},i("update:isDirty",!1))});const D=N=>{if(!N)return null;const $=new Date(N),z=$.getTimezoneOffset();return new Date($.getTime()-z*60*1e3).toISOString().slice(0,16)},M=N=>N?new Date(N).toISOString():null,S=()=>{i("update:isDirty",!0)},w=()=>{i("close")},I=()=>{_.value||(d.value=y[k.value+1].value)},T=N=>{c.value=N,l.value=!0},B=()=>{if(!h.value.text||!h.value.text.trim()){T(`Please enter ${n.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){T("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(z=>!(z.itemType!==null&&(!z.ids||z.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const $={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:M(h.value.visibleFrom),visibleUntil:M(h.value.visibleUntil),mustCompleteBy:M(h.value.mustCompleteBy),linksToCheckIn:h.value.linksToCheckIn};f.value||($.createSeparateItems=h.value.createSeparateItems),i("save",$)},E=()=>{i("delete",o.checklistItem.itemId)};return(N,$)=>(p(),g(Ie,null,[Pe(Zt,{show:e.show,title:f.value?`Edit ${F(n).checklist}`:`Create ${F(n).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:w},{"tab-header":Ve(()=>[Pe(dl,{modelValue:d.value,"onUpdate:modelValue":$[0]||($[0]=z=>d.value=z),tabs:y},null,8,["modelValue"])]),footer:Ve(()=>[r("div",d7,[r("div",h7,[f.value?(p(),g("button",{key:0,type:"button",onClick:E,class:"btn btn-danger"}," Delete ")):P("",!0),!f.value&&!_.value?(p(),g("button",{key:1,type:"button",onClick:I,class:"btn btn-secondary mobile-only"},b(x.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:B,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(B,["prevent"]),class:"checklist-form"},[We(r("div",e7,[r("div",t7,[r("label",n7,b(F(a).checklist)+" text: *",1),We(r("textarea",{id:"text","onUpdate:modelValue":$[1]||($[1]=z=>h.value.text=z),onInput:S,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${F(n).checklists}, one per line...`:`Enter the ${F(n).checklist} text...`},null,40,o7),[[at,h.value.text]]),f.value?P("",!0):(p(),g("label",a7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[2]||($[2]=z=>h.value.createSeparateItems=z),onChange:S},null,544),[[Ma,h.value.createSeparateItems]]),$[6]||($[6]=r("span",null,"Each line creates a new item",-1))]))]),m.value?(p(),g("div",s7,[r("label",i7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[3]||($[3]=z=>h.value.linksToCheckIn=z),onChange:S},null,544),[[Ma,h.value.linksToCheckIn]]),$[7]||($[7]=r("span",null,"Link to check-in status",-1))]),r("p",l7," Completing this "+b(F(n).checklist)+" will check the "+b(F(n).person)+" in at the "+b(F(n).checkpoint)+". Checking in will complete this "+b(F(n).checklist)+". ",1)])):h.value.linksToCheckIn?(p(),g("div",r7,[r("p",c7,[$[8]||($[8]=r("strong",null,"Note:",-1)),Je(' Link to check-in is currently enabled but the visibility settings are incompatible. Change visibility to "Everyone at specific '+b(F(n).checkpoints)+'" or "Specific '+b(F(n).people)+'" to use this feature. ',1)])])):P("",!0)],512),[[oa,d.value==="details"]]),We(r("div",u7,[Pe(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":$[4]||($[4]=z=>h.value.scopeConfigurations=z),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:S},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[oa,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:l.value,title:"Validation error",message:c.value,onClose:$[5]||($[5]=z=>l.value=!1)},null,8,["show","message"])],64))}},p7=Ke(f7,[["__scopeId","data-v-6f300b9a"]]),v7={class:"tab-content"},m7={class:"form-group"},g7={class:"form-group"},y7={class:"form-row"},k7={class:"form-group"},b7={class:"checkbox-label-inline show-emergency-checkbox"},w7={class:"form-group"},_7={class:"form-row"},C7={class:"form-group"},L7={class:"form-group checkbox-group-inline"},S7={class:"checkbox-label-inline"},I7={class:"tab-content"},x7={class:"custom-footer"},$7={class:"footer-left"},T7={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=A(!1),i=A(""),l=A("details"),c=A({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=I=>I==="Urgent"||I==="Emergency",h=H(()=>!!n.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],m=H(()=>f.findIndex(I=>I.value===l.value)),y=H(()=>m.value===f.length-1),k=H(()=>y.value?"":f[m.value+1]?.label||"");Ye(()=>n.show,I=>{I&&(l.value=n.initialTab,n.note?c.value={title:n.note.title||"",content:n.note.content||"",scopeConfigurations:n.note.scopeConfigurations?JSON.parse(JSON.stringify(n.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:n.note.displayOrder||0,priority:n.note.priority||"Normal",category:n.note.category||"",isPinned:n.note.isPinned||!1,showInEmergencyInfo:n.note.showInEmergencyInfo??d(n.note.priority)}:c.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),Ye(()=>c.value.priority,(I,T)=>{!h.value&&I!==T&&(d(I)?c.value.showInEmergencyInfo=!0:d(T)&&(c.value.showInEmergencyInfo=!1))});const _=()=>{a("update:isDirty",!0)},x=()=>{a("close")},D=()=>{y.value||(l.value=f[m.value+1].value)},M=I=>{i.value=I,o.value=!0},S=()=>{if(!c.value.title||!c.value.title.trim()){M("Please enter a note title");return}if(!c.value.scopeConfigurations||c.value.scopeConfigurations.length===0){M("Please select at least one visibility scope");return}if(!c.value.scopeConfigurations.some(B=>!(B.itemType!==null&&(!B.ids||B.ids.length===0)))){M("Please configure at least one scope with valid selections");return}const T={title:c.value.title.trim(),content:c.value.content||"",scopeConfigurations:c.value.scopeConfigurations,displayOrder:c.value.displayOrder||0,priority:c.value.priority||"Normal",category:c.value.category?.trim()||null,isPinned:c.value.isPinned||!1,showInEmergencyInfo:c.value.showInEmergencyInfo};a("save",T)},w=()=>{a("delete",n.note.noteId)};return(I,T)=>(p(),g(Ie,null,[Pe(Zt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{"tab-header":Ve(()=>[Pe(dl,{modelValue:l.value,"onUpdate:modelValue":T[0]||(T[0]=B=>l.value=B),tabs:f},null,8,["modelValue"])]),footer:Ve(()=>[r("div",x7,[r("div",$7,[h.value?(p(),g("button",{key:0,type:"button",onClick:w,class:"btn btn-danger"}," Delete ")):P("",!0),!h.value&&!y.value?(p(),g("button",{key:1,type:"button",onClick:D,class:"btn btn-secondary mobile-only"},b(k.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:S,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(S,["prevent"]),class:"note-form"},[We(r("div",v7,[r("div",m7,[T[10]||(T[10]=r("label",{for:"title"},"Title: *",-1)),We(r("input",{id:"title","onUpdate:modelValue":T[1]||(T[1]=B=>c.value.title=B),type:"text",onInput:_,required:"",placeholder:"Enter note title..."},null,544),[[at,c.value.title]])]),r("div",g7,[T[11]||(T[11]=r("label",{for:"content"},"Content:",-1)),We(r("textarea",{id:"content","onUpdate:modelValue":T[2]||(T[2]=B=>c.value.content=B),onInput:_,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[at,c.value.content]])]),r("div",y7,[r("div",k7,[T[14]||(T[14]=r("label",{for:"priority"},"Priority:",-1)),We(r("select",{id:"priority","onUpdate:modelValue":T[3]||(T[3]=B=>c.value.priority=B),onChange:_},[...T[12]||(T[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[Qn,c.value.priority]]),r("label",b7,[We(r("input",{type:"checkbox","onUpdate:modelValue":T[4]||(T[4]=B=>c.value.showInEmergencyInfo=B),onChange:_},null,544),[[Ma,c.value.showInEmergencyInfo]]),T[13]||(T[13]=r("span",null,"Show in emergency info",-1))])]),r("div",w7,[T[15]||(T[15]=r("label",{for:"category"},"Category:",-1)),We(r("input",{id:"category","onUpdate:modelValue":T[5]||(T[5]=B=>c.value.category=B),type:"text",onInput:_,placeholder:"e.g., Safety, Logistics..."},null,544),[[at,c.value.category]])])]),r("div",_7,[r("div",C7,[T[16]||(T[16]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":T[6]||(T[6]=B=>c.value.displayOrder=B),type:"number",onInput:_,min:"0"},null,544),[[at,c.value.displayOrder,void 0,{number:!0}]]),T[17]||(T[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",L7,[r("label",S7,[We(r("input",{type:"checkbox","onUpdate:modelValue":T[7]||(T[7]=B=>c.value.isPinned=B),onChange:_},null,544),[[Ma,c.value.isPinned]]),T[18]||(T[18]=r("span",null,"Pin to top",-1))]),T[19]||(T[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[oa,l.value==="details"]]),We(r("div",I7,[Pe(id,{modelValue:c.value.scopeConfigurations,"onUpdate:modelValue":T[8]||(T[8]=B=>c.value.scopeConfigurations=B),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:_},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[oa,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:o.value,title:"Validation error",message:i.value,onClose:T[9]||(T[9]=B=>o.value=!1)},null,8,["show","message"])],64))}},M7=Ke(T7,[["__scopeId","data-v-e8488047"]]),A7={class:"incident-detail-header"},E7={class:"header-title-row"},P7={class:"modal-title"},D7={class:"header-badges"},R7=["disabled"],O7={key:0,class:"status-dropdown-menu"},B7=["onClick","disabled"],N7={key:0,class:"incident-detail-content"},F7={class:"accordion-section"},U7={class:"accordion-arrow"},z7={key:0,class:"accordion-content"},H7={class:"description-text"},V7={class:"accordion-section"},G7={class:"accordion-arrow"},q7={key:0,class:"accordion-content"},j7={class:"info-grid"},W7={class:"info-item"},Z7={class:"info-value"},K7={class:"info-item"},Y7={class:"info-value"},J7={key:0,class:"info-item"},X7={class:"info-label"},Q7={class:"info-value"},eU={key:1,class:"info-item"},tU={class:"info-label"},nU={class:"info-value"},oU={key:2,class:"info-item"},aU={class:"info-value"},sU={key:0,class:"incident-map-container"},iU={class:"accordion-section"},lU={class:"accordion-preview"},rU={class:"accordion-arrow"},cU={key:0,class:"accordion-content"},uU={class:"reporter-info"},dU={class:"reporter-name"},hU={key:0,class:"accordion-section"},fU={class:"accordion-title"},pU={class:"accordion-preview"},vU={class:"accordion-arrow"},mU={key:0,class:"accordion-content"},gU={class:"marshals-list"},yU={class:"marshal-name"},kU={key:0,class:"checkin-badge success"},bU={key:1,class:"checkin-badge not-checked-in"},wU={class:"accordion-section"},_U={key:0,class:"accordion-preview"},CU={class:"accordion-arrow"},LU={key:0,class:"accordion-content"},SU={key:0,class:"notes-timeline"},IU={class:"note-header"},xU={class:"note-author"},$U={class:"note-time"},TU={key:0,class:"note-status-change"},MU={key:1,class:"note-text"},AU={key:1,class:"no-notes"},EU={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:n,termsSentence:a}=ht(),o=e,i=t,l=A(!1),c=A(!1),d=A(null),h=A({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ye(()=>o.show,z=>{z&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},c.value=!1)});const f=z=>{d.value&&!d.value.contains(z.target)&&(c.value=!1)};Ye(c,z=>{z?document.addEventListener("click",f):document.removeEventListener("click",f)});const m=()=>{c.value=!c.value},y=z=>{o.incident?.status!==z&&(c.value=!1,$(z))},k=z=>{const O=h.value[z];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),O||(h.value[z]=!0)},_=H(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),x=H(()=>_.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),D=H(()=>_.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),M=H(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const z=o.incident.description||"";return z.length<=50?z:z.substring(0,47)+"..."}),S=H(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((O,j)=>(O.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),w=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],I=z=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[z]||z,T=z=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[z]||z,B=z=>{if(!z)return"";let O=z.name||"";if(z.description){const j=z.description,Z=40,J=j.length>Z?j.substring(0,Z-3)+"...":j;O+=` - ${J}`}return O},E=z=>z?new Date(z).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=z=>{if(!z)return"";const O=new Date(z),Z=new Date-O,J=Math.floor(Z/6e4),re=Math.floor(Z/36e5),K=Math.floor(Z/864e5);return J<1?"just now":J<60?`${J}m ago`:re<24?`${re}h ago`:K<7?`${K}d ago`:O.toLocaleDateString()},$=async z=>{if(o.incident?.status!==z){l.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:z})}finally{l.value=!1}}};return(z,O)=>(p(),qe(Zt,{show:e.show,title:M.value,size:"large",onClose:O[7]||(O[7]=j=>z.$emit("close"))},{header:Ve(()=>[r("div",A7,[r("div",E7,[r("span",{class:le(["severity-indicator",e.incident?.severity])},null,2),r("h2",P7,b(M.value),1)]),r("div",D7,[r("span",{class:le(["severity-badge",e.incident?.severity])},b(I(e.incident?.severity)),3),e.canManage?(p(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:le(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:m,disabled:l.value},[Je(b(T(e.incident?.status))+" ",1),O[8]||(O[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,R7),c.value?(p(),g("div",O7,[(p(),g(Ie,null,je(w,j=>r("button",{key:j.value,type:"button",class:le(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Z=>y(j.value),disabled:e.incident?.status===j.value},[r("span",{class:le(["status-dot",j.value])},null,2),Je(" "+b(j.label),1)],10,B7)),64))])):P("",!0)],512)):(p(),g("span",{key:1,class:le(["status-badge",e.incident?.status])},b(T(e.incident?.status)),3))])])]),footer:Ve(()=>[r("button",{class:"btn btn-secondary",onClick:O[6]||(O[6]=j=>z.$emit("close"))},"Close")]),default:Ve(()=>[e.incident?(p(),g("div",N7,[r("div",F7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.description}]),onClick:O[0]||(O[0]=j=>k("description"))},[O[9]||(O[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",U7,b(h.value.description?"":""),1)],2),h.value.description?(p(),g("div",z7,[r("p",H7,b(e.incident.description),1)])):P("",!0)]),r("div",V7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.timeLocation}]),onClick:O[1]||(O[1]=j=>k("timeLocation"))},[O[10]||(O[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",G7,b(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(p(),g("div",q7,[r("div",j7,[r("div",W7,[O[11]||(O[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",Z7,b(E(e.incident.incidentTime)),1)]),r("div",K7,[O[12]||(O[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",Y7,b(E(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(p(),g("div",J7,[r("span",X7,b(F(a).checkpoint),1),r("span",Q7,b(B(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(p(),g("div",eU,[r("span",tU,b(F(a).area),1),r("span",nU,b(e.incident.area.areaName),1)])):P("",!0),_.value?(p(),g("div",oU,[O[13]||(O[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",aU,b(e.incident.latitude.toFixed(6))+", "+b(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),_.value?(p(),g("div",sU,[Pe(il,{locations:e.checkpoints,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:x.value,zoom:15,"user-location":D.value,height:"200px"},null,8,["locations","route","route-color","route-style","route-weight","center","user-location"])])):P("",!0)])):P("",!0)]),r("div",iU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.reporter}]),onClick:O[2]||(O[2]=j=>k("reporter"))},[O[14]||(O[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",lU,b(e.incident.reportedBy?.name||"Unknown"),1),r("span",rU,b(h.value.reporter?"":""),1)],2),h.value.reporter?(p(),g("div",cU,[r("div",uU,[r("span",dU,b(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),S.value.length?(p(),g("div",hU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.marshals}]),onClick:O[3]||(O[3]=j=>k("marshals"))},[r("span",fU,b(F(n).peoplePlural)+" at "+b(F(n).checkpoint.toLowerCase()),1),r("span",pU,b(S.value.length),1),r("span",vU,b(h.value.marshals?"":""),1)],2),h.value.marshals?(p(),g("div",mU,[r("div",gU,[(p(!0),g(Ie,null,je(S.value,j=>(p(),g("div",{key:j.marshalId,class:le(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",yU,b(j.name),1),j.wasCheckedIn?(p(),g("span",kU," Checked in "+b(N(j.checkInTime)),1)):(p(),g("span",bU," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),r("div",wU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.notes}]),onClick:O[4]||(O[4]=j=>k("notes"))},[O[15]||(O[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(p(),g("span",_U,b(e.incident.updates.length),1)):P("",!0),r("span",CU,b(h.value.notes?"":""),1)],2),h.value.notes?(p(),g("div",LU,[e.incident.updates?.length?(p(),g("div",SU,[(p(!0),g(Ie,null,je(e.incident.updates,(j,Z)=>(p(),g("div",{key:Z,class:"note-item"},[r("div",IU,[r("span",xU,b(j.authorName||"System"),1),r("span",$U,b(N(j.timestamp)),1)]),j.statusChange?(p(),g("div",TU,[O[16]||(O[16]=Je(" Status changed to ",-1)),r("span",{class:le(["status-badge",j.statusChange])},b(T(j.statusChange)),3)])):j.note?(p(),g("p",MU,b(j.note),1)):P("",!0)]))),128))])):(p(),g("div",AU," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:O[5]||(O[5]=j=>z.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},_1=Ke(EU,[["__scopeId","data-v-cc8f343d"]]),PU={class:"form-group"},DU={class:"form-group"},RU={class:"form-row"},OU={class:"form-group form-group-half"},BU=["value"],NU={class:"form-group form-group-half"},FU={key:0,class:"form-group"},UU={for:"checkpoint",class:"form-label"},zU=["value"],HU={key:1,class:"form-group"},VU={class:"form-label"},GU={class:"checkpoint-toggle"},qU={class:"checkbox-label"},jU={class:"checkpoint-name"},WU={key:0,class:"checkpoint-description"},ZU={class:"form-group"},KU={class:"location-options"},YU={class:"location-buttons"},JU={key:0,class:"location-status"},XU={key:0,class:"location-getting"},QU={key:1,class:"location-display"},ez={key:0,class:"location-accuracy"},tz={key:2,class:"location-error"},nz={key:1,class:"map-picker-container"},oz={key:0,class:"map-picker-hint"},az={key:2,class:"location-display"},sz={key:2,class:"error-message"},iz={class:"modal-actions"},lz=["disabled"],rz={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:n}=ht(),a=e,o=t,i=A({title:"",description:"",severity:"medium",incidentTime:""}),l=A(""),c=A(!0),d=A("none"),h=A(!1),f=A(null),m=A(null),y=A(null),k=A(!1),_=A(!1),x=A(null),D=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],M=()=>{const j=new Date,Z=j.getFullYear(),J=String(j.getMonth()+1).padStart(2,"0"),re=String(j.getDate()).padStart(2,"0"),K=String(j.getHours()).padStart(2,"0"),ie=String(j.getMinutes()).padStart(2,"0");return`${Z}-${J}-${re}T${K}:${ie}`},S=j=>j?new Date(j).toISOString():null,w=H(()=>a.checkpoints||[]),I=H(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=w.value.find(Z=>Z.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(w.value.length>0){const j=w.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.route?.length>0){const j=a.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),T=H(()=>i.value.description.trim()!==""),B=H(()=>i.value.description.trim()!=="");Ye(()=>a.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:M()},l.value="",c.value=!0,_.value=!1,x.value=null,y.value=null,f.value=null,m.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),a.checkpoint&&(l.value=a.checkpoint.locationId||a.checkpoint.id||""))});const E=j=>{y.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,m.value=null):j==="gps"?(d.value="gps",h.value=!1,$()):(d.value="none",h.value=!1,f.value=null,m.value=null)},N=j=>{f.value={latitude:j.lat,longitude:j.lng},m.value=null,h.value=!1},$=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},m.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},z=async()=>{if(!(!B.value||_.value)){_.value=!0,x.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let Z=null,J=!1;w.value.length>0?l.value?Z=l.value:J=!0:a.checkpoint&&(c.value?Z=a.checkpoint.locationId||a.checkpoint.id||null:J=!0);const re={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:S(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:Z,skipCheckpointAutoAssign:J};o("submit",re)}catch(j){x.value=j.message||"Failed to report incident. Please try again.",_.value=!1}}},O=()=>{o("close")};return(j,Z)=>(p(),qe(Zt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":T.value,onClose:O},{footer:Ve(()=>[r("div",iz,[r("button",{type:"button",class:"btn btn-secondary",onClick:O}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:z,disabled:!B.value||_.value},b(_.value?"Reporting...":"Report Incident"),9,lz)])]),default:Ve(()=>[r("form",{onSubmit:ct(z,["prevent"]),class:"incident-form"},[r("div",PU,[Z[10]||(Z[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),We(r("input",{id:"title","onUpdate:modelValue":Z[0]||(Z[0]=J=>i.value.title=J),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[at,i.value.title]])]),r("div",DU,[Z[11]||(Z[11]=r("label",{for:"description",class:"form-label"},[Je("Description "),r("span",{class:"required"},"*")],-1)),We(r("textarea",{id:"description","onUpdate:modelValue":Z[1]||(Z[1]=J=>i.value.description=J),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[at,i.value.description]])]),r("div",RU,[r("div",OU,[Z[12]||(Z[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),We(r("select",{id:"severity","onUpdate:modelValue":Z[2]||(Z[2]=J=>i.value.severity=J),class:"form-input form-select"},[(p(),g(Ie,null,je(D,J=>r("option",{key:J.value,value:J.value},b(J.label),9,BU)),64))],512),[[Qn,i.value.severity]])]),r("div",NU,[Z[13]||(Z[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),We(r("input",{id:"incidentTime","onUpdate:modelValue":Z[3]||(Z[3]=J=>i.value.incidentTime=J),type:"datetime-local",class:"form-input"},null,512),[[at,i.value.incidentTime]])])]),w.value.length>0?(p(),g("div",FU,[r("label",UU,b(F(n).checkpoint),1),We(r("select",{id:"checkpoint","onUpdate:modelValue":Z[4]||(Z[4]=J=>l.value=J),class:"form-input form-select"},[Z[14]||(Z[14]=r("option",{value:""},"-- None / Unknown --",-1)),(p(!0),g(Ie,null,je(w.value,J=>(p(),g("option",{key:J.id,value:J.id},b(J.name)+b(J.description?` - ${J.description}`:""),9,zU))),128))],512),[[Qn,l.value]])])):e.checkpoint?(p(),g("div",HU,[r("label",VU,b(F(n).checkpoint),1),r("div",GU,[r("label",qU,[We(r("input",{type:"checkbox","onUpdate:modelValue":Z[5]||(Z[5]=J=>c.value=J)},null,512),[[Ma,c.value]]),r("span",jU,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",WU," - "+b(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),r("div",ZU,[Z[15]||(Z[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",KU,[r("div",YU,[r("button",{type:"button",class:le(["location-btn",{active:d.value==="gps"}]),onClick:Z[6]||(Z[6]=J=>E("gps"))}," GPS ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="map"}]),onClick:Z[7]||(Z[7]=J=>E("map"))}," Pick on map ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="none"}]),onClick:Z[8]||(Z[8]=J=>E("none"))}," None ",2)]),d.value==="gps"?(p(),g("div",JU,[k.value?(p(),g("div",XU," Getting location... ")):f.value&&f.value.latitude!=null?(p(),g("div",QU,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),m.value?(p(),g("span",ez,"("+b(Math.round(m.value))+"m)",1)):P("",!0)])):y.value?(p(),g("div",tz,b(y.value),1)):P("",!0)])):P("",!0),d.value==="map"?(p(),g("div",nz,[h.value?(p(),g("div",oz,"Tap to select location")):P("",!0),h.value?(p(),qe(il,{key:1,locations:w.value,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:I.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:N},null,8,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id"])):P("",!0),f.value&&f.value.latitude!=null?(p(),g("div",az,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),h.value?P("",!0):(p(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:Z[9]||(Z[9]=J=>h.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),x.value?(p(),g("div",sz,b(x.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},C1=Ke(rz,[["__scopeId","data-v-8a211d20"]]),cz={class:"tab-content"},uz={key:0,class:"form-group"},dz={for:"marshalId"},hz=["value"],fz={class:"help-text"},pz={key:1,class:"form-group"},vz={class:"linked-marshal-info"},mz={class:"linked-marshal-name"},gz={class:"linked-marshal-hint"},yz={key:2,class:"form-group"},kz={class:"form-group"},bz={key:0,class:"selected-roles"},wz=["onClick"],_z={class:"role-input-group"},Cz=["value"],Lz={class:"checkbox-label-inline show-emergency-checkbox"},Sz={class:"form-row"},Iz={class:"form-group"},xz={class:"form-group"},$z={class:"form-group"},Tz={class:"form-row"},Mz={class:"form-group"},Az={class:"form-group checkbox-group-inline"},Ez={class:"checkbox-label-inline"},Pz={class:"tab-content"},Dz={class:"custom-footer"},Rz={class:"footer-left"},Oz=["disabled"],Bz={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A("details"),d=A(""),h=A({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=H(()=>[...a.roleDefinitions].sort((J,re)=>J.isBuiltIn!==re.isBuiltIn?J.isBuiltIn?-1:1:J.displayOrder!==re.displayOrder?(J.displayOrder||0)-(re.displayOrder||0):(J.name||"").localeCompare(re.name||"",void 0,{numeric:!0,sensitivity:"base"}))),m=H(()=>{const J=h.value.roles||[];return f.value.filter(re=>!J.includes(re.roleId))}),y=J=>a.roleDefinitions.find(K=>K.roleId===J)?.name||J,k=J=>a.roleDefinitions.find(K=>K.roleId===J)?.name==="EmergencyContact",_=()=>{d.value&&!h.value.roles.includes(d.value)&&(h.value.roles.push(d.value),k(d.value)&&(h.value.showInEmergencyInfo=!0),E()),d.value=""},x=J=>{const re=h.value.roles.indexOf(J);re>-1&&(h.value.roles.splice(re,1),k(J)&&!h.value.roles.some(K=>k(K))&&(h.value.showInEmergencyInfo=!1),E())},D=H(()=>!!a.contact),M=H(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),S=H(()=>!!h.value.marshalId),w=H(()=>!D.value&&!!a.prefilledMarshalId),I=H(()=>D.value&&!!a.contact?.marshalId),T=H(()=>a.contact?.marshalId?a.marshals.find(re=>re.id===a.contact.marshalId)?.name||"Unknown":""),B=H(()=>[...a.marshals].sort((J,re)=>ea(J.name,re.name)));Ye(()=>a.show,J=>{if(J){if(c.value=a.initialTab,d.value="",a.contact){let re=[];a.contact.roles&&Array.isArray(a.contact.roles)&&(re=[...a.contact.roles]),h.value={roles:re,name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??re.some(K=>k(K)),displayOrder:a.contact.displayOrder||0,isPinned:a.contact.isPinned||!1,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{let re;a.createFromAreaContext?re=[]:a.preselectedArea?re=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:re=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let K={name:a.prefilledName||"",phone:"",email:"",roles:[]};if(a.prefilledMarshalId){const ie=a.marshals.find(U=>U.id===a.prefilledMarshalId);ie&&(K={name:ie.name||"",phone:ie.phoneNumber||"",email:ie.email||"",roles:ie.roles||[]})}h.value={roles:[...K.roles],name:K.name,phone:K.phone,email:K.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:K.roles.some(ie=>k(ie)),displayOrder:0,isPinned:!1,scopeConfigurations:re}}o("update:isDirty",!1)}});const E=()=>{o("update:isDirty",!0)},N=()=>{if(h.value.marshalId){const J=a.marshals.find(re=>re.id===h.value.marshalId);J&&(h.value.name=J.name,!h.value.phone&&J.phoneNumber&&(h.value.phone=J.phoneNumber),!h.value.email&&J.email&&(h.value.email=J.email),h.value.roles=J.roles?[...J.roles]:[],h.value.showInEmergencyInfo=h.value.roles.some(re=>k(re)))}else h.value.name="";E()},$=()=>{o("close")},z=()=>{if(!h.value.roles||h.value.roles.length===0){O("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){O("Please enter a contact name");return}c.value="visibility"},O=J=>{l.value=J,i.value=!0},j=()=>{if(!h.value.roles||h.value.roles.length===0){O("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){O("Please enter a contact name");return}if(!a.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){O("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(K=>!(K.itemType!==null&&(!K.ids||K.ids.length===0)))){O("Please configure at least one scope with valid selections");return}}const J={roles:h.value.roles,name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};o("save",J)},Z=()=>{o("delete",a.contact.contactId)};return(J,re)=>(p(),g(Ie,null,[Pe(Zt,{show:e.show,title:D.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:$},{"tab-header":Ve(()=>[Pe(dl,{modelValue:c.value,"onUpdate:modelValue":re[0]||(re[0]=K=>c.value=K),tabs:M.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",Dz,[r("div",Rz,[D.value?(p(),g("button",{key:0,type:"button",onClick:Z,class:"btn btn-danger"}," Delete ")):P("",!0),!D.value&&c.value==="details"?(p(),g("button",{key:1,type:"button",onClick:z,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),r("button",{type:"button",onClick:j,class:"btn btn-success",disabled:D.value&&!e.isDirty}," Save ",8,Oz)])]),default:Ve(()=>[r("form",{onSubmit:ct(j,["prevent"]),class:"contact-form"},[We(r("div",cz,[!w.value&&!I.value?(p(),g("div",uz,[r("label",dz,"Link to "+b(F(n).person.toLowerCase())+":",1),We(r("select",{id:"marshalId","onUpdate:modelValue":re[1]||(re[1]=K=>h.value.marshalId=K),onChange:N},[re[12]||(re[12]=r("option",{value:null},"-- Not linked --",-1)),(p(!0),g(Ie,null,je(B.value,K=>(p(),g("option",{key:K.id,value:K.id},b(K.name),9,hz))),128))],544),[[Qn,h.value.marshalId]]),r("span",fz,"Optionally link to an existing "+b(F(n).person.toLowerCase())+" in the system",1)])):P("",!0),I.value?(p(),g("div",pz,[r("label",null,"Linked "+b(F(n).person.toLowerCase())+":",1),r("div",vz,[r("span",mz,b(T.value),1),r("span",gz,"Contact details are synced with this "+b(F(n).person.toLowerCase()),1)])])):P("",!0),S.value?P("",!0):(p(),g("div",yz,[re[13]||(re[13]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":re[2]||(re[2]=K=>h.value.name=K),type:"text",onInput:E,placeholder:"Contact name..."},null,544),[[at,h.value.name]])])),r("div",kz,[re[16]||(re[16]=r("label",null,"Roles: *",-1)),h.value.roles.length>0?(p(),g("div",bz,[(p(!0),g(Ie,null,je(h.value.roles,K=>(p(),g("span",{key:K,class:"role-pill"},[Je(b(y(K))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:ie=>x(K),title:"Remove role"},"",8,wz)]))),128))])):P("",!0),r("div",_z,[We(r("select",{id:"role","onUpdate:modelValue":re[3]||(re[3]=K=>d.value=K),onChange:_},[re[14]||(re[14]=r("option",{value:"",disabled:""},"Add a role...",-1)),(p(!0),g(Ie,null,je(m.value,K=>(p(),g("option",{key:K.roleId,value:K.roleId},b(K.name),9,Cz))),128))],544),[[Qn,d.value]])]),r("label",Lz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[4]||(re[4]=K=>h.value.showInEmergencyInfo=K),onChange:E},null,544),[[Ma,h.value.showInEmergencyInfo]]),re[15]||(re[15]=r("span",null,"Show in emergency info",-1))])]),r("div",Sz,[r("div",Iz,[re[17]||(re[17]=r("label",{for:"phone"},"Phone:",-1)),We(r("input",{id:"phone","onUpdate:modelValue":re[5]||(re[5]=K=>h.value.phone=K),type:"tel",onInput:E,placeholder:"Phone number..."},null,544),[[at,h.value.phone]])]),r("div",xz,[re[18]||(re[18]=r("label",{for:"email"},"Email:",-1)),We(r("input",{id:"email","onUpdate:modelValue":re[6]||(re[6]=K=>h.value.email=K),type:"email",onInput:E,placeholder:"Email address..."},null,544),[[at,h.value.email]])])]),r("div",$z,[re[19]||(re[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":re[7]||(re[7]=K=>h.value.notes=K),onInput:E,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[at,h.value.notes]])]),r("div",Tz,[r("div",Mz,[re[20]||(re[20]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":re[8]||(re[8]=K=>h.value.displayOrder=K),type:"number",onInput:E,min:"0"},null,544),[[at,h.value.displayOrder,void 0,{number:!0}]]),re[21]||(re[21]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",Az,[r("label",Ez,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[9]||(re[9]=K=>h.value.isPinned=K),onChange:E},null,544),[[Ma,h.value.isPinned]]),re[22]||(re[22]=r("span",null,"Pin to top",-1))]),re[23]||(re[23]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[oa,c.value==="details"]]),We(r("div",Pz,[Pe(id,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":re[10]||(re[10]=K=>h.value.scopeConfigurations=K),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":D.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:E},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[oa,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:i.value,title:"Validation error",message:l.value,onClose:re[11]||(re[11]=K=>i.value=!1)},null,8,["show","message"])],64))}},Nz=Ke(Bz,[["__scopeId","data-v-300a990f"]]),Fz={class:"tab-content"},Uz={class:"form-group"},zz={class:"form-group"},Hz={class:"form-group checkbox-group"},Vz={class:"checkbox-label"},Gz={class:"checkbox-text"},qz={class:"help-text"},jz={class:"tab-content"},Wz={key:0,class:"loading-state"},Zz={key:1,class:"empty-state"},Kz={key:2,class:"people-list"},Yz={class:"search-row"},Jz={class:"people-items"},Xz=["checked","onChange"],Qz={class:"person-name"},eH={class:"person-type-badge marshal"},tH={key:0,class:"empty-search"},nH={class:"custom-footer"},oH={class:"footer-left"},aH={__name:"EditRoleDefinitionModal",props:{show:{type:Boolean,default:!1},role:{type:Object,default:null},initialTab:{type:String,default:"details"},people:{type:Array,default:()=>[]},loadingPeople:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty","load-people"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=A(!1),l=A(""),c=A(""),d=A(new Map),h=A([]),f=A({marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set}),m=[{value:"details",label:"Details"},{value:"assignments",label:"Assignments"}],y=A(a.initialTab),k=A({name:"",notes:"",canManageAreaCheckpoints:!1}),_=H(()=>!!a.role?.roleId);Ye(()=>[a.show,a.role],([$,z])=>{$&&(y.value=a.initialTab,c.value="",d.value=new Map,h.value=[],f.value={marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set},z?k.value={name:z.name||"",notes:z.notes||"",canManageAreaCheckpoints:z.canManageAreaCheckpoints||!1}:k.value={name:"",notes:"",canManageAreaCheckpoints:!1},o("update:isDirty",!1))},{immediate:!0}),Ye(y,$=>{$==="assignments"&&_.value&&a.people.length===0&&o("load-people",a.role.roleId)}),Ye(()=>a.people,$=>{if($.length>0&&(h.value=$.map(z=>({...z})),d.value.size===0)){const z=new Map;for(const O of $)z.set(O.id,O.hasRole);d.value=z}},{immediate:!0});const x=()=>{o("update:isDirty",!0)},D=$=>$==="Linked"?"Linked":$==="Marshal"?n.value.person:$==="Contact"?"Contact":$,M=H(()=>{let $=[...h.value];if(c.value.trim()){const z=c.value.toLowerCase();$=$.filter(O=>O.name.toLowerCase().includes(z))}return $.sort((z,O)=>{const j=d.value.get(z.id)??!1,Z=d.value.get(O.id)??!1;return j!==Z?j?-1:1:z.name.localeCompare(O.name,void 0,{sensitivity:"base"})})}),S=H(()=>h.value.length>0&&h.value.every($=>$.hasRole));H(()=>f.value.marshalIdsToAdd.size>0||f.value.marshalIdsToRemove.size>0||f.value.contactIdsToAdd.size>0||f.value.contactIdsToRemove.size>0);const w=()=>{const $=!S.value;for(const z of h.value)z.hasRole!==$&&I(z,$)},I=($,z)=>{const O=h.value.find(j=>j.id===$.id);O&&(O.hasRole=z),$.personType==="Marshal"||$.personType==="Linked"?z?f.value.marshalIdsToRemove.has($.marshalId)?f.value.marshalIdsToRemove.delete($.marshalId):f.value.marshalIdsToAdd.add($.marshalId):f.value.marshalIdsToAdd.has($.marshalId)?f.value.marshalIdsToAdd.delete($.marshalId):f.value.marshalIdsToRemove.add($.marshalId):$.personType==="Contact"&&(z?f.value.contactIdsToRemove.has($.contactId)?f.value.contactIdsToRemove.delete($.contactId):f.value.contactIdsToAdd.add($.contactId):f.value.contactIdsToAdd.has($.contactId)?f.value.contactIdsToAdd.delete($.contactId):f.value.contactIdsToRemove.add($.contactId)),o("update:isDirty",!0)},T=$=>{I($,!$.hasRole)},B=()=>{if(!k.value.name.trim()){l.value="Role name is required.",i.value=!0;return}o("save",{name:k.value.name.trim(),notes:k.value.notes.trim(),canManageAreaCheckpoints:k.value.canManageAreaCheckpoints,assignmentChanges:{marshalIdsToAdd:Array.from(f.value.marshalIdsToAdd),marshalIdsToRemove:Array.from(f.value.marshalIdsToRemove),contactIdsToAdd:Array.from(f.value.contactIdsToAdd),contactIdsToRemove:Array.from(f.value.contactIdsToRemove)}})},E=()=>{o("delete",a.role.roleId)},N=()=>{o("close")};return($,z)=>(p(),g(Ie,null,[Pe(Zt,{show:e.show,title:_.value?"Edit role":"Create role",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:N},{"tab-header":Ve(()=>[Pe(dl,{modelValue:y.value,"onUpdate:modelValue":z[0]||(z[0]=O=>y.value=O),tabs:m},null,8,["modelValue"])]),footer:Ve(()=>[r("div",nH,[r("div",oH,[_.value?(p(),g("button",{key:0,type:"button",onClick:E,class:"btn btn-danger",title:"Delete this role"}," Delete ")):P("",!0)]),r("button",{type:"button",onClick:B,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:ct(B,["prevent"]),class:"role-form"},[We(r("div",Fz,[r("div",Uz,[z[6]||(z[6]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":z[1]||(z[1]=O=>k.value.name=O),type:"text",onInput:x,required:"",placeholder:"Enter role name..."},null,544),[[at,k.value.name]])]),r("div",zz,[z[7]||(z[7]=r("label",{for:"notes"},"Notes:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":z[2]||(z[2]=O=>k.value.notes=O),onInput:x,rows:"6",placeholder:"Enter role description or notes..."},null,544),[[at,k.value.notes]]),z[8]||(z[8]=r("span",{class:"help-text"},"Describe what this role is responsible for",-1))]),r("div",Hz,[r("label",Vz,[We(r("input",{type:"checkbox","onUpdate:modelValue":z[3]||(z[3]=O=>k.value.canManageAreaCheckpoints=O),onChange:x},null,544),[[Ma,k.value.canManageAreaCheckpoints]]),r("span",Gz,"Is "+b(F(n).area.toLowerCase())+" lead",1)]),r("span",qz,"When enabled, "+b(F(n).people.toLowerCase())+" with this role can view all other "+b(F(n).checkpoints.toLowerCase())+" and "+b(F(n).people.toLowerCase())+" in their "+b(F(n).area.toLowerCase())+".",1)])],512),[[oa,y.value==="details"]]),We(r("div",jz,[z[11]||(z[11]=r("div",{class:"assignments-header"},[r("h4",null,"Who has this role?"),r("p",{class:"help-text"},"Select the people who should have this role assigned.")],-1)),e.loadingPeople?(p(),g("div",Wz," Loading people... ")):e.people.length===0?(p(),g("div",Zz,[...z[9]||(z[9]=[r("p",null,"No marshals or contacts to assign.",-1)])])):(p(),g("div",Kz,[r("div",Yz,[We(r("input",{"onUpdate:modelValue":z[4]||(z[4]=O=>c.value=O),type:"text",class:"search-input",placeholder:"Search by name..."},null,512),[[at,c.value]]),r("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:w},b(S.value?"Deselect all":"Select all"),1)]),r("div",Jz,[(p(!0),g(Ie,null,je(M.value,O=>(p(),g("label",{key:O.id,class:le(["person-item",{checked:O.hasRole}])},[r("input",{type:"checkbox",checked:O.hasRole,onChange:j=>T(O)},null,40,Xz),r("span",Qz,b(O.name),1),O.personType==="Linked"?(p(),g(Ie,{key:0},[r("span",eH,b(F(n).person),1),z[10]||(z[10]=r("span",{class:"person-type-badge contact"},"Contact",-1))],64)):(p(),g("span",{key:1,class:le(["person-type-badge",O.personType.toLowerCase()])},b(D(O.personType)),3))],2))),128))]),M.value.length===0?(p(),g("div",tH," No people match your search. ")):P("",!0)]))],512),[[oa,y.value==="assignments"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(wc,{show:i.value,title:"Validation error",message:l.value,onClose:z[5]||(z[5]=O=>i.value=!1)},null,8,["show","message"])],64))}},sH=Ke(aH,[["__scopeId","data-v-4a0e6d84"]]),iH={key:0,class:"fullscreen-map-overlay"},lH={class:"fullscreen-map-header"},rH={class:"context-info"},cH={key:0},uH={class:"action-buttons"},dH=["disabled"],hH={class:"fullscreen-map-container"},fH={key:0,class:"drawing-controls"},pH={class:"point-count"},vH={class:"undo-redo-buttons"},mH=["disabled"],gH=["disabled"],yH=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const n=e,a=t,o=A(null),i=A(0),l=A(!1),c=A(!1),d=()=>{a("done")},h=()=>{a("cancel")},f=x=>{i.value=x?.length||0,m(),a("polygon-drawing",x)},m=()=>{o.value&&(l.value=o.value.canUndo(),c.value=o.value.canRedo())},y=()=>{o.value&&(o.value.undoPolygonPoint(),m())},k=()=>{o.value&&(o.value.redoPolygonPoint(),m())};Ye(()=>n.show,x=>{x||(i.value=0,l.value=!1,c.value=!1)});const _=x=>{x.key==="Escape"&&n.show&&h(),n.show&&n.drawingMode&&((x.ctrlKey||x.metaKey)&&x.key==="z"&&!x.shiftKey?(x.preventDefault(),y()):(x.ctrlKey||x.metaKey)&&(x.key==="y"||x.key==="z"&&x.shiftKey)&&(x.preventDefault(),k()))};return un(()=>{document.addEventListener("keydown",_)}),Ln(()=>{document.removeEventListener("keydown",_)}),(x,D)=>(p(),qe(ec,{to:"body"},[e.show?(p(),g("div",iH,[r("div",lH,[r("div",rH,[r("h3",null,b(e.contextTitle),1),e.contextDescription?(p(),g("p",cH,b(e.contextDescription),1)):P("",!0)]),r("div",uH,[e.mode==="view"?(p(),g("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(p(),g(Ie,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,dH)],64))])]),r("div",hH,[Pe(Jh,Ug({ref_key:"mapViewRef",ref:o,"drawing-mode":e.drawingMode},x.$attrs,{onMapClick:D[0]||(D[0]=M=>x.$emit("map-click",M)),onPolygonComplete:D[1]||(D[1]=M=>x.$emit("polygon-complete",M)),onPolygonDrawing:f,onLocationClick:D[2]||(D[2]=M=>x.$emit("location-click",M)),onAreaClick:D[3]||(D[3]=M=>x.$emit("area-click",M))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(p(),g("div",fH,[r("div",pH,b(i.value)+" point"+b(i.value!==1?"s":""),1),r("div",vH,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,mH),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!c.value,title:"Redo point"}," Redo  ",8,gH)])])):P("",!0)])])):P("",!0)]))}}),kH=Ke(yH,[["__scopeId","data-v-9ce62b55"]]),bH={class:"form-group"},wH={class:"form-group"},_H={class:"form-group"},CH={key:0,class:"form-error"},LH={class:"form-row"},SH={class:"form-group",style:{flex:"1"}},IH={class:"form-group",style:{flex:"1"}},xH={class:"form-group",style:{flex:"0 0 auto"}},$H={class:"form-group"},TH={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=A({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ye(()=>a.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{o("update:isDirty",!0),o("update:location",{...i.value})},c=()=>{if(!Lu(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}o("save",i.value)},d=()=>{o("close")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:`Add ${F(n).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add "+b(F(n).checkpoint),1)]),default:Ve(()=>[r("form",{onSubmit:ct(c,["prevent"])},[r("div",bH,[f[7]||(f[7]=r("label",null,"Name",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>i.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[at,i.value.name]])]),r("div",wH,[f[8]||(f[8]=r("label",null,"Description",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>i.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[at,i.value.description]])]),r("div",_H,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>i.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[at,i.value.what3Words]]),i.value.what3Words&&!F(Lu)(i.value.what3Words)?(p(),g("small",CH," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),r("div",LH,[r("div",SH,[f[10]||(f[10]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>i.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[at,i.value.longitude,void 0,{number:!0}]])]),r("div",IH,[f[11]||(f[11]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[at,i.value.latitude,void 0,{number:!0}]])]),r("div",xH,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>h.$emit("set-on-map"))},"  ")])]),r("div",$H,[r("label",null,"Required "+b(F(n).people),1),We(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>i.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[at,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},MH=Ke(TH,[["__scopeId","data-v-fb51fed0"]]),AH=["aria-expanded","title"],EH=["innerHTML"],PH={key:0,class:"dropdown-menu"},DH=["onClick"],RH=["innerHTML"],OH={__name:"ThemeToggle",setup(e){const{theme:t,isDark:n,setTheme:a}=Zy(),o=A(!1),i=A(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=H(()=>n.value?l.dark:l.light),h=()=>{o.value=!o.value},f=y=>{a(y),o.value=!1},m=y=>{i.value&&!i.value.contains(y.target)&&(o.value=!1)};return un(()=>{document.addEventListener("click",m)}),Ln(()=>{document.removeEventListener("click",m)}),(y,k)=>(p(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":o.value,title:F(n)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,EH)],8,AH),o.value?(p(),g("div",PH,[(p(),g(Ie,null,je(c,_=>r("button",{key:_.value,class:le(["dropdown-item",{active:F(t)===_.value}]),onClick:x=>f(_.value)},[r("span",{class:"option-icon",innerHTML:_.icon},null,8,RH),r("span",null,b(_.label),1)],10,DH)),64))])):P("",!0)],512))}},BH=Ke(OH,[["__scopeId","data-v-969124a4"]]),NH={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},FH=["id"],UH=["filter"],zH={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){F0(n=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=H(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(n,a)=>(p(),g("svg",NH,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,FH)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,UH),a[2]||(a[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:le({"marshal-figure":e.animate})},[...a[1]||(a[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},HH=Ke(zH,[["__scopeId","data-v-3e647831"]]),VH={class:"header"},GH={class:"header-left"},qH={key:0},jH={class:"event-date"},WH={class:"header-actions"},ZH={class:"container"},KH={class:"tabs-nav"},YH={class:"tab-content-wrapper"},JH={class:"add-note-form"},XH={class:"modal-footer-actions"},QH=["disabled"],eV=6e4,tV={__name:"AdminEventManage",setup(e){const t=Qu(),n=rr(),a=Gy(),o=H(()=>t.params.eventId),{activeTab:i,switchTab:l}=qy("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","roles","settings"]),{showConfirmModal:c,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:_}=i2(),{tabLabels:x,terms:D,termsLower:M}=ht(),S=l2(),w=c2(o),I=r2(o),{colorScheme:T}=Zy(),B=H(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:x.value.course,icon:"course"},{value:"areas",label:x.value.areas,icon:"area"},{value:"checkpoints",label:x.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:x.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:x.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"roles",label:"Roles",icon:"roles"},{value:"settings",label:"Settings",icon:"settings"}]),E=A(null),N=A([]),$=A([]),z=A({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0,roles:0}),O=A(null),j=A(!1),Z=A(!1),J=A(null),re=A(null),K=A(!1),ie=A(!1),U=A(null),X=A(""),ae=I.eventAdmins,he=I.showAddAdmin,$e=w.showUploadRoute,Ee=w.uploading,Me=w.uploadError,ze=w.showImportLocations,be=w.showImportMarshals,V=w.importing,Y=w.importingMarshals,de=w.importError,se=w.importResult,Re=w.importMarshalsResult,q=A(!1),Q=A(!1),ee=A({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),_e=A(!1),Be=A(!1),Ue=A({marshalName:"",locations:[],marshal:null}),Ae=A(null),ne=A([]),ge=A(!1),Oe=A(null),De=A(null),xe=A(null),me=A({}),Ze=A({id:"",name:"",email:"",phoneNumber:"",notes:""}),Ge=A(!1),fe=A([]),ke=A([]),te=A([]),ye=A([]),He=A(!1),rt=A(""),kt=A(""),Rt=A({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Lt=A(!1),xt=A(!1),Kt=A(""),no=A(""),Mo=A(0),ft=A({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ct=A([]),Mt=A(null),Mn=A(!1),go=A("details"),oo=A(null),An=A(null),tn=A(null),Pa=S.isAddingMultipleCheckpoints,yo=S.multiCheckpointCounter,Uo=S.isFullscreenMapActive,pe=S.fullscreenMode,ve=S.fullscreenContext,Le=S.tempLocationCoords,lt=S.tempCheckpoints,Qe=S.savedMapCenter,Ot=S.savedMapZoom,on=S.isDrawingAreaBoundary,mn=A(null),gn=A([]),Vn=A(null),Za=A(!1),ko=A("details"),hl=H(()=>!gn.value||gn.value.length===0?0:Math.max(...gn.value.map(oe=>oe.displayOrder||0))+1),fl=A(null),pl=A(null),vi=A(!1),zo=A([]),Ho=A(null),Ts=A(!1),Vo=A("details"),bo=A([]),mi=A(!1),En=A(null),Ao=A(!1),Ms=A(!1),Ka=A(!1),ao=A(""),aa=A(!1),so=A([]),sa=A({builtInRoles:[],customRoles:[]}),vt=A(null),Bt=A(!1),Pn=A([]),Sn=A(null),io=A(!1),ia=A("details"),dt=A([]),Yt=A(!1),Eo=A("details"),wo=A(null),bn=A(""),Go=A(null),qo=A(null),_o=H(()=>qo.value?.marshalId!=null),Jt=()=>{n.push(`/event/${t.params.eventId}`)},Gn=H(()=>`${window.location.origin}/#/event/${t.params.eventId}`),la=H(()=>{const G=[];return $.value.forEach(oe=>{oe.assignments&&G.push(...oe.assignments)}),G}),Ya=H(()=>{if(!Oe.value)return $.value;const G=Oe.value.assignedLocationIds||[],oe=te.value.map(we=>we.locationId),ce=ye.value;return $.value.filter(we=>!G.includes(we.id)&&!oe.includes(we.id)||ce.includes(we.id))}),As=H(()=>{let G=ne.value;if(O.value){const oe=O.value.assignments.map(we=>we.marshalName),ce=fe.value.map(we=>we.marshalName);G=ne.value.filter(we=>!oe.includes(we.name)&&!ce.includes(we.name))}return G.slice().sort((oe,ce)=>oe.name.localeCompare(ce.name))}),Ja=H(()=>pe.value==="draw-area"&&Mt.value?.polygon?.length>0||S.canCompleteFullscreen.value),Es=H(()=>pe.value==="move-checkpoint"&&O.value?.id?O.value.id:null),gi=H(()=>{const G=[...$.value];return pe.value==="place-checkpoint"&&Le.value&&G.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Le.value.lat,longitude:Le.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),pe.value==="move-checkpoint"&&Le.value&&O.value&&G.push({id:"temp-move",name:O.value.name+" (new position)",latitude:Le.value.lat,longitude:Le.value.lng,requiredMarshals:O.value.requiredMarshals,assignments:[],isTemporary:!0}),pe.value==="add-multiple"&&G.push(...lt.value),G}),ra=H(()=>{let G=[...Ct.value];return pe.value==="draw-area"&&Mt.value?.id&&(G=G.filter(oe=>oe.id!==Mt.value.id)),pe.value==="draw-area"&&Mt.value?.polygon?.length>0&&G.push({...Mt.value,id:Mt.value.id||"temp-area"}),G}),Ps=H(()=>{if(!Oe.value||!bo.value.length)return[];const G=Oe.value.id,oe=Oe.value.assignedLocationIds||[];return bo.value.filter(ce=>{if(ce.reportedBy?.marshalId===G)return!0;const we=ce.context?.checkpoint?.checkpointId;return!!(we&&oe.includes(we))}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),Xa=H(()=>{if(!O.value||!bo.value.length)return[];const G=O.value.id;return bo.value.filter(oe=>oe.context?.checkpoint?.checkpointId===G).sort((oe,ce)=>new Date(ce.incidentTime||ce.createdAt)-new Date(oe.incidentTime||oe.createdAt))}),Qa=H(()=>{if(!Mt.value||!bo.value.length)return[];const G=Mt.value.id,oe=$.value.filter(ce=>ce.areaIds&&ce.areaIds.includes(G)).map(ce=>ce.id);return bo.value.filter(ce=>{const we=ce.context?.checkpoint?.checkpointId;return we&&oe.includes(we)}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),vl=G=>{En.value=G,Ao.value=!0},yi=G=>{En.value=G,Ao.value=!0},hr=G=>{En.value=G,Ao.value=!0},bt=()=>{n.push("/sessions")},Dt=(G=!0)=>{Ge.value=G},Ut=()=>{Lt.value=!0},Co=async G=>{try{G&&(Rt.value={...G});const oe=rc(E.value.eventDate),ce=Rt.value.eventDate;if(oe!==ce){const we=N.value.filter(st=>st.startTime||st.endTime);if(we.length>0){Kt.value=oe,no.value=ce,Mo.value=we.length,xt.value=!0;return}}await Ds(!1,null)}catch(oe){console.error("Failed to update event:",oe),alert("Failed to update event. Please try again.")}},Ds=async(G,oe)=>{try{if(await a.updateEvent(t.params.eventId,{...Rt.value,defaultCheckpointStyleMapRotation:Rt.value.defaultCheckpointStyleMapRotation!=null?String(Rt.value.defaultCheckpointStyleMapRotation):null}),G&&oe!==null){const ce=Math.floor(Math.abs(oe)/1e3),we=oe<0,st=Math.floor(ce/3600),Tt=Math.floor(ce%3600/60),Gt=ce%60,xn=`${we?"-":""}${st.toString().padStart(2,"0")}:${Tt.toString().padStart(2,"0")}:${Gt.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,xn)}await an(),Lt.value=!1}catch(ce){console.error("Failed to update event:",ce),alert("Failed to update event. Please try again.")}},es=async({shouldShift:G,timeDelta:oe})=>{xt.value=!1,await Ds(G,oe)},ki=()=>{xt.value=!1,an()},ca=async({routeColor:G,routeStyle:oe,routeWeight:ce})=>{if(E.value)try{await a.updateEvent(t.params.eventId,{name:E.value.name,description:E.value.description,eventDate:E.value.eventDate,timeZoneId:E.value.timeZoneId,routeColor:G,routeStyle:oe,routeWeight:ce}),E.value={...E.value,routeColor:G,routeStyle:oe,routeWeight:ce}}catch(we){console.error("Failed to update route settings:",we)}},an=async()=>{try{await a.fetchEvent(t.params.eventId),E.value=a.currentEvent,E.value&&(Rt.value={name:E.value.name||"",description:E.value.description||"",eventDate:rc(E.value.eventDate),timeZoneId:E.value.timeZoneId||"UTC",peopleTerm:E.value.peopleTerm||"Marshals",checkpointTerm:E.value.checkpointTerm||"Checkpoints",areaTerm:E.value.areaTerm||"Areas",checklistTerm:E.value.checklistTerm||"Checklists",courseTerm:E.value.courseTerm||"Course",defaultCheckpointStyleType:E.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:E.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:E.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:E.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:E.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:E.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:E.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:E.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:E.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:E.value.brandingHeaderGradientEnd||"",brandingLogoUrl:E.value.brandingLogoUrl||"",brandingLogoPosition:E.value.brandingLogoPosition||"",brandingAccentColor:E.value.brandingAccentColor||"",brandingPageGradientStart:E.value.brandingPageGradientStart||"",brandingPageGradientEnd:E.value.brandingPageGradientEnd||""},Lt.value=!1,Zh(E.value));const G=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Zo(),wn(),sn(),lo(),Da(),ts(),Ra(),Se()]);N.value=a.locations,$.value=a.eventStatus.locations,G.forEach((oe,ce)=>{oe.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts","roles"][ce]}:`,oe.reason)})}catch(G){console.error("Failed to load event data:",G)}},wn=async()=>{try{const G=await _a.getByEvent(t.params.eventId);ne.value=G.data,z.value.marshals=Date.now()}catch(G){console.error("Failed to load marshals:",G)}},sn=async()=>{try{const G=await ms.getByEvent(t.params.eventId);Ct.value=G.data,z.value.areas=Date.now()}catch(G){console.error("Failed to load areas:",G)}},lo=async()=>{try{const[G,oe]=await Promise.all([zt.getByEvent(t.params.eventId),zt.getReport(t.params.eventId)]);gn.value=G.data,fl.value=oe.data,z.value.checklists=Date.now()}catch(G){console.error("Failed to load checklists:",G)}},Lo=async()=>{try{vi.value=!0;const G=await zt.getDetailedReport(t.params.eventId);pl.value=G.data}catch(G){console.error("Failed to load detailed report:",G)}finally{vi.value=!1}},Da=async()=>{try{const G=await ba.getByEvent(t.params.eventId);zo.value=G.data,z.value.notes=Date.now()}catch(G){console.error("Failed to load notes:",G)}},ts=async()=>{mi.value=!0;try{const G=await Ga.getAll(t.params.eventId);bo.value=G.data.incidents||[],z.value.incidents=Date.now()}catch(G){console.error("Failed to load incidents:",G)}finally{mi.value=!1}},Ra=async()=>{try{const[G,oe]=await Promise.all([us.getByEvent(t.params.eventId),us.getRoles(t.params.eventId)]);so.value=G.data,sa.value=oe.data,z.value.contacts=Date.now()}catch(G){console.error("Failed to load contacts:",G)}},Rs=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),N.value=a.locations,z.value.checkpoints=Date.now(),$.value=a.eventStatus.locations},ml=async()=>{await Promise.all([wn(),a.fetchEventStatus(t.params.eventId)]),$.value=a.eventStatus.locations},bi=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),sn()]),N.value=a.locations,$.value=a.eventStatus.locations},At=async()=>{await a.fetchEventStatus(t.params.eventId),$.value=a.eventStatus.locations},wi=()=>{Mt.value=null,go.value="details",Ge.value=!1,Mn.value=!0},In=G=>{Mt.value=G,An.value=G.id,go.value="details",Ge.value=!1,Mn.value=!0},ns=async G=>{try{let oe;if(Mt.value&&Mt.value.id){if(oe=Mt.value.id,await ms.update(t.params.eventId,oe,G),G.checklistChanges&&G.checklistChanges.length>0)for(const ce of G.checklistChanges)try{ce.complete?await zt.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await zt.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}}else oe=(await ms.create({eventId:t.params.eventId,...G})).data.id;if(G.pendingContacts&&G.pendingContacts.length>0&&oe)for(const ce of G.pendingContacts)try{const we=ce.scopeConfigurations?JSON.parse(JSON.stringify(ce.scopeConfigurations)):[],st=we.find(Tt=>Tt.scope==="EveryoneInAreas"&&Tt.itemType==="Area");st?(st.ids||(st.ids=[]),st.ids.includes(oe)||st.ids.push(oe)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}),await us.update(t.params.eventId,ce.contactId,{...ce,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",ce,we)}if(G.contactsToRemove&&G.contactsToRemove.length>0&&oe)for(const ce of G.contactsToRemove)try{const we=so.value.find(Gt=>Gt.contactId===ce);if(!we)continue;const st=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],Tt=st.find(Gt=>Gt.scope==="EveryoneInAreas"&&Gt.itemType==="Area");if(Tt&&Tt.ids){Tt.ids=Tt.ids.filter(xn=>xn!==oe);const Gt=Tt.ids.length>0?st:st.filter(xn=>!(xn.scope==="EveryoneInAreas"&&xn.itemType==="Area"));await us.update(t.params.eventId,ce,{...we,scopeConfigurations:Gt})}}catch(we){console.error("Failed to remove area from contact:",ce,we)}if((G.pendingContacts&&G.pendingContacts.length>0||G.contactsToRemove&&G.contactsToRemove.length>0)&&await Ra(),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0&&oe){for(const ce of G.pendingNewChecklistItems)if(ce.text?.trim())try{await zt.create(t.params.eventId,{text:ce.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}],displayOrder:0,isRequired:!1})}catch(we){console.error("Failed to create checklist item:",ce,we)}await lo()}if(G.pendingNewNotes&&G.pendingNewNotes.length>0&&oe){for(const ce of G.pendingNewNotes)if(!(!ce.title?.trim()&&!ce.content?.trim()))try{await ba.create(t.params.eventId,{title:ce.title||"Untitled",content:ce.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(we){console.error("Failed to create note:",ce,we)}await Da()}await sn(),await an(),ua()}catch(oe){console.error("Failed to save area:",oe),alert(oe.response?.data?.message||"Failed to save area. Please try again.")}},gl=async G=>{y(`Delete ${M.value.area}`,`Are you sure you want to delete this ${M.value.area}? ${D.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ms.delete(t.params.eventId,G),await ms.recalculate(t.params.eventId),await sn(),await an(),ua()}catch(oe){console.error(`Failed to delete ${M.value.area}:`,oe),alert(oe.response?.data?.message||`Failed to delete ${M.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},ua=()=>{Mn.value=!1,Mt.value=null,An.value=null,Ge.value=!1,on.value=!1,tn.value=null},os=({marshal:G,area:oe})=>{vt.value=null,Eo.value="details",Ge.value=!1,wo.value=oe,bn.value="",Go.value=G.id,Bt.value=!0},fr=({name:G,area:oe})=>{vt.value=null,Eo.value="details",Ge.value=!1,wo.value=oe,bn.value=G,Go.value=null,Bt.value=!0},yl=G=>{vt.value=G,Eo.value="details",Ge.value=!1,Bt.value=!0},as=()=>{Vn.value=null,ko.value="details",Ge.value=!1,Za.value=!0},_i=(G,oe="details")=>{Vn.value=G,ko.value=oe,Ge.value=!1,Za.value=!0},jo=async G=>{try{const oe={...G,scopeConfigurations:Ud(G.scopeConfigurations,{areas:Ct.value,locations:$.value,marshals:ne.value})};if(Vn.value&&Vn.value.itemId)await zt.update(t.params.eventId,Vn.value.itemId,oe);else{const ce=await zt.create(t.params.eventId,oe);ce.data.count&&ce.data.count>1&&(rt.value="Checklist Items Created",kt.value=`Successfully created ${ce.data.count} checklist items.`,He.value=!0)}await lo(),On()}catch(oe){console.error("Failed to save checklist item:",oe);const ce=oe.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ce)}},Ci=async G=>{y(`Delete ${M.value.checklist}`,`Are you sure you want to delete this ${M.value.checklist}?`,async()=>{try{await zt.delete(t.params.eventId,G),await lo(),On()}catch(oe){console.error(`Failed to delete ${M.value.checklist}:`,oe),alert(oe.response?.data?.message||`Failed to delete ${M.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},On=()=>{Za.value=!1,Vn.value=null,Ge.value=!1},kl=async G=>{const oe=[...gn.value];G.forEach(ce=>{const we=gn.value.find(st=>st.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await zt.reorder(t.params.eventId,G)}catch(ce){gn.value=oe,console.error("Failed to reorder checklist items:",ce),alert("Failed to save order. Changes have been reverted.")}},Li=()=>{Ho.value=null,Vo.value="details",Ge.value=!1,Ts.value=!0},Wo=G=>{Ho.value=G,Vo.value="details",Ge.value=!1,Ts.value=!0},bl=async G=>{try{const oe={...G,scopeConfigurations:Ud(G.scopeConfigurations,{areas:Ct.value,locations:$.value,marshals:ne.value})};Ho.value&&Ho.value.noteId?await ba.update(t.params.eventId,Ho.value.noteId,oe):await ba.create(t.params.eventId,oe),await Da(),ss()}catch(oe){console.error("Failed to save note:",oe);const ce=oe.response?.data?.message||"Failed to save note. Please try again.";alert(ce)}},Si=async G=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await ba.delete(t.params.eventId,G),await Da(),ss()}catch(oe){console.error("Failed to delete note:",oe),alert(oe.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},ss=()=>{Ts.value=!1,Ho.value=null,Ge.value=!1},Os=async G=>{const oe=[...zo.value];G.forEach(ce=>{const we=zo.value.find(st=>st.noteId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await ba.reorder(t.params.eventId,G)}catch(ce){zo.value=oe,console.error("Failed to reorder notes:",ce),alert("Failed to save order. Changes have been reverted.")}},Bs=async G=>{const oe=[...gn.value];G.forEach(ce=>{const we=gn.value.find(st=>st.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await zt.reorder(t.params.eventId,G)}catch(ce){gn.value=oe,console.error("Failed to reorder checklists:",ce),alert("Failed to save order. Changes have been reverted.")}},wl=()=>{Ms.value=!0},_l=async G=>{try{await Ga.create(t.params.eventId,G),Ms.value=!1,await ts()}catch(oe){console.error("Failed to report incident:",oe),alert(oe.response?.data?.message||"Failed to report incident. Please try again.")}},Cl=G=>{En.value=G,Ao.value=!0},Ii=()=>{Ao.value=!1,En.value=null},xi=async({incidentId:G,status:oe})=>{try{if(await Ga.updateStatus(t.params.eventId,G,{status:oe}),await ts(),En.value?.incidentId===G){const ce=bo.value.find(we=>we.incidentId===G);ce&&(En.value=ce)}}catch(ce){console.error("Failed to update incident status:",ce),alert(ce.response?.data?.message||"Failed to update status. Please try again.")}},$i=()=>{ao.value="",Ka.value=!0},Ns=()=>{Ka.value=!1,ao.value=""},Fs=async()=>{if(!(!ao.value.trim()||!En.value)){aa.value=!0;try{await Ga.addNote(t.params.eventId,En.value.incidentId,ao.value.trim()),Ns(),await ts();const G=bo.value.find(oe=>oe.incidentId===En.value.incidentId);G&&(En.value=G)}catch(G){console.error("Failed to add note to incident:",G),alert(G.response?.data?.message||"Failed to add note. Please try again.")}finally{aa.value=!1}}},da=()=>{vt.value=null,Eo.value="details",wo.value=null,Ge.value=!1,Bt.value=!0},pr=G=>{vt.value=G,Eo.value="details",Ge.value=!1,Bt.value=!0},Oa=async G=>{try{const oe={...G,scopeConfigurations:Ud(G.scopeConfigurations,{areas:Ct.value,locations:$.value,marshals:ne.value})};let ce=null;const we=!vt.value||!vt.value.contactId,st=!!wo.value;if(vt.value&&vt.value.contactId)await us.update(t.params.eventId,vt.value.contactId,oe);else{const Tt=await us.create(t.params.eventId,oe);ce=Tt.data?.contactId||Tt.data?.id}if(await Ra(),we&&st&&ce&&oo.value){const Tt=so.value.find(Gt=>Gt.contactId===ce);Tt&&oo.value.addPendingContact(Tt)}is()}catch(oe){console.error("Failed to save contact:",oe);const ce=oe.response?.data?.message||"Failed to save contact. Please try again.";alert(ce)}},Bn=async G=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await us.delete(t.params.eventId,G),await Ra(),oo.value&&oo.value.removeContactById(G),is()}catch(oe){console.error("Failed to delete contact:",oe),alert(oe.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},is=()=>{Bt.value=!1,vt.value=null,wo.value=null,bn.value="",Go.value=null,Ge.value=!1},Ti=async G=>{const oe=[...so.value];G.forEach(ce=>{const we=so.value.find(st=>st.contactId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await us.reorder(t.params.eventId,G)}catch(ce){so.value=oe,console.error("Failed to reorder contacts:",ce),alert("Failed to save order. Changes have been reverted.")}},Se=async()=>{try{const G=await Ks.getAll(t.params.eventId);Pn.value=G.data,z.value.roles=Date.now()}catch(G){console.error("Failed to load role definitions:",G)}},Ce=()=>{Sn.value=null,ia.value="details",dt.value=[],Ge.value=!1,io.value=!0},nt=G=>{Sn.value=G,ia.value="details",dt.value=[],Ge.value=!1,io.value=!0},mt=async G=>{try{const oe=Sn.value?.roleId,{assignmentChanges:ce,...we}=G;oe?(await Ks.update(t.params.eventId,oe,we),ce&&(ce.marshalIdsToAdd.length>0||ce.marshalIdsToRemove.length>0||ce.contactIdsToAdd.length>0||ce.contactIdsToRemove.length>0)&&await Ks.updatePeople(t.params.eventId,oe,ce)):await Ks.create(t.params.eventId,we),await Se(),Ht()}catch(oe){console.error("Failed to save role:",oe);const ce=oe.response?.data?.message||"Failed to save role. Please try again.";alert(ce)}},$t=async G=>{const oe=Sn.value?.usageCount||0;let ce="Are you sure you want to delete this role?";if(oe>0){const we=oe===1?M.value.person:M.value.people;ce=`This role is assigned to ${oe} ${we}. They will all be unassigned from this role. Are you sure you want to delete it?`}y("Delete role",ce,async()=>{try{await Ks.delete(t.params.eventId,G),await Se(),Ht()}catch(we){console.error("Failed to delete role:",we),alert(we.response?.data?.message||"Failed to delete role. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ht=()=>{io.value=!1,Sn.value=null,dt.value=[],Ge.value=!1},Nn=async G=>{Yt.value=!0;try{const oe=await Ks.getPeople(t.params.eventId,G);dt.value=oe.data}catch(oe){console.error("Failed to load people for role:",oe)}finally{Yt.value=!1}},Vt=async G=>{const oe=[...Pn.value];G.forEach(ce=>{const we=Pn.value.find(st=>st.roleId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ks.reorder(t.params.eventId,G)}catch(ce){Pn.value=oe,console.error("Failed to reorder roles:",ce),alert("Failed to save order. Changes have been reverted.")}},ln=G=>{tn.value={...G,id:Mt.value?.id};const oe={...G,id:Mt.value?.id,polygon:[]};Mt.value=oe;let ce=!1;if(G.polygon&&G.polygon.length>0){const we=G.polygon.map(s=>s.lat||s[0]),st=G.polygon.map(s=>s.lng||s[1]),Tt=Math.min(...we),Gt=Math.max(...we),xn=Math.min(...st),Di=Math.max(...st);Qe.value={lat:(Tt+Gt)/2,lng:(xn+Di)/2};const Ri=Gt-Tt,Rl=Di-xn,Gs=Math.max(Ri,Rl);Ot.value=Gs<.005?17:Gs<.01?16:Gs<.02?15:Gs<.05?14:13,ce=!0}if(!ce&&G.checkpointIds&&G.checkpointIds.length>0){const we=$.value.filter(st=>G.checkpointIds.includes(st.id));if(we.length>0){const st=we.map(Gt=>Gt.latitude).filter(Boolean),Tt=we.map(Gt=>Gt.longitude).filter(Boolean);if(st.length>0&&Tt.length>0){const Gt=Math.min(...st),xn=Math.max(...st),Di=Math.min(...Tt),Ri=Math.max(...Tt);Qe.value={lat:(Gt+xn)/2,lng:(Di+Ri)/2};const Rl=xn-Gt,Gs=Ri-Di,s=Math.max(Rl,Gs);Ot.value=s<.005?16:s<.01?15:s<.02?14:s<.05?13:12,ce=!0}}}if(!ce&&J.value){const we=J.value.getMapCenter(),st=J.value.getMapZoom();we&&st!==null&&(Qe.value=we,Ot.value=st)}Uo.value=!0,pe.value="draw-area",on.value=!0,ve.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},ro=G=>{tn.value?Mt.value={...Mt.value||{},...tn.value,polygon:G}:Mt.value={...Mt.value,polygon:G}},wt=G=>{S.handlePolygonDrawing(G)},qn=()=>{on.value=!1,tn.value&&(Mt.value=tn.value,Mn.value=!0,tn.value=null)},Zo=()=>I.loadEventAdmins(),vr=async G=>{try{await I.addAdmin(G),await Zo(),mr()}catch(oe){console.error("Failed to add admin:",oe),alert(oe.response?.data?.message||"Failed to add administrator. Please try again.")}},Mi=async G=>{y("Remove administrator",`Remove ${G} as an administrator?`,async()=>{try{await I.removeAdmin(G),await Zo()}catch(oe){console.error("Failed to remove admin:",oe),alert(oe.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},mr=()=>{I.closeAddAdminModal(),Ge.value=!1},Ll=async G=>{await w.uploadRoute(G)&&(await Rs(),_c())},_c=()=>{w.closeUploadRouteModal()},Ba=async({file:G,deleteExisting:oe})=>{const ce=await w.importLocations(G,oe);if(ce){await bi(),Ai();const we=w.formatImportResultMessage(ce,"location");rt.value="Import Complete",kt.value=we,He.value=!0}},Ai=()=>{w.closeImportLocationsModal()},rd=async G=>{if(Z.value)ft.value.latitude=G.lat,ft.value.longitude=G.lng;else if(Q.value)ee.value.latitude=G.lat,ee.value.longitude=G.lng,O.value&&(O.value={...O.value,latitude:G.lat,longitude:G.lng}),Q.value=!1,q.value=!0,Dt();else if(Pa.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${yo.value}`,description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:""}),yo.value++,await an()}catch(oe){console.error("Failed to create checkpoint:",oe),alert("Failed to create checkpoint. Please try again.")}},gr=G=>{S.handleFullscreenMapClick(G)},cd=G=>{ft.value={...G}},ha=()=>{Z.value=!1,S.enterPlaceCheckpointMode()},ud=()=>{S.saveMapState(J.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},S.enterPlaceCheckpointMode()},Us=()=>{S.saveMapState(J.value),Uo.value=!0,pe.value="view",ve.value={title:"Course map",description:""}},dd=()=>{S.saveMapState(J.value),Mt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Ct.value.length},S.enterDrawAreaMode()},fa=()=>{O.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],Ge.value=!1,q.value=!0},Sl=()=>{const G=S.calculateStartingNumber($);S.saveMapState(J.value),S.enterAddMultipleMode(G)},Cc=()=>{if(pe.value==="place-checkpoint"){const G=S.getPlacedCoords()||{lat:0,lng:0};O.value={id:null,name:"",description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],Ge.value=!1,zs(),q.value=!0}else if(pe.value==="move-checkpoint"){const G=S.getPlacedCoords();G&&(ee.value.latitude=G.lat,ee.value.longitude=G.lng,O.value&&(O.value={...O.value,...mn.value||{},latitude:G.lat,longitude:G.lng}),Dt()),mn.value=null,zs(),q.value=!0}else if(pe.value==="draw-area"){const G=S.getCompletedPolygon();G&&(tn.value?Mt.value={...Mt.value||{},...tn.value,polygon:G}:Mt.value={...Mt.value||{},polygon:G}),tn.value=null,zs()}else pe.value==="add-multiple"&&yr()},yr=async()=>{const G=S.getTempCheckpoints();try{for(const oe of G)await a.createLocation({eventId:t.params.eventId,name:oe.name,description:oe.description,latitude:oe.latitude,longitude:oe.longitude,requiredMarshals:oe.requiredMarshals,what3Words:oe.what3Words});S.clearTempCheckpoints(),zs(),await an()}catch(oe){console.error("Failed to create checkpoints:",oe),alert("Failed to create checkpoints. Please try again.")}},Il=()=>{pe.value==="draw-area"?tn.value&&(Mt.value=tn.value,tn.value=null):pe.value==="move-checkpoint"&&(mn.value&&O.value&&Object.assign(O.value,mn.value),q.value=!0,Q.value=!1),S.cancelFullscreen()},zs=()=>{S.exitFullscreen()},xl=G=>{pa(G)},pa=G=>{O.value=G,ee.value={id:G.id,name:G.name,description:G.description||"",latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||""},fe.value=[],ke.value=[],Ge.value=!1,q.value=!0,setTimeout(()=>{J.value?.scrollMapIntoView()},100)},$l=async G=>{if(!Lu(G.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...G}),await an(),Tl()}catch(oe){console.error("Failed to save location:",oe),alert("Failed to save location. Please try again.")}},Tl=()=>{Z.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Ge.value=!1,Ge.value=!1},Ml=()=>{q.value=!1,O.value=null,j.value=!1,Q.value=!1,_e.value=!1,mn.value=null,ee.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],Ge.value=!1},kr=()=>{_e.value=!1},Al=()=>{_e.value=!0},hd=G=>{G?.formData&&(mn.value=G.formData),q.value=!1,Le.value=null;const oe=mn.value?.latitude??O.value?.latitude,ce=mn.value?.longitude??O.value?.longitude;if(oe&&ce)Qe.value={lat:oe,lng:ce},Ot.value=16;else if(J.value){const st=J.value.getMapCenter(),Tt=J.value.getMapZoom();st&&Tt!==null&&(Qe.value=st,Ot.value=Tt)}const we=mn.value?.name||O.value?.name;Uo.value=!0,pe.value="move-checkpoint",ve.value={title:`Move ${M.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},Lc=async G=>{if(!Lu(G.what3Words)){alert("Invalid What3Words format.");return}try{const oe=!O.value.id;if(oe){const ce=await a.createLocation({eventId:t.params.eventId,name:G.name,description:G.description,latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||null,startTime:G.startTime,endTime:G.endTime,styleType:G.styleType,styleColor:G.styleColor,styleBackgroundShape:G.styleBackgroundShape,styleBackgroundColor:G.styleBackgroundColor,styleBorderColor:G.styleBorderColor,styleIconColor:G.styleIconColor,styleSize:G.styleSize,styleMapRotation:G.styleMapRotation!=null?String(G.styleMapRotation):null,peopleTerm:G.peopleTerm,checkpointTerm:G.checkpointTerm,isDynamic:G.isDynamic||!1,locationUpdateScopeConfigurations:G.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:G.pendingNewChecklistItems||[],pendingNewNotes:G.pendingNewNotes||[]});if(G.pendingAssignments&&G.pendingAssignments.length>0)for(const we of G.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ce.id,marshalId:we.marshalId})}else{const ce=O.value.id;if(await Kn.update(t.params.eventId,ce,{eventId:t.params.eventId,name:G.name,description:G.description,latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||null,startTime:G.startTime,endTime:G.endTime,styleType:G.styleType,styleColor:G.styleColor,styleBackgroundShape:G.styleBackgroundShape,styleBackgroundColor:G.styleBackgroundColor,styleBorderColor:G.styleBorderColor,styleIconColor:G.styleIconColor,styleSize:G.styleSize,styleMapRotation:G.styleMapRotation!=null?String(G.styleMapRotation):null,peopleTerm:G.peopleTerm,checkpointTerm:G.checkpointTerm,isDynamic:G.isDynamic||!1,locationUpdateScopeConfigurations:G.locationUpdateScopeConfigurations||[]}),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0)for(const we of G.pendingNewChecklistItems)we.text?.trim()&&await zt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,isRequired:!1});if(G.pendingNewNotes&&G.pendingNewNotes.length>0)for(const we of G.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ba.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of ke.value)await a.deleteAssignment(t.params.eventId,we);if(G.assignmentsToRemove&&G.assignmentsToRemove.length>0)for(const we of G.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of fe.value)await a.createAssignment({eventId:t.params.eventId,locationId:O.value.id,marshalId:we.marshalId});if(G.checkInChanges&&G.checkInChanges.length>0)for(const we of G.checkInChanges){const st=O.value.assignments.find(Tt=>Tt.id===we.assignmentId);st&&st.isCheckedIn!==we.shouldBeCheckedIn&&await ri.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!oe&&G.checklistChanges&&G.checklistChanges.length>0)for(const ce of G.checklistChanges)try{ce.complete?await zt.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await zt.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}await an(),Ml()}catch(oe){console.error("Failed to update location:",oe),alert("Failed to update location. Please try again.")}},fd=async G=>{y(`Delete ${M.value.checkpoint}`,`Are you sure you want to delete this ${M.value.checkpoint}?`,async()=>{try{await Kn.delete(t.params.eventId,G),await bi(),Ml()}catch(oe){console.error(`Failed to delete ${M.value.checkpoint}:`,oe),alert(`Failed to delete ${M.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Sc=async G=>{try{if(re.value&&re.value.setCheckingIn(G.id),await ri.adminCheckIn(t.params.eventId,G.id),await At(),O.value){const oe=$.value.find(ce=>ce.id===O.value.id);oe&&(O.value=oe)}}catch(oe){console.error("Failed to toggle check-in:",oe),alert("Failed to toggle check-in. Please try again.")}finally{re.value&&re.value.setCheckingIn(null)}},pd=G=>{const oe=G?.id??G;if(oe?.toString().startsWith("temp-")){const ce=O.value.assignments.find(we=>we.id===oe);ce&&(fe.value=fe.value.filter(we=>we.marshalId!==ce.marshalId)),O.value.assignments=O.value.assignments.filter(we=>we.id!==oe),Dt()}else ke.value.includes(oe)||(ke.value.push(oe),O.value.assignments=O.value.assignments.filter(ce=>ce.id!==oe),Dt())},Ko=async G=>{const oe=ne.value.find(we=>we.id===G);if(!oe)return;const ce=$.value.filter(we=>we.assignments?.some(st=>st.marshalId===G&&we.id!==O.value.id));if(ce.length>0){Ue.value={marshalName:oe.name,locations:ce.map(st=>st.name),marshal:oe};const we=await new Promise(st=>{Ae.value=st,Be.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const st of ce){const Tt=st.assignments.find(Gt=>Gt.marshalId===G);if(Tt){ke.value.push(Tt.id);const Gt=$.value.findIndex(xn=>xn.id===st.id);Gt!==-1&&($.value[Gt].assignments=$.value[Gt].assignments.filter(xn=>xn.id!==Tt.id))}}}fe.value.push({marshalId:oe.id,marshalName:oe.name}),O.value.assignments||(O.value.assignments=[]),O.value.assignments.push({id:`temp-${Date.now()}`,marshalId:oe.id,marshalName:oe.name,locationId:O.value.id,isCheckedIn:!1,isPending:!0}),Dt(),kr()},El=async G=>{try{const ce=(await _a.create({eventId:t.params.eventId,name:G.name,email:G.email,phoneNumber:G.phoneNumber})).data;await wn(),fe.value.push({marshalId:ce.id,marshalName:ce.name}),O.value&&(O.value.assignments||(O.value.assignments=[]),O.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ce.id,marshalName:ce.name,locationId:O.value.id,isCheckedIn:!1,isPending:!0})),Dt(),kr()}catch(oe){console.error("Failed to create marshal:",oe),alert("Failed to create marshal. Please try again.")}},vd=()=>{Oe.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},te.value=[],ye.value=[],Ge.value=!1,ge.value=!0},Pl=G=>{Oe.value=G,me.value={},Ze.value={id:G.id,name:G.name,email:G.email||"",phoneNumber:G.phoneNumber||"",notes:G.notes||""},te.value=[],ye.value=[],Ge.value=!1,ge.value=!0},Ic=H(()=>{if(!Oe.value)return[];const G=[];return $.value.forEach(oe=>{oe.assignments.filter(we=>we.marshalName===Oe.value.name&&!ye.value.includes(we.id)).forEach(we=>{G.push({...we,locationName:oe.name,locationDescription:oe.description||""})})}),te.value.forEach((oe,ce)=>{const we=$.value.find(st=>st.id===oe.locationId);we&&G.push({id:`pending-${ce}`,locationId:oe.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:Oe.value.id,marshalName:Oe.value.name,isCheckedIn:!1,isPending:!0})}),G}),xc=async G=>{try{let oe=Oe.value?.id,ce=!1;if(Oe.value){if(await _a.update(t.params.eventId,Oe.value.id,{name:G.name,email:G.email,phoneNumber:G.phoneNumber,notes:G.notes,roles:G.roles||[]}),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0)for(const we of G.pendingNewChecklistItems)we.text?.trim()&&await zt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,isRequired:!1});if(G.pendingNewNotes&&G.pendingNewNotes.length>0)for(const we of G.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ba.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,priority:"Normal",isPinned:!1})}else oe=(await _a.create({eventId:t.params.eventId,name:G.name,email:G.email,phoneNumber:G.phoneNumber,notes:G.notes,roles:G.roles||[],pendingNewChecklistItems:G.pendingNewChecklistItems||[],pendingNewNotes:G.pendingNewNotes||[]})).data.id,ce=!0;for(const we of ye.value)await a.deleteAssignment(t.params.eventId,we);if(G.assignmentsToRemove&&G.assignmentsToRemove.length>0)for(const we of G.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of te.value)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:oe});if(G.pendingAssignments&&G.pendingAssignments.length>0)for(const we of G.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:oe});if(G.checkInChanges&&G.checkInChanges.length>0){const we=Ic.value;for(const st of G.checkInChanges){const Tt=we.find(Gt=>Gt.id===st.assignmentId);Tt&&Tt.isCheckedIn!==st.shouldBeCheckedIn&&await ri.adminCheckIn(t.params.eventId,st.assignmentId)}}if(G.checklistChanges&&G.checklistChanges.length>0)for(const we of G.checklistChanges)try{const st={marshalId:oe};we.contextType&&we.contextId&&(st.contextType=we.contextType,st.contextId=we.contextId),we.complete?await zt.complete(t.params.eventId,we.itemId,st):await zt.uncomplete(t.params.eventId,we.itemId,st)}catch(st){console.error("Failed to process checklist change:",st);const Tt=st.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Tt}`)}if(await an(),O.value){const we=$.value.find(st=>st.id===O.value.id);we&&(O.value=we)}Dl(),ce&&(U.value=oe,X.value=G.name,ie.value=!0)}catch(oe){console.error("Failed to save marshal:",oe);const ce=oe.response?.data?.message||"Failed to save marshal. Please try again.";if(oe.response?.status===400){const we=ce.toLowerCase();we.includes("name")?(me.value={name:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("name"))):we.includes("email")?(me.value={email:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("email"))):(me.value={general:ce},xe.value&&xe.value.switchToTab("details"))}else me.value={general:ce},xe.value&&xe.value.switchToTab("details")}},$c=async G=>{const oe=G||Oe.value?.id;if(!oe){console.error("No marshal ID to delete");return}const ce=M.value.person;y(`Delete ${ce}`,`Are you sure you want to delete this ${ce}?`,async()=>{try{await _a.delete(t.params.eventId,oe),await ml(),Dl()}catch(we){console.error(`Failed to delete ${ce}:`,we),alert(`Failed to delete ${ce}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ei=G=>{$c(G.id)},md=G=>{const oe=G?.id??G;if(oe?.toString().startsWith("pending-")){const ce=G?.locationId;ce&&(te.value=te.value.filter(we=>we.locationId!==ce)),Dt()}else ye.value.includes(oe)||(ye.value.push(oe),Dt())},Hs=G=>{te.value.push({locationId:G}),Dt()},Dl=()=>{ge.value=!1,Oe.value=null,De.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},te.value=[],ye.value=[],Ge.value=!1},Tc=async G=>{const oe=ne.value.find(ce=>ce.id===G.marshalId);if(!oe){console.error("Marshal not found:",G.marshalId);return}De.value=O.value?.id||null,Ge.value=!1,Oe.value=oe,ge.value=!0},gd=G=>{const oe=$.value.find(ce=>ce.id===G.locationId);if(!oe){console.error("Location not found:",G.locationId);return}j.value=!0,Ge.value=!1,O.value=oe,q.value=!0},va=async({file:G})=>{const oe=await w.importMarshals(G);if(oe){await ml(),br();const ce=w.formatImportResultMessage(oe,"marshal");rt.value="Import Complete",kt.value=ce,He.value=!0}},br=()=>{w.closeImportMarshalsModal()},Mc=G=>{Ae.value&&(Ae.value(G),Ae.value=null),Be.value=!1};let ma=null;const Ac=async()=>{try{const G=t.params.eventId,oe=await Kn.getDynamicCheckpoints(G);if(oe.data&&Array.isArray(oe.data))for(const ce of oe.data){const we=$.value.find(st=>st.id===ce.checkpointId);we&&(we.latitude=ce.latitude,we.longitude=ce.longitude,we.lastLocationUpdate=ce.lastLocationUpdate)}}catch(G){console.warn("Failed to poll dynamic checkpoints:",G)}},Pi=()=>{ma||!$.value.some(oe=>oe.isDynamic||oe.IsDynamic)||(Ac(),ma=setInterval(Ac,6e4))},Vs=()=>{ma&&(clearInterval(ma),ma=null)};return Ye(i,G=>{G==="course"?Pi():Vs();const oe=Date.now(),ce=we=>oe-z.value[we]>eV;switch(G){case"marshals":ce("marshals")&&wn(),ce("roles")&&Se();break;case"areas":ce("areas")&&sn(),ce("roles")&&Se();break;case"checkpoints":ce("checkpoints")&&Rs();break;case"checklists":ce("checklists")&&lo();break;case"notes":ce("notes")&&Da();break;case"incidents":ce("incidents")&&ts();break;case"contacts":ce("contacts")&&Ra(),ce("roles")&&Se();break;case"roles":ce("roles")&&Se();break}}),un(async()=>{await an();try{const G=await qa.getMe(t.params.eventId);qo.value=G.data}catch(G){console.warn("Failed to fetch user claims:",G)}i.value==="course"&&Pi()}),Ye(E,G=>{G&&(document.title="OnTheDay App - Admin")},{immediate:!0}),Ln(()=>{Vs()}),(G,oe)=>(p(),g("div",{class:"admin-event-manage",style:tt({colorScheme:F(T)})},[r("header",VH,[r("div",GH,[r("button",{onClick:bt,class:"btn-back",title:"Back to sessions"},[Pe(HH,{size:48,animate:""})]),E.value?(p(),g("div",qH,[r("h1",null,b(E.value.name),1),r("p",jH,b(F(Ky)(E.value.eventDate)),1)])):P("",!0)]),r("div",WH,[_o.value?(p(),g("button",{key:0,onClick:Jt,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Pe(BH,{class:"theme-toggle-fixed"})]),r("div",ZH,[r("div",KH,[Pe(eP,{tabs:B.value,"model-value":F(i),"onUpdate:modelValue":F(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",YH,[F(i)==="course"?(p(),qe(eS,{key:0,ref_key:"courseAreasTab",ref:J,checkpoints:$.value,areas:Ct.value,route:E.value?.route||[],"route-color":E.value?.routeColor||"","route-style":E.value?.routeStyle||"","route-weight":E.value?.routeWeight,"selected-area-id":An.value,"drawing-mode":F(on),onMapClick:rd,onLocationClick:xl,onAreaClick:In,onImportCheckpoints:oe[0]||(oe[0]=ce=>ze.value=!0),onUploadRoute:oe[1]||(oe[1]=ce=>$e.value=!0),onSelectLocation:pa,onAddArea:wi,onSelectArea:In,onPolygonComplete:ro,onCancelDrawing:qn,onAddCheckpointFromMap:ud,onAddManyCheckpointsFromMap:Sl,onAddAreaFromMap:dd,onFullscreen:Us,"onUpdate:routeSettings":ca},null,8,["checkpoints","areas","route","route-color","route-style","route-weight","selected-area-id","drawing-mode"])):P("",!0),F(i)==="checkpoints"?(p(),qe(L3,{key:1,locations:$.value,areas:Ct.value,onAddCheckpointManually:fa,onImportCheckpoints:oe[2]||(oe[2]=ce=>ze.value=!0),onSelectLocation:pa},null,8,["locations","areas"])):P("",!0),F(i)==="areas"?(p(),qe(G3,{key:2,areas:Ct.value,checkpoints:$.value,contacts:so.value,"event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onAddArea:wi,onSelectArea:In},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),F(i)==="marshals"?(p(),qe(nI,{key:3,ref_key:"marshalsTabRef",ref:re,marshals:ne.value,assignments:la.value,locations:$.value,onAddMarshal:vd,onImportMarshals:oe[3]||(oe[3]=ce=>be.value=!0),onSelectMarshal:Pl,onDeleteMarshal:Ei,onToggleCheckIn:Sc},null,8,["marshals","assignments","locations"])):P("",!0),F(i)==="checklists"?(p(),qe(v$,{key:4,"checklist-items":gn.value,areas:Ct.value,locations:$.value,marshals:ne.value,"completion-report":fl.value,"detailed-report":pl.value,"is-loading-detailed-report":vi.value,onAddChecklistItem:as,onSelectChecklistItem:_i,onReorder:kl,onLoadDetailedReport:Lo},null,8,["checklist-items","areas","locations","marshals","completion-report","detailed-report","is-loading-detailed-report"])):P("",!0),F(i)==="notes"?(p(),qe(P$,{key:5,notes:zo.value,areas:Ct.value,locations:$.value,marshals:ne.value,onAddNote:Li,onSelectNote:Wo,onReorder:Os},null,8,["notes","areas","locations","marshals"])):P("",!0),F(i)==="incidents"?(p(),qe(n3,{key:6,incidents:bo.value,areas:Ct.value,loading:mi.value,onSelectIncident:Cl,onReportIncident:wl},null,8,["incidents","areas","loading"])):P("",!0),F(i)==="contacts"?(p(),qe(tT,{key:7,contacts:so.value,areas:Ct.value,locations:$.value,marshals:ne.value,"available-roles":sa.value,"role-definitions":Pn.value,onAddContact:da,onSelectContact:pr,onReorder:Ti},null,8,["contacts","areas","locations","marshals","available-roles","role-definitions"])):P("",!0),F(i)==="roles"?(p(),qe(yT,{key:8,"role-definitions":Pn.value,onAddRole:Ce,onSelectRole:nt,onReorder:Vt},null,8,["role-definitions"])):P("",!0),F(i)==="details"?(p(),qe(MT,{key:9,"event-data":Rt.value,"form-dirty":Lt.value,onSubmit:Co,"onUpdate:formDirty":Ut},null,8,["event-data","form-dirty"])):P("",!0),F(i)==="settings"?(p(),qe(E4,{key:10,"event-data":Rt.value,"event-id":F(t).params.eventId,admins:F(ae),"form-dirty":Lt.value,onSubmit:Co,onAddAdmin:oe[4]||(oe[4]=ce=>he.value=!0),onRemoveAdmin:Mi,"onUpdate:formDirty":Ut},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Pe(MH,{show:Z.value,location:ft.value,"is-dirty":Ge.value,onClose:Tl,onSave:$l,onSetOnMap:ha,"onUpdate:isDirty":Dt,"onUpdate:location":cd},null,8,["show","location","is-dirty"]),Pe(tO,{show:q.value,location:O.value,assignments:O.value?.assignments||[],"event-date":E.value?.eventDate||"",areas:Ct.value,"event-id":F(t).params.eventId,"all-locations":$.value,notes:zo.value,"available-marshals":As.value,"all-marshals":ne.value,"all-checklist-items":gn.value,incidents:Xa.value,"is-dirty":Ge.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","z-index":Mn.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:Ml,onSave:Lc,onDelete:fd,onMoveLocation:hd,onRemoveAssignment:pd,onOpenAssignModal:Al,"onUpdate:isDirty":Dt,onSelectIncident:yi,onSelectMarshal:Tc,onReorderNotes:Os,onReorderChecklists:Bs},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Pe(sP,{show:K.value,link:Gn.value,"is-dirty":!1,onClose:oe[5]||(oe[5]=ce=>K.value=!1)},null,8,["show","link"]),Pe(jP,{show:ie.value,"event-id":F(t).params.eventId,"marshal-id":U.value,"marshal-name":X.value,onClose:oe[6]||(oe[6]=ce=>ie.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Pe(KP,{show:F(he),"is-dirty":Ge.value,onClose:mr,onSubmit:vr,"onUpdate:isDirty":Dt},null,8,["show","is-dirty"]),Pe(e6,{show:F($e),uploading:F(Ee),error:F(Me),"is-dirty":Ge.value,onClose:_c,onSubmit:Ll,"onUpdate:isDirty":Dt},null,8,["show","uploading","error","is-dirty"]),Pe(u6,{show:F(ze),importing:F(V),error:F(de),result:F(se),"is-dirty":Ge.value,onClose:Ai,onSubmit:Ba,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Pe(dN,{ref_key:"editMarshalModalRef",ref:xe,show:ge.value,marshal:Oe.value,"event-id":F(t).params.eventId,assignments:Ic.value,"available-locations":Ya.value,"all-locations":$.value,areas:Ct.value,"is-editing":!!Oe.value,"event-notes":zo.value,"all-checklist-items":gn.value,incidents:Ps.value,"all-marshals":ne.value,"is-dirty":Ge.value,"validation-errors":me.value,"locked-checkpoint-id":De.value,"z-index":De.value?1100:1e3,"role-definitions":Pn.value,onClose:Dl,onSave:xc,onDelete:$c,onRemoveAssignment:md,onAssignToLocation:Hs,"onUpdate:isDirty":Dt,onSelectIncident:vl,onSelectCheckpoint:gd,onReorderNotes:Os,onReorderChecklists:Bs},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index","role-definitions"]),Pe(y6,{show:F(be),importing:F(Y),error:F(de),result:F(Re),"is-dirty":Ge.value,onClose:br,onSubmit:va,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Pe(vN,{show:Be.value,"conflict-data":Ue.value,onClose:oe[7]||(oe[7]=ce=>Be.value=!1),onChoice:Mc},null,8,["show","conflict-data"]),Pe(SN,{show:_e.value,"location-name":O.value?.name||"",marshals:As.value,onClose:kr,onAssignExisting:Ko,onCreateAndAssign:El},null,8,["show","location-name","marshals"]),Pe(BN,{show:xt.value,"old-event-date":Kt.value,"new-event-date":no.value,"affected-checkpoints-count":Mo.value,onConfirm:es,onCancel:ki},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Pe(JF,{ref_key:"editAreaModalRef",ref:oo,show:Mn.value,area:Mt.value,"initial-tab":go.value,checkpoints:$.value,marshals:ne.value,areas:Ct.value,route:E.value?.route||[],"route-color":E.value?.routeColor||"","route-style":E.value?.routeStyle||"","route-weight":E.value?.routeWeight,"is-dirty":Ge.value,"event-id":F(t).params.eventId,"all-locations":$.value,assignments:la.value,notes:zo.value,contacts:so.value,incidents:Qa.value,"role-definitions":Pn.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onClose:ua,onSave:ns,onDelete:gl,onDrawBoundary:ln,"onUpdate:isDirty":Dt,onSelectCheckpoint:pa,onCreateContactFromMarshal:os,onCreateNewContact:fr,onEditContact:yl,onSelectIncident:hr,onReorderNotes:Os,onReorderChecklists:Bs,onReorderContacts:Ti},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","route-color","route-style","route-weight","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","role-definitions","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Pe(p7,{show:Za.value,"checklist-item":Vn.value,"initial-tab":ko.value,areas:Ct.value,locations:$.value,marshals:ne.value,"is-dirty":Ge.value,"next-display-order":hl.value,onClose:On,onSave:jo,onDelete:Ci,"onUpdate:isDirty":Dt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty","next-display-order"]),Pe(M7,{show:Ts.value,note:Ho.value,"initial-tab":Vo.value,areas:Ct.value,locations:$.value,marshals:ne.value,"is-dirty":Ge.value,onClose:ss,onSave:bl,onDelete:Si,"onUpdate:isDirty":Dt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Pe(_1,{show:Ao.value,incident:En.value,route:E.value?.route||[],"route-color":E.value?.routeColor||"","route-style":E.value?.routeStyle||"","route-weight":E.value?.routeWeight,checkpoints:$.value,"can-manage":!0,onClose:Ii,onStatusChange:xi,onOpenAddNote:$i},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints"]),Pe(Zt,{show:Ka.value,title:"Add update",size:"small",onClose:Ns},{footer:Ve(()=>[r("div",XH,[r("button",{type:"button",class:"btn btn-secondary",onClick:Ns}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Fs,disabled:!ao.value.trim()||aa.value},b(aa.value?"Adding...":"Add update"),9,QH)])]),default:Ve(()=>[r("div",JH,[We(r("textarea",{"onUpdate:modelValue":oe[8]||(oe[8]=ce=>ao.value=ce),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,ao.value]])])]),_:1},8,["show"]),Pe(C1,{show:Ms.value,"event-id":F(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:$.value,route:E.value?.route||[],"route-color":E.value?.routeColor||"","route-style":E.value?.routeStyle||"","route-weight":E.value?.routeWeight,onClose:oe[9]||(oe[9]=ce=>Ms.value=!1),onSubmit:_l},null,8,["show","event-id","checkpoints","route","route-color","route-style","route-weight"]),Pe(Nz,{show:Bt.value,contact:vt.value,"initial-tab":Eo.value,areas:Ct.value,locations:$.value,marshals:ne.value,"available-roles":sa.value,"role-definitions":Pn.value,"is-dirty":Ge.value,"prefilled-name":bn.value,"prefilled-marshal-id":Go.value,"create-from-area-context":!!wo.value,onClose:is,onSave:Oa,onDelete:Bn,"onUpdate:isDirty":Dt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","role-definitions","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Pe(sH,{show:io.value,role:Sn.value,"initial-tab":ia.value,people:dt.value,"loading-people":Yt.value,"is-dirty":Ge.value,onClose:Ht,onSave:mt,onDelete:$t,"onUpdate:isDirty":Dt,onLoadPeople:Nn},null,8,["show","role","initial-tab","people","loading-people","is-dirty"]),Pe(kH,{show:F(Uo),mode:F(pe),"context-title":F(ve).title,"context-description":F(ve).description,"can-complete":Ja.value,clickable:F(pe)!=="draw-area","drawing-mode":F(pe)==="draw-area"&&F(on),locations:gi.value,areas:ra.value,route:E.value?.route||[],"route-color":E.value?.routeColor||"","route-style":E.value?.routeStyle||"","route-weight":E.value?.routeWeight,"selected-area-id":An.value,center:F(Qe),zoom:F(Ot),"highlight-location-id":Es.value,onMapClick:gr,onPolygonComplete:ro,onPolygonDrawing:wt,onDone:Cc,onCancel:Il},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","route-color","route-style","route-weight","selected-area-id","center","zoom","highlight-location-id"]),Pe(wc,{show:He.value,title:rt.value,message:kt.value,onClose:oe[10]||(oe[10]=ce=>He.value=!1)},null,8,["show","title","message"]),Pe(hi,{show:F(c),title:F(d),message:F(h),"is-danger":F(f),"confirm-text":F(m),onConfirm:F(k),onCancel:F(_)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},nV=Ke(tV,[["__scopeId","data-v-efdf1f23"]]),oV={key:0,class:"emergency-notes-section"},aV={class:"emergency-notes-list"},sV={class:"note-header"},iV={key:0,class:"note-content"},lV={key:1,class:"emergency-contacts-section"},rV={class:"emergency-contacts-list"},cV={class:"contact-header"},uV={key:0,class:"role-badge"},dV={class:"contact-details"},hV={key:0,class:"info-section"},fV=["href"],pV={key:1,class:"info-section"},vV=["href"],mV={key:2,class:"info-section"},gV=["href"],yV={key:2,class:"no-contacts"},kV={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,a=t,o=H(()=>n.notes?[...n.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,_=f.displayOrder||f.DisplayOrder||0;if(k!==_)return k-_;const x=h.priority||h.Priority,D=f.priority||f.Priority;return x==="Emergency"&&D!=="Emergency"?-1:D==="Emergency"&&x!=="Emergency"?1:0}):[]),i=H(()=>n.contacts?n.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,_=f.displayOrder||f.DisplayOrder||0;if(k!==_)return k-_;const x=h.name||h.Name||"",D=f.name||f.Name||"";return x.localeCompare(D,void 0,{sensitivity:"base"})}):[]),l=()=>{a("close")},c=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(p(),qe(Zt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Ve(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[o.value.length>0?(p(),g("div",oV,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",aV,[(p(!0),g(Ie,null,je(o.value,m=>(p(),g("div",{key:m.noteId||m.NoteId,class:le(["emergency-note-item",{"is-emergency":(m.priority||m.Priority)==="Emergency"}])},[r("div",sV,[r("h3",null,b(m.title||m.Title),1),r("span",{class:le(["priority-badge",(m.priority||m.Priority).toLowerCase()])},b(m.priority||m.Priority),3)]),m.content||m.Content?(p(),g("div",iV,b(m.content||m.Content),1)):P("",!0)],2))),128))])])):P("",!0),i.value&&i.value.length>0?(p(),g("div",lV,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",rV,[(p(!0),g(Ie,null,je(i.value,m=>(p(),g("div",{key:m.contactId||m.name,class:"emergency-contact-item"},[r("div",cV,[r("h3",null,b(m.name),1),d(m).length>0?(p(),g("span",uV,b(d(m).map(c).join(", ")),1)):P("",!0)]),r("div",dV,[m.phone?(p(),g("div",hV,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${m.phone}`,class:"phone-link"},b(m.phone),9,fV)])):P("",!0),m.email?(p(),g("div",pV,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${m.email}`,class:"email-link"},b(m.email),9,vV)])):P("",!0),m.notes||m.details?(p(),g("div",mV,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,b(m.notes||m.details),1)])):P("",!0)]),m.phone?(p(),g("a",{key:0,href:`tel:${m.phone}`,class:"btn btn-danger btn-full"}," Call "+b(m.name),9,gV)):P("",!0)]))),128))])])):P("",!0),i.value.length===0&&o.value.length===0?(p(),g("div",yV,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},bV=Ke(kV,[["__scopeId","data-v-6ae197f1"]]),Pr=A(navigator.onLine),ks=A(!0),si=A(0),jc=A(null),Zi=A("idle"),er=A(null),of=A(!1);let mm=null,bh=!1,wa=null,gm=0;function wV(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Pu(){wa&&(clearTimeout(wa),wa=null);const e=wV(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),wa=setTimeout(async()=>{if(wa=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await _u()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Du();const n=await _u();n>0&&navigator.onLine&&(console.log(`${n} actions remaining, scheduling retry...`),Pu())},e)}async function Zl(){if(!navigator.onLine)return ks.value=!1,!1;try{return await CC.check(),ks.value=!0,!0}catch(e){return e.response?.status===404?(ks.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),ks.value=!1,!1)}}async function zf(){const e=Date.now();if(e-gm<2e3)return;gm=e;const t=navigator.onLine;if(Pr.value=t,!t){ks.value=!1;return}of.value=!0;try{await Zl()&&si.value>0&&Pu()}finally{of.value=!1}}function ym(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),zf())}function km(){console.log("Window focused, checking connectivity..."),zf()}async function _V(e){try{switch(e.type){case"checkin":await ri.checkIn(e.payload);break;case"checkin_toggle":await ri.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await ri.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await zt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await zt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const n=t.response.data?.message||t.response.data||"",a=typeof n=="string"?n.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Du(){if(!bh&&navigator.onLine){bh=!0,Zi.value="syncing",er.value=null;try{const e=await Fy();if(e.length===0){Zi.value="success",si.value=0;return}let t=0,n=0;for(const a of e){const o=await _V(a);if(o===!0)await bv(a.id),t++;else if(o==="permanent_failure")await bv(a.id),n++;else{const i=(a.attempts||0)+1;i>=5?(await kv(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),n++):await kv(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}si.value=await _u(),n>0?(Zi.value="error",er.value=`${n} action(s) failed to sync`):Zi.value="success"}catch(e){console.error("Sync error:",e),Zi.value="error",er.value="Failed to sync pending actions"}finally{bh=!1}}}function CV(){mm||(mm=setInterval(async()=>{navigator.onLine&&(await Zl(),ks.value&&si.value>0&&await Du())},3e4))}function Hf(){const e=H(()=>Pr.value&&ks.value);async function t(){si.value=await _u()}async function n(){Pr.value=!0,await Zl()&&si.value>0&&Pu()}function a(){Pr.value=!1,ks.value=!1,wa&&(clearTimeout(wa),wa=null)}un(async()=>{await xs(),await t(),window.addEventListener("online",n),window.addEventListener("offline",a),document.addEventListener("visibilitychange",ym),window.addEventListener("focus",km),navigator.onLine&&await Zl()&&si.value>0&&Pu(),CV()}),Ln(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",ym),window.removeEventListener("focus",km),wa&&(clearTimeout(wa),wa=null)});async function o(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await lc(d,f),jc.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await li(d);return h&&(jc.value=h.cachedAt),h}async function l(d){jc.value=await vC(d)}async function c(){return navigator.onLine?await Zl()?(await Du(),Zi.value==="success"):(er.value="Server is not responding",!1):(er.value="Cannot sync while offline",!1)}return{isOnline:Pr,isServerHealthy:ks,isFullyOnline:e,isCheckingStatus:of,pendingActionsCount:si,lastSyncTime:jc,syncStatus:Zi,syncError:er,checkServerHealth:Zl,quickConnectivityCheck:zf,syncPendingActions:Du,updatePendingCount:t,refreshCache:o,getCachedData:i,loadLastSyncTime:l,forcSync:c}}const LV={class:"offline-indicator-container"},SV={class:"offline-icon"},IV={key:0,viewBox:"0 0 24 24",fill:"currentColor"},xV={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},$V={class:"offline-text"},TV={key:0,class:"last-sync"},MV={class:"pending-text"},AV={key:0,class:"pending-subtext"},EV={key:1,class:"syncing-text"},PV={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:n,isCheckingStatus:a,pendingActionsCount:o,lastSyncTime:i,syncStatus:l,syncError:c,forcSync:d}=Hf(),h=A(!1),f=A(""),m=A(""),y=H(()=>{if(!i.value)return"";const _=new Date(i.value),D=new Date-_,M=Math.floor(D/6e4),S=Math.floor(M/60);return M<1?"just now":M<60?`${M}m ago`:S<24?`${S}h ago`:_.toLocaleDateString()}),k=async()=>{await d()};return Ye(l,_=>{_==="success"&&o.value===0?(f.value="All actions synced successfully!",m.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):_==="error"&&(f.value=c.value||"Sync failed",m.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(_,x)=>(p(),g("div",LV,[Pe(Ia,{name:"slide"},{default:Ve(()=>[F(n)?P("",!0):(p(),g("div",{key:0,class:le(["offline-banner",{checking:F(a)}])},[r("span",SV,[F(a)?(p(),g("svg",xV,[...x[1]||(x[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(p(),g("svg",IV,[...x[0]||(x[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",$V,b(F(a)?"Checking connection...":F(t)?"Server unavailable":"You're offline"),1),F(i)&&!F(a)?(p(),g("span",TV," Last synced: "+b(y.value),1)):P("",!0)],2))]),_:1}),Pe(Ia,{name:"fade"},{default:Ve(()=>[F(o)>0?(p(),g("div",{key:0,class:le(["pending-banner",{"offline-pending":!F(n)}])},[x[2]||(x[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",MV,[Je(b(F(o))+" pending action"+b(F(o)!==1?"s":"")+" ",1),F(n)?P("",!0):(p(),g("span",AV,"(will sync when online)"))]),F(n)&&F(l)!=="syncing"?(p(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):F(l)==="syncing"?(p(),g("span",EV,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Pe(Ia,{name:"fade"},{default:Ve(()=>[h.value?(p(),g("div",{key:0,class:le(["sync-toast",m.value])},b(f.value),3)):P("",!0)]),_:1})]))}},DV=Ke(PV,[["__scopeId","data-v-9c1e58f4"]]),RV={class:"modal-content check-in-reminder-modal"},OV={class:"modal-header warning"},BV={class:"modal-body"},NV={class:"reminder-message"},FV={key:0},UV={class:"reminder-hint"},zV={class:"modal-footer"},HV={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ht();return(n,a)=>(p(),qe(Ia,{name:"modal"},{default:Ve(()=>[e.show&&e.checkpoint?(p(),g("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=ct(o=>n.$emit("dismiss"),["self"]))},[r("div",RV,[r("div",OV,[a[4]||(a[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:a[0]||(a[0]=o=>n.$emit("dismiss"))},"")]),r("div",BV,[a[6]||(a[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",NV,[Je(" You have not checked in yet to "+b(F(t).checkpoint)+" ",1),r("strong",null,b(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(p(),g("span",FV," - "+b(e.checkpoint.location.description),1)):P("",!0),a[5]||(a[5]=Je(". ",-1))]),r("p",UV," Please check in when you arrive at your "+b(F(t).checkpoint)+". ",1)]),r("div",zV,[r("button",{onClick:a[1]||(a[1]=o=>n.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:a[2]||(a[2]=o=>n.$emit("go-to-checkpoint")),class:"btn btn-primary",style:tt(e.accentButtonStyle)}," Go to "+b(F(t).checkpoint),5)])])])):P("",!0)]),_:1}))}},VV=Ke(HV,[["__scopeId","data-v-4761fdb9"]]),GV={class:"modal-content location-update-modal"},qV={class:"modal-header"},jV={class:"modal-body"},WV={key:0,class:"success-message"},ZV={key:1},KV={class:"modal-description"},YV={key:0,class:"last-update-info"},JV={key:1,class:"gps-status active"},XV={class:"update-option"},QV=["disabled"],eG={class:"update-option auto-update-option"},tG={class:"checkbox-label"},nG=["checked"],oG={class:"option-hint"},aG={class:"update-option"},sG=["disabled"],iG={class:"update-option"},lG={class:"option-label"},rG={key:0,class:"checkpoint-list"},cG=["onClick","disabled"],uG={class:"checkpoint-name"},dG={key:0,class:"checkpoint-description"},hG={key:1,class:"no-checkpoints"},fG={key:2,class:"error"},pG={class:"modal-footer"},vG={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ht(),n=o=>o?new Date(o).toLocaleString():"",a=(o,i=50)=>o?o.length<=i?o:o.substring(0,i).trim()+"...":"";return(o,i)=>(p(),qe(Ia,{name:"modal"},{default:Ve(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=ct(l=>o.$emit("close"),["self"]))},[r("div",GV,[r("div",qV,[r("h3",null,"Update "+b(F(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>o.$emit("close"))},"")]),r("div",jV,[e.success?(p(),g("div",WV,b(e.success),1)):(p(),g("div",ZV,[r("p",KV,[i[6]||(i[6]=Je(" Update the position of ",-1)),r("strong",null,b(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(p(),g("div",YV," Last updated: "+b(n(e.assignment.location.lastLocationUpdate)),1)):P("",!0),e.userLocation?(p(),g("div",JV,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):P("",!0),r("div",XV,[r("button",{onClick:i[1]||(i[1]=l=>o.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:tt(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+b(e.updating?"Updating...":"Use current GPS location"),1)],12,QV)]),r("div",eG,[r("label",tG,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>o.$emit("toggle-auto-update"))},null,40,nG),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",oG,"Automatically updates the "+b(F(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",aG,[r("button",{onClick:i[3]||(i[3]=l=>o.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,sG)]),r("div",iG,[r("label",lG,"Or copy location from another "+b(F(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(p(),g("div",rG,[(p(!0),g(Ie,null,je(e.availableCheckpoints,l=>(p(),g("button",{key:l.id,onClick:c=>o.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",uG,b(l.name),1),l.description?(p(),g("span",dG,b(a(l.description)),1)):P("",!0)],8,cG))),128))])):(p(),g("p",hG," No other "+b(F(t).checkpoints)+" available to copy from. ",1))]),e.error?(p(),g("div",fG,b(e.error),1)):P("",!0)]))]),r("div",pG,[r("button",{onClick:i[4]||(i[4]=l=>o.$emit("close")),class:"btn btn-secondary"},b(e.success?"Ok":"Cancel"),1)])])])):P("",!0)]),_:1}))}},mG=Ke(vG,[["__scopeId","data-v-b3924a32"]]),gG={class:"contact-info"},yG={class:"contact-name-row"},kG={key:0,class:"primary-badge"},bG={class:"contact-name"},wG={key:0,class:"contact-notes-text"},_G={key:1,class:"contact-detail"},CG={key:2,class:"contact-detail"},LG={class:"contact-actions"},SG=["href"],IG=["href"],xG=["href"],$G={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),a=["Emergency","Safety","Medical","First Aid"],o=H(()=>n.value.length===0?!1:n.value.some(c=>a.some(d=>c.toLowerCase().includes(d.toLowerCase())))),i=c=>c?c.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=H(()=>n.value.length===0?"":n.value.map(i).join(", "));return(c,d)=>(p(),g("div",{class:le(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",gG,[r("div",yG,[e.isPrimary?(p(),g("span",kG,"")):P("",!0),r("span",bG,b(e.name),1),n.value.length>0?(p(),g("span",{key:1,class:le(["contact-role-badge",{"emergency-role":o.value}])},b(l.value),3)):P("",!0)]),e.notes?(p(),g("div",wG,b(e.notes),1)):P("",!0),e.phone?(p(),g("div",_G,b(e.phone),1)):P("",!0),e.email?(p(),g("div",CG,b(e.email),1)):P("",!0)]),r("div",LG,[e.phone?(p(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,SG)):P("",!0),e.phone?(p(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,IG)):P("",!0),e.email?(p(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,xG)):P("",!0)])],2))}},L1=Ke($G,[["__scopeId","data-v-2fdc8dea"]]),TG={key:0,class:"accordion-section"},MG={class:"accordion-title"},AG=["innerHTML"],EG={class:"accordion-icon"},PG={key:0,class:"accordion-content"},DG={key:0,class:"loading"},RG={key:1,class:"contact-list"},OG={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.contacts.length>0||e.loading?(p(),g("div",TG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",MG,[r("span",{class:"section-icon",innerHTML:F(to)("contacts")},null,8,AG),Je(" Your "+b(e.contacts.length===1?"contact":"contacts")+b(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",EG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",PG,[e.loading?(p(),g("div",DG,"Loading contacts...")):(p(),g("div",RG,[(p(!0),g(Ie,null,je(e.contacts,a=>(p(),qe(L1,{key:a.contactId,name:a.name,roles:a.roles,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):P("",!0)])):P("",!0)}},BG=Ke(OG,[["__scopeId","data-v-c3b5d73d"]]),NG={key:0,class:"accordion-section"},FG={class:"accordion-title"},UG=["innerHTML"],zG={class:"accordion-icon"},HG={key:0,class:"accordion-content"},VG={key:0,class:"loading-state"},GG={key:1,class:"empty-state"},qG={key:2,class:"incidents-list"},jG={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,n)=>e.incidents.length>0||e.loading?(p(),g("div",NG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",FG,[r("span",{class:"section-icon",innerHTML:F(to)("incidents")},null,8,UG),Je(" Your "+b(e.incidents.length===1?"incident":"incidents")+b(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",zG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",HG,[e.loading?(p(),g("div",VG," Loading incidents... ")):e.incidents.length===0?(p(),g("div",GG,[...n[1]||(n[1]=[r("p",null,"No incidents to show.",-1)])])):(p(),g("div",qG,[(p(!0),g(Ie,null,je(e.incidents,a=>(p(),qe(kc,{key:a.incidentId,incident:a,onSelect:o=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0)}},WG=Ke(jG,[["__scopeId","data-v-e84cbdf1"]]),ZG={key:0,class:"accordion-section"},KG={class:"accordion-title"},YG=["innerHTML"],JG={class:"accordion-icon"},XG={key:0,class:"accordion-content"},QG={class:"event-details"},eq={key:0,class:"event-detail-row"},tq={class:"detail-value"},nq={key:1,class:"event-description"},oq={class:"detail-value"},aq={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=n=>n?new Date(n).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(n,a)=>e.eventDate||e.description?(p(),g("div",ZG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=o=>n.$emit("toggle"))},[r("span",KG,[r("span",{class:"section-icon",innerHTML:F(to)("event")},null,8,YG),a[1]||(a[1]=Je(" Event details ",-1))]),r("span",JG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",XG,[r("div",QG,[e.eventDate?(p(),g("div",eq,[a[2]||(a[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",tq,b(t(e.eventDate)),1)])):P("",!0),e.description?(p(),g("div",nq,[a[3]||(a[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",oq,b(e.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)}},sq=Ke(aq,[["__scopeId","data-v-7c880ad1"]]),iq={class:"accordion-section"},lq={class:"accordion-title"},rq=["innerHTML"],cq={class:"accordion-icon"},uq={key:0,class:"accordion-content"},dq={key:0,class:"loading"},hq={key:1,class:"error"},fq={key:2,class:"empty-state"},pq={class:"checklist-section"},vq={key:0,class:"empty-state small"},mq={key:1,class:"my-jobs-list"},gq=["checked","disabled","onChange"],yq={key:0,class:"checklist-section"},kq={class:"checklist-section-title"},bq={key:0,class:"checklist-items"},wq={class:"item-checkbox"},_q=["checked","disabled","onChange"],Cq={class:"item-content"},Lq={key:0,class:"item-context"},Sq={key:1,class:"completion-info"},Iq={class:"completion-text"},xq={class:"completion-time"},$q={key:1,class:"checklist-groups"},Tq=["onClick"],Mq={class:"group-title"},Aq={class:"group-status"},Eq={class:"group-count"},Pq={class:"group-expand-icon"},Dq={key:0,class:"checklist-group-items"},Rq={class:"item-checkbox"},Oq=["checked","disabled","onChange"],Bq={class:"item-content"},Nq={key:0,class:"completion-info"},Fq={class:"completion-text"},Uq={class:"completion-time"},zq={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ht(),n=e,a=H(()=>n.visibleItems.length),o=i=>i?new Date(i).toLocaleString():"";return(i,l)=>(p(),g("div",iq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=c=>i.$emit("toggle"))},[r("span",lq,[r("span",{class:"section-icon",innerHTML:F(to)("checklist")},null,8,rq),Je(" Your "+b(F(t).checklists)+" ("+b(e.completedCount)+" of "+b(a.value)+" complete) ",1)]),r("span",cq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",uq,[e.loading?(p(),g("div",dq,"Loading checklist...")):e.error?(p(),g("div",hq,b(e.error),1)):a.value===0?(p(),g("div",fq,[r("p",null,"No "+b(F(t).checklists)+" for you.",1)])):e.isAreaLead?(p(),g(Ie,{key:3},[r("div",pq,[l[3]||(l[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(p(),g("div",vq,[...l[2]||(l[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(p(),g("div",mq,[(p(!0),g(Ie,null,je(e.myItems,c=>(p(),g("div",{key:`${c.itemId}_${c.completionContextType}_${c.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:c.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",c)},null,40,gq),r("span",{class:le(["my-job-text",{completed:c.isCompleted}])},b(c.text),3)]))),128))]))]),e.areaItems.length>0?(p(),g("div",yq,[r("h4",kq,"Your "+b(F(t).area)+"'s jobs",1),Pe(Uf,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:l[1]||(l[1]=c=>i.$emit("toggle-item",c))},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(p(),g(Ie,{key:4},[e.effectiveGroupBy==="none"?(p(),g("div",bq,[(p(!0),g(Ie,null,je(e.visibleItems,c=>(p(),g("div",{key:`${c.itemId}_${c.completionContextType}_${c.completionContextId}`,class:le(["checklist-item",{"item-completed":c.isCompleted}])},[r("div",wq,[r("input",{type:"checkbox",checked:c.isCompleted,disabled:!c.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",c)},null,40,_q)]),r("div",Cq,[r("div",{class:le(["item-text",{"text-completed":c.isCompleted}])},b(c.text),3),e.getContextName(c)?(p(),g("div",Lq,b(e.getContextName(c)),1)):P("",!0),c.isCompleted?(p(),g("div",Sq,[r("span",Iq," Completed by "+b(c.completedByActorName||"Unknown"),1),r("span",xq,b(o(c.completedAt)),1)])):P("",!0)])],2))),128))])):(p(),g("div",$q,[(p(!0),g(Ie,null,je(e.groupedItems,c=>(p(),g("div",{key:c.key,class:"checklist-group"},[r("button",{class:le(["checklist-group-header",{expanded:e.expandedGroup===c.key,"all-complete":c.completedCount===c.items.length}]),onClick:d=>i.$emit("toggle-group",c.key)},[r("span",Mq,b(c.name),1),r("span",Aq,[r("span",Eq,b(c.completedCount)+"/"+b(c.items.length),1),r("span",Pq,b(e.expandedGroup===c.key?"":"+"),1)])],10,Tq),e.expandedGroup===c.key?(p(),g("div",Dq,[(p(!0),g(Ie,null,je(c.items,d=>(p(),g("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:le(["checklist-item",{"item-completed":d.isCompleted}])},[r("div",Rq,[r("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:h=>i.$emit("toggle-item",d)},null,40,Oq)]),r("div",Bq,[r("div",{class:le(["item-text",{"text-completed":d.isCompleted}])},b(d.text),3),d.isCompleted?(p(),g("div",Nq,[r("span",Fq,b(d.completedByActorName||"Unknown"),1),r("span",Uq,b(o(d.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]))}},Hq=Ke(zq,[["__scopeId","data-v-b2878e4f"]]),Vq={class:"accordion-section"},Gq={class:"accordion-title"},qq=["innerHTML"],jq={class:"accordion-icon"},Wq={key:0,class:"accordion-content"},Zq={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,n)=>(p(),g("div",Vq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",Gq,[r("span",{class:"section-icon",innerHTML:F(to)("notes")},null,8,qq),Je(" Your "+b(e.notes.length===1?"note":"notes")+b(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",jq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Wq,[Pe(ld,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:n[1]||(n[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]))}},Kq=Ke(Zq,[["__scopeId","data-v-10b7523a"]]),Yq={class:"accordion-section"},Jq={class:"accordion-title"},Xq=["innerHTML"],Qq={key:0,class:"location-status active"},ej={key:1,class:"location-status"},tj={class:"accordion-icon"},nj={key:0,class:"accordion-content map-content"},oj={key:0,class:"map-selection-banner"},aj={class:"map-wrapper"},sj={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:n}=ht(),a=xo("marshalBranding",{headerStyle:{},headerTextColor:""}),o=al({headerStyle:H(()=>ru(a.headerStyle)),headerTextColor:H(()=>ru(a.headerTextColor))}),i=A(null);return t({mapRef:i,recenterOnLocation:(l,c,d)=>i.value?.recenterOnLocation?.(l,c,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,c)=>(p(),g("div",Yq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:c[0]||(c[0]=d=>l.$emit("toggle"))},[r("span",Jq,[r("span",{class:"section-icon",innerHTML:F(to)("course")},null,8,Xq),Je(" "+b(F(n).course)+" ",1),e.userLocation?(p(),g("span",Qq,"GPS Active")):(p(),g("span",ej,"GPS Inactive"))]),r("span",tj,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",nj,[e.selectingLocation?(p(),g("div",oj,[r("span",null,[c[7]||(c[7]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),r("div",aj,[Pe(il,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!1,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":F(n).course,"fullscreen-header-style":o.headerStyle,"fullscreen-header-text-color":o.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:le({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:c[3]||(c[3]=d=>l.$emit("map-click",d)),onLocationClick:c[4]||(c[4]=d=>l.$emit("location-click",d)),onActionClick:c[5]||(c[5]=d=>l.$emit("action-click",d)),onVisibilityChange:c[6]||(c[6]=d=>l.$emit("visibility-change",d))},yf({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ve(()=>[r("span",null,[c[8]||(c[8]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[2]||(c[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]))}},ij=Ke(sj,[["__scopeId","data-v-ff7cc2e4"]]),lj={class:"area-lead-content"},rj={key:0,class:"loading-state"},cj={key:1,class:"error-state"},uj={key:2,class:"empty-state"},dj={key:3,class:"checkpoint-accordion"},hj=["onClick"],fj={class:"checkpoint-header-content"},pj={class:"checkpoint-title-row"},vj={class:"checkpoint-name"},mj={key:0,class:"area-badge"},gj={key:0,class:"checkpoint-description-preview"},yj={class:"checkpoint-status-row"},kj={class:"status-badge marshals-status"},bj={key:0,class:"status-badge tasks-status"},wj={class:"accordion-icon"},_j={key:0,class:"checkpoint-accordion-content"},Cj={class:"checkpoint-mini-map"},Lj={class:"checkpoint-marshals-section"},Sj={class:"marshals-label"},Ij={key:0,class:"empty-state"},xj={key:1,class:"marshals-list"},$j=["onClick"],Tj={class:"marshal-header"},Mj={class:"marshal-name-row"},Aj={class:"marshal-name"},Ej={key:0,class:"task-count"},Pj={class:"check-status-row"},Dj=["onClick","disabled"],Rj={key:0,class:"check-in-time"},Oj={key:0},Bj={key:1,class:"last-access-time"},Nj={key:0,class:"checkpoint-tasks-section"},Fj={class:"marshals-label"},Uj={class:"tasks-list"},zj=["disabled","onChange"],Hj={class:"task-text"},Vj=["disabled","onChange"],Gj={class:"task-text"},qj={key:0,class:"marshal-details-modal"},jj={class:"details-section"},Wj={class:"contact-info"},Zj={key:0,class:"contact-row"},Kj=["href"],Yj={key:1,class:"contact-row"},Jj=["href"],Xj={key:2,class:"no-contact"},Qj={class:"details-section"},eW={key:0,class:"checked-in-section"},tW={class:"checked-in-details"},nW={class:"check-time-detail"},oW={key:0,class:"check-method"},aW=["disabled"],sW={key:1,class:"not-checked-in-section"},iW=["disabled"],lW={key:2,class:"last-access-detail"},rW={class:"details-section"},cW={key:0,class:"no-tasks"},uW={key:1,class:"tasks-list modal-tasks"},dW=["disabled","onChange"],hW={class:"task-text"},fW={class:"details-section contact-actions-section"},pW={class:"contact-buttons"},vW=["href"],mW=["href"],gW=["href"],yW={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),{updatePendingCount:i}=Hf(),l=e,c=n,d=A(!1),h=A(null),f=A([]),m=A([]),y=A(null),k=A(!1),_=A(null),x=H(()=>{const U=new Set(l.areaIds);return U.size===0?[...m.value].sort((X,ae)=>ea(X.name,ae.name)):m.value.filter(X=>(X.areaIds||[]).some(he=>U.has(he))).sort((X,ae)=>ea(X.name,ae.name))}),D=(U,X=60)=>U?U.length<=X?U:U.substring(0,X).trim()+"...":"",M=A(!1),S=A(null),w=A(null),I=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,Zn()){try{const U=await li(l.eventId);if(U?.areaLeadDashboard){f.value=U.areaLeadDashboard.areas||[],m.value=U.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(U){console.warn("Failed to load cached dashboard:",U)}h.value="Offline - no cached data available",d.value=!1;return}try{const U=await ms.getAreaLeadDashboard(l.eventId);f.value=U.data.areas||[],m.value=U.data.checkpoints||[];try{const X=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await li(l.eventId)?await eu(l.eventId,"areaLeadDashboard",X):await lc(l.eventId,{areaLeadDashboard:X})}catch(X){console.warn("Failed to cache dashboard:",X)}}catch(U){console.error("Failed to load area lead dashboard:",U);try{const X=await li(l.eventId);if(X?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=X.areaLeadDashboard.areas||[],m.value=X.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(X){console.warn("Failed to load cached dashboard:",X)}h.value=U.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},T=U=>{y.value=y.value===U?null:U},B=U=>U.marshals.filter(X=>X.isCheckedIn).length,E=U=>{const X=U.marshals.reduce((ae,he)=>ae+he.outstandingTaskCount,0);return U.outstandingTaskCount+X},N=(U,X)=>{S.value=U,w.value=X,M.value=!0},$=()=>{M.value=!1,S.value=null,w.value=null},z=async(U,X)=>{if(_.value)return;const ae=U.assignmentId||U.id;if(!ae){console.error("No assignment ID found for marshal:",U);return}_.value=U.marshalId;try{if(Zn())await Ro("checkin_toggle",{eventId:l.eventId,assignmentId:ae}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated");else if(await ri.toggleCheckIn(l.eventId,ae),await I(),c("checkin-updated"),S.value?.marshalId===U.marshalId&&w.value){const he=m.value.find($e=>$e.checkpointId===w.value.checkpointId);if(he){const $e=he.marshals.find(Ee=>Ee.marshalId===U.marshalId);$e&&(S.value=$e)}}}catch(he){console.error("Failed to check in marshal:",he),(Zn()||!he.response)&&(await Ro("checkin_toggle",{eventId:l.eventId,assignmentId:ae}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated"))}finally{_.value=null}},O=async(U,X)=>{if(k.value)return;k.value=!0;const he={marshalId:X.marshals.length>0?X.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId};try{Zn()?(await Ro("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:he}),X.outstandingTasks=X.outstandingTasks.filter($e=>$e.itemId!==U.itemId),X.outstandingTaskCount=Math.max(0,X.outstandingTaskCount-1),await i(),c("checklist-updated")):(await zt.complete(l.eventId,U.itemId,he),await I(),c("checklist-updated"))}catch($e){console.error("Failed to complete task:",$e),(Zn()||!$e.response)&&(await Ro("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:he}),X.outstandingTasks=X.outstandingTasks.filter(Ee=>Ee.itemId!==U.itemId),X.outstandingTaskCount=Math.max(0,X.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},j=async(U,X)=>{if(k.value)return;k.value=!0;const he={marshalId:X.marshals.length>0?X.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId,actorMarshalId:l.marshalId};try{Zn()?(await Ro("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:he}),X.completedTasks&&(X.completedTasks=X.completedTasks.filter($e=>$e.itemId!==U.itemId)),X.outstandingTasks||(X.outstandingTasks=[]),X.outstandingTasks.push(U),X.outstandingTaskCount=(X.outstandingTaskCount||0)+1,await i(),c("checklist-updated")):(await zt.uncomplete(l.eventId,U.itemId,he),await I(),c("checklist-updated"))}catch($e){console.error("Failed to uncomplete task:",$e),(Zn()||!$e.response)&&(await Ro("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:he}),X.completedTasks&&(X.completedTasks=X.completedTasks.filter(Ee=>Ee.itemId!==U.itemId)),X.outstandingTasks||(X.outstandingTasks=[]),X.outstandingTasks.push(U),X.outstandingTaskCount=(X.outstandingTaskCount||0)+1,await i(),c("checklist-updated"))}finally{k.value=!1}},Z=async U=>{if(k.value||!S.value)return;k.value=!0;const X={marshalId:S.value.marshalId,contextType:U.contextType,contextId:U.contextId};try{if(Zn())await Ro("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:X}),S.value.outstandingTasks=S.value.outstandingTasks.filter(ae=>ae.itemId!==U.itemId),S.value.outstandingTaskCount=Math.max(0,S.value.outstandingTaskCount-1),await i(),c("checklist-updated");else{if(await zt.complete(l.eventId,U.itemId,X),await I(),S.value&&w.value){const ae=m.value.find(he=>he.checkpointId===w.value.checkpointId);if(ae){const he=ae.marshals.find($e=>$e.marshalId===S.value.marshalId);he&&(S.value=he)}}c("checklist-updated")}}catch(ae){console.error("Failed to complete task:",ae),(Zn()||!ae.response)&&(await Ro("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:X}),S.value.outstandingTasks=S.value.outstandingTasks.filter(he=>he.itemId!==U.itemId),S.value.outstandingTaskCount=Math.max(0,S.value.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},J=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",re=U=>U?new Date(U).toLocaleString():"",K=U=>{if(!U)return"";const X=new Date(U),he=new Date-X,$e=Math.floor(he/6e4),Ee=Math.floor($e/60),Me=Math.floor(Ee/24);return $e<1?"just now":$e<60?`${$e}m ago`:Ee<24?`${Ee}h ago`:Me===1?"yesterday":Me<7?`${Me}d ago`:X.toLocaleDateString()},ie=U=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[U]||U;return t({areas:f,checkpoints:m,loading:d,loadDashboard:I}),Ye(()=>l.eventId,()=>{I()},{immediate:!0}),(U,X)=>(p(),g("div",lj,[d.value?(p(),g("div",rj," Loading dashboard... ")):h.value?(p(),g("div",cj,[r("p",null,b(h.value),1),r("button",{onClick:I,class:"btn btn-secondary"},"Retry")])):x.value.length===0?(p(),g("div",uj,[r("p",null,"No "+b(F(o).checkpoints)+" in your "+b(F(o).areas)+".",1)])):(p(),g("div",dj,[(p(!0),g(Ie,null,je(x.value,ae=>(p(),g("div",{key:ae.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:le(["checkpoint-accordion-header",{active:y.value===ae.checkpointId}]),onClick:he=>T(ae.checkpointId)},[r("div",fj,[r("div",pj,[r("span",vj,b(ae.name),1),ae.areaName?(p(),g("span",mj,b(ae.areaName),1)):P("",!0)]),ae.description?(p(),g("div",gj,b(D(ae.description)),1)):P("",!0),r("div",yj,[r("span",kj,b(B(ae))+" / "+b(ae.marshals.length)+" checked in ",1),E(ae)>0?(p(),g("span",bj,b(E(ae))+" tasks ",1)):P("",!0)])]),r("span",wj,b(y.value===ae.checkpointId?"":"+"),1)],10,hj),y.value===ae.checkpointId?(p(),g("div",_j,[r("div",Cj,[Pe(il,{locations:[{id:ae.checkpointId,name:ae.name,description:ae.description,latitude:ae.latitude,longitude:ae.longitude}],route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:ae.latitude,lng:ae.longitude},zoom:16,"highlight-location-id":ae.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","route-color","route-style","route-weight","center","highlight-location-id"])]),r("div",Lj,[r("div",Sj,b(F(a).people)+" ("+b(ae.marshals.length)+")",1),ae.marshals.length===0?(p(),g("div",Ij," No "+b(F(o).people)+" assigned to this "+b(F(o).checkpoint)+". ",1)):(p(),g("div",xj,[(p(!0),g(Ie,null,je(ae.marshals,he=>(p(),g("div",{key:he.marshalId,class:le(["marshal-card",{"is-checked-in":he.isCheckedIn}]),onClick:$e=>N(he,ae)},[r("div",Tj,[r("div",Mj,[r("span",Aj,b(he.name),1),he.outstandingTaskCount>0?(p(),g("span",Ej,b(he.outstandingTaskCount)+" tasks ",1)):P("",!0)]),r("div",Pj,[r("div",{class:le(["check-status",{"checked-in":he.isCheckedIn}])},b(he.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:ct($e=>z(he),["stop"]),class:le(["quick-checkin-btn",{"undo-btn":he.isCheckedIn}]),disabled:_.value===he.marshalId},b(_.value===he.marshalId?"...":he.isCheckedIn?"Undo":"Check In"),11,Dj)])]),he.isCheckedIn&&he.checkInTime?(p(),g("div",Rj,[Je(b(J(he.checkInTime))+" ",1),he.checkInMethod?(p(),g("span",Oj," ("+b(ie(he.checkInMethod))+")",1)):P("",!0)])):P("",!0),he.lastAccessedAt?(p(),g("div",Bj," Last active: "+b(K(he.lastAccessedAt)),1)):P("",!0)],10,$j))),128))]))]),ae.outstandingTaskCount>0||ae.completedTasks&&ae.completedTasks.length>0?(p(),g("div",Nj,[r("div",Fj,b(F(a).checkpoint)+" tasks",1),r("div",Uj,[(p(!0),g(Ie,null,je(ae.outstandingTasks,he=>(p(),g("div",{key:he.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:$e=>O(he,ae)},null,40,zj),r("span",Hj,b(he.text),1)]))),128)),(p(!0),g(Ie,null,je(ae.completedTasks||[],he=>(p(),g("div",{key:`completed-${he.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:$e=>j(he,ae)},null,40,Vj),r("span",Gj,b(he.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Pe(Zt,{show:M.value,title:S.value?.name||"Marshal Details",size:"large",onClose:$},{actions:Ve(()=>[r("button",{onClick:$,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[S.value?(p(),g("div",qj,[r("div",jj,[X[4]||(X[4]=r("h4",null,"Contact Details",-1)),r("div",Wj,[S.value.email?(p(),g("div",Zj,[X[2]||(X[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${S.value.email}`},b(S.value.email),9,Kj)])):P("",!0),S.value.phoneNumber?(p(),g("div",Yj,[X[3]||(X[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${S.value.phoneNumber}`},b(S.value.phoneNumber),9,Jj)])):P("",!0),!S.value.email&&!S.value.phoneNumber?(p(),g("div",Xj," No contact details available. ")):P("",!0)])]),r("div",Qj,[X[8]||(X[8]=r("h4",null,"Check-in Status",-1)),S.value.isCheckedIn?(p(),g("div",eW,[r("div",tW,[X[6]||(X[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[X[5]||(X[5]=r("strong",null,"Checked In",-1)),r("p",nW,b(re(S.value.checkInTime)),1),S.value.checkInMethod?(p(),g("p",oW," Method: "+b(ie(S.value.checkInMethod)),1)):P("",!0)])]),r("button",{onClick:X[0]||(X[0]=ae=>z(S.value,w.value)),class:"btn btn-secondary undo-checkin-btn",disabled:_.value===S.value.marshalId},b(_.value===S.value.marshalId?"Undoing...":"Undo Check-in"),9,aW)])):(p(),g("div",sW,[X[7]||(X[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:X[1]||(X[1]=ae=>z(S.value,w.value)),class:"btn btn-primary check-in-btn",disabled:_.value===S.value.marshalId},b(_.value===S.value.marshalId?"Checking in...":"Check In"),9,iW)])),S.value.lastAccessedAt?(p(),g("div",lW," Last active: "+b(K(S.value.lastAccessedAt)),1)):P("",!0)]),r("div",rW,[r("h4",null,b(F(a).checklists)+" ("+b(S.value.outstandingTasks?.length||0)+" outstanding)",1),!S.value.outstandingTasks||S.value.outstandingTasks.length===0?(p(),g("div",cW," No outstanding tasks. ")):(p(),g("div",uW,[(p(!0),g(Ie,null,je(S.value.outstandingTasks,ae=>(p(),g("div",{key:ae.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:he=>Z(ae)},null,40,dW),r("span",hW,b(ae.text),1)]))),128))]))]),r("div",fW,[r("div",pW,[S.value.phoneNumber?(p(),g("a",{key:0,href:`tel:${S.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,vW)):P("",!0),S.value.phoneNumber?(p(),g("a",{key:1,href:`sms:${S.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,mW)):P("",!0),S.value.email?(p(),g("a",{key:2,href:`mailto:${S.value.email}`,class:"btn btn-secondary"}," Email ",8,gW)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},kW=Ke(yW,[["__scopeId","data-v-57f3b188"]]),bW={key:0,class:"accordion-section"},wW={class:"accordion-title"},_W=["innerHTML"],CW={class:"accordion-icon"},LW={key:0,class:"accordion-content area-lead-accordion-content"},SW={key:0,class:"area-filter-pills"},IW=["onClick"],xW={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:n}=ht(),a=A(null);return t({areaLeadRef:a}),(o,i)=>e.isAreaLead?(p(),g("div",bW,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",wW,[r("span",{class:"section-icon",innerHTML:F(to)("area")},null,8,_W),Je(" Your "+b(e.areas.length===1?F(n).area:F(n).areas)+b(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",CW,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",LW,[e.areas.length>1?(p(),g("div",SW,[(p(!0),g(Ie,null,je(e.areas,l=>(p(),g("button",{key:l.areaId,class:le(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:tt(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:c=>o.$emit("toggle-filter",l.areaId)},b(l.name),15,IW))),128))])):P("",!0),Pe(kW,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,onChecklistUpdated:i[1]||(i[1]=l=>o.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route","route-color","route-style","route-weight"])])):P("",!0)])):P("",!0)}},$W=Ke(xW,[["__scopeId","data-v-26e83023"]]),TW={key:0,class:"accordion-section"},MW={class:"accordion-title"},AW=["innerHTML"],EW={class:"accordion-icon"},PW={key:0,class:"accordion-content area-lead-marshals-content"},DW={class:"area-lead-marshals-list"},RW=["onClick"],OW={class:"marshal-header-info"},BW={class:"marshal-name-row"},NW={class:"marshal-name"},FW={class:"marshal-meta"},UW={class:"marshal-checkpoint"},zW={key:0,class:"marshal-task-count"},HW={class:"accordion-icon"},VW={key:0,class:"area-lead-marshal-content"},GW={key:0,class:"marshal-actions-row"},qW=["onClick"],jW={key:1,class:"marshal-contact-section"},WW=["href"],ZW=["href"],KW={key:2,class:"marshal-tasks-section"},YW={class:"tasks-label"},JW={class:"tasks-list"},XW=["checked","disabled","onChange"],QW={class:"task-text"},eZ={key:3,class:"no-tasks-message"},tZ={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1},currentMarshalId:{type:String,default:null}},emits:["toggle","toggle-marshal","check-in","toggle-task","show-qr"],setup(e){const{terms:t,termsLower:n}=ht(),a=o=>{if(!o||o.length===0)return"";const i=l=>l.description?`${l.name} - ${l.description}`:l.name;return o.length===1?i(o[0]):o.map(i).join(", ")};return(o,i)=>e.isAreaLead&&e.marshals.length>0?(p(),g("div",TW,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",MW,[r("span",{class:"section-icon",innerHTML:F(to)("marshal")},null,8,AW),Je(" Your "+b(e.marshals.length===1?F(n).person:F(n).people)+b(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",EW,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",PW,[r("div",DW,[(p(!0),g(Ie,null,je(e.marshals,l=>(p(),g("div",{key:l.marshalId,class:"area-lead-marshal-item"},[r("button",{class:le(["area-lead-marshal-header",{active:e.expandedMarshalId===l.marshalId,"is-checked-in":l.isCheckedIn}]),onClick:c=>o.$emit("toggle-marshal",l.marshalId)},[r("div",OW,[r("div",BW,[r("span",NW,b(l.name),1),r("span",{class:le(["check-status-badge",{"checked-in":l.isCheckedIn}])},b(l.isCheckedIn?"":""),3)]),r("div",FW,[r("span",UW,b(a(l.checkpoints)),1),l.totalTaskCount>0?(p(),g("span",zW,b(l.completedTaskCount)+" / "+b(l.totalTaskCount)+" "+b(F(n).checklists)+" complete ",1)):P("",!0)])]),r("span",HW,b(e.expandedMarshalId===l.marshalId?"":"+"),1)],10,RW),e.expandedMarshalId===l.marshalId?(p(),g("div",VW,[l.marshalId!==e.currentMarshalId?(p(),g("div",GW,[Pe(xu,{"is-checked-in":l.isCheckedIn,"check-in-time":l.checkInTime,"check-in-method":l.checkInMethod,"checked-in-by":l.checkedInBy,"marshal-name":l.marshalName,"is-loading":e.checkingInMarshalId===l.id,onToggle:c=>o.$emit("check-in",l)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct(c=>o.$emit("show-qr",l),["stop"]),title:"Show QR code for magic link"},[...i[1]||(i[1]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-f53b5160><rect x="3" y="3" width="7" height="7" data-v-f53b5160></rect><rect x="14" y="3" width="7" height="7" data-v-f53b5160></rect><rect x="3" y="14" width="7" height="7" data-v-f53b5160></rect><rect x="14" y="14" width="3" height="3" data-v-f53b5160></rect><rect x="19" y="14" width="2" height="2" data-v-f53b5160></rect><rect x="14" y="19" width="2" height="2" data-v-f53b5160></rect><rect x="19" y="19" width="2" height="2" data-v-f53b5160></rect></svg>',1)])],8,qW)])):P("",!0),l.email||l.phoneNumber?(p(),g("div",jW,[l.phoneNumber?(p(),g("a",{key:0,href:`tel:${l.phoneNumber}`,class:"contact-link"},b(l.phoneNumber),9,WW)):P("",!0),l.email?(p(),g("a",{key:1,href:`mailto:${l.email}`,class:"contact-link"},b(l.email),9,ZW)):P("",!0)])):P("",!0),l.allTasks.length>0?(p(),g("div",KW,[r("div",YW,b(F(t).checklists),1),r("div",JW,[(p(!0),g(Ie,null,je(l.allTasks,c=>(p(),g("div",{key:`${c.itemId}-${c.contextId}`,class:le(["task-item",{"task-completed":c.isCompleted}])},[r("input",{type:"checkbox",checked:c.isCompleted,disabled:e.savingTask,onChange:d=>o.$emit("toggle-task",c,l)},null,40,XW),r("span",QW,b(c.text),1)],2))),128))])])):(p(),g("div",eZ," No "+b(F(n).checklists)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0)}},nZ=Ke(tZ,[["__scopeId","data-v-f53b5160"]]),oZ={class:"checkpoint-note-header"},aZ={key:0,class:"pin-icon",title:"Pinned"},sZ={class:"checkpoint-note-title"},iZ={key:0,class:"checkpoint-note-content"},lZ={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>(t.priority||"Normal").toLowerCase());return(a,o)=>(p(),g("div",{class:le(["checkpoint-note-item",n.value])},[r("div",oZ,[e.isPinned?(p(),g("span",aZ,"")):P("",!0),r("span",{class:le(["priority-indicator",n.value])},null,2),r("strong",sZ,b(e.title),1),r("span",{class:le(["priority-badge",n.value])},b(e.priority),3)]),e.content?(p(),g("div",iZ,b(e.content),1)):P("",!0)],2))}},rZ=Ke(lZ,[["__scopeId","data-v-5f2df920"]]),cZ={class:"checkpoint-accordion-section"},uZ={class:"checkpoint-header-content"},dZ={class:"checkpoint-title-row"},hZ=["innerHTML"],fZ={key:0,class:"checkpoint-check-icon"},pZ={class:"checkpoint-name"},vZ={key:1,class:"area-badge"},mZ={key:2,class:"checkpoint-time-badge"},gZ={key:3,class:"checkpoint-distance-badge"},yZ={key:0,class:"checkpoint-description-preview"},kZ={class:"accordion-icon"},bZ={key:0,class:"checkpoint-accordion-content"},wZ={key:0,class:"checkpoint-mini-map"},_Z={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},CZ={class:"my-checkin-section"},LZ={key:0,class:"check-in-error"},SZ={key:1,class:"dynamic-location-section"},IZ={class:"dynamic-location-header"},xZ={class:"dynamic-badge"},$Z={key:0,class:"last-update"},TZ={key:0,class:"dynamic-location-actions"},MZ=["disabled"],AZ=["title"],EZ={class:"checkpoint-marshals"},PZ={class:"marshals-label"},DZ={key:0,class:"marshals-list"},RZ={key:0,class:"check-badge"},OZ={key:1,class:"marshals-list-expanded"},BZ=["onClick"],NZ={class:"marshal-name-text"},FZ={class:"marshal-status-icons"},UZ={key:0,class:"check-badge"},zZ={class:"expand-icon"},HZ={key:0,class:"marshal-details-panel"},VZ={class:"detail-row"},GZ={key:0,class:"detail-row"},qZ={key:1,class:"detail-row"},jZ={key:2,class:"detail-row"},WZ=["href"],ZZ={key:3,class:"detail-row"},KZ=["href"],YZ={key:4,class:"contact-buttons-mini"},JZ=["href"],XZ=["href"],QZ=["href"],eK={key:5,class:"checkpoint-marshal-actions"},tK=["onClick"],nK={key:2,class:"checkpoint-area-contacts"},oK={class:"marshals-label"},aK={class:"contact-list"},sK={key:3,class:"checkpoint-notes"},iK={class:"checkpoint-notes-list"},lK={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{terms:n,termsLower:a}=ht(),o=xo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=al({headerStyle:H(()=>ru(o.headerStyle)),headerTextColor:H(()=>ru(o.headerTextColor))}),l=e,c=A(null),d=H(()=>l.assignment.location?.isDynamic),h=H(()=>{const S=l.assignment.location?.name||l.assignment.locationName,w=l.assignment.location?.description;return w?`${S}  ${w}`:S}),f=H(()=>{if(!d.value)return!1;const S=l.assignment.location,w=S?.locationUpdateScopeConfigurations||S?.LocationUpdateScopeConfigurations||[];return Yy({scopeConfigurations:w,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),m=H(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const S=l.assignment.location;return!S?.latitude||!S?.longitude?null:sl(l.userLocation.lat,l.userLocation.lng,S.latitude,S.longitude)}),y=H(()=>{const S=m.value;return S==null?null:S<1e3?`${Math.round(S/10)*10} m`:`${(Math.round(S/100)/10).toFixed(1)} km`});t({mapRef:c});const k=S=>{const w=S?.iconType||"checkpoint",I=S?.iconColor||"#667eea",T={checkpoint:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return T[w]||T.checkpoint},_=(S,w)=>{const I=T=>T?new Date(T).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return S&&w?`${I(S)} - ${I(w)}`:S?`from ${I(S)}`:w?`until ${I(w)}`:""},x=S=>S?new Date(S).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",D=S=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[S]||S,M=S=>S?new Date(S).toLocaleString():"";return(S,w)=>(p(),g("div",cZ,[r("button",{class:le(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:w[0]||(w[0]=I=>S.$emit("toggle"))},[r("div",uZ,[r("div",dZ,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,hZ),e.assignment.effectiveIsCheckedIn?(p(),g("span",fZ,"")):P("",!0),r("span",pZ,b(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(p(),g("span",vZ,b(e.assignment.areaName),1)):P("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(p(),g("span",mZ,b(_(e.assignment.location.startTime,e.assignment.location.endTime)),1)):P("",!0),y.value?(p(),g("span",gZ,b(y.value),1)):P("",!0)]),e.assignment.location?.description?(p(),g("div",yZ,b(e.assignment.location.description),1)):P("",!0)]),r("span",kZ,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",bZ,[e.assignment.location?(p(),g("div",wZ,[Pe(il,{ref_key:"mapRef",ref:c,locations:e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:w[2]||(w[2]=I=>S.$emit("map-click",I)),onLocationClick:w[3]||(w[3]=I=>S.$emit("location-click",I)),onActionClick:w[4]||(w[4]=I=>S.$emit("action-click",I)),onVisibilityChange:w[5]||(w[5]=I=>S.$emit("visibility-change",I))},yf({_:2},[f.value?{name:"fullscreen-footer",fn:Ve(()=>[r("button",{class:"btn btn-primary",onClick:w[1]||(w[1]=I=>S.$emit("update-location"))},[(p(),g("svg",_Z,[...w[9]||(w[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),w[10]||(w[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):P("",!0),r("div",CZ,[Pe(xu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:w[6]||(w[6]=I=>S.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(p(),g("div",LZ,b(e.checkInError),1)):P("",!0)]),d.value?(p(),g("div",SZ,[r("div",IZ,[r("span",xZ,"Dynamic "+b(e.assignment.location.resolvedCheckpointTerm||F(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(p(),g("span",$Z," Last updated: "+b(M(e.assignment.location.lastLocationUpdate)),1)):P("",!0)]),f.value?(p(),g("div",TZ,[r("button",{onClick:w[7]||(w[7]=I=>S.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...w[11]||(w[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,MZ),r("button",{onClick:w[8]||(w[8]=I=>S.$emit("toggle-auto-update")),class:le(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[w[12]||(w[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+b(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,AZ)])):P("",!0)])):P("",!0),r("div",EZ,[r("div",PZ,b(F(n).people)+":",1),e.isAreaLeadForCheckpoint?(p(),g("div",OZ,[(p(!0),g(Ie,null,je(e.assignment.allMarshals,I=>(p(),g("div",{key:I.marshalId,class:le(["marshal-card-mini",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn,expanded:e.expandedMarshalId===I.marshalId}])},[r("button",{class:"marshal-card-header",onClick:T=>S.$emit("toggle-marshal",I.marshalId)},[r("span",NZ,b(I.marshalName)+b(I.marshalId===e.currentMarshalId?" (you)":""),1),r("span",FZ,[I.effectiveIsCheckedIn?(p(),g("span",UZ,"")):P("",!0),r("span",zZ,b(e.expandedMarshalId===I.marshalId?"":"+"),1)])],8,BZ),e.expandedMarshalId===I.marshalId?(p(),g("div",HZ,[r("div",VZ,[w[13]||(w[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:le(I.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},b(I.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),I.effectiveIsCheckedIn&&I.checkInTime?(p(),g("div",GZ,[w[14]||(w[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,b(x(I.checkInTime)),1)])):P("",!0),I.checkInMethod?(p(),g("div",qZ,[w[15]||(w[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,b(D(I.checkInMethod)),1)])):P("",!0),I.email?(p(),g("div",jZ,[w[16]||(w[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+I.email},b(I.email),9,WZ)])):P("",!0),I.phoneNumber?(p(),g("div",ZZ,[w[17]||(w[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+I.phoneNumber},b(I.phoneNumber),9,KZ)])):P("",!0),I.email||I.phoneNumber?(p(),g("div",YZ,[I.phoneNumber?(p(),g("a",{key:0,href:"tel:"+I.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,JZ)):P("",!0),I.phoneNumber?(p(),g("a",{key:1,href:"sms:"+I.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,XZ)):P("",!0),I.email?(p(),g("a",{key:2,href:"mailto:"+I.email,class:"btn btn-sm btn-secondary"},"Email",8,QZ)):P("",!0)])):P("",!0),I.marshalId!==e.currentMarshalId?(p(),g("div",eK,[Pe(xu,{"is-checked-in":I.effectiveIsCheckedIn,"check-in-time":I.checkInTime,"check-in-method":I.checkInMethod,"checked-in-by":I.checkedInBy,"marshal-name":I.marshalName,"is-loading":e.checkingInMarshalId===I.id,onToggle:T=>S.$emit("marshal-check-in",I)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct(T=>S.$emit("show-marshal-qr",I),["stop"]),title:"Show QR code for magic link"},[...w[18]||(w[18]=[ui('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-0d96a43b><rect x="3" y="3" width="7" height="7" data-v-0d96a43b></rect><rect x="14" y="3" width="7" height="7" data-v-0d96a43b></rect><rect x="3" y="14" width="7" height="7" data-v-0d96a43b></rect><rect x="14" y="14" width="3" height="3" data-v-0d96a43b></rect><rect x="19" y="14" width="2" height="2" data-v-0d96a43b></rect><rect x="14" y="19" width="2" height="2" data-v-0d96a43b></rect><rect x="19" y="19" width="2" height="2" data-v-0d96a43b></rect></svg>',1)])],8,tK)])):P("",!0)])):P("",!0)],2))),128))])):(p(),g("div",DZ,[(p(!0),g(Ie,null,je(e.assignment.allMarshals,I=>(p(),g("span",{key:I.marshalId,class:le(["marshal-tag",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn}])},[Je(b(I.marshalName)+b(I.marshalId===e.currentMarshalId?" (you)":"")+" ",1),I.effectiveIsCheckedIn?(p(),g("span",RZ,"")):P("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(p(),g("div",nK,[r("div",oK,b(F(n).area)+" contacts:",1),r("div",aK,[(p(!0),g(Ie,null,je(e.assignment.areaContacts,I=>(p(),qe(L1,{key:I.marshalId,name:I.marshalName,role:I.role,phone:I.phone,email:I.email},null,8,["name","role","phone","email"]))),128))])])):P("",!0),e.notes.length>0?(p(),g("div",sK,[w[19]||(w[19]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",iK,[(p(!0),g(Ie,null,je(e.notes,I=>(p(),qe(rZ,{key:I.noteId,title:I.title,content:I.content,priority:I.priority,"is-pinned":I.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):P("",!0)])):P("",!0)]))}},rK=Ke(lK,[["__scopeId","data-v-0d96a43b"]]),cK={class:"accordion-section"},uK={class:"accordion-title"},dK=["innerHTML"],hK={class:"accordion-icon"},fK={key:0,class:"accordion-content assignments-accordion-content"},pK={key:0,class:"empty-state"},vK={key:1,class:"checkpoint-accordion"},mK={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{termsLower:n}=ht(),a=e,o=H(()=>a.assignments.map(c=>c.locationId)),i={},l=(c,d)=>{d?i[c]=d:delete i[c]};return t({checkpointRefs:i}),(c,d)=>(p(),g("div",cK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[r("span",uK,[r("span",{class:"section-icon",innerHTML:F(to)("checkpoint")},null,8,dK),Je(" Your "+b(e.assignments.length===1?F(n).checkpoint:F(n).checkpoints)+b(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",hK,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",fK,[e.assignments.length===0?(p(),g("div",pK,[r("p",null,"You don't have any "+b(F(n).checkpoint)+" assignments yet.",1)])):(p(),g("div",vK,[(p(!0),g(Ie,null,je(e.assignments,h=>(p(),qe(rK,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":o.value,onToggle:f=>c.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>c.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>c.$emit("location-click",f)),onActionClick:f=>c.$emit("action-click",h,f),onVisibilityChange:f=>c.$emit("visibility-change",h.id,f),onUpdateLocation:f=>c.$emit("update-location",h),onCheckIn:f=>c.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>c.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>c.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>c.$emit("toggle-auto-update",h),onShowMarshalQr:d[4]||(d[4]=f=>c.$emit("show-marshal-qr",f))},null,8,["assignment","is-expanded","all-locations","route","route-color","route-style","route-weight","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):P("",!0)]))}},gK=Ke(mK,[["__scopeId","data-v-2439f41b"]]),yK={key:0,class:"accordion-section"},kK={class:"accordion-title"},bK=["innerHTML"],wK={class:"accordion-icon"},_K={key:0,class:"accordion-content"},CK={class:"roles-list"},LK={class:"role-title"},SK={class:"role-notes"},IK={__name:"MarshalRolesSection",props:{roles:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.roles.length>0?(p(),g("div",yK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",kK,[r("span",{class:"section-icon",innerHTML:F(to)("user")},null,8,bK),Je(" Your "+b(e.roles.length===1?"role":"roles")+b(e.roles.length>1?` (${e.roles.length})`:""),1)]),r("span",wK,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",_K,[r("div",CK,[(p(!0),g(Ie,null,je(e.roles,a=>(p(),g("div",{key:a.roleId,class:"role-card"},[r("div",LK,b(a.name),1),r("div",SK,b(a.notes),1)]))),128))])])):P("",!0)])):P("",!0)}},xK=Ke(IK,[["__scopeId","data-v-5a883d94"]]),S1="marshal-branding-cache";function $K(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${S1}-${e}`);return t?JSON.parse(t):null}catch{return null}}function TK(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${S1}-${e}`,JSON.stringify(t))}catch{}}function MK(e,t=null){const n=A(t?$K(t):null);Ye(()=>e.value,y=>{if(y&&t){const k={brandingPageGradientStart:y.brandingPageGradientStart,brandingPageGradientEnd:y.brandingPageGradientEnd,brandingHeaderGradientStart:y.brandingHeaderGradientStart,brandingHeaderGradientEnd:y.brandingHeaderGradientEnd,brandingAccentColor:y.brandingAccentColor,brandingLogoUrl:y.brandingLogoUrl,brandingLogoPosition:y.brandingLogoPosition};TK(t,k),n.value=k}},{immediate:!0});const a=(y,k)=>e.value?.[y]||n.value?.[y]||k,o=H(()=>{const y=a("brandingPageGradientStart",yn.pageGradientStart),k=a("brandingPageGradientEnd",yn.pageGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),i=H(()=>{const y=a("brandingHeaderGradientStart",yn.headerGradientStart),k=a("brandingHeaderGradientEnd",yn.headerGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),l=H(()=>{const y=a("brandingHeaderGradientStart",yn.headerGradientStart),k=a("brandingHeaderGradientEnd",yn.headerGradientEnd);return e1(y,k)}),c=H(()=>a("brandingAccentColor",yn.accentColor)),d=H(()=>Iu(c.value)),h=H(()=>({background:c.value,color:d.value})),f=H(()=>{const y=a("brandingLogoUrl","");return y?y.startsWith("/api")?ti+y.substring(4):y:""}),m=H(()=>a("brandingLogoPosition","left"));return{pageBackgroundStyle:o,headerStyle:i,headerTextColor:l,accentColor:c,accentTextColor:d,accentButtonStyle:h,brandingLogoUrl:f,brandingLogoPosition:m}}function AK(){const e=A(null),t=A(null);let n=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),n=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},o=()=>{n!==null&&(navigator.geolocation.clearWatch(n),n=null)};return Ln(()=>{o()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:o}}function EK({eventId:e,currentMarshalId:t,currentPerson:n,assignments:a,areaLeadAreaIds:o,isAreaLead:i,allLocations:l,areas:c,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:m,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:_}){const x=A([]),D=A(!1),M=A(null),S=A(!1),w=A("person"),I=A(null),T=H(()=>x.value.filter(U=>U.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(U.matchedScope)?U.completedByActorId===t.value:!0)),B=H(()=>T.value.filter(U=>U.isCompleted).length),E=H(()=>{const U=a.value.map(X=>X.locationId);return T.value.filter(X=>X.completionContextType==="Personal"?X.contextOwnerMarshalId===t.value:X.completionContextType==="Checkpoint"?U.includes(X.completionContextId):X.completionContextType==="Area"?o.value.includes(X.completionContextId):!0)}),N=H(()=>{if(!i.value)return[];const U=a.value.map(X=>X.locationId);return T.value.filter(X=>X.completionContextType==="Personal"?X.contextOwnerMarshalId!==t.value:X.completionContextType==="Checkpoint"?!U.includes(X.completionContextId):X.completionContextType==="Area"?!o.value.includes(X.completionContextId):!1)}),$=H(()=>E.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1})).sort((U,X)=>(U.displayOrder||0)-(X.displayOrder||0))),z=H(()=>N.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1})).sort((U,X)=>(U.displayOrder||0)-(X.displayOrder||0))),O=H(()=>{const U=f.value?.checkpoints||m.value||[];if(U.length===0)return[];const X=[],ae=new Set;for(const he of U)for(const $e of he.marshals||[])ae.has($e.marshalId)||(ae.add($e.marshalId),X.push($e));return X}),j=H(()=>{if(i.value)return"none";const U=T.value,X=new Set;for(const ae of U)ae.completionContextType==="Checkpoint"&&ae.completionContextId&&X.add(ae.completionContextId);return X.size>1?"checkpoint":"none"}),Z=H(()=>{const U=T.value,X={};for(const ae of U){let he,$e;ae.completionContextType==="Checkpoint"&&ae.completionContextId?(he=`checkpoint_${ae.completionContextId}`,$e=l.value.find(Me=>Me.id===ae.completionContextId)?.name||"Unknown "+d.value.checkpoint):ae.completionContextType==="Area"&&ae.completionContextId?(he=`area_${ae.completionContextId}`,$e=c.value.find(Me=>Me.id===ae.completionContextId)?.name||"Unknown "+d.value.area):(he="personal",$e="Personal"),X[he]||(X[he]={key:he,name:$e,items:[],completedCount:0}),X[he].items.push(ae),ae.isCompleted&&X[he].completedCount++}for(const ae of Object.values(X))ae.items.sort((he,$e)=>{const Ee=he.displayOrder||0,Me=$e.displayOrder||0;return Ee-Me});return Object.values(X).sort((ae,he)=>ae.name.localeCompare(he.name,void 0,{numeric:!0,sensitivity:"base"}))}),J=U=>{I.value=I.value===U?null:U},re=U=>{if(!U.completionContextType||!U.completionContextId)return null;if(U.completionContextType==="Checkpoint"){const X=l.value.find(he=>he.id===U.completionContextId);if(!X)return null;const ae=X.description?` - ${X.description}`:"";return`At ${h.value.checkpoint} ${X.name}${ae}`}if(U.completionContextType==="Area"){const X=c.value.find(ae=>ae.id===U.completionContextId);return X?`At ${h.value.area} ${X.name}`:null}return U.completionContextType==="Personal"?"Personal item":null},K=async(U=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}U||(D.value=!0),M.value=null;try{const X=e.value;console.log("Fetching checklist for marshal:",t.value);let he=(await zt.getMarshalChecklist(X,t.value)).data||[];if(i.value&&o.value.length>0){console.log("Fetching area checklists for areas:",o.value);const $e=o.value.map(ze=>zt.getAreaChecklist(X,ze).catch(be=>(console.warn(`Failed to fetch checklist for area ${ze}:`,be),{data:[]}))),Ee=await Promise.all($e),Me=new Map;for(const ze of he){const be=`${ze.itemId}_${ze.completionContextType}_${ze.completionContextId}`;Me.set(be,ze)}for(const ze of Ee)for(const be of ze.data||[]){const V=`${be.itemId}_${be.completionContextType}_${be.completionContextId}`;Me.has(V)||Me.set(V,be)}he=Array.from(Me.values()),console.log("Merged checklist items:",he.length)}x.value=he,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",x.value.length,"items")}catch(X){console.error("Failed to load checklist:",X.response?.status,X.response?.data),M.value=X.response?.data?.message||"Failed to load checklist"}finally{U||(D.value=!1)}};return{checklistItems:x,checklistLoading:D,checklistError:M,savingChecklist:S,checklistGroupBy:w,expandedChecklistGroup:I,visibleChecklistItems:T,completedChecklistCount:B,myChecklistItems:E,areaChecklistItems:N,myChecklistItemsWithLocalState:$,areaChecklistItemsWithLocalState:z,areaMarshalsForChecklist:O,effectiveChecklistGroupBy:j,groupedChecklistItems:Z,loadChecklist:K,handleToggleChecklist:async U=>{if(S.value)return;S.value=!0;const X=e.value,ae={marshalId:U.contextOwnerMarshalId||t.value,contextType:U.completionContextType,contextId:U.completionContextId,actorMarshalId:t.value};try{if(U.isCompleted)if(Zn())await Ro("checklist_uncomplete",{eventId:X,itemId:U.itemId,data:ae}),U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null,_&&await _();else{if(await zt.uncomplete(X,U.itemId,ae),U.linksToCheckIn&&U.linkedCheckpointId){const he=a.value.find($e=>$e.locationId===U.linkedCheckpointId);he&&(he.isCheckedIn=!1,he.checkedInAt=null,console.log(`Linked check-out: Checked out from ${U.linkedCheckpointName||"checkpoint"}`))}await K(!0)}else if(Zn())await Ro("checklist_complete",{eventId:X,itemId:U.itemId,data:ae}),U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=n.value?.name||"You",_&&await _();else{const he=await zt.complete(X,U.itemId,ae),$e=U.linkedCheckpointId||he.data?.linkedCheckIn?.locationId;if(U.linksToCheckIn&&$e){const Ee=a.value.find(Me=>Me.locationId===$e);if(Ee){const Me=he.data?.linkedCheckIn?.checkedInAt||new Date().toISOString();Ee.isCheckedIn=!0,Ee.checkedInAt=Me,console.log(`Linked check-in: Checked in at ${U.linkedCheckpointName||$e}`)}else console.warn("Could not find assignment for linked check-in:",{checkpointId:$e,linkedCheckpointId:U.linkedCheckpointId})}await K(!0)}k&&await k(X,"checklist",JSON.parse(JSON.stringify(x.value)))}catch(he){if(console.error("Failed to toggle checklist item:",he),Zn()||!he.response){const $e=U.isCompleted?"checklist_uncomplete":"checklist_complete";await Ro($e,{eventId:X,itemId:U.itemId,data:ae}),U.isCompleted?(U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null):(U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=n.value?.name||"You"),_&&await _(),k&&await k(X,"checklist",JSON.parse(JSON.stringify(x.value)))}}finally{S.value=!1}},toggleChecklistGroup:J,getContextName:re}}function PK({eventId:e,allLocations:t,userLocation:n,locationLastUpdated:a}){const o=A(!1),i=A(null),l=A(null),c=A(null),d=A(!1),h=A(!1),f=A(!1);let m=null,y=null,k=null;const _=U=>U?.isDynamic===!0||U?.IsDynamic===!0,x=(U,X,ae,he)=>{const $e=t.value.find(Ee=>Ee.id===U);$e&&($e.latitude=X,$e.longitude=ae,$e.lastLocationUpdate=he)},D=U=>{i.value=U,l.value=null,c.value=null,o.value=!0},M=()=>{o.value=!1,i.value=null,l.value=null,c.value=null,f.value=!1},S=()=>{o.value=!1,f.value=!0},w=()=>{f.value=!1,o.value=!0},I=async(U,X,ae,he,$e=null)=>{d.value=!0;try{const Ee=e.value,Me={latitude:X,longitude:ae,sourceType:he};$e&&(Me.sourceCheckpointId=$e);const ze=await Kn.updatePosition(Ee,U,Me);ze.data.success&&(h.value&&z(),x(U,ze.data.latitude,ze.data.longitude,ze.data.lastLocationUpdate))}catch(Ee){console.error("Failed to update location:",Ee),Ee.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},T=async()=>{if(i.value){d.value=!0,l.value=null;try{let U,X;if(n.value&&a?.value&&Date.now()-a.value<3e4&&(U=n.value.lat,X=n.value.lng),!U||!X){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Ee=await new Promise((Me,ze)=>{navigator.geolocation.getCurrentPosition(Me,ze,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});U=Ee.coords.latitude,X=Ee.coords.longitude}const ae=e.value,he=i.value.locationId,$e=await Kn.updatePosition(ae,he,{latitude:U,longitude:X,sourceType:"gps"});$e.data.success&&(c.value="Location updated successfully!",x(he,$e.data.latitude,$e.data.longitude,$e.data.lastLocationUpdate),setTimeout(()=>M(),1500))}catch(U){console.error("Failed to update location with GPS:",U),U.response?.status===403?l.value="You do not have permission to update this location.":U.code===1?l.value="Location access denied. Please enable location permissions.":U.code===2?l.value="Unable to determine your location. Please try again.":U.code===3||U.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},B=async U=>{if(!i.value)return;const X=t.value.find(ae=>ae.id===U);if(!X){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const ae=e.value,he=i.value.locationId,$e=await Kn.updatePosition(ae,he,{latitude:X.latitude,longitude:X.longitude,sourceType:"checkpoint",sourceCheckpointId:U});$e.data.success&&(h.value&&z(),c.value=`Location copied from ${X.name}!`,x(he,$e.data.latitude,$e.data.longitude,$e.data.lastLocationUpdate),setTimeout(()=>M(),1500))}catch(ae){console.error("Failed to copy location from checkpoint:",ae),ae.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},E=async(U,X)=>{if(i.value){d.value=!0,l.value=null;try{const ae=e.value,he=i.value.locationId,$e=await Kn.updatePosition(ae,he,{latitude:U,longitude:X,sourceType:"manual"});$e.data.success&&(c.value="Location updated successfully!",x(he,$e.data.latitude,$e.data.longitude,$e.data.lastLocationUpdate),setTimeout(()=>M(),1500))}catch(ae){console.error("Failed to update location manually:",ae),ae.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},N=async U=>{if(!(!U||!("geolocation"in navigator)))try{const X=await new Promise(($e,Ee)=>{navigator.geolocation.getCurrentPosition($e,Ee,{enableHighAccuracy:!0,timeout:15e3})}),ae=e.value,he=U.locationId;await Kn.updatePosition(ae,he,{latitude:X.coords.latitude,longitude:X.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),x(he,X.coords.latitude,X.coords.longitude,new Date().toISOString())}catch(X){console.warn("Auto-update location failed:",X)}},$=U=>{h.value=!0,N(U),m=setInterval(()=>{N(U)},6e4)},z=()=>{h.value=!1,m&&(clearInterval(m),m=null)},O=U=>{h.value?z():$(U)},j=()=>{y||!t.value.some(X=>X.isDynamic||X.IsDynamic)||(y=setInterval(async()=>{try{const X=e.value,ae=await Kn.getDynamicCheckpoints(X,{skipLoadingOverlay:!0});if(ae.data&&Array.isArray(ae.data))for(const he of ae.data){const $e=t.value.find(Ee=>Ee.id===he.checkpointId);$e&&($e.latitude=he.latitude,$e.longitude=he.longitude,$e.lastLocationUpdate=he.lastLocationUpdate)}}catch(X){console.warn("Failed to poll dynamic checkpoints:",X)}},6e4))},Z=()=>{y&&(clearInterval(y),y=null)},J=async()=>{try{const U=e.value,X=await Kn.getByEvent(U,{skipLoadingOverlay:!0});if(X.data&&Array.isArray(X.data))for(const ae of X.data){const he=t.value.find($e=>$e.id===ae.id);he&&(he.latitude=ae.latitude,he.longitude=ae.longitude,ae.lastLocationUpdate&&(he.lastLocationUpdate=ae.lastLocationUpdate))}}catch(U){console.warn("Failed to poll all checkpoint locations:",U)}};return{showLocationUpdateModal:o,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:c,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:_,openLocationUpdateModal:D,closeLocationUpdateModal:M,startMapLocationSelect:S,cancelMapLocationSelect:w,updateDynamicCheckpointLocation:I,updateLocationWithGps:T,updateLocationFromCheckpoint:B,updateLocationManually:E,toggleAutoUpdate:O,startAutoUpdate:$,stopAutoUpdate:z,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:Z,startAllCheckpointsPolling:()=>{k||(J(),k=setInterval(J,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:U=>{f.value&&i.value&&(I(i.value.locationId,U.lat,U.lng,"manual"),f.value=!1)}}}function DK({eventId:e,assignments:t,allLocations:n,areaLeadRef:a,areaLeadCheckpoints:o,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:c,reloadChecklist:d}){const{termsLower:h}=ht(),f=A(null),m=A(null),y=A(null),k=A(!1),_=A(null),x=A(new Set),D=A(!1),M=A(""),S=O=>{if(!O)return!0;const j=new Date(O);return(new Date-j)/(1e3*60*60)>24},w=O=>O?new Date(O).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",I=O=>{if(!O)return"";switch(O){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return O}},T=O=>{x.value.add(O),k.value=!1,_.value=null},B=()=>{D.value=!1,M.value=""},E=O=>O<1e3?`${Math.round(O/10)*10} m`:`${(Math.round(O/100)/10).toFixed(1)} km`,N=(O,j,Z)=>{if(O==null||j==null)return;const J=n.value?.find(U=>U.id===Z);if(!J)return;const re=J.latitude,K=J.longitude;if(re==null||K==null)return;const ie=sl(O,j,re,K);if(ie>50){const U=E(ie);M.value=`Thanks for checking in. Just so you know, it's possible you are more than ${U} from your ${h.value.checkpoint} area.`,D.value=!0}},$=async(O,j=!0,Z=null)=>{if(!O?.id){y.value="Cannot check in: Assignment ID is missing";return}f.value=O.id,m.value=O.id,y.value=null;const J=e.value;if(!J){y.value="Cannot check in: Event ID is missing",f.value=null,m.value=null;return}const re=O.effectiveIsCheckedIn!==void 0?O.effectiveIsCheckedIn:O.isCheckedIn&&!S(O.checkInTime),K=O.isCheckedIn&&!re,ie=re?"check-out":K?"refresh":"check-in",U=!re;let X=null,ae=null,he="Manual";if(j&&!re&&"geolocation"in navigator)try{const Ee=await new Promise((Me,ze)=>{navigator.geolocation.getCurrentPosition(Me,ze,{enableHighAccuracy:!0,timeout:5e3})});X=Ee.coords.latitude,ae=Ee.coords.longitude,he="GPS"}catch(Ee){console.log("GPS unavailable, using manual check-in:",Ee.message)}const $e={latitude:X,longitude:ae,action:ie};try{if(Zn()){await Ro("checkin_toggle",{eventId:J,assignmentId:O.id,gpsData:$e});const Ee=t.value.findIndex(Me=>Me.id===O.id);if(Ee!==-1&&(t.value[Ee]={...t.value[Ee],isCheckedIn:U,checkInTime:U?new Date().toISOString():null,checkInMethod:U?`${he} (pending)`:null,checkInLatitude:X,checkInLongitude:ae}),Z){const Me=n.value.find(ze=>ze.id===Z);if(Me?.assignments){const ze=Me.assignments.find(be=>be.id===O.id||be.marshalId===O.marshalId);ze&&(ze.isCheckedIn=U,ze.checkInTime=U?new Date().toISOString():null)}}l&&await l(),c&&await c(J,"locations",n.value)}else{const Ee=await ri.toggleCheckIn(J,O.id,$e),Me=Ee.data?.assignment||Ee.data,ze=Ee.data?.linkedTasksCompleted||[],be=Ee.data?.linkedTasksUncompleted||0,V=t.value.findIndex(Y=>Y.id===O.id);if(V!==-1&&(t.value[V]=Me),Z){const Y=n.value.find(de=>de.id===Z);if(Y?.assignments){const de=Y.assignments.find(se=>se.id===O.id||se.marshalId===O.marshalId);de&&Object.assign(de,Me)}}d&&ze.length>0&&(console.log("Linked tasks completed via check-in:",ze.length),await d(!0)),d&&be>0&&(console.log("Linked tasks uncompleted via check-out:",be),await d(!0))}if(Z&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++,U&&X!=null&&ae!=null){const Ee=Z||O.locationId;Ee&&N(X,ae,Ee)}}catch(Ee){if(Zn()||!Ee.response){await Ro("checkin_toggle",{eventId:J,assignmentId:O.id,gpsData:$e});const Me=t.value.findIndex(ze=>ze.id===O.id);Me!==-1&&(t.value[Me]={...t.value[Me],isCheckedIn:U,checkInTime:U?new Date().toISOString():null,checkInMethod:U?"Manual (pending)":null}),l&&await l()}else Ee.response?.data?.message?y.value=Ee.response.data.message:Ee.message?y.value=Ee.message:y.value=`Failed to ${ie}. Please try again.`}finally{f.value=null,m.value=null}};return{checkingIn:f,checkingInAssignment:m,checkInError:y,showCheckInReminderModal:k,checkInReminderCheckpoint:_,dismissedCheckInReminders:x,showDistanceWarning:D,distanceWarningMessage:M,isCheckInStale:S,formatCheckInTime:w,formatCheckInMethod:I,handleCheckInToggle:$,handleAreaLeadMarshalCheckIn:async O=>{const Z=(a?.value?.checkpoints||o?.value||[]).find(X=>X.marshals?.some(ae=>ae.marshalId===O.marshalId));if(!Z){console.error("Could not find checkpoint for marshal:",O);return}const J=Z.marshals.find(X=>X.marshalId===O.marshalId);if(!J)return;const re=J.assignmentId||J.id;if(!re){console.error("No assignment ID found for marshal:",J);return}const K=!O.isCheckedIn,ie={id:re,marshalId:O.marshalId,isCheckedIn:O.isCheckedIn,effectiveIsCheckedIn:O.isCheckedIn};await $(ie,!1,Z.checkpointId||Z.locationId);const U=[a?.value?.checkpoints,o?.value].filter(Boolean);for(const X of U)for(const ae of X){const he=ae.marshals?.find($e=>$e.marshalId===O.marshalId);he&&(he.isCheckedIn=K,he.checkInTime=K?new Date().toISOString():null,he.checkInMethod=K?"AreaLead":null)}i&&i.value++},dismissCheckInReminder:T,dismissDistanceWarning:B}}function RK({eventId:e,currentMarshalId:t,isAreaLead:n,areaLeadAreaIds:a,sectionLastLoadedAt:o,showMessage:i}){const l=A([]),c=A(!1),d=A(null),h=A(!1),f=A(!1),m=A(""),y=A(!1),k=A(!1),_=A(!1),x=H(()=>l.value.filter(N=>N.status==="open"||N.status==="acknowledged"||N.status==="in_progress").length),D=async()=>{const N=e.value;c.value=!0;try{const $=new Map;if(n.value&&a.value.length>0)for(const z of a.value)try{const j=(await Ga.getForArea(N,z)).data.incidents||[];for(const Z of j)$.set(Z.incidentId,Z)}catch(O){console.warn(`Failed to load incidents for area ${z}:`,O)}try{const O=(await Ga.getAll(N)).data.incidents||[];for(const j of O)j.reportedBy?.marshalId===t.value&&$.set(j.incidentId,j)}catch(z){console.debug("Could not load all incidents:",z)}l.value=Array.from($.values()).sort((z,O)=>new Date(O.incidentTime||O.createdAt)-new Date(z.incidentTime||z.createdAt)),o?.value&&(o.value.incidents=Date.now()),console.log("My incidents loaded:",l.value.length)}catch($){console.error("Failed to load incidents:",$)}finally{c.value=!1}},M=async N=>{_.value=!0;try{await Ga.create(e.value,N),k.value=!1,D(),i&&i("Incident Reported","An administrator will review it shortly.")}catch($){console.error("Failed to report incident:",$),i&&i("Error",$.response?.data?.message||"Failed to report incident. Please try again.")}finally{_.value=!1}},S=N=>{d.value=N,h.value=!0},w=()=>{h.value=!1,d.value=null},I=async({incidentId:N,status:$})=>{try{await Ga.updateStatus(e.value,N,{status:$});const z=l.value.find(O=>O.incidentId===N);z&&(z.status=$),d.value?.incidentId===N&&(d.value.status=$)}catch(z){console.error("Failed to update incident status:",z),i&&i("Error","Failed to update status. Please try again.")}},T=()=>{m.value="",f.value=!0},B=()=>{f.value=!1,m.value=""};return{myIncidents:l,incidentsLoading:c,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:f,incidentNoteText:m,submittingIncidentNote:y,showReportIncident:k,reportingIncident:_,openIncidentsCount:x,loadMyIncidents:D,handleReportIncident:M,openIncidentDetail:S,closeIncidentDetail:w,handleIncidentStatusChange:I,openAddIncidentNoteModal:T,closeAddIncidentNoteModal:B,submitIncidentNote:async()=>{if(!(!m.value.trim()||!d.value)){y.value=!0;try{await Ga.addNote(e.value,d.value.incidentId,m.value.trim()),B(),D();const N=await Ga.get(e.value,d.value.incidentId);d.value=N.data}catch(N){console.error("Failed to add note:",N),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const bm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',wm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',OK='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',BK='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function NK({userLocation:e,assignmentsWithDetails:t,courseMapRef:n}){const{termsLower:a}=ht(),o=A({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=A(!1),l=A(-1),c=A({}),d={},h=H(()=>t.value.filter(M=>M.location?.latitude&&M.location?.longitude&&!(M.location.latitude===0&&M.location.longitude===0))),f=H(()=>{const M=[];return M.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+a.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?OK:BK}),e.value&&!o.value.userLocationInView&&M.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:bm}),h.value.length>0&&!o.value.highlightedLocationInView&&M.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:wm}),M}),m=M=>{const S=o.value,w=S.userLocationInView!==M.userLocationInView||S.highlightedLocationInView!==M.highlightedLocationInView,I=JSON.stringify(S.highlightedLocationsVisibility)!==JSON.stringify(M.highlightedLocationsVisibility||{});(w||I)&&(o.value={...M,highlightedLocationsVisibility:M.highlightedLocationsVisibility||{}})},y=()=>{const M=h.value;if(M.length===0)return null;if(M.length===1)return l.value=0,M[0];const S=o.value.highlightedLocationsVisibility||{},w=[];for(let B=0;B<M.length;B++){const E=M[B].locationId;S[E]===!1&&w.push(B)}if(w.length===0)return l.value=0,M[0];if(w.length===1)return l.value=w[0],M[w[0]];const I=l.value;let T=-1;for(const B of w)if(B>I){T=B;break}return T===-1&&(T=w[0]),l.value=T,M[T]};return{courseMapVisibility:o,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:m,handleCourseMapAction:({actionId:M})=>{if(M==="toggle-other-checkpoints")i.value=!i.value;else if(M==="recenter-user"&&e.value)n.value?.recenterOnUserLocation();else if(M==="recenter-checkpoint"){const S=y();S?.location&&n.value?.recenterOnLocation(S.location.latitude,S.location.longitude)}},checkpointMapVisibility:c,checkpointMapRefs:d,getCheckpointMapActions:M=>{const S=[],w=c.value[M]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!w.userLocationInView&&S.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:bm}),w.highlightedLocationInView||S.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:wm}),S},handleCheckpointMapVisibilityChange:(M,S)=>{const w=c.value[M];(!w||w.userLocationInView!==S.userLocationInView||w.highlightedLocationInView!==S.highlightedLocationInView)&&(c.value={...c.value,[M]:S})},handleCheckpointMapAction:(M,{actionId:S})=>{const w=d[M.id];S==="recenter-user"&&e.value?w?.recenterOnUserLocation():S==="recenter-checkpoint"&&M.location&&w?.recenterOnLocation(M.location.latitude,M.location.longitude)}}}function FK({eventId:e,currentMarshalId:t,areaLeadRef:n,areaLeadCheckpoints:a,areaChecklistItems:o,myChecklistItems:i,areaLeadAreaIds:l,loadChecklist:c}){const d=A(null),h=A(!1),f=A(0),m=_=>{d.value=d.value===_?null:_},y=H(()=>{f.value;const _=n?.value?.checkpoints,x=a?.value,D=_?.length>0?_:x||[],M=o?.value||[],S=i?.value||[],w=[...M,...S],I=new Map;for(const B of D){const E=B.marshals||B.Marshals||[],N=B.checkpointId||B.CheckpointId,$=B.name||B.Name,z=B.description||B.Description,O=B.areaIds||B.AreaIds||[];for(const j of E){const Z=j.marshalId||j.MarshalId;if(!Z)continue;I.has(Z)||I.set(Z,{...j,marshalId:Z,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const J=I.get(Z);J.checkpoints.push({checkpointId:N,name:$,description:z}),J.checkpointIds.add(N);for(const re of O)J.areaIds.add(re)}}for(const B of w){const E=B.completionContextType,N=B.completionContextId;let $=[];if(E==="Personal"){const z=B.contextOwnerMarshalId;z&&I.has(z)&&($=[I.get(z)])}else if(E==="Checkpoint")for(const z of I.values())z.checkpointIds.has(N)&&$.push(z);else if(E==="Area")for(const z of I.values())z.areaIds.has(N)&&$.push(z);else $=Array.from(I.values());for(const z of $)z.allTasks.push({...B,isCompleted:B.isCompleted||B.localIsCompleted}),z.totalTaskCount++,(B.isCompleted||B.localIsCompleted)&&z.completedTaskCount++}return Array.from(I.values()).map(B=>({...B,checkpointIds:Array.from(B.checkpointIds),areaIds:Array.from(B.areaIds)})).sort((B,E)=>(B.name||"").localeCompare(E.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:d,savingAreaLeadMarshalTask:h,areaLeadMarshalDataVersion:f,allAreaLeadMarshals:y,toggleAreaLeadMarshalExpansion:m,toggleAreaLeadMarshalTask:async(_,x)=>{if(h.value)return;h.value=!0;const D={marshalId:x.marshalId,contextType:_.contextType,contextId:_.contextId,actorMarshalId:t.value};try{_.isCompleted?await zt.uncomplete(e.value,_.itemId,D):await zt.complete(e.value,_.itemId,D),n?.value?.loadDashboard&&await n.value.loadDashboard(),f.value++,c&&await c(!0)}catch(M){console.error("Failed to toggle area lead marshal task:",M)}finally{h.value=!1}}}}function UK({router:e,route:t,onAuthSuccess:n}){const a=A(!1),o=A(!1),i=A(null),l=A(null),c=A(null),d=A(null),h=H(()=>l.value?.name||null),f=H(()=>d.value?.eventRoles?d.value.eventRoles.filter($=>$.role==="EventAreaLead").flatMap($=>$.areaIds||[]):[]),m=H(()=>f.value.length>0),y=H(()=>d.value?.eventRoles?d.value.eventRoles.some(N=>N.role==="EventAdmin"):!1),k=H(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),_=H(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let x=null;const D=()=>{x||(x=setInterval(async()=>{if(d.value?.marshalId)try{await qa.getMe(t.params.eventId)}catch(N){console.debug("Heartbeat failed:",N)}},300*1e3))},M=()=>{x&&(clearInterval(x),x=null)},S=async(N,$,z=!1)=>{o.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:N,code:$,isReauth:z}),Nd();try{Oo("marshal",N);const O=await qa.marshalLogin(N,$);if(console.log("Auth response:",O.data),O.data.success){nv(N,{token:O.data.sessionToken,marshalId:O.data.marshalId,marshalName:O.data.person?.name||null}),Ow(N,O.data.marshalId,$),l.value=O.data.person,c.value=O.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",c.value,l.value?.name);try{const j=await qa.getMe(N);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),D(),n&&await n()}else i.value=O.data.message||"Authentication failed"}catch(O){console.error("Authentication failed:",O),i.value=O.response?.data?.message||"Invalid or expired login link"}finally{o.value=!1}};return{isAuthenticated:a,authenticating:o,loginError:i,currentPerson:l,currentMarshalId:c,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:m,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:_,authenticateWithMagicCode:S,checkExistingSession:async N=>{Oo("marshal",N);const $=bu(N),z=$?.marshalId,O=z?py(N,z):null;if(!$?.token)return O?(console.log("No session but have stored code, attempting re-authentication..."),Nd(),await S(N,O,!0),a.value):!1;try{const j=await qa.getMe(N);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},c.value=j.data.marshalId,a.value=!0,uy(N,j.data.marshalId),D(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),O)try{if(Nd(),await S(N,O,!0),a.value)return console.log("Re-authentication successful"),!0}catch(Z){console.error("Re-authentication failed:",Z)}$?.sessionKey&&Uh($.sessionKey)}return!1},handleClose:N=>{M(),Oo(null),a.value=!1,l.value=null,c.value=null,d.value=null,N&&N(),e.push("/marshal")},handleRemoveSession:async N=>{const[$]=N.split(":");Oo("marshal",$);try{await qa.logout()}catch{}Uh(N),Oo(null)},updateSessionEventInfo:(N,$,z)=>{const O=bu(N);O&&O.marshalId&&nv(N,{marshalId:O.marshalId,marshalName:O.marshalName,token:O.token,eventName:$,eventDate:z})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:D,stopHeartbeat:M}}function zK({eventDate:e,latitude:t,longitude:n}){const a=A(null),o=A(!1),i=A(null),l=["US","LR","MM"],c=H(()=>{try{const S=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(S)}catch{return!1}}),d=H(()=>c.value?"fahrenheit":"celsius"),h=H(()=>{if(!e.value)return null;const M=new Date,S=new Date(e.value);return M.setHours(0,0,0,0),S.setHours(0,0,0,0),Math.floor((S-M)/(1e3*60*60*24))}),f=H(()=>{const M=h.value;return M===null?!1:M>=-1&&M<=7}),m=M=>M>3?720*60*1e3:M>1?10800*1e3:3600*1e3,y=(M,S,w)=>`weather_${M.toFixed(2)}_${S.toFixed(2)}_${w}`,k=(M,S,w,I)=>{try{const T=y(M,S,w),B=localStorage.getItem(T);if(!B)return null;const{data:E,timestamp:N}=JSON.parse(B),$=m(I);return Date.now()-N<$?E:(localStorage.removeItem(T),null)}catch{return null}},_=(M,S,w,I)=>{try{const T=y(M,S,w);localStorage.setItem(T,JSON.stringify({data:I,timestamp:Date.now()}))}catch{}},x={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},D=async()=>{const M=t.value,S=n.value,w=e.value,I=h.value;if(!M||!S||!w||!f.value){a.value=null;return}const T=new Date(w).toISOString().split("T")[0],B=k(M,S,T,I);if(B){a.value=B;return}o.value=!0,i.value=null;try{const E=c.value?"fahrenheit":"celsius",N=`https://api.open-meteo.com/v1/forecast?latitude=${M}&longitude=${S}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${E}&timezone=auto`,$=await fetch(N);if(!$.ok)throw new Error("Weather API request failed");const z=await $.json(),O=z.daily.time.indexOf(T);if(O===-1){a.value=null;return}const j=z.daily.weathercode[O],Z=Math.round(z.daily.temperature_2m_max[O]),J=Math.round(z.daily.temperature_2m_min[O]),re=x[j]||{icon:"cloud",description:"Unknown"},K={tempMax:Z,tempMin:J,unit:c.value?"F":"C",icon:re.icon,description:re.description,weatherCode:j};_(M,S,T,K),a.value=K}catch(E){console.warn("Failed to fetch weather:",E),i.value=E.message,a.value=null}finally{o.value=!1}};return Ye([e,t,n,f],()=>{f.value&&t.value&&n.value?D():a.value=null},{immediate:!0}),{weather:a,loading:o,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:D}}const HK=["aria-label"],VK={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,n={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},a=H(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${n[t.icon]||"cloudy"}.svg`),o=H(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=H(()=>({width:o.value,height:o.value,backgroundColor:t.color,maskImage:`url(${a.value})`,WebkitMaskImage:`url(${a.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,c)=>(p(),g("span",{class:"weather-icon",style:tt(i.value),role:"img","aria-label":e.alt},null,12,HK))}},GK=Ke(VK,[["__scopeId","data-v-9861a237"]]),qK={key:0,class:"header-logo-cover"},jK=["src"],WK={key:2,class:"header-logo header-logo-left"},ZK=["src"],KK={class:"header-center"},YK={key:0},JK={key:1,class:"header-event-date"},XK=["title"],QK={class:"weather-temp"},eY={key:0,class:"header-actions"},tY={key:3,class:"header-logo header-logo-right"},nY=["src"],oY={class:"container"},aY={key:0,class:"selection-card"},sY={key:1,class:"selection-card"},iY={key:0,class:"loading"},lY={key:2,class:"selection-card error-card"},rY={class:"error"},cY={key:3,class:"dashboard"},uY={key:0,class:"welcome-bar"},dY={class:"welcome-info"},hY={key:0,class:"welcome-email"},fY={key:0,class:"mode-switch"},pY={key:1,class:"mode-switch"},vY={class:"accordion"},mY={key:1,class:"refresh-indicator"},gY={class:"add-note-form"},yY={class:"modal-actions"},kY=["disabled"],bY={key:0,class:"qr-loading-state"},wY={key:1,class:"qr-error-state"},_Y=6e4,CY={__name:"MarshalView",setup(e){const{terms:t,termsLower:n}=ht(),{updatePendingCount:a}=Hf(),o=Qu(),i=rr(),l=H(()=>o.params.eventId),c={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:m,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:_,isAreaLead:x,canSwitchToAdmin:D,isAdminButNeedsReauth:M,authenticateWithMagicCode:S,checkExistingSession:w,handleClose:I,updateSessionEventInfo:T,switchToAdminMode:B,stopHeartbeat:E}=UK({router:i,route:o,onAuthSuccess:()=>c.onAuthSuccess?.()}),N=A(new Set),$=H(()=>_.value.length?K.value.filter(Se=>_.value.includes(Se.id)).map(Se=>({areaId:Se.id,name:Se.name,color:Se.color})).sort((Se,Ce)=>(Se.name||"").localeCompare(Ce.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ye($,Se=>{Se.length>0&&N.value.size===0&&(N.value=new Set(Se.map(Ce=>Ce.areaId)))},{immediate:!0});const z=H(()=>_.value.filter(Se=>N.value.has(Se))),O=Se=>{const Ce=new Set(N.value);Ce.has(Se)?Ce.delete(Se):Ce.add(Se),N.value=Ce},j=H(()=>{const Se=Lo.value.find(nt=>nt.isCheckedIn&&!aa(nt.checkInTime)&&nt.location);if(Se?.location)return{id:Se.location.id,locationId:Se.location.id,name:Se.location.name,description:Se.location.description};if(wn.value){const nt=Lo.value.find(mt=>mt.id===wn.value);if(nt?.location)return{id:nt.location.id,locationId:nt.location.id,name:nt.location.name,description:nt.location.description}}const Ce=Lo.value[0];return Ce?.location?{id:Ce.location.id,locationId:Ce.location.id,name:Ce.location.name,description:Ce.location.description}:null}),Z=A(null),J=A([]),re=A([]),K=A([]),ie=A(!0),U=A(!1),{pageBackgroundStyle:X,headerStyle:ae,headerTextColor:he,accentColor:$e,accentTextColor:Ee,accentButtonStyle:Me,brandingLogoUrl:ze,brandingLogoPosition:be}=MK(Z,o.params.eventId);Br("marshalBranding",{headerStyle:ae,headerTextColor:he,accentButtonStyle:Me,accentColor:$e,accentTextColor:Ee});const V=H(()=>{if(!J.value.length)return null;const Se=J.value.filter(Ce=>Ce.latitude&&Ce.longitude);return Se.length?Se.reduce((Ce,nt)=>Ce+nt.latitude,0)/Se.length:null}),Y=H(()=>{if(!J.value.length)return null;const Se=J.value.filter(Ce=>Ce.latitude&&Ce.longitude);return Se.length?Se.reduce((Ce,nt)=>Ce+nt.longitude,0)/Se.length:null}),de=H(()=>Z.value?.eventDate||null),{weather:se,shouldShowWeather:Re}=zK({eventDate:de,latitude:V,longitude:Y}),q=A(null),Q=A({checklist:0,notes:0,incidents:0,eventContacts:0}),ee=A([]),_e=A([]),Be=A([]),Ue=A(null),Ae=H(()=>Ue.value?.areaLeadRef?.value),{checklistItems:ne,checklistLoading:ge,checklistError:Oe,savingChecklist:De,expandedChecklistGroup:xe,visibleChecklistItems:me,completedChecklistCount:Ze,myChecklistItems:Ge,areaChecklistItems:fe,areaChecklistItemsWithLocalState:ke,areaMarshalsForChecklist:te,effectiveChecklistGroupBy:ye,groupedChecklistItems:He,loadChecklist:rt,handleToggleChecklist:kt,toggleChecklistGroup:Rt,getContextName:Lt}=EK({eventId:l,currentMarshalId:y,currentPerson:m,assignments:re,areaLeadAreaIds:_,isAreaLead:x,allLocations:J,areas:K,terms:t,termsLower:n,areaLeadRef:Ae,areaLeadCheckpoints:ee,sectionLastLoadedAt:Q,updateCachedField:eu,updatePendingCount:a}),{userLocation:xt,locationLastUpdated:Kt,startLocationTracking:no,stopLocationTracking:Mo}=AK(),{showLocationUpdateModal:ft,updatingLocationFor:Ct,locationUpdateError:Mt,locationUpdateSuccess:Mn,updatingLocation:go,autoUpdateEnabled:oo,selectingLocationOnMap:An,openLocationUpdateModal:tn,closeLocationUpdateModal:Pa,startMapLocationSelect:yo,cancelMapLocationSelect:Uo,updateDynamicCheckpointLocation:pe,updateLocationWithGps:ve,updateLocationFromCheckpoint:Le,toggleAutoUpdate:lt,stopAutoUpdate:Qe,startDynamicCheckpointPolling:Ot,stopDynamicCheckpointPolling:on,startAllCheckpointsPolling:mn,stopAllCheckpointsPolling:gn}=PK({eventId:l,allLocations:J,userLocation:xt,locationLastUpdated:Kt});let Vn=null;const Za=async()=>{yo(),Vn=q.value,q.value="map",await cn(),Co.value?.openFullscreen?.()},ko=()=>{Vn&&(q.value=Vn,Vn=null)},hl=()=>{Uo(),Co.value?.mapRef?.closeFullscreen?.(),ko()},{expandedAreaLeadMarshal:fl,savingAreaLeadMarshalTask:pl,areaLeadMarshalDataVersion:vi,allAreaLeadMarshals:zo,toggleAreaLeadMarshalExpansion:Ho,toggleAreaLeadMarshalTask:Ts}=FK({eventId:l,currentMarshalId:y,areaLeadRef:Ae,areaLeadCheckpoints:ee,areaChecklistItems:fe,myChecklistItems:Ge,areaLeadAreaIds:_,loadChecklist:rt}),{checkingIn:Vo,checkingInAssignment:bo,checkInError:mi,showCheckInReminderModal:En,checkInReminderCheckpoint:Ao,dismissedCheckInReminders:Ms,showDistanceWarning:Ka,distanceWarningMessage:ao,isCheckInStale:aa,handleCheckInToggle:so,handleAreaLeadMarshalCheckIn:sa,dismissCheckInReminder:vt,dismissDistanceWarning:Bt}=DK({eventId:l,assignments:re,allLocations:J,areaLeadRef:Ae,areaLeadCheckpoints:ee,areaLeadMarshalDataVersion:vi,updatePendingCount:a,updateCachedField:eu,reloadChecklist:rt}),Pn=A(!1),Sn=A(!1),io=A(""),ia=A(""),dt=A(null),Yt=A(!1),Eo=A(""),wo=A(""),bn=(Se,Ce)=>{Eo.value=Se,wo.value=Ce,Yt.value=!0},Go=A(!1),qo=A(""),_o=A(""),Jt=A(!1),Gn=A(""),la=async Se=>{_o.value=Se.name||Se.marshalName||"",qo.value="",Gn.value="",Jt.value=!0,Go.value=!0;try{const Ce=await _a.getMagicLink(l.value,Se.marshalId);qo.value=Ce.data.magicLink,Jt.value=!1}catch(Ce){Jt.value=!1,Gn.value=Ce.response?.data?.message||"Failed to load magic link"}},{myIncidents:Ya,incidentsLoading:As,selectedIncident:Ja,showIncidentDetail:Es,showAddIncidentNoteModal:gi,incidentNoteText:ra,submittingIncidentNote:Ps,showReportIncident:Xa,loadMyIncidents:Qa,handleReportIncident:vl,openIncidentDetail:yi,handleIncidentStatusChange:hr,openAddIncidentNoteModal:bt,closeAddIncidentNoteModal:Dt,submitIncidentNote:Ut}=RK({eventId:l,currentMarshalId:y,isAreaLead:x,areaLeadAreaIds:_,sectionLastLoadedAt:Q,showMessage:bn}),Co=A(null),Ds=H(()=>Co.value),es=A(null),ki=Se=>!Se||Se.length===0?!1:Se.some(Ce=>_.value.includes(Ce)),ca=Se=>{es.value=es.value===Se?null:Se},an=Se=>{const Ce=q.value===Se;if(q.value=Ce?null:Se,!Ce){const nt=Date.now(),mt=$t=>nt-Q.value[$t]>_Y;switch(Se){case"checklist":mt("checklist")&&rt();break;case"notes":mt("notes")&&xi();break;case"incidents":mt("incidents")&&Qa();break;case"eventContacts":mt("eventContacts")&&$i();break}}},wn=A(null),sn=Se=>{wn.value=wn.value===Se?null:Se};Ye(()=>re.value,Se=>{Se.length===1&&wn.value===null&&(wn.value=Se[0].id)},{immediate:!0});const lo=H(()=>q.value==="map"||q.value==="assignments"&&wn.value!==null);Ye(lo,Se=>{Se?mn():gn()});const Lo=H(()=>re.value.map(Se=>{const Ce=J.value.find(wt=>wt.id===Se.locationId),nt=Ce?.areaIds||Ce?.AreaIds||[];let mt=null;nt.length>0&&K.value.length>0&&(mt=K.value.find(qn=>nt.includes(qn.id))?.name);const Ht=(Ce?.assignments||[]).map(wt=>({...wt,effectiveIsCheckedIn:wt.isCheckedIn&&!aa(wt.checkInTime)})).sort((wt,qn)=>(wt.marshalName||"").localeCompare(qn.marshalName||"",void 0,{sensitivity:"base"})),Nn=Si.value.filter(wt=>nt.includes(wt.areaId)&&(!wt.marshalId||wt.marshalId!==y.value)),Vt=new Set,ln=Nn.filter(wt=>{const qn=JSON.stringify({name:wt.name||"",marshalId:wt.marshalId||"",role:wt.role||"",phone:wt.phone||"",email:wt.email||"",notes:wt.notes||""});return Vt.has(qn)?!1:(Vt.add(qn),!0)}).sort((wt,qn)=>(wt.marshalName||wt.name||"").localeCompare(qn.marshalName||qn.name||"",void 0,{sensitivity:"base"})),ro=Se.isCheckedIn&&!aa(Se.checkInTime);return{...Se,location:Ce,areaName:mt,areaIds:nt,allMarshals:Ht,areaContacts:ln,locationName:Ce?.name||"Unknown Location",effectiveIsCheckedIn:ro}})),{courseMapActions:Da,hideOtherCheckpoints:ts,handleCourseMapVisibilityChange:Ra,handleCourseMapAction:Rs,getCheckpointMapActions:ml,handleCheckpointMapVisibilityChange:bi,handleCheckpointMapAction:At}=NK({userLocation:xt,assignmentsWithDetails:Lo,courseMapRef:Ds}),wi=H(()=>re.value.length>0?re.value[0]:null),In=H(()=>re.value.map(Se=>Se.locationId)),ns=H(()=>ts.value?J.value.filter(Se=>{const Ce=In.value.includes(Se.id),nt=Se.isDynamic||Se.IsDynamic;return Ce||nt}):J.value),gl=H(()=>Lo.value.some(Se=>Se.location?.isDynamic||Se.location?.IsDynamic)),ua=H(()=>Lo.value.find(Se=>Se.location?.isDynamic||Se.location?.IsDynamic)),os=H(()=>{const Se=ua.value;if(!Se)return!1;const Ce=Se.location,nt=Ce?.locationUpdateScopeConfigurations||Ce?.LocationUpdateScopeConfigurations||[];return Yy({scopeConfigurations:nt,marshalId:y.value,marshalAssignmentLocationIds:In.value,areaLeadAreaIds:_.value,locationId:Se.locationId,locationAreaIds:Se.areaIds||[]})}),fr=H(()=>{if(!Z.value||!Lo.value.length)return[];const Se=new Date,Ce=Z.value.eventDate?new Date(Z.value.eventDate):null;return Lo.value.filter(nt=>{if(nt.effectiveIsCheckedIn||Ms.value.has(nt.id))return!1;const mt=nt.location;if(!mt)return!1;const $t=mt.startTime?new Date(mt.startTime):Ce;if(!$t)return!1;let Ht;if(mt.endTime)Ht=new Date(mt.endTime);else if(Ce)Ht=new Date(Ce.getTime()+7200*1e3);else return!1;return Se>=$t&&Se<Ht})});Ye(fr,Se=>{Se.length>0&&!En.value&&(Ao.value=Se[0],En.value=!0)},{immediate:!0}),Ye(Ka,Se=>{Se&&(bn("Distance notice",ao.value),Bt())});const yl=()=>{const Se=Ao.value;Se&&(vt(Se.id),q.value="assignments",wn.value=Se.id)},as=H(()=>Z.value?.route?(typeof Z.value.route=="string"?JSON.parse(Z.value.route):Z.value.route)||[]:[]),_i=H(()=>!wi.value||!J.value.length?null:J.value.find(Se=>Se.id===wi.value.locationId)),jo=A([]),Ci=A(!1),On=H(()=>{const Se=jo.value.filter(mt=>!mt.marshalId||mt.marshalId!==y.value),Ce=new Set;return Se.filter(mt=>{const $t=JSON.stringify({name:mt.name||"",marshalId:mt.marshalId||"",role:mt.role||"",phone:mt.phone||"",email:mt.email||"",notes:mt.notes||""});return Ce.has($t)?!1:(Ce.add($t),!0)}).sort((mt,$t)=>{if(mt.isPinned!==$t.isPinned)return mt.isPinned?-1:1;const Ht=mt.displayOrder||0,Nn=$t.displayOrder||0;return Ht!==Nn?Ht-Nn:(mt.name||"").localeCompare($t.name||"",void 0,{sensitivity:"base"})})}),kl=H(()=>On.value.filter(Se=>Se.showInEmergencyInfo)),Li=H(()=>_e.value.filter(Se=>Se.showInEmergencyInfo)),Wo=H(()=>kl.value.length>0||Li.value.length>0),bl=Se=>{if(!_e.value||_e.value.length===0)return[];const Ce=[],nt=new Set;for(const $t of _e.value){const Ht=$t.noteId||$t.NoteId||$t.id;if(nt.has(Ht))continue;const Nn=$t.scopeConfigurations||$t.ScopeConfigurations||[];let Vt=!1;if(Nn.length>0)for(const ln of Nn){const ro=ln.itemType||ln.ItemType,wt=ln.ids||ln.Ids||[];if(ro==="Checkpoint"&&(wt.includes(Se)||wt.includes("ALL_CHECKPOINTS"))){Vt=!0;break}}else{const ln=$t.matchedScope||$t.MatchedScope||"";["EveryoneAtCheckpoints","Checkpoint"].some(wt=>ln.includes(wt)||ln===wt)&&(Vt=!0)}Vt&&(nt.add(Ht),Ce.push($t))}const mt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Ce.sort(($t,Ht)=>{const Nn=$t.isPinned||$t.IsPinned,Vt=Ht.isPinned||Ht.IsPinned;if(Nn&&!Vt)return-1;if(!Nn&&Vt)return 1;const ln=mt[$t.priority||$t.Priority||"Normal"]??3,ro=mt[Ht.priority||Ht.Priority||"Normal"]??3;if(ln!==ro)return ln-ro;const wt=$t.displayOrder||$t.DisplayOrder||0,qn=Ht.displayOrder||Ht.DisplayOrder||0;if(wt!==qn)return wt-qn;const Zo=$t.createdAt||$t.CreatedAt,vr=Ht.createdAt||Ht.CreatedAt;return new Date(vr)-new Date(Zo)})},Si=A([]),ss=(Se,Ce)=>Se.localeCompare(Ce,void 0,{numeric:!0,sensitivity:"base"}),Os=H(()=>{if(!Ct.value)return[];const Se=Ct.value.locationId;return J.value.filter(Ce=>Ce.id!==Se&&Ce.latitude!==0&&Ce.longitude!==0).sort((Ce,nt)=>ss(Ce.name,nt.name))}),Bs=H(()=>_i.value?{lat:_i.value.latitude,lng:_i.value.longitude}:xt.value?xt.value:J.value.length>0?{lat:J.value[0].latitude,lng:J.value[0].longitude}:{lat:51.505,lng:-.09}),wl=Se=>{if(Z.value=Se.event,K.value=Se.areas||[],J.value=Se.locations||[],ne.value=Se.checklist||[],jo.value=Se.contacts||[],_e.value=Se.notes||[],Be.value=Se.roles||[],Se.areaLeadDashboard?.checkpoints&&(ee.value=Se.areaLeadDashboard.checkpoints),Z.value&&Zh(Z.value),y.value){const Ce=[];for(const nt of J.value){const mt=nt.assignments?.find($t=>$t.marshalId===y.value);mt&&Ce.push(mt)}re.value=Ce}},_l=async()=>{const Se=o.params.eventId;console.log("Loading event data for:",{eventId:Se,marshalId:y.value});const Ce=await li(Se);let nt=!1;if(Ce&&(console.log("Loaded cached data from:",Ce.cachedAt),wl(Ce),nt=!0,ie.value=!1),Zn())if(nt){console.log("Offline mode - using cached data");return}else{console.warn("No cached data available while offline");return}nt&&(U.value=!0),console.log("Fetching fresh event data in parallel...");const[mt,$t,Ht]=await Promise.allSettled([ni.getById(Se),ms.getByEvent(Se),$r.getEventStatus(Se)]);if(mt.status==="fulfilled"?(Z.value=mt.value.data,console.log("Event loaded:",Z.value?.name),Z.value&&(Zh(Z.value),T(Se,Z.value.name,Z.value.eventDate))):console.error("Failed to load event:",mt.reason),$t.status==="fulfilled"?(K.value=$t.value.data||[],console.log("Areas loaded:",K.value.length)):console.error("Failed to load areas:",$t.reason),Ht.status==="fulfilled"){if(J.value=Ht.value.data?.locations||[],console.log("Locations loaded:",J.value.length),y.value){const Vt=[];for(const ln of J.value){const ro=ln.assignments?.find(wt=>wt.marshalId===y.value);ro&&Vt.push(ro)}re.value=Vt,console.log("Total assignments found:",re.value.length)}}else console.error("Failed to load event status:",Ht.reason);const Nn=[rt(),$i(),xi(),Qa(),Ns()];x.value&&Nn.push(Ii()),await Promise.allSettled(Nn);try{const Vt={event:Z.value,areas:K.value,locations:J.value,checklist:ne.value,contacts:jo.value,notes:_e.value,roles:Be.value,marshalId:y.value};ee.value.length>0&&(Vt.areaLeadDashboard={checkpoints:ee.value});const ln=JSON.parse(JSON.stringify(Vt));await lc(Se,ln),console.log("Event data cached for offline access")}catch(Vt){console.warn("Failed to cache event data:",Vt)}Ot(),U.value=!1};c.onAuthSuccess=_l;const Cl=async()=>{const Se=o.params.eventId;if(Zn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Ce=await ms.getAreaLeadDashboard(Se);if(Ce.data){ee.value=Ce.data.checkpoints||[];const nt=JSON.parse(JSON.stringify({areas:Ce.data.areas||[],checkpoints:Ce.data.checkpoints||[]}));await li(Se)?await eu(Se,"areaLeadDashboard",nt):await lc(Se,{areaLeadDashboard:nt}),console.log("Area lead dashboard cached for offline access")}}catch(Ce){Ce.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Ce)}console.log("Background preload complete")},Ii=async()=>{const Se=o.params.eventId;try{const Ce=await ms.getAreaLeadDashboard(Se);Ce.data?.checkpoints&&(ee.value=Ce.data.checkpoints,console.log("Area lead dashboard loaded:",ee.value.length,"checkpoints"))}catch(Ce){Ce.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Ce)}},xi=async()=>{const Se=o.params.eventId;try{const Ce=await ba.getMyNotes(Se);_e.value=Ce.data||[],Q.value.notes=Date.now(),console.log("Notes loaded:",_e.value.length)}catch(Ce){console.error("Failed to load notes:",Ce)}},$i=async()=>{const Se=o.params.eventId;Ci.value=!0;try{const Ce=await us.getMyContacts(Se);jo.value=Ce.data||[],Q.value.eventContacts=Date.now(),console.log("Contacts loaded:",jo.value.length)}catch(Ce){console.warn("Failed to load contacts:",Ce),jo.value=[]}finally{Ci.value=!1}},Ns=async()=>{const Se=o.params.eventId;try{const Ce=await Ks.getMyRoles(Se);Be.value=Ce.data||[],console.log("Roles loaded:",Be.value.length)}catch(Ce){console.warn("Failed to load roles:",Ce),Be.value=[]}},Fs=()=>{Sn.value=!1,dt.value&&(dt.value(),dt.value=null)},da=()=>{Sn.value=!1,dt.value=null},pr=()=>{Yt.value=!1},Oa=async Se=>{if(An.value&&Ct.value){await pe(Ct.value.locationId,Se.lat,Se.lng,"manual"),An.value=!1,Ct.value=null,Co.value?.mapRef?.closeFullscreen?.(),ko();return}if(os.value&&ua.value){const Ce=ua.value;io.value="Update location",ia.value=`Update ${Ce.location?.name||"dynamic checkpoint"} to this location?`,dt.value=async()=>{await pe(Ce.locationId,Se.lat,Se.lng,"manual"),Co.value?.mapRef?.closeFullscreen?.()},Sn.value=!0}},Bn=async Se=>{if(An.value&&Ct.value){if(Se.id===Ct.value.locationId)return;await pe(Ct.value.locationId,Se.latitude,Se.longitude,"checkpoint",Se.id),An.value=!1,Co.value?.mapRef?.closeFullscreen?.(),ko();return}if(os.value&&ua.value){const Ce=ua.value;if(Se.id===Ce.locationId)return;io.value="Copy location",ia.value=`Copy location from "${Se.name}" to ${Ce.location?.name||"your dynamic checkpoint"}?`,dt.value=async()=>{await pe(Ce.locationId,Se.latitude,Se.longitude,"checkpoint",Se.id),Co.value?.mapRef?.closeFullscreen?.()},Sn.value=!0}},is=()=>{I(()=>{re.value=[],ne.value=[],Si.value=[]})},Ti=Se=>Se?new Date(Se).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return un(async()=>{const Se=o.params.eventId,Ce=o.query.code;ie.value=!0;try{Ce?await S(Se,Ce):await w(Se)&&await _l()}finally{ie.value=!1}d.value&&(no(),"requestIdleCallback"in window?requestIdleCallback(()=>{Cl()},{timeout:5e3}):setTimeout(()=>{Cl()},2e3))}),Ye(d,Se=>{Se?no():Mo()}),Ye(()=>o.query.code,async Se=>{if(Se&&d.value){ie.value=!0;try{await S(o.params.eventId,Se)}finally{ie.value=!1}}}),Ye(Z,Se=>{Se&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),Ln(()=>{E(),Qe(),on(),gn()}),(Se,Ce)=>(p(),g("div",{class:"marshal-view",style:tt(F(X))},[Pe(DV),r("header",{class:le(["header",`logo-${F(be)}`]),style:tt(F(ae))},[F(ze)&&F(be)==="cover"?(p(),g("div",qK,[r("img",{src:F(ze),alt:"Event logo",class:"header-logo-cover-img"},null,8,jK)])):P("",!0),F(d)&&F(be)==="right"?(p(),g("button",{key:1,onClick:is,class:"btn-close-session btn-close-left",style:tt({color:F(he)}),title:"Close session"},"  ",4)):P("",!0),F(ze)&&F(be)==="left"?(p(),g("div",WK,[r("img",{src:F(ze),alt:"Event logo",class:"header-logo-img"},null,8,ZK)])):P("",!0),r("div",KK,[r("div",{class:"header-title",style:tt({color:F(he)})},[Z.value?(p(),g("h1",YK,b(Z.value.name),1)):P("",!0),Z.value?.eventDate?(p(),g("div",JK,[Je(b(Ti(Z.value.eventDate))+" ",1),F(Re)&&F(se)?(p(),g("span",{key:0,class:"header-weather",title:F(se).description},[Pe(GK,{icon:F(se).icon,size:18,alt:F(se).description,color:F(he)},null,8,["icon","alt","color"]),r("span",QK,b(F(se).tempMax)+""+b(F(se).unit),1)],8,XK)):P("",!0)])):P("",!0)],4),F(d)?(p(),g("div",eY,[r("button",{onClick:Ce[0]||(Ce[0]=nt=>Xa.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),Wo.value?(p(),g("button",{key:0,onClick:Ce[1]||(Ce[1]=nt=>Pn.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):P("",!0)])):P("",!0)]),F(ze)&&F(be)==="right"?(p(),g("div",tY,[r("img",{src:F(ze),alt:"Event logo",class:"header-logo-img"},null,8,nY)])):P("",!0),F(d)&&F(be)!=="right"?(p(),g("button",{key:4,onClick:is,class:"btn-close-session btn-close-right",style:tt({color:F(he)}),title:"Close session"},"  ",4)):P("",!0)],6),r("div",oY,[ie.value?(p(),g("div",aY,[...Ce[25]||(Ce[25]=[r("div",{class:"loading"},"Loading...",-1)])])):!F(d)&&!F(f)?(p(),g("div",sY,[Ce[26]||(Ce[26]=r("h2",null,"Welcome",-1)),Ce[27]||(Ce[27]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),F(h)?(p(),g("p",iY,"Authenticating...")):P("",!0)])):F(f)?(p(),g("div",lY,[Ce[28]||(Ce[28]=r("h2",null,"Login failed",-1)),r("p",rY,b(F(f)),1),Ce[29]||(Ce[29]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(p(),g("div",cY,[F(D)||F(M)?(p(),g("div",uY,[r("div",dY,[F(m)?.email?(p(),g("span",hY,b(F(m).email),1)):P("",!0)]),F(D)?(p(),g("div",fY,[r("button",{onClick:Ce[2]||(Ce[2]=(...nt)=>F(B)&&F(B)(...nt)),class:"btn-mode-switch"}," Switch to Admin ")])):F(M)?(p(),g("div",pY,[...Ce[30]||(Ce[30]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),r("div",vY,[Pe(xK,{roles:Be.value,"is-expanded":q.value==="roles",onToggle:Ce[3]||(Ce[3]=nt=>an("roles"))},null,8,["roles","is-expanded"]),Pe(gK,{ref:"assignmentsSectionRef","is-expanded":q.value==="assignments",assignments:Lo.value,"expanded-checkpoint-id":wn.value,"all-locations":J.value,route:as.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,"user-location":F(xt),"has-dynamic-assignment":gl.value,"current-marshal-id":F(y),"current-marshal-name":F(k),"checking-in-id":F(Vo),"checking-in-assignment-id":F(bo),"check-in-error":F(mi),"checking-in-marshal-id":F(Vo),"expanded-marshal-id":es.value,"updating-location":F(go),"auto-update-enabled":F(oo),"get-toolbar-actions":F(ml),"is-area-lead-for-areas":ki,"get-notes-for-checkpoint":bl,"area-lead-area-ids":F(_),onToggle:Ce[4]||(Ce[4]=nt=>an("assignments")),onToggleCheckpoint:sn,onMapClick:Oa,onLocationClick:Bn,onActionClick:F(At),onVisibilityChange:F(bi),onUpdateLocation:F(tn),onCheckIn:Ce[5]||(Ce[5]=nt=>F(so)(nt,!0)),onToggleMarshal:ca,onMarshalCheckIn:Ce[6]||(Ce[6]=(nt,mt)=>F(so)(nt,!1,mt)),onToggleAutoUpdate:F(lt),onShowMarshalQr:la},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","route-color","route-style","route-weight","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Pe(Hq,{loading:F(ge),error:F(Oe),"is-expanded":q.value==="checklist","is-area-lead":F(x),"my-items":F(Ge),"area-items":F(fe),"area-items-with-local-state":F(ke),"visible-items":F(me),"grouped-items":F(He),"completed-count":F(Ze),saving:F(De),"effective-group-by":F(ye),"expanded-group":F(xe),locations:J.value,areas:K.value,marshals:F(te),"get-context-name":F(Lt),onToggle:Ce[7]||(Ce[7]=nt=>an("checklist")),onToggleItem:F(kt),onToggleGroup:F(Rt)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Pe(Kq,{"event-id":F(o).params.eventId,notes:_e.value,locations:J.value,areas:K.value,assignments:re.value,"is-expanded":q.value==="notes",onToggle:Ce[8]||(Ce[8]=nt=>an("notes")),onNotesChanged:xi},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Pe(BG,{contacts:On.value,loading:Ci.value,"is-expanded":q.value==="eventContacts",onToggle:Ce[9]||(Ce[9]=nt=>an("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Pe(WG,{incidents:F(Ya),loading:F(As),"is-expanded":q.value==="incidents",onToggle:Ce[10]||(Ce[10]=nt=>an("incidents")),onSelectIncident:F(yi)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Pe($W,{ref_key:"areaLeadSectionRef",ref:Ue,"is-area-lead":F(x),"is-expanded":q.value==="areaLead",areas:$.value,"selected-filters":N.value,"filtered-area-ids":z.value,"event-id":F(o).params.eventId,"marshal-id":F(y),route:as.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onToggle:Ce[11]||(Ce[11]=nt=>an("areaLead")),onToggleFilter:O,onChecklistUpdated:F(rt)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","route-color","route-style","route-weight","onChecklistUpdated"]),Pe(nZ,{"is-area-lead":F(x),"is-expanded":q.value==="areaLeadMarshals",marshals:F(zo),"expanded-marshal-id":F(fl),"checking-in-marshal-id":F(Vo),"saving-task":F(pl),"current-marshal-id":F(y),onToggle:Ce[12]||(Ce[12]=nt=>an("areaLeadMarshals")),onToggleMarshal:F(Ho),onCheckIn:F(sa),onToggleTask:F(Ts),onShowQr:la},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","current-marshal-id","onToggleMarshal","onCheckIn","onToggleTask"]),Pe(ij,{ref_key:"routeSectionRef",ref:Co,"is-expanded":q.value==="map","user-location":F(xt),"selecting-location":F(An),"selecting-location-name":F(Ct)?.location?.name||"",locations:ns.value,route:as.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,center:Bs.value,"highlight-location-ids":In.value,clickable:F(An)||os.value,"toolbar-actions":F(Da),onToggle:Ce[13]||(Ce[13]=nt=>an("map")),onCancelSelect:hl,onMapClick:Oa,onLocationClick:Bn,onActionClick:F(Rs),onVisibilityChange:F(Ra)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","route-color","route-style","route-weight","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Pe(sq,{"event-date":Z.value?.eventDate,description:Z.value?.description,"is-expanded":q.value==="eventDetails",onToggle:Ce[14]||(Ce[14]=nt=>an("eventDetails"))},null,8,["event-date","description","is-expanded"])]),U.value?(p(),g("div",mY,[...Ce[31]||(Ce[31]=[r("span",{class:"refresh-spinner"},null,-1),r("span",null,"Updating...",-1)])])):P("",!0)]))]),Pe(bV,{show:Pn.value,contacts:kl.value,notes:Li.value,onClose:Ce[15]||(Ce[15]=nt=>Pn.value=!1)},null,8,["show","contacts","notes"]),Pe(C1,{show:F(Xa),"event-id":l.value||"",checkpoint:j.value,"initial-location":F(xt),checkpoints:J.value,route:as.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onClose:Ce[16]||(Ce[16]=nt=>Xa.value=!1),onSubmit:F(vl)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","route-color","route-style","route-weight","onSubmit"]),Pe(_1,{show:F(Es),incident:F(Ja),route:as.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,checkpoints:J.value,"can-manage":F(x),onClose:Ce[17]||(Ce[17]=nt=>Es.value=!1),onStatusChange:F(hr),onOpenAddNote:F(bt)},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Pe(Zt,{show:F(gi),title:"Add update",size:"small",onClose:F(Dt)},{footer:Ve(()=>[r("div",yY,[r("button",{type:"button",class:"btn btn-secondary",onClick:Ce[19]||(Ce[19]=(...nt)=>F(Dt)&&F(Dt)(...nt))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Ce[20]||(Ce[20]=(...nt)=>F(Ut)&&F(Ut)(...nt)),disabled:!F(ra).trim()||F(Ps)},b(F(Ps)?"Adding...":"Add update"),9,kY)])]),default:Ve(()=>[r("div",gY,[We(r("textarea",{"onUpdate:modelValue":Ce[18]||(Ce[18]=nt=>dn(ra)?ra.value=nt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,F(ra)]])])]),_:1},8,["show","onClose"]),Pe(hi,{show:Sn.value,title:io.value,message:ia.value,onConfirm:Fs,onCancel:da},null,8,["show","title","message"]),Pe(hi,{show:Yt.value,title:Eo.value,message:wo.value,"show-cancel":!1,onConfirm:pr},null,8,["show","title","message"]),Pe(VV,{show:F(En),checkpoint:F(Ao),"accent-button-style":F(Me),onDismiss:Ce[21]||(Ce[21]=nt=>F(vt)(F(Ao)?.id)),onGoToCheckpoint:yl},null,8,["show","checkpoint","accent-button-style"]),Pe(mG,{show:F(ft),assignment:F(Ct),"user-location":F(xt),"auto-update-enabled":F(oo),updating:F(go),error:F(Mt),success:F(Mn),"available-checkpoints":Os.value,"accent-button-style":F(Me),onClose:F(Pa),onUpdateGps:F(ve),onToggleAutoUpdate:Ce[22]||(Ce[22]=nt=>F(lt)(F(Ct))),onSelectOnMap:Za,onCopyFromCheckpoint:F(Le)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"]),!Jt.value&&!Gn.value&&qo.value?(p(),qe(Ff,{key:0,show:Go.value,url:qo.value,title:`Magic link for ${_o.value}`,warning:`Only share this QR code with ${_o.value}. This link provides full access to their ${F(n).person} dashboard.`,"z-index":1100,onClose:Ce[23]||(Ce[23]=nt=>Go.value=!1)},null,8,["show","url","title","warning"])):P("",!0),Jt.value||Gn.value?(p(),qe(Zt,{key:1,show:Go.value,title:`Magic link for ${_o.value}`,size:"small","z-index":1100,onClose:Ce[24]||(Ce[24]=nt=>Go.value=!1)},{default:Ve(()=>[Jt.value?(p(),g("div",bY,[...Ce[32]||(Ce[32]=[r("p",null,"Loading magic link...",-1)])])):Gn.value?(p(),g("div",wY,[r("p",null,b(Gn.value),1)])):P("",!0)]),_:1},8,["show","title"])):P("",!0)],4))}},LY=Ke(CY,[["__scopeId","data-v-611126d0"]]),SY={class:"form-group"},IY={class:"form-group"},xY={class:"form-group"},$Y={class:"actions-left"},TY={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const n=e,a=t,o=A({name:"",email:"",phone:""});Ye(()=>n.profile,h=>{h&&(o.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ye(()=>n.show,h=>{h&&n.profile&&(o.value={name:n.profile.name||"",email:n.profile.email||"",phone:n.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},l=()=>{if(!o.value.name.trim()){alert("Name is required");return}if(!o.value.email.trim()){alert("Email is required");return}a("submit",{name:o.value.name.trim(),email:o.value.email.trim(),phone:o.value.phone?.trim()||""})},c=()=>{a("close")},d=()=>{a("logout")};return(h,f)=>(p(),qe(Zt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("div",$Y,[e.showLogout?(p(),g("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):P("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:ct(l,["prevent"])},[r("div",SY,[f[3]||(f[3]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>o.value.name=m),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[at,o.value.name]])]),r("div",IY,[f[4]||(f[4]=r("label",null,"Email *",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>o.value.email=m),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[at,o.value.email]])]),r("div",xY,[f[5]||(f[5]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>o.value.phone=m),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[at,o.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},MY=Ke(TY,[["__scopeId","data-v-178e5f48"]]),AY={class:"tabs"},EY={class:"tab-content"},PY={class:"form-group"},DY={class:"form-group"},RY={class:"form-group"},OY={class:"form-group"},BY=["value"],NY={class:"tab-content"},FY={class:"emergency-contacts-section"},UY={key:0,class:"empty-state"},zY={class:"card-header"},HY=["onClick"],VY={class:"form-group"},GY=["onUpdate:modelValue"],qY={class:"form-group"},jY=["onUpdate:modelValue"],WY={class:"form-group"},ZY=["onUpdate:modelValue"],KY={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const n=e,a=t,{activeTab:o,switchTab:i,resetTab:l}=qy("basic",["basic","emergency"]),c=A({...n.eventData});Ye(()=>n.eventData,y=>{c.value={...y},c.value.emergencyContacts||(c.value.emergencyContacts=[])},{deep:!0}),Ye(()=>n.show,y=>{y&&l()});const d=()=>{c.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{c.value.emergencyContacts.splice(y,1)},f=()=>{a("submit",{...c.value})},m=()=>{a("close")};return(y,k)=>(p(),qe(Zt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Ve(()=>[r("div",AY,[r("button",{type:"button",onClick:k[0]||(k[0]=_=>F(i)("basic")),class:le(["tab-button",{active:F(o)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=_=>F(i)("emergency")),class:le(["tab-button",{active:F(o)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ve(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:ct(f,["prevent"])},[We(r("div",EY,[r("div",PY,[k[6]||(k[6]=r("label",null,"Event name *",-1)),We(r("input",{"onUpdate:modelValue":k[2]||(k[2]=_=>c.value.name=_),type:"text",required:"",class:"form-input"},null,512),[[at,c.value.name]])]),r("div",DY,[k[7]||(k[7]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=_=>c.value.description=_),rows:"3",class:"form-input"},null,512),[[at,c.value.description]])]),r("div",RY,[k[8]||(k[8]=r("label",null,"Event date *",-1)),We(r("input",{"onUpdate:modelValue":k[4]||(k[4]=_=>c.value.eventDate=_),type:"datetime-local",required:"",class:"form-input"},null,512),[[at,c.value.eventDate]])]),r("div",OY,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),We(r("select",{"onUpdate:modelValue":k[5]||(k[5]=_=>c.value.timeZoneId=_),required:"",class:"form-input"},[(p(!0),g(Ie,null,je(F(f1),_=>(p(),g("option",{key:_.value,value:_.value},b(_.label),9,BY))),128))],512),[[Qn,c.value.timeZoneId]])])],512),[[oa,F(o)==="basic"]]),We(r("div",NY,[r("div",FY,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),c.value.emergencyContacts.length===0?(p(),g("div",UY,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(p(!0),g(Ie,null,je(c.value.emergencyContacts,(_,x)=>(p(),g("div",{key:x,class:"emergency-contact-card"},[r("div",zY,[r("h4",null,"Contact "+b(x+1),1),r("button",{type:"button",onClick:D=>h(x),class:"btn-remove"},"  ",8,HY)]),r("div",VY,[k[12]||(k[12]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":D=>_.name=D,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,GY),[[at,_.name]])]),r("div",qY,[k[13]||(k[13]=r("label",null,"Phone *",-1)),We(r("input",{"onUpdate:modelValue":D=>_.phone=D,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,jY),[[at,_.phone]])]),r("div",WY,[k[14]||(k[14]=r("label",null,"Additional details",-1)),We(r("textarea",{"onUpdate:modelValue":D=>_.details=D,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,ZY),[[at,_.details]])])]))),128))])],512),[[oa,F(o)==="emergency"]])],32)]),_:1},8,["show","title"]))}},YY=Ke(KY,[["__scopeId","data-v-d820eb4f"]]),JY=Lf("profile",()=>{const e=A(null),t=A(!1),n=A(null);return{profile:e,loading:t,error:n,fetchProfile:async()=>{t.value=!0,n.value=null;try{const d=await Fc.getProfile();return e.value=d.data,d.data}catch(d){throw n.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,n.value=null;try{const h=await Fc.updateProfile(d);return e.value=h.data,h.data}catch(h){throw n.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,n.value=null;try{return(await Fc.getPerson(d,h)).data}catch(f){throw n.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,n.value=null;try{return(await Fc.updatePerson(d,h,f)).data}catch(m){throw n.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,n.value=null}}}),XY={class:"sessions-view"},QY={class:"sessions-container"},eJ={key:0,class:"loading-state"},tJ={key:1,class:"empty-state"},nJ={key:2,class:"sessions-list"},oJ={class:"section-header"},aJ={class:"section-actions"},sJ=["onClick"],iJ={class:"session-info"},lJ={class:"event-name"},rJ={key:0,class:"event-date"},cJ={key:1,class:"sign-in-section"},uJ={key:2,class:"section-header"},dJ=["onClick"],hJ={class:"session-info"},fJ={class:"event-name"},pJ={class:"role-name"},vJ={key:0,class:"event-date"},mJ=["onClick"],gJ={class:"modal-card"},yJ={class:"modal-actions"},kJ={class:"modal-card"},bJ={class:"modal-actions"},wJ={__name:"SessionsView",setup(e){const t=rr(),n=mc(),a=Gy(),o=JY(),i=A([]),l=A([]),c=A(!0),d=A(!1),h=A(!1),f=A(!1),m=A(!1),y=A(null),k=A(!1),_=A({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),x=H(()=>localStorage.getItem("adminEmail")),D=H(()=>!!x.value),M=()=>{i.value=Rw()},S=ie=>{uy(ie.eventId,ie.marshalId),t.push(`/event/${ie.eventId}`)},w=ie=>{y.value=ie,f.value=!0},I=async()=>{if(!y.value)return;const{sessionKey:ie,eventId:U}=y.value;try{Oo("marshal",U),await authApi.logout()}catch{}Uh(ie),Oo(null),M(),f.value=!1,y.value=null},T=()=>{m.value=!0},B=async()=>{await n.logout(),l.value=[],m.value=!1},E=async()=>{if(h.value=!0,!o.profile)try{await o.fetchProfile()}catch(ie){console.error("Failed to load profile:",ie)}},N=async ie=>{try{await o.updateProfile(ie),h.value=!1}catch(U){console.error("Failed to save profile:",U),alert("Failed to save profile. Please try again.")}},$=async()=>{await n.logout(),l.value=[],h.value=!1},z=ie=>ie?new Date(ie).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",O=async()=>{if(D.value)try{Oo("admin");const ie=await ni.getAll();l.value=ie.data||[]}catch(ie){console.error("Failed to load admin events:",ie),l.value=[]}},j=ie=>{t.push(`/admin/event/${ie}`)},Z=()=>{t.push("/")},J=()=>{},re=()=>{k.value=!1,_.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},K=async ie=>{try{const U={...ie,adminEmail:n.adminEmail};await a.createEvent(U),re(),await O()}catch(U){console.error("Failed to create event:",U),alert("Failed to create event. Please try again.")}};return un(async()=>{document.title="OnTheDay App - Sessions",hy(),dy(),M(),await O(),c.value=!1}),(ie,U)=>(p(),g("div",XY,[r("div",QY,[Pe(Hy,{title:"Your sessions"}),c.value?(p(),g("div",eJ,[...U[9]||(U[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(p(),g("div",tJ,[U[10]||(U[10]=r("p",null,"No active sessions.",-1)),U[11]||(U[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:U[0]||(U[0]=X=>d.value=!0)}," Sign in ")])):(p(),g("div",nJ,[D.value?(p(),g(Ie,{key:0},[r("div",oJ,[U[12]||(U[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",aJ,[r("button",{class:"btn btn-small btn-primary",onClick:E}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:U[1]||(U[1]=X=>k.value=!0)}," Create event ")])]),(p(!0),g(Ie,null,je(l.value,X=>(p(),g("div",{key:"admin-"+X.id,class:"session-card admin-card",onClick:ae=>j(X.id)},[U[14]||(U[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",iJ,[r("div",lJ,b(X.name),1),U[13]||(U[13]=r("div",{class:"role-name"},"Admin",-1)),X.eventDate?(p(),g("div",rJ,b(z(X.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:ct(T,["stop"]),title:"Log out as admin"},"  ")],8,sJ))),128))],64)):(p(),g("div",cJ,[r("button",{class:"btn btn-primary",onClick:U[2]||(U[2]=X=>d.value=!0)}," Sign in ")])),i.value.length>0?(p(),g("div",uJ,[...U[15]||(U[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):P("",!0),(p(!0),g(Ie,null,je(i.value,X=>(p(),g("div",{key:X.sessionKey,class:"session-card",onClick:ae=>S(X)},[U[16]||(U[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",hJ,[r("div",fJ,b(X.eventName||"Event"),1),r("div",pJ,b(X.marshalName||"Marshal"),1),X.eventDate?(p(),g("div",vJ,b(z(X.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:ct(ae=>w(X),["stop"]),title:"Log out from this session"},"  ",8,mJ)],8,dJ))),128))])),r("button",{class:"btn-back-home",onClick:Z,title:"Back to home"},"  ")]),Pe(Vy,{show:d.value,onClose:U[3]||(U[3]=X=>d.value=!1),onSuccess:J},null,8,["show"]),Pe(MY,{show:h.value,profile:F(o).profile,"show-logout":!0,onClose:U[4]||(U[4]=X=>h.value=!1),onSubmit:N,onLogout:$},null,8,["show","profile"]),Pe(YY,{show:k.value,"event-data":_.value,"is-editing":!1,onClose:re,onSubmit:K},null,8,["show","event-data"]),(p(),qe(ec,{to:"body"},[Pe(Ia,{name:"modal"},{default:Ve(()=>[m.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:U[6]||(U[6]=ct(X=>m.value=!1,["self"]))},[r("div",gJ,[U[17]||(U[17]=r("h3",null,"Log out as admin?",-1)),U[18]||(U[18]=r("p",null,"This will log you out from all admin events.",-1)),U[19]||(U[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",yJ,[r("button",{class:"btn btn-secondary",onClick:U[5]||(U[5]=X=>m.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:B},"Log out")])])])):P("",!0)]),_:1})])),(p(),qe(ec,{to:"body"},[Pe(Ia,{name:"modal"},{default:Ve(()=>[f.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:U[8]||(U[8]=ct(X=>f.value=!1,["self"]))},[r("div",kJ,[U[22]||(U[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[U[20]||(U[20]=Je("This will log you out from ",-1)),r("strong",null,b(y.value?.eventName||"this event"),1),U[21]||(U[21]=Je(".",-1))]),U[23]||(U[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",bJ,[r("button",{class:"btn btn-secondary",onClick:U[7]||(U[7]=X=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:I},"Log out")])])])):P("",!0)]),_:1})]))]))}},_J=Ke(wJ,[["__scopeId","data-v-add55e1c"]]);let _m=!1;function CJ(){_m||(_m=!0,hy(),dy())}const LJ=[{path:"/",name:"Home",component:GC},{path:"/admin/login",name:"AdminLogin",component:XC},{path:"/admin/verify",name:"AdminVerify",component:s2},{path:"/sessions",name:"Sessions",component:_J},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:nV,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:LY},{path:"/:pathMatch(.*)*",redirect:"/"}],I1=kw({history:Jb("/VolunteerCheckin/testing/"),routes:LJ});I1.beforeEach((e,t,n)=>{CJ();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){n({name:"AdminLogin"});return}if(e.meta.requiresAuth?Oo("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&Oo(null),e.name==="MarshalView"){const o=e.params.eventId,i=!!e.query.code,l=bu(o),c=l?.marshalId?py(o,l.marshalId):null;if(i){n();return}if(l?.token){n();return}if(c){n();return}if(fy()){n({name:"Sessions"});return}}n()});xs().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Vf=ab(Pw);Vf.use(lb());Vf.use(I1);Vf.mount("#app");
