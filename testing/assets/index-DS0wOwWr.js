(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function rf(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const nn={},Wl=[],_s=()=>{},Tm=()=>!1,Ru=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),cf=e=>e.startsWith("onUpdate:"),Rn=Object.assign,uf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},V1=Object.prototype.hasOwnProperty,Kt=(e,t)=>V1.call(e,t),ut=Array.isArray,Zl=e=>uc(e)==="[object Map]",ar=e=>uc(e)==="[object Set]",Xf=e=>uc(e)==="[object Date]",_t=e=>typeof e=="function",fn=e=>typeof e=="string",Is=e=>typeof e=="symbol",Qt=e=>e!==null&&typeof e=="object",Mm=e=>(Qt(e)||_t(e))&&_t(e.then)&&_t(e.catch),Am=Object.prototype.toString,uc=e=>Am.call(e),G1=e=>uc(e).slice(8,-1),Em=e=>uc(e)==="[object Object]",Ou=e=>fn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dr=rf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Bu=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},q1=/-\w/g,ts=Bu(e=>e.replace(q1,t=>t.slice(1).toUpperCase())),j1=/\B([A-Z])/g,yi=Bu(e=>e.replace(j1,"-$1").toLowerCase()),Nu=Bu(e=>e.charAt(0).toUpperCase()+e.slice(1)),bd=Bu(e=>e?`on${Nu(e)}`:""),di=(e,t)=>!Object.is(e,t),Zc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Pm=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Fu=e=>{const t=parseFloat(e);return isNaN(t)?e:t},W1=e=>{const t=fn(e)?Number(e):NaN;return isNaN(t)?e:t};let Qf;const Uu=()=>Qf||(Qf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],o=fn(s)?J1(s):tt(s);if(o)for(const i in o)t[i]=o[i]}return t}else if(fn(e)||Qt(e))return e}const Z1=/;(?![^(]*\))/g,K1=/:([^]+)/,Y1=/\/\*[^]*?\*\//g;function J1(e){const t={};return e.replace(Y1,"").split(Z1).forEach(n=>{if(n){const s=n.split(K1);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function le(e){let t="";if(fn(e))t=e;else if(ut(e))for(let n=0;n<e.length;n++){const s=le(e[n]);s&&(t+=s+" ")}else if(Qt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const X1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Q1=rf(X1);function Dm(e){return!!e||e===""}function ek(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=el(e[s],t[s]);return n}function el(e,t){if(e===t)return!0;let n=Xf(e),s=Xf(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=Is(e),s=Is(t),n||s)return e===t;if(n=ut(e),s=ut(t),n||s)return n&&s?ek(e,t):!1;if(n=Qt(e),s=Qt(t),n||s){if(!n||!s)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const l in e){const c=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(c&&!d||!c&&d||!el(e[l],t[l]))return!1}}return String(e)===String(t)}function df(e,t){return e.findIndex(n=>el(n,t))}const Rm=e=>!!(e&&e.__v_isRef===!0),_=e=>fn(e)?e:e==null?"":ut(e)||Qt(e)&&(e.toString===Am||!_t(e.toString))?Rm(e)?_(e.value):JSON.stringify(e,Om,2):String(e),Om=(e,t)=>Rm(t)?Om(e,t.value):Zl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,o],i)=>(n[wd(s,i)+" =>"]=o,n),{})}:ar(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>wd(n))}:Is(t)?wd(t):Qt(t)&&!ut(t)&&!Em(t)?String(t):t,wd=(e,t="")=>{var n;return Is(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function tk(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Yn;class Bm{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yn,!t&&Yn&&(this.index=(Yn.scopes||(Yn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Yn;try{return Yn=this,t()}finally{Yn=n}}}on(){++this._on===1&&(this.prevScope=Yn,Yn=this)}off(){this._on>0&&--this._on===0&&(Yn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Nm(e){return new Bm(e)}function Fm(){return Yn}function nk(e,t=!1){Yn&&Yn.cleanups.push(e)}let on;const _d=new WeakSet;class Um{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yn&&Yn.active&&Yn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,_d.has(this)&&(_d.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Hm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ep(this),Vm(this);const t=on,n=Cs;on=this,Cs=!0;try{return this.fn()}finally{Gm(this),on=t,Cs=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)pf(t);this.deps=this.depsTail=void 0,ep(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?_d.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_h(this)&&this.run()}get dirty(){return _h(this)}}let zm=0,Rr,Or;function Hm(e,t=!1){if(e.flags|=8,t){e.next=Or,Or=e;return}e.next=Rr,Rr=e}function hf(){zm++}function ff(){if(--zm>0)return;if(Or){let t=Or;for(Or=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Rr;){let t=Rr;for(Rr=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function Vm(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Gm(e){let t,n=e.depsTail,s=n;for(;s;){const o=s.prevDep;s.version===-1?(s===n&&(n=o),pf(s),ok(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=o}e.deps=t,e.depsTail=n}function _h(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(qm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function qm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Jr)||(e.globalVersion=Jr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!_h(e))))return;e.flags|=2;const t=e.dep,n=on,s=Cs;on=e,Cs=!0;try{Vm(e);const o=e.fn(e._value);(t.version===0||di(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{on=n,Cs=s,Gm(e),e.flags&=-3}}function pf(e,t=!1){const{dep:n,prevSub:s,nextSub:o}=e;if(s&&(s.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)pf(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function ok(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Cs=!0;const jm=[];function Ca(){jm.push(Cs),Cs=!1}function La(){const e=jm.pop();Cs=e===void 0?!0:e}function ep(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=on;on=void 0;try{t()}finally{on=n}}}let Jr=0;class sk{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class vf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!on||!Cs||on===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==on)n=this.activeLink=new sk(on,this),on.deps?(n.prevDep=on.depsTail,on.depsTail.nextDep=n,on.depsTail=n):on.deps=on.depsTail=n,Wm(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=on.depsTail,n.nextDep=void 0,on.depsTail.nextDep=n,on.depsTail=n,on.deps===n&&(on.deps=s)}return n}trigger(t){this.version++,Jr++,this.notify(t)}notify(t){hf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ff()}}}function Wm(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Wm(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const ru=new WeakMap,Yi=Symbol(""),Ch=Symbol(""),Xr=Symbol("");function Qn(e,t,n){if(Cs&&on){let s=ru.get(e);s||ru.set(e,s=new Map);let o=s.get(n);o||(s.set(n,o=new vf),o.map=s,o.key=n),o.track()}}function fa(e,t,n,s,o,i){const l=ru.get(e);if(!l){Jr++;return}const c=d=>{d&&d.trigger()};if(hf(),t==="clear")l.forEach(c);else{const d=ut(e),h=d&&Ou(n);if(d&&n==="length"){const f=Number(s);l.forEach((v,g)=>{(g==="length"||g===Xr||!Is(g)&&g>=f)&&c(v)})}else switch((n!==void 0||l.has(void 0))&&c(l.get(n)),h&&c(l.get(Xr)),t){case"add":d?h&&c(l.get("length")):(c(l.get(Yi)),Zl(e)&&c(l.get(Ch)));break;case"delete":d||(c(l.get(Yi)),Zl(e)&&c(l.get(Ch)));break;case"set":Zl(e)&&c(l.get(Yi));break}}ff()}function ak(e,t){const n=ru.get(e);return n&&n.get(t)}function Rl(e){const t=Ht(e);return t===e?t:(Qn(t,"iterate",Xr),Uo(e)?t:t.map(Ss))}function zu(e){return Qn(e=Ht(e),"iterate",Xr),e}function ei(e,t){return Ia(e)?wa(e)?Ql(Ss(t)):Ql(t):Ss(t)}const ik={__proto__:null,[Symbol.iterator](){return Cd(this,Symbol.iterator,e=>ei(this,e))},concat(...e){return Rl(this).concat(...e.map(t=>ut(t)?Rl(t):t))},entries(){return Cd(this,"entries",e=>(e[1]=ei(this,e[1]),e))},every(e,t){return la(this,"every",e,t,void 0,arguments)},filter(e,t){return la(this,"filter",e,t,n=>n.map(s=>ei(this,s)),arguments)},find(e,t){return la(this,"find",e,t,n=>ei(this,n),arguments)},findIndex(e,t){return la(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return la(this,"findLast",e,t,n=>ei(this,n),arguments)},findLastIndex(e,t){return la(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return la(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ld(this,"includes",e)},indexOf(...e){return Ld(this,"indexOf",e)},join(e){return Rl(this).join(e)},lastIndexOf(...e){return Ld(this,"lastIndexOf",e)},map(e,t){return la(this,"map",e,t,void 0,arguments)},pop(){return wr(this,"pop")},push(...e){return wr(this,"push",e)},reduce(e,...t){return tp(this,"reduce",e,t)},reduceRight(e,...t){return tp(this,"reduceRight",e,t)},shift(){return wr(this,"shift")},some(e,t){return la(this,"some",e,t,void 0,arguments)},splice(...e){return wr(this,"splice",e)},toReversed(){return Rl(this).toReversed()},toSorted(e){return Rl(this).toSorted(e)},toSpliced(...e){return Rl(this).toSpliced(...e)},unshift(...e){return wr(this,"unshift",e)},values(){return Cd(this,"values",e=>ei(this,e))}};function Cd(e,t,n){const s=zu(e),o=s[t]();return s!==e&&!Uo(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=n(i.value)),i}),o}const lk=Array.prototype;function la(e,t,n,s,o,i){const l=zu(e),c=l!==e&&!Uo(e),d=l[t];if(d!==lk[t]){const v=d.apply(e,i);return c?Ss(v):v}let h=n;l!==e&&(c?h=function(v,g){return n.call(this,ei(e,v),g,e)}:n.length>2&&(h=function(v,g){return n.call(this,v,g,e)}));const f=d.call(l,h,s);return c&&o?o(f):f}function tp(e,t,n,s){const o=zu(e);let i=n;return o!==e&&(Uo(e)?n.length>3&&(i=function(l,c,d){return n.call(this,l,c,d,e)}):i=function(l,c,d){return n.call(this,l,ei(e,c),d,e)}),o[t](i,...s)}function Ld(e,t,n){const s=Ht(e);Qn(s,"iterate",Xr);const o=s[t](...n);return(o===-1||o===!1)&&Hu(n[0])?(n[0]=Ht(n[0]),s[t](...n)):o}function wr(e,t,n=[]){Ca(),hf();const s=Ht(e)[t].apply(e,n);return ff(),La(),s}const rk=rf("__proto__,__v_isRef,__isVue"),Zm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Is));function ck(e){Is(e)||(e=String(e));const t=Ht(this);return Qn(t,"has",e),t.hasOwnProperty(e)}class Km{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(o?i?kk:Qm:i?Xm:Jm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const l=ut(t);if(!o){let d;if(l&&(d=ik[n]))return d;if(n==="hasOwnProperty")return ck}const c=Reflect.get(t,n,hn(t)?t:s);if((Is(n)?Zm.has(n):rk(n))||(o||Qn(t,"get",n),i))return c;if(hn(c)){const d=l&&Ou(n)?c:c.value;return o&&Qt(d)?Ih(d):d}return Qt(c)?o?Ih(c):ol(c):c}}class Ym extends Km{constructor(t=!1){super(!1,t)}set(t,n,s,o){let i=t[n];const l=ut(t)&&Ou(n);if(!this._isShallow){const h=Ia(i);if(!Uo(s)&&!Ia(s)&&(i=Ht(i),s=Ht(s)),!l&&hn(i)&&!hn(s))return h||(i.value=s),!0}const c=l?Number(n)<t.length:Kt(t,n),d=Reflect.set(t,n,s,hn(t)?t:o);return t===Ht(o)&&(c?di(s,i)&&fa(t,"set",n,s):fa(t,"add",n,s)),d}deleteProperty(t,n){const s=Kt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&s&&fa(t,"delete",n,void 0),o}has(t,n){const s=Reflect.has(t,n);return(!Is(n)||!Zm.has(n))&&Qn(t,"has",n),s}ownKeys(t){return Qn(t,"iterate",ut(t)?"length":Yi),Reflect.ownKeys(t)}}class uk extends Km{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const dk=new Ym,hk=new uk,fk=new Ym(!0);const Lh=e=>e,Dc=e=>Reflect.getPrototypeOf(e);function pk(e,t,n){return function(...s){const o=this.__v_raw,i=Ht(o),l=Zl(i),c=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=o[e](...s),f=n?Lh:t?Ql:Ss;return!t&&Qn(i,"iterate",d?Ch:Yi),{next(){const{value:v,done:g}=h.next();return g?{value:v,done:g}:{value:c?[f(v[0]),f(v[1])]:f(v),done:g}},[Symbol.iterator](){return this}}}}function Rc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function vk(e,t){const n={get(o){const i=this.__v_raw,l=Ht(i),c=Ht(o);e||(di(o,c)&&Qn(l,"get",o),Qn(l,"get",c));const{has:d}=Dc(l),h=t?Lh:e?Ql:Ss;if(d.call(l,o))return h(i.get(o));if(d.call(l,c))return h(i.get(c));i!==l&&i.get(o)},get size(){const o=this.__v_raw;return!e&&Qn(Ht(o),"iterate",Yi),o.size},has(o){const i=this.__v_raw,l=Ht(i),c=Ht(o);return e||(di(o,c)&&Qn(l,"has",o),Qn(l,"has",c)),o===c?i.has(o):i.has(o)||i.has(c)},forEach(o,i){const l=this,c=l.__v_raw,d=Ht(c),h=t?Lh:e?Ql:Ss;return!e&&Qn(d,"iterate",Yi),c.forEach((f,v)=>o.call(i,h(f),h(v),l))}};return Rn(n,e?{add:Rc("add"),set:Rc("set"),delete:Rc("delete"),clear:Rc("clear")}:{add(o){!t&&!Uo(o)&&!Ia(o)&&(o=Ht(o));const i=Ht(this);return Dc(i).has.call(i,o)||(i.add(o),fa(i,"add",o,o)),this},set(o,i){!t&&!Uo(i)&&!Ia(i)&&(i=Ht(i));const l=Ht(this),{has:c,get:d}=Dc(l);let h=c.call(l,o);h||(o=Ht(o),h=c.call(l,o));const f=d.call(l,o);return l.set(o,i),h?di(i,f)&&fa(l,"set",o,i):fa(l,"add",o,i),this},delete(o){const i=Ht(this),{has:l,get:c}=Dc(i);let d=l.call(i,o);d||(o=Ht(o),d=l.call(i,o)),c&&c.call(i,o);const h=i.delete(o);return d&&fa(i,"delete",o,void 0),h},clear(){const o=Ht(this),i=o.size!==0,l=o.clear();return i&&fa(o,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=pk(o,e,t)}),n}function mf(e,t){const n=vk(e,t);return(s,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?s:Reflect.get(Kt(n,o)&&o in s?n:s,o,i)}const mk={get:mf(!1,!1)},gk={get:mf(!1,!0)},yk={get:mf(!0,!1)};const Jm=new WeakMap,Xm=new WeakMap,Qm=new WeakMap,kk=new WeakMap;function bk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wk(e){return e.__v_skip||!Object.isExtensible(e)?0:bk(G1(e))}function ol(e){return Ia(e)?e:gf(e,!1,dk,mk,Jm)}function eg(e){return gf(e,!1,fk,gk,Xm)}function Ih(e){return gf(e,!0,hk,yk,Qm)}function gf(e,t,n,s,o){if(!Qt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=wk(e);if(i===0)return e;const l=o.get(e);if(l)return l;const c=new Proxy(e,i===2?s:n);return o.set(e,c),c}function wa(e){return Ia(e)?wa(e.__v_raw):!!(e&&e.__v_isReactive)}function Ia(e){return!!(e&&e.__v_isReadonly)}function Uo(e){return!!(e&&e.__v_isShallow)}function Hu(e){return e?!!e.__v_raw:!1}function Ht(e){const t=e&&e.__v_raw;return t?Ht(t):e}function yf(e){return!Kt(e,"__v_skip")&&Object.isExtensible(e)&&Pm(e,"__v_skip",!0),e}const Ss=e=>Qt(e)?ol(e):e,Ql=e=>Qt(e)?Ih(e):e;function hn(e){return e?e.__v_isRef===!0:!1}function D(e){return tg(e,!1)}function _k(e){return tg(e,!0)}function tg(e,t){return hn(e)?e:new Ck(e,t)}class Ck{constructor(t,n){this.dep=new vf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Ht(t),this._value=n?t:Ss(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||Uo(t)||Ia(t);t=s?t:Ht(t),di(t,n)&&(this._rawValue=t,this._value=s?t:Ss(t),this.dep.trigger())}}function N(e){return hn(e)?e.value:e}function cu(e){return _t(e)?e():N(e)}const Lk={get:(e,t,n)=>t==="__v_raw"?e:N(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const o=e[t];return hn(o)&&!hn(n)?(o.value=n,!0):Reflect.set(e,t,n,s)}};function ng(e){return wa(e)?e:new Proxy(e,Lk)}function Ik(e){const t=ut(e)?new Array(e.length):{};for(const n in e)t[n]=xk(e,n);return t}class Sk{constructor(t,n,s){this._object=t,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Ht(t);let o=!0,i=t;if(!ut(t)||!Ou(String(n)))do o=!Hu(i)||Uo(i);while(o&&(i=i.__v_raw));this._shallow=o}get value(){let t=this._object[this._key];return this._shallow&&(t=N(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&hn(this._raw[this._key])){const n=this._object[this._key];if(hn(n)){n.value=t;return}}this._object[this._key]=t}get dep(){return ak(this._raw,this._key)}}function xk(e,t,n){return new Sk(e,t,n)}class $k{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new vf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Jr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&on!==this)return Hm(this,!0),!0}get value(){const t=this.dep.track();return qm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Tk(e,t,n=!1){let s,o;return _t(e)?s=e:(s=e.get,o=e.set),new $k(s,o,n)}const Oc={},uu=new WeakMap;let Vi;function Mk(e,t=!1,n=Vi){if(n){let s=uu.get(n);s||uu.set(n,s=[]),s.push(e)}}function Ak(e,t,n=nn){const{immediate:s,deep:o,once:i,scheduler:l,augmentJob:c,call:d}=n,h=I=>o?I:Uo(I)||o===!1||o===0?pa(I,1):pa(I);let f,v,g,k,b=!1,x=!1;if(hn(e)?(v=()=>e.value,b=Uo(e)):wa(e)?(v=()=>h(e),b=!0):ut(e)?(x=!0,b=e.some(I=>wa(I)||Uo(I)),v=()=>e.map(I=>{if(hn(I))return I.value;if(wa(I))return h(I);if(_t(I))return d?d(I,2):I()})):_t(e)?t?v=d?()=>d(e,2):e:v=()=>{if(g){Ca();try{g()}finally{La()}}const I=Vi;Vi=f;try{return d?d(e,3,[k]):e(k)}finally{Vi=I}}:v=_s,t&&o){const I=v,$=o===!0?1/0:o;v=()=>pa(I(),$)}const A=Fm(),T=()=>{f.stop(),A&&A.active&&uf(A.effects,f)};if(i&&t){const I=t;t=(...$)=>{I(...$),T()}}let w=x?new Array(e.length).fill(Oc):Oc;const C=I=>{if(!(!(f.flags&1)||!f.dirty&&!I))if(t){const $=f.run();if(o||b||(x?$.some((R,M)=>di(R,w[M])):di($,w))){g&&g();const R=Vi;Vi=f;try{const M=[$,w===Oc?void 0:x&&w[0]===Oc?[]:w,k];w=$,d?d(t,3,M):t(...M)}finally{Vi=R}}}else f.run()};return c&&c(C),f=new Um(v),f.scheduler=l?()=>l(C,!1):C,k=I=>Mk(I,!1,f),g=f.onStop=()=>{const I=uu.get(f);if(I){if(d)d(I,4);else for(const $ of I)$();uu.delete(f)}},t?s?C(!0):w=f.run():l?l(C.bind(null,!0),!0):f.run(),T.pause=f.pause.bind(f),T.resume=f.resume.bind(f),T.stop=T,T}function pa(e,t=1/0,n){if(t<=0||!Qt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,hn(e))pa(e.value,t,n);else if(ut(e))for(let s=0;s<e.length;s++)pa(e[s],t,n);else if(ar(e)||Zl(e))e.forEach(s=>{pa(s,t,n)});else if(Em(e)){for(const s in e)pa(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&pa(e[s],t,n)}return e}function dc(e,t,n,s){try{return s?e(...s):e()}catch(o){Vu(o,t,n)}}function xs(e,t,n,s){if(_t(e)){const o=dc(e,t,n,s);return o&&Mm(o)&&o.catch(i=>{Vu(i,t,n)}),o}if(ut(e)){const o=[];for(let i=0;i<e.length;i++)o.push(xs(e[i],t,n,s));return o}}function Vu(e,t,n,s=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||nn;if(t){let c=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${n}`;for(;c;){const f=c.ec;if(f){for(let v=0;v<f.length;v++)if(f[v](e,d,h)===!1)return}c=c.parent}if(i){Ca(),dc(i,null,10,[e,d,h]),La();return}}Ek(e,n,o,s,l)}function Ek(e,t,n,s=!0,o=!1){if(o)throw e;console.error(e)}const mo=[];let Vs=-1;const Kl=[];let ti=null,Ul=0;const og=Promise.resolve();let du=null;function cn(e){const t=du||og;return e?t.then(this?e.bind(this):e):t}function Pk(e){let t=Vs+1,n=mo.length;for(;t<n;){const s=t+n>>>1,o=mo[s],i=Qr(o);i<e||i===e&&o.flags&2?t=s+1:n=s}return t}function kf(e){if(!(e.flags&1)){const t=Qr(e),n=mo[mo.length-1];!n||!(e.flags&2)&&t>=Qr(n)?mo.push(e):mo.splice(Pk(t),0,e),e.flags|=1,sg()}}function sg(){du||(du=og.then(lg))}function ag(e){ut(e)?Kl.push(...e):ti&&e.id===-1?ti.splice(Ul+1,0,e):e.flags&1||(Kl.push(e),e.flags|=1),sg()}function np(e,t,n=Vs+1){for(;n<mo.length;n++){const s=mo[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;mo.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function ig(e){if(Kl.length){const t=[...new Set(Kl)].sort((n,s)=>Qr(n)-Qr(s));if(Kl.length=0,ti){ti.push(...t);return}for(ti=t,Ul=0;Ul<ti.length;Ul++){const n=ti[Ul];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ti=null,Ul=0}}const Qr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function lg(e){try{for(Vs=0;Vs<mo.length;Vs++){const t=mo[Vs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),dc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Vs<mo.length;Vs++){const t=mo[Vs];t&&(t.flags&=-2)}Vs=-1,mo.length=0,ig(),du=null,(mo.length||Kl.length)&&lg()}}let Hn=null,rg=null;function hu(e){const t=Hn;return Hn=e,rg=e&&e.type.__scopeId||null,t}function Ve(e,t=Hn,n){if(!t||e._n)return e;const s=(...o)=>{s._d&&vu(-1);const i=hu(t);let l;try{l=e(...o)}finally{hu(i),s._d&&vu(1)}return l};return s._n=!0,s._c=!0,s._d=!0,s}function We(e,t){if(Hn===null)return e;const n=Ku(Hn),s=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,l,c,d=nn]=t[o];i&&(_t(i)&&(i={mounted:i,updated:i}),i.deep&&pa(l),s.push({dir:i,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d}))}return e}function Oi(e,t,n,s){const o=e.dirs,i=t&&t.dirs;for(let l=0;l<o.length;l++){const c=o[l];i&&(c.oldValue=i[l].value);let d=c.dir[s];d&&(Ca(),xs(d,n,8,[e.el,c,e,t]),La())}}function Br(e,t){if(to){let n=to.provides;const s=to.parent&&to.parent.provides;s===n&&(n=to.provides=Object.create(s)),n[e]=t}}function $o(e,t,n=!1){const s=Zu();if(s||Ji){let o=Ji?Ji._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&_t(t)?t.call(s&&s.proxy):t}}function Dk(){return!!(Zu()||Ji)}const Rk=Symbol.for("v-scx"),Ok=()=>$o(Rk);function Bk(e,t){return bf(e,null,t)}function Ye(e,t,n){return bf(e,t,n)}function bf(e,t,n=nn){const{immediate:s,deep:o,flush:i,once:l}=n,c=Rn({},n),d=t&&s||!t&&i!=="post";let h;if(sc){if(i==="sync"){const k=Ok();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=_s,k.resume=_s,k.pause=_s,k}}const f=to;c.call=(k,b,x)=>xs(k,f,b,x);let v=!1;i==="post"?c.scheduler=k=>{po(k,f&&f.suspense)}:i!=="sync"&&(v=!0,c.scheduler=(k,b)=>{b?k():kf(k)}),c.augmentJob=k=>{t&&(k.flags|=4),v&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const g=Ak(e,t,c);return sc&&(h?h.push(g):d&&g()),g}function Nk(e,t,n){const s=this.proxy,o=fn(e)?e.includes(".")?cg(s,e):()=>s[e]:e.bind(s,s);let i;_t(t)?i=t:(i=t.handler,n=t);const l=hc(this),c=bf(o,i.bind(s),n);return l(),c}function cg(e,t){const n=t.split(".");return()=>{let s=e;for(let o=0;o<n.length&&s;o++)s=s[n[o]];return s}}const ug=Symbol("_vte"),dg=e=>e.__isTeleport,Nr=e=>e&&(e.disabled||e.disabled===""),op=e=>e&&(e.defer||e.defer===""),sp=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ap=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Sh=(e,t)=>{const n=e&&e.to;return fn(n)?t?t(n):null:n},hg={name:"Teleport",__isTeleport:!0,process(e,t,n,s,o,i,l,c,d,h){const{mc:f,pc:v,pbc:g,o:{insert:k,querySelector:b,createText:x,createComment:A}}=h,T=Nr(t.props);let{shapeFlag:w,children:C,dynamicChildren:I}=t;if(e==null){const $=t.el=x(""),R=t.anchor=x("");k($,n,s),k(R,n,s);const M=(E,U)=>{w&16&&f(C,E,U,o,i,l,c,d)},O=()=>{const E=t.target=Sh(t.props,b),U=fg(E,t,x,k);E&&(l!=="svg"&&sp(E)?l="svg":l!=="mathml"&&ap(E)&&(l="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(E),T||(M(E,U),Kc(t,!1)))};T&&(M(n,R),Kc(t,!0)),op(t.props)?(t.el.__isMounted=!1,po(()=>{O(),delete t.el.__isMounted},i)):O()}else{if(op(t.props)&&e.el.__isMounted===!1){po(()=>{hg.process(e,t,n,s,o,i,l,c,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const $=t.anchor=e.anchor,R=t.target=e.target,M=t.targetAnchor=e.targetAnchor,O=Nr(e.props),E=O?n:R,U=O?$:M;if(l==="svg"||sp(R)?l="svg":(l==="mathml"||ap(R))&&(l="mathml"),I?(g(e.dynamicChildren,I,E,o,i,l,c),If(e,t,!0)):d||v(e,t,E,U,o,i,l,c,!1),T)O?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Bc(t,n,$,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=Sh(t.props,b);F&&Bc(t,F,null,h,0)}else O&&Bc(t,R,M,h,1);Kc(t,T)}},remove(e,t,n,{um:s,o:{remove:o}},i){const{shapeFlag:l,children:c,anchor:d,targetStart:h,targetAnchor:f,target:v,props:g}=e;if(v&&(o(h),o(f)),i&&o(d),l&16){const k=i||!Nr(g);for(let b=0;b<c.length;b++){const x=c[b];s(x,t,n,k,!!x.dynamicChildren)}}},move:Bc,hydrate:Fk};function Bc(e,t,n,{o:{insert:s},m:o},i=2){i===0&&s(e.targetAnchor,t,n);const{el:l,anchor:c,shapeFlag:d,children:h,props:f}=e,v=i===2;if(v&&s(l,t,n),(!v||Nr(f))&&d&16)for(let g=0;g<h.length;g++)o(h[g],t,n,2);v&&s(c,t,n)}function Fk(e,t,n,s,o,i,{o:{nextSibling:l,parentNode:c,querySelector:d,insert:h,createText:f}},v){function g(x,A,T,w){A.anchor=v(l(x),A,c(x),n,s,o,i),A.targetStart=T,A.targetAnchor=w}const k=t.target=Sh(t.props,d),b=Nr(t.props);if(k){const x=k._lpa||k.firstChild;if(t.shapeFlag&16)if(b)g(e,t,x,x&&l(x));else{t.anchor=l(e);let A=x;for(;A;){if(A&&A.nodeType===8){if(A.data==="teleport start anchor")t.targetStart=A;else if(A.data==="teleport anchor"){t.targetAnchor=A,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}A=l(A)}t.targetAnchor||fg(k,t,f,h),v(x&&l(x),t,k,n,s,o,i)}Kc(t,b)}else b&&t.shapeFlag&16&&g(e,t,e,l(e));return t.anchor&&l(t.anchor)}const ec=hg;function Kc(e,t){const n=e.ctx;if(n&&n.ut){let s,o;for(t?(s=e.el,o=e.anchor):(s=e.targetStart,o=e.targetAnchor);s&&s!==o;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function fg(e,t,n,s){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[ug]=i,e&&(s(o,e),s(i,e)),i}const ha=Symbol("_leaveCb"),Nc=Symbol("_enterCb");function Uk(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return un(()=>{e.isMounted=!0}),Cg(()=>{e.isUnmounting=!0}),e}const Yo=[Function,Array],pg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Yo,onEnter:Yo,onAfterEnter:Yo,onEnterCancelled:Yo,onBeforeLeave:Yo,onLeave:Yo,onAfterLeave:Yo,onLeaveCancelled:Yo,onBeforeAppear:Yo,onAppear:Yo,onAfterAppear:Yo,onAppearCancelled:Yo},vg=e=>{const t=e.subTree;return t.component?vg(t.component):t},zk={name:"BaseTransition",props:pg,setup(e,{slots:t}){const n=Zu(),s=Uk();return()=>{const o=t.default&&yg(t.default(),!0);if(!o||!o.length)return;const i=mg(o),l=Ht(e),{mode:c}=l;if(s.isLeaving)return Id(i);const d=ip(i);if(!d)return Id(i);let h=xh(d,l,s,n,v=>h=v);d.type!==eo&&tc(d,h);let f=n.subTree&&ip(n.subTree);if(f&&f.type!==eo&&!qi(f,d)&&vg(n).type!==eo){let v=xh(f,l,s,n);if(tc(f,v),c==="out-in"&&d.type!==eo)return s.isLeaving=!0,v.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete v.afterLeave,f=void 0},Id(i);c==="in-out"&&d.type!==eo?v.delayLeave=(g,k,b)=>{const x=gg(s,f);x[String(f.key)]=f,g[ha]=()=>{k(),g[ha]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{b(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function mg(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==eo){t=n;break}}return t}const Hk=zk;function gg(e,t){const{leavingVNodes:n}=e;let s=n.get(t.type);return s||(s=Object.create(null),n.set(t.type,s)),s}function xh(e,t,n,s,o){const{appear:i,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:v,onBeforeLeave:g,onLeave:k,onAfterLeave:b,onLeaveCancelled:x,onBeforeAppear:A,onAppear:T,onAfterAppear:w,onAppearCancelled:C}=t,I=String(e.key),$=gg(n,e),R=(E,U)=>{E&&xs(E,s,9,U)},M=(E,U)=>{const F=U[1];R(E,U),ut(E)?E.every(j=>j.length<=1)&&F():E.length<=1&&F()},O={mode:l,persisted:c,beforeEnter(E){let U=d;if(!n.isMounted)if(i)U=A||d;else return;E[ha]&&E[ha](!0);const F=$[I];F&&qi(e,F)&&F.el[ha]&&F.el[ha](),R(U,[E])},enter(E){let U=h,F=f,j=v;if(!n.isMounted)if(i)U=T||h,F=w||f,j=C||v;else return;let Z=!1;const Q=E[Nc]=re=>{Z||(Z=!0,re?R(j,[E]):R(F,[E]),O.delayedLeave&&O.delayedLeave(),E[Nc]=void 0)};U?M(U,[E,Q]):Q()},leave(E,U){const F=String(e.key);if(E[Nc]&&E[Nc](!0),n.isUnmounting)return U();R(g,[E]);let j=!1;const Z=E[ha]=Q=>{j||(j=!0,U(),Q?R(x,[E]):R(b,[E]),E[ha]=void 0,$[F]===e&&delete $[F])};$[F]=e,k?M(k,[E,Z]):Z()},clone(E){const U=xh(E,t,n,s,o);return o&&o(U),U}};return O}function Id(e){if(Gu(e))return e=pi(e),e.children=null,e}function ip(e){if(!Gu(e))return dg(e.type)&&e.children?mg(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&_t(n.default))return n.default()}}function tc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,tc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function yg(e,t=!1,n){let s=[],o=0;for(let i=0;i<e.length;i++){let l=e[i];const c=n==null?l.key:String(n)+String(l.key!=null?l.key:i);l.type===Ie?(l.patchFlag&128&&o++,s=s.concat(yg(l.children,t,c))):(t||l.type!==eo)&&s.push(c!=null?pi(l,{key:c}):l)}if(o>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function kg(e,t){return _t(e)?Rn({name:e.name},t,{setup:e}):e}function bg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const fu=new WeakMap;function Fr(e,t,n,s,o=!1){if(ut(e)){e.forEach((b,x)=>Fr(b,t&&(ut(t)?t[x]:t),n,s,o));return}if(Yl(s)&&!o){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Fr(e,t,n,s.component.subTree);return}const i=s.shapeFlag&4?Ku(s.component):s.el,l=o?null:i,{i:c,r:d}=e,h=t&&t.r,f=c.refs===nn?c.refs={}:c.refs,v=c.setupState,g=Ht(v),k=v===nn?Tm:b=>Kt(g,b);if(h!=null&&h!==d){if(lp(t),fn(h))f[h]=null,k(h)&&(v[h]=null);else if(hn(h)){h.value=null;const b=t;b.k&&(f[b.k]=null)}}if(_t(d))dc(d,c,12,[l,f]);else{const b=fn(d),x=hn(d);if(b||x){const A=()=>{if(e.f){const T=b?k(d)?v[d]:f[d]:d.value;if(o)ut(T)&&uf(T,i);else if(ut(T))T.includes(i)||T.push(i);else if(b)f[d]=[i],k(d)&&(v[d]=f[d]);else{const w=[i];d.value=w,e.k&&(f[e.k]=w)}}else b?(f[d]=l,k(d)&&(v[d]=l)):x&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const T=()=>{A(),fu.delete(e)};T.id=-1,fu.set(e,T),po(T,n)}else lp(e),A()}}}function lp(e){const t=fu.get(e);t&&(t.flags|=8,fu.delete(e))}Uu().requestIdleCallback;Uu().cancelIdleCallback;const Yl=e=>!!e.type.__asyncLoader,Gu=e=>e.type.__isKeepAlive;function Vk(e,t){wg(e,"a",t)}function Gk(e,t){wg(e,"da",t)}function wg(e,t,n=to){const s=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(qu(t,s,n),n){let o=n.parent;for(;o&&o.parent;)Gu(o.parent.vnode)&&qk(s,t,n,o),o=o.parent}}function qk(e,t,n,s){const o=qu(t,e,s,!0);Sn(()=>{uf(s[t],o)},n)}function qu(e,t,n=to,s=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Ca();const c=hc(n),d=xs(t,n,e,l);return c(),La(),d});return s?o.unshift(i):o.push(i),i}}const xa=e=>(t,n=to)=>{(!sc||e==="sp")&&qu(e,(...s)=>t(...s),n)},jk=xa("bm"),un=xa("m"),_g=xa("bu"),Wk=xa("u"),Cg=xa("bum"),Sn=xa("um"),Zk=xa("sp"),Kk=xa("rtg"),Yk=xa("rtc");function Jk(e,t=to){qu("ec",e,t)}const Lg="components";function wf(e,t){return Sg(Lg,e,!0,t)||e}const Ig=Symbol.for("v-ndc");function Xk(e){return fn(e)?Sg(Lg,e,!1)||e:e||Ig}function Sg(e,t,n=!0,s=!1){const o=Hn||to;if(o){const i=o.type;{const c=R0(i,!1);if(c&&(c===t||c===ts(t)||c===Nu(ts(t))))return i}const l=rp(o[e]||i[e],t)||rp(o.appContext[e],t);return!l&&s?i:l}}function rp(e,t){return e&&(e[t]||e[ts(t)]||e[Nu(ts(t))])}function je(e,t,n,s){let o;const i=n,l=ut(e);if(l||fn(e)){const c=l&&wa(e);let d=!1,h=!1;c&&(d=!Uo(e),h=Ia(e),e=zu(e)),o=new Array(e.length);for(let f=0,v=e.length;f<v;f++)o[f]=t(d?h?Ql(Ss(e[f])):Ss(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let c=0;c<e;c++)o[c]=t(c+1,c,void 0,i)}else if(Qt(e))if(e[Symbol.iterator])o=Array.from(e,(c,d)=>t(c,d,void 0,i));else{const c=Object.keys(e);o=new Array(c.length);for(let d=0,h=c.length;d<h;d++){const f=c[d];o[d]=t(e[f],f,d,i)}}else o=[];return o}function _f(e,t){for(let n=0;n<t.length;n++){const s=t[n];if(ut(s))for(let o=0;o<s.length;o++)e[s[o].name]=s[o].fn;else s&&(e[s.name]=s.key?(...o)=>{const i=s.fn(...o);return i&&(i.key=s.key),i}:s.fn)}return e}function go(e,t,n={},s,o){if(Hn.ce||Hn.parent&&Yl(Hn.parent)&&Hn.parent.ce){const h=Object.keys(n).length>0;return t!=="default"&&(n.name=t),p(),Ge(Ie,null,[Pe("slot",n,s&&s())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),p();const l=i&&xg(i(n)),c=n.key||l&&l.key,d=Ge(Ie,{key:(c&&!Is(c)?c:`_${t}`)+(!l&&s?"_fb":"")},l||(s?s():[]),l&&e._===1?64:-2);return!o&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function xg(e){return e.some(t=>oc(t)?!(t.type===eo||t.type===Ie&&!xg(t.children)):!0)?e:null}const $h=e=>e?jg(e)?Ku(e):$h(e.parent):null,Ur=Rn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>$h(e.parent),$root:e=>$h(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Tg(e),$forceUpdate:e=>e.f||(e.f=()=>{kf(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>Nk.bind(e)}),Sd=(e,t)=>e!==nn&&!e.__isScriptSetup&&Kt(e,t),Qk={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:o,props:i,accessCache:l,type:c,appContext:d}=e;if(t[0]!=="$"){const g=l[t];if(g!==void 0)switch(g){case 1:return s[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(Sd(s,t))return l[t]=1,s[t];if(o!==nn&&Kt(o,t))return l[t]=2,o[t];if(Kt(i,t))return l[t]=3,i[t];if(n!==nn&&Kt(n,t))return l[t]=4,n[t];Th&&(l[t]=0)}}const h=Ur[t];let f,v;if(h)return t==="$attrs"&&Qn(e.attrs,"get",""),h(e);if((f=c.__cssModules)&&(f=f[t]))return f;if(n!==nn&&Kt(n,t))return l[t]=4,n[t];if(v=d.config.globalProperties,Kt(v,t))return v[t]},set({_:e},t,n){const{data:s,setupState:o,ctx:i}=e;return Sd(o,t)?(o[t]=n,!0):s!==nn&&Kt(s,t)?(s[t]=n,!0):Kt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:o,props:i,type:l}},c){let d;return!!(n[c]||e!==nn&&c[0]!=="$"&&Kt(e,c)||Sd(t,c)||Kt(i,c)||Kt(s,c)||Kt(Ur,c)||Kt(o.config.globalProperties,c)||(d=l.__cssModules)&&d[c])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Kt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function cp(e){return ut(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Th=!0;function e0(e){const t=Tg(e),n=e.proxy,s=e.ctx;Th=!1,t.beforeCreate&&up(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:l,watch:c,provide:d,inject:h,created:f,beforeMount:v,mounted:g,beforeUpdate:k,updated:b,activated:x,deactivated:A,beforeDestroy:T,beforeUnmount:w,destroyed:C,unmounted:I,render:$,renderTracked:R,renderTriggered:M,errorCaptured:O,serverPrefetch:E,expose:U,inheritAttrs:F,components:j,directives:Z,filters:Q}=t;if(h&&t0(h,s,null),l)for(const ae in l){const q=l[ae];_t(q)&&(s[ae]=q.bind(n))}if(o){const ae=o.call(n,n);Qt(ae)&&(e.data=ol(ae))}if(Th=!0,i)for(const ae in i){const q=i[ae],J=_t(q)?q.bind(n,n):_t(q.get)?q.get.bind(n,n):_s,ee=!_t(q)&&_t(q.set)?q.set.bind(n):_s,ue=H({get:J,set:ee});Object.defineProperty(s,ae,{enumerable:!0,configurable:!0,get:()=>ue.value,set:_e=>ue.value=_e})}if(c)for(const ae in c)$g(c[ae],s,n,ae);if(d){const ae=_t(d)?d.call(n):d;Reflect.ownKeys(ae).forEach(q=>{Br(q,ae[q])})}f&&up(f,e,"c");function K(ae,q){ut(q)?q.forEach(J=>ae(J.bind(n))):q&&ae(q.bind(n))}if(K(jk,v),K(un,g),K(_g,k),K(Wk,b),K(Vk,x),K(Gk,A),K(Jk,O),K(Yk,R),K(Kk,M),K(Cg,w),K(Sn,I),K(Zk,E),ut(U))if(U.length){const ae=e.exposed||(e.exposed={});U.forEach(q=>{Object.defineProperty(ae,q,{get:()=>n[q],set:J=>n[q]=J,enumerable:!0})})}else e.exposed||(e.exposed={});$&&e.render===_s&&(e.render=$),F!=null&&(e.inheritAttrs=F),j&&(e.components=j),Z&&(e.directives=Z),E&&bg(e)}function t0(e,t,n=_s){ut(e)&&(e=Mh(e));for(const s in e){const o=e[s];let i;Qt(o)?"default"in o?i=$o(o.from||s,o.default,!0):i=$o(o.from||s):i=$o(o),hn(i)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[s]=i}}function up(e,t,n){xs(ut(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function $g(e,t,n,s){let o=s.includes(".")?cg(n,s):()=>n[s];if(fn(e)){const i=t[e];_t(i)&&Ye(o,i)}else if(_t(e))Ye(o,e.bind(n));else if(Qt(e))if(ut(e))e.forEach(i=>$g(i,t,n,s));else{const i=_t(e.handler)?e.handler.bind(n):t[e.handler];_t(i)&&Ye(o,i,e)}}function Tg(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,c=i.get(t);let d;return c?d=c:!o.length&&!n&&!s?d=t:(d={},o.length&&o.forEach(h=>pu(d,h,l,!0)),pu(d,t,l)),Qt(t)&&i.set(t,d),d}function pu(e,t,n,s=!1){const{mixins:o,extends:i}=t;i&&pu(e,i,n,!0),o&&o.forEach(l=>pu(e,l,n,!0));for(const l in t)if(!(s&&l==="expose")){const c=n0[l]||n&&n[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const n0={data:dp,props:hp,emits:hp,methods:xr,computed:xr,beforeCreate:ho,created:ho,beforeMount:ho,mounted:ho,beforeUpdate:ho,updated:ho,beforeDestroy:ho,beforeUnmount:ho,destroyed:ho,unmounted:ho,activated:ho,deactivated:ho,errorCaptured:ho,serverPrefetch:ho,components:xr,directives:xr,watch:s0,provide:dp,inject:o0};function dp(e,t){return t?e?function(){return Rn(_t(e)?e.call(this,this):e,_t(t)?t.call(this,this):t)}:t:e}function o0(e,t){return xr(Mh(e),Mh(t))}function Mh(e){if(ut(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ho(e,t){return e?[...new Set([].concat(e,t))]:t}function xr(e,t){return e?Rn(Object.create(null),e,t):t}function hp(e,t){return e?ut(e)&&ut(t)?[...new Set([...e,...t])]:Rn(Object.create(null),cp(e),cp(t??{})):t}function s0(e,t){if(!e)return t;if(!t)return e;const n=Rn(Object.create(null),e);for(const s in t)n[s]=ho(e[s],t[s]);return n}function Mg(){return{app:null,config:{isNativeTag:Tm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let a0=0;function i0(e,t){return function(s,o=null){_t(s)||(s=Rn({},s)),o!=null&&!Qt(o)&&(o=null);const i=Mg(),l=new WeakSet,c=[];let d=!1;const h=i.app={_uid:a0++,_component:s,_props:o,_container:null,_context:i,_instance:null,version:B0,get config(){return i.config},set config(f){},use(f,...v){return l.has(f)||(f&&_t(f.install)?(l.add(f),f.install(h,...v)):_t(f)&&(l.add(f),f(h,...v))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,v){return v?(i.components[f]=v,h):i.components[f]},directive(f,v){return v?(i.directives[f]=v,h):i.directives[f]},mount(f,v,g){if(!d){const k=h._ceVNode||Pe(s,o);return k.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),e(k,f,g),d=!0,h._container=f,f.__vue_app__=h,Ku(k.component)}},onUnmount(f){c.push(f)},unmount(){d&&(xs(c,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,v){return i.provides[f]=v,h},runWithContext(f){const v=Ji;Ji=h;try{return f()}finally{Ji=v}}};return h}}let Ji=null;const l0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ts(t)}Modifiers`]||e[`${yi(t)}Modifiers`];function r0(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||nn;let o=n;const i=t.startsWith("update:"),l=i&&l0(s,t.slice(7));l&&(l.trim&&(o=n.map(f=>fn(f)?f.trim():f)),l.number&&(o=n.map(Fu)));let c,d=s[c=bd(t)]||s[c=bd(ts(t))];!d&&i&&(d=s[c=bd(yi(t))]),d&&xs(d,e,6,o);const h=s[c+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,xs(h,e,6,o)}}const c0=new WeakMap;function Ag(e,t,n=!1){const s=n?c0:t.emitsCache,o=s.get(e);if(o!==void 0)return o;const i=e.emits;let l={},c=!1;if(!_t(e)){const d=h=>{const f=Ag(h,t,!0);f&&(c=!0,Rn(l,f))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!c?(Qt(e)&&s.set(e,null),null):(ut(i)?i.forEach(d=>l[d]=null):Rn(l,i),Qt(e)&&s.set(e,l),l)}function ju(e,t){return!e||!Ru(t)?!1:(t=t.slice(2).replace(/Once$/,""),Kt(e,t[0].toLowerCase()+t.slice(1))||Kt(e,yi(t))||Kt(e,t))}function fp(e){const{type:t,vnode:n,proxy:s,withProxy:o,propsOptions:[i],slots:l,attrs:c,emit:d,render:h,renderCache:f,props:v,data:g,setupState:k,ctx:b,inheritAttrs:x}=e,A=hu(e);let T,w;try{if(n.shapeFlag&4){const I=o||s,$=I;T=qs(h.call($,I,f,v,k,g,b)),w=c}else{const I=t;T=qs(I.length>1?I(v,{attrs:c,slots:l,emit:d}):I(v,null)),w=t.props?c:u0(c)}}catch(I){Hr.length=0,Vu(I,e,1),T=Pe(eo)}let C=T;if(w&&x!==!1){const I=Object.keys(w),{shapeFlag:$}=C;I.length&&$&7&&(i&&I.some(cf)&&(w=d0(w,i)),C=pi(C,w,!1,!0))}return n.dirs&&(C=pi(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(n.dirs):n.dirs),n.transition&&tc(C,n.transition),T=C,hu(A),T}const u0=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ru(n))&&((t||(t={}))[n]=e[n]);return t},d0=(e,t)=>{const n={};for(const s in e)(!cf(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function h0(e,t,n){const{props:s,children:o,component:i}=e,{props:l,children:c,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return s?pp(s,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let v=0;v<f.length;v++){const g=f[v];if(l[g]!==s[g]&&!ju(h,g))return!0}}}else return(o||c)&&(!c||!c.$stable)?!0:s===l?!1:s?l?pp(s,l,h):!0:!!l;return!1}function pp(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let o=0;o<s.length;o++){const i=s[o];if(t[i]!==e[i]&&!ju(n,i))return!0}return!1}function f0({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const Eg={},Pg=()=>Object.create(Eg),Dg=e=>Object.getPrototypeOf(e)===Eg;function p0(e,t,n,s=!1){const o={},i=Pg();e.propsDefaults=Object.create(null),Rg(e,t,o,i);for(const l in e.propsOptions[0])l in o||(o[l]=void 0);n?e.props=s?o:eg(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function v0(e,t,n,s){const{props:o,attrs:i,vnode:{patchFlag:l}}=e,c=Ht(o),[d]=e.propsOptions;let h=!1;if((s||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let v=0;v<f.length;v++){let g=f[v];if(ju(e.emitsOptions,g))continue;const k=t[g];if(d)if(Kt(i,g))k!==i[g]&&(i[g]=k,h=!0);else{const b=ts(g);o[b]=Ah(d,c,b,k,e,!1)}else k!==i[g]&&(i[g]=k,h=!0)}}}else{Rg(e,t,o,i)&&(h=!0);let f;for(const v in c)(!t||!Kt(t,v)&&((f=yi(v))===v||!Kt(t,f)))&&(d?n&&(n[v]!==void 0||n[f]!==void 0)&&(o[v]=Ah(d,c,v,void 0,e,!0)):delete o[v]);if(i!==c)for(const v in i)(!t||!Kt(t,v))&&(delete i[v],h=!0)}h&&fa(e.attrs,"set","")}function Rg(e,t,n,s){const[o,i]=e.propsOptions;let l=!1,c;if(t)for(let d in t){if(Dr(d))continue;const h=t[d];let f;o&&Kt(o,f=ts(d))?!i||!i.includes(f)?n[f]=h:(c||(c={}))[f]=h:ju(e.emitsOptions,d)||(!(d in s)||h!==s[d])&&(s[d]=h,l=!0)}if(i){const d=Ht(n),h=c||nn;for(let f=0;f<i.length;f++){const v=i[f];n[v]=Ah(o,d,v,h[v],e,!Kt(h,v))}}return l}function Ah(e,t,n,s,o,i){const l=e[n];if(l!=null){const c=Kt(l,"default");if(c&&s===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&_t(d)){const{propsDefaults:h}=o;if(n in h)s=h[n];else{const f=hc(o);s=h[n]=d.call(null,t),f()}}else s=d;o.ce&&o.ce._setProp(n,s)}l[0]&&(i&&!c?s=!1:l[1]&&(s===""||s===yi(n))&&(s=!0))}return s}const m0=new WeakMap;function Og(e,t,n=!1){const s=n?m0:t.propsCache,o=s.get(e);if(o)return o;const i=e.props,l={},c=[];let d=!1;if(!_t(e)){const f=v=>{d=!0;const[g,k]=Og(v,t,!0);Rn(l,g),k&&c.push(...k)};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Qt(e)&&s.set(e,Wl),Wl;if(ut(i))for(let f=0;f<i.length;f++){const v=ts(i[f]);vp(v)&&(l[v]=nn)}else if(i)for(const f in i){const v=ts(f);if(vp(v)){const g=i[f],k=l[v]=ut(g)||_t(g)?{type:g}:Rn({},g),b=k.type;let x=!1,A=!0;if(ut(b))for(let T=0;T<b.length;++T){const w=b[T],C=_t(w)&&w.name;if(C==="Boolean"){x=!0;break}else C==="String"&&(A=!1)}else x=_t(b)&&b.name==="Boolean";k[0]=x,k[1]=A,(x||Kt(k,"default"))&&c.push(v)}}const h=[l,c];return Qt(e)&&s.set(e,h),h}function vp(e){return e[0]!=="$"&&!Dr(e)}const Cf=e=>e==="_"||e==="_ctx"||e==="$stable",Lf=e=>ut(e)?e.map(qs):[qs(e)],g0=(e,t,n)=>{if(t._n)return t;const s=Ve((...o)=>Lf(t(...o)),n);return s._c=!1,s},Bg=(e,t,n)=>{const s=e._ctx;for(const o in e){if(Cf(o))continue;const i=e[o];if(_t(i))t[o]=g0(o,i,s);else if(i!=null){const l=Lf(i);t[o]=()=>l}}},Ng=(e,t)=>{const n=Lf(t);e.slots.default=()=>n},Fg=(e,t,n)=>{for(const s in t)(n||!Cf(s))&&(e[s]=t[s])},y0=(e,t,n)=>{const s=e.slots=Pg();if(e.vnode.shapeFlag&32){const o=t._;o?(Fg(s,t,n),n&&Pm(s,"_",o,!0)):Bg(t,s)}else t&&Ng(e,t)},k0=(e,t,n)=>{const{vnode:s,slots:o}=e;let i=!0,l=nn;if(s.shapeFlag&32){const c=t._;c?n&&c===1?i=!1:Fg(o,t,n):(i=!t.$stable,Bg(t,o)),l=t}else t&&(Ng(e,t),l={default:1});if(i)for(const c in o)!Cf(c)&&l[c]==null&&delete o[c]},po=L0;function b0(e){return w0(e)}function w0(e,t){const n=Uu();n.__VUE__=!0;const{insert:s,remove:o,patchProp:i,createElement:l,createText:c,createComment:d,setText:h,setElementText:f,parentNode:v,nextSibling:g,setScopeId:k=_s,insertStaticContent:b}=e,x=(G,X,te,Ce=null,Ne=null,Fe=null,Ee=void 0,oe=null,ge=!!X.dynamicChildren)=>{if(G===X)return;G&&!qi(G,X)&&(Ce=z(G),_e(G,Ne,Fe,!0),G=null),X.patchFlag===-2&&(ge=!1,X.dynamicChildren=null);const{type:Be,ref:Oe,shapeFlag:xe}=X;switch(Be){case Wu:A(G,X,te,Ce);break;case eo:T(G,X,te,Ce);break;case zr:G==null&&w(X,te,Ce,Ee);break;case Ie:j(G,X,te,Ce,Ne,Fe,Ee,oe,ge);break;default:xe&1?$(G,X,te,Ce,Ne,Fe,Ee,oe,ge):xe&6?Z(G,X,te,Ce,Ne,Fe,Ee,oe,ge):(xe&64||xe&128)&&Be.process(G,X,te,Ce,Ne,Fe,Ee,oe,ge,ie)}Oe!=null&&Ne?Fr(Oe,G&&G.ref,Fe,X||G,!X):Oe==null&&G&&G.ref!=null&&Fr(G.ref,null,Fe,G,!0)},A=(G,X,te,Ce)=>{if(G==null)s(X.el=c(X.children),te,Ce);else{const Ne=X.el=G.el;X.children!==G.children&&h(Ne,X.children)}},T=(G,X,te,Ce)=>{G==null?s(X.el=d(X.children||""),te,Ce):X.el=G.el},w=(G,X,te,Ce)=>{[G.el,G.anchor]=b(G.children,X,te,Ce,G.el,G.anchor)},C=({el:G,anchor:X},te,Ce)=>{let Ne;for(;G&&G!==X;)Ne=g(G),s(G,te,Ce),G=Ne;s(X,te,Ce)},I=({el:G,anchor:X})=>{let te;for(;G&&G!==X;)te=g(G),o(G),G=te;o(X)},$=(G,X,te,Ce,Ne,Fe,Ee,oe,ge)=>{if(X.type==="svg"?Ee="svg":X.type==="math"&&(Ee="mathml"),G==null)R(X,te,Ce,Ne,Fe,Ee,oe,ge);else{const Be=G.el&&G.el._isVueCE?G.el:null;try{Be&&Be._beginPatch(),E(G,X,Ne,Fe,Ee,oe,ge)}finally{Be&&Be._endPatch()}}},R=(G,X,te,Ce,Ne,Fe,Ee,oe)=>{let ge,Be;const{props:Oe,shapeFlag:xe,transition:me,dirs:Ze}=G;if(ge=G.el=l(G.type,Fe,Oe&&Oe.is,Oe),xe&8?f(ge,G.children):xe&16&&O(G.children,ge,null,Ce,Ne,xd(G,Fe),Ee,oe),Ze&&Oi(G,null,Ce,"created"),M(ge,G,G.scopeId,Ee,Ce),Oe){for(const fe in Oe)fe!=="value"&&!Dr(fe)&&i(ge,fe,null,Oe[fe],Fe,Ce);"value"in Oe&&i(ge,"value",null,Oe.value,Fe),(Be=Oe.onVnodeBeforeMount)&&Us(Be,Ce,G)}Ze&&Oi(G,null,Ce,"beforeMount");const qe=_0(Ne,me);qe&&me.beforeEnter(ge),s(ge,X,te),((Be=Oe&&Oe.onVnodeMounted)||qe||Ze)&&po(()=>{Be&&Us(Be,Ce,G),qe&&me.enter(ge),Ze&&Oi(G,null,Ce,"mounted")},Ne)},M=(G,X,te,Ce,Ne)=>{if(te&&k(G,te),Ce)for(let Fe=0;Fe<Ce.length;Fe++)k(G,Ce[Fe]);if(Ne){let Fe=Ne.subTree;if(X===Fe||Hg(Fe.type)&&(Fe.ssContent===X||Fe.ssFallback===X)){const Ee=Ne.vnode;M(G,Ee,Ee.scopeId,Ee.slotScopeIds,Ne.parent)}}},O=(G,X,te,Ce,Ne,Fe,Ee,oe,ge=0)=>{for(let Be=ge;Be<G.length;Be++){const Oe=G[Be]=oe?ni(G[Be]):qs(G[Be]);x(null,Oe,X,te,Ce,Ne,Fe,Ee,oe)}},E=(G,X,te,Ce,Ne,Fe,Ee)=>{const oe=X.el=G.el;let{patchFlag:ge,dynamicChildren:Be,dirs:Oe}=X;ge|=G.patchFlag&16;const xe=G.props||nn,me=X.props||nn;let Ze;if(te&&Bi(te,!1),(Ze=me.onVnodeBeforeUpdate)&&Us(Ze,te,X,G),Oe&&Oi(X,G,te,"beforeUpdate"),te&&Bi(te,!0),(xe.innerHTML&&me.innerHTML==null||xe.textContent&&me.textContent==null)&&f(oe,""),Be?U(G.dynamicChildren,Be,oe,te,Ce,xd(X,Ne),Fe):Ee||q(G,X,oe,null,te,Ce,xd(X,Ne),Fe,!1),ge>0){if(ge&16)F(oe,xe,me,te,Ne);else if(ge&2&&xe.class!==me.class&&i(oe,"class",null,me.class,Ne),ge&4&&i(oe,"style",xe.style,me.style,Ne),ge&8){const qe=X.dynamicProps;for(let fe=0;fe<qe.length;fe++){const ke=qe[fe],ne=xe[ke],ye=me[ke];(ye!==ne||ke==="value")&&i(oe,ke,ne,ye,Ne,te)}}ge&1&&G.children!==X.children&&f(oe,X.children)}else!Ee&&Be==null&&F(oe,xe,me,te,Ne);((Ze=me.onVnodeUpdated)||Oe)&&po(()=>{Ze&&Us(Ze,te,X,G),Oe&&Oi(X,G,te,"updated")},Ce)},U=(G,X,te,Ce,Ne,Fe,Ee)=>{for(let oe=0;oe<X.length;oe++){const ge=G[oe],Be=X[oe],Oe=ge.el&&(ge.type===Ie||!qi(ge,Be)||ge.shapeFlag&198)?v(ge.el):te;x(ge,Be,Oe,null,Ce,Ne,Fe,Ee,!0)}},F=(G,X,te,Ce,Ne)=>{if(X!==te){if(X!==nn)for(const Fe in X)!Dr(Fe)&&!(Fe in te)&&i(G,Fe,X[Fe],null,Ne,Ce);for(const Fe in te){if(Dr(Fe))continue;const Ee=te[Fe],oe=X[Fe];Ee!==oe&&Fe!=="value"&&i(G,Fe,oe,Ee,Ne,Ce)}"value"in te&&i(G,"value",X.value,te.value,Ne)}},j=(G,X,te,Ce,Ne,Fe,Ee,oe,ge)=>{const Be=X.el=G?G.el:c(""),Oe=X.anchor=G?G.anchor:c("");let{patchFlag:xe,dynamicChildren:me,slotScopeIds:Ze}=X;Ze&&(oe=oe?oe.concat(Ze):Ze),G==null?(s(Be,te,Ce),s(Oe,te,Ce),O(X.children||[],te,Oe,Ne,Fe,Ee,oe,ge)):xe>0&&xe&64&&me&&G.dynamicChildren&&G.dynamicChildren.length===me.length?(U(G.dynamicChildren,me,te,Ne,Fe,Ee,oe),(X.key!=null||Ne&&X===Ne.subTree)&&If(G,X,!0)):q(G,X,te,Oe,Ne,Fe,Ee,oe,ge)},Z=(G,X,te,Ce,Ne,Fe,Ee,oe,ge)=>{X.slotScopeIds=oe,G==null?X.shapeFlag&512?Ne.ctx.activate(X,te,Ce,Ee,ge):Q(X,te,Ce,Ne,Fe,Ee,ge):re(G,X,ge)},Q=(G,X,te,Ce,Ne,Fe,Ee)=>{const oe=G.component=M0(G,Ce,Ne);if(Gu(G)&&(oe.ctx.renderer=ie),A0(oe,!1,Ee),oe.asyncDep){if(Ne&&Ne.registerDep(oe,K,Ee),!G.el){const ge=oe.subTree=Pe(eo);T(null,ge,X,te),G.placeholder=ge.el}}else K(oe,G,X,te,Ne,Fe,Ee)},re=(G,X,te)=>{const Ce=X.component=G.component;if(h0(G,X,te))if(Ce.asyncDep&&!Ce.asyncResolved){ae(Ce,X,te);return}else Ce.next=X,Ce.update();else X.el=G.el,Ce.vnode=X},K=(G,X,te,Ce,Ne,Fe,Ee)=>{const oe=()=>{if(G.isMounted){let{next:xe,bu:me,u:Ze,parent:qe,vnode:fe}=G;{const ct=Ug(G);if(ct){xe&&(xe.el=fe.el,ae(G,xe,Ee)),ct.asyncDep.then(()=>{G.isUnmounted||oe()});return}}let ke=xe,ne;Bi(G,!1),xe?(xe.el=fe.el,ae(G,xe,Ee)):xe=fe,me&&Zc(me),(ne=xe.props&&xe.props.onVnodeBeforeUpdate)&&Us(ne,qe,xe,fe),Bi(G,!0);const ye=fp(G),He=G.subTree;G.subTree=ye,x(He,ye,v(He.el),z(He),G,Ne,Fe),xe.el=ye.el,ke===null&&f0(G,ye.el),Ze&&po(Ze,Ne),(ne=xe.props&&xe.props.onVnodeUpdated)&&po(()=>Us(ne,qe,xe,fe),Ne)}else{let xe;const{el:me,props:Ze}=X,{bm:qe,m:fe,parent:ke,root:ne,type:ye}=G,He=Yl(X);Bi(G,!1),qe&&Zc(qe),!He&&(xe=Ze&&Ze.onVnodeBeforeMount)&&Us(xe,ke,X),Bi(G,!0);{ne.ce&&ne.ce._def.shadowRoot!==!1&&ne.ce._injectChildStyle(ye);const ct=G.subTree=fp(G);x(null,ct,te,Ce,G,Ne,Fe),X.el=ct.el}if(fe&&po(fe,Ne),!He&&(xe=Ze&&Ze.onVnodeMounted)){const ct=X;po(()=>Us(xe,ke,ct),Ne)}(X.shapeFlag&256||ke&&Yl(ke.vnode)&&ke.vnode.shapeFlag&256)&&G.a&&po(G.a,Ne),G.isMounted=!0,X=te=Ce=null}};G.scope.on();const ge=G.effect=new Um(oe);G.scope.off();const Be=G.update=ge.run.bind(ge),Oe=G.job=ge.runIfDirty.bind(ge);Oe.i=G,Oe.id=G.uid,ge.scheduler=()=>kf(Oe),Bi(G,!0),Be()},ae=(G,X,te)=>{X.component=G;const Ce=G.vnode.props;G.vnode=X,G.next=null,v0(G,X.props,Ce,te),k0(G,X.children,te),Ca(),np(G),La()},q=(G,X,te,Ce,Ne,Fe,Ee,oe,ge=!1)=>{const Be=G&&G.children,Oe=G?G.shapeFlag:0,xe=X.children,{patchFlag:me,shapeFlag:Ze}=X;if(me>0){if(me&128){ee(Be,xe,te,Ce,Ne,Fe,Ee,oe,ge);return}else if(me&256){J(Be,xe,te,Ce,Ne,Fe,Ee,oe,ge);return}}Ze&8?(Oe&16&&be(Be,Ne,Fe),xe!==Be&&f(te,xe)):Oe&16?Ze&16?ee(Be,xe,te,Ce,Ne,Fe,Ee,oe,ge):be(Be,Ne,Fe,!0):(Oe&8&&f(te,""),Ze&16&&O(xe,te,Ce,Ne,Fe,Ee,oe,ge))},J=(G,X,te,Ce,Ne,Fe,Ee,oe,ge)=>{G=G||Wl,X=X||Wl;const Be=G.length,Oe=X.length,xe=Math.min(Be,Oe);let me;for(me=0;me<xe;me++){const Ze=X[me]=ge?ni(X[me]):qs(X[me]);x(G[me],Ze,te,null,Ne,Fe,Ee,oe,ge)}Be>Oe?be(G,Ne,Fe,!0,!1,xe):O(X,te,Ce,Ne,Fe,Ee,oe,ge,xe)},ee=(G,X,te,Ce,Ne,Fe,Ee,oe,ge)=>{let Be=0;const Oe=X.length;let xe=G.length-1,me=Oe-1;for(;Be<=xe&&Be<=me;){const Ze=G[Be],qe=X[Be]=ge?ni(X[Be]):qs(X[Be]);if(qi(Ze,qe))x(Ze,qe,te,null,Ne,Fe,Ee,oe,ge);else break;Be++}for(;Be<=xe&&Be<=me;){const Ze=G[xe],qe=X[me]=ge?ni(X[me]):qs(X[me]);if(qi(Ze,qe))x(Ze,qe,te,null,Ne,Fe,Ee,oe,ge);else break;xe--,me--}if(Be>xe){if(Be<=me){const Ze=me+1,qe=Ze<Oe?X[Ze].el:Ce;for(;Be<=me;)x(null,X[Be]=ge?ni(X[Be]):qs(X[Be]),te,qe,Ne,Fe,Ee,oe,ge),Be++}}else if(Be>me)for(;Be<=xe;)_e(G[Be],Ne,Fe,!0),Be++;else{const Ze=Be,qe=Be,fe=new Map;for(Be=qe;Be<=me;Be++){const Lt=X[Be]=ge?ni(X[Be]):qs(X[Be]);Lt.key!=null&&fe.set(Lt.key,Be)}let ke,ne=0;const ye=me-qe+1;let He=!1,ct=0;const ht=new Array(ye);for(Be=0;Be<ye;Be++)ht[Be]=0;for(Be=Ze;Be<=xe;Be++){const Lt=G[Be];if(ne>=ye){_e(Lt,Ne,Fe,!0);continue}let Nt;if(Lt.key!=null)Nt=fe.get(Lt.key);else for(ke=qe;ke<=me;ke++)if(ht[ke-qe]===0&&qi(Lt,X[ke])){Nt=ke;break}Nt===void 0?_e(Lt,Ne,Fe,!0):(ht[Nt-qe]=Be+1,Nt>=ct?ct=Nt:He=!0,x(Lt,X[Nt],te,null,Ne,Fe,Ee,oe,ge),ne++)}const Bt=He?C0(ht):Wl;for(ke=Bt.length-1,Be=ye-1;Be>=0;Be--){const Lt=qe+Be,Nt=X[Lt],Et=X[Lt+1],yo=Lt+1<Oe?Et.el||zg(Et):Ce;ht[Be]===0?x(null,Nt,te,yo,Ne,Fe,Ee,oe,ge):He&&(ke<0||Be!==Bt[ke]?ue(Nt,te,yo,2):ke--)}}},ue=(G,X,te,Ce,Ne=null)=>{const{el:Fe,type:Ee,transition:oe,children:ge,shapeFlag:Be}=G;if(Be&6){ue(G.component.subTree,X,te,Ce);return}if(Be&128){G.suspense.move(X,te,Ce);return}if(Be&64){Ee.move(G,X,te,ie);return}if(Ee===Ie){s(Fe,X,te);for(let xe=0;xe<ge.length;xe++)ue(ge[xe],X,te,Ce);s(G.anchor,X,te);return}if(Ee===zr){C(G,X,te);return}if(Ce!==2&&Be&1&&oe)if(Ce===0)oe.beforeEnter(Fe),s(Fe,X,te),po(()=>oe.enter(Fe),Ne);else{const{leave:xe,delayLeave:me,afterLeave:Ze}=oe,qe=()=>{G.ctx.isUnmounted?o(Fe):s(Fe,X,te)},fe=()=>{Fe._isLeaving&&Fe[ha](!0),xe(Fe,()=>{qe(),Ze&&Ze()})};me?me(Fe,qe,fe):fe()}else s(Fe,X,te)},_e=(G,X,te,Ce=!1,Ne=!1)=>{const{type:Fe,props:Ee,ref:oe,children:ge,dynamicChildren:Be,shapeFlag:Oe,patchFlag:xe,dirs:me,cacheIndex:Ze}=G;if(xe===-2&&(Ne=!1),oe!=null&&(Ca(),Fr(oe,null,te,G,!0),La()),Ze!=null&&(X.renderCache[Ze]=void 0),Oe&256){X.ctx.deactivate(G);return}const qe=Oe&1&&me,fe=!Yl(G);let ke;if(fe&&(ke=Ee&&Ee.onVnodeBeforeUnmount)&&Us(ke,X,G),Oe&6)Re(G.component,te,Ce);else{if(Oe&128){G.suspense.unmount(te,Ce);return}qe&&Oi(G,null,X,"beforeUnmount"),Oe&64?G.type.remove(G,X,te,ie,Ce):Be&&!Be.hasOnce&&(Fe!==Ie||xe>0&&xe&64)?be(Be,X,te,!1,!0):(Fe===Ie&&xe&384||!Ne&&Oe&16)&&be(ge,X,te),Ce&&$e(G)}(fe&&(ke=Ee&&Ee.onVnodeUnmounted)||qe)&&po(()=>{ke&&Us(ke,X,G),qe&&Oi(G,null,X,"unmounted")},te)},$e=G=>{const{type:X,el:te,anchor:Ce,transition:Ne}=G;if(X===Ie){De(te,Ce);return}if(X===zr){I(G);return}const Fe=()=>{o(te),Ne&&!Ne.persisted&&Ne.afterLeave&&Ne.afterLeave()};if(G.shapeFlag&1&&Ne&&!Ne.persisted){const{leave:Ee,delayLeave:oe}=Ne,ge=()=>Ee(te,Fe);oe?oe(G.el,Fe,ge):ge()}else Fe()},De=(G,X)=>{let te;for(;G!==X;)te=g(G),o(G),G=te;o(X)},Re=(G,X,te)=>{const{bum:Ce,scope:Ne,job:Fe,subTree:Ee,um:oe,m:ge,a:Be}=G;mp(ge),mp(Be),Ce&&Zc(Ce),Ne.stop(),Fe&&(Fe.flags|=8,_e(Ee,G,X,te)),oe&&po(oe,X),po(()=>{G.isUnmounted=!0},X)},be=(G,X,te,Ce=!1,Ne=!1,Fe=0)=>{for(let Ee=Fe;Ee<G.length;Ee++)_e(G[Ee],X,te,Ce,Ne)},z=G=>{if(G.shapeFlag&6)return z(G.component.subTree);if(G.shapeFlag&128)return G.suspense.next();const X=g(G.anchor||G.el),te=X&&X[ug];return te?g(te):X};let Y=!1;const de=(G,X,te)=>{let Ce;G==null?X._vnode&&(_e(X._vnode,null,null,!0),Ce=X._vnode.component):x(X._vnode||null,G,X,null,null,null,te),X._vnode=G,Y||(Y=!0,np(Ce),ig(),Y=!1)},ie={p:x,um:_e,m:ue,r:$e,mt:Q,mc:O,pc:q,pbc:U,n:z,o:e};return{render:de,hydrate:void 0,createApp:i0(de)}}function xd({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Bi({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function _0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function If(e,t,n=!1){const s=e.children,o=t.children;if(ut(s)&&ut(o))for(let i=0;i<s.length;i++){const l=s[i];let c=o[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=o[i]=ni(o[i]),c.el=l.el),!n&&c.patchFlag!==-2&&If(l,c)),c.type===Wu&&(c.patchFlag!==-1?c.el=l.el:c.__elIndex=i+(e.type===Ie?1:0)),c.type===eo&&!c.el&&(c.el=l.el)}}function C0(e){const t=e.slice(),n=[0];let s,o,i,l,c;const d=e.length;for(s=0;s<d;s++){const h=e[s];if(h!==0){if(o=n[n.length-1],e[o]<h){t[s]=o,n.push(s);continue}for(i=0,l=n.length-1;i<l;)c=i+l>>1,e[n[c]]<h?i=c+1:l=c;h<e[n[i]]&&(i>0&&(t[s]=n[i-1]),n[i]=s)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}function Ug(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ug(t)}function mp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function zg(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?zg(t.subTree):null}const Hg=e=>e.__isSuspense;function L0(e,t){t&&t.pendingBranch?ut(e)?t.effects.push(...e):t.effects.push(e):ag(e)}const Ie=Symbol.for("v-fgt"),Wu=Symbol.for("v-txt"),eo=Symbol.for("v-cmt"),zr=Symbol.for("v-stc"),Hr=[];let Fo=null;function p(e=!1){Hr.push(Fo=e?null:[])}function I0(){Hr.pop(),Fo=Hr[Hr.length-1]||null}let nc=1;function vu(e,t=!1){nc+=e,e<0&&Fo&&t&&(Fo.hasOnce=!0)}function Vg(e){return e.dynamicChildren=nc>0?Fo||Wl:null,I0(),nc>0&&Fo&&Fo.push(e),e}function y(e,t,n,s,o,i){return Vg(r(e,t,n,s,o,i,!0))}function Ge(e,t,n,s,o){return Vg(Pe(e,t,n,s,o,!0))}function oc(e){return e?e.__v_isVNode===!0:!1}function qi(e,t){return e.type===t.type&&e.key===t.key}const Gg=({key:e})=>e??null,Yc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?fn(e)||hn(e)||_t(e)?{i:Hn,r:e,k:t,f:!!n}:e:null);function r(e,t=null,n=null,s=0,o=null,i=e===Ie?0:1,l=!1,c=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Gg(t),ref:t&&Yc(t),scopeId:rg,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Hn};return c?(Sf(d,n),i&128&&e.normalize(d)):n&&(d.shapeFlag|=fn(n)?8:16),nc>0&&!l&&Fo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&Fo.push(d),d}const Pe=S0;function S0(e,t=null,n=null,s=0,o=null,i=!1){if((!e||e===Ig)&&(e=eo),oc(e)){const c=pi(e,t,!0);return n&&Sf(c,n),nc>0&&!i&&Fo&&(c.shapeFlag&6?Fo[Fo.indexOf(e)]=c:Fo.push(c)),c.patchFlag=-2,c}if(O0(e)&&(e=e.__vccOpts),t){t=x0(t);let{class:c,style:d}=t;c&&!fn(c)&&(t.class=le(c)),Qt(d)&&(Hu(d)&&!ut(d)&&(d=Rn({},d)),t.style=tt(d))}const l=fn(e)?1:Hg(e)?128:dg(e)?64:Qt(e)?4:_t(e)?2:0;return r(e,t,n,s,o,l,i,!0)}function x0(e){return e?Hu(e)||Dg(e)?Rn({},e):e:null}function pi(e,t,n=!1,s=!1){const{props:o,ref:i,patchFlag:l,children:c,transition:d}=e,h=t?qg(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Gg(h),ref:t&&t.ref?n&&i?ut(i)?i.concat(Yc(t)):[i,Yc(t)]:Yc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ie?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&pi(e.ssContent),ssFallback:e.ssFallback&&pi(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&s&&tc(f,d.clone(f)),f}function Je(e=" ",t=0){return Pe(Wu,null,e,t)}function vi(e,t){const n=Pe(zr,null,e);return n.staticCount=t,n}function P(e="",t=!1){return t?(p(),Ge(eo,null,e)):Pe(eo,null,e)}function qs(e){return e==null||typeof e=="boolean"?Pe(eo):ut(e)?Pe(Ie,null,e.slice()):oc(e)?ni(e):Pe(Wu,null,String(e))}function ni(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:pi(e)}function Sf(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(ut(t))n=16;else if(typeof t=="object")if(s&65){const o=t.default;o&&(o._c&&(o._d=!1),Sf(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!Dg(t)?t._ctx=Hn:o===3&&Hn&&(Hn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else _t(t)?(t={default:t,_ctx:Hn},n=32):(t=String(t),s&64?(n=16,t=[Je(t)]):n=8);e.children=t,e.shapeFlag|=n}function qg(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const o in s)if(o==="class")t.class!==s.class&&(t.class=le([t.class,s.class]));else if(o==="style")t.style=tt([t.style,s.style]);else if(Ru(o)){const i=t[o],l=s[o];l&&i!==l&&!(ut(i)&&i.includes(l))&&(t[o]=i?[].concat(i,l):l)}else o!==""&&(t[o]=s[o])}return t}function Us(e,t,n,s=null){xs(e,t,7,[n,s])}const $0=Mg();let T0=0;function M0(e,t,n){const s=e.type,o=(t?t.appContext:e.appContext)||$0,i={uid:T0++,vnode:e,type:s,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Bm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Og(s,o),emitsOptions:Ag(s,o),emit:null,emitted:null,propsDefaults:nn,inheritAttrs:s.inheritAttrs,ctx:nn,data:nn,props:nn,attrs:nn,slots:nn,refs:nn,setupState:nn,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=r0.bind(null,i),e.ce&&e.ce(i),i}let to=null;const Zu=()=>to||Hn;let mu,Eh;{const e=Uu(),t=(n,s)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(s),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};mu=t("__VUE_INSTANCE_SETTERS__",n=>to=n),Eh=t("__VUE_SSR_SETTERS__",n=>sc=n)}const hc=e=>{const t=to;return mu(e),e.scope.on(),()=>{e.scope.off(),mu(t)}},gp=()=>{to&&to.scope.off(),mu(null)};function jg(e){return e.vnode.shapeFlag&4}let sc=!1;function A0(e,t=!1,n=!1){t&&Eh(t);const{props:s,children:o}=e.vnode,i=jg(e);p0(e,s,i,t),y0(e,o,n||t);const l=i?E0(e,t):void 0;return t&&Eh(!1),l}function E0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Qk);const{setup:s}=n;if(s){Ca();const o=e.setupContext=s.length>1?D0(e):null,i=hc(e),l=dc(s,e,0,[e.props,o]),c=Mm(l);if(La(),i(),(c||e.sp)&&!Yl(e)&&bg(e),c){if(l.then(gp,gp),t)return l.then(d=>{yp(e,d)}).catch(d=>{Vu(d,e,0)});e.asyncDep=l}else yp(e,l)}else Wg(e)}function yp(e,t,n){_t(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qt(t)&&(e.setupState=ng(t)),Wg(e)}function Wg(e,t,n){const s=e.type;e.render||(e.render=s.render||_s);{const o=hc(e);Ca();try{e0(e)}finally{La(),o()}}}const P0={get(e,t){return Qn(e,"get",""),e[t]}};function D0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,P0),slots:e.slots,emit:e.emit,expose:t}}function Ku(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(ng(yf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ur)return Ur[n](e)},has(t,n){return n in t||n in Ur}})):e.proxy}function R0(e,t=!0){return _t(e)?e.displayName||e.name:e.name||t&&e.__name}function O0(e){return _t(e)&&"__vccOpts"in e}const H=(e,t)=>Tk(e,t,sc);function xf(e,t,n){try{vu(-1);const s=arguments.length;return s===2?Qt(t)&&!ut(t)?oc(t)?Pe(e,null,[t]):Pe(e,t):Pe(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&oc(n)&&(n=[n]),Pe(e,t,n))}finally{vu(1)}}const B0="3.5.26";let Ph;const kp=typeof window<"u"&&window.trustedTypes;if(kp)try{Ph=kp.createPolicy("vue",{createHTML:e=>e})}catch{}const Zg=Ph?e=>Ph.createHTML(e):e=>e,N0="http://www.w3.org/2000/svg",F0="http://www.w3.org/1998/Math/MathML",da=typeof document<"u"?document:null,bp=da&&da.createElement("template"),U0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const o=t==="svg"?da.createElementNS(N0,e):t==="mathml"?da.createElementNS(F0,e):n?da.createElement(e,{is:n}):da.createElement(e);return e==="select"&&s&&s.multiple!=null&&o.setAttribute("multiple",s.multiple),o},createText:e=>da.createTextNode(e),createComment:e=>da.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>da.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,o,i){const l=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{bp.innerHTML=Zg(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const c=bp.content;if(s==="svg"||s==="mathml"){const d=c.firstChild;for(;d.firstChild;)c.appendChild(d.firstChild);c.removeChild(d)}t.insertBefore(c,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ka="transition",_r="animation",ac=Symbol("_vtc"),Kg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},z0=Rn({},pg,Kg),H0=e=>(e.displayName="Transition",e.props=z0,e),Ls=H0((e,{slots:t})=>xf(Hk,V0(e),t)),Ni=(e,t=[])=>{ut(e)?e.forEach(n=>n(...t)):e&&e(...t)},wp=e=>e?ut(e)?e.some(t=>t.length>1):e.length>1:!1;function V0(e){const t={};for(const j in e)j in Kg||(t[j]=e[j]);if(e.css===!1)return t;const{name:n="v",type:s,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=c,leaveFromClass:v=`${n}-leave-from`,leaveActiveClass:g=`${n}-leave-active`,leaveToClass:k=`${n}-leave-to`}=e,b=G0(o),x=b&&b[0],A=b&&b[1],{onBeforeEnter:T,onEnter:w,onEnterCancelled:C,onLeave:I,onLeaveCancelled:$,onBeforeAppear:R=T,onAppear:M=w,onAppearCancelled:O=C}=t,E=(j,Z,Q,re)=>{j._enterCancelled=re,Fi(j,Z?f:c),Fi(j,Z?h:l),Q&&Q()},U=(j,Z)=>{j._isLeaving=!1,Fi(j,v),Fi(j,k),Fi(j,g),Z&&Z()},F=j=>(Z,Q)=>{const re=j?M:w,K=()=>E(Z,j,Q);Ni(re,[Z,K]),_p(()=>{Fi(Z,j?d:i),ra(Z,j?f:c),wp(re)||Cp(Z,s,x,K)})};return Rn(t,{onBeforeEnter(j){Ni(T,[j]),ra(j,i),ra(j,l)},onBeforeAppear(j){Ni(R,[j]),ra(j,d),ra(j,h)},onEnter:F(!1),onAppear:F(!0),onLeave(j,Z){j._isLeaving=!0;const Q=()=>U(j,Z);ra(j,v),j._enterCancelled?(ra(j,g),Sp(j)):(Sp(j),ra(j,g)),_p(()=>{j._isLeaving&&(Fi(j,v),ra(j,k),wp(I)||Cp(j,s,A,Q))}),Ni(I,[j,Q])},onEnterCancelled(j){E(j,!1,void 0,!0),Ni(C,[j])},onAppearCancelled(j){E(j,!0,void 0,!0),Ni(O,[j])},onLeaveCancelled(j){U(j),Ni($,[j])}})}function G0(e){if(e==null)return null;if(Qt(e))return[$d(e.enter),$d(e.leave)];{const t=$d(e);return[t,t]}}function $d(e){return W1(e)}function ra(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[ac]||(e[ac]=new Set)).add(t)}function Fi(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const n=e[ac];n&&(n.delete(t),n.size||(e[ac]=void 0))}function _p(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let q0=0;function Cp(e,t,n,s){const o=e._endId=++q0,i=()=>{o===e._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:l,timeout:c,propCount:d}=j0(e,t);if(!l)return s();const h=l+"end";let f=0;const v=()=>{e.removeEventListener(h,g),i()},g=k=>{k.target===e&&++f>=d&&v()};setTimeout(()=>{f<d&&v()},c+1),e.addEventListener(h,g)}function j0(e,t){const n=window.getComputedStyle(e),s=b=>(n[b]||"").split(", "),o=s(`${Ka}Delay`),i=s(`${Ka}Duration`),l=Lp(o,i),c=s(`${_r}Delay`),d=s(`${_r}Duration`),h=Lp(c,d);let f=null,v=0,g=0;t===Ka?l>0&&(f=Ka,v=l,g=i.length):t===_r?h>0&&(f=_r,v=h,g=d.length):(v=Math.max(l,h),f=v>0?l>h?Ka:_r:null,g=f?f===Ka?i.length:d.length:0);const k=f===Ka&&/\b(?:transform|all)(?:,|$)/.test(s(`${Ka}Property`).toString());return{type:f,timeout:v,propCount:g,hasTransform:k}}function Lp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,s)=>Ip(n)+Ip(e[s])))}function Ip(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Sp(e){return(e?e.ownerDocument:document).body.offsetHeight}function W0(e,t,n){const s=e[ac];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const gu=Symbol("_vod"),Yg=Symbol("_vsh"),ns={name:"show",beforeMount(e,{value:t},{transition:n}){e[gu]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Cr(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),Cr(e,!0),s.enter(e)):s.leave(e,()=>{Cr(e,!1)}):Cr(e,t))},beforeUnmount(e,{value:t}){Cr(e,t)}};function Cr(e,t){e.style.display=t?e[gu]:"none",e[Yg]=!t}const Jg=Symbol("");function Z0(e){const t=Zu();if(!t)return;const n=t.ut=(o=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>yu(i,o))},s=()=>{const o=e(t.proxy);t.ce?yu(t.ce,o):Dh(t.subTree,o),n(o)};_g(()=>{ag(s)}),un(()=>{Ye(s,_s,{flush:"post"});const o=new MutationObserver(s);o.observe(t.subTree.el.parentNode,{childList:!0}),Sn(()=>o.disconnect())})}function Dh(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Dh(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)yu(e.el,t);else if(e.type===Ie)e.children.forEach(n=>Dh(n,t));else if(e.type===zr){let{el:n,anchor:s}=e;for(;n&&(yu(n,t),n!==s);)n=n.nextSibling}}function yu(e,t){if(e.nodeType===1){const n=e.style;let s="";for(const o in t){const i=tk(t[o]);n.setProperty(`--${o}`,i),s+=`--${o}: ${i};`}n[Jg]=s}}const K0=/(?:^|;)\s*display\s*:/;function Y0(e,t,n){const s=e.style,o=fn(n);let i=!1;if(n&&!o){if(t)if(fn(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();n[c]==null&&Jc(s,c,"")}else for(const l in t)n[l]==null&&Jc(s,l,"");for(const l in n)l==="display"&&(i=!0),Jc(s,l,n[l])}else if(o){if(t!==n){const l=s[Jg];l&&(n+=";"+l),s.cssText=n,i=K0.test(n)}}else t&&e.removeAttribute("style");gu in e&&(e[gu]=i?s.display:"",e[Yg]&&(s.display="none"))}const xp=/\s*!important$/;function Jc(e,t,n){if(ut(n))n.forEach(s=>Jc(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=J0(e,t);xp.test(n)?e.setProperty(yi(s),n.replace(xp,""),"important"):e[s]=n}}const $p=["Webkit","Moz","ms"],Td={};function J0(e,t){const n=Td[t];if(n)return n;let s=ts(t);if(s!=="filter"&&s in e)return Td[t]=s;s=Nu(s);for(let o=0;o<$p.length;o++){const i=$p[o]+s;if(i in e)return Td[t]=i}return t}const Tp="http://www.w3.org/1999/xlink";function Mp(e,t,n,s,o,i=Q1(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Tp,t.slice(6,t.length)):e.setAttributeNS(Tp,t,n):n==null||i&&!Dm(n)?e.removeAttribute(t):e.setAttribute(t,i?"":Is(n)?String(n):n)}function Ap(e,t,n,s,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Zg(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(c!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=Dm(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(o||t)}function va(e,t,n,s){e.addEventListener(t,n,s)}function X0(e,t,n,s){e.removeEventListener(t,n,s)}const Ep=Symbol("_vei");function Q0(e,t,n,s,o=null){const i=e[Ep]||(e[Ep]={}),l=i[t];if(s&&l)l.value=s;else{const[c,d]=eb(t);if(s){const h=i[t]=ob(s,o);va(e,c,h,d)}else l&&(X0(e,c,l,d),i[t]=void 0)}}const Pp=/(?:Once|Passive|Capture)$/;function eb(e){let t;if(Pp.test(e)){t={};let s;for(;s=e.match(Pp);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):yi(e.slice(2)),t]}let Md=0;const tb=Promise.resolve(),nb=()=>Md||(tb.then(()=>Md=0),Md=Date.now());function ob(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;xs(sb(s,n.value),t,5,[s])};return n.value=e,n.attached=nb(),n}function sb(e,t){if(ut(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>o=>!o._stopped&&s&&s(o))}else return t}const Dp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,ab=(e,t,n,s,o,i)=>{const l=o==="svg";t==="class"?W0(e,s,l):t==="style"?Y0(e,n,s):Ru(t)?cf(t)||Q0(e,t,n,s,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):ib(e,t,s,l))?(Ap(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Mp(e,t,s,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!fn(s))?Ap(e,ts(t),s,i,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),Mp(e,t,s,l))};function ib(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&Dp(t)&&_t(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Dp(t)&&fn(n)?!1:t in e}const mi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ut(t)?n=>Zc(t,n):t};function lb(e){e.target.composing=!0}function Rp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const es=Symbol("_assign");function Op(e,t,n){return t&&(e=e.trim()),n&&(e=Fu(e)),e}const st={created(e,{modifiers:{lazy:t,trim:n,number:s}},o){e[es]=mi(o);const i=s||o.props&&o.props.type==="number";va(e,t?"change":"input",l=>{l.target.composing||e[es](Op(e.value,n,i))}),(n||i)&&va(e,"change",()=>{e.value=Op(e.value,n,i)}),t||(va(e,"compositionstart",lb),va(e,"compositionend",Rp),va(e,"change",Rp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:o,number:i}},l){if(e[es]=mi(l),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Fu(e.value):e.value,d=t??"";c!==d&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||o&&e.value.trim()===d)||(e.value=d))}},$s={deep:!0,created(e,t,n){e[es]=mi(n),va(e,"change",()=>{const s=e._modelValue,o=er(e),i=e.checked,l=e[es];if(ut(s)){const c=df(s,o),d=c!==-1;if(i&&!d)l(s.concat(o));else if(!i&&d){const h=[...s];h.splice(c,1),l(h)}}else if(ar(s)){const c=new Set(s);i?c.add(o):c.delete(o),l(c)}else l(Xg(e,i))})},mounted:Bp,beforeUpdate(e,t,n){e[es]=mi(n),Bp(e,t,n)}};function Bp(e,{value:t,oldValue:n},s){e._modelValue=t;let o;if(ut(t))o=df(t,s.props.value)>-1;else if(ar(t))o=t.has(s.props.value);else{if(t===n)return;o=el(t,Xg(e,!0))}e.checked!==o&&(e.checked=o)}const Np={created(e,{value:t},n){e.checked=el(t,n.props.value),e[es]=mi(n),va(e,"change",()=>{e[es](er(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[es]=mi(s),t!==n&&(e.checked=el(t,s.props.value))}},no={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const o=ar(t);va(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?Fu(er(l)):er(l));e[es](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[es]=mi(s)},mounted(e,{value:t}){Fp(e,t)},beforeUpdate(e,t,n){e[es]=mi(n)},updated(e,{value:t}){e._assigning||Fp(e,t)}};function Fp(e,t){const n=e.multiple,s=ut(t);if(!(n&&!s&&!ar(t))){for(let o=0,i=e.options.length;o<i;o++){const l=e.options[o],c=er(l);if(n)if(s){const d=typeof c;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(c)):l.selected=df(t,c)>-1}else l.selected=t.has(c);else if(el(er(l),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function er(e){return"_value"in e?e._value:e.value}function Xg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const rb=["ctrl","shift","alt","meta"],cb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>rb.some(n=>e[`${n}Key`]&&!t.includes(n))},rt=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=((o,...i)=>{for(let l=0;l<t.length;l++){const c=cb[t[l]];if(c&&c(o,t))return}return e(o,...i)}))},ub={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Xo=(e,t)=>{const n=e._withKeys||(e._withKeys={}),s=t.join(".");return n[s]||(n[s]=(o=>{if(!("key"in o))return;const i=yi(o.key);if(t.some(l=>l===i||ub[l]===i))return e(o)}))},db=Rn({patchProp:ab},U0);let Up;function hb(){return Up||(Up=b0(db))}const fb=((...e)=>{const t=hb().createApp(...e),{mount:n}=t;return t.mount=s=>{const o=vb(s);if(!o)return;const i=t._component;!_t(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const l=n(o,!1,pb(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),l},t});function pb(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function vb(e){return fn(e)?document.querySelector(e):e}let Qg;const Yu=e=>Qg=e,ey=Symbol();function Rh(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Vr;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Vr||(Vr={}));function mb(){const e=Nm(!0),t=e.run(()=>D({}));let n=[],s=[];const o=yf({install(i){Yu(o),o._a=i,i.provide(ey,o),i.config.globalProperties.$pinia=o,s.forEach(l=>n.push(l)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const ty=()=>{};function zp(e,t,n,s=ty){e.add(t);const o=()=>{e.delete(t)&&s()};return!n&&Fm()&&nk(o),o}function Ol(e,...t){e.forEach(n=>{n(...t)})}const gb=e=>e(),Hp=Symbol(),Ad=Symbol();function Oh(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,s)=>e.set(s,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const s=t[n],o=e[n];Rh(o)&&Rh(s)&&e.hasOwnProperty(n)&&!hn(s)&&!wa(s)?e[n]=Oh(o,s):e[n]=s}return e}const yb=Symbol();function kb(e){return!Rh(e)||!Object.prototype.hasOwnProperty.call(e,yb)}const{assign:Xa}=Object;function bb(e){return!!(hn(e)&&e.effect)}function wb(e,t,n,s){const{state:o,actions:i,getters:l}=t,c=n.state.value[e];let d;function h(){c||(n.state.value[e]=o?o():{});const f=Ik(n.state.value[e]);return Xa(f,i,Object.keys(l||{}).reduce((v,g)=>(v[g]=yf(H(()=>{Yu(n);const k=n._s.get(e);return l[g].call(k,k)})),v),{}))}return d=ny(e,h,t,n,s,!0),d}function ny(e,t,n={},s,o,i){let l;const c=Xa({actions:{}},n),d={deep:!0};let h,f,v=new Set,g=new Set,k;const b=s.state.value[e];!i&&!b&&(s.state.value[e]={}),D({});let x;function A(O){let E;h=f=!1,typeof O=="function"?(O(s.state.value[e]),E={type:Vr.patchFunction,storeId:e,events:k}):(Oh(s.state.value[e],O),E={type:Vr.patchObject,payload:O,storeId:e,events:k});const U=x=Symbol();cn().then(()=>{x===U&&(h=!0)}),f=!0,Ol(v,E,s.state.value[e])}const T=i?function(){const{state:E}=n,U=E?E():{};this.$patch(F=>{Xa(F,U)})}:ty;function w(){l.stop(),v.clear(),g.clear(),s._s.delete(e)}const C=(O,E="")=>{if(Hp in O)return O[Ad]=E,O;const U=function(){Yu(s);const F=Array.from(arguments),j=new Set,Z=new Set;function Q(ae){j.add(ae)}function re(ae){Z.add(ae)}Ol(g,{args:F,name:U[Ad],store:$,after:Q,onError:re});let K;try{K=O.apply(this&&this.$id===e?this:$,F)}catch(ae){throw Ol(Z,ae),ae}return K instanceof Promise?K.then(ae=>(Ol(j,ae),ae)).catch(ae=>(Ol(Z,ae),Promise.reject(ae))):(Ol(j,K),K)};return U[Hp]=!0,U[Ad]=E,U},I={_p:s,$id:e,$onAction:zp.bind(null,g),$patch:A,$reset:T,$subscribe(O,E={}){const U=zp(v,O,E.detached,()=>F()),F=l.run(()=>Ye(()=>s.state.value[e],j=>{(E.flush==="sync"?f:h)&&O({storeId:e,type:Vr.direct,events:k},j)},Xa({},d,E)));return U},$dispose:w},$=ol(I);s._s.set(e,$);const M=(s._a&&s._a.runWithContext||gb)(()=>s._e.run(()=>(l=Nm()).run(()=>t({action:C}))));for(const O in M){const E=M[O];if(hn(E)&&!bb(E)||wa(E))i||(b&&kb(E)&&(hn(E)?E.value=b[O]:Oh(E,b[O])),s.state.value[e][O]=E);else if(typeof E=="function"){const U=C(E,O);M[O]=U,c.actions[O]=E}}return Xa($,M),Xa(Ht($),M),Object.defineProperty($,"$state",{get:()=>s.state.value[e],set:O=>{A(E=>{Xa(E,O)})}}),s._p.forEach(O=>{Xa($,l.run(()=>O({store:$,app:s._a,pinia:s,options:c})))}),b&&i&&n.hydrate&&n.hydrate($.$state,b),h=!0,f=!0,$}function $f(e,t,n){let s;const o=typeof t=="function";s=o?n:t;function i(l,c){const d=Dk();return l=l||(d?$o(ey,null):null),l&&Yu(l),l=Qg,l._s.has(e)||(o?ny(e,t,s,l):wb(e,s,l)),l._s.get(e)}return i.$id=e,i}const zl=typeof document<"u";function oy(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function _b(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&oy(e.default)}const Zt=Object.assign;function Ed(e,t){const n={};for(const s in t){const o=t[s];n[s]=Ts(o)?o.map(e):e(o)}return n}const Gr=()=>{},Ts=Array.isArray;function Vp(e,t){const n={};for(const s in e)n[s]=s in t?t[s]:e[s];return n}const sy=/#/g,Cb=/&/g,Lb=/\//g,Ib=/=/g,Sb=/\?/g,ay=/\+/g,xb=/%5B/g,$b=/%5D/g,iy=/%5E/g,Tb=/%60/g,ly=/%7B/g,Mb=/%7C/g,ry=/%7D/g,Ab=/%20/g;function Tf(e){return e==null?"":encodeURI(""+e).replace(Mb,"|").replace(xb,"[").replace($b,"]")}function Eb(e){return Tf(e).replace(ly,"{").replace(ry,"}").replace(iy,"^")}function Bh(e){return Tf(e).replace(ay,"%2B").replace(Ab,"+").replace(sy,"%23").replace(Cb,"%26").replace(Tb,"`").replace(ly,"{").replace(ry,"}").replace(iy,"^")}function Pb(e){return Bh(e).replace(Ib,"%3D")}function Db(e){return Tf(e).replace(sy,"%23").replace(Sb,"%3F")}function Rb(e){return Db(e).replace(Lb,"%2F")}function ic(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ob=/\/$/,Bb=e=>e.replace(Ob,"");function Pd(e,t,n="/"){let s,o={},i="",l="";const c=t.indexOf("#");let d=t.indexOf("?");return d=c>=0&&d>c?-1:d,d>=0&&(s=t.slice(0,d),i=t.slice(d,c>0?c:t.length),o=e(i.slice(1))),c>=0&&(s=s||t.slice(0,c),l=t.slice(c,t.length)),s=zb(s??t,n),{fullPath:s+i+l,path:s,query:o,hash:ic(l)}}function Nb(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Gp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Fb(e,t,n){const s=t.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&tr(t.matched[s],n.matched[o])&&cy(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function tr(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function cy(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!Ub(e[n],t[n]))return!1;return!0}function Ub(e,t){return Ts(e)?qp(e,t):Ts(t)?qp(t,e):e?.valueOf()===t?.valueOf()}function qp(e,t){return Ts(t)?e.length===t.length&&e.every((n,s)=>n===t[s]):e.length===1&&e[0]===t}function zb(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),s=e.split("/"),o=s[s.length-1];(o===".."||o===".")&&s.push("");let i=n.length-1,l,c;for(l=0;l<s.length;l++)if(c=s[l],c!==".")if(c==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(l).join("/")}const Ya={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Nh=(function(e){return e.pop="pop",e.push="push",e})({}),Dd=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Hb(e){if(!e)if(zl){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Bb(e)}const Vb=/^[^#]+#/;function Gb(e,t){return e.replace(Vb,"#")+t}function qb(e,t){const n=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:t.behavior,left:s.left-n.left-(t.left||0),top:s.top-n.top-(t.top||0)}}const Ju=()=>({left:window.scrollX,top:window.scrollY});function jb(e){let t;if("el"in e){const n=e.el,s=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=qb(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function jp(e,t){return(history.state?history.state.position-t:-1)+e}const Fh=new Map;function Wb(e,t){Fh.set(e,t)}function Zb(e){const t=Fh.get(e);return Fh.delete(e),t}function Kb(e){return typeof e=="string"||e&&typeof e=="object"}function uy(e){return typeof e=="string"||typeof e=="symbol"}let gn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const dy=Symbol("");gn.MATCHER_NOT_FOUND+"",gn.NAVIGATION_GUARD_REDIRECT+"",gn.NAVIGATION_ABORTED+"",gn.NAVIGATION_CANCELLED+"",gn.NAVIGATION_DUPLICATED+"";function nr(e,t){return Zt(new Error,{type:e,[dy]:!0},t)}function ca(e,t){return e instanceof Error&&dy in e&&(t==null||!!(e.type&t))}const Yb=["params","query","hash"];function Jb(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of Yb)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function Xb(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const o=n[s].replace(ay," "),i=o.indexOf("="),l=ic(i<0?o:o.slice(0,i)),c=i<0?null:ic(o.slice(i+1));if(l in t){let d=t[l];Ts(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function Wp(e){let t="";for(let n in e){const s=e[n];if(n=Pb(n),s==null){s!==void 0&&(t+=(t.length?"&":"")+n);continue}(Ts(s)?s.map(o=>o&&Bh(o)):[s&&Bh(s)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function Qb(e){const t={};for(const n in e){const s=e[n];s!==void 0&&(t[n]=Ts(s)?s.map(o=>o==null?null:""+o):s==null?s:""+s)}return t}const ew=Symbol(""),Zp=Symbol(""),Xu=Symbol(""),Mf=Symbol(""),Uh=Symbol("");function Lr(){let e=[];function t(s){return e.push(s),()=>{const o=e.indexOf(s);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function oi(e,t,n,s,o,i=l=>l()){const l=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((c,d)=>{const h=g=>{g===!1?d(nr(gn.NAVIGATION_ABORTED,{from:n,to:t})):g instanceof Error?d(g):Kb(g)?d(nr(gn.NAVIGATION_GUARD_REDIRECT,{from:t,to:g})):(l&&s.enterCallbacks[o]===l&&typeof g=="function"&&l.push(g),c())},f=i(()=>e.call(s&&s.instances[o],t,n,h));let v=Promise.resolve(f);e.length<3&&(v=v.then(h)),v.catch(g=>d(g))})}function Rd(e,t,n,s,o=i=>i()){const i=[];for(const l of e)for(const c in l.components){let d=l.components[c];if(!(t!=="beforeRouteEnter"&&!l.instances[c]))if(oy(d)){const h=(d.__vccOpts||d)[t];h&&i.push(oi(h,n,s,l,c,o))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${l.path}"`);const v=_b(f)?f.default:f;l.mods[c]=f,l.components[c]=v;const g=(v.__vccOpts||v)[t];return g&&oi(g,n,s,l,c,o)()}))}}return i}function tw(e,t){const n=[],s=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const c=t.matched[l];c&&(e.matched.find(h=>tr(h,c))?s.push(c):n.push(c));const d=e.matched[l];d&&(t.matched.find(h=>tr(h,d))||o.push(d))}return[n,s,o]}let nw=()=>location.protocol+"//"+location.host;function hy(e,t){const{pathname:n,search:s,hash:o}=t,i=e.indexOf("#");if(i>-1){let l=o.includes(e.slice(i))?e.slice(i).length:1,c=o.slice(l);return c[0]!=="/"&&(c="/"+c),Gp(c,"")}return Gp(n,e)+s+o}function ow(e,t,n,s){let o=[],i=[],l=null;const c=({state:g})=>{const k=hy(e,location),b=n.value,x=t.value;let A=0;if(g){if(n.value=k,t.value=g,l&&l===b){l=null;return}A=x?g.position-x.position:0}else s(k);o.forEach(T=>{T(n.value,b,{delta:A,type:Nh.pop,direction:A?A>0?Dd.forward:Dd.back:Dd.unknown})})};function d(){l=n.value}function h(g){o.push(g);const k=()=>{const b=o.indexOf(g);b>-1&&o.splice(b,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:g}=window;if(!g.state)return;g.replaceState(Zt({},g.state,{scroll:Ju()}),"")}}function v(){for(const g of i)g();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:v}}function Kp(e,t,n,s=!1,o=!1){return{back:e,current:t,forward:n,replaced:s,position:window.history.length,scroll:o?Ju():null}}function sw(e){const{history:t,location:n}=window,s={value:hy(e,n)},o={value:t.state};o.value||i(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const v=e.indexOf("#"),g=v>-1?(n.host&&document.querySelector("base")?e:e.slice(v))+d:nw()+e+d;try{t[f?"replaceState":"pushState"](h,"",g),o.value=h}catch(k){console.error(k),n[f?"replace":"assign"](g)}}function l(d,h){i(d,Zt({},t.state,Kp(o.value.back,d,o.value.forward,!0),h,{position:o.value.position}),!0),s.value=d}function c(d,h){const f=Zt({},o.value,t.state,{forward:d,scroll:Ju()});i(f.current,f,!0),i(d,Zt({},Kp(s.value,d,null),{position:f.position+1},h),!1),s.value=d}return{location:s,state:o,push:c,replace:l}}function aw(e){e=Hb(e);const t=sw(e),n=ow(e,t.state,t.location,t.replace);function s(i,l=!0){l||n.pauseListeners(),history.go(i)}const o=Zt({location:"",base:e,go:s,createHref:Gb.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function iw(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),aw(e)}let Zi=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Tn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Tn||{});const lw={type:Zi.Static,value:""},rw=/[a-zA-Z0-9_]/;function cw(e){if(!e)return[[]];if(e==="/")return[[lw]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${n})/"${h}": ${k}`)}let n=Tn.Static,s=n;const o=[];let i;function l(){i&&o.push(i),i=[]}let c=0,d,h="",f="";function v(){h&&(n===Tn.Static?i.push({type:Zi.Static,value:h}):n===Tn.Param||n===Tn.ParamRegExp||n===Tn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Zi.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function g(){h+=d}for(;c<e.length;){if(d=e[c++],d==="\\"&&n!==Tn.ParamRegExp){s=n,n=Tn.EscapeNext;continue}switch(n){case Tn.Static:d==="/"?(h&&v(),l()):d===":"?(v(),n=Tn.Param):g();break;case Tn.EscapeNext:g(),n=s;break;case Tn.Param:d==="("?n=Tn.ParamRegExp:rw.test(d)?g():(v(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--);break;case Tn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:n=Tn.ParamRegExpEnd:f+=d;break;case Tn.ParamRegExpEnd:v(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--,f="";break;default:t("Unknown state");break}}return n===Tn.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),v(),l(),o}const Yp="[^/]+?",uw={sensitive:!1,strict:!1,start:!0,end:!0};var vo=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(vo||{});const dw=/[.+*?^${}()[\]/\\]/g;function hw(e,t){const n=Zt({},uw,t),s=[];let o=n.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[vo.Root];n.strict&&!h.length&&(o+="/");for(let v=0;v<h.length;v++){const g=h[v];let k=vo.Segment+(n.sensitive?vo.BonusCaseSensitive:0);if(g.type===Zi.Static)v||(o+="/"),o+=g.value.replace(dw,"\\$&"),k+=vo.Static;else if(g.type===Zi.Param){const{value:b,repeatable:x,optional:A,regexp:T}=g;i.push({name:b,repeatable:x,optional:A});const w=T||Yp;if(w!==Yp){k+=vo.BonusCustomRegExp;try{`${w}`}catch(I){throw new Error(`Invalid custom RegExp for param "${b}" (${w}): `+I.message)}}let C=x?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;v||(C=A&&h.length<2?`(?:/${C})`:"/"+C),A&&(C+="?"),o+=C,k+=vo.Dynamic,A&&(k+=vo.BonusOptional),x&&(k+=vo.BonusRepeatable),w===".*"&&(k+=vo.BonusWildcard)}f.push(k)}s.push(f)}if(n.strict&&n.end){const h=s.length-1;s[h][s[h].length-1]+=vo.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const l=new RegExp(o,n.sensitive?"":"i");function c(h){const f=h.match(l),v={};if(!f)return null;for(let g=1;g<f.length;g++){const k=f[g]||"",b=i[g-1];v[b.name]=k&&b.repeatable?k.split("/"):k}return v}function d(h){let f="",v=!1;for(const g of e){(!v||!f.endsWith("/"))&&(f+="/"),v=!1;for(const k of g)if(k.type===Zi.Static)f+=k.value;else if(k.type===Zi.Param){const{value:b,repeatable:x,optional:A}=k,T=b in h?h[b]:"";if(Ts(T)&&!x)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const w=Ts(T)?T.join("/"):T;if(!w)if(A)g.length<2&&(f.endsWith("/")?f=f.slice(0,-1):v=!0);else throw new Error(`Missing required param "${b}"`);f+=w}}return f||"/"}return{re:l,score:s,keys:i,parse:c,stringify:d}}function fw(e,t){let n=0;for(;n<e.length&&n<t.length;){const s=t[n]-e[n];if(s)return s;n++}return e.length<t.length?e.length===1&&e[0]===vo.Static+vo.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===vo.Static+vo.Segment?1:-1:0}function fy(e,t){let n=0;const s=e.score,o=t.score;for(;n<s.length&&n<o.length;){const i=fw(s[n],o[n]);if(i)return i;n++}if(Math.abs(o.length-s.length)===1){if(Jp(s))return 1;if(Jp(o))return-1}return o.length-s.length}function Jp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const pw={strict:!1,end:!0,sensitive:!1};function vw(e,t,n){const s=hw(cw(e.path),n),o=Zt(s,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function mw(e,t){const n=[],s=new Map;t=Vp(pw,t);function o(v){return s.get(v)}function i(v,g,k){const b=!k,x=Qp(v);x.aliasOf=k&&k.record;const A=Vp(t,v),T=[x];if("alias"in v){const I=typeof v.alias=="string"?[v.alias]:v.alias;for(const $ of I)T.push(Qp(Zt({},x,{components:k?k.record.components:x.components,path:$,aliasOf:k?k.record:x})))}let w,C;for(const I of T){const{path:$}=I;if(g&&$[0]!=="/"){const R=g.record.path,M=R[R.length-1]==="/"?"":"/";I.path=g.record.path+($&&M+$)}if(w=vw(I,g,A),k?k.alias.push(w):(C=C||w,C!==w&&C.alias.push(w),b&&v.name&&!ev(w)&&l(v.name)),py(w)&&d(w),x.children){const R=x.children;for(let M=0;M<R.length;M++)i(R[M],w,k&&k.children[M])}k=k||w}return C?()=>{l(C)}:Gr}function l(v){if(uy(v)){const g=s.get(v);g&&(s.delete(v),n.splice(n.indexOf(g),1),g.children.forEach(l),g.alias.forEach(l))}else{const g=n.indexOf(v);g>-1&&(n.splice(g,1),v.record.name&&s.delete(v.record.name),v.children.forEach(l),v.alias.forEach(l))}}function c(){return n}function d(v){const g=kw(v,n);n.splice(g,0,v),v.record.name&&!ev(v)&&s.set(v.record.name,v)}function h(v,g){let k,b={},x,A;if("name"in v&&v.name){if(k=s.get(v.name),!k)throw nr(gn.MATCHER_NOT_FOUND,{location:v});A=k.record.name,b=Zt(Xp(g.params,k.keys.filter(C=>!C.optional).concat(k.parent?k.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),v.params&&Xp(v.params,k.keys.map(C=>C.name))),x=k.stringify(b)}else if(v.path!=null)x=v.path,k=n.find(C=>C.re.test(x)),k&&(b=k.parse(x),A=k.record.name);else{if(k=g.name?s.get(g.name):n.find(C=>C.re.test(g.path)),!k)throw nr(gn.MATCHER_NOT_FOUND,{location:v,currentLocation:g});A=k.record.name,b=Zt({},g.params,v.params),x=k.stringify(b)}const T=[];let w=k;for(;w;)T.unshift(w.record),w=w.parent;return{name:A,path:x,params:b,matched:T,meta:yw(T)}}e.forEach(v=>i(v));function f(){n.length=0,s.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:c,getRecordMatcher:o}}function Xp(e,t){const n={};for(const s of t)s in e&&(n[s]=e[s]);return n}function Qp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:gw(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function gw(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const s in e.components)t[s]=typeof n=="object"?n[s]:n;return t}function ev(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function yw(e){return e.reduce((t,n)=>Zt(t,n.meta),{})}function kw(e,t){let n=0,s=t.length;for(;n!==s;){const i=n+s>>1;fy(e,t[i])<0?s=i:n=i+1}const o=bw(e);return o&&(s=t.lastIndexOf(o,s-1)),s}function bw(e){let t=e;for(;t=t.parent;)if(py(t)&&fy(e,t)===0)return t}function py({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function tv(e){const t=$o(Xu),n=$o(Mf),s=H(()=>{const d=N(e.to);return t.resolve(d)}),o=H(()=>{const{matched:d}=s.value,{length:h}=d,f=d[h-1],v=n.matched;if(!f||!v.length)return-1;const g=v.findIndex(tr.bind(null,f));if(g>-1)return g;const k=nv(d[h-2]);return h>1&&nv(f)===k&&v[v.length-1].path!==k?v.findIndex(tr.bind(null,d[h-2])):g}),i=H(()=>o.value>-1&&Iw(n.params,s.value.params)),l=H(()=>o.value>-1&&o.value===n.matched.length-1&&cy(n.params,s.value.params));function c(d={}){if(Lw(d)){const h=t[N(e.replace)?"replace":"push"](N(e.to)).catch(Gr);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:s,href:H(()=>s.value.href),isActive:i,isExactActive:l,navigate:c}}function ww(e){return e.length===1?e[0]:e}const _w=kg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:tv,setup(e,{slots:t}){const n=ol(tv(e)),{options:s}=$o(Xu),o=H(()=>({[ov(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[ov(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&ww(t.default(n));return e.custom?i:xf("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),Cw=_w;function Lw(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Iw(e,t){for(const n in t){const s=t[n],o=e[n];if(typeof s=="string"){if(s!==o)return!1}else if(!Ts(o)||o.length!==s.length||s.some((i,l)=>i.valueOf()!==o[l].valueOf()))return!1}return!0}function nv(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ov=(e,t,n)=>e??t??n,Sw=kg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=$o(Uh),o=H(()=>e.route||s.value),i=$o(Zp,0),l=H(()=>{let h=N(i);const{matched:f}=o.value;let v;for(;(v=f[h])&&!v.components;)h++;return h}),c=H(()=>o.value.matched[l.value]);Br(Zp,H(()=>l.value+1)),Br(ew,c),Br(Uh,o);const d=D();return Ye(()=>[d.value,c.value,e.name],([h,f,v],[g,k,b])=>{f&&(f.instances[v]=h,k&&k!==f&&h&&h===g&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!tr(f,k)||!g)&&(f.enterCallbacks[v]||[]).forEach(x=>x(h))},{flush:"post"}),()=>{const h=o.value,f=e.name,v=c.value,g=v&&v.components[f];if(!g)return sv(n.default,{Component:g,route:h});const k=v.props[f],b=k?k===!0?h.params:typeof k=="function"?k(h):k:null,A=xf(g,Zt({},b,t,{onVnodeUnmounted:T=>{T.component.isUnmounted&&(v.instances[f]=null)},ref:d}));return sv(n.default,{Component:A,route:h})||A}}});function sv(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const xw=Sw;function $w(e){const t=mw(e.routes,e),n=e.parseQuery||Xb,s=e.stringifyQuery||Wp,o=e.history,i=Lr(),l=Lr(),c=Lr(),d=_k(Ya);let h=Ya;zl&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ed.bind(null,z=>""+z),v=Ed.bind(null,Rb),g=Ed.bind(null,ic);function k(z,Y){let de,ie;return uy(z)?(de=t.getRecordMatcher(z),ie=Y):ie=z,t.addRoute(ie,de)}function b(z){const Y=t.getRecordMatcher(z);Y&&t.removeRoute(Y)}function x(){return t.getRoutes().map(z=>z.record)}function A(z){return!!t.getRecordMatcher(z)}function T(z,Y){if(Y=Zt({},Y||d.value),typeof z=="string"){const te=Pd(n,z,Y.path),Ce=t.resolve({path:te.path},Y),Ne=o.createHref(te.fullPath);return Zt(te,Ce,{params:g(Ce.params),hash:ic(te.hash),redirectedFrom:void 0,href:Ne})}let de;if(z.path!=null)de=Zt({},z,{path:Pd(n,z.path,Y.path).path});else{const te=Zt({},z.params);for(const Ce in te)te[Ce]==null&&delete te[Ce];de=Zt({},z,{params:v(te)}),Y.params=v(Y.params)}const ie=t.resolve(de,Y),Ae=z.hash||"";ie.params=f(g(ie.params));const G=Nb(s,Zt({},z,{hash:Eb(Ae),path:ie.path})),X=o.createHref(G);return Zt({fullPath:G,hash:Ae,query:s===Wp?Qb(z.query):z.query||{}},ie,{redirectedFrom:void 0,href:X})}function w(z){return typeof z=="string"?Pd(n,z,d.value.path):Zt({},z)}function C(z,Y){if(h!==z)return nr(gn.NAVIGATION_CANCELLED,{from:Y,to:z})}function I(z){return M(z)}function $(z){return I(Zt(w(z),{replace:!0}))}function R(z,Y){const de=z.matched[z.matched.length-1];if(de&&de.redirect){const{redirect:ie}=de;let Ae=typeof ie=="function"?ie(z,Y):ie;return typeof Ae=="string"&&(Ae=Ae.includes("?")||Ae.includes("#")?Ae=w(Ae):{path:Ae},Ae.params={}),Zt({query:z.query,hash:z.hash,params:Ae.path!=null?{}:z.params},Ae)}}function M(z,Y){const de=h=T(z),ie=d.value,Ae=z.state,G=z.force,X=z.replace===!0,te=R(de,ie);if(te)return M(Zt(w(te),{state:typeof te=="object"?Zt({},Ae,te.state):Ae,force:G,replace:X}),Y||de);const Ce=de;Ce.redirectedFrom=Y;let Ne;return!G&&Fb(s,ie,de)&&(Ne=nr(gn.NAVIGATION_DUPLICATED,{to:Ce,from:ie}),ue(ie,ie,!0,!1)),(Ne?Promise.resolve(Ne):U(Ce,ie)).catch(Fe=>ca(Fe)?ca(Fe,gn.NAVIGATION_GUARD_REDIRECT)?Fe:ee(Fe):q(Fe,Ce,ie)).then(Fe=>{if(Fe){if(ca(Fe,gn.NAVIGATION_GUARD_REDIRECT))return M(Zt({replace:X},w(Fe.to),{state:typeof Fe.to=="object"?Zt({},Ae,Fe.to.state):Ae,force:G}),Y||Ce)}else Fe=j(Ce,ie,!0,X,Ae);return F(Ce,ie,Fe),Fe})}function O(z,Y){const de=C(z,Y);return de?Promise.reject(de):Promise.resolve()}function E(z){const Y=De.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(z):z()}function U(z,Y){let de;const[ie,Ae,G]=tw(z,Y);de=Rd(ie.reverse(),"beforeRouteLeave",z,Y);for(const te of ie)te.leaveGuards.forEach(Ce=>{de.push(oi(Ce,z,Y))});const X=O.bind(null,z,Y);return de.push(X),be(de).then(()=>{de=[];for(const te of i.list())de.push(oi(te,z,Y));return de.push(X),be(de)}).then(()=>{de=Rd(Ae,"beforeRouteUpdate",z,Y);for(const te of Ae)te.updateGuards.forEach(Ce=>{de.push(oi(Ce,z,Y))});return de.push(X),be(de)}).then(()=>{de=[];for(const te of G)if(te.beforeEnter)if(Ts(te.beforeEnter))for(const Ce of te.beforeEnter)de.push(oi(Ce,z,Y));else de.push(oi(te.beforeEnter,z,Y));return de.push(X),be(de)}).then(()=>(z.matched.forEach(te=>te.enterCallbacks={}),de=Rd(G,"beforeRouteEnter",z,Y,E),de.push(X),be(de))).then(()=>{de=[];for(const te of l.list())de.push(oi(te,z,Y));return de.push(X),be(de)}).catch(te=>ca(te,gn.NAVIGATION_CANCELLED)?te:Promise.reject(te))}function F(z,Y,de){c.list().forEach(ie=>E(()=>ie(z,Y,de)))}function j(z,Y,de,ie,Ae){const G=C(z,Y);if(G)return G;const X=Y===Ya,te=zl?history.state:{};de&&(ie||X?o.replace(z.fullPath,Zt({scroll:X&&te&&te.scroll},Ae)):o.push(z.fullPath,Ae)),d.value=z,ue(z,Y,de,X),ee()}let Z;function Q(){Z||(Z=o.listen((z,Y,de)=>{if(!Re.listening)return;const ie=T(z),Ae=R(ie,Re.currentRoute.value);if(Ae){M(Zt(Ae,{replace:!0,force:!0}),ie).catch(Gr);return}h=ie;const G=d.value;zl&&Wb(jp(G.fullPath,de.delta),Ju()),U(ie,G).catch(X=>ca(X,gn.NAVIGATION_ABORTED|gn.NAVIGATION_CANCELLED)?X:ca(X,gn.NAVIGATION_GUARD_REDIRECT)?(M(Zt(w(X.to),{force:!0}),ie).then(te=>{ca(te,gn.NAVIGATION_ABORTED|gn.NAVIGATION_DUPLICATED)&&!de.delta&&de.type===Nh.pop&&o.go(-1,!1)}).catch(Gr),Promise.reject()):(de.delta&&o.go(-de.delta,!1),q(X,ie,G))).then(X=>{X=X||j(ie,G,!1),X&&(de.delta&&!ca(X,gn.NAVIGATION_CANCELLED)?o.go(-de.delta,!1):de.type===Nh.pop&&ca(X,gn.NAVIGATION_ABORTED|gn.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),F(ie,G,X)}).catch(Gr)}))}let re=Lr(),K=Lr(),ae;function q(z,Y,de){ee(z);const ie=K.list();return ie.length?ie.forEach(Ae=>Ae(z,Y,de)):console.error(z),Promise.reject(z)}function J(){return ae&&d.value!==Ya?Promise.resolve():new Promise((z,Y)=>{re.add([z,Y])})}function ee(z){return ae||(ae=!z,Q(),re.list().forEach(([Y,de])=>z?de(z):Y()),re.reset()),z}function ue(z,Y,de,ie){const{scrollBehavior:Ae}=e;if(!zl||!Ae)return Promise.resolve();const G=!de&&Zb(jp(z.fullPath,0))||(ie||!de)&&history.state&&history.state.scroll||null;return cn().then(()=>Ae(z,Y,G)).then(X=>X&&jb(X)).catch(X=>q(X,z,Y))}const _e=z=>o.go(z);let $e;const De=new Set,Re={currentRoute:d,listening:!0,addRoute:k,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:A,getRoutes:x,resolve:T,options:e,push:I,replace:$,go:_e,back:()=>_e(-1),forward:()=>_e(1),beforeEach:i.add,beforeResolve:l.add,afterEach:c.add,onError:K.add,isReady:J,install(z){z.component("RouterLink",Cw),z.component("RouterView",xw),z.config.globalProperties.$router=Re,Object.defineProperty(z.config.globalProperties,"$route",{enumerable:!0,get:()=>N(d)}),zl&&!$e&&d.value===Ya&&($e=!0,I(o.location).catch(ie=>{}));const Y={};for(const ie in Ya)Object.defineProperty(Y,ie,{get:()=>d.value[ie],enumerable:!0});z.provide(Xu,Re),z.provide(Mf,eg(Y)),z.provide(Uh,d);const de=z.unmount;De.add(z),z.unmount=function(){De.delete(z),De.size<1&&(h=Ya,Z&&Z(),Z=null,d.value=Ya,$e=!1,ae=!1),de()}}};function be(z){return z.reduce((Y,de)=>Y.then(()=>E(de)),Promise.resolve())}return Re}function ir(){return $o(Xu)}function Qu(e){return $o(Mf)}const Tw=500,Mw=3e3,Aw=500,ai=D(new Map),ed=D(!1),lc=D(""),Af=D(!1);let Ew=0,qr=null;function Pw(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:Tw,isSaving:!0}:{message:"Loading...",delay:Mw,isSaving:!1}}function Dw(){qr&&(clearTimeout(qr),qr=null)}function Rw(e){if(e.skipLoadingOverlay)return null;Dw();const t=++Ew,{message:n,delay:s,isSaving:o}=Pw(e.method),i=o?setTimeout(()=>{ai.value.has(t)&&(lc.value=n,ed.value=!0)},s):null,l=setTimeout(()=>{ai.value.has(t)&&(Af.value=!0)},s);return ai.value.set(t,{config:e,message:n,isSaving:o,overlayTimeoutId:i,disableInputsTimeoutId:l}),e._loadingRequestId=t,t}function av(e){if(e===null)return;const t=ai.value.get(e);if(t){if(t.overlayTimeoutId&&clearTimeout(t.overlayTimeoutId),t.disableInputsTimeoutId&&clearTimeout(t.disableInputsTimeoutId),ai.value.delete(e),ai.value.size===0)qr=setTimeout(()=>{ai.value.size===0&&(ed.value=!1,lc.value="",Af.value=!1),qr=null},Aw);else for(const n of ai.value.values())if(n.isSaving){lc.value=n.message;break}}}function iv(e){return e?._loadingRequestId}const Ow=H(()=>ed.value&&lc.value==="Saving...");function vy(){return{showOverlay:ed,overlayMessage:lc,isSaving:Ow,shouldDisableInputs:Af}}const Ke=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},Bw={key:0,class:"loading-overlay"},Nw={class:"loading-content"},Fw={class:"loading-message"},Uw={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:n}=vy();return(s,o)=>(p(),Ge(Ls,{name:"fade"},{default:Ve(()=>[N(t)?(p(),y("div",Bw,[r("div",Nw,[o[0]||(o[0]=r("div",{class:"spinner"},null,-1)),r("p",Fw,_(N(n)||"Loading..."),1)])])):P("",!0)]),_:1}))}},zw=Ke(Uw,[["__scopeId","data-v-fdee3530"]]),Hw={__name:"App",setup(e){const t=ir(),{shouldDisableInputs:n}=vy();Bk(()=>{n.value?document.body.classList.add("has-network-activity"):document.body.classList.remove("has-network-activity")});const s=D(""),o=["/","/sessions"];return Ye(()=>t.currentRoute.value,(i,l)=>{if(!l?.path){s.value="";return}const c=o.indexOf(i.path),d=o.indexOf(l.path);c!==-1&&d!==-1?s.value=c>d?"slide-left":"slide-right":s.value=""},{immediate:!0}),(i,l)=>{const c=wf("router-view");return p(),y(Ie,null,[Pe(c,null,{default:Ve(({Component:d,route:h})=>[Pe(Ls,{name:s.value,mode:"out-in"},{default:Ve(()=>[(p(),Ge(Xk(d),{key:h.path}))]),_:2},1032,["name"])]),_:1}),Pe(zw)],64)}}},lr="marshalSessions",Vw=30;function ku(e,t){return`${e}:${t}`}function Ef(e){const[t,n]=e.split(":");return{eventId:t,marshalId:n}}function ki(){try{return JSON.parse(localStorage.getItem(lr)||"{}")}catch{return{}}}function bu(e){const t=ki(),n=Object.entries(t).filter(([s])=>s.startsWith(`${e}:`)).map(([s,o])=>({sessionKey:s,...o}));return n.length===0?null:(n.sort((s,o)=>new Date(o.lastAccessed)-new Date(s.lastAccessed)),n[0])}function lv(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const n=ki(),s=ku(e,t.marshalId);n[s]={...n[s],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(lr,JSON.stringify(n))}function zh(e){const t=ki(),{eventId:n,marshalId:s}=Ef(e);delete t[e],localStorage.setItem(lr,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${n}_${s}`)}function my(e,t){const n=ki(),s=ku(e,t);n[s]&&(n[s].lastAccessed=new Date().toISOString(),localStorage.setItem(lr,JSON.stringify(n)))}function gy(){const e=ki(),t=new Date;t.setDate(t.getDate()-Vw);let n=!1;for(const s of Object.keys(e))if(new Date(e[s].lastAccessed)<t){const{eventId:i,marshalId:l}=Ef(s);delete e[s],localStorage.removeItem(`marshalCode_${i}_${l}`),n=!0}n&&localStorage.setItem(lr,JSON.stringify(e))}function yy(){const e=ki(),t=[];for(let s=0;s<localStorage.length;s++){const o=localStorage.key(s);if(o&&o.startsWith("marshal_")&&!o.startsWith("marshalCode_")&&!o.startsWith("marshalSessions")){const i=o.replace("marshal_",""),l=localStorage.getItem(o);if(l){const c=ku(i,l);e[c]||(e[c]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(o)}}const n=Object.keys(e).filter(s=>!s.includes(":"));for(const s of n){const o=e[s];if(o&&o.marshalId){const i=ku(s,o.marshalId);e[i]||(e[i]={...o,eventId:s}),delete e[s]}}(t.length>0||n.length>0)&&(localStorage.setItem(lr,JSON.stringify(e)),t.forEach(s=>localStorage.removeItem(s)))}function Gw(){const e=ki();return Object.entries(e).map(([t,n])=>{const{eventId:s,marshalId:o}=Ef(t);return{sessionKey:t,eventId:s,marshalId:o,...n}}).filter(t=>t.token).sort((t,n)=>t.eventDate&&n.eventDate?new Date(t.eventDate)-new Date(n.eventDate):new Date(n.lastAccessed)-new Date(t.lastAccessed))}function ky(){const e=ki();return Object.values(e).some(t=>t.token)}function by(e,t){const n=`marshalCode_${e}_${t}`,s=localStorage.getItem(n);return s||localStorage.getItem(`marshalCode_${e}`)}function qw(e,t,n){localStorage.setItem(`marshalCode_${e}_${t}`,n)}function wy(e,t){return function(){return e.apply(t,arguments)}}const{toString:jw}=Object.prototype,{getPrototypeOf:Pf}=Object,{iterator:td,toStringTag:_y}=Symbol,nd=(e=>t=>{const n=jw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ms=e=>(e=e.toLowerCase(),t=>nd(t)===e),od=e=>t=>typeof t===e,{isArray:rr}=Array,or=od("undefined");function fc(e){return e!==null&&!or(e)&&e.constructor!==null&&!or(e.constructor)&&To(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Cy=Ms("ArrayBuffer");function Ww(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Cy(e.buffer),t}const Zw=od("string"),To=od("function"),Ly=od("number"),pc=e=>e!==null&&typeof e=="object",Kw=e=>e===!0||e===!1,Xc=e=>{if(nd(e)!=="object")return!1;const t=Pf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(_y in e)&&!(td in e)},Yw=e=>{if(!pc(e)||fc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Jw=Ms("Date"),Xw=Ms("File"),Qw=Ms("Blob"),e_=Ms("FileList"),t_=e=>pc(e)&&To(e.pipe),n_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||To(e.append)&&((t=nd(e))==="formdata"||t==="object"&&To(e.toString)&&e.toString()==="[object FormData]"))},o_=Ms("URLSearchParams"),[s_,a_,i_,l_]=["ReadableStream","Request","Response","Headers"].map(Ms),r_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),rr(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(fc(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let c;for(s=0;s<l;s++)c=i[s],t.call(null,e[c],c,e)}}function Iy(e,t){if(fc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Sy=e=>!or(e)&&e!==Ki;function Hh(){const{caseless:e,skipUndefined:t}=Sy(this)&&this||{},n={},s=(o,i)=>{const l=e&&Iy(n,i)||i;Xc(n[l])&&Xc(o)?n[l]=Hh(n[l],o):Xc(o)?n[l]=Hh({},o):rr(o)?n[l]=o.slice():(!t||!or(o))&&(n[l]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&vc(arguments[o],s);return n}const c_=(e,t,n,{allOwnKeys:s}={})=>(vc(t,(o,i)=>{n&&To(o)?e[i]=wy(o,n):e[i]=o},{allOwnKeys:s}),e),u_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),d_=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},h_=(e,t,n,s)=>{let o,i,l;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)l=o[i],(!s||s(l,e,t))&&!c[l]&&(t[l]=e[l],c[l]=!0);e=n!==!1&&Pf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},f_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},p_=e=>{if(!e)return null;if(rr(e))return e;let t=e.length;if(!Ly(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},v_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Pf(Uint8Array)),m_=(e,t)=>{const s=(e&&e[td]).call(e);let o;for(;(o=s.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},g_=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},y_=Ms("HTMLFormElement"),k_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),rv=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),b_=Ms("RegExp"),xy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};vc(n,(o,i)=>{let l;(l=t(o,i,e))!==!1&&(s[i]=l||o)}),Object.defineProperties(e,s)},w_=e=>{xy(e,(t,n)=>{if(To(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(To(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},__=(e,t)=>{const n={},s=o=>{o.forEach(i=>{n[i]=!0})};return rr(e)?s(e):s(String(e).split(t)),n},C_=()=>{},L_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function I_(e){return!!(e&&To(e.append)&&e[_y]==="FormData"&&e[td])}const S_=e=>{const t=new Array(10),n=(s,o)=>{if(pc(s)){if(t.indexOf(s)>=0)return;if(fc(s))return s;if(!("toJSON"in s)){t[o]=s;const i=rr(s)?[]:{};return vc(s,(l,c)=>{const d=n(l,o+1);!or(d)&&(i[c]=d)}),t[o]=void 0,i}}return s};return n(e,0)},x_=Ms("AsyncFunction"),$_=e=>e&&(pc(e)||To(e))&&To(e.then)&&To(e.catch),$y=((e,t)=>e?setImmediate:t?((n,s)=>(Ki.addEventListener("message",({source:o,data:i})=>{o===Ki&&i===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Ki.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",To(Ki.postMessage)),T_=typeof queueMicrotask<"u"?queueMicrotask.bind(Ki):typeof process<"u"&&process.nextTick||$y,M_=e=>e!=null&&To(e[td]),ze={isArray:rr,isArrayBuffer:Cy,isBuffer:fc,isFormData:n_,isArrayBufferView:Ww,isString:Zw,isNumber:Ly,isBoolean:Kw,isObject:pc,isPlainObject:Xc,isEmptyObject:Yw,isReadableStream:s_,isRequest:a_,isResponse:i_,isHeaders:l_,isUndefined:or,isDate:Jw,isFile:Xw,isBlob:Qw,isRegExp:b_,isFunction:To,isStream:t_,isURLSearchParams:o_,isTypedArray:v_,isFileList:e_,forEach:vc,merge:Hh,extend:c_,trim:r_,stripBOM:u_,inherits:d_,toFlatObject:h_,kindOf:nd,kindOfTest:Ms,endsWith:f_,toArray:p_,forEachEntry:m_,matchAll:g_,isHTMLForm:y_,hasOwnProperty:rv,hasOwnProp:rv,reduceDescriptors:xy,freezeMethods:w_,toObjectSet:__,toCamelCase:k_,noop:C_,toFiniteNumber:L_,findKey:Iy,global:Ki,isContextDefined:Sy,isSpecCompliantForm:I_,toJSONObject:S_,isAsyncFn:x_,isThenable:$_,setImmediate:$y,asap:T_,isIterable:M_};function St(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}ze.inherits(St,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ze.toJSONObject(this.config),code:this.code,status:this.status}}});const Ty=St.prototype,My={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{My[e]={value:e}});Object.defineProperties(St,My);Object.defineProperty(Ty,"isAxiosError",{value:!0});St.from=(e,t,n,s,o,i)=>{const l=Object.create(Ty);ze.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const c=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return St.call(l,c,d,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const A_=null;function Vh(e){return ze.isPlainObject(e)||ze.isArray(e)}function Ay(e){return ze.endsWith(e,"[]")?e.slice(0,-2):e}function cv(e,t,n){return e?e.concat(t).map(function(o,i){return o=Ay(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function E_(e){return ze.isArray(e)&&!e.some(Vh)}const P_=ze.toFlatObject(ze,{},null,function(t){return/^is[A-Z]/.test(t)});function sd(e,t,n){if(!ze.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ze.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,A){return!ze.isUndefined(A[x])});const s=n.metaTokens,o=n.visitor||f,i=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&ze.isSpecCompliantForm(t);if(!ze.isFunction(o))throw new TypeError("visitor must be a function");function h(b){if(b===null)return"";if(ze.isDate(b))return b.toISOString();if(ze.isBoolean(b))return b.toString();if(!d&&ze.isBlob(b))throw new St("Blob is not supported. Use a Buffer instead.");return ze.isArrayBuffer(b)||ze.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function f(b,x,A){let T=b;if(b&&!A&&typeof b=="object"){if(ze.endsWith(x,"{}"))x=s?x:x.slice(0,-2),b=JSON.stringify(b);else if(ze.isArray(b)&&E_(b)||(ze.isFileList(b)||ze.endsWith(x,"[]"))&&(T=ze.toArray(b)))return x=Ay(x),T.forEach(function(C,I){!(ze.isUndefined(C)||C===null)&&t.append(l===!0?cv([x],I,i):l===null?x:x+"[]",h(C))}),!1}return Vh(b)?!0:(t.append(cv(A,x,i),h(b)),!1)}const v=[],g=Object.assign(P_,{defaultVisitor:f,convertValue:h,isVisitable:Vh});function k(b,x){if(!ze.isUndefined(b)){if(v.indexOf(b)!==-1)throw Error("Circular reference detected in "+x.join("."));v.push(b),ze.forEach(b,function(T,w){(!(ze.isUndefined(T)||T===null)&&o.call(t,T,ze.isString(w)?w.trim():w,x,g))===!0&&k(T,x?x.concat(w):[w])}),v.pop()}}if(!ze.isObject(e))throw new TypeError("data must be an object");return k(e),t}function uv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Df(e,t){this._pairs=[],e&&sd(e,this,t)}const Ey=Df.prototype;Ey.append=function(t,n){this._pairs.push([t,n])};Ey.toString=function(t){const n=t?function(s){return t.call(this,s,uv)}:uv;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function D_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Py(e,t,n){if(!t)return e;const s=n&&n.encode||D_;ze.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(t,n):i=ze.isURLSearchParams(t)?t.toString():new Df(t,n).toString(s),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class dv{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ze.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Dy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},R_=typeof URLSearchParams<"u"?URLSearchParams:Df,O_=typeof FormData<"u"?FormData:null,B_=typeof Blob<"u"?Blob:null,N_={isBrowser:!0,classes:{URLSearchParams:R_,FormData:O_,Blob:B_},protocols:["http","https","file","blob","url","data"]},Rf=typeof window<"u"&&typeof document<"u",Gh=typeof navigator=="object"&&navigator||void 0,F_=Rf&&(!Gh||["ReactNative","NativeScript","NS"].indexOf(Gh.product)<0),U_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",z_=Rf&&window.location.href||"http://localhost",H_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rf,hasStandardBrowserEnv:F_,hasStandardBrowserWebWorkerEnv:U_,navigator:Gh,origin:z_},Symbol.toStringTag,{value:"Module"})),oo={...H_,...N_};function V_(e,t){return sd(e,new oo.classes.URLSearchParams,{visitor:function(n,s,o,i){return oo.isNode&&ze.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function G_(e){return ze.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function q_(e){const t={},n=Object.keys(e);let s;const o=n.length;let i;for(s=0;s<o;s++)i=n[s],t[i]=e[i];return t}function Ry(e){function t(n,s,o,i){let l=n[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=i>=n.length;return l=!l&&ze.isArray(o)?o.length:l,d?(ze.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!c):((!o[l]||!ze.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],i)&&ze.isArray(o[l])&&(o[l]=q_(o[l])),!c)}if(ze.isFormData(e)&&ze.isFunction(e.entries)){const n={};return ze.forEachEntry(e,(s,o)=>{t(G_(s),o,n,0)}),n}return null}function j_(e,t,n){if(ze.isString(e))try{return(t||JSON.parse)(e),ze.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const mc={transitional:Dy,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,i=ze.isObject(t);if(i&&ze.isHTMLForm(t)&&(t=new FormData(t)),ze.isFormData(t))return o?JSON.stringify(Ry(t)):t;if(ze.isArrayBuffer(t)||ze.isBuffer(t)||ze.isStream(t)||ze.isFile(t)||ze.isBlob(t)||ze.isReadableStream(t))return t;if(ze.isArrayBufferView(t))return t.buffer;if(ze.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return V_(t,this.formSerializer).toString();if((c=ze.isFileList(t))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return sd(c?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),j_(t)):t}],transformResponse:[function(t){const n=this.transitional||mc.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(ze.isResponse(t)||ze.isReadableStream(t))return t;if(t&&ze.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?St.from(c,St.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oo.classes.FormData,Blob:oo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ze.forEach(["delete","get","head","post","put","patch"],e=>{mc.headers[e]={}});const W_=ze.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Z_=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&W_[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},hv=Symbol("internals");function Ir(e){return e&&String(e).trim().toLowerCase()}function Qc(e){return e===!1||e==null?e:ze.isArray(e)?e.map(Qc):String(e)}function K_(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const Y_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Od(e,t,n,s,o){if(ze.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!ze.isString(t)){if(ze.isString(s))return t.indexOf(s)!==-1;if(ze.isRegExp(s))return s.test(t)}}function J_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function X_(e,t){const n=ze.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,i,l){return this[s].call(this,t,o,i,l)},configurable:!0})})}let Mo=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function i(c,d,h){const f=Ir(d);if(!f)throw new Error("header name must be a non-empty string");const v=ze.findKey(o,f);(!v||o[v]===void 0||h===!0||h===void 0&&o[v]!==!1)&&(o[v||d]=Qc(c))}const l=(c,d)=>ze.forEach(c,(h,f)=>i(h,f,d));if(ze.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(ze.isString(t)&&(t=t.trim())&&!Y_(t))l(Z_(t),n);else if(ze.isObject(t)&&ze.isIterable(t)){let c={},d,h;for(const f of t){if(!ze.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[h=f[0]]=(d=c[h])?ze.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(c,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=Ir(t),t){const s=ze.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return K_(o);if(ze.isFunction(n))return n.call(this,o,s);if(ze.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ir(t),t){const s=ze.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Od(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function i(l){if(l=Ir(l),l){const c=ze.findKey(s,l);c&&(!n||Od(s,s[c],c,n))&&(delete s[c],o=!0)}}return ze.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const i=n[s];(!t||Od(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,s={};return ze.forEach(this,(o,i)=>{const l=ze.findKey(s,i);if(l){n[l]=Qc(o),delete n[i];return}const c=t?J_(i):String(i).trim();c!==i&&delete n[i],n[c]=Qc(o),s[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ze.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&ze.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[hv]=this[hv]={accessors:{}}).accessors,o=this.prototype;function i(l){const c=Ir(l);s[c]||(X_(o,l),s[c]=!0)}return ze.isArray(t)?t.forEach(i):i(t),this}};Mo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ze.reduceDescriptors(Mo.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});ze.freezeMethods(Mo);function Bd(e,t){const n=this||mc,s=t||n,o=Mo.from(s.headers);let i=s.data;return ze.forEach(e,function(c){i=c.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Oy(e){return!!(e&&e.__CANCEL__)}function cr(e,t,n){St.call(this,e??"canceled",St.ERR_CANCELED,t,n),this.name="CanceledError"}ze.inherits(cr,St,{__CANCEL__:!0});function By(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new St("Request failed with status code "+n.status,[St.ERR_BAD_REQUEST,St.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Q_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function eC(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=s[i];l||(l=h),n[o]=d,s[o]=h;let v=i,g=0;for(;v!==o;)g+=n[v++],v=v%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(g*1e3/k):void 0}}function tC(e,t){let n=0,s=1e3/t,o,i;const l=(h,f=Date.now())=>{n=f,o=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),v=f-n;v>=s?l(h,f):(o=h,i||(i=setTimeout(()=>{i=null,l(o)},s-v)))},()=>o&&l(o)]}const wu=(e,t,n=3)=>{let s=0;const o=eC(50,250);return tC(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,d=l-s,h=o(d),f=l<=c;s=l;const v={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:h||void 0,estimated:h&&c&&f?(c-l)/h:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(v)},n)},fv=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},pv=e=>(...t)=>ze.asap(()=>e(...t)),nC=oo.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,oo.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(oo.origin),oo.navigator&&/(msie|trident)/i.test(oo.navigator.userAgent)):()=>!0,oC=oo.hasStandardBrowserEnv?{write(e,t,n,s,o,i,l){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];ze.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),ze.isString(s)&&c.push(`path=${s}`),ze.isString(o)&&c.push(`domain=${o}`),i===!0&&c.push("secure"),ze.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function sC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function aC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ny(e,t,n){let s=!sC(t);return e&&(s||n==!1)?aC(e,t):t}const vv=e=>e instanceof Mo?{...e}:e;function tl(e,t){t=t||{};const n={};function s(h,f,v,g){return ze.isPlainObject(h)&&ze.isPlainObject(f)?ze.merge.call({caseless:g},h,f):ze.isPlainObject(f)?ze.merge({},f):ze.isArray(f)?f.slice():f}function o(h,f,v,g){if(ze.isUndefined(f)){if(!ze.isUndefined(h))return s(void 0,h,v,g)}else return s(h,f,v,g)}function i(h,f){if(!ze.isUndefined(f))return s(void 0,f)}function l(h,f){if(ze.isUndefined(f)){if(!ze.isUndefined(h))return s(void 0,h)}else return s(void 0,f)}function c(h,f,v){if(v in t)return s(h,f);if(v in e)return s(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(h,f,v)=>o(vv(h),vv(f),v,!0)};return ze.forEach(Object.keys({...e,...t}),function(f){const v=d[f]||o,g=v(e[f],t[f],f);ze.isUndefined(g)&&v!==c||(n[f]=g)}),n}const Fy=e=>{const t=tl({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:i,headers:l,auth:c}=t;if(t.headers=l=Mo.from(l),t.url=Py(Ny(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),ze.isFormData(n)){if(oo.hasStandardBrowserEnv||oo.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ze.isFunction(n.getHeaders)){const d=n.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,v])=>{h.includes(f.toLowerCase())&&l.set(f,v)})}}if(oo.hasStandardBrowserEnv&&(s&&ze.isFunction(s)&&(s=s(t)),s||s!==!1&&nC(t.url))){const d=o&&i&&oC.read(i);d&&l.set(o,d)}return t},iC=typeof XMLHttpRequest<"u",lC=iC&&function(e){return new Promise(function(n,s){const o=Fy(e);let i=o.data;const l=Mo.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:h}=o,f,v,g,k,b;function x(){k&&k(),b&&b(),o.cancelToken&&o.cancelToken.unsubscribe(f),o.signal&&o.signal.removeEventListener("abort",f)}let A=new XMLHttpRequest;A.open(o.method.toUpperCase(),o.url,!0),A.timeout=o.timeout;function T(){if(!A)return;const C=Mo.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders()),$={data:!c||c==="text"||c==="json"?A.responseText:A.response,status:A.status,statusText:A.statusText,headers:C,config:e,request:A};By(function(M){n(M),x()},function(M){s(M),x()},$),A=null}"onloadend"in A?A.onloadend=T:A.onreadystatechange=function(){!A||A.readyState!==4||A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0)||setTimeout(T)},A.onabort=function(){A&&(s(new St("Request aborted",St.ECONNABORTED,e,A)),A=null)},A.onerror=function(I){const $=I&&I.message?I.message:"Network Error",R=new St($,St.ERR_NETWORK,e,A);R.event=I||null,s(R),A=null},A.ontimeout=function(){let I=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const $=o.transitional||Dy;o.timeoutErrorMessage&&(I=o.timeoutErrorMessage),s(new St(I,$.clarifyTimeoutError?St.ETIMEDOUT:St.ECONNABORTED,e,A)),A=null},i===void 0&&l.setContentType(null),"setRequestHeader"in A&&ze.forEach(l.toJSON(),function(I,$){A.setRequestHeader($,I)}),ze.isUndefined(o.withCredentials)||(A.withCredentials=!!o.withCredentials),c&&c!=="json"&&(A.responseType=o.responseType),h&&([g,b]=wu(h,!0),A.addEventListener("progress",g)),d&&A.upload&&([v,k]=wu(d),A.upload.addEventListener("progress",v),A.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(f=C=>{A&&(s(!C||C.type?new cr(null,e,A):C),A.abort(),A=null)},o.cancelToken&&o.cancelToken.subscribe(f),o.signal&&(o.signal.aborted?f():o.signal.addEventListener("abort",f)));const w=Q_(o.url);if(w&&oo.protocols.indexOf(w)===-1){s(new St("Unsupported protocol "+w+":",St.ERR_BAD_REQUEST,e));return}A.send(i||null)})},rC=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const i=function(h){if(!o){o=!0,c();const f=h instanceof Error?h:this.reason;s.abort(f instanceof St?f:new cr(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new St(`timeout ${t} of ms exceeded`,St.ETIMEDOUT))},t);const c=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=s;return d.unsubscribe=()=>ze.asap(c),d}},cC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},uC=async function*(e,t){for await(const n of dC(e))yield*cC(n,t)},dC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},mv=(e,t,n,s)=>{const o=uC(e,t);let i=0,l,c=d=>{l||(l=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await o.next();if(h){c(),d.close();return}let v=f.byteLength;if(n){let g=i+=v;n(g)}d.enqueue(new Uint8Array(f))}catch(h){throw c(h),h}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},gv=64*1024,{isFunction:Fc}=ze,hC=(({Request:e,Response:t})=>({Request:e,Response:t}))(ze.global),{ReadableStream:yv,TextEncoder:kv}=ze.global,bv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},fC=e=>{e=ze.merge.call({skipUndefined:!0},hC,e);const{fetch:t,Request:n,Response:s}=e,o=t?Fc(t):typeof fetch=="function",i=Fc(n),l=Fc(s);if(!o)return!1;const c=o&&Fc(yv),d=o&&(typeof kv=="function"?(b=>x=>b.encode(x))(new kv):async b=>new Uint8Array(await new n(b).arrayBuffer())),h=i&&c&&bv(()=>{let b=!1;const x=new n(oo.origin,{body:new yv,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!x}),f=l&&c&&bv(()=>ze.isReadableStream(new s("").body)),v={stream:f&&(b=>b.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!v[b]&&(v[b]=(x,A)=>{let T=x&&x[b];if(T)return T.call(x);throw new St(`Response type '${b}' is not supported`,St.ERR_NOT_SUPPORT,A)})});const g=async b=>{if(b==null)return 0;if(ze.isBlob(b))return b.size;if(ze.isSpecCompliantForm(b))return(await new n(oo.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(ze.isArrayBufferView(b)||ze.isArrayBuffer(b))return b.byteLength;if(ze.isURLSearchParams(b)&&(b=b+""),ze.isString(b))return(await d(b)).byteLength},k=async(b,x)=>{const A=ze.toFiniteNumber(b.getContentLength());return A??g(x)};return async b=>{let{url:x,method:A,data:T,signal:w,cancelToken:C,timeout:I,onDownloadProgress:$,onUploadProgress:R,responseType:M,headers:O,withCredentials:E="same-origin",fetchOptions:U}=Fy(b),F=t||fetch;M=M?(M+"").toLowerCase():"text";let j=rC([w,C&&C.toAbortSignal()],I),Z=null;const Q=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let re;try{if(R&&h&&A!=="get"&&A!=="head"&&(re=await k(O,T))!==0){let ue=new n(x,{method:"POST",body:T,duplex:"half"}),_e;if(ze.isFormData(T)&&(_e=ue.headers.get("content-type"))&&O.setContentType(_e),ue.body){const[$e,De]=fv(re,wu(pv(R)));T=mv(ue.body,gv,$e,De)}}ze.isString(E)||(E=E?"include":"omit");const K=i&&"credentials"in n.prototype,ae={...U,signal:j,method:A.toUpperCase(),headers:O.normalize().toJSON(),body:T,duplex:"half",credentials:K?E:void 0};Z=i&&new n(x,ae);let q=await(i?F(Z,U):F(x,ae));const J=f&&(M==="stream"||M==="response");if(f&&($||J&&Q)){const ue={};["status","statusText","headers"].forEach(Re=>{ue[Re]=q[Re]});const _e=ze.toFiniteNumber(q.headers.get("content-length")),[$e,De]=$&&fv(_e,wu(pv($),!0))||[];q=new s(mv(q.body,gv,$e,()=>{De&&De(),Q&&Q()}),ue)}M=M||"text";let ee=await v[ze.findKey(v,M)||"text"](q,b);return!J&&Q&&Q(),await new Promise((ue,_e)=>{By(ue,_e,{data:ee,headers:Mo.from(q.headers),status:q.status,statusText:q.statusText,config:b,request:Z})})}catch(K){throw Q&&Q(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new St("Network Error",St.ERR_NETWORK,b,Z),{cause:K.cause||K}):St.from(K,K&&K.code,b,Z)}}},pC=new Map,Uy=e=>{let t=e&&e.env||{};const{fetch:n,Request:s,Response:o}=t,i=[s,o,n];let l=i.length,c=l,d,h,f=pC;for(;c--;)d=i[c],h=f.get(d),h===void 0&&f.set(d,h=c?new Map:fC(t)),f=h;return h};Uy();const Of={http:A_,xhr:lC,fetch:{get:Uy}};ze.forEach(Of,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const wv=e=>`- ${e}`,vC=e=>ze.isFunction(e)||e===null||e===!1;function mC(e,t){e=ze.isArray(e)?e:[e];const{length:n}=e;let s,o;const i={};for(let l=0;l<n;l++){s=e[l];let c;if(o=s,!vC(s)&&(o=Of[(c=String(s)).toLowerCase()],o===void 0))throw new St(`Unknown adapter '${c}'`);if(o&&(ze.isFunction(o)||(o=o.get(t))))break;i[c||"#"+l]=o}if(!o){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=n?l.length>1?`since :
`+l.map(wv).join(`
`):" "+wv(l[0]):"as no adapter specified";throw new St("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const zy={getAdapter:mC,adapters:Of};function Nd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new cr(null,e)}function _v(e){return Nd(e),e.headers=Mo.from(e.headers),e.data=Bd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),zy.getAdapter(e.adapter||mc.adapter,e)(e).then(function(s){return Nd(e),s.data=Bd.call(e,e.transformResponse,s),s.headers=Mo.from(s.headers),s},function(s){return Oy(s)||(Nd(e),s&&s.response&&(s.response.data=Bd.call(e,e.transformResponse,s.response),s.response.headers=Mo.from(s.response.headers))),Promise.reject(s)})}const Hy="1.13.2",ad={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ad[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Cv={};ad.transitional=function(t,n,s){function o(i,l){return"[Axios v"+Hy+"] Transitional option '"+i+"'"+l+(s?". "+s:"")}return(i,l,c)=>{if(t===!1)throw new St(o(l," has been removed"+(n?" in "+n:"")),St.ERR_DEPRECATED);return n&&!Cv[l]&&(Cv[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,c):!0}};ad.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function gC(e,t,n){if(typeof e!="object")throw new St("options must be an object",St.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const i=s[o],l=t[i];if(l){const c=e[i],d=c===void 0||l(c,i,e);if(d!==!0)throw new St("option "+i+" must be "+d,St.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new St("Unknown option "+i,St.ERR_BAD_OPTION)}}const eu={assertOptions:gC,validators:ad},zs=eu.validators;let Xi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new dv,response:new dv}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=tl(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:i}=n;s!==void 0&&eu.assertOptions(s,{silentJSONParsing:zs.transitional(zs.boolean),forcedJSONParsing:zs.transitional(zs.boolean),clarifyTimeoutError:zs.transitional(zs.boolean)},!1),o!=null&&(ze.isFunction(o)?n.paramsSerializer={serialize:o}:eu.assertOptions(o,{encode:zs.function,serialize:zs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),eu.assertOptions(n,{baseUrl:zs.spelling("baseURL"),withXsrfToken:zs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&ze.merge(i.common,i[n.method]);i&&ze.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),n.headers=Mo.concat(l,i);const c=[];let d=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(d=d&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let f,v=0,g;if(!d){const b=[_v.bind(this),void 0];for(b.unshift(...c),b.push(...h),g=b.length,f=Promise.resolve(n);v<g;)f=f.then(b[v++],b[v++]);return f}g=c.length;let k=n;for(;v<g;){const b=c[v++],x=c[v++];try{k=b(k)}catch(A){x.call(this,A);break}}try{f=_v.call(this,k)}catch(b){return Promise.reject(b)}for(v=0,g=h.length;v<g;)f=f.then(h[v++],h[v++]);return f}getUri(t){t=tl(this.defaults,t);const n=Ny(t.baseURL,t.url,t.allowAbsoluteUrls);return Py(n,t.params,t.paramsSerializer)}};ze.forEach(["delete","get","head","options"],function(t){Xi.prototype[t]=function(n,s){return this.request(tl(s||{},{method:t,url:n,data:(s||{}).data}))}});ze.forEach(["post","put","patch"],function(t){function n(s){return function(i,l,c){return this.request(tl(c||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Xi.prototype[t]=n(),Xi.prototype[t+"Form"]=n(!0)});let yC=class Vy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(o=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](o);s._listeners=null}),this.promise.then=o=>{let i;const l=new Promise(c=>{s.subscribe(c),i=c}).then(o);return l.cancel=function(){s.unsubscribe(i)},l},t(function(i,l,c){s.reason||(s.reason=new cr(i,l,c),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Vy(function(o){t=o}),cancel:t}}};function kC(e){return function(n){return e.apply(null,n)}}function bC(e){return ze.isObject(e)&&e.isAxiosError===!0}const qh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(qh).forEach(([e,t])=>{qh[t]=e});function Gy(e){const t=new Xi(e),n=wy(Xi.prototype.request,t);return ze.extend(n,Xi.prototype,t,{allOwnKeys:!0}),ze.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Gy(tl(e,o))},n}const wn=Gy(mc);wn.Axios=Xi;wn.CanceledError=cr;wn.CancelToken=yC;wn.isCancel=Oy;wn.VERSION=Hy;wn.toFormData=sd;wn.AxiosError=St;wn.Cancel=wn.CanceledError;wn.all=function(t){return Promise.all(t)};wn.spread=kC;wn.isAxiosError=bC;wn.mergeConfig=tl;wn.AxiosHeaders=Mo;wn.formToJSON=e=>Ry(ze.isHTMLForm(e)?new FormData(e):e);wn.getAdapter=zy.getAdapter;wn.HttpStatusCode=qh;wn.default=wn;const{Axios:pX,AxiosError:vX,CanceledError:mX,isCancel:gX,CancelToken:yX,VERSION:kX,all:bX,Cancel:wX,isAxiosError:_X,spread:CX,toFormData:LX,AxiosHeaders:IX,HttpStatusCode:SX,formToJSON:xX,getAdapter:$X,mergeConfig:TX}=wn,ii="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",wC="VolunteerCheckinOffline",_C=1;let ws=null;async function $a(){return ws||new Promise((e,t)=>{const n=indexedDB.open(wC,_C);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{ws=n.result,e(ws)},n.onupgradeneeded=s=>{const o=s.target.result;o.objectStoreNames.contains("eventData")||o.createObjectStore("eventData",{keyPath:"eventId"}),o.objectStoreNames.contains("pendingActions")||o.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),o.objectStoreNames.contains("syncMeta")||o.createObjectStore("syncMeta",{keyPath:"key"})}})}async function rc(e,t){return await $a(),new Promise((n,s)=>{const o=ws.transaction(["eventData","syncMeta"],"readwrite"),i=o.objectStore("eventData"),l=o.objectStore("syncMeta"),c={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(c),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function hi(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}async function tu(e,t,n){const s=await hi(e);s&&(s[t]=n,s.cachedAt=new Date().toISOString(),await rc(e,s))}async function CC(e){return await $a(),new Promise((t,n)=>{const o=ws.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=o.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function qy(){return await $a(),new Promise((e,t)=>{const i=ws.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(c=>c.status==="pending"||c.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function _u(){return(await qy()).length}async function Lv(e,t){return await $a(),new Promise((n,s)=>{const o=ws.transaction(["pendingActions"],"readwrite"),i=o.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const c=l.result;c&&(Object.assign(c,t),i.put(c))},o.oncomplete=()=>n(),o.onerror=()=>s(o.error)})}async function Iv(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}async function LC(e){return await $a(),new Promise((t,n)=>{const i=ws.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>n(i.error)})}const et=wn.create({baseURL:ii,headers:{"Content-Type":"application/json"},timeout:15e3});let jh=!1,jy={type:null,eventId:null};function Bo(e,t=null){jy={type:e,eventId:t}}async function IC(){}function Sv(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const n of t){const s=e.match(n);if(s)return s[1]}return null}function SC(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Wy(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:jy}const xC=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];et.interceptors.request.use(e=>{if(xC.some(i=>e.url?.includes(i)))return e;const n=localStorage.getItem("adminEmail");n&&(e.headers["X-Admin-Email"]=n);const s=Wy();let o=null;if(s.type==="marshal"&&s.eventId){const i=bu(s.eventId);i?.token&&(o=i.token)}return o||(o=localStorage.getItem("sessionToken")),o&&(e.headers.Authorization=`Bearer ${o}`),Rw(e),e});let Cu=0;const $C=2;function TC(){if(Cu++,Cu>=$C&&Wy().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function MC(){Cu=0}function Fd(){Cu=0}function AC(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),n=e.headers?.Authorization||e.headers?.authorization;if(n&&t&&n.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const o=window.location.hash||"";return!!(o.match(/#\/event\/[^/?]+/)||o==="#/marshal"||o.startsWith("#/marshal?"))}et.interceptors.response.use(e=>{const t=iv(e.config);t&&av(t),jh=!1,MC();const n=e.config.url,s=Sv(n);return e.config.method,e},async e=>{const t=e.config,n=iv(t);if(n&&av(n),e.response&&(e.response.status===401||e.response.status===403))return AC(t)||TC(),Promise.reject(e);if(SC(e)&&(jh=!0,t.method==="get")){const s=Sv(t.url);if(s){const o=await hi(s);if(o)return console.log("Returning cached data for:",t.url),Promise.resolve({data:o,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Oo(e,t,n){return await CC({type:e,payload:t,eventId:t.eventId}),await IC(),{data:n,status:200,statusText:"OK (queued)",queued:!0}}function Jn(){return jh||!navigator.onLine}const EC={check:()=>et.head("/health")},Wh=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),js={requestLogin:e=>et.post("/auth/request-login",{email:e,frontendUrl:Wh()}),verifyToken:e=>et.post("/auth/verify-token",{token:e}),instantLogin:e=>et.post("/auth/instant-login",{email:e}),createAdmin:e=>et.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>et.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>et.get("/auth/me",{params:{eventId:e}}),logout:()=>et.post("/auth/logout")},Uc={getProfile:()=>et.get("/auth/profile"),updateProfile:e=>et.put("/auth/profile",e),getPerson:(e,t)=>et.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,n)=>et.put(`/people/${e}`,n,{params:{eventId:t}})},li={create:e=>et.post("/events",e),getAll:()=>et.get("/events"),getById:e=>et.get(`/events/${e}`),update:(e,t)=>et.put(`/events/${e}`,t),delete:e=>et.delete(`/events/${e}`),uploadGpx:(e,t)=>{const n=new FormData;return n.append("gpx",t),et.post(`/events/${e}/upload-gpx`,n,{headers:{"Content-Type":"multipart/form-data"}})}},Xn={create:e=>et.post("/locations",e),getById:(e,t)=>et.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>et.get(`/events/${e}/locations`,t),update:(e,t,n)=>et.put(`/locations/${e}/${t}`,n),delete:(e,t)=>et.delete(`/locations/${e}/${t}`),importCsv:(e,t,n)=>{const s=new FormData;return s.append("csv",t),et.post(`/locations/import/${e}?deleteExisting=${n}`,s,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>et.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,n,s={})=>et.post(`/locations/${e}/${t}/update-position`,n,s),getDynamicCheckpoints:(e,t={})=>et.get(`/events/${e}/dynamic-checkpoints`,t)},$r={create:e=>et.post("/assignments",e),getById:(e,t)=>et.get(`/assignments/${e}/${t}`),getByEvent:e=>et.get(`/assignments/event/${e}`),delete:(e,t)=>et.delete(`/assignments/${e}/${t}`),getEventStatus:e=>et.get(`/events/${e}/status`)},fi={checkIn:e=>et.post("/checkin",e),toggleCheckIn:(e,t,{latitude:n,longitude:s,action:o}={})=>et.post(`/checkin/${e}/${t}/toggle`,{latitude:n??null,longitude:s??null,action:o??null}),adminCheckIn:(e,t)=>et.post(`/checkin/admin/${e}/${t}`)},Ud={getAdmins:e=>et.get(`/events/${e}/admins`),addAdmin:(e,t)=>et.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>et.delete(`/events/${e}/admins/${t}`)},bs={create:e=>et.post("/marshals",e),getByEvent:e=>et.get(`/events/${e}/marshals`),getById:(e,t)=>et.get(`/marshals/${e}/${t}`),update:(e,t,n)=>et.put(`/marshals/${e}/${t}`,n),delete:(e,t)=>et.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>et.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Wh()}}),sendMagicLink:(e,t)=>et.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Wh()}),importCsv:(e,t)=>{const n=new FormData;return n.append("csv",t),et.post(`/marshals/import/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}})}},ma={create:e=>et.post("/areas",e),getByEvent:e=>et.get(`/events/${e}/areas`),getById:(e,t)=>et.get(`/areas/${e}/${t}`),update:(e,t,n)=>et.put(`/areas/${e}/${t}`,n),delete:(e,t)=>et.delete(`/areas/${e}/${t}`),recalculate:e=>et.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>et.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>et.get(`/events/${e}/area-lead-dashboard`)},Ot={create:(e,t)=>et.post(`/events/${e}/checklist-items`,t),getByEvent:e=>et.get(`/events/${e}/checklist-items`),getById:(e,t)=>et.get(`/checklist-items/${e}/${t}`),update:(e,t,n)=>et.put(`/checklist-items/${e}/${t}`,n),delete:(e,t)=>et.delete(`/checklist-items/${e}/${t}`),getReport:e=>et.get(`/events/${e}/checklist-report`),getDetailedReport:e=>et.get(`/events/${e}/checklist-report/detailed`),getMarshalChecklist:(e,t)=>et.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>et.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>et.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/complete`,n),uncomplete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/uncomplete`,n),reorder:(e,t)=>et.post(`/events/${e}/checklist-items/reorder`,{items:t})},ys={create:(e,t)=>et.post(`/events/${e}/notes`,t),getByEvent:e=>et.get(`/events/${e}/notes`),getById:(e,t)=>et.get(`/events/${e}/notes/${t}`),update:(e,t,n)=>et.put(`/events/${e}/notes/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>et.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>et.get(`/events/${e}/my-notes`),reorder:(e,t)=>et.post(`/events/${e}/notes/reorder`,{items:t})},ua={create:(e,t)=>et.post(`/events/${e}/contacts`,t),getByEvent:e=>et.get(`/events/${e}/contacts`),getById:(e,t)=>et.get(`/events/${e}/contacts/${t}`),update:(e,t,n)=>et.put(`/events/${e}/contacts/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/contacts/${t}`),getRoles:e=>et.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>et.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>et.get(`/events/${e}/my-contacts`),reorder:(e,t)=>et.post(`/events/${e}/contacts/reorder`,{items:t})},Qa={getAll:e=>et.get(`/events/${e}/role-definitions`),create:(e,t)=>et.post(`/events/${e}/role-definitions`,t),update:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/role-definitions/${t}`),getPeople:(e,t)=>et.get(`/events/${e}/role-definitions/${t}/people`),updatePeople:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}/people`,n),reorder:(e,t)=>et.post(`/events/${e}/role-definitions/reorder`,{items:t}),getMyRoles:e=>et.get(`/events/${e}/my-roles`)},ga={create:(e,t)=>et.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>et.get(`/events/${e}/incidents`,{params:t}),get:(e,t)=>et.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,n)=>et.patch(`/events/${e}/incidents/${t}`,n),addNote:(e,t,n)=>et.post(`/events/${e}/incidents/${t}/notes`,{note:n})},PC={class:"hero-animation-container"},DC={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,n=D(!1);return un(()=>{t.animate?requestAnimationFrame(()=>{n.value=!0}):n.value=!0}),(s,o)=>(p(),y("div",PC,[(p(),y("svg",{viewBox:"0 0 400 350",class:le(["hero-map-svg",{animate:n.value&&e.animate,"no-animate":n.value&&!e.animate}])},[...o[0]||(o[0]=[vi(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},RC=Ke(DC,[["__scopeId","data-v-cec8ae43"]]),OC={class:"hero-header"},BC={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=D(!1);return un(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(n,s)=>(p(),y("div",OC,[Pe(RC,{animate:t.value},null,8,["animate"]),e.title?(p(),y("div",{key:0,class:le(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,_(e.title),1)],2)):P("",!0)]))}},Zy=Ke(BC,[["__scopeId","data-v-c824ab01"]]),gc=$f("auth",()=>{const e=D(localStorage.getItem("adminEmail")||null),t=D(!!e.value),n=D(!1);return{adminEmail:e,isAuthenticated:t,loginPending:n,requestLogin:async c=>{const d=await js.requestLogin(c);return d.data.success&&(n.value=!0),d.data},verifyToken:async c=>{const d=await js.verifyToken(c);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,n.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),Bo("admin")),d.data},instantLogin:async c=>{const d=await js.instantLogin(c);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),Bo("admin")),d.data},logout:async()=>{try{await js.logout()}catch{}e.value=null,t.value=!1,n.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),Bo(null)}}}),NC={class:"modal-card"},FC={key:0,class:"email-sent"},UC={key:1},zC={class:"form-group"},HC=["disabled"],VC={key:0,class:"error"},GC={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const n=e,s=t,o=gc(),i=D(""),l=D(!1),c=D(null),d=D(!1);async function h(){l.value=!0,c.value=null;try{const g=await o.requestLogin(i.value);g.success?(d.value=!0,s("success",i.value)):c.value=g.message||"Failed to send login link. Please try again."}catch{c.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,c.value=null}function v(){s("close")}return Ye(()=>n.show,g=>{g||setTimeout(()=>{f()},200)}),(g,k)=>(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[e.show?(p(),y("div",{key:0,class:"modal-overlay",style:tt({zIndex:e.zIndex}),onClick:rt(v,["self"])},[r("div",NC,[r("button",{class:"modal-close",onClick:v},""),d.value?(p(),y("div",FC,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Je("We've sent a login link to ",-1)),r("strong",null,_(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(p(),y("div",UC,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(h,["prevent"])},[r("div",zC,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>i.value=b),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},_(l.value?"Sending...":"Send login link"),9,HC)],32),c.value?(p(),y("div",VC,_(c.value),1)):P("",!0)]))])],4)):P("",!0)]),_:1})]))}},Ky=Ke(GC,[["__scopeId","data-v-7c646305"]]),qC={class:"home"},jC={class:"hero-section"},WC={class:"content-section"},ZC={class:"container"},KC={class:"carousel"},YC={class:"carousel-indicators"},JC=["onClick"],XC={__name:"Home",setup(e){const t=Qu(),n=ir();function s(){const g=!!localStorage.getItem("adminEmail"),k=ky();return g||k}function o(){s()?n.push("/sessions"):f.value=!0}const i=D(0);let l=null;function c(g){i.value=g,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=D(!1);function v(){f.value=!1,t.query.login&&n.replace({query:{}})}return un(()=>{h(),t.query.login&&(s()?n.replace("/sessions"):f.value=!0)}),Sn(()=>{l&&clearInterval(l)}),(g,k)=>(p(),y("div",qC,[r("section",jC,[Pe(Zy,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:o}," Join us or login ")]),r("section",WC,[r("div",ZC,[k[2]||(k[2]=vi('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",KC,[r("div",{class:"carousel-track",style:tt({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[vi('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",YC,[(p(),y(Ie,null,je(2,(b,x)=>r("button",{key:x,class:le(["indicator",{active:i.value===x}]),onClick:A=>c(x)},null,10,JC)),64))])])])]),Pe(Ky,{show:f.value,onClose:v},null,8,["show"])]))}},QC=Ke(XC,[["__scopeId","data-v-aaecbd22"]]),e2={class:"admin-login"},t2={class:"login-card"},n2={key:0,class:"email-sent"},o2={class:"form-group"},s2=["disabled"],a2={key:0,class:"error"},i2={__name:"AdminLogin",setup(e){const t=gc(),n=D(""),s=D(!1),o=D(null),i=D(!1),l=async()=>{s.value=!0,o.value=null;try{const d=await t.requestLogin(n.value);d.success?i.value=!0:o.value=d.message||"Failed to send login link. Please try again."}catch{o.value="Failed to send login link. Please try again."}finally{s.value=!1}},c=()=>{n.value="",i.value=!1,o.value=null};return(d,h)=>{const f=wf("router-link");return p(),y("div",e2,[r("div",t2,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(p(),y("div",n2,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Je("We've sent a login link to ",-1)),r("strong",null,_(n.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:c,class:"btn btn-secondary"}," Use a different email ")])):(p(),y(Ie,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",o2,[We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=v=>n.value=v),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,n.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:s.value},_(s.value?"Sending...":"Send login link"),9,s2)],32),o.value?(p(),y("div",a2,_(o.value),1)):P("",!0)],64)),Pe(f,{to:"/",class:"back-link"},{default:Ve(()=>[...h[6]||(h[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},l2=Ke(i2,[["__scopeId","data-v-5d0a88c2"]]),r2={class:"admin-verify"},c2={class:"verify-card"},u2={key:0,class:"status"},d2={key:1,class:"status error"},h2={key:2,class:"status success"},f2={__name:"AdminVerify",setup(e){const t=ir(),n=Qu(),s=gc(),o=D(!0),i=D(null);return un(async()=>{const l=n.query.token;if(!l){i.value="No login token provided. Please request a new login link.",o.value=!1;return}try{const c=await s.verifyToken(l);c.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=c.message||"Invalid or expired login link. Please request a new one."}catch(c){console.error("Verification error:",c),i.value="Failed to verify login. Please try again."}finally{o.value=!1}}),(l,c)=>{const d=wf("router-link");return p(),y("div",r2,[r("div",c2,[o.value?(p(),y("div",u2,[...c[0]||(c[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(p(),y("div",d2,[c[2]||(c[2]=r("h2",null,"Login failed",-1)),r("p",null,_(i.value),1),Pe(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ve(()=>[...c[1]||(c[1]=[Je(" Try again ",-1)])]),_:1})])):(p(),y("div",h2,[...c[3]||(c[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},p2=Ke(f2,[["__scopeId","data-v-b2435a84"]]);function Yy(e){if(!e||!e._)return e;const{_d:t={},_ds:n={},g:s=[],m:o=[],cm:i=[],sc:l=[],l:c=[]}=e,d=g=>g==null||g<0||g>=s.length?null:s[g],h=g=>{if(g==null||g<0||g>=o.length)return{id:null,name:null};const k=o[g];return{id:d(k.r),name:k.n||""}},f=(g,k)=>g??n[k]??"";return{eventId:null,locations:c.map(g=>{const k=(g.a||[]).map(T=>{const w=h(T.m),C=h(T.cb),I=T.ci??t["a.ci"]??!1;return{id:d(T.r),eventId:null,locationId:d(g.r),marshalId:w.id,marshalName:w.name,isCheckedIn:I,checkInTime:T.ct||null,checkInLatitude:T.cla??null,checkInLongitude:T.clo??null,checkInMethod:T.cm!=null&&i[T.cm]||"",checkedInBy:C.name||""}}),b=(g.ai||[]).map(T=>d(T)).filter(T=>T!=null),x=(g.lus||[]).map(T=>({scope:T.s!=null&&T.s>=0&&l[T.s]||"",itemType:T.t||null,ids:(T.i||[]).map(w=>d(w)).filter(w=>w!=null)})),A=g.dy??t["l.dy"]??!1;return{id:d(g.r),name:g.n||"",description:g.de||"",latitude:g.lat,longitude:g.lng,requiredMarshals:g.rm||0,checkedInCount:g.cc||0,assignments:k,what3Words:g.w||"",startTime:g.st||null,endTime:g.et||null,areaIds:b,styleType:f(g.sty,"l.sty"),styleColor:f(g.sc,"l.sc"),styleBackgroundShape:f(g.sbs,"l.sbs"),styleBackgroundColor:f(g.sbc,"l.sbc"),styleBorderColor:f(g.sboc,"l.sboc"),styleIconColor:f(g.sic,"l.sic"),styleSize:f(g.ssz,"l.ssz"),styleMapRotation:f(g.smr,"l.smr"),resolvedStyleType:f(g.rsty,"l.rsty"),resolvedStyleColor:f(g.rsc,"l.rsc"),resolvedStyleBackgroundShape:f(g.rsbs,"l.rsbs"),resolvedStyleBackgroundColor:f(g.rsbc,"l.rsbc"),resolvedStyleBorderColor:f(g.rsboc,"l.rsboc"),resolvedStyleIconColor:f(g.rsic,"l.rsic"),resolvedStyleSize:f(g.rssz,"l.rssz"),resolvedStyleMapRotation:f(g.rsmr,"l.rsmr"),peopleTerm:g.pt||"",checkpointTerm:g.cpt||"",isDynamic:A,locationUpdateScopeConfigurations:x,lastLocationUpdate:g.llu||null}})}}function Zh(e){if(!e||!e._)return e;const{_d:t={},g:n=[],sc:s=[],ct:o=[],cm:i=[],td:l=[],ar:c=[],cp:d=[]}=e,h=k=>k==null||k<0||k>=n.length?null:n[k],f=k=>{const b=l[k.ti]||{};return{itemId:h(b.r),text:b.t||"",scope:k.si!=null&&k.si>=0&&s[k.si]||"",contextType:k.cti!=null&&k.cti>=0&&o[k.cti]||"",contextId:h(k.ci),marshalId:k.mi!=null?h(k.mi):null}},v=c.map(k=>({areaId:h(k.r),name:k.n||"",color:k.c||""})),g=d.map(k=>{const b=k.ani!=null&&k.ani>=0&&k.ani<v.length?v[k.ani].name:null,x=(k.ai||[]).map(w=>h(w)).filter(w=>w!=null),A=(k.ot||[]).map(f),T=(k.ms||[]).map(w=>{const C=w.ci??t["m.ci"]??!1,I=(w.ot||[]).map(f);return{marshalId:h(w.r),assignmentId:h(w.ar),name:w.n||"",email:w.e||null,phoneNumber:w.p||null,isCheckedIn:C,checkInTime:w.cit||null,checkInMethod:w.cmi!=null&&w.cmi>=0?i[w.cmi]||"":null,lastAccessedAt:w.la||null,outstandingTaskCount:w.otc||0,outstandingTasks:I}});return{checkpointId:h(k.r),name:k.n||"",description:k.de||"",latitude:k.lat,longitude:k.lng,areaName:b,areaIds:x,marshals:T,outstandingTaskCount:k.otc||0,outstandingTasks:A}});return{areas:v,checkpoints:g}}function Jy(e){if(!e||!e._)return e;const{_d:t={},g:n=[],sv:s=[],st:o=[],cm:i=[],p:l=[],i:c=[]}=e,d=v=>v==null||v<0||v>=n.length?null:n[v],h=v=>{if(v==null||v<0||v>=l.length)return{personId:null,name:"",marshalId:null};const g=l[v];return{personId:d(g.r),name:g.n||"",marshalId:g.m!=null?d(g.m):null}};return{incidents:c.map(v=>{const g=h(v.rb);let k={checkpoint:null,marshalsPresentAtCheckpoint:[]};if(v.ctx){let x=null;if(v.ctx.cp){const T=v.ctx.cp;x={checkpointId:d(T.r),name:T.n||"",description:T.de||"",latitude:T.lat,longitude:T.lng,areaIds:(T.ai||[]).map(w=>d(w)).filter(w=>w!=null),areaNames:T.an||[]}}const A=(v.ctx.ms||[]).map(T=>({marshalId:d(T.r),name:T.n||"",wasCheckedIn:T.ci??t["m.ci"]??!1,checkInTime:T.cit||null,checkInMethod:T.cmi!=null&&T.cmi>=0?i[T.cmi]||"":null}));k={checkpoint:x,marshalsPresentAtCheckpoint:A}}const b=(v.up||[]).map(x=>{const A=h(x.ap);return{updateId:d(x.r),timestamp:x.ts,authorPersonId:A.personId,authorName:A.name,note:x.no||"",statusChange:x.sc!=null&&x.sc>=0&&o[x.sc]||null}});return{incidentId:d(v.r),eventId:null,title:v.ti||"",description:v.de||"",severity:v.sv!=null&&v.sv>=0&&s[v.sv]||"",incidentTime:v.it,createdAt:v.ca,latitude:v.lat??null,longitude:v.lng??null,status:v.st!=null&&v.st>=0&&o[v.st]||"",reportedBy:{personId:g.personId,name:g.name,marshalId:g.marshalId},area:v.ar!=null?{areaId:d(v.ar),areaName:v.an||""}:null,context:k,updates:b}})}}function Bf(e){if(Array.isArray(e)||!e||!e._)return e;const{_d:t={},g:n=[],s=[],at:o=[],ct:i=[],m:l=[],c=[],d=[],n:h=[]}=e,f=k=>k==null||k<0||k>=n.length?null:n[k],v=k=>{if(k==null||k<0||k>=l.length)return{id:null,name:null};const b=l[k];return{id:f(b.r),name:b.n||""}},g=k=>{if(k==null||k<0||k>=c.length)return{type:"",id:null};const b=c[k];return{type:b.t!=null&&b.t>=0&&i[b.t]||"",id:f(b.r)}};return h.map(k=>{const b=d[k.i]||{},x=(b.sc||[]).map(O=>({scope:O.s!=null&&O.s>=0&&s[O.s]||"",itemType:O.t||null,ids:(O.i||[]).map(E=>f(E)).filter(E=>E!=null)})),A=g(k.x),T=v(k.a),w=k.at!=null&&k.at>=0&&o[k.at]||null,C=v(k.o),I=k.c??t["n.c"]??!1,$=k.m??t["n.m"]??!1,R=b.r2??t["d.r2"]??!1,M=b.l??t["d.l"]??!1;return{itemId:f(b.r),eventId:null,text:b.t||"",scopeConfigurations:x,displayOrder:b.o||0,isRequired:R,visibleFrom:b.vf||null,visibleUntil:b.vu||null,mustCompleteBy:b.mb||null,isCompleted:I,canBeCompletedByMe:$,completedByActorName:T.name||null,completedByActorType:w,completedByActorId:T.id,completedAt:k.ca||null,completionContextType:A.type,completionContextId:A.id,matchedScope:k.s!=null&&k.s>=0&&s[k.s]||"",contextOwnerName:C.name||null,contextOwnerMarshalId:C.id,linksToCheckIn:M,linkedCheckpointId:f(b.lc),linkedCheckpointName:b.ln||null}})}const Xy=$f("events",()=>{const e=D([]),t=D(null),n=D([]),s=D([]),o=D(null),i=D(!1),l=D(null),c=async()=>{i.value=!0,l.value=null;try{const R=await li.getAll();e.value=R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},d=async R=>{i.value=!0,l.value=null;try{const M=await li.getById(R);t.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},h=async R=>{i.value=!0,l.value=null;try{const M=await li.create(R);return e.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},f=async(R,M)=>{i.value=!0,l.value=null;try{const O=await li.update(R,M),E=e.value.findIndex(U=>U.id===R);return E!==-1&&(e.value[E]=O.data),t.value?.id===R&&(t.value=O.data),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},v=async R=>{i.value=!0,l.value=null;try{await li.delete(R),e.value=e.value.filter(M=>M.id!==R)}catch(M){throw l.value=M.message,M}finally{i.value=!1}},g=async R=>{i.value=!0,l.value=null;try{const M=await Xn.getByEvent(R);n.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}};return{events:e,currentEvent:t,locations:n,assignments:s,eventStatus:o,loading:i,error:l,fetchEvents:c,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:v,fetchLocations:g,createLocation:async R=>{i.value=!0,l.value=null;try{const M=await Xn.create(R);return n.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateLocation:async(R,M,O)=>{i.value=!0,l.value=null;try{const E=await Xn.update(R,M,O),U=n.value.findIndex(F=>F.id===M);return U!==-1&&(n.value[U]=E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},deleteLocation:async(R,M)=>{i.value=!0,l.value=null;try{await Xn.delete(R,M),n.value=n.value.filter(O=>O.id!==M)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},bulkUpdateLocationTimes:async(R,M)=>{i.value=!0,l.value=null;try{const O=await Xn.bulkUpdateTimes(R,M);return await g(R),O.data}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchAssignments:async R=>{i.value=!0,l.value=null;try{const M=await $r.getByEvent(R);s.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},createAssignment:async R=>{i.value=!0,l.value=null;try{const M=await $r.create(R);return s.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},deleteAssignment:async(R,M)=>{i.value=!0,l.value=null;try{await $r.delete(R,M),s.value=s.value.filter(O=>O.id!==M)}catch(O){throw l.value=O.message,O}finally{i.value=!1}},fetchEventStatus:async R=>{i.value=!0,l.value=null;try{const M=await $r.getEventStatus(R),O=Yy(M.data);return O&&!O.eventId&&(O.eventId=R),o.value=O,O}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateAssignmentCheckIn:R=>{const M=s.value.findIndex(O=>O.id===R.id);M!==-1&&(s.value[M]=R),o.value&&o.value.locations.forEach(O=>{const E=O.assignments.findIndex(U=>U.id===R.id);E!==-1&&(O.assignments[E]=R,O.checkedInCount=O.assignments.filter(U=>U.isCheckedIn).length)})}}});function Qy(e="details",t=[]){const n=D(e),s=v=>{n.value=v},o=()=>{n.value=e},i=v=>n.value===v,l=H(()=>t.length===0?-1:t.indexOf(n.value)),c=(v=!1)=>{if(t.length===0)return;const g=l.value;if(g===-1)return;const k=g+1;k<t.length?n.value=t[k]:v&&(n.value=t[0])},d=(v=!1)=>{if(t.length===0)return;const g=l.value;if(g===-1)return;const k=g-1;k>=0?n.value=t[k]:v&&(n.value=t[t.length-1])},h=H(()=>{if(t.length===0)return!1;const v=l.value;return v!==-1&&v<t.length-1}),f=H(()=>t.length===0?!1:l.value>0);return{activeTab:n,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:s,resetTab:o,isActiveTab:i,nextTab:c,previousTab:d}}function v2(){const e=D(!1),t=D(""),n=D(""),s=D(null),o=D(!1),i=D("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:n,confirmModalIsDanger:o,confirmModalConfirmText:i,showConfirm:(f,v,g,k={})=>{t.value=f,n.value=v,s.value=g,o.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,s.value&&(s.value(),s.value=null)},handleConfirmModalCancel:()=>{e.value=!1,s.value=null},closeConfirmModal:()=>{e.value=!1,s.value=null}}}const Hl=D({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),ka={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},ya={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function ji(e,t,n="Marshals"){if(!t)return"";const s=ka[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${ka.people[n]?.singular||"Person"} point`:s?.singular?s.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function e1(e,t,n="Marshals"){if(!t)return"";const s=ka[e]?.[t];return t==="Person points"?`${ka.people[n]?.singular||"Person"} points`:s?.plural?s.plural:t}function Kh(e,t){return e==="Person points"?`${ka.people[t]?.singular||"Person"} points`:e}function Yh(e){e&&(Hl.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const vs=e=>e.toLowerCase(),ms=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function dt(){const e=f=>{const v=Hl.value[f],g=ka[f]?.[v];if(f==="checkpoint"&&v==="Person points"){const k=Hl.value.people;return`${ka.people[k]?.singular||"Person"} point`}return g?.singular||v},t=f=>{const v=Hl.value[f],g=ka[f]?.[v];if(f==="checkpoint"&&v==="Person points"){const k=Hl.value.people;return`${ka.people[k]?.singular||"Person"} points`}return g?.plural||v},n=H(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),s=H(()=>({person:vs(e("people")),checkpoint:vs(e("checkpoint")),area:vs(e("area")),checklist:vs(e("checklist")),course:vs(e("course")),people:vs(t("people")),checkpoints:vs(t("checkpoint")),areas:vs(t("area")),checklists:vs(t("checklist")),courses:vs(t("course"))})),o=H(()=>({person:ms(e("people")),checkpoint:ms(e("checkpoint")),area:ms(e("area")),checklist:ms(e("checklist")),course:ms(e("course")),people:ms(t("people")),checkpoints:ms(t("checkpoint")),areas:ms(t("area")),checklists:ms(t("checklist")),courses:ms(t("course"))})),i=H(()=>({course:n.value.course,checkpoints:n.value.checkpoints,areas:n.value.areas,marshals:n.value.people,checklists:n.value.checklists,notes:"Notes",details:"Event details"}));return{terms:n,termsLower:s,termsSentence:o,tabLabels:i,singular:e,plural:t,formatCount:(f,v)=>v===1?`1 ${e(f)}`:`${v} ${t(f)}`,lower:(f,v=!0)=>vs(v?t(f):e(f)),title:(f,v=!0)=>v?t(f):e(f),sentence:(f,v=!0)=>ms(v?t(f):e(f)),terminology:Hl}}function m2(){const e=D(!1),t=D(null),n=D({}),s=D(null),o=D(null),i=D([]),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(1),v=H(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value!==null:t.value==="draw-area"?o.value&&o.value.length>=3:t.value==="add-multiple"),g=Z=>{if(Z){const Q=Z.getMapCenter?.(),re=Z.getMapZoom?.();Q&&re!==null&&(l.value=Q,c.value=re)}},k=(Z={})=>{s.value=null,e.value=!0,t.value="place-checkpoint",n.value={title:Z.title||"Select checkpoint location",description:Z.description||"Click on the map to set the location. Click again to reposition."}},b=(Z,Q="checkpoint")=>{s.value=null,e.value=!0,t.value="move-checkpoint",n.value={title:`Move ${Q}: ${Z}`,description:"Click on the map to set the new location"}},x=(Z={})=>{e.value=!0,t.value="draw-area",d.value=!0,n.value={title:Z.title||"Draw area boundary",description:Z.description||"Click to add points. Click Done when finished to complete the area."}},A=(Z=1)=>{f.value=Z,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,n.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},T=Z=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?s.value=Z:t.value==="add-multiple"&&w(Z)},w=Z=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Z.lat,longitude:Z.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,n.value={...n.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},C=Z=>{o.value=Z},I=()=>o.value&&o.value.length>=3?o.value.map(Z=>({lat:Z.lat,lng:Z.lng})):null,$=()=>{e.value=!1,t.value=null,n.value={},s.value=null,l.value=null,c.value=null,o.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:n,tempLocationCoords:s,currentDrawingPolygon:o,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:c,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:v,saveMapState:g,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:b,enterDrawAreaMode:x,enterAddMultipleMode:A,handleFullscreenMapClick:T,handlePolygonDrawing:C,getCompletedPolygon:I,exitFullscreen:$,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,o.value=null),$()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>s.value,createDisplayCheckpoints:(Z,Q,re)=>H(()=>{const K=[...Z.value];return t.value==="place-checkpoint"&&s.value&&K.push({id:"temp-single",name:Q.value?.name||"New Checkpoint",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:Q.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&s.value&&re.value&&K.push({id:"temp-move",name:re.value.name+" (new position)",latitude:s.value.lat,longitude:s.value.lng,requiredMarshals:re.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&K.push(...i.value),K}),createDisplayAreas:(Z,Q)=>H(()=>{const re=[...Z.value];if(t.value==="draw-area"&&Q.value?.polygon?.length>0){const K=re.findIndex(ae=>ae.id===Q.value.id);K>=0?re[K]={...Q.value}:re.push({...Q.value,id:Q.value.id||"temp-area"})}return re}),calculateStartingNumber:Z=>{const Q=Z.value.map(re=>{const K=re.name.match(/^Checkpoint (\d+)$/);return K?parseInt(K[1]):0}).filter(re=>re>0);return Q.length>0?Math.max(...Q)+1:1}}}function g2(e){const t=D([]),n=D(!1);return{eventAdmins:t,showAddAdmin:n,loadEventAdmins:async()=>{try{const d=await Ud.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{n.value=!0},closeAddAdminModal:()=>{n.value=!1},addAdmin:async d=>{await Ud.addAdmin(e.value,d)},removeAdmin:async d=>{await Ud.removeAdmin(e.value,d)}}}function y2(e){const t=D(!1),n=D(!1),s=D(!1),o=D(!1),i=D(!1),l=D(!1),c=D(null),d=D(null),h=D(null),f=D(null);return{showUploadRoute:t,showImportLocations:n,showImportMarshals:s,uploading:o,importing:i,importingMarshals:l,uploadError:c,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{c.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,c.value=null},uploadRoute:async $=>{if(!$)return c.value="Please select a GPX file",null;o.value=!0,c.value=null;try{return await li.uploadGpx(e.value,$),!0}catch(R){return console.error("Failed to upload route:",R),c.value=R.response?.data?.message||"Failed to upload route. Please try again.",null}finally{o.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,n.value=!0},closeImportLocationsModal:()=>{n.value=!1,d.value=null,h.value=null},importLocations:async($,R)=>{if(!$)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const M=await Xn.importCsv(e.value,$,R);return h.value=M.data,M.data}catch(M){return console.error("Failed to import locations:",M),d.value=M.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,s.value=!0},closeImportMarshalsModal:()=>{s.value=!1,d.value=null,f.value=null},importMarshals:async $=>{if(!$)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const R=await bs.importCsv(e.value,$);return f.value=R.data,R.data}catch(R){return console.error("Failed to import marshals:",R),d.value=R.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:($,R="location")=>{const M=R==="location"?"location(s)":"marshal(s)";let E=`<p>Created <strong>${$[R==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${M} and <strong>${$.assignmentsCreated}</strong> assignment(s)</p>`;return $.errors&&$.errors.length>0&&(E+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',$.errors.forEach(U=>{E+=`<li>${U}</li>`}),E+="</ul>"),E}}}const t1="admin-theme-preference",Ui=D(k2());function k2(){return typeof window>"u"?"system":localStorage.getItem(t1)||"system"}function b2(e){localStorage.setItem(t1,e)}function n1(){const e=H(()=>Ui.value==="system"?"light dark":Ui.value),t=(o,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Ui.value=o,b2(o)},n=()=>{const o=["system","light","dark"],l=(o.indexOf(Ui.value)+1)%o.length;t(o[l])},s=H(()=>Ui.value==="dark"?!0:Ui.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Ui,colorScheme:e,isDark:s,setTheme:t,cycleTheme:n}}const o1=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",cc=e=>{if(!e)return"";const t=new Date(e),n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${n}-${s}-${o}T${i}:${l}`},Lu=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const n=e.includes("."),s=e.includes("/");return n!==s},sl=(e,t,n,s)=>{const i=e*Math.PI/180,l=n*Math.PI/180,c=(n-e)*Math.PI/180,d=(s-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},w2=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function zd(e,{areas:t=[],locations:n=[],marshals:s=[]}){if(!e||e.length===0)return e;const o=new Set(t.map(h=>h.id)),i=new Set(n.map(h=>h.id)),l=new Set(s.map(h=>h.id)),c=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,v=h.ids||[];if(!f||v.length===0)return h;const g=v.filter(k=>c.has(k)?!0:f==="Area"?o.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:g}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function s1({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:n=[],areaLeadAreaIds:s=[],locationId:o,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const c=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(c){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(n.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(o))&&n.includes(o)||d.some(f=>n.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(n.length>0)return!0}else if(d.some(f=>i.includes(f))&&n.includes(o))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(s.length>0)return!0}else if(d.some(f=>s.includes(f)))return!0;break}}return!1}function a1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tr={exports:{}};var _2=Tr.exports,xv;function C2(){return xv||(xv=1,(function(e,t){(function(n,s){s(t)})(_2,(function(n){var s="1.9.4";function o(a){var u,m,S,B;for(m=1,S=arguments.length;m<S;m++){B=arguments[m];for(u in B)a[u]=B[u]}return a}var i=Object.create||(function(){function a(){}return function(u){return a.prototype=u,new a}})();function l(a,u){var m=Array.prototype.slice;if(a.bind)return a.bind.apply(a,m.call(arguments,1));var S=m.call(arguments,2);return function(){return a.apply(u,S.length?S.concat(m.call(arguments)):arguments)}}var c=0;function d(a){return"_leaflet_id"in a||(a._leaflet_id=++c),a._leaflet_id}function h(a,u,m){var S,B,W,he;return he=function(){S=!1,B&&(W.apply(m,B),B=!1)},W=function(){S?B=arguments:(a.apply(m,arguments),setTimeout(he,u),S=!0)},W}function f(a,u,m){var S=u[1],B=u[0],W=S-B;return a===S&&m?a:((a-B)%W+W)%W+B}function v(){return!1}function g(a,u){if(u===!1)return a;var m=Math.pow(10,u===void 0?6:u);return Math.round(a*m)/m}function k(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function b(a){return k(a).split(/\s+/)}function x(a,u){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?i(a.options):{});for(var m in u)a.options[m]=u[m];return a.options}function A(a,u,m){var S=[];for(var B in a)S.push(encodeURIComponent(m?B.toUpperCase():B)+"="+encodeURIComponent(a[B]));return(!u||u.indexOf("?")===-1?"?":"&")+S.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function w(a,u){return a.replace(T,function(m,S){var B=u[S];if(B===void 0)throw new Error("No value provided for variable "+m);return typeof B=="function"&&(B=B(u)),B})}var C=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function I(a,u){for(var m=0;m<a.length;m++)if(a[m]===u)return m;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var M=0;function O(a){var u=+new Date,m=Math.max(0,16-(u-M));return M=u+m,window.setTimeout(a,m)}var E=window.requestAnimationFrame||R("RequestAnimationFrame")||O,U=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,u,m){if(m&&E===O)a.call(u);else return E.call(window,l(a,u))}function j(a){a&&U.call(window,a)}var Z={__proto__:null,extend:o,create:i,bind:l,get lastId(){return c},stamp:d,throttle:h,wrapNum:f,falseFn:v,formatNum:g,trim:k,splitWords:b,setOptions:x,getParamString:A,template:w,isArray:C,indexOf:I,emptyImageUrl:$,requestFn:E,cancelFn:U,requestAnimFrame:F,cancelAnimFrame:j};function Q(){}Q.extend=function(a){var u=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},m=u.__super__=this.prototype,S=i(m);S.constructor=u,u.prototype=S;for(var B in this)Object.prototype.hasOwnProperty.call(this,B)&&B!=="prototype"&&B!=="__super__"&&(u[B]=this[B]);return a.statics&&o(u,a.statics),a.includes&&(re(a.includes),o.apply(null,[S].concat(a.includes))),o(S,a),delete S.statics,delete S.includes,S.options&&(S.options=m.options?i(m.options):{},o(S.options,a.options)),S._initHooks=[],S.callInitHooks=function(){if(!this._initHooksCalled){m.callInitHooks&&m.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,he=S._initHooks.length;W<he;W++)S._initHooks[W].call(this)}},u},Q.include=function(a){var u=this.prototype.options;return o(this.prototype,a),a.options&&(this.prototype.options=u,this.mergeOptions(a.options)),this},Q.mergeOptions=function(a){return o(this.prototype.options,a),this},Q.addInitHook=function(a){var u=Array.prototype.slice.call(arguments,1),m=typeof a=="function"?a:function(){this[a].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(m),this};function re(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=C(a)?a:[a];for(var u=0;u<a.length;u++)a[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(a,u,m){if(typeof a=="object")for(var S in a)this._on(S,a[S],u);else{a=b(a);for(var B=0,W=a.length;B<W;B++)this._on(a[B],u,m)}return this},off:function(a,u,m){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var S in a)this._off(S,a[S],u);else{a=b(a);for(var B=arguments.length===1,W=0,he=a.length;W<he;W++)B?this._off(a[W]):this._off(a[W],u,m)}return this},_on:function(a,u,m,S){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(a,u,m)===!1){m===this&&(m=void 0);var B={fn:u,ctx:m};S&&(B.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(B)}},_off:function(a,u,m){var S,B,W;if(this._events&&(S=this._events[a],!!S)){if(arguments.length===1){if(this._firingCount)for(B=0,W=S.length;B<W;B++)S[B].fn=v;delete this._events[a];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var he=this._listens(a,u,m);if(he!==!1){var Me=S[he];this._firingCount&&(Me.fn=v,this._events[a]=S=S.slice()),S.splice(he,1)}}},fire:function(a,u,m){if(!this.listens(a,m))return this;var S=o({},u,{type:a,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var B=this._events[a];if(B){this._firingCount=this._firingCount+1||1;for(var W=0,he=B.length;W<he;W++){var Me=B[W],Ue=Me.fn;Me.once&&this.off(a,Ue,Me.ctx),Ue.call(Me.ctx||this,S)}this._firingCount--}}return m&&this._propagateEvent(S),this},listens:function(a,u,m,S){typeof a!="string"&&console.warn('"string" type argument expected');var B=u;typeof u!="function"&&(S=!!u,B=void 0,m=void 0);var W=this._events&&this._events[a];if(W&&W.length&&this._listens(a,B,m)!==!1)return!0;if(S){for(var he in this._eventParents)if(this._eventParents[he].listens(a,u,m,S))return!0}return!1},_listens:function(a,u,m){if(!this._events)return!1;var S=this._events[a]||[];if(!u)return!!S.length;m===this&&(m=void 0);for(var B=0,W=S.length;B<W;B++)if(S[B].fn===u&&S[B].ctx===m)return B;return!1},once:function(a,u,m){if(typeof a=="object")for(var S in a)this._on(S,a[S],u,!0);else{a=b(a);for(var B=0,W=a.length;B<W;B++)this._on(a[B],u,m,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d(a)],this},_propagateEvent:function(a){for(var u in this._eventParents)this._eventParents[u].fire(a.type,o({layer:a.target,propagatedFrom:a.target},a),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var ae=Q.extend(K);function q(a,u,m){this.x=m?Math.round(a):a,this.y=m?Math.round(u):u}var J=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(a){return this.clone()._add(ee(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(ee(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new q(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new q(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=J(this.x),this.y=J(this.y),this},distanceTo:function(a){a=ee(a);var u=a.x-this.x,m=a.y-this.y;return Math.sqrt(u*u+m*m)},equals:function(a){return a=ee(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=ee(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function ee(a,u,m){return a instanceof q?a:C(a)?new q(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new q(a.x,a.y):new q(a,u,m)}function ue(a,u){if(a)for(var m=u?[a,u]:a,S=0,B=m.length;S<B;S++)this.extend(m[S])}ue.prototype={extend:function(a){var u,m;if(!a)return this;if(a instanceof q||typeof a[0]=="number"||"x"in a)u=m=ee(a);else if(a=_e(a),u=a.min,m=a.max,!u||!m)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=m.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(m.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(m.y,this.max.y)),this},getCenter:function(a){return ee((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return ee(this.min.x,this.max.y)},getTopRight:function(){return ee(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var u,m;return typeof a[0]=="number"||a instanceof q?a=ee(a):a=_e(a),a instanceof ue?(u=a.min,m=a.max):u=m=a,u.x>=this.min.x&&m.x<=this.max.x&&u.y>=this.min.y&&m.y<=this.max.y},intersects:function(a){a=_e(a);var u=this.min,m=this.max,S=a.min,B=a.max,W=B.x>=u.x&&S.x<=m.x,he=B.y>=u.y&&S.y<=m.y;return W&&he},overlaps:function(a){a=_e(a);var u=this.min,m=this.max,S=a.min,B=a.max,W=B.x>u.x&&S.x<m.x,he=B.y>u.y&&S.y<m.y;return W&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var u=this.min,m=this.max,S=Math.abs(u.x-m.x)*a,B=Math.abs(u.y-m.y)*a;return _e(ee(u.x-S,u.y-B),ee(m.x+S,m.y+B))},equals:function(a){return a?(a=_e(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function _e(a,u){return!a||a instanceof ue?a:new ue(a,u)}function $e(a,u){if(a)for(var m=u?[a,u]:a,S=0,B=m.length;S<B;S++)this.extend(m[S])}$e.prototype={extend:function(a){var u=this._southWest,m=this._northEast,S,B;if(a instanceof Re)S=a,B=a;else if(a instanceof $e){if(S=a._southWest,B=a._northEast,!S||!B)return this}else return a?this.extend(be(a)||De(a)):this;return!u&&!m?(this._southWest=new Re(S.lat,S.lng),this._northEast=new Re(B.lat,B.lng)):(u.lat=Math.min(S.lat,u.lat),u.lng=Math.min(S.lng,u.lng),m.lat=Math.max(B.lat,m.lat),m.lng=Math.max(B.lng,m.lng)),this},pad:function(a){var u=this._southWest,m=this._northEast,S=Math.abs(u.lat-m.lat)*a,B=Math.abs(u.lng-m.lng)*a;return new $e(new Re(u.lat-S,u.lng-B),new Re(m.lat+S,m.lng+B))},getCenter:function(){return new Re((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Re(this.getNorth(),this.getWest())},getSouthEast:function(){return new Re(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof Re||"lat"in a?a=be(a):a=De(a);var u=this._southWest,m=this._northEast,S,B;return a instanceof $e?(S=a.getSouthWest(),B=a.getNorthEast()):S=B=a,S.lat>=u.lat&&B.lat<=m.lat&&S.lng>=u.lng&&B.lng<=m.lng},intersects:function(a){a=De(a);var u=this._southWest,m=this._northEast,S=a.getSouthWest(),B=a.getNorthEast(),W=B.lat>=u.lat&&S.lat<=m.lat,he=B.lng>=u.lng&&S.lng<=m.lng;return W&&he},overlaps:function(a){a=De(a);var u=this._southWest,m=this._northEast,S=a.getSouthWest(),B=a.getNorthEast(),W=B.lat>u.lat&&S.lat<m.lat,he=B.lng>u.lng&&S.lng<m.lng;return W&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,u){return a?(a=De(a),this._southWest.equals(a.getSouthWest(),u)&&this._northEast.equals(a.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function De(a,u){return a instanceof $e?a:new $e(a,u)}function Re(a,u,m){if(isNaN(a)||isNaN(u))throw new Error("Invalid LatLng object: ("+a+", "+u+")");this.lat=+a,this.lng=+u,m!==void 0&&(this.alt=+m)}Re.prototype={equals:function(a,u){if(!a)return!1;a=be(a);var m=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return m<=(u===void 0?1e-9:u)},toString:function(a){return"LatLng("+g(this.lat,a)+", "+g(this.lng,a)+")"},distanceTo:function(a){return Y.distance(this,be(a))},wrap:function(){return Y.wrapLatLng(this)},toBounds:function(a){var u=180*a/40075017,m=u/Math.cos(Math.PI/180*this.lat);return De([this.lat-u,this.lng-m],[this.lat+u,this.lng+m])},clone:function(){return new Re(this.lat,this.lng,this.alt)}};function be(a,u,m){return a instanceof Re?a:C(a)&&typeof a[0]!="object"?a.length===3?new Re(a[0],a[1],a[2]):a.length===2?new Re(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new Re(a.lat,"lng"in a?a.lng:a.lon,a.alt):u===void 0?null:new Re(a,u,m)}var z={latLngToPoint:function(a,u){var m=this.projection.project(a),S=this.scale(u);return this.transformation._transform(m,S)},pointToLatLng:function(a,u){var m=this.scale(u),S=this.transformation.untransform(a,m);return this.projection.unproject(S)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var u=this.projection.bounds,m=this.scale(a),S=this.transformation.transform(u.min,m),B=this.transformation.transform(u.max,m);return new ue(S,B)},infinite:!1,wrapLatLng:function(a){var u=this.wrapLng?f(a.lng,this.wrapLng,!0):a.lng,m=this.wrapLat?f(a.lat,this.wrapLat,!0):a.lat,S=a.alt;return new Re(m,u,S)},wrapLatLngBounds:function(a){var u=a.getCenter(),m=this.wrapLatLng(u),S=u.lat-m.lat,B=u.lng-m.lng;if(S===0&&B===0)return a;var W=a.getSouthWest(),he=a.getNorthEast(),Me=new Re(W.lat-S,W.lng-B),Ue=new Re(he.lat-S,he.lng-B);return new $e(Me,Ue)}},Y=o({},z,{wrapLng:[-180,180],R:6371e3,distance:function(a,u){var m=Math.PI/180,S=a.lat*m,B=u.lat*m,W=Math.sin((u.lat-a.lat)*m/2),he=Math.sin((u.lng-a.lng)*m/2),Me=W*W+Math.cos(S)*Math.cos(B)*he*he,Ue=2*Math.atan2(Math.sqrt(Me),Math.sqrt(1-Me));return this.R*Ue}}),de=6378137,ie={R:de,MAX_LATITUDE:85.0511287798,project:function(a){var u=Math.PI/180,m=this.MAX_LATITUDE,S=Math.max(Math.min(m,a.lat),-m),B=Math.sin(S*u);return new q(this.R*a.lng*u,this.R*Math.log((1+B)/(1-B))/2)},unproject:function(a){var u=180/Math.PI;return new Re((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*u,a.x*u/this.R)},bounds:(function(){var a=de*Math.PI;return new ue([-a,-a],[a,a])})()};function Ae(a,u,m,S){if(C(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=u,this._c=m,this._d=S}Ae.prototype={transform:function(a,u){return this._transform(a.clone(),u)},_transform:function(a,u){return u=u||1,a.x=u*(this._a*a.x+this._b),a.y=u*(this._c*a.y+this._d),a},untransform:function(a,u){return u=u||1,new q((a.x/u-this._b)/this._a,(a.y/u-this._d)/this._c)}};function G(a,u,m,S){return new Ae(a,u,m,S)}var X=o({},Y,{code:"EPSG:3857",projection:ie,transformation:(function(){var a=.5/(Math.PI*ie.R);return G(a,.5,-a,.5)})()}),te=o({},X,{code:"EPSG:900913"});function Ce(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function Ne(a,u){var m="",S,B,W,he,Me,Ue;for(S=0,W=a.length;S<W;S++){for(Me=a[S],B=0,he=Me.length;B<he;B++)Ue=Me[B],m+=(B?"L":"M")+Ue.x+" "+Ue.y;m+=u?Qe.svg?"z":"x":""}return m||"M0 0"}var Fe=document.documentElement.style,Ee="ActiveXObject"in window,oe=Ee&&!document.addEventListener,ge="msLaunchUri"in navigator&&!("documentMode"in document),Be=lt("webkit"),Oe=lt("android"),xe=lt("android 2")||lt("android 3"),me=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=Oe&&lt("Google")&&me<537&&!("AudioNode"in window),qe=!!window.opera,fe=!ge&&lt("chrome"),ke=lt("gecko")&&!Be&&!qe&&!Ee,ne=!fe&&lt("safari"),ye=lt("phantom"),He="OTransition"in Fe,ct=navigator.platform.indexOf("Win")===0,ht=Ee&&"transition"in Fe,Bt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,Lt="MozPerspective"in Fe,Nt=!window.L_DISABLE_3D&&(ht||Bt||Lt)&&!He&&!ye,Et=typeof orientation<"u"||lt("mobile"),yo=Et&&Be,ko=Et&&Bt,ft=!window.PointerEvent&&window.MSPointerEvent,Pt=!!(window.PointerEvent||ft),mt="ontouchstart"in window||!!window.TouchEvent,An=!window.L_NO_TOUCH&&(mt||Pt),Ao=Et&&qe,ao=Et&&ke,bo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Gt=(function(){var a=!1;try{var u=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",v,u),window.removeEventListener("testPassiveEventSupport",v,u)}catch{}return a})(),As=(function(){return!!document.createElement("canvas").getContext})(),wo=!!(document.createElementNS&&Ce("svg").createSVGRect),zo=!!wo&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),pe=!wo&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var u=a.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),ve=navigator.platform.indexOf("Mac")===0,Se=navigator.platform.indexOf("Linux")===0;function lt(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var Qe={ie:Ee,ielt9:oe,edge:ge,webkit:Be,android:Oe,android23:xe,androidStock:Ze,opera:qe,chrome:fe,gecko:ke,safari:ne,phantom:ye,opera12:He,win:ct,ie3d:ht,webkit3d:Bt,gecko3d:Lt,any3d:Nt,mobile:Et,mobileWebkit:yo,mobileWebkit3d:ko,msPointer:ft,pointer:Pt,touch:An,touchNative:mt,mobileOpera:Ao,mobileGecko:ao,retina:bo,passiveEvents:Gt,canvas:As,svg:wo,vml:pe,inlineSvg:zo,mac:ve,linux:Se},Ft=Qe.msPointer?"MSPointerDown":"pointerdown",sn=Qe.msPointer?"MSPointerMove":"pointermove",yn=Qe.msPointer?"MSPointerUp":"pointerup",_n=Qe.msPointer?"MSPointerCancel":"pointercancel",_o={touchstart:Ft,touchmove:sn,touchend:yn,touchcancel:_n},Ho={touchstart:Vn,touchmove:Es,touchend:Es,touchcancel:Es},Vo={},Ma=!1;function dl(a,u,m){return u==="touchstart"&&Aa(),Ho[u]?(m=Ho[u].bind(this,m),a.addEventListener(_o[u],m,!1),m):(console.warn("wrong event specified:",u),v)}function hl(a,u,m){if(!_o[u]){console.warn("wrong event specified:",u);return}a.removeEventListener(_o[u],m,!1)}function bi(a){Vo[a.pointerId]=a}function Go(a){Vo[a.pointerId]&&(Vo[a.pointerId]=a)}function qo(a){delete Vo[a.pointerId]}function Aa(){Ma||(document.addEventListener(Ft,bi,!0),document.addEventListener(sn,Go,!0),document.addEventListener(yn,qo,!0),document.addEventListener(_n,qo,!0),Ma=!0)}function Es(a,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var m in Vo)u.touches.push(Vo[m]);u.changedTouches=[u],a(u)}}function Vn(a,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&qt(u),Es(a,u)}function wi(a){var u={},m,S;for(S in a)m=a[S],u[S]=m&&m.bind?m.bind(a):m;return a=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var Gn=200;function jo(a,u){a.addEventListener("dblclick",u);var m=0,S;function B(W){if(W.detail!==1){S=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var he=fl(W);if(!(he.some(function(Ue){return Ue instanceof HTMLLabelElement&&Ue.attributes.for})&&!he.some(function(Ue){return Ue instanceof HTMLInputElement||Ue instanceof HTMLSelectElement}))){var Me=Date.now();Me-m<=Gn?(S++,S===2&&u(wi(W))):S=1,m=Me}}}return a.addEventListener("click",B),{dblclick:u,simDblclick:B}}function os(a,u){a.removeEventListener("dblclick",u.dblclick),a.removeEventListener("click",u.simDblclick)}var Ks=Eo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),io=Eo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ys=io==="webkitTransition"||io==="OTransition"?io+"End":"transitionend";function qn(a){return typeof a=="string"?document.getElementById(a):a}function Wo(a,u){var m=a.style[u]||a.currentStyle&&a.currentStyle[u];if((!m||m==="auto")&&document.defaultView){var S=document.defaultView.getComputedStyle(a,null);m=S?S[u]:null}return m==="auto"?null:m}function bt(a,u,m){var S=document.createElement(a);return S.className=u||"",m&&m.appendChild(S),S}function Dt(a){var u=a.parentNode;u&&u.removeChild(a)}function jn(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function On(a){var u=a.parentNode;u&&u.lastChild!==a&&u.appendChild(a)}function Bn(a){var u=a.parentNode;u&&u.firstChild!==a&&u.insertBefore(a,u.firstChild)}function ss(a,u){if(a.classList!==void 0)return a.classList.contains(u);var m=Lo(a);return m.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(m)}function pt(a,u){if(a.classList!==void 0)for(var m=b(u),S=0,B=m.length;S<B;S++)a.classList.add(m[S]);else if(!ss(a,u)){var W=Lo(a);Co(a,(W?W+" ":"")+u)}}function Vt(a,u){a.classList!==void 0?a.classList.remove(u):Co(a,k((" "+Lo(a)+" ").replace(" "+u+" "," ")))}function Co(a,u){a.className.baseVal===void 0?a.className=u:a.className.baseVal=u}function Lo(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Cn(a,u){"opacity"in a.style?a.style.opacity=u:"filter"in a.style&&Js(a,u)}function Js(a,u){var m=!1,S="DXImageTransform.Microsoft.Alpha";try{m=a.filters.item(S)}catch{if(u===1)return}u=Math.round(u*100),m?(m.Enabled=u!==100,m.Opacity=u):a.style.filter+=" progid:"+S+"(opacity="+u+")"}function Eo(a){for(var u=document.documentElement.style,m=0;m<a.length;m++)if(a[m]in u)return a[m];return!1}function Io(a,u,m){var S=u||new q(0,0);a.style[Ks]=(Qe.ie3d?"translate("+S.x+"px,"+S.y+"px)":"translate3d("+S.x+"px,"+S.y+"px,0)")+(m?" scale("+m+")":"")}function en(a,u){a._leaflet_pos=u,Qe.any3d?Io(a,u):(a.style.left=u.x+"px",a.style.top=u.y+"px")}function Wn(a){return a._leaflet_pos||new q(0,0)}var lo,Ps,Ea;if("onselectstart"in document)lo=function(){wt(window,"selectstart",qt)},Ps=function(){Ut(window,"selectstart",qt)};else{var Xs=Eo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);lo=function(){if(Xs){var a=document.documentElement.style;Ea=a[Xs],a[Xs]="none"}},Ps=function(){Xs&&(document.documentElement.style[Xs]=Ea,Ea=void 0)}}function _i(){wt(window,"dragstart",qt)}function Pa(){Ut(window,"dragstart",qt)}var Da,Ds;function Ra(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Rs(),Da=a,Ds=a.style.outlineStyle,a.style.outlineStyle="none",wt(window,"keydown",Rs))}function Rs(){Da&&(Da.style.outlineStyle=Ds,Da=void 0,Ds=void 0,Ut(window,"keydown",Rs))}function Ci(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function Li(a){var u=a.getBoundingClientRect();return{x:u.width/a.offsetWidth||1,y:u.height/a.offsetHeight||1,boundingClientRect:u}}var ur={__proto__:null,TRANSFORM:Ks,TRANSITION:io,TRANSITION_END:Ys,get:qn,getStyle:Wo,create:bt,remove:Dt,empty:jn,toFront:On,toBack:Bn,hasClass:ss,addClass:pt,removeClass:Vt,setClass:Co,getClass:Lo,setOpacity:Cn,testProp:Eo,setTransform:Io,setPosition:en,getPosition:Wn,get disableTextSelection(){return lo},get enableTextSelection(){return Ps},disableImageDrag:_i,enableImageDrag:Pa,preventOutline:Ra,restoreOutline:Rs,getSizedParentNode:Ci,getScale:Li};function wt(a,u,m,S){if(u&&typeof u=="object")for(var B in u)Ii(a,B,u[B],m);else{u=b(u);for(var W=0,he=u.length;W<he;W++)Ii(a,u[W],m,S)}return this}var Rt="_leaflet_events";function Ut(a,u,m,S){if(arguments.length===1)Oa(a),delete a[Rt];else if(u&&typeof u=="object")for(var B in u)Qs(a,B,u[B],m);else if(u=b(u),arguments.length===2)Oa(a,function(Me){return I(u,Me)!==-1});else for(var W=0,he=u.length;W<he;W++)Qs(a,u[W],m,S);return this}function Oa(a,u){for(var m in a[Rt]){var S=m.split(/\d/)[0];(!u||u(S))&&Qs(a,S,null,null,m)}}var ro={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ii(a,u,m,S){var B=u+d(m)+(S?"_"+d(S):"");if(a[Rt]&&a[Rt][B])return this;var W=function(Me){return m.call(S||a,Me||window.event)},he=W;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?W=dl(a,u,W):Qe.touch&&u==="dblclick"?W=jo(a,W):"addEventListener"in a?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?a.addEventListener(ro[u]||u,W,Qe.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(W=function(Me){Me=Me||window.event,Ba(a,Me)&&he(Me)},a.addEventListener(ro[u],W,!1)):a.addEventListener(u,he,!1):a.attachEvent("on"+u,W),a[Rt]=a[Rt]||{},a[Rt][B]=W}function Qs(a,u,m,S,B){B=B||u+d(m)+(S?"_"+d(S):"");var W=a[Rt]&&a[Rt][B];if(!W)return this;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?hl(a,u,W):Qe.touch&&u==="dblclick"?os(a,W):"removeEventListener"in a?a.removeEventListener(ro[u]||u,W,!1):a.detachEvent("on"+u,W),a[Rt][B]=null}function as(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Zn(a){return Ii(a,"wheel",as),this}function kn(a){return wt(a,"mousedown touchstart dblclick contextmenu",as),a._leaflet_disable_click=!0,this}function qt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function co(a){return qt(a),as(a),this}function fl(a){if(a.composedPath)return a.composedPath();for(var u=[],m=a.target;m;)u.push(m),m=m.parentNode;return u}function xn(a,u){if(!u)return new q(a.clientX,a.clientY);var m=Li(u),S=m.boundingClientRect;return new q((a.clientX-S.left)/m.x-u.clientLeft,(a.clientY-S.top)/m.y-u.clientTop)}var ea=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Os(a){return Qe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/ea:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function Ba(a,u){var m=u.relatedTarget;if(!m)return!0;try{for(;m&&m!==a;)m=m.parentNode}catch{return!1}return m!==a}var pl={__proto__:null,on:wt,off:Ut,stopPropagation:as,disableScrollPropagation:Zn,disableClickPropagation:kn,preventDefault:qt,stop:co,getPropagationPath:fl,getMousePosition:xn,getWheelDelta:Os,isExternalTarget:Ba,addListener:wt,removeListener:Ut},Si=ae.extend({run:function(a,u,m,S){this.stop(),this._el=a,this._inProgress=!0,this._duration=m||.25,this._easeOutPower=1/Math.max(S||.5,.2),this._startPos=Wn(a),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var u=+new Date-this._startTime,m=this._duration*1e3;u<m?this._runFrame(this._easeOut(u/m),a):(this._runFrame(1),this._complete())},_runFrame:function(a,u){var m=this._startPos.add(this._offset.multiplyBy(a));u&&m._round(),en(this._el,m),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),$t=ae.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,u){u=x(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(be(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=io&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),wt(this._proxy,Ys,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,u,m){if(u=u===void 0?this._zoom:this._limitZoom(u),a=this._limitCenter(be(a),u,this.options.maxBounds),m=m||{},this._stop(),this._loaded&&!m.reset&&m!==!0){m.animate!==void 0&&(m.zoom=o({animate:m.animate},m.zoom),m.pan=o({animate:m.animate,duration:m.duration},m.pan));var S=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,u,m.zoom):this._tryAnimatedPan(a,m.pan);if(S)return clearTimeout(this._sizeTimer),this}return this._resetView(a,u,m.pan&&m.pan.noMoveStart),this},setZoom:function(a,u){return this._loaded?this.setView(this.getCenter(),a,{zoom:u}):(this._zoom=a,this)},zoomIn:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,u)},zoomOut:function(a,u){return a=a||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,u)},setZoomAround:function(a,u,m){var S=this.getZoomScale(u),B=this.getSize().divideBy(2),W=a instanceof q?a:this.latLngToContainerPoint(a),he=W.subtract(B).multiplyBy(1-1/S),Me=this.containerPointToLatLng(B.add(he));return this.setView(Me,u,{zoom:m})},_getBoundsCenterZoom:function(a,u){u=u||{},a=a.getBounds?a.getBounds():De(a);var m=ee(u.paddingTopLeft||u.padding||[0,0]),S=ee(u.paddingBottomRight||u.padding||[0,0]),B=this.getBoundsZoom(a,!1,m.add(S));if(B=typeof u.maxZoom=="number"?Math.min(u.maxZoom,B):B,B===1/0)return{center:a.getCenter(),zoom:B};var W=S.subtract(m).divideBy(2),he=this.project(a.getSouthWest(),B),Me=this.project(a.getNorthEast(),B),Ue=this.unproject(he.add(Me).divideBy(2).add(W),B);return{center:Ue,zoom:B}},fitBounds:function(a,u){if(a=De(a),!a.isValid())throw new Error("Bounds are not valid.");var m=this._getBoundsCenterZoom(a,u);return this.setView(m.center,m.zoom,u)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,u){return this.setView(a,this._zoom,{pan:u})},panBy:function(a,u){if(a=ee(a).round(),u=u||{},!a.x&&!a.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Si,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){pt(this._mapPane,"leaflet-pan-anim");var m=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,m,u.duration||.25,u.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,u,m){if(m=m||{},m.animate===!1||!Qe.any3d)return this.setView(a,u,m);this._stop();var S=this.project(this.getCenter()),B=this.project(a),W=this.getSize(),he=this._zoom;a=be(a),u=u===void 0?he:u;var Me=Math.max(W.x,W.y),Ue=Me*this.getZoomScale(he,u),Xe=B.distanceTo(S)||1,it=1.42,gt=it*it;function Mt(Ln){var Pc=Ln?-1:1,F1=Ln?Ue:Me,U1=Ue*Ue-Me*Me+Pc*gt*gt*Xe*Xe,z1=2*F1*gt*Xe,kd=U1/z1,Jf=Math.sqrt(kd*kd+1)-kd,H1=Jf<1e-9?-18:Math.log(Jf);return H1}function uo(Ln){return(Math.exp(Ln)-Math.exp(-Ln))/2}function Dn(Ln){return(Math.exp(Ln)+Math.exp(-Ln))/2}function Ko(Ln){return uo(Ln)/Dn(Ln)}var So=Mt(0);function Dl(Ln){return Me*(Dn(So)/Dn(So+it*Ln))}function R1(Ln){return Me*(Dn(So)*Ko(So+it*Ln)-uo(So))/gt}function O1(Ln){return 1-Math.pow(1-Ln,1.5)}var B1=Date.now(),Kf=(Mt(1)-So)/it,N1=m.duration?1e3*m.duration:1e3*Kf*.8;function Yf(){var Ln=(Date.now()-B1)/N1,Pc=O1(Ln)*Kf;Ln<=1?(this._flyToFrame=F(Yf,this),this._move(this.unproject(S.add(B.subtract(S).multiplyBy(R1(Pc)/Xe)),he),this.getScaleZoom(Me/Dl(Pc),he),{flyTo:!0})):this._move(a,u)._moveEnd(!0)}return this._moveStart(!0,m.noMoveStart),Yf.call(this),this},flyToBounds:function(a,u){var m=this._getBoundsCenterZoom(a,u);return this.flyTo(m.center,m.zoom,u)},setMaxBounds:function(a){return a=De(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var u=this.options.minZoom;return this.options.minZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var u=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&u!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,u){this._enforcingBounds=!0;var m=this.getCenter(),S=this._limitCenter(m,this._zoom,De(a));return m.equals(S)||this.panTo(S,u),this._enforcingBounds=!1,this},panInside:function(a,u){u=u||{};var m=ee(u.paddingTopLeft||u.padding||[0,0]),S=ee(u.paddingBottomRight||u.padding||[0,0]),B=this.project(this.getCenter()),W=this.project(a),he=this.getPixelBounds(),Me=_e([he.min.add(m),he.max.subtract(S)]),Ue=Me.getSize();if(!Me.contains(W)){this._enforcingBounds=!0;var Xe=W.subtract(Me.getCenter()),it=Me.extend(W).getSize().subtract(Ue);B.x+=Xe.x<0?-it.x:it.x,B.y+=Xe.y<0?-it.y:it.y,this.panTo(this.unproject(B),u),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=o({animate:!1,pan:!0},a===!0?{animate:!0}:a);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var m=this.getSize(),S=u.divideBy(2).round(),B=m.divideBy(2).round(),W=S.subtract(B);return!W.x&&!W.y?this:(a.animate&&a.pan?this.panBy(W):(a.pan&&this._rawPanBy(W),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:m}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=o({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),m=l(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,m,a):navigator.geolocation.getCurrentPosition(u,m,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var u=a.code,m=a.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+m+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var u=a.coords.latitude,m=a.coords.longitude,S=new Re(u,m),B=S.toBounds(a.coords.accuracy*2),W=this._locateOptions;if(W.setView){var he=this.getBoundsZoom(B);this.setView(S,W.maxZoom?Math.min(he,W.maxZoom):he)}var Me={latlng:S,bounds:B,timestamp:a.timestamp};for(var Ue in a.coords)typeof a.coords[Ue]=="number"&&(Me[Ue]=a.coords[Ue]);this.fire("locationfound",Me)}},addHandler:function(a,u){if(!u)return this;var m=this[a]=new u(this);return this._handlers.push(m),this.options[a]&&m.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Dt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Dt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,u){var m="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),S=bt("div",m,u||this._mapPane);return a&&(this._panes[a]=S),S},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),u=this.unproject(a.getBottomLeft()),m=this.unproject(a.getTopRight());return new $e(u,m)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,u,m){a=De(a),m=ee(m||[0,0]);var S=this.getZoom()||0,B=this.getMinZoom(),W=this.getMaxZoom(),he=a.getNorthWest(),Me=a.getSouthEast(),Ue=this.getSize().subtract(m),Xe=_e(this.project(Me,S),this.project(he,S)).getSize(),it=Qe.any3d?this.options.zoomSnap:1,gt=Ue.x/Xe.x,Mt=Ue.y/Xe.y,uo=u?Math.max(gt,Mt):Math.min(gt,Mt);return S=this.getScaleZoom(uo,S),it&&(S=Math.round(S/(it/100))*(it/100),S=u?Math.ceil(S/it)*it:Math.floor(S/it)*it),Math.max(B,Math.min(W,S))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,u){var m=this._getTopLeftPoint(a,u);return new ue(m,m.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,u){var m=this.options.crs;return u=u===void 0?this._zoom:u,m.scale(a)/m.scale(u)},getScaleZoom:function(a,u){var m=this.options.crs;u=u===void 0?this._zoom:u;var S=m.zoom(a*m.scale(u));return isNaN(S)?1/0:S},project:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(be(a),u)},unproject:function(a,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(ee(a),u)},layerPointToLatLng:function(a){var u=ee(a).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(a){var u=this.project(be(a))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(be(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(De(a))},distance:function(a,u){return this.options.crs.distance(be(a),be(u))},containerPointToLayerPoint:function(a){return ee(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return ee(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var u=this.containerPointToLayerPoint(ee(a));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(be(a)))},mouseEventToContainerPoint:function(a){return xn(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var u=this._container=qn(a);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");wt(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,pt(a,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=Wo(a,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),en(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(a.markerPane,"leaflet-zoom-hide"),pt(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,u,m){en(this._mapPane,new q(0,0));var S=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var B=this._zoom!==u;this._moveStart(B,m)._move(a,u)._moveEnd(B),this.fire("viewreset"),S&&this.fire("load")},_moveStart:function(a,u){return a&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(a,u,m,S){u===void 0&&(u=this._zoom);var B=this._zoom!==u;return this._zoom=u,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),S?m&&m.pinch&&this.fire("zoom",m):((B||m&&m.pinch)&&this.fire("zoom",m),this.fire("move",m)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){en(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[d(this._container)]=this;var u=a?Ut:wt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,u){for(var m=[],S,B=u==="mouseout"||u==="mouseover",W=a.target||a.srcElement,he=!1;W;){if(S=this._targets[d(W)],S&&(u==="click"||u==="preclick")&&this._draggableMoved(S)){he=!0;break}if(S&&S.listens(u,!0)&&(B&&!Ba(W,a)||(m.push(S),B))||W===this._container)break;W=W.parentNode}return!m.length&&!he&&!B&&this.listens(u,!0)&&(m=[this]),m},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var u=a.target||a.srcElement;if(!(!this._loaded||u._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(u))){var m=a.type;m==="mousedown"&&Ra(u),this._fireDOMEvent(a,m)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,u,m){if(a.type==="click"){var S=o({},a);S.type="preclick",this._fireDOMEvent(S,S.type,m)}var B=this._findEventTargets(a,u);if(m){for(var W=[],he=0;he<m.length;he++)m[he].listens(u,!0)&&W.push(m[he]);B=W.concat(B)}if(B.length){u==="contextmenu"&&qt(a);var Me=B[0],Ue={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var Xe=Me.getLatLng&&(!Me._radius||Me._radius<=10);Ue.containerPoint=Xe?this.latLngToContainerPoint(Me.getLatLng()):this.mouseEventToContainerPoint(a),Ue.layerPoint=this.containerPointToLayerPoint(Ue.containerPoint),Ue.latlng=Xe?Me.getLatLng():this.layerPointToLatLng(Ue.layerPoint)}for(he=0;he<B.length;he++)if(B[he].fire(u,Ue,!0),Ue.originalEvent._stopped||B[he].options.bubblingMouseEvents===!1&&I(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,u=this._handlers.length;a<u;a++)this._handlers[a].disable()},whenReady:function(a,u){return this._loaded?a.call(u||this,{target:this}):this.on("load",a,u),this},_getMapPanePos:function(){return Wn(this._mapPane)||new q(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,u){var m=a&&u!==void 0?this._getNewPixelOrigin(a,u):this.getPixelOrigin();return m.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,u){var m=this.getSize()._divideBy(2);return this.project(a,u)._subtract(m)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,u,m){var S=this._getNewPixelOrigin(m,u);return this.project(a,u)._subtract(S)},_latLngBoundsToNewLayerBounds:function(a,u,m){var S=this._getNewPixelOrigin(m,u);return _e([this.project(a.getSouthWest(),u)._subtract(S),this.project(a.getNorthWest(),u)._subtract(S),this.project(a.getSouthEast(),u)._subtract(S),this.project(a.getNorthEast(),u)._subtract(S)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,u,m){if(!m)return a;var S=this.project(a,u),B=this.getSize().divideBy(2),W=new ue(S.subtract(B),S.add(B)),he=this._getBoundsOffset(W,m,u);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?a:this.unproject(S.add(he),u)},_limitOffset:function(a,u){if(!u)return a;var m=this.getPixelBounds(),S=new ue(m.min.add(a),m.max.add(a));return a.add(this._getBoundsOffset(S,u))},_getBoundsOffset:function(a,u,m){var S=_e(this.project(u.getNorthEast(),m),this.project(u.getSouthWest(),m)),B=S.min.subtract(a.min),W=S.max.subtract(a.max),he=this._rebound(B.x,-W.x),Me=this._rebound(B.y,-W.y);return new q(he,Me)},_rebound:function(a,u){return a+u>0?Math.round(a-u)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(u))},_limitZoom:function(a){var u=this.getMinZoom(),m=this.getMaxZoom(),S=Qe.any3d?this.options.zoomSnap:1;return S&&(a=Math.round(a/S)*S),Math.max(u,Math.min(m,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,u){var m=this._getCenterOffset(a)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(m)?!1:(this.panBy(m,u),!0)},_createAnimProxy:function(){var a=this._proxy=bt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(u){var m=Ks,S=this._proxy.style[m];Io(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),S===this._proxy.style[m]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Dt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),u=this.getZoom();Io(this._proxy,this.project(a,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,u,m){if(this._animatingZoom)return!0;if(m=m||{},!this._zoomAnimated||m.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var S=this.getZoomScale(u),B=this._getCenterOffset(a)._divideBy(1-1/S);return m.animate!==!0&&!this.getSize().contains(B)?!1:(F(function(){this._moveStart(!0,m.noMoveStart||!1)._animateZoom(a,u,!0)},this),!0)},_animateZoom:function(a,u,m,S){this._mapPane&&(m&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=u,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:u,noUpdate:S}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function vl(a,u){return new $t(a,u)}var En=Q.extend({options:{position:"topright"},initialize:function(a){x(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var u=this._map;return u&&u.removeControl(this),this.options.position=a,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var u=this._container=this.onAdd(a),m=this.getPosition(),S=a._controlCorners[m];return pt(u,"leaflet-control"),m.indexOf("bottom")!==-1?S.insertBefore(u,S.firstChild):S.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Dt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),is=function(a){return new En(a)};$t.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},u="leaflet-",m=this._controlContainer=bt("div",u+"control-container",this._container);function S(B,W){var he=u+B+" "+u+W;a[B+W]=bt("div",he,m)}S("top","left"),S("top","right"),S("bottom","left"),S("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Dt(this._controlCorners[a]);Dt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ml=En.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,u,m,S){return m<S?-1:S<m?1:0}},initialize:function(a,u,m){x(this,m),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var S in a)this._addLayer(a[S],S);for(S in u)this._addLayer(u[S],S,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return En.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,u){return this._addLayer(a,u),this._map?this._update():this},addOverlay:function(a,u){return this._addLayer(a,u,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(a));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(pt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",u=this._container=bt("div",a),m=this.options.collapsed;u.setAttribute("aria-haspopup",!0),kn(u),Zn(u);var S=this._section=bt("section",a+"-list");m&&(this._map.on("click",this.collapse,this),wt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var B=this._layersLink=bt("a",a+"-toggle",u);B.href="#",B.title="Layers",B.setAttribute("role","button"),wt(B,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){qt(W),this._expandSafely()}},this),m||this.expand(),this._baseLayersList=bt("div",a+"-base",S),this._separator=bt("div",a+"-separator",S),this._overlaysList=bt("div",a+"-overlays",S),u.appendChild(S)},_getLayer:function(a){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===a)return this._layers[u]},_addLayer:function(a,u,m){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:u,overlay:m}),this.options.sortLayers&&this._layers.sort(l(function(S,B){return this.options.sortFunction(S.layer,B.layer,S.name,B.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;jn(this._baseLayersList),jn(this._overlaysList),this._layerControlInputs=[];var a,u,m,S,B=0;for(m=0;m<this._layers.length;m++)S=this._layers[m],this._addItem(S),u=u||S.overlay,a=a||!S.overlay,B+=S.overlay?0:1;return this.options.hideSingleBase&&(a=a&&B>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=u&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var u=this._getLayer(d(a.target)),m=u.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;m&&this._map.fire(m,u)},_createRadioElement:function(a,u){var m='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(u?' checked="checked"':"")+"/>",S=document.createElement("div");return S.innerHTML=m,S.firstChild},_addItem:function(a){var u=document.createElement("label"),m=this._map.hasLayer(a.layer),S;a.overlay?(S=document.createElement("input"),S.type="checkbox",S.className="leaflet-control-layers-selector",S.defaultChecked=m):S=this._createRadioElement("leaflet-base-layers_"+d(this),m),this._layerControlInputs.push(S),S.layerId=d(a.layer),wt(S,"click",this._onInputClick,this);var B=document.createElement("span");B.innerHTML=" "+a.name;var W=document.createElement("span");u.appendChild(W),W.appendChild(S),W.appendChild(B);var he=a.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,u,m,S=[],B=[];this._handlingClick=!0;for(var W=a.length-1;W>=0;W--)u=a[W],m=this._getLayer(u.layerId).layer,u.checked?S.push(m):u.checked||B.push(m);for(W=0;W<B.length;W++)this._map.hasLayer(B[W])&&this._map.removeLayer(B[W]);for(W=0;W<S.length;W++)this._map.hasLayer(S[W])||this._map.addLayer(S[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,u,m,S=this._map.getZoom(),B=a.length-1;B>=0;B--)u=a[B],m=this._getLayer(u.layerId).layer,u.disabled=m.options.minZoom!==void 0&&S<m.options.minZoom||m.options.maxZoom!==void 0&&S>m.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,wt(a,"click",qt),this.expand();var u=this;setTimeout(function(){Ut(a,"click",qt),u._preventClick=!1})}}),xi=function(a,u,m){return new ml(a,u,m)},ls=En.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var u="leaflet-control-zoom",m=bt("div",u+" leaflet-bar"),S=this.options;return this._zoomInButton=this._createButton(S.zoomInText,S.zoomInTitle,u+"-in",m,this._zoomIn),this._zoomOutButton=this._createButton(S.zoomOutText,S.zoomOutTitle,u+"-out",m,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),m},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,u,m,S,B){var W=bt("a",m,S);return W.innerHTML=a,W.href="#",W.title=u,W.setAttribute("role","button"),W.setAttribute("aria-label",u),kn(W),wt(W,"click",co),wt(W,"click",B,this),wt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var a=this._map,u="leaflet-disabled";Vt(this._zoomInButton,u),Vt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(pt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(pt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});$t.mergeOptions({zoomControl:!0}),$t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ls,this.addControl(this.zoomControl))});var $i=function(a){return new ls(a)},gl=En.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var u="leaflet-control-scale",m=bt("div",u),S=this.options;return this._addScales(S,u+"-line",m),a.on(S.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),m},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,u,m){a.metric&&(this._mScale=bt("div",u,m)),a.imperial&&(this._iScale=bt("div",u,m))},_update:function(){var a=this._map,u=a.getSize().y/2,m=a.distance(a.containerPointToLatLng([0,u]),a.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(m)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var u=this._getRoundNum(a),m=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,m,u/a)},_updateImperial:function(a){var u=a*3.2808399,m,S,B;u>5280?(m=u/5280,S=this._getRoundNum(m),this._updateScale(this._iScale,S+" mi",S/m)):(B=this._getRoundNum(u),this._updateScale(this._iScale,B+" ft",B/u))},_updateScale:function(a,u,m){a.style.width=Math.round(this.options.maxWidth*m)+"px",a.innerHTML=u},_getRoundNum:function(a){var u=Math.pow(10,(Math.floor(a)+"").length-1),m=a/u;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:1,u*m}}),dr=function(a){return new gl(a)},ta='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',na=En.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?ta+" ":"")+"Leaflet</a>"},initialize:function(a){x(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=bt("div","leaflet-control-attribution"),kn(this._container);for(var u in a._layers)a._layers[u].getAttribution&&this.addAttribution(a._layers[u].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var u in this._attributions)this._attributions[u]&&a.push(u);var m=[];this.options.prefix&&m.push(this.options.prefix),a.length&&m.push(a.join(", ")),this._container.innerHTML=m.join(' <span aria-hidden="true">|</span> ')}}});$t.mergeOptions({attributionControl:!0}),$t.addInitHook(function(){this.options.attributionControl&&new na().addTo(this)});var Bs=function(a){return new na(a)};En.Layers=ml,En.Zoom=ls,En.Scale=gl,En.Attribution=na,is.layers=xi,is.zoom=$i,is.scale=dr,is.attribution=Bs;var Pn=Q.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Pn.addTo=function(a,u){return a.addHandler(u,this),this};var Ti={Events:K},Mi=Qe.touch?"touchstart mousedown":"mousedown",Po=ae.extend({options:{clickTolerance:3},initialize:function(a,u,m,S){x(this,S),this._element=a,this._dragStartTarget=u||a,this._preventOutline=m},enable:function(){this._enabled||(wt(this._dragStartTarget,Mi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Po._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,Mi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!ss(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Po._dragging===this&&this.finishDrag();return}if(!(Po._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Po._dragging=this,this._preventOutline&&Ra(this._element),_i(),lo(),!this._moving)){this.fire("down");var u=a.touches?a.touches[0]:a,m=Ci(this._element);this._startPoint=new q(u.clientX,u.clientY),this._startPos=Wn(this._element),this._parentScale=Li(m);var S=a.type==="mousedown";wt(document,S?"mousemove":"touchmove",this._onMove,this),wt(document,S?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var u=a.touches&&a.touches.length===1?a.touches[0]:a,m=new q(u.clientX,u.clientY)._subtract(this._startPoint);!m.x&&!m.y||Math.abs(m.x)+Math.abs(m.y)<this.options.clickTolerance||(m.x/=this._parentScale.x,m.y/=this._parentScale.y,qt(a),this._moved||(this.fire("dragstart"),this._moved=!0,pt(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(m),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),en(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Vt(document.body,"leaflet-dragging"),this._lastTarget&&(Vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),Pa(),Ps();var u=this._moved&&this._moving;this._moving=!1,Po._dragging=!1,u&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function yl(a,u,m){var S,B=[1,4,2,8],W,he,Me,Ue,Xe,it,gt,Mt;for(W=0,it=a.length;W<it;W++)a[W]._code=rs(a[W],u);for(Me=0;Me<4;Me++){for(gt=B[Me],S=[],W=0,it=a.length,he=it-1;W<it;he=W++)Ue=a[W],Xe=a[he],Ue._code&gt?Xe._code&gt||(Mt=Ha(Xe,Ue,gt,u,m),Mt._code=rs(Mt,u),S.push(Mt)):(Xe._code&gt&&(Mt=Ha(Xe,Ue,gt,u,m),Mt._code=rs(Mt,u),S.push(Mt)),S.push(Ue));a=S}return a}function kl(a,u){var m,S,B,W,he,Me,Ue,Xe,it;if(!a||a.length===0)throw new Error("latlngs not passed");Nn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var gt=be([0,0]),Mt=De(a),uo=Mt.getNorthWest().distanceTo(Mt.getSouthWest())*Mt.getNorthEast().distanceTo(Mt.getNorthWest());uo<1700&&(gt=Ns(a));var Dn=a.length,Ko=[];for(m=0;m<Dn;m++){var So=be(a[m]);Ko.push(u.project(be([So.lat-gt.lat,So.lng-gt.lng])))}for(Me=Ue=Xe=0,m=0,S=Dn-1;m<Dn;S=m++)B=Ko[m],W=Ko[S],he=B.y*W.x-W.y*B.x,Ue+=(B.x+W.x)*he,Xe+=(B.y+W.y)*he,Me+=he*3;Me===0?it=Ko[0]:it=[Ue/Me,Xe/Me];var Dl=u.unproject(ee(it));return be([Dl.lat+gt.lat,Dl.lng+gt.lng])}function Ns(a){for(var u=0,m=0,S=0,B=0;B<a.length;B++){var W=be(a[B]);u+=W.lat,m+=W.lng,S++}return be([u/S,m/S])}var Na={__proto__:null,clipPolygon:yl,polygonCenter:kl,centroid:Ns};function Fa(a,u){if(!u||!a.length)return a.slice();var m=u*u;return a=fr(a,m),a=wl(a,m),a}function bl(a,u,m){return Math.sqrt(sa(a,u,m,!0))}function hr(a,u,m){return sa(a,u,m)}function wl(a,u){var m=a.length,S=typeof Uint8Array<"u"?Uint8Array:Array,B=new S(m);B[0]=B[m-1]=1,Ua(a,B,u,0,m-1);var W,he=[];for(W=0;W<m;W++)B[W]&&he.push(a[W]);return he}function Ua(a,u,m,S,B){var W=0,he,Me,Ue;for(Me=S+1;Me<=B-1;Me++)Ue=sa(a[Me],a[S],a[B],!0),Ue>W&&(he=Me,W=Ue);W>m&&(u[he]=1,Ua(a,u,m,S,he),Ua(a,u,m,he,B))}function fr(a,u){for(var m=[a[0]],S=1,B=0,W=a.length;S<W;S++)pr(a[S],a[B])>u&&(m.push(a[S]),B=S);return B<W-1&&m.push(a[W-1]),m}var za;function oa(a,u,m,S,B){var W=S?za:rs(a,m),he=rs(u,m),Me,Ue,Xe;for(za=he;;){if(!(W|he))return[a,u];if(W&he)return!1;Me=W||he,Ue=Ha(a,u,Me,m,B),Xe=rs(Ue,m),Me===W?(a=Ue,W=Xe):(u=Ue,he=Xe)}}function Ha(a,u,m,S,B){var W=u.x-a.x,he=u.y-a.y,Me=S.min,Ue=S.max,Xe,it;return m&8?(Xe=a.x+W*(Ue.y-a.y)/he,it=Ue.y):m&4?(Xe=a.x+W*(Me.y-a.y)/he,it=Me.y):m&2?(Xe=Ue.x,it=a.y+he*(Ue.x-a.x)/W):m&1&&(Xe=Me.x,it=a.y+he*(Me.x-a.x)/W),new q(Xe,it,B)}function rs(a,u){var m=0;return a.x<u.min.x?m|=1:a.x>u.max.x&&(m|=2),a.y<u.min.y?m|=4:a.y>u.max.y&&(m|=8),m}function pr(a,u){var m=u.x-a.x,S=u.y-a.y;return m*m+S*S}function sa(a,u,m,S){var B=u.x,W=u.y,he=m.x-B,Me=m.y-W,Ue=he*he+Me*Me,Xe;return Ue>0&&(Xe=((a.x-B)*he+(a.y-W)*Me)/Ue,Xe>1?(B=m.x,W=m.y):Xe>0&&(B+=he*Xe,W+=Me*Xe)),he=a.x-B,Me=a.y-W,S?he*he+Me*Me:new q(B,W)}function Nn(a){return!C(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function aa(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Nn(a)}function Va(a,u){var m,S,B,W,he,Me,Ue,Xe;if(!a||a.length===0)throw new Error("latlngs not passed");Nn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var it=be([0,0]),gt=De(a),Mt=gt.getNorthWest().distanceTo(gt.getSouthWest())*gt.getNorthEast().distanceTo(gt.getNorthWest());Mt<1700&&(it=Ns(a));var uo=a.length,Dn=[];for(m=0;m<uo;m++){var Ko=be(a[m]);Dn.push(u.project(be([Ko.lat-it.lat,Ko.lng-it.lng])))}for(m=0,S=0;m<uo-1;m++)S+=Dn[m].distanceTo(Dn[m+1])/2;if(S===0)Xe=Dn[0];else for(m=0,W=0;m<uo-1;m++)if(he=Dn[m],Me=Dn[m+1],B=he.distanceTo(Me),W+=B,W>S){Ue=(W-S)/B,Xe=[Me.x-Ue*(Me.x-he.x),Me.y-Ue*(Me.y-he.y)];break}var So=u.unproject(ee(Xe));return be([So.lat+it.lat,So.lng+it.lng])}var cs={__proto__:null,simplify:Fa,pointToSegmentDistance:bl,closestPointOnSegment:hr,clipSegment:oa,_getEdgeIntersection:Ha,_getBitCode:rs,_sqClosestPointOnSegment:sa,isFlat:Nn,_flat:aa,polylineCenter:Va},Te={project:function(a){return new q(a.lng,a.lat)},unproject:function(a){return new Re(a.y,a.x)},bounds:new ue([-180,-90],[180,90])},Le={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var u=Math.PI/180,m=this.R,S=a.lat*u,B=this.R_MINOR/m,W=Math.sqrt(1-B*B),he=W*Math.sin(S),Me=Math.tan(Math.PI/4-S/2)/Math.pow((1-he)/(1+he),W/2);return S=-m*Math.log(Math.max(Me,1e-10)),new q(a.lng*u*m,S)},unproject:function(a){for(var u=180/Math.PI,m=this.R,S=this.R_MINOR/m,B=Math.sqrt(1-S*S),W=Math.exp(-a.y/m),he=Math.PI/2-2*Math.atan(W),Me=0,Ue=.1,Xe;Me<15&&Math.abs(Ue)>1e-7;Me++)Xe=B*Math.sin(he),Xe=Math.pow((1-Xe)/(1+Xe),B/2),Ue=Math.PI/2-2*Math.atan(W*Xe)-he,he+=Ue;return new Re(he*u,a.x*u/m)}},nt={__proto__:null,LonLat:Te,Mercator:Le,SphericalMercator:ie},vt=o({},Y,{code:"EPSG:3395",projection:Le,transformation:(function(){var a=.5/(Math.PI*Le.R);return G(a,.5,-a,.5)})()}),Ct=o({},Y,{code:"EPSG:4326",projection:Te,transformation:G(1/180,1,-1/180,.5)}),Xt=o({},z,{projection:Te,transformation:G(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,u){var m=u.lng-a.lng,S=u.lat-a.lat;return Math.sqrt(m*m+S*S)},infinite:!0});z.Earth=Y,z.EPSG3395=vt,z.EPSG3857=X,z.EPSG900913=te,z.EPSG4326=Ct,z.Simple=Xt;var tn=ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var u=a.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var m=this.getEvents();u.on(m,this),this.once("remove",function(){u.off(m,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});$t.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(a);return this._layers[u]?this:(this._layers[u]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var u=d(a);return this._layers[u]?(this._loaded&&a.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return d(a)in this._layers},eachLayer:function(a,u){for(var m in this._layers)a.call(u,this._layers[m]);return this},_addLayers:function(a){a=a?C(a)?a:[a]:[];for(var u=0,m=a.length;u<m;u++)this.addLayer(a[u])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[d(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var u=d(a);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,u=-1/0,m=this._getZoomSpan();for(var S in this._zoomBoundLayers){var B=this._zoomBoundLayers[S].options;a=B.minZoom===void 0?a:Math.min(a,B.minZoom),u=B.maxZoom===void 0?u:Math.max(u,B.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=a===1/0?void 0:a,m!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var an=tn.extend({initialize:function(a,u){x(this,u),this._layers={};var m,S;if(a)for(m=0,S=a.length;m<S;m++)this.addLayer(a[m])},addLayer:function(a){var u=this.getLayerId(a);return this._layers[u]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var u=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(a){var u=typeof a=="number"?a:this.getLayerId(a);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var u=Array.prototype.slice.call(arguments,1),m,S;for(m in this._layers)S=this._layers[m],S[a]&&S[a].apply(S,u);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,u){for(var m in this._layers)a.call(u,this._layers[m]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d(a)}}),pn=function(a,u){return new an(a,u)},bn=an.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),an.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),an.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new $e;for(var u in this._layers){var m=this._layers[u];a.extend(m.getBounds?m.getBounds():m.getLatLng())}return a}}),Tt=function(a,u){return new bn(a,u)},ln=Q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){x(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,u){var m=this._getIconUrl(a);if(!m){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var S=this._createImg(m,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(S,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),S},_setIconStyles:function(a,u){var m=this.options,S=m[u+"Size"];typeof S=="number"&&(S=[S,S]);var B=ee(S),W=ee(u==="shadow"&&m.shadowAnchor||m.iconAnchor||B&&B.divideBy(2,!0));a.className="leaflet-marker-"+u+" "+(m.className||""),W&&(a.style.marginLeft=-W.x+"px",a.style.marginTop=-W.y+"px"),B&&(a.style.width=B.x+"px",a.style.height=B.y+"px")},_createImg:function(a,u){return u=u||document.createElement("img"),u.src=a,u},_getIconUrl:function(a){return Qe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function vr(a){return new ln(a)}var ia=ln.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof ia.imagePath!="string"&&(ia.imagePath=this._detectIconPath()),(this.options.imagePath||ia.imagePath)+ln.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var u=function(m,S,B){var W=S.exec(m);return W&&W[B]};return a=u(a,/^url\((['"])?(.+)\1\)$/,2),a&&u(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=bt("div","leaflet-default-icon-path",document.body),u=Wo(a,"background-image")||Wo(a,"backgroundImage");if(document.body.removeChild(a),u=this._stripUrl(u),u)return u;var m=document.querySelector('link[href$="leaflet.css"]');return m?m.href.substring(0,m.href.length-11-1):""}}),mr=Pn.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Po(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var u=this._marker,m=u._map,S=this._marker.options.autoPanSpeed,B=this._marker.options.autoPanPadding,W=Wn(u._icon),he=m.getPixelBounds(),Me=m.getPixelOrigin(),Ue=_e(he.min._subtract(Me).add(B),he.max._subtract(Me).subtract(B));if(!Ue.contains(W)){var Xe=ee((Math.max(Ue.max.x,W.x)-Ue.max.x)/(he.max.x-Ue.max.x)-(Math.min(Ue.min.x,W.x)-Ue.min.x)/(he.min.x-Ue.min.x),(Math.max(Ue.max.y,W.y)-Ue.max.y)/(he.max.y-Ue.max.y)-(Math.min(Ue.min.y,W.y)-Ue.min.y)/(he.min.y-Ue.min.y)).multiplyBy(S);m.panBy(Xe,{animate:!1}),this._draggable._newPos._add(Xe),this._draggable._startPos._add(Xe),en(u._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var u=this._marker,m=u._shadow,S=Wn(u._icon),B=u._map.layerPointToLatLng(S);m&&en(m,S),u._latlng=B,a.latlng=B,a.oldLatLng=this._oldLatLng,u.fire("move",a).fire("drag",a)},_onDragEnd:function(a){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),_l=tn.extend({options:{icon:new ia,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,u){x(this,u),this._latlng=be(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var u=this._latlng;return this._latlng=be(a),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),m=a.icon.createIcon(this._icon),S=!1;m!==this._icon&&(this._icon&&this._removeIcon(),S=!0,a.title&&(m.title=a.title),m.tagName==="IMG"&&(m.alt=a.alt||"")),pt(m,u),a.keyboard&&(m.tabIndex="0",m.setAttribute("role","button")),this._icon=m,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wt(m,"focus",this._panOnFocus,this);var B=a.icon.createShadow(this._shadow),W=!1;B!==this._shadow&&(this._removeShadow(),W=!0),B&&(pt(B,u),B.alt=""),this._shadow=B,a.opacity<1&&this._updateOpacity(),S&&this.getPane().appendChild(this._icon),this._initInteraction(),B&&W&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Dt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Dt(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&en(this._icon,a),this._shadow&&en(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mr)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mr(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Cn(this._icon,a),this._shadow&&Cn(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var u=this.options.icon.options,m=u.iconSize?ee(u.iconSize):ee(0,0),S=u.iconAnchor?ee(u.iconAnchor):ee(0,0);a.panInside(this._latlng,{paddingTopLeft:S,paddingBottomRight:m.subtract(S)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Cc(a,u){return new _l(a,u)}var Fs=tn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return x(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ai=Fs.extend({options:{fill:!0,radius:10},initialize:function(a,u){x(this,u),this._latlng=be(a),this._radius=this.options.radius},setLatLng:function(a){var u=this._latlng;return this._latlng=be(a),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var u=a&&a.radius||this._radius;return Fs.prototype.setStyle.call(this,a),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,u=this._radiusY||a,m=this._clickTolerance(),S=[a+m,u+m];this._pxBounds=new ue(this._point.subtract(S),this._point.add(S))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function cd(a,u){return new Ai(a,u)}var gr=Ai.extend({initialize:function(a,u,m){if(typeof u=="number"&&(u=o({},m,{radius:u})),x(this,u),this._latlng=be(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new $e(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Fs.prototype.setStyle,_project:function(){var a=this._latlng.lng,u=this._latlng.lat,m=this._map,S=m.options.crs;if(S.distance===Y.distance){var B=Math.PI/180,W=this._mRadius/Y.R/B,he=m.project([u+W,a]),Me=m.project([u-W,a]),Ue=he.add(Me).divideBy(2),Xe=m.unproject(Ue).lat,it=Math.acos((Math.cos(W*B)-Math.sin(u*B)*Math.sin(Xe*B))/(Math.cos(u*B)*Math.cos(Xe*B)))/B;(isNaN(it)||it===0)&&(it=W/Math.cos(Math.PI/180*u)),this._point=Ue.subtract(m.getPixelOrigin()),this._radius=isNaN(it)?0:Ue.x-m.project([Xe,a-it]).x,this._radiusY=Ue.y-he.y}else{var gt=S.unproject(S.project(this._latlng).subtract([this._mRadius,0]));this._point=m.latLngToLayerPoint(this._latlng),this._radius=this._point.x-m.latLngToLayerPoint(gt).x}this._updateBounds()}});function ud(a,u,m){return new gr(a,u,m)}var us=Fs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,u){x(this,u),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var u=1/0,m=null,S=sa,B,W,he=0,Me=this._parts.length;he<Me;he++)for(var Ue=this._parts[he],Xe=1,it=Ue.length;Xe<it;Xe++){B=Ue[Xe-1],W=Ue[Xe];var gt=S(a,B,W,!0);gt<u&&(u=gt,m=S(a,B,W))}return m&&(m.distance=Math.sqrt(u)),m},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Va(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,u){return u=u||this._defaultShape(),a=be(a),u.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new $e,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Nn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var u=[],m=Nn(a),S=0,B=a.length;S<B;S++)m?(u[S]=be(a[S]),this._bounds.extend(u[S])):u[S]=this._convertLatLngs(a[S]);return u},_project:function(){var a=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),u=new q(a,a);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(a,u,m){var S=a[0]instanceof Re,B=a.length,W,he;if(S){for(he=[],W=0;W<B;W++)he[W]=this._map.latLngToLayerPoint(a[W]),m.extend(he[W]);u.push(he)}else for(W=0;W<B;W++)this._projectLatlngs(a[W],u,m)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,m,S,B,W,he,Me,Ue;for(m=0,B=0,W=this._rings.length;m<W;m++)for(Ue=this._rings[m],S=0,he=Ue.length;S<he-1;S++)Me=oa(Ue[S],Ue[S+1],a,S,!0),Me&&(u[B]=u[B]||[],u[B].push(Me[0]),(Me[1]!==Ue[S+1]||S===he-2)&&(u[B].push(Me[1]),B++))}},_simplifyPoints:function(){for(var a=this._parts,u=this.options.smoothFactor,m=0,S=a.length;m<S;m++)a[m]=Fa(a[m],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,u){var m,S,B,W,he,Me,Ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(m=0,W=this._parts.length;m<W;m++)for(Me=this._parts[m],S=0,he=Me.length,B=he-1;S<he;B=S++)if(!(!u&&S===0)&&bl(a,Me[B],Me[S])<=Ue)return!0;return!1}});function dd(a,u){return new us(a,u)}us._flat=aa;var Ga=us.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return kl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var u=us.prototype._convertLatLngs.call(this,a),m=u.length;return m>=2&&u[0]instanceof Re&&u[0].equals(u[m-1])&&u.pop(),u},_setLatLngs:function(a){us.prototype._setLatLngs.call(this,a),Nn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Nn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,u=this.options.weight,m=new q(u,u);if(a=new ue(a.min.subtract(m),a.max.add(m)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var S=0,B=this._rings.length,W;S<B;S++)W=yl(this._rings[S],a,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var u=!1,m,S,B,W,he,Me,Ue,Xe;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(W=0,Ue=this._parts.length;W<Ue;W++)for(m=this._parts[W],he=0,Xe=m.length,Me=Xe-1;he<Xe;Me=he++)S=m[he],B=m[Me],S.y>a.y!=B.y>a.y&&a.x<(B.x-S.x)*(a.y-S.y)/(B.y-S.y)+S.x&&(u=!u);return u||us.prototype._containsPoint.call(this,a,!0)}});function hd(a,u){return new Ga(a,u)}var ds=bn.extend({initialize:function(a,u){x(this,u),this._layers={},a&&this.addData(a)},addData:function(a){var u=C(a)?a:a.features,m,S,B;if(u){for(m=0,S=u.length;m<S;m++)B=u[m],(B.geometries||B.geometry||B.features||B.coordinates)&&this.addData(B);return this}var W=this.options;if(W.filter&&!W.filter(a))return this;var he=Cl(a,W);return he?(he.feature=Sl(a),he.defaultOptions=he.options,this.resetStyle(he),W.onEachFeature&&W.onEachFeature(a,he),this.addLayer(he)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=o({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(u){this._setLayerStyle(u,a)},this)},_setLayerStyle:function(a,u){a.setStyle&&(typeof u=="function"&&(u=u(a.feature)),a.setStyle(u))}});function Cl(a,u){var m=a.type==="Feature"?a.geometry:a,S=m?m.coordinates:null,B=[],W=u&&u.pointToLayer,he=u&&u.coordsToLatLng||yr,Me,Ue,Xe,it;if(!S&&!m)return null;switch(m.type){case"Point":return Me=he(S),Lc(W,a,Me,u);case"MultiPoint":for(Xe=0,it=S.length;Xe<it;Xe++)Me=he(S[Xe]),B.push(Lc(W,a,Me,u));return new bn(B);case"LineString":case"MultiLineString":return Ue=Ll(S,m.type==="LineString"?0:1,he),new us(Ue,u);case"Polygon":case"MultiPolygon":return Ue=Ll(S,m.type==="Polygon"?1:2,he),new Ga(Ue,u);case"GeometryCollection":for(Xe=0,it=m.geometries.length;Xe<it;Xe++){var gt=Cl({geometry:m.geometries[Xe],type:"Feature",properties:a.properties},u);gt&&B.push(gt)}return new bn(B);case"FeatureCollection":for(Xe=0,it=m.features.length;Xe<it;Xe++){var Mt=Cl(m.features[Xe],u);Mt&&B.push(Mt)}return new bn(B);default:throw new Error("Invalid GeoJSON object.")}}function Lc(a,u,m,S){return a?a(u,m):new _l(m,S&&S.markersInheritOptions&&S)}function yr(a){return new Re(a[1],a[0],a[2])}function Ll(a,u,m){for(var S=[],B=0,W=a.length,he;B<W;B++)he=u?Ll(a[B],u-1,m):(m||yr)(a[B]),S.push(he);return S}function qa(a,u){return a=be(a),a.alt!==void 0?[g(a.lng,u),g(a.lat,u),g(a.alt,u)]:[g(a.lng,u),g(a.lat,u)]}function Il(a,u,m,S){for(var B=[],W=0,he=a.length;W<he;W++)B.push(u?Il(a[W],Nn(a[W])?0:u-1,m,S):qa(a[W],S));return!u&&m&&B.length>0&&B.push(B[0].slice()),B}function hs(a,u){return a.feature?o({},a.feature,{geometry:u}):Sl(u)}function Sl(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var xl={toGeoJSON:function(a){return hs(this,{type:"Point",coordinates:qa(this.getLatLng(),a)})}};_l.include(xl),gr.include(xl),Ai.include(xl),us.include({toGeoJSON:function(a){var u=!Nn(this._latlngs),m=Il(this._latlngs,u?1:0,!1,a);return hs(this,{type:(u?"Multi":"")+"LineString",coordinates:m})}}),Ga.include({toGeoJSON:function(a){var u=!Nn(this._latlngs),m=u&&!Nn(this._latlngs[0]),S=Il(this._latlngs,m?2:u?1:0,!0,a);return u||(S=[S]),hs(this,{type:(m?"Multi":"")+"Polygon",coordinates:S})}}),an.include({toMultiPoint:function(a){var u=[];return this.eachLayer(function(m){u.push(m.toGeoJSON(a).geometry.coordinates)}),hs(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(a){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(a);var m=u==="GeometryCollection",S=[];return this.eachLayer(function(B){if(B.toGeoJSON){var W=B.toGeoJSON(a);if(m)S.push(W.geometry);else{var he=Sl(W);he.type==="FeatureCollection"?S.push.apply(S,he.features):S.push(he)}}}),m?hs(this,{geometries:S,type:"GeometryCollection"}):{type:"FeatureCollection",features:S}}});function $l(a,u){return new ds(a,u)}var kr=$l,Tl=tn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,u,m){this._url=a,this._bounds=De(u),x(this,m)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Dt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&On(this._image),this},bringToBack:function(){return this._map&&Bn(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=De(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",u=this._image=a?this._url:bt("img");if(pt(u,"leaflet-image-layer"),this._zoomAnimated&&pt(u,"leaflet-zoom-animated"),this.options.className&&pt(u,this.options.className),u.onselectstart=v,u.onmousemove=v,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(a){var u=this._map.getZoomScale(a.zoom),m=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Io(this._image,m,u)},_reset:function(){var a=this._image,u=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),m=u.getSize();en(a,u.min),a.style.width=m.x+"px",a.style.height=m.y+"px"},_updateOpacity:function(){Cn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),fd=function(a,u,m){return new Tl(a,u,m)},Ic=Tl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",u=this._image=a?this._url:bt("video");if(pt(u,"leaflet-image-layer"),this._zoomAnimated&&pt(u,"leaflet-zoom-animated"),this.options.className&&pt(u,this.options.className),u.onselectstart=v,u.onmousemove=v,u.onloadeddata=l(this.fire,this,"load"),a){for(var m=u.getElementsByTagName("source"),S=[],B=0;B<m.length;B++)S.push(m[B].src);this._url=m.length>0?S:[u.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var he=bt("source");he.src=this._url[W],u.appendChild(he)}}});function pd(a,u,m){return new Ic(a,u,m)}var Sc=Tl.extend({_initImage:function(){var a=this._image=this._url;pt(a,"leaflet-image-layer"),this._zoomAnimated&&pt(a,"leaflet-zoom-animated"),this.options.className&&pt(a,this.options.className),a.onselectstart=v,a.onmousemove=v}});function vd(a,u,m){return new Sc(a,u,m)}var Zo=tn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,u){a&&(a instanceof Re||C(a))?(this._latlng=be(a),x(this,u)):(x(this,a),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Cn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Cn(this._container,1),this.bringToFront(),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Cn(this._container,0),this._removeTimeout=setTimeout(l(Dt,void 0,this._container),200)):Dt(this._container),this.options.interactive&&(Vt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=be(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&On(this._container),this},bringToBack:function(){return this._map&&Bn(this._container),this},_prepareOpen:function(a){var u=this._source;if(!u._map)return!1;if(u instanceof bn){u=null;var m=this._source._layers;for(var S in m)if(m[S]._map){u=m[S];break}if(!u)return!1;this._source=u}if(!a)if(u.getCenter)a=u.getCenter();else if(u.getLatLng)a=u.getLatLng();else if(u.getBounds)a=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")a.innerHTML=u;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),u=ee(this.options.offset),m=this._getAnchor();this._zoomAnimated?en(this._container,a.add(m)):u=u.add(a).add(m);var S=this._containerBottom=-u.y,B=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=S+"px",this._container.style.left=B+"px"}},_getAnchor:function(){return[0,0]}});$t.include({_initOverlay:function(a,u,m,S){var B=u;return B instanceof a||(B=new a(S).setContent(u)),m&&B.setLatLng(m),B}}),tn.include({_initOverlay:function(a,u,m,S){var B=m;return B instanceof a?(x(B,S),B._source=this):(B=u&&!S?u:new a(S,this),B.setContent(m)),B}});var Ml=Zo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Zo.prototype.openOn.call(this,a)},onAdd:function(a){Zo.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Fs||this._source.on("preclick",as))},onRemove:function(a){Zo.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Fs||this._source.off("preclick",as))},getEvents:function(){var a=Zo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",u=this._container=bt("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),m=this._wrapper=bt("div",a+"-content-wrapper",u);if(this._contentNode=bt("div",a+"-content",m),kn(u),Zn(this._contentNode),wt(u,"contextmenu",as),this._tipContainer=bt("div",a+"-tip-container",u),this._tip=bt("div",a+"-tip",this._tipContainer),this.options.closeButton){var S=this._closeButton=bt("a",a+"-close-button",u);S.setAttribute("role","button"),S.setAttribute("aria-label","Close popup"),S.href="#close",S.innerHTML='<span aria-hidden="true">&#215;</span>',wt(S,"click",function(B){qt(B),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,u=a.style;u.width="",u.whiteSpace="nowrap";var m=a.offsetWidth;m=Math.min(m,this.options.maxWidth),m=Math.max(m,this.options.minWidth),u.width=m+1+"px",u.whiteSpace="",u.height="";var S=a.offsetHeight,B=this.options.maxHeight,W="leaflet-popup-scrolled";B&&S>B?(u.height=B+"px",pt(a,W)):Vt(a,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),m=this._getAnchor();en(this._container,u.add(m))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,u=parseInt(Wo(this._container,"marginBottom"),10)||0,m=this._container.offsetHeight+u,S=this._containerWidth,B=new q(this._containerLeft,-m-this._containerBottom);B._add(Wn(this._container));var W=a.layerPointToContainerPoint(B),he=ee(this.options.autoPanPadding),Me=ee(this.options.autoPanPaddingTopLeft||he),Ue=ee(this.options.autoPanPaddingBottomRight||he),Xe=a.getSize(),it=0,gt=0;W.x+S+Ue.x>Xe.x&&(it=W.x+S-Xe.x+Ue.x),W.x-it-Me.x<0&&(it=W.x-Me.x),W.y+m+Ue.y>Xe.y&&(gt=W.y+m-Xe.y+Ue.y),W.y-gt-Me.y<0&&(gt=W.y-Me.y),(it||gt)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([it,gt]))}},_getAnchor:function(){return ee(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),md=function(a,u){return new Ml(a,u)};$t.mergeOptions({closePopupOnClick:!0}),$t.include({openPopup:function(a,u,m){return this._initOverlay(Ml,a,u,m).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),tn.include({bindPopup:function(a,u){return this._popup=this._initOverlay(Ml,this._popup,a,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof bn||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){co(a);var u=a.layer||a.target;if(this._popup._source===u&&!(u instanceof Fs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=u,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Al=Zo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Zo.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Zo.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Zo.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",u=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=bt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var u,m,S=this._map,B=this._container,W=S.latLngToContainerPoint(S.getCenter()),he=S.layerPointToContainerPoint(a),Me=this.options.direction,Ue=B.offsetWidth,Xe=B.offsetHeight,it=ee(this.options.offset),gt=this._getAnchor();Me==="top"?(u=Ue/2,m=Xe):Me==="bottom"?(u=Ue/2,m=0):Me==="center"?(u=Ue/2,m=Xe/2):Me==="right"?(u=0,m=Xe/2):Me==="left"?(u=Ue,m=Xe/2):he.x<W.x?(Me="right",u=0,m=Xe/2):(Me="left",u=Ue+(it.x+gt.x)*2,m=Xe/2),a=a.subtract(ee(u,m,!0)).add(it).add(gt),Vt(B,"leaflet-tooltip-right"),Vt(B,"leaflet-tooltip-left"),Vt(B,"leaflet-tooltip-top"),Vt(B,"leaflet-tooltip-bottom"),pt(B,"leaflet-tooltip-"+Me),en(B,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Cn(this._container,a)},_animateZoom:function(a){var u=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(u)},_getAnchor:function(){return ee(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),xc=function(a,u){return new Al(a,u)};$t.include({openTooltip:function(a,u,m){return this._initOverlay(Al,a,u,m).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),tn.include({bindTooltip:function(a,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Al,this._tooltip,a,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var u=a?"off":"on",m={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?m.add=this._openTooltip:(m.mouseover=this._openTooltip,m.mouseout=this.closeTooltip,m.click=this._openTooltip,this._map?this._addFocusListeners():m.add=this._addFocusListeners),this._tooltip.options.sticky&&(m.mousemove=this._moveTooltip),this[u](m),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof bn||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&(wt(u,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),wt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var u=typeof a.getElement=="function"&&a.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var u=a.latlng,m,S;this._tooltip.options.sticky&&a.originalEvent&&(m=this._map.mouseEventToContainerPoint(a.originalEvent),S=this._map.containerPointToLayerPoint(m),u=this._map.layerPointToLatLng(S)),this._tooltip.setLatLng(u)}});var $c=ln.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var u=a&&a.tagName==="DIV"?a:document.createElement("div"),m=this.options;if(m.html instanceof Element?(jn(u),u.appendChild(m.html)):u.innerHTML=m.html!==!1?m.html:"",m.bgPos){var S=ee(m.bgPos);u.style.backgroundPosition=-S.x+"px "+-S.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function Tc(a){return new $c(a)}ln.Default=ia;var Ei=tn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){x(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Dt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(On(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Bn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof q?a:new q(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var u=this.getPane().children,m=-a(-1/0,1/0),S=0,B=u.length,W;S<B;S++)W=u[S].style.zIndex,u[S]!==this._container&&W&&(m=a(m,+W));isFinite(m)&&(this.options.zIndex=m+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){Cn(this._container,this.options.opacity);var a=+new Date,u=!1,m=!1;for(var S in this._tiles){var B=this._tiles[S];if(!(!B.current||!B.loaded)){var W=Math.min(1,(a-B.loaded)/200);Cn(B.el,W),W<1?u=!0:(B.active?m=!0:this._onOpaqueTile(B),B.active=!0)}}m&&!this._noPrune&&this._pruneTiles(),u&&(j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=bt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,u=this.options.maxZoom;if(a!==void 0){for(var m in this._levels)m=Number(m),this._levels[m].el.children.length||m===a?(this._levels[m].el.style.zIndex=u-Math.abs(a-m),this._onUpdateLevel(m)):(Dt(this._levels[m].el),this._removeTilesAtZoom(m),this._onRemoveLevel(m),delete this._levels[m]);var S=this._levels[a],B=this._map;return S||(S=this._levels[a]={},S.el=bt("div","leaflet-tile-container leaflet-zoom-animated",this._container),S.el.style.zIndex=u,S.origin=B.project(B.unproject(B.getPixelOrigin()),a).round(),S.zoom=a,this._setZoomTransform(S,B.getCenter(),B.getZoom()),v(S.el.offsetWidth),this._onCreateLevel(S)),this._level=S,S}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var a,u,m=this._map.getZoom();if(m>this.options.maxZoom||m<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)u=this._tiles[a],u.retain=u.current;for(a in this._tiles)if(u=this._tiles[a],u.current&&!u.active){var S=u.coords;this._retainParent(S.x,S.y,S.z,S.z-5)||this._retainChildren(S.x,S.y,S.z,S.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var u in this._tiles)this._tiles[u].coords.z===a&&this._removeTile(u)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Dt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,u,m,S){var B=Math.floor(a/2),W=Math.floor(u/2),he=m-1,Me=new q(+B,+W);Me.z=+he;var Ue=this._tileCoordsToKey(Me),Xe=this._tiles[Ue];return Xe&&Xe.active?(Xe.retain=!0,!0):(Xe&&Xe.loaded&&(Xe.retain=!0),he>S?this._retainParent(B,W,he,S):!1)},_retainChildren:function(a,u,m,S){for(var B=2*a;B<2*a+2;B++)for(var W=2*u;W<2*u+2;W++){var he=new q(B,W);he.z=m+1;var Me=this._tileCoordsToKey(he),Ue=this._tiles[Me];if(Ue&&Ue.active){Ue.retain=!0;continue}else Ue&&Ue.loaded&&(Ue.retain=!0);m+1<S&&this._retainChildren(B,W,m+1,S)}},_resetView:function(a){var u=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var u=this.options;return u.minNativeZoom!==void 0&&a<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<a?u.maxNativeZoom:a},_setView:function(a,u,m,S){var B=Math.round(u);this.options.maxZoom!==void 0&&B>this.options.maxZoom||this.options.minZoom!==void 0&&B<this.options.minZoom?B=void 0:B=this._clampZoom(B);var W=this.options.updateWhenZooming&&B!==this._tileZoom;(!S||W)&&(this._tileZoom=B,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),B!==void 0&&this._update(a),m||this._pruneTiles(),this._noPrune=!!m),this._setZoomTransforms(a,u)},_setZoomTransforms:function(a,u){for(var m in this._levels)this._setZoomTransform(this._levels[m],a,u)},_setZoomTransform:function(a,u,m){var S=this._map.getZoomScale(m,a.zoom),B=a.origin.multiplyBy(S).subtract(this._map._getNewPixelOrigin(u,m)).round();Qe.any3d?Io(a.el,B,S):en(a.el,B)},_resetGrid:function(){var a=this._map,u=a.options.crs,m=this._tileSize=this.getTileSize(),S=this._tileZoom,B=this._map.getPixelWorldBounds(this._tileZoom);B&&(this._globalTileRange=this._pxBoundsToTileRange(B)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,u.wrapLng[0]],S).x/m.x),Math.ceil(a.project([0,u.wrapLng[1]],S).x/m.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([u.wrapLat[0],0],S).y/m.x),Math.ceil(a.project([u.wrapLat[1],0],S).y/m.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var u=this._map,m=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),S=u.getZoomScale(m,this._tileZoom),B=u.project(a,this._tileZoom).floor(),W=u.getSize().divideBy(S*2);return new ue(B.subtract(W),B.add(W))},_update:function(a){var u=this._map;if(u){var m=this._clampZoom(u.getZoom());if(a===void 0&&(a=u.getCenter()),this._tileZoom!==void 0){var S=this._getTiledPixelBounds(a),B=this._pxBoundsToTileRange(S),W=B.getCenter(),he=[],Me=this.options.keepBuffer,Ue=new ue(B.getBottomLeft().subtract([Me,-Me]),B.getTopRight().add([Me,-Me]));if(!(isFinite(B.min.x)&&isFinite(B.min.y)&&isFinite(B.max.x)&&isFinite(B.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Xe in this._tiles){var it=this._tiles[Xe].coords;(it.z!==this._tileZoom||!Ue.contains(new q(it.x,it.y)))&&(this._tiles[Xe].current=!1)}if(Math.abs(m-this._tileZoom)>1){this._setView(a,m);return}for(var gt=B.min.y;gt<=B.max.y;gt++)for(var Mt=B.min.x;Mt<=B.max.x;Mt++){var uo=new q(Mt,gt);if(uo.z=this._tileZoom,!!this._isValidTile(uo)){var Dn=this._tiles[this._tileCoordsToKey(uo)];Dn?Dn.current=!0:he.push(uo)}}if(he.sort(function(So,Dl){return So.distanceTo(W)-Dl.distanceTo(W)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ko=document.createDocumentFragment();for(Mt=0;Mt<he.length;Mt++)this._addTile(he[Mt],Ko);this._level.el.appendChild(Ko)}}}},_isValidTile:function(a){var u=this._map.options.crs;if(!u.infinite){var m=this._globalTileRange;if(!u.wrapLng&&(a.x<m.min.x||a.x>m.max.x)||!u.wrapLat&&(a.y<m.min.y||a.y>m.max.y))return!1}if(!this.options.bounds)return!0;var S=this._tileCoordsToBounds(a);return De(this.options.bounds).overlaps(S)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var u=this._map,m=this.getTileSize(),S=a.scaleBy(m),B=S.add(m),W=u.unproject(S,a.z),he=u.unproject(B,a.z);return[W,he]},_tileCoordsToBounds:function(a){var u=this._tileCoordsToNwSe(a),m=new $e(u[0],u[1]);return this.options.noWrap||(m=this._map.wrapLatLngBounds(m)),m},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var u=a.split(":"),m=new q(+u[0],+u[1]);return m.z=+u[2],m},_removeTile:function(a){var u=this._tiles[a];u&&(Dt(u.el),delete this._tiles[a],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){pt(a,"leaflet-tile");var u=this.getTileSize();a.style.width=u.x+"px",a.style.height=u.y+"px",a.onselectstart=v,a.onmousemove=v,Qe.ielt9&&this.options.opacity<1&&Cn(a,this.options.opacity)},_addTile:function(a,u){var m=this._getTilePos(a),S=this._tileCoordsToKey(a),B=this.createTile(this._wrapCoords(a),l(this._tileReady,this,a));this._initTile(B),this.createTile.length<2&&F(l(this._tileReady,this,a,null,B)),en(B,m),this._tiles[S]={el:B,coords:a,current:!0},u.appendChild(B),this.fire("tileloadstart",{tile:B,coords:a})},_tileReady:function(a,u,m){u&&this.fire("tileerror",{error:u,tile:m,coords:a});var S=this._tileCoordsToKey(a);m=this._tiles[S],m&&(m.loaded=+new Date,this._map._fadeAnimated?(Cn(m.el,0),j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(m.active=!0,this._pruneTiles()),u||(pt(m.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:m.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var u=new q(this._wrapX?f(a.x,this._wrapX):a.x,this._wrapY?f(a.y,this._wrapY):a.y);return u.z=a.z,u},_pxBoundsToTileRange:function(a){var u=this.getTileSize();return new ue(a.min.unscaleBy(u).floor(),a.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function gd(a){return new Ei(a)}var ja=Ei.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,u){this._url=a,u=x(this,u),u.detectRetina&&Qe.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,u){return this._url===a&&u===void 0&&(u=!0),this._url=a,u||this.redraw(),this},createTile:function(a,u){var m=document.createElement("img");return wt(m,"load",l(this._tileOnLoad,this,u,m)),wt(m,"error",l(this._tileOnError,this,u,m)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(m.referrerPolicy=this.options.referrerPolicy),m.alt="",m.src=this.getTileUrl(a),m},getTileUrl:function(a){var u={r:Qe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var m=this._globalTileRange.max.y-a.y;this.options.tms&&(u.y=m),u["-y"]=m}return w(this._url,o(u,this.options))},_tileOnLoad:function(a,u){Qe.ielt9?setTimeout(l(a,this,null,u),0):a(null,u)},_tileOnError:function(a,u,m){var S=this.options.errorTileUrl;S&&u.getAttribute("src")!==S&&(u.src=S),a(m,u)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,u=this.options.maxZoom,m=this.options.zoomReverse,S=this.options.zoomOffset;return m&&(a=u-a),a+S},_getSubdomain:function(a){var u=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var a,u;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(u=this._tiles[a].el,u.onload=v,u.onerror=v,!u.complete)){u.src=$;var m=this._tiles[a].coords;Dt(u),delete this._tiles[a],this.fire("tileabort",{tile:u,coords:m})}},_removeTile:function(a){var u=this._tiles[a];if(u)return u.el.setAttribute("src",$),Ei.prototype._removeTile.call(this,a)},_tileReady:function(a,u,m){if(!(!this._map||m&&m.getAttribute("src")===$))return Ei.prototype._tileReady.call(this,a,u,m)}});function El(a,u){return new ja(a,u)}var Mc=ja.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,u){this._url=a;var m=o({},this.defaultWmsParams);for(var S in u)S in this.options||(m[S]=u[S]);u=x(this,u);var B=u.detectRetina&&Qe.retina?2:1,W=this.getTileSize();m.width=W.x*B,m.height=W.y*B,this.wmsParams=m},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,ja.prototype.onAdd.call(this,a)},getTileUrl:function(a){var u=this._tileCoordsToNwSe(a),m=this._crs,S=_e(m.project(u[0]),m.project(u[1])),B=S.min,W=S.max,he=(this._wmsVersion>=1.3&&this._crs===Ct?[B.y,B.x,W.y,W.x]:[B.x,B.y,W.x,W.y]).join(","),Me=ja.prototype.getTileUrl.call(this,a);return Me+A(this.wmsParams,Me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(a,u){return o(this.wmsParams,a),u||this.redraw(),this}});function yd(a,u){return new Mc(a,u)}ja.WMS=Mc,El.wms=yd;var fs=tn.extend({options:{padding:.1},initialize:function(a){x(this,a),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,u){var m=this._map.getZoomScale(u,this._zoom),S=this._map.getSize().multiplyBy(.5+this.options.padding),B=this._map.project(this._center,u),W=S.multiplyBy(-m).add(B).subtract(this._map._getNewPixelOrigin(a,u));Qe.any3d?Io(this._container,W,m):en(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,u=this._map.getSize(),m=this._map.containerPointToLayerPoint(u.multiplyBy(-a)).round();this._bounds=new ue(m,m.add(u.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),br=fs.extend({options:{tolerance:0},getEvents:function(){var a=fs.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");wt(a,"mousemove",this._onMouseMove,this),wt(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),wt(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Dt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var u in this._layers)a=this._layers[u],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fs.prototype._update.call(this);var a=this._bounds,u=this._container,m=a.getSize(),S=Qe.retina?2:1;en(u,a.min),u.width=S*m.x,u.height=S*m.y,u.style.width=m.x+"px",u.style.height=m.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){fs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[d(a)]=a;var u=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var u=a._order,m=u.next,S=u.prev;m?m.prev=S:this._drawLast=S,S?S.next=m:this._drawFirst=m,delete a._order,delete this._layers[d(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var u=a.options.dashArray.split(/[, ]+/),m=[],S,B;for(B=0;B<u.length;B++){if(S=Number(u[B]),isNaN(S))return;m.push(S)}a.options._dashArray=m}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var u=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(a._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(a._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var u=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,u=this._redrawBounds;if(this._ctx.save(),u){var m=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,m.x,m.y),this._ctx.clip()}this._drawing=!0;for(var S=this._drawFirst;S;S=S.next)a=S.layer,(!u||a._pxBounds&&a._pxBounds.intersects(u))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,u){if(this._drawing){var m,S,B,W,he=a._parts,Me=he.length,Ue=this._ctx;if(Me){for(Ue.beginPath(),m=0;m<Me;m++){for(S=0,B=he[m].length;S<B;S++)W=he[m][S],Ue[S?"lineTo":"moveTo"](W.x,W.y);u&&Ue.closePath()}this._fillStroke(Ue,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var u=a._point,m=this._ctx,S=Math.max(Math.round(a._radius),1),B=(Math.max(Math.round(a._radiusY),1)||S)/S;B!==1&&(m.save(),m.scale(1,B)),m.beginPath(),m.arc(u.x,u.y/B,S,0,Math.PI*2,!1),B!==1&&m.restore(),this._fillStroke(m,a)}},_fillStroke:function(a,u){var m=u.options;m.fill&&(a.globalAlpha=m.fillOpacity,a.fillStyle=m.fillColor||m.color,a.fill(m.fillRule||"evenodd")),m.stroke&&m.weight!==0&&(a.setLineDash&&a.setLineDash(u.options&&u.options._dashArray||[]),a.globalAlpha=m.opacity,a.lineWidth=m.weight,a.strokeStyle=m.color,a.lineCap=m.lineCap,a.lineJoin=m.lineJoin,a.stroke())},_onClick:function(a){for(var u=this._map.mouseEventToLayerPoint(a),m,S,B=this._drawFirst;B;B=B.next)m=B.layer,m.options.interactive&&m._containsPoint(u)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(m))&&(S=m);this._fireEvent(S?[S]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,u)}},_handleMouseOut:function(a){var u=this._hoveredLayer;u&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([u],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,u){if(!this._mouseHoverThrottled){for(var m,S,B=this._drawFirst;B;B=B.next)m=B.layer,m.options.interactive&&m._containsPoint(u)&&(S=m);S!==this._hoveredLayer&&(this._handleMouseOut(a),S&&(pt(this._container,"leaflet-interactive"),this._fireEvent([S],a,"mouseover"),this._hoveredLayer=S)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,u,m){this._map._fireDOMEvent(u,m||u.type,a)},_bringToFront:function(a){var u=a._order;if(u){var m=u.next,S=u.prev;if(m)m.prev=S;else return;S?S.next=m:m&&(this._drawFirst=m),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(a)}},_bringToBack:function(a){var u=a._order;if(u){var m=u.next,S=u.prev;if(S)S.next=m;else return;m?m.prev=S:S&&(this._drawLast=S),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(a)}}});function Ac(a){return Qe.canvas?new br(a):null}var ps=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ec={_initContainer:function(){this._container=bt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fs.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var u=a._container=ps("shape");pt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",a._path=ps("path"),u.appendChild(a._path),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){var u=a._container;this._container.appendChild(u),a.options.interactive&&a.addInteractiveTarget(u)},_removePath:function(a){var u=a._container;Dt(u),a.removeInteractiveTarget(u),delete this._layers[d(a)]},_updateStyle:function(a){var u=a._stroke,m=a._fill,S=a.options,B=a._container;B.stroked=!!S.stroke,B.filled=!!S.fill,S.stroke?(u||(u=a._stroke=ps("stroke")),B.appendChild(u),u.weight=S.weight+"px",u.color=S.color,u.opacity=S.opacity,S.dashArray?u.dashStyle=C(S.dashArray)?S.dashArray.join(" "):S.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=S.lineCap.replace("butt","flat"),u.joinstyle=S.lineJoin):u&&(B.removeChild(u),a._stroke=null),S.fill?(m||(m=a._fill=ps("fill")),B.appendChild(m),m.color=S.fillColor||S.color,m.opacity=S.fillOpacity):m&&(B.removeChild(m),a._fill=null)},_updateCircle:function(a){var u=a._point.round(),m=Math.round(a._radius),S=Math.round(a._radiusY||m);this._setPath(a,a._empty()?"M0 0":"AL "+u.x+","+u.y+" "+m+","+S+" 0,"+65535*360)},_setPath:function(a,u){a._path.v=u},_bringToFront:function(a){On(a._container)},_bringToBack:function(a){Bn(a._container)}},Pi=Qe.vml?ps:Ce,Wa=fs.extend({_initContainer:function(){this._container=Pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Dt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fs.prototype._update.call(this);var a=this._bounds,u=a.getSize(),m=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,m.setAttribute("width",u.x),m.setAttribute("height",u.y)),en(m,a.min),m.setAttribute("viewBox",[a.min.x,a.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(a){var u=a._path=Pi("path");a.options.className&&pt(u,a.options.className),a.options.interactive&&pt(u,"leaflet-interactive"),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Dt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[d(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var u=a._path,m=a.options;u&&(m.stroke?(u.setAttribute("stroke",m.color),u.setAttribute("stroke-opacity",m.opacity),u.setAttribute("stroke-width",m.weight),u.setAttribute("stroke-linecap",m.lineCap),u.setAttribute("stroke-linejoin",m.lineJoin),m.dashArray?u.setAttribute("stroke-dasharray",m.dashArray):u.removeAttribute("stroke-dasharray"),m.dashOffset?u.setAttribute("stroke-dashoffset",m.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),m.fill?(u.setAttribute("fill",m.fillColor||m.color),u.setAttribute("fill-opacity",m.fillOpacity),u.setAttribute("fill-rule",m.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(a,u){this._setPath(a,Ne(a._parts,u))},_updateCircle:function(a){var u=a._point,m=Math.max(Math.round(a._radius),1),S=Math.max(Math.round(a._radiusY),1)||m,B="a"+m+","+S+" 0 1,0 ",W=a._empty()?"M0 0":"M"+(u.x-m)+","+u.y+B+m*2+",0 "+B+-m*2+",0 ";this._setPath(a,W)},_setPath:function(a,u){a._path.setAttribute("d",u)},_bringToFront:function(a){On(a._path)},_bringToBack:function(a){Bn(a._path)}});Qe.vml&&Wa.include(Ec);function V(a){return Qe.svg||Qe.vml?new Wa(a):null}$t.include({getRenderer:function(a){var u=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var u=this._paneRenderers[a];return u===void 0&&(u=this._createRenderer({pane:a}),this._paneRenderers[a]=u),u},_createRenderer:function(a){return this.options.preferCanvas&&Ac(a)||V(a)}});var se=Ga.extend({initialize:function(a,u){Ga.prototype.initialize.call(this,this._boundsToLatLngs(a),u)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=De(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function ce(a,u){return new se(a,u)}Wa.create=Pi,Wa.pointsToPath=Ne,ds.geometryToLayer=Cl,ds.coordsToLatLng=yr,ds.coordsToLatLngs=Ll,ds.latLngToCoords=qa,ds.latLngsToCoords=Il,ds.getFeature=hs,ds.asFeature=Sl,$t.mergeOptions({boxZoom:!0});var we=Pn.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){wt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Dt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),lo(),_i(),this._startPoint=this._map.mouseEventToContainerPoint(a),wt(document,{contextmenu:co,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=bt("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var u=new ue(this._point,this._startPoint),m=u.getSize();en(this._box,u.min),this._box.style.width=m.x+"px",this._box.style.height=m.y+"px"},_finish:function(){this._moved&&(Dt(this._box),Vt(this._container,"leaflet-crosshair")),Ps(),Pa(),Ut(document,{contextmenu:co,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new $e(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});$t.addInitHook("addHandler","boxZoom",we),$t.mergeOptions({doubleClickZoom:!0});var at=Pn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var u=this._map,m=u.getZoom(),S=u.options.zoomDelta,B=a.originalEvent.shiftKey?m-S:m+S;u.options.doubleClickZoom==="center"?u.setZoom(B):u.setZoomAround(a.containerPoint,B)}});$t.addInitHook("addHandler","doubleClickZoom",at),$t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var xt=Pn.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Po(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Vt(this._map._container,"leaflet-grab"),Vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=De(this._map.options.maxBounds);this._offsetLimit=_e(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var u=this._lastTime=+new Date,m=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(m),this._times.push(u),this._prunePositions(u)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,u){return a-(a-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;a.x<u.min.x&&(a.x=this._viscousLimit(a.x,u.min.x)),a.y<u.min.y&&(a.y=this._viscousLimit(a.y,u.min.y)),a.x>u.max.x&&(a.x=this._viscousLimit(a.x,u.max.x)),a.y>u.max.y&&(a.y=this._viscousLimit(a.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,u=Math.round(a/2),m=this._initialWorldOffset,S=this._draggable._newPos.x,B=(S-u+m)%a+u-m,W=(S+u+m)%a-u-m,he=Math.abs(B+m)<Math.abs(W+m)?B:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(a){var u=this._map,m=u.options,S=!m.inertia||a.noInertia||this._times.length<2;if(u.fire("dragend",a),S)u.fire("moveend");else{this._prunePositions(+new Date);var B=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,he=m.easeLinearity,Me=B.multiplyBy(he/W),Ue=Me.distanceTo([0,0]),Xe=Math.min(m.inertiaMaxSpeed,Ue),it=Me.multiplyBy(Xe/Ue),gt=Xe/(m.inertiaDeceleration*he),Mt=it.multiplyBy(-gt/2).round();!Mt.x&&!Mt.y?u.fire("moveend"):(Mt=u._limitOffset(Mt,u.options.maxBounds),F(function(){u.panBy(Mt,{duration:gt,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});$t.addInitHook("addHandler","dragging",xt),$t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var jt=Pn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),wt(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,u=document.documentElement,m=a.scrollTop||u.scrollTop,S=a.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(S,m)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var u=this._panKeys={},m=this.keyCodes,S,B;for(S=0,B=m.left.length;S<B;S++)u[m.left[S]]=[-1*a,0];for(S=0,B=m.right.length;S<B;S++)u[m.right[S]]=[a,0];for(S=0,B=m.down.length;S<B;S++)u[m.down[S]]=[0,a];for(S=0,B=m.up.length;S<B;S++)u[m.up[S]]=[0,-1*a]},_setZoomDelta:function(a){var u=this._zoomKeys={},m=this.keyCodes,S,B;for(S=0,B=m.zoomIn.length;S<B;S++)u[m.zoomIn[S]]=a;for(S=0,B=m.zoomOut.length;S<B;S++)u[m.zoomOut[S]]=-a},_addHooks:function(){wt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var u=a.keyCode,m=this._map,S;if(u in this._panKeys){if(!m._panAnim||!m._panAnim._inProgress)if(S=this._panKeys[u],a.shiftKey&&(S=ee(S).multiplyBy(3)),m.options.maxBounds&&(S=m._limitOffset(ee(S),m.options.maxBounds)),m.options.worldCopyJump){var B=m.wrapLatLng(m.unproject(m.project(m.getCenter()).add(S)));m.panTo(B)}else m.panBy(S)}else if(u in this._zoomKeys)m.setZoom(m.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&m._popup&&m._popup.options.closeOnEscapeKey)m.closePopup();else return;co(a)}}});$t.addInitHook("addHandler","keyboard",jt),$t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var $n=Pn.extend({addHooks:function(){wt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var u=Os(a),m=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var S=Math.max(m-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),S),co(a)},_performZoom:function(){var a=this._map,u=a.getZoom(),m=this._map.options.zoomSnap||0;a._stop();var S=this._delta/(this._map.options.wheelPxPerZoomLevel*4),B=4*Math.log(2/(1+Math.exp(-Math.abs(S))))/Math.LN2,W=m?Math.ceil(B/m)*m:B,he=a._limitZoom(u+(this._delta>0?W:-W))-u;this._delta=0,this._startTime=null,he&&(a.options.scrollWheelZoom==="center"?a.setZoom(u+he):a.setZoomAround(this._lastMousePos,u+he))}});$t.addInitHook("addHandler","scrollWheelZoom",$n);var Di=600;$t.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var Ri=Pn.extend({addHooks:function(){wt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var u=a.touches[0];this._startPos=this._newPos=new q(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(wt(document,"touchend",qt),wt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Di),wt(document,"touchend touchcancel contextmenu",this._cancel,this),wt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Ut(document,"touchend",qt),Ut(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(a){var u=a.touches[0];this._newPos=new q(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,u){var m=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});m._simulated=!0,u.target.dispatchEvent(m)}});$t.addInitHook("addHandler","tapHold",Ri),$t.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var Pl=Pn.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),wt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var u=this._map;if(!(!a.touches||a.touches.length!==2||u._animatingZoom||this._zooming)){var m=u.mouseEventToContainerPoint(a.touches[0]),S=u.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(m.add(S)._divideBy(2))),this._startDist=m.distanceTo(S),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),wt(document,"touchmove",this._onTouchMove,this),wt(document,"touchend touchcancel",this._onTouchEnd,this),qt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var u=this._map,m=u.mouseEventToContainerPoint(a.touches[0]),S=u.mouseEventToContainerPoint(a.touches[1]),B=m.distanceTo(S)/this._startDist;if(this._zoom=u.getScaleZoom(B,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&B<1||this._zoom>u.getMaxZoom()&&B>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,B===1)return}else{var W=m._add(S)._divideBy(2)._subtract(this._centerPoint);if(B===1&&W.x===0&&W.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var he=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(he,this,!0),qt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});$t.addInitHook("addHandler","touchZoom",Pl),$t.BoxZoom=we,$t.DoubleClickZoom=at,$t.Drag=xt,$t.Keyboard=jt,$t.ScrollWheelZoom=$n,$t.TapHold=Ri,$t.TouchZoom=Pl,n.Bounds=ue,n.Browser=Qe,n.CRS=z,n.Canvas=br,n.Circle=gr,n.CircleMarker=Ai,n.Class=Q,n.Control=En,n.DivIcon=$c,n.DivOverlay=Zo,n.DomEvent=pl,n.DomUtil=ur,n.Draggable=Po,n.Evented=ae,n.FeatureGroup=bn,n.GeoJSON=ds,n.GridLayer=Ei,n.Handler=Pn,n.Icon=ln,n.ImageOverlay=Tl,n.LatLng=Re,n.LatLngBounds=$e,n.Layer=tn,n.LayerGroup=an,n.LineUtil=cs,n.Map=$t,n.Marker=_l,n.Mixin=Ti,n.Path=Fs,n.Point=q,n.PolyUtil=Na,n.Polygon=Ga,n.Polyline=us,n.Popup=Ml,n.PosAnimation=Si,n.Projection=nt,n.Rectangle=se,n.Renderer=fs,n.SVG=Wa,n.SVGOverlay=Sc,n.TileLayer=ja,n.Tooltip=Al,n.Transformation=Ae,n.Util=Z,n.VideoOverlay=Ic,n.bind=l,n.bounds=_e,n.canvas=Ac,n.circle=ud,n.circleMarker=cd,n.control=is,n.divIcon=Tc,n.extend=o,n.featureGroup=Tt,n.geoJSON=$l,n.geoJson=kr,n.gridLayer=gd,n.icon=vr,n.imageOverlay=fd,n.latLng=be,n.latLngBounds=De,n.layerGroup=pn,n.map=vl,n.marker=Cc,n.point=ee,n.polygon=hd,n.polyline=dd,n.popup=md,n.rectangle=ce,n.setOptions=x,n.stamp=d,n.svg=V,n.svgOverlay=vd,n.tileLayer=El,n.tooltip=xc,n.transformation=G,n.version=s,n.videoOverlay=pd;var Za=window.L;n.noConflict=function(){return window.L=Za,this},window.L=n}))})(Tr,Tr.exports)),Tr.exports}var L2=C2();const Jt=a1(L2);(function(e,t,n){function s(o,i){for(;(o=o.parentElement)&&!o.classList.contains(i););return o}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(o,i){this._map=o,this._container=o._container,this._overlayPane=o._panes.overlayPane,this._popupPane=o._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(L.DomUtil.disableTextSelection(),o.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(o){L.setOptions(this,o)},_fireCreatedEvent:function(o){this._map.fire(L.Draw.Event.CREATED,{layer:o,layerType:this.type})},_cancelDrawing:function(o){o.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(o,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var o=this._markers.pop(),i=this._poly,l=i.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(o),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(c,!1)}},addVertex:function(o){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(o))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(o)),this._poly.addLatLng(o),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(o,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var o=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(o[o.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(o.originalEvent)},_vertexChanged:function(o,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(o,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(o){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(o),this._clickHandled=!0,this._disableNewMarkers();var i=o.originalEvent,l=i.clientX,c=i.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(o,i){this._mouseDownOrigin=L.point(o,i)},_onMouseUp:function(o){var i=o.originalEvent,l=i.clientX,c=i.clientY;this._endPoint.call(this,l,c,o),this._clickHandled=null},_endPoint:function(o,i,l){if(this._mouseDownOrigin){var c=L.point(o,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(o){var i,l,c=o.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,o),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(o){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=c.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_createMarker:function(o){var i=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(o){var i=this._markers?this._markers.length:0;i>0&&(o=o||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),o))},_updateTooltip:function(o){var i=this._getTooltipText();o&&this._tooltip.updatePosition(o),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(o,i){var l,c,d,h=Math.floor(Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))),f=this.options.guidelineDistance,v=this.options.maxGuideLineLength,g=h>v?h-v:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));g<h;g+=this.options.guidelineDistance)l=g/h,c={x:Math.floor(o.x*(1-l)+l*i.x),y:Math.floor(o.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(o){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=o},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var o,i,l=this.options.showLength;return this._markers.length===0?o={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",o=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),o},_updateRunningMeasure:function(o,i){var l,c,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),c=L.GeometryUtil.isVersion07x()?o.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(o,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(i?1:-1))},_getMeasurementString:function(){var o,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return o=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(o,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var o=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(o,i){L.Draw.Polyline.prototype.initialize.call(this,o,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var o=this._markers.length;o===1&&this._markers[0].on("click",this._finishShape,this),o>2&&(this._markers[o-1].on("dblclick",this._finishShape,this),o>3&&this._markers[o-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var o,i;return this._markers.length===0?o=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(o=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(o=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:o,subtext:i}},_getMeasurementString:function(){var o=this._area,i="";return o||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),o&&(i+="<br>"+L.GeometryUtil.readableArea(o,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(o,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,o,i)},_cleanUpShape:function(){var o=this._markers.length;o>0&&(this._markers[0].off("click",this._finishShape,this),o>2&&this._markers[o-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(o,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(o){this._isDrawing=!0,this._startLatLng=o.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(o.originalEvent)},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(o,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(o){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!s(o.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(o){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,o)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,o),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_getTooltipText:function(){var o,i,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(o),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(o){return new L.Marker(o,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(o){this._onMouseMove(o),this._onClick()},_fireCreatedEvent:function(){var o=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},_fireCreatedEvent:function(){var o=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)},_createMarker:function(o){return new L.CircleMarker(o,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(o,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},_drawShape:function(o){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(o);else var i=this._map.distance(this._startLatLng,o);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_onMouseMove:function(o){var i,l=o.latlng,c=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";c&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(o,i){this._marker=o,L.setOptions(this,i)},addHooks:function(){var o=this._marker;o.dragging.enable(),o.on("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},removeHooks:function(){var o=this._marker;o.dragging.disable(),o.off("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},_onDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var o=this._marker._icon;o&&(o.style.display="none",L.DomUtil.hasClass(o,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,-4)):(L.DomUtil.addClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,4)),o.style.display="")},_offsetMarker:function(o,i){var l=parseInt(o.style.marginTop,10)-i,c=parseInt(o.style.marginLeft,10)-i;o.style.marginTop=l+"px",o.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(o){this.latlngs=[o._latlngs],o._holes&&(this.latlngs=this.latlngs.concat(o._holes)),this._poly=o,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(o){for(var i=0;i<this._verticesHandlers.length;i++)o(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(o){o.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(o){o.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(o){o.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var o=0;o<this.latlngs.length;o++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[o],this._poly.options.poly))},_updateLatLngs:function(o){this.latlngs=[o.layer._latlngs],o.layer._holes&&(this.latlngs=this.latlngs.concat(o.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(o,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=o,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var o=this._poly,i=o._path;o instanceof L.Polygon||(o.options.fill=!1,o.options.editing&&(o.options.editing.fill=!1)),i&&o.options.editing&&o.options.editing.className&&(o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var o=this._poly,i=o._path;i&&o.options.editing&&o.options.editing.className&&(o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.original),o._map&&(o._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var o,i,l,c,d=this._defaultShape();for(o=0,l=d.length;o<l;o++)c=this._createMarker(d[o],o),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var h,f;for(o=0,i=l-1;o<l;i=o++)(o!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[o],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:this.options.icon});return l._origLatLng=o,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var o=this._defaultShape(),i=[].splice.apply(o,arguments);return this._poly._convertLatLngs(o,!0),this._poly.redraw(),i},_removeMarker:function(o){var i=o._index;this._markerGroup.removeLayer(o),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(o){var i=o.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,c),i.setLatLng(c);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(o){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=o.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(o){var i=o.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),c=o.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(o,i){this._markerGroup.eachLayer(function(l){l._index>o&&(l._index+=i)})},_createMiddleMarker:function(o,i){var l,c,d,h=this._getMiddleLatLng(o,i),f=this._createMarker(h);f.setOpacity(.6),o._middleRight=i._middleLeft=f,c=function(){f.off("touchmove",c,this);var v=i._index;f._index=v,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(v,0,h),this._markers.splice(v,0,f),f.setOpacity(1),this._updateIndexes(v,1),i._index++,this._updatePrevNext(o,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",c,this),f.off("dragend",d,this),f.off("touchmove",c,this),this._createMiddleMarker(o,f),this._createMiddleMarker(f,i)},l=function(){c.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",c,this).on("dragend",d,this).on("touchmove",c,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(o,i){o&&(o._next=i),i&&(i._prev=o)},_getMiddleLatLng:function(o,i){var l=this._poly._map,c=l.project(o.getLatLng()),d=l.project(i.getLatLng());return l.unproject(c._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(o,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=o,L.Util.setOptions(this,i)},addHooks:function(){var o=this._shape;this._shape._map&&(this._map=this._shape._map,o.setStyle(o.options.editing),o._map&&(this._map=o._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var o=this._shape;if(o.setStyle(o.options.original),o._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(o){o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(o){o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(o){o.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(o){var i=o.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(o){o.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(o){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o),typeof this._getCorners=="function"){var i=this._getCorners(),l=o.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return o.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(o){o.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds(),i=o.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var o=this._getCorners();this._resizeMarkers=[];for(var i=0,l=o.length;i<l;i++)this._resizeMarkers.push(this._createMarker(o[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(o){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o);var i=this._getCorners(),l=o.target,c=l._cornerIndex;this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(o){var i,l,c=o.target;c===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,o)},_move:function(o){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),d=c.getCenter(),h=[],f=0,v=l.length;f<v;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([o.lat+i[0],o.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(o){var i;this._shape.setBounds(L.latLngBounds(o,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var o=this._shape.getBounds();return[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()]},_toggleCornerMarkers:function(o){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(o)},_repositionCornerMarkers:function(){for(var o=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(o[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getLatLng();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(o){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(o);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(o),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var o=this._shape.getLatLng(),i=this._getResizeMarkerPoint(o);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(o){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(o);return this._map.unproject([l.x+i,l.y-i])},_resize:function(o){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(o):radius=this._map.distance(i,o),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(o,i){var l={};if(o.touches!==void 0){if(!o.touches.length)return;l=o.touches[0]}else if(o.pointerType!=="touch"||(l=o,!this._filterClick(o)))return;var c=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:o})},_filterClick:function(o){var i=o.timeStamp||o.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||o.target._simulatedClick&&!o._simulated?(L.DomEvent.stop(o),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(o){this._map._loaded&&this._touchEvent(o,"touchstart")},_onTouchEnd:function(o){this._map._loaded&&this._touchEvent(o,"touchend")},_onTouchCancel:function(o){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(o,i)}},_onTouchLeave:function(o){this._map._loaded&&this._touchEvent(o,"touchleave")},_onTouchMove:function(o){this._map._loaded&&this._touchEvent(o,"touchmove")},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var o=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(o,"leaflet-clickable"),L.DomEvent.on(o,"click",this._onMouseClick,this),L.DomEvent.on(o,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(o,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(o){for(var i=[],l=0,c=o.length;l<c;l++)Array.isArray(o[l])?i.push(L.LatLngUtil.cloneLatLngs(o[l])):i.push(this.cloneLatLng(o[l]));return i},cloneLatLng:function(o){return L.latLng(o.lat,o.lng)}},(function(){var o={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,c,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var v=0;v<d;v++)l=i[v],c=i[(v+1)%d],h+=(c.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(c.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var c=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,v=h&&h.decimal;if(f||v){var g=c.split(".");c=f?g[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):g[0],v=v||".",g.length>1&&(c=c+v+g[1])}return c},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},o,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,c,d,v){var f,v=L.Util.extend({},o,v);switch(l?typeof l=="string"?l:"metric":c?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,v.km)+" km":L.GeometryUtil.formattedNumber(i,v.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,v.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,v.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,v.mi)+" miles":L.GeometryUtil.formattedNumber(i,v.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(o,i,l,c){return this._checkCounterclockwise(o,l,c)!==this._checkCounterclockwise(i,l,c)&&this._checkCounterclockwise(o,i,l)!==this._checkCounterclockwise(o,i,c)},_checkCounterclockwise:function(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}}),L.Polyline.include({intersects:function(){var o,i,l,c=this._getProjectedPoints(),d=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(o=d-1;o>=3;o--)if(i=c[o-1],l=c[o],this._lineSegmentsIntersectsRange(i,l,o-2))return!0;return!1},newLatLngIntersects:function(o,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(o),i)},newPointIntersects:function(o,i){var l=this._getProjectedPoints(),c=l?l.length:0,d=l?l[c-1]:null,h=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,o,h,i?1:0)},_tooFewPointsForIntersection:function(o){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=o||0,!i||l<=3},_lineSegmentsIntersectsRange:function(o,i,l,c){var d,h,f=this._getProjectedPoints();c=c||0;for(var v=l;v>c;v--)if(d=f[v-1],h=f[v],L.LineUtil.segmentsIntersect(o,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var o=[],i=this._defaultShape(),l=0;l<i.length;l++)o.push(this._map.latLngToLayerPoint(i[l]));return o}}),L.Polygon.include({intersects:function(){var o,i,l,c,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(o=d.length,i=d[0],l=d[o-1],c=o-2,this._lineSegmentsIntersectsRange(l,i,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(o){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,o);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(o){var i,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(o))&&(c||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(i));return l},onRemove:function(){for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&this._toolbars[o].removeToolbar()},setDrawingOptions:function(o){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(o)},_toolbarEnabled:function(o){var i=o.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(o){L.setOptions(this,o),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(o){var i,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,d=this._toolbarClass||"",h=this.getModeHandlers(o);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=o,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,c++,d,h[i].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var o in this._modes)this._modes.hasOwnProperty(o)&&(this._disposeButton(this._modes[o].button,this._modes[o].handler.enable,this._modes[o].handler),this._modes[o].handler.disable(),this._modes[o].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(o,i,l,c,d){var h=o.type;this._modes[h]={},this._modes[h].handler=o,this._modes[h].button=this._createButton({type:h,title:d,className:c+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(o){var i=L.DomUtil.create("a",o.className||"",o.container),l=L.DomUtil.create("span","sr-only",o.container);i.href="#",i.appendChild(l),o.title&&(i.title=o.title,l.innerHTML=o.title),o.text&&(i.innerHTML=o.text,l.innerHTML=o.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,c,o.callback,o.context),i},_disposeButton:function(o,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(o,"click",L.DomEvent.stopPropagation).off(o,"mousedown",L.DomEvent.stopPropagation).off(o,"dblclick",L.DomEvent.stopPropagation).off(o,"touchstart",L.DomEvent.stopPropagation).off(o,"click",L.DomEvent.preventDefault).off(o,l,i)},_handlerActivated:function(o){this.disable(),this._activeMode=this._modes[o.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(o){var i,l,c,d,h=this._actionsContainer,f=this.getActions(o),v=f.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var g=0;g<v;g++)"enabled"in f[g]&&!f[g].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[g].title,text:f[g].text,container:i,callback:f[g].callback,context:f[g].context}),this._actionButtons.push({button:d,callback:f[g].callback}))},_showActionsToolbar:function(){var o=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",o===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),o===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(o){this._map=o,this._popupPane=o._panes.popupPane,this._visible=!1,this._container=o.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(o){return this._container?(o.subtext=o.subtext||"",o.subtext.length!==0||this._singleLineLabel?o.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(o.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+o.subtext+"</span><br />":"")+"<span>"+o.text+"</span>",o.text||o.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(o){var i=this._map.latLngToLayerPoint(o),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(o){for(var i in this.options)this.options.hasOwnProperty(i)&&o[i]&&(o[i]=L.extend({},this.options[i],o[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,o)},getModeHandlers:function(o){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(o,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(o,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(o,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(o,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(o,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(o,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(o){return[{enabled:o.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:o.completeShape,context:o},{enabled:o.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:o.deleteLastVertex,context:o},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(o){L.setOptions(this,o);for(var i in this._modes)this._modes.hasOwnProperty(i)&&o.hasOwnProperty(i)&&this._modes[i].handler.setOptions(o[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(o){o.edit&&(o.edit.selectedPathOptions===void 0&&(o.edit.selectedPathOptions=this.options.edit.selectedPathOptions),o.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,o.edit.selectedPathOptions)),o.remove&&(o.remove=L.extend({},this.options.remove,o.remove)),o.poly&&(o.poly=L.extend({},this.options.poly,o.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,o),this._selectedFeatureCount=0},getModeHandlers:function(o){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(o,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(o,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(o){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return o.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(o){var i=L.Toolbar.prototype.addToolbar.call(this,o);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var o,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(o=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(o=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),o._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(o){this._revertLayer(o)},this)},save:function(){var o=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(o.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:o})},_backupLayer:function(o){var i=L.Util.stamp(o);this._uneditedLayerProps[i]||(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(o.getLatLngs())}:o instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng()),radius:o.getRadius()}:(o instanceof L.Marker||o instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(o){var i=L.Util.stamp(o);o.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?o.setLatLngs(this._uneditedLayerProps[i].latlngs):o instanceof L.Circle?(o.setLatLng(this._uneditedLayerProps[i].latlng),o.setRadius(this._uneditedLayerProps[i].radius)):(o instanceof L.Marker||o instanceof L.CircleMarker)&&o.setLatLng(this._uneditedLayerProps[i].latlng),o.fire("revert-edited",{layer:o}))},_enableLayerEdit:function(o){var i,l,c=o.layer||o.target||o;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=c.options.color,i.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=i),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(o){var i=o.layer||o.target||o;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_onMarkerDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(o){var i=o.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(l);o.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(o){this._deletableLayers.addLayer(o),o.fire("revert-deleted",{layer:o})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(o){this._removeLayer({layer:o})},this),this.save()},_enableLayerDelete:function(o){(o.layer||o.target||o).on("click",this._removeLayer,this)},_disableLayerDelete:function(o){var i=o.layer||o.target||o;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(o){var i=o.layer||o.target||o;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const i1=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",$v=e=>e.length*6+12,Hd=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),I2=(e,t)=>{if(!e||t.length===0)return new Set;const n=[],s=e.getBounds();t.forEach(l=>{if(s.contains(l.getLatLng())){const c=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&n.push({marker:l,pixelPos:c,location:d})}});const o=n.map(({marker:l,pixelPos:c,location:d})=>{const v=$v(d.name),g=d.description?$v(`${d.name}: ${i1(d.description,50)}`):v;return{marker:l,location:d,markerBox:{left:c.x-15,right:c.x+15,top:c.y-15,bottom:c.y+15},baseLabelBox:{left:c.x-v/2,right:c.x+v/2,top:c.y+15+2,bottom:c.y+15+2+20},descLabelBox:d.description?{left:c.x-g/2,right:c.x+g/2,top:c.y+15+2,bottom:c.y+15+2+20}:null}}),i=new Set;return o.forEach(({marker:l,location:c,markerBox:d,baseLabelBox:h,descLabelBox:f},v)=>{if(!c.description)return;let g=!1;for(let k=0;k<o.length;k++){if(v===k)continue;const b=o[k];if(Hd(f,b.markerBox)||Hd(f,b.baseLabelBox)){g=!0;break}if(b.descLabelBox&&i.has(b.location.id)&&Hd(f,b.descLabelBox)){g=!0;break}}g||i.add(c.id)}),i},zc=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],S2=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Iu=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function Qi(e){return Iu.find(t=>t.value===e)||Iu[0]}function x2(e){return Qi(e).defaultColor||"#667eea"}function $2(e,t){return t||x2(e)}const Jh={dot:(e,t=32)=>{const n=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const n=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const n=t/2,s=4,o=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s} ${l},${o} ${i},${o}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${s-o} ${n+o},${s} ${n},${s+o} ${n-o},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-3,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${n+o*Math.cos(d)},${s+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${n+i*Math.cos(h)},${s+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<6;l++){const c=Math.PI/6+l*Math.PI/3;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const n=t/2,s=t/2,o=t/2-4,i=[];for(let l=0;l<5;l++){const c=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${n+o*Math.cos(c)},${s+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Tv={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Gl={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",s=t==="none"?0:2,o=13,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${16+o*Math.cos(d)},${16+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${s}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Mv={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function zn({type:e,backgroundShape:t="circle",backgroundColor:n,borderColor:s,iconColor:o,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(n||s||o||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const c=Qi(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(c.isShapeOnly){const v=n||c.defaultColor||"#667eea",g=s||"#fff";if(Gl[e])f=Gl[e]({backgroundColor:v,borderColor:g});else return Jh[e]?.(v,h)||null}else{const v=n||"#667eea",g=s||"#fff",k=o||"#fff",b=t||"circle";b!=="none"&&Gl[b]&&(f+=Gl[b]({backgroundColor:v,borderColor:g})),Mv[e]&&(f+=Mv[e](k,v))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const T2={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function M2(e,t){return e===0?"missing":e>=t?"full":"partial"}function Xh(e,t){const n=M2(e,t);return T2[n]}function A2(e,t,n=32){if(e==="default")return null;if(Tv[e])return Tv[e](n);if(Jh[e]){const s=t||"#667eea";return Jh[e](s,n)}return null}const E2=["circle","square","hexagon","pentagon"];function P2(e){return E2.includes(e)}function D2(e,t,n,s,o=32,i=!0){const l=A2(e,t,o),c=Xh(n,s);if(!l)return null;const d=i&&P2(e),h=$2(e,t),f=O2(h),v=l1(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",g=o>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${g};
      text-shadow: ${v};
      pointer-events: none;
    ">${n}/${s}</div>
  `:"";return`
    <div style="position: relative; width: ${o}px; height: ${o}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${c}
      </div>
    </div>
  `}function R2(e){const t=e.replace("#",""),n=parseInt(t.substr(0,2),16)/255,s=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function l1(e){return!e||e.length<6?!1:R2(e)>.4}function O2(e){return l1(e)?"#1F2937":"#FFFFFF"}const B2={class:"map-container-wrapper"},N2="#667eea",F2={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null);let l=null;const c=D([]),d=D([]),h=D([]);let f=null,v=null;const g=D([]);let k=null,b=null,x=!1;const A=D(!1),T=()=>{if(l){const Oe=l.getCenter();return{lat:Oe.lat,lng:Oe.lng}}return null},w=()=>l?l.getZoom():null,C=()=>{if(c.value.length>0){h.value.push([...c.value]);const Oe=d.value.pop()||[];c.value=Oe,Ce(),o("polygon-drawing",c.value)}},I=()=>{if(h.value.length>0){d.value.push([...c.value]);const Oe=h.value.pop();c.value=Oe,Ce(),o("polygon-drawing",c.value)}},$=()=>c.value.length>0,R=()=>h.value.length>0,M=()=>c.value.length,O=()=>{c.value.length>=3&&(o("polygon-complete",[...c.value]),E())},E=()=>{c.value=[],d.value=[],h.value=[],Ce()},U=()=>{!l||!s.userLocation||(l.setView([s.userLocation.lat,s.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),A.value=!0)},F=(Oe,xe,me=null)=>{if(!l||Oe==null||xe==null)return;l.setView([Oe,xe],me??l.getZoom(),{animate:!0,duration:.5});const Ze=s.center&&Math.abs(s.center.lat-Oe)<1e-4&&Math.abs(s.center.lng-xe)<1e-4;A.value=!Ze},j=D(!0),Z=D(!0),Q=(Oe,xe)=>{if(!l||Oe==null||xe==null)return!0;const me=l.getBounds(),Ze=Jt.latLng(Oe,xe);return me.contains(Ze)};t({getMapCenter:T,getMapZoom:w,undoPolygonPoint:C,redoPolygonPoint:I,canUndo:$,canRedo:R,getPolygonPointCount:M,completePolygon:O,clearPolygonDrawing:E,recenterOnUserLocation:U,recenterOnLocation:F,isLocationInView:Q,userLocationInView:Z,highlightedLocationInView:j});const re=D([]);let K=null;const ae=D(!0),q=D(!1),J=D(new Set),ee=D([]);let ue=null,_e=null;const $e=H(()=>s.hideRecenterButton||!s.highlightLocationId||!A.value?!1:!j.value),De=D({}),Re=()=>{const Oe={};if(s.highlightLocationId){const xe=s.locations.find(me=>me.id===s.highlightLocationId);if(xe?.latitude&&xe?.longitude){const me=Q(xe.latitude,xe.longitude);j.value=me,Oe[s.highlightLocationId]=me,De.value=Oe;return}}if(s.highlightLocationIds&&s.highlightLocationIds.length>0){let xe=!0;for(const me of s.highlightLocationIds){const Ze=s.locations.find(qe=>qe.id===me);if(Ze?.latitude&&Ze?.longitude){const qe=Q(Ze.latitude,Ze.longitude);Oe[me]=qe,qe||(xe=!1)}else Oe[me]=!0}j.value=xe,De.value=Oe;return}if(!l){j.value=!0,De.value={};return}j.value=!0,De.value={}},be=()=>{if(!l||!s.userLocation){Z.value=!0;return}Z.value=Q(s.userLocation.lat,s.userLocation.lng)},z=()=>{Re(),be(),o("visibility-change",{userLocationInView:Z.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:De.value})},Y=()=>{if(!l||!s.highlightLocationId)return;const Oe=s.locations.find(xe=>xe.id===s.highlightLocationId);!Oe||!Oe.latitude||!Oe.longitude||(l.setView([Oe.latitude,Oe.longitude],l.getZoom(),{animate:!0,duration:.5}),A.value=!1,j.value=!0)},de=(Oe,xe,me,Ze,qe=!1)=>{const fe=me?"36px":Ze?"20px":"30px",ke=me?"#667eea":"white",ne=qe?"":Xh(Oe,xe);return`
    <div style="position: relative; width: ${fe}; height: ${fe};">
      <div style="
        background-color: ${N2};
        width: ${fe};
        height: ${fe};
        border-radius: 50%;
        border: 3px solid ${ke};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${qe?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ne}
      </div>`}
    </div>
  `},ie=()=>{if(!l)return;const Oe=I2(l,re.value),xe=Array.from(J.value).sort().join(","),me=Array.from(Oe).sort().join(",");xe!==me&&(J.value=Oe,Be())},Ae=()=>{if(_e&&(_e.remove(),_e=null),!l||!s.userLocation)return;const Oe=Jt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});_e=Jt.marker([s.userLocation.lat,s.userLocation.lng],{icon:Oe}).addTo(l).bindPopup("Your location")},G=()=>{if(!i.value)return;let Oe=51.505,xe=-.09,me=13;const Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,qe=(ke,ne)=>ke!=null&&ne!=null&&!(ke===0&&ne===0),fe=[];Ze.length>0&&fe.push(...Ze.filter(ke=>qe(ke.latitude,ke.longitude)).map(ke=>({lat:ke.latitude,lng:ke.longitude}))),s.route&&s.route.length>0&&fe.push(...s.route.filter(ke=>qe(ke.lat,ke.lng)).map(ke=>({lat:ke.lat,lng:ke.lng}))),s.center?(Oe=s.center.lat,xe=s.center.lng,me=s.zoom??13):fe.length>0&&(Oe=fe.reduce((ke,ne)=>ke+ne.lat,0)/fe.length,xe=fe.reduce((ke,ne)=>ke+ne.lng,0)/fe.length,me=10),l=Jt.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([Oe,xe],me),Jt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),s.clickable&&l.on("click",ke=>{s.drawingMode||o("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}),l.on("zoomstart",()=>{ge=!0}),l.on("zoomend moveend",()=>{ge=!1,oe?Be():ie(),z()}),l.on("dragstart",()=>{A.value=!0}),Be(),X(),te(),Ae(),Ee(),Fe(),l.whenReady(()=>{z()})},X=()=>{if(K&&(K.remove(),K=null),!l||s.route.length===0)return;const Oe=s.route.map(fe=>[fe.lat,fe.lng]),xe=s.routeColor||"#3388ff",me=s.routeWeight||4;let Ze=null,qe="butt";switch(s.routeStyle){case"dash":Ze="10, 10";break;case"dash-long":Ze="20, 12";break;case"dash-short":Ze="6, 6";break;case"dash-dense":Ze="6, 3";break;case"dot":Ze="2, 8",qe="round";break;case"dot-sparse":Ze="2, 14",qe="round";break;case"dot-dense":Ze="2, 2",qe="round";break;case"dash-dot":Ze="16, 8, 4, 8";break;case"dash-dot-dot":Ze="16, 6, 4, 6, 4, 6";break;case"long-short":Ze="16, 4, 6, 4";break;case"double-dash":Ze="8, 3, 8, 8";break}K=Jt.polyline(Oe,{color:xe,weight:me,opacity:.7,dashArray:Ze,lineCap:qe}).addTo(l)},te=()=>{ee.value.forEach(Oe=>Oe.remove()),ee.value=[],!(!l||s.areas.length===0)&&s.areas.forEach(Oe=>{const xe=typeof Oe.polygon=="string"?JSON.parse(Oe.polygon):Oe.polygon;if(!xe||xe.length===0)return;const me=xe.map(ke=>[ke.lat,ke.lng]),Ze=Oe.id===s.selectedAreaId,qe=Oe.color||"#667eea",fe=Jt.polygon(me,{color:qe,fillColor:qe,fillOpacity:Ze?.4:.2,weight:Ze?3:2,opacity:.8}).addTo(l);fe.setStyle({pane:"overlayPane"}),s.drawingMode||(fe.on("click",()=>o("area-click",Oe)),fe.on("mouseover",()=>{fe.setStyle({fillOpacity:.4})}),fe.on("mouseout",()=>{fe.setStyle({fillOpacity:Ze?.4:.2})})),ee.value.push(fe)})},Ce=()=>{if(l&&(f&&(f.remove(),f=null),v&&(v.remove(),v=null),c.value.length!==0&&(v=Jt.layerGroup().addTo(l),c.value.forEach((Oe,xe)=>{const me=xe===0,Ze=xe===c.value.length-1,qe=Jt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${me?"16px":"12px"};
        height: ${me?"16px":"12px"};
        background-color: ${me?"#667eea":Ze?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[me?16:12,me?16:12],iconAnchor:[me?8:6,me?8:6]});Jt.marker([Oe.lat,Oe.lng],{icon:qe,interactive:!1}).addTo(v)}),c.value.length>=2))){const Oe=c.value.map(xe=>[xe.lat,xe.lng]);c.value.length>=3&&Oe.push(Oe[0]),f=Jt.polyline(Oe,{color:"#667eea",weight:3,opacity:.8,dashArray:c.value.length<3?"10, 10":null}).addTo(l)}},Ne=()=>{if(!l||(k&&(k.remove(),k=null),b&&(b.remove(),b=null),g.value.length===0))return;const Oe=g.value.map(me=>[me.lat,me.lng]);k=Jt.polygon(Oe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),b=Jt.layerGroup({pane:"markerPane"}).addTo(l);const xe=me=>{g.value.length<=3||(g.value.splice(me,1),x=!0,o("polygon-update",[...g.value]),Ne())};g.value.forEach((me,Ze)=>{const qe=g.value.length>3,fe=Jt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),ke=Jt.marker([me.lat,me.lng],{icon:fe,draggable:!0}).addTo(b);if(ke.on("drag",ne=>{const ye=ne.target.getLatLng();g.value[Ze]={lat:ye.lat,lng:ye.lng};const He=g.value.map(ct=>[ct.lat,ct.lng]);k.setLatLngs(He)}),ke.on("dragend",()=>{x=!0,o("polygon-update",[...g.value])}),ke.on("contextmenu",ne=>{Jt.DomEvent.preventDefault(ne),qe&&xe(Ze)}),qe){const ne=document.createElement("div"),ye=document.createElement("button");ye.textContent="Delete point",ye.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const He=ct=>{ct.preventDefault(),ct.stopPropagation(),ke.closePopup(),xe(Ze)};ye.addEventListener("click",He),ye.addEventListener("touchend",He),ne.appendChild(ye),ke.bindPopup(ne,{closeButton:!1,className:"vertex-popup"})}})},Fe=(Oe=!0)=>{if(l){if(!s.editingPolygon||s.editingPolygon.length===0){k&&(k.remove(),k=null),b&&(b.remove(),b=null),g.value=[];return}if(g.value=s.editingPolygon.map(xe=>({lat:xe.lat,lng:xe.lng})),Ne(),Oe&&g.value.length>=3){const xe=Jt.latLngBounds(g.value.map(me=>[me.lat,me.lng]));l.fitBounds(xe,{padding:[50,50]})}}},Ee=()=>{if(!l)return;if(ue||(ue=new Jt.FeatureGroup,l.addLayer(ue)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!s.drawingMode){E(),ue&&ue.clearLayers();return}let Oe=0,xe=null,me=!1,Ze=!1;const qe=300,fe=15,ke=ht=>{d.value.push([...c.value]),h.value=[],c.value.push({lat:ht.lat,lng:ht.lng}),Ce(),o("polygon-drawing",c.value)},ne=ht=>{ht.originalEvent&&ht.originalEvent.sourceCapabilities?.firesTouchEvents||ke(ht.latlng)},ye=ht=>{if(ht.touches.length>1){Ze=!0;return}Ze=!1,Oe=Date.now(),xe={x:ht.touches[0].clientX,y:ht.touches[0].clientY},me=!1},He=ht=>{if(!xe||Ze)return;const Bt=ht.touches[0].clientX-xe.x,Lt=ht.touches[0].clientY-xe.y;Math.sqrt(Bt*Bt+Lt*Lt)>fe&&(me=!0)},ct=ht=>{if(Ze){Ze=!1,xe=null;return}if(Date.now()-Oe<qe&&!me&&xe){const Lt=ht.changedTouches[0],Nt=Jt.point(Lt.clientX-l.getContainer().getBoundingClientRect().left,Lt.clientY-l.getContainer().getBoundingClientRect().top),Et=l.containerPointToLatLng(Nt);ht.preventDefault(),ht.stopPropagation(),ke(Et)}xe=null,me=!1};l.on("click",ne),l.getContainer().addEventListener("touchstart",ye,{passive:!0}),l.getContainer().addEventListener("touchmove",He,{passive:!0}),l.getContainer().addEventListener("touchend",ct,{passive:!1}),l._customDrawingHandlers={handleClick:ne,handleTouchStart:ye,handleTouchMove:He,handleTouchEnd:ct},Ce()};let oe=!1,ge=!1;const Be=()=>{if(l&&(l._animatingZoom||ge)){oe=!0;return}if(oe=!1,re.value.forEach(me=>{me._map&&(me.off(),me.remove())}),re.value=[],!l)return;const Oe=i.value?.clientWidth||400,xe=Math.floor(Oe*.75);if(s.locations.forEach(me=>{const Ze=me.latitude??me.Latitude,qe=me.longitude??me.Longitude;if(Ze==null||qe==null||Ze===0&&qe===0)return;const fe=me.checkedInCount||0,ke=me.requiredMarshals||1,ne=s.highlightLocationId===me.id||s.highlightLocationIds.includes(me.id),ye=me.isDynamic||me.IsDynamic,He=s.simplifyNonHighlighted&&!ne&&!ye,ct=me.resolvedStyleType||me.ResolvedStyleType,ht=me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor,Bt=me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor,Lt=me.resolvedStyleIconColor||me.ResolvedStyleIconColor,Nt=me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape,Et=ct&&ct!=="default"||ht||Bt||Lt||Nt&&Nt!=="circle"&&Nt!=="default",yo=me.resolvedStyleMapRotation??me.ResolvedStyleMapRotation??me.styleMapRotation??me.StyleMapRotation??0,ko=parseInt(yo,10)||0,ft=me.areaColor||"#999",Pt=me.areaId&&!s.marshalMode,An=J.value.has(me.id)&&me.description?`${me.name}: ${i1(me.description,50)}`:me.name,Ao=ne?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",ao=ne?"#667eea":He?"#e0e0e0":"white",bo=ne?"white":He?"#888":"#333";let Gt;if(He){const Qe="20px";Gt=`
        <div style="
          background-color: #999;
          width: ${Qe};
          height: ${Qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const As=!s.marshalMode,wo=Xh(fe,ke),zo=As?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${fe}/${ke}</div>`:"";if(!He&&Et){const Qe=ne?40:32,Ft=me.resolvedStyleSize||me.ResolvedStyleSize||"100",sn=zn({type:me.resolvedStyleType||me.ResolvedStyleType,backgroundShape:me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape||"circle",backgroundColor:me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor||"",borderColor:me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor||"",iconColor:me.resolvedStyleIconColor||me.ResolvedStyleIconColor||"",size:Ft});sn?Gt=sn:Gt=D2(me.resolvedStyleType,me.resolvedStyleColor,fe,ke,Qe,As)||de(fe,ke,ne,s.marshalMode,!0)}else He||(Gt=de(fe,ke,ne,s.marshalMode,!0));const pe=ko!==0?`transform: rotate(${ko}deg);`:"",ve=Jt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ao}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Pt?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ft};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${pe}">
                ${Gt}
              </div>
              ${He||s.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${wo}
              </div>`}
              ${He?"":zo}
            </div>
          </div>
          <div style="
            background-color: ${ao};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ne?"12px":"11px"};
            font-weight: bold;
            color: ${bo};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${xe}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${An}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Se=s.marshalMode?`<b>${me.name}</b>${me.description?`<br>${me.description}`:""}`:`<b>${me.name}</b><br>${me.description||""}<br>Checked in: ${fe}/${ke}`,lt=Jt.marker([me.latitude,me.longitude],{icon:ve}).addTo(l).bindPopup(Se);lt.on("click",()=>{o("location-click",me)}),lt.locationData=me,re.value.push(lt)}),l&&ae.value&&!s.center&&!q.value){const me=[],Ze=s.allLocationsForBounds.length>0?s.allLocationsForBounds:s.locations,qe=(fe,ke)=>fe!=null&&ke!=null&&!(fe===0&&ke===0);if(Ze.length>0&&me.push(...Ze.filter(fe=>qe(fe.latitude,fe.longitude)).map(fe=>[fe.latitude,fe.longitude])),s.route.length>0&&me.push(...s.route.filter(fe=>qe(fe.lat,fe.lng)).map(fe=>[fe.lat,fe.lng])),me.length>0){const fe=Jt.latLngBounds(me);l.fitBounds(fe,{padding:[50,50]}),ae.value=!1,q.value=!0}}else s.center&&(ae.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&ie()},100)};return un(()=>{q.value=!1,ae.value=!0,G();let Oe,xe=0,me=0;const Ze=new ResizeObserver(qe=>{if(l&&qe.length>0){const{width:fe,height:ke}=qe[0].contentRect;(Math.abs(fe-xe)>10||Math.abs(ke-me)>10)&&(xe=fe,me=ke,clearTimeout(Oe),Oe=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&Ze.observe(i.value),Sn(()=>{clearTimeout(Oe),Ze.disconnect()})}),Ye(()=>s.locations,Oe=>{if(Be(),l&&!q.value&&Oe.length>0&&!s.center){const xe=Oe.map(fe=>fe.latitude),me=Oe.map(fe=>fe.longitude),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,qe=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,qe],10),q.value=!0,ae.value=!1}l&&setTimeout(()=>z(),50)},{deep:!0}),Ye(()=>s.route,Oe=>{if(X(),Be(),l&&!q.value&&Oe&&Oe.length>0&&!s.center){const xe=Oe.map(fe=>fe.lat),me=Oe.map(fe=>fe.lng),Ze=xe.reduce((fe,ke)=>fe+ke,0)/xe.length,qe=me.reduce((fe,ke)=>fe+ke,0)/me.length;l.setView([Ze,qe],10),q.value=!0,ae.value=!1}},{deep:!0}),Ye(()=>[s.routeColor,s.routeStyle,s.routeWeight],()=>{X()}),Ye(()=>s.center,(Oe,xe)=>{l&&!A.value&&(!xe||Math.abs(Oe.lat-xe.lat)>1e-6||Math.abs(Oe.lng-xe.lng)>1e-6)&&l.setView([Oe.lat,Oe.lng],s.zoom)}),Ye(()=>s.areas,()=>{te()},{deep:!0}),Ye(()=>s.selectedAreaId,()=>{te()}),Ye(()=>s.drawingMode,()=>{Ee()}),Ye(()=>s.editingPolygon,()=>{if(x){x=!1;return}Fe()},{deep:!0}),Ye(()=>s.userLocation,()=>{Ae()},{deep:!0}),Ye(()=>s.highlightLocationId,()=>{Be()}),Ye(()=>s.highlightLocationIds,()=>{Be(),l&&setTimeout(()=>z(),50)},{deep:!0}),Ye(()=>s.marshalMode,()=>{Be()}),Ye(()=>s.simplifyNonHighlighted,()=>{Be()}),Ye(()=>s.clickable,Oe=>{l&&(l.off("click"),Oe&&l.on("click",xe=>{s.drawingMode||o("map-click",{lat:xe.latlng.lat,lng:xe.latlng.lng})}))}),(Oe,xe)=>(p(),y("div",B2,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),$e.value?(p(),y("button",{key:0,class:"recenter-btn",onClick:Y,title:"Recenter on checkpoint"},[...xe[0]||(xe[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):P("",!0)]))}},Qh=Ke(F2,[["__scopeId","data-v-59e540e9"]]);function Qo(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const U2={class:"areas-selection"},z2={key:0,class:"areas-selection-header"},H2={class:"areas-list"},V2=["checked","onChange"],G2={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>[...n.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Qo(d.name,h.name))),i=H(()=>n.areas.length>0&&n.selectedAreaIds.length===n.areas.length),l=d=>{const h=[...n.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),s("update:selectedAreaIds",h)},c=()=>{i.value?s("update:selectedAreaIds",[]):s("update:selectedAreaIds",n.areas.map(d=>d.id))};return(d,h)=>(p(),y("div",U2,[e.areas.length>1?(p(),y("div",z2,[r("button",{onClick:c,class:"toggle-all-btn"},_(i.value?"Deselect all":"Select all"),1)])):P("",!0),r("div",H2,[(p(!0),y(Ie,null,je(o.value,f=>(p(),y("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:v=>l(f.id)},null,40,V2),r("span",{class:"area-color-dot",style:tt({backgroundColor:f.color||"#667eea"})},null,4),Je(" "+_(f.name),1)]))),128))])]))}},q2=Ke(G2,[["__scopeId","data-v-ba19009b"]]),j2={key:1,class:"toolbar-btn-wrapper filters-wrapper"},W2={key:1,class:"dropdown-content filters-dropdown"},Z2={class:"filters-header"},K2={class:"filter-section"},Y2={class:"filter-checkbox"},J2=["checked"],X2={key:0,class:"filter-checkbox"},Q2=["checked"],eL={class:"filter-section"},tL={class:"filter-checkbox"},nL=["checked"],oL={class:"filter-checkbox"},sL=["checked"],aL={class:"filter-checkbox"},iL=["checked"],lL={key:0,class:"filter-section"},rL=["onClick","title"],cL={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},uL={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},dL=["innerHTML"],hL={key:0,class:"dropdown-content action-dropdown"},fL=["onClick"],pL={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:n}){const{terms:s}=dt(),o=e,i=n,l=D(!1),c=D(null),d=H(()=>c.value!==null),h=()=>{l.value=!l.value,l.value&&(c.value=null)},f=(b,x)=>{i("filter-change",{...o.filters,[b]:x})},v=b=>{b.items&&b.items.length>0?c.value===b.id?c.value=null:(c.value=b.id,l.value=!1):i("action-click",{actionId:b.id})},g=(b,x)=>{c.value=null,i("action-click",{actionId:b,itemId:x})};return t({closeDropdowns:()=>{l.value=!1,c.value=null}}),(b,x)=>(p(),y("div",{class:le(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(p(),y("button",{key:0,class:"toolbar-btn",onClick:x[0]||(x[0]=A=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...x[9]||(x[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(p(),y("div",j2,[l.value?(p(),y("div",{key:0,class:"mobile-backdrop",onClick:x[1]||(x[1]=A=>l.value=!1)})):P("",!0),r("button",{class:le(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...x[10]||(x[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(p(),y("div",W2,[r("div",Z2,[x[12]||(x[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:x[2]||(x[2]=A=>l.value=!1),title:"Close"},[...x[11]||(x[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",K2,[x[13]||(x[13]=r("h4",null,"Display",-1)),r("label",Y2,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:x[3]||(x[3]=A=>f("showRoute",A.target.checked))},null,40,J2),r("span",null,_(N(s).course)+" line",1)]),e.areas.length>0?(p(),y("label",X2,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:x[4]||(x[4]=A=>f("showAreaOverlays",A.target.checked))},null,40,Q2),r("span",null,_(N(s).area)+" overlays",1)])):P("",!0)]),r("div",eL,[r("h4",null,_(N(s).checkpoints),1),r("label",tL,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:x[5]||(x[5]=A=>f("showUncheckedIn",A.target.checked))},null,40,nL),x[14]||(x[14]=r("span",{class:"status-indicator unchecked"},null,-1)),x[15]||(x[15]=r("span",null,"Unchecked-in",-1))]),r("label",oL,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:x[6]||(x[6]=A=>f("showPartiallyCheckedIn",A.target.checked))},null,40,sL),x[16]||(x[16]=r("span",{class:"status-indicator partial"},null,-1)),x[17]||(x[17]=r("span",null,"Partially checked-in",-1))]),r("label",aL,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:x[7]||(x[7]=A=>f("showFullyCheckedIn",A.target.checked))},null,40,iL),x[18]||(x[18]=r("span",{class:"status-indicator full"},null,-1)),x[19]||(x[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(p(),y("div",lL,[r("h4",null,_(N(s).areas),1),Pe(q2,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":x[8]||(x[8]=A=>f("selectedAreaIds",A))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(p(!0),y(Ie,null,je(e.actions,A=>(p(),y("div",{key:A.id,class:le(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:le(["toolbar-btn",{active:c.value===A.id}]),onClick:T=>v(A),title:A.label||A.id},[A.icon==="plus"?(p(),y("svg",cL,[...x[20]||(x[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):A.icon==="edit"?(p(),y("svg",uL,[...x[21]||(x[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):A.icon==="custom"?(p(),y("span",{key:2,innerHTML:A.customIcon},null,8,dL)):P("",!0)],10,rL),A.items&&c.value===A.id?(p(),y("div",hL,[(p(!0),y(Ie,null,je(A.items,T=>(p(),y("button",{key:T.id,onClick:w=>g(A.id,T.id),class:"dropdown-item"},_(T.label),9,fL))),128))])):P("",!0)],2))),128))],2))}},Av=Ke(pL,[["__scopeId","data-v-adedd545"]]),vL={key:0,class:"drawing-controls"},mL={class:"point-count"},gL={class:"undo-redo-buttons"},yL=["disabled"],kL=["disabled"],bL={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.show&&n.pointCount>0),i=l=>{if(!o.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),n.canUndo&&s("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),n.canRedo&&s("redo"))};return un(()=>{document.addEventListener("keydown",i)}),Sn(()=>{document.removeEventListener("keydown",i)}),(l,c)=>o.value?(p(),y("div",vL,[r("div",mL,_(e.pointCount)+" point"+_(e.pointCount!==1?"s":""),1),r("div",gL,[r("button",{onClick:c[0]||(c[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,yL),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,kL)])])):P("",!0)}},Ev=Ke(bL,[["__scopeId","data-v-6cd009cb"]]),wL={class:"context-info"},_L={class:"action-buttons"},CL=["disabled"],LL={key:0,class:"fullscreen-map-banner"},IL={class:"fullscreen-map-container"},SL={key:1,class:"fullscreen-map-footer"},xL={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const n=e,s=H(()=>n.headerTextColor?{color:n.headerTextColor}:{}),o=t,i=()=>{o("done")},l=()=>{o("cancel")},c=()=>{o("close")},d=h=>{h.key==="Escape"&&n.show&&(n.mode==="view"?c():l())};return Ye(()=>n.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),un(()=>{document.addEventListener("keydown",d)}),Sn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(p(),Ge(ec,{to:"body"},[e.show?(p(),y("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=rt(()=>{},["prevent","self"]))},[r("div",{class:le(["fullscreen-map-header",{compact:e.mode==="view"}]),style:tt(e.headerStyle)},[r("div",wL,[r("h3",{style:tt({color:e.headerTextColor})},_(e.title),5),e.description?(p(),y("p",{key:0,style:tt({color:e.headerTextColor,opacity:.85})},_(e.description),5)):P("",!0)]),r("div",_L,[go(h.$slots,"actions",{},void 0,!0),e.mode==="view"?(p(),y("button",{key:0,type:"button",onClick:rt(c,["stop"]),class:"btn btn-close-x",style:tt(s.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(p(),y(Ie,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,CL)],64))])],6),h.$slots.banner?(p(),y("div",LL,[go(h.$slots,"banner",{},void 0,!0)])):P("",!0),r("div",IL,[go(h.$slots,"default",{},void 0,!0)]),h.$slots.footer?(p(),y("div",SL,[go(h.$slots,"footer",{},void 0,!0)])):P("",!0)],32)):P("",!0)]))}},$L=Ke(xL,[["__scopeId","data-v-a1e3e36c"]]),TL={class:"map-wrapper"},ML={class:"fullscreen-map-wrapper"},AL={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(!1),f=D(0),v=D(!1),g=D(!1),k=D({...s.filters});Ye(()=>s.filters,K=>{k.value={...K}},{deep:!0}),Ye(()=>s.areas,K=>{s.showFilters&&K.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=K.map(ae=>ae.id))},{immediate:!0});const b=H(()=>s.showFilters?s.locations.filter(K=>{const ae=K.checkedInCount||0,q=K.requiredMarshals||1,J=ae===0,ee=ae>0&&ae<q,ue=ae>=q;if(J&&!k.value.showUncheckedIn||ee&&!k.value.showPartiallyCheckedIn||ue&&!k.value.showFullyCheckedIn)return!1;const _e=K.areaIds||K.AreaIds||[];return!(s.areas.length>0&&_e.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!_e.some(De=>k.value.selectedAreaIds.includes(De))))}):s.locations),x=H(()=>s.showFilters?k.value.showRoute?s.route:[]:s.route),A=H(()=>s.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?s.areas.filter(K=>k.value.selectedAreaIds.includes(K.id)):s.areas.length>0?[]:s.areas:s.areas),T=H(()=>s.mode==="select-point"?!0:s.mode==="draw-polygon"?f.value>=3:!0),w=()=>h.value?l.value:i.value,C=()=>{h.value=!0,o("fullscreen-change",!0)},I=()=>{h.value=!1,o("fullscreen-change",!1)},$=()=>{if(s.mode==="draw-polygon"){const K=w();K&&K.clearPolygonDrawing(),f.value=0,v.value=!1,g.value=!1}h.value=!1,o("fullscreen-cancel"),o("fullscreen-change",!1)},R=()=>{if(s.mode==="draw-polygon"&&f.value>=3){const K=w();K&&K.completePolygon()}h.value=!1,o("fullscreen-done"),o("fullscreen-change",!1)},M=K=>{k.value=K,o("filter-change",K)},O=K=>{s.mode==="select-point"&&o("point-selected",K),o("map-click",K)},E=K=>{f.value=K?.length||0,j(),o("polygon-drawing",K)},U=K=>{o("polygon-complete",K),f.value=0,v.value=!1,g.value=!1},F=K=>{o("polygon-update",K)},j=()=>{const K=w();K&&(v.value=K.canUndo?K.canUndo():!1,g.value=K.canRedo?K.canRedo():!1)},Z=()=>{const K=w();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),j())},Q=()=>{const K=w();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),j())};return t({getMapCenter:()=>w()?.getMapCenter?.(),getMapZoom:()=>w()?.getMapZoom?.(),undoPolygonPoint:Z,redoPolygonPoint:Q,canUndo:()=>v.value,canRedo:()=>g.value,getPolygonPointCount:()=>f.value,completePolygon:()=>w()?.completePolygon?.(),clearPolygonDrawing:()=>{w()?.clearPolygonDrawing?.(),f.value=0,v.value=!1,g.value=!1},recenterOnUserLocation:()=>w()?.recenterOnUserLocation?.(),recenterOnLocation:(K,ae,q)=>w()?.recenterOnLocation?.(K,ae,q),isLocationInView:(K,ae)=>w()?.isLocationInView?.(K,ae)??!0,getUserLocationInView:()=>w()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>w()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,o("fullscreen-change",!0)},closeFullscreen:I,closeDropdowns:()=>{c.value&&c.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(K,ae)=>(p(),y("div",{class:"common-map",style:tt({height:e.height})},[r("div",TL,[Pe(Qh,{ref_key:"mapViewRef",ref:i,locations:b.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,areas:A.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[0]||(ae[0]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[1]||(ae[1]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:E,onPolygonUpdate:F,onVisibilityChange:ae[2]||(ae[2]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","route-weight","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe(Av,{ref_key:"toolbarRef",ref:c,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:C,onFilterChange:M,onActionClick:ae[3]||(ae[3]=q=>K.$emit("action-click",q))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Pe(Ev,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":v.value,"can-redo":g.value,onUndo:Z,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])]),Pe($L,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":T.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:$,onClose:I},_f({default:Ve(()=>[r("div",ML,[Pe(Qh,{ref_key:"fullscreenMapViewRef",ref:l,locations:b.value,route:x.value,"route-color":e.routeColor,"route-style":e.routeStyle,areas:A.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ae[4]||(ae[4]=q=>K.$emit("location-click",q)),onMapClick:O,onAreaClick:ae[5]||(ae[5]=q=>K.$emit("area-click",q)),onPolygonComplete:U,onPolygonDrawing:E,onPolygonUpdate:F,onVisibilityChange:ae[6]||(ae[6]=q=>K.$emit("visibility-change",q))},null,8,["locations","route","route-color","route-style","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Pe(Av,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:M,onActionClick:ae[7]||(ae[7]=q=>K.$emit("action-click",q))},null,8,["show-filters","filters","areas","actions","position"]),Pe(Ev,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":v.value,"can-redo":g.value,onUndo:Z,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[K.$slots["fullscreen-actions"]?{name:"actions",fn:Ve(()=>[go(K.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,K.$slots["fullscreen-banner"]?{name:"banner",fn:Ve(()=>[go(K.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,K.$slots["fullscreen-footer"]?{name:"footer",fn:Ve(()=>[go(K.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},al=Ke(AL,[["__scopeId","data-v-b4c73381"]]),Un=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],nu="#667eea";function EL(e){const t=e.map(s=>s.color);return Un.find(s=>!t.includes(s.hex))?.hex||nu}function ef(e){const t=e.replace("#",""),n=parseInt(t.slice(0,2),16)/255,s=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Su(e){return!e||e===""?"#ffffff":ef(e)>.179?"#333333":"#ffffff"}function tf(e,t){const n=e||dn.headerGradientStart,s=t||dn.headerGradientEnd,o=ef(n),i=ef(s);return(o+i)/2>.35?"#333333":"#ffffff"}const dn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},PL={class:"branding-color-picker"},DL={key:0,class:"picker-label"},RL={class:"color-name"},OL={key:1,class:"color-popup"},BL={class:"popup-header"},NL={class:"color-grid"},FL=["title","onClick"],UL={key:0,class:"check-mark"},zL={key:0,class:"check-mark"},HL={key:0,class:"custom-hex-input"},VL={class:"hex-input-row"},GL=["disabled"],qL={key:0,class:"hex-error"},jL={key:1,class:"contrast-preview"},WL={__name:"BrandingColorPicker",props:{modelValue:{type:String,default:""},label:{type:String,default:""},defaultColor:{type:String,default:""},showDefault:{type:Boolean,default:!0},showContrastPreview:{type:Boolean,default:!0},colors:{type:Array,default:()=>Un}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(!1),l=D(""),c=D(null),d=H(()=>n.modelValue&&n.modelValue!=="default"?n.modelValue:n.defaultColor||dn.headerGradientStart),h=H(()=>{if(!n.modelValue||n.modelValue===""||n.modelValue==="default")return"Default";const C=n.colors.find(I=>I.hex.toLowerCase()===n.modelValue.toLowerCase());return C?C.name:n.modelValue}),f=H(()=>Su(d.value));function v(C){return n.modelValue&&n.modelValue.toLowerCase()===C.toLowerCase()}const g=H(()=>!n.modelValue||n.modelValue===""||n.modelValue==="default"?!1:!n.colors.some(C=>C.hex.toLowerCase()===n.modelValue.toLowerCase())),k=H(()=>{if(!l.value)return!1;const C=l.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(C)||/^[0-9A-Fa-f]{3}$/.test(C)});function b(){o.value=!o.value,o.value||(i.value=!1)}function x(C){i.value=!1,s("update:modelValue",C),o.value=!1}function A(){i.value=!i.value,i.value&&(g.value?l.value=n.modelValue.replace(/^#/,""):l.value="",cn(()=>{c.value?.focus()}))}function T(){l.value=l.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()}function w(){if(!k.value)return;let C=l.value;C.length===3&&(C=C[0]+C[0]+C[1]+C[1]+C[2]+C[2]),s("update:modelValue","#"+C),i.value=!1,o.value=!1}return(C,I)=>(p(),y("div",PL,[e.label?(p(),y("label",DL,_(e.label),1)):P("",!0),r("button",{type:"button",class:le(["color-button",{active:o.value}]),onClick:b},[r("span",{class:"color-swatch",style:tt({backgroundColor:d.value})},null,4),r("span",RL,_(h.value),1),I[3]||(I[3]=r("span",{class:"arrow"},"",-1))],2),o.value?(p(),y("div",OL,[r("div",BL,[r("span",null,_(e.label||"Select colour"),1),r("button",{type:"button",class:"popup-close",onClick:I[0]||(I[0]=$=>o.value=!1)},"")]),r("div",NL,[e.showDefault?(p(),y("button",{key:0,type:"button",class:le(["color-option default-option",{selected:e.modelValue===""||e.modelValue==="default"}]),onClick:I[1]||(I[1]=$=>x(""))},[...I[4]||(I[4]=[r("span",{class:"default-icon"},"",-1),r("span",null,"Default",-1)])],2)):P("",!0),(p(!0),y(Ie,null,je(e.colors,$=>(p(),y("button",{key:$.hex,type:"button",class:le(["color-option",{selected:v($.hex)}]),style:tt({backgroundColor:$.hex}),title:$.name,onClick:R=>x($.hex)},[v($.hex)?(p(),y("span",UL,"")):P("",!0)],14,FL))),128)),r("button",{type:"button",class:le(["color-option custom-option",{selected:g.value}]),style:tt(g.value?{backgroundColor:e.modelValue}:{}),title:"Custom colour",onClick:A},[I[5]||(I[5]=r("svg",{class:"custom-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"})],-1)),g.value?(p(),y("span",zL,"")):P("",!0)],6)]),i.value?(p(),y("div",HL,[I[7]||(I[7]=r("label",null,"Enter hex code",-1)),r("div",VL,[I[6]||(I[6]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInput",ref:c,"onUpdate:modelValue":I[2]||(I[2]=$=>l.value=$),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:l.value&&!k.value}]),onInput:T,onKeydown:Xo(w,["enter"])},null,34),[[st,l.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:k.value?"#"+l.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!k.value,onClick:w}," Apply ",8,GL)]),l.value&&!k.value?(p(),y("span",qL," Invalid hex code ")):P("",!0)])):P("",!0),e.showContrastPreview?(p(),y("div",jL,[I[8]||(I[8]=r("span",{class:"preview-label"},"Text will appear:",-1)),r("span",{class:"preview-text",style:tt({backgroundColor:d.value,color:f.value})}," Sample Text ",4)])):P("",!0)])):P("",!0)]))}},ZL=Ke(WL,[["__scopeId","data-v-713a193b"]]),KL={class:"course-areas-tab"},YL={key:0,class:"route-settings-bar"},JL={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},XL=["stroke","stroke-dasharray","stroke-linecap"],QL=["onClick"],eI={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},tI=["stroke","stroke-dasharray","stroke-linecap"],nI={class:"style-preview",viewBox:"0 0 60 10",preserveAspectRatio:"none"},oI=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],sI=["onClick"],aI={class:"style-preview-wide",viewBox:"0 0 80 10",preserveAspectRatio:"none"},iI=["stroke","stroke-width","stroke-dasharray","stroke-linecap"],lI=["disabled"],Pv="#3388ff",rI={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map","update:routeSettings"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=e,l=n,c=D(null),d=D(null),h=D(null),f=D(null),v=D(0),g=D(!1),k=D(!1),b=D(i.routeColor),x=D(i.routeStyle),A=D(i.routeWeight);Ye(()=>i.routeColor,$e=>{b.value=$e},{immediate:!0}),Ye(()=>i.routeStyle,$e=>{x.value=$e},{immediate:!0}),Ye(()=>i.routeWeight,$e=>{A.value=$e},{immediate:!0});const T=H(()=>{const $e=b.value!==i.routeColor,De=x.value!==i.routeStyle,Re=A.value!==i.routeWeight;return $e||De||Re}),w=[{value:"line",label:"Solid"},{value:"dash",label:"Dashed"},{value:"dash-long",label:"Long dash"},{value:"dash-short",label:"Short dash"},{value:"dash-dense",label:"Dense dash"},{value:"dot",label:"Dotted"},{value:"dot-sparse",label:"Sparse dots"},{value:"dot-dense",label:"Dense dots"},{value:"dash-dot",label:"Dash-dot"},{value:"dash-dot-dot",label:"Dash-dot-dot"},{value:"long-short",label:"Long-short"},{value:"double-dash",label:"Double dash"}],C=[{value:2,label:"Thin"},{value:4,label:"Normal"},{value:6,label:"Thick"},{value:8,label:"Extra thick"}],I=H(()=>b.value||Pv),$=$e=>{const De=$e.replace("#",""),Re=parseInt(De.substr(0,2),16)/255,be=parseInt(De.substr(2,2),16)/255,z=parseInt(De.substr(4,2),16)/255,Y=de=>de<=.03928?de/12.92:Math.pow((de+.055)/1.055,2.4);return .2126*Y(Re)+.7152*Y(be)+.0722*Y(z)},R=H(()=>{const $e=I.value;return $($e)>.5?{backgroundColor:"#333",borderColor:"#555"}:{}}),M=$e=>{switch($e){case"dash":return"8, 6";case"dash-long":return"16, 8";case"dash-short":return"4, 4";case"dash-dense":return"6, 3";case"dot":return"2, 4";case"dot-sparse":return"2, 8";case"dot-dense":return"2, 2";case"dash-dot":return"12, 4, 2, 4";case"dash-dot-dot":return"12, 4, 2, 4, 2, 4";case"long-short":return"16, 4, 6, 4";case"double-dash":return"8, 3, 8, 8";default:return"none"}},O=$e=>$e==="dot"||$e==="dot-sparse"||$e==="dot-dense"?"round":"butt",E=()=>{g.value=!g.value,k.value=!1},U=()=>{k.value=!k.value,g.value=!1},F=$e=>{x.value=$e,g.value=!1},j=$e=>{A.value=$e,k.value=!1},Z=()=>{l("update:routeSettings",{routeColor:b.value,routeStyle:x.value,routeWeight:A.value})},Q=$e=>{h.value&&!h.value.contains($e.target)&&(g.value=!1),f.value&&!f.value.contains($e.target)&&(k.value=!1)};Ye([g,k],([$e,De])=>{$e||De?document.addEventListener("click",Q,!0):document.removeEventListener("click",Q,!0)}),Sn(()=>{document.removeEventListener("click",Q,!0)});const re=D({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),K=H(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:s.value.checkpoint},{id:"many-checkpoints",label:`Many ${o.value.checkpoints}`},{id:"area",label:s.value.area},{id:"import",label:`Import ${o.value.checkpoints}...`},{id:"upload",label:`Upload ${o.value.course}...`}]}]),ae=({actionId:$e,itemId:De})=>{$e==="add"&&(De==="checkpoint"?(l("add-checkpoint-from-map"),ee()):De==="many-checkpoints"?(l("add-many-checkpoints-from-map"),ee()):De==="area"?(l("add-area-from-map"),ee()):De==="import"?l("import-checkpoints"):De==="upload"&&l("upload-route"))},q=$e=>{re.value=$e},J=$e=>{v.value=$e?.length||0},ee=()=>{c.value&&c.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:ee,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ye(()=>i.areas,$e=>{if($e.length>0){const De=new Set(re.value.selectedAreaIds);$e.forEach(Re=>{De.has(Re.id)||re.value.selectedAreaIds.push(Re.id)}),re.value.selectedAreaIds=re.value.selectedAreaIds.filter(Re=>$e.some(be=>be.id===Re))}},{immediate:!0}),Ye(()=>i.drawingMode,$e=>{$e||(v.value=0)}),($e,De)=>(p(),y("div",KL,[e.route.length>0?(p(),y("div",YL,[De[7]||(De[7]=r("span",{class:"route-settings-label"},"Route style:",-1)),Pe(ZL,{"model-value":b.value,"default-color":Pv,"show-contrast-preview":!1,"show-default":!0,"onUpdate:modelValue":De[0]||(De[0]=Re=>b.value=Re)},null,8,["model-value"]),r("div",{class:"style-selector",ref_key:"styleSelectorRef",ref:h},[r("button",{type:"button",class:"style-selector-button",onClick:E},[(p(),y("svg",JL,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:I.value,"stroke-width":"3","stroke-dasharray":M(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,XL)])),De[5]||(De[5]=r("span",{class:"style-selector-arrow"},"",-1))]),g.value?(p(),y("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),y(Ie,null,je(w,Re=>r("button",{key:Re.value,type:"button",class:le(["style-option",{selected:(x.value||"line")===Re.value}]),onClick:be=>F(Re.value)},[(p(),y("svg",eI,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:I.value,"stroke-width":"3","stroke-dasharray":M(Re.value),"stroke-linecap":O(Re.value)},null,8,tI)]))],10,QL)),64))],4)):P("",!0)],512),r("div",{class:"style-selector",ref_key:"weightSelectorRef",ref:f},[r("button",{type:"button",class:"style-selector-button",onClick:U},[(p(),y("svg",nI,[r("line",{x1:"0",y1:"5",x2:"60",y2:"5",stroke:I.value,"stroke-width":A.value||4,"stroke-dasharray":M(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,oI)])),De[6]||(De[6]=r("span",{class:"style-selector-arrow"},"",-1))]),k.value?(p(),y("div",{key:0,class:"style-dropdown",style:tt(R.value)},[(p(),y(Ie,null,je(C,Re=>r("button",{key:Re.value,type:"button",class:le(["style-option",{selected:(A.value||4)===Re.value}]),onClick:be=>j(Re.value)},[(p(),y("svg",aI,[r("line",{x1:"0",y1:"5",x2:"80",y2:"5",stroke:I.value,"stroke-width":Re.value,"stroke-dasharray":M(x.value||"line"),"stroke-linecap":O(x.value||"line")},null,8,iI)]))],10,sI)),64))],4)):P("",!0)],512),r("button",{type:"button",class:"btn-save-style",disabled:!T.value,onClick:Z}," Save ",8,lI)])):P("",!0),r("div",{class:"map-section",ref_key:"mapSection",ref:c},[Pe(al,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,"route-color":b.value,"route-style":x.value,"route-weight":A.value,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:re.value,"toolbar-actions":K.value,"fullscreen-title":e.drawingMode?`Draw ${N(o).area} boundary`:N(s).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:De[1]||(De[1]=Re=>$e.$emit("map-click",Re)),onLocationClick:De[2]||(De[2]=Re=>$e.$emit("location-click",Re)),onAreaClick:De[3]||(De[3]=Re=>$e.$emit("area-click",Re)),onPolygonComplete:De[4]||(De[4]=Re=>$e.$emit("polygon-complete",Re)),onPolygonDrawing:J,onFilterChange:q,onActionClick:ae},null,8,["locations","route","route-color","route-style","route-weight","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},cI=Ke(rI,[["__scopeId","data-v-4903e5fa"]]),uI=(e,t)=>{const n=String(e).trim(),s=String(t).trim(),o=parseFloat(n),i=parseFloat(s),l=!isNaN(o)&&String(o)===n,c=!isNaN(i)&&String(i)===s;return l&&c?o-i:n.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})},r1=(e,t)=>[...e].sort((n,s)=>{const o=n.displayOrder||0,i=s.displayOrder||0;if(o!==i)return o-i;const l=n.text.localeCompare(s.text,void 0,{sensitivity:"base"});if(l!==0)return l;const c=t(n),d=t(s);return c.localeCompare(d,void 0,{numeric:!0,sensitivity:"base"})}),dI={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,n)=>(p(),y("button",{class:le(["status-pill",[e.variant,{active:e.active}]]),onClick:n[0]||(n[0]=s=>t.$emit("click"))},[go(t.$slots,"default",{},void 0,!0)],2))}},At=Ke(dI,[["__scopeId","data-v-a94deea5"]]),hI={class:"check-in-toggle-container"},fI=["disabled"],pI={key:0,class:"toggle-spinner"},vI={key:1,class:"toggle-icon"},mI={class:"toggle-label"},gI={key:0,class:"check-in-details"},yI={key:0,class:"check-in-method"},kI={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,n=H(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),s=H(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),o=H(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=H(()=>{const{checkedInBy:c,checkInMethod:d,marshalName:h}=t;return c&&c!==h?c:d||""}),l=c=>{if(!c)return"";const d=new Date(c),f=(new Date-d)/(1e3*60*60),v=d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return f>24?`${d.toLocaleDateString([],{day:"numeric",month:"short"})}, ${v}`:v};return(c,d)=>(p(),y("div",hI,[r("button",{class:le(["check-in-toggle disable-on-load",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[e.isLoading?(p(),y("span",pI)):e.isCheckedIn?(p(),y("span",vI,"")):P("",!0),r("span",mI,_(o.value),1)],10,fI),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(p(),y("span",gI,[Je(_(l(e.checkInTime))+" ",1),i.value?(p(),y("span",yI,"("+_(i.value)+")",1)):P("",!0),n.value?(p(),y("span",{key:1,class:le(["check-in-distance",s.value]),onClick:d[1]||(d[1]=rt(h=>c.$emit("distance-click"),["stop"]))},_(n.value),3)):P("",!0)])):P("",!0)]))}},xu=Ke(kI,[["__scopeId","data-v-7fb908af"]]),bI={class:"confirm-modal"},wI={class:"confirm-actions"},_I={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const n=t,s=()=>{n("confirm")},o=()=>{n("cancel")};return(i,l)=>e.show?(p(),y("div",{key:0,class:"modal-overlay",onClick:rt(o,["self"])},[r("div",bI,[r("h3",null,_(e.title),1),r("p",null,_(e.message),1),r("div",wI,[e.showCancel?(p(),y("button",{key:0,onClick:o,class:"btn btn-secondary"},_(e.cancelText),1)):P("",!0),r("button",{onClick:s,class:le(["btn",e.isDanger?"btn-danger":"btn-primary"])},_(e.confirmText),3)])])])):P("",!0)}},gi=Ke(_I,[["__scopeId","data-v-b3f01e55"]]),CI={class:"base-modal-header"},LI={class:"base-modal-header-content"},II={key:0,class:"base-modal-title"},SI={key:0,class:"base-modal-tab-header"},xI={key:1,class:"base-modal-footer"},$I={key:0,class:"base-modal-actions"},TI={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=()=>{const C=document.documentElement,I=getComputedStyle(C).getPropertyValue("--modal-resize-duration").trim();return I.endsWith("s")?parseFloat(I)*1e3:300},s=e,o=t,i=D(!1),l=D(!1),c=D(null),d=D(null);let h=null,f=!1,v=0;const g=()=>{if(!d.value||!c.value||f)return;const C=d.value.scrollHeight,I=v;if(I===C||v===0){v=C;return}f=!0,d.value.style.height=`${I}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${C}px`;const $=n();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,v=C},$)},k=()=>{!c.value||typeof MutationObserver>"u"||(d.value&&(v=d.value.scrollHeight),h=new MutationObserver(()=>{cn(()=>{g()})}),h.observe(c.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{h&&(h.disconnect(),h=null)};un(()=>{cn(()=>{s.show&&k()})}),Sn(()=>{b()}),Ye(()=>s.show,C=>{C?cn(()=>{v=0,k()}):b()});const x=()=>{s.closeOnOverlay&&A()},A=()=>{s.confirmOnClose&&s.isDirty?i.value=!0:o("close")},T=()=>{i.value=!1,o("close")},w=()=>{i.value=!1};return(C,I)=>(p(),Ge(Ls,{name:"modal",appear:""},{default:Ve(()=>[e.show?(p(),y("div",{key:0,class:"base-modal-overlay",style:tt({zIndex:e.zIndex}),onClick:rt(x,["self"])},[r("div",{class:le(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",CI,[r("div",LI,[go(C.$slots,"header",{},()=>[e.title?(p(),y("h2",II,_(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(p(),y("button",{key:0,onClick:A,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),C.$slots["tab-header"]?(p(),y("div",SI,[go(C.$slots,"tab-header",{},void 0,!0)])):P("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:c},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[go(C.$slots,"default",{},void 0,!0)],512)],512),C.$slots.footer||C.$slots.actions?(p(),y("div",xI,[go(C.$slots,"footer",{},()=>[C.$slots.actions?(p(),y("div",$I,[go(C.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!l.value?(p(),Ge(gi,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:T,onCancel:w},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},Yt=Ke(TI,[["__scopeId","data-v-141bdab1"]]),MI={class:"map-modal-content"},AI={class:"location-info"},EI={key:0,class:"info-row"},PI={class:"info-value"},DI={key:1,class:"info-row"},RI={class:"info-label"},OI={class:"info-value"},BI={key:2,class:"info-row distance-row"},NI={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=dt(),n=e,s=D(null);let o=null,i=null,l=null;const c=H(()=>t.value.checkpoint),d=H(()=>n.marshalName&&n.checkpointName?`${n.marshalName} - ${n.checkpointName}`:n.marshalName?n.marshalName:"Check-in location"),h=H(()=>n.distance===null?"":n.distance<1e3?`${Math.round(n.distance)} m`:`${(n.distance/1e3).toFixed(2)} km`),f=H(()=>n.distance===null?"":n.distance<=50?"distance-close":n.distance<=100?"distance-medium":"distance-far"),v=(x,A)=>x==null||A==null?"Unknown":`${x.toFixed(6)}, ${A.toFixed(6)}`,g=()=>{if(!s.value||o)return;let x=[51.505,-.09],A=15;n.checkInLocation&&(x=[n.checkInLocation.lat,n.checkInLocation.lng]),o=Jt.map(s.value).setView(x,A),Jt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(o),k()},k=()=>{if(!o)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const x=[];if(n.checkInLocation){const A=Jt.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Jt.marker([n.checkInLocation.lat,n.checkInLocation.lng],{icon:A}).addTo(o).bindPopup(`<b>${n.marshalName||"Marshal"}</b><br>Check-in location`),x.push([n.checkInLocation.lat,n.checkInLocation.lng])}if(n.checkpointLocation&&n.checkpointLocation.lat&&n.checkpointLocation.lng){const A=Jt.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${n.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Jt.marker([n.checkpointLocation.lat,n.checkpointLocation.lng],{icon:A}).addTo(o).bindPopup(`<b>${n.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),x.push([n.checkpointLocation.lat,n.checkpointLocation.lng])}if(x.length===2){const A=Jt.latLngBounds(x);o.fitBounds(A,{padding:[50,50],maxZoom:17})}else x.length===1&&o.setView(x[0],16)},b=()=>{o&&(o.remove(),o=null,i=null,l=null)};return Ye(()=>n.show,async x=>{x?(await cn(),setTimeout(()=>{g()},100)):b()}),Ye([()=>n.checkInLocation,()=>n.checkpointLocation],()=>{o&&k()},{deep:!0}),un(()=>{n.show&&cn(()=>{setTimeout(()=>{g()},100)})}),Sn(()=>{b()}),(x,A)=>(p(),Ge(Yt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:A[0]||(A[0]=T=>x.$emit("close"))},{default:Ve(()=>[r("div",MI,[r("div",{class:"map-container",ref_key:"mapContainer",ref:s},null,512),r("div",AI,[e.checkInLocation?(p(),y("div",EI,[A[1]||(A[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",PI,_(v(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):P("",!0),e.checkpointLocation?(p(),y("div",DI,[r("span",RI,_(c.value)+" location:",1),r("span",OI,_(v(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):P("",!0),e.distance!==null?(p(),y("div",BI,[A[2]||(A[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:le(["info-value distance-value",f.value])},_(h.value),3)])):P("",!0)])])]),_:1},8,["show","title","z-index"]))}},Nf=Ke(NI,[["__scopeId","data-v-011fa479"]]),FI={class:"marshals-tab"},UI={class:"tab-header"},zI={class:"button-group"},HI={key:0,class:"status-pills"},VI={class:"filters-section"},GI={class:"search-group"},qI={class:"marshals-grid"},jI={class:"marshals-table"},WI={key:0,class:"sort-indicator"},ZI={key:0,class:"sort-indicator"},KI={key:0,class:"sort-indicator"},YI={key:0,class:"sort-indicator"},JI=["onClick"],XI=["rowspan"],QI={class:"checkpoint-cell"},eS={class:"checkpoint-name"},tS={key:0,class:"checkpoint-description"},nS=["rowspan"],oS={key:0,class:"last-active-text"},sS={key:1,class:"last-active-never"},aS=["onClick"],iS={class:"no-checkpoint-text"},lS={class:"hide-on-mobile last-active-cell"},rS={key:0,class:"last-active-text"},cS={key:1,class:"last-active-never"},uS={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:n}){const{terms:s}=dt(),o=e,i=n,l=D(null),c=D(!1),d=D(null),h=z=>{l.value=z},f=z=>{d.value=z,c.value=!0},v=()=>{c.value=!1,d.value=null},g=H(()=>d.value?_e(d.value.marshalId):""),k=H(()=>d.value?ee(d.value.locationId):""),b=H(()=>{if(!d.value)return null;const{checkInLatitude:z,checkInLongitude:Y}=d.value;return!z||!Y?null:{lat:z,lng:Y}}),x=H(()=>{if(!d.value)return null;const z=J(d.value.locationId);return!z?.latitude||!z?.longitude?null:{lat:z.latitude,lng:z.longitude}}),A=H(()=>d.value?$e(d.value):null),T=D(!1),w=D(null),C=z=>{z.isCheckedIn?(w.value=z,T.value=!0):i("toggle-check-in",z)},I=()=>{w.value&&i("toggle-check-in",w.value),T.value=!1,w.value=null},$=()=>{T.value=!1,w.value=null},R=H(()=>w.value?`Are you sure you want to undo ${_e(w.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const M=D("name"),O=D("asc"),E=D(""),U=D("all"),F=z=>{U.value=z},j=z=>{M.value===z?O.value=O.value==="asc"?"desc":"asc":(M.value=z,O.value="asc")},Z=z=>o.assignments.filter(Y=>Y.marshalId===z),Q=H(()=>new Set(o.assignments.filter(z=>z.isCheckedIn).map(z=>z.marshalId))),re=H(()=>new Set(o.assignments.map(z=>z.marshalId))),K=H(()=>Q.value.size),ae=H(()=>o.marshals.filter(z=>!re.value.has(z.id)).length),q=H(()=>o.marshals.filter(z=>re.value.has(z.id)&&!Q.value.has(z.id)).length),J=z=>o.locations.find(Y=>Y.id===z),ee=z=>{const Y=J(z);return Y?Y.name:"Unknown"},ue=z=>{const Y=J(z);return Y?Y.description:""},_e=z=>{const Y=o.marshals.find(de=>de.id===z);return Y?Y.name:""},$e=z=>{const{checkInLatitude:Y,checkInLongitude:de,locationId:ie}=z,Ae=J(ie);return!Y||!de||!Ae?.latitude||!Ae?.longitude?null:sl(Y,de,Ae.latitude,Ae.longitude)},De=z=>{if(!z)return"";const Y=new Date(z),ie=new Date-Y,Ae=Math.floor(ie/6e4),G=Math.floor(Ae/60),X=Math.floor(G/24);return Ae<1?"just now":Ae<60?`${Ae}m ago`:G<24?`${G}h ago`:X===1?"yesterday":X<7?`${X}d ago`:Y.toLocaleDateString()},Re=H(()=>{let z=o.marshals;if(U.value==="unassigned"?z=z.filter(Y=>!re.value.has(Y.id)):U.value==="checked-in"?z=z.filter(Y=>Q.value.has(Y.id)):U.value==="not-checked-in"&&(z=z.filter(Y=>re.value.has(Y.id)&&!Q.value.has(Y.id))),E.value.trim()){const Y=E.value.toLowerCase().trim().split(/\s+/);z=z.filter(de=>{const Ae=Z(de.id).map(X=>{const te=J(X.locationId);return te?`${te.name||""} ${te.description||""}`:""}).join(" "),G=`${de.name} ${Ae}`.toLowerCase();return Y.every(X=>G.includes(X))})}return z}),be=H(()=>{const z=[...Re.value];return z.sort((Y,de)=>{let ie=0;if(M.value==="name")ie=Y.name.localeCompare(de.name);else if(M.value==="checkpoint"){const Ae=Z(Y.id),G=Z(de.id),X=Ae.length>0?ee(Ae[0].locationId):"",te=G.length>0?ee(G[0].locationId):"";ie=uI(X,te)}else if(M.value==="status"){const Ae=Z(Y.id),G=Z(de.id),X=Ae.length>0&&Ae[0].isCheckedIn?1:0;ie=(G.length>0&&G[0].isCheckedIn?1:0)-X}else if(M.value==="lastActive"){const Ae=Y.lastAccessedDate?new Date(Y.lastAccessedDate).getTime():0;ie=(de.lastAccessedDate?new Date(de.lastAccessedDate).getTime():0)-Ae}return O.value==="asc"?ie:-ie}),z});return(z,Y)=>(p(),y("div",FI,[r("div",UI,[r("div",zI,[r("button",{onClick:Y[0]||(Y[0]=de=>z.$emit("add-marshal")),class:"btn btn-primary"}," Add "+_(N(s).person.toLowerCase()),1),r("button",{onClick:Y[1]||(Y[1]=de=>z.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(p(),y("div",HI,[Pe(At,{variant:"neutral",active:U.value==="all",onClick:Y[2]||(Y[2]=de=>F("all"))},{default:Ve(()=>[Je(_(e.marshals.length)+" total ",1)]),_:1},8,["active"]),ae.value>0&&ae.value<e.marshals.length?(p(),Ge(At,{key:0,variant:"warning",active:U.value==="unassigned",onClick:Y[3]||(Y[3]=de=>F("unassigned"))},{default:Ve(()=>[Je(_(ae.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),K.value>0&&K.value<e.marshals.length?(p(),Ge(At,{key:1,variant:"success",active:U.value==="checked-in",onClick:Y[4]||(Y[4]=de=>F("checked-in"))},{default:Ve(()=>[Je(_(K.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),q.value>0&&q.value<e.marshals.length?(p(),Ge(At,{key:2,variant:"danger",active:U.value==="not-checked-in",onClick:Y[5]||(Y[5]=de=>F("not-checked-in"))},{default:Ve(()=>[Je(_(q.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",VI,[r("div",GI,[We(r("input",{"onUpdate:modelValue":Y[6]||(Y[6]=de=>E.value=de),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,E.value]])])]),r("div",qI,[r("table",jI,[r("thead",null,[r("tr",null,[r("th",{onClick:Y[7]||(Y[7]=de=>j("name")),class:"sortable"},[Y[12]||(Y[12]=Je(" Name ",-1)),M.value==="name"?(p(),y("span",WI,_(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[8]||(Y[8]=de=>j("checkpoint")),class:"sortable"},[Je(_(N(s).checkpoint)+" ",1),M.value==="checkpoint"?(p(),y("span",ZI,_(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[9]||(Y[9]=de=>j("status")),class:"sortable"},[Y[13]||(Y[13]=Je(" Status ",-1)),M.value==="status"?(p(),y("span",KI,_(O.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:Y[10]||(Y[10]=de=>j("lastActive")),class:"sortable hide-on-mobile"},[Y[14]||(Y[14]=Je(" Last active ",-1)),M.value==="lastActive"?(p(),y("span",YI,_(O.value==="asc"?"":""),1)):P("",!0)])])]),r("tbody",null,[(p(!0),y(Ie,null,je(be.value,de=>(p(),y(Ie,{key:de.id},[Z(de.id).length>0?(p(!0),y(Ie,{key:0},je(Z(de.id),(ie,Ae)=>(p(),y("tr",{key:`${de.id}-${ie.id}`,class:"marshal-row",onClick:G=>z.$emit("select-marshal",de)},[Ae===0?(p(),y("td",{key:0,rowspan:Z(de.id).length},_(de.name),9,XI)):P("",!0),r("td",QI,[r("div",eS,_(ee(ie.locationId)),1),ue(ie.locationId)?(p(),y("div",tS,_(ue(ie.locationId)),1)):P("",!0)]),r("td",{onClick:Y[11]||(Y[11]=rt(()=>{},["stop"])),class:"check-in-cell"},[Pe(xu,{"is-checked-in":ie.isCheckedIn,"check-in-time":ie.checkInTime,"check-in-method":ie.checkInMethod,"checked-in-by":ie.checkedInBy,"marshal-name":_e(ie.marshalId),"is-loading":l.value===ie.id,distance:$e(ie),onToggle:G=>C(ie),onDistanceClick:G=>f(ie)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),Ae===0?(p(),y("td",{key:1,rowspan:Z(de.id).length,class:"hide-on-mobile last-active-cell"},[de.lastAccessedDate?(p(),y("span",oS,_(De(de.lastAccessedDate)),1)):(p(),y("span",sS,"Never"))],8,nS)):P("",!0)],8,JI))),128)):(p(),y("tr",{key:1,class:"marshal-row",onClick:ie=>z.$emit("select-marshal",de)},[r("td",null,_(de.name),1),r("td",iS,"No "+_(N(s).checkpoint.toLowerCase())+" assigned",1),Y[15]||(Y[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",lS,[de.lastAccessedDate?(p(),y("span",rS,_(De(de.lastAccessedDate)),1)):(p(),y("span",cS,"Never"))])],8,aS))],64))),128))])])]),Pe(Nf,{show:c.value,"marshal-name":g.value,"checkpoint-name":k.value,"check-in-location":b.value,"checkpoint-location":x.value,distance:A.value,onClose:v},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Pe(gi,{show:T.value,title:"Confirm check-out",message:R.value,"confirm-text":"Check out","is-danger":!0,onConfirm:I,onCancel:$},null,8,["show","message"])]))}},dS=Ke(uS,[["__scopeId","data-v-bdb66e38"]]),hS={class:"assignment-pills"},fS={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:n}=dt(),s=e,o=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${n.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${n.value.checkpoints}`,SpecificPeople:`Specific ${n.value.people}`,EveryAreaLead:`Every ${n.value.area} lead`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,OnePerArea:`One per ${n.value.area}`,OneLeadPerArea:`One lead per ${n.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${n.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?s.areas.find(g=>g.id===h)?.name||null:f==="Checkpoint"?s.locations.find(g=>g.id===h)?.name||null:f==="Marshal"&&s.marshals.find(g=>g.id===h)?.name||null,c=h=>{if(!h)return[];const f=o(h.scope),v=h.ids||[];if(h.itemType===null||v.length===0)return[f];if(v.includes("ALL_MARSHALS"))return["Everyone"];if(v.includes("ALL_AREAS"))return[`${f} (All ${n.value.areas})`];if(v.includes("ALL_CHECKPOINTS"))return[`${f} (All ${n.value.checkpoints})`];const g=v.filter(b=>l(b,h.itemType)!==null);if(g.length===0)return[];if(g.length>s.maxExpandedItems)return[`${f} (${g.length})`];const k=i(h.scope);return g.map(b=>{const x=l(b,h.itemType);return k?`${k} ${x}`:x})},d=H(()=>{if(!s.scopeConfigurations||s.scopeConfigurations.length===0)return[];const h=[];for(const f of s.scopeConfigurations)h.push(...c(f));return h});return(h,f)=>(p(),y("div",hS,[(p(!0),y(Ie,null,je(d.value,(v,g)=>(p(),y("span",{key:g,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},_(v),1))),128))]))}},nl=Ke(fS,[["__scopeId","data-v-82c305e5"]]);function Dv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Zs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dv(Object(n),!0).forEach(function(s){pS(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ou(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ou=function(t){return typeof t}:ou=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function pS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sa(){return Sa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Sa.apply(this,arguments)}function vS(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,i;for(i=0;i<s.length;i++)o=s[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function mS(e,t){if(e==null)return{};var n=vS(e,t),s,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)s=i[o],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}var gS="1.14.0";function _a(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Ta=_a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),yc=_a(/Edge/i),Rv=_a(/firefox/i),jr=_a(/safari/i)&&!_a(/chrome/i)&&!_a(/android/i),c1=_a(/iP(ad|od|hone)/i),yS=_a(/chrome/i)&&_a(/android/i),u1={capture:!1,passive:!1};function Wt(e,t,n){e.addEventListener(t,n,!Ta&&u1)}function zt(e,t,n){e.removeEventListener(t,n,!Ta&&u1)}function $u(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function kS(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Gs(e,t,n,s){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&$u(e,t):$u(e,t))||s&&e===n)return e;if(e===n)break}while(e=kS(e))}return null}var Ov=/\s+/g;function Do(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var s=(" "+e.className+" ").replace(Ov," ").replace(" "+t+" "," ");e.className=(s+(n?" "+t:"")).replace(Ov," ")}}function yt(e,t,n){var s=e&&e.style;if(s){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in s)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),s[t]=n+(typeof n=="string"?"":"px")}}function Jl(e,t){var n="";if(typeof e=="string")n=e;else do{var s=yt(e,"transform");s&&s!=="none"&&(n=s+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function d1(e,t,n){if(e){var s=e.getElementsByTagName(t),o=0,i=s.length;if(n)for(;o<i;o++)n(s[o],o);return s}return[]}function Ws(){var e=document.scrollingElement;return e||document.documentElement}function Mn(e,t,n,s,o){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,c,d,h,f,v;if(e!==window&&e.parentNode&&e!==Ws()?(i=e.getBoundingClientRect(),l=i.top,c=i.left,d=i.bottom,h=i.right,f=i.height,v=i.width):(l=0,c=0,d=window.innerHeight,h=window.innerWidth,f=window.innerHeight,v=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!Ta))do if(o&&o.getBoundingClientRect&&(yt(o,"transform")!=="none"||n&&yt(o,"position")!=="static")){var g=o.getBoundingClientRect();l-=g.top+parseInt(yt(o,"border-top-width")),c-=g.left+parseInt(yt(o,"border-left-width")),d=l+i.height,h=c+i.width;break}while(o=o.parentNode);if(s&&e!==window){var k=Jl(o||e),b=k&&k.a,x=k&&k.d;k&&(l/=x,c/=b,v/=b,f/=x,d=l+f,h=c+v)}return{top:l,left:c,bottom:d,right:h,width:v,height:f}}}function Bv(e,t,n){for(var s=ci(e,!0),o=Mn(e)[t];s;){var i=Mn(s)[n],l=void 0;if(l=o>=i,!l)return s;if(s===Ws())break;s=ci(s,!1)}return!1}function sr(e,t,n,s){for(var o=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==kt.ghost&&(s||l[i]!==kt.dragged)&&Gs(l[i],n.draggable,e,!1)){if(o===t)return l[i];o++}i++}return null}function Ff(e,t){for(var n=e.lastElementChild;n&&(n===kt.ghost||yt(n,"display")==="none"||t&&!$u(n,t));)n=n.previousElementSibling;return n||null}function Jo(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==kt.clone&&(!t||$u(e,t))&&n++;return n}function Nv(e){var t=0,n=0,s=Ws();if(e)do{var o=Jl(e),i=o.a,l=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*l}while(e!==s&&(e=e.parentNode));return[t,n]}function bS(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e[n][s])return Number(n)}return-1}function ci(e,t){if(!e||!e.getBoundingClientRect)return Ws();var n=e,s=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=yt(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Ws();if(s||t)return n;s=!0}}while(n=n.parentNode);return Ws()}function wS(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Vd(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Wr;function h1(e,t){return function(){if(!Wr){var n=arguments,s=this;n.length===1?e.call(s,n[0]):e.apply(s,n),Wr=setTimeout(function(){Wr=void 0},t)}}}function _S(){clearTimeout(Wr),Wr=void 0}function f1(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function p1(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var No="Sortable"+new Date().getTime();function CS(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var s=[].slice.call(this.el.children);s.forEach(function(o){if(!(yt(o,"display")==="none"||o===kt.ghost)){e.push({target:o,rect:Mn(o)});var i=Zs({},e[e.length-1].rect);if(o.thisAnimationDuration){var l=Jl(o,!0);l&&(i.top-=l.f,i.left-=l.e)}o.fromRect=i}})}},addAnimationState:function(s){e.push(s)},removeAnimationState:function(s){e.splice(bS(e,{target:s}),1)},animateAll:function(s){var o=this;if(!this.options.animation){clearTimeout(t),typeof s=="function"&&s();return}var i=!1,l=0;e.forEach(function(c){var d=0,h=c.target,f=h.fromRect,v=Mn(h),g=h.prevFromRect,k=h.prevToRect,b=c.rect,x=Jl(h,!0);x&&(v.top-=x.f,v.left-=x.e),h.toRect=v,h.thisAnimationDuration&&Vd(g,v)&&!Vd(f,v)&&(b.top-v.top)/(b.left-v.left)===(f.top-v.top)/(f.left-v.left)&&(d=IS(b,g,k,o.options)),Vd(v,f)||(h.prevFromRect=f,h.prevToRect=v,d||(d=o.options.animation),o.animate(h,b,v,d)),d&&(i=!0,l=Math.max(l,d),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},d),h.thisAnimationDuration=d)}),clearTimeout(t),i?t=setTimeout(function(){typeof s=="function"&&s()},l):typeof s=="function"&&s(),e=[]},animate:function(s,o,i,l){if(l){yt(s,"transition",""),yt(s,"transform","");var c=Jl(this.el),d=c&&c.a,h=c&&c.d,f=(o.left-i.left)/(d||1),v=(o.top-i.top)/(h||1);s.animatingX=!!f,s.animatingY=!!v,yt(s,"transform","translate3d("+f+"px,"+v+"px,0)"),this.forRepaintDummy=LS(s),yt(s,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),yt(s,"transform","translate3d(0,0,0)"),typeof s.animated=="number"&&clearTimeout(s.animated),s.animated=setTimeout(function(){yt(s,"transition",""),yt(s,"transform",""),s.animated=!1,s.animatingX=!1,s.animatingY=!1},l)}}}}function LS(e){return e.offsetWidth}function IS(e,t,n,s){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*s.animation}var Bl=[],Gd={initializeByDefault:!0},kc={mount:function(t){for(var n in Gd)Gd.hasOwnProperty(n)&&!(n in t)&&(t[n]=Gd[n]);Bl.forEach(function(s){if(s.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Bl.push(t)},pluginEvent:function(t,n,s){var o=this;this.eventCanceled=!1,s.cancel=function(){o.eventCanceled=!0};var i=t+"Global";Bl.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][i]&&n[l.pluginName][i](Zs({sortable:n},s)),n.options[l.pluginName]&&n[l.pluginName][t]&&n[l.pluginName][t](Zs({sortable:n},s)))})},initializePlugins:function(t,n,s,o){Bl.forEach(function(c){var d=c.pluginName;if(!(!t.options[d]&&!c.initializeByDefault)){var h=new c(t,n,t.options);h.sortable=t,h.options=t.options,t[d]=h,Sa(s,h.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,n){var s={};return Bl.forEach(function(o){typeof o.eventProperties=="function"&&Sa(s,o.eventProperties.call(n[o.pluginName],t))}),s},modifyOption:function(t,n,s){var o;return Bl.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(t[i.pluginName],s))}),o}};function SS(e){var t=e.sortable,n=e.rootEl,s=e.name,o=e.targetEl,i=e.cloneEl,l=e.toEl,c=e.fromEl,d=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,v=e.newDraggableIndex,g=e.originalEvent,k=e.putSortable,b=e.extraEventProperties;if(t=t||n&&n[No],!!t){var x,A=t.options,T="on"+s.charAt(0).toUpperCase()+s.substr(1);window.CustomEvent&&!Ta&&!yc?x=new CustomEvent(s,{bubbles:!0,cancelable:!0}):(x=document.createEvent("Event"),x.initEvent(s,!0,!0)),x.to=l||n,x.from=c||n,x.item=o||n,x.clone=i,x.oldIndex=d,x.newIndex=h,x.oldDraggableIndex=f,x.newDraggableIndex=v,x.originalEvent=g,x.pullMode=k?k.lastPutMode:void 0;var w=Zs(Zs({},b),kc.getEventProperties(s,t));for(var C in w)x[C]=w[C];n&&n.dispatchEvent(x),A[T]&&A[T].call(t,x)}}var xS=["evt"],xo=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.evt,i=mS(s,xS);kc.pluginEvent.bind(kt)(t,n,Zs({dragEl:ot,parentEl:vn,ghostEl:It,rootEl:rn,nextEl:Gi,lastDownEl:su,cloneEl:mn,cloneHidden:ri,dragStarted:Mr,putSortable:Fn,activeSortable:kt.active,originalEvent:o,oldIndex:ql,oldDraggableIndex:Zr,newIndex:Ro,newDraggableIndex:si,hideGhostForTarget:y1,unhideGhostForTarget:k1,cloneNowHidden:function(){ri=!0},cloneNowShown:function(){ri=!1},dispatchSortableEvent:function(c){fo({sortable:n,name:c,originalEvent:o})}},i))};function fo(e){SS(Zs({putSortable:Fn,cloneEl:mn,targetEl:ot,rootEl:rn,oldIndex:ql,oldDraggableIndex:Zr,newIndex:Ro,newDraggableIndex:si},e))}var ot,vn,It,rn,Gi,su,mn,ri,ql,Ro,Zr,si,Hc,Fn,Vl=!1,Tu=!1,Mu=[],zi,gs,qd,jd,Fv,Uv,Mr,Nl,Kr,Yr=!1,Vc=!1,au,Kn,Wd=[],nf=!1,Au=[],id=typeof document<"u",Gc=c1,zv=yc||Ta?"cssFloat":"float",$S=id&&!yS&&!c1&&"draggable"in document.createElement("div"),v1=(function(){if(id){if(Ta)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),m1=function(t,n){var s=yt(t),o=parseInt(s.width)-parseInt(s.paddingLeft)-parseInt(s.paddingRight)-parseInt(s.borderLeftWidth)-parseInt(s.borderRightWidth),i=sr(t,0,n),l=sr(t,1,n),c=i&&yt(i),d=l&&yt(l),h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Mn(i).width,f=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Mn(l).width;if(s.display==="flex")return s.flexDirection==="column"||s.flexDirection==="column-reverse"?"vertical":"horizontal";if(s.display==="grid")return s.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&c.float&&c.float!=="none"){var v=c.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===v)?"vertical":"horizontal"}return i&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||h>=o&&s[zv]==="none"||l&&s[zv]==="none"&&h+f>o)?"vertical":"horizontal"},TS=function(t,n,s){var o=s?t.left:t.top,i=s?t.right:t.bottom,l=s?t.width:t.height,c=s?n.left:n.top,d=s?n.right:n.bottom,h=s?n.width:n.height;return o===c||i===d||o+l/2===c+h/2},MS=function(t,n){var s;return Mu.some(function(o){var i=o[No].options.emptyInsertThreshold;if(!(!i||Ff(o))){var l=Mn(o),c=t>=l.left-i&&t<=l.right+i,d=n>=l.top-i&&n<=l.bottom+i;if(c&&d)return s=o}}),s},g1=function(t){function n(i,l){return function(c,d,h,f){var v=c.options.group.name&&d.options.group.name&&c.options.group.name===d.options.group.name;if(i==null&&(l||v))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return n(i(c,d,h,f),l)(c,d,h,f);var g=(l?c:d).options.group.name;return i===!0||typeof i=="string"&&i===g||i.join&&i.indexOf(g)>-1}}var s={},o=t.group;(!o||ou(o)!="object")&&(o={name:o}),s.name=o.name,s.checkPull=n(o.pull,!0),s.checkPut=n(o.put),s.revertClone=o.revertClone,t.group=s},y1=function(){!v1&&It&&yt(It,"display","none")},k1=function(){!v1&&It&&yt(It,"display","")};id&&document.addEventListener("click",function(e){if(Tu)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tu=!1,!1},!0);var Hi=function(t){if(ot){t=t.touches?t.touches[0]:t;var n=MS(t.clientX,t.clientY);if(n){var s={};for(var o in t)t.hasOwnProperty(o)&&(s[o]=t[o]);s.target=s.rootEl=n,s.preventDefault=void 0,s.stopPropagation=void 0,n[No]._onDragOver(s)}}},AS=function(t){ot&&ot.parentNode[No]._isOutsideThisEl(t.target)};function kt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Sa({},t),e[No]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return m1(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:kt.supportPointer!==!1&&"PointerEvent"in window&&!jr,emptyInsertThreshold:5};kc.initializePlugins(this,e,n);for(var s in n)!(s in t)&&(t[s]=n[s]);g1(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:$S,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Wt(e,"pointerdown",this._onTapStart):(Wt(e,"mousedown",this._onTapStart),Wt(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Wt(e,"dragover",this),Wt(e,"dragenter",this)),Mu.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Sa(this,CS())}kt.prototype={constructor:kt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Nl=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,ot):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,s=this.el,o=this.options,i=o.preventOnFilter,l=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(c||t).target,h=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,f=o.filter;if(FS(s),!ot&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||o.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&jr&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=Gs(d,o.draggable,s,!1),!(d&&d.animated)&&su!==d)){if(ql=Jo(d),Zr=Jo(d,o.draggable),typeof f=="function"){if(f.call(this,t,d,this)){fo({sortable:n,rootEl:h,name:"filter",targetEl:d,toEl:s,fromEl:s}),xo("filter",n,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(f&&(f=f.split(",").some(function(v){if(v=Gs(h,v.trim(),s,!1),v)return fo({sortable:n,rootEl:v,name:"filter",targetEl:d,fromEl:s,toEl:s}),xo("filter",n,{evt:t}),!0}),f)){i&&t.cancelable&&t.preventDefault();return}o.handle&&!Gs(h,o.handle,s,!1)||this._prepareDragStart(t,c,d)}}},_prepareDragStart:function(t,n,s){var o=this,i=o.el,l=o.options,c=i.ownerDocument,d;if(s&&!ot&&s.parentNode===i){var h=Mn(s);if(rn=i,ot=s,vn=ot.parentNode,Gi=ot.nextSibling,su=s,Hc=l.group,kt.dragged=ot,zi={target:ot,clientX:(n||t).clientX,clientY:(n||t).clientY},Fv=zi.clientX-h.left,Uv=zi.clientY-h.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,ot.style["will-change"]="all",d=function(){if(xo("delayEnded",o,{evt:t}),kt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Rv&&o.nativeDraggable&&(ot.draggable=!0),o._triggerDragStart(t,n),fo({sortable:o,name:"choose",originalEvent:t}),Do(ot,l.chosenClass,!0)},l.ignore.split(",").forEach(function(f){d1(ot,f.trim(),Zd)}),Wt(c,"dragover",Hi),Wt(c,"mousemove",Hi),Wt(c,"touchmove",Hi),Wt(c,"mouseup",o._onDrop),Wt(c,"touchend",o._onDrop),Wt(c,"touchcancel",o._onDrop),Rv&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ot.draggable=!0),xo("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(yc||Ta))){if(kt.eventCanceled){this._onDrop();return}Wt(c,"mouseup",o._disableDelayedDrag),Wt(c,"touchend",o._disableDelayedDrag),Wt(c,"touchcancel",o._disableDelayedDrag),Wt(c,"mousemove",o._delayedDragTouchMoveHandler),Wt(c,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&Wt(c,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ot&&Zd(ot),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;zt(t,"mouseup",this._disableDelayedDrag),zt(t,"touchend",this._disableDelayedDrag),zt(t,"touchcancel",this._disableDelayedDrag),zt(t,"mousemove",this._delayedDragTouchMoveHandler),zt(t,"touchmove",this._delayedDragTouchMoveHandler),zt(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Wt(document,"pointermove",this._onTouchMove):n?Wt(document,"touchmove",this._onTouchMove):Wt(document,"mousemove",this._onTouchMove):(Wt(ot,"dragend",this),Wt(rn,"dragstart",this._onDragStart));try{document.selection?iu(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Vl=!1,rn&&ot){xo("dragStarted",this,{evt:n}),this.nativeDraggable&&Wt(document,"dragover",AS);var s=this.options;!t&&Do(ot,s.dragClass,!1),Do(ot,s.ghostClass,!0),kt.active=this,t&&this._appendGhost(),fo({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(gs){this._lastX=gs.clientX,this._lastY=gs.clientY,y1();for(var t=document.elementFromPoint(gs.clientX,gs.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(gs.clientX,gs.clientY),t!==n);)n=t;if(ot.parentNode[No]._isOutsideThisEl(t),n)do{if(n[No]){var s=void 0;if(s=n[No]._onDragOver({clientX:gs.clientX,clientY:gs.clientY,target:t,rootEl:n}),s&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);k1()}},_onTouchMove:function(t){if(zi){var n=this.options,s=n.fallbackTolerance,o=n.fallbackOffset,i=t.touches?t.touches[0]:t,l=It&&Jl(It,!0),c=It&&l&&l.a,d=It&&l&&l.d,h=Gc&&Kn&&Nv(Kn),f=(i.clientX-zi.clientX+o.x)/(c||1)+(h?h[0]-Wd[0]:0)/(c||1),v=(i.clientY-zi.clientY+o.y)/(d||1)+(h?h[1]-Wd[1]:0)/(d||1);if(!kt.active&&!Vl){if(s&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<s)return;this._onDragStart(t,!0)}if(It){l?(l.e+=f-(qd||0),l.f+=v-(jd||0)):l={a:1,b:0,c:0,d:1,e:f,f:v};var g="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");yt(It,"webkitTransform",g),yt(It,"mozTransform",g),yt(It,"msTransform",g),yt(It,"transform",g),qd=f,jd=v,gs=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!It){var t=this.options.fallbackOnBody?document.body:rn,n=Mn(ot,!0,Gc,!0,t),s=this.options;if(Gc){for(Kn=t;yt(Kn,"position")==="static"&&yt(Kn,"transform")==="none"&&Kn!==document;)Kn=Kn.parentNode;Kn!==document.body&&Kn!==document.documentElement?(Kn===document&&(Kn=Ws()),n.top+=Kn.scrollTop,n.left+=Kn.scrollLeft):Kn=Ws(),Wd=Nv(Kn)}It=ot.cloneNode(!0),Do(It,s.ghostClass,!1),Do(It,s.fallbackClass,!0),Do(It,s.dragClass,!0),yt(It,"transition",""),yt(It,"transform",""),yt(It,"box-sizing","border-box"),yt(It,"margin",0),yt(It,"top",n.top),yt(It,"left",n.left),yt(It,"width",n.width),yt(It,"height",n.height),yt(It,"opacity","0.8"),yt(It,"position",Gc?"absolute":"fixed"),yt(It,"zIndex","100000"),yt(It,"pointerEvents","none"),kt.ghost=It,t.appendChild(It),yt(It,"transform-origin",Fv/parseInt(It.style.width)*100+"% "+Uv/parseInt(It.style.height)*100+"%")}},_onDragStart:function(t,n){var s=this,o=t.dataTransfer,i=s.options;if(xo("dragStart",this,{evt:t}),kt.eventCanceled){this._onDrop();return}xo("setupClone",this),kt.eventCanceled||(mn=p1(ot),mn.draggable=!1,mn.style["will-change"]="",this._hideClone(),Do(mn,this.options.chosenClass,!1),kt.clone=mn),s.cloneId=iu(function(){xo("clone",s),!kt.eventCanceled&&(s.options.removeCloneOnHide||rn.insertBefore(mn,ot),s._hideClone(),fo({sortable:s,name:"clone"}))}),!n&&Do(ot,i.dragClass,!0),n?(Tu=!0,s._loopId=setInterval(s._emulateDragOver,50)):(zt(document,"mouseup",s._onDrop),zt(document,"touchend",s._onDrop),zt(document,"touchcancel",s._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(s,o,ot)),Wt(document,"drop",s),yt(ot,"transform","translateZ(0)")),Vl=!0,s._dragStartId=iu(s._dragStarted.bind(s,n,t)),Wt(document,"selectstart",s),Mr=!0,jr&&yt(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,s=t.target,o,i,l,c=this.options,d=c.group,h=kt.active,f=Hc===d,v=c.sort,g=Fn||h,k,b=this,x=!1;if(nf)return;function A(q,J){xo(q,b,Zs({evt:t,isOwner:f,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:i,canSort:v,fromSortable:g,target:s,completed:w,onMove:function(ue,_e){return qc(rn,n,ot,o,ue,Mn(ue),t,_e)},changed:C},J))}function T(){A("dragOverAnimationCapture"),b.captureAnimationState(),b!==g&&g.captureAnimationState()}function w(q){return A("dragOverCompleted",{insertion:q}),q&&(f?h._hideClone():h._showClone(b),b!==g&&(Do(ot,Fn?Fn.options.ghostClass:h.options.ghostClass,!1),Do(ot,c.ghostClass,!0)),Fn!==b&&b!==kt.active?Fn=b:b===kt.active&&Fn&&(Fn=null),g===b&&(b._ignoreWhileAnimating=s),b.animateAll(function(){A("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==g&&(g.animateAll(),g._ignoreWhileAnimating=null)),(s===ot&&!ot.animated||s===n&&!s.animated)&&(Nl=null),!c.dragoverBubble&&!t.rootEl&&s!==document&&(ot.parentNode[No]._isOutsideThisEl(t.target),!q&&Hi(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),x=!0}function C(){Ro=Jo(ot),si=Jo(ot,c.draggable),fo({sortable:b,name:"change",toEl:n,newIndex:Ro,newDraggableIndex:si,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),s=Gs(s,c.draggable,n,!0),A("dragOver"),kt.eventCanceled)return x;if(ot.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||b._ignoreWhileAnimating===s)return w(!1);if(Tu=!1,h&&!c.disabled&&(f?v||(l=vn!==rn):Fn===this||(this.lastPutMode=Hc.checkPull(this,h,ot,t))&&d.checkPut(this,h,ot,t))){if(k=this._getDirection(t,s)==="vertical",o=Mn(ot),A("dragOverValid"),kt.eventCanceled)return x;if(l)return vn=rn,T(),this._hideClone(),A("revert"),kt.eventCanceled||(Gi?rn.insertBefore(ot,Gi):rn.appendChild(ot)),w(!0);var I=Ff(n,c.draggable);if(!I||RS(t,k,this)&&!I.animated){if(I===ot)return w(!1);if(I&&n===t.target&&(s=I),s&&(i=Mn(s)),qc(rn,n,ot,o,s,i,t,!!s)!==!1)return T(),n.appendChild(ot),vn=n,C(),w(!0)}else if(I&&DS(t,k,this)){var $=sr(n,0,c,!0);if($===ot)return w(!1);if(s=$,i=Mn(s),qc(rn,n,ot,o,s,i,t,!1)!==!1)return T(),n.insertBefore(ot,$),vn=n,C(),w(!0)}else if(s.parentNode===n){i=Mn(s);var R=0,M,O=ot.parentNode!==n,E=!TS(ot.animated&&ot.toRect||o,s.animated&&s.toRect||i,k),U=k?"top":"left",F=Bv(s,"top","top")||Bv(ot,"top","top"),j=F?F.scrollTop:void 0;Nl!==s&&(M=i[U],Yr=!1,Vc=!E&&c.invertSwap||O),R=OS(t,s,i,k,E?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,Vc,Nl===s);var Z;if(R!==0){var Q=Jo(ot);do Q-=R,Z=vn.children[Q];while(Z&&(yt(Z,"display")==="none"||Z===It))}if(R===0||Z===s)return w(!1);Nl=s,Kr=R;var re=s.nextElementSibling,K=!1;K=R===1;var ae=qc(rn,n,ot,o,s,i,t,K);if(ae!==!1)return(ae===1||ae===-1)&&(K=ae===1),nf=!0,setTimeout(PS,30),T(),K&&!re?n.appendChild(ot):s.parentNode.insertBefore(ot,K?re:s),F&&f1(F,0,j-F.scrollTop),vn=ot.parentNode,M!==void 0&&!Vc&&(au=Math.abs(M-Mn(s)[U])),C(),w(!0)}if(n.contains(ot))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zt(document,"mousemove",this._onTouchMove),zt(document,"touchmove",this._onTouchMove),zt(document,"pointermove",this._onTouchMove),zt(document,"dragover",Hi),zt(document,"mousemove",Hi),zt(document,"touchmove",Hi)},_offUpEvents:function(){var t=this.el.ownerDocument;zt(t,"mouseup",this._onDrop),zt(t,"touchend",this._onDrop),zt(t,"pointerup",this._onDrop),zt(t,"touchcancel",this._onDrop),zt(document,"selectstart",this)},_onDrop:function(t){var n=this.el,s=this.options;if(Ro=Jo(ot),si=Jo(ot,s.draggable),xo("drop",this,{evt:t}),vn=ot&&ot.parentNode,Ro=Jo(ot),si=Jo(ot,s.draggable),kt.eventCanceled){this._nulling();return}Vl=!1,Vc=!1,Yr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),of(this.cloneId),of(this._dragStartId),this.nativeDraggable&&(zt(document,"drop",this),zt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),jr&&yt(document.body,"user-select",""),yt(ot,"transform",""),t&&(Mr&&(t.cancelable&&t.preventDefault(),!s.dropBubble&&t.stopPropagation()),It&&It.parentNode&&It.parentNode.removeChild(It),(rn===vn||Fn&&Fn.lastPutMode!=="clone")&&mn&&mn.parentNode&&mn.parentNode.removeChild(mn),ot&&(this.nativeDraggable&&zt(ot,"dragend",this),Zd(ot),ot.style["will-change"]="",Mr&&!Vl&&Do(ot,Fn?Fn.options.ghostClass:this.options.ghostClass,!1),Do(ot,this.options.chosenClass,!1),fo({sortable:this,name:"unchoose",toEl:vn,newIndex:null,newDraggableIndex:null,originalEvent:t}),rn!==vn?(Ro>=0&&(fo({rootEl:vn,name:"add",toEl:vn,fromEl:rn,originalEvent:t}),fo({sortable:this,name:"remove",toEl:vn,originalEvent:t}),fo({rootEl:vn,name:"sort",toEl:vn,fromEl:rn,originalEvent:t}),fo({sortable:this,name:"sort",toEl:vn,originalEvent:t})),Fn&&Fn.save()):Ro!==ql&&Ro>=0&&(fo({sortable:this,name:"update",toEl:vn,originalEvent:t}),fo({sortable:this,name:"sort",toEl:vn,originalEvent:t})),kt.active&&((Ro==null||Ro===-1)&&(Ro=ql,si=Zr),fo({sortable:this,name:"end",toEl:vn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){xo("nulling",this),rn=ot=vn=It=Gi=mn=su=ri=zi=gs=Mr=Ro=si=ql=Zr=Nl=Kr=Fn=Hc=kt.dragged=kt.ghost=kt.clone=kt.active=null,Au.forEach(function(t){t.checked=!0}),Au.length=qd=jd=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":ot&&(this._onDragOver(t),ES(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,s=this.el.children,o=0,i=s.length,l=this.options;o<i;o++)n=s[o],Gs(n,l.draggable,this.el,!1)&&t.push(n.getAttribute(l.dataIdAttr)||NS(n));return t},sort:function(t,n){var s={},o=this.el;this.toArray().forEach(function(i,l){var c=o.children[l];Gs(c,this.options.draggable,o,!1)&&(s[i]=c)},this),n&&this.captureAnimationState(),t.forEach(function(i){s[i]&&(o.removeChild(s[i]),o.appendChild(s[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Gs(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var s=this.options;if(n===void 0)return s[t];var o=kc.modifyOption(this,t,n);typeof o<"u"?s[t]=o:s[t]=n,t==="group"&&g1(s)},destroy:function(){xo("destroy",this);var t=this.el;t[No]=null,zt(t,"mousedown",this._onTapStart),zt(t,"touchstart",this._onTapStart),zt(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(zt(t,"dragover",this),zt(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Mu.splice(Mu.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ri){if(xo("hideClone",this),kt.eventCanceled)return;yt(mn,"display","none"),this.options.removeCloneOnHide&&mn.parentNode&&mn.parentNode.removeChild(mn),ri=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ri){if(xo("showClone",this),kt.eventCanceled)return;ot.parentNode==rn&&!this.options.group.revertClone?rn.insertBefore(mn,ot):Gi?rn.insertBefore(mn,Gi):rn.appendChild(mn),this.options.group.revertClone&&this.animate(ot,mn),yt(mn,"display",""),ri=!1}}};function ES(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function qc(e,t,n,s,o,i,l,c){var d,h=e[No],f=h.options.onMove,v;return window.CustomEvent&&!Ta&&!yc?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=e,d.dragged=n,d.draggedRect=s,d.related=o||t,d.relatedRect=i||Mn(t),d.willInsertAfter=c,d.originalEvent=l,e.dispatchEvent(d),f&&(v=f.call(h,d,l)),v}function Zd(e){e.draggable=!1}function PS(){nf=!1}function DS(e,t,n){var s=Mn(sr(n.el,0,n.options,!0)),o=10;return t?e.clientX<s.left-o||e.clientY<s.top&&e.clientX<s.right:e.clientY<s.top-o||e.clientY<s.bottom&&e.clientX<s.left}function RS(e,t,n){var s=Mn(Ff(n.el,n.options.draggable)),o=10;return t?e.clientX>s.right+o||e.clientX<=s.right&&e.clientY>s.bottom&&e.clientX>=s.left:e.clientX>s.right&&e.clientY>s.top||e.clientX<=s.right&&e.clientY>s.bottom+o}function OS(e,t,n,s,o,i,l,c){var d=s?e.clientY:e.clientX,h=s?n.height:n.width,f=s?n.top:n.left,v=s?n.bottom:n.right,g=!1;if(!l){if(c&&au<h*o){if(!Yr&&(Kr===1?d>f+h*i/2:d<v-h*i/2)&&(Yr=!0),Yr)g=!0;else if(Kr===1?d<f+au:d>v-au)return-Kr}else if(d>f+h*(1-o)/2&&d<v-h*(1-o)/2)return BS(t)}return g=g||l,g&&(d<f+h*i/2||d>v-h*i/2)?d>f+h/2?1:-1:0}function BS(e){return Jo(ot)<Jo(e)?1:-1}function NS(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,s=0;n--;)s+=t.charCodeAt(n);return s.toString(36)}function FS(e){Au.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var s=t[n];s.checked&&Au.push(s)}}function iu(e){return setTimeout(e,0)}function of(e){return clearTimeout(e)}id&&Wt(document,"touchmove",function(e){(kt.active||Vl)&&e.cancelable&&e.preventDefault()});kt.utils={on:Wt,off:zt,css:yt,find:d1,is:function(t,n){return!!Gs(t,n,t,!1)},extend:wS,throttle:h1,closest:Gs,toggleClass:Do,clone:p1,index:Jo,nextTick:iu,cancelNextTick:of,detectDirection:m1,getChild:sr};kt.get=function(e){return e[No]};kt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(s){if(!s.prototype||!s.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(s));s.utils&&(kt.utils=Zs(Zs({},kt.utils),s.utils)),kc.mount(s)})};kt.create=function(e,t){return new kt(e,t)};kt.version=gS;var In=[],Ar,sf,af=!1,Kd,Yd,Eu,Er;function US(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var s=n.originalEvent;this.sortable.nativeDraggable?Wt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Wt(document,"pointermove",this._handleFallbackAutoScroll):s.touches?Wt(document,"touchmove",this._handleFallbackAutoScroll):Wt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var s=n.originalEvent;!this.options.dragOverBubble&&!s.rootEl&&this._handleAutoScroll(s)},drop:function(){this.sortable.nativeDraggable?zt(document,"dragover",this._handleAutoScroll):(zt(document,"pointermove",this._handleFallbackAutoScroll),zt(document,"touchmove",this._handleFallbackAutoScroll),zt(document,"mousemove",this._handleFallbackAutoScroll)),Hv(),lu(),_S()},nulling:function(){Eu=sf=Ar=af=Er=Kd=Yd=null,In.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,s){var o=this,i=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(i,l);if(Eu=n,s||this.options.forceAutoScrollFallback||yc||Ta||jr){Jd(n,this.options,c,s);var d=ci(c,!0);af&&(!Er||i!==Kd||l!==Yd)&&(Er&&Hv(),Er=setInterval(function(){var h=ci(document.elementFromPoint(i,l),!0);h!==d&&(d=h,lu()),Jd(n,o.options,h,s)},10),Kd=i,Yd=l)}else{if(!this.options.bubbleScroll||ci(c,!0)===Ws()){lu();return}Jd(n,this.options,ci(c,!1),!1)}}},Sa(e,{pluginName:"scroll",initializeByDefault:!0})}function lu(){In.forEach(function(e){clearInterval(e.pid)}),In=[]}function Hv(){clearInterval(Er)}var Jd=h1(function(e,t,n,s){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,c=t.scrollSpeed,d=Ws(),h=!1,f;sf!==n&&(sf=n,lu(),Ar=t.scroll,f=t.scrollFn,Ar===!0&&(Ar=ci(n,!0)));var v=0,g=Ar;do{var k=g,b=Mn(k),x=b.top,A=b.bottom,T=b.left,w=b.right,C=b.width,I=b.height,$=void 0,R=void 0,M=k.scrollWidth,O=k.scrollHeight,E=yt(k),U=k.scrollLeft,F=k.scrollTop;k===d?($=C<M&&(E.overflowX==="auto"||E.overflowX==="scroll"||E.overflowX==="visible"),R=I<O&&(E.overflowY==="auto"||E.overflowY==="scroll"||E.overflowY==="visible")):($=C<M&&(E.overflowX==="auto"||E.overflowX==="scroll"),R=I<O&&(E.overflowY==="auto"||E.overflowY==="scroll"));var j=$&&(Math.abs(w-o)<=l&&U+C<M)-(Math.abs(T-o)<=l&&!!U),Z=R&&(Math.abs(A-i)<=l&&F+I<O)-(Math.abs(x-i)<=l&&!!F);if(!In[v])for(var Q=0;Q<=v;Q++)In[Q]||(In[Q]={});(In[v].vx!=j||In[v].vy!=Z||In[v].el!==k)&&(In[v].el=k,In[v].vx=j,In[v].vy=Z,clearInterval(In[v].pid),(j!=0||Z!=0)&&(h=!0,In[v].pid=setInterval((function(){s&&this.layer===0&&kt.active._onTouchMove(Eu);var re=In[this.layer].vy?In[this.layer].vy*c:0,K=In[this.layer].vx?In[this.layer].vx*c:0;typeof f=="function"&&f.call(kt.dragged.parentNode[No],K,re,e,Eu,In[this.layer].el)!=="continue"||f1(In[this.layer].el,K,re)}).bind({layer:v}),24))),v++}while(t.bubbleScroll&&g!==d&&(g=ci(g,!1)));af=h}},30),b1=function(t){var n=t.originalEvent,s=t.putSortable,o=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,c=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(n){var h=s||i;c();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,v=document.elementFromPoint(f.clientX,f.clientY);d(),h&&!h.el.contains(v)&&(l("spill"),this.onSpill({dragEl:o,putSortable:s}))}};function Uf(){}Uf.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,s=t.putSortable;this.sortable.captureAnimationState(),s&&s.captureAnimationState();var o=sr(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),s&&s.animateAll()},drop:b1};Sa(Uf,{pluginName:"revertOnSpill"});function zf(){}zf.prototype={onSpill:function(t){var n=t.dragEl,s=t.putSortable,o=s||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:b1};Sa(zf,{pluginName:"removeOnSpill"});kt.mount(new US);kt.mount(zf,Uf);const zS=["data-id"],HS={key:0,class:"order-overlay"},il={__name:"DraggableList",props:{items:{type:Array,required:!0},itemKey:{type:String,default:"id"},pinnedKey:{type:String,default:null},disabled:{type:Boolean,default:!1},layout:{type:String,default:"list"},showOrderOverlay:{type:Boolean,default:!0}},emits:["reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(!1);let l=null;const c=D([...n.items]);Ye(()=>n.items,k=>{c.value=[...k]},{deep:!0}),Ye(()=>n.disabled,k=>{l&&l.option("disabled",k)});const d=k=>{i.value=!1;const{oldIndex:b,newIndex:x}=k;if(b===x)return;const A=c.value.splice(b,1)[0];c.value.splice(x,0,A);const T=c.value.map((w,C)=>({id:w[n.itemKey],displayOrder:C+1}));s("reorder",{items:c.value,changes:T})},h=()=>{i.value=!0},f=k=>{if(!n.pinnedKey)return!0;const b=k.dragged.dataset.id,x=c.value.find(I=>String(I[n.itemKey])===b);if(!x)return!0;const A=x[n.pinnedKey],T=k.related.dataset.id,w=c.value.find(I=>String(I[n.itemKey])===T);if(!w)return!0;const C=w[n.pinnedKey];return A===C},v=()=>{o.value&&(l=kt.create(o.value,{animation:200,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",disabled:n.disabled,onMove:f,onStart:h,onEnd:d}))},g=()=>{l&&(l.destroy(),l=null)};return un(()=>{cn(()=>{v()})}),Sn(()=>{g()}),(k,b)=>(p(),y("div",{ref_key:"listRef",ref:o,class:le(["draggable-list",{"draggable-grid":e.layout==="grid","is-dragging":i.value}])},[(p(!0),y(Ie,null,je(c.value,(x,A)=>(p(),y("div",{key:x[e.itemKey],"data-id":x[e.itemKey],class:"draggable-item"},[go(k.$slots,"item",{element:x,index:A}),i.value&&e.showOrderOverlay?(p(),y("div",HS,_(A+1),1)):P("",!0)],8,zS))),128))],2))}},VS=["title"],ll={__name:"DragHandle",props:{disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(p(),y("span",{class:le(["drag-handle",{disabled:e.disabled}]),title:e.disabled?"":"Drag to reorder"},[...n[0]||(n[0]=[vi('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><circle cx="5" cy="3" r="1.5"></circle><circle cx="11" cy="3" r="1.5"></circle><circle cx="5" cy="8" r="1.5"></circle><circle cx="11" cy="8" r="1.5"></circle><circle cx="5" cy="13" r="1.5"></circle><circle cx="11" cy="13" r="1.5"></circle></svg>',1)])],10,VS))}},GS={class:"checklists-tab"},qS={class:"tab-header"},jS={class:"button-group"},WS={class:"view-toggle"},ZS={key:0,class:"status-pills"},KS={key:1,class:"status-pills"},YS={key:2,class:"status-pills"},JS={key:3,class:"status-pills"},XS={class:"filters-section"},QS={class:"search-group"},ex=["placeholder"],tx={class:"checklist-items-list"},nx={key:0,class:"empty-state"},ox={class:"checklist-item-card"},sx={class:"checklist-item-content"},ax=["onClick"],ix={key:0,class:"loading-state"},lx={key:1,class:"empty-state"},rx={class:"filters-section"},cx={class:"search-group"},ux=["placeholder"],dx={class:"report-list"},hx={key:0,class:"empty-state"},fx=["onClick"],px={class:"report-card-title"},vx={class:"expand-icon"},mx={class:"report-card-stats"},gx={key:0,class:"report-card-body"},yx={class:"task-text"},kx={key:0,class:"task-completed-by"},bx={key:0,class:"loading-state"},wx={key:1,class:"empty-state"},_x={class:"filters-section"},Cx={class:"search-group"},Lx=["placeholder"],Ix={class:"report-list"},Sx={key:0,class:"empty-state"},xx=["onClick"],$x={class:"report-card-title"},Tx={class:"expand-icon"},Mx={class:"report-card-stats"},Ax={key:0,class:"report-card-body"},Ex={key:0,class:"empty-state small"},Px={class:"task-text"},Dx={key:0,class:"task-completed-by"},Rx={key:0,class:"loading-state"},Ox={key:1,class:"empty-state"},Bx={class:"filters-section"},Nx={class:"search-group"},Fx=["placeholder"],Ux={class:"report-list"},zx={key:0,class:"empty-state"},Hx=["onClick"],Vx={class:"report-card-title"},Gx={class:"expand-icon"},qx={class:"report-card-stats"},jx={class:"stat-badge secondary"},Wx={key:0,class:"report-card-body nested-body"},Zx=["onClick"],Kx={class:"nested-card-title"},Yx={class:"expand-icon"},Jx={class:"nested-card-stats"},Xx={key:0,class:"nested-card-body"},Qx={class:"task-text"},e$={key:0,class:"task-completed-by"},t$={key:0,class:"loading-state"},n$={key:1,class:"empty-state"},o$={class:"filters-section"},s$={class:"search-group"},a$=["placeholder"],i$={class:"report-list"},l$={key:0,class:"empty-state"},r$=["onClick"],c$={class:"report-card-title"},u$={class:"expand-icon"},d$={class:"report-card-title-text"},h$={key:0,class:"report-card-description"},f$={class:"report-card-stats"},p$={class:"stat-badge secondary"},v$={key:0,class:"report-card-body nested-body"},m$=["onClick"],g$={class:"nested-card-title"},y$={class:"expand-icon"},k$={class:"nested-card-stats"},b$={key:0,class:"nested-card-body"},w$={class:"task-text"},_$={key:0,class:"task-completed-by"},C$={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null},detailedReport:{type:Object,default:null},isLoadingDetailedReport:{type:Boolean,default:!1}},emits:["add-checklist-item","select-checklist-item","reorder","load-detailed-report"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D("define"),l=D(""),c=D(""),d=D(""),h=D(""),f=D(""),v=D("all"),g=D("all"),k=D("all"),b=D("all"),x=D(new Set),A=D(new Set),T=D(new Set),w=D(new Set),C=D(new Set),I=D(new Set),$=be=>{i.value=be,(be==="byPerson"||be==="byTask"||be==="byCheckpoint"||be==="byArea")&&!s.detailedReport&&!s.isLoadingDetailedReport&&o("load-detailed-report")},R=be=>{x.value.has(be)?x.value.delete(be):(x.value.clear(),x.value.add(be)),x.value=new Set(x.value)},M=be=>{A.value.has(be)?A.value.delete(be):(A.value.clear(),A.value.add(be)),A.value=new Set(A.value)},O=be=>{T.value.has(be)?(T.value.delete(be),C.value.clear()):(T.value.clear(),C.value.clear(),T.value.add(be)),T.value=new Set(T.value),C.value=new Set(C.value)},E=be=>{w.value.has(be)?(w.value.delete(be),I.value.clear()):(w.value.clear(),I.value.clear(),w.value.add(be)),w.value=new Set(w.value),I.value=new Set(I.value)},U=(be,z)=>{const Y=`${be}:${z}`;C.value.has(Y)?C.value.delete(Y):([...C.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>C.value.delete(ie)),C.value.add(Y)),C.value=new Set(C.value)},F=(be,z)=>{const Y=`${be}:${z}`;I.value.has(Y)?I.value.delete(Y):([...I.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>I.value.delete(ie)),I.value.add(Y)),I.value=new Set(I.value)},j=H(()=>{if(!l.value.trim())return s.checklistItems;const be=l.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(z=>{const Y=(z.text||"").toLowerCase();return be.every(de=>Y.includes(de))})}),Z=H(()=>[...j.value].sort((be,z)=>be.displayOrder!==z.displayOrder?be.displayOrder-z.displayOrder:Qo(be.text,z.text))),Q=(be,z)=>be===0?"incomplete":be===z?"complete":"partial",re=(be,z)=>be===0?"not-started":be===z?"complete":"partial",K=H(()=>{if(!s.detailedReport?.detailedByPerson)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByPerson;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),ae=H(()=>{if(!s.detailedReport?.detailedByTask)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByTask;return{total:be.length,incomplete:be.filter(z=>Q(z.completedCount,z.applicableCount)==="incomplete").length,partial:be.filter(z=>Q(z.completedCount,z.applicableCount)==="partial").length,complete:be.filter(z=>Q(z.completedCount,z.applicableCount)==="complete").length}}),q=H(()=>{if(!s.detailedReport?.detailedByCheckpoint)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByCheckpoint;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),J=H(()=>{if(!s.detailedReport?.detailedByArea)return{total:0,incomplete:0,partial:0,complete:0};const be=s.detailedReport.detailedByArea;return{total:be.length,incomplete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="incomplete").length,partial:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="partial").length,complete:be.filter(z=>Q(z.completedTasks,z.totalTasks)==="complete").length}}),ee=H(()=>{if(!s.detailedReport?.detailedByPerson)return[];let be=s.detailedReport.detailedByPerson;if(v.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===v.value)),c.value.trim()){const z=c.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.marshalName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be}),ue=H(()=>{if(!s.detailedReport?.detailedByTask)return[];let be=s.detailedReport.detailedByTask;if(g.value!=="all"&&(be=be.filter(z=>Q(z.completedCount,z.applicableCount)===g.value)),d.value.trim()){const z=d.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.text||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be}),_e=H(()=>{if(!s.detailedReport?.detailedByCheckpoint)return[];let be=[...s.detailedReport.detailedByCheckpoint];if(k.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===k.value)),h.value.trim()){const z=h.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.checkpointName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be.sort((z,Y)=>Qo(z.checkpointName,Y.checkpointName)),be}),$e=H(()=>{if(!s.detailedReport?.detailedByArea)return[];let be=[...s.detailedReport.detailedByArea];if(b.value!=="all"&&(be=be.filter(z=>Q(z.completedTasks,z.totalTasks)===b.value)),f.value.trim()){const z=f.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const de=(Y.areaName||"").toLowerCase();return z.every(ie=>de.includes(ie))})}return be.sort((z,Y)=>Qo(z.areaName,Y.areaName)),be}),De=be=>[...be].sort((z,Y)=>z.displayOrder!==Y.displayOrder?z.displayOrder-Y.displayOrder:Qo(z.text,Y.text)),Re=({changes:be})=>{o("reorder",be)};return(be,z)=>(p(),y("div",GS,[r("div",qS,[r("div",jS,[r("div",WS,[r("button",{class:le(["view-toggle-btn",{active:i.value==="define"}]),onClick:z[0]||(z[0]=Y=>$("define"))}," Define ",2),r("button",{class:le(["view-toggle-btn",{active:i.value==="byArea"}]),onClick:z[1]||(z[1]=Y=>$("byArea"))}," By "+_(N(n).area),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byCheckpoint"}]),onClick:z[2]||(z[2]=Y=>$("byCheckpoint"))}," By "+_(N(n).checkpoint),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byPerson"}]),onClick:z[3]||(z[3]=Y=>$("byPerson"))}," By "+_(N(n).person),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byTask"}]),onClick:z[4]||(z[4]=Y=>$("byTask"))}," By "+_(N(n).checklist),3)]),i.value==="define"?(p(),y("button",{key:0,onClick:z[5]||(z[5]=Y=>be.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+_(N(n).checklist),1)):P("",!0)]),i.value==="byArea"&&J.value.total>0?(p(),y("div",ZS,[Pe(At,{variant:"neutral",active:b.value==="all",onClick:z[6]||(z[6]=Y=>b.value="all")},{default:Ve(()=>[Je(_(J.value.total)+" total ",1)]),_:1},8,["active"]),J.value.incomplete>0?(p(),Ge(At,{key:0,variant:"danger",active:b.value==="incomplete",onClick:z[7]||(z[7]=Y=>b.value="incomplete")},{default:Ve(()=>[Je(_(J.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),J.value.partial>0?(p(),Ge(At,{key:1,variant:"warning",active:b.value==="partial",onClick:z[8]||(z[8]=Y=>b.value="partial")},{default:Ve(()=>[Je(_(J.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),J.value.complete>0?(p(),Ge(At,{key:2,variant:"success",active:b.value==="complete",onClick:z[9]||(z[9]=Y=>b.value="complete")},{default:Ve(()=>[Je(_(J.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byCheckpoint"&&q.value.total>0?(p(),y("div",KS,[Pe(At,{variant:"neutral",active:k.value==="all",onClick:z[10]||(z[10]=Y=>k.value="all")},{default:Ve(()=>[Je(_(q.value.total)+" total ",1)]),_:1},8,["active"]),q.value.incomplete>0?(p(),Ge(At,{key:0,variant:"danger",active:k.value==="incomplete",onClick:z[11]||(z[11]=Y=>k.value="incomplete")},{default:Ve(()=>[Je(_(q.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),q.value.partial>0?(p(),Ge(At,{key:1,variant:"warning",active:k.value==="partial",onClick:z[12]||(z[12]=Y=>k.value="partial")},{default:Ve(()=>[Je(_(q.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),q.value.complete>0?(p(),Ge(At,{key:2,variant:"success",active:k.value==="complete",onClick:z[13]||(z[13]=Y=>k.value="complete")},{default:Ve(()=>[Je(_(q.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byPerson"&&K.value.total>0?(p(),y("div",YS,[Pe(At,{variant:"neutral",active:v.value==="all",onClick:z[14]||(z[14]=Y=>v.value="all")},{default:Ve(()=>[Je(_(K.value.total)+" total ",1)]),_:1},8,["active"]),K.value.incomplete>0?(p(),Ge(At,{key:0,variant:"danger",active:v.value==="incomplete",onClick:z[15]||(z[15]=Y=>v.value="incomplete")},{default:Ve(()=>[Je(_(K.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),K.value.partial>0?(p(),Ge(At,{key:1,variant:"warning",active:v.value==="partial",onClick:z[16]||(z[16]=Y=>v.value="partial")},{default:Ve(()=>[Je(_(K.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),K.value.complete>0?(p(),Ge(At,{key:2,variant:"success",active:v.value==="complete",onClick:z[17]||(z[17]=Y=>v.value="complete")},{default:Ve(()=>[Je(_(K.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0),i.value==="byTask"&&ae.value.total>0?(p(),y("div",JS,[Pe(At,{variant:"neutral",active:g.value==="all",onClick:z[18]||(z[18]=Y=>g.value="all")},{default:Ve(()=>[Je(_(ae.value.total)+" total ",1)]),_:1},8,["active"]),ae.value.incomplete>0?(p(),Ge(At,{key:0,variant:"danger",active:g.value==="incomplete",onClick:z[19]||(z[19]=Y=>g.value="incomplete")},{default:Ve(()=>[Je(_(ae.value.incomplete)+" not started ",1)]),_:1},8,["active"])):P("",!0),ae.value.partial>0?(p(),Ge(At,{key:1,variant:"warning",active:g.value==="partial",onClick:z[20]||(z[20]=Y=>g.value="partial")},{default:Ve(()=>[Je(_(ae.value.partial)+" partial ",1)]),_:1},8,["active"])):P("",!0),ae.value.complete>0?(p(),Ge(At,{key:2,variant:"success",active:g.value==="complete",onClick:z[21]||(z[21]=Y=>g.value="complete")},{default:Ve(()=>[Je(_(ae.value.complete)+" complete ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),i.value==="define"?(p(),y(Ie,{key:0},[r("div",XS,[r("div",QS,[We(r("input",{"onUpdate:modelValue":z[22]||(z[22]=Y=>l.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checklists}...`},null,8,ex),[[st,l.value]])])]),r("div",tx,[j.value.length===0?(p(),y("div",nx,[r("p",null,_(l.value?`No ${N(n).checklists} match your search.`:`No ${N(n).checklists} yet. Create one to get started!`),1)])):(p(),Ge(il,{key:1,items:Z.value,"item-key":"itemId",disabled:!!l.value,onReorder:Re},{item:Ve(({element:Y})=>[r("div",ox,[l.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",sx,[r("div",{class:"checklist-item-title",onClick:de=>be.$emit("select-checklist-item",Y,"details")},[r("strong",null,_(Y.text),1)],8,ax),Pe(nl,{class:"checklist-item-scopes","scope-configurations":Y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:de=>be.$emit("select-checklist-item",Y,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])])]),_:1},8,["items","disabled"]))])],64)):i.value==="byPerson"?(p(),y(Ie,{key:1},[e.isLoadingDetailedReport?(p(),y("div",ix,[...z[27]||(z[27]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),y(Ie,{key:2},[r("div",rx,[r("div",cx,[We(r("input",{"onUpdate:modelValue":z[23]||(z[23]=Y=>c.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).people}...`},null,8,ux),[[st,c.value]])])]),r("div",dx,[ee.value.length===0?(p(),y("div",hx,[r("p",null,_(c.value||v.value!=="all"?`No ${N(n).people} match your filters.`:`No ${N(n).people} with ${N(n).checklists}.`),1)])):P("",!0),(p(!0),y(Ie,null,je(ee.value,Y=>(p(),y("div",{key:Y.marshalId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>R(Y.marshalId)},[r("div",px,[r("span",vx,_(x.value.has(Y.marshalId)?"":""),1),r("strong",null,_(Y.marshalName),1)]),r("div",mx,[r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},_(Y.completedTasks)+" / "+_(Y.totalTasks),3)])],8,fx),x.value.has(Y.marshalId)?(p(),y("div",gx,[(p(!0),y(Ie,null,je(De(Y.tasks),de=>(p(),y("div",{key:de.itemId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},_(de.isCompleted?"":""),3),r("span",yx,_(de.text),1),de.isCompleted&&de.completedBy?(p(),y("span",kx," by "+_(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),y("div",lx,[...z[28]||(z[28]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byTask"?(p(),y(Ie,{key:2},[e.isLoadingDetailedReport?(p(),y("div",bx,[...z[29]||(z[29]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),y(Ie,{key:2},[r("div",_x,[r("div",Cx,[We(r("input",{"onUpdate:modelValue":z[24]||(z[24]=Y=>d.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checklists}...`},null,8,Lx),[[st,d.value]])])]),r("div",Ix,[ue.value.length===0?(p(),y("div",Sx,[r("p",null,_(d.value||g.value!=="all"?`No ${N(n).checklists} match your filters.`:`No ${N(n).checklists} defined.`),1)])):P("",!0),(p(!0),y(Ie,null,je(ue.value,Y=>(p(),y("div",{key:Y.itemId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>M(Y.itemId)},[r("div",$x,[r("span",Tx,_(A.value.has(Y.itemId)?"":""),1),r("strong",null,_(Y.text),1)]),r("div",Mx,[r("span",{class:le(["stat-badge",re(Y.completedCount,Y.applicableCount)])},_(Y.completedCount)+" / "+_(Y.applicableCount),3)])],8,xx),A.value.has(Y.itemId)?(p(),y("div",Ax,[Y.marshals.length===0?(p(),y("div",Ex,[r("p",null,"No "+_(N(n).people)+" assigned to this "+_(N(n).checklist)+".",1)])):P("",!0),(p(!0),y(Ie,null,je(Y.marshals,de=>(p(),y("div",{key:de.marshalId,class:"task-row"},[r("span",{class:le(["task-status",de.isCompleted?"completed":"pending"])},_(de.isCompleted?"":""),3),r("span",Px,_(de.marshalName),1),de.isCompleted&&de.completedBy?(p(),y("span",Dx," by "+_(de.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),y("div",wx,[...z[30]||(z[30]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byArea"?(p(),y(Ie,{key:3},[e.isLoadingDetailedReport?(p(),y("div",Rx,[...z[31]||(z[31]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),y(Ie,{key:2},[r("div",Bx,[r("div",Nx,[We(r("input",{"onUpdate:modelValue":z[25]||(z[25]=Y=>f.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).areas}...`},null,8,Fx),[[st,f.value]])])]),r("div",Ux,[$e.value.length===0?(p(),y("div",zx,[r("p",null,_(f.value||b.value!=="all"?`No ${N(n).areas} match your filters.`:`No ${N(n).areas} with ${N(n).people}.`),1)])):P("",!0),(p(!0),y(Ie,null,je($e.value,Y=>(p(),y("div",{key:Y.areaId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>E(Y.areaId)},[r("div",Vx,[r("span",Gx,_(w.value.has(Y.areaId)?"":""),1),r("strong",null,_(Y.areaName),1)]),r("div",qx,[r("span",jx,_(Y.totalPeople)+" "+_(Y.totalPeople===1?N(n).person:N(n).people),1),r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},_(Y.completedTasks)+" / "+_(Y.totalTasks),3)])],8,Hx),w.value.has(Y.areaId)?(p(),y("div",Wx,[(p(!0),y(Ie,null,je(Y.people,de=>(p(),y("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:rt(ie=>F(Y.areaId,de.marshalId),["stop"])},[r("div",Kx,[r("span",Yx,_(I.value.has(`${Y.areaId}:${de.marshalId}`)?"":""),1),r("strong",null,_(de.marshalName),1)]),r("div",Jx,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},_(de.completedTasks)+" / "+_(de.totalTasks),3)])],8,Zx),I.value.has(`${Y.areaId}:${de.marshalId}`)?(p(),y("div",Xx,[(p(!0),y(Ie,null,je(De(de.tasks),ie=>(p(),y("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},_(ie.isCompleted?"":""),3),r("span",Qx,_(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),y("span",e$," by "+_(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),y("div",Ox,[...z[32]||(z[32]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byCheckpoint"?(p(),y(Ie,{key:4},[e.isLoadingDetailedReport?(p(),y("div",t$,[...z[33]||(z[33]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),y(Ie,{key:2},[r("div",o$,[r("div",s$,[We(r("input",{"onUpdate:modelValue":z[26]||(z[26]=Y=>h.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checkpoints}...`},null,8,a$),[[st,h.value]])])]),r("div",i$,[_e.value.length===0?(p(),y("div",l$,[r("p",null,_(h.value||k.value!=="all"?`No ${N(n).checkpoints} match your filters.`:`No ${N(n).checkpoints} with ${N(n).people}.`),1)])):P("",!0),(p(!0),y(Ie,null,je(_e.value,Y=>(p(),y("div",{key:Y.checkpointId,class:"report-card"},[r("div",{class:"report-card-header",onClick:de=>O(Y.checkpointId)},[r("div",c$,[r("span",u$,_(T.value.has(Y.checkpointId)?"":""),1),r("div",d$,[r("strong",null,_(Y.checkpointName),1),Y.checkpointDescription?(p(),y("span",h$,_(Y.checkpointDescription),1)):P("",!0)])]),r("div",f$,[r("span",p$,_(Y.totalPeople)+" "+_(Y.totalPeople===1?N(n).person:N(n).people),1),r("span",{class:le(["stat-badge",re(Y.completedTasks,Y.totalTasks)])},_(Y.completedTasks)+" / "+_(Y.totalTasks),3)])],8,r$),T.value.has(Y.checkpointId)?(p(),y("div",v$,[(p(!0),y(Ie,null,je(Y.people,de=>(p(),y("div",{key:de.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:rt(ie=>U(Y.checkpointId,de.marshalId),["stop"])},[r("div",g$,[r("span",y$,_(C.value.has(`${Y.checkpointId}:${de.marshalId}`)?"":""),1),r("strong",null,_(de.marshalName),1)]),r("div",k$,[r("span",{class:le(["stat-badge small",re(de.completedTasks,de.totalTasks)])},_(de.completedTasks)+" / "+_(de.totalTasks),3)])],8,m$),C.value.has(`${Y.checkpointId}:${de.marshalId}`)?(p(),y("div",b$,[(p(!0),y(Ie,null,je(De(de.tasks),ie=>(p(),y("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},_(ie.isCompleted?"":""),3),r("span",w$,_(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),y("span",_$," by "+_(ie.completedBy),1)):P("",!0)]))),128))])):P("",!0)]))),128))])):P("",!0)]))),128))])],64)):(p(),y("div",n$,[...z[34]||(z[34]=[r("p",null,"No report data available.",-1)])]))],64)):P("",!0)]))}},L$=Ke(C$,[["__scopeId","data-v-48e233e8"]]),I$={class:"notes-tab"},S$={class:"tab-header"},x$={class:"button-group"},$$={class:"filters-section"},T$={class:"search-group"},M$={class:"notes-list"},A$={key:0,class:"empty-state"},E$=["onClick"],P$={class:"note-header"},D$={class:"note-title-row"},R$={key:0,class:"pin-icon",title:"Pinned"},O$={key:1,class:"emergency-indicator",title:"Shown in emergency info"},B$={class:"note-meta"},N$={key:0,class:"category-badge"},F$={class:"created-info"},U$={key:0,class:"note-preview"},z$={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=H(()=>{if(!o.value.trim())return n.notes;const f=o.value.toLowerCase().trim().split(/\s+/);return n.notes.filter(v=>{const g=`${v.title||""} ${v.content||""} ${v.priority||""}`.toLowerCase();return f.every(k=>g.includes(k))})}),l=H(()=>{const f={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((v,g)=>{if(v.isPinned!==g.isPinned)return v.isPinned?-1:1;const k=f[v.priority]??2,b=f[g.priority]??2;return k!==b?k-b:v.displayOrder!==g.displayOrder?v.displayOrder-g.displayOrder:Qo(v.title,g.title)})}),c=({changes:f})=>{const v=f.map(g=>({id:g.id,displayOrder:g.displayOrder}));s("reorder",v)},d=f=>{if(!f)return"";const v=150;return f.length<=v?f:f.substring(0,v)+"..."},h=f=>{if(!f)return"";const v=new Date(f),k=new Date-v,b=Math.floor(k/6e4),x=Math.floor(k/36e5),A=Math.floor(k/864e5);return b<1?"Just now":b<60?`${b}m ago`:x<24?`${x}h ago`:A<7?`${A}d ago`:v.toLocaleDateString()};return(f,v)=>(p(),y("div",I$,[r("div",S$,[r("div",x$,[r("button",{onClick:v[0]||(v[0]=g=>f.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",$$,[r("div",T$,[We(r("input",{"onUpdate:modelValue":v[1]||(v[1]=g=>o.value=g),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,o.value]])])]),r("div",M$,[i.value.length===0?(p(),y("div",A$,[r("p",null,_(o.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):(p(),Ge(il,{key:1,items:l.value,"item-key":"noteId","pinned-key":"isPinned",disabled:!!o.value,onReorder:c},{item:Ve(({element:g})=>[r("div",{class:le(["note-card",{pinned:g.isPinned}])},[o.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",{class:"note-content",onClick:k=>f.$emit("select-note",g)},[r("div",P$,[r("div",D$,[g.isPinned?(p(),y("span",R$,"")):P("",!0),r("span",{class:le(["priority-indicator",g.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,_(g.title),1),g.showInEmergencyInfo?(p(),y("span",O$,"")):P("",!0)]),r("div",B$,[g.category?(p(),y("span",N$,_(g.category),1)):P("",!0),r("span",F$,_(h(g.createdAt)),1)])]),g.content?(p(),y("div",U$,_(d(g.content)),1)):P("",!0),Pe(nl,{"scope-configurations":g.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],8,E$)],2)]),_:1},8,["items","disabled"]))])]))}},H$=Ke(z$,[["__scopeId","data-v-715ffc72"]]),V$={class:"contacts-tab"},G$={class:"tab-header"},q$={class:"button-group"},j$={key:0,class:"status-pills"},W$={class:"filters-section"},Z$={class:"search-group"},K$={class:"contacts-list"},Y$={key:0,class:"empty-state"},J$=["onClick"],X$={class:"contact-header"},Q$={class:"contact-name-row"},eT={key:0,class:"pin-icon",title:"Pinned"},tT={key:1,class:"primary-badge",title:"Primary contact"},nT={key:2,class:"emergency-indicator",title:"Shown in emergency info"},oT={class:"contact-roles"},sT={class:"contact-details"},aT={key:0,class:"contact-detail"},iT={key:1,class:"contact-detail"},lT={key:0,class:"contact-notes"},rT={key:2,class:"no-scope-warning"},cT={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]}},emits:["add-contact","select-contact","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=D("all"),l=H(()=>n.contacts.filter(C=>!C.scopeConfigurations||C.scopeConfigurations.length===0).length),c=H(()=>n.contacts.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0).length),d=C=>{i.value=C},h=C=>C?C.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=H(()=>{const C=new Map;for(const I of n.roleDefinitions)C.set(I.roleId,I.name),C.set(I.name,I.name);return C}),v=C=>{if(!C)return"";const I=f.value.get(C);return I||C.replace(/([A-Z])/g," $1").replace(/^./,$=>$.toUpperCase()).trim()},g=C=>C.roles&&Array.isArray(C.roles)&&C.roles.length>0?C.roles:C.role?[C.role]:[],k=C=>g(C).map(v).join(" "),b=C=>{if(!C)return"";const I=100;return C.length<=I?C:C.substring(0,I)+"..."},x=H(()=>{let C=n.contacts;if(i.value==="no-scope"?C=C.filter(I=>!I.scopeConfigurations||I.scopeConfigurations.length===0):i.value==="with-scope"&&(C=C.filter(I=>I.scopeConfigurations&&I.scopeConfigurations.length>0)),o.value.trim()){const $=h(o.value).split(" ").filter(R=>R.length>0);C=C.filter(R=>{const M=k(R),O=h(`${R.name||""} ${M} ${R.email||""} ${R.phone||""}`);return $.every(E=>O.includes(E))})}return C}),A=H(()=>[...x.value].sort((C,I)=>{if(C.isPinned!==I.isPinned)return C.isPinned?-1:1;const $=C.displayOrder||0,R=I.displayOrder||0;return $!==R?$-R:(C.name||"").localeCompare(I.name||"",void 0,{sensitivity:"base"})})),T=H(()=>{const C=o.value.trim();return i.value==="no-scope"?C?"No unassigned contacts match your search.":"All contacts are assigned.":i.value==="with-scope"?C?"No assigned contacts match your search.":"No contacts are assigned yet.":C?"No contacts match your search.":"No contacts yet. Create one to get started!"}),w=({changes:C})=>{s("reorder",C)};return(C,I)=>(p(),y("div",V$,[r("div",G$,[r("div",q$,[r("button",{onClick:I[0]||(I[0]=$=>C.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(p(),y("div",j$,[Pe(At,{variant:"neutral",active:i.value==="all",onClick:I[1]||(I[1]=$=>d("all"))},{default:Ve(()=>[Je(_(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0&&c.value<e.contacts.length?(p(),Ge(At,{key:0,variant:"success",active:i.value==="with-scope",onClick:I[2]||(I[2]=$=>d("with-scope"))},{default:Ve(()=>[Je(_(c.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),l.value>0&&l.value<e.contacts.length?(p(),Ge(At,{key:1,variant:"danger",active:i.value==="no-scope",onClick:I[3]||(I[3]=$=>d("no-scope"))},{default:Ve(()=>[Je(_(l.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",W$,[r("div",Z$,[We(r("input",{"onUpdate:modelValue":I[4]||(I[4]=$=>o.value=$),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,o.value]])])]),r("div",K$,[x.value.length===0?(p(),y("div",Y$,[r("p",null,_(T.value),1)])):(p(),Ge(il,{key:1,items:A.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!!o.value||i.value!=="all",onReorder:w},{item:Ve(({element:$})=>[r("div",{class:le(["contact-card",{pinned:$.isPinned,primary:$.isPrimary}])},[!o.value&&i.value==="all"?(p(),Ge(ll,{key:0})):P("",!0),r("div",{class:"contact-content",onClick:R=>C.$emit("select-contact",$)},[r("div",X$,[r("div",Q$,[$.isPinned?(p(),y("span",eT,"")):P("",!0),$.isPrimary?(p(),y("span",tT,"")):P("",!0),r("strong",null,_($.name),1),$.showInEmergencyInfo?(p(),y("span",nT,"")):P("",!0)]),r("div",oT,[(p(!0),y(Ie,null,je(g($),R=>(p(),y("span",{key:R,class:le(["role-badge",{"emergency-role":R==="Emergency"}])},_(v(R)),3))),128))])]),r("div",sT,[$.phone?(p(),y("span",aT,_($.phone),1)):P("",!0),$.email?(p(),y("span",iT,_($.email),1)):P("",!0)]),$.notes?(p(),y("div",lT,_(b($.notes)),1)):P("",!0),$.scopeConfigurations&&$.scopeConfigurations.length>0?(p(),Ge(nl,{key:1,"scope-configurations":$.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):(p(),y("div",rT," No visibility scope configured "))],8,J$)],2)]),_:1},8,["items","disabled"]))])]))}},uT=Ke(cT,[["__scopeId","data-v-83f433bf"]]),dT={class:"roles-tab"},hT={class:"tab-header"},fT={class:"button-group"},pT={key:0,class:"status-pills"},vT={class:"filters-section"},mT={class:"search-group"},gT={class:"roles-list"},yT={key:0,class:"empty-state"},kT=["onClick"],bT={class:"role-header"},wT={class:"role-name-row"},_T={key:0,class:"built-in-badge",title:"Built-in role"},CT={class:"role-usage"},LT={key:0,class:"role-notes"},IT={key:1,class:"role-notes empty"},ST={__name:"RolesTab",props:{roleDefinitions:{type:Array,required:!0}},emits:["add-role","select-role","reorder"],setup(e,{emit:t}){const n=e,s=t,o=D(""),i=H(()=>n.roleDefinitions.reduce((g,k)=>g+(k.usageCount||0),0)),l=g=>g?g.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",c=g=>{if(!g)return"";const k=150;return g.length<=k?g:g.substring(0,k)+"..."},d=H(()=>{if(!o.value.trim())return n.roleDefinitions;const k=l(o.value).split(" ").filter(b=>b.length>0);return n.roleDefinitions.filter(b=>{const x=l(`${b.name||""} ${b.notes||""}`);return k.every(A=>x.includes(A))})}),h=H(()=>[...d.value].sort((g,k)=>{const b=g.displayOrder||0,x=k.displayOrder||0;return b!==x?b-x:(g.name||"").localeCompare(k.name||"",void 0,{numeric:!0,sensitivity:"base"})})),f=H(()=>o.value.trim()?"No roles match your search.":"No roles defined yet. Create one to get started!"),v=({changes:g})=>{s("reorder",g)};return(g,k)=>(p(),y("div",dT,[r("div",hT,[r("div",fT,[r("button",{onClick:k[0]||(k[0]=b=>g.$emit("add-role")),class:"btn btn-primary"}," Add role ")]),e.roleDefinitions.length>0?(p(),y("div",pT,[Pe(At,{variant:"neutral"},{default:Ve(()=>[Je(_(e.roleDefinitions.length)+" "+_(e.roleDefinitions.length===1?"role":"roles"),1)]),_:1}),i.value>0?(p(),Ge(At,{key:0,variant:"success"},{default:Ve(()=>[Je(_(i.value)+" "+_(i.value===1?"assignment":"assignments"),1)]),_:1})):P("",!0)])):P("",!0)]),r("div",vT,[r("div",mT,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>o.value=b),type:"text",class:"search-input",placeholder:"Search by name or notes..."},null,512),[[st,o.value]])])]),r("div",gT,[d.value.length===0?(p(),y("div",yT,[r("p",null,_(f.value),1)])):(p(),Ge(il,{key:1,items:h.value,"item-key":"roleId",disabled:!!o.value,onReorder:v},{item:Ve(({element:b})=>[r("div",{class:le(["role-card",{"built-in":b.isBuiltIn}])},[o.value?P("",!0):(p(),Ge(ll,{key:0})),r("div",{class:"role-content",onClick:x=>g.$emit("select-role",b)},[r("div",bT,[r("div",wT,[r("strong",null,_(b.name),1),b.isBuiltIn?(p(),y("span",_T,"Built-in")):P("",!0)]),r("div",CT,[r("span",{class:le(["usage-badge",{"has-usage":b.usageCount>0}])},_(b.usageCount)+" "+_(b.usageCount===1?"person":"people"),3)])]),b.notes?(p(),y("div",LT,_(c(b.notes)),1)):(p(),y("div",IT," No notes "))],8,kT)],2)]),_:1},8,["items","disabled"]))])]))}},xT=Ke(ST,[["__scopeId","data-v-634d49c0"]]),w1=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],$T={class:"event-details-tab"},TT={class:"event-info-card"},MT={class:"form-group"},AT={class:"form-group"},ET={class:"form-row"},PT={class:"form-group"},DT={class:"form-group"},RT=["value"],OT={class:"form-actions"},BT=["disabled"],NT={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const n=e,s=t,o=D({...n.eventData});Ye(()=>n.eventData,c=>{o.value={...c}},{deep:!0});const i=()=>{s("update:formDirty",!0)},l=()=>{s("submit",{...o.value})};return(c,d)=>(p(),y("div",$T,[r("div",TT,[r("form",{onSubmit:rt(l,["prevent"]),class:"event-details-form"},[r("div",MT,[d[4]||(d[4]=r("label",null,"Event name",-1)),We(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>o.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.name]])]),r("div",AT,[d[5]||(d[5]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>o.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[st,o.value.description]])]),r("div",ET,[r("div",PT,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),We(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>o.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.eventDate]])]),r("div",DT,[d[7]||(d[7]=r("label",null,"Time zone",-1)),We(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(p(!0),y(Ie,null,je(N(w1),h=>(p(),y("option",{key:h.value,value:h.value},_(h.label),9,RT))),128))],544),[[no,o.value.timeZoneId]])])]),r("div",OT,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,BT)])],32)])]))}},FT=Ke(NT,[["__scopeId","data-v-2754c3cc"]]),UT={class:"admins-list"},zT={class:"admin-info"},HT={class:"admin-role"},VT=["onClick"],GT={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,n)=>(p(),y("div",null,[r("button",{onClick:n[0]||(n[0]=s=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",UT,[(p(!0),y(Ie,null,je(e.admins,s=>(p(),y("div",{key:s.userEmail,class:"admin-item"},[r("div",zT,[r("strong",null,_(s.userEmail),1),r("span",HT,_(s.role),1)]),e.admins.length>1?(p(),y("button",{key:0,onClick:o=>t.$emit("remove-admin",s.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,VT)):P("",!0)]))),128))])]))}},qT=Ke(GT,[["__scopeId","data-v-e526860b"]]),jT={class:"modal-content"},WT={class:"modal-body"},ZT={class:"preview-section"},KT={class:"map-preview"},YT=["innerHTML"],JT={class:"options-grid"},XT={class:"option-button-content"},QT={class:"option-button-value icon-value"},eM=["innerHTML"],tM={class:"option-button-content"},nM={class:"option-button-value color-value"},oM=["disabled"],sM={class:"option-button-content"},aM={class:"option-button-value color-value"},iM={class:"option-button-content"},lM={class:"option-button-value icon-value"},rM=["innerHTML"],cM=["disabled"],uM={class:"option-button-content"},dM={class:"option-button-value color-value"},hM={class:"option-button-content"},fM={class:"option-button-value"},pM={class:"option-button-content"},vM={class:"option-button-value"},mM={key:0,class:"centered-popup"},gM={class:"popup-grid"},yM=["onClick"],kM=["innerHTML"],bM={key:0},wM={key:1,class:"centered-popup"},_M={class:"popup-grid"},CM=["title","onClick"],LM=["innerHTML"],IM={key:0},SM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},xM={key:1,class:"custom-check-mark"},$M={key:0,class:"custom-hex-input"},TM={class:"hex-input-row"},MM=["disabled"],AM={key:0,class:"hex-error"},EM={key:2,class:"centered-popup"},PM={class:"popup-grid"},DM=["title","onClick"],RM=["innerHTML"],OM={key:0},BM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},NM={key:1,class:"custom-check-mark"},FM={key:0,class:"custom-hex-input"},UM={class:"hex-input-row"},zM=["disabled"],HM={key:0,class:"hex-error"},VM={key:3,class:"centered-popup icon-popup"},GM={class:"popup-grid"},qM=["onClick"],jM=["innerHTML"],WM={key:0},ZM={key:4,class:"centered-popup"},KM={class:"popup-grid"},YM=["title","onClick"],JM=["innerHTML"],XM={key:0},QM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},eA={key:1,class:"custom-check-mark"},tA={key:0,class:"custom-hex-input"},nA={class:"hex-input-row"},oA=["disabled"],sA={key:0,class:"hex-error"},aA={key:5,class:"centered-popup"},iA={class:"size-grid"},lA=["onClick"],rA=["innerHTML"],cA={key:6,class:"centered-popup"},uA={class:"rotation-content"},dA={class:"rotation-preview-container"},hA=["innerHTML"],fA={class:"rotation-control"},pA={class:"rotation-slider-container"},vA=["value"],mA={class:"rotation-value"},gA={class:"rotation-presets"},yA="#667eea",kA={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const n=e,s=t,o=D(n.backgroundShape||"circle"),i=D(n.iconType||"none"),l=D(n.backgroundColor||""),c=D(n.borderColor||""),d=D(n.iconColor||""),h=D(n.size||"100"),f=D(n.mapRotation??""),v=D(null),g=D(!1),k=D(!1),b=D(!1),x=D(""),A=D(""),T=D(""),w=D(null),C=D(null),I=D(null),$=pe=>pe==="default"?n.inheritedBackgroundShape||"circle":pe==="none"?"none":pe||"circle",R=pe=>pe==="default"||!pe?q():pe==="none"?"transparent":pe,M=pe=>pe==="default"?n.inheritedBorderColor||"#ffffff":pe==="none"||!pe?"transparent":pe,O=pe=>{if(pe==="default"){const ve=n.inheritedType;return ve&&ve!=="default"&&Qi(ve).category==="content"?ve:"none"}return pe==="none"||!pe?"none":pe},E=pe=>pe==="default"||!pe?n.inheritedIconColor||"#ffffff":pe==="none"?"transparent":pe,U=pe=>pe==="default"?n.inheritedSize||"100":pe||"100",F=pe=>{if(pe==="default"||pe===""){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null&&parseInt(ve,10)||0}return parseInt(pe,10)||0},j=H(()=>{const pe=n.inheritedBackgroundShape||"circle",ve=zc.find(Se=>Se.value===pe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ve})`,showLabel:!0},...zc.filter(Se=>Se.value!=="none").map(Se=>({...Se,showLabel:!1}))]}),Z=H(()=>{const pe=Iu.filter(lt=>lt.category==="content"),ve=[{value:"none",label:"None",category:"content",showLabel:!0}],Se=n.inheritedType;if(Se&&Se!=="default"){const lt=Qi(Se);lt.category==="content"&&ve.push({value:"default",label:`Default (${lt.label||Se})`,category:"content",showLabel:!0})}return ve.push(...pe.map(lt=>({...lt,showLabel:!1}))),ve}),Q=H(()=>{const pe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${pe[n.inheritedSize]||"Normal"})`},...S2.map(Se=>({value:Se.value,label:pe[Se.value]||Se.label}))]}),re=H(()=>$(o.value)!=="none"),K=H(()=>O(i.value)!=="none"),ae=H(()=>{const pe=n.inheritedBackgroundColor;return pe&&pe!=="default"&&pe.startsWith("#")?pe:yA}),q=()=>ae.value,J=H(()=>l.value&&l.value!=="default"?l.value:q()),ee=H(()=>c.value==="none"?"transparent":c.value?c.value:n.inheritedBorderColor&&n.inheritedBorderColor!=="none"?n.inheritedBorderColor:"#ffffff"),ue=H(()=>d.value?d.value:n.inheritedIconColor?n.inheritedIconColor:"#ffffff"),_e=H(()=>{const pe=ae.value,ve=Un.find(Se=>Se.hex.toLowerCase()===pe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},...Un.map(Se=>({hex:Se.hex,name:Se.name,showLabel:!1}))]}),$e=H(()=>{const pe=n.inheritedBorderColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Se=>Se.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Se=>Se.hex!=="#ffffff").map(Se=>({hex:Se.hex,name:Se.name,showLabel:!1}))]}),De=H(()=>{const pe=n.inheritedIconColor||"#ffffff",ve=pe==="#ffffff"?"White":Un.find(Se=>Se.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Un.filter(Se=>Se.hex!=="#ffffff").map(Se=>({hex:Se.hex,name:Se.name,showLabel:!1}))]}),Re=pe=>pe==="default"?!l.value||l.value==="default":l.value===pe,be=pe=>pe==="#ffffff"?!d.value||d.value==="#ffffff":d.value===pe,z=H(()=>{const pe=l.value;return!pe||pe==="default"||pe==="none"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),Y=H(()=>{const pe=c.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),de=H(()=>{const pe=d.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Un.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),ie=H(()=>{if(!x.value)return!1;const pe=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),Ae=H(()=>{if(!A.value)return!1;const pe=A.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),G=H(()=>{if(!T.value)return!1;const pe=T.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),X=pe=>{if(pe==="none")return"None";if(pe==="default"){const Se=n.inheritedBackgroundShape;return Se?`Default (${zc.find(Qe=>Qe.value===Se)?.label||"Circle"})`:"Default (Circle)"}const ve=zc.find(Se=>Se.value===pe);return ve?ve.label:"Circle"},te=pe=>{if(pe==="none")return"None";if(pe==="default"){const Se=n.inheritedType;if(Se&&Se!=="default"){const lt=Qi(Se);if(lt.category==="content")return`Default (${lt.label||Se})`}return"Default"}const ve=Iu.find(Se=>Se.value===pe);return ve?ve.label:"None"},Ce=pe=>{if(pe==="none")return"None";if(!pe||pe==="default"){const Se=ae.value;return`Default (${Un.find(Qe=>Qe.hex.toLowerCase()===Se.toLowerCase())?.name||"Custom"})`}const ve=[...Un].find(Se=>Se.hex.toLowerCase()===pe.toLowerCase());return ve?ve.name:pe},Ne=pe=>{if(pe==="none")return"None";if(pe==="default"){const Se=n.inheritedBorderColor;return Se&&Se!=="none"?`Default (${Se==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Se)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...$e.value].find(Se=>Se.hex===pe);return ve?ve.name:pe},Fe=pe=>{if(pe==="none")return"None";if(pe==="default"){const Se=n.inheritedIconColor;return Se?`Default (${Se==="#ffffff"?"White":Un.find(Qe=>Qe.hex===Se)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...De.value].find(Se=>Se.hex===pe);return ve?ve.name:pe},Ee=pe=>{const ve={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(pe==="default"){const Se=n.inheritedSize;return`Default (${ve[Se]||"Normal"})`}return ve[pe]||"Normal"},oe=pe=>{if(pe==="default"||pe===""||pe===void 0||pe===null){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null?`Default (${ve})`:"Default (0)"}return`${pe}`},ge=pe=>{if(pe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ve=$(pe),Se=R(l.value),lt=M(c.value);return Gl[ve]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Gl[ve]({backgroundColor:Se,borderColor:lt==="transparent"?"none":lt})}</svg>`:""},Be=pe=>{const ve=O(pe);return ve==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:zn({type:ve,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Oe=pe=>{const ve=$(pe);if(ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Se=R(l.value),lt=M(c.value),Qe=O(i.value),Ft=E(d.value);return zn({type:Qe!=="none"?Qe:ve,backgroundShape:ve,backgroundColor:Se,borderColor:lt==="transparent"?"none":lt,iconColor:Ft,size:"100",outputSize:28})},xe=pe=>{const ve=R(pe),Se=$(o.value),lt=M(c.value),Qe=O(i.value),Ft=E(d.value);return Se==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Se,backgroundShape:Se,backgroundColor:ve==="transparent"?"#e2e8f0":ve,borderColor:lt==="transparent"?"none":lt,iconColor:Ft,size:"100",outputSize:28})},me=pe=>{const ve=M(pe),Se=$(o.value),lt=R(l.value),Qe=O(i.value),Ft=E(d.value);return Se==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ve}" stroke-width="2"/>
    </svg>`:zn({type:Qe!=="none"?Qe:Se,backgroundShape:Se,backgroundColor:lt,borderColor:ve==="transparent"?"none":ve,iconColor:Ft,size:"100",outputSize:28})},Ze=pe=>{const ve=O(pe),Se=$(o.value),lt=R(l.value),Qe=M(c.value),Ft=E(d.value);if(ve==="none"&&Se==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const sn=Se!=="none"?Se:"circle";return zn({type:ve!=="none"?ve:sn,backgroundShape:sn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:Ft,size:"100",outputSize:42})},qe=pe=>{const ve=E(pe),Se=$(o.value),lt=R(l.value),Qe=M(c.value),Ft=O(i.value);return Ft==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:zn({type:Ft,backgroundShape:Se!=="none"?Se:"circle",backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:ve==="transparent"?"#e2e8f0":ve,size:"100",outputSize:28})},fe=pe=>{const ve=U(pe),Se=$(o.value),lt=R(l.value),Qe=M(c.value),Ft=O(i.value),sn=E(d.value);if(Se==="none"&&Ft==="none")return"";const yn=Se!=="none"?Se:"circle";return zn({type:Ft!=="none"?Ft:yn,backgroundShape:yn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:sn,size:ve})},ke=H(()=>{const pe=$(o.value),ve=R(l.value),Se=M(c.value),lt=O(i.value),Qe=E(d.value),Ft=U(h.value);return pe==="none"&&lt==="none"?"":zn(pe==="none"&&lt!=="none"?{type:lt,backgroundShape:"none",backgroundColor:ve,borderColor:"none",iconColor:Qe,size:Ft}:{type:lt!=="none"?lt:pe,backgroundShape:pe,backgroundColor:ve,borderColor:Se==="transparent"?"none":Se,iconColor:Qe,size:Ft})}),ne=pe=>{v.value=v.value===pe?null:pe},ye=()=>{v.value=null,g.value=!1,k.value=!1,b.value=!1},He=pe=>{o.value=pe,ye()},ct=pe=>{l.value=pe,ye()},ht=pe=>{c.value=pe,ye()},Bt=pe=>{i.value=pe,ye()},Lt=pe=>{d.value=pe,ye()},Nt=pe=>{h.value=pe,ye()},Et=pe=>{f.value=pe,ye()},yo=()=>{g.value=!g.value,g.value&&(z.value?x.value=l.value.replace(/^#/,""):x.value="",cn(()=>w.value?.focus()))},ko=()=>{k.value=!k.value,k.value&&(Y.value?A.value=c.value.replace(/^#/,""):A.value="",cn(()=>C.value?.focus()))},ft=()=>{b.value=!b.value,b.value&&(de.value?T.value=d.value.replace(/^#/,""):T.value="",cn(()=>I.value?.focus()))},Pt=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},mt=()=>{A.value=A.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},An=()=>{T.value=T.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Ao=pe=>pe.length===3?pe[0]+pe[0]+pe[1]+pe[1]+pe[2]+pe[2]:pe,ao=()=>{if(!ie.value)return;const pe=Ao(x.value);l.value="#"+pe,g.value=!1,ye()},bo=()=>{if(!Ae.value)return;const pe=Ao(A.value);c.value="#"+pe,k.value=!1,ye()},Gt=()=>{if(!G.value)return;const pe=Ao(T.value);d.value="#"+pe,b.value=!1,ye()},As=pe=>{f.value=pe};Ye(()=>n.isOpen,pe=>{if(pe){const ve=n.backgroundShape&&n.backgroundShape!=="default"&&n.backgroundShape!=="circle",Se=n.iconType&&n.iconType!=="none"&&n.iconType!=="default",lt=n.backgroundColor&&n.backgroundColor!=="",Qe=n.borderColor&&n.borderColor!=="",Ft=n.iconColor&&n.iconColor!=="",sn=n.size&&n.size!==""&&n.size!=="100",yn=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null&&n.mapRotation!==0;ve||Se||lt||Qe||Ft||sn||yn?(o.value=n.backgroundShape||"default",i.value=n.iconType||"default",l.value=n.backgroundColor||"default",c.value=n.borderColor||"default",d.value=n.iconColor||"default",h.value=n.size||"default",f.value=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null?n.mapRotation:"default"):(o.value="default",i.value="default",l.value="default",c.value="default",d.value="default",h.value="default",f.value="default"),v.value=null}});const wo=()=>{ye(),s("update:isOpen",!1),s("cancel")},zo=()=>{ye();const pe=lt=>lt==="default"?"":lt;let ve="";i.value==="none"?ve="none":i.value&&i.value!=="default"&&(ve=i.value);let Se="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Se=parseInt(f.value,10)||0),s("apply",{iconType:ve,backgroundShape:pe(o.value),backgroundColor:pe(l.value),borderColor:pe(c.value),iconColor:pe(d.value),size:pe(h.value),mapRotation:Se}),s("update:isOpen",!1)};return(pe,ve)=>e.isOpen?(p(),y("div",{key:0,class:"modal-overlay",onClick:rt(wo,["self"])},[r("div",jT,[r("div",{class:"modal-header"},[ve[18]||(ve[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:wo},"")]),r("div",WT,[r("div",ZT,[r("div",KT,[ve[19]||(ve[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,YT)])]),r("div",JT,[r("button",{type:"button",class:le(["option-button",{active:v.value==="shape"}]),onClick:ve[0]||(ve[0]=Se=>ne("shape"))},[r("div",XT,[ve[20]||(ve[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",QT,[r("div",{class:"icon-preview-small",innerHTML:ge(o.value)},null,8,eM),r("span",null,_(X(o.value)),1)])]),ve[21]||(ve[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:v.value==="bgColor"}]),onClick:ve[1]||(ve[1]=Se=>ne("bgColor"))},[r("div",tM,[ve[22]||(ve[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",nM,[r("span",{class:"color-swatch",style:tt({backgroundColor:J.value})},null,4),r("span",null,_(Ce(l.value)),1)])]),ve[23]||(ve[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:v.value==="borderColor",disabled:!re.value}]),disabled:!re.value,onClick:ve[2]||(ve[2]=Se=>ne("borderColor"))},[r("div",sM,[ve[24]||(ve[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",aM,[r("span",{class:le(["color-swatch",{"no-border":c.value==="none"}]),style:tt(c.value!=="none"?{backgroundColor:ee.value}:{})},null,6),r("span",null,_(Ne(c.value)),1)])]),ve[25]||(ve[25]=r("span",{class:"option-button-arrow"},"",-1))],10,oM),r("button",{type:"button",class:le(["option-button",{active:v.value==="icon"}]),onClick:ve[3]||(ve[3]=Se=>ne("icon"))},[r("div",iM,[ve[26]||(ve[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",lM,[r("div",{class:"icon-preview-small",innerHTML:Be(i.value)},null,8,rM),r("span",null,_(te(i.value)),1)])]),ve[27]||(ve[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:v.value==="iconColor",disabled:!K.value}]),disabled:!K.value,onClick:ve[4]||(ve[4]=Se=>ne("iconColor"))},[r("div",uM,[ve[28]||(ve[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",dM,[r("span",{class:"color-swatch",style:tt({backgroundColor:ue.value})},null,4),r("span",null,_(Fe(d.value)),1)])]),ve[29]||(ve[29]=r("span",{class:"option-button-arrow"},"",-1))],10,cM),r("button",{type:"button",class:le(["option-button",{active:v.value==="size"}]),onClick:ve[5]||(ve[5]=Se=>ne("size"))},[r("div",hM,[ve[30]||(ve[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",fM,_(Ee(h.value)),1)]),ve[31]||(ve[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button option-button-full",{active:v.value==="mapRotation"}]),onClick:ve[6]||(ve[6]=Se=>ne("mapRotation"))},[r("div",pM,[ve[32]||(ve[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",vM,_(oe(f.value)),1)]),ve[33]||(ve[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),v.value==="shape"?(p(),y("div",mM,[r("div",{class:"popup-header"},[ve[34]||(ve[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",gM,[(p(!0),y(Ie,null,je(j.value,Se=>(p(),y("button",{key:Se.value,type:"button",class:le(["popup-grid-item",{selected:o.value===Se.value}]),onClick:lt=>He(Se.value)},[r("div",{class:"popup-item-preview",innerHTML:Oe(Se.value)},null,8,kM),Se.showLabel?(p(),y("span",bM,_(Se.label),1)):P("",!0)],10,yM))),128))])])):P("",!0),v.value==="bgColor"?(p(),y("div",wM,[r("div",{class:"popup-header"},[ve[35]||(ve[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",_M,[(p(!0),y(Ie,null,je(_e.value,Se=>(p(),y("button",{key:Se.hex,type:"button",class:le(["popup-grid-item",{selected:Re(Se.hex)}]),title:Se.name,onClick:lt=>ct(Se.hex)},[r("div",{class:"popup-item-preview",innerHTML:xe(Se.hex)},null,8,LM),Se.showLabel?(p(),y("span",IM,_(Se.name),1)):P("",!0)],10,CM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:z.value}]),style:tt(z.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:yo},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(z.value?{backgroundColor:l.value}:{})},[z.value?P("",!0):(p(),y("svg",SM,[...ve[36]||(ve[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),z.value?(p(),y("span",xM,"")):P("",!0)],4),ve[37]||(ve[37]=r("span",null,"Custom",-1))],6)]),g.value?(p(),y("div",$M,[ve[39]||(ve[39]=r("label",null,"Enter hex code",-1)),r("div",TM,[ve[38]||(ve[38]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"bgHexInput",ref:w,"onUpdate:modelValue":ve[7]||(ve[7]=Se=>x.value=Se),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:x.value&&!ie.value}]),onInput:Pt,onKeydown:Xo(ao,["enter"])},null,34),[[st,x.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:ie.value?"#"+x.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!ie.value,onClick:ao}," Apply ",8,MM)]),x.value&&!ie.value?(p(),y("span",AM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),v.value==="borderColor"?(p(),y("div",EM,[r("div",{class:"popup-header"},[ve[40]||(ve[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",PM,[(p(!0),y(Ie,null,je($e.value,Se=>(p(),y("button",{key:Se.hex,type:"button",class:le(["popup-grid-item",{selected:c.value===Se.hex}]),title:Se.name,onClick:lt=>ht(Se.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(Se.hex)},null,8,RM),Se.showLabel?(p(),y("span",OM,_(Se.name),1)):P("",!0)],10,DM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:Y.value}]),style:tt(Y.value?{"--custom-color":c.value}:{}),title:"Custom colour",onClick:ko},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(Y.value?{backgroundColor:c.value}:{})},[Y.value?P("",!0):(p(),y("svg",BM,[...ve[41]||(ve[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Y.value?(p(),y("span",NM,"")):P("",!0)],4),ve[42]||(ve[42]=r("span",null,"Custom",-1))],6)]),k.value?(p(),y("div",FM,[ve[44]||(ve[44]=r("label",null,"Enter hex code",-1)),r("div",UM,[ve[43]||(ve[43]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"borderHexInput",ref:C,"onUpdate:modelValue":ve[8]||(ve[8]=Se=>A.value=Se),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!Ae.value}]),onInput:mt,onKeydown:Xo(bo,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:Ae.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Ae.value,onClick:bo}," Apply ",8,zM)]),A.value&&!Ae.value?(p(),y("span",HM," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),v.value==="icon"?(p(),y("div",VM,[r("div",{class:"popup-header"},[ve[45]||(ve[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",GM,[(p(!0),y(Ie,null,je(Z.value,Se=>(p(),y("button",{key:Se.value,type:"button",class:le(["popup-grid-item",{selected:i.value===Se.value}]),onClick:lt=>Bt(Se.value)},[r("div",{class:"popup-item-preview",innerHTML:Ze(Se.value)},null,8,jM),Se.showLabel?(p(),y("span",WM,_(Se.label),1)):P("",!0)],10,qM))),128))])])):P("",!0),v.value==="iconColor"?(p(),y("div",ZM,[r("div",{class:"popup-header"},[ve[46]||(ve[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",KM,[(p(!0),y(Ie,null,je(De.value,Se=>(p(),y("button",{key:Se.hex,type:"button",class:le(["popup-grid-item",{selected:be(Se.hex)}]),title:Se.name,onClick:lt=>Lt(Se.hex)},[r("div",{class:"popup-item-preview",innerHTML:qe(Se.hex)},null,8,JM),Se.showLabel?(p(),y("span",XM,_(Se.name),1)):P("",!0)],10,YM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:de.value}]),style:tt(de.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:ft},[r("div",{class:"popup-item-preview custom-color-preview",style:tt(de.value?{backgroundColor:d.value}:{})},[de.value?P("",!0):(p(),y("svg",QM,[...ve[47]||(ve[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),de.value?(p(),y("span",eA,"")):P("",!0)],4),ve[48]||(ve[48]=r("span",null,"Custom",-1))],6)]),b.value?(p(),y("div",tA,[ve[50]||(ve[50]=r("label",null,"Enter hex code",-1)),r("div",nA,[ve[49]||(ve[49]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"iconHexInput",ref:I,"onUpdate:modelValue":ve[9]||(ve[9]=Se=>T.value=Se),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:T.value&&!G.value}]),onInput:An,onKeydown:Xo(Gt,["enter"])},null,34),[[st,T.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:G.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!G.value,onClick:Gt}," Apply ",8,oA)]),T.value&&!G.value?(p(),y("span",sA," Invalid hex code ")):P("",!0)])):P("",!0)])):P("",!0),v.value==="size"?(p(),y("div",aA,[r("div",{class:"popup-header"},[ve[51]||(ve[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",iA,[(p(!0),y(Ie,null,je(Q.value,Se=>(p(),y("button",{key:Se.value,type:"button",class:le(["size-grid-item",{selected:h.value===Se.value}]),onClick:lt=>Nt(Se.value)},[r("div",{class:"size-preview",innerHTML:fe(Se.value)},null,8,rA),r("span",null,_(Se.label),1)],10,lA))),128))])])):P("",!0),v.value==="mapRotation"?(p(),y("div",cA,[r("div",{class:"popup-header"},[ve[52]||(ve[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",uA,[r("div",dA,[r("div",{class:"rotation-preview-icon",style:tt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,hA)]),ve[53]||(ve[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",fA,[r("button",{type:"button",class:le(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ve[10]||(ve[10]=Se=>Et("default"))}," Default ",2),r("div",pA,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ve[11]||(ve[11]=Se=>As(parseInt(Se.target.value,10)))},null,40,vA),r("div",mA,_(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",gA,[r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ve[12]||(ve[12]=Se=>Et(-90))},"-90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ve[13]||(ve[13]=Se=>Et(-45))},"-45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===0}]),onClick:ve[14]||(ve[14]=Se=>Et(0))},"0",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===45}]),onClick:ve[15]||(ve[15]=Se=>Et(45))},"+45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===90}]),onClick:ve[16]||(ve[16]=Se=>Et(90))},"+90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===180}]),onClick:ve[17]||(ve[17]=Se=>Et(180))},"180",2)])])])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:wo},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:zo},"Apply")])])])):P("",!0)}},bA=Ke(kA,[["__scopeId","data-v-bbab1a46"]]),wA={class:"checkpoint-style-picker"},_A={class:"form-group"},CA={class:"style-options"},LA=["innerHTML"],IA={class:"option-label"},SA=["innerHTML"],xA="#667eea",$A={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const n=e,s=t,o=D(n.styleType),i=D(n.styleColor||""),l=D(n.styleBackgroundShape||"default"),c=D(n.styleBackgroundColor||""),d=D(n.styleBorderColor||""),h=D(n.styleIconColor||""),f=D(n.styleSize||"default"),v=D(n.styleMapRotation||""),g=F=>!F||F==="default"?!1:Qi(F).category==="content",k=D(n.styleType&&n.styleType!=="default"&&n.styleType!=="custom"&&g(n.styleType)?n.styleType:"default"),b=D(!1),x=H(()=>!!(o.value&&o.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||c.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),A=F=>F&&F!==""&&F!=="default",T=F=>F&&F.startsWith("#"),w=H(()=>{const j=A(n.inheritedStyleType),Z=A(n.inheritedBackgroundShape),Q=T(n.inheritedBackgroundColor)||T(n.inheritedStyleColor),re=T(n.inheritedBorderColor),K=T(n.inheritedIconColor),ae=A(n.inheritedSize);if(j||Z||Q||re||K||ae){const J=j?n.inheritedStyleType:Z?n.inheritedBackgroundShape:"circle",ee=(T(n.inheritedBackgroundColor)?n.inheritedBackgroundColor:null)||(T(n.inheritedStyleColor)?n.inheritedStyleColor:null)||xA;return zn({type:J,backgroundShape:n.inheritedBackgroundShape||"circle",backgroundColor:ee,borderColor:n.inheritedBorderColor||"#ffffff",iconColor:n.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=H(()=>{const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),I=H(()=>{if(v.value!==""&&v.value!==void 0&&v.value!==null){const j=parseInt(v.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),$=H(()=>{if(x.value){const F=k.value&&k.value!=="none"&&k.value!=="default";let j=null;n.inheritedStyleType&&n.inheritedStyleType!=="default"&&n.inheritedStyleType!=="custom"&&Qi(n.inheritedStyleType).category==="content"&&(j=n.inheritedStyleType);const Z=k.value==="default"&&j,Q=F||Z,re=F?k.value:Z?j:null,K=l.value&&l.value!=="default"?l.value:n.inheritedBackgroundShape||"circle",ae=Q?re:K,q=c.value||n.inheritedBackgroundColor||n.inheritedStyleColor||"#667eea",J=d.value||n.inheritedBorderColor||"#ffffff",ee=h.value||n.inheritedIconColor||"#ffffff";return zn({type:ae,backgroundShape:K,backgroundColor:q,borderColor:J,iconColor:ee,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),R=()=>{o.value="default",k.value="default",s("update:styleType","default"),l.value="default",c.value="",i.value="",d.value="",h.value="",f.value="default",v.value="",s("update:styleBackgroundShape",""),s("update:styleBackgroundColor",""),s("update:styleColor",""),s("update:styleBorderColor",""),s("update:styleIconColor",""),s("update:styleSize",""),s("update:styleMapRotation",""),U()},M=()=>{b.value=!0},O=F=>{F.iconType==="none"?k.value="none":F.iconType?k.value=F.iconType:k.value="default",l.value=F.backgroundShape||"default",c.value=F.backgroundColor||"",d.value=F.borderColor||"",h.value=F.iconColor||"",f.value=F.size||"default",v.value=F.mapRotation??"";const j=F.iconType==="none"||F.iconType&&F.iconType!==""||F.backgroundShape||F.backgroundColor||F.borderColor||F.iconColor||F.size||F.mapRotation!==""&&F.mapRotation!==0;F.iconType&&F.iconType!=="none"?o.value=F.iconType:j?o.value="custom":o.value="default",s("update:styleType",o.value),s("update:styleBackgroundShape",F.backgroundShape),s("update:styleBackgroundColor",F.backgroundColor),s("update:styleBorderColor",F.borderColor),s("update:styleIconColor",F.iconColor),s("update:styleSize",F.size),s("update:styleMapRotation",F.mapRotation??""),U()},E=()=>{},U=()=>{s("change",{styleType:o.value,styleColor:c.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:c.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:v.value})};return Ye(()=>n.styleType,F=>{o.value=F,F&&F!=="default"&&F!=="custom"&&g(F)?k.value=F:k.value="default"}),Ye(()=>n.styleColor,F=>{i.value=F||""}),Ye(()=>n.styleBackgroundShape,F=>{l.value=F||"default"}),Ye(()=>n.styleBackgroundColor,F=>{c.value=F||""}),Ye(()=>n.styleBorderColor,F=>{d.value=F||""}),Ye(()=>n.styleIconColor,F=>{h.value=F||""}),Ye(()=>n.styleSize,F=>{f.value=F||"default"}),Ye(()=>n.styleMapRotation,F=>{v.value=F??""}),(F,j)=>(p(),y("div",wA,[r("div",_A,[r("label",null,_(e.iconLabel),1),r("div",CA,[r("button",{type:"button",class:le(["style-option-button",{selected:!x.value}]),onClick:R},[r("div",{class:"option-preview",style:tt(C.value),innerHTML:w.value},null,12,LA),r("span",IA,_(e.defaultLabel),1)],2),r("button",{type:"button",class:le(["style-option-button",{selected:x.value}]),onClick:M},[r("div",{class:"option-preview",style:tt(I.value),innerHTML:$.value},null,12,SA),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Pe(bA,{isOpen:b.value,"onUpdate:isOpen":j[0]||(j[0]=Z=>b.value=Z),"icon-type":k.value,"background-shape":l.value,"background-color":c.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":v.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:O,onCancel:E},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Hf=Ke($A,[["__scopeId","data-v-c066da64"]]),TA={class:"logo-uploader"},MA={key:0,class:"logo-preview"},AA=["src"],EA=["disabled"],PA={key:0,class:"upload-progress"},DA={key:1,class:"upload-prompt"},RA={key:2,class:"error-message"},Vv=5*1024*1024,OA={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:n}){const s=K=>K?K.startsWith("/api")?ii+K.substring(4):K:"",o=e;function i(){const K={},ae=localStorage.getItem("adminEmail");ae&&(K["X-Admin-Email"]=ae);const q=localStorage.getItem("sessionToken");return q&&(K.Authorization=`Bearer ${q}`),K}const l=n;function c(){l("staged-change",{hasPendingChanges:k.value!==null||x.value,isPendingDelete:x.value,displayUrl:b.value||(x.value?"":o.modelValue)||""})}const d=D(null),h=D(!1),f=D(!1),v=D(""),g=D(Date.now()),k=D(null),b=D(""),x=D(!1),A=H(()=>{if(o.staged){if(b.value)return!0;if(x.value)return!1}return!!o.modelValue}),T=H(()=>{if(o.staged&&x.value)return"";if(o.staged&&b.value)return b.value;if(!o.modelValue)return"";const K=s(o.modelValue),ae=K.includes("?")?"&":"?";return`${K}${ae}_t=${g.value}`});function w(){b.value&&(URL.revokeObjectURL(b.value),b.value="")}Sn(()=>{w()});const C=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function I(){h.value||d.value?.click()}function $(K){const ae=K.target.files?.[0];ae&&M(ae),d.value&&(d.value.value="")}function R(K){f.value=!1;const ae=K.dataTransfer?.files?.[0];ae&&M(ae)}async function M(K){if(v.value="",!C.includes(K.type)){v.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>Vv){v.value=`File too large. Maximum size is ${Vv/(1024*1024)}MB.`;return}if(o.staged){w(),k.value=K,b.value=URL.createObjectURL(K),x.value=!1,c();return}h.value=!0;try{const ae=await fetch(`${ii}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...i()},body:K});if(!ae.ok){const J=await ae.text().catch(()=>"");let ee=`Upload failed (${ae.status})`;try{ee=JSON.parse(J).message||ee}catch{J&&(ee=J)}throw new Error(ee)}const q=await ae.json();g.value=Date.now(),l("update:modelValue",q.logoUrl)}catch(ae){console.error("Logo upload error:",ae),ae.name==="TypeError"&&ae.message==="Failed to fetch"?v.value="Network error. Check your connection or try a smaller file.":ae.message?.includes("401")||ae.message?.includes("403")?v.value="Not authorized. Please refresh the page and try again.":v.value=ae.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function O(){if(v.value="",o.staged){k.value?(w(),k.value=null):o.modelValue&&(x.value=!0),c();return}h.value=!0;try{const K=await fetch(`${ii}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}l("update:modelValue","")}catch(K){console.error("Logo delete error:",K),v.value=K.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function E(){if(!k.value)return{success:!0,logoUrl:x.value?"":o.modelValue};h.value=!0,v.value="";try{const K=await fetch(`${ii}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!K.ok){const q=await K.text().catch(()=>"");let J=`Upload failed (${K.status})`;try{J=JSON.parse(q).message||J}catch{q&&(J=q)}throw new Error(J)}const ae=await K.json();return g.value=Date.now(),w(),k.value=null,x.value=!1,{success:!0,logoUrl:ae.logoUrl}}catch(K){return console.error("Logo upload error:",K),v.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}async function U(){if(!x.value)return{success:!0};h.value=!0,v.value="";try{const K=await fetch(`${ii}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!K.ok){const ae=await K.json().catch(()=>({}));throw new Error(ae.message||"Delete failed")}return x.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),v.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{h.value=!1}}function F(){return k.value!==null||x.value}function j(){return k.value}function Z(){return x.value}function Q(){return b.value?b.value:x.value?"":s(o.modelValue)||""}function re(){w(),k.value=null,x.value=!1}return t({uploadStagedFile:E,deleteStagedLogo:U,hasPendingChanges:F,getStagedFile:j,isPendingDelete:Z,getDisplayUrl:Q,resetStagedState:re}),(K,ae)=>(p(),y("div",TA,[ae[4]||(ae[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),A.value?(p(),y("div",MA,[r("img",{src:T.value,alt:"Event logo",class:"logo-image"},null,8,AA),r("button",{type:"button",class:"remove-btn",onClick:O,disabled:h.value}," Remove ",8,EA)])):(p(),y("div",{key:1,class:le(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:ae[0]||(ae[0]=rt(q=>f.value=!0,["prevent"])),onDragleave:ae[1]||(ae[1]=rt(q=>f.value=!1,["prevent"])),onDrop:rt(R,["prevent"]),onClick:I},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:$},null,544),h.value?(p(),y("div",PA,[...ae[2]||(ae[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(p(),y("div",DA,[...ae[3]||(ae[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),v.value?(p(),y("div",RA,_(v.value),1)):P("",!0)]))}},BA=Ke(OA,[["__scopeId","data-v-bfb1b332"]]),_1=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function NA(){return{..._1[0]}}function FA(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}const UA={class:"marshal-mockup-container"},zA={class:"presets-section"},HA={class:"presets-row"},VA=["title","onClick"],GA={class:"preset-name"},qA={class:"mockup-frame"},jA={key:0,class:"logo-cover-bg"},WA=["src"],ZA=["src"],KA={class:"header-center"},YA={class:"event-name"},JA={class:"mockup-buttons"},XA=["src"],QA={class:"mockup-body"},eE={class:"mockup-card"},tE={class:"card-content"},nE={class:"editor-header"},oE={class:"editor-content"},sE={class:"color-grid-inline"},aE={class:"color-field"},iE={class:"color-swatches"},lE=["title","onClick"],rE={key:0,class:"check"},cE={class:"custom-color-wrapper"},uE={class:"hex-popup-header"},dE={class:"hex-input-row"},hE=["disabled"],fE={key:0,class:"hex-error"},pE={class:"gradient-toggle"},vE={key:0,class:"color-field"},mE={class:"color-swatches"},gE=["title","onClick"],yE={key:0,class:"check"},kE={class:"custom-color-wrapper"},bE={class:"hex-popup-header"},wE={class:"hex-input-row"},_E=["disabled"],CE={key:0,class:"hex-error"},LE={key:1,class:"logo-position-section"},IE={class:"position-buttons"},SE={class:"color-swatches"},xE=["title","onClick"],$E={key:0,class:"check"},TE={class:"custom-color-wrapper"},ME={class:"hex-popup-header"},AE={class:"hex-input-row"},EE=["disabled"],PE={key:0,class:"hex-error"},DE={class:"color-grid-inline"},RE={class:"color-field"},OE={class:"color-swatches"},BE=["title","onClick"],NE={key:0,class:"check"},FE={class:"custom-color-wrapper"},UE={class:"hex-popup-header"},zE={class:"hex-input-row"},HE=["disabled"],VE={key:0,class:"hex-error"},GE={class:"gradient-toggle"},qE={key:0,class:"color-field"},jE={class:"color-swatches"},WE=["title","onClick"],ZE={key:0,class:"check"},KE={class:"custom-color-wrapper"},YE={class:"hex-popup-header"},JE={class:"hex-input-row"},XE=["disabled"],QE={key:0,class:"hex-error"},e4={class:"editor-footer"},t4={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:n}){const s=Ee=>Ee?Ee.startsWith("/api")?ii+Ee.substring(4):Ee:"",o=Un,i=e,l=n,c=D(null),d=_1,h=D(!1),f=D(!1),v=D(null),g=D(!1),k=D(""),b=Ee=>{typeof Ee=="object"&&Ee!==null?(g.value=Ee.isPendingDelete,k.value=Ee.displayUrl||"",l("logo-staged-change",Ee.hasPendingChanges)):(v.value&&(g.value=v.value.isPendingDelete(),k.value=v.value.getDisplayUrl()||""),l("logo-staged-change",!!Ee))},x=D(null),A=D(""),T=D(null),w=D(null),C=D({left:"50%",right:"auto",transform:"translateX(-50%)"}),I=Ee=>Ee?!o.some(oe=>oe.hex.toLowerCase()===Ee.toLowerCase()):!1,$=Ee=>!Ee||!I(Ee)?"#666666":Su(Ee),R=Ee=>!Ee||!I(Ee)?"#e0e0e0":Ee,M=H(()=>{if(!A.value)return!1;const Ee=A.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Ee)||/^[0-9A-Fa-f]{3}$/.test(Ee)}),O=(Ee,oe)=>{if(x.value===Ee)x.value=null;else{x.value=Ee;let ge="";switch(Ee){case"headerStart":ge=i.branding.headerGradientStart;break;case"headerEnd":ge=i.branding.headerGradientEnd;break;case"pageStart":ge=i.branding.pageGradientStart;break;case"pageEnd":ge=i.branding.pageGradientEnd;break;case"accent":ge=i.branding.accentColor;break}if(ge&&I(ge)?A.value=ge.replace(/^#/,""):A.value="",oe&&w.value){const Be=oe.currentTarget,Oe=w.value,xe=Be.getBoundingClientRect(),me=Oe.getBoundingClientRect(),Ze=220,qe=12,fe=xe.left+xe.width/2-me.left,ke=me.width,ne=fe-Ze/2;fe+Ze/2>ke-qe?C.value={left:"auto",right:"0",transform:"none"}:ne<qe?C.value={left:"0",right:"auto",transform:"none"}:C.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>T.value?.focus())}},E=()=>{A.value=A.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},U=()=>{if(!M.value||!x.value)return;let Ee=A.value;Ee.length===3&&(Ee=Ee[0]+Ee[0]+Ee[1]+Ee[1]+Ee[2]+Ee[2]);const oe="#"+Ee;switch(x.value){case"headerStart":Y("start",oe);break;case"headerEnd":z("headerGradientEnd",oe);break;case"pageStart":de("start",oe);break;case"pageEnd":z("pageGradientEnd",oe);break;case"accent":z("accentColor",oe);break}x.value=null};Ye(c,Ee=>{if(x.value=null,A.value="",Ee==="header"){const oe=i.branding.headerGradientStart||dn.headerGradientStart,ge=i.branding.headerGradientEnd||dn.headerGradientEnd;h.value=oe!==ge}else if(Ee==="page"){const oe=i.branding.pageGradientStart||dn.pageGradientStart,ge=i.branding.pageGradientEnd||dn.pageGradientEnd;f.value=oe!==ge}});const F={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=H(()=>i.branding.headerGradientStart||dn.headerGradientStart),Z=H(()=>i.branding.headerGradientEnd||dn.headerGradientEnd),Q=H(()=>i.branding.accentColor||dn.accentColor),re=H(()=>i.branding.pageGradientStart||dn.pageGradientStart),K=H(()=>i.branding.pageGradientEnd||dn.pageGradientEnd),ae=H(()=>i.branding.logoPosition||"left"),q=D(Date.now());Ye(()=>i.branding.logoUrl,()=>{q.value=Date.now(),g.value=!1,k.value=""});const J=H(()=>g.value?!1:!!(k.value||i.branding.logoUrl)),ee=H(()=>{if(g.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const ge=s(k.value),Be=ge.includes("?")?"&":"?";return`${ge}${Be}_t=${q.value}`}if(!i.branding.logoUrl)return"";const Ee=s(i.branding.logoUrl),oe=Ee.includes("?")?"&":"?";return`${Ee}${oe}_t=${q.value}`}),ue=H(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Z.value} 100%)`})),_e=H(()=>tf(j.value,Z.value)),$e=H(()=>({background:Q.value,color:Su(Q.value)})),De=H(()=>({background:`linear-gradient(135deg, ${re.value} 0%, ${K.value} 100%)`}));function Re(Ee){c.value=c.value===Ee?null:Ee}function be(Ee){!J.value&&Ee&&z("logoPosition",Ee),Re("logo")}function z(Ee,oe){l("update:branding",{...i.branding,[Ee]:oe})}function Y(Ee,oe){h.value?z("headerGradientStart",oe):l("update:branding",{...i.branding,headerGradientStart:oe,headerGradientEnd:oe})}function de(Ee,oe){f.value?z("pageGradientStart",oe):l("update:branding",{...i.branding,pageGradientStart:oe,pageGradientEnd:oe})}function ie(){if(!h.value){const Ee=i.branding.headerGradientStart||dn.headerGradientStart;z("headerGradientEnd",Ee)}}function Ae(){if(!f.value){const Ee=i.branding.pageGradientStart||dn.pageGradientStart;z("pageGradientEnd",Ee)}}function G(Ee){l("update:branding",FA(i.branding,Ee)),c.value=null}async function X(){return v.value?await v.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function te(){return v.value?await v.value.deleteStagedLogo():{success:!0}}function Ce(){return v.value?.hasPendingChanges()||!1}function Ne(){return v.value?.isPendingDelete()||!1}function Fe(){v.value&&v.value.resetStagedState(),g.value=!1,k.value=""}return t({uploadStagedLogo:X,deleteStagedLogo:te,hasLogoChanges:Ce,isLogoPendingDelete:Ne,resetLogo:Fe}),(Ee,oe)=>(p(),y("div",UA,[r("div",zA,[oe[32]||(oe[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",HA,[(p(!0),y(Ie,null,je(N(d),ge=>(p(),y("button",{key:ge.name,type:"button",class:"preset-btn",title:ge.name,onClick:Be=>G(ge)},[r("span",{class:"preset-preview",style:tt({background:`linear-gradient(135deg, ${ge.pageGradientStart} 0%, ${ge.pageGradientEnd} 100%)`})},null,4),r("span",GA,_(ge.name),1)],8,VA))),128))])]),r("div",qA,[r("div",{class:le(["mockup-page",{"region-active":c.value==="page"}]),style:tt(De.value),onClick:oe[7]||(oe[7]=ge=>Re("page"))},[r("div",{class:le(["mockup-header",[{"region-active":c.value==="header"},J.value?`logo-${ae.value}`:"logo-none"]]),style:tt(ue.value),onClick:oe[5]||(oe[5]=rt(ge=>Re("header"),["stop"]))},[J.value&&ae.value==="cover"?(p(),y("div",jA,[r("img",{src:ee.value,alt:"Logo",class:"logo-cover-img"},null,8,WA)])):P("",!0),J.value&&ae.value==="cover"?(p(),y("button",{key:1,type:"button",class:le(["logo-cover-edit-btn",{"region-active":c.value==="logo"}]),onClick:oe[0]||(oe[0]=rt(ge=>Re("logo"),["stop"])),title:"Edit logo"},[...oe[33]||(oe[33]=[r("span",null,"",-1)])],2)):P("",!0),J.value&&ae.value==="left"?(p(),y("div",{key:2,class:le(["mockup-logo logo-left",{"region-active":c.value==="logo"}]),onClick:oe[1]||(oe[1]=rt(ge=>Re("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,ZA)],2)):P("",!0),J.value?P("",!0):(p(),y("div",{key:3,class:le(["logo-add-area logo-add-left",{"region-active":c.value==="logo"}]),onClick:oe[2]||(oe[2]=rt(ge=>be("left"),["stop"]))},[...oe[34]||(oe[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",KA,[r("div",{class:"mockup-title",style:tt({color:_e.value})},[r("span",YA,_(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:tt({color:_e.value})},_(e.eventDate||"Event Date"),5),r("div",JA,[oe[35]||(oe[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:tt({color:_e.value})},"Logout",4)])]),J.value&&ae.value==="right"?(p(),y("div",{key:4,class:le(["mockup-logo logo-right",{"region-active":c.value==="logo"}]),onClick:oe[3]||(oe[3]=rt(ge=>Re("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,XA)],2)):P("",!0),J.value?P("",!0):(p(),y("div",{key:5,class:le(["logo-add-area logo-add-right",{"region-active":c.value==="logo"}]),onClick:oe[4]||(oe[4]=rt(ge=>be("right"),["stop"]))},[...oe[36]||(oe[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",QA,[r("div",eE,[oe[37]||(oe[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",tE,[r("div",{class:le(["mockup-checkin-btn",{"region-active":c.value==="accent"}]),style:tt($e.value),onClick:oe[6]||(oe[6]=rt(ge=>Re("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),We(r("div",{class:"editor-overlay",onClick:oe[31]||(oe[31]=rt(ge=>c.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:w,class:"editor-modal"},[r("div",nE,[r("span",null,_(F[c.value]),1),r("button",{type:"button",class:"editor-close",onClick:oe[8]||(oe[8]=ge=>c.value=null)},"")]),r("div",oE,[c.value==="header"?(p(),y(Ie,{key:0},[oe[46]||(oe[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",sE,[r("div",aE,[r("label",null,_(h.value?"Start colour":"Colour"),1),r("div",iE,[(p(!0),y(Ie,null,je(N(o),ge=>(p(),y("button",{key:"hs-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Be=>Y("start",ge.hex)},[e.branding.headerGradientStart===ge.hex?(p(),y("span",rE,"")):P("",!0)],14,lE))),128)),r("div",cE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientStart)}]),style:tt({backgroundColor:R(e.branding.headerGradientStart)}),title:"Custom colour",onClick:oe[9]||(oe[9]=ge=>O("headerStart",ge))},[(p(),y("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[38]||(oe[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerStart"?(p(),y("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",uE,[oe[39]||(oe[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[10]||(oe[10]=ge=>x.value=null)},"")]),r("div",dE,[oe[40]||(oe[40]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:T,"onUpdate:modelValue":oe[11]||(oe[11]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!M.value}]),onInput:E,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,hE)]),A.value&&!M.value?(p(),y("span",fE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",pE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[12]||(oe[12]=ge=>h.value=ge),onChange:ie},null,544),[[$s,h.value]]),oe[41]||(oe[41]=r("span",null,"Use gradient",-1))])]),h.value?(p(),y("div",vE,[oe[45]||(oe[45]=r("label",null,"End colour",-1)),r("div",mE,[(p(!0),y(Ie,null,je(N(o),ge=>(p(),y("button",{key:"he-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Be=>z("headerGradientEnd",ge.hex)},[e.branding.headerGradientEnd===ge.hex?(p(),y("span",yE,"")):P("",!0)],14,gE))),128)),r("div",kE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientEnd)}]),style:tt({backgroundColor:R(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:oe[13]||(oe[13]=ge=>O("headerEnd",ge))},[(p(),y("svg",{class:"custom-icon",style:tt({color:$(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[42]||(oe[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerEnd"?(p(),y("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",bE,[oe[43]||(oe[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[14]||(oe[14]=ge=>x.value=null)},"")]),r("div",wE,[oe[44]||(oe[44]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:T,"onUpdate:modelValue":oe[15]||(oe[15]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!M.value}]),onInput:E,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,_E)]),A.value&&!M.value?(p(),y("span",CE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0),c.value==="logo"?(p(),y("div",LE,[oe[47]||(oe[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",IE,[r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="left"}]),onClick:oe[16]||(oe[16]=ge=>z("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="cover"}]),onClick:oe[17]||(oe[17]=ge=>z("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:le(["position-btn",{selected:ae.value==="right"}]),onClick:oe[18]||(oe[18]=ge=>z("logoPosition","right"))}," Right ",2)])])):P("",!0),We(Pe(BA,{ref_key:"logoUploaderRef",ref:v,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":oe[19]||(oe[19]=ge=>z("logoUrl",ge)),onStagedChange:b},null,8,["model-value","event-id","admin-email"]),[[ns,c.value==="logo"]]),c.value==="accent"?(p(),y(Ie,{key:2},[oe[51]||(oe[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",SE,[(p(!0),y(Ie,null,je(N(o),ge=>(p(),y("button",{key:"ac-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.accentColor===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Be=>z("accentColor",ge.hex)},[e.branding.accentColor===ge.hex?(p(),y("span",$E,"")):P("",!0)],14,xE))),128)),r("div",TE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.accentColor)}]),style:tt({backgroundColor:R(e.branding.accentColor)}),title:"Custom colour",onClick:oe[20]||(oe[20]=ge=>O("accent",ge))},[(p(),y("svg",{class:"custom-icon",style:tt({color:$(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[48]||(oe[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="accent"?(p(),y("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",ME,[oe[49]||(oe[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[21]||(oe[21]=ge=>x.value=null)},"")]),r("div",AE,[oe[50]||(oe[50]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:T,"onUpdate:modelValue":oe[22]||(oe[22]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!M.value}]),onInput:E,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,EE)]),A.value&&!M.value?(p(),y("span",PE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])],64)):P("",!0),c.value==="page"?(p(),y(Ie,{key:3},[oe[60]||(oe[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",DE,[r("div",RE,[r("label",null,_(f.value?"Start colour":"Colour"),1),r("div",OE,[(p(!0),y(Ie,null,je(N(o),ge=>(p(),y("button",{key:"ps-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientStart===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Be=>de("start",ge.hex)},[e.branding.pageGradientStart===ge.hex?(p(),y("span",NE,"")):P("",!0)],14,BE))),128)),r("div",FE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientStart)}]),style:tt({backgroundColor:R(e.branding.pageGradientStart)}),title:"Custom colour",onClick:oe[23]||(oe[23]=ge=>O("pageStart",ge))},[(p(),y("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[52]||(oe[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageStart"?(p(),y("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",UE,[oe[53]||(oe[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[24]||(oe[24]=ge=>x.value=null)},"")]),r("div",zE,[oe[54]||(oe[54]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:T,"onUpdate:modelValue":oe[25]||(oe[25]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!M.value}]),onInput:E,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,HE)]),A.value&&!M.value?(p(),y("span",VE,"Invalid hex code")):P("",!0)],4)):P("",!0)])]),r("label",GE,[We(r("input",{type:"checkbox","onUpdate:modelValue":oe[26]||(oe[26]=ge=>f.value=ge),onChange:Ae},null,544),[[$s,f.value]]),oe[55]||(oe[55]=r("span",null,"Use gradient",-1))])]),f.value?(p(),y("div",qE,[oe[59]||(oe[59]=r("label",null,"End colour",-1)),r("div",jE,[(p(!0),y(Ie,null,je(N(o),ge=>(p(),y("button",{key:"pe-"+ge.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ge.hex}]),style:tt({backgroundColor:ge.hex}),title:ge.name,onClick:Be=>z("pageGradientEnd",ge.hex)},[e.branding.pageGradientEnd===ge.hex?(p(),y("span",ZE,"")):P("",!0)],14,WE))),128)),r("div",KE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientEnd)}]),style:tt({backgroundColor:R(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:oe[27]||(oe[27]=ge=>O("pageEnd",ge))},[(p(),y("svg",{class:"custom-icon",style:tt({color:$(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...oe[56]||(oe[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageEnd"?(p(),y("div",{key:0,class:"custom-hex-popup",style:tt(C.value)},[r("div",YE,[oe[57]||(oe[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:oe[28]||(oe[28]=ge=>x.value=null)},"")]),r("div",JE,[oe[58]||(oe[58]=r("span",{class:"hex-prefix"},"#",-1)),We(r("input",{ref_key:"hexInputRef",ref:T,"onUpdate:modelValue":oe[29]||(oe[29]=ge=>A.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:A.value&&!M.value}]),onInput:E,onKeydown:Xo(U,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:tt({backgroundColor:M.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:U}," Apply ",8,XE)]),A.value&&!M.value?(p(),y("span",QE,"Invalid hex code")):P("",!0)],4)):P("",!0)])])])):P("",!0)])],64)):P("",!0)]),r("div",e4,[r("button",{type:"button",class:"btn-done",onClick:oe[30]||(oe[30]=ge=>c.value=null)},"Done")])],512)],512),[[ns,c.value]]),oe[61]||(oe[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},n4=Ke(t4,[["__scopeId","data-v-01af4f2d"]]),o4={class:"settings-tab"},s4={class:"accordion"},a4={class:"accordion-section"},i4={class:"accordion-title"},l4={class:"accordion-icon"},r4={key:0,class:"accordion-content"},c4={class:"accordion-section"},u4={class:"accordion-icon"},d4={key:0,class:"accordion-content"},h4={class:"terminology-grid"},f4={class:"term-group"},p4=["value"],v4={class:"term-group"},m4=["value"],g4={class:"term-group"},y4=["value"],k4={class:"term-group"},b4=["value"],w4={class:"term-group"},_4=["value"],C4={class:"form-actions"},L4=["disabled"],I4={class:"accordion-section"},S4={class:"accordion-title"},x4={class:"accordion-icon"},$4={key:0,class:"accordion-content"},T4={class:"section-description"},M4={class:"form-actions"},A4=["disabled"],E4={class:"accordion-section"},P4={class:"accordion-title"},D4={class:"accordion-icon"},R4={key:0,class:"accordion-content"},O4={class:"section-description"},B4={class:"form-actions"},N4=["disabled"],F4=["disabled"],Gv="admin_settings_accordion",U4={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=gc(),i=H(()=>o.adminEmail||""),l=e,c=t,d=D({...l.eventData}),h=D(null),f=D(!1),v=()=>l.eventId?`${Gv}_${l.eventId}`:Gv,g=D(null);un(()=>{const M=localStorage.getItem(v());M&&(g.value=M)});const k=H(()=>{const M=d.value.peopleTerm||"Marshals";return ya.checkpoint.map(O=>({value:O,label:Kh(O,M)}))}),b=M=>{const O=g.value===M?null:M;g.value=O,O?localStorage.setItem(v(),O):localStorage.removeItem(v())};Ye(()=>l.eventData,M=>{d.value={...M},w.value=!1},{deep:!0});const x=()=>{c("update:formDirty",!0)},A=(M,O)=>{d.value[M]=O,x()},T=H(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),w=D(!1),C=M=>{w.value=M},I=M=>{d.value.brandingHeaderGradientStart=M.headerGradientStart,d.value.brandingHeaderGradientEnd=M.headerGradientEnd,d.value.brandingLogoUrl=M.logoUrl,d.value.brandingLogoPosition=M.logoPosition,d.value.brandingAccentColor=M.accentColor,d.value.brandingPageGradientStart=M.pageGradientStart,d.value.brandingPageGradientEnd=M.pageGradientEnd,x()},$=()=>{NA(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",w.value=!1,h.value?.resetLogo(),x()},R=async()=>{if(!f.value){f.value=!0;try{if(w.value&&h.value){if(h.value.isLogoPendingDelete()){const O=await h.value.deleteStagedLogo();if(!O.success){console.error("Failed to delete logo:",O.error);return}d.value.brandingLogoUrl=""}else{const O=await h.value.uploadStagedLogo();if(!O.success){console.error("Failed to upload logo:",O.error);return}O.logoUrl&&!O.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=O.logoUrl)}w.value=!1}c("submit",{...d.value})}finally{f.value=!1}}};return(M,O)=>(p(),y("div",o4,[r("div",s4,[r("div",a4,[r("button",{class:le(["accordion-header",{active:g.value==="admins"}]),onClick:O[0]||(O[0]=E=>b("admins"))},[r("span",i4,"Administrators ("+_(e.admins.length)+")",1),r("span",l4,_(g.value==="admins"?"-":"+"),1)],2),g.value==="admins"?(p(),y("div",r4,[Pe(qT,{admins:e.admins,onAddAdmin:O[1]||(O[1]=E=>M.$emit("add-admin")),onRemoveAdmin:O[2]||(O[2]=E=>M.$emit("remove-admin",E))},null,8,["admins"])])):P("",!0)]),r("div",c4,[r("button",{class:le(["accordion-header",{active:g.value==="terminology"}]),onClick:O[3]||(O[3]=E=>b("terminology"))},[O[19]||(O[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",u4,_(g.value==="terminology"?"-":"+"),1)],2),g.value==="terminology"?(p(),y("div",d4,[O[20]||(O[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",h4,[r("div",f4,[r("label",null,_(N(n).people)+" are called",1),We(r("select",{"onUpdate:modelValue":O[4]||(O[4]=E=>d.value.peopleTerm=E),class:"form-input",onChange:x},[(p(!0),y(Ie,null,je(N(ya).people,E=>(p(),y("option",{key:E,value:E},_(E),9,p4))),128))],544),[[no,d.value.peopleTerm]])]),r("div",v4,[r("label",null,_(N(n).checkpoints)+" are called",1),We(r("select",{"onUpdate:modelValue":O[5]||(O[5]=E=>d.value.checkpointTerm=E),class:"form-input",onChange:x},[(p(!0),y(Ie,null,je(k.value,E=>(p(),y("option",{key:E.value,value:E.value},_(E.label),9,m4))),128))],544),[[no,d.value.checkpointTerm]])]),r("div",g4,[r("label",null,_(N(n).areas)+" are called",1),We(r("select",{"onUpdate:modelValue":O[6]||(O[6]=E=>d.value.areaTerm=E),class:"form-input",onChange:x},[(p(!0),y(Ie,null,je(N(ya).area,E=>(p(),y("option",{key:E,value:E},_(E),9,y4))),128))],544),[[no,d.value.areaTerm]])]),r("div",k4,[r("label",null,_(N(n).checklists)+" are called",1),We(r("select",{"onUpdate:modelValue":O[7]||(O[7]=E=>d.value.checklistTerm=E),class:"form-input",onChange:x},[(p(!0),y(Ie,null,je(N(ya).checklist,E=>(p(),y("option",{key:E,value:E},_(E),9,b4))),128))],544),[[no,d.value.checklistTerm]])]),r("div",w4,[r("label",null,_(N(n).course)+" is called",1),We(r("select",{"onUpdate:modelValue":O[8]||(O[8]=E=>d.value.courseTerm=E),class:"form-input",onChange:x},[(p(!0),y(Ie,null,je(N(ya).course,E=>(p(),y("option",{key:E,value:E},_(E),9,_4))),128))],544),[[no,d.value.courseTerm]])])]),r("div",C4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,L4)])])):P("",!0)]),r("div",I4,[r("button",{class:le(["accordion-header",{active:g.value==="appearance"}]),onClick:O[9]||(O[9]=E=>b("appearance"))},[r("span",S4,_(N(n).checkpoint)+" appearance",1),r("span",x4,_(g.value==="appearance"?"-":"+"),1)],2),g.value==="appearance"?(p(),y("div",$4,[r("p",T4," Set the default marker style for all "+_(N(s).checkpoints)+" in this event. Individual "+_(N(s).areas)+" and "+_(N(s).checkpoints)+" can override this setting. ",1),Pe(Hf,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":O[10]||(O[10]=E=>A("defaultCheckpointStyleType",E)),"onUpdate:styleColor":O[11]||(O[11]=E=>A("defaultCheckpointStyleColor",E)),"onUpdate:styleBackgroundShape":O[12]||(O[12]=E=>A("defaultCheckpointStyleBackgroundShape",E)),"onUpdate:styleBackgroundColor":O[13]||(O[13]=E=>A("defaultCheckpointStyleBackgroundColor",E)),"onUpdate:styleBorderColor":O[14]||(O[14]=E=>A("defaultCheckpointStyleBorderColor",E)),"onUpdate:styleIconColor":O[15]||(O[15]=E=>A("defaultCheckpointStyleIconColor",E)),"onUpdate:styleSize":O[16]||(O[16]=E=>A("defaultCheckpointStyleSize",E)),"onUpdate:styleMapRotation":O[17]||(O[17]=E=>A("defaultCheckpointStyleMapRotation",E))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",M4,[r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,A4)])])):P("",!0)]),r("div",E4,[r("button",{class:le(["accordion-header",{active:g.value==="branding"}]),onClick:O[18]||(O[18]=E=>b("branding"))},[r("span",P4,_(N(n).person)+" branding",1),r("span",D4,_(g.value==="branding"?"-":"+"),1)],2),g.value==="branding"?(p(),y("div",R4,[r("p",O4," Customise the appearance of the "+_(N(s).person)+" view to match your organisation's branding. ",1),Pe(n4,{ref_key:"brandingMockupRef",ref:h,branding:T.value,"event-name":d.value.name,"event-date":N(o1)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":I,onLogoStagedChange:C},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",B4,[r("button",{onClick:$,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,N4),r("button",{onClick:R,class:"btn btn-primary",disabled:!e.formDirty&&!w.value||f.value},_(f.value?"Saving...":"Save"),9,F4)])])):P("",!0)])])]))}},z4=Ke(U4,[["__scopeId","data-v-bb7e241a"]]),H4={class:"incident-header"},V4={class:"incident-title-row"},G4={class:"incident-title"},q4={class:"incident-badges"},j4={key:0,class:"incident-description"},W4={class:"incident-context"},Z4={key:0,class:"context-item"},K4={key:1,class:"context-item"},Y4={key:2,class:"context-item"},J4={class:"incident-footer"},X4={class:"reporter-info"},Q4={class:"time-info"},e3={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,n=H(()=>{if(t.incident.title)return t.incident.title;const c=t.incident.description||"";return c.length<=60?c:c.substring(0,57).trim()+"..."}),s=c=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[c]||c,o=c=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[c]||c,i=(c,d=120)=>!c||c.length<=d?c:c.substring(0,d).trim()+"...",l=c=>{if(!c)return"";const d=new Date(c),f=new Date-d,v=Math.floor(f/6e4),g=Math.floor(f/36e5),k=Math.floor(f/864e5);return v<1?"just now":v<60?`${v}m ago`:g<24?`${g}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(c,d)=>(p(),y("div",{class:le(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>c.$emit("select",e.incident))},[r("div",H4,[r("div",V4,[r("span",{class:le(["severity-indicator",e.incident.severity])},null,2),r("strong",G4,_(n.value),1)]),r("div",q4,[r("span",{class:le(["severity-badge",e.incident.severity])},_(s(e.incident.severity)),3),r("span",{class:le(["status-badge",e.incident.status])},_(o(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(p(),y("div",j4,_(i(e.incident.description)),1)):P("",!0),r("div",W4,[e.incident.context?.checkpoint?(p(),y("div",Z4,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,_(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(p(),y("div",K4,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(p(),y("div",Y4,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,_(e.incident.area.areaName),1)])):P("",!0)]),r("div",J4,[r("span",X4," Reported by "+_(e.incident.reportedBy?.name||"Unknown"),1),r("span",Q4,_(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},bc=Ke(e3,[["__scopeId","data-v-690fd385"]]),t3={class:"incidents-tab"},n3={class:"tab-header"},o3={class:"button-group"},s3={key:0,class:"status-pills"},a3={class:"filters-section"},i3={class:"search-group"},l3={class:"incidents-list"},r3={key:0,class:"loading-state"},c3={key:1,class:"empty-state"},u3={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const n=e,s=D(""),o=D("all"),i=g=>{o.value=g},l=H(()=>n.incidents.filter(g=>g.status==="open").length),c=H(()=>n.incidents.filter(g=>g.status==="in_progress"||g.status==="acknowledged").length),d=H(()=>n.incidents.filter(g=>g.status==="resolved").length),h=H(()=>n.incidents.filter(g=>g.status==="closed").length),f=H(()=>{let g=n.incidents;if(o.value==="open"?g=g.filter(k=>k.status==="open"):o.value==="in-progress"?g=g.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):o.value==="resolved"?g=g.filter(k=>k.status==="resolved"):o.value==="closed"&&(g=g.filter(k=>k.status==="closed")),s.value.trim()){const k=s.value.toLowerCase().trim().split(/\s+/);g=g.filter(b=>{const x=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,A=b.area?.areaName||"",T=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map(I=>I.name||"")].join(" "),w=(b.updates||[]).map(I=>I.note||"").join(" "),C=`${b.title||""} ${b.description||""} ${x} ${A} ${T} ${w}`.toLowerCase();return k.every(I=>C.includes(I))})}return g}),v=H(()=>[...f.value].sort((g,k)=>new Date(k.incidentTime||k.createdAt)-new Date(g.incidentTime||g.createdAt)));return(g,k)=>(p(),y("div",t3,[r("div",n3,[r("div",o3,[r("button",{onClick:k[0]||(k[0]=b=>g.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(p(),y("div",s3,[Pe(At,{variant:"neutral",active:o.value==="all",onClick:k[1]||(k[1]=b=>i("all"))},{default:Ve(()=>[Je(_(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(p(),Ge(At,{key:0,variant:"info",active:o.value==="open",onClick:k[2]||(k[2]=b=>i("open"))},{default:Ve(()=>[Je(_(l.value)+" open ",1)]),_:1},8,["active"])):P("",!0),c.value>0&&c.value<e.incidents.length?(p(),Ge(At,{key:1,variant:"purple",active:o.value==="in-progress",onClick:k[3]||(k[3]=b=>i("in-progress"))},{default:Ve(()=>[Je(_(c.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0&&d.value<e.incidents.length?(p(),Ge(At,{key:2,variant:"success",active:o.value==="resolved",onClick:k[4]||(k[4]=b=>i("resolved"))},{default:Ve(()=>[Je(_(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.incidents.length?(p(),Ge(At,{key:3,variant:"neutral",active:o.value==="closed",onClick:k[5]||(k[5]=b=>i("closed"))},{default:Ve(()=>[Je(_(h.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",a3,[r("div",i3,[We(r("input",{"onUpdate:modelValue":k[6]||(k[6]=b=>s.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,s.value]])])]),r("div",l3,[e.loading?(p(),y("div",r3," Loading incidents... ")):f.value.length===0?(p(),y("div",c3,[r("p",null,_(s.value||o.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(p(!0),y(Ie,null,je(v.value,b=>(p(),Ge(bc,{key:b.incidentId,incident:b,onSelect:x=>g.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},d3=Ke(u3,[["__scopeId","data-v-f24c84f4"]]),h3={key:0,class:"empty-state"},f3={key:0,class:"empty-hint"},p3={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,n)=>e.isEmpty?(p(),y("div",h3,[r("p",null,_(e.emptyMessage),1),e.emptyHint?(p(),y("p",f3,_(e.emptyHint),1)):P("",!0)])):(p(),y("div",{key:1,class:le(["cards-grid",e.gridClass])},[go(t.$slots,"default",{},void 0,!0)],2))}},wc=Ke(p3,[["__scopeId","data-v-a842b7b1"]]),v3={class:"checkpoint-card-header"},m3={class:"checkpoint-name-row"},g3=["innerHTML"],y3={class:"checkpoint-name"},k3={key:0,class:"checkpoint-description"},b3={key:0,class:"checkpoint-card-areas"},w3={class:"checkpoint-card-stats"},_3={key:1,class:"checkpoint-card-marshals"},C3={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.checkpoint.areaIds||n.checkpoint.AreaIds||[]),i=A=>{const T=n.areas.find(w=>w.id===A);return T?T.name:null},l=A=>{const T=n.areas.find(w=>w.id===A);return T?T.color:"#999"},c=H(()=>{const A=n.checkpoint,T=A.resolvedStyleBackgroundColor||A.ResolvedStyleBackgroundColor||A.resolvedStyleColor||A.ResolvedStyleColor;return T||(o.value.length>0?l(o.value[0]):"#667eea")}),d=H(()=>{const A=n.checkpoint,T=(A.assignments||[]).length;return A.requiredMarshals===0?null:T>=A.requiredMarshals?"full":T>0?"partial":"none"}),h=H(()=>[...n.checkpoint.assignments||[]].sort((T,w)=>(T.marshalName||"").localeCompare(w.marshalName||"",void 0,{sensitivity:"base"}))),f=H(()=>(n.checkpoint.assignments||[]).length),v=H(()=>(n.checkpoint.assignments||[]).filter(A=>A.isCheckedIn).length),g=H(()=>d.value?`staffing-${d.value}`:""),k=H(()=>{const A=f.value,T=v.value;return A===0?"":T===0?"checkin-none":T>=A?"checkin-full":"checkin-partial"}),b=H(()=>{const A=n.checkpoint,T=A.resolvedStyleType||A.ResolvedStyleType,w=A.resolvedStyleBackgroundColor||A.ResolvedStyleBackgroundColor||A.resolvedStyleColor||A.ResolvedStyleColor,C=A.resolvedStyleBorderColor||A.ResolvedStyleBorderColor,I=A.resolvedStyleIconColor||A.ResolvedStyleIconColor,$=A.resolvedStyleBackgroundShape||A.ResolvedStyleBackgroundShape;return T&&T!=="default"||w||C||I||$&&$!=="circle"?zn({type:T||"circle",backgroundShape:$||"circle",backgroundColor:w||"#667eea",borderColor:C||"#ffffff",iconColor:I||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),x=()=>{n.clickable&&s("click",n.checkpoint)};return(A,T)=>(p(),y("div",{class:le(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:tt({borderLeftColor:c.value}),onClick:x},[r("div",v3,[r("div",{class:le(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",m3,[r("span",{class:"checkpoint-icon",innerHTML:b.value},null,8,g3),r("span",y3,_(e.checkpoint.name),1),e.checkpoint.description?(p(),y("span",k3,"  "+_(e.checkpoint.description),1)):P("",!0)])],2)]),o.value.length>0?(p(),y("div",b3,[(p(!0),y(Ie,null,je(o.value,w=>(p(),y("span",{key:w,class:"area-badge",style:tt({backgroundColor:l(w)})},_(i(w)),5))),128))])):P("",!0),r("div",w3,[r("span",{class:le(["stat-badge staffing-badge",g.value])},_(f.value)+"/"+_(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(p(),y("span",{key:0,class:le(["stat-badge",k.value])},_(v.value)+"/"+_(f.value)+" checked in ",3)):P("",!0)]),h.value.length>0?(p(),y("div",_3,[(p(!0),y(Ie,null,je(h.value,w=>(p(),y("span",{key:w.id,class:le(["marshal-badge",{"checked-in":w.isCheckedIn}])},_(w.marshalName),3))),128))])):P("",!0)],6))}},L3=Ke(C3,[["__scopeId","data-v-7ae260df"]]),C1={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),Ge(wc,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),y(Ie,null,je(e.checkpoints,s=>(p(),Ge(L3,{key:s.id,checkpoint:s,areas:e.areas,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},I3={class:"checkpoints-tab"},S3={class:"tab-header"},x3={class:"button-group"},$3={key:0,class:"status-pills"},T3={class:"filters-section"},M3={class:"search-group"},A3=["placeholder"],E3={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=dt(),n=e,s=D(""),o=D("all"),i=w=>{o.value=w},l=w=>(w.assignments||[]).length,c=w=>(w.assignments||[]).filter(C=>C.isCheckedIn).length,d=H(()=>n.locations.filter(w=>l(w)>=w.requiredMarshals&&w.requiredMarshals>0).length),h=H(()=>n.locations.filter(w=>l(w)>0&&l(w)<w.requiredMarshals).length),f=H(()=>n.locations.filter(w=>l(w)===0&&w.requiredMarshals>0).length),v=H(()=>n.locations.filter(w=>{const C=l(w),I=c(w);return C>0&&I>=C}).length),g=H(()=>n.locations.filter(w=>{const C=l(w),I=c(w);return C>0&&I>0&&I<C}).length),k=H(()=>n.locations.filter(w=>{const C=l(w),I=c(w);return C>0&&I===0}).length),b=w=>{const C=n.areas.find(I=>I.id===w);return C?C.name:null},x=H(()=>{let w=n.locations;if(o.value==="full"?w=w.filter(C=>l(C)>=C.requiredMarshals&&C.requiredMarshals>0):o.value==="partial"?w=w.filter(C=>l(C)>0&&l(C)<C.requiredMarshals):o.value==="missing"?w=w.filter(C=>l(C)===0&&C.requiredMarshals>0):o.value==="checkin-full"?w=w.filter(C=>{const I=l(C),$=c(C);return I>0&&$>=I}):o.value==="checkin-partial"?w=w.filter(C=>{const I=l(C),$=c(C);return I>0&&$>0&&$<I}):o.value==="checkin-none"&&(w=w.filter(C=>{const I=l(C),$=c(C);return I>0&&$===0})),s.value.trim()){const C=s.value.toLowerCase().trim().split(/\s+/);w=w.filter(I=>{const R=(I.areaIds||I.AreaIds||[]).map(E=>b(E)||"").join(" "),M=(I.assignments||[]).map(E=>E.marshalName||"").join(" "),O=`${I.name||""} ${I.description||""} ${R} ${M}`.toLowerCase();return C.every(E=>O.includes(E))})}return w}),A=H(()=>[...x.value].sort((w,C)=>Qo(w.name,C.name))),T=H(()=>{const w=s.value.trim();return o.value==="full"?w?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:o.value==="partial"?w?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:o.value==="missing"?w?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:o.value==="checkin-full"?w?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:o.value==="checkin-partial"?w?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:o.value==="checkin-none"?w?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:w?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(w,C)=>(p(),y("div",I3,[r("div",S3,[r("div",x3,[r("button",{onClick:C[0]||(C[0]=I=>w.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+_(N(t).checkpoint),1),r("button",{onClick:C[1]||(C[1]=I=>w.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(p(),y("div",$3,[Pe(At,{variant:"neutral",active:o.value==="all",onClick:C[2]||(C[2]=I=>i("all"))},{default:Ve(()=>[Je(_(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(p(),Ge(At,{key:0,variant:"success",active:o.value==="full",onClick:C[3]||(C[3]=I=>i("full"))},{default:Ve(()=>[Je(_(d.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),h.value>0&&h.value<e.locations.length?(p(),Ge(At,{key:1,variant:"warning",active:o.value==="partial",onClick:C[4]||(C[4]=I=>i("partial"))},{default:Ve(()=>[Je(_(h.value)+" partially staffed ",1)]),_:1},8,["active"])):P("",!0),f.value>0&&f.value<e.locations.length?(p(),Ge(At,{key:2,variant:"danger",active:o.value==="missing",onClick:C[5]||(C[5]=I=>i("missing"))},{default:Ve(()=>[Je(_(f.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0),v.value>0&&v.value<e.locations.length?(p(),Ge(At,{key:3,variant:"success",active:o.value==="checkin-full",onClick:C[6]||(C[6]=I=>i("checkin-full"))},{default:Ve(()=>[Je(_(v.value)+" fully checked in ",1)]),_:1},8,["active"])):P("",!0),g.value>0&&g.value<e.locations.length?(p(),Ge(At,{key:4,variant:"warning",active:o.value==="checkin-partial",onClick:C[7]||(C[7]=I=>i("checkin-partial"))},{default:Ve(()=>[Je(_(g.value)+" partially checked in ",1)]),_:1},8,["active"])):P("",!0),k.value>0&&k.value<e.locations.length?(p(),Ge(At,{key:5,variant:"danger",active:o.value==="checkin-none",onClick:C[8]||(C[8]=I=>i("checkin-none"))},{default:Ve(()=>[Je(_(k.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",T3,[r("div",M3,[We(r("input",{"onUpdate:modelValue":C[9]||(C[9]=I=>s.value=I),type:"text",class:"search-input",placeholder:`Search by name, description, ${N(t).area}, or ${N(t).person}...`},null,8,A3),[[st,s.value]])])]),Pe(C1,{checkpoints:A.value,areas:e.areas,"empty-message":T.value,onSelect:C[10]||(C[10]=I=>w.$emit("select-location",I))},null,8,["checkpoints","areas","empty-message"])]))}},P3=Ke(E3,[["__scopeId","data-v-846aa906"]]),D3={class:"area-card-header"},R3={class:"area-name-row"},O3={class:"area-name"},B3={key:0,class:"default-badge"},N3={key:0,class:"area-description"},F3={class:"area-card-stats"},U3={class:"stat-badge"},z3={class:"stat-badge"},H3={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.area.checkpointCount!==void 0?n.area.checkpointCount:n.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(n.area.id)||f.areaId===n.area.id).length),i=H(()=>n.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(v=>v.scope==="EveryoneInAreas"&&v.itemType==="Area"?v.ids?.includes("ALL_AREAS")?!0:v.ids?.includes(n.area.id):!1):!1).length),l=H(()=>n.area.peopleTerm||n.eventPeopleTerm||"Marshals"),c=H(()=>{const f=n.area.checkpointTerm||n.eventCheckpointTerm||"Checkpoints";return o.value===1?ji("checkpoint",f,l.value):e1("checkpoint",f,l.value)}),d=H(()=>`${o.value} ${c.value.toLowerCase()}`),h=()=>{n.clickable&&s("click",n.area)};return(f,v)=>(p(),y("div",{class:le(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:tt({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",D3,[r("div",{class:le(["area-card-title",{clickable:e.clickable}])},[r("div",R3,[r("span",O3,_(e.area.name),1),e.area.isDefault?(p(),y("span",B3,"Default")):P("",!0)]),e.area.description?(p(),y("span",N3,_(e.area.description),1)):P("",!0)],2)]),r("div",F3,[r("span",U3,_(d.value),1),r("span",z3,_(i.value)+" contact"+_(i.value===1?"":"s"),1)])],6))}},V3=Ke(H3,[["__scopeId","data-v-8ac20bf2"]]),G3={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),Ge(wc,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(p(!0),y(Ie,null,je(e.areas,s=>(p(),Ge(V3,{key:s.id,area:s,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},q3={class:"areas-tab"},j3={class:"tab-header"},W3={class:"button-group"},Z3={key:0,class:"status-pills"},K3={class:"filters-section"},Y3={class:"search-group"},J3=["placeholder"],X3={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=dt(),n=e,s=D(""),o=d=>n.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=H(()=>{if(!s.value.trim())return n.areas;const d=s.value.toLowerCase().trim().split(/\s+/);return n.areas.filter(h=>{const v=o(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),g=`${h.name||""} ${h.description||""} ${v}`.toLowerCase();return d.every(k=>g.includes(k))})}),l=H(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Qo(d.name,h.name))),c=H(()=>s.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(p(),y("div",q3,[r("div",j3,[r("div",W3,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+_(N(t).area),1)]),e.areas.length>0?(p(),y("div",Z3,[Pe(At,{variant:"neutral",active:!1},{default:Ve(()=>[Je(_(e.areas.length)+" "+_(e.areas.length===1?N(t).area:N(t).areas),1)]),_:1})])):P("",!0)]),r("div",K3,[r("div",Y3,[We(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>s.value=f),type:"text",class:"search-input",placeholder:`Search by ${N(t).area} name or ${N(t).checkpoint} name...`},null,8,J3),[[st,s.value]])])]),Pe(G3,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":c.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},Q3=Ke(X3,[["__scopeId","data-v-203f9606"]]),eP={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',roles:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15c0-4 3.5-7 8-7s8 3 8 7"/><path d="M4 15c0 1.5 3.5 3 8 3s8-1.5 8-3"/><path d="M20 15h2c.5 0 1-.5 1-1v-1c0-1-1-2-2.5-2H20"/><circle cx="12" cy="8" r="1"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},so=e=>eP[e]||"",tP={class:"responsive-tabs"},nP=["onClick"],oP=["innerHTML"],sP=["innerHTML"],aP={class:"hamburger-label"},iP=["onClick"],lP=["innerHTML"],rP={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D({}),h=D(!1),f=H(()=>n.tabs.find(T=>T.value===n.modelValue)),v=H(()=>f.value?f.value.label:"Menu"),g=()=>{if(c.value=!c.value,c.value&&i.value){const T=i.value.getBoundingClientRect();d.value={top:`${T.bottom+4}px`}}},k=T=>{s("update:modelValue",T),c.value=!1},b=T=>{if(!o.value)return;const w=o.value.contains(T.target);c.value&&!w&&(c.value=!1)},x=()=>{if(!l.value)return;const T=l.value,w=h.value;w&&(T.style.visibility="visible",T.style.position="static");const C=T.scrollWidth>T.clientWidth;w&&(T.style.visibility="",T.style.position=""),h.value=C};let A=null;return un(()=>{document.addEventListener("click",b),cn(()=>{x()}),cn(()=>{const T=l.value?.parentElement;T&&(A=new ResizeObserver(()=>{x()}),A.observe(T))})}),Sn(()=>{document.removeEventListener("click",b),A&&A.disconnect()}),Ye(()=>n.tabs,()=>{cn(()=>{x()})},{deep:!0}),(T,w)=>(p(),y("div",tP,[r("div",{ref_key:"visibleTabsRef",ref:l,class:le(["visible-tabs",{"is-hidden":h.value}])},[(p(!0),y(Ie,null,je(e.tabs,C=>(p(),y("button",{key:C.value,class:le(["tab-button",{active:e.modelValue===C.value}]),onClick:I=>T.$emit("update:modelValue",C.value),type:"button"},[C.icon?(p(),y("span",{key:0,class:"tab-icon",innerHTML:N(so)(C.icon)},null,8,oP)):P("",!0),Je(" "+_(C.label),1)],10,nP))),128))],2),r("div",{class:le(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:o},[r("button",{ref_key:"hamburgerButton",ref:i,class:le(["hamburger-button",{active:c.value}]),onClick:rt(g,["stop"]),type:"button"},[w[1]||(w[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(p(),y("span",{key:0,class:"tab-icon",innerHTML:N(so)(f.value.icon)},null,8,sP)):P("",!0),r("span",aP,_(v.value),1)],2),c.value?(p(),y("div",{key:0,class:"hamburger-dropdown",style:tt(d.value),onClick:w[0]||(w[0]=rt(()=>{},["stop"]))},[(p(!0),y(Ie,null,je(e.tabs,C=>(p(),y("button",{key:C.value,class:le(["dropdown-item",{active:e.modelValue===C.value}]),onClick:rt(I=>k(C.value),["stop"]),type:"button"},[C.icon?(p(),y("span",{key:0,class:"tab-icon",innerHTML:N(so)(C.icon)},null,8,lP)):P("",!0),Je(" "+_(C.label),1)],10,iP))),128))],4)):P("",!0)],512)],2)]))}},cP=Ke(rP,[["__scopeId","data-v-2467c6fc"]]),uP={class:"instruction"},dP={class:"share-link-container"},hP=["value"],fP={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=t,i=D(!1),l=D(null),c=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{o("close")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:`${N(n).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[r("p",uP,"Share this link with "+_(N(s).peoplePlural)+" so they can check in:",1),r("div",dP,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,hP),r("button",{onClick:c,class:"btn btn-primary"},_(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},pP=Ke(fP,[["__scopeId","data-v-b037c39b"]]);var Fl={},Xd,qv;function vP(){return qv||(qv=1,Xd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Xd}var Qd={},Ja={},jv;function rl(){if(jv)return Ja;jv=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Ja.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17},Ja.getSymbolTotalCodewords=function(s){return t[s]},Ja.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s},Ja.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');e=s},Ja.isKanjiModeEnabled=function(){return typeof e<"u"},Ja.toSJIS=function(s){return e(s)},Ja}var eh={},Wv;function Vf(){return Wv||(Wv=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},e.from=function(s,o){if(e.isValid(s))return s;try{return t(s)}catch{return o}}})(eh)),eh}var th,Zv;function mP(){if(Zv)return th;Zv=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let s=0;s<n;s++)this.putBit((t>>>n-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},th=e,th}var nh,Kv;function gP(){if(Kv)return nh;Kv=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,s,o){const i=t*this.size+n;this.data[i]=s,o&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,s){this.data[t*this.size+n]^=s},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},nh=e,nh}var oh={},Yv;function yP(){return Yv||(Yv=1,(function(e){const t=rl().getSymbolSize;e.getRowColCoords=function(s){if(s===1)return[];const o=Math.floor(s/7)+2,i=t(s),l=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let d=1;d<o-1;d++)c[d]=c[d-1]-l;return c.push(6),c.reverse()},e.getPositions=function(s){const o=[],i=e.getRowColCoords(s),l=i.length;for(let c=0;c<l;c++)for(let d=0;d<l;d++)c===0&&d===0||c===0&&d===l-1||c===l-1&&d===0||o.push([i[c],i[d]]);return o}})(oh)),oh}var sh={},Jv;function kP(){if(Jv)return sh;Jv=1;const e=rl().getSymbolSize,t=7;return sh.getPositions=function(s){const o=e(s);return[[0,0],[o-t,0],[0,o-t]]},sh}var ah={},Xv;function bP(){return Xv||(Xv=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const i=o.size;let l=0,c=0,d=0,h=null,f=null;for(let v=0;v<i;v++){c=d=0,h=f=null;for(let g=0;g<i;g++){let k=o.get(v,g);k===h?c++:(c>=5&&(l+=t.N1+(c-5)),h=k,c=1),k=o.get(g,v),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}c>=5&&(l+=t.N1+(c-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(o){const i=o.size;let l=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=o.get(c,d)+o.get(c,d+1)+o.get(c+1,d)+o.get(c+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const i=o.size;let l=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let f=0;f<i;f++)c=c<<1&2047|o.get(h,f),f>=10&&(c===1488||c===93)&&l++,d=d<<1&2047|o.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let i=0;const l=o.data.length;for(let d=0;d<l;d++)i+=o.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function n(s,o,i){switch(s){case e.Patterns.PATTERN000:return(o+i)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(o+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return o*i%2+o*i%3===0;case e.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case e.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}e.applyMask=function(o,i){const l=i.size;for(let c=0;c<l;c++)for(let d=0;d<l;d++)i.isReserved(d,c)||i.xor(d,c,n(o,d,c))},e.getBestMask=function(o,i){const l=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,o);const f=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(h,o),f<d&&(d=f,c=h)}return c}})(ah)),ah}var jc={},Qv;function L1(){if(Qv)return jc;Qv=1;const e=Vf(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return jc.getBlocksCount=function(o,i){switch(i){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},jc.getTotalCodewordsCount=function(o,i){switch(i){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},jc}var ih={},Sr={},em;function wP(){if(em)return Sr;em=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let s=1;for(let o=0;o<255;o++)e[o]=s,t[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),Sr.log=function(s){if(s<1)throw new Error("log("+s+")");return t[s]},Sr.exp=function(s){return e[s]},Sr.mul=function(s,o){return s===0||o===0?0:e[t[s]+t[o]]},Sr}var tm;function _P(){return tm||(tm=1,(function(e){const t=wP();e.mul=function(s,o){const i=new Uint8Array(s.length+o.length-1);for(let l=0;l<s.length;l++)for(let c=0;c<o.length;c++)i[l+c]^=t.mul(s[l],o[c]);return i},e.mod=function(s,o){let i=new Uint8Array(s);for(;i.length-o.length>=0;){const l=i[0];for(let d=0;d<o.length;d++)i[d]^=t.mul(o[d],l);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(s){let o=new Uint8Array([1]);for(let i=0;i<s;i++)o=e.mul(o,new Uint8Array([1,t.exp(i)]));return o}})(ih)),ih}var lh,nm;function CP(){if(nm)return lh;nm=1;const e=_P();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(s){this.degree=s,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const i=e.mod(o,this.genPoly),l=this.degree-i.length;if(l>0){const c=new Uint8Array(this.degree);return c.set(i,l),c}return i},lh=t,lh}var rh={},ch={},uh={},om;function I1(){return om||(om=1,uh.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),uh}var Hs={},sm;function S1(){if(sm)return Hs;sm=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Hs.KANJI=new RegExp(n,"g"),Hs.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Hs.BYTE=new RegExp(s,"g"),Hs.NUMERIC=new RegExp(e,"g"),Hs.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Hs.testKanji=function(d){return o.test(d)},Hs.testNumeric=function(d){return i.test(d)},Hs.testAlphanumeric=function(d){return l.test(d)},Hs}var am;function cl(){return am||(am=1,(function(e){const t=I1(),n=S1();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return n.testNumeric(i)?e.NUMERIC:n.testAlphanumeric(i)?e.ALPHANUMERIC:n.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(i,l){if(e.isValid(i))return i;try{return s(i)}catch{return l}}})(ch)),ch}var im;function LP(){return im||(im=1,(function(e){const t=rl(),n=L1(),s=Vf(),o=cl(),i=I1(),l=7973,c=t.getBCHDigit(l);function d(g,k,b){for(let x=1;x<=40;x++)if(k<=e.getCapacity(x,b,g))return x}function h(g,k){return o.getCharCountIndicator(g,k)+4}function f(g,k){let b=0;return g.forEach(function(x){const A=h(x.mode,k);b+=A+x.getBitsLength()}),b}function v(g,k){for(let b=1;b<=40;b++)if(f(g,b)<=e.getCapacity(b,k,o.MIXED))return b}e.from=function(k,b){return i.isValid(k)?parseInt(k,10):b},e.getCapacity=function(k,b,x){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=o.BYTE);const A=t.getSymbolTotalCodewords(k),T=n.getTotalCodewordsCount(k,b),w=(A-T)*8;if(x===o.MIXED)return w;const C=w-h(x,k);switch(x){case o.NUMERIC:return Math.floor(C/10*3);case o.ALPHANUMERIC:return Math.floor(C/11*2);case o.KANJI:return Math.floor(C/13);case o.BYTE:default:return Math.floor(C/8)}},e.getBestVersionForData=function(k,b){let x;const A=s.from(b,s.M);if(Array.isArray(k)){if(k.length>1)return v(k,A);if(k.length===0)return 1;x=k[0]}else x=k;return d(x.mode,x.getLength(),A)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let b=k<<12;for(;t.getBCHDigit(b)-c>=0;)b^=l<<t.getBCHDigit(b)-c;return k<<12|b}})(rh)),rh}var dh={},lm;function IP(){if(lm)return dh;lm=1;const e=rl(),t=1335,n=21522,s=e.getBCHDigit(t);return dh.getEncodedBits=function(i,l){const c=i.bit<<3|l;let d=c<<10;for(;e.getBCHDigit(d)-s>=0;)d^=t<<e.getBCHDigit(d)-s;return(c<<10|d)^n},dh}var hh={},fh,rm;function SP(){if(rm)return fh;rm=1;const e=cl();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){let o,i,l;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),l=parseInt(i,10),s.put(l,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),l=parseInt(i,10),s.put(l,c*3+1))},fh=t,fh}var ph,cm;function xP(){if(cm)return ph;cm=1;const e=cl(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(s){this.mode=e.ALPHANUMERIC,this.data=s}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[i]),6)},ph=n,ph}var vh,um;function $P(){if(um)return vh;um=1;const e=cl();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(s){return s*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)},vh=t,vh}var mh,dm;function TP(){if(dm)return mh;dm=1;const e=cl(),t=rl();function n(s){this.mode=e.KANJI,this.data=s}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let o;for(o=0;o<this.data.length;o++){let i=t.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),s.put(i,13)}},mh=n,mh}var gh={exports:{}},hm;function MP(){return hm||(hm=1,(function(e){var t={single_source_shortest_paths:function(n,s,o){var i={},l={};l[s]=0;var c=t.PriorityQueue.make();c.push(s,0);for(var d,h,f,v,g,k,b,x,A;!c.empty();){d=c.pop(),h=d.value,v=d.cost,g=n[h]||{};for(f in g)g.hasOwnProperty(f)&&(k=g[f],b=v+k,x=l[f],A=typeof l[f]>"u",(A||x>b)&&(l[f]=b,c.push(f,b),i[f]=h))}if(typeof o<"u"&&typeof l[o]>"u"){var T=["Could not find a path from ",s," to ",o,"."].join("");throw new Error(T)}return i},extract_shortest_path_from_predecessor_list:function(n,s){for(var o=[],i=s;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,s,o){var i=t.single_source_shortest_paths(n,s,o);return t.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var s=t.PriorityQueue,o={},i;n=n||{};for(i in s)s.hasOwnProperty(i)&&(o[i]=s[i]);return o.queue=[],o.sorter=n.sorter||s.default_sorter,o},default_sorter:function(n,s){return n.cost-s.cost},push:function(n,s){var o={value:n,cost:s};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(gh)),gh.exports}var fm;function AP(){return fm||(fm=1,(function(e){const t=cl(),n=SP(),s=xP(),o=$P(),i=TP(),l=S1(),c=rl(),d=MP();function h(T){return unescape(encodeURIComponent(T)).length}function f(T,w,C){const I=[];let $;for(;($=T.exec(C))!==null;)I.push({data:$[0],index:$.index,mode:w,length:$[0].length});return I}function v(T){const w=f(l.NUMERIC,t.NUMERIC,T),C=f(l.ALPHANUMERIC,t.ALPHANUMERIC,T);let I,$;return c.isKanjiModeEnabled()?(I=f(l.BYTE,t.BYTE,T),$=f(l.KANJI,t.KANJI,T)):(I=f(l.BYTE_KANJI,t.BYTE,T),$=[]),w.concat(C,I,$).sort(function(M,O){return M.index-O.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function g(T,w){switch(w){case t.NUMERIC:return n.getBitsLength(T);case t.ALPHANUMERIC:return s.getBitsLength(T);case t.KANJI:return i.getBitsLength(T);case t.BYTE:return o.getBitsLength(T)}}function k(T){return T.reduce(function(w,C){const I=w.length-1>=0?w[w.length-1]:null;return I&&I.mode===C.mode?(w[w.length-1].data+=C.data,w):(w.push(C),w)},[])}function b(T){const w=[];for(let C=0;C<T.length;C++){const I=T[C];switch(I.mode){case t.NUMERIC:w.push([I,{data:I.data,mode:t.ALPHANUMERIC,length:I.length},{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.ALPHANUMERIC:w.push([I,{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.KANJI:w.push([I,{data:I.data,mode:t.BYTE,length:h(I.data)}]);break;case t.BYTE:w.push([{data:I.data,mode:t.BYTE,length:h(I.data)}])}}return w}function x(T,w){const C={},I={start:{}};let $=["start"];for(let R=0;R<T.length;R++){const M=T[R],O=[];for(let E=0;E<M.length;E++){const U=M[E],F=""+R+E;O.push(F),C[F]={node:U,lastCount:0},I[F]={};for(let j=0;j<$.length;j++){const Z=$[j];C[Z]&&C[Z].node.mode===U.mode?(I[Z][F]=g(C[Z].lastCount+U.length,U.mode)-g(C[Z].lastCount,U.mode),C[Z].lastCount+=U.length):(C[Z]&&(C[Z].lastCount=U.length),I[Z][F]=g(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,w))}}$=O}for(let R=0;R<$.length;R++)I[$[R]].end=0;return{map:I,table:C}}function A(T,w){let C;const I=t.getBestModeForData(T);if(C=t.from(w,I),C!==t.BYTE&&C.bit<I.bit)throw new Error('"'+T+'" cannot be encoded with mode '+t.toString(C)+`.
 Suggested mode is: `+t.toString(I));switch(C===t.KANJI&&!c.isKanjiModeEnabled()&&(C=t.BYTE),C){case t.NUMERIC:return new n(T);case t.ALPHANUMERIC:return new s(T);case t.KANJI:return new i(T);case t.BYTE:return new o(T)}}e.fromArray=function(w){return w.reduce(function(C,I){return typeof I=="string"?C.push(A(I,null)):I.data&&C.push(A(I.data,I.mode)),C},[])},e.fromString=function(w,C){const I=v(w,c.isKanjiModeEnabled()),$=b(I),R=x($,C),M=d.find_path(R.map,"start","end"),O=[];for(let E=1;E<M.length-1;E++)O.push(R.table[M[E]].node);return e.fromArray(k(O))},e.rawSplit=function(w){return e.fromArray(v(w,c.isKanjiModeEnabled()))}})(hh)),hh}var pm;function EP(){if(pm)return Qd;pm=1;const e=rl(),t=Vf(),n=mP(),s=gP(),o=yP(),i=kP(),l=bP(),c=L1(),d=CP(),h=LP(),f=IP(),v=cl(),g=AP();function k(R,M){const O=R.size,E=i.getPositions(M);for(let U=0;U<E.length;U++){const F=E[U][0],j=E[U][1];for(let Z=-1;Z<=7;Z++)if(!(F+Z<=-1||O<=F+Z))for(let Q=-1;Q<=7;Q++)j+Q<=-1||O<=j+Q||(Z>=0&&Z<=6&&(Q===0||Q===6)||Q>=0&&Q<=6&&(Z===0||Z===6)||Z>=2&&Z<=4&&Q>=2&&Q<=4?R.set(F+Z,j+Q,!0,!0):R.set(F+Z,j+Q,!1,!0))}}function b(R){const M=R.size;for(let O=8;O<M-8;O++){const E=O%2===0;R.set(O,6,E,!0),R.set(6,O,E,!0)}}function x(R,M){const O=o.getPositions(M);for(let E=0;E<O.length;E++){const U=O[E][0],F=O[E][1];for(let j=-2;j<=2;j++)for(let Z=-2;Z<=2;Z++)j===-2||j===2||Z===-2||Z===2||j===0&&Z===0?R.set(U+j,F+Z,!0,!0):R.set(U+j,F+Z,!1,!0)}}function A(R,M){const O=R.size,E=h.getEncodedBits(M);let U,F,j;for(let Z=0;Z<18;Z++)U=Math.floor(Z/3),F=Z%3+O-8-3,j=(E>>Z&1)===1,R.set(U,F,j,!0),R.set(F,U,j,!0)}function T(R,M,O){const E=R.size,U=f.getEncodedBits(M,O);let F,j;for(F=0;F<15;F++)j=(U>>F&1)===1,F<6?R.set(F,8,j,!0):F<8?R.set(F+1,8,j,!0):R.set(E-15+F,8,j,!0),F<8?R.set(8,E-F-1,j,!0):F<9?R.set(8,15-F-1+1,j,!0):R.set(8,15-F-1,j,!0);R.set(E-8,8,1,!0)}function w(R,M){const O=R.size;let E=-1,U=O-1,F=7,j=0;for(let Z=O-1;Z>0;Z-=2)for(Z===6&&Z--;;){for(let Q=0;Q<2;Q++)if(!R.isReserved(U,Z-Q)){let re=!1;j<M.length&&(re=(M[j]>>>F&1)===1),R.set(U,Z-Q,re),F--,F===-1&&(j++,F=7)}if(U+=E,U<0||O<=U){U-=E,E=-E;break}}}function C(R,M,O){const E=new n;O.forEach(function(Q){E.put(Q.mode.bit,4),E.put(Q.getLength(),v.getCharCountIndicator(Q.mode,R)),Q.write(E)});const U=e.getSymbolTotalCodewords(R),F=c.getTotalCodewordsCount(R,M),j=(U-F)*8;for(E.getLengthInBits()+4<=j&&E.put(0,4);E.getLengthInBits()%8!==0;)E.putBit(0);const Z=(j-E.getLengthInBits())/8;for(let Q=0;Q<Z;Q++)E.put(Q%2?17:236,8);return I(E,R,M)}function I(R,M,O){const E=e.getSymbolTotalCodewords(M),U=c.getTotalCodewordsCount(M,O),F=E-U,j=c.getBlocksCount(M,O),Z=E%j,Q=j-Z,re=Math.floor(E/j),K=Math.floor(F/j),ae=K+1,q=re-K,J=new d(q);let ee=0;const ue=new Array(j),_e=new Array(j);let $e=0;const De=new Uint8Array(R.buffer);for(let de=0;de<j;de++){const ie=de<Q?K:ae;ue[de]=De.slice(ee,ee+ie),_e[de]=J.encode(ue[de]),ee+=ie,$e=Math.max($e,ie)}const Re=new Uint8Array(E);let be=0,z,Y;for(z=0;z<$e;z++)for(Y=0;Y<j;Y++)z<ue[Y].length&&(Re[be++]=ue[Y][z]);for(z=0;z<q;z++)for(Y=0;Y<j;Y++)Re[be++]=_e[Y][z];return Re}function $(R,M,O,E){let U;if(Array.isArray(R))U=g.fromArray(R);else if(typeof R=="string"){let re=M;if(!re){const K=g.rawSplit(R);re=h.getBestVersionForData(K,O)}U=g.fromString(R,re||40)}else throw new Error("Invalid data");const F=h.getBestVersionForData(U,O);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!M)M=F;else if(M<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const j=C(M,O,U),Z=e.getSymbolSize(M),Q=new s(Z);return k(Q,M),b(Q),x(Q,M),T(Q,O,0),M>=7&&A(Q,M),w(Q,j),isNaN(E)&&(E=l.getBestMask(Q,T.bind(null,Q,O))),l.applyMask(E,Q),T(Q,O,E),{modules:Q,version:M,errorCorrectionLevel:O,maskPattern:E,segments:U}}return Qd.create=function(M,O){if(typeof M>"u"||M==="")throw new Error("No input text");let E=t.M,U,F;return typeof O<"u"&&(E=t.from(O.errorCorrectionLevel,t.M),U=h.from(O.version),F=l.from(O.maskPattern),O.toSJISFunc&&e.setToSJISFunction(O.toSJISFunc)),$(M,U,E,F)},Qd}var yh={},kh={},vm;function x1(){return vm||(vm=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let s=n.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+n);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const o=parseInt(s.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+s.slice(0,6).join("")}}e.getOptions=function(s){s||(s={}),s.color||(s.color={});const o=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,l=s.scale||4;return{width:i,scale:i?4:l,margin:o,color:{dark:t(s.color.dark||"#000000ff"),light:t(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},e.getScale=function(s,o){return o.width&&o.width>=s+o.margin*2?o.width/(s+o.margin*2):o.scale},e.getImageWidth=function(s,o){const i=e.getScale(s,o);return Math.floor((s+o.margin*2)*i)},e.qrToImageData=function(s,o,i){const l=o.modules.size,c=o.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,v=[i.color.light,i.color.dark];for(let g=0;g<h;g++)for(let k=0;k<h;k++){let b=(g*h+k)*4,x=i.color.light;if(g>=f&&k>=f&&g<h-f&&k<h-f){const A=Math.floor((g-f)/d),T=Math.floor((k-f)/d);x=v[c[A*l+T]?1:0]}s[b++]=x.r,s[b++]=x.g,s[b++]=x.b,s[b]=x.a}}})(kh)),kh}var mm;function PP(){return mm||(mm=1,(function(e){const t=x1();function n(o,i,l){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,c){let d=c,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=s()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),v=h.getContext("2d"),g=v.createImageData(f,f);return t.qrToImageData(g.data,i,d),n(v,h,f),v.putImageData(g,0,0),h},e.renderToDataURL=function(i,l,c){let d=c;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",v=d.rendererOpts||{};return h.toDataURL(f,v.quality)}})(yh)),yh}var bh={},gm;function DP(){if(gm)return bh;gm=1;const e=x1();function t(o,i){const l=o.a/255,c=i+'="'+o.hex+'"';return l<1?c+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':c}function n(o,i,l){let c=o+i;return typeof l<"u"&&(c+=" "+l),c}function s(o,i,l){let c="",d=0,h=!1,f=0;for(let v=0;v<o.length;v++){const g=Math.floor(v%i),k=Math.floor(v/i);!g&&!h&&(h=!0),o[v]?(f++,v>0&&g>0&&o[v-1]||(c+=h?n("M",g+l,.5+k+l):n("m",d,0),d=0,h=!1),g+1<i&&o[v+1]||(c+=n("h",f),f=0)):d++}return c}return bh.render=function(i,l,c){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,v=h+d.margin*2,g=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+v+"v"+v+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+s(f,h,d.margin)+'"/>',b='viewBox="0 0 '+v+" "+v+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+b+' shape-rendering="crispEdges">'+g+k+`</svg>
`;return typeof c=="function"&&c(null,A),A},bh}var ym;function RP(){if(ym)return Fl;ym=1;const e=vP(),t=EP(),n=PP(),s=DP();function o(i,l,c,d,h){const f=[].slice.call(arguments,1),v=f.length,g=typeof f[v-1]=="function";if(!g&&!e())throw new Error("Callback required as last argument");if(g){if(v<2)throw new Error("Too few arguments provided");v===2?(h=c,c=l,l=d=void 0):v===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=c,c=l,l=void 0))}else{if(v<1)throw new Error("Too few arguments provided");return v===1?(c=l,l=d=void 0):v===2&&!l.getContext&&(d=c,c=l,l=void 0),new Promise(function(k,b){try{const x=t.create(c,d);k(i(x,l,d))}catch(x){b(x)}})}try{const k=t.create(c,d);h(null,i(k,l,d))}catch(k){h(k)}}return Fl.create=t.create,Fl.toCanvas=o.bind(null,n.render),Fl.toDataURL=o.bind(null,n.renderToDataURL),Fl.toString=o.bind(null,function(i,l,c){return s.render(i,c)}),Fl}var OP=RP();const BP=a1(OP),NP={class:"qr-container"},FP={key:0,class:"qr-warning"},UP={key:1,class:"error-text"},zP={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3},warning:{type:String,default:""}},emits:["close"],setup(e){const t=e,n=D(null),s=D(""),o=async()=>{if(!(!n.value||!t.url)){s.value="";try{await BP.toCanvas(n.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),s.value="Failed to generate QR code"}}};return Ye(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(o,50)},{immediate:!0}),(i,l)=>(p(),Ge(Yt,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=c=>i.$emit("close"))},{actions:Ve(()=>[r("button",{onClick:l[0]||(l[0]=c=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",NP,[e.warning?(p(),y("p",FP,_(e.warning),1)):P("",!0),r("canvas",{ref_key:"canvasRef",ref:n,class:"qr-canvas"},null,512),s.value?(p(),y("p",UP,_(s.value),1)):P("",!0)])]),_:1},8,["show","title","z-index"]))}},Gf=Ke(zP,[["__scopeId","data-v-401727ed"]]),HP={class:"success-content"},VP={class:"success-message"},GP={class:"link-section"},qP={class:"help-text"},jP={key:0,class:"loading-text"},WP={key:1,class:"magic-link-container"},ZP=["value"],KP={class:"magic-link-actions"},YP=["disabled"],JP={key:0,class:"success-text"},XP={key:1,class:"error-text"},QP={key:2,class:"error-text"},e6={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(""),l=D(!1),c=D(!1),d=D(""),h=D(!1),f=D(!1),v=D(!1),g=D(""),k=D(!1),b=async()=>{if(!(!s.eventId||!s.marshalId)){c.value=!0,d.value="";try{const w=await bs.getMagicLink(s.eventId,s.marshalId);i.value=w.data.magicLink,l.value=w.data.hasEmail}catch(w){console.error("Failed to fetch magic link:",w),d.value="Failed to load login link"}finally{c.value=!1}}},x=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const w=document.createElement("textarea");w.value=i.value,w.style.position="fixed",w.style.left="-9999px",document.body.appendChild(w),w.select(),document.execCommand("copy"),document.body.removeChild(w)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(w){console.error("Failed to copy:",w)}},A=async()=>{if(!(!s.eventId||!s.marshalId)){f.value=!0,v.value=!1,g.value="";try{await bs.sendMagicLink(s.eventId,s.marshalId),v.value=!0,setTimeout(()=>{v.value=!1},3e3)}catch(w){console.error("Failed to send email:",w),g.value=w.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},T=()=>{o("close")};return Ye(()=>s.show,w=>{w&&s.marshalId?b():(i.value="",l.value=!1,d.value="",h.value=!1,v.value=!1,g.value="",k.value=!1)},{immediate:!0}),(w,C)=>(p(),y(Ie,null,[Pe(Yt,{show:e.show,title:`${N(n).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:T},{actions:Ve(()=>[r("button",{onClick:T,class:"btn btn-primary"},"Done")]),default:Ve(()=>[r("div",HP,[C[4]||(C[4]=r("div",{class:"success-icon"},"",-1)),r("p",VP,[r("strong",null,_(e.marshalName),1),C[3]||(C[3]=Je(" has been added successfully. ",-1))])]),r("div",GP,[C[6]||(C[6]=r("label",null,"Login link",-1)),r("p",qP," Share this unique link with "+_(e.marshalName)+" so they can access their dashboard and check in. ",1),c.value?(p(),y("div",jP,"Loading link...")):i.value?(p(),y("div",WP,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:C[0]||(C[0]=I=>I.target.select())},null,40,ZP),r("div",KP,[r("button",{type:"button",class:"btn btn-secondary",onClick:x},_(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:C[1]||(C[1]=I=>k.value=!0),title:"Show QR code"},[...C[5]||(C[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(p(),y("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:A},_(f.value?"Sending...":"Send via email"),9,YP)):P("",!0)]),v.value?(p(),y("p",JP,"Email sent successfully!")):P("",!0),g.value?(p(),y("p",XP,_(g.value),1)):P("",!0)])):d.value?(p(),y("div",QP,_(d.value),1)):P("",!0)])]),_:1},8,["show","title"]),Pe(Gf,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:C[2]||(C[2]=I=>k.value=!1)},null,8,["show","url"])],64))}},t6=Ke(e6,[["__scopeId","data-v-9aa97b04"]]),n6={class:"form-group"},o6={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D("");Ye(()=>n.show,d=>{d||(o.value="")});const i=()=>{s("update:isDirty",!0)},l=()=>{s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),Ge(Yt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ve(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",n6,[h[1]||(h[1]=r("label",null,"Email address",-1)),We(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,o.value]])])],32)]),_:1},8,["show","is-dirty"]))}},s6=Ke(o6,[["__scopeId","data-v-a82da194"]]),a6={class:"form-group"},i6={key:0,class:"error"},l6=["disabled"],r6={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(null);Ye(()=>n.show,d=>{d||(o.value=null)});const i=d=>{o.value=d.target.files[0],s("update:isDirty",!0)},l=()=>{o.value&&s("submit",o.value)},c=()=>{s("close")};return(d,h)=>(p(),Ge(Yt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},_(e.uploading?"Uploading...":"Upload route"),9,l6)]),default:Ve(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",a6,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(p(),y("div",i6,_(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},c6=Ke(r6,[["__scopeId","data-v-317975db"]]),u6={class:"instruction"},d6={class:"form-group"},h6={class:"form-group"},f6={class:"checkbox-label"},p6={key:0,class:"error"},v6={key:1,class:"import-result"},m6={key:0,class:"import-errors"},g6=["disabled"],y6={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(null),c=D(!1);Ye(()=>o.show,g=>{g||(l.value=null,c.value=!1)});const d=g=>{l.value=g.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:c.value})},v=()=>{i("close")};return(g,k)=>(p(),Ge(Yt,{show:e.show,title:`Import ${N(s).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:v},{actions:Ve(()=>[r("button",{type:"button",onClick:v,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${N(s).checkpoints}`),9,g6)]),default:Ve(()=>[r("p",u6,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+_(N(n).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:rt(f,["prevent"])},[r("div",d6,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",h6,[r("label",f6,[We(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=b=>c.value=b),onChange:h},null,544),[[$s,c.value]]),Je(" Delete existing "+_(N(s).checkpoints)+" before import ",1)])]),e.error?(p(),y("div",p6,_(e.error),1)):P("",!0),e.result?(p(),y("div",v6,[r("p",null,"Created "+_(e.result.locationsCreated)+" "+_(N(s).checkpoints)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),y("div",m6,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),y(Ie,null,je(e.result.errors,(b,x)=>(p(),y("li",{key:x},_(b),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},k6=Ke(y6,[["__scopeId","data-v-75c79d31"]]),b6={class:"instruction"},w6={class:"form-group"},_6={key:0,class:"error"},C6={key:1,class:"import-result"},L6={key:0,class:"import-errors"},I6=["disabled"],S6={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(null);Ye(()=>o.show,f=>{f||(l.value=null)});const c=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,v)=>(p(),Ge(Yt,{show:e.show,title:`Import ${N(s).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Ve(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${N(s).people}`),9,I6)]),default:Ve(()=>[r("p",b6,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+_(N(n).checkpoint)+" (optional)",1),v[2]||(v[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:rt(d,["prevent"])},[r("div",w6,[v[0]||(v[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:c,required:"",class:"form-input"},null,32)]),e.error?(p(),y("div",_6,_(e.error),1)):P("",!0),e.result?(p(),y("div",C6,[r("p",null,"Imported "+_(e.result.marshalsCreated)+" "+_(N(s).people)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),y("div",L6,[v[1]||(v[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),y(Ie,null,je(e.result.errors,(g,k)=>(p(),y("li",{key:k},_(g),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},x6=Ke(S6,[["__scopeId","data-v-be89bf1f"]]),$6=["onClick"],T6=["innerHTML"],M6={class:"hamburger-nav"},A6=["disabled"],E6=["innerHTML"],P6={class:"current-tab-label"},D6=["disabled"],R6={key:0,class:"hamburger-menu"},O6=["onClick"],B6=["innerHTML"],N6=400,F6={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(null),l=D(null),c=D(!1),d=D(!1),h=H(()=>{const $=n.tabs.find(R=>R.value===n.modelValue);return $?$.label:""}),f=H(()=>n.tabs.find(R=>R.value===n.modelValue)?.icon||null),v=H(()=>n.tabs.findIndex($=>$.value===n.modelValue)),g=H(()=>v.value>0),k=H(()=>v.value<n.tabs.length-1),b=()=>{g.value&&s("update:modelValue",n.tabs[v.value-1].value)},x=()=>{k.value&&s("update:modelValue",n.tabs[v.value+1].value)},A=()=>{if(!o.value)return;const $=o.value.clientWidth;if($<N6){c.value=!0;return}if(i.value&&!c.value){i.value.scrollWidth>$&&(c.value=!0);return}const R=n.tabs.some(E=>E.icon)?110:90,M=n.tabs.length*R,O=(n.tabs.length-1)*8;M+O<=$&&(c.value=!1,cn(()=>{i.value&&i.value.scrollWidth>$&&(c.value=!0)}))},T=()=>{d.value=!d.value},w=$=>{s("update:modelValue",$),d.value=!1},C=$=>{l.value&&!l.value.contains($.target)&&(d.value=!1)};let I=null;return un(()=>{cn(()=>{A(),o.value&&typeof ResizeObserver<"u"&&(I=new ResizeObserver(()=>{A()}),I.observe(o.value)),document.addEventListener("click",C)})}),Sn(()=>{I&&I.disconnect(),document.removeEventListener("click",C)}),Ye(()=>n.tabs,()=>{cn(()=>{A()})},{deep:!0}),($,R)=>(p(),y("div",{class:"tabs-container",ref_key:"containerRef",ref:o},[c.value?(p(),y("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",M6,[r("button",{class:le(["nav-arrow",{invisible:!g.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!g.value},"  ",10,A6),r("button",{class:"hamburger-button",onClick:T,type:"button","aria-label":"Tab menu"},[f.value?(p(),y("span",{key:0,class:"current-tab-icon",innerHTML:N(so)(f.value)},null,8,E6)):P("",!0),r("span",P6,_(h.value),1),R[0]||(R[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:le(["nav-arrow",{invisible:!k.value}]),onClick:x,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,D6)]),d.value?(p(),y("div",R6,[(p(!0),y(Ie,null,je(e.tabs,M=>(p(),y("button",{key:M.value,class:le(["menu-item",{active:e.modelValue===M.value}]),onClick:O=>w(M.value),type:"button"},[M.icon?(p(),y("span",{key:0,class:"tab-icon",innerHTML:N(so)(M.icon)},null,8,B6)):P("",!0),Je(" "+_(M.label),1)],10,O6))),128))])):P("",!0)],512)):(p(),y("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(p(!0),y(Ie,null,je(e.tabs,M=>(p(),y("button",{key:M.value,class:le(["tab-button",{active:e.modelValue===M.value}]),onClick:O=>$.$emit("update:modelValue",M.value),type:"button"},[M.icon?(p(),y("span",{key:0,class:"tab-icon",innerHTML:N(so)(M.icon)},null,8,T6)):P("",!0),Je(" "+_(M.label),1)],10,$6))),128))],512))],512))}},ul=Ke(F6,[["__scopeId","data-v-736c5d0a"]]),U6={class:"tab-content"},z6={class:"form-group"},H6=["value"],V6={class:"form-group"},G6=["value"],q6={class:"form-group"},j6={class:"area-display"},W6={key:0,class:"no-area"},Z6={class:"form-help"},K6={class:"form-group checkbox-group"},Y6={class:"checkbox-label"},J6=["checked"],X6={class:"form-help"},Q6={key:0,class:"custom-times-section"},eD={class:"form-group"},tD=["value"],nD={class:"form-help"},oD={class:"form-group"},sD=["value"],aD={class:"form-help"},iD={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>(n.form.areaIds||n.form.AreaIds||[]).map(d=>n.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(c,d)=>{s("update:form",{...n.form,[c]:d}),s("input")},l=c=>{const d={...n.form,useCustomTimes:c};if(!c)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&n.eventDate){const h=cc(n.eventDate);d.startTime=h,d.endTime=h}s("update:form",d),s("input")};return(c,d)=>(p(),y("div",U6,[r("form",{onSubmit:d[5]||(d[5]=rt(h=>c.$emit("save"),["prevent"]))},[r("div",z6,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,H6)]),r("div",V6,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,G6)]),r("div",q6,[r("label",null,_(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",j6,[o.value.length===0?(p(),y("span",W6," Not in any "+_(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(p(!0),y(Ie,null,je(o.value,h=>(p(),y("span",{key:h.id,class:"area-badge",style:tt({backgroundColor:h.color||"var(--brand-primary)"})},_(h.name),5))),128))]),r("small",Z6,_(e.areaTermPlural)+" are automatically assigned based on "+_(e.checkpointTermSingular.toLowerCase())+" location within "+_(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",K6,[r("label",Y6,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,J6),r("span",null,"Use custom date/time for this "+_(e.checkpointTermSingular.toLowerCase()),1)]),r("small",X6," By default, "+_(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(p(),y("div",Q6,[r("div",eD,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,tD),r("small",nD," When "+_(e.peopleTermPlural.toLowerCase())+" should arrive at this "+_(e.checkpointTermSingular.toLowerCase()),1)]),r("div",oD,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,sD),r("small",aD," When "+_(e.peopleTermPlural.toLowerCase())+" can leave this "+_(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},lD=Ke(iD,[["__scopeId","data-v-aa628901"]]),rD={class:"scope-configuration-editor"},cD={class:"editor-header"},uD={class:"scope-types-list"},dD=["onClick"],hD={class:"scope-type-label"},fD={class:"scope-type-pill"},pD={class:"expand-label"},vD={class:"expand-icon"},mD={class:"modal-content"},gD={class:"modal-header"},yD={class:"modal-body"},kD={class:"scope-help"},bD={key:0,class:"form-group"},wD={class:"checkbox-label special-option"},_D=["checked"],CD={key:0,class:"specific-selection"},LD=["placeholder"],ID={class:"checkbox-group scrollable"},SD=["checked","onChange"],xD={key:1,class:"form-group"},$D={class:"checkbox-label special-option"},TD=["checked"],MD={key:0,class:"specific-selection"},AD={class:"checkbox-group scrollable"},ED=["checked","onChange"],PD={key:2,class:"form-group"},DD={class:"checkbox-label special-option"},RD=["checked"],OD={key:0,class:"specific-selection"},BD=["placeholder"],ND={class:"checkbox-group scrollable"},FD={key:0,class:"checkbox-label this-checkpoint-option"},UD=["checked"],zD={class:"checkpoint-info"},HD={class:"checkpoint-name"},VD=["checked","onChange"],GD={class:"checkpoint-info"},qD={class:"checkpoint-name"},jD={key:0,class:"checkpoint-description"},WD={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>[{scope:"SpecificPeople",label:`Specific ${n.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${n.value.person} at specified ${n.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${n.value.person} at each specified ${n.value.checkpoint}`},{scope:"OnePerArea",label:`One ${n.value.person} in specified ${n.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${n.value.areas}`},{scope:"EveryAreaLead",label:`Every ${n.value.area} lead at specified ${n.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${n.value.area}`}]),l=D({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),c=D(null),d=D(""),h=D(""),f=D(!s.isEditing);let v=!0,g=!1;const k=H(()=>i.value.filter(ie=>!s.excludeScopes.includes(ie.scope))),b=H(()=>f.value?k.value:k.value.filter(ie=>U(ie.scope))),x=H(()=>k.value.filter(Ae=>U(Ae.scope)).length<k.value.length),A=H(()=>{const ie=k.value.filter(Ae=>U(Ae.scope)).length;return k.value.length-ie}),T=H(()=>!s.currentCheckpointId&&s.intent==="location-update");Ye(()=>s.modelValue,ie=>{if(ie){if(g){g=!1;return}v=!0,Object.keys(l.value).forEach(Ae=>{l.value[Ae]={enabled:!1,ids:[]}}),ie.forEach(Ae=>{Ae.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Ae.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Ae.ids]}:l.value[Ae.scope]&&(l.value[Ae.scope]={enabled:!0,ids:[...Ae.ids]})}),v=!1}},{immediate:!0});const w=()=>{const ie=[];return Object.keys(l.value).forEach(Ae=>{const G=l.value[Ae];if(G.enabled){const X={scope:Ae,itemType:C(Ae),ids:[...G.ids]};ie.push(X)}}),ie};Ye(l,()=>{if(v)return;if(Object.keys(l.value).some(G=>G!=="SpecificPeople"&&l.value[G].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const G=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(G,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}g=!0;const Ae=w();o("update:modelValue",Ae),o("user-changed")},{deep:!0});const C=ie=>I(ie)?"Area":$(ie)?"Checkpoint":R(ie)?"Marshal":null,I=ie=>ie==="EveryoneInAreas"||ie==="OnePerArea"||ie==="EveryAreaLead"||ie==="OneLeadPerArea",$=ie=>ie==="EveryoneAtCheckpoints"||ie==="OnePerCheckpoint",R=ie=>ie==="SpecificPeople",M=ie=>{const Ae=i.value.find(G=>G.scope===ie);return Ae?Ae.label:ie},O=H(()=>s.headerText?s.headerText:s.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${n.value.checklist}?`),E=ie=>s.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${n.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${n.value.person} at each selected ${n.value.checkpoint} can update the location`,OnePerArea:`Any ${n.value.person} in each selected ${n.value.area} can update the location`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} can update the location`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} can update the location`,OneLeadPerArea:`Any ${n.value.area} lead at the selected ${n.value.areas} can update the location`}[ie]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${n.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${n.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${n.value.area} (shared completion)`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${n.value.area}, only ${n.value.area} leads can complete (shared among leads)`}[ie]||"",U=ie=>l.value[ie]?.enabled||!1,F=ie=>{const Ae=l.value[ie];if(!Ae||!Ae.enabled)return"No";const G=Ae.ids||[];if(I(ie)){if(G.includes("ALL_AREAS"))return`All ${n.value.areas}`;const X=G.length;return X>0?`${X} ${X!==1?n.value.areas:n.value.area}`:`Select ${n.value.areas}...`}if($(ie)){if(G.includes("ALL_CHECKPOINTS"))return`All ${n.value.checkpoints}`;if(G.length===1&&G[0]==="THIS_CHECKPOINT")return`This ${n.value.checkpoint}`;const X=G.length;return X>0?`${X} ${X!==1?n.value.checkpoints:n.value.checkpoint}`:`Select ${n.value.checkpoints}...`}if(R(ie)){if(G.includes("ALL_MARSHALS"))return"Everyone";const X=G.length;return X>0?`${X} ${X!==1?n.value.people:n.value.person}`:`Select ${n.value.people}...`}return"Configured"},j=ie=>{c.value=ie,d.value="",h.value=""},Z=()=>{c.value=null},Q=()=>{c.value&&(l.value[c.value]={enabled:!1,ids:[]}),Z()},re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_MARSHALS"),K=()=>{if(!c.value)return;const ie=l.value[c.value];re()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_MARSHALS"],ie.enabled=!0)},ae=ie=>c.value&&l.value[c.value]?.ids.includes(ie),q=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},J=()=>{let ie=s.marshals;if(h.value){const G=h.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(G)||X.email&&X.email.toLowerCase().includes(G))}const Ae=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,X)=>{const te=Ae.includes(G.id),Ce=Ae.includes(X.id);return te&&!Ce?-1:!te&&Ce?1:G.name.localeCompare(X.name,void 0,{sensitivity:"base"})})},ee=()=>c.value&&l.value[c.value]?.ids.includes("ALL_AREAS"),ue=()=>{if(!c.value)return;const ie=l.value[c.value];ee()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_AREAS"],ie.enabled=!0)},_e=ie=>c.value&&l.value[c.value]?.ids.includes(ie),$e=()=>{const ie=c.value?l.value[c.value]?.ids||[]:[];return[...s.areas].sort((Ae,G)=>{const X=ie.includes(Ae.id),te=ie.includes(G.id);return X&&!te?-1:!X&&te?1:Ae.name.localeCompare(G.name,void 0,{sensitivity:"base"})})},De=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},Re=()=>c.value&&l.value[c.value]?.ids.includes("ALL_CHECKPOINTS"),be=()=>{if(!c.value)return;const ie=l.value[c.value];Re()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_CHECKPOINTS"],ie.enabled=!0)},z=ie=>c.value&&l.value[c.value]?.ids.includes(ie),Y=ie=>{if(!c.value)return;const Ae=l.value[c.value],G=Ae.ids.indexOf(ie);G>=0?(Ae.ids.splice(G,1),Ae.ids.length===0&&(Ae.enabled=!1)):(Ae.ids.push(ie),Ae.enabled=!0)},de=()=>{let ie=s.locations;if(d.value){const G=d.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(G)||X.description&&X.description.toLowerCase().includes(G))}const Ae=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((G,X)=>{const te=Ae.includes(G.id),Ce=Ae.includes(X.id);return te&&!Ce?-1:!te&&Ce?1:Qo(G.name,X.name)})};return(ie,Ae)=>(p(),y("div",rD,[r("div",cD,[r("h4",null,_(O.value),1)]),r("div",uD,[(p(!0),y(Ie,null,je(b.value,G=>(p(),y("div",{key:G.scope,class:le(["scope-type-row",{active:U(G.scope)}]),onClick:X=>j(G.scope)},[r("div",hD,_(G.label),1),r("div",fD,_(F(G.scope)),1)],10,dD))),128)),x.value?(p(),y("div",{key:0,class:"expand-row",onClick:Ae[0]||(Ae[0]=G=>f.value=!f.value)},[r("div",pD,_(f.value?"Show less":`Show ${A.value} more option${A.value!==1?"s":""}...`),1),r("div",vD,_(f.value?"":""),1)])):P("",!0)]),c.value?(p(),y("div",{key:0,class:"scope-config-modal",onClick:rt(Z,["self"])},[r("div",mD,[r("div",gD,[r("h5",null,_(M(c.value)),1),r("button",{onClick:Z,class:"btn-close",type:"button"},"")]),r("div",yD,[r("p",kD,_(E(c.value)),1),R(c.value)?(p(),y("div",bD,[r("label",wD,[r("input",{type:"checkbox",checked:re(),onChange:K},null,40,_D),r("span",null,[Ae[4]||(Ae[4]=r("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+_(N(n).people)+")",1)])]),re()?P("",!0):(p(),y("div",CD,[We(r("input",{"onUpdate:modelValue":Ae[1]||(Ae[1]=G=>h.value=G),type:"text",placeholder:`Search ${N(n).people}...`,class:"search-input"},null,8,LD),[[st,h.value]]),r("div",ID,[(p(!0),y(Ie,null,je(J(),G=>(p(),y("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:ae(G.id),onChange:X=>q(G.id)},null,40,SD),r("span",null,_(G.name),1)]))),128))])]))])):P("",!0),I(c.value)?(p(),y("div",xD,[r("label",$D,[r("input",{type:"checkbox",checked:ee(),onChange:ue},null,40,TD),r("span",null,[r("strong",null,"All "+_(N(n).areas),1),Je(" (includes future "+_(N(n).areas)+")",1)])]),ee()?P("",!0):(p(),y("div",MD,[r("div",AD,[(p(!0),y(Ie,null,je($e(),G=>(p(),y("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:_e(G.id),onChange:X=>De(G.id)},null,40,ED),r("span",{class:"area-color-dot",style:tt({backgroundColor:G.color||"#667eea"})},null,4),r("span",null,_(G.name),1)]))),128))])]))])):P("",!0),$(c.value)?(p(),y("div",PD,[r("label",DD,[r("input",{type:"checkbox",checked:Re(),onChange:be},null,40,RD),r("span",null,[r("strong",null,"All "+_(N(n).checkpoints),1),Je(" (includes future "+_(N(n).checkpoints)+")",1)])]),Re()?P("",!0):(p(),y("div",OD,[We(r("input",{"onUpdate:modelValue":Ae[2]||(Ae[2]=G=>d.value=G),type:"text",placeholder:`Search ${N(n).checkpoints}...`,class:"search-input"},null,8,BD),[[st,d.value]]),r("div",ND,[T.value?(p(),y("label",FD,[r("input",{type:"checkbox",checked:z("THIS_CHECKPOINT"),onChange:Ae[3]||(Ae[3]=G=>Y("THIS_CHECKPOINT"))},null,40,UD),r("div",zD,[r("span",HD,[r("strong",null,"This "+_(N(n).checkpoint),1)])])])):P("",!0),(p(!0),y(Ie,null,je(de(),G=>(p(),y("label",{key:G.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:z(G.id),onChange:X=>Y(G.id)},null,40,VD),r("div",GD,[r("span",qD,_(G.name),1),G.description?(p(),y("span",jD," - "+_(G.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:Q,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:Z,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},ld=Ke(WD,[["__scopeId","data-v-d465703e"]]),ZD={class:"tab-content"},KD={class:"form-group"},YD=["value"],JD={key:0,class:"form-error"},XD={class:"form-row"},QD={class:"form-group"},e5=["disabled"],t5={class:"form-group"},n5=["disabled"],o5={class:"form-group"},s5={class:"accordion-item"},a5={class:"accordion-preview"},i5={class:"accordion-arrow"},l5={key:0,class:"accordion-content"},r5={class:"section-description"},c5={class:"dynamic-checkbox"},u5=["checked"],d5={key:0,class:"dynamic-settings"},h5={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D(""),c=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ye(()=>n.form.longitude,k=>{i.value=c(k)},{immediate:!0}),Ye(()=>n.form.latitude,k=>{l.value=c(k)},{immediate:!0});const d=k=>{const b=k==="longitude"?i:l,x=parseFloat(b.value);isNaN(x)?b.value.trim()===""&&(s("update:form",{...n.form,[k]:0}),s("input"),b.value=c(0)):(s("update:form",{...n.form,[k]:x}),s("input"),b.value=c(x))},h=(k,b)=>{s("update:form",{...n.form,[k]:b}),s("input")},f=k=>{if(k){const x=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[n.form.id||"THIS_CHECKPOINT"]}];s("update:form",{...n.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else s("update:form",{...n.form,isDynamic:!1});s("input")},v=k=>{s("update:form",{...n.form,locationUpdateScopeConfigurations:k}),s("input")},g=k=>{if(!k)return!0;const b=k.includes(".")?k.split("."):k.split("/");if(b.length!==3)return!1;const x=/^[a-z]{1,20}$/;return b.every(A=>x.test(A))};return(k,b)=>(p(),y("div",ZD,[r("form",{onSubmit:b[6]||(b[6]=rt(x=>k.$emit("save"),["prevent"]))},[r("div",KD,[b[10]||(b[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=x=>h("what3Words",x.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,YD),e.form.what3Words&&!g(e.form.what3Words)?(p(),y("small",JD," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(p(),y(Ie,{key:0},[r("div",XD,[r("div",QD,[b[11]||(b[11]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":b[1]||(b[1]=x=>i.value=x),onBlur:b[2]||(b[2]=x=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,e5),[[st,i.value]])]),r("div",t5,[b[12]||(b[12]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":b[3]||(b[3]=x=>l.value=x),onBlur:b[4]||(b[4]=x=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,n5),[[st,l.value]])])]),r("div",o5,[r("button",{type:"button",onClick:b[5]||(b[5]=x=>k.$emit("move-location")),class:le(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+_(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",s5,[r("button",{type:"button",class:le(["accordion-header",{expanded:o.value}]),onClick:b[7]||(b[7]=x=>o.value=!o.value)},[b[14]||(b[14]=vi('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",a5,_(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",i5,_(o.value?"":""),1)],2),o.value?(p(),y("div",l5,[r("p",r5," Enable this for lead cars, sweep vehicles, or other moving "+_(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+_(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",c5,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=x=>f(x.target.checked))},null,40,u5),r("span",null,"This "+_(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(p(),y("div",d5,[Pe(ld,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":v,onUserChanged:b[9]||(b[9]=x=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},f5=Ke(h5,[["__scopeId","data-v-bd432637"]]);function $1(e){const t=D(new Map),n=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:n,handleToggleCheckIn:f=>{const g=!n(f);g===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,g),e&&e()},getStatusIcon:f=>n(f)?"":"",getStatusColor:f=>n(f)?"#28a745":"#dc3545",getStatusText:f=>n(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,v])=>({assignmentId:f,shouldBeCheckedIn:v}))}}const p5={class:"card-main"},v5={class:"card-title"},m5={class:"marshal-name"},g5={key:0,class:"card-check-in"},y5={class:"toggle-icon"},k5={class:"toggle-label"},b5={key:0,class:"check-in-time"},w5={key:0,class:"check-in-method"},_5={key:1,class:"unsaved-indicator"},C5={key:1,class:"card-status-readonly"},L5={class:"status-icon"},I5={key:0,class:"check-in-time"},S5={key:0,class:"check-in-method"},x5={key:2,class:"card-badge"},$5={key:3,class:"card-badge"},T5={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const n=e,s=t,o=()=>{s("distance-click",n.assignment)},i=g=>g?new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=H(()=>{const{checkedInBy:g,checkInMethod:k,marshalName:b}=n.assignment;return g&&g!==b?g:k||""}),c=H(()=>!n.assignment.isPending&&!n.isMarkedForRemoval&&!n.readOnly),d=H(()=>{const{checkInLatitude:g,checkInLongitude:k}=n.assignment,b=n.location;return!g||!k||!b?.latitude||!b?.longitude?null:sl(g,k,b.latitude,b.longitude)}),h=H(()=>d.value===null?null:w2(d.value)),f=H(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),v=()=>{c.value&&s("click",n.assignment)};return(g,k)=>(p(),y("div",{class:le(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":c.value}]),onClick:v},[r("div",p5,[r("div",v5,[r("span",m5,_(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(p(),y("div",g5,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=rt(b=>g.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",y5,_(e.effectiveCheckInStatus?"":""),1),r("span",k5,_(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),y("span",b5,[Je(_(i(e.assignment.checkInTime))+" ",1),l.value?(p(),y("span",w5,"("+_(l.value)+")",1)):P("",!0),h.value?(p(),y("span",{key:1,class:le(["check-in-distance",f.value]),onClick:rt(o,["stop"])},_(h.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),y("span",_5," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(p(),y("div",C5,[r("span",{class:le(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",L5,_(e.effectiveCheckInStatus?"":""),1),Je(" "+_(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(p(),y("span",I5,[Je(_(i(e.assignment.checkInTime))+" ",1),l.value?(p(),y("span",S5,"("+_(l.value)+")",1)):P("",!0),h.value?(p(),y("span",{key:1,class:le(["check-in-distance",f.value]),onClick:rt(o,["stop"])},_(h.value),3)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(p(),y("div",x5,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),y("div",$5,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(p(),y("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=rt(b=>g.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),y("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=rt(b=>g.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},M5=Ke(T5,[["__scopeId","data-v-85a18d73"]]),A5={class:"tab-content"},E5={key:0,class:"read-only-notice"},P5={key:1,class:"form-group"},D5=["value"],R5={class:"section-title"},O5={key:2,class:"assign-section"},B5={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:n}){const s=e,o=H(()=>s.peopleTerm.toLowerCase()),i=H(()=>s.personTerm.toLowerCase()),l=H(()=>s.checkpointTerm.toLowerCase()),c=n,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=$1(()=>c("input")),v=D(new Set),g=H(()=>s.assignments?.length||0),k=H(()=>s.assignments?[...s.assignments].sort((E,U)=>(E.marshalName||"").localeCompare(U.marshalName||"",void 0,{sensitivity:"base"})):[]),b=E=>v.value.has(E),x=E=>{E.isPending||c("select-marshal",E)},A=D(!1),T=D(null),w=E=>{h(E)?(T.value=E,A.value=!0):f(E)},C=()=>{T.value&&f(T.value),A.value=!1,T.value=null},I=()=>{A.value=!1,T.value=null},$=H(()=>T.value?`Are you sure you want to undo ${T.value.marshalName||"this marshal"}'s check-in?`:""),R=E=>{E.isPending?c("remove-assignment",E):(v.value.add(E.id),c("input"))},M=E=>{v.value.delete(E.id),c("input")},O=(E,U)=>{c("update:form",{...s.form,[E]:Number(U)}),c("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),v.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([E,U])=>({assignmentId:E,shouldBeCheckedIn:U})),getMarkedForRemoval:()=>Array.from(v.value)}),(E,U)=>(p(),y("div",A5,[e.readOnly?(p(),y("div",E5," Viewing from "+_(i.value)+" - "+_(o.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(p(),y("div",P5,[r("label",null,"Required "+_(o.value),1),r("input",{value:e.form.requiredMarshals,onInput:U[0]||(U[0]=F=>O("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,D5)])),r("h3",R5,"Assigned "+_(o.value)+" ("+_(g.value)+")",1),Pe(wc,{"is-empty":e.assignments.length===0,"empty-message":`No ${o.value} assigned yet.`,"empty-hint":`Use the button below to assign ${o.value} to this ${l.value}.`},{default:Ve(()=>[(p(!0),y(Ie,null,je(k.value,F=>(p(),Ge(M5,{key:F.id,assignment:F,"effective-check-in-status":N(h)(F),"has-unsaved-changes":N(d).has(F.id),"is-marked-for-removal":b(F.id),"read-only":e.readOnly,location:e.form,onClick:x,onToggleCheckIn:w,onRemove:R,onUndoRemove:M,onDistanceClick:U[1]||(U[1]=j=>E.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(p(),y("div",O5,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:U[2]||(U[2]=F=>E.$emit("open-assign-modal"))}," + Assign "+_(i.value)+"... ",1)])),Pe(gi,{show:A.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:I},null,8,["show","message"])]))}},N5=Ke(B5,[["__scopeId","data-v-7124720e"]]),F5={class:"grouped-tasks-list"},U5={key:0,class:"empty-state"},z5={class:"task-group-header-row"},H5=["onClick"],V5={class:"task-header-content"},G5={class:"task-checkbox-area"},q5={class:"task-info"},j5={class:"task-name"},W5={class:"task-summary"},Z5={key:0,class:"modified-badge"},K5={class:"task-scope"},Y5=["title"],J5={class:"expand-arrow"},X5={key:0,class:"task-group-details"},Q5={class:"sub-group-header"},e8={class:"detail-checkbox"},t8=["name","checked","disabled","onChange"],n8=["checked","disabled","onChange"],o8={class:"detail-content"},s8={class:"detail-context"},a8={key:0,class:"detail-completion"},i8={key:0,class:"pending-text"},l8={class:"completion-text"},r8={class:"completion-time"},c8={key:1,class:"detail-uncomplete"},u8={key:2,class:"detail-disabled"},d8={class:"detail-checkbox"},h8=["checked","disabled","onChange"],f8={class:"detail-content"},p8={class:"detail-context"},v8={key:0,class:"detail-completion"},m8={key:0,class:"pending-text"},g8={class:"completion-text"},y8={class:"completion-time"},k8={key:1,class:"detail-uncomplete"},b8={key:2,class:"detail-disabled"},w8={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["toggle-complete","reorder"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D(new Set),c=(I,$)=>{if(I==="Checkpoint"){const R=o.locations.find(M=>M.id===$);if(!R)return`${n.value.checkpoint} (unknown)`;if(R.description){const O=R.description.length>40?R.description.substring(0,40)+"...":R.description;return`${R.name} - ${O}`}return R.name}return I==="Area"?o.areas.find(M=>M.id===$)?.name||`${n.value.area} (unknown)`:$},d=(I,$)=>I==="Checkpoint"?o.locations.find(M=>M.id===$)?.name||"":I==="Area"?o.areas.find(M=>M.id===$)?.name||"":$,h=H(()=>{const I=new Map;for(const $ of o.items){I.has($.itemId)||I.set($.itemId,{itemId:$.itemId,text:$.text,displayOrder:$.displayOrder||0,matchedScope:$.matchedScope,items:[],subGroups:null,totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1,contextIds:new Set,completedContextIds:new Set});const R=I.get($.itemId);R.items.push($),A.includes($.matchedScope)&&$.completionContextId?(R.contextIds.add($.completionContextId),$.localIsCompleted&&R.completedContextIds.add($.completionContextId)):(R.totalCount++,$.localIsCompleted&&R.completedCount++),$.isModified&&(R.hasModified=!0)}for(const $ of I.values()){if(A.includes($.matchedScope)){$.totalCount=$.contextIds.size,$.completedCount=$.completedContextIds.size;const M=new Map;for(const O of $.items){const E=O.completionContextId;M.has(E)||M.set(E,{contextId:E,contextType:O.completionContextType,contextName:c(O.completionContextType,E),sortKey:d(O.completionContextType,E),items:[],isContextCompleted:!1});const U=M.get(E);U.items.push(O),O.localIsCompleted&&(U.isContextCompleted=!0)}$.subGroups=Array.from(M.values()).sort((O,E)=>O.sortKey.localeCompare(E.sortKey,void 0,{numeric:!0,sensitivity:"base"}));for(const O of $.subGroups)O.items.sort((E,U)=>{const F=E.contextOwnerName||"",j=U.contextOwnerName||"";return F.localeCompare(j,void 0,{sensitivity:"base"})})}else $.items.sort((M,O)=>{const E=T(M),U=T(O);return E.localeCompare(U,void 0,{numeric:!0,sensitivity:"base"})});$.allCompleted=$.totalCount>0&&$.completedCount===$.totalCount}return Array.from(I.values()).sort(($,R)=>{const M=$.displayOrder||0,O=R.displayOrder||0;return M!==O?M-O:$.text.localeCompare(R.text,void 0,{sensitivity:"base"})})}),f=I=>{l.value.has(I)?l.value.delete(I):l.value.add(I),l.value=new Set(l.value)},v=({changes:I})=>{i("reorder",I)},g=I=>I.hasModified?"status-modified":I.allCompleted?"status-completed":I.completedCount>0?"status-partial":"status-pending",k=I=>I.allCompleted?"":I.completedCount>0?"":"",b=I=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${s.value.area}`,EveryoneAtCheckpoints:`Per ${s.value.checkpoint}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[I.matchedScope]||I.matchedScope,x=I=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This task is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[I.matchedScope]||"",A=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],T=I=>{if(!I.completionContextType||!I.completionContextId)return"Everyone";if(A.includes(I.matchedScope)&&I.contextOwnerName)return I.contextOwnerName;if(I.completionContextType==="Checkpoint"){if(I.linksToCheckIn&&I.contextOwnerName){const M=o.locations.find(O=>O.id===I.completionContextId)?.name||I.linkedCheckpointName;return M?`${I.contextOwnerName} (${M})`:I.contextOwnerName}const $=o.locations.find(R=>R.id===I.completionContextId);return $?$.description?`${$.name} - ${$.description}`:$.name:`${n.value.checkpoint} (unknown)`}if(I.completionContextType==="Area"){const $=o.areas.find(R=>R.id===I.completionContextId);return $?$.name:`${n.value.area} (unknown)`}if(I.completionContextType==="Personal"){if(I.contextOwnerName)return I.contextOwnerName;if(I.completionContextId&&o.marshals.length>0){const $=o.marshals.find(R=>R.id===I.completionContextId||R.marshalId===I.completionContextId);if($)return $.name||$.marshalName}return"Assigned individually"}return I.completionContextType},w=I=>{if(!I)return"";const $=new Date(I),O=(new Date-$)/(1e3*60*60);return O<24&&O>=0?$.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):$.toLocaleString()},C=I=>I.completedByActorName&&I.contextOwnerName&&I.completedByActorName!==I.contextOwnerName?`${I.completedByActorName} on behalf of ${I.contextOwnerName}`:I.completedByActorName||I.contextOwnerName||"Unknown";return(I,$)=>(p(),y("div",F5,[h.value.length===0?(p(),y("div",U5,[...$[0]||($[0]=[r("p",null,"No tasks available.",-1)])])):(p(),Ge(il,{key:1,items:h.value,"item-key":"itemId",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:v},{item:Ve(({element:R})=>[r("div",{class:le(["task-group",{"all-completed":R.allCompleted,"has-modified":R.hasModified}])},[r("div",z5,[e.allowReorder?(p(),Ge(ll,{key:0,class:"task-drag-handle"})):P("",!0),r("button",{type:"button",class:"task-group-header",onClick:M=>f(R.itemId)},[r("div",V5,[r("div",G5,[r("span",{class:le(["task-status-icon",g(R)])},_(k(R)),3)]),r("div",q5,[r("div",j5,_(R.text),1),r("div",W5,[r("span",{class:le(["completion-count",{"all-done":R.allCompleted}])},_(R.completedCount)+"/"+_(R.totalCount)+" completed ",3),R.hasModified?(p(),y("span",Z5," Modified ")):P("",!0)])]),r("div",K5,[R.items[0]?.scopeConfigurations?.length?(p(),Ge(nl,{key:0,"scope-configurations":R.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(p(),y("span",{key:1,class:"scope-pill",title:x(R.items[0])},_(b(R.items[0])),9,Y5))])]),r("span",J5,_(l.value.has(R.itemId)?"":""),1)],8,H5)]),l.value.has(R.itemId)?(p(),y("div",X5,[R.subGroups&&R.subGroups.length>0?(p(!0),y(Ie,{key:0},je(R.subGroups,M=>(p(),y("div",{key:M.contextId,class:"task-sub-group"},[r("div",Q5,_(M.contextName),1),(p(!0),y(Ie,null,je(M.items,O=>(p(),y("div",{key:`${O.itemId}-${O.completionContextId}-${O.contextOwnerMarshalId}`,class:le(["task-detail-item",{"item-completed":O.localIsCompleted,"item-modified":O.isModified}])},[r("div",e8,[M.isContextCompleted?(p(),y("input",{key:1,type:"checkbox",checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe&&!O.localIsCompleted,onChange:E=>I.$emit("toggle-complete",O)},null,40,n8)):(p(),y("input",{key:0,type:"radio",name:`shared-${O.itemId}-${M.contextId}`,checked:O.localIsCompleted,disabled:!O.canBeCompletedByMe,onChange:E=>I.$emit("toggle-complete",O)},null,40,t8))]),r("div",o8,[r("div",s8,_(O.contextOwnerName||"Unknown marshal"),1),O.localIsCompleted?(p(),y("div",a8,[O.isModified&&!O.isCompleted?(p(),y("span",i8," Will be marked as completed ")):(p(),y(Ie,{key:1},[r("span",l8,_(C(O)),1),r("span",r8,_(w(O.completedAt)),1)],64))])):O.isModified&&O.isCompleted?(p(),y("div",c8,[...$[1]||($[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):O.canBeCompletedByMe?P("",!0):(p(),y("div",u8," Already completed by someone else "))])],2))),128))]))),128)):(p(!0),y(Ie,{key:1},je(R.items,M=>(p(),y("div",{key:`${M.itemId}-${M.completionContextId}`,class:le(["task-detail-item",{"item-completed":M.localIsCompleted,"item-modified":M.isModified}])},[r("div",d8,[r("input",{type:"checkbox",checked:M.localIsCompleted,disabled:!M.canBeCompletedByMe&&!M.localIsCompleted,onChange:O=>I.$emit("toggle-complete",M)},null,40,h8)]),r("div",f8,[r("div",p8,_(T(M)),1),M.localIsCompleted?(p(),y("div",v8,[M.isModified&&!M.isCompleted?(p(),y("span",m8," Will be marked as completed ")):(p(),y(Ie,{key:1},[r("span",g8,_(C(M)),1),r("span",y8,_(w(M.completedAt)),1)],64))])):M.isModified&&M.isCompleted?(p(),y("div",k8,[...$[2]||($[2]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):M.canBeCompletedByMe?P("",!0):(p(),y("div",b8," Already completed by someone else "))])],2))),128))])):P("",!0)],2)]),_:1},8,["items","disabled","show-order-overlay"]))]))}},qf=Ke(w8,[["__scopeId","data-v-06c0c2c6"]]),_8={class:"checkpoint-checklist-view"},C8={key:0,class:"loading-state"},L8={key:1,class:"error-state"},I8={key:2,class:"empty-state"},S8={class:"help-text"},x8={key:3,class:"empty-state"},$8={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=H(()=>o.assignments.length===0),v=H(()=>l.value.map(T=>{const w=h.value.get(`${T.itemId}|||${T.completionContextId}`),C=w!==void 0?w.complete:T.isCompleted,I=w!==void 0&&w.complete!==T.isCompleted;return{...T,localIsCompleted:C,isModified:I}})),g=async()=>{if(!(!o.eventId||!o.locationId&&!o.areaId)){c.value=!0,d.value=null;try{const T=o.locationId?await Ot.getCheckpointChecklist(o.eventId,o.locationId):await Ot.getAreaChecklist(o.eventId,o.areaId);if(l.value=Bf(T.data)||[],o.modelValue&&o.modelValue.length>0){const w=new Map;o.modelValue.forEach(C=>{w.set(`${C.itemId}|||${C.contextId}`,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),h.value=w}}catch(T){console.error("Failed to load checklist:",T),d.value=T.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},k=T=>{const w=T.contextOwnerMarshalId||(o.assignments.length>0?o.assignments[0].marshalId:null);if(!w)return;const C=`${T.itemId}|||${T.completionContextId}`,I=h.value.get(C),$=I!==void 0?I.complete:T.isCompleted;h.value.set(C,{complete:!$,contextType:T.completionContextType,contextId:T.completionContextId,marshalId:w}),b()},b=()=>{const T=[];for(const[w,C]of h.value.entries()){const[I,$]=w.split("|||"),R=l.value.find(M=>M.itemId===I&&M.completionContextId===$);R&&C.complete!==R.isCompleted&&T.push({itemId:I,complete:C.complete,contextType:C.contextType,contextId:C.contextId,marshalId:C.marshalId})}i("update:modelValue",T),i("change",T)},x=T=>{i("reorder",T)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const T=new Map;o.modelValue.forEach(w=>{T.set(`${w.itemId}|||${w.contextId}`,{complete:w.complete,contextType:w.contextType,contextId:w.contextId,marshalId:w.marshalId})}),h.value=T}},loadChecklist:g}),Ye(()=>[o.eventId,o.locationId,o.areaId],()=>{g()},{immediate:!0}),(T,w)=>(p(),y("div",_8,[c.value?(p(),y("div",C8," Loading checklist... ")):d.value?(p(),y("div",L8,[r("p",null,_(d.value),1),r("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(p(),y("div",I8,[r("p",null,"No "+_(N(s).peoplePlural)+" assigned to this "+_(N(s).checkpoint)+" yet.",1),r("p",S8,"Assign "+_(N(s).peoplePlural)+" to enable "+_(N(s).checklist)+" completion.",1)])):l.value.length===0?(p(),y("div",x8,[r("p",null,"No checklist items for this "+_(N(s).checkpoint)+".",1)])):(p(),Ge(qf,{key:4,items:v.value,locations:e.locations,areas:e.areas,marshals:e.marshals,"allow-reorder":e.allowReorder,onToggleComplete:k,onReorder:x},null,8,["items","locations","areas","marshals","allow-reorder"]))]))}},T1=Ke($8,[["__scopeId","data-v-267ab725"]]),T8={class:"notes-view"},M8={key:0,class:"loading-state"},A8={key:1,class:"error-state"},E8={key:2,class:"empty-state"},P8={class:"note-item-content"},D8={class:"note-header"},R8={class:"note-title-row"},O8={key:0,class:"pin-icon",title:"Pinned"},B8={class:"note-title"},N8={class:"note-meta"},F8={key:0,class:"category-badge"},U8={key:0,class:"note-content"},z8={class:"note-footer"},H8={class:"created-info"},V8={key:1,class:"scope-info"},G8={key:1,class:"notes-list"},q8={class:"note-item-content"},j8={class:"note-header"},W8={class:"note-title-row"},Z8={key:0,class:"pin-icon",title:"Pinned"},K8={class:"note-title"},Y8={class:"note-meta"},J8={key:0,class:"category-badge"},X8={key:0,class:"note-content"},Q8={class:"note-footer"},eR={class:"created-info"},tR={key:1,class:"scope-info"},nR={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0},allowReorder:{type:Boolean,default:!1}},emits:["reorder"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D([]),l=D(!1),c=D(null),d=H(()=>s.marshalId?"No notes for this marshal.":s.areaId?"No notes for this area.":s.locationId?"No notes for this checkpoint.":"No notes available."),h=H(()=>s.areaId?s.locations.filter(I=>I.areaIds&&I.areaIds.includes(s.areaId)):[]),f=H(()=>h.value.map(I=>I.id)),v=H(()=>{if(!s.areaId)return[];const I=new Set;return s.assignments.filter($=>f.value.includes($.locationId)).forEach($=>I.add($.marshalId)),Array.from(I)}),g=I=>s.assignments.filter($=>$.marshalId===I).map($=>$.locationId),k=I=>{const $=g(I),R=new Set;for(const M of $){const O=s.locations.find(E=>E.id===M);O?.areaIds&&O.areaIds.forEach(E=>R.add(E))}return Array.from(R)},b=(I,$)=>{if(!I.scopeConfigurations)return null;for(const R of I.scopeConfigurations){if(R.itemType==="Area"){if($.type==="area"&&(R.ids.includes($.areaId)||R.ids.includes("ALL_AREAS")))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"};if($.type==="checkpoint"){const O=s.locations.find(E=>E.id===$.locationId)?.areaIds||[];if(R.ids.includes("ALL_AREAS")||O.some(E=>R.ids.includes(E)))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(R.itemType==="Checkpoint"){if($.type==="checkpoint"&&(R.ids.includes($.locationId)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if($.type==="area"&&$.checkpointIds.some(O=>R.ids.includes(O)||R.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(R.itemType==="Marshal"){if($.type==="marshal"&&(R.ids.includes($.marshalId)||R.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if($.type==="checkpoint"){const M=s.assignments.filter(E=>E.locationId===$.locationId).map(E=>E.marshalId);if(R.ids.includes("ALL_MARSHALS")||M.some(E=>R.ids.includes(E)))return{matched:!0,scope:"Marshal at checkpoint"}}if($.type==="area"&&(R.ids.includes("ALL_MARSHALS")||$.marshalIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Marshal in area"}}if($.type==="marshal"&&$.checkpointIds&&$.areaIds){if(R.itemType==="Checkpoint"&&(R.ids.includes("ALL_CHECKPOINTS")||$.checkpointIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:"Assigned checkpoint"};if(R.itemType==="Area"&&(R.ids.includes("ALL_AREAS")||$.areaIds.some(O=>R.ids.includes(O))))return{matched:!0,scope:R.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},x=H(()=>{const I=s.allNotes||i.value;if(!I||I.length===0)return[];if(s.areaId&&s.allNotes){const $={type:"area",areaId:s.areaId,checkpointIds:f.value,marshalIds:v.value},R=[],M=new Set;for(const O of I){if(M.has(O.noteId))continue;const E=b(O,$);E&&(M.add(O.noteId),R.push({...O,matchedScope:E.scope}))}return R}if(s.locationId&&s.allNotes){const $={type:"checkpoint",locationId:s.locationId},R=[],M=new Set;for(const O of I){if(M.has(O.noteId))continue;const E=b(O,$);E&&(M.add(O.noteId),R.push({...O,matchedScope:E.scope}))}return R}if(s.marshalId&&s.allNotes){const $=g(s.marshalId),R=k(s.marshalId),M={type:"marshal",marshalId:s.marshalId,checkpointIds:$,areaIds:R},O=[],E=new Set;for(const U of I){if(E.has(U.noteId))continue;const F=b(U,M);F&&(E.add(U.noteId),O.push({...U,matchedScope:F.scope}))}return O}return I}),A=H(()=>{const I={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...x.value].sort(($,R)=>{if($.isPinned!==R.isPinned)return $.isPinned?-1:1;const M=I[$.priority]??2,O=I[R.priority]??2;return M!==O?M-O:$.displayOrder!==R.displayOrder?$.displayOrder-R.displayOrder:new Date(R.createdAt)-new Date($.createdAt)})}),T=({changes:I})=>{o("reorder",I)},w=async()=>{if(s.allNotes===null&&s.eventId){l.value=!0,c.value=null;try{let I;s.marshalId?I=await ys.getMarshalNotes(s.eventId,s.marshalId):I=await ys.getByEvent(s.eventId),i.value=I.data||[]}catch(I){console.error("Failed to load notes:",I),c.value=I.response?.data?.message||"Failed to load notes"}finally{l.value=!1}}};Ye(()=>[s.eventId,s.locationId,s.areaId,s.marshalId],()=>{s.allNotes===null&&w()},{immediate:!0});const C=I=>{if(!I)return"";const $=new Date(I),M=new Date-$,O=Math.floor(M/6e4),E=Math.floor(M/36e5),U=Math.floor(M/864e5);return O<1?"just now":O<60?`${O}m ago`:E<24?`${E}h ago`:U<7?`${U}d ago`:$.toLocaleDateString()};return t({loadNotes:w}),(I,$)=>(p(),y("div",T8,[l.value?(p(),y("div",M8," Loading notes... ")):c.value?(p(),y("div",A8,[r("p",null,_(c.value),1),r("button",{onClick:w,class:"btn btn-secondary btn-small"}," Retry ")])):x.value.length===0?(p(),y("div",E8,[r("p",null,_(d.value),1)])):(p(),y(Ie,{key:3},[e.allowReorder?(p(),Ge(il,{key:0,items:A.value,"item-key":"noteId","pinned-key":"isPinned",onReorder:T,class:"notes-list"},{item:Ve(({element:R})=>[r("div",{class:le(["note-item",{pinned:R.isPinned}])},[Pe(ll),r("div",P8,[r("div",D8,[r("div",R8,[R.isPinned?(p(),y("span",O8,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",B8,_(R.title),1)]),r("div",N8,[R.category?(p(),y("span",F8,_(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},_(R.priority||"Normal"),3)])]),R.content?(p(),y("div",U8,_(R.content),1)):P("",!0),r("div",z8,[r("span",H8," Created by "+_(R.createdByName||"Unknown")+"  "+_(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),Ge(nl,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),y("span",V8,_(R.matchedScope),1)):P("",!0)])])],2)]),_:1},8,["items"])):(p(),y("div",G8,[(p(!0),y(Ie,null,je(A.value,R=>(p(),y("div",{key:R.noteId,class:le(["note-item",{pinned:R.isPinned}])},[r("div",q8,[r("div",j8,[r("div",W8,[R.isPinned?(p(),y("span",Z8,"")):P("",!0),r("span",{class:le(["priority-indicator",(R.priority||"Normal").toLowerCase()])},null,2),r("strong",K8,_(R.title),1)]),r("div",Y8,[R.category?(p(),y("span",J8,_(R.category),1)):P("",!0),r("span",{class:le(["priority-badge",(R.priority||"Normal").toLowerCase()])},_(R.priority||"Normal"),3)])]),R.content?(p(),y("div",X8,_(R.content),1)):P("",!0),r("div",Q8,[r("span",eR," Created by "+_(R.createdByName||"Unknown")+"  "+_(C(R.createdAt)),1),R.scopeConfigurations?.length&&e.showScope?(p(),Ge(nl,{key:0,class:"scope-pills","scope-configurations":R.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):R.matchedScope&&e.showScope?(p(),y("span",tR,_(R.matchedScope),1)):P("",!0)])])],2))),128))]))],64))]))}},rd=Ke(nR,[["__scopeId","data-v-cd3c899d"]]),oR={class:"checklist-preview"},sR={class:"preview-actions"},aR={class:"preview-header"},iR={key:0,class:"add-item-form"},lR=["placeholder"],rR=["disabled"],cR={key:1,class:"pending-items"},uR={class:"item-content"},dR={class:"item-header"},hR={class:"item-text"},fR={class:"item-scope"},pR=["onClick"],vR={key:2,class:"empty-state"},mR={key:0,class:"help-text"},gR={key:3,class:"checklist-items"},yR={class:"item-content"},kR={class:"item-header"},bR={class:"item-text"},wR={class:"item-scope"},_R=["title"],CR={key:0,class:"item-context"},LR={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=H(()=>o.checkpointTermSingular?o.checkpointTermSingular.toLowerCase():s.value.checkpoint),l=t,c=D(!1),d=D(""),h=D([...o.modelValue]);Ye(()=>o.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",c.value=!1,g())},v=C=>{h.value.splice(C,1),g()},g=()=>{l("update:modelValue",[...h.value]),l("change")},k=C=>{const I=C.scope,$=C.itemType,R=C.ids||[];return(I==="EveryoneAtCheckpoints"||I==="OnePerCheckpoint")&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):I==="OnePerCheckpoint"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>o.pendingAreaIds.includes(M)):(I==="EveryoneInAreas"||I==="OnePerArea"||I==="EveryAreaLead"||I==="OneLeadPerArea")&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>o.pendingAreaIds.includes(M)):!1},b=H(()=>o.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(I=>k(I)):!1)),x=C=>({EveryoneAtCheckpoints:`All at ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,EveryoneInAreas:`All in ${s.value.areas}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${s.value.area} leads`,OneLeadPerArea:`One lead per ${s.value.area}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const I=C.scopeConfigurations.find(R=>k(R));if(!I)return x(C.scopeConfigurations[0].scope);const $=I.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${s.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${s.value.areas}`:x(I.scope)},T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const I=C.scopeConfigurations.find(R=>k(R));return I&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${s.value.checkpoints}`,OnePerCheckpoint:`One person at each ${s.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${s.value.areas}`,OnePerArea:`One person in each ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`}[I.scope]||""},w=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const I=C.scopeConfigurations.find(M=>k(M));if(!I)return null;const $=I.itemType,R=I.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const M=o.areas.filter(O=>R.includes(O.id)&&o.pendingAreaIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,I)=>(p(),y("div",oR,[r("div",sR,[r("p",aR,_(e.isEditing?`Add new ${N(s).checklist} for this ${i.value}:`:`${N(n).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=$=>c.value=!c.value)},_(c.value?"Cancel":`Add ${N(s).checklist}`),1)]),c.value?(p(),y("div",iR,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=$=>d.value=$),type:"text",placeholder:`Enter ${N(s).checklist} text...`,class:"add-item-input",onKeyup:Xo(f,["enter"])},null,40,lR),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,rR)])):P("",!0),h.value.length>0?(p(),y("div",cR,[(p(!0),y(Ie,null,je(h.value,($,R)=>(p(),y("div",{key:`pending-${R}`,class:"checklist-item pending"},[I[3]||(I[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",uR,[r("div",dR,[r("div",hR,_($.text),1),r("div",fR,[I[2]||(I[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>v(R),title:"Remove"},"  ",8,pR)])])])]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(p(),y("div",vR,[r("p",null,"No "+_(N(s).checklists)+" will apply based on the current "+_(N(s).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),y("p",mR," Assign "+_(N(s).areas)+" to see relevant "+_(N(s).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),y("div",gR,[(p(!0),y(Ie,null,je(b.value,$=>(p(),y("div",{key:$.id,class:"checklist-item"},[I[4]||(I[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",yR,[r("div",kR,[r("div",bR,_($.text),1),r("div",wR,[r("span",{class:"scope-pill",title:T($)},_(A($)),9,_R)])]),w($)?(p(),y("div",CR,_(w($)),1)):P("",!0)])]))),128))])):P("",!0)]))}},IR=Ke(LR,[["__scopeId","data-v-7d943b21"]]),SR={class:"notes-preview"},xR={class:"preview-actions"},$R={class:"preview-header"},TR={key:0,class:"add-item-form"},MR={class:"add-form-fields"},AR=["disabled"],ER={key:1,class:"pending-items"},PR={class:"note-header"},DR={class:"note-title"},RR={class:"note-actions"},OR=["onClick"],BR={key:0,class:"note-content"},NR={key:2,class:"empty-state"},FR={key:0,class:"help-text"},UR={key:3,class:"notes-list"},zR={class:"note-header"},HR={class:"note-title"},VR=["title"],GR={key:0,class:"note-content"},qR={key:1,class:"note-context"},jR={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():n.value.checkpoint),l=D(!1),c=D(""),d=D(""),h=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{!c.value.trim()&&!d.value.trim()||(h.value.push({title:c.value.trim(),content:d.value.trim(),isNew:!0}),c.value="",d.value="",l.value=!1,g())},v=C=>{h.value.splice(C,1),g()},g=()=>{o("update:modelValue",[...h.value]),o("change")},k=C=>{const I=C.scope,$=C.itemType,R=C.ids||[];return I==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS"):I==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>s.pendingAreaIds.includes(M)):!1},b=H(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(I=>k(I)):!1)),x=C=>({EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const I=C.scopeConfigurations.find(R=>k(R));if(!I)return x(C.scopeConfigurations[0].scope);const $=I.ids||[];return $.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const I=C.scopeConfigurations.find(R=>k(R));return I&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},w=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const I=C.scopeConfigurations.find(M=>k(M));if(!I)return null;const $=I.itemType,R=I.ids||[];if(R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Area"){const M=s.areas.filter(O=>R.includes(O.id)&&s.pendingAreaIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,I)=>(p(),y("div",SR,[r("div",xR,[r("p",$R,_(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=$=>l.value=!l.value)},_(l.value?"Cancel":"Add note"),1)]),l.value?(p(),y("div",TR,[r("div",MR,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=$=>c.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,c.value]]),We(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=$=>d.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,AR)])):P("",!0),h.value.length>0?(p(),y("div",ER,[(p(!0),y(Ie,null,je(h.value,($,R)=>(p(),y("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",PR,[r("span",DR,_($.title||"Untitled"),1),r("div",RR,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>v(R),title:"Remove"},"  ",8,OR)])]),$.content?(p(),y("div",BR,_($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(p(),y("div",NR,[r("p",null,"No notes will apply based on the current "+_(N(n).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),y("p",FR," Assign "+_(N(n).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),y("div",UR,[(p(!0),y(Ie,null,je(b.value,$=>(p(),y("div",{key:$.id,class:"note-item"},[r("div",zR,[r("span",HR,_($.title||"Untitled"),1),r("span",{class:"scope-pill",title:T($)},_(A($)),9,VR)]),$.content?(p(),y("div",GR,_($.content),1)):P("",!0),w($)?(p(),y("div",qR,_(w($)),1)):P("",!0)]))),128))])):P("",!0)]))}},WR=Ke(jR,[["__scopeId","data-v-71646c3f"]]),ZR={class:"base-modal-title modal-title-with-icon"},KR=["innerHTML"],YR={key:7,class:"tab-content appearance-tab"},JR={class:"accordion-item"},XR=["innerHTML"],QR={class:"accordion-title"},eO={class:"accordion-arrow"},tO={key:0,class:"accordion-content"},nO={class:"section-description"},oO={class:"accordion-item"},sO={class:"accordion-preview"},aO={class:"accordion-arrow"},iO={key:0,class:"accordion-content"},lO={class:"section-description"},rO={class:"terminology-row"},cO={class:"terminology-field"},uO=["value"],dO={value:""},hO=["value"],fO={class:"terminology-field"},pO=["value"],vO={value:""},mO=["value"],gO={key:8,class:"tab-content incidents-tab"},yO={class:"incidents-list"},kO={class:"custom-footer"},bO={class:"footer-left"},km="edit_location_accordion",wO={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal","reorder-notes","reorder-checklists"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D("details"),l=D(!1),c=D(null),d=D(null),h=D([]),f=D([]),v=D([]),g=D({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=D(!1),b=D(null),x=fe=>{b.value=fe,k.value=!0},A=()=>{k.value=!1,b.value=null},T=H(()=>b.value&&b.value.marshalName||""),w=H(()=>g.value.name||s.location?.name||""),C=H(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=b.value;return!fe||!ke?null:{lat:fe,lng:ke}}),I=H(()=>{const fe=g.value.latitude,ke=g.value.longitude;return!fe||!ke?null:{lat:fe,lng:ke}}),$=H(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:ke}=b.value,ne=g.value.latitude,ye=g.value.longitude;return!fe||!ke||!ne||!ye?null:sl(fe,ke,ne,ye)}),R=()=>s.eventId?`${km}_${s.eventId}`:km,M=D({iconStyle:!1,terminology:!1});un(()=>{const fe=localStorage.getItem(R());if(fe)try{const ke=JSON.parse(fe);M.value={...M.value,...ke}}catch{}});const O=fe=>{M.value[fe]=!M.value[fe],localStorage.setItem(R(),JSON.stringify(M.value))},E=H(()=>{const fe=g.value.areaIds||[];if(fe.length>0){const ke=s.areas.filter(ne=>fe.includes(ne.id)&&ne.peopleTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].peopleTerm}return s.eventPeopleTerm||"Marshals"}),U=H(()=>g.value.peopleTerm?g.value.peopleTerm:E.value),F=H(()=>{const fe=g.value.areaIds||[];if(fe.length>0){const ke=s.areas.filter(ne=>fe.includes(ne.id)&&ne.checkpointTerm).sort((ne,ye)=>(ne.checkpointCount||0)-(ye.checkpointCount||0));if(ke.length>0)return ke[0].checkpointTerm}return n.value.checkpoint});H(()=>F.value.toLowerCase());const j=H(()=>{const fe=g.value.checkpointTerm||s.location?.checkpointTerm||s.location?.CheckpointTerm;if(fe)return ji("checkpoint",fe,U.value);const ke=g.value.areaIds||[];let ne=null;if(ke.length>0){const ye=s.areas.filter(He=>ke.includes(He.id)&&He.checkpointTerm).sort((He,ct)=>(He.checkpointCount||0)-(ct.checkpointCount||0));ye.length>0&&(ne=ye[0].checkpointTerm)}return ne?ji("checkpoint",ne,U.value):n.value.checkpoint}),Z=H(()=>j.value.toLowerCase()),Q=H(()=>{const fe=U.value;return ji("people",fe)});H(()=>Q.value.toLowerCase());const re=H(()=>n.value.area);H(()=>re.value.toLowerCase());const K=H(()=>n.value.area),ae=H(()=>K.value.toLowerCase()),q=H(()=>n.value.areas),J=H(()=>!!(s.location&&s.location.id)),ee=H(()=>J.value?`Edit ${Z.value}: ${s.location?.name||""}`:`Add ${Z.value}`),ue=H(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:U.value,icon:"marshal"},{value:"checklists",label:n.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return s.incidents&&s.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),_e=H(()=>ue.value.findIndex(fe=>fe.value===i.value)),$e=H(()=>_e.value===ue.value.length-1),De=H(()=>{const fe=g.value.areaIds||[],ke=s.areas.filter(ft=>fe.includes(ft.id)).sort((ft,Pt)=>(ft.checkpointCount||0)-(Pt.checkpointCount||0)),ne=(ft,Pt)=>{for(const mt of ke){const An=ft(mt);if(An&&An!=="default")return{value:An,source:"area"}}return Pt&&Pt!=="default"?{value:Pt,source:"event"}:{value:"",source:"none"}},ye=ne(ft=>ft.checkpointStyleType||ft.CheckpointStyleType,s.eventDefaultStyleType),He=ne(ft=>ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleColor),ct=ne(ft=>ft.checkpointStyleBackgroundShape||ft.CheckpointStyleBackgroundShape,s.eventDefaultStyleBackgroundShape),ht=ne(ft=>ft.checkpointStyleBackgroundColor||ft.CheckpointStyleBackgroundColor||ft.checkpointStyleColor||ft.CheckpointStyleColor,s.eventDefaultStyleBackgroundColor||s.eventDefaultStyleColor),Bt=ne(ft=>ft.checkpointStyleBorderColor||ft.CheckpointStyleBorderColor,s.eventDefaultStyleBorderColor),Lt=ne(ft=>ft.checkpointStyleIconColor||ft.CheckpointStyleIconColor,s.eventDefaultStyleIconColor),Nt=ne(ft=>ft.checkpointStyleSize||ft.CheckpointStyleSize,s.eventDefaultStyleSize),Et=ne(ft=>ft.checkpointStyleMapRotation??ft.CheckpointStyleMapRotation,s.eventDefaultStyleMapRotation),ko=[ye,ct,ht,Bt,Lt,Nt,Et].some(ft=>ft.source==="area");return{type:ye.value||"default",color:He.value,backgroundShape:ct.value,backgroundColor:ht.value,borderColor:Bt.value,iconColor:Lt.value,size:Nt.value,mapRotation:Et.value,source:ko?"area":ye.value?"event":"none"}}),Re=H(()=>De.value.source==="area"?`${K.value} default`:"Event default"),be=H(()=>{const fe=g.value.styleType&&g.value.styleType!=="default"&&g.value.styleType!=="custom"?g.value.styleType:De.value.type,ke=g.value.styleBackgroundShape||De.value.backgroundShape||"circle",ne=g.value.styleBackgroundColor||De.value.backgroundColor||"#667eea",ye=g.value.styleBorderColor||De.value.borderColor||"#ffffff",He=g.value.styleIconColor||De.value.iconColor||"#ffffff";return zn({type:fe||"circle",backgroundShape:ke,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100"})}),z=H(()=>{let fe,ke,ne,ye,He;return J.value&&s.location?(fe=s.location.resolvedStyleType||s.location.ResolvedStyleType,ke=s.location.resolvedStyleBackgroundShape||s.location.ResolvedStyleBackgroundShape||"circle",ne=s.location.resolvedStyleBackgroundColor||s.location.ResolvedStyleBackgroundColor||s.location.resolvedStyleColor||s.location.ResolvedStyleColor||"#667eea",ye=s.location.resolvedStyleBorderColor||s.location.ResolvedStyleBorderColor||"#ffffff",He=s.location.resolvedStyleIconColor||s.location.ResolvedStyleIconColor||"#ffffff"):(fe=g.value.styleType&&g.value.styleType!=="default"&&g.value.styleType!=="custom"?g.value.styleType:De.value.type,ke=g.value.styleBackgroundShape||De.value.backgroundShape||"circle",ne=g.value.styleBackgroundColor||De.value.backgroundColor||"#667eea",ye=g.value.styleBorderColor||De.value.borderColor||"#ffffff",He=g.value.styleIconColor||De.value.iconColor||"#ffffff"),zn({type:fe||"circle",backgroundShape:ke,backgroundColor:ne,borderColor:ye,iconColor:He,size:"100",outputSize:28})}),Y=H(()=>{const fe=!!g.value.checkpointTerm,ke=!!g.value.peopleTerm;return fe&&ke?`${ji("checkpoint",g.value.checkpointTerm,g.value.peopleTerm)}, ${g.value.peopleTerm}`:fe?ji("checkpoint",g.value.checkpointTerm,U.value):ke?g.value.peopleTerm:"Using defaults"}),de=H(()=>$e.value?null:ue.value[_e.value+1]),ie=H(()=>de.value?`${de.value.label}...`:""),Ae=D(!1),G=D(null);Ye(()=>s.location,fe=>{if(fe){const ke=fe.id||"new";if(G.value!==ke){G.value=ke,Ae.value=!0;let ne="",ye="";fe.startTime&&(ne=cc(fe.startTime)),fe.endTime&&(ye=cc(fe.endTime)),g.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:ne,endTime:ye,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ye(()=>s.show,fe=>{fe?(i.value="details",l.value=!1,h.value=[],f.value=[],v.value=[],c.value?.clearPendingChanges&&c.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(G.value=null,Ae.value=!1)});const X=fe=>{g.value=fe},te=()=>{o("update:isDirty",!0)},Ce=()=>{l.value=!l.value,o("move-location",{isMoving:l.value,formData:{...g.value}})},Ne=fe=>{h.value=fe,te()},Fe=()=>{de.value&&(i.value=de.value.value)},Ee=()=>{const fe={...g.value,startTime:g.value.useCustomTimes&&g.value.startTime?new Date(g.value.startTime).toISOString():null,endTime:g.value.useCustomTimes&&g.value.endTime?new Date(g.value.endTime).toISOString():null,checkInChanges:c.value?.getPendingChanges?.()||[],assignmentsToRemove:c.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:s.assignments.filter(ke=>ke.isPending).map(ke=>({marshalId:ke.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:v.value};o("save",fe)},oe=()=>{s.location&&s.location.id&&o("delete",s.location.id)},ge=fe=>{o("remove-assignment",fe)},Be=()=>{o("open-assign-modal")},Oe=fe=>{o("select-marshal",fe)},xe=()=>{o("close")},me=(fe,ke)=>{g.value[fe]=ke,te()},Ze=fe=>{o("reorder-notes",fe)},qe=fe=>{o("reorder-checklists",fe)};return(fe,ke)=>(p(),Ge(Yt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:xe},{header:Ve(()=>[r("h2",ZR,[z.value?(p(),y("span",{key:0,class:"modal-title-icon",innerHTML:z.value},null,8,KR)):P("",!0),Je(" "+_(ee.value),1)])]),"tab-header":Ve(()=>[Pe(ul,{modelValue:i.value,"onUpdate:modelValue":ke[0]||(ke[0]=ne=>i.value=ne),tabs:ue.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",kO,[r("div",bO,[J.value&&!e.lockedFromMarshal?(p(),y("button",{key:0,type:"button",onClick:oe,class:"btn btn-danger"}," Delete ")):P("",!0),!J.value&&!$e.value?(p(),y("button",{key:1,type:"button",onClick:Fe,class:"btn btn-secondary mobile-only"},_(ie.value),1)):P("",!0)]),r("button",{type:"button",onClick:Ee,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[i.value==="details"?(p(),Ge(lD,{key:0,form:g.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":K.value,"area-term-plural":q.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,"onUpdate:form":X,onInput:te,onSave:Ee},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),i.value==="location"?(p(),Ge(f5,{key:1,form:g.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":J.value,"onUpdate:form":X,onInput:te,onSave:Ee,onMoveLocation:Ce},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),i.value==="marshals"?(p(),Ge(N5,{key:2,ref_key:"assignmentsTabRef",ref:c,form:g.value,assignments:e.assignments,"people-term":U.value,"person-term":Q.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":X,onInput:te,onRemoveAssignment:ge,onOpenAssignModal:Be,onSelectMarshal:Oe,onDistanceClick:x},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),i.value==="checklists"&&J.value?(p(),Ge(T1,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":ke[1]||(ke[1]=ne=>h.value=ne),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onChange:Ne,onReorder:qe},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):P("",!0),i.value==="checklists"?(p(),Ge(IR,{key:4,modelValue:f.value,"onUpdate:modelValue":ke[2]||(ke[2]=ne=>f.value=ne),"all-checklist-items":e.allChecklistItems,"pending-area-ids":g.value.areaIds,areas:e.areas,"is-editing":J.value,"checkpoint-term-singular":j.value,onChange:te},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="notes"&&J.value?(p(),Ge(rd,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Ze},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),i.value==="notes"?(p(),Ge(WR,{key:6,modelValue:v.value,"onUpdate:modelValue":ke[3]||(ke[3]=ne=>v.value=ne),"all-notes":e.notes,"pending-area-ids":g.value.areaIds,areas:e.areas,"is-editing":J.value,"checkpoint-term-singular":j.value,onChange:te},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),i.value==="appearance"?(p(),y("div",YR,[r("div",JR,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.iconStyle}]),onClick:ke[4]||(ke[4]=ne=>O("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:be.value},null,8,XR),r("span",QR,_(j.value)+" marker style",1),r("span",eO,_(M.value.iconStyle?"":""),1)],2),M.value.iconStyle?(p(),y("div",tO,[r("p",nO," Choose a custom icon for this "+_(Z.value)+", or leave as Default to inherit from "+_(ae.value)+" or event settings. ",1),Pe(Hf,{"style-type":g.value.styleType||"default","style-color":g.value.styleColor||"","style-background-shape":g.value.styleBackgroundShape||"","style-background-color":g.value.styleBackgroundColor||"","style-border-color":g.value.styleBorderColor||"","style-icon-color":g.value.styleIconColor||"","style-size":g.value.styleSize||"","style-map-rotation":g.value.styleMapRotation??"","inherited-style-type":De.value.type,"inherited-style-color":De.value.color,"inherited-background-shape":De.value.backgroundShape||"","inherited-background-color":De.value.backgroundColor||De.value.color||"","inherited-border-color":De.value.borderColor||"","inherited-icon-color":De.value.iconColor||"","inherited-size":De.value.size||"","inherited-map-rotation":De.value.mapRotation??"","default-label":Re.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ke[5]||(ke[5]=ne=>me("styleType",ne)),"onUpdate:styleColor":ke[6]||(ke[6]=ne=>me("styleColor",ne)),"onUpdate:styleBackgroundShape":ke[7]||(ke[7]=ne=>me("styleBackgroundShape",ne)),"onUpdate:styleBackgroundColor":ke[8]||(ke[8]=ne=>me("styleBackgroundColor",ne)),"onUpdate:styleBorderColor":ke[9]||(ke[9]=ne=>me("styleBorderColor",ne)),"onUpdate:styleIconColor":ke[10]||(ke[10]=ne=>me("styleIconColor",ne)),"onUpdate:styleSize":ke[11]||(ke[11]=ne=>me("styleSize",ne)),"onUpdate:styleMapRotation":ke[12]||(ke[12]=ne=>me("styleMapRotation",ne))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),r("div",oO,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.terminology}]),onClick:ke[13]||(ke[13]=ne=>O("terminology"))},[ke[17]||(ke[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ke[18]||(ke[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",sO,_(Y.value),1),r("span",aO,_(M.value.terminology?"":""),1)],2),M.value.terminology?(p(),y("div",iO,[r("p",lO," Customise what this "+_(Z.value)+" and its "+_(U.value.toLowerCase())+" are called. ",1),r("div",rO,[r("div",cO,[r("label",null,"What is this "+_(Z.value)+" called?",1),r("select",{value:g.value.checkpointTerm,class:"form-input",onChange:ke[14]||(ke[14]=ne=>{X({...g.value,checkpointTerm:ne.target.value}),te()})},[r("option",dO,"Use "+_(ae.value)+" default ("+_(j.value)+")",1),ke[19]||(ke[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),ke[20]||(ke[20]=r("option",{value:"Car"},"Car",-1)),ke[21]||(ke[21]=r("option",{value:"Bike"},"Bike",-1)),(p(!0),y(Ie,null,je(N(ya).checkpoint,ne=>(p(),y("option",{key:ne,value:ne},_(ne),9,hO))),128))],40,uO)]),r("div",fO,[r("label",null,"What are "+_(U.value.toLowerCase())+" called here?",1),r("select",{value:g.value.peopleTerm,class:"form-input",onChange:ke[15]||(ke[15]=ne=>{X({...g.value,peopleTerm:ne.target.value}),te()})},[r("option",vO,"Use "+_(ae.value)+" default ("+_(E.value)+")",1),(p(!0),y(Ie,null,je(N(ya).people,ne=>(p(),y("option",{key:ne,value:ne},_(ne),9,mO))),128))],40,pO)])])])):P("",!0)])])):P("",!0),i.value==="incidents"?(p(),y("div",gO,[r("div",yO,[(p(!0),y(Ie,null,je(e.incidents,ne=>(p(),Ge(bc,{key:ne.incidentId,incident:ne,onSelect:ke[16]||(ke[16]=ye=>fe.$emit("select-incident",ye))},null,8,["incident"]))),128))])])):P("",!0),Pe(Nf,{show:k.value,"marshal-name":T.value,"checkpoint-name":w.value,"check-in-location":C.value,"checkpoint-location":I.value,distance:$.value,"z-index":e.zIndex+100,onClose:A},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},_O=Ke(wO,[["__scopeId","data-v-221a28c2"]]),CO={class:"tab-content"},LO={key:0,class:"error-banner"},IO=["value"],SO={key:0,class:"field-error"},xO={class:"contact-row"},$O=["value"],TO={key:0,class:"field-error"},MO=["value"],AO={key:0,class:"field-error"},EO=["value"],PO={key:0,class:"field-error"},DO={key:1,class:"magic-link-section"},RO={key:0,class:"loading-text"},OO={key:1,class:"magic-link-container"},BO={class:"magic-link-row"},NO=["value"],FO={key:0,class:"error-text"},UO={key:1,class:"magic-link-actions"},zO=["disabled"],HO={key:2,class:"success-text"},VO={key:3,class:"error-text"},GO={key:2,class:"error-text"},qO={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:n}){const s=e,o=n,i=D(null),l=D(null),c=D(null),d=D(null),h=D(""),f=D(!1),v=D(!1),g=D(""),k=D(!1),b=D(!1),x=D(!1),A=D(""),T=D(!1),w=(O,E)=>{o("update:form",{...s.form,[O]:E}),o("input")},C=async()=>{if(!(!s.eventId||!s.marshalId)){v.value=!0,g.value="";try{const O=await bs.getMagicLink(s.eventId,s.marshalId);h.value=O.data.magicLink,f.value=O.data.hasEmail}catch(O){console.error("Failed to fetch magic link:",O),g.value="Failed to load login link"}finally{v.value=!1}}},I=D(""),$=async()=>{I.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(O){console.warn("Clipboard API failed, trying fallback:",O)}try{const O=document.createElement("textarea");O.value=h.value,O.style.position="fixed",O.style.left="-9999px",O.style.top="0",document.body.appendChild(O),O.focus(),O.select();const E=document.execCommand("copy");document.body.removeChild(O),E?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(I.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3))}catch(O){console.error("Fallback copy failed:",O),I.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3)}},R=async()=>{if(!(!s.eventId||!s.marshalId)){b.value=!0,x.value=!1,A.value="";try{await bs.sendMagicLink(s.eventId,s.marshalId),x.value=!0,setTimeout(()=>{x.value=!1},3e3)}catch(O){console.error("Failed to send email:",O),A.value=O.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ye(()=>s.marshalId,O=>{O?C():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:O=>{cn(()=>{const U={name:i,email:l,phoneNumber:c,notes:d}[O];U?.value&&(U.value.focus(),U.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(O,E)=>(p(),y("div",CO,[e.validationErrors.general?(p(),y("div",LO,_(e.validationErrors.general),1)):P("",!0),r("div",{class:le(["form-group",{"has-error":e.validationErrors.name}])},[E[7]||(E[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:E[0]||(E[0]=U=>w("name",U.target.value)),type:"text",required:"",class:le(["form-input",{"input-error":e.validationErrors.name}])},null,42,IO),e.validationErrors.name?(p(),y("span",SO,_(e.validationErrors.name),1)):P("",!0)],2),r("div",xO,[r("div",{class:le(["form-group contact-email",{"has-error":e.validationErrors.email}])},[E[8]||(E[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:E[1]||(E[1]=U=>w("email",U.target.value)),type:"email",class:le(["form-input",{"input-error":e.validationErrors.email}])},null,42,$O),e.validationErrors.email?(p(),y("span",TO,_(e.validationErrors.email),1)):P("",!0)],2),r("div",{class:le(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[E[9]||(E[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:c,value:e.form.phoneNumber,onInput:E[2]||(E[2]=U=>w("phoneNumber",U.target.value)),type:"tel",class:le(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,MO),e.validationErrors.phoneNumber?(p(),y("span",AO,_(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),r("div",{class:le(["form-group",{"has-error":e.validationErrors.notes}])},[E[10]||(E[10]=r("label",null,"Additional details",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:E[3]||(E[3]=U=>w("notes",U.target.value)),class:le(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,EO),e.validationErrors.notes?(p(),y("span",PO,_(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(p(),y("div",DO,[E[12]||(E[12]=r("label",null,"Login link",-1)),E[13]||(E[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),v.value?(p(),y("div",RO,"Loading link...")):h.value?(p(),y("div",OO,[r("div",BO,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:E[4]||(E[4]=U=>U.target.select())},null,40,NO),r("button",{type:"button",class:"btn btn-secondary",onClick:$},_(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:E[5]||(E[5]=U=>T.value=!0),title:"Show QR code"},[...E[11]||(E[11]=[vi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6c3801fd><rect x="3" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="3" y="14" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="14" width="3" height="3" data-v-6c3801fd></rect><rect x="19" y="14" width="2" height="2" data-v-6c3801fd></rect><rect x="14" y="19" width="2" height="2" data-v-6c3801fd></rect><rect x="19" y="19" width="2" height="2" data-v-6c3801fd></rect></svg>',1)])])]),I.value?(p(),y("p",FO,_(I.value),1)):P("",!0),f.value?(p(),y("div",UO,[r("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:R},_(b.value?"Sending...":"Send via email"),9,zO)])):P("",!0),x.value?(p(),y("p",HO,"Email sent successfully!")):P("",!0),A.value?(p(),y("p",VO,_(A.value),1)):P("",!0)])):g.value?(p(),y("div",GO,_(g.value),1)):P("",!0)])):P("",!0),Pe(Gf,{show:T.value,url:h.value,title:"Scan to log in",onClose:E[6]||(E[6]=U=>T.value=!1)},null,8,["show","url"])]))}},jO=Ke(qO,[["__scopeId","data-v-6c3801fd"]]),WO={class:"card-header"},ZO={class:"checkpoint-name-row"},KO=["innerHTML"],YO={class:"checkpoint-name"},JO={key:0,class:"checkpoint-description"},XO={key:0,class:"card-areas"},QO={key:1,class:"card-check-in"},eB={key:0,class:"check-in-time"},tB={key:0,class:"check-in-method"},nB={key:1,class:"unsaved-indicator"},oB={key:2,class:"card-locked"},sB={class:"locked-badge"},aB={key:3,class:"card-badge"},iB={key:4,class:"card-badge"},lB={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.location?s.location.areaIds||s.location.AreaIds||[]:[]),l=H(()=>i.value.map(T=>{const w=s.areas.find(C=>C.id===T);return w?w.name:null}).filter(Boolean)),c=H(()=>i.value.map(T=>{const w=s.areas.find(C=>C.id===T);return w?w.color:"#999"})),d=H(()=>{if(!s.location)return"#667eea";const T=s.location,w=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor;if(w)return w;if(i.value.length>0){const C=s.areas.find(I=>I.id===i.value[0]);if(C)return C.color}return"#667eea"}),h=H(()=>{if(!s.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const T=s.location,w=T.resolvedStyleType||T.ResolvedStyleType,C=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor,I=T.resolvedStyleBorderColor||T.ResolvedStyleBorderColor,$=T.resolvedStyleIconColor||T.ResolvedStyleIconColor,R=T.resolvedStyleBackgroundShape||T.ResolvedStyleBackgroundShape;return w&&w!=="default"||C||I||$||R&&R!=="circle"?zn({type:w||"circle",backgroundShape:R||"circle",backgroundColor:C||"#667eea",borderColor:I||"#ffffff",iconColor:$||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=T=>T?new Date(T).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",v=H(()=>{const{checkedInBy:T,checkInMethod:w,marshalName:C}=s.assignment;return T&&T!==C?T:w||""}),g=H(()=>{const{checkInLatitude:T,checkInLongitude:w}=s.assignment,C=s.location;return!T||!w||!C?.latitude||!C?.longitude?null:sl(T,w,C.latitude,C.longitude)}),k=H(()=>g.value===null?null:g.value<1e3?`${Math.round(g.value)} m`:`${(g.value/1e3).toFixed(2)} km`),b=H(()=>g.value===null?"":g.value<=50?"distance-close":g.value<=100?"distance-medium":"distance-far"),x=()=>{!s.assignment.isPending&&!s.isMarkedForRemoval&&!s.isLocked&&o("click",s.assignment)},A=()=>{o("distance-click",s.assignment)};return(T,w)=>(p(),y("div",{class:le(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:tt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",WO,[r("div",{class:"card-title",onClick:x},[r("span",ZO,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,KO),r("span",YO,_(e.assignment.locationName),1),e.assignment.locationDescription?(p(),y("span",JO,"  "+_(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(p(),y("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:w[0]||(w[0]=rt(C=>T.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(p(),y("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:w[1]||(w[1]=rt(C=>T.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(p(),y("div",XO,[(p(!0),y(Ie,null,je(l.value,(C,I)=>(p(),y("span",{key:I,class:"area-badge",style:tt({backgroundColor:c.value[I]})},_(C),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(p(),y("div",QO,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:w[2]||(w[2]=C=>T.$emit("toggle-check-in",e.assignment))},[...w[3]||(w[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),y("span",eB,[Je(_(f(e.assignment.checkInTime))+" ",1),v.value?(p(),y("span",tB,"("+_(v.value)+")",1)):P("",!0),k.value?(p(),y("span",{key:1,class:le(["check-in-distance",b.value]),onClick:rt(A,["stop"])},_(k.value),3)):P("",!0)])):e.hasUnsavedChanges?(p(),y("span",nB," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(p(),y("div",oB,[r("span",sB,"Viewing from this "+_(N(n).checkpoint),1)])):P("",!0),e.assignment.isPending?(p(),y("div",aB,[...w[4]||(w[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),y("div",iB,[...w[5]||(w[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},rB=Ke(lB,[["__scopeId","data-v-d3de6925"]]),cB={class:"tab-content"},uB={key:0,class:"read-only-notice"},dB={class:"section-title"},hB={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},fB={value:""},pB=["value"],vB={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,{pendingCheckInChanges:l,getEffectiveCheckInStatus:c,handleToggleCheckIn:d}=$1(()=>i("input")),h=D(""),f=D(new Set),v=H(()=>o.assignments?.length||0),g=U=>o.allLocations&&o.allLocations.find(F=>F.id===U)||null,k=H(()=>[...o.assignments].sort((U,F)=>(U.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=U=>f.value.has(U),x=U=>{U.isPending||i("select-checkpoint",U)},A=D(!1),T=D(null),w=U=>{c(U)?(T.value=U,A.value=!0):d(U)},C=()=>{T.value&&d(T.value),A.value=!1,T.value=null},I=()=>{A.value=!1,T.value=null},$=H(()=>T.value?`Are you sure you want to undo ${T.value.marshalName||"this marshal"}'s check-in?`:""),R=U=>{U.isPending?i("remove-assignment",U):(f.value.add(U.id),i("input"))},M=U=>{f.value.delete(U.id),i("input")},O=H(()=>{const U=[...o.availableLocations];return U.sort((F,j)=>F.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),U}),E=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([U,F])=>({assignmentId:U,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(U,F)=>(p(),y("div",cB,[e.lockedCheckpointId?(p(),y("div",uB," Viewing from "+_(N(s).checkpoint)+" - "+_(N(s).checkpoints)+" cannot be modified here. ",1)):P("",!0),r("h3",dB,"Assigned "+_(N(s).checkpoints)+" ("+_(v.value)+")",1),Pe(wc,{"is-empty":e.assignments.length===0,"empty-message":`No ${N(s).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${N(s).person} to ${N(s).checkpoints}.`},{default:Ve(()=>[(p(!0),y(Ie,null,je(k.value,j=>(p(),Ge(rB,{key:j.id,assignment:j,location:g(j.locationId),areas:e.areas,"effective-check-in-status":N(c)(j),"has-unsaved-changes":N(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b(j.id),onClick:x,onToggleCheckIn:w,onRemove:R,onUndoRemove:M,onDistanceClick:F[0]||(F[0]=Z=>U.$emit("distance-click",Z))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&O.value.length>0?(p(),y("div",hB,[r("label",null,"Assign to "+_(N(s).checkpoint),1),We(r("select",{"onUpdate:modelValue":F[1]||(F[1]=j=>h.value=j),class:"form-input",onChange:E},[r("option",fB,"Select a "+_(N(s).checkpoint)+"...",1),(p(!0),y(Ie,null,je(O.value,j=>(p(),y("option",{key:j.id,value:j.id},[Je(_(j.name),1),j.description?(p(),y(Ie,{key:0},[Je(" - "+_(j.description),1)],64)):P("",!0)],8,pB))),128))],544),[[no,h.value]])])):P("",!0),Pe(gi,{show:A.value,title:"Confirm check-out",message:$.value,"confirm-text":"Check out","is-danger":!0,onConfirm:C,onCancel:I},null,8,["show","message"])]))}},mB=Ke(vB,[["__scopeId","data-v-07754949"]]),gB={class:"tab-content roles-tab"},yB={key:0,class:"empty-state"},kB={class:"help-text"},bB={key:1,class:"roles-list"},wB={class:"roles-label"},_B={class:"available-roles"},CB=["onClick"],LB={class:"role-checkbox"},IB=["checked","onChange"],SB={class:"role-info"},xB={class:"role-name"},$B={__name:"MarshalRolesTab",props:{roles:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["update:roles","input"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=H(()=>s.roles||[]),l=D(new Set);Ye(()=>s.roles,f=>{l.value.size===0&&f&&f.length>0&&(l.value=new Set(f))},{immediate:!0});const c=H(()=>[...s.roleDefinitions].sort((f,v)=>{const g=l.value.has(f.roleId),k=l.value.has(v.roleId);return g!==k?g?-1:1:f.displayOrder!==v.displayOrder?(f.displayOrder||0)-(v.displayOrder||0):(f.name||"").localeCompare(v.name||"",void 0,{numeric:!0,sensitivity:"base"})})),d=H(()=>c.value),h=f=>{const v=i.value.includes(f);let g;v?g=i.value.filter(k=>k!==f):g=[...i.value,f],o("update:roles",g),o("input")};return(f,v)=>(p(),y("div",gB,[e.roleDefinitions.length===0?(p(),y("div",yB,[v[1]||(v[1]=r("p",null,"No roles have been defined for this event yet.",-1)),r("p",kB,"Create roles in the Roles tab to assign them to "+_(N(n).people)+".",1)])):(p(),y("div",bB,[r("label",wB,"Select roles for this "+_(N(n).person),1),r("div",_B,[(p(!0),y(Ie,null,je(d.value,g=>(p(),y("div",{key:g.roleId,class:le(["role-option",{selected:i.value.includes(g.roleId)}]),onClick:k=>h(g.roleId)},[r("div",LB,[r("input",{type:"checkbox",checked:i.value.includes(g.roleId),onClick:v[0]||(v[0]=rt(()=>{},["stop"])),onChange:k=>h(g.roleId)},null,40,IB)]),r("div",SB,[r("span",xB,_(g.name),1)])],10,CB))),128))])]))]))}},TB=Ke($B,[["__scopeId","data-v-f56e155c"]]),MB={class:"marshal-checklist-view"},AB={key:0,class:"loading-state"},EB={key:1,class:"error-state"},PB={key:2,class:"empty-state"},DB={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:s}=dt(),o=e,i=n,l=D([]),c=D(!1),d=D(null),h=D(new Map),f=H(()=>l.value.map(A=>{const T=h.value.get(A.itemId),w=T!==void 0?T.complete:A.isCompleted,C=T!==void 0&&T.complete!==A.isCompleted;return{...A,localIsCompleted:w,isModified:C}})),v=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,d.value=null;try{const A=await Ot.getMarshalChecklist(o.eventId,o.marshalId);if(l.value=Bf(A.data)||[],o.modelValue&&o.modelValue.length>0){const T=new Map;o.modelValue.forEach(w=>{T.set(w.itemId,{complete:w.complete,contextType:w.contextType,contextId:w.contextId})}),h.value=T}}catch(A){console.error("Failed to load checklist:",A),d.value=A.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},g=A=>{const T=h.value.get(A.itemId),w=T!==void 0?T.complete:A.isCompleted;h.value.set(A.itemId,{complete:!w,contextType:A.completionContextType,contextId:A.completionContextId}),k()},k=()=>{const A=[];for(const[T,w]of h.value.entries()){const C=l.value.find(I=>I.itemId===T);C&&w.complete!==C.isCompleted&&A.push({itemId:T,complete:w.complete,contextType:w.contextType,contextId:w.contextId})}i("update:modelValue",A),i("change",A)},b=A=>{i("reorder",A)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const A=new Map;o.modelValue.forEach(T=>{A.set(T.itemId,{complete:T.complete,contextType:T.contextType,contextId:T.contextId})}),h.value=A}},loadChecklist:v}),Ye(()=>[o.eventId,o.marshalId],()=>{v()},{immediate:!0}),(A,T)=>(p(),y("div",MB,[c.value?(p(),y("div",AB," Loading checklist... ")):d.value?(p(),y("div",EB,[r("p",null,_(d.value),1),r("button",{onClick:v,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(p(),y("div",PB,[r("p",null,"No checklist items for this "+_(N(s).person)+".",1)])):(p(),Ge(qf,{key:3,items:f.value,locations:e.locations,areas:e.areas,"allow-reorder":e.allowReorder,onToggleComplete:g,onReorder:b},null,8,["items","locations","areas","allow-reorder"]))]))}},RB=Ke(DB,[["__scopeId","data-v-a60af2d8"]]),OB={class:"checklist-preview"},BB={class:"preview-actions"},NB={class:"preview-header"},FB={key:0,class:"add-item-form"},UB=["placeholder"],zB=["disabled"],HB={key:1,class:"pending-items"},VB={class:"item-content"},GB={class:"item-header"},qB={class:"item-text"},jB={class:"item-scope"},WB=["onClick"],ZB={key:2,class:"empty-state"},KB={key:0,class:"help-text"},YB={key:3,class:"checklist-items"},JB={class:"item-content"},XB={class:"item-header"},QB={class:"item-text"},eN={class:"item-scope"},tN=["title"],nN={key:0,class:"item-context"},oN={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,w=>{c.value=[...w]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=w=>{c.value.splice(w,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")},v=H(()=>{const w=new Set;for(const C of s.pendingLocationIds){const I=s.allLocations.find($=>$.id===C);I&&(I.areaIds||I.AreaIds||[]).forEach(R=>w.add(R))}return[...w]}),g=w=>{const C=w.scope,I=w.itemType,$=w.ids||[];return C==="SpecificPeople"&&I==="Marshal"?$.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&I==="Checkpoint"?$.includes("ALL_CHECKPOINTS")?!0:$.some(R=>s.pendingLocationIds.includes(R)):C==="OnePerCheckpoint"&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>v.value.includes(R)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(R=>v.value.includes(R)):!1},k=H(()=>s.allChecklistItems.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0?w.scopeConfigurations.some(C=>g(C)):!1)),b=w=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,EveryoneInAreas:`All in ${n.value.areas}`,OnePerArea:`One per ${n.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${n.value.area}`})[w]||w,x=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"Unknown";const C=w.scopeConfigurations.find($=>g($));if(!C)return b(w.scopeConfigurations[0].scope);const I=C.ids||[];return I.includes("ALL_MARSHALS")?"Everyone":I.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${n.value.areas}`:b(C.scope)},A=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"";const C=w.scopeConfigurations.find($=>g($));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${n.value.checkpoints}`,OnePerCheckpoint:`One person at each ${n.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${n.value.areas}`,OnePerArea:`One person in each ${n.value.area} needs to complete this`,EveryAreaLead:`This item is for ${n.value.area} leads only`,OneLeadPerArea:`One ${n.value.area} lead needs to complete this`}[C.scope]||""},T=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return null;const C=w.scopeConfigurations.find(R=>g(R));if(!C)return null;const I=C.itemType,$=C.ids||[];if($.includes("ALL_MARSHALS")||$.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(I==="Checkpoint"){const R=s.allLocations.filter(M=>$.includes(M.id)&&s.pendingLocationIds.includes(M.id)).map(M=>M.name);if(R.length>0)return`At: ${R.join(", ")}`}if(I==="Area"){const R=s.areas.filter(M=>$.includes(M.id)&&v.value.includes(M.id)).map(M=>M.name);if(R.length>0)return`In: ${R.join(", ")}`}return null};return(w,C)=>(p(),y("div",OB,[r("div",BB,[r("p",NB,_(e.isEditing?`Add new ${N(n).checklist} for this ${N(n).person}:`:`${N(n).checklists} that will apply to this ${N(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=I=>i.value=!i.value)},_(i.value?"Cancel":`Add ${N(n).checklist}`),1)]),i.value?(p(),y("div",FB,[We(r("input",{"onUpdate:modelValue":C[1]||(C[1]=I=>l.value=I),type:"text",placeholder:`Enter ${N(n).checklist} text...`,class:"add-item-input",onKeyup:Xo(d,["enter"])},null,40,UB),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,zB)])):P("",!0),c.value.length>0?(p(),y("div",HB,[(p(!0),y(Ie,null,je(c.value,(I,$)=>(p(),y("div",{key:`pending-${$}`,class:"checklist-item pending"},[C[3]||(C[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",VB,[r("div",GB,[r("div",qB,_(I.text),1),r("div",jB,[C[2]||(C[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:R=>h($),title:"Remove"},"  ",8,WB)])])])]))),128))])):P("",!0),!e.isEditing&&k.value.length===0&&c.value.length===0?(p(),y("div",ZB,[r("p",null,"No "+_(N(n).checklists)+" will apply based on the current "+_(N(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),y("p",KB," Assign "+_(N(n).checkpoints)+" to see relevant "+_(N(n).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&k.value.length>0?(p(),y("div",YB,[(p(!0),y(Ie,null,je(k.value,I=>(p(),y("div",{key:I.id,class:"checklist-item"},[C[4]||(C[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",JB,[r("div",XB,[r("div",QB,_(I.text),1),r("div",eN,[r("span",{class:"scope-pill",title:A(I)},_(x(I)),9,tN)])]),T(I)?(p(),y("div",nN,_(T(I)),1)):P("",!0)])]))),128))])):P("",!0)]))}},sN=Ke(oN,[["__scopeId","data-v-6deaacc2"]]),aN={class:"notes-preview"},iN={class:"preview-actions"},lN={class:"preview-header"},rN={key:0,class:"add-item-form"},cN={class:"add-form-fields"},uN=["disabled"],dN={key:1,class:"pending-items"},hN={class:"note-header"},fN={class:"note-title"},pN={class:"note-actions"},vN=["onClick"],mN={key:0,class:"note-content"},gN={key:2,class:"empty-state"},yN={key:0,class:"help-text"},kN={key:3,class:"notes-list"},bN={class:"note-header"},wN={class:"note-title"},_N=["title"],CN={key:0,class:"note-content"},LN={key:1,class:"note-context"},IN={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,C=>{d.value=[...C]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,v())},f=C=>{d.value.splice(C,1),v()},v=()=>{o("update:modelValue",[...d.value]),o("change")},g=H(()=>{const C=new Set;for(const I of s.pendingLocationIds){const $=s.allLocations.find(R=>R.id===I);$&&($.areaIds||$.AreaIds||[]).forEach(M=>C.add(M))}return[...C]}),k=C=>{const I=C.scope,$=C.itemType,R=C.ids||[];return I==="SpecificPeople"&&$==="Marshal"?R.includes("ALL_MARSHALS"):I==="EveryoneAtCheckpoints"&&$==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(M=>s.pendingLocationIds.includes(M)):I==="EveryoneInAreas"&&$==="Area"?R.includes("ALL_AREAS")?!0:R.some(M=>g.value.includes(M)):!1},b=H(()=>s.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(I=>k(I)):!1)),x=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[C]||C,A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const I=C.scopeConfigurations.find(R=>k(R));if(!I)return x(C.scopeConfigurations[0].scope);const $=I.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const I=C.scopeConfigurations.find(R=>k(R));return I&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},w=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const I=C.scopeConfigurations.find(M=>k(M));if(!I)return null;const $=I.itemType,R=I.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const M=s.allLocations.filter(O=>R.includes(O.id)&&s.pendingLocationIds.includes(O.id)).map(O=>O.name);if(M.length>0)return`At: ${M.join(", ")}`}if($==="Area"){const M=s.areas.filter(O=>R.includes(O.id)&&g.value.includes(O.id)).map(O=>O.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(C,I)=>(p(),y("div",aN,[r("div",iN,[r("p",lN,_(e.isEditing?`Add new note for this ${N(n).person}:`:`Notes that will be visible to this ${N(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=$=>i.value=!i.value)},_(i.value?"Cancel":"Add note"),1)]),i.value?(p(),y("div",rN,[r("div",cN,[We(r("input",{"onUpdate:modelValue":I[1]||(I[1]=$=>l.value=$),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=$=>c.value=$),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,uN)])):P("",!0),d.value.length>0?(p(),y("div",dN,[(p(!0),y(Ie,null,je(d.value,($,R)=>(p(),y("div",{key:`pending-${R}`,class:"note-item pending"},[r("div",hN,[r("span",fN,_($.title||"Untitled"),1),r("div",pN,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>f(R),title:"Remove"},"  ",8,vN)])]),$.content?(p(),y("div",mN,_($.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(p(),y("div",gN,[r("p",null,"No notes will be visible based on the current "+_(N(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),y("p",yN," Assign "+_(N(n).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(p(),y("div",kN,[(p(!0),y(Ie,null,je(b.value,$=>(p(),y("div",{key:$.id,class:"note-item"},[r("div",bN,[r("span",wN,_($.title||"Untitled"),1),r("span",{class:"scope-pill",title:T($)},_(A($)),9,_N)]),$.content?(p(),y("div",CN,_($.content),1)):P("",!0),w($)?(p(),y("div",LN,_(w($)),1)):P("",!0)]))),128))])):P("",!0)]))}},SN=Ke(IN,[["__scopeId","data-v-e8e0946a"]]),xN={key:6,class:"tab-content incidents-tab"},$N={class:"incidents-list"},TN={class:"custom-footer"},MN={class:"footer-left"},AN={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3},roleDefinitions:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint","reorder-notes","reorder-checklists"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=e,l=n,c=D("details"),d=D(null),h=D(null),f=D(null),v=D([]),g=D([]),k=D([]),b=D([]),x=D({name:"",email:"",phoneNumber:"",notes:"",roles:[]}),A=D(!1),T=D(null),w=te=>{T.value=te,A.value=!0},C=()=>{A.value=!1,T.value=null},I=te=>i.allLocations.find(Ce=>Ce.id===te),$=H(()=>x.value.name||i.marshal?.name||""),R=H(()=>T.value&&I(T.value.locationId)?.name||""),M=H(()=>{if(!T.value)return null;const{checkInLatitude:te,checkInLongitude:Ce}=T.value;return!te||!Ce?null:{lat:te,lng:Ce}}),O=H(()=>{if(!T.value)return null;const te=I(T.value.locationId);return!te?.latitude||!te?.longitude?null:{lat:te.latitude,lng:te.longitude}}),E=H(()=>{if(!T.value)return null;const{checkInLatitude:te,checkInLongitude:Ce,locationId:Ne}=T.value,Fe=I(Ne);return!te||!Ce||!Fe?.latitude||!Fe?.longitude?null:sl(te,Ce,Fe.latitude,Fe.longitude)}),U=H(()=>{const te=i.isEditing?`Edit ${o.value.person}`:`Create ${o.value.person}`,Ce=x.value.name?.trim();return Ce?`${te} - ${Ce}`:te}),F=H(()=>{const te=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:s.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&te.push({value:"incidents",label:"Incidents",icon:"incidents"}),te.push({value:"roles",label:"Roles",icon:"roles"}),te}),j=H(()=>F.value.findIndex(te=>te.value===c.value)),Z=H(()=>j.value===F.value.length-1),Q=H(()=>Z.value?null:F.value[j.value+1]),re=H(()=>Q.value?`${Q.value.label}...`:""),K=H(()=>g.value.map(te=>te.locationId)),ae=H(()=>i.isEditing?i.assignments:g.value.map(te=>({id:`pending-${te.locationId}`,locationId:te.locationId,locationName:i.allLocations.find(Ce=>Ce.id===te.locationId)?.name||"Unknown",isPending:!0}))),q=H(()=>{if(i.isEditing)return i.availableLocations;const te=g.value.map(Ce=>Ce.locationId);return i.allLocations.filter(Ce=>!te.includes(Ce.id))});Ye(()=>i.marshal,te=>{te?x.value={name:te.name||"",email:te.email||"",phoneNumber:te.phoneNumber||"",notes:te.notes||"",roles:te.roles||[]}:x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}},{immediate:!0,deep:!0}),Ye(()=>i.show,te=>{te&&(c.value="details",v.value=[],g.value=[],k.value=[],b.value=[],i.isEditing||(x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const J=te=>{x.value=te},ee=te=>{x.value={...x.value,roles:te}},ue=()=>{l("update:isDirty",!0)},_e=()=>{l("update:isDirty",!0)},$e=()=>{Q.value&&(c.value=Q.value.value)},De=te=>{l("reorder-notes",te)},Re=te=>{l("reorder-checklists",te)},be=()=>{const te={...x.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:v.value||[],pendingAssignments:i.isEditing?[]:g.value,pendingNewChecklistItems:k.value,pendingNewNotes:b.value};l("save",te)},z=()=>{l("delete")},Y=te=>{!i.isEditing&&te.isPending?g.value=g.value.filter(Ce=>Ce.locationId!==te.locationId):l("remove-assignment",te)},de=te=>{i.isEditing?l("assign-to-location",te):(g.value.push({locationId:te}),l("update:isDirty",!0))},ie=te=>{l("select-checkpoint",te)},Ae=()=>{l("close")};return t({switchToTab:te=>{c.value=te},focusField:te=>{d.value?.focusField&&d.value.focusField(te)}}),(te,Ce)=>(p(),Ge(Yt,{show:e.show,title:U.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:Ae},{"tab-header":Ve(()=>[Pe(ul,{modelValue:c.value,"onUpdate:modelValue":Ce[0]||(Ce[0]=Ne=>c.value=Ne),tabs:F.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",TN,[r("div",MN,[e.isEditing&&!e.lockedCheckpointId?(p(),y("button",{key:0,type:"button",onClick:z,class:"btn btn-danger"}," Delete ")):P("",!0),!e.isEditing&&!Z.value?(p(),y("button",{key:1,type:"button",onClick:$e,class:"btn btn-secondary mobile-only"},_(re.value),1)):P("",!0)]),r("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[c.value==="details"?(p(),Ge(jO,{key:0,ref_key:"detailsTabRef",ref:d,form:x.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":J,onInput:ue},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),c.value==="checkpoints"?(p(),Ge(mB,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:ae.value,"available-locations":q.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:ue,onRemoveAssignment:Y,onAssignToLocation:de,onSelectCheckpoint:ie,onDistanceClick:w},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),c.value==="checklists"&&e.isEditing?(p(),Ge(RB,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:v.value,"onUpdate:modelValue":Ce[1]||(Ce[1]=Ne=>v.value=Ne),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,"allow-reorder":!0,onChange:_e,onReorder:Re},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),c.value==="checklists"?(p(),Ge(sN,{key:3,modelValue:k.value,"onUpdate:modelValue":Ce[2]||(Ce[2]=Ne=>k.value=Ne),"all-checklist-items":e.allChecklistItems,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="notes"&&e.isEditing?(p(),Ge(rd,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:De},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),c.value==="notes"?(p(),Ge(SN,{key:5,modelValue:b.value,"onUpdate:modelValue":Ce[3]||(Ce[3]=Ne=>b.value=Ne),"all-notes":e.eventNotes,"pending-location-ids":K.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),c.value==="incidents"?(p(),y("div",xN,[r("div",$N,[(p(!0),y(Ie,null,je(e.incidents,Ne=>(p(),Ge(bc,{key:Ne.incidentId,incident:Ne,onSelect:Ce[4]||(Ce[4]=Fe=>te.$emit("select-incident",Fe))},null,8,["incident"]))),128))])])):P("",!0),c.value==="roles"?(p(),Ge(TB,{key:7,roles:x.value.roles,"role-definitions":e.roleDefinitions,"onUpdate:roles":ee,onInput:ue},null,8,["roles","role-definitions"])):P("",!0),Pe(Nf,{show:A.value,"marshal-name":$.value,"checkpoint-name":R.value,"check-in-location":M.value,"checkpoint-location":O.value,distance:E.value,"z-index":e.zIndex+100,onClose:C},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},EN=Ke(AN,[["__scopeId","data-v-131580b5"]]),PN={class:"locations-list"},DN={class:"conflict-actions"},RN={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=t,i=c=>{o("choice",c)},l=()=>{o("close")};return(c,d)=>(p(),Ge(Yt,{show:e.show,title:`${N(n).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ve(()=>[r("div",DN,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+_(N(s).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ve(()=>[r("p",null,[r("strong",null,_(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),r("ul",PN,[(p(!0),y(Ie,null,je(e.conflictData.locations,h=>(p(),y("li",{key:h},_(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},ON=Ke(RN,[["__scopeId","data-v-997e8aaa"]]),BN={key:0,class:"assign-marshal-section"},NN={value:""},FN=["value"],UN=["disabled"],zN={key:1,class:"assign-marshal-section create-mode"},HN={class:"form-group"},VN={class:"form-group"},GN={class:"form-group"},qN={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D({name:"",email:"",phoneNumber:""});Ye(()=>s.show,k=>{k||(i.value=!1,l.value="",c.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&o("assign-existing",l.value)},f=()=>{c.value.name&&o("create-and-assign",{...c.value})},v=()=>{i.value=!1,c.value={name:"",email:"",phoneNumber:""}},g=()=>{o("close")};return(k,b)=>(p(),Ge(Yt,{show:e.show,title:i.value?`Create new ${N(n).person}`:`Assign ${N(n).person} to ${e.locationName}`,size:"medium",onClose:g},{actions:Ve(()=>[i.value?(p(),y(Ie,{key:0},[r("button",{onClick:v,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ve(()=>[i.value?(p(),y("div",zN,[r("h3",null,"Create new "+_(N(n).person),1),r("div",HN,[b[5]||(b[5]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":b[1]||(b[1]=x=>c.value.name=x),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",VN,[b[6]||(b[6]=r("label",null,"Email",-1)),We(r("input",{"onUpdate:modelValue":b[2]||(b[2]=x=>c.value.email=x),type:"email",class:"form-input"},null,512),[[st,c.value.email]])]),r("div",GN,[b[7]||(b[7]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":b[3]||(b[3]=x=>c.value.phoneNumber=x),type:"tel",class:"form-input"},null,512),[[st,c.value.phoneNumber]])])])):(p(),y("div",BN,[r("h3",null,"Select existing "+_(N(n).person),1),We(r("select",{"onUpdate:modelValue":b[0]||(b[0]=x=>l.value=x),class:"form-input"},[r("option",NN,"Choose a "+_(N(n).person)+"...",1),(p(!0),y(Ie,null,je(e.marshals,x=>(p(),y("option",{key:x.id,value:x.id},[Je(_(x.name)+" ",1),x.assignedLocationIds&&x.assignedLocationIds.length>0?(p(),y(Ie,{key:0},[Je(" (assigned to "+_(x.assignedLocationIds.length)+" "+_(x.assignedLocationIds.length>1?N(n).checkpoints:N(n).checkpoint)+") ",1)],64)):P("",!0)],8,FN))),128))],512),[[no,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+_(N(n).person),9,UN),b[4]||(b[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+_(N(n).person),1)]))]),_:1},8,["show","title"]))}},jN=Ke(qN,[["__scopeId","data-v-fa70b913"]]),WN={class:"shift-times-content"},ZN={class:"info-text"},KN={class:"time-delta-info"},YN={class:"delta-detail"},JN={class:"delta-detail"},XN={class:"delta-summary"},QN={class:"affected-checkpoints"},e9={class:"option-selection"},t9={class:"radio-option"},n9={class:"radio-option"},o9={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:n,termsLower:s}=dt(),o=e,i=t,l=D("shift"),c=H(()=>{const g=new Date(o.oldEventDate);return new Date(o.newEventDate)-g}),d=g=>new Date(g).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=g=>{const k=Math.abs(g),b=g>=0?"+":"-",x=Math.floor(k/(1e3*60*60*24)),A=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),T=Math.floor(k%(1e3*60*60)/(1e3*60)),w=[];return x>0&&w.push(`${x}d`),A>0&&w.push(`${A}h`),T>0&&w.push(`${T}m`),`${b}${w.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:c.value})},v=()=>{i("cancel")};return(g,k)=>(p(),Ge(Yt,{show:e.show,title:`Shift ${N(n).checkpoint} Times?`,size:"medium",onClose:v},{actions:Ve(()=>[r("button",{type:"button",onClick:v,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},_(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ve(()=>[r("div",WN,[r("p",ZN," You've changed the event date/time. Some "+_(N(s).checkpoints)+" have custom times set. ",1),r("div",KN,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",YN," Old: "+_(d(e.oldEventDate)),1),r("div",JN," New: "+_(d(e.newEventDate)),1),r("div",XN," Delta: "+_(h(c.value)),1)]),r("p",QN,[r("strong",null,_(e.affectedCheckpointsCount)+" "+_(e.affectedCheckpointsCount===1?N(s).checkpoint:N(s).checkpoints),1),k[3]||(k[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),r("div",e9,[r("label",t9,[We(r("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>l.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[Np,l.value]]),r("div",null,[r("strong",null,"Shift all "+_(N(s).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",n9,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>l.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[Np,l.value]]),r("div",null,[r("strong",null,"Keep "+_(N(s).checkpoint)+" times unchanged",1),r("small",null,_(N(n).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},s9=Ke(o9,[["__scopeId","data-v-a6454aff"]]),a9={class:"checklist-preview"},i9={class:"preview-actions"},l9={class:"preview-header"},r9={key:0,class:"add-item-form"},c9=["placeholder"],u9=["disabled"],d9={key:1,class:"pending-items"},h9={class:"item-content"},f9={class:"item-header"},p9={class:"item-text"},v9={class:"item-scope"},m9=["onClick"],g9={key:2,class:"empty-state"},y9={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D([...s.modelValue]);Ye(()=>s.modelValue,v=>{c.value=[...v]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=v=>{c.value.splice(v,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")};return(v,g)=>(p(),y("div",a9,[r("div",i9,[r("p",l9," Add new "+_(N(n).checklist)+" for this "+_(N(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:g[0]||(g[0]=k=>i.value=!i.value)},_(i.value?"Cancel":`Add ${N(n).checklist}`),1)]),i.value?(p(),y("div",r9,[We(r("input",{"onUpdate:modelValue":g[1]||(g[1]=k=>l.value=k),type:"text",placeholder:`Enter ${N(n).checklist} text...`,class:"add-item-input",onKeyup:Xo(d,["enter"])},null,40,c9),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,u9)])):P("",!0),c.value.length>0?(p(),y("div",d9,[(p(!0),y(Ie,null,je(c.value,(k,b)=>(p(),y("div",{key:`pending-${b}`,class:"checklist-item pending"},[g[3]||(g[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",h9,[r("div",f9,[r("div",p9,_(k.text),1),r("div",v9,[g[2]||(g[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:x=>h(b),title:"Remove"},"  ",8,m9)])])])]))),128))])):P("",!0),c.value.length===0&&!i.value?(p(),y("div",g9,[r("p",null,"No new "+_(N(n).checklists)+" to add. Click the button above to create one.",1)])):P("",!0)]))}},k9=Ke(y9,[["__scopeId","data-v-a394c400"]]),b9={class:"notes-preview"},w9={class:"preview-actions"},_9={class:"preview-header"},C9={key:0,class:"add-item-form"},L9={class:"add-form-fields"},I9=["disabled"],S9={key:1,class:"pending-items"},x9={class:"note-header"},$9={class:"note-title"},T9={class:"note-actions"},M9=["onClick"],A9={key:0,class:"note-content"},E9={key:2,class:"empty-state"},P9={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D([...s.modelValue]);Ye(()=>s.modelValue,g=>{d.value=[...g]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,v())},f=g=>{d.value.splice(g,1),v()},v=()=>{o("update:modelValue",[...d.value]),o("change")};return(g,k)=>(p(),y("div",b9,[r("div",w9,[r("p",_9," Add new note for this "+_(N(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=b=>i.value=!i.value)},_(i.value?"Cancel":"Add note"),1)]),i.value?(p(),y("div",C9,[r("div",L9,[We(r("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>l.value=b),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),We(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=b=>c.value=b),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,I9)])):P("",!0),d.value.length>0?(p(),y("div",S9,[(p(!0),y(Ie,null,je(d.value,(b,x)=>(p(),y("div",{key:`pending-${x}`,class:"note-item pending"},[r("div",x9,[r("span",$9,_(b.title||"Untitled"),1),r("div",T9,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:A=>f(x),title:"Remove"},"  ",8,M9)])]),b.content?(p(),y("div",A9,_(b.content),1)):P("",!0)]))),128))])):P("",!0),d.value.length===0&&!i.value?(p(),y("div",E9,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):P("",!0)]))}},D9=Ke(P9,[["__scopeId","data-v-5e6bdcab"]]),R9={class:"search-section"},O9={class:"form-group"},B9={class:"suggestions-list"},N9={class:"suggestion-content"},F9={key:0,class:"suggestion-detail"},U9=["onClick"],z9={class:"suggestion-content"},H9={class:"suggestion-name"},V9={key:0,class:"suggestion-detail"},G9=["onClick"],q9={class:"suggestion-content"},j9={class:"suggestion-name"},W9={key:0,class:"suggestion-detail"},Z9={key:1,class:"no-results"},K9={key:2,class:"no-results"},Y9={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(""),l=D(null),c=H(()=>s.contacts.filter(M=>s.excludeContactIds.includes(M.contactId)&&M.marshalId).map(M=>M.marshalId)),d=H(()=>s.contacts.filter(M=>M.marshalId).map(M=>M.marshalId)),h=H(()=>s.contacts.filter(M=>!s.excludeContactIds.includes(M.contactId))),f=H(()=>s.marshals.filter(M=>!c.value.includes(M.id)&&!d.value.includes(M.id))),v=M=>M?M.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",g=H(()=>{const M=v(i.value);return M?M.split(" ").filter(O=>O.length>0):[]}),k=(M,O)=>{if(O.length===0)return{score:1,isPartial:!1};const E=v(M);let U=0;for(const F of O)E.includes(F)&&U++;return{score:U,isPartial:U>0&&U<O.length,isFullMatch:U===O.length}},b=H(()=>{const M=g.value,O=[];return h.value.forEach(E=>{const U=`${E.name||""} ${E.role||""}`,F=k(U,M);(M.length===0||F.score>0)&&O.push({key:`contact-${E.contactId}`,type:"contact",name:E.name,detail:E.role?R(E.role):null,data:E,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),f.value.forEach(E=>{const U=`${E.name||""} ${E.email||""}`,F=k(U,M);(M.length===0||F.score>0)&&O.push({key:`marshal-${E.id}`,type:"marshal",name:E.name,detail:E.email||E.phoneNumber||null,data:E,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),O.sort((E,U)=>U.matchScore!==E.matchScore?U.matchScore-E.matchScore:E.name.localeCompare(U.name,void 0,{sensitivity:"base"})),O}),x=H(()=>g.value.length===0?b.value:b.value.filter(M=>M.isFullMatch)),A=H(()=>g.value.length===0?[]:b.value.filter(M=>M.isPartial)),T=H(()=>A.value.length>0);Ye(()=>s.show,async M=>{M&&(i.value="",await cn(),l.value?.focus())});const w=M=>{const O=s.contacts.find(E=>E.marshalId===M.id);if(O){if(s.excludeContactIds.includes(O.contactId))return;o("select-contact",O)}else o("create-from-marshal",M)},C=M=>{o("select-contact",M)},I=()=>{o("create-new",i.value.trim())},$=()=>{o("close")},R=M=>M?M.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"";return(M,O)=>(p(),Ge(Yt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:$},{actions:Ve(()=>[r("button",{onClick:$,class:"btn btn-secondary"}," Cancel ")]),default:Ve(()=>[r("div",R9,[r("div",O9,[O[1]||(O[1]=r("label",null,"Search or create",-1)),We(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":O[0]||(O[0]=E=>i.value=E),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",B9,[r("div",{class:"suggestion-item create-new",onClick:I},[O[3]||(O[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",N9,[O[2]||(O[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(p(),y("span",F9,'"'+_(i.value.trim())+'"',1)):P("",!0)])]),(p(!0),y(Ie,null,je(x.value,E=>(p(),y("div",{key:E.key,class:"suggestion-item",onClick:U=>E.type==="marshal"?w(E.data):C(E.data)},[r("span",{class:le(["suggestion-icon",E.type==="marshal"?"marshal-icon":"contact-icon"])},_(E.type==="marshal"?"M":"C"),3),r("div",z9,[r("span",H9,_(E.name),1),E.detail?(p(),y("span",V9,_(E.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":E.type==="contact"}])},_(E.type==="marshal"?N(n).person:"Contact"),3)],8,U9))),128)),T.value?(p(),y(Ie,{key:0},[O[4]||(O[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(p(!0),y(Ie,null,je(A.value,E=>(p(),y("div",{key:E.key,class:"suggestion-item",onClick:U=>E.type==="marshal"?w(E.data):C(E.data)},[r("span",{class:le(["suggestion-icon",E.type==="marshal"?"marshal-icon":"contact-icon"])},_(E.type==="marshal"?"M":"C"),3),r("div",q9,[r("span",j9,_(E.name),1),E.detail?(p(),y("span",W9,_(E.detail),1)):P("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":E.type==="contact"}])},_(E.type==="marshal"?N(n).person:"Contact"),3)],8,G9))),128))],64)):P("",!0),i.value.trim()&&x.value.length===0&&A.value.length===0?(p(),y("div",Z9," No matching "+_(N(n).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!i.value.trim()&&x.value.length===0?(p(),y("div",K9," No "+_(N(n).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},J9=Ke(Y9,[["__scopeId","data-v-e25ca97b"]]),X9={class:"contact-card-header"},Q9={class:"contact-name-row"},eF={key:0,class:"pin-icon",title:"Pinned"},tF={key:1,class:"primary-badge",title:"Primary contact"},nF={class:"contact-name"},oF={key:0,class:"contact-role"},sF={key:0,class:"emergency-indicator",title:"Shown in emergency info"},aF={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},iF=["title"],lF={key:0,class:"contact-card-details"},rF={key:0,class:"contact-phone"},cF={key:1,class:"contact-email"},uF={key:1,class:"contact-card-notes"},dF={key:3,class:"contact-card-badge"},hF={key:4,class:"contact-card-badge"},fF={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=H(()=>{const v=new Map;for(const g of s.roleDefinitions)v.set(g.roleId,g.name),v.set(g.name,g.name);return v}),l=H(()=>s.contact.roles&&Array.isArray(s.contact.roles)&&s.contact.roles.length>0?s.contact.roles:s.contact.role?[s.contact.role]:[]),c=H(()=>{const v=s.contact.scopeConfigurations;return!v||v.length===0}),d=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&o("click",s.contact)},h=v=>{if(!v)return"";const g=i.value.get(v);return g||(v==="AreaLead"?`${n.value.area} Lead`:v.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim())},f=v=>{if(!v)return"";const g=100;return v.length<=g?v:v.substring(0,g)+"..."};return(v,g)=>(p(),y("div",{class:le(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:d},[r("div",X9,[r("div",{class:le(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",Q9,[e.contact.isPinned&&!e.isMarkedForRemoval?(p(),y("span",eF,"")):P("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(p(),y("span",tF,"")):P("",!0),r("span",nF,_(e.contact.name),1)]),l.value.length>0?(p(),y("span",oF,_(l.value.map(h).join(", ")),1)):P("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(p(),y("span",sF,"")):P("",!0),c.value&&!e.isMarkedForRemoval&&!e.isPending?(p(),y("span",aF,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(p(),y("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:g[0]||(g[0]=rt(k=>v.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,iF)):P("",!0),e.isMarkedForRemoval?(p(),y("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:g[1]||(g[1]=rt(k=>v.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(p(),y("div",lF,[e.contact.phone?(p(),y("span",rF,_(e.contact.phone),1)):P("",!0),e.contact.email?(p(),y("span",cF,_(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(p(),y("div",uF,_(f(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(p(),Ge(nl,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):P("",!0),e.isPending?(p(),y("div",dF,[...g[2]||(g[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(p(),y("div",hF,[...g[3]||(g[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},pF=Ke(fF,[["__scopeId","data-v-9a194a03"]]),vF={class:"contact-card-wrapper"},mF={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["select","remove","undo-remove","reorder"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>[...n.contacts].sort((d,h)=>{if(d.isPinned!==h.isPinned)return d.isPinned?-1:1;const f=d.displayOrder||0,v=h.displayOrder||0;return f!==v?f-v:(d.name||"").localeCompare(h.name||"",void 0,{sensitivity:"base"})})),i=d=>typeof n.removeTitle=="function"?n.removeTitle(d):n.removeTitle,l=d=>!d.isPending,c=({changes:d})=>{s("reorder",d)};return(d,h)=>(p(),Ge(wc,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[e.contacts.length>0?(p(),Ge(il,{key:0,items:o.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:c},{item:Ve(({element:f})=>[r("div",vF,[e.allowReorder?(p(),Ge(ll,{key:0})):P("",!0),Pe(pF,{contact:f,"is-pending":f.isPending,"is-marked-for-removal":f.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":i(f),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:l(f),areas:e.areas,locations:e.locations,marshals:e.marshals,"role-definitions":e.roleDefinitions,onClick:v=>d.$emit("select",f),onRemove:h[0]||(h[0]=v=>d.$emit("remove",v)),onUndoRemove:h[1]||(h[1]=v=>d.$emit("undo-remove",v))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","role-definitions","onClick"])])]),_:1},8,["items","disabled","show-order-overlay"])):P("",!0)]),_:1},8,["is-empty","empty-message","empty-hint"]))}},gF=Ke(mF,[["__scopeId","data-v-4c025463"]]),yF={key:0,class:"tab-content"},kF={class:"form-group"},bF=["disabled"],wF={class:"form-group"},_F={key:1,class:"tab-content"},CF={class:"boundary-section"},LF={key:0,class:"boundary-preview"},IF={class:"boundary-actions"},SF={key:2,class:"tab-content"},xF={class:"contacts-header"},$F={class:"section-title"},TF={key:3,class:"tab-content"},MF={class:"section-title"},AF={key:4,class:"placeholder-message"},EF={key:7,class:"placeholder-message"},PF={key:10,class:"placeholder-message"},DF={key:11,class:"tab-content appearance-tab"},RF={class:"accordion-item"},OF=["innerHTML"],BF={class:"accordion-title"},NF={class:"accordion-arrow"},FF={key:0,class:"accordion-content"},UF={class:"section-description"},zF={class:"color-picker"},HF=["title","onClick"],VF={class:"accordion-item"},GF=["innerHTML"],qF={class:"accordion-title"},jF={class:"accordion-arrow"},WF={key:0,class:"accordion-content"},ZF={class:"section-description"},KF={class:"accordion-item"},YF={class:"accordion-title"},JF={class:"accordion-preview"},XF={class:"accordion-arrow"},QF={key:0,class:"accordion-content"},e7={class:"section-description"},t7={class:"form-group"},n7={value:""},o7=["value"],s7={class:"accordion-item"},a7={class:"accordion-title"},i7={class:"accordion-preview"},l7={class:"accordion-arrow"},r7={key:0,class:"accordion-content"},c7={class:"section-description"},u7={class:"form-group"},d7={value:""},h7=["value"],f7={key:12,class:"tab-content incidents-tab"},p7={class:"incidents-list"},v7={class:"custom-footer"},m7={class:"footer-left"},bm="edit_area_accordion",g7={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident","reorder-notes","reorder-checklists","reorder-contacts"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),i=()=>$.value.peopleTerm?$.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(ne=!0)=>{const ye=$.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",He=i();return ne?e1("checkpoint",ye,He):ji("checkpoint",ye,He)},c=(ne=!0)=>l(ne).toLowerCase(),d=e,h=n,f=D("details"),v=D(null),g=D([]),k=D({}),b=D({}),x=D(!1),A=D(!1),T=D([]),w=D([]),C=D([]),I=D([]),$=D({name:"",description:"",color:nu,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>({name:"",description:"",color:EL(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),M=()=>d.eventId?`${bm}_${d.eventId}`:bm,O=D({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});un(()=>{const ne=localStorage.getItem(M());if(ne)try{const ye=JSON.parse(ne);O.value={...O.value,...ye}}catch{}});const E=ne=>{O.value[ne]=!O.value[ne],localStorage.setItem(M(),JSON.stringify(O.value))},U=H(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${$.value.color||nu}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),F=H(()=>{const ne=$.value.checkpointStyleType!=="default"||$.value.checkpointStyleBackgroundShape||$.value.checkpointStyleBackgroundColor||$.value.checkpointStyleBorderColor||$.value.checkpointStyleIconColor||$.value.checkpointStyleSize,ye=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!ne&&!ye)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const He=$.value.checkpointStyleType&&$.value.checkpointStyleType!=="default"?$.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",ct=$.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",ht=$.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Bt=$.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Lt=$.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",Nt=$.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return zn({type:He!=="default"?He:ct,backgroundShape:ct,backgroundColor:ht,borderColor:Bt,iconColor:Lt,size:Nt,outputSize:24})}),j=H(()=>d.area&&d.area.id),Z=H(()=>!$.value.polygon||$.value.polygon.length===0?[]:$.value.polygon.map((ne,ye)=>({id:`polygon-point-${ye}`,latitude:ne.lat,longitude:ne.lng}))),Q=H(()=>d.area?.id?d.areas.filter(ne=>ne.id!==d.area.id).map(ne=>({...ne,color:"#999999"})):d.areas.map(ne=>({...ne,color:"#999999"})));H(()=>ue.value.map(ne=>ne.id));const re=H(()=>{const ne=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:s.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&ne.push({value:"incidents",label:"Incidents",icon:"incidents"}),ne}),K=H(()=>re.value.findIndex(ne=>ne.value===f.value)),ae=H(()=>K.value===re.value.length-1),q=H(()=>ae.value?null:re.value[K.value+1]),J=H(()=>q.value?`${q.value.label}...`:""),ee=H(()=>{if(!d.area||!d.area.id)return[];const ne=d.checkpoints.filter(ye=>ye.areaIds&&ye.areaIds.includes(d.area.id)).map(ye=>ye.id);return d.assignments.filter(ye=>ne.includes(ye.locationId))}),ue=H(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(ne=>ne.areaIds&&ne.areaIds.includes(d.area.id))),_e=H(()=>{const ne=[...ue.value];return ne.sort((ye,He)=>{const ct=ye.name.match(/^(\d+)/),ht=He.name.match(/^(\d+)/);if(ct&&ht){const Bt=parseInt(ct[1]),Lt=parseInt(ht[1]);if(Bt!==Lt)return Bt-Lt}return ye.name.localeCompare(He.name,void 0,{numeric:!0,sensitivity:"base"})}),ne}),$e=H(()=>!d.area||!d.area.id?[]:d.contacts.filter(ne=>ne.scopeConfigurations?ne.scopeConfigurations.some(ye=>ye.scope==="EveryoneInAreas"&&ye.itemType==="Area"?ye.ids?.includes("ALL_AREAS")?!0:ye.ids?.includes(d.area.id):!1):!1)),De=H(()=>{const ne=new Set($e.value.map(ct=>ct.contactId)),ye=$e.value.map(ct=>({...ct,isPending:!1,isExisting:!0,isMarkedForRemoval:w.value.includes(ct.contactId)})),He=T.value.filter(ct=>!ne.has(ct.contactId)).map(ct=>({...ct,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...ye,...He].sort((ct,ht)=>ct.name.localeCompare(ht.name,void 0,{sensitivity:"base"}))}),Re=H(()=>{const ne=$e.value.map(He=>He.contactId),ye=T.value.map(He=>He.contactId);return[...ne,...ye]}),be=async ne=>{if(!(k.value[ne]||b.value[ne])){b.value[ne]=!0;try{const ye=await Ot.getCheckpointChecklist(d.eventId,ne),He=Bf(ye.data)||[];k.value[ne]={total:He.length,completed:He.filter(ct=>ct.isCompleted).length}}catch(ye){console.error("Failed to load checklist status for checkpoint:",ne,ye),k.value[ne]={total:0,completed:0}}finally{b.value[ne]=!1}}};Ye(()=>d.area,ne=>{if(ne){const ye=ne.polygon?typeof ne.polygon=="string"?JSON.parse(ne.polygon):ne.polygon:[];$.value={name:ne.name||"",description:ne.description||"",color:ne.color||nu,displayOrder:ne.displayOrder||0,isDefault:ne.isDefault||!1,polygon:ye,checkpointStyleType:ne.checkpointStyleType||"default",checkpointStyleColor:ne.checkpointStyleColor||"",checkpointStyleBackgroundShape:ne.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:ne.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:ne.checkpointStyleBorderColor||"",checkpointStyleIconColor:ne.checkpointStyleIconColor||"",checkpointStyleSize:ne.checkpointStyleSize||"",checkpointStyleMapRotation:ne.checkpointStyleMapRotation??"",peopleTerm:ne.peopleTerm||"",checkpointTerm:ne.checkpointTerm||""}}else $.value=R()},{immediate:!0,deep:!0}),Ye(()=>d.show,ne=>{ne&&(f.value=d.initialTab||"details",g.value=[],k.value={},b.value={},T.value=[],w.value=[],C.value=[],I.value=[],A.value=!1,j.value||($.value=R()),v.value?.resetLocalState&&v.value.resetLocalState())}),Ye(f,ne=>{ne==="checkpoints"&&d.area&&d.area.id&&ue.value.forEach(ye=>{setTimeout(()=>be(ye.id),0)})});const z=()=>{h("update:isDirty",!0)},Y=ne=>{$.value.color=ne,z()},de=(ne,ye)=>{$.value[ne]=ye,z()},ie=()=>{h("draw-boundary",$.value)},Ae=ne=>{$.value.polygon=ne,z()},G=()=>{$.value.polygon=[],x.value=!1,z()},X=ne=>{A.value=!1,h("create-contact-from-marshal",{marshal:ne,area:d.area})},te=ne=>{A.value=!1,h("create-new-contact",{name:ne,area:d.area})},Ce=ne=>{T.value.find(ye=>ye.contactId===ne.contactId)||(T.value.push(ne),z()),A.value=!1},Ne=ne=>{T.value=T.value.filter(ye=>ye.contactId!==ne),z()},Fe=ne=>{w.value.includes(ne)||(w.value.push(ne),z())},Ee=ne=>ne.isPending?"Remove pending contact":`Remove from ${o.value.area}`,oe=ne=>{De.value.find(He=>He.contactId===ne)?.isPending?Ne(ne):Fe(ne)},ge=ne=>{w.value=w.value.filter(ye=>ye!==ne),z()},Be=ne=>{g.value=ne,z()},Oe=()=>{q.value&&(f.value=q.value.value)},xe=ne=>{h("reorder-notes",ne)},me=ne=>{h("reorder-checklists",ne)},Ze=ne=>{h("reorder-contacts",ne)},qe=()=>{const ne=d.area?{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,displayOrder:$.value.displayOrder,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,checklistChanges:g.value||[],pendingContacts:T.value||[],contactsToRemove:w.value||[],pendingNewChecklistItems:C.value||[],pendingNewNotes:I.value||[]}:{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,pendingContacts:T.value||[]};h("save",ne)},fe=()=>{h("delete",d.area.id)},ke=()=>{h("close")};return t({addPendingContact:ne=>{ne&&!T.value.find(ye=>ye.contactId===ne.contactId)&&(T.value.push(ne),z())},removeContactById:ne=>{const ye=T.value.some(He=>He.contactId===ne);T.value=T.value.filter(He=>He.contactId!==ne),w.value=w.value.filter(He=>He!==ne),ye&&z()}}),(ne,ye)=>(p(),Ge(Yt,{show:e.show,title:e.area&&e.area.id?`Edit ${N(o).area}: ${e.area.name}`:`Create new ${N(o).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ke},{"tab-header":Ve(()=>[Pe(ul,{modelValue:f.value,"onUpdate:modelValue":ye[0]||(ye[0]=He=>f.value=He),tabs:re.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",v7,[r("div",m7,[j.value&&!$.value.isDefault?(p(),y("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete ")):P("",!0),!j.value&&!ae.value?(p(),y("button",{key:1,type:"button",onClick:Oe,class:"btn btn-secondary mobile-only"},_(J.value),1)):P("",!0)]),r("button",{type:"button",onClick:qe,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[f.value==="details"?(p(),y("div",yF,[r("form",{onSubmit:rt(qe,["prevent"])},[r("div",kF,[ye[27]||(ye[27]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":ye[1]||(ye[1]=He=>$.value.name=He),type:"text",required:"",class:"form-input",disabled:$.value.isDefault,onInput:z},null,40,bF),[[st,$.value.name]])]),r("div",wF,[ye[28]||(ye[28]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":ye[2]||(ye[2]=He=>$.value.description=He),class:"form-input",rows:"3",onInput:z},null,544),[[st,$.value.description]])])],32)])):P("",!0),f.value==="boundary"?(p(),y("div",_F,[r("div",CF,[$.value.polygon&&$.value.polygon.length>0?(p(),y("div",LF,[Pe(al,{mode:"edit-polygon","editing-polygon":$.value.polygon,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,locations:e.checkpoints,areas:Q.value,"all-locations-for-bounds":Z.value,height:"300px",onPolygonUpdate:Ae},null,8,["editing-polygon","route","route-color","route-style","route-weight","locations","areas","all-locations-for-bounds"]),ye[29]||(ye[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),r("div",IF,[!$.value.polygon||$.value.polygon.length===0?(p(),y("button",{key:0,onClick:ie,class:"btn btn-primary btn-full"}," Draw on map ")):(p(),y(Ie,{key:1},[r("button",{onClick:ie,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:ye[3]||(ye[3]=He=>x.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Pe(gi,{show:x.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:G,onCancel:ye[4]||(ye[4]=He=>x.value=!1)},null,8,["show"]),f.value==="contacts"?(p(),y("div",SF,[r("div",xF,[r("h3",$F,_(N(s).area)+" contacts ("+_(De.value.length)+")",1),r("button",{onClick:ye[5]||(ye[5]=He=>A.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Pe(gF,{contacts:De.value,"show-remove-button":!0,"remove-title":Ee,"empty-message":`No contacts assigned to this ${N(o).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${N(o).people} in this ${N(o).area}.`,"allow-reorder":j.value,"role-definitions":e.roleDefinitions,onSelect:ye[6]||(ye[6]=He=>ne.$emit("edit-contact",He)),onRemove:oe,onUndoRemove:ge,onReorder:Ze},null,8,["contacts","empty-message","empty-hint","allow-reorder","role-definitions"])])):P("",!0),Pe(J9,{show:A.value,"area-name":$.value.name||"this "+N(o).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Re.value,onClose:ye[7]||(ye[7]=He=>A.value=!1),onSelectContact:Ce,onCreateFromMarshal:X,onCreateNew:te},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(p(),y("div",TF,[r("h3",MF,_(l())+" in "+_(e.area?.name)+" ("+_(ue.value.length)+")",1),Pe(C1,{checkpoints:_e.value,areas:e.areas,"empty-message":`No ${c()} in this ${N(o).area} yet.`,onSelect:ye[8]||(ye[8]=He=>ne.$emit("select-checkpoint",He))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),f.value==="checkpoints"&&!j.value?(p(),y("div",AF,[r("p",null,_(l())+" will be automatically assigned based on boundaries after the "+_(N(o).area)+" is created.",1)])):P("",!0),f.value==="checklists"&&j.value?(p(),Ge(T1,{key:5,ref_key:"checklistTabRef",ref:v,modelValue:g.value,"onUpdate:modelValue":ye[9]||(ye[9]=He=>g.value=He),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ee.value,marshals:e.marshals,"allow-reorder":!0,onChange:Be,onReorder:me},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):P("",!0),f.value==="checklists"&&j.value?(p(),Ge(k9,{key:6,modelValue:C.value,"onUpdate:modelValue":ye[10]||(ye[10]=He=>C.value=He),onChange:z},null,8,["modelValue"])):P("",!0),f.value==="checklists"&&!j.value?(p(),y("div",EF,[r("p",null,_(N(s).checklists)+" can be assigned after the "+_(N(o).area)+" is created.",1)])):P("",!0),f.value==="notes"&&j.value?(p(),Ge(rd,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals,"allow-reorder":!0,onReorder:xe},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):P("",!0),f.value==="notes"&&j.value?(p(),Ge(D9,{key:9,modelValue:I.value,"onUpdate:modelValue":ye[11]||(ye[11]=He=>I.value=He),onChange:z},null,8,["modelValue"])):P("",!0),f.value==="notes"&&!j.value?(p(),y("div",PF,[r("p",null,"Notes can be viewed after the "+_(N(o).area)+" is created.",1)])):P("",!0),f.value==="appearance"?(p(),y("div",DF,[r("div",RF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.polygonColor}]),onClick:ye[12]||(ye[12]=He=>E("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:U.value},null,8,OF),r("span",BF,_(N(s).area)+" polygon colour",1),r("span",NF,_(O.value.polygonColor?"":""),1)],2),O.value.polygonColor?(p(),y("div",FF,[r("p",UF," Choose a colour for this "+_(N(o).area)+"'s boundary on the map. ",1),r("div",zF,[(p(!0),y(Ie,null,je(N(Un),He=>(p(),y("div",{key:He.hex,class:le(["color-swatch",{selected:$.value.color===He.hex}]),style:tt({backgroundColor:He.hex}),title:He.name,onClick:ct=>Y(He.hex)},null,14,HF))),128))])])):P("",!0)]),r("div",VF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.iconStyle}]),onClick:ye[13]||(ye[13]=He=>E("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:F.value},null,8,GF),r("span",qF,_(l(!1))+" marker style",1),r("span",jF,_(O.value.iconStyle?"":""),1)],2),O.value.iconStyle?(p(),y("div",WF,[r("p",ZF," Set a default marker style for all "+_(c())+" in this "+_(N(o).area)+". Individual "+_(c())+" can override this setting. ",1),Pe(Hf,{"style-type":$.value.checkpointStyleType||"default","style-color":$.value.checkpointStyleColor||"","style-background-shape":$.value.checkpointStyleBackgroundShape||"","style-background-color":$.value.checkpointStyleBackgroundColor||"","style-border-color":$.value.checkpointStyleBorderColor||"","style-icon-color":$.value.checkpointStyleIconColor||"","style-size":$.value.checkpointStyleSize||"","style-map-rotation":$.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":ye[14]||(ye[14]=He=>de("checkpointStyleType",He)),"onUpdate:styleColor":ye[15]||(ye[15]=He=>de("checkpointStyleColor",He)),"onUpdate:styleBackgroundShape":ye[16]||(ye[16]=He=>de("checkpointStyleBackgroundShape",He)),"onUpdate:styleBackgroundColor":ye[17]||(ye[17]=He=>de("checkpointStyleBackgroundColor",He)),"onUpdate:styleBorderColor":ye[18]||(ye[18]=He=>de("checkpointStyleBorderColor",He)),"onUpdate:styleIconColor":ye[19]||(ye[19]=He=>de("checkpointStyleIconColor",He)),"onUpdate:styleSize":ye[20]||(ye[20]=He=>de("checkpointStyleSize",He)),"onUpdate:styleMapRotation":ye[21]||(ye[21]=He=>de("checkpointStyleMapRotation",He))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),r("div",KF,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.peopleTerm}]),onClick:ye[22]||(ye[22]=He=>E("peopleTerm"))},[ye[30]||(ye[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",YF,_(i())+" terminology",1),r("span",JF,_($.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",XF,_(O.value.peopleTerm?"":""),1)],2),O.value.peopleTerm?(p(),y("div",QF,[r("p",e7," Choose what "+_(i().toLowerCase())+" are called in this "+_(N(o).area)+". This will be inherited by "+_(c())+" unless they override it. ",1),r("div",t7,[ye[31]||(ye[31]=r("label",null,"What are people called?",-1)),We(r("select",{"onUpdate:modelValue":ye[23]||(ye[23]=He=>$.value.peopleTerm=He),class:"form-input",onChange:z},[r("option",n7,"Use event default ("+_(e.eventPeopleTerm)+")",1),(p(!0),y(Ie,null,je(N(ya).people,He=>(p(),y("option",{key:He,value:He},_(He),9,o7))),128))],544),[[no,$.value.peopleTerm]])])])):P("",!0)]),r("div",s7,[r("button",{type:"button",class:le(["accordion-header",{expanded:O.value.checkpointTerm}]),onClick:ye[24]||(ye[24]=He=>E("checkpointTerm"))},[ye[32]||(ye[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",a7,_(l(!1))+" terminology",1),r("span",i7,_($.value.checkpointTerm?N(Kh)($.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",l7,_(O.value.checkpointTerm?"":""),1)],2),O.value.checkpointTerm?(p(),y("div",r7,[r("p",c7," Choose what "+_(c())+" are called in this "+_(N(o).area)+". ",1),r("div",u7,[r("label",null,"What are "+_(c())+" called?",1),We(r("select",{"onUpdate:modelValue":ye[25]||(ye[25]=He=>$.value.checkpointTerm=He),class:"form-input",onChange:z},[r("option",d7,"Use event default ("+_(e.eventCheckpointTerm)+")",1),(p(!0),y(Ie,null,je(N(ya).checkpoint,He=>(p(),y("option",{key:He,value:He},_(N(Kh)(He,i())),9,h7))),128))],544),[[no,$.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),f.value==="incidents"?(p(),y("div",f7,[r("div",p7,[(p(!0),y(Ie,null,je(e.incidents,He=>(p(),Ge(bc,{key:He.incidentId,incident:He,onSelect:ye[26]||(ye[26]=ct=>ne.$emit("select-incident",ct))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},y7=Ke(g7,[["__scopeId","data-v-26ec257c"]]),k7=["innerHTML"],b7={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const n=t,s=()=>{n("close")};return(o,i)=>(p(),Ge(Yt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:s},{actions:Ve(()=>[r("button",{onClick:s,class:"btn btn-primary"},_(e.okText),1)]),default:Ve(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,k7)]),_:1},8,["show","title"]))}},_c=Ke(b7,[["__scopeId","data-v-a6e7148c"]]),w7={class:"tab-content"},_7={class:"form-group"},C7={for:"text"},L7=["placeholder"],I7={key:0,class:"checkbox-label-inline create-separate-items"},S7={key:0,class:"form-group link-to-checkin"},x7={class:"checkbox-label-inline"},$7={class:"help-text"},T7={key:1,class:"form-group link-to-checkin-warning"},M7={class:"help-text warning"},A7={class:"tab-content"},E7={class:"custom-footer"},P7={class:"footer-left"},D7={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},nextDisplayOrder:{type:Number,default:0}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:n,termsSentence:s}=dt(),o=e,i=t,l=D(!1),c=D(""),d=D("details"),h=D({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1}),f=H(()=>!!o.checklistItem),v=H(()=>{const O=h.value.scopeConfigurations.filter(E=>E.scope&&(E.ids?.length>0||E.scope==="Everyone"||E.scope==="EveryoneAtCheckpoints"||E.scope==="SpecificPeople"));return O.length===0?!1:O.every(E=>E.scope==="EveryoneAtCheckpoints"||E.scope==="SpecificPeople")}),g=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=H(()=>g.findIndex(O=>O.value===d.value)),b=H(()=>k.value===g.length-1),x=H(()=>b.value?"":g[k.value+1]?.label||"");Ye(()=>o.show,O=>{O&&(d.value=o.initialTab,o.checklistItem?h.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?A(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?A(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?A(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1,linksToCheckIn:o.checklistItem.linksToCheckIn||!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.nextDisplayOrder,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1},i("update:isDirty",!1))});const A=O=>{if(!O)return null;const E=new Date(O),U=E.getTimezoneOffset();return new Date(E.getTime()-U*60*1e3).toISOString().slice(0,16)},T=O=>O?new Date(O).toISOString():null,w=()=>{i("update:isDirty",!0)},C=()=>{i("close")},I=()=>{b.value||(d.value=g[k.value+1].value)},$=O=>{c.value=O,l.value=!0},R=()=>{if(!h.value.text||!h.value.text.trim()){$(`Please enter ${n.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){$("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(U=>!(U.itemType!==null&&(!U.ids||U.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const E={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:T(h.value.visibleFrom),visibleUntil:T(h.value.visibleUntil),mustCompleteBy:T(h.value.mustCompleteBy),linksToCheckIn:h.value.linksToCheckIn};f.value||(E.createSeparateItems=h.value.createSeparateItems),i("save",E)},M=()=>{i("delete",o.checklistItem.itemId)};return(O,E)=>(p(),y(Ie,null,[Pe(Yt,{show:e.show,title:f.value?`Edit ${N(n).checklist}`:`Create ${N(n).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":Ve(()=>[Pe(ul,{modelValue:d.value,"onUpdate:modelValue":E[0]||(E[0]=U=>d.value=U),tabs:g},null,8,["modelValue"])]),footer:Ve(()=>[r("div",E7,[r("div",P7,[f.value?(p(),y("button",{key:0,type:"button",onClick:M,class:"btn btn-danger"}," Delete ")):P("",!0),!f.value&&!b.value?(p(),y("button",{key:1,type:"button",onClick:I,class:"btn btn-secondary mobile-only"},_(x.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(R,["prevent"]),class:"checklist-form"},[We(r("div",w7,[r("div",_7,[r("label",C7,_(N(s).checklist)+" text: *",1),We(r("textarea",{id:"text","onUpdate:modelValue":E[1]||(E[1]=U=>h.value.text=U),onInput:w,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${N(n).checklists}, one per line...`:`Enter the ${N(n).checklist} text...`},null,40,L7),[[st,h.value.text]]),f.value?P("",!0):(p(),y("label",I7,[We(r("input",{type:"checkbox","onUpdate:modelValue":E[2]||(E[2]=U=>h.value.createSeparateItems=U),onChange:w},null,544),[[$s,h.value.createSeparateItems]]),E[6]||(E[6]=r("span",null,"Each line creates a new item",-1))]))]),v.value?(p(),y("div",S7,[r("label",x7,[We(r("input",{type:"checkbox","onUpdate:modelValue":E[3]||(E[3]=U=>h.value.linksToCheckIn=U),onChange:w},null,544),[[$s,h.value.linksToCheckIn]]),E[7]||(E[7]=r("span",null,"Link to check-in status",-1))]),r("p",$7," Completing this "+_(N(n).checklist)+" will check the "+_(N(n).person)+" in at the "+_(N(n).checkpoint)+". Checking in will complete this "+_(N(n).checklist)+". ",1)])):h.value.linksToCheckIn?(p(),y("div",T7,[r("p",M7,[E[8]||(E[8]=r("strong",null,"Note:",-1)),Je(' Link to check-in is currently enabled but the visibility settings are incompatible. Change visibility to "Everyone at specific '+_(N(n).checkpoints)+'" or "Specific '+_(N(n).people)+'" to use this feature. ',1)])])):P("",!0)],512),[[ns,d.value==="details"]]),We(r("div",A7,[Pe(ld,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":E[4]||(E[4]=U=>h.value.scopeConfigurations=U),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:w},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(_c,{show:l.value,title:"Validation error",message:c.value,onClose:E[5]||(E[5]=U=>l.value=!1)},null,8,["show","message"])],64))}},R7=Ke(D7,[["__scopeId","data-v-6f300b9a"]]),O7={class:"tab-content"},B7={class:"form-group"},N7={class:"form-group"},F7={class:"form-row"},U7={class:"form-group"},z7={class:"checkbox-label-inline show-emergency-checkbox"},H7={class:"form-group"},V7={class:"form-row"},G7={class:"form-group"},q7={class:"form-group checkbox-group-inline"},j7={class:"checkbox-label-inline"},W7={class:"tab-content"},Z7={class:"custom-footer"},K7={class:"footer-left"},Y7={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const n=e,s=t,o=D(!1),i=D(""),l=D("details"),c=D({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=I=>I==="Urgent"||I==="Emergency",h=H(()=>!!n.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],v=H(()=>f.findIndex(I=>I.value===l.value)),g=H(()=>v.value===f.length-1),k=H(()=>g.value?"":f[v.value+1]?.label||"");Ye(()=>n.show,I=>{I&&(l.value=n.initialTab,n.note?c.value={title:n.note.title||"",content:n.note.content||"",scopeConfigurations:n.note.scopeConfigurations?JSON.parse(JSON.stringify(n.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:n.note.displayOrder||0,priority:n.note.priority||"Normal",category:n.note.category||"",isPinned:n.note.isPinned||!1,showInEmergencyInfo:n.note.showInEmergencyInfo??d(n.note.priority)}:c.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},s("update:isDirty",!1))}),Ye(()=>c.value.priority,(I,$)=>{!h.value&&I!==$&&(d(I)?c.value.showInEmergencyInfo=!0:d($)&&(c.value.showInEmergencyInfo=!1))});const b=()=>{s("update:isDirty",!0)},x=()=>{s("close")},A=()=>{g.value||(l.value=f[v.value+1].value)},T=I=>{i.value=I,o.value=!0},w=()=>{if(!c.value.title||!c.value.title.trim()){T("Please enter a note title");return}if(!c.value.scopeConfigurations||c.value.scopeConfigurations.length===0){T("Please select at least one visibility scope");return}if(!c.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const $={title:c.value.title.trim(),content:c.value.content||"",scopeConfigurations:c.value.scopeConfigurations,displayOrder:c.value.displayOrder||0,priority:c.value.priority||"Normal",category:c.value.category?.trim()||null,isPinned:c.value.isPinned||!1,showInEmergencyInfo:c.value.showInEmergencyInfo};s("save",$)},C=()=>{s("delete",n.note.noteId)};return(I,$)=>(p(),y(Ie,null,[Pe(Yt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{"tab-header":Ve(()=>[Pe(ul,{modelValue:l.value,"onUpdate:modelValue":$[0]||($[0]=R=>l.value=R),tabs:f},null,8,["modelValue"])]),footer:Ve(()=>[r("div",Z7,[r("div",K7,[h.value?(p(),y("button",{key:0,type:"button",onClick:C,class:"btn btn-danger"}," Delete ")):P("",!0),!h.value&&!g.value?(p(),y("button",{key:1,type:"button",onClick:A,class:"btn btn-secondary mobile-only"},_(k.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:w,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(w,["prevent"]),class:"note-form"},[We(r("div",O7,[r("div",B7,[$[10]||($[10]=r("label",{for:"title"},"Title: *",-1)),We(r("input",{id:"title","onUpdate:modelValue":$[1]||($[1]=R=>c.value.title=R),type:"text",onInput:b,required:"",placeholder:"Enter note title..."},null,544),[[st,c.value.title]])]),r("div",N7,[$[11]||($[11]=r("label",{for:"content"},"Content:",-1)),We(r("textarea",{id:"content","onUpdate:modelValue":$[2]||($[2]=R=>c.value.content=R),onInput:b,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,c.value.content]])]),r("div",F7,[r("div",U7,[$[14]||($[14]=r("label",{for:"priority"},"Priority:",-1)),We(r("select",{id:"priority","onUpdate:modelValue":$[3]||($[3]=R=>c.value.priority=R),onChange:b},[...$[12]||($[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[no,c.value.priority]]),r("label",z7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[4]||($[4]=R=>c.value.showInEmergencyInfo=R),onChange:b},null,544),[[$s,c.value.showInEmergencyInfo]]),$[13]||($[13]=r("span",null,"Show in emergency info",-1))])]),r("div",H7,[$[15]||($[15]=r("label",{for:"category"},"Category:",-1)),We(r("input",{id:"category","onUpdate:modelValue":$[5]||($[5]=R=>c.value.category=R),type:"text",onInput:b,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,c.value.category]])])]),r("div",V7,[r("div",G7,[$[16]||($[16]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":$[6]||($[6]=R=>c.value.displayOrder=R),type:"number",onInput:b,min:"0"},null,544),[[st,c.value.displayOrder,void 0,{number:!0}]]),$[17]||($[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",q7,[r("label",j7,[We(r("input",{type:"checkbox","onUpdate:modelValue":$[7]||($[7]=R=>c.value.isPinned=R),onChange:b},null,544),[[$s,c.value.isPinned]]),$[18]||($[18]=r("span",null,"Pin to top",-1))]),$[19]||($[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ns,l.value==="details"]]),We(r("div",W7,[Pe(ld,{modelValue:c.value.scopeConfigurations,"onUpdate:modelValue":$[8]||($[8]=R=>c.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:b},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(_c,{show:o.value,title:"Validation error",message:i.value,onClose:$[9]||($[9]=R=>o.value=!1)},null,8,["show","message"])],64))}},J7=Ke(Y7,[["__scopeId","data-v-e8488047"]]),X7={class:"incident-detail-header"},Q7={class:"header-title-row"},eU={class:"modal-title"},tU={class:"header-badges"},nU=["disabled"],oU={key:0,class:"status-dropdown-menu"},sU=["onClick","disabled"],aU={key:0,class:"incident-detail-content"},iU={class:"accordion-section"},lU={class:"accordion-arrow"},rU={key:0,class:"accordion-content"},cU={class:"description-text"},uU={class:"accordion-section"},dU={class:"accordion-arrow"},hU={key:0,class:"accordion-content"},fU={class:"info-grid"},pU={class:"info-item"},vU={class:"info-value"},mU={class:"info-item"},gU={class:"info-value"},yU={key:0,class:"info-item"},kU={class:"info-label"},bU={class:"info-value"},wU={key:1,class:"info-item"},_U={class:"info-label"},CU={class:"info-value"},LU={key:2,class:"info-item"},IU={class:"info-value"},SU={key:0,class:"incident-map-container"},xU={class:"accordion-section"},$U={class:"accordion-preview"},TU={class:"accordion-arrow"},MU={key:0,class:"accordion-content"},AU={class:"reporter-info"},EU={class:"reporter-name"},PU={key:0,class:"accordion-section"},DU={class:"accordion-title"},RU={class:"accordion-preview"},OU={class:"accordion-arrow"},BU={key:0,class:"accordion-content"},NU={class:"marshals-list"},FU={class:"marshal-name"},UU={key:0,class:"checkin-badge success"},zU={key:1,class:"checkin-badge not-checked-in"},HU={class:"accordion-section"},VU={key:0,class:"accordion-preview"},GU={class:"accordion-arrow"},qU={key:0,class:"accordion-content"},jU={key:0,class:"notes-timeline"},WU={class:"note-header"},ZU={class:"note-author"},KU={class:"note-time"},YU={key:0,class:"note-status-change"},JU={key:1,class:"note-text"},XU={key:1,class:"no-notes"},QU={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:n,termsSentence:s}=dt(),o=e,i=t,l=D(!1),c=D(!1),d=D(null),h=D({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ye(()=>o.show,U=>{U&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},c.value=!1)});const f=U=>{d.value&&!d.value.contains(U.target)&&(c.value=!1)};Ye(c,U=>{U?document.addEventListener("click",f):document.removeEventListener("click",f)});const v=()=>{c.value=!c.value},g=U=>{o.incident?.status!==U&&(c.value=!1,E(U))},k=U=>{const F=h.value[U];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),F||(h.value[U]=!0)},b=H(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),x=H(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),A=H(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),T=H(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const U=o.incident.description||"";return U.length<=50?U:U.substring(0,47)+"..."}),w=H(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((F,j)=>(F.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),C=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],I=U=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[U]||U,$=U=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[U]||U,R=U=>{if(!U)return"";let F=U.name||"";if(U.description){const j=U.description,Z=40,Q=j.length>Z?j.substring(0,Z-3)+"...":j;F+=` - ${Q}`}return F},M=U=>U?new Date(U).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",O=U=>{if(!U)return"";const F=new Date(U),Z=new Date-F,Q=Math.floor(Z/6e4),re=Math.floor(Z/36e5),K=Math.floor(Z/864e5);return Q<1?"just now":Q<60?`${Q}m ago`:re<24?`${re}h ago`:K<7?`${K}d ago`:F.toLocaleDateString()},E=async U=>{if(o.incident?.status!==U){l.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:U})}finally{l.value=!1}}};return(U,F)=>(p(),Ge(Yt,{show:e.show,title:T.value,size:"large",onClose:F[7]||(F[7]=j=>U.$emit("close"))},{header:Ve(()=>[r("div",X7,[r("div",Q7,[r("span",{class:le(["severity-indicator",e.incident?.severity])},null,2),r("h2",eU,_(T.value),1)]),r("div",tU,[r("span",{class:le(["severity-badge",e.incident?.severity])},_(I(e.incident?.severity)),3),e.canManage?(p(),y("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:le(["status-badge status-dropdown-trigger disable-on-load",e.incident?.status]),onClick:v,disabled:l.value},[Je(_($(e.incident?.status))+" ",1),F[8]||(F[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,nU),c.value?(p(),y("div",oU,[(p(),y(Ie,null,je(C,j=>r("button",{key:j.value,type:"button",class:le(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Z=>g(j.value),disabled:e.incident?.status===j.value},[r("span",{class:le(["status-dot",j.value])},null,2),Je(" "+_(j.label),1)],10,sU)),64))])):P("",!0)],512)):(p(),y("span",{key:1,class:le(["status-badge",e.incident?.status])},_($(e.incident?.status)),3))])])]),footer:Ve(()=>[r("button",{class:"btn btn-secondary",onClick:F[6]||(F[6]=j=>U.$emit("close"))},"Close")]),default:Ve(()=>[e.incident?(p(),y("div",aU,[r("div",iU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.description}]),onClick:F[0]||(F[0]=j=>k("description"))},[F[9]||(F[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",lU,_(h.value.description?"":""),1)],2),h.value.description?(p(),y("div",rU,[r("p",cU,_(e.incident.description),1)])):P("",!0)]),r("div",uU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.timeLocation}]),onClick:F[1]||(F[1]=j=>k("timeLocation"))},[F[10]||(F[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",dU,_(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(p(),y("div",hU,[r("div",fU,[r("div",pU,[F[11]||(F[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",vU,_(M(e.incident.incidentTime)),1)]),r("div",mU,[F[12]||(F[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",gU,_(M(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(p(),y("div",yU,[r("span",kU,_(N(s).checkpoint),1),r("span",bU,_(R(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(p(),y("div",wU,[r("span",_U,_(N(s).area),1),r("span",CU,_(e.incident.area.areaName),1)])):P("",!0),b.value?(p(),y("div",LU,[F[13]||(F[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",IU,_(e.incident.latitude.toFixed(6))+", "+_(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),b.value?(p(),y("div",SU,[Pe(al,{locations:e.checkpoints,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:x.value,zoom:15,"user-location":A.value,height:"200px"},null,8,["locations","route","route-color","route-style","route-weight","center","user-location"])])):P("",!0)])):P("",!0)]),r("div",xU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.reporter}]),onClick:F[2]||(F[2]=j=>k("reporter"))},[F[14]||(F[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",$U,_(e.incident.reportedBy?.name||"Unknown"),1),r("span",TU,_(h.value.reporter?"":""),1)],2),h.value.reporter?(p(),y("div",MU,[r("div",AU,[r("span",EU,_(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),w.value.length?(p(),y("div",PU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.marshals}]),onClick:F[3]||(F[3]=j=>k("marshals"))},[r("span",DU,_(N(n).peoplePlural)+" at "+_(N(n).checkpoint.toLowerCase()),1),r("span",RU,_(w.value.length),1),r("span",OU,_(h.value.marshals?"":""),1)],2),h.value.marshals?(p(),y("div",BU,[r("div",NU,[(p(!0),y(Ie,null,je(w.value,j=>(p(),y("div",{key:j.marshalId,class:le(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",FU,_(j.name),1),j.wasCheckedIn?(p(),y("span",UU," Checked in "+_(O(j.checkInTime)),1)):(p(),y("span",zU," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),r("div",HU,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.notes}]),onClick:F[4]||(F[4]=j=>k("notes"))},[F[15]||(F[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(p(),y("span",VU,_(e.incident.updates.length),1)):P("",!0),r("span",GU,_(h.value.notes?"":""),1)],2),h.value.notes?(p(),y("div",qU,[e.incident.updates?.length?(p(),y("div",jU,[(p(!0),y(Ie,null,je(e.incident.updates,(j,Z)=>(p(),y("div",{key:Z,class:"note-item"},[r("div",WU,[r("span",ZU,_(j.authorName||"System"),1),r("span",KU,_(O(j.timestamp)),1)]),j.statusChange?(p(),y("div",YU,[F[16]||(F[16]=Je(" Status changed to ",-1)),r("span",{class:le(["status-badge",j.statusChange])},_($(j.statusChange)),3)])):j.note?(p(),y("p",JU,_(j.note),1)):P("",!0)]))),128))])):(p(),y("div",XU," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn disable-on-load",onClick:F[5]||(F[5]=j=>U.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},M1=Ke(QU,[["__scopeId","data-v-fe828546"]]),ez={class:"form-group"},tz={class:"form-group"},nz={class:"form-row"},oz={class:"form-group form-group-half"},sz=["value"],az={class:"form-group form-group-half"},iz={key:0,class:"form-group"},lz={for:"checkpoint",class:"form-label"},rz=["value"],cz={key:1,class:"form-group"},uz={class:"form-label"},dz={class:"checkpoint-toggle"},hz={class:"checkbox-label"},fz={class:"checkpoint-name"},pz={key:0,class:"checkpoint-description"},vz={class:"form-group"},mz={class:"location-options"},gz={class:"location-buttons"},yz={key:0,class:"location-status"},kz={key:0,class:"location-getting"},bz={key:1,class:"location-display"},wz={key:0,class:"location-accuracy"},_z={key:2,class:"location-error"},Cz={key:1,class:"map-picker-container"},Lz={key:0,class:"map-picker-hint"},Iz={key:2,class:"location-display"},Sz={key:2,class:"error-message"},xz={class:"modal-actions"},$z=["disabled"],Tz={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:n}=dt(),s=e,o=t,i=D({title:"",description:"",severity:"medium",incidentTime:""}),l=D(""),c=D(!0),d=D("none"),h=D(!1),f=D(null),v=D(null),g=D(null),k=D(!1),b=D(!1),x=D(null),A=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],T=()=>{const j=new Date,Z=j.getFullYear(),Q=String(j.getMonth()+1).padStart(2,"0"),re=String(j.getDate()).padStart(2,"0"),K=String(j.getHours()).padStart(2,"0"),ae=String(j.getMinutes()).padStart(2,"0");return`${Z}-${Q}-${re}T${K}:${ae}`},w=j=>j?new Date(j).toISOString():null,C=H(()=>s.checkpoints||[]),I=H(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=C.value.find(Z=>Z.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.initialLocation?.latitude!=null)return{lat:s.initialLocation.latitude,lng:s.initialLocation.longitude};if(s.checkpoint?.latitude!=null)return{lat:s.checkpoint.latitude,lng:s.checkpoint.longitude};if(C.value.length>0){const j=C.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(s.route?.length>0){const j=s.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),$=H(()=>i.value.description.trim()!==""),R=H(()=>i.value.description.trim()!=="");Ye(()=>s.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:T()},l.value="",c.value=!0,b.value=!1,x.value=null,g.value=null,f.value=null,v.value=null,s.initialLocation&&s.initialLocation.latitude!=null?(f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},v.value=s.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),s.checkpoint&&(l.value=s.checkpoint.locationId||s.checkpoint.id||""))});const M=j=>{g.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,v.value=null):j==="gps"?(d.value="gps",h.value=!1,E()):(d.value="none",h.value=!1,f.value=null,v.value=null)},O=j=>{f.value={latitude:j.lat,longitude:j.lng},v.value=null,h.value=!1},E=()=>{if(s.initialLocation&&s.initialLocation.latitude!=null){f.value={latitude:s.initialLocation.latitude,longitude:s.initialLocation.longitude},v.value=s.initialLocation.accuracy;return}if(!navigator.geolocation){g.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},v.value=j.coords.accuracy,k.value=!1},j=>{g.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},U=async()=>{if(!(!R.value||b.value)){b.value=!0,x.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let Z=null,Q=!1;C.value.length>0?l.value?Z=l.value:Q=!0:s.checkpoint&&(c.value?Z=s.checkpoint.locationId||s.checkpoint.id||null:Q=!0);const re={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:w(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:Z,skipCheckpointAutoAssign:Q};o("submit",re)}catch(j){x.value=j.message||"Failed to report incident. Please try again.",b.value=!1}}},F=()=>{o("close")};return(j,Z)=>(p(),Ge(Yt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":$.value,onClose:F},{footer:Ve(()=>[r("div",xz,[r("button",{type:"button",class:"btn btn-secondary",onClick:F}," Cancel "),r("button",{type:"button",class:"btn btn-primary disable-on-load",onClick:U,disabled:!R.value||b.value},_(b.value?"Reporting...":"Report Incident"),9,$z)])]),default:Ve(()=>[r("form",{onSubmit:rt(U,["prevent"]),class:"incident-form"},[r("div",ez,[Z[10]||(Z[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),We(r("input",{id:"title","onUpdate:modelValue":Z[0]||(Z[0]=Q=>i.value.title=Q),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),r("div",tz,[Z[11]||(Z[11]=r("label",{for:"description",class:"form-label"},[Je("Description "),r("span",{class:"required"},"*")],-1)),We(r("textarea",{id:"description","onUpdate:modelValue":Z[1]||(Z[1]=Q=>i.value.description=Q),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),r("div",nz,[r("div",oz,[Z[12]||(Z[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),We(r("select",{id:"severity","onUpdate:modelValue":Z[2]||(Z[2]=Q=>i.value.severity=Q),class:"form-input form-select"},[(p(),y(Ie,null,je(A,Q=>r("option",{key:Q.value,value:Q.value},_(Q.label),9,sz)),64))],512),[[no,i.value.severity]])]),r("div",az,[Z[13]||(Z[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),We(r("input",{id:"incidentTime","onUpdate:modelValue":Z[3]||(Z[3]=Q=>i.value.incidentTime=Q),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),C.value.length>0?(p(),y("div",iz,[r("label",lz,_(N(n).checkpoint),1),We(r("select",{id:"checkpoint","onUpdate:modelValue":Z[4]||(Z[4]=Q=>l.value=Q),class:"form-input form-select"},[Z[14]||(Z[14]=r("option",{value:""},"-- None / Unknown --",-1)),(p(!0),y(Ie,null,je(C.value,Q=>(p(),y("option",{key:Q.id,value:Q.id},_(Q.name)+_(Q.description?` - ${Q.description}`:""),9,rz))),128))],512),[[no,l.value]])])):e.checkpoint?(p(),y("div",cz,[r("label",uz,_(N(n).checkpoint),1),r("div",dz,[r("label",hz,[We(r("input",{type:"checkbox","onUpdate:modelValue":Z[5]||(Z[5]=Q=>c.value=Q)},null,512),[[$s,c.value]]),r("span",fz,_(e.checkpoint.name),1),e.checkpoint.description?(p(),y("span",pz," - "+_(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),r("div",vz,[Z[15]||(Z[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",mz,[r("div",gz,[r("button",{type:"button",class:le(["location-btn",{active:d.value==="gps"}]),onClick:Z[6]||(Z[6]=Q=>M("gps"))}," GPS ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="map"}]),onClick:Z[7]||(Z[7]=Q=>M("map"))}," Pick on map ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="none"}]),onClick:Z[8]||(Z[8]=Q=>M("none"))}," None ",2)]),d.value==="gps"?(p(),y("div",yz,[k.value?(p(),y("div",kz," Getting location... ")):f.value&&f.value.latitude!=null?(p(),y("div",bz,[r("span",null,_(f.value.latitude.toFixed(5))+", "+_(f.value.longitude.toFixed(5)),1),v.value?(p(),y("span",wz,"("+_(Math.round(v.value))+"m)",1)):P("",!0)])):g.value?(p(),y("div",_z,_(g.value),1)):P("",!0)])):P("",!0),d.value==="map"?(p(),y("div",Cz,[h.value?(p(),y("div",Lz,"Tap to select location")):P("",!0),h.value?(p(),Ge(al,{key:1,locations:C.value,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:I.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:O},null,8,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id"])):P("",!0),f.value&&f.value.latitude!=null?(p(),y("div",Iz,[r("span",null,_(f.value.latitude.toFixed(5))+", "+_(f.value.longitude.toFixed(5)),1),h.value?P("",!0):(p(),y("button",{key:0,type:"button",class:"location-edit-btn",onClick:Z[9]||(Z[9]=Q=>h.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),x.value?(p(),y("div",Sz,_(x.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},A1=Ke(Tz,[["__scopeId","data-v-38a5456c"]]),Mz={class:"tab-content"},Az={key:0,class:"form-group"},Ez={for:"marshalId"},Pz=["value"],Dz={class:"help-text"},Rz={key:1,class:"form-group"},Oz={class:"linked-marshal-info"},Bz={class:"linked-marshal-name"},Nz={class:"linked-marshal-hint"},Fz={key:2,class:"form-group"},Uz={class:"form-group"},zz={key:0,class:"selected-roles"},Hz=["onClick"],Vz={class:"role-input-group"},Gz=["value"],qz={class:"checkbox-label-inline show-emergency-checkbox"},jz={class:"form-row"},Wz={class:"form-group"},Zz={class:"form-group"},Kz={class:"form-group"},Yz={class:"form-row"},Jz={class:"form-group"},Xz={class:"form-group checkbox-group-inline"},Qz={class:"checkbox-label-inline"},eH={class:"tab-content"},tH={class:"custom-footer"},nH={class:"footer-left"},oH=["disabled"],sH={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D("details"),d=D(""),h=D({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=H(()=>[...s.roleDefinitions].sort((Q,re)=>Q.isBuiltIn!==re.isBuiltIn?Q.isBuiltIn?-1:1:Q.displayOrder!==re.displayOrder?(Q.displayOrder||0)-(re.displayOrder||0):(Q.name||"").localeCompare(re.name||"",void 0,{numeric:!0,sensitivity:"base"}))),v=H(()=>{const Q=h.value.roles||[];return f.value.filter(re=>!Q.includes(re.roleId))}),g=Q=>s.roleDefinitions.find(K=>K.roleId===Q)?.name||Q,k=Q=>s.roleDefinitions.find(K=>K.roleId===Q)?.name==="EmergencyContact",b=()=>{d.value&&!h.value.roles.includes(d.value)&&(h.value.roles.push(d.value),k(d.value)&&(h.value.showInEmergencyInfo=!0),M()),d.value=""},x=Q=>{const re=h.value.roles.indexOf(Q);re>-1&&(h.value.roles.splice(re,1),k(Q)&&!h.value.roles.some(K=>k(K))&&(h.value.showInEmergencyInfo=!1),M())},A=H(()=>!!s.contact),T=H(()=>s.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),w=H(()=>!!h.value.marshalId),C=H(()=>!A.value&&!!s.prefilledMarshalId),I=H(()=>A.value&&!!s.contact?.marshalId),$=H(()=>s.contact?.marshalId?s.marshals.find(re=>re.id===s.contact.marshalId)?.name||"Unknown":""),R=H(()=>[...s.marshals].sort((Q,re)=>Qo(Q.name,re.name)));Ye(()=>s.show,Q=>{if(Q){if(c.value=s.initialTab,d.value="",s.contact){let re=[];s.contact.roles&&Array.isArray(s.contact.roles)&&(re=[...s.contact.roles]),h.value={roles:re,name:s.contact.name||"",phone:s.contact.phone||"",email:s.contact.email||"",notes:s.contact.notes||"",marshalId:s.contact.marshalId||null,showInEmergencyInfo:s.contact.showInEmergencyInfo??re.some(K=>k(K)),displayOrder:s.contact.displayOrder||0,isPinned:s.contact.isPinned||!1,scopeConfigurations:s.contact.scopeConfigurations?JSON.parse(JSON.stringify(s.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{let re;s.createFromAreaContext?re=[]:s.preselectedArea?re=[{scope:"EveryoneInAreas",itemType:"Area",ids:[s.preselectedArea.id]}]:re=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let K={name:s.prefilledName||"",phone:"",email:"",roles:[]};if(s.prefilledMarshalId){const ae=s.marshals.find(q=>q.id===s.prefilledMarshalId);ae&&(K={name:ae.name||"",phone:ae.phoneNumber||"",email:ae.email||"",roles:ae.roles||[]})}h.value={roles:[...K.roles],name:K.name,phone:K.phone,email:K.email,notes:"",marshalId:s.prefilledMarshalId||null,showInEmergencyInfo:K.roles.some(ae=>k(ae)),displayOrder:0,isPinned:!1,scopeConfigurations:re}}o("update:isDirty",!1)}});const M=()=>{o("update:isDirty",!0)},O=()=>{if(h.value.marshalId){const Q=s.marshals.find(re=>re.id===h.value.marshalId);Q&&(h.value.name=Q.name,!h.value.phone&&Q.phoneNumber&&(h.value.phone=Q.phoneNumber),!h.value.email&&Q.email&&(h.value.email=Q.email),h.value.roles=Q.roles?[...Q.roles]:[],h.value.showInEmergencyInfo=h.value.roles.some(re=>k(re)))}else h.value.name="";M()},E=()=>{o("close")},U=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}c.value="visibility"},F=Q=>{l.value=Q,i.value=!0},j=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}if(!s.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){F("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(K=>!(K.itemType!==null&&(!K.ids||K.ids.length===0)))){F("Please configure at least one scope with valid selections");return}}const Q={roles:h.value.roles,name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};o("save",Q)},Z=()=>{o("delete",s.contact.contactId)};return(Q,re)=>(p(),y(Ie,null,[Pe(Yt,{show:e.show,title:A.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:E},{"tab-header":Ve(()=>[Pe(ul,{modelValue:c.value,"onUpdate:modelValue":re[0]||(re[0]=K=>c.value=K),tabs:T.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[r("div",tH,[r("div",nH,[A.value?(p(),y("button",{key:0,type:"button",onClick:Z,class:"btn btn-danger"}," Delete ")):P("",!0),!A.value&&c.value==="details"?(p(),y("button",{key:1,type:"button",onClick:U,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),r("button",{type:"button",onClick:j,class:"btn btn-success",disabled:A.value&&!e.isDirty}," Save ",8,oH)])]),default:Ve(()=>[r("form",{onSubmit:rt(j,["prevent"]),class:"contact-form"},[We(r("div",Mz,[!C.value&&!I.value?(p(),y("div",Az,[r("label",Ez,"Link to "+_(N(n).person.toLowerCase())+":",1),We(r("select",{id:"marshalId","onUpdate:modelValue":re[1]||(re[1]=K=>h.value.marshalId=K),onChange:O},[re[12]||(re[12]=r("option",{value:null},"-- Not linked --",-1)),(p(!0),y(Ie,null,je(R.value,K=>(p(),y("option",{key:K.id,value:K.id},_(K.name),9,Pz))),128))],544),[[no,h.value.marshalId]]),r("span",Dz,"Optionally link to an existing "+_(N(n).person.toLowerCase())+" in the system",1)])):P("",!0),I.value?(p(),y("div",Rz,[r("label",null,"Linked "+_(N(n).person.toLowerCase())+":",1),r("div",Oz,[r("span",Bz,_($.value),1),r("span",Nz,"Contact details are synced with this "+_(N(n).person.toLowerCase()),1)])])):P("",!0),w.value?P("",!0):(p(),y("div",Fz,[re[13]||(re[13]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":re[2]||(re[2]=K=>h.value.name=K),type:"text",onInput:M,placeholder:"Contact name..."},null,544),[[st,h.value.name]])])),r("div",Uz,[re[16]||(re[16]=r("label",null,"Roles: *",-1)),h.value.roles.length>0?(p(),y("div",zz,[(p(!0),y(Ie,null,je(h.value.roles,K=>(p(),y("span",{key:K,class:"role-pill"},[Je(_(g(K))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:ae=>x(K),title:"Remove role"},"",8,Hz)]))),128))])):P("",!0),r("div",Vz,[We(r("select",{id:"role","onUpdate:modelValue":re[3]||(re[3]=K=>d.value=K),onChange:b},[re[14]||(re[14]=r("option",{value:"",disabled:""},"Add a role...",-1)),(p(!0),y(Ie,null,je(v.value,K=>(p(),y("option",{key:K.roleId,value:K.roleId},_(K.name),9,Gz))),128))],544),[[no,d.value]])]),r("label",qz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[4]||(re[4]=K=>h.value.showInEmergencyInfo=K),onChange:M},null,544),[[$s,h.value.showInEmergencyInfo]]),re[15]||(re[15]=r("span",null,"Show in emergency info",-1))])]),r("div",jz,[r("div",Wz,[re[17]||(re[17]=r("label",{for:"phone"},"Phone:",-1)),We(r("input",{id:"phone","onUpdate:modelValue":re[5]||(re[5]=K=>h.value.phone=K),type:"tel",onInput:M,placeholder:"Phone number..."},null,544),[[st,h.value.phone]])]),r("div",Zz,[re[18]||(re[18]=r("label",{for:"email"},"Email:",-1)),We(r("input",{id:"email","onUpdate:modelValue":re[6]||(re[6]=K=>h.value.email=K),type:"email",onInput:M,placeholder:"Email address..."},null,544),[[st,h.value.email]])])]),r("div",Kz,[re[19]||(re[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":re[7]||(re[7]=K=>h.value.notes=K),onInput:M,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,h.value.notes]])]),r("div",Yz,[r("div",Jz,[re[20]||(re[20]=r("label",{for:"displayOrder"},"Display order:",-1)),We(r("input",{id:"displayOrder","onUpdate:modelValue":re[8]||(re[8]=K=>h.value.displayOrder=K),type:"number",onInput:M,min:"0"},null,544),[[st,h.value.displayOrder,void 0,{number:!0}]]),re[21]||(re[21]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",Xz,[r("label",Qz,[We(r("input",{type:"checkbox","onUpdate:modelValue":re[9]||(re[9]=K=>h.value.isPinned=K),onChange:M},null,544),[[$s,h.value.isPinned]]),re[22]||(re[22]=r("span",null,"Pin to top",-1))]),re[23]||(re[23]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[ns,c.value==="details"]]),We(r("div",eH,[Pe(ld,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":re[10]||(re[10]=K=>h.value.scopeConfigurations=K),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":A.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:M},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ns,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(_c,{show:i.value,title:"Validation error",message:l.value,onClose:re[11]||(re[11]=K=>i.value=!1)},null,8,["show","message"])],64))}},aH=Ke(sH,[["__scopeId","data-v-300a990f"]]),iH={class:"tab-content"},lH={class:"form-group"},rH={class:"form-group"},cH={class:"form-group checkbox-group"},uH={class:"checkbox-label"},dH={class:"checkbox-text"},hH={class:"help-text"},fH={class:"tab-content"},pH={key:0,class:"loading-state"},vH={key:1,class:"empty-state"},mH={key:2,class:"people-list"},gH={class:"search-row"},yH={class:"people-items"},kH=["checked","onChange"],bH={class:"person-name"},wH={class:"person-type-badge marshal"},_H={key:0,class:"empty-search"},CH={class:"custom-footer"},LH={class:"footer-left"},IH={__name:"EditRoleDefinitionModal",props:{show:{type:Boolean,default:!1},role:{type:Object,default:null},initialTab:{type:String,default:"details"},people:{type:Array,default:()=>[]},loadingPeople:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty","load-people"],setup(e,{emit:t}){const{terms:n}=dt(),s=e,o=t,i=D(!1),l=D(""),c=D(""),d=D(new Map),h=D([]),f=D({marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set}),v=[{value:"details",label:"Details"},{value:"assignments",label:"Assignments"}],g=D(s.initialTab),k=D({name:"",notes:"",canManageAreaCheckpoints:!1}),b=H(()=>!!s.role?.roleId);Ye(()=>[s.show,s.role],([E,U])=>{E&&(g.value=s.initialTab,c.value="",d.value=new Map,h.value=[],f.value={marshalIdsToAdd:new Set,marshalIdsToRemove:new Set,contactIdsToAdd:new Set,contactIdsToRemove:new Set},U?k.value={name:U.name||"",notes:U.notes||"",canManageAreaCheckpoints:U.canManageAreaCheckpoints||!1}:k.value={name:"",notes:"",canManageAreaCheckpoints:!1},o("update:isDirty",!1))},{immediate:!0}),Ye(g,E=>{E==="assignments"&&b.value&&s.people.length===0&&o("load-people",s.role.roleId)}),Ye(()=>s.people,E=>{if(E.length>0&&(h.value=E.map(U=>({...U})),d.value.size===0)){const U=new Map;for(const F of E)U.set(F.id,F.hasRole);d.value=U}},{immediate:!0});const x=()=>{o("update:isDirty",!0)},A=E=>E==="Linked"?"Linked":E==="Marshal"?n.value.person:E==="Contact"?"Contact":E,T=H(()=>{let E=[...h.value];if(c.value.trim()){const U=c.value.toLowerCase();E=E.filter(F=>F.name.toLowerCase().includes(U))}return E.sort((U,F)=>{const j=d.value.get(U.id)??!1,Z=d.value.get(F.id)??!1;return j!==Z?j?-1:1:U.name.localeCompare(F.name,void 0,{sensitivity:"base"})})}),w=H(()=>h.value.length>0&&h.value.every(E=>E.hasRole));H(()=>f.value.marshalIdsToAdd.size>0||f.value.marshalIdsToRemove.size>0||f.value.contactIdsToAdd.size>0||f.value.contactIdsToRemove.size>0);const C=()=>{const E=!w.value;for(const U of h.value)U.hasRole!==E&&I(U,E)},I=(E,U)=>{const F=h.value.find(j=>j.id===E.id);F&&(F.hasRole=U),E.personType==="Marshal"||E.personType==="Linked"?U?f.value.marshalIdsToRemove.has(E.marshalId)?f.value.marshalIdsToRemove.delete(E.marshalId):f.value.marshalIdsToAdd.add(E.marshalId):f.value.marshalIdsToAdd.has(E.marshalId)?f.value.marshalIdsToAdd.delete(E.marshalId):f.value.marshalIdsToRemove.add(E.marshalId):E.personType==="Contact"&&(U?f.value.contactIdsToRemove.has(E.contactId)?f.value.contactIdsToRemove.delete(E.contactId):f.value.contactIdsToAdd.add(E.contactId):f.value.contactIdsToAdd.has(E.contactId)?f.value.contactIdsToAdd.delete(E.contactId):f.value.contactIdsToRemove.add(E.contactId)),o("update:isDirty",!0)},$=E=>{I(E,!E.hasRole)},R=()=>{if(!k.value.name.trim()){l.value="Role name is required.",i.value=!0;return}o("save",{name:k.value.name.trim(),notes:k.value.notes.trim(),canManageAreaCheckpoints:k.value.canManageAreaCheckpoints,assignmentChanges:{marshalIdsToAdd:Array.from(f.value.marshalIdsToAdd),marshalIdsToRemove:Array.from(f.value.marshalIdsToRemove),contactIdsToAdd:Array.from(f.value.contactIdsToAdd),contactIdsToRemove:Array.from(f.value.contactIdsToRemove)}})},M=()=>{o("delete",s.role.roleId)},O=()=>{o("close")};return(E,U)=>(p(),y(Ie,null,[Pe(Yt,{show:e.show,title:b.value?"Edit role":"Create role",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:O},{"tab-header":Ve(()=>[Pe(ul,{modelValue:g.value,"onUpdate:modelValue":U[0]||(U[0]=F=>g.value=F),tabs:v},null,8,["modelValue"])]),footer:Ve(()=>[r("div",CH,[r("div",LH,[b.value?(p(),y("button",{key:0,type:"button",onClick:M,class:"btn btn-danger",title:"Delete this role"}," Delete ")):P("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[r("form",{onSubmit:rt(R,["prevent"]),class:"role-form"},[We(r("div",iH,[r("div",lH,[U[6]||(U[6]=r("label",{for:"name"},"Name: *",-1)),We(r("input",{id:"name","onUpdate:modelValue":U[1]||(U[1]=F=>k.value.name=F),type:"text",onInput:x,required:"",placeholder:"Enter role name..."},null,544),[[st,k.value.name]])]),r("div",rH,[U[7]||(U[7]=r("label",{for:"notes"},"Notes:",-1)),We(r("textarea",{id:"notes","onUpdate:modelValue":U[2]||(U[2]=F=>k.value.notes=F),onInput:x,rows:"6",placeholder:"Enter role description or notes..."},null,544),[[st,k.value.notes]]),U[8]||(U[8]=r("span",{class:"help-text"},"Describe what this role is responsible for",-1))]),r("div",cH,[r("label",uH,[We(r("input",{type:"checkbox","onUpdate:modelValue":U[3]||(U[3]=F=>k.value.canManageAreaCheckpoints=F),onChange:x},null,544),[[$s,k.value.canManageAreaCheckpoints]]),r("span",dH,"Is "+_(N(n).area.toLowerCase())+" lead",1)]),r("span",hH,"When enabled, "+_(N(n).people.toLowerCase())+" with this role can view all other "+_(N(n).checkpoints.toLowerCase())+" and "+_(N(n).people.toLowerCase())+" in their "+_(N(n).area.toLowerCase())+".",1)])],512),[[ns,g.value==="details"]]),We(r("div",fH,[U[11]||(U[11]=r("div",{class:"assignments-header"},[r("h4",null,"Who has this role?"),r("p",{class:"help-text"},"Select the people who should have this role assigned.")],-1)),e.loadingPeople?(p(),y("div",pH," Loading people... ")):e.people.length===0?(p(),y("div",vH,[...U[9]||(U[9]=[r("p",null,"No marshals or contacts to assign.",-1)])])):(p(),y("div",mH,[r("div",gH,[We(r("input",{"onUpdate:modelValue":U[4]||(U[4]=F=>c.value=F),type:"text",class:"search-input",placeholder:"Search by name..."},null,512),[[st,c.value]]),r("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C},_(w.value?"Deselect all":"Select all"),1)]),r("div",yH,[(p(!0),y(Ie,null,je(T.value,F=>(p(),y("label",{key:F.id,class:le(["person-item",{checked:F.hasRole}])},[r("input",{type:"checkbox",checked:F.hasRole,onChange:j=>$(F)},null,40,kH),r("span",bH,_(F.name),1),F.personType==="Linked"?(p(),y(Ie,{key:0},[r("span",wH,_(N(n).person),1),U[10]||(U[10]=r("span",{class:"person-type-badge contact"},"Contact",-1))],64)):(p(),y("span",{key:1,class:le(["person-type-badge",F.personType.toLowerCase()])},_(A(F.personType)),3))],2))),128))]),T.value.length===0?(p(),y("div",_H," No people match your search. ")):P("",!0)]))],512),[[ns,g.value==="assignments"]])],32)]),_:1},8,["show","title","is-dirty"]),Pe(_c,{show:i.value,title:"Validation error",message:l.value,onClose:U[5]||(U[5]=F=>i.value=!1)},null,8,["show","message"])],64))}},SH=Ke(IH,[["__scopeId","data-v-4a0e6d84"]]),xH={key:0,class:"fullscreen-map-overlay"},$H={class:"fullscreen-map-header"},TH={class:"context-info"},MH={key:0},AH={class:"action-buttons"},EH=["disabled"],PH={class:"fullscreen-map-container"},DH={key:0,class:"drawing-controls"},RH={class:"point-count"},OH={class:"undo-redo-buttons"},BH=["disabled"],NH=["disabled"],FH=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const n=e,s=t,o=D(null),i=D(0),l=D(!1),c=D(!1),d=()=>{s("done")},h=()=>{s("cancel")},f=x=>{i.value=x?.length||0,v(),s("polygon-drawing",x)},v=()=>{o.value&&(l.value=o.value.canUndo(),c.value=o.value.canRedo())},g=()=>{o.value&&(o.value.undoPolygonPoint(),v())},k=()=>{o.value&&(o.value.redoPolygonPoint(),v())};Ye(()=>n.show,x=>{x||(i.value=0,l.value=!1,c.value=!1)});const b=x=>{x.key==="Escape"&&n.show&&h(),n.show&&n.drawingMode&&((x.ctrlKey||x.metaKey)&&x.key==="z"&&!x.shiftKey?(x.preventDefault(),g()):(x.ctrlKey||x.metaKey)&&(x.key==="y"||x.key==="z"&&x.shiftKey)&&(x.preventDefault(),k()))};return un(()=>{document.addEventListener("keydown",b)}),Sn(()=>{document.removeEventListener("keydown",b)}),(x,A)=>(p(),Ge(ec,{to:"body"},[e.show?(p(),y("div",xH,[r("div",$H,[r("div",TH,[r("h3",null,_(e.contextTitle),1),e.contextDescription?(p(),y("p",MH,_(e.contextDescription),1)):P("",!0)]),r("div",AH,[e.mode==="view"?(p(),y("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(p(),y(Ie,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,EH)],64))])]),r("div",PH,[Pe(Qh,qg({ref_key:"mapViewRef",ref:o,"drawing-mode":e.drawingMode},x.$attrs,{onMapClick:A[0]||(A[0]=T=>x.$emit("map-click",T)),onPolygonComplete:A[1]||(A[1]=T=>x.$emit("polygon-complete",T)),onPolygonDrawing:f,onLocationClick:A[2]||(A[2]=T=>x.$emit("location-click",T)),onAreaClick:A[3]||(A[3]=T=>x.$emit("area-click",T))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(p(),y("div",DH,[r("div",RH,_(i.value)+" point"+_(i.value!==1?"s":""),1),r("div",OH,[r("button",{onClick:g,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,BH),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!c.value,title:"Redo point"}," Redo  ",8,NH)])])):P("",!0)])])):P("",!0)]))}}),UH=Ke(FH,[["__scopeId","data-v-9ce62b55"]]),zH={class:"form-group"},HH={class:"form-group"},VH={class:"form-group"},GH={key:0,class:"form-error"},qH={class:"form-row"},jH={class:"form-group",style:{flex:"1"}},WH={class:"form-group",style:{flex:"1"}},ZH={class:"form-group",style:{flex:"0 0 auto"}},KH={class:"form-group"},YH={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:n}=dt(),s=e,o=t,i=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ye(()=>s.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{o("update:isDirty",!0),o("update:location",{...i.value})},c=()=>{if(!Lu(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}o("save",i.value)},d=()=>{o("close")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:`Add ${N(n).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add "+_(N(n).checkpoint),1)]),default:Ve(()=>[r("form",{onSubmit:rt(c,["prevent"])},[r("div",zH,[f[7]||(f[7]=r("label",null,"Name",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=v=>i.value.name=v),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",HH,[f[8]||(f[8]=r("label",null,"Description",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=v=>i.value.description=v),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",VH,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=v=>i.value.what3Words=v),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!N(Lu)(i.value.what3Words)?(p(),y("small",GH," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),r("div",qH,[r("div",jH,[f[10]||(f[10]=r("label",null,"Longitude",-1)),We(r("input",{"onUpdate:modelValue":f[3]||(f[3]=v=>i.value.longitude=v),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",WH,[f[11]||(f[11]=r("label",null,"Latitude",-1)),We(r("input",{"onUpdate:modelValue":f[4]||(f[4]=v=>i.value.latitude=v),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",ZH,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=v=>h.$emit("set-on-map"))},"  ")])]),r("div",KH,[r("label",null,"Required "+_(N(n).people),1),We(r("input",{"onUpdate:modelValue":f[6]||(f[6]=v=>i.value.requiredMarshals=v),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},JH=Ke(YH,[["__scopeId","data-v-fb51fed0"]]),XH=["aria-expanded","title"],QH=["innerHTML"],eV={key:0,class:"dropdown-menu"},tV=["onClick"],nV=["innerHTML"],oV={__name:"ThemeToggle",setup(e){const{theme:t,isDark:n,setTheme:s}=n1(),o=D(!1),i=D(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=H(()=>n.value?l.dark:l.light),h=()=>{o.value=!o.value},f=g=>{s(g),o.value=!1},v=g=>{i.value&&!i.value.contains(g.target)&&(o.value=!1)};return un(()=>{document.addEventListener("click",v)}),Sn(()=>{document.removeEventListener("click",v)}),(g,k)=>(p(),y("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":o.value,title:N(n)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,QH)],8,XH),o.value?(p(),y("div",eV,[(p(),y(Ie,null,je(c,b=>r("button",{key:b.value,class:le(["dropdown-item",{active:N(t)===b.value}]),onClick:x=>f(b.value)},[r("span",{class:"option-icon",innerHTML:b.icon},null,8,nV),r("span",null,_(b.label),1)],10,tV)),64))])):P("",!0)],512))}},sV=Ke(oV,[["__scopeId","data-v-969124a4"]]),aV={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},iV=["id"],lV=["filter"],rV={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){Z0(n=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=H(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(n,s)=>(p(),y("svg",aV,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...s[0]||(s[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,iV)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,lV),s[2]||(s[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:le({"marshal-figure":e.animate})},[...s[1]||(s[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},cV=Ke(rV,[["__scopeId","data-v-3e647831"]]),uV={class:"header"},dV={class:"header-left"},hV={key:0},fV={class:"event-date"},pV={class:"header-actions"},vV={class:"container"},mV={class:"tabs-nav"},gV={class:"tab-content-wrapper"},yV={class:"add-note-form"},kV={class:"modal-footer-actions"},bV=["disabled"],wV=6e4,_V={__name:"AdminEventManage",setup(e){const t=Qu(),n=ir(),s=Xy(),o=H(()=>t.params.eventId),{activeTab:i,switchTab:l}=Qy("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","roles","settings"]),{showConfirmModal:c,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:v,showConfirm:g,handleConfirmModalConfirm:k,handleConfirmModalCancel:b}=v2(),{tabLabels:x,terms:A,termsLower:T}=dt(),w=m2(),C=y2(o),I=g2(o),{colorScheme:$}=n1(),R=H(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:x.value.course,icon:"course"},{value:"areas",label:x.value.areas,icon:"area"},{value:"checkpoints",label:x.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:x.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:x.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"roles",label:"Roles",icon:"roles"},{value:"settings",label:"Settings",icon:"settings"}]),M=D(null),O=D([]),E=D([]),U=D({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0,roles:0}),F=D(null),j=D(!1),Z=D(!1),Q=D(null),re=D(null),K=D(!1),ae=D(!1),q=D(null),J=D(""),ee=I.eventAdmins,ue=I.showAddAdmin,_e=C.showUploadRoute,$e=C.uploading,De=C.uploadError,Re=C.showImportLocations,be=C.showImportMarshals,z=C.importing,Y=C.importingMarshals,de=C.importError,ie=C.importResult,Ae=C.importMarshalsResult,G=D(!1),X=D(!1),te=D({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ce=D(!1),Ne=D(!1),Fe=D({marshalName:"",locations:[],marshal:null}),Ee=D(null),oe=D([]),ge=D(!1),Be=D(null),Oe=D(null),xe=D(null),me=D({}),Ze=D({id:"",name:"",email:"",phoneNumber:"",notes:""}),qe=D(!1),fe=D([]),ke=D([]),ne=D([]),ye=D([]),He=D(!1),ct=D(""),ht=D(""),Bt=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Lt=D(!1),Nt=D(!1),Et=D(""),yo=D(""),ko=D(0),ft=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Pt=D([]),mt=D(null),An=D(!1),Ao=D("details"),ao=D(null),bo=D(null),Gt=D(null),As=w.isAddingMultipleCheckpoints,wo=w.multiCheckpointCounter,zo=w.isFullscreenMapActive,pe=w.fullscreenMode,ve=w.fullscreenContext,Se=w.tempLocationCoords,lt=w.tempCheckpoints,Qe=w.savedMapCenter,Ft=w.savedMapZoom,sn=w.isDrawingAreaBoundary,yn=D(null),_n=D([]),_o=D(null),Ho=D(!1),Vo=D("details"),Ma=H(()=>!_n.value||_n.value.length===0?0:Math.max(..._n.value.map(se=>se.displayOrder||0))+1),dl=D(null),hl=D(null),bi=D(!1),Go=D([]),qo=D(null),Aa=D(!1),Es=D("details"),Vn=D([]),wi=D(!1),Gn=D(null),jo=D(!1),os=D(!1),Ks=D(!1),io=D(""),Ys=D(!1),qn=D([]),Wo=D({builtInRoles:[],customRoles:[]}),bt=D(null),Dt=D(!1),jn=D([]),On=D(null),Bn=D(!1),ss=D("details"),pt=D([]),Vt=D(!1),Co=D("details"),Lo=D(null),Cn=D(""),Js=D(null),Eo=D(null),Io=H(()=>Eo.value?.marshalId!=null),en=()=>{n.push(`/event/${t.params.eventId}`)},Wn=H(()=>`${window.location.origin}/#/event/${t.params.eventId}`),lo=H(()=>{const V=[];return E.value.forEach(se=>{se.assignments&&V.push(...se.assignments)}),V}),Ps=H(()=>{if(!Be.value)return E.value;const V=Be.value.assignedLocationIds||[],se=ne.value.map(we=>we.locationId),ce=ye.value;return E.value.filter(we=>!V.includes(we.id)&&!se.includes(we.id)||ce.includes(we.id))}),Ea=H(()=>{let V=oe.value;if(F.value){const se=F.value.assignments.map(we=>we.marshalName),ce=fe.value.map(we=>we.marshalName);V=oe.value.filter(we=>!se.includes(we.name)&&!ce.includes(we.name))}return V.slice().sort((se,ce)=>se.name.localeCompare(ce.name))}),Xs=H(()=>pe.value==="draw-area"&&mt.value?.polygon?.length>0||w.canCompleteFullscreen.value),_i=H(()=>pe.value==="move-checkpoint"&&F.value?.id?F.value.id:null),Pa=H(()=>{const V=[...E.value];return pe.value==="place-checkpoint"&&Se.value&&V.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Se.value.lat,longitude:Se.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),pe.value==="move-checkpoint"&&Se.value&&F.value&&V.push({id:"temp-move",name:F.value.name+" (new position)",latitude:Se.value.lat,longitude:Se.value.lng,requiredMarshals:F.value.requiredMarshals,assignments:[],isTemporary:!0}),pe.value==="add-multiple"&&V.push(...lt.value),V}),Da=H(()=>{let V=[...Pt.value];return pe.value==="draw-area"&&mt.value?.id&&(V=V.filter(se=>se.id!==mt.value.id)),pe.value==="draw-area"&&mt.value?.polygon?.length>0&&V.push({...mt.value,id:mt.value.id||"temp-area"}),V}),Ds=H(()=>{if(!Be.value||!Vn.value.length)return[];const V=Be.value.id,se=Be.value.assignedLocationIds||[];return Vn.value.filter(ce=>{if(ce.reportedBy?.marshalId===V)return!0;const we=ce.context?.checkpoint?.checkpointId;return!!(we&&se.includes(we))}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),Ra=H(()=>{if(!F.value||!Vn.value.length)return[];const V=F.value.id;return Vn.value.filter(se=>se.context?.checkpoint?.checkpointId===V).sort((se,ce)=>new Date(ce.incidentTime||ce.createdAt)-new Date(se.incidentTime||se.createdAt))}),Rs=H(()=>{if(!mt.value||!Vn.value.length)return[];const V=mt.value.id,se=E.value.filter(ce=>ce.areaIds&&ce.areaIds.includes(V)).map(ce=>ce.id);return Vn.value.filter(ce=>{const we=ce.context?.checkpoint?.checkpointId;return we&&se.includes(we)}).sort((ce,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ce.incidentTime||ce.createdAt))}),Ci=V=>{Gn.value=V,jo.value=!0},Li=V=>{Gn.value=V,jo.value=!0},ur=V=>{Gn.value=V,jo.value=!0},wt=()=>{n.push("/sessions")},Rt=(V=!0)=>{qe.value=V},Ut=()=>{Lt.value=!0},Oa=async V=>{try{V&&(Bt.value={...V});const se=cc(M.value.eventDate),ce=Bt.value.eventDate;if(se!==ce){const we=O.value.filter(at=>at.startTime||at.endTime);if(we.length>0){Et.value=se,yo.value=ce,ko.value=we.length,Nt.value=!0;return}}await ro(!1,null)}catch(se){console.error("Failed to update event:",se),alert("Failed to update event. Please try again.")}},ro=async(V,se)=>{try{if(await s.updateEvent(t.params.eventId,{...Bt.value,defaultCheckpointStyleMapRotation:Bt.value.defaultCheckpointStyleMapRotation!=null?String(Bt.value.defaultCheckpointStyleMapRotation):null}),V&&se!==null){const ce=Math.floor(Math.abs(se)/1e3),we=se<0,at=Math.floor(ce/3600),xt=Math.floor(ce%3600/60),jt=ce%60,$n=`${we?"-":""}${at.toString().padStart(2,"0")}:${xt.toString().padStart(2,"0")}:${jt.toString().padStart(2,"0")}`;await s.bulkUpdateLocationTimes(t.params.eventId,$n)}await Zn(),Lt.value=!1}catch(ce){console.error("Failed to update event:",ce),alert("Failed to update event. Please try again.")}},Ii=async({shouldShift:V,timeDelta:se})=>{Nt.value=!1,await ro(V,se)},Qs=()=>{Nt.value=!1,Zn()},as=async({routeColor:V,routeStyle:se,routeWeight:ce})=>{if(M.value)try{await s.updateEvent(t.params.eventId,{name:M.value.name,description:M.value.description,eventDate:M.value.eventDate,timeZoneId:M.value.timeZoneId,routeColor:V,routeStyle:se,routeWeight:ce}),M.value={...M.value,routeColor:V,routeStyle:se,routeWeight:ce}}catch(we){console.error("Failed to update route settings:",we)}},Zn=async()=>{try{await s.fetchEvent(t.params.eventId),M.value=s.currentEvent,M.value&&(Bt.value={name:M.value.name||"",description:M.value.description||"",eventDate:cc(M.value.eventDate),timeZoneId:M.value.timeZoneId||"UTC",peopleTerm:M.value.peopleTerm||"Marshals",checkpointTerm:M.value.checkpointTerm||"Checkpoints",areaTerm:M.value.areaTerm||"Areas",checklistTerm:M.value.checklistTerm||"Checklists",courseTerm:M.value.courseTerm||"Course",defaultCheckpointStyleType:M.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:M.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:M.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:M.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:M.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:M.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:M.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:M.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:M.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:M.value.brandingHeaderGradientEnd||"",brandingLogoUrl:M.value.brandingLogoUrl||"",brandingLogoPosition:M.value.brandingLogoPosition||"",brandingAccentColor:M.value.brandingAccentColor||"",brandingPageGradientStart:M.value.brandingPageGradientStart||"",brandingPageGradientEnd:M.value.brandingPageGradientEnd||""},Lt.value=!1,Yh(M.value));const V=await Promise.allSettled([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),ln(),kn(),qt(),co(),xn(),ea(),Os(),cs()]);O.value=s.locations,E.value=s.eventStatus.locations,V.forEach((se,ce)=>{se.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts","roles"][ce]}:`,se.reason)})}catch(V){console.error("Failed to load event data:",V)}},kn=async()=>{try{const V=await bs.getByEvent(t.params.eventId);oe.value=V.data,U.value.marshals=Date.now()}catch(V){console.error("Failed to load marshals:",V)}},qt=async()=>{try{const V=await ma.getByEvent(t.params.eventId);Pt.value=V.data,U.value.areas=Date.now()}catch(V){console.error("Failed to load areas:",V)}},co=async()=>{try{const[V,se]=await Promise.all([Ot.getByEvent(t.params.eventId),Ot.getReport(t.params.eventId)]);_n.value=V.data,dl.value=se.data,U.value.checklists=Date.now()}catch(V){console.error("Failed to load checklists:",V)}},fl=async()=>{try{bi.value=!0;const V=await Ot.getDetailedReport(t.params.eventId);hl.value=V.data}catch(V){console.error("Failed to load detailed report:",V)}finally{bi.value=!1}},xn=async()=>{try{const V=await ys.getByEvent(t.params.eventId);Go.value=V.data,U.value.notes=Date.now()}catch(V){console.error("Failed to load notes:",V)}},ea=async()=>{wi.value=!0;try{const V=await ga.getAll(t.params.eventId),se=Jy(V.data);Vn.value=se.incidents||[],U.value.incidents=Date.now()}catch(V){console.error("Failed to load incidents:",V)}finally{wi.value=!1}},Os=async()=>{try{const[V,se]=await Promise.all([ua.getByEvent(t.params.eventId),ua.getRoles(t.params.eventId)]);qn.value=V.data,Wo.value=se.data,U.value.contacts=Date.now()}catch(V){console.error("Failed to load contacts:",V)}},Ba=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId)]),O.value=s.locations,U.value.checkpoints=Date.now(),E.value=s.eventStatus.locations},pl=async()=>{await Promise.all([kn(),s.fetchEventStatus(t.params.eventId)]),E.value=s.eventStatus.locations},Si=async()=>{await Promise.all([s.fetchLocations(t.params.eventId),s.fetchEventStatus(t.params.eventId),qt()]),O.value=s.locations,E.value=s.eventStatus.locations},$t=async()=>{await s.fetchEventStatus(t.params.eventId),E.value=s.eventStatus.locations},vl=()=>{mt.value=null,Ao.value="details",qe.value=!1,An.value=!0},En=V=>{mt.value=V,bo.value=V.id,Ao.value="details",qe.value=!1,An.value=!0},is=async V=>{try{let se;if(mt.value&&mt.value.id){if(se=mt.value.id,await ma.update(t.params.eventId,se,V),V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Ot.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Ot.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}}else se=(await ma.create({eventId:t.params.eventId,...V})).data.id;if(V.pendingContacts&&V.pendingContacts.length>0&&se)for(const ce of V.pendingContacts)try{const we=ce.scopeConfigurations?JSON.parse(JSON.stringify(ce.scopeConfigurations)):[],at=we.find(xt=>xt.scope==="EveryoneInAreas"&&xt.itemType==="Area");at?(at.ids||(at.ids=[]),at.ids.includes(se)||at.ids.push(se)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[se]}),await ua.update(t.params.eventId,ce.contactId,{...ce,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",ce,we)}if(V.contactsToRemove&&V.contactsToRemove.length>0&&se)for(const ce of V.contactsToRemove)try{const we=qn.value.find(jt=>jt.contactId===ce);if(!we)continue;const at=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],xt=at.find(jt=>jt.scope==="EveryoneInAreas"&&jt.itemType==="Area");if(xt&&xt.ids){xt.ids=xt.ids.filter($n=>$n!==se);const jt=xt.ids.length>0?at:at.filter($n=>!($n.scope==="EveryoneInAreas"&&$n.itemType==="Area"));await ua.update(t.params.eventId,ce,{...we,scopeConfigurations:jt})}}catch(we){console.error("Failed to remove area from contact:",ce,we)}if((V.pendingContacts&&V.pendingContacts.length>0||V.contactsToRemove&&V.contactsToRemove.length>0)&&await Os(),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0&&se){for(const ce of V.pendingNewChecklistItems)if(ce.text?.trim())try{await Ot.create(t.params.eventId,{text:ce.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,isRequired:!1})}catch(we){console.error("Failed to create checklist item:",ce,we)}await co()}if(V.pendingNewNotes&&V.pendingNewNotes.length>0&&se){for(const ce of V.pendingNewNotes)if(!(!ce.title?.trim()&&!ce.content?.trim()))try{await ys.create(t.params.eventId,{title:ce.title||"Untitled",content:ce.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(we){console.error("Failed to create note:",ce,we)}await xn()}await qt(),await Zn(),xi()}catch(se){console.error("Failed to save area:",se),alert(se.response?.data?.message||"Failed to save area. Please try again.")}},ml=async V=>{g(`Delete ${T.value.area}`,`Are you sure you want to delete this ${T.value.area}? ${A.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ma.delete(t.params.eventId,V),await ma.recalculate(t.params.eventId),await qt(),await Zn(),xi()}catch(se){console.error(`Failed to delete ${T.value.area}:`,se),alert(se.response?.data?.message||`Failed to delete ${T.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},xi=()=>{An.value=!1,mt.value=null,bo.value=null,qe.value=!1,sn.value=!1,Gt.value=null},ls=({marshal:V,area:se})=>{bt.value=null,Co.value="details",qe.value=!1,Lo.value=se,Cn.value="",Js.value=V.id,Dt.value=!0},$i=({name:V,area:se})=>{bt.value=null,Co.value="details",qe.value=!1,Lo.value=se,Cn.value=V,Js.value=null,Dt.value=!0},gl=V=>{bt.value=V,Co.value="details",qe.value=!1,Dt.value=!0},dr=()=>{_o.value=null,Vo.value="details",qe.value=!1,Ho.value=!0},ta=(V,se="details")=>{_o.value=V,Vo.value=se,qe.value=!1,Ho.value=!0},na=async V=>{try{const se={...V,scopeConfigurations:zd(V.scopeConfigurations,{areas:Pt.value,locations:E.value,marshals:oe.value})};if(_o.value&&_o.value.itemId)await Ot.update(t.params.eventId,_o.value.itemId,se);else{const ce=await Ot.create(t.params.eventId,se);ce.data.count&&ce.data.count>1&&(ct.value="Checklist Items Created",ht.value=`Successfully created ${ce.data.count} checklist items.`,He.value=!0)}await co(),Pn()}catch(se){console.error("Failed to save checklist item:",se);const ce=se.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ce)}},Bs=async V=>{g(`Delete ${T.value.checklist}`,`Are you sure you want to delete this ${T.value.checklist}?`,async()=>{try{await Ot.delete(t.params.eventId,V),await co(),Pn()}catch(se){console.error(`Failed to delete ${T.value.checklist}:`,se),alert(se.response?.data?.message||`Failed to delete ${T.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Pn=()=>{Ho.value=!1,_o.value=null,qe.value=!1},Ti=async V=>{const se=[..._n.value];V.forEach(ce=>{const we=_n.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ot.reorder(t.params.eventId,V)}catch(ce){_n.value=se,console.error("Failed to reorder checklist items:",ce),alert("Failed to save order. Changes have been reverted.")}},Mi=()=>{qo.value=null,Es.value="details",qe.value=!1,Aa.value=!0},Po=V=>{qo.value=V,Es.value="details",qe.value=!1,Aa.value=!0},yl=async V=>{try{const se={...V,scopeConfigurations:zd(V.scopeConfigurations,{areas:Pt.value,locations:E.value,marshals:oe.value})};qo.value&&qo.value.noteId?await ys.update(t.params.eventId,qo.value.noteId,se):await ys.create(t.params.eventId,se),await xn(),Ns()}catch(se){console.error("Failed to save note:",se);const ce=se.response?.data?.message||"Failed to save note. Please try again.";alert(ce)}},kl=async V=>{g("Delete note","Are you sure you want to delete this note?",async()=>{try{await ys.delete(t.params.eventId,V),await xn(),Ns()}catch(se){console.error("Failed to delete note:",se),alert(se.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ns=()=>{Aa.value=!1,qo.value=null,qe.value=!1},Na=async V=>{const se=[...Go.value];V.forEach(ce=>{const we=Go.value.find(at=>at.noteId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await ys.reorder(t.params.eventId,V)}catch(ce){Go.value=se,console.error("Failed to reorder notes:",ce),alert("Failed to save order. Changes have been reverted.")}},Fa=async V=>{const se=[..._n.value];V.forEach(ce=>{const we=_n.value.find(at=>at.itemId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Ot.reorder(t.params.eventId,V)}catch(ce){_n.value=se,console.error("Failed to reorder checklists:",ce),alert("Failed to save order. Changes have been reverted.")}},bl=()=>{os.value=!0},hr=async V=>{try{await ga.create(t.params.eventId,V),os.value=!1,await ea()}catch(se){console.error("Failed to report incident:",se),alert(se.response?.data?.message||"Failed to report incident. Please try again.")}},wl=V=>{Gn.value=V,jo.value=!0},Ua=()=>{jo.value=!1,Gn.value=null},fr=async({incidentId:V,status:se})=>{try{if(await ga.updateStatus(t.params.eventId,V,{status:se}),await ea(),Gn.value?.incidentId===V){const ce=Vn.value.find(we=>we.incidentId===V);ce&&(Gn.value=ce)}}catch(ce){console.error("Failed to update incident status:",ce),alert(ce.response?.data?.message||"Failed to update status. Please try again.")}},za=()=>{io.value="",Ks.value=!0},oa=()=>{Ks.value=!1,io.value=""},Ha=async()=>{if(!(!io.value.trim()||!Gn.value)){Ys.value=!0;try{await ga.addNote(t.params.eventId,Gn.value.incidentId,io.value.trim()),oa(),await ea();const V=Vn.value.find(se=>se.incidentId===Gn.value.incidentId);V&&(Gn.value=V)}catch(V){console.error("Failed to add note to incident:",V),alert(V.response?.data?.message||"Failed to add note. Please try again.")}finally{Ys.value=!1}}},rs=()=>{bt.value=null,Co.value="details",Lo.value=null,qe.value=!1,Dt.value=!0},pr=V=>{bt.value=V,Co.value="details",qe.value=!1,Dt.value=!0},sa=async V=>{try{const se={...V,scopeConfigurations:zd(V.scopeConfigurations,{areas:Pt.value,locations:E.value,marshals:oe.value})};let ce=null;const we=!bt.value||!bt.value.contactId,at=!!Lo.value;if(bt.value&&bt.value.contactId)await ua.update(t.params.eventId,bt.value.contactId,se);else{const xt=await ua.create(t.params.eventId,se);ce=xt.data?.contactId||xt.data?.id}if(await Os(),we&&at&&ce&&ao.value){const xt=qn.value.find(jt=>jt.contactId===ce);xt&&ao.value.addPendingContact(xt)}aa()}catch(se){console.error("Failed to save contact:",se);const ce=se.response?.data?.message||"Failed to save contact. Please try again.";alert(ce)}},Nn=async V=>{g("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await ua.delete(t.params.eventId,V),await Os(),ao.value&&ao.value.removeContactById(V),aa()}catch(se){console.error("Failed to delete contact:",se),alert(se.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},aa=()=>{Dt.value=!1,bt.value=null,Lo.value=null,Cn.value="",Js.value=null,qe.value=!1},Va=async V=>{const se=[...qn.value];V.forEach(ce=>{const we=qn.value.find(at=>at.contactId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await ua.reorder(t.params.eventId,V)}catch(ce){qn.value=se,console.error("Failed to reorder contacts:",ce),alert("Failed to save order. Changes have been reverted.")}},cs=async()=>{try{const V=await Qa.getAll(t.params.eventId);jn.value=V.data,U.value.roles=Date.now()}catch(V){console.error("Failed to load role definitions:",V)}},Te=()=>{On.value=null,ss.value="details",pt.value=[],qe.value=!1,Bn.value=!0},Le=V=>{On.value=V,ss.value="details",pt.value=[],qe.value=!1,Bn.value=!0},nt=async V=>{try{const se=On.value?.roleId,{assignmentChanges:ce,...we}=V;se?(await Qa.update(t.params.eventId,se,we),ce&&(ce.marshalIdsToAdd.length>0||ce.marshalIdsToRemove.length>0||ce.contactIdsToAdd.length>0||ce.contactIdsToRemove.length>0)&&await Qa.updatePeople(t.params.eventId,se,ce)):await Qa.create(t.params.eventId,we),await cs(),Ct()}catch(se){console.error("Failed to save role:",se);const ce=se.response?.data?.message||"Failed to save role. Please try again.";alert(ce)}},vt=async V=>{const se=On.value?.usageCount||0;let ce="Are you sure you want to delete this role?";if(se>0){const we=se===1?T.value.person:T.value.people;ce=`This role is assigned to ${se} ${we}. They will all be unassigned from this role. Are you sure you want to delete it?`}g("Delete role",ce,async()=>{try{await Qa.delete(t.params.eventId,V),await cs(),Ct()}catch(we){console.error("Failed to delete role:",we),alert(we.response?.data?.message||"Failed to delete role. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ct=()=>{Bn.value=!1,On.value=null,pt.value=[],qe.value=!1},Xt=async V=>{Vt.value=!0;try{const se=await Qa.getPeople(t.params.eventId,V);pt.value=se.data}catch(se){console.error("Failed to load people for role:",se)}finally{Vt.value=!1}},tn=async V=>{const se=[...jn.value];V.forEach(ce=>{const we=jn.value.find(at=>at.roleId===ce.id);we&&(we.displayOrder=ce.displayOrder)});try{await Qa.reorder(t.params.eventId,V)}catch(ce){jn.value=se,console.error("Failed to reorder roles:",ce),alert("Failed to save order. Changes have been reverted.")}},an=V=>{Gt.value={...V,id:mt.value?.id};const se={...V,id:mt.value?.id,polygon:[]};mt.value=se;let ce=!1;if(V.polygon&&V.polygon.length>0){const we=V.polygon.map(a=>a.lat||a[0]),at=V.polygon.map(a=>a.lng||a[1]),xt=Math.min(...we),jt=Math.max(...we),$n=Math.min(...at),Di=Math.max(...at);Qe.value={lat:(xt+jt)/2,lng:($n+Di)/2};const Ri=jt-xt,Pl=Di-$n,Za=Math.max(Ri,Pl);Ft.value=Za<.005?17:Za<.01?16:Za<.02?15:Za<.05?14:13,ce=!0}if(!ce&&V.checkpointIds&&V.checkpointIds.length>0){const we=E.value.filter(at=>V.checkpointIds.includes(at.id));if(we.length>0){const at=we.map(jt=>jt.latitude).filter(Boolean),xt=we.map(jt=>jt.longitude).filter(Boolean);if(at.length>0&&xt.length>0){const jt=Math.min(...at),$n=Math.max(...at),Di=Math.min(...xt),Ri=Math.max(...xt);Qe.value={lat:(jt+$n)/2,lng:(Di+Ri)/2};const Pl=$n-jt,Za=Ri-Di,a=Math.max(Pl,Za);Ft.value=a<.005?16:a<.01?15:a<.02?14:a<.05?13:12,ce=!0}}}if(!ce&&Q.value){const we=Q.value.getMapCenter(),at=Q.value.getMapZoom();we&&at!==null&&(Qe.value=we,Ft.value=at)}zo.value=!0,pe.value="draw-area",sn.value=!0,ve.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},pn=V=>{Gt.value?mt.value={...mt.value||{},...Gt.value,polygon:V}:mt.value={...mt.value,polygon:V}},bn=V=>{w.handlePolygonDrawing(V)},Tt=()=>{sn.value=!1,Gt.value&&(mt.value=Gt.value,An.value=!0,Gt.value=null)},ln=()=>I.loadEventAdmins(),vr=async V=>{try{await I.addAdmin(V),await ln(),mr()}catch(se){console.error("Failed to add admin:",se),alert(se.response?.data?.message||"Failed to add administrator. Please try again.")}},ia=async V=>{g("Remove administrator",`Remove ${V} as an administrator?`,async()=>{try{await I.removeAdmin(V),await ln()}catch(se){console.error("Failed to remove admin:",se),alert(se.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},mr=()=>{I.closeAddAdminModal(),qe.value=!1},_l=async V=>{await C.uploadRoute(V)&&(await Ba(),Cc())},Cc=()=>{C.closeUploadRouteModal()},Fs=async({file:V,deleteExisting:se})=>{const ce=await C.importLocations(V,se);if(ce){await Si(),Ai();const we=C.formatImportResultMessage(ce,"location");ct.value="Import Complete",ht.value=we,He.value=!0}},Ai=()=>{C.closeImportLocationsModal()},cd=async V=>{if(Z.value)ft.value.latitude=V.lat,ft.value.longitude=V.lng;else if(X.value)te.value.latitude=V.lat,te.value.longitude=V.lng,F.value&&(F.value={...F.value,latitude:V.lat,longitude:V.lng}),X.value=!1,G.value=!0,Rt();else if(As.value)try{await s.createLocation({eventId:t.params.eventId,name:`Checkpoint ${wo.value}`,description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""}),wo.value++,await Zn()}catch(se){console.error("Failed to create checkpoint:",se),alert("Failed to create checkpoint. Please try again.")}},gr=V=>{w.handleFullscreenMapClick(V)},ud=V=>{ft.value={...V}},us=()=>{Z.value=!1,w.enterPlaceCheckpointMode()},dd=()=>{w.saveMapState(Q.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},w.enterPlaceCheckpointMode()},Ga=()=>{w.saveMapState(Q.value),zo.value=!0,pe.value="view",ve.value={title:"Course map",description:""}},hd=()=>{w.saveMapState(Q.value),mt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Pt.value.length},w.enterDrawAreaMode()},ds=()=>{F.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},te.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1,G.value=!0},Cl=()=>{const V=w.calculateStartingNumber(E);w.saveMapState(Q.value),w.enterAddMultipleMode(V)},Lc=()=>{if(pe.value==="place-checkpoint"){const V=w.getPlacedCoords()||{lat:0,lng:0};F.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},te.value={id:null,name:"",description:"",latitude:V.lat,longitude:V.lng,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1,qa(),G.value=!0}else if(pe.value==="move-checkpoint"){const V=w.getPlacedCoords();V&&(te.value.latitude=V.lat,te.value.longitude=V.lng,F.value&&(F.value={...F.value,...yn.value||{},latitude:V.lat,longitude:V.lng}),Rt()),yn.value=null,qa(),G.value=!0}else if(pe.value==="draw-area"){const V=w.getCompletedPolygon();V&&(Gt.value?mt.value={...mt.value||{},...Gt.value,polygon:V}:mt.value={...mt.value||{},polygon:V}),Gt.value=null,qa()}else pe.value==="add-multiple"&&yr()},yr=async()=>{const V=w.getTempCheckpoints();try{for(const se of V)await s.createLocation({eventId:t.params.eventId,name:se.name,description:se.description,latitude:se.latitude,longitude:se.longitude,requiredMarshals:se.requiredMarshals,what3Words:se.what3Words});w.clearTempCheckpoints(),qa(),await Zn()}catch(se){console.error("Failed to create checkpoints:",se),alert("Failed to create checkpoints. Please try again.")}},Ll=()=>{pe.value==="draw-area"?Gt.value&&(mt.value=Gt.value,Gt.value=null):pe.value==="move-checkpoint"&&(yn.value&&F.value&&Object.assign(F.value,yn.value),G.value=!0,X.value=!1),w.cancelFullscreen()},qa=()=>{w.exitFullscreen()},Il=V=>{hs(V)},hs=V=>{F.value=V,te.value={id:V.id,name:V.name,description:V.description||"",latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||""},fe.value=[],ke.value=[],qe.value=!1,G.value=!0,setTimeout(()=>{Q.value?.scrollMapIntoView()},100)},Sl=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await s.createLocation({eventId:t.params.eventId,...V}),await Zn(),xl()}catch(se){console.error("Failed to save location:",se),alert("Failed to save location. Please try again.")}},xl=()=>{Z.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},qe.value=!1,qe.value=!1},$l=()=>{G.value=!1,F.value=null,j.value=!1,X.value=!1,Ce.value=!1,yn.value=null,te.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},fe.value=[],ke.value=[],qe.value=!1},kr=()=>{Ce.value=!1},Tl=()=>{Ce.value=!0},fd=V=>{V?.formData&&(yn.value=V.formData),G.value=!1,Se.value=null;const se=yn.value?.latitude??F.value?.latitude,ce=yn.value?.longitude??F.value?.longitude;if(se&&ce)Qe.value={lat:se,lng:ce},Ft.value=16;else if(Q.value){const at=Q.value.getMapCenter(),xt=Q.value.getMapZoom();at&&xt!==null&&(Qe.value=at,Ft.value=xt)}const we=yn.value?.name||F.value?.name;zo.value=!0,pe.value="move-checkpoint",ve.value={title:`Move ${T.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},Ic=async V=>{if(!Lu(V.what3Words)){alert("Invalid What3Words format.");return}try{const se=!F.value.id;if(se){const ce=await s.createLocation({eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:ce.id,marshalId:we.marshalId})}else{const ce=F.value.id;if(await Xn.update(t.params.eventId,ce,{eventId:t.params.eventId,name:V.name,description:V.description,latitude:V.latitude,longitude:V.longitude,requiredMarshals:V.requiredMarshals,what3Words:V.what3Words||null,startTime:V.startTime,endTime:V.endTime,styleType:V.styleType,styleColor:V.styleColor,styleBackgroundShape:V.styleBackgroundShape,styleBackgroundColor:V.styleBackgroundColor,styleBorderColor:V.styleBorderColor,styleIconColor:V.styleIconColor,styleSize:V.styleSize,styleMapRotation:V.styleMapRotation!=null?String(V.styleMapRotation):null,peopleTerm:V.peopleTerm,checkpointTerm:V.checkpointTerm,isDynamic:V.isDynamic||!1,locationUpdateScopeConfigurations:V.locationUpdateScopeConfigurations||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Ot.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ys.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ce]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of ke.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of fe.value)await s.createAssignment({eventId:t.params.eventId,locationId:F.value.id,marshalId:we.marshalId});if(V.checkInChanges&&V.checkInChanges.length>0)for(const we of V.checkInChanges){const at=F.value.assignments.find(xt=>xt.id===we.assignmentId);at&&at.isCheckedIn!==we.shouldBeCheckedIn&&await fi.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!se&&V.checklistChanges&&V.checklistChanges.length>0)for(const ce of V.checklistChanges)try{ce.complete?await Ot.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Ot.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(we){console.error("Failed to update checklist item:",ce,we)}await Zn(),$l()}catch(se){console.error("Failed to update location:",se),alert("Failed to update location. Please try again.")}},pd=async V=>{g(`Delete ${T.value.checkpoint}`,`Are you sure you want to delete this ${T.value.checkpoint}?`,async()=>{try{await Xn.delete(t.params.eventId,V),await Si(),$l()}catch(se){console.error(`Failed to delete ${T.value.checkpoint}:`,se),alert(`Failed to delete ${T.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Sc=async V=>{try{if(re.value&&re.value.setCheckingIn(V.id),await fi.adminCheckIn(t.params.eventId,V.id),await $t(),F.value){const se=E.value.find(ce=>ce.id===F.value.id);se&&(F.value=se)}}catch(se){console.error("Failed to toggle check-in:",se),alert("Failed to toggle check-in. Please try again.")}finally{re.value&&re.value.setCheckingIn(null)}},vd=V=>{const se=V?.id??V;if(se?.toString().startsWith("temp-")){const ce=F.value.assignments.find(we=>we.id===se);ce&&(fe.value=fe.value.filter(we=>we.marshalId!==ce.marshalId)),F.value.assignments=F.value.assignments.filter(we=>we.id!==se),Rt()}else ke.value.includes(se)||(ke.value.push(se),F.value.assignments=F.value.assignments.filter(ce=>ce.id!==se),Rt())},Zo=async V=>{const se=oe.value.find(we=>we.id===V);if(!se)return;const ce=E.value.filter(we=>we.assignments?.some(at=>at.marshalId===V&&we.id!==F.value.id));if(ce.length>0){Fe.value={marshalName:se.name,locations:ce.map(at=>at.name),marshal:se};const we=await new Promise(at=>{Ee.value=at,Ne.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const at of ce){const xt=at.assignments.find(jt=>jt.marshalId===V);if(xt){ke.value.push(xt.id);const jt=E.value.findIndex($n=>$n.id===at.id);jt!==-1&&(E.value[jt].assignments=E.value[jt].assignments.filter($n=>$n.id!==xt.id))}}}fe.value.push({marshalId:se.id,marshalName:se.name}),F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:se.id,marshalName:se.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0}),Rt(),kr()},Ml=async V=>{try{const ce=(await bs.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber})).data;await kn(),fe.value.push({marshalId:ce.id,marshalName:ce.name}),F.value&&(F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ce.id,marshalName:ce.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0})),Rt(),kr()}catch(se){console.error("Failed to create marshal:",se),alert("Failed to create marshal. Please try again.")}},md=()=>{Be.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],qe.value=!1,ge.value=!0},Al=V=>{Be.value=V,me.value={},Ze.value={id:V.id,name:V.name,email:V.email||"",phoneNumber:V.phoneNumber||"",notes:V.notes||""},ne.value=[],ye.value=[],qe.value=!1,ge.value=!0},xc=H(()=>{if(!Be.value)return[];const V=[];return E.value.forEach(se=>{se.assignments.filter(we=>we.marshalName===Be.value.name&&!ye.value.includes(we.id)).forEach(we=>{V.push({...we,locationName:se.name,locationDescription:se.description||""})})}),ne.value.forEach((se,ce)=>{const we=E.value.find(at=>at.id===se.locationId);we&&V.push({id:`pending-${ce}`,locationId:se.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:Be.value.id,marshalName:Be.value.name,isCheckedIn:!1,isPending:!0})}),V}),$c=async V=>{try{let se=Be.value?.id,ce=!1;if(Be.value){if(await bs.update(t.params.eventId,Be.value.id,{name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[]}),V.pendingNewChecklistItems&&V.pendingNewChecklistItems.length>0)for(const we of V.pendingNewChecklistItems)we.text?.trim()&&await Ot.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,isRequired:!1});if(V.pendingNewNotes&&V.pendingNewNotes.length>0)for(const we of V.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await ys.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}else se=(await bs.create({eventId:t.params.eventId,name:V.name,email:V.email,phoneNumber:V.phoneNumber,notes:V.notes,roles:V.roles||[],pendingNewChecklistItems:V.pendingNewChecklistItems||[],pendingNewNotes:V.pendingNewNotes||[]})).data.id,ce=!0;for(const we of ye.value)await s.deleteAssignment(t.params.eventId,we);if(V.assignmentsToRemove&&V.assignmentsToRemove.length>0)for(const we of V.assignmentsToRemove)await s.deleteAssignment(t.params.eventId,we);for(const we of ne.value)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.pendingAssignments&&V.pendingAssignments.length>0)for(const we of V.pendingAssignments)await s.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:se});if(V.checkInChanges&&V.checkInChanges.length>0){const we=xc.value;for(const at of V.checkInChanges){const xt=we.find(jt=>jt.id===at.assignmentId);xt&&xt.isCheckedIn!==at.shouldBeCheckedIn&&await fi.adminCheckIn(t.params.eventId,at.assignmentId)}}if(V.checklistChanges&&V.checklistChanges.length>0)for(const we of V.checklistChanges)try{const at={marshalId:se};we.contextType&&we.contextId&&(at.contextType=we.contextType,at.contextId=we.contextId),we.complete?await Ot.complete(t.params.eventId,we.itemId,at):await Ot.uncomplete(t.params.eventId,we.itemId,at)}catch(at){console.error("Failed to process checklist change:",at);const xt=at.response?.data?.message||"Failed to update checklist item";alert(`Error: ${xt}`)}if(await Zn(),F.value){const we=E.value.find(at=>at.id===F.value.id);we&&(F.value=we)}El(),ce&&(q.value=se,J.value=V.name,ae.value=!0)}catch(se){console.error("Failed to save marshal:",se);const ce=se.response?.data?.message||"Failed to save marshal. Please try again.";if(se.response?.status===400){const we=ce.toLowerCase();we.includes("name")?(me.value={name:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("name"))):we.includes("email")?(me.value={email:ce},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("email"))):(me.value={general:ce},xe.value&&xe.value.switchToTab("details"))}else me.value={general:ce},xe.value&&xe.value.switchToTab("details")}},Tc=async V=>{const se=V||Be.value?.id;if(!se){console.error("No marshal ID to delete");return}const ce=T.value.person;g(`Delete ${ce}`,`Are you sure you want to delete this ${ce}?`,async()=>{try{await bs.delete(t.params.eventId,se),await pl(),El()}catch(we){console.error(`Failed to delete ${ce}:`,we),alert(`Failed to delete ${ce}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ei=V=>{Tc(V.id)},gd=V=>{const se=V?.id??V;if(se?.toString().startsWith("pending-")){const ce=V?.locationId;ce&&(ne.value=ne.value.filter(we=>we.locationId!==ce)),Rt()}else ye.value.includes(se)||(ye.value.push(se),Rt())},ja=V=>{ne.value.push({locationId:V}),Rt()},El=()=>{ge.value=!1,Be.value=null,Oe.value=null,me.value={},Ze.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ne.value=[],ye.value=[],qe.value=!1},Mc=async V=>{const se=oe.value.find(ce=>ce.id===V.marshalId);if(!se){console.error("Marshal not found:",V.marshalId);return}Oe.value=F.value?.id||null,qe.value=!1,Be.value=se,ge.value=!0},yd=V=>{const se=E.value.find(ce=>ce.id===V.locationId);if(!se){console.error("Location not found:",V.locationId);return}j.value=!0,qe.value=!1,F.value=se,G.value=!0},fs=async({file:V})=>{const se=await C.importMarshals(V);if(se){await pl(),br();const ce=C.formatImportResultMessage(se,"marshal");ct.value="Import Complete",ht.value=ce,He.value=!0}},br=()=>{C.closeImportMarshalsModal()},Ac=V=>{Ee.value&&(Ee.value(V),Ee.value=null),Ne.value=!1};let ps=null;const Ec=async()=>{try{const V=t.params.eventId,se=await Xn.getDynamicCheckpoints(V);if(se.data&&Array.isArray(se.data))for(const ce of se.data){const we=E.value.find(at=>at.id===ce.checkpointId);we&&(we.latitude=ce.latitude,we.longitude=ce.longitude,we.lastLocationUpdate=ce.lastLocationUpdate)}}catch(V){console.warn("Failed to poll dynamic checkpoints:",V)}},Pi=()=>{ps||!E.value.some(se=>se.isDynamic||se.IsDynamic)||(Ec(),ps=setInterval(Ec,6e4))},Wa=()=>{ps&&(clearInterval(ps),ps=null)};return Ye(i,V=>{V==="course"?Pi():Wa();const se=Date.now(),ce=we=>se-U.value[we]>wV;switch(V){case"marshals":ce("marshals")&&kn(),ce("roles")&&cs();break;case"areas":ce("areas")&&qt(),ce("roles")&&cs();break;case"checkpoints":ce("checkpoints")&&Ba();break;case"checklists":ce("checklists")&&co();break;case"notes":ce("notes")&&xn();break;case"incidents":ce("incidents")&&ea();break;case"contacts":ce("contacts")&&Os(),ce("roles")&&cs();break;case"roles":ce("roles")&&cs();break}}),un(async()=>{await Zn();try{const V=await js.getMe(t.params.eventId);Eo.value=V.data}catch(V){console.warn("Failed to fetch user claims:",V)}i.value==="course"&&Pi()}),Ye(M,V=>{V&&(document.title="OnTheDay App - Admin")},{immediate:!0}),Sn(()=>{Wa()}),(V,se)=>(p(),y("div",{class:"admin-event-manage",style:tt({colorScheme:N($)})},[r("header",uV,[r("div",dV,[r("button",{onClick:wt,class:"btn-back",title:"Back to sessions"},[Pe(cV,{size:48,animate:""})]),M.value?(p(),y("div",hV,[r("h1",null,_(M.value.name),1),r("p",fV,_(N(o1)(M.value.eventDate)),1)])):P("",!0)]),r("div",pV,[Io.value?(p(),y("button",{key:0,onClick:en,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Pe(sV,{class:"theme-toggle-fixed"})]),r("div",vV,[r("div",mV,[Pe(cP,{tabs:R.value,"model-value":N(i),"onUpdate:modelValue":N(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",gV,[N(i)==="course"?(p(),Ge(cI,{key:0,ref_key:"courseAreasTab",ref:Q,checkpoints:E.value,areas:Pt.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"selected-area-id":bo.value,"drawing-mode":N(sn),onMapClick:cd,onLocationClick:Il,onAreaClick:En,onImportCheckpoints:se[0]||(se[0]=ce=>Re.value=!0),onUploadRoute:se[1]||(se[1]=ce=>_e.value=!0),onSelectLocation:hs,onAddArea:vl,onSelectArea:En,onPolygonComplete:pn,onCancelDrawing:Tt,onAddCheckpointFromMap:dd,onAddManyCheckpointsFromMap:Cl,onAddAreaFromMap:hd,onFullscreen:Ga,"onUpdate:routeSettings":as},null,8,["checkpoints","areas","route","route-color","route-style","route-weight","selected-area-id","drawing-mode"])):P("",!0),N(i)==="checkpoints"?(p(),Ge(P3,{key:1,locations:E.value,areas:Pt.value,onAddCheckpointManually:ds,onImportCheckpoints:se[2]||(se[2]=ce=>Re.value=!0),onSelectLocation:hs},null,8,["locations","areas"])):P("",!0),N(i)==="areas"?(p(),Ge(Q3,{key:2,areas:Pt.value,checkpoints:E.value,contacts:qn.value,"event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onAddArea:vl,onSelectArea:En},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),N(i)==="marshals"?(p(),Ge(dS,{key:3,ref_key:"marshalsTabRef",ref:re,marshals:oe.value,assignments:lo.value,locations:E.value,onAddMarshal:md,onImportMarshals:se[3]||(se[3]=ce=>be.value=!0),onSelectMarshal:Al,onDeleteMarshal:Ei,onToggleCheckIn:Sc},null,8,["marshals","assignments","locations"])):P("",!0),N(i)==="checklists"?(p(),Ge(L$,{key:4,"checklist-items":_n.value,areas:Pt.value,locations:E.value,marshals:oe.value,"completion-report":dl.value,"detailed-report":hl.value,"is-loading-detailed-report":bi.value,onAddChecklistItem:dr,onSelectChecklistItem:ta,onReorder:Ti,onLoadDetailedReport:fl},null,8,["checklist-items","areas","locations","marshals","completion-report","detailed-report","is-loading-detailed-report"])):P("",!0),N(i)==="notes"?(p(),Ge(H$,{key:5,notes:Go.value,areas:Pt.value,locations:E.value,marshals:oe.value,onAddNote:Mi,onSelectNote:Po,onReorder:Na},null,8,["notes","areas","locations","marshals"])):P("",!0),N(i)==="incidents"?(p(),Ge(d3,{key:6,incidents:Vn.value,areas:Pt.value,loading:wi.value,onSelectIncident:wl,onReportIncident:bl},null,8,["incidents","areas","loading"])):P("",!0),N(i)==="contacts"?(p(),Ge(uT,{key:7,contacts:qn.value,areas:Pt.value,locations:E.value,marshals:oe.value,"available-roles":Wo.value,"role-definitions":jn.value,onAddContact:rs,onSelectContact:pr,onReorder:Va},null,8,["contacts","areas","locations","marshals","available-roles","role-definitions"])):P("",!0),N(i)==="roles"?(p(),Ge(xT,{key:8,"role-definitions":jn.value,onAddRole:Te,onSelectRole:Le,onReorder:tn},null,8,["role-definitions"])):P("",!0),N(i)==="details"?(p(),Ge(FT,{key:9,"event-data":Bt.value,"form-dirty":Lt.value,onSubmit:Oa,"onUpdate:formDirty":Ut},null,8,["event-data","form-dirty"])):P("",!0),N(i)==="settings"?(p(),Ge(z4,{key:10,"event-data":Bt.value,"event-id":N(t).params.eventId,admins:N(ee),"form-dirty":Lt.value,onSubmit:Oa,onAddAdmin:se[4]||(se[4]=ce=>ue.value=!0),onRemoveAdmin:ia,"onUpdate:formDirty":Ut},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Pe(JH,{show:Z.value,location:ft.value,"is-dirty":qe.value,onClose:xl,onSave:Sl,onSetOnMap:us,"onUpdate:isDirty":Rt,"onUpdate:location":ud},null,8,["show","location","is-dirty"]),Pe(_O,{show:G.value,location:F.value,assignments:F.value?.assignments||[],"event-date":M.value?.eventDate||"",areas:Pt.value,"event-id":N(t).params.eventId,"all-locations":E.value,notes:Go.value,"available-marshals":Ea.value,"all-marshals":oe.value,"all-checklist-items":_n.value,incidents:Ra.value,"is-dirty":qe.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","z-index":An.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:$l,onSave:Ic,onDelete:pd,onMoveLocation:fd,onRemoveAssignment:vd,onOpenAssignModal:Tl,"onUpdate:isDirty":Rt,onSelectIncident:Li,onSelectMarshal:Mc,onReorderNotes:Na,onReorderChecklists:Fa},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Pe(pP,{show:K.value,link:Wn.value,"is-dirty":!1,onClose:se[5]||(se[5]=ce=>K.value=!1)},null,8,["show","link"]),Pe(t6,{show:ae.value,"event-id":N(t).params.eventId,"marshal-id":q.value,"marshal-name":J.value,onClose:se[6]||(se[6]=ce=>ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Pe(s6,{show:N(ue),"is-dirty":qe.value,onClose:mr,onSubmit:vr,"onUpdate:isDirty":Rt},null,8,["show","is-dirty"]),Pe(c6,{show:N(_e),uploading:N($e),error:N(De),"is-dirty":qe.value,onClose:Cc,onSubmit:_l,"onUpdate:isDirty":Rt},null,8,["show","uploading","error","is-dirty"]),Pe(k6,{show:N(Re),importing:N(z),error:N(de),result:N(ie),"is-dirty":qe.value,onClose:Ai,onSubmit:Fs,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Pe(EN,{ref_key:"editMarshalModalRef",ref:xe,show:ge.value,marshal:Be.value,"event-id":N(t).params.eventId,assignments:xc.value,"available-locations":Ps.value,"all-locations":E.value,areas:Pt.value,"is-editing":!!Be.value,"event-notes":Go.value,"all-checklist-items":_n.value,incidents:Ds.value,"all-marshals":oe.value,"is-dirty":qe.value,"validation-errors":me.value,"locked-checkpoint-id":Oe.value,"z-index":Oe.value?1100:1e3,"role-definitions":jn.value,onClose:El,onSave:$c,onDelete:Tc,onRemoveAssignment:gd,onAssignToLocation:ja,"onUpdate:isDirty":Rt,onSelectIncident:Ci,onSelectCheckpoint:yd,onReorderNotes:Na,onReorderChecklists:Fa},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index","role-definitions"]),Pe(x6,{show:N(be),importing:N(Y),error:N(de),result:N(Ae),"is-dirty":qe.value,onClose:br,onSubmit:fs,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Pe(ON,{show:Ne.value,"conflict-data":Fe.value,onClose:se[7]||(se[7]=ce=>Ne.value=!1),onChoice:Ac},null,8,["show","conflict-data"]),Pe(jN,{show:Ce.value,"location-name":F.value?.name||"",marshals:Ea.value,onClose:kr,onAssignExisting:Zo,onCreateAndAssign:Ml},null,8,["show","location-name","marshals"]),Pe(s9,{show:Nt.value,"old-event-date":Et.value,"new-event-date":yo.value,"affected-checkpoints-count":ko.value,onConfirm:Ii,onCancel:Qs},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Pe(y7,{ref_key:"editAreaModalRef",ref:ao,show:An.value,area:mt.value,"initial-tab":Ao.value,checkpoints:E.value,marshals:oe.value,areas:Pt.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"is-dirty":qe.value,"event-id":N(t).params.eventId,"all-locations":E.value,assignments:lo.value,notes:Go.value,contacts:qn.value,incidents:Rs.value,"role-definitions":jn.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onClose:xi,onSave:is,onDelete:ml,onDrawBoundary:an,"onUpdate:isDirty":Rt,onSelectCheckpoint:hs,onCreateContactFromMarshal:ls,onCreateNewContact:$i,onEditContact:gl,onSelectIncident:ur,onReorderNotes:Na,onReorderChecklists:Fa,onReorderContacts:Va},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","route-color","route-style","route-weight","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","role-definitions","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Pe(R7,{show:Ho.value,"checklist-item":_o.value,"initial-tab":Vo.value,areas:Pt.value,locations:E.value,marshals:oe.value,"is-dirty":qe.value,"next-display-order":Ma.value,onClose:Pn,onSave:na,onDelete:Bs,"onUpdate:isDirty":Rt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty","next-display-order"]),Pe(J7,{show:Aa.value,note:qo.value,"initial-tab":Es.value,areas:Pt.value,locations:E.value,marshals:oe.value,"is-dirty":qe.value,onClose:Ns,onSave:yl,onDelete:kl,"onUpdate:isDirty":Rt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Pe(M1,{show:jo.value,incident:Gn.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,checkpoints:E.value,"can-manage":!0,onClose:Ua,onStatusChange:fr,onOpenAddNote:za},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints"]),Pe(Yt,{show:Ks.value,title:"Add update",size:"small",onClose:oa},{footer:Ve(()=>[r("div",kV,[r("button",{type:"button",class:"btn btn-secondary",onClick:oa}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Ha,disabled:!io.value.trim()||Ys.value},_(Ys.value?"Adding...":"Add update"),9,bV)])]),default:Ve(()=>[r("div",yV,[We(r("textarea",{"onUpdate:modelValue":se[8]||(se[8]=ce=>io.value=ce),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,io.value]])])]),_:1},8,["show"]),Pe(A1,{show:os.value,"event-id":N(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:E.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,onClose:se[9]||(se[9]=ce=>os.value=!1),onSubmit:hr},null,8,["show","event-id","checkpoints","route","route-color","route-style","route-weight"]),Pe(aH,{show:Dt.value,contact:bt.value,"initial-tab":Co.value,areas:Pt.value,locations:E.value,marshals:oe.value,"available-roles":Wo.value,"role-definitions":jn.value,"is-dirty":qe.value,"prefilled-name":Cn.value,"prefilled-marshal-id":Js.value,"create-from-area-context":!!Lo.value,onClose:aa,onSave:sa,onDelete:Nn,"onUpdate:isDirty":Rt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","role-definitions","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Pe(SH,{show:Bn.value,role:On.value,"initial-tab":ss.value,people:pt.value,"loading-people":Vt.value,"is-dirty":qe.value,onClose:Ct,onSave:nt,onDelete:vt,"onUpdate:isDirty":Rt,onLoadPeople:Xt},null,8,["show","role","initial-tab","people","loading-people","is-dirty"]),Pe(UH,{show:N(zo),mode:N(pe),"context-title":N(ve).title,"context-description":N(ve).description,"can-complete":Xs.value,clickable:N(pe)!=="draw-area","drawing-mode":N(pe)==="draw-area"&&N(sn),locations:Pa.value,areas:Da.value,route:M.value?.route||[],"route-color":M.value?.routeColor||"","route-style":M.value?.routeStyle||"","route-weight":M.value?.routeWeight,"selected-area-id":bo.value,center:N(Qe),zoom:N(Ft),"highlight-location-id":_i.value,onMapClick:gr,onPolygonComplete:pn,onPolygonDrawing:bn,onDone:Lc,onCancel:Ll},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","route-color","route-style","route-weight","selected-area-id","center","zoom","highlight-location-id"]),Pe(_c,{show:He.value,title:ct.value,message:ht.value,onClose:se[10]||(se[10]=ce=>He.value=!1)},null,8,["show","title","message"]),Pe(gi,{show:N(c),title:N(d),message:N(h),"is-danger":N(f),"confirm-text":N(v),onConfirm:N(k),onCancel:N(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},CV=Ke(_V,[["__scopeId","data-v-76bd7564"]]),LV={key:0,class:"emergency-notes-section"},IV={class:"emergency-notes-list"},SV={class:"note-header"},xV={key:0,class:"note-content"},$V={key:1,class:"emergency-contacts-section"},TV={class:"emergency-contacts-list"},MV={class:"contact-header"},AV={key:0,class:"role-badge"},EV={class:"contact-details"},PV={key:0,class:"info-section"},DV=["href"],RV={key:1,class:"info-section"},OV=["href"],BV={key:2,class:"info-section"},NV=["href"],FV={key:2,class:"no-contacts"},UV={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,s=t,o=H(()=>n.notes?[...n.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const v=h.isPinned||h.IsPinned,g=f.isPinned||f.IsPinned;if(v!==g)return v?-1:1;const k=h.displayOrder||h.DisplayOrder||0,b=f.displayOrder||f.DisplayOrder||0;if(k!==b)return k-b;const x=h.priority||h.Priority,A=f.priority||f.Priority;return x==="Emergency"&&A!=="Emergency"?-1:A==="Emergency"&&x!=="Emergency"?1:0}):[]),i=H(()=>n.contacts?n.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const v=h.isPinned||h.IsPinned,g=f.isPinned||f.IsPinned;if(v!==g)return v?-1:1;const k=h.displayOrder||h.DisplayOrder||0,b=f.displayOrder||f.DisplayOrder||0;if(k!==b)return k-b;const x=h.name||h.Name||"",A=f.name||f.Name||"";return x.localeCompare(A,void 0,{sensitivity:"base"})}):[]),l=()=>{s("close")},c=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(p(),Ge(Yt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Ve(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[o.value.length>0?(p(),y("div",LV,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",IV,[(p(!0),y(Ie,null,je(o.value,v=>(p(),y("div",{key:v.noteId||v.NoteId,class:le(["emergency-note-item",{"is-emergency":(v.priority||v.Priority)==="Emergency"}])},[r("div",SV,[r("h3",null,_(v.title||v.Title),1),r("span",{class:le(["priority-badge",(v.priority||v.Priority).toLowerCase()])},_(v.priority||v.Priority),3)]),v.content||v.Content?(p(),y("div",xV,_(v.content||v.Content),1)):P("",!0)],2))),128))])])):P("",!0),i.value&&i.value.length>0?(p(),y("div",$V,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",TV,[(p(!0),y(Ie,null,je(i.value,v=>(p(),y("div",{key:v.contactId||v.name,class:"emergency-contact-item"},[r("div",MV,[r("h3",null,_(v.name),1),d(v).length>0?(p(),y("span",AV,_(d(v).map(c).join(", ")),1)):P("",!0)]),r("div",EV,[v.phone?(p(),y("div",PV,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${v.phone}`,class:"phone-link"},_(v.phone),9,DV)])):P("",!0),v.email?(p(),y("div",RV,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${v.email}`,class:"email-link"},_(v.email),9,OV)])):P("",!0),v.notes||v.details?(p(),y("div",BV,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,_(v.notes||v.details),1)])):P("",!0)]),v.phone?(p(),y("a",{key:0,href:`tel:${v.phone}`,class:"btn btn-danger btn-full"}," Call "+_(v.name),9,NV)):P("",!0)]))),128))])])):P("",!0),i.value.length===0&&o.value.length===0?(p(),y("div",FV,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},zV=Ke(UV,[["__scopeId","data-v-6ae197f1"]]),Pr=D(navigator.onLine),ba=D(!0),ui=D(0),Wc=D(null),Wi=D("idle"),Xl=D(null),lf=D(!1);let wm=null,wh=!1,ks=null,_m=0;function HV(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Pu(){ks&&(clearTimeout(ks),ks=null);const e=HV(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),ks=setTimeout(async()=>{if(ks=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await _u()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Du();const n=await _u();n>0&&navigator.onLine&&(console.log(`${n} actions remaining, scheduling retry...`),Pu())},e)}async function jl(){if(!navigator.onLine)return ba.value=!1,!1;try{return await EC.check(),ba.value=!0,!0}catch(e){return e.response?.status===404?(ba.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),ba.value=!1,!1)}}async function jf(){const e=Date.now();if(e-_m<2e3)return;_m=e;const t=navigator.onLine;if(Pr.value=t,!t){ba.value=!1;return}lf.value=!0;try{await jl()&&ui.value>0&&Pu()}finally{lf.value=!1}}function Cm(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),jf())}function Lm(){console.log("Window focused, checking connectivity..."),jf()}async function VV(e){try{switch(e.type){case"checkin":await fi.checkIn(e.payload);break;case"checkin_toggle":await fi.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await fi.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Ot.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Ot.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const n=t.response.data?.message||t.response.data||"",s=typeof n=="string"?n.toLowerCase():"";if(s.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(s.includes("already completed")||s.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Du(){if(!wh&&navigator.onLine){wh=!0,Wi.value="syncing",Xl.value=null;try{const e=await qy();if(e.length===0){Wi.value="success",ui.value=0;return}let t=0,n=0;for(const s of e){const o=await VV(s);if(o===!0)await Iv(s.id),t++;else if(o==="permanent_failure")await Iv(s.id),n++;else{const i=(s.attempts||0)+1;i>=5?(await Lv(s.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),n++):await Lv(s.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ui.value=await _u(),n>0?(Wi.value="error",Xl.value=`${n} action(s) failed to sync`):Wi.value="success"}catch(e){console.error("Sync error:",e),Wi.value="error",Xl.value="Failed to sync pending actions"}finally{wh=!1}}}function GV(){wm||(wm=setInterval(async()=>{navigator.onLine&&(await jl(),ba.value&&ui.value>0&&await Du())},3e4))}function Wf(){const e=H(()=>Pr.value&&ba.value);async function t(){ui.value=await _u()}async function n(){Pr.value=!0,await jl()&&ui.value>0&&Pu()}function s(){Pr.value=!1,ba.value=!1,ks&&(clearTimeout(ks),ks=null)}un(async()=>{await $a(),await t(),window.addEventListener("online",n),window.addEventListener("offline",s),document.addEventListener("visibilitychange",Cm),window.addEventListener("focus",Lm),navigator.onLine&&await jl()&&ui.value>0&&Pu(),GV()}),Sn(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s),document.removeEventListener("visibilitychange",Cm),window.removeEventListener("focus",Lm),ks&&(clearTimeout(ks),ks=null)});async function o(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await rc(d,f),Wc.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await hi(d);return h&&(Wc.value=h.cachedAt),h}async function l(d){Wc.value=await LC(d)}async function c(){return navigator.onLine?await jl()?(await Du(),Wi.value==="success"):(Xl.value="Server is not responding",!1):(Xl.value="Cannot sync while offline",!1)}return{isOnline:Pr,isServerHealthy:ba,isFullyOnline:e,isCheckingStatus:lf,pendingActionsCount:ui,lastSyncTime:Wc,syncStatus:Wi,syncError:Xl,checkServerHealth:jl,quickConnectivityCheck:jf,syncPendingActions:Du,updatePendingCount:t,refreshCache:o,getCachedData:i,loadLastSyncTime:l,forcSync:c}}const qV={class:"offline-indicator-container"},jV={class:"offline-icon"},WV={key:0,viewBox:"0 0 24 24",fill:"currentColor"},ZV={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},KV={class:"offline-text"},YV={key:0,class:"last-sync"},JV={class:"pending-text"},XV={key:0,class:"pending-subtext"},QV={key:1,class:"syncing-text"},eG={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:n,isCheckingStatus:s,pendingActionsCount:o,lastSyncTime:i,syncStatus:l,syncError:c,forcSync:d}=Wf(),h=D(!1),f=D(""),v=D(""),g=H(()=>{if(!i.value)return"";const b=new Date(i.value),A=new Date-b,T=Math.floor(A/6e4),w=Math.floor(T/60);return T<1?"just now":T<60?`${T}m ago`:w<24?`${w}h ago`:b.toLocaleDateString()}),k=async()=>{await d()};return Ye(l,b=>{b==="success"&&o.value===0?(f.value="All actions synced successfully!",v.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):b==="error"&&(f.value=c.value||"Sync failed",v.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(b,x)=>(p(),y("div",qV,[Pe(Ls,{name:"slide"},{default:Ve(()=>[N(n)?P("",!0):(p(),y("div",{key:0,class:le(["offline-banner",{checking:N(s)}])},[r("span",jV,[N(s)?(p(),y("svg",ZV,[...x[1]||(x[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(p(),y("svg",WV,[...x[0]||(x[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",KV,_(N(s)?"Checking connection...":N(t)?"Server unavailable":"You're offline"),1),N(i)&&!N(s)?(p(),y("span",YV," Last synced: "+_(g.value),1)):P("",!0)],2))]),_:1}),Pe(Ls,{name:"fade"},{default:Ve(()=>[N(o)>0?(p(),y("div",{key:0,class:le(["pending-banner",{"offline-pending":!N(n)}])},[x[2]||(x[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",JV,[Je(_(N(o))+" pending action"+_(N(o)!==1?"s":"")+" ",1),N(n)?P("",!0):(p(),y("span",XV,"(will sync when online)"))]),N(n)&&N(l)!=="syncing"?(p(),y("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):N(l)==="syncing"?(p(),y("span",QV,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Pe(Ls,{name:"fade"},{default:Ve(()=>[h.value?(p(),y("div",{key:0,class:le(["sync-toast",v.value])},_(f.value),3)):P("",!0)]),_:1})]))}},tG=Ke(eG,[["__scopeId","data-v-9c1e58f4"]]),nG={class:"modal-content check-in-reminder-modal"},oG={class:"modal-header warning"},sG={class:"modal-body"},aG={class:"reminder-message"},iG={key:0},lG={class:"reminder-hint"},rG={class:"modal-footer"},cG={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=dt();return(n,s)=>(p(),Ge(Ls,{name:"modal"},{default:Ve(()=>[e.show&&e.checkpoint?(p(),y("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=rt(o=>n.$emit("dismiss"),["self"]))},[r("div",nG,[r("div",oG,[s[4]||(s[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:s[0]||(s[0]=o=>n.$emit("dismiss"))},"")]),r("div",sG,[s[6]||(s[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",aG,[Je(" You have not checked in yet to "+_(N(t).checkpoint)+" ",1),r("strong",null,_(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(p(),y("span",iG," - "+_(e.checkpoint.location.description),1)):P("",!0),s[5]||(s[5]=Je(". ",-1))]),r("p",lG," Please check in when you arrive at your "+_(N(t).checkpoint)+". ",1)]),r("div",rG,[r("button",{onClick:s[1]||(s[1]=o=>n.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:s[2]||(s[2]=o=>n.$emit("go-to-checkpoint")),class:"btn btn-primary",style:tt(e.accentButtonStyle)}," Go to "+_(N(t).checkpoint),5)])])])):P("",!0)]),_:1}))}},uG=Ke(cG,[["__scopeId","data-v-4761fdb9"]]),dG={class:"modal-content location-update-modal"},hG={class:"modal-header"},fG={class:"modal-body"},pG={key:0,class:"success-message"},vG={key:1},mG={class:"modal-description"},gG={key:0,class:"last-update-info"},yG={key:1,class:"gps-status active"},kG={class:"update-option"},bG=["disabled"],wG={class:"update-option auto-update-option"},_G={class:"checkbox-label"},CG=["checked"],LG={class:"option-hint"},IG={class:"update-option"},SG=["disabled"],xG={class:"update-option"},$G={class:"option-label"},TG={key:0,class:"checkpoint-list"},MG=["onClick","disabled"],AG={class:"checkpoint-name"},EG={key:0,class:"checkpoint-description"},PG={key:1,class:"no-checkpoints"},DG={key:2,class:"error"},RG={class:"modal-footer"},OG={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=dt(),n=o=>o?new Date(o).toLocaleString():"",s=(o,i=50)=>o?o.length<=i?o:o.substring(0,i).trim()+"...":"";return(o,i)=>(p(),Ge(Ls,{name:"modal"},{default:Ve(()=>[e.show?(p(),y("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=rt(l=>o.$emit("close"),["self"]))},[r("div",dG,[r("div",hG,[r("h3",null,"Update "+_(N(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>o.$emit("close"))},"")]),r("div",fG,[e.success?(p(),y("div",pG,_(e.success),1)):(p(),y("div",vG,[r("p",mG,[i[6]||(i[6]=Je(" Update the position of ",-1)),r("strong",null,_(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(p(),y("div",gG," Last updated: "+_(n(e.assignment.location.lastLocationUpdate)),1)):P("",!0),e.userLocation?(p(),y("div",yG,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):P("",!0),r("div",kG,[r("button",{onClick:i[1]||(i[1]=l=>o.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:tt(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+_(e.updating?"Updating...":"Use current GPS location"),1)],12,bG)]),r("div",wG,[r("label",_G,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>o.$emit("toggle-auto-update"))},null,40,CG),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",LG,"Automatically updates the "+_(N(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",IG,[r("button",{onClick:i[3]||(i[3]=l=>o.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,SG)]),r("div",xG,[r("label",$G,"Or copy location from another "+_(N(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(p(),y("div",TG,[(p(!0),y(Ie,null,je(e.availableCheckpoints,l=>(p(),y("button",{key:l.id,onClick:c=>o.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",AG,_(l.name),1),l.description?(p(),y("span",EG,_(s(l.description)),1)):P("",!0)],8,MG))),128))])):(p(),y("p",PG," No other "+_(N(t).checkpoints)+" available to copy from. ",1))]),e.error?(p(),y("div",DG,_(e.error),1)):P("",!0)]))]),r("div",RG,[r("button",{onClick:i[4]||(i[4]=l=>o.$emit("close")),class:"btn btn-secondary"},_(e.success?"Ok":"Cancel"),1)])])])):P("",!0)]),_:1}))}},BG=Ke(OG,[["__scopeId","data-v-b3924a32"]]),NG={class:"contact-info"},FG={class:"contact-name-row"},UG={key:0,class:"primary-badge"},zG={class:"contact-name"},HG={key:0,class:"contact-notes-text"},VG={key:1,class:"contact-detail"},GG={key:2,class:"contact-detail"},qG={class:"contact-actions"},jG=["href"],WG=["href"],ZG=["href"],KG={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),s=["Emergency","Safety","Medical","First Aid"],o=H(()=>n.value.length===0?!1:n.value.some(c=>s.some(d=>c.toLowerCase().includes(d.toLowerCase())))),i=c=>c?c.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=H(()=>n.value.length===0?"":n.value.map(i).join(", "));return(c,d)=>(p(),y("div",{class:le(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",NG,[r("div",FG,[e.isPrimary?(p(),y("span",UG,"")):P("",!0),r("span",zG,_(e.name),1),n.value.length>0?(p(),y("span",{key:1,class:le(["contact-role-badge",{"emergency-role":o.value}])},_(l.value),3)):P("",!0)]),e.notes?(p(),y("div",HG,_(e.notes),1)):P("",!0),e.phone?(p(),y("div",VG,_(e.phone),1)):P("",!0),e.email?(p(),y("div",GG,_(e.email),1)):P("",!0)]),r("div",qG,[e.phone?(p(),y("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,jG)):P("",!0),e.phone?(p(),y("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,WG)):P("",!0),e.email?(p(),y("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,ZG)):P("",!0)])],2))}},E1=Ke(KG,[["__scopeId","data-v-2fdc8dea"]]),YG={key:0,class:"accordion-section"},JG={class:"accordion-title"},XG=["innerHTML"],QG={key:0,class:"header-count"},eq={class:"accordion-icon"},tq={key:0,class:"accordion-content"},nq={key:0,class:"loading"},oq={key:1,class:"contact-list"},sq={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.contacts.length>0||e.loading?(p(),y("div",YG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",JG,[r("span",{class:"section-icon",innerHTML:N(so)("contacts")},null,8,XG),Je(" Your "+_(e.contacts.length===1?"contact":"contacts"),1),e.contacts.length>1?(p(),y("span",QG," ("+_(e.contacts.length)+")",1)):P("",!0)]),r("span",eq,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",tq,[e.loading?(p(),y("div",nq,"Loading contacts...")):(p(),y("div",oq,[(p(!0),y(Ie,null,je(e.contacts,s=>(p(),Ge(E1,{key:s.contactId,name:s.name,roles:s.roles,role:s.role,phone:s.phone,email:s.email,notes:s.notes,"is-primary":s.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):P("",!0)])):P("",!0)}},aq=Ke(sq,[["__scopeId","data-v-87bba6dd"]]),iq={key:0,class:"accordion-section"},lq={class:"accordion-title"},rq=["innerHTML"],cq={key:0,class:"header-count"},uq={class:"accordion-icon"},dq={key:0,class:"accordion-content"},hq={key:0,class:"loading-state"},fq={key:1,class:"empty-state"},pq={key:2,class:"incidents-list"},vq={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,n)=>e.incidents.length>0||e.loading?(p(),y("div",iq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",lq,[r("span",{class:"section-icon",innerHTML:N(so)("incidents")},null,8,rq),Je(" Your "+_(e.incidents.length===1?"incident":"incidents"),1),e.incidents.length>1?(p(),y("span",cq," ("+_(e.incidents.length)+")",1)):P("",!0)]),r("span",uq,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",dq,[e.loading?(p(),y("div",hq," Loading incidents... ")):e.incidents.length===0?(p(),y("div",fq,[...n[1]||(n[1]=[r("p",null,"No incidents to show.",-1)])])):(p(),y("div",pq,[(p(!0),y(Ie,null,je(e.incidents,s=>(p(),Ge(bc,{key:s.incidentId,incident:s,onSelect:o=>t.$emit("select-incident",s)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0)}},mq=Ke(vq,[["__scopeId","data-v-8a5966fd"]]),gq={key:0,class:"accordion-section"},yq={class:"accordion-title"},kq=["innerHTML"],bq={class:"accordion-icon"},wq={key:0,class:"accordion-content"},_q={class:"event-details"},Cq={key:0,class:"event-detail-row"},Lq={class:"detail-value"},Iq={key:1,class:"event-description"},Sq={class:"detail-value"},xq={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=n=>n?new Date(n).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(n,s)=>e.eventDate||e.description?(p(),y("div",gq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:s[0]||(s[0]=o=>n.$emit("toggle"))},[r("span",yq,[r("span",{class:"section-icon",innerHTML:N(so)("event")},null,8,kq),s[1]||(s[1]=Je(" Event details ",-1))]),r("span",bq,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",wq,[r("div",_q,[e.eventDate?(p(),y("div",Cq,[s[2]||(s[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",Lq,_(t(e.eventDate)),1)])):P("",!0),e.description?(p(),y("div",Iq,[s[3]||(s[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",Sq,_(e.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)}},$q=Ke(xq,[["__scopeId","data-v-7c880ad1"]]),Tq={class:"accordion-section"},Mq={class:"accordion-title"},Aq=["innerHTML"],Eq={class:"header-count"},Pq={class:"header-count"},Dq={class:"accordion-icon"},Rq={key:0,class:"accordion-content"},Oq={key:0,class:"loading"},Bq={key:1,class:"error"},Nq={key:2,class:"empty-state"},Fq={class:"checklist-section"},Uq={class:"checklist-section-title"},zq={key:0,class:"empty-state small"},Hq={key:1,class:"my-jobs-list"},Vq=["checked","disabled","onChange"],Gq={class:"my-job-content"},qq={key:0,class:"context-info"},jq={key:1,class:"completion-info"},Wq={class:"completion-text"},Zq={class:"completion-time"},Kq={key:0,class:"checklist-section"},Yq={class:"checklist-section-title"},Jq={key:0,class:"checklist-items"},Xq={class:"item-checkbox"},Qq=["checked","disabled","onChange"],ej={class:"item-content"},tj={key:0,class:"item-context"},nj={key:1,class:"completion-info"},oj={class:"completion-text"},sj={class:"completion-time"},aj={key:1,class:"checklist-groups"},ij=["onClick"],lj={class:"group-title"},rj={class:"group-status"},cj={class:"group-count"},uj={class:"group-expand-icon"},dj={key:0,class:"checklist-group-items"},hj={class:"item-checkbox"},fj=["checked","disabled","onChange"],pj={class:"item-content"},vj={key:0,class:"completion-info"},mj={class:"completion-text"},gj={class:"completion-time"},yj={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},ledAreaCount:{type:Number,default:1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=dt(),n=e,s=H(()=>n.ledAreaCount===1?t.value.area:t.value.areas),o=H(()=>n.ledAreaCount===1?`${t.value.area}'s`:`${t.value.areas}'`),i=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],l=H(()=>{let A=0;const T=new Set;for(const w of n.myItems)if(i.includes(w.matchedScope)&&w.completionContextId){const C=`${w.itemId}_${w.completionContextId}`;T.has(C)||(T.add(C),A++)}else A++;return A}),c=H(()=>{let A=0;const T=new Set;for(const w of n.myItems)if(i.includes(w.matchedScope)&&w.completionContextId){const C=`${w.itemId}_${w.completionContextId}`;T.has(C)||(T.add(C),w.isCompleted&&A++)}else w.isCompleted&&A++;return A}),d=H(()=>l.value-c.value),h=H(()=>{let A=0;const T=new Set;for(const w of n.visibleItems)if(i.includes(w.matchedScope)&&w.completionContextId){const C=`${w.itemId}_${w.completionContextId}`;T.has(C)||(T.add(C),w.isCompleted||A++)}else w.isCompleted||A++;return A}),f=H(()=>{let A=0;const T=new Set;for(const w of n.areaItems)if(i.includes(w.matchedScope)&&w.completionContextId){const C=`${w.itemId}_${w.completionContextId}`;T.has(C)||(T.add(C),n.areaItems.some($=>$.itemId===w.itemId&&$.completionContextId===w.completionContextId&&$.isCompleted)||A++)}else w.isCompleted||A++;return A}),v=A=>{if(!A)return"";const T=new Date(A),I=(new Date-T)/(1e3*60*60);return I<24&&I>=0?T.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):T.toLocaleString()},g=A=>A.completedByActorName&&A.contextOwnerName&&A.completedByActorName!==A.contextOwnerName?`${A.completedByActorName} on behalf of ${A.contextOwnerName}`:A.completedByActorName||"Unknown",k=A=>{if(A.completionContextType==="Checkpoint"&&A.completionContextId){const T=n.locations.find(w=>w.id===A.completionContextId);if(T){if(T.description){const C=T.description.length>50?T.description.substring(0,50)+"...":T.description;return`${T.name} - ${C}`}return T.name}}if(A.completionContextType==="Area"&&A.completionContextId){const T=n.areas.find(w=>w.id===A.completionContextId);if(T)return T.name}return""},b=A=>A.completionContextType==="Checkpoint"&&A.completionContextId?n.locations.find(w=>w.id===A.completionContextId)?.name||"":A.completionContextType==="Area"&&A.completionContextId&&n.areas.find(w=>w.id===A.completionContextId)?.name||"",x=H(()=>{if(!n.myItems||n.myItems.length===0)return[];const A=new Map;for(const w of n.myItems)A.set(w.text,(A.get(w.text)||0)+1);return r1(n.myItems,b).map(w=>({...w,needsDisambiguation:A.get(w.text)>1,contextDisplayName:k(w)}))});return(A,T)=>(p(),y("div",Tq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:T[0]||(T[0]=w=>A.$emit("toggle"))},[r("span",Mq,[r("span",{class:"section-icon",innerHTML:N(so)("checklist")},null,8,Aq),e.isAreaLead?(p(),y(Ie,{key:0},[Je(" Your "+_(N(t).checklists)+" ",1),r("span",Eq,"(You: "+_(d.value)+", Your "+_(s.value)+": "+_(f.value)+")",1)],64)):(p(),y(Ie,{key:1},[Je(" Your "+_(N(t).checklists)+" ",1),r("span",Pq,"("+_(h.value)+")",1)],64))]),r("span",Dq,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",Rq,[e.loading?(p(),y("div",Oq,"Loading checklist...")):e.error?(p(),y("div",Bq,_(e.error),1)):l.value===0&&(!e.isAreaLead||e.areaItems.length===0)?(p(),y("div",Nq,[r("p",null,"No "+_(N(t).checklists)+" for you.",1)])):e.isAreaLead?(p(),y(Ie,{key:3},[r("div",Fq,[r("h4",Uq,"Your "+_(N(t).checklists),1),x.value.length===0?(p(),y("div",zq,[r("p",null,"No "+_(N(t).checklists)+" assigned to you.",1)])):(p(),y("div",Hq,[(p(!0),y(Ie,null,je(x.value,w=>(p(),y("div",{key:`${w.itemId}_${w.completionContextType}_${w.completionContextId}`,class:le(["my-job-item",{"item-completed":w.isCompleted}])},[r("input",{type:"checkbox",class:"disable-on-load",checked:w.isCompleted,disabled:e.saving||!w.canBeCompletedByMe,onChange:C=>A.$emit("toggle-item",w)},null,40,Vq),r("div",Gq,[r("span",{class:le(["my-job-text",{completed:w.isCompleted}])},_(w.text),3),w.needsDisambiguation&&w.contextDisplayName?(p(),y("div",qq,_(w.contextDisplayName),1)):P("",!0),w.isCompleted&&w.completedByActorName?(p(),y("div",jq,[r("span",Wq,_(g(w)),1),r("span",Zq,_(v(w.completedAt)),1)])):P("",!0)])],2))),128))]))]),e.areaItems.length>0?(p(),y("div",Kq,[r("h4",Yq,"Your "+_(o.value)+" "+_(N(t).checklists),1),Pe(qf,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:T[1]||(T[1]=w=>A.$emit("toggle-item",w))},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(p(),y(Ie,{key:4},[e.effectiveGroupBy==="none"?(p(),y("div",Jq,[(p(!0),y(Ie,null,je(e.visibleItems,w=>(p(),y("div",{key:`${w.itemId}_${w.completionContextType}_${w.completionContextId}`,class:le(["checklist-item",{"item-completed":w.isCompleted}])},[r("div",Xq,[r("input",{type:"checkbox",class:"disable-on-load",checked:w.isCompleted,disabled:!w.canBeCompletedByMe||e.saving,onChange:C=>A.$emit("toggle-item",w)},null,40,Qq)]),r("div",ej,[r("div",{class:le(["item-text",{"text-completed":w.isCompleted}])},_(w.text),3),e.getContextName(w)?(p(),y("div",tj,_(e.getContextName(w)),1)):P("",!0),w.isCompleted?(p(),y("div",nj,[r("span",oj,_(g(w)),1),r("span",sj,_(v(w.completedAt)),1)])):P("",!0)])],2))),128))])):(p(),y("div",aj,[(p(!0),y(Ie,null,je(e.groupedItems,w=>(p(),y("div",{key:w.key,class:"checklist-group"},[r("button",{class:le(["checklist-group-header",{expanded:e.expandedGroup===w.key,"all-complete":w.completedCount===w.items.length}]),onClick:C=>A.$emit("toggle-group",w.key)},[r("span",lj,_(w.name),1),r("span",rj,[r("span",cj,_(w.completedCount)+"/"+_(w.items.length),1),r("span",uj,_(e.expandedGroup===w.key?"":"+"),1)])],10,ij),e.expandedGroup===w.key?(p(),y("div",dj,[(p(!0),y(Ie,null,je(w.items,C=>(p(),y("div",{key:`${C.itemId}_${C.completionContextType}_${C.completionContextId}`,class:le(["checklist-item",{"item-completed":C.isCompleted}])},[r("div",hj,[r("input",{type:"checkbox",class:"disable-on-load",checked:C.isCompleted,disabled:!C.canBeCompletedByMe||e.saving,onChange:I=>A.$emit("toggle-item",C)},null,40,fj)]),r("div",pj,[r("div",{class:le(["item-text",{"text-completed":C.isCompleted}])},_(C.text),3),C.isCompleted?(p(),y("div",vj,[r("span",mj,_(g(C)),1),r("span",gj,_(v(C.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]))}},kj=Ke(yj,[["__scopeId","data-v-bda9593a"]]),bj={class:"accordion-section"},wj={class:"accordion-title"},_j=["innerHTML"],Cj={key:0,class:"header-count"},Lj={class:"accordion-icon"},Ij={key:0,class:"accordion-content"},Sj={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,n)=>(p(),y("div",bj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",wj,[r("span",{class:"section-icon",innerHTML:N(so)("notes")},null,8,_j),Je(" Your "+_(e.notes.length===1?"note":"notes"),1),e.notes.length>1?(p(),y("span",Cj," ("+_(e.notes.length)+")",1)):P("",!0)]),r("span",Lj,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",Ij,[Pe(rd,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:n[1]||(n[1]=s=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]))}},xj=Ke(Sj,[["__scopeId","data-v-ef145eb9"]]),$j={class:"accordion-section"},Tj={class:"accordion-title"},Mj=["innerHTML"],Aj={key:0,class:"location-status active"},Ej={key:1,class:"location-status"},Pj={class:"accordion-icon"},Dj={key:0,class:"accordion-content map-content"},Rj={key:0,class:"map-selection-banner"},Oj={class:"map-wrapper"},Bj={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:n}=dt(),s=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),o=ol({headerStyle:H(()=>cu(s.headerStyle)),headerTextColor:H(()=>cu(s.headerTextColor))}),i=D(null);return t({mapRef:i,recenterOnLocation:(l,c,d)=>i.value?.recenterOnLocation?.(l,c,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,c)=>(p(),y("div",$j,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:c[0]||(c[0]=d=>l.$emit("toggle"))},[r("span",Tj,[r("span",{class:"section-icon",innerHTML:N(so)("course")},null,8,Mj),Je(" "+_(N(n).course)+" ",1),e.userLocation?(p(),y("span",Aj,"GPS Active")):(p(),y("span",Ej,"GPS Inactive"))]),r("span",Pj,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",Dj,[e.selectingLocation?(p(),y("div",Rj,[r("span",null,[c[7]||(c[7]=Je("Click on the map to set the new location for ",-1)),r("strong",null,_(e.selectingLocationName),1)]),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),r("div",Oj,[Pe(al,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!1,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":N(n).course,"fullscreen-header-style":o.headerStyle,"fullscreen-header-text-color":o.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:le({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:c[3]||(c[3]=d=>l.$emit("map-click",d)),onLocationClick:c[4]||(c[4]=d=>l.$emit("location-click",d)),onActionClick:c[5]||(c[5]=d=>l.$emit("action-click",d)),onVisibilityChange:c[6]||(c[6]=d=>l.$emit("visibility-change",d))},_f({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ve(()=>[r("span",null,[c[8]||(c[8]=Je("Click on the map to set the new location for ",-1)),r("strong",null,_(e.selectingLocationName),1)]),r("button",{onClick:c[2]||(c[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]))}},Nj=Ke(Bj,[["__scopeId","data-v-ff7cc2e4"]]),Fj={class:"area-lead-content"},Uj={key:0,class:"loading-state"},zj={key:1,class:"error-state"},Hj={key:2,class:"empty-state"},Vj={key:3,class:"checkpoint-accordion"},Gj=["onClick"],qj={class:"checkpoint-header-content"},jj={class:"checkpoint-title-row"},Wj={class:"checkpoint-name"},Zj={key:0,class:"area-badge"},Kj={key:0,class:"checkpoint-description-preview"},Yj={class:"checkpoint-status-row"},Jj={class:"status-badge marshals-status"},Xj={key:0,class:"status-badge tasks-status"},Qj={class:"accordion-icon"},eW={key:0,class:"checkpoint-accordion-content"},tW={class:"checkpoint-mini-map"},nW={class:"checkpoint-marshals-section"},oW={class:"marshals-label"},sW={key:0,class:"empty-state"},aW={key:1,class:"marshals-list"},iW=["onClick"],lW={class:"marshal-header"},rW={class:"marshal-name-row"},cW={class:"marshal-name"},uW={key:0,class:"task-count"},dW={class:"check-status-row"},hW=["onClick","disabled"],fW={key:0,class:"check-in-time"},pW={key:0},vW={key:1,class:"last-access-time"},mW={key:0,class:"checkpoint-tasks-section"},gW={class:"marshals-label"},yW={class:"tasks-list"},kW=["disabled","onChange"],bW={class:"task-text"},wW=["disabled","onChange"],_W={class:"task-text"},CW={key:0,class:"marshal-details-modal"},LW={class:"details-section"},IW={class:"contact-info"},SW={key:0,class:"contact-row"},xW=["href"],$W={key:1,class:"contact-row"},TW=["href"],MW={key:2,class:"no-contact"},AW={class:"details-section"},EW={key:0,class:"checked-in-section"},PW={class:"checked-in-details"},DW={class:"check-time-detail"},RW={key:0,class:"check-method"},OW=["disabled"],BW={key:1,class:"not-checked-in-section"},NW=["disabled"],FW={key:2,class:"last-access-detail"},UW={class:"details-section"},zW={key:0,class:"no-tasks"},HW={key:1,class:"tasks-list modal-tasks"},VW=["disabled","onChange"],GW={class:"task-text"},qW={class:"details-section contact-actions-section"},jW={class:"contact-buttons"},WW=["href"],ZW=["href"],KW=["href"],YW={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:n}){const{terms:s,termsLower:o}=dt(),{updatePendingCount:i}=Wf(),l=e,c=n,d=D(!1),h=D(null),f=D([]),v=D([]),g=D(null),k=D(!1),b=D(null),x=H(()=>{const q=new Set(l.areaIds);return q.size===0?[...v.value].sort((J,ee)=>Qo(J.name,ee.name)):v.value.filter(J=>(J.areaIds||[]).some(ue=>q.has(ue))).sort((J,ee)=>Qo(J.name,ee.name))}),A=(q,J=60)=>q?q.length<=J?q:q.substring(0,J).trim()+"...":"",T=D(!1),w=D(null),C=D(null),I=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,Jn()){try{const q=await hi(l.eventId);if(q?.areaLeadDashboard){f.value=q.areaLeadDashboard.areas||[],v.value=q.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(q){console.warn("Failed to load cached dashboard:",q)}h.value="Offline - no cached data available",d.value=!1;return}try{const q=await ma.getAreaLeadDashboard(l.eventId),J=Zh(q.data);f.value=J.areas||[],v.value=J.checkpoints||[];try{const ee=JSON.parse(JSON.stringify({areas:f.value,checkpoints:v.value}));await hi(l.eventId)?await tu(l.eventId,"areaLeadDashboard",ee):await rc(l.eventId,{areaLeadDashboard:ee})}catch(ee){console.warn("Failed to cache dashboard:",ee)}}catch(q){console.error("Failed to load area lead dashboard:",q);try{const J=await hi(l.eventId);if(J?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=J.areaLeadDashboard.areas||[],v.value=J.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(J){console.warn("Failed to load cached dashboard:",J)}h.value=q.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},$=q=>{g.value=g.value===q?null:q},R=q=>q.marshals.filter(J=>J.isCheckedIn).length,M=q=>{const J=q.marshals.reduce((ee,ue)=>ee+ue.outstandingTaskCount,0);return q.outstandingTaskCount+J},O=(q,J)=>{w.value=q,C.value=J,T.value=!0},E=()=>{T.value=!1,w.value=null,C.value=null},U=async(q,J)=>{if(b.value)return;const ee=q.assignmentId||q.id;if(!ee){console.error("No assignment ID found for marshal:",q);return}b.value=q.marshalId;try{if(Jn())await Oo("checkin_toggle",{eventId:l.eventId,assignmentId:ee}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated");else if(await fi.toggleCheckIn(l.eventId,ee),await I(),c("checkin-updated"),w.value?.marshalId===q.marshalId&&C.value){const ue=v.value.find(_e=>_e.checkpointId===C.value.checkpointId);if(ue){const _e=ue.marshals.find($e=>$e.marshalId===q.marshalId);_e&&(w.value=_e)}}}catch(ue){console.error("Failed to check in marshal:",ue),(Jn()||!ue.response)&&(await Oo("checkin_toggle",{eventId:l.eventId,assignmentId:ee}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated"))}finally{b.value=null}},F=async(q,J)=>{if(k.value)return;k.value=!0;const ue={marshalId:J.marshals.length>0?J.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId};try{Jn()?(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),J.outstandingTasks=J.outstandingTasks.filter(_e=>_e.itemId!==q.itemId),J.outstandingTaskCount=Math.max(0,J.outstandingTaskCount-1),await i(),c("checklist-updated")):(await Ot.complete(l.eventId,q.itemId,ue),await I(),c("checklist-updated"))}catch(_e){console.error("Failed to complete task:",_e),(Jn()||!_e.response)&&(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:ue}),J.outstandingTasks=J.outstandingTasks.filter($e=>$e.itemId!==q.itemId),J.outstandingTaskCount=Math.max(0,J.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},j=async(q,J)=>{if(k.value)return;k.value=!0;const ue={marshalId:J.marshals.length>0?J.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId,actorMarshalId:l.marshalId};try{Jn()?(await Oo("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),J.completedTasks&&(J.completedTasks=J.completedTasks.filter(_e=>_e.itemId!==q.itemId)),J.outstandingTasks||(J.outstandingTasks=[]),J.outstandingTasks.push(q),J.outstandingTaskCount=(J.outstandingTaskCount||0)+1,await i(),c("checklist-updated")):(await Ot.uncomplete(l.eventId,q.itemId,ue),await I(),c("checklist-updated"))}catch(_e){console.error("Failed to uncomplete task:",_e),(Jn()||!_e.response)&&(await Oo("checklist_uncomplete",{eventId:l.eventId,itemId:q.itemId,data:ue}),J.completedTasks&&(J.completedTasks=J.completedTasks.filter($e=>$e.itemId!==q.itemId)),J.outstandingTasks||(J.outstandingTasks=[]),J.outstandingTasks.push(q),J.outstandingTaskCount=(J.outstandingTaskCount||0)+1,await i(),c("checklist-updated"))}finally{k.value=!1}},Z=async q=>{if(k.value||!w.value)return;k.value=!0;const J={marshalId:w.value.marshalId,contextType:q.contextType,contextId:q.contextId};try{if(Jn())await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:J}),w.value.outstandingTasks=w.value.outstandingTasks.filter(ee=>ee.itemId!==q.itemId),w.value.outstandingTaskCount=Math.max(0,w.value.outstandingTaskCount-1),await i(),c("checklist-updated");else{if(await Ot.complete(l.eventId,q.itemId,J),await I(),w.value&&C.value){const ee=v.value.find(ue=>ue.checkpointId===C.value.checkpointId);if(ee){const ue=ee.marshals.find(_e=>_e.marshalId===w.value.marshalId);ue&&(w.value=ue)}}c("checklist-updated")}}catch(ee){console.error("Failed to complete task:",ee),(Jn()||!ee.response)&&(await Oo("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:J}),w.value.outstandingTasks=w.value.outstandingTasks.filter(ue=>ue.itemId!==q.itemId),w.value.outstandingTaskCount=Math.max(0,w.value.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},Q=q=>q?new Date(q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",re=q=>{if(!q)return"";const J=new Date(q),_e=(new Date-J)/(1e3*60*60);return _e<24&&_e>=0?J.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):J.toLocaleString()},K=q=>{if(!q)return"";const J=new Date(q),ue=new Date-J,_e=Math.floor(ue/6e4),$e=Math.floor(_e/60),De=Math.floor($e/24);return _e<1?"just now":_e<60?`${_e}m ago`:$e<24?`${$e}h ago`:De===1?"yesterday":De<7?`${De}d ago`:J.toLocaleDateString()},ae=q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${s.value.area} Lead`})[q]||q;return t({areas:f,checkpoints:v,loading:d,loadDashboard:I}),Ye(()=>l.eventId,()=>{I()},{immediate:!0}),(q,J)=>(p(),y("div",Fj,[d.value?(p(),y("div",Uj," Loading dashboard... ")):h.value?(p(),y("div",zj,[r("p",null,_(h.value),1),r("button",{onClick:I,class:"btn btn-secondary"},"Retry")])):x.value.length===0?(p(),y("div",Hj,[r("p",null,"No "+_(N(o).checkpoints)+" in your "+_(N(o).areas)+".",1)])):(p(),y("div",Vj,[(p(!0),y(Ie,null,je(x.value,ee=>(p(),y("div",{key:ee.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:le(["checkpoint-accordion-header",{active:g.value===ee.checkpointId}]),onClick:ue=>$(ee.checkpointId)},[r("div",qj,[r("div",jj,[r("span",Wj,_(ee.name),1),ee.areaName?(p(),y("span",Zj,_(ee.areaName),1)):P("",!0)]),ee.description?(p(),y("div",Kj,_(A(ee.description)),1)):P("",!0),r("div",Yj,[r("span",Jj,_(R(ee))+" / "+_(ee.marshals.length)+" checked in ",1),M(ee)>0?(p(),y("span",Xj,_(M(ee))+" tasks ",1)):P("",!0)])]),r("span",Qj,_(g.value===ee.checkpointId?"":"+"),1)],10,Gj),g.value===ee.checkpointId?(p(),y("div",eW,[r("div",tW,[Pe(al,{locations:[{id:ee.checkpointId,name:ee.name,description:ee.description,latitude:ee.latitude,longitude:ee.longitude}],route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:ee.latitude,lng:ee.longitude},zoom:16,"highlight-location-id":ee.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","route-color","route-style","route-weight","center","highlight-location-id"])]),r("div",nW,[r("div",oW,_(N(s).people)+" ("+_(ee.marshals.length)+")",1),ee.marshals.length===0?(p(),y("div",sW," No "+_(N(o).people)+" assigned to this "+_(N(o).checkpoint)+". ",1)):(p(),y("div",aW,[(p(!0),y(Ie,null,je(ee.marshals,ue=>(p(),y("div",{key:ue.marshalId,class:le(["marshal-card",{"is-checked-in":ue.isCheckedIn}]),onClick:_e=>O(ue,ee)},[r("div",lW,[r("div",rW,[r("span",cW,_(ue.name),1),ue.outstandingTaskCount>0?(p(),y("span",uW,_(ue.outstandingTaskCount)+" tasks ",1)):P("",!0)]),r("div",dW,[r("div",{class:le(["check-status",{"checked-in":ue.isCheckedIn}])},_(ue.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:rt(_e=>U(ue),["stop"]),class:le(["quick-checkin-btn",{"undo-btn":ue.isCheckedIn}]),disabled:b.value===ue.marshalId},_(b.value===ue.marshalId?"...":ue.isCheckedIn?"Undo":"Check In"),11,hW)])]),ue.isCheckedIn&&ue.checkInTime?(p(),y("div",fW,[Je(_(Q(ue.checkInTime))+" ",1),ue.checkInMethod?(p(),y("span",pW," ("+_(ae(ue.checkInMethod))+")",1)):P("",!0)])):P("",!0),ue.lastAccessedAt?(p(),y("div",vW," Last active: "+_(K(ue.lastAccessedAt)),1)):P("",!0)],10,iW))),128))]))]),ee.outstandingTaskCount>0||ee.completedTasks&&ee.completedTasks.length>0?(p(),y("div",mW,[r("div",gW,_(N(s).checkpoint)+" tasks",1),r("div",yW,[(p(!0),y(Ie,null,je(ee.outstandingTasks,ue=>(p(),y("div",{key:ue.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:_e=>F(ue,ee)},null,40,kW),r("span",bW,_(ue.text),1)]))),128)),(p(!0),y(Ie,null,je(ee.completedTasks||[],ue=>(p(),y("div",{key:`completed-${ue.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:_e=>j(ue,ee)},null,40,wW),r("span",_W,_(ue.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Pe(Yt,{show:T.value,title:w.value?.name||"Marshal Details",size:"large",onClose:E},{actions:Ve(()=>[r("button",{onClick:E,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[w.value?(p(),y("div",CW,[r("div",LW,[J[4]||(J[4]=r("h4",null,"Contact Details",-1)),r("div",IW,[w.value.email?(p(),y("div",SW,[J[2]||(J[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${w.value.email}`},_(w.value.email),9,xW)])):P("",!0),w.value.phoneNumber?(p(),y("div",$W,[J[3]||(J[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${w.value.phoneNumber}`},_(w.value.phoneNumber),9,TW)])):P("",!0),!w.value.email&&!w.value.phoneNumber?(p(),y("div",MW," No contact details available. ")):P("",!0)])]),r("div",AW,[J[8]||(J[8]=r("h4",null,"Check-in Status",-1)),w.value.isCheckedIn?(p(),y("div",EW,[r("div",PW,[J[6]||(J[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[J[5]||(J[5]=r("strong",null,"Checked In",-1)),r("p",DW,_(re(w.value.checkInTime)),1),w.value.checkInMethod?(p(),y("p",RW," Method: "+_(ae(w.value.checkInMethod)),1)):P("",!0)])]),r("button",{onClick:J[0]||(J[0]=ee=>U(w.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===w.value.marshalId},_(b.value===w.value.marshalId?"Undoing...":"Undo Check-in"),9,OW)])):(p(),y("div",BW,[J[7]||(J[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:J[1]||(J[1]=ee=>U(w.value,C.value)),class:"btn btn-primary check-in-btn",disabled:b.value===w.value.marshalId},_(b.value===w.value.marshalId?"Checking in...":"Check In"),9,NW)])),w.value.lastAccessedAt?(p(),y("div",FW," Last active: "+_(K(w.value.lastAccessedAt)),1)):P("",!0)]),r("div",UW,[r("h4",null,_(N(s).checklists)+" ("+_(w.value.outstandingTasks?.length||0)+" outstanding)",1),!w.value.outstandingTasks||w.value.outstandingTasks.length===0?(p(),y("div",zW," No outstanding tasks. ")):(p(),y("div",HW,[(p(!0),y(Ie,null,je(w.value.outstandingTasks,ee=>(p(),y("div",{key:ee.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:ue=>Z(ee)},null,40,VW),r("span",GW,_(ee.text),1)]))),128))]))]),r("div",qW,[r("div",jW,[w.value.phoneNumber?(p(),y("a",{key:0,href:`tel:${w.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,WW)):P("",!0),w.value.phoneNumber?(p(),y("a",{key:1,href:`sms:${w.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,ZW)):P("",!0),w.value.email?(p(),y("a",{key:2,href:`mailto:${w.value.email}`,class:"btn btn-secondary"}," Email ",8,KW)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},JW=Ke(YW,[["__scopeId","data-v-2a10b044"]]),XW={key:0,class:"accordion-section"},QW={class:"accordion-title"},eZ=["innerHTML"],tZ={key:0,class:"header-count"},nZ={class:"accordion-icon"},oZ={key:0,class:"accordion-content area-lead-accordion-content"},sZ={key:0,class:"area-filter-pills"},aZ=["onClick"],iZ={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:n}=dt(),s=D(null);return t({areaLeadRef:s}),(o,i)=>e.isAreaLead?(p(),y("div",XW,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",QW,[r("span",{class:"section-icon",innerHTML:N(so)("area")},null,8,eZ),Je(" Your "+_(e.areas.length===1?N(n).area:N(n).areas),1),e.areas.length>1?(p(),y("span",tZ," ("+_(e.areas.length)+")",1)):P("",!0)]),r("span",nZ,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",oZ,[e.areas.length>1?(p(),y("div",sZ,[(p(!0),y(Ie,null,je(e.areas,l=>(p(),y("button",{key:l.areaId,class:le(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:tt(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:c=>o.$emit("toggle-filter",l.areaId)},_(l.name),15,aZ))),128))])):P("",!0),Pe(JW,{ref_key:"areaLeadRef",ref:s,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,onChecklistUpdated:i[1]||(i[1]=l=>o.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route","route-color","route-style","route-weight"])])):P("",!0)])):P("",!0)}},lZ=Ke(iZ,[["__scopeId","data-v-dfc09e28"]]),rZ={key:0,class:"accordion-section"},cZ={class:"accordion-title"},uZ=["innerHTML"],dZ={key:0,class:"header-count"},hZ={class:"accordion-icon"},fZ={key:0,class:"accordion-content area-lead-marshals-content"},pZ={class:"area-lead-marshals-list"},vZ=["onClick"],mZ={class:"marshal-header-info"},gZ={class:"marshal-name-row"},yZ={class:"marshal-name"},kZ={class:"marshal-meta"},bZ={class:"marshal-checkpoint"},wZ={key:0,class:"marshal-task-count"},_Z={class:"accordion-icon"},CZ={key:0,class:"area-lead-marshal-content"},LZ={key:0,class:"marshal-actions-row"},IZ=["onClick"],SZ={key:1,class:"marshal-contact-section"},xZ=["href"],$Z=["href"],TZ={key:2,class:"marshal-tasks-section"},MZ={class:"tasks-label"},AZ={class:"tasks-list"},EZ=["checked","disabled","onChange"],PZ={class:"task-content"},DZ={class:"task-text"},RZ={key:0,class:"task-context"},OZ={key:1,class:"task-completion-info"},BZ={key:0,class:"completion-by"},NZ={key:1,class:"completion-time"},FZ={key:3,class:"no-tasks-message"},UZ={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1},currentMarshalId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]}},emits:["toggle","toggle-marshal","check-in","toggle-task","show-qr"],setup(e){const{terms:t,termsLower:n}=dt(),s=e,o=v=>{if(!v||v.length===0)return"";const g=k=>k.description?`${k.name} - ${k.description}`:k.name;return v.length===1?g(v[0]):v.map(g).join(", ")},i=(v,g)=>{const k=v.completionContextType||v.contextType,b=v.completionContextId||v.contextId;if(k==="Checkpoint"&&b){const x=g.checkpoints?.find(T=>T.checkpointId===b);if(x){if(x.description){const w=x.description.length>50?x.description.substring(0,50)+"...":x.description;return`${x.name} - ${w}`}return x.name}const A=s.locations.find(T=>T.id===b);if(A){if(A.description){const w=A.description.length>50?A.description.substring(0,50)+"...":A.description;return`${A.name} - ${w}`}return A.name}}if(k==="Area"&&b){const x=s.areas.find(A=>A.id===b);if(x)return x.name}return""},l=(v,g)=>{const k=v.completionContextType||v.contextType,b=v.completionContextId||v.contextId;if(k==="Checkpoint"&&b){const x=g.checkpoints?.find(T=>T.checkpointId===b);return x?x.name||"":s.locations.find(T=>T.id===b)?.name||""}return k==="Area"&&b&&s.areas.find(A=>A.id===b)?.name||""},c=v=>{if(!v.allTasks||v.allTasks.length===0)return[];const g=new Map;for(const A of v.allTasks){const T=A.completionContextType||A.contextType,w=A.completionContextId||A.contextId,C=`${A.itemId}_${T}_${w}`;if(!g.has(C))g.set(C,{...A});else{const I=g.get(C);A.isCompleted&&!I.isCompleted&&g.set(C,{...I,isCompleted:!0,completedAt:A.completedAt||I.completedAt,completedByActorName:A.completedByActorName||I.completedByActorName,contextOwnerName:A.contextOwnerName||I.contextOwnerName})}}const k=Array.from(g.values()),b=new Map;for(const A of k)b.set(A.text,(b.get(A.text)||0)+1);return r1(k,A=>l(A,v)).map(A=>({...A,needsDisambiguation:b.get(A.text)>1,contextDisplayName:i(A,v)}))},d=v=>v.completedByActorName&&v.contextOwnerName&&v.completedByActorName!==v.contextOwnerName?`${v.completedByActorName} on behalf of ${v.contextOwnerName}`:v.completedByActorName||"",h=v=>{if(!v)return"";const g=new Date(v),x=(new Date-g)/(1e3*60*60);return x<24&&x>=0?g.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):g.toLocaleString()},f=v=>{const g=c(v),k=g.length,b=g.filter(x=>x.isCompleted).length;return{total:k,completed:b}};return(v,g)=>e.isAreaLead&&e.marshals.length>0?(p(),y("div",rZ,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:g[0]||(g[0]=k=>v.$emit("toggle"))},[r("span",cZ,[r("span",{class:"section-icon",innerHTML:N(so)("marshal")},null,8,uZ),Je(" Your "+_(e.marshals.length===1?N(n).person:N(n).people),1),e.marshals.length>1?(p(),y("span",dZ," ("+_(e.marshals.length)+")",1)):P("",!0)]),r("span",hZ,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",fZ,[r("div",pZ,[(p(!0),y(Ie,null,je(e.marshals,k=>(p(),y("div",{key:k.marshalId,class:"area-lead-marshal-item"},[r("button",{class:le(["area-lead-marshal-header",{active:e.expandedMarshalId===k.marshalId,"is-checked-in":k.isCheckedIn}]),onClick:b=>v.$emit("toggle-marshal",k.marshalId)},[r("div",mZ,[r("div",gZ,[r("span",yZ,_(k.name),1),r("span",{class:le(["check-status-badge",{"checked-in":k.isCheckedIn}])},_(k.isCheckedIn?"":""),3)]),r("div",kZ,[r("span",bZ,_(o(k.checkpoints)),1),f(k).total>0?(p(),y("span",wZ,_(f(k).completed)+" / "+_(f(k).total)+" "+_(N(n).checklists)+" complete ",1)):P("",!0)])]),r("span",_Z,_(e.expandedMarshalId===k.marshalId?"":"+"),1)],10,vZ),e.expandedMarshalId===k.marshalId?(p(),y("div",CZ,[k.marshalId!==e.currentMarshalId?(p(),y("div",LZ,[Pe(xu,{"is-checked-in":k.isCheckedIn,"check-in-time":k.checkInTime,"check-in-method":k.checkInMethod,"checked-in-by":k.checkedInBy,"marshal-name":k.marshalName,"is-loading":e.checkingInMarshalId===k.id,onToggle:b=>v.$emit("check-in",k)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:rt(b=>v.$emit("show-qr",k),["stop"]),title:"Show QR code for magic link"},[...g[1]||(g[1]=[vi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-efab33d3><rect x="3" y="3" width="7" height="7" data-v-efab33d3></rect><rect x="14" y="3" width="7" height="7" data-v-efab33d3></rect><rect x="3" y="14" width="7" height="7" data-v-efab33d3></rect><rect x="14" y="14" width="3" height="3" data-v-efab33d3></rect><rect x="19" y="14" width="2" height="2" data-v-efab33d3></rect><rect x="14" y="19" width="2" height="2" data-v-efab33d3></rect><rect x="19" y="19" width="2" height="2" data-v-efab33d3></rect></svg>',1)])],8,IZ)])):P("",!0),k.email||k.phoneNumber?(p(),y("div",SZ,[k.phoneNumber?(p(),y("a",{key:0,href:`tel:${k.phoneNumber}`,class:"contact-link"},_(k.phoneNumber),9,xZ)):P("",!0),k.email?(p(),y("a",{key:1,href:`mailto:${k.email}`,class:"contact-link"},_(k.email),9,$Z)):P("",!0)])):P("",!0),c(k).length>0?(p(),y("div",TZ,[r("div",MZ,_(N(t).checklists),1),r("div",AZ,[(p(!0),y(Ie,null,je(c(k),b=>(p(),y("div",{key:`${b.itemId}-${b.completionContextType||b.contextType}-${b.completionContextId||b.contextId}`,class:le(["task-item",{"task-completed":b.isCompleted}])},[r("input",{type:"checkbox",checked:b.isCompleted,disabled:e.savingTask,onChange:x=>v.$emit("toggle-task",b,k)},null,40,EZ),r("div",PZ,[r("span",DZ,_(b.text),1),b.needsDisambiguation&&b.contextDisplayName?(p(),y("div",RZ,_(b.contextDisplayName),1)):P("",!0),b.isCompleted&&(b.completedByActorName||b.completedAt)?(p(),y("div",OZ,[d(b)?(p(),y("span",BZ,_(d(b)),1)):P("",!0),b.completedAt?(p(),y("span",NZ,_(h(b.completedAt)),1)):P("",!0)])):P("",!0)])],2))),128))])])):(p(),y("div",FZ," No "+_(N(n).checklists)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0)}},zZ=Ke(UZ,[["__scopeId","data-v-efab33d3"]]),HZ={class:"checkpoint-note-header"},VZ={key:0,class:"pin-icon",title:"Pinned"},GZ={class:"checkpoint-note-title"},qZ={key:0,class:"checkpoint-note-content"},jZ={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,n=H(()=>(t.priority||"Normal").toLowerCase());return(s,o)=>(p(),y("div",{class:le(["checkpoint-note-item",n.value])},[r("div",HZ,[e.isPinned?(p(),y("span",VZ,"")):P("",!0),r("span",{class:le(["priority-indicator",n.value])},null,2),r("strong",GZ,_(e.title),1),r("span",{class:le(["priority-badge",n.value])},_(e.priority),3)]),e.content?(p(),y("div",qZ,_(e.content),1)):P("",!0)],2))}},WZ=Ke(jZ,[["__scopeId","data-v-5f2df920"]]),ZZ={class:"checkpoint-accordion-section"},KZ={class:"checkpoint-header-content"},YZ={class:"checkpoint-title-row"},JZ=["innerHTML"],XZ={key:0,class:"checkpoint-check-icon"},QZ={class:"checkpoint-name"},eK={key:1,class:"area-badge"},tK={key:2,class:"checkpoint-time-badge"},nK={key:3,class:"checkpoint-distance-badge"},oK={key:0,class:"checkpoint-description-preview"},sK={class:"accordion-icon"},aK={key:0,class:"checkpoint-accordion-content"},iK={key:0,class:"checkpoint-mini-map"},lK={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},rK={class:"my-checkin-section"},cK={key:0,class:"check-in-error"},uK={key:1,class:"dynamic-location-section"},dK={class:"dynamic-location-header"},hK={class:"dynamic-badge"},fK={key:0,class:"last-update"},pK={key:0,class:"dynamic-location-actions"},vK=["disabled"],mK=["title"],gK={class:"checkpoint-marshals"},yK={class:"marshals-label"},kK={key:0,class:"marshals-list"},bK={key:0,class:"check-badge"},wK={key:1,class:"marshals-list-expanded"},_K=["onClick"],CK={class:"marshal-name-text"},LK={class:"marshal-status-icons"},IK={key:0,class:"check-badge"},SK={class:"expand-icon"},xK={key:0,class:"marshal-details-panel"},$K={class:"detail-row"},TK={key:0,class:"detail-row"},MK={key:1,class:"detail-row"},AK={key:2,class:"detail-row"},EK=["href"],PK={key:3,class:"detail-row"},DK=["href"],RK={key:4,class:"contact-buttons-mini"},OK=["href"],BK=["href"],NK=["href"],FK={key:5,class:"checkpoint-marshal-actions"},UK=["onClick"],zK={key:2,class:"checkpoint-area-contacts"},HK={class:"marshals-label"},VK={class:"contact-list"},GK={key:3,class:"checkpoint-notes"},qK={class:"checkpoint-notes-list"},jK={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{terms:n,termsLower:s}=dt(),o=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ol({headerStyle:H(()=>cu(o.headerStyle)),headerTextColor:H(()=>cu(o.headerTextColor))}),l=e,c=D(null),d=H(()=>l.assignment.location?.isDynamic),h=H(()=>{const w=l.assignment.location?.name||l.assignment.locationName,C=l.assignment.location?.description;return C?`${w}  ${C}`:w}),f=H(()=>{if(!d.value)return!1;const w=l.assignment.location,C=w?.locationUpdateScopeConfigurations||w?.LocationUpdateScopeConfigurations||[];return s1({scopeConfigurations:C,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),v=H(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const w=l.assignment.location;return!w?.latitude||!w?.longitude?null:sl(l.userLocation.lat,l.userLocation.lng,w.latitude,w.longitude)}),g=H(()=>{const w=v.value;return w==null?null:w<1e3?`${Math.round(w/10)*10} m`:`${(Math.round(w/100)/10).toFixed(1)} km`});t({mapRef:c});const k=w=>{const C=w?.iconType||"checkpoint",I=w?.iconColor||"#667eea",$={checkpoint:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return $[C]||$.checkpoint},b=(w,C)=>{const I=$=>$?new Date($).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return w&&C?`${I(w)} - ${I(C)}`:w?`from ${I(w)}`:C?`until ${I(C)}`:""},x=w=>w?new Date(w).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",A=w=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[w]||w,T=w=>{if(!w)return"";const C=new Date(w),R=(new Date-C)/(1e3*60*60);return R<24&&R>=0?C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):C.toLocaleString()};return(w,C)=>(p(),y("div",ZZ,[r("button",{class:le(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:C[0]||(C[0]=I=>w.$emit("toggle"))},[r("div",KZ,[r("div",YZ,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,JZ),e.assignment.effectiveIsCheckedIn?(p(),y("span",XZ,"")):P("",!0),r("span",QZ,_(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(p(),y("span",eK,_(e.assignment.areaName),1)):P("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(p(),y("span",tK,_(b(e.assignment.location.startTime,e.assignment.location.endTime)),1)):P("",!0),g.value?(p(),y("span",nK,_(g.value),1)):P("",!0)]),e.assignment.location?.description?(p(),y("div",oK,_(e.assignment.location.description),1)):P("",!0)]),r("span",sK,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",aK,[e.assignment.location?(p(),y("div",iK,[Pe(al,{ref_key:"mapRef",ref:c,locations:e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:C[2]||(C[2]=I=>w.$emit("map-click",I)),onLocationClick:C[3]||(C[3]=I=>w.$emit("location-click",I)),onActionClick:C[4]||(C[4]=I=>w.$emit("action-click",I)),onVisibilityChange:C[5]||(C[5]=I=>w.$emit("visibility-change",I))},_f({_:2},[f.value?{name:"fullscreen-footer",fn:Ve(()=>[r("button",{class:"btn btn-primary",onClick:C[1]||(C[1]=I=>w.$emit("update-location"))},[(p(),y("svg",lK,[...C[9]||(C[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),C[10]||(C[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","route-color","route-style","route-weight","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):P("",!0),r("div",rK,[Pe(xu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:C[6]||(C[6]=I=>w.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(p(),y("div",cK,_(e.checkInError),1)):P("",!0)]),d.value?(p(),y("div",uK,[r("div",dK,[r("span",hK,"Dynamic "+_(e.assignment.location.resolvedCheckpointTerm||N(s).checkpoint),1),e.assignment.location.lastLocationUpdate?(p(),y("span",fK," Last updated: "+_(T(e.assignment.location.lastLocationUpdate)),1)):P("",!0)]),f.value?(p(),y("div",pK,[r("button",{onClick:C[7]||(C[7]=I=>w.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...C[11]||(C[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,vK),r("button",{onClick:C[8]||(C[8]=I=>w.$emit("toggle-auto-update")),class:le(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[C[12]||(C[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+_(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,mK)])):P("",!0)])):P("",!0),r("div",gK,[r("div",yK,_(N(n).people)+":",1),e.isAreaLeadForCheckpoint?(p(),y("div",wK,[(p(!0),y(Ie,null,je(e.assignment.allMarshals,I=>(p(),y("div",{key:I.marshalId,class:le(["marshal-card-mini",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn,expanded:e.expandedMarshalId===I.marshalId}])},[r("button",{class:"marshal-card-header",onClick:$=>w.$emit("toggle-marshal",I.marshalId)},[r("span",CK,_(I.marshalName)+_(I.marshalId===e.currentMarshalId?" (you)":""),1),r("span",LK,[I.effectiveIsCheckedIn?(p(),y("span",IK,"")):P("",!0),r("span",SK,_(e.expandedMarshalId===I.marshalId?"":"+"),1)])],8,_K),e.expandedMarshalId===I.marshalId?(p(),y("div",xK,[r("div",$K,[C[13]||(C[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:le(I.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},_(I.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),I.effectiveIsCheckedIn&&I.checkInTime?(p(),y("div",TK,[C[14]||(C[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,_(x(I.checkInTime)),1)])):P("",!0),I.checkInMethod?(p(),y("div",MK,[C[15]||(C[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,_(A(I.checkInMethod)),1)])):P("",!0),I.email?(p(),y("div",AK,[C[16]||(C[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+I.email},_(I.email),9,EK)])):P("",!0),I.phoneNumber?(p(),y("div",PK,[C[17]||(C[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+I.phoneNumber},_(I.phoneNumber),9,DK)])):P("",!0),I.email||I.phoneNumber?(p(),y("div",RK,[I.phoneNumber?(p(),y("a",{key:0,href:"tel:"+I.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,OK)):P("",!0),I.phoneNumber?(p(),y("a",{key:1,href:"sms:"+I.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,BK)):P("",!0),I.email?(p(),y("a",{key:2,href:"mailto:"+I.email,class:"btn btn-sm btn-secondary"},"Email",8,NK)):P("",!0)])):P("",!0),I.marshalId!==e.currentMarshalId?(p(),y("div",FK,[Pe(xu,{"is-checked-in":I.effectiveIsCheckedIn,"check-in-time":I.checkInTime,"check-in-method":I.checkInMethod,"checked-in-by":I.checkedInBy,"marshal-name":I.marshalName,"is-loading":e.checkingInMarshalId===I.id,onToggle:$=>w.$emit("marshal-check-in",I)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:rt($=>w.$emit("show-marshal-qr",I),["stop"]),title:"Show QR code for magic link"},[...C[18]||(C[18]=[vi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-bbde95f8><rect x="3" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="3" width="7" height="7" data-v-bbde95f8></rect><rect x="3" y="14" width="7" height="7" data-v-bbde95f8></rect><rect x="14" y="14" width="3" height="3" data-v-bbde95f8></rect><rect x="19" y="14" width="2" height="2" data-v-bbde95f8></rect><rect x="14" y="19" width="2" height="2" data-v-bbde95f8></rect><rect x="19" y="19" width="2" height="2" data-v-bbde95f8></rect></svg>',1)])],8,UK)])):P("",!0)])):P("",!0)],2))),128))])):(p(),y("div",kK,[(p(!0),y(Ie,null,je(e.assignment.allMarshals,I=>(p(),y("span",{key:I.marshalId,class:le(["marshal-tag",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn}])},[Je(_(I.marshalName)+_(I.marshalId===e.currentMarshalId?" (you)":"")+" ",1),I.effectiveIsCheckedIn?(p(),y("span",bK,"")):P("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(p(),y("div",zK,[r("div",HK,_(N(n).area)+" contacts:",1),r("div",VK,[(p(!0),y(Ie,null,je(e.assignment.areaContacts,I=>(p(),Ge(E1,{key:I.marshalId,name:I.marshalName,role:I.role,phone:I.phone,email:I.email},null,8,["name","role","phone","email"]))),128))])])):P("",!0),e.notes.length>0?(p(),y("div",GK,[C[19]||(C[19]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",qK,[(p(!0),y(Ie,null,je(e.notes,I=>(p(),Ge(WZ,{key:I.noteId,title:I.title,content:I.content,priority:I.priority,"is-pinned":I.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):P("",!0)])):P("",!0)]))}},WK=Ke(jK,[["__scopeId","data-v-bbde95f8"]]),ZK={class:"accordion-section"},KK={class:"accordion-title"},YK=["innerHTML"],JK={key:0,class:"header-count"},XK={class:"accordion-icon"},QK={key:0,class:"accordion-content assignments-accordion-content"},eY={key:0,class:"empty-state"},tY={key:1,class:"checkpoint-accordion"},nY={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},routeColor:{type:String,default:""},routeStyle:{type:String,default:""},routeWeight:{type:Number,default:null},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{termsLower:n}=dt(),s=e,o=H(()=>s.assignments.map(c=>c.locationId)),i={},l=(c,d)=>{d?i[c]=d:delete i[c]};return t({checkpointRefs:i}),(c,d)=>(p(),y("div",ZK,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[r("span",KK,[r("span",{class:"section-icon",innerHTML:N(so)("checkpoint")},null,8,YK),Je(" Your "+_(e.assignments.length===1?N(n).checkpoint:N(n).checkpoints),1),e.assignments.length>1?(p(),y("span",JK," ("+_(e.assignments.length)+")",1)):P("",!0)]),r("span",XK,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",QK,[e.assignments.length===0?(p(),y("div",eY,[r("p",null,"You don't have any "+_(N(n).checkpoint)+" assignments yet.",1)])):(p(),y("div",tY,[(p(!0),y(Ie,null,je(e.assignments,h=>(p(),Ge(WK,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"route-color":e.routeColor,"route-style":e.routeStyle,"route-weight":e.routeWeight,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":o.value,onToggle:f=>c.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>c.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>c.$emit("location-click",f)),onActionClick:f=>c.$emit("action-click",h,f),onVisibilityChange:f=>c.$emit("visibility-change",h.id,f),onUpdateLocation:f=>c.$emit("update-location",h),onCheckIn:f=>c.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>c.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>c.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>c.$emit("toggle-auto-update",h),onShowMarshalQr:d[4]||(d[4]=f=>c.$emit("show-marshal-qr",f))},null,8,["assignment","is-expanded","all-locations","route","route-color","route-style","route-weight","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):P("",!0)]))}},oY=Ke(nY,[["__scopeId","data-v-e4d1cee8"]]),sY={key:0,class:"accordion-section"},aY={class:"accordion-title"},iY=["innerHTML"],lY={key:0,class:"header-count"},rY={class:"accordion-icon"},cY={key:0,class:"accordion-content"},uY={class:"roles-list"},dY={class:"role-title"},hY={class:"role-notes"},fY={__name:"MarshalRolesSection",props:{roles:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.roles.length>0?(p(),y("div",sY,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=s=>t.$emit("toggle"))},[r("span",aY,[r("span",{class:"section-icon",innerHTML:N(so)("user")},null,8,iY),Je(" Your "+_(e.roles.length===1?"role":"roles"),1),e.roles.length>1?(p(),y("span",lY," ("+_(e.roles.length)+")",1)):P("",!0)]),r("span",rY,_(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),y("div",cY,[r("div",uY,[(p(!0),y(Ie,null,je(e.roles,s=>(p(),y("div",{key:s.roleId,class:"role-card"},[r("div",dY,_(s.name),1),r("div",hY,_(s.notes),1)]))),128))])])):P("",!0)])):P("",!0)}},pY=Ke(fY,[["__scopeId","data-v-c6ef5d00"]]),P1="marshal-branding-cache";function vY(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${P1}-${e}`);return t?JSON.parse(t):null}catch{return null}}function mY(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${P1}-${e}`,JSON.stringify(t))}catch{}}function gY(e,t=null){const n=D(t?vY(t):null);Ye(()=>e.value,k=>{if(k&&t){const b={brandingPageGradientStart:k.brandingPageGradientStart,brandingPageGradientEnd:k.brandingPageGradientEnd,brandingHeaderGradientStart:k.brandingHeaderGradientStart,brandingHeaderGradientEnd:k.brandingHeaderGradientEnd,brandingAccentColor:k.brandingAccentColor,brandingLogoUrl:k.brandingLogoUrl,brandingLogoPosition:k.brandingLogoPosition};mY(t,b),n.value=b}},{immediate:!0});const s=(k,b)=>e.value?.[k]||n.value?.[k]||b,o=H(()=>{const k=s("brandingPageGradientStart",dn.pageGradientStart),b=s("brandingPageGradientEnd",dn.pageGradientEnd);return{background:`linear-gradient(135deg, ${k} 0%, ${b} 100%)`}}),i=H(()=>{const k=s("brandingHeaderGradientStart",dn.headerGradientStart),b=s("brandingHeaderGradientEnd",dn.headerGradientEnd);return{background:`linear-gradient(135deg, ${k} 0%, ${b} 100%)`}}),l=H(()=>{const k=s("brandingHeaderGradientStart",dn.headerGradientStart),b=s("brandingHeaderGradientEnd",dn.headerGradientEnd);return tf(k,b)}),c=H(()=>{const k=s("brandingPageGradientStart",dn.pageGradientStart),b=s("brandingPageGradientEnd",dn.pageGradientEnd);return tf(k,b)}),d=H(()=>s("brandingAccentColor",dn.accentColor)),h=H(()=>Su(d.value)),f=H(()=>({background:d.value,color:h.value})),v=H(()=>{const k=s("brandingLogoUrl","");return k?k.startsWith("/api")?ii+k.substring(4):k:""}),g=H(()=>s("brandingLogoPosition","left"));return{pageBackgroundStyle:o,headerStyle:i,headerTextColor:l,pageTextColor:c,accentColor:d,accentTextColor:h,accentButtonStyle:f,brandingLogoUrl:v,brandingLogoPosition:g}}function yY(){const e=D(null),t=D(null);let n=null;const s=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),n=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},o=()=>{n!==null&&(navigator.geolocation.clearWatch(n),n=null)};return Sn(()=>{o()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:s,stopLocationTracking:o}}function Im(e){if(!e||!e._)return Array.isArray(e)?e:[];const{_d:t={},g:n=[],s=[],at:o=[],ct:i=[],m:l=[],c=[],d=[],n:h=[]}=e,f=v=>v==null||v<0||v>=n.length?null:n[v];return h.map(v=>{const g=d[v.i]||{},k=c[v.x]||{},b=i[k.t]||"",x=s[v.s]||"",A=v.c??t["n.c"]??!1,T=v.m??t["n.m"]??!1,w=g.r2??t["d.r2"]??!1,C=g.l??t["d.l"]??!1;let I=null,$=null,R=null;if(A&&v.a!=null&&v.a>=0){const U=l[v.a];U&&(I=U.n,R=f(U.r)),v.at!=null&&v.at>=0&&($=o[v.at])}let M=null,O=null;if(v.o!=null&&v.o>=0){const U=l[v.o];U&&(M=U.n,O=f(U.r))}const E=(g.sc||[]).map(U=>({scope:s[U.s]||"",itemType:U.t,ids:(U.i||[]).map(F=>f(F)).filter(F=>F!=null)}));return{itemId:f(g.r),text:g.t,scopeConfigurations:E,displayOrder:g.o,isRequired:w,visibleFrom:g.vf,visibleUntil:g.vu,mustCompleteBy:g.mb,linksToCheckIn:C,linkedCheckpointId:g.lc!=null?f(g.lc):null,linkedCheckpointName:g.ln,isCompleted:A,canBeCompletedByMe:T,completedByActorName:I,completedByActorType:$,completedByActorId:R,completedAt:v.ca,completionContextType:b,completionContextId:f(k.r),matchedScope:x,contextOwnerName:M,contextOwnerMarshalId:O}})}function kY({eventId:e,currentMarshalId:t,currentPerson:n,assignments:s,areaLeadAreaIds:o,isAreaLead:i,allLocations:l,areas:c,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:v,sectionLastLoadedAt:g,updateCachedField:k,updatePendingCount:b}){const x=D([]),A=D(!1),T=D(null),w=D(!1),C=D("person"),I=D(null),$=H(()=>x.value.slice().sort((J,ee)=>(J.displayOrder||0)-(ee.displayOrder||0))),R=H(()=>$.value.filter(J=>J.isCompleted).length),M=["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],O=H(()=>{const J=s.value.map(ee=>ee.locationId);return $.value.filter(ee=>M.includes(ee.matchedScope)?ee.contextOwnerMarshalId!=null?!1:ee.completionContextType==="Checkpoint"?J.includes(ee.completionContextId):ee.completionContextType==="Area"?o.value.includes(ee.completionContextId):!0:ee.completionContextType==="Personal"?ee.contextOwnerMarshalId===t.value:ee.completionContextType==="Checkpoint"?ee.linksToCheckIn?ee.contextOwnerMarshalId===t.value:J.includes(ee.completionContextId):ee.completionContextType==="Area"?o.value.includes(ee.completionContextId):!0)}),E=H(()=>i.value?$.value.filter(J=>M.includes(J.matchedScope)?J.contextOwnerMarshalId!=null:J.completionContextType==="Personal"?J.contextOwnerMarshalId!==t.value:J.completionContextType==="Checkpoint"?J.linksToCheckIn?J.contextOwnerMarshalId!==t.value:!1:(J.completionContextType==="Area",!1)):[]),U=H(()=>O.value.map(J=>({...J,localIsCompleted:J.isCompleted,isModified:!1})).sort((J,ee)=>(J.displayOrder||0)-(ee.displayOrder||0))),F=H(()=>E.value.map(J=>({...J,localIsCompleted:J.isCompleted,isModified:!1})).sort((J,ee)=>(J.displayOrder||0)-(ee.displayOrder||0))),j=H(()=>{const J=f.value?.checkpoints||v.value||[];if(J.length===0)return[];const ee=[],ue=new Set;for(const _e of J)for(const $e of _e.marshals||[])ue.has($e.marshalId)||(ue.add($e.marshalId),ee.push($e));return ee}),Z=H(()=>{if(i.value)return"none";const J=$.value,ee=new Set;for(const ue of J)ue.completionContextType==="Checkpoint"&&ue.completionContextId&&ee.add(ue.completionContextId);return ee.size>1?"checkpoint":"none"}),Q=H(()=>{const J=$.value,ee={};for(const ue of J){let _e,$e;ue.completionContextType==="Checkpoint"&&ue.completionContextId?(_e=`checkpoint_${ue.completionContextId}`,$e=l.value.find(Re=>Re.id===ue.completionContextId)?.name||"Unknown "+d.value.checkpoint):ue.completionContextType==="Area"&&ue.completionContextId?(_e=`area_${ue.completionContextId}`,$e=c.value.find(Re=>Re.id===ue.completionContextId)?.name||"Unknown "+d.value.area):(_e="personal",$e="Personal"),ee[_e]||(ee[_e]={key:_e,name:$e,items:[],completedCount:0}),ee[_e].items.push(ue),ue.isCompleted&&ee[_e].completedCount++}for(const ue of Object.values(ee))ue.items.sort((_e,$e)=>{const De=_e.displayOrder||0,Re=$e.displayOrder||0;return De-Re});return Object.values(ee).sort((ue,_e)=>ue.name.localeCompare(_e.name,void 0,{numeric:!0,sensitivity:"base"}))}),re=J=>{I.value=I.value===J?null:J},K=J=>{if(!J.completionContextType||!J.completionContextId)return null;if(J.completionContextType==="Checkpoint"){const ee=l.value.find(_e=>_e.id===J.completionContextId);if(!ee)return null;const ue=ee.description?` - ${ee.description}`:"";return`At ${h.value.checkpoint} ${ee.name}${ue}`}if(J.completionContextType==="Area"){const ee=c.value.find(ue=>ue.id===J.completionContextId);return ee?`At ${h.value.area} ${ee.name}`:null}return J.completionContextType==="Personal"?"Personal item":null},ae=async(J=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}J||(A.value=!0),T.value=null;try{const ee=e.value,ue=await Ot.getMarshalChecklist(ee,t.value);let _e=Im(ue.data);if(i.value&&o.value.length>0){const $e=o.value.map(z=>Ot.getAreaChecklist(ee,z).catch(Y=>(console.warn(`Failed to fetch checklist for area ${z}:`,Y),{data:null}))),De=await Promise.all($e),Re=new Map,be=z=>{const Y=`${z.itemId}_${z.completionContextType}_${z.completionContextId}`;return z.contextOwnerMarshalId?`${Y}_${z.contextOwnerMarshalId}`:Y};for(const z of _e)Re.set(be(z),z);for(const z of De){const Y=Im(z.data);for(const de of Y){const ie=be(de);Re.has(ie)||Re.set(ie,de)}}_e=Array.from(Re.values())}x.value=_e,g?.value&&(g.value.checklist=Date.now())}catch(ee){console.error("Failed to load checklist:",ee.response?.status,ee.response?.data),T.value=ee.response?.data?.message||"Failed to load checklist"}finally{J||(A.value=!1)}};return{checklistItems:x,checklistLoading:A,checklistError:T,savingChecklist:w,checklistGroupBy:C,expandedChecklistGroup:I,visibleChecklistItems:$,completedChecklistCount:R,myChecklistItems:O,areaChecklistItems:E,myChecklistItemsWithLocalState:U,areaChecklistItemsWithLocalState:F,areaMarshalsForChecklist:j,effectiveChecklistGroupBy:Z,groupedChecklistItems:Q,loadChecklist:ae,handleToggleChecklist:async J=>{if(w.value)return;w.value=!0;const ee=e.value,ue={marshalId:J.contextOwnerMarshalId||t.value,contextType:J.completionContextType,contextId:J.completionContextId,actorMarshalId:t.value};try{if(J.isCompleted)if(Jn())await Oo("checklist_uncomplete",{eventId:ee,itemId:J.itemId,data:ue}),J.isCompleted=!1,J.completedAt=null,J.completedByActorName=null,b&&await b();else{if(await Ot.uncomplete(ee,J.itemId,ue),J.linksToCheckIn&&J.linkedCheckpointId){const _e=s.value.find($e=>$e.locationId===J.linkedCheckpointId);_e&&(_e.isCheckedIn=!1,_e.checkedInAt=null)}await ae(!0)}else if(Jn())await Oo("checklist_complete",{eventId:ee,itemId:J.itemId,data:ue}),J.isCompleted=!0,J.completedAt=new Date().toISOString(),J.completedByActorName=n.value?.name||"You",b&&await b();else{const _e=await Ot.complete(ee,J.itemId,ue),$e=J.linkedCheckpointId||_e.data?.linkedCheckIn?.locationId;if(J.linksToCheckIn&&$e){const De=s.value.find(Re=>Re.locationId===$e);if(De){const Re=_e.data?.linkedCheckIn?.checkedInAt||new Date().toISOString();De.isCheckedIn=!0,De.checkedInAt=Re}}await ae(!0)}k&&await k(ee,"checklist",JSON.parse(JSON.stringify(x.value)))}catch(_e){if(console.error("Failed to toggle checklist item:",_e),Jn()||!_e.response){const $e=J.isCompleted?"checklist_uncomplete":"checklist_complete";await Oo($e,{eventId:ee,itemId:J.itemId,data:ue}),J.isCompleted?(J.isCompleted=!1,J.completedAt=null,J.completedByActorName=null):(J.isCompleted=!0,J.completedAt=new Date().toISOString(),J.completedByActorName=n.value?.name||"You"),b&&await b(),k&&await k(ee,"checklist",JSON.parse(JSON.stringify(x.value)))}}finally{w.value=!1}},toggleChecklistGroup:re,getContextName:K}}function bY({eventId:e,allLocations:t,userLocation:n,locationLastUpdated:s}){const o=D(!1),i=D(null),l=D(null),c=D(null),d=D(!1),h=D(!1),f=D(!1);let v=null,g=null,k=null;const b=q=>q?.isDynamic===!0||q?.IsDynamic===!0,x=(q,J,ee,ue)=>{const _e=t.value.find($e=>$e.id===q);_e&&(_e.latitude=J,_e.longitude=ee,_e.lastLocationUpdate=ue)},A=q=>{i.value=q,l.value=null,c.value=null,o.value=!0},T=()=>{o.value=!1,i.value=null,l.value=null,c.value=null,f.value=!1},w=()=>{o.value=!1,f.value=!0},C=()=>{f.value=!1,o.value=!0},I=async(q,J,ee,ue,_e=null)=>{d.value=!0;try{const $e=e.value,De={latitude:J,longitude:ee,sourceType:ue};_e&&(De.sourceCheckpointId=_e);const Re=await Xn.updatePosition($e,q,De);Re.data.success&&(h.value&&U(),x(q,Re.data.latitude,Re.data.longitude,Re.data.lastLocationUpdate))}catch($e){console.error("Failed to update location:",$e),$e.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},$=async()=>{if(i.value){d.value=!0,l.value=null;try{let q,J;if(n.value&&s?.value&&Date.now()-s.value<3e4&&(q=n.value.lat,J=n.value.lng),!q||!J){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const $e=await new Promise((De,Re)=>{navigator.geolocation.getCurrentPosition(De,Re,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});q=$e.coords.latitude,J=$e.coords.longitude}const ee=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(ee,ue,{latitude:q,longitude:J,sourceType:"gps"});_e.data.success&&(c.value="Location updated successfully!",x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>T(),1500))}catch(q){console.error("Failed to update location with GPS:",q),q.response?.status===403?l.value="You do not have permission to update this location.":q.code===1?l.value="Location access denied. Please enable location permissions.":q.code===2?l.value="Unable to determine your location. Please try again.":q.code===3||q.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async q=>{if(!i.value)return;const J=t.value.find(ee=>ee.id===q);if(!J){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const ee=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(ee,ue,{latitude:J.latitude,longitude:J.longitude,sourceType:"checkpoint",sourceCheckpointId:q});_e.data.success&&(h.value&&U(),c.value=`Location copied from ${J.name}!`,x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>T(),1500))}catch(ee){console.error("Failed to copy location from checkpoint:",ee),ee.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},M=async(q,J)=>{if(i.value){d.value=!0,l.value=null;try{const ee=e.value,ue=i.value.locationId,_e=await Xn.updatePosition(ee,ue,{latitude:q,longitude:J,sourceType:"manual"});_e.data.success&&(c.value="Location updated successfully!",x(ue,_e.data.latitude,_e.data.longitude,_e.data.lastLocationUpdate),setTimeout(()=>T(),1500))}catch(ee){console.error("Failed to update location manually:",ee),ee.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},O=async q=>{if(!(!q||!("geolocation"in navigator)))try{const J=await new Promise((_e,$e)=>{navigator.geolocation.getCurrentPosition(_e,$e,{enableHighAccuracy:!0,timeout:15e3})}),ee=e.value,ue=q.locationId;await Xn.updatePosition(ee,ue,{latitude:J.coords.latitude,longitude:J.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),x(ue,J.coords.latitude,J.coords.longitude,new Date().toISOString())}catch(J){console.warn("Auto-update location failed:",J)}},E=q=>{h.value=!0,O(q),v=setInterval(()=>{O(q)},6e4)},U=()=>{h.value=!1,v&&(clearInterval(v),v=null)},F=q=>{h.value?U():E(q)},j=()=>{g||!t.value.some(J=>J.isDynamic||J.IsDynamic)||(g=setInterval(async()=>{try{const J=e.value,ee=await Xn.getDynamicCheckpoints(J,{skipLoadingOverlay:!0});if(ee.data&&Array.isArray(ee.data))for(const ue of ee.data){const _e=t.value.find($e=>$e.id===ue.checkpointId);_e&&(_e.latitude=ue.latitude,_e.longitude=ue.longitude,_e.lastLocationUpdate=ue.lastLocationUpdate)}}catch(J){console.warn("Failed to poll dynamic checkpoints:",J)}},6e4))},Z=()=>{g&&(clearInterval(g),g=null)},Q=async()=>{try{const q=e.value,J=await Xn.getByEvent(q,{skipLoadingOverlay:!0});if(J.data&&Array.isArray(J.data))for(const ee of J.data){const ue=t.value.find(_e=>_e.id===ee.id);ue&&(ue.latitude=ee.latitude,ue.longitude=ee.longitude,ee.lastLocationUpdate&&(ue.lastLocationUpdate=ee.lastLocationUpdate))}}catch(q){console.warn("Failed to poll all checkpoint locations:",q)}};return{showLocationUpdateModal:o,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:c,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:b,openLocationUpdateModal:A,closeLocationUpdateModal:T,startMapLocationSelect:w,cancelMapLocationSelect:C,updateDynamicCheckpointLocation:I,updateLocationWithGps:$,updateLocationFromCheckpoint:R,updateLocationManually:M,toggleAutoUpdate:F,startAutoUpdate:E,stopAutoUpdate:U,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:Z,startAllCheckpointsPolling:()=>{k||(Q(),k=setInterval(Q,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:q=>{f.value&&i.value&&(I(i.value.locationId,q.lat,q.lng,"manual"),f.value=!1)}}}function wY({eventId:e,assignments:t,allLocations:n,areaLeadRef:s,areaLeadCheckpoints:o,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:c,reloadChecklist:d,checklistItems:h,currentMarshalId:f}){const{termsLower:v}=dt(),g=D(null),k=D(null),b=D(null),x=D(!1),A=D(null),T=D(new Set),w=D(!1),C=D(""),I=()=>!1,$=Z=>{if(!Z)return"";const Q=new Date(Z),K=(new Date-Q)/(1e3*60*60),ae=Q.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K>24?`${Q.toLocaleDateString([],{day:"numeric",month:"short"})}, ${ae}`:ae},R=Z=>{if(!Z)return"";switch(Z){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return Z}},M=Z=>{T.value.add(Z),x.value=!1,A.value=null},O=()=>{w.value=!1,C.value=""},E=Z=>Z<1e3?`${Math.round(Z/10)*10} m`:`${(Math.round(Z/100)/10).toFixed(1)} km`,U=(Z,Q,re)=>{if(Z==null||Q==null)return;const K=n.value?.find(ee=>ee.id===re);if(!K)return;const ae=K.latitude,q=K.longitude;if(ae==null||q==null)return;const J=sl(Z,Q,ae,q);if(J>50){const ee=E(J);C.value=`Thanks for checking in. Just so you know, it's possible you are more than ${ee} from your ${v.value.checkpoint} area.`,w.value=!0}},F=async(Z,Q=!0,re=null)=>{if(!Z?.id){b.value="Cannot check in: Assignment ID is missing";return}g.value=Z.id,k.value=Z.id,b.value=null;const K=e.value;if(!K){b.value="Cannot check in: Event ID is missing",g.value=null,k.value=null;return}const ae=Z.effectiveIsCheckedIn!==void 0?Z.effectiveIsCheckedIn:Z.isCheckedIn&&!I(Z.checkInTime),q=Z.isCheckedIn&&!ae,J=ae?"check-out":q?"refresh":"check-in",ee=!ae;let ue=null,_e=null,$e="Manual";if(Q&&!ae&&"geolocation"in navigator)try{const Re=await new Promise((be,z)=>{navigator.geolocation.getCurrentPosition(be,z,{enableHighAccuracy:!0,timeout:5e3})});ue=Re.coords.latitude,_e=Re.coords.longitude,$e="GPS"}catch{}const De={latitude:ue,longitude:_e,action:J};try{if(Jn()){await Oo("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:De});const Re=t.value.findIndex(be=>be.id===Z.id);if(Re!==-1&&(t.value[Re]={...t.value[Re],isCheckedIn:ee,checkInTime:ee?new Date().toISOString():null,checkInMethod:ee?`${$e} (pending)`:null,checkInLatitude:ue,checkInLongitude:_e}),re){const be=n.value.find(z=>z.id===re);if(be?.assignments){const z=be.assignments.find(Y=>Y.id===Z.id||Y.marshalId===Z.marshalId);z&&(z.isCheckedIn=ee,z.checkInTime=ee?new Date().toISOString():null)}}l&&await l(),c&&await c(K,"locations",n.value)}else{const Re=await fi.toggleCheckIn(K,Z.id,De),be=Re.data?.assignment||Re.data,z=Re.data?.linkedTasksCompleted||[],Y=Re.data?.linkedTasksUncompleted||0,de=t.value.findIndex(ie=>ie.id===Z.id);if(de!==-1&&(t.value[de]=be),re){const ie=n.value.find(Ae=>Ae.id===re);if(ie?.assignments){const Ae=ie.assignments.find(G=>G.id===Z.id||G.marshalId===Z.marshalId);Ae&&Object.assign(Ae,be)}}d&&(z.length>0||Y>0)&&await d(!0)}if(re&&s?.value?.loadDashboard&&(await s.value.loadDashboard(),o&&s?.value?.checkpoints&&(o.value=s.value.checkpoints)),i&&i.value++,ee&&ue!=null&&_e!=null){const Re=re||Z.locationId;Re&&U(ue,_e,Re)}}catch(Re){if(Jn()||!Re.response){await Oo("checkin_toggle",{eventId:K,assignmentId:Z.id,gpsData:De});const be=t.value.findIndex(z=>z.id===Z.id);be!==-1&&(t.value[be]={...t.value[be],isCheckedIn:ee,checkInTime:ee?new Date().toISOString():null,checkInMethod:ee?"Manual (pending)":null}),l&&await l()}else Re.response?.data?.message?b.value=Re.response.data.message:Re.message?b.value=Re.message:b.value=`Failed to ${J}. Please try again.`}finally{g.value=null,k.value=null}};return{checkingIn:g,checkingInAssignment:k,checkInError:b,showCheckInReminderModal:x,checkInReminderCheckpoint:A,dismissedCheckInReminders:T,showDistanceWarning:w,distanceWarningMessage:C,isCheckInStale:I,formatCheckInTime:$,formatCheckInMethod:R,handleCheckInToggle:F,handleAreaLeadMarshalCheckIn:async Z=>{const re=(s?.value?.checkpoints||o?.value||[]).find(_e=>_e.marshals?.some($e=>$e.marshalId===Z.marshalId));if(!re){console.error("Could not find checkpoint for marshal:",Z);return}const K=re.marshals.find(_e=>_e.marshalId===Z.marshalId);if(!K)return;const ae=K.assignmentId||K.id;if(!ae){console.error("No assignment ID found for marshal:",K);return}const q=!Z.isCheckedIn,J=re.checkpointId||re.locationId,ee={id:ae,marshalId:Z.marshalId,isCheckedIn:Z.isCheckedIn,effectiveIsCheckedIn:Z.isCheckedIn};await F(ee,!1,J);const ue=[s?.value?.checkpoints,o?.value].filter(Boolean);for(const _e of ue)for(const $e of _e){const De=$e.marshals?.find(Re=>Re.marshalId===Z.marshalId);De&&(De.isCheckedIn=q,De.checkInTime=q?new Date().toISOString():null,De.checkInMethod=q?"AreaLead":null)}if(i&&i.value++,h?.value&&e?.value&&f?.value){const _e=h.value.filter($e=>$e.linksToCheckIn&&$e.linkedCheckpointId===J&&($e.contextOwnerMarshalId===Z.marshalId||$e.completionContextType==="Checkpoint"&&$e.completionContextId===J));if(_e.length>0){for(const $e of _e)try{const De={marshalId:$e.contextOwnerMarshalId||Z.marshalId,contextType:$e.completionContextType,contextId:$e.completionContextId,actorMarshalId:f.value};q&&!$e.isCompleted?await Ot.complete(e.value,$e.itemId,De):!q&&$e.isCompleted&&await Ot.uncomplete(e.value,$e.itemId,De)}catch(De){console.error("Failed to toggle linked task:",De)}d&&await d(!0)}}},dismissCheckInReminder:M,dismissDistanceWarning:O}}function _Y({eventId:e,sectionLastLoadedAt:t,showMessage:n}){const s=D([]),o=D(!1),i=D(null),l=D(!1),c=D(!1),d=D(""),h=D(!1),f=D(!1),v=D(!1),g=H(()=>s.value.filter($=>$.status==="open"||$.status==="acknowledged"||$.status==="in_progress").length),k=async()=>{const $=e.value;o.value=!0;try{const R=await ga.getAll($),O=Jy(R.data).incidents||[];s.value=O.sort((E,U)=>new Date(U.incidentTime||U.createdAt)-new Date(E.incidentTime||E.createdAt)),t?.value&&(t.value.incidents=Date.now())}catch(R){console.error("Failed to load incidents:",R)}finally{o.value=!1}},b=async $=>{v.value=!0;try{await ga.create(e.value,$),f.value=!1,k(),n&&n("Incident Reported","An administrator will review it shortly.")}catch(R){console.error("Failed to report incident:",R),n&&n("Error",R.response?.data?.message||"Failed to report incident. Please try again.")}finally{v.value=!1}},x=$=>{i.value=$,l.value=!0},A=()=>{l.value=!1,i.value=null},T=async({incidentId:$,status:R})=>{try{await ga.updateStatus(e.value,$,{status:R});const M=s.value.find(O=>O.incidentId===$);M&&(M.status=R),i.value?.incidentId===$&&(i.value.status=R)}catch(M){console.error("Failed to update incident status:",M),n&&n("Error","Failed to update status. Please try again.")}},w=()=>{d.value="",c.value=!0},C=()=>{c.value=!1,d.value=""};return{myIncidents:s,incidentsLoading:o,selectedIncident:i,showIncidentDetail:l,showAddIncidentNoteModal:c,incidentNoteText:d,submittingIncidentNote:h,showReportIncident:f,reportingIncident:v,openIncidentsCount:g,loadMyIncidents:k,handleReportIncident:b,openIncidentDetail:x,closeIncidentDetail:A,handleIncidentStatusChange:T,openAddIncidentNoteModal:w,closeAddIncidentNoteModal:C,submitIncidentNote:async()=>{if(!(!d.value.trim()||!i.value)){h.value=!0;try{await ga.addNote(e.value,i.value.incidentId,d.value.trim()),C(),k();const $=await ga.get(e.value,i.value.incidentId);i.value=$.data}catch($){console.error("Failed to add note:",$),n&&n("Error","Failed to add note. Please try again.")}finally{h.value=!1}}}}}const Sm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',xm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',CY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',LY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function IY({userLocation:e,assignmentsWithDetails:t,courseMapRef:n}){const{termsLower:s}=dt(),o=D({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=D(!1),l=D(-1),c=D({}),d={},h=H(()=>t.value.filter(T=>T.location?.latitude&&T.location?.longitude&&!(T.location.latitude===0&&T.location.longitude===0))),f=H(()=>{const T=[];return T.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+s.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?CY:LY}),e.value&&!o.value.userLocationInView&&T.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Sm}),h.value.length>0&&!o.value.highlightedLocationInView&&T.push({id:"recenter-checkpoint",label:"My "+s.value.checkpoint,icon:"custom",customIcon:xm}),T}),v=T=>{const w=o.value,C=w.userLocationInView!==T.userLocationInView||w.highlightedLocationInView!==T.highlightedLocationInView,I=JSON.stringify(w.highlightedLocationsVisibility)!==JSON.stringify(T.highlightedLocationsVisibility||{});(C||I)&&(o.value={...T,highlightedLocationsVisibility:T.highlightedLocationsVisibility||{}})},g=()=>{const T=h.value;if(T.length===0)return null;if(T.length===1)return l.value=0,T[0];const w=o.value.highlightedLocationsVisibility||{},C=[];for(let R=0;R<T.length;R++){const M=T[R].locationId;w[M]===!1&&C.push(R)}if(C.length===0)return l.value=0,T[0];if(C.length===1)return l.value=C[0],T[C[0]];const I=l.value;let $=-1;for(const R of C)if(R>I){$=R;break}return $===-1&&($=C[0]),l.value=$,T[$]};return{courseMapVisibility:o,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:v,handleCourseMapAction:({actionId:T})=>{if(T==="toggle-other-checkpoints")i.value=!i.value;else if(T==="recenter-user"&&e.value)n.value?.recenterOnUserLocation();else if(T==="recenter-checkpoint"){const w=g();w?.location&&n.value?.recenterOnLocation(w.location.latitude,w.location.longitude)}},checkpointMapVisibility:c,checkpointMapRefs:d,getCheckpointMapActions:T=>{const w=[],C=c.value[T]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!C.userLocationInView&&w.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Sm}),C.highlightedLocationInView||w.push({id:"recenter-checkpoint",label:s.value.checkpoint.charAt(0).toUpperCase()+s.value.checkpoint.slice(1),icon:"custom",customIcon:xm}),w},handleCheckpointMapVisibilityChange:(T,w)=>{const C=c.value[T];(!C||C.userLocationInView!==w.userLocationInView||C.highlightedLocationInView!==w.highlightedLocationInView)&&(c.value={...c.value,[T]:w})},handleCheckpointMapAction:(T,{actionId:w})=>{const C=d[T.id];w==="recenter-user"&&e.value?C?.recenterOnUserLocation():w==="recenter-checkpoint"&&T.location&&C?.recenterOnLocation(T.location.latitude,T.location.longitude)}}}function SY({eventId:e,currentMarshalId:t,areaLeadRef:n,areaLeadCheckpoints:s,areaChecklistItems:o,myChecklistItems:i,areaLeadAreaIds:l,loadChecklist:c}){const d=D(null),h=D(!1),f=D(0),v=b=>{d.value=d.value===b?null:b},g=H(()=>{f.value;const b=n?.value?.checkpoints,x=s?.value,A=b?.length>0?b:x||[],T=o?.value||[],w=i?.value||[],C=[...T,...w],I=new Map;for(const R of A){const M=R.marshals||R.Marshals||[],O=R.checkpointId||R.CheckpointId,E=R.name||R.Name,U=R.description||R.Description,F=R.areaIds||R.AreaIds||[];for(const j of M){const Z=j.marshalId||j.MarshalId;if(!Z)continue;I.has(Z)||I.set(Z,{...j,marshalId:Z,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const Q=I.get(Z);Q.checkpoints.push({checkpointId:O,name:E,description:U}),Q.checkpointIds.add(O);for(const re of F)Q.areaIds.add(re)}}for(const R of C){const M=R.completionContextType,O=R.completionContextId,E=R.contextOwnerMarshalId;let U=[];if(E)I.has(E)&&(U=[I.get(E)]);else{if(M==="Personal")continue;if(M==="Checkpoint")for(const F of I.values())F.checkpointIds.has(O)&&U.push(F);else if(M==="Area")for(const F of I.values())F.areaIds.has(O)&&U.push(F);else U=Array.from(I.values())}for(const F of U)F.allTasks.push({...R,isCompleted:R.isCompleted||R.localIsCompleted}),F.totalTaskCount++,(R.isCompleted||R.localIsCompleted)&&F.completedTaskCount++}return Array.from(I.values()).map(R=>({...R,checkpointIds:Array.from(R.checkpointIds),areaIds:Array.from(R.areaIds)})).sort((R,M)=>(R.name||"").localeCompare(M.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:d,savingAreaLeadMarshalTask:h,areaLeadMarshalDataVersion:f,allAreaLeadMarshals:g,toggleAreaLeadMarshalExpansion:v,toggleAreaLeadMarshalTask:async(b,x)=>{if(h.value)return;h.value=!0;const A={marshalId:x.marshalId,contextType:b.completionContextType||b.contextType,contextId:b.completionContextId||b.contextId,actorMarshalId:t.value},T=!b.isCompleted;try{if(b.isCompleted?await Ot.uncomplete(e.value,b.itemId,A):await Ot.complete(e.value,b.itemId,A),b.linksToCheckIn){const w=n?.value?.checkpoints||s?.value||[];for(const C of w){const I=C.marshals?.find($=>$.marshalId===x.marshalId);I&&(I.isCheckedIn=T,I.checkInTime=T?new Date().toISOString():null,I.checkInMethod=T?"Task":null)}}n?.value?.loadDashboard&&(await n.value.loadDashboard(),s&&n?.value?.checkpoints&&(s.value=n.value.checkpoints)),f.value++,c&&await c(!0)}catch(w){console.error("Failed to toggle area lead marshal task:",w),console.error("Error response data:",w.response?.data)}finally{h.value=!1}}}}function xY({router:e,route:t,onAuthSuccess:n}){const s=D(!1),o=D(!1),i=D(null),l=D(null),c=D(null),d=D(null),h=H(()=>l.value?.name||null),f=H(()=>d.value?.eventRoles?d.value.eventRoles.filter(E=>E.role==="EventAreaLead").flatMap(E=>E.areaIds||[]):[]),v=H(()=>f.value.length>0),g=H(()=>d.value?.eventRoles?d.value.eventRoles.some(O=>O.role==="EventAdmin"):!1),k=H(()=>d.value?.authMethod==="SecureEmailLink"&&g.value),b=H(()=>d.value?.authMethod==="MarshalMagicCode"&&g.value);let x=null;const A=()=>{x||(x=setInterval(async()=>{if(d.value?.marshalId)try{await js.getMe(t.params.eventId)}catch(O){console.debug("Heartbeat failed:",O)}},300*1e3))},T=()=>{x&&(clearInterval(x),x=null)},w=async(O,E,U=!1)=>{o.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:O,code:E,isReauth:U}),Fd();try{Bo("marshal",O);const F=await js.marshalLogin(O,E);if(console.log("Auth response:",F.data),F.data.success){lv(O,{token:F.data.sessionToken,marshalId:F.data.marshalId,marshalName:F.data.person?.name||null}),qw(O,F.data.marshalId,E),l.value=F.data.person,c.value=F.data.marshalId,s.value=!0,console.log("Authenticated as marshal:",c.value,l.value?.name);try{const j=await js.getMe(O);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),A(),n&&await n()}else i.value=F.data.message||"Authentication failed"}catch(F){console.error("Authentication failed:",F),i.value=F.response?.data?.message||"Invalid or expired login link"}finally{o.value=!1}};return{isAuthenticated:s,authenticating:o,loginError:i,currentPerson:l,currentMarshalId:c,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:v,isEventAdmin:g,canSwitchToAdmin:k,isAdminButNeedsReauth:b,authenticateWithMagicCode:w,checkExistingSession:async O=>{Bo("marshal",O);const E=bu(O),U=E?.marshalId,F=U?by(O,U):null;if(!E?.token)return F?(console.log("No session but have stored code, attempting re-authentication..."),Fd(),await w(O,F,!0),s.value):!1;try{const j=await js.getMe(O);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},c.value=j.data.marshalId,s.value=!0,my(O,j.data.marshalId),A(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),F)try{if(Fd(),await w(O,F,!0),s.value)return console.log("Re-authentication successful"),!0}catch(Z){console.error("Re-authentication failed:",Z)}E?.sessionKey&&zh(E.sessionKey)}return!1},handleClose:O=>{T(),Bo(null),s.value=!1,l.value=null,c.value=null,d.value=null,O&&O(),e.push("/marshal")},handleRemoveSession:async O=>{const[E]=O.split(":");Bo("marshal",E);try{await js.logout()}catch{}zh(O),Bo(null)},updateSessionEventInfo:(O,E,U)=>{const F=bu(O);F&&F.marshalId&&lv(O,{marshalId:F.marshalId,marshalName:F.marshalName,token:F.token,eventName:E,eventDate:U})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:A,stopHeartbeat:T}}function $Y({eventDate:e,latitude:t,longitude:n}){const s=D(null),o=D(!1),i=D(null),l=["US","LR","MM"],c=H(()=>{try{const w=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(w)}catch{return!1}}),d=H(()=>c.value?"fahrenheit":"celsius"),h=H(()=>{if(!e.value)return null;const T=new Date,w=new Date(e.value);return T.setHours(0,0,0,0),w.setHours(0,0,0,0),Math.floor((w-T)/(1e3*60*60*24))}),f=H(()=>{const T=h.value;return T===null?!1:T>=-1&&T<=7}),v=T=>T>3?720*60*1e3:T>1?10800*1e3:3600*1e3,g=(T,w,C)=>`weather_${T.toFixed(2)}_${w.toFixed(2)}_${C}`,k=(T,w,C,I)=>{try{const $=g(T,w,C),R=localStorage.getItem($);if(!R)return null;const{data:M,timestamp:O}=JSON.parse(R),E=v(I);return Date.now()-O<E?M:(localStorage.removeItem($),null)}catch{return null}},b=(T,w,C,I)=>{try{const $=g(T,w,C);localStorage.setItem($,JSON.stringify({data:I,timestamp:Date.now()}))}catch{}},x={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},A=async()=>{const T=t.value,w=n.value,C=e.value,I=h.value;if(!T||!w||!C||!f.value){s.value=null;return}const $=new Date(C).toISOString().split("T")[0],R=k(T,w,$,I);if(R){s.value=R;return}o.value=!0,i.value=null;try{const M=c.value?"fahrenheit":"celsius",O=`https://api.open-meteo.com/v1/forecast?latitude=${T}&longitude=${w}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${M}&timezone=auto`,E=await fetch(O);if(!E.ok)throw new Error("Weather API request failed");const U=await E.json(),F=U.daily.time.indexOf($);if(F===-1){s.value=null;return}const j=U.daily.weathercode[F],Z=Math.round(U.daily.temperature_2m_max[F]),Q=Math.round(U.daily.temperature_2m_min[F]),re=x[j]||{icon:"cloud",description:"Unknown"},K={tempMax:Z,tempMin:Q,unit:c.value?"F":"C",icon:re.icon,description:re.description,weatherCode:j};b(T,w,$,K),s.value=K}catch(M){console.warn("Failed to fetch weather:",M),i.value=M.message,s.value=null}finally{o.value=!1}};return Ye([e,t,n,f],()=>{f.value&&t.value&&n.value?A():s.value=null},{immediate:!0}),{weather:s,loading:o,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:A}}const TY=["aria-label"],MY={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,n={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},s=H(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${n[t.icon]||"cloudy"}.svg`),o=H(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=H(()=>({width:o.value,height:o.value,backgroundColor:t.color,maskImage:`url(${s.value})`,WebkitMaskImage:`url(${s.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,c)=>(p(),y("span",{class:"weather-icon",style:tt(i.value),role:"img","aria-label":e.alt},null,12,TY))}},AY=Ke(MY,[["__scopeId","data-v-9861a237"]]),EY={key:0,class:"header-logo-cover"},PY=["src"],DY={key:2,class:"header-logo header-logo-left"},RY=["src"],OY={class:"header-center"},BY={key:0},NY={key:1,class:"header-event-date"},FY=["title"],UY={class:"weather-temp"},zY={key:0,class:"header-actions"},HY={key:3,class:"header-logo header-logo-right"},VY=["src"],GY={class:"container"},qY={key:0,class:"selection-card"},jY={key:1,class:"selection-card"},WY={key:0,class:"loading"},ZY={key:2,class:"selection-card error-card"},KY={class:"error"},YY={key:3,class:"dashboard"},JY={key:0,class:"welcome-bar"},XY={class:"welcome-info"},QY={key:0,class:"welcome-email"},eJ={key:0,class:"mode-switch"},tJ={key:1,class:"mode-switch"},nJ={class:"accordion"},oJ={key:1,class:"refresh-indicator"},sJ={class:"add-note-form"},aJ={class:"modal-actions"},iJ=["disabled"],lJ={key:0,class:"qr-loading-state"},rJ={key:1,class:"qr-error-state"},cJ=6e4,uJ={__name:"MarshalView",setup(e){const{terms:t,termsLower:n}=dt(),{updatePendingCount:s}=Wf(),o=Qu(),i=ir(),l=H(()=>o.params.eventId),c={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:v,currentMarshalId:g,currentMarshalName:k,areaLeadAreaIds:b,isAreaLead:x,canSwitchToAdmin:A,isAdminButNeedsReauth:T,authenticateWithMagicCode:w,checkExistingSession:C,handleClose:I,updateSessionEventInfo:$,switchToAdminMode:R,stopHeartbeat:M}=xY({router:i,route:o,onAuthSuccess:()=>c.onAuthSuccess?.()}),O=D(new Set),E=H(()=>b.value.length?K.value.filter(Te=>b.value.includes(Te.id)).map(Te=>({areaId:Te.id,name:Te.name,color:Te.color})).sort((Te,Le)=>(Te.name||"").localeCompare(Le.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ye(E,Te=>{Te.length>0&&O.value.size===0&&(O.value=new Set(Te.map(Le=>Le.areaId)))},{immediate:!0});const U=H(()=>b.value.filter(Te=>O.value.has(Te))),F=Te=>{const Le=new Set(O.value);Le.has(Te)?Le.delete(Te):Le.add(Te),O.value=Le},j=H(()=>{const Te=xn.value.find(nt=>nt.isCheckedIn&&!qn(nt.checkInTime)&&nt.location);if(Te?.location)return{id:Te.location.id,locationId:Te.location.id,name:Te.location.name,description:Te.location.description};if(qt.value){const nt=xn.value.find(vt=>vt.id===qt.value);if(nt?.location)return{id:nt.location.id,locationId:nt.location.id,name:nt.location.name,description:nt.location.description}}const Le=xn.value[0];return Le?.location?{id:Le.location.id,locationId:Le.location.id,name:Le.location.name,description:Le.location.description}:null}),Z=D(null),Q=D([]),re=D([]),K=D([]),ae=D(!0),q=D(!1),{pageBackgroundStyle:J,headerStyle:ee,headerTextColor:ue,pageTextColor:_e,accentColor:$e,accentTextColor:De,accentButtonStyle:Re,brandingLogoUrl:be,brandingLogoPosition:z}=gY(Z,o.params.eventId);Br("marshalBranding",{headerStyle:ee,headerTextColor:ue,accentButtonStyle:Re,accentColor:$e,accentTextColor:De});const Y=H(()=>{if(!Q.value.length)return null;const Te=Q.value.filter(Le=>Le.latitude&&Le.longitude);return Te.length?Te.reduce((Le,nt)=>Le+nt.latitude,0)/Te.length:null}),de=H(()=>{if(!Q.value.length)return null;const Te=Q.value.filter(Le=>Le.latitude&&Le.longitude);return Te.length?Te.reduce((Le,nt)=>Le+nt.longitude,0)/Te.length:null}),ie=H(()=>Z.value?.eventDate||null),{weather:Ae,shouldShowWeather:G}=$Y({eventDate:ie,latitude:Y,longitude:de}),X=D("assignments"),te=D({checklist:0,notes:0,incidents:0,eventContacts:0}),Ce=D([]),Ne=D([]),Fe=D([]),Ee=D(null),oe=H(()=>Ee.value?.areaLeadRef?.value),{checklistItems:ge,checklistLoading:Be,checklistError:Oe,savingChecklist:xe,expandedChecklistGroup:me,visibleChecklistItems:Ze,completedChecklistCount:qe,myChecklistItems:fe,areaChecklistItems:ke,areaChecklistItemsWithLocalState:ne,areaMarshalsForChecklist:ye,effectiveChecklistGroupBy:He,groupedChecklistItems:ct,loadChecklist:ht,handleToggleChecklist:Bt,toggleChecklistGroup:Lt,getContextName:Nt}=kY({eventId:l,currentMarshalId:g,currentPerson:v,assignments:re,areaLeadAreaIds:b,isAreaLead:x,allLocations:Q,areas:K,terms:t,termsLower:n,areaLeadRef:oe,areaLeadCheckpoints:Ce,sectionLastLoadedAt:te,updateCachedField:tu,updatePendingCount:s}),{userLocation:Et,locationLastUpdated:yo,startLocationTracking:ko,stopLocationTracking:ft}=yY(),{showLocationUpdateModal:Pt,updatingLocationFor:mt,locationUpdateError:An,locationUpdateSuccess:Ao,updatingLocation:ao,autoUpdateEnabled:bo,selectingLocationOnMap:Gt,openLocationUpdateModal:As,closeLocationUpdateModal:wo,startMapLocationSelect:zo,cancelMapLocationSelect:pe,updateDynamicCheckpointLocation:ve,updateLocationWithGps:Se,updateLocationFromCheckpoint:lt,toggleAutoUpdate:Qe,stopAutoUpdate:Ft,startDynamicCheckpointPolling:sn,stopDynamicCheckpointPolling:yn,startAllCheckpointsPolling:_n,stopAllCheckpointsPolling:_o}=bY({eventId:l,allLocations:Q,userLocation:Et,locationLastUpdated:yo});let Ho=null;const Vo=async()=>{zo(),Ho=X.value,X.value="map",await cn(),ro.value?.openFullscreen?.()},Ma=()=>{Ho&&(X.value=Ho,Ho=null)},dl=()=>{pe(),ro.value?.mapRef?.closeFullscreen?.(),Ma()},{expandedAreaLeadMarshal:hl,savingAreaLeadMarshalTask:bi,areaLeadMarshalDataVersion:Go,allAreaLeadMarshals:qo,toggleAreaLeadMarshalExpansion:Aa,toggleAreaLeadMarshalTask:Es}=SY({eventId:l,currentMarshalId:g,areaLeadRef:oe,areaLeadCheckpoints:Ce,areaChecklistItems:ke,myChecklistItems:fe,areaLeadAreaIds:b,loadChecklist:ht}),{checkingIn:Vn,checkingInAssignment:wi,checkInError:Gn,showCheckInReminderModal:jo,checkInReminderCheckpoint:os,dismissedCheckInReminders:Ks,showDistanceWarning:io,distanceWarningMessage:Ys,isCheckInStale:qn,handleCheckInToggle:Wo,handleAreaLeadMarshalCheckIn:bt,dismissCheckInReminder:Dt,dismissDistanceWarning:jn}=wY({eventId:l,assignments:re,allLocations:Q,areaLeadRef:oe,areaLeadCheckpoints:Ce,areaLeadMarshalDataVersion:Go,updatePendingCount:s,updateCachedField:tu,reloadChecklist:ht,checklistItems:ge,currentMarshalId:g}),On=D(!1),Bn=D(!1),ss=D(""),pt=D(""),Vt=D(null),Co=D(!1),Lo=D(""),Cn=D(""),Js=(Te,Le)=>{Lo.value=Te,Cn.value=Le,Co.value=!0},Eo=D(!1),Io=D(""),en=D(""),Wn=D(!1),lo=D(""),Ps=async Te=>{en.value=Te.name||Te.marshalName||"",Io.value="",lo.value="",Wn.value=!0,Eo.value=!0;try{const Le=await bs.getMagicLink(l.value,Te.marshalId);Io.value=Le.data.magicLink,Wn.value=!1}catch(Le){Wn.value=!1,lo.value=Le.response?.data?.message||"Failed to load magic link"}},{myIncidents:Ea,incidentsLoading:Xs,selectedIncident:_i,showIncidentDetail:Pa,showAddIncidentNoteModal:Da,incidentNoteText:Ds,submittingIncidentNote:Ra,showReportIncident:Rs,loadMyIncidents:Ci,handleReportIncident:Li,openIncidentDetail:ur,handleIncidentStatusChange:wt,openAddIncidentNoteModal:Rt,closeAddIncidentNoteModal:Ut,submitIncidentNote:Oa}=_Y({eventId:l,sectionLastLoadedAt:te,showMessage:Js}),ro=D(null),Ii=H(()=>ro.value),Qs=D(null),as=Te=>!Te||Te.length===0?!1:Te.some(Le=>b.value.includes(Le)),Zn=Te=>{Qs.value=Qs.value===Te?null:Te},kn=Te=>{const Le=X.value===Te;if(X.value=Le?null:Te,!Le){const nt=Date.now(),vt=Ct=>nt-te.value[Ct]>cJ;switch(Te){case"checklist":vt("checklist")&&ht();break;case"notes":vt("notes")&&za();break;case"incidents":vt("incidents")&&Ci();break;case"eventContacts":vt("eventContacts")&&oa();break}}},qt=D(null),co=Te=>{qt.value=qt.value===Te?null:Te},fl=H(()=>X.value==="map"||X.value==="assignments"&&qt.value!==null);Ye(fl,Te=>{Te?_n():_o()});const xn=H(()=>re.value.map(Te=>{const Le=Q.value.find(Tt=>Tt.id===Te.locationId),nt=Le?.areaIds||Le?.AreaIds||[];let vt=null;nt.length>0&&K.value.length>0&&(vt=K.value.find(ln=>nt.includes(ln.id))?.name);const Xt=(Le?.assignments||[]).map(Tt=>({...Tt,effectiveIsCheckedIn:Tt.isCheckedIn&&!qn(Tt.checkInTime)})).sort((Tt,ln)=>(Tt.marshalName||"").localeCompare(ln.marshalName||"",void 0,{sensitivity:"base"})),tn=Ns.value.filter(Tt=>nt.includes(Tt.areaId)&&(!Tt.marshalId||Tt.marshalId!==g.value)),an=new Set,pn=tn.filter(Tt=>{const ln=JSON.stringify({name:Tt.name||"",marshalId:Tt.marshalId||"",role:Tt.role||"",phone:Tt.phone||"",email:Tt.email||"",notes:Tt.notes||""});return an.has(ln)?!1:(an.add(ln),!0)}).sort((Tt,ln)=>(Tt.marshalName||Tt.name||"").localeCompare(ln.marshalName||ln.name||"",void 0,{sensitivity:"base"})),bn=Te.isCheckedIn&&!qn(Te.checkInTime);return{...Te,location:Le,areaName:vt,areaIds:nt,allMarshals:Xt,areaContacts:pn,locationName:Le?.name||"Unknown Location",effectiveIsCheckedIn:bn}})),{courseMapActions:ea,hideOtherCheckpoints:Os,handleCourseMapVisibilityChange:Ba,handleCourseMapAction:pl,getCheckpointMapActions:Si,handleCheckpointMapVisibilityChange:$t,handleCheckpointMapAction:vl}=IY({userLocation:Et,assignmentsWithDetails:xn,courseMapRef:Ii}),En=H(()=>re.value.length>0?re.value[0]:null),is=H(()=>re.value.map(Te=>Te.locationId)),ml=H(()=>Os.value?Q.value.filter(Te=>{const Le=is.value.includes(Te.id),nt=Te.isDynamic||Te.IsDynamic;return Le||nt}):Q.value),xi=H(()=>xn.value.some(Te=>Te.location?.isDynamic||Te.location?.IsDynamic)),ls=H(()=>xn.value.find(Te=>Te.location?.isDynamic||Te.location?.IsDynamic)),$i=H(()=>{const Te=ls.value;if(!Te)return!1;const Le=Te.location,nt=Le?.locationUpdateScopeConfigurations||Le?.LocationUpdateScopeConfigurations||[];return s1({scopeConfigurations:nt,marshalId:g.value,marshalAssignmentLocationIds:is.value,areaLeadAreaIds:b.value,locationId:Te.locationId,locationAreaIds:Te.areaIds||[]})}),gl=H(()=>{if(!Z.value||!xn.value.length)return[];const Te=new Date,Le=Z.value.eventDate?new Date(Z.value.eventDate):null;return xn.value.filter(nt=>{if(nt.effectiveIsCheckedIn||Ks.value.has(nt.id))return!1;const vt=nt.location;if(!vt)return!1;const Ct=vt.startTime?new Date(vt.startTime):Le;if(!Ct)return!1;let Xt;if(vt.endTime)Xt=new Date(vt.endTime);else if(Le)Xt=new Date(Le.getTime()+7200*1e3);else return!1;return Te>=Ct&&Te<Xt})});Ye(gl,Te=>{Te.length>0&&!jo.value&&(os.value=Te[0],jo.value=!0)},{immediate:!0}),Ye(io,Te=>{Te&&(Js("Distance notice",Ys.value),jn())});const dr=()=>{const Te=os.value;Te&&(Dt(Te.id),X.value="assignments",qt.value=Te.id)},ta=H(()=>Z.value?.route?(typeof Z.value.route=="string"?JSON.parse(Z.value.route):Z.value.route)||[]:[]),na=H(()=>!En.value||!Q.value.length?null:Q.value.find(Te=>Te.id===En.value.locationId)),Bs=D([]),Pn=D(!1),Ti=H(()=>{const Te=Bs.value.filter(vt=>!vt.marshalId||vt.marshalId!==g.value),Le=new Set;return Te.filter(vt=>{const Ct=JSON.stringify({name:vt.name||"",marshalId:vt.marshalId||"",role:vt.role||"",phone:vt.phone||"",email:vt.email||"",notes:vt.notes||""});return Le.has(Ct)?!1:(Le.add(Ct),!0)}).sort((vt,Ct)=>{if(vt.isPinned!==Ct.isPinned)return vt.isPinned?-1:1;const Xt=vt.displayOrder||0,tn=Ct.displayOrder||0;return Xt!==tn?Xt-tn:(vt.name||"").localeCompare(Ct.name||"",void 0,{sensitivity:"base"})})}),Mi=H(()=>Ti.value.filter(Te=>Te.showInEmergencyInfo)),Po=H(()=>Ne.value.filter(Te=>Te.showInEmergencyInfo)),yl=H(()=>Mi.value.length>0||Po.value.length>0),kl=Te=>{if(!Ne.value||Ne.value.length===0)return[];const Le=[],nt=new Set;for(const Ct of Ne.value){const Xt=Ct.noteId||Ct.NoteId||Ct.id;if(nt.has(Xt))continue;const tn=Ct.scopeConfigurations||Ct.ScopeConfigurations||[];let an=!1;if(tn.length>0)for(const pn of tn){const bn=pn.itemType||pn.ItemType,Tt=pn.ids||pn.Ids||[];if(bn==="Checkpoint"&&(Tt.includes(Te)||Tt.includes("ALL_CHECKPOINTS"))){an=!0;break}}else{const pn=Ct.matchedScope||Ct.MatchedScope||"";["EveryoneAtCheckpoints","Checkpoint"].some(Tt=>pn.includes(Tt)||pn===Tt)&&(an=!0)}an&&(nt.add(Xt),Le.push(Ct))}const vt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Le.sort((Ct,Xt)=>{const tn=Ct.isPinned||Ct.IsPinned,an=Xt.isPinned||Xt.IsPinned;if(tn&&!an)return-1;if(!tn&&an)return 1;const pn=vt[Ct.priority||Ct.Priority||"Normal"]??3,bn=vt[Xt.priority||Xt.Priority||"Normal"]??3;if(pn!==bn)return pn-bn;const Tt=Ct.displayOrder||Ct.DisplayOrder||0,ln=Xt.displayOrder||Xt.DisplayOrder||0;if(Tt!==ln)return Tt-ln;const vr=Ct.createdAt||Ct.CreatedAt,ia=Xt.createdAt||Xt.CreatedAt;return new Date(ia)-new Date(vr)})},Ns=D([]),Na=(Te,Le)=>Te.localeCompare(Le,void 0,{numeric:!0,sensitivity:"base"}),Fa=H(()=>{if(!mt.value)return[];const Te=mt.value.locationId;return Q.value.filter(Le=>Le.id!==Te&&Le.latitude!==0&&Le.longitude!==0).sort((Le,nt)=>Na(Le.name,nt.name))}),bl=H(()=>na.value?{lat:na.value.latitude,lng:na.value.longitude}:Et.value?Et.value:Q.value.length>0?{lat:Q.value[0].latitude,lng:Q.value[0].longitude}:{lat:51.505,lng:-.09}),hr=Te=>{if(Z.value=Te.event,K.value=Te.areas||[],Q.value=Te.locations||[],ge.value=Te.checklist||[],Bs.value=Te.contacts||[],Ne.value=Te.notes||[],Fe.value=Te.roles||[],Te.areaLeadDashboard?.checkpoints&&(Ce.value=Te.areaLeadDashboard.checkpoints),Z.value&&Yh(Z.value),g.value){const Le=[];for(const nt of Q.value){const vt=nt.assignments?.find(Ct=>Ct.marshalId===g.value);vt&&Le.push(vt)}re.value=Le}},wl=async()=>{const Te=o.params.eventId;console.log("Loading event data for:",{eventId:Te,marshalId:g.value});const Le=await hi(Te);let nt=!1;if(Le&&(console.log("Loaded cached data from:",Le.cachedAt),hr(Le),nt=!0,ae.value=!1),Jn())if(nt){console.log("Offline mode - using cached data");return}else{console.warn("No cached data available while offline");return}nt&&(q.value=!0),console.log("Fetching fresh event data in parallel...");const[vt,Ct,Xt]=await Promise.allSettled([li.getById(Te),ma.getByEvent(Te),$r.getEventStatus(Te)]);if(vt.status==="fulfilled"?(Z.value=vt.value.data,console.log("Event loaded:",Z.value?.name),Z.value&&(Yh(Z.value),$(Te,Z.value.name,Z.value.eventDate))):console.error("Failed to load event:",vt.reason),Ct.status==="fulfilled"?(K.value=Ct.value.data||[],console.log("Areas loaded:",K.value.length)):console.error("Failed to load areas:",Ct.reason),Xt.status==="fulfilled"){const an=Yy(Xt.value.data);if(Q.value=an?.locations||[],console.log("Locations loaded:",Q.value.length),g.value){const pn=[];for(const bn of Q.value){const Tt=bn.assignments?.find(ln=>ln.marshalId===g.value);Tt&&pn.push(Tt)}re.value=pn,console.log("Total assignments found:",re.value.length)}}else console.error("Failed to load event status:",Xt.reason);const tn=[ht(),oa(),za(),Ci(),Ha()];x.value&&tn.push(fr()),await Promise.allSettled(tn);try{const an={event:Z.value,areas:K.value,locations:Q.value,checklist:ge.value,contacts:Bs.value,notes:Ne.value,roles:Fe.value,marshalId:g.value};Ce.value.length>0&&(an.areaLeadDashboard={checkpoints:Ce.value});const pn=JSON.parse(JSON.stringify(an));await rc(Te,pn),console.log("Event data cached for offline access")}catch(an){console.warn("Failed to cache event data:",an)}sn(),q.value=!1};c.onAuthSuccess=wl;const Ua=async()=>{const Te=o.params.eventId;if(Jn()){console.log("Skipping background preload: offline");return}if(console.log("Starting background preload for offline data..."),Ce.value.length>0)console.log("Area lead dashboard already loaded, skipping preload");else try{const Le=await ma.getAreaLeadDashboard(Te);if(Le.data){const nt=Zh(Le.data);Ce.value=nt.checkpoints||[];const vt=JSON.parse(JSON.stringify({areas:nt.areas||[],checkpoints:nt.checkpoints||[]}));await hi(Te)?await tu(Te,"areaLeadDashboard",vt):await rc(Te,{areaLeadDashboard:vt}),console.log("Area lead dashboard cached for offline access")}}catch(Le){Le.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Le)}console.log("Background preload complete")},fr=async()=>{const Te=o.params.eventId;try{const Le=await ma.getAreaLeadDashboard(Te);if(Le.data){const nt=Zh(Le.data);Ce.value=nt.checkpoints||[],console.log("Area lead dashboard loaded:",Ce.value.length,"checkpoints")}}catch(Le){Le.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Le)}},za=async()=>{const Te=o.params.eventId;try{const Le=await ys.getMyNotes(Te);Ne.value=Le.data||[],te.value.notes=Date.now(),console.log("Notes loaded:",Ne.value.length)}catch(Le){console.error("Failed to load notes:",Le)}},oa=async()=>{const Te=o.params.eventId;Pn.value=!0;try{const Le=await ua.getMyContacts(Te);Bs.value=Le.data||[],te.value.eventContacts=Date.now(),console.log("Contacts loaded:",Bs.value.length)}catch(Le){console.warn("Failed to load contacts:",Le),Bs.value=[]}finally{Pn.value=!1}},Ha=async()=>{const Te=o.params.eventId;try{const Le=await Qa.getMyRoles(Te);Fe.value=Le.data||[],console.log("Roles loaded:",Fe.value.length)}catch(Le){console.warn("Failed to load roles:",Le),Fe.value=[]}},rs=()=>{Bn.value=!1,Vt.value&&(Vt.value(),Vt.value=null)},pr=()=>{Bn.value=!1,Vt.value=null},sa=()=>{Co.value=!1},Nn=async Te=>{if(Gt.value&&mt.value){await ve(mt.value.locationId,Te.lat,Te.lng,"manual"),Gt.value=!1,mt.value=null,ro.value?.mapRef?.closeFullscreen?.(),Ma();return}if($i.value&&ls.value){const Le=ls.value;ss.value="Update location",pt.value=`Update ${Le.location?.name||"dynamic checkpoint"} to this location?`,Vt.value=async()=>{await ve(Le.locationId,Te.lat,Te.lng,"manual"),ro.value?.mapRef?.closeFullscreen?.()},Bn.value=!0}},aa=async Te=>{if(Gt.value&&mt.value){if(Te.id===mt.value.locationId)return;await ve(mt.value.locationId,Te.latitude,Te.longitude,"checkpoint",Te.id),Gt.value=!1,ro.value?.mapRef?.closeFullscreen?.(),Ma();return}if($i.value&&ls.value){const Le=ls.value;if(Te.id===Le.locationId)return;ss.value="Copy location",pt.value=`Copy location from "${Te.name}" to ${Le.location?.name||"your dynamic checkpoint"}?`,Vt.value=async()=>{await ve(Le.locationId,Te.latitude,Te.longitude,"checkpoint",Te.id),ro.value?.mapRef?.closeFullscreen?.()},Bn.value=!0}},Va=()=>{I(()=>{re.value=[],ge.value=[],Ns.value=[]})},cs=Te=>Te?new Date(Te).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return un(async()=>{const Te=o.params.eventId,Le=o.query.code;ae.value=!0;try{Le?await w(Te,Le):await C(Te)&&await wl()}finally{ae.value=!1}d.value&&(ko(),"requestIdleCallback"in window?requestIdleCallback(()=>{Ua()},{timeout:5e3}):setTimeout(()=>{Ua()},2e3))}),Ye(d,Te=>{Te?ko():ft()}),Ye(()=>o.query.code,async Te=>{if(Te&&d.value){ae.value=!0;try{await w(o.params.eventId,Te)}finally{ae.value=!1}}}),Ye(Z,Te=>{Te&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),Sn(()=>{M(),Ft(),yn(),_o()}),(Te,Le)=>(p(),y("div",{class:"marshal-view",style:tt(N(J))},[Pe(tG),r("header",{class:le(["header",`logo-${N(z)}`]),style:tt(N(ee))},[N(be)&&N(z)==="cover"?(p(),y("div",EY,[r("img",{src:N(be),alt:"Event logo",class:"header-logo-cover-img"},null,8,PY)])):P("",!0),N(d)&&N(z)==="right"?(p(),y("button",{key:1,onClick:Va,class:"btn-close-session btn-close-left",style:tt({color:N(ue)}),title:"Close session"},"  ",4)):P("",!0),N(be)&&N(z)==="left"?(p(),y("div",DY,[r("img",{src:N(be),alt:"Event logo",class:"header-logo-img"},null,8,RY)])):P("",!0),r("div",OY,[r("div",{class:"header-title",style:tt({color:N(ue)})},[Z.value?(p(),y("h1",BY,_(Z.value.name),1)):P("",!0),Z.value?.eventDate?(p(),y("div",NY,[Je(_(cs(Z.value.eventDate))+" ",1),N(G)&&N(Ae)?(p(),y("span",{key:0,class:"header-weather",title:N(Ae).description},[Pe(AY,{icon:N(Ae).icon,size:18,alt:N(Ae).description,color:N(ue)},null,8,["icon","alt","color"]),r("span",UY,_(N(Ae).tempMax)+""+_(N(Ae).unit),1)],8,FY)):P("",!0)])):P("",!0)],4),N(d)?(p(),y("div",zY,[r("button",{onClick:Le[0]||(Le[0]=nt=>Rs.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),yl.value?(p(),y("button",{key:0,onClick:Le[1]||(Le[1]=nt=>On.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):P("",!0)])):P("",!0)]),N(be)&&N(z)==="right"?(p(),y("div",HY,[r("img",{src:N(be),alt:"Event logo",class:"header-logo-img"},null,8,VY)])):P("",!0),N(d)&&N(z)!=="right"?(p(),y("button",{key:4,onClick:Va,class:"btn-close-session btn-close-right",style:tt({color:N(ue)}),title:"Close session"},"  ",4)):P("",!0)],6),r("div",GY,[ae.value?(p(),y("div",qY,[...Le[25]||(Le[25]=[r("div",{class:"loading"},"Loading...",-1)])])):!N(d)&&!N(f)?(p(),y("div",jY,[Le[26]||(Le[26]=r("h2",null,"Welcome",-1)),Le[27]||(Le[27]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),N(h)?(p(),y("p",WY,"Authenticating...")):P("",!0)])):N(f)?(p(),y("div",ZY,[Le[28]||(Le[28]=r("h2",null,"Login failed",-1)),r("p",KY,_(N(f)),1),Le[29]||(Le[29]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(p(),y("div",YY,[N(A)||N(T)?(p(),y("div",JY,[r("div",XY,[N(v)?.email?(p(),y("span",QY,_(N(v).email),1)):P("",!0)]),N(A)?(p(),y("div",eJ,[r("button",{onClick:Le[2]||(Le[2]=(...nt)=>N(R)&&N(R)(...nt)),class:"btn-mode-switch"}," Switch to Admin ")])):N(T)?(p(),y("div",tJ,[...Le[30]||(Le[30]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),r("div",nJ,[Pe(pY,{roles:Fe.value,"is-expanded":X.value==="roles",onToggle:Le[3]||(Le[3]=nt=>kn("roles"))},null,8,["roles","is-expanded"]),xn.value.length>0?(p(),Ge(oY,{key:0,ref:"assignmentsSectionRef","is-expanded":X.value==="assignments",assignments:xn.value,"expanded-checkpoint-id":qt.value,"all-locations":Q.value,route:ta.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,"user-location":N(Et),"has-dynamic-assignment":xi.value,"current-marshal-id":N(g),"current-marshal-name":N(k),"checking-in-id":N(Vn),"checking-in-assignment-id":N(wi),"check-in-error":N(Gn),"checking-in-marshal-id":N(Vn),"expanded-marshal-id":Qs.value,"updating-location":N(ao),"auto-update-enabled":N(bo),"get-toolbar-actions":N(Si),"is-area-lead-for-areas":as,"get-notes-for-checkpoint":kl,"area-lead-area-ids":N(b),onToggle:Le[4]||(Le[4]=nt=>kn("assignments")),onToggleCheckpoint:co,onMapClick:Nn,onLocationClick:aa,onActionClick:N(vl),onVisibilityChange:N($t),onUpdateLocation:N(As),onCheckIn:Le[5]||(Le[5]=nt=>N(Wo)(nt,!0)),onToggleMarshal:Zn,onMarshalCheckIn:Le[6]||(Le[6]=(nt,vt)=>N(Wo)(nt,!1,vt)),onToggleAutoUpdate:N(Qe),onShowMarshalQr:Ps},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","route-color","route-style","route-weight","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"])):P("",!0),N(fe).length>0||N(ke).length>0?(p(),Ge(kj,{key:1,loading:N(Be),error:N(Oe),"is-expanded":X.value==="checklist","is-area-lead":N(x),"led-area-count":N(b).length,"my-items":N(fe),"area-items":N(ke),"area-items-with-local-state":N(ne),"visible-items":N(Ze),"grouped-items":N(ct),"completed-count":N(qe),saving:N(xe),"effective-group-by":N(He),"expanded-group":N(me),locations:Q.value,areas:K.value,marshals:N(ye),"get-context-name":N(Nt),onToggle:Le[7]||(Le[7]=nt=>kn("checklist")),onToggleItem:N(Bt),onToggleGroup:N(Lt)},null,8,["loading","error","is-expanded","is-area-lead","led-area-count","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"])):P("",!0),Ne.value.length>0?(p(),Ge(xj,{key:2,"event-id":N(o).params.eventId,notes:Ne.value,locations:Q.value,areas:K.value,assignments:re.value,"is-expanded":X.value==="notes",onToggle:Le[8]||(Le[8]=nt=>kn("notes")),onNotesChanged:za},null,8,["event-id","notes","locations","areas","assignments","is-expanded"])):P("",!0),Ti.value.length>0?(p(),Ge(aq,{key:3,contacts:Ti.value,loading:Pn.value,"is-expanded":X.value==="eventContacts",onToggle:Le[9]||(Le[9]=nt=>kn("eventContacts"))},null,8,["contacts","loading","is-expanded"])):P("",!0),Pe(mq,{incidents:N(Ea),loading:N(Xs),"is-expanded":X.value==="incidents",onToggle:Le[10]||(Le[10]=nt=>kn("incidents")),onSelectIncident:N(ur)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Pe(lZ,{ref_key:"areaLeadSectionRef",ref:Ee,"is-area-lead":N(x),"is-expanded":X.value==="areaLead",areas:E.value,"selected-filters":O.value,"filtered-area-ids":U.value,"event-id":N(o).params.eventId,"marshal-id":N(g),route:ta.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onToggle:Le[11]||(Le[11]=nt=>kn("areaLead")),onToggleFilter:F,onChecklistUpdated:N(ht)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","route-color","route-style","route-weight","onChecklistUpdated"]),Pe(zZ,{"is-area-lead":N(x),"is-expanded":X.value==="areaLeadMarshals",marshals:N(qo),"expanded-marshal-id":N(hl),"checking-in-marshal-id":N(Vn),"saving-task":N(bi),"current-marshal-id":N(g),locations:Q.value,areas:K.value,onToggle:Le[12]||(Le[12]=nt=>kn("areaLeadMarshals")),onToggleMarshal:N(Aa),onCheckIn:N(bt),onToggleTask:N(Es),onShowQr:Ps},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","current-marshal-id","locations","areas","onToggleMarshal","onCheckIn","onToggleTask"]),Pe(Nj,{ref_key:"routeSectionRef",ref:ro,"is-expanded":X.value==="map","user-location":N(Et),"selecting-location":N(Gt),"selecting-location-name":N(mt)?.location?.name||"",locations:ml.value,route:ta.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,center:bl.value,"highlight-location-ids":is.value,clickable:N(Gt)||$i.value,"toolbar-actions":N(ea),onToggle:Le[13]||(Le[13]=nt=>kn("map")),onCancelSelect:dl,onMapClick:Nn,onLocationClick:aa,onActionClick:N(pl),onVisibilityChange:N(Ba)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","route-color","route-style","route-weight","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Pe($q,{"event-date":Z.value?.eventDate,description:Z.value?.description,"is-expanded":X.value==="eventDetails",onToggle:Le[14]||(Le[14]=nt=>kn("eventDetails"))},null,8,["event-date","description","is-expanded"])]),q.value?(p(),y("div",oJ,[...Le[31]||(Le[31]=[r("span",{class:"refresh-spinner"},null,-1),r("span",null,"Updating...",-1)])])):P("",!0),r("div",{class:"logged-in-info",style:tt({color:N(_e)})}," Logged in as "+_(N(k)),5)]))]),Pe(zV,{show:On.value,contacts:Mi.value,notes:Po.value,onClose:Le[15]||(Le[15]=nt=>On.value=!1)},null,8,["show","contacts","notes"]),Pe(A1,{show:N(Rs),"event-id":l.value||"",checkpoint:j.value,"initial-location":N(Et),checkpoints:Q.value,route:ta.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,onClose:Le[16]||(Le[16]=nt=>Rs.value=!1),onSubmit:N(Li)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","route-color","route-style","route-weight","onSubmit"]),Pe(M1,{show:N(Pa),incident:N(_i),route:ta.value,"route-color":Z.value?.routeColor,"route-style":Z.value?.routeStyle,"route-weight":Z.value?.routeWeight,checkpoints:Q.value,"can-manage":N(x),onClose:Le[17]||(Le[17]=nt=>Pa.value=!1),onStatusChange:N(wt),onOpenAddNote:N(Rt)},null,8,["show","incident","route","route-color","route-style","route-weight","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Pe(Yt,{show:N(Da),title:"Add update",size:"small",onClose:N(Ut)},{footer:Ve(()=>[r("div",aJ,[r("button",{type:"button",class:"btn btn-secondary",onClick:Le[19]||(Le[19]=(...nt)=>N(Ut)&&N(Ut)(...nt))}," Cancel "),r("button",{type:"button",class:"btn btn-primary disable-on-load",onClick:Le[20]||(Le[20]=(...nt)=>N(Oa)&&N(Oa)(...nt)),disabled:!N(Ds).trim()||N(Ra)},_(N(Ra)?"Adding...":"Add update"),9,iJ)])]),default:Ve(()=>[r("div",sJ,[We(r("textarea",{"onUpdate:modelValue":Le[18]||(Le[18]=nt=>hn(Ds)?Ds.value=nt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,N(Ds)]])])]),_:1},8,["show","onClose"]),Pe(gi,{show:Bn.value,title:ss.value,message:pt.value,onConfirm:rs,onCancel:pr},null,8,["show","title","message"]),Pe(gi,{show:Co.value,title:Lo.value,message:Cn.value,"show-cancel":!1,onConfirm:sa},null,8,["show","title","message"]),Pe(uG,{show:N(jo),checkpoint:N(os),"accent-button-style":N(Re),onDismiss:Le[21]||(Le[21]=nt=>N(Dt)(N(os)?.id)),onGoToCheckpoint:dr},null,8,["show","checkpoint","accent-button-style"]),Pe(BG,{show:N(Pt),assignment:N(mt),"user-location":N(Et),"auto-update-enabled":N(bo),updating:N(ao),error:N(An),success:N(Ao),"available-checkpoints":Fa.value,"accent-button-style":N(Re),onClose:N(wo),onUpdateGps:N(Se),onToggleAutoUpdate:Le[22]||(Le[22]=nt=>N(Qe)(N(mt))),onSelectOnMap:Vo,onCopyFromCheckpoint:N(lt)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"]),!Wn.value&&!lo.value&&Io.value?(p(),Ge(Gf,{key:0,show:Eo.value,url:Io.value,title:`Magic link for ${en.value}`,warning:`Only share this QR code with ${en.value}. This link provides full access to their ${N(n).person} dashboard.`,"z-index":1100,onClose:Le[23]||(Le[23]=nt=>Eo.value=!1)},null,8,["show","url","title","warning"])):P("",!0),Wn.value||lo.value?(p(),Ge(Yt,{key:1,show:Eo.value,title:`Magic link for ${en.value}`,size:"small","z-index":1100,onClose:Le[24]||(Le[24]=nt=>Eo.value=!1)},{default:Ve(()=>[Wn.value?(p(),y("div",lJ,[...Le[32]||(Le[32]=[r("p",null,"Loading magic link...",-1)])])):lo.value?(p(),y("div",rJ,[r("p",null,_(lo.value),1)])):P("",!0)]),_:1},8,["show","title"])):P("",!0)],4))}},dJ=Ke(uJ,[["__scopeId","data-v-372ef494"]]),hJ={class:"form-group"},fJ={class:"form-group"},pJ={class:"form-group"},vJ={class:"actions-left"},mJ={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const n=e,s=t,o=D({name:"",email:"",phone:""});Ye(()=>n.profile,h=>{h&&(o.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ye(()=>n.show,h=>{h&&n.profile&&(o.value={name:n.profile.name||"",email:n.profile.email||"",phone:n.profile.phone||""})});const i=()=>{s("update:isDirty",!0)},l=()=>{if(!o.value.name.trim()){alert("Name is required");return}if(!o.value.email.trim()){alert("Email is required");return}s("submit",{name:o.value.name.trim(),email:o.value.email.trim(),phone:o.value.phone?.trim()||""})},c=()=>{s("close")},d=()=>{s("logout")};return(h,f)=>(p(),Ge(Yt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ve(()=>[r("div",vJ,[e.showLogout?(p(),y("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):P("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:rt(l,["prevent"])},[r("div",hJ,[f[3]||(f[3]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":f[0]||(f[0]=v=>o.value.name=v),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,o.value.name]])]),r("div",fJ,[f[4]||(f[4]=r("label",null,"Email *",-1)),We(r("input",{"onUpdate:modelValue":f[1]||(f[1]=v=>o.value.email=v),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,o.value.email]])]),r("div",pJ,[f[5]||(f[5]=r("label",null,"Phone",-1)),We(r("input",{"onUpdate:modelValue":f[2]||(f[2]=v=>o.value.phone=v),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,o.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},gJ=Ke(mJ,[["__scopeId","data-v-178e5f48"]]),yJ={class:"tabs"},kJ={class:"tab-content"},bJ={class:"form-group"},wJ={class:"form-group"},_J={class:"form-group"},CJ={class:"form-group"},LJ=["value"],IJ={class:"tab-content"},SJ={class:"emergency-contacts-section"},xJ={key:0,class:"empty-state"},$J={class:"card-header"},TJ=["onClick"],MJ={class:"form-group"},AJ=["onUpdate:modelValue"],EJ={class:"form-group"},PJ=["onUpdate:modelValue"],DJ={class:"form-group"},RJ=["onUpdate:modelValue"],OJ={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const n=e,s=t,{activeTab:o,switchTab:i,resetTab:l}=Qy("basic",["basic","emergency"]),c=D({...n.eventData});Ye(()=>n.eventData,g=>{c.value={...g},c.value.emergencyContacts||(c.value.emergencyContacts=[])},{deep:!0}),Ye(()=>n.show,g=>{g&&l()});const d=()=>{c.value.emergencyContacts.push({name:"",phone:"",details:""})},h=g=>{c.value.emergencyContacts.splice(g,1)},f=()=>{s("submit",{...c.value})},v=()=>{s("close")};return(g,k)=>(p(),Ge(Yt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:v},{"tab-header":Ve(()=>[r("div",yJ,[r("button",{type:"button",onClick:k[0]||(k[0]=b=>N(i)("basic")),class:le(["tab-button",{active:N(o)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=b=>N(i)("emergency")),class:le(["tab-button",{active:N(o)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ve(()=>[r("button",{type:"button",onClick:v,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ve(()=>[r("form",{onSubmit:rt(f,["prevent"])},[We(r("div",kJ,[r("div",bJ,[k[6]||(k[6]=r("label",null,"Event name *",-1)),We(r("input",{"onUpdate:modelValue":k[2]||(k[2]=b=>c.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",wJ,[k[7]||(k[7]=r("label",null,"Description",-1)),We(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=b=>c.value.description=b),rows:"3",class:"form-input"},null,512),[[st,c.value.description]])]),r("div",_J,[k[8]||(k[8]=r("label",null,"Event date *",-1)),We(r("input",{"onUpdate:modelValue":k[4]||(k[4]=b=>c.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,c.value.eventDate]])]),r("div",CJ,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),We(r("select",{"onUpdate:modelValue":k[5]||(k[5]=b=>c.value.timeZoneId=b),required:"",class:"form-input"},[(p(!0),y(Ie,null,je(N(w1),b=>(p(),y("option",{key:b.value,value:b.value},_(b.label),9,LJ))),128))],512),[[no,c.value.timeZoneId]])])],512),[[ns,N(o)==="basic"]]),We(r("div",IJ,[r("div",SJ,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),c.value.emergencyContacts.length===0?(p(),y("div",xJ,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(p(!0),y(Ie,null,je(c.value.emergencyContacts,(b,x)=>(p(),y("div",{key:x,class:"emergency-contact-card"},[r("div",$J,[r("h4",null,"Contact "+_(x+1),1),r("button",{type:"button",onClick:A=>h(x),class:"btn-remove"},"  ",8,TJ)]),r("div",MJ,[k[12]||(k[12]=r("label",null,"Name *",-1)),We(r("input",{"onUpdate:modelValue":A=>b.name=A,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,AJ),[[st,b.name]])]),r("div",EJ,[k[13]||(k[13]=r("label",null,"Phone *",-1)),We(r("input",{"onUpdate:modelValue":A=>b.phone=A,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,PJ),[[st,b.phone]])]),r("div",DJ,[k[14]||(k[14]=r("label",null,"Additional details",-1)),We(r("textarea",{"onUpdate:modelValue":A=>b.details=A,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,RJ),[[st,b.details]])])]))),128))])],512),[[ns,N(o)==="emergency"]])],32)]),_:1},8,["show","title"]))}},BJ=Ke(OJ,[["__scopeId","data-v-d820eb4f"]]),NJ=$f("profile",()=>{const e=D(null),t=D(!1),n=D(null);return{profile:e,loading:t,error:n,fetchProfile:async()=>{t.value=!0,n.value=null;try{const d=await Uc.getProfile();return e.value=d.data,d.data}catch(d){throw n.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,n.value=null;try{const h=await Uc.updateProfile(d);return e.value=h.data,h.data}catch(h){throw n.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,n.value=null;try{return(await Uc.getPerson(d,h)).data}catch(f){throw n.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,n.value=null;try{return(await Uc.updatePerson(d,h,f)).data}catch(v){throw n.value=v.response?.data?.message||"Failed to update person",v}finally{t.value=!1}},clearProfile:()=>{e.value=null,n.value=null}}}),FJ={class:"sessions-view"},UJ={class:"sessions-container"},zJ={key:0,class:"loading-state"},HJ={key:1,class:"empty-state"},VJ={key:2,class:"sessions-list"},GJ={class:"section-header"},qJ={class:"section-actions"},jJ=["onClick"],WJ={class:"session-info"},ZJ={class:"event-name"},KJ={key:0,class:"event-date"},YJ={key:1,class:"sign-in-section"},JJ={key:2,class:"section-header"},XJ=["onClick"],QJ={class:"session-info"},eX={class:"event-name"},tX={class:"role-name"},nX={key:0,class:"event-date"},oX=["onClick"],sX={class:"modal-card"},aX={class:"modal-actions"},iX={class:"modal-card"},lX={class:"modal-actions"},rX={__name:"SessionsView",setup(e){const t=ir(),n=gc(),s=Xy(),o=NJ(),i=D([]),l=D([]),c=D(!0),d=D(!1),h=D(!1),f=D(!1),v=D(!1),g=D(null),k=D(!1),b=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),x=H(()=>localStorage.getItem("adminEmail")),A=H(()=>!!x.value),T=()=>{i.value=Gw()},w=ae=>{my(ae.eventId,ae.marshalId),t.push(`/event/${ae.eventId}`)},C=ae=>{g.value=ae,f.value=!0},I=async()=>{if(!g.value)return;const{sessionKey:ae,eventId:q}=g.value;try{Bo("marshal",q),await authApi.logout()}catch{}zh(ae),Bo(null),T(),f.value=!1,g.value=null},$=()=>{v.value=!0},R=async()=>{await n.logout(),l.value=[],v.value=!1},M=async()=>{if(h.value=!0,!o.profile)try{await o.fetchProfile()}catch(ae){console.error("Failed to load profile:",ae)}},O=async ae=>{try{await o.updateProfile(ae),h.value=!1}catch(q){console.error("Failed to save profile:",q),alert("Failed to save profile. Please try again.")}},E=async()=>{await n.logout(),l.value=[],h.value=!1},U=ae=>ae?new Date(ae).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",F=async()=>{if(A.value)try{Bo("admin");const ae=await li.getAll();l.value=ae.data||[]}catch(ae){console.error("Failed to load admin events:",ae),l.value=[]}},j=ae=>{t.push(`/admin/event/${ae}`)},Z=()=>{t.push("/")},Q=()=>{},re=()=>{k.value=!1,b.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},K=async ae=>{try{const q={...ae,adminEmail:n.adminEmail};await s.createEvent(q),re(),await F()}catch(q){console.error("Failed to create event:",q),alert("Failed to create event. Please try again.")}};return un(async()=>{document.title="OnTheDay App - Sessions",yy(),gy(),T(),await F(),c.value=!1}),(ae,q)=>(p(),y("div",FJ,[r("div",UJ,[Pe(Zy,{title:"Your sessions"}),c.value?(p(),y("div",zJ,[...q[9]||(q[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(p(),y("div",HJ,[q[10]||(q[10]=r("p",null,"No active sessions.",-1)),q[11]||(q[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:q[0]||(q[0]=J=>d.value=!0)}," Sign in ")])):(p(),y("div",VJ,[A.value?(p(),y(Ie,{key:0},[r("div",GJ,[q[12]||(q[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",qJ,[r("button",{class:"btn btn-small btn-primary",onClick:M}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:q[1]||(q[1]=J=>k.value=!0)}," Create event ")])]),(p(!0),y(Ie,null,je(l.value,J=>(p(),y("div",{key:"admin-"+J.id,class:"session-card admin-card",onClick:ee=>j(J.id)},[q[14]||(q[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",WJ,[r("div",ZJ,_(J.name),1),q[13]||(q[13]=r("div",{class:"role-name"},"Admin",-1)),J.eventDate?(p(),y("div",KJ,_(U(J.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:rt($,["stop"]),title:"Log out as admin"},"  ")],8,jJ))),128))],64)):(p(),y("div",YJ,[r("button",{class:"btn btn-primary",onClick:q[2]||(q[2]=J=>d.value=!0)}," Sign in ")])),i.value.length>0?(p(),y("div",JJ,[...q[15]||(q[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):P("",!0),(p(!0),y(Ie,null,je(i.value,J=>(p(),y("div",{key:J.sessionKey,class:"session-card",onClick:ee=>w(J)},[q[16]||(q[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",QJ,[r("div",eX,_(J.eventName||"Event"),1),r("div",tX,_(J.marshalName||"Marshal"),1),J.eventDate?(p(),y("div",nX,_(U(J.eventDate)),1)):P("",!0)]),r("button",{class:"btn-logout",onClick:rt(ee=>C(J),["stop"]),title:"Log out from this session"},"  ",8,oX)],8,XJ))),128))])),r("button",{class:"btn-back-home",onClick:Z,title:"Back to home"},"  ")]),Pe(Ky,{show:d.value,onClose:q[3]||(q[3]=J=>d.value=!1),onSuccess:Q},null,8,["show"]),Pe(gJ,{show:h.value,profile:N(o).profile,"show-logout":!0,onClose:q[4]||(q[4]=J=>h.value=!1),onSubmit:O,onLogout:E},null,8,["show","profile"]),Pe(BJ,{show:k.value,"event-data":b.value,"is-editing":!1,onClose:re,onSubmit:K},null,8,["show","event-data"]),(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[v.value?(p(),y("div",{key:0,class:"modal-overlay",onClick:q[6]||(q[6]=rt(J=>v.value=!1,["self"]))},[r("div",sX,[q[17]||(q[17]=r("h3",null,"Log out as admin?",-1)),q[18]||(q[18]=r("p",null,"This will log you out from all admin events.",-1)),q[19]||(q[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",aX,[r("button",{class:"btn btn-secondary",onClick:q[5]||(q[5]=J=>v.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:R},"Log out")])])])):P("",!0)]),_:1})])),(p(),Ge(ec,{to:"body"},[Pe(Ls,{name:"modal"},{default:Ve(()=>[f.value?(p(),y("div",{key:0,class:"modal-overlay",onClick:q[8]||(q[8]=rt(J=>f.value=!1,["self"]))},[r("div",iX,[q[22]||(q[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[q[20]||(q[20]=Je("This will log you out from ",-1)),r("strong",null,_(g.value?.eventName||"this event"),1),q[21]||(q[21]=Je(".",-1))]),q[23]||(q[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",lX,[r("button",{class:"btn btn-secondary",onClick:q[7]||(q[7]=J=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:I},"Log out")])])])):P("",!0)]),_:1})]))]))}},cX=Ke(rX,[["__scopeId","data-v-add55e1c"]]);let $m=!1;function uX(){$m||($m=!0,yy(),gy())}const dX=[{path:"/",name:"Home",component:QC},{path:"/admin/login",name:"AdminLogin",component:l2},{path:"/admin/verify",name:"AdminVerify",component:p2},{path:"/sessions",name:"Sessions",component:cX},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:CV,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:dJ},{path:"/:pathMatch(.*)*",redirect:"/"}],D1=$w({history:iw("/VolunteerCheckin/testing/"),routes:dX});D1.beforeEach((e,t,n)=>{uX();const s=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!s){n({name:"AdminLogin"});return}if(e.meta.requiresAuth?Bo("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&Bo(null),e.name==="MarshalView"){const o=e.params.eventId,i=!!e.query.code,l=bu(o),c=l?.marshalId?by(o,l.marshalId):null;if(i){n();return}if(l?.token){n();return}if(c){n();return}if(ky()){n({name:"Sessions"});return}}n()});$a().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Zf=fb(Hw);Zf.use(mb());Zf.use(D1);Zf.mount("#app");
