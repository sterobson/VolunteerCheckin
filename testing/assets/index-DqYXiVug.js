(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();function Nu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Vt={},Ni=[],Xo=()=>{},Sf=()=>!1,Xr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Fu=e=>e.startsWith("onUpdate:"),yn=Object.assign,Uu=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},xm=Object.prototype.hasOwnProperty,Dt=(e,t)=>xm.call(e,t),lt=Array.isArray,Fi=e=>Gl(e)==="[object Map]",Wi=e=>Gl(e)==="[object Set]",Pd=e=>Gl(e)==="[object Date]",pt=e=>typeof e=="function",Xt=e=>typeof e=="string",ts=e=>typeof e=="symbol",Ft=e=>e!==null&&typeof e=="object",If=e=>(Ft(e)||pt(e))&&pt(e.then)&&pt(e.catch),xf=Object.prototype.toString,Gl=e=>xf.call(e),$m=e=>Gl(e).slice(8,-1),$f=e=>Gl(e)==="[object Object]",Qr=e=>Xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,_l=Nu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ec=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Tm=/-\w/g,Ro=ec(e=>e.replace(Tm,t=>t.slice(1).toUpperCase())),Mm=/\B([A-Z])/g,Ta=ec(e=>e.replace(Mm,"-$1").toLowerCase()),tc=ec(e=>e.charAt(0).toUpperCase()+e.slice(1)),Oc=ec(e=>e?`on${tc(e)}`:""),Ca=(e,t)=>!Object.is(e,t),_r=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},Tf=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},nc=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Am=e=>{const t=Xt(e)?Number(e):NaN;return isNaN(t)?e:t};let Dd;const oc=()=>Dd||(Dd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function et(e){if(lt(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],s=Xt(a)?Om(a):et(a);if(s)for(const i in s)t[i]=s[i]}return t}else if(Xt(e)||Ft(e))return e}const Em=/;(?![^(]*\))/g,Pm=/:([^]+)/,Dm=/\/\*[^]*?\*\//g;function Om(e){const t={};return e.replace(Dm,"").split(Em).forEach(o=>{if(o){const a=o.split(Pm);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ve(e){let t="";if(Xt(e))t=e;else if(lt(e))for(let o=0;o<e.length;o++){const a=ve(e[o]);a&&(t+=a+" ")}else if(Ft(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Rm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Bm=Nu(Rm);function Mf(e){return!!e||e===""}function Nm(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=ri(e[a],t[a]);return o}function ri(e,t){if(e===t)return!0;let o=Pd(e),a=Pd(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=ts(e),a=ts(t),o||a)return e===t;if(o=lt(e),a=lt(t),o||a)return o&&a?Nm(e,t):!1;if(o=Ft(e),a=Ft(t),o||a){if(!o||!a)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const r in e){const u=e.hasOwnProperty(r),d=t.hasOwnProperty(r);if(u&&!d||!u&&d||!ri(e[r],t[r]))return!1}}return String(e)===String(t)}function zu(e,t){return e.findIndex(o=>ri(o,t))}const Af=e=>!!(e&&e.__v_isRef===!0),w=e=>Xt(e)?e:e==null?"":lt(e)||Ft(e)&&(e.toString===xf||!pt(e.toString))?Af(e)?w(e.value):JSON.stringify(e,Ef,2):String(e),Ef=(e,t)=>Af(t)?Ef(e,t.value):Fi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,s],i)=>(o[Rc(a,i)+" =>"]=s,o),{})}:Wi(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Rc(o))}:ts(t)?Rc(t):Ft(t)&&!lt(t)&&!$f(t)?String(t):t,Rc=(e,t="")=>{var o;return ts(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function Fm(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Dn;class Pf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Dn,!t&&Dn&&(this.index=(Dn.scopes||(Dn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Dn;try{return Dn=this,t()}finally{Dn=o}}}on(){++this._on===1&&(this.prevScope=Dn,Dn=this)}off(){this._on>0&&--this._on===0&&(Dn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Df(e){return new Pf(e)}function Of(){return Dn}function Um(e,t=!1){Dn&&Dn.cleanups.push(e)}let Zt;const Bc=new WeakSet;class Rf{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Dn&&Dn.active&&Dn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bc.has(this)&&(Bc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Nf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Od(this),Ff(this);const t=Zt,o=Qo;Zt=this,Qo=!0;try{return this.fn()}finally{Uf(this),Zt=t,Qo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Gu(t);this.deps=this.depsTail=void 0,Od(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){su(this)&&this.run()}get dirty(){return su(this)}}let Bf=0,bl,wl;function Nf(e,t=!1){if(e.flags|=8,t){e.next=wl,wl=e;return}e.next=bl,bl=e}function Hu(){Bf++}function Vu(){if(--Bf>0)return;if(wl){let t=wl;for(wl=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;bl;){let t=bl;for(bl=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Ff(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Uf(e){let t,o=e.depsTail,a=o;for(;a;){const s=a.prevDep;a.version===-1?(a===o&&(o=s),Gu(a),zm(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=s}e.deps=t,e.depsTail=o}function su(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(zf(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function zf(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===El)||(e.globalVersion=El,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!su(e))))return;e.flags|=2;const t=e.dep,o=Zt,a=Qo;Zt=e,Qo=!0;try{Ff(e);const s=e.fn(e._value);(t.version===0||Ca(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Zt=o,Qo=a,Uf(e),e.flags&=-3}}function Gu(e,t=!1){const{dep:o,prevSub:a,nextSub:s}=e;if(a&&(a.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)Gu(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function zm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Qo=!0;const Hf=[];function zs(){Hf.push(Qo),Qo=!1}function Hs(){const e=Hf.pop();Qo=e===void 0?!0:e}function Od(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Zt;Zt=void 0;try{t()}finally{Zt=o}}}let El=0;class Hm{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ju{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Zt||!Qo||Zt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Zt)o=this.activeLink=new Hm(Zt,this),Zt.deps?(o.prevDep=Zt.depsTail,Zt.depsTail.nextDep=o,Zt.depsTail=o):Zt.deps=Zt.depsTail=o,Vf(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Zt.depsTail,o.nextDep=void 0,Zt.depsTail.nextDep=o,Zt.depsTail=o,Zt.deps===o&&(Zt.deps=a)}return o}trigger(t){this.version++,El++,this.notify(t)}notify(t){Hu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Vu()}}}function Vf(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Vf(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Tr=new WeakMap,si=Symbol(""),au=Symbol(""),Pl=Symbol("");function Rn(e,t,o){if(Qo&&Zt){let a=Tr.get(e);a||Tr.set(e,a=new Map);let s=a.get(o);s||(a.set(o,s=new ju),s.map=a,s.key=o),s.track()}}function Ds(e,t,o,a,s,i){const r=Tr.get(e);if(!r){El++;return}const u=d=>{d&&d.trigger()};if(Hu(),t==="clear")r.forEach(u);else{const d=lt(e),h=d&&Qr(o);if(d&&o==="length"){const p=Number(a);r.forEach((g,y)=>{(y==="length"||y===Pl||!ts(y)&&y>=p)&&u(g)})}else switch((o!==void 0||r.has(void 0))&&u(r.get(o)),h&&u(r.get(Pl)),t){case"add":d?h&&u(r.get("length")):(u(r.get(si)),Fi(e)&&u(r.get(au)));break;case"delete":d||(u(r.get(si)),Fi(e)&&u(r.get(au)));break;case"set":Fi(e)&&u(r.get(si));break}}Vu()}function Vm(e,t){const o=Tr.get(e);return o&&o.get(t)}function Ai(e){const t=Mt(e);return t===e?t:(Rn(t,"iterate",Pl),So(e)?t:t.map(ns))}function sc(e){return Rn(e=Mt(e),"iterate",Pl),e}function va(e,t){return Vs(e)?Us(e)?Vi(ns(t)):Vi(t):ns(t)}const Gm={__proto__:null,[Symbol.iterator](){return Nc(this,Symbol.iterator,e=>va(this,e))},concat(...e){return Ai(this).concat(...e.map(t=>lt(t)?Ai(t):t))},entries(){return Nc(this,"entries",e=>(e[1]=va(this,e[1]),e))},every(e,t){return Ts(this,"every",e,t,void 0,arguments)},filter(e,t){return Ts(this,"filter",e,t,o=>o.map(a=>va(this,a)),arguments)},find(e,t){return Ts(this,"find",e,t,o=>va(this,o),arguments)},findIndex(e,t){return Ts(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Ts(this,"findLast",e,t,o=>va(this,o),arguments)},findLastIndex(e,t){return Ts(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Ts(this,"forEach",e,t,void 0,arguments)},includes(...e){return Fc(this,"includes",e)},indexOf(...e){return Fc(this,"indexOf",e)},join(e){return Ai(this).join(e)},lastIndexOf(...e){return Fc(this,"lastIndexOf",e)},map(e,t){return Ts(this,"map",e,t,void 0,arguments)},pop(){return dl(this,"pop")},push(...e){return dl(this,"push",e)},reduce(e,...t){return Rd(this,"reduce",e,t)},reduceRight(e,...t){return Rd(this,"reduceRight",e,t)},shift(){return dl(this,"shift")},some(e,t){return Ts(this,"some",e,t,void 0,arguments)},splice(...e){return dl(this,"splice",e)},toReversed(){return Ai(this).toReversed()},toSorted(e){return Ai(this).toSorted(e)},toSpliced(...e){return Ai(this).toSpliced(...e)},unshift(...e){return dl(this,"unshift",e)},values(){return Nc(this,"values",e=>va(this,e))}};function Nc(e,t,o){const a=sc(e),s=a[t]();return a!==e&&!So(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=o(i.value)),i}),s}const jm=Array.prototype;function Ts(e,t,o,a,s,i){const r=sc(e),u=r!==e&&!So(e),d=r[t];if(d!==jm[t]){const g=d.apply(e,i);return u?ns(g):g}let h=o;r!==e&&(u?h=function(g,y){return o.call(this,va(e,g),y,e)}:o.length>2&&(h=function(g,y){return o.call(this,g,y,e)}));const p=d.call(r,h,a);return u&&s?s(p):p}function Rd(e,t,o,a){const s=sc(e);let i=o;return s!==e&&(So(e)?o.length>3&&(i=function(r,u,d){return o.call(this,r,u,d,e)}):i=function(r,u,d){return o.call(this,r,va(e,u),d,e)}),s[t](i,...a)}function Fc(e,t,o){const a=Mt(e);Rn(a,"iterate",Pl);const s=a[t](...o);return(s===-1||s===!1)&&ac(o[0])?(o[0]=Mt(o[0]),a[t](...o)):s}function dl(e,t,o=[]){zs(),Hu();const a=Mt(e)[t].apply(e,o);return Vu(),Hs(),a}const Zm=Nu("__proto__,__v_isRef,__isVue"),Gf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ts));function qm(e){ts(e)||(e=String(e));const t=Mt(this);return Rn(t,"has",e),t.hasOwnProperty(e)}class jf{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(s?i?og:Kf:i?Wf:qf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const r=lt(t);if(!s){let d;if(r&&(d=Gm[o]))return d;if(o==="hasOwnProperty")return qm}const u=Reflect.get(t,o,Yt(t)?t:a);if((ts(o)?Gf.has(o):Zm(o))||(s||Rn(t,"get",o),i))return u;if(Yt(u)){const d=r&&Qr(o)?u:u.value;return s&&Ft(d)?lu(d):d}return Ft(u)?s?lu(u):ui(u):u}}class Zf extends jf{constructor(t=!1){super(!1,t)}set(t,o,a,s){let i=t[o];const r=lt(t)&&Qr(o);if(!this._isShallow){const h=Vs(i);if(!So(a)&&!Vs(a)&&(i=Mt(i),a=Mt(a)),!r&&Yt(i)&&!Yt(a))return h||(i.value=a),!0}const u=r?Number(o)<t.length:Dt(t,o),d=Reflect.set(t,o,a,Yt(t)?t:s);return t===Mt(s)&&(u?Ca(a,i)&&Ds(t,"set",o,a):Ds(t,"add",o,a)),d}deleteProperty(t,o){const a=Dt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&a&&Ds(t,"delete",o,void 0),s}has(t,o){const a=Reflect.has(t,o);return(!ts(o)||!Gf.has(o))&&Rn(t,"has",o),a}ownKeys(t){return Rn(t,"iterate",lt(t)?"length":si),Reflect.ownKeys(t)}}class Wm extends jf{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Km=new Zf,Jm=new Wm,Ym=new Zf(!0);const iu=e=>e,dr=e=>Reflect.getPrototypeOf(e);function Xm(e,t,o){return function(...a){const s=this.__v_raw,i=Mt(s),r=Fi(i),u=e==="entries"||e===Symbol.iterator&&r,d=e==="keys"&&r,h=s[e](...a),p=o?iu:t?Vi:ns;return!t&&Rn(i,"iterate",d?au:si),{next(){const{value:g,done:y}=h.next();return y?{value:g,done:y}:{value:u?[p(g[0]),p(g[1])]:p(g),done:y}},[Symbol.iterator](){return this}}}}function hr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Qm(e,t){const o={get(s){const i=this.__v_raw,r=Mt(i),u=Mt(s);e||(Ca(s,u)&&Rn(r,"get",s),Rn(r,"get",u));const{has:d}=dr(r),h=t?iu:e?Vi:ns;if(d.call(r,s))return h(i.get(s));if(d.call(r,u))return h(i.get(u));i!==r&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Rn(Mt(s),"iterate",si),s.size},has(s){const i=this.__v_raw,r=Mt(i),u=Mt(s);return e||(Ca(s,u)&&Rn(r,"has",s),Rn(r,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)},forEach(s,i){const r=this,u=r.__v_raw,d=Mt(u),h=t?iu:e?Vi:ns;return!e&&Rn(d,"iterate",si),u.forEach((p,g)=>s.call(i,h(p),h(g),r))}};return yn(o,e?{add:hr("add"),set:hr("set"),delete:hr("delete"),clear:hr("clear")}:{add(s){!t&&!So(s)&&!Vs(s)&&(s=Mt(s));const i=Mt(this);return dr(i).has.call(i,s)||(i.add(s),Ds(i,"add",s,s)),this},set(s,i){!t&&!So(i)&&!Vs(i)&&(i=Mt(i));const r=Mt(this),{has:u,get:d}=dr(r);let h=u.call(r,s);h||(s=Mt(s),h=u.call(r,s));const p=d.call(r,s);return r.set(s,i),h?Ca(i,p)&&Ds(r,"set",s,i):Ds(r,"add",s,i),this},delete(s){const i=Mt(this),{has:r,get:u}=dr(i);let d=r.call(i,s);d||(s=Mt(s),d=r.call(i,s)),u&&u.call(i,s);const h=i.delete(s);return d&&Ds(i,"delete",s,void 0),h},clear(){const s=Mt(this),i=s.size!==0,r=s.clear();return i&&Ds(s,"clear",void 0,void 0),r}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=Xm(s,e,t)}),o}function Zu(e,t){const o=Qm(e,t);return(a,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?a:Reflect.get(Dt(o,s)&&s in a?o:a,s,i)}const eg={get:Zu(!1,!1)},tg={get:Zu(!1,!0)},ng={get:Zu(!0,!1)};const qf=new WeakMap,Wf=new WeakMap,Kf=new WeakMap,og=new WeakMap;function sg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ag(e){return e.__v_skip||!Object.isExtensible(e)?0:sg($m(e))}function ui(e){return Vs(e)?e:qu(e,!1,Km,eg,qf)}function Jf(e){return qu(e,!1,Ym,tg,Wf)}function lu(e){return qu(e,!0,Jm,ng,Kf)}function qu(e,t,o,a,s){if(!Ft(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=ag(e);if(i===0)return e;const r=s.get(e);if(r)return r;const u=new Proxy(e,i===2?a:o);return s.set(e,u),u}function Us(e){return Vs(e)?Us(e.__v_raw):!!(e&&e.__v_isReactive)}function Vs(e){return!!(e&&e.__v_isReadonly)}function So(e){return!!(e&&e.__v_isShallow)}function ac(e){return e?!!e.__v_raw:!1}function Mt(e){const t=e&&e.__v_raw;return t?Mt(t):e}function Wu(e){return!Dt(e,"__v_skip")&&Object.isExtensible(e)&&Tf(e,"__v_skip",!0),e}const ns=e=>Ft(e)?ui(e):e,Vi=e=>Ft(e)?lu(e):e;function Yt(e){return e?e.__v_isRef===!0:!1}function M(e){return Yf(e,!1)}function ig(e){return Yf(e,!0)}function Yf(e,t){return Yt(e)?e:new lg(e,t)}class lg{constructor(t,o){this.dep=new ju,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Mt(t),this._value=o?t:ns(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||So(t)||Vs(t);t=a?t:Mt(t),Ca(t,o)&&(this._rawValue=t,this._value=a?t:ns(t),this.dep.trigger())}}function D(e){return Yt(e)?e.value:e}function Mr(e){return pt(e)?e():D(e)}const rg={get:(e,t,o)=>t==="__v_raw"?e:D(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const s=e[t];return Yt(s)&&!Yt(o)?(s.value=o,!0):Reflect.set(e,t,o,a)}};function Xf(e){return Us(e)?e:new Proxy(e,rg)}function cg(e){const t=lt(e)?new Array(e.length):{};for(const o in e)t[o]=dg(e,o);return t}class ug{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Mt(t);let s=!0,i=t;if(!lt(t)||!Qr(String(o)))do s=!ac(i)||So(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=D(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Yt(this._raw[this._key])){const o=this._object[this._key];if(Yt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Vm(this._raw,this._key)}}function dg(e,t,o){return new ug(e,t,o)}class hg{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new ju(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=El-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Zt!==this)return Nf(this,!0),!0}get value(){const t=this.dep.track();return zf(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function fg(e,t,o=!1){let a,s;return pt(e)?a=e:(a=e.get,s=e.set),new hg(a,s,o)}const fr={},Ar=new WeakMap;let Ya;function pg(e,t=!1,o=Ya){if(o){let a=Ar.get(o);a||Ar.set(o,a=[]),a.push(e)}}function vg(e,t,o=Vt){const{immediate:a,deep:s,once:i,scheduler:r,augmentJob:u,call:d}=o,h=B=>s?B:So(B)||s===!1||s===0?Os(B,1):Os(B);let p,g,y,_,b=!1,C=!1;if(Yt(e)?(g=()=>e.value,b=So(e)):Us(e)?(g=()=>h(e),b=!0):lt(e)?(C=!0,b=e.some(B=>Us(B)||So(B)),g=()=>e.map(B=>{if(Yt(B))return B.value;if(Us(B))return h(B);if(pt(B))return d?d(B,2):B()})):pt(e)?t?g=d?()=>d(e,2):e:g=()=>{if(y){zs();try{y()}finally{Hs()}}const B=Ya;Ya=p;try{return d?d(e,3,[_]):e(_)}finally{Ya=B}}:g=Xo,t&&s){const B=g,E=s===!0?1/0:s;g=()=>Os(B(),E)}const I=Of(),$=()=>{p.stop(),I&&I.active&&Uu(I.effects,p)};if(i&&t){const B=t;t=(...E)=>{B(...E),$()}}let x=C?new Array(e.length).fill(fr):fr;const S=B=>{if(!(!(p.flags&1)||!p.dirty&&!B))if(t){const E=p.run();if(s||b||(C?E.some((q,P)=>Ca(q,x[P])):Ca(E,x))){y&&y();const q=Ya;Ya=p;try{const P=[E,x===fr?void 0:C&&x[0]===fr?[]:x,_];x=E,d?d(t,3,P):t(...P)}finally{Ya=q}}}else p.run()};return u&&u(S),p=new Rf(g),p.scheduler=r?()=>r(S,!1):S,_=B=>pg(B,!1,p),y=p.onStop=()=>{const B=Ar.get(p);if(B){if(d)d(B,4);else for(const E of B)E();Ar.delete(p)}},t?a?S(!0):x=p.run():r?r(S.bind(null,!0),!0):p.run(),$.pause=p.pause.bind(p),$.resume=p.resume.bind(p),$.stop=$,$}function Os(e,t=1/0,o){if(t<=0||!Ft(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Yt(e))Os(e.value,t,o);else if(lt(e))for(let a=0;a<e.length;a++)Os(e[a],t,o);else if(Wi(e)||Fi(e))e.forEach(a=>{Os(a,t,o)});else if($f(e)){for(const a in e)Os(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Os(e[a],t,o)}return e}function jl(e,t,o,a){try{return a?e(...a):e()}catch(s){ic(s,t,o)}}function os(e,t,o,a){if(pt(e)){const s=jl(e,t,o,a);return s&&If(s)&&s.catch(i=>{ic(i,t,o)}),s}if(lt(e)){const s=[];for(let i=0;i<e.length;i++)s.push(os(e[i],t,o,a));return s}}function ic(e,t,o,a=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||Vt;if(t){let u=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,d,h)===!1)return}u=u.parent}if(i){zs(),jl(i,null,10,[e,d,h]),Hs();return}}mg(e,o,s,a,r)}function mg(e,t,o,a=!0,s=!1){if(s)throw e;console.error(e)}const Kn=[];let hs=-1;const Ui=[];let ma=null,Pi=0;const Qf=Promise.resolve();let Er=null;function sn(e){const t=Er||Qf;return e?t.then(this?e.bind(this):e):t}function gg(e){let t=hs+1,o=Kn.length;for(;t<o;){const a=t+o>>>1,s=Kn[a],i=Dl(s);i<e||i===e&&s.flags&2?t=a+1:o=a}return t}function Ku(e){if(!(e.flags&1)){const t=Dl(e),o=Kn[Kn.length-1];!o||!(e.flags&2)&&t>=Dl(o)?Kn.push(e):Kn.splice(gg(t),0,e),e.flags|=1,ep()}}function ep(){Er||(Er=Qf.then(op))}function tp(e){lt(e)?Ui.push(...e):ma&&e.id===-1?ma.splice(Pi+1,0,e):e.flags&1||(Ui.push(e),e.flags|=1),ep()}function Bd(e,t,o=hs+1){for(;o<Kn.length;o++){const a=Kn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Kn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function np(e){if(Ui.length){const t=[...new Set(Ui)].sort((o,a)=>Dl(o)-Dl(a));if(Ui.length=0,ma){ma.push(...t);return}for(ma=t,Pi=0;Pi<ma.length;Pi++){const o=ma[Pi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}ma=null,Pi=0}}const Dl=e=>e.id==null?e.flags&2?-1:1/0:e.id;function op(e){try{for(hs=0;hs<Kn.length;hs++){const t=Kn[hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),jl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hs<Kn.length;hs++){const t=Kn[hs];t&&(t.flags&=-2)}hs=-1,Kn.length=0,np(),Er=null,(Kn.length||Ui.length)&&op()}}let xn=null,sp=null;function Pr(e){const t=xn;return xn=e,sp=e&&e.type.__scopeId||null,t}function He(e,t=xn,o){if(!t||e._n)return e;const a=(...s)=>{a._d&&Rr(-1);const i=Pr(t);let r;try{r=e(...s)}finally{Pr(i),a._d&&Rr(1)}return r};return a._n=!0,a._c=!0,a._d=!0,a}function ze(e,t){if(xn===null)return e;const o=hc(xn),a=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,r,u,d=Vt]=t[s];i&&(pt(i)&&(i={mounted:i,updated:i}),i.deep&&Os(r),a.push({dir:i,instance:o,value:r,oldValue:void 0,arg:u,modifiers:d}))}return e}function Za(e,t,o,a){const s=e.dirs,i=t&&t.dirs;for(let r=0;r<s.length;r++){const u=s[r];i&&(u.oldValue=i[r].value);let d=u.dir[a];d&&(zs(),os(d,o,8,[e.el,u,e,t]),Hs())}}function Cl(e,t){if(Nn){let o=Nn.provides;const a=Nn.parent&&Nn.parent.provides;a===o&&(o=Nn.provides=Object.create(a)),o[e]=t}}function uo(e,t,o=!1){const a=dc();if(a||ai){let s=ai?ai._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&pt(t)?t.call(a&&a.proxy):t}}function yg(){return!!(dc()||ai)}const kg=Symbol.for("v-scx"),_g=()=>uo(kg);function Ze(e,t,o){return ap(e,t,o)}function ap(e,t,o=Vt){const{immediate:a,deep:s,flush:i,once:r}=o,u=yn({},o),d=t&&a||!t&&i!=="post";let h;if(Fl){if(i==="sync"){const _=_g();h=_.__watcherHandles||(_.__watcherHandles=[])}else if(!d){const _=()=>{};return _.stop=Xo,_.resume=Xo,_.pause=Xo,_}}const p=Nn;u.call=(_,b,C)=>os(_,p,b,C);let g=!1;i==="post"?u.scheduler=_=>{qn(_,p&&p.suspense)}:i!=="sync"&&(g=!0,u.scheduler=(_,b)=>{b?_():Ku(_)}),u.augmentJob=_=>{t&&(_.flags|=4),g&&(_.flags|=2,p&&(_.id=p.uid,_.i=p))};const y=vg(e,t,u);return Fl&&(h?h.push(y):d&&y()),y}function bg(e,t,o){const a=this.proxy,s=Xt(e)?e.includes(".")?ip(a,e):()=>a[e]:e.bind(a,a);let i;pt(t)?i=t:(i=t.handler,o=t);const r=Zl(this),u=ap(s,i.bind(a),o);return r(),u}function ip(e,t){const o=t.split(".");return()=>{let a=e;for(let s=0;s<o.length&&a;s++)a=a[o[s]];return a}}const lp=Symbol("_vte"),rp=e=>e.__isTeleport,Ll=e=>e&&(e.disabled||e.disabled===""),Nd=e=>e&&(e.defer||e.defer===""),Fd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Ud=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,ru=(e,t)=>{const o=e&&e.to;return Xt(o)?t?t(o):null:o},cp={name:"Teleport",__isTeleport:!0,process(e,t,o,a,s,i,r,u,d,h){const{mc:p,pc:g,pbc:y,o:{insert:_,querySelector:b,createText:C,createComment:I}}=h,$=Ll(t.props);let{shapeFlag:x,children:S,dynamicChildren:B}=t;if(e==null){const E=t.el=C(""),q=t.anchor=C("");_(E,o,a),_(q,o,a);const P=(R,j)=>{x&16&&p(S,R,j,s,i,r,u,d)},F=()=>{const R=t.target=ru(t.props,b),j=up(R,t,C,_);R&&(r!=="svg"&&Fd(R)?r="svg":r!=="mathml"&&Ud(R)&&(r="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(R),$||(P(R,j),br(t,!1)))};$&&(P(o,q),br(t,!0)),Nd(t.props)?(t.el.__isMounted=!1,qn(()=>{F(),delete t.el.__isMounted},i)):F()}else{if(Nd(t.props)&&e.el.__isMounted===!1){qn(()=>{cp.process(e,t,o,a,s,i,r,u,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const E=t.anchor=e.anchor,q=t.target=e.target,P=t.targetAnchor=e.targetAnchor,F=Ll(e.props),R=F?o:q,j=F?E:P;if(r==="svg"||Fd(q)?r="svg":(r==="mathml"||Ud(q))&&(r="mathml"),B?(y(e.dynamicChildren,B,R,s,i,r,u),Qu(e,t,!0)):d||g(e,t,R,j,s,i,r,u,!1),$)F?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):pr(t,o,E,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const O=t.target=ru(t.props,b);O&&pr(t,O,null,h,0)}else F&&pr(t,q,P,h,1);br(t,$)}},remove(e,t,o,{um:a,o:{remove:s}},i){const{shapeFlag:r,children:u,anchor:d,targetStart:h,targetAnchor:p,target:g,props:y}=e;if(g&&(s(h),s(p)),i&&s(d),r&16){const _=i||!Ll(y);for(let b=0;b<u.length;b++){const C=u[b];a(C,t,o,_,!!C.dynamicChildren)}}},move:pr,hydrate:wg};function pr(e,t,o,{o:{insert:a},m:s},i=2){i===0&&a(e.targetAnchor,t,o);const{el:r,anchor:u,shapeFlag:d,children:h,props:p}=e,g=i===2;if(g&&a(r,t,o),(!g||Ll(p))&&d&16)for(let y=0;y<h.length;y++)s(h[y],t,o,2);g&&a(u,t,o)}function wg(e,t,o,a,s,i,{o:{nextSibling:r,parentNode:u,querySelector:d,insert:h,createText:p}},g){function y(C,I,$,x){I.anchor=g(r(C),I,u(C),o,a,s,i),I.targetStart=$,I.targetAnchor=x}const _=t.target=ru(t.props,d),b=Ll(t.props);if(_){const C=_._lpa||_.firstChild;if(t.shapeFlag&16)if(b)y(e,t,C,C&&r(C));else{t.anchor=r(e);let I=C;for(;I;){if(I&&I.nodeType===8){if(I.data==="teleport start anchor")t.targetStart=I;else if(I.data==="teleport anchor"){t.targetAnchor=I,_._lpa=t.targetAnchor&&r(t.targetAnchor);break}}I=r(I)}t.targetAnchor||up(_,t,p,h),g(C&&r(C),t,_,o,a,s,i)}br(t,b)}else b&&t.shapeFlag&16&&y(e,t,e,r(e));return t.anchor&&r(t.anchor)}const Ol=cp;function br(e,t){const o=e.ctx;if(o&&o.ut){let a,s;for(t?(a=e.el,s=e.anchor):(a=e.targetStart,s=e.targetAnchor);a&&a!==s;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function up(e,t,o,a){const s=t.targetStart=o(""),i=t.targetAnchor=o("");return s[lp]=i,e&&(a(s,e),a(i,e)),i}const Ps=Symbol("_leaveCb"),vr=Symbol("_enterCb");function Cg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qt(()=>{e.isMounted=!0}),_p(()=>{e.isUnmounting=!0}),e}const Do=[Function,Array],dp={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Do,onEnter:Do,onAfterEnter:Do,onEnterCancelled:Do,onBeforeLeave:Do,onLeave:Do,onAfterLeave:Do,onLeaveCancelled:Do,onBeforeAppear:Do,onAppear:Do,onAfterAppear:Do,onAppearCancelled:Do},hp=e=>{const t=e.subTree;return t.component?hp(t.component):t},Lg={name:"BaseTransition",props:dp,setup(e,{slots:t}){const o=dc(),a=Cg();return()=>{const s=t.default&&vp(t.default(),!0);if(!s||!s.length)return;const i=fp(s),r=Mt(e),{mode:u}=r;if(a.isLeaving)return Uc(i);const d=zd(i);if(!d)return Uc(i);let h=cu(d,r,a,o,g=>h=g);d.type!==Bn&&Rl(d,h);let p=o.subTree&&zd(o.subTree);if(p&&p.type!==Bn&&!Xa(p,d)&&hp(o).type!==Bn){let g=cu(p,r,a,o);if(Rl(p,g),u==="out-in"&&d.type!==Bn)return a.isLeaving=!0,g.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},Uc(i);u==="in-out"&&d.type!==Bn?g.delayLeave=(y,_,b)=>{const C=pp(a,p);C[String(p.key)]=p,y[Ps]=()=>{_(),y[Ps]=void 0,delete h.delayedLeave,p=void 0},h.delayedLeave=()=>{b(),delete h.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return i}}};function fp(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Bn){t=o;break}}return t}const Sg=Lg;function pp(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function cu(e,t,o,a,s){const{appear:i,mode:r,persisted:u=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:y,onLeave:_,onAfterLeave:b,onLeaveCancelled:C,onBeforeAppear:I,onAppear:$,onAfterAppear:x,onAppearCancelled:S}=t,B=String(e.key),E=pp(o,e),q=(R,j)=>{R&&os(R,a,9,j)},P=(R,j)=>{const O=j[1];q(R,j),lt(R)?R.every(G=>G.length<=1)&&O():R.length<=1&&O()},F={mode:r,persisted:u,beforeEnter(R){let j=d;if(!o.isMounted)if(i)j=I||d;else return;R[Ps]&&R[Ps](!0);const O=E[B];O&&Xa(e,O)&&O.el[Ps]&&O.el[Ps](),q(j,[R])},enter(R){let j=h,O=p,G=g;if(!o.isMounted)if(i)j=$||h,O=x||p,G=S||g;else return;let Q=!1;const se=R[vr]=pe=>{Q||(Q=!0,pe?q(G,[R]):q(O,[R]),F.delayedLeave&&F.delayedLeave(),R[vr]=void 0)};j?P(j,[R,se]):se()},leave(R,j){const O=String(e.key);if(R[vr]&&R[vr](!0),o.isUnmounting)return j();q(y,[R]);let G=!1;const Q=R[Ps]=se=>{G||(G=!0,j(),se?q(C,[R]):q(b,[R]),R[Ps]=void 0,E[O]===e&&delete E[O])};E[O]=e,_?P(_,[R,Q]):Q()},clone(R){const j=cu(R,t,o,a,s);return s&&s(j),j}};return F}function Uc(e){if(lc(e))return e=Ia(e),e.children=null,e}function zd(e){if(!lc(e))return rp(e.type)&&e.children?fp(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&pt(o.default))return o.default()}}function Rl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Rl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function vp(e,t=!1,o){let a=[],s=0;for(let i=0;i<e.length;i++){let r=e[i];const u=o==null?r.key:String(o)+String(r.key!=null?r.key:i);r.type===Me?(r.patchFlag&128&&s++,a=a.concat(vp(r.children,t,u))):(t||r.type!==Bn)&&a.push(u!=null?Ia(r,{key:u}):r)}if(s>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function mp(e,t){return pt(e)?yn({name:e.name},t,{setup:e}):e}function gp(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Dr=new WeakMap;function Sl(e,t,o,a,s=!1){if(lt(e)){e.forEach((b,C)=>Sl(b,t&&(lt(t)?t[C]:t),o,a,s));return}if(zi(a)&&!s){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&Sl(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?hc(a.component):a.el,r=s?null:i,{i:u,r:d}=e,h=t&&t.r,p=u.refs===Vt?u.refs={}:u.refs,g=u.setupState,y=Mt(g),_=g===Vt?Sf:b=>Dt(y,b);if(h!=null&&h!==d){if(Hd(t),Xt(h))p[h]=null,_(h)&&(g[h]=null);else if(Yt(h)){h.value=null;const b=t;b.k&&(p[b.k]=null)}}if(pt(d))jl(d,u,12,[r,p]);else{const b=Xt(d),C=Yt(d);if(b||C){const I=()=>{if(e.f){const $=b?_(d)?g[d]:p[d]:d.value;if(s)lt($)&&Uu($,i);else if(lt($))$.includes(i)||$.push(i);else if(b)p[d]=[i],_(d)&&(g[d]=p[d]);else{const x=[i];d.value=x,e.k&&(p[e.k]=x)}}else b?(p[d]=r,_(d)&&(g[d]=r)):C&&(d.value=r,e.k&&(p[e.k]=r))};if(r){const $=()=>{I(),Dr.delete(e)};$.id=-1,Dr.set(e,$),qn($,o)}else Hd(e),I()}}}function Hd(e){const t=Dr.get(e);t&&(t.flags|=8,Dr.delete(e))}oc().requestIdleCallback;oc().cancelIdleCallback;const zi=e=>!!e.type.__asyncLoader,lc=e=>e.type.__isKeepAlive;function Ig(e,t){yp(e,"a",t)}function xg(e,t){yp(e,"da",t)}function yp(e,t,o=Nn){const a=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(rc(t,a,o),o){let s=o.parent;for(;s&&s.parent;)lc(s.parent.vnode)&&$g(a,t,o,s),s=s.parent}}function $g(e,t,o,a){const s=rc(t,e,a,!0);kn(()=>{Uu(a[t],s)},o)}function rc(e,t,o=Nn,a=!1){if(o){const s=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...r)=>{zs();const u=Zl(o),d=os(t,o,e,r);return u(),Hs(),d});return a?s.unshift(i):s.push(i),i}}const Zs=e=>(t,o=Nn)=>{(!Fl||e==="sp")&&rc(e,(...a)=>t(...a),o)},Tg=Zs("bm"),Qt=Zs("m"),kp=Zs("bu"),Mg=Zs("u"),_p=Zs("bum"),kn=Zs("um"),Ag=Zs("sp"),Eg=Zs("rtg"),Pg=Zs("rtc");function Dg(e,t=Nn){rc("ec",e,t)}const bp="components";function Ju(e,t){return Cp(bp,e,!0,t)||e}const wp=Symbol.for("v-ndc");function Og(e){return Xt(e)?Cp(bp,e,!1)||e:e||wp}function Cp(e,t,o=!0,a=!1){const s=xn||Nn;if(s){const i=s.type;{const u=yy(i,!1);if(u&&(u===t||u===Ro(t)||u===tc(Ro(t))))return i}const r=Vd(s[e]||i[e],t)||Vd(s.appContext[e],t);return!r&&a?i:r}}function Vd(e,t){return e&&(e[t]||e[Ro(t)]||e[tc(Ro(t))])}function Fe(e,t,o,a){let s;const i=o,r=lt(e);if(r||Xt(e)){const u=r&&Us(e);let d=!1,h=!1;u&&(d=!So(e),h=Vs(e),e=sc(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(d?h?Vi(ns(e[p])):ns(e[p]):e[p],p,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,i)}else if(Ft(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,h=u.length;d<h;d++){const p=u[d];s[d]=t(e[p],p,d,i)}}else s=[];return s}function Lp(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(lt(a))for(let s=0;s<a.length;s++)e[a[s].name]=a[s].fn;else a&&(e[a.name]=a.key?(...s)=>{const i=a.fn(...s);return i&&(i.key=a.key),i}:a.fn)}return e}function co(e,t,o={},a,s){if(xn.ce||xn.parent&&zi(xn.parent)&&xn.parent.ce){const h=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),qe(Me,null,[Ee("slot",o,a&&a())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const r=i&&Sp(i(o)),u=o.key||r&&r.key,d=qe(Me,{key:(u&&!ts(u)?u:`_${t}`)+(!r&&a?"_fb":"")},r||(a?a():[]),r&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function Sp(e){return e.some(t=>Nl(t)?!(t.type===Bn||t.type===Me&&!Sp(t.children)):!0)?e:null}const uu=e=>e?Gp(e)?hc(e):uu(e.parent):null,Il=yn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>uu(e.parent),$root:e=>uu(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>xp(e),$forceUpdate:e=>e.f||(e.f=()=>{Ku(e.update)}),$nextTick:e=>e.n||(e.n=sn.bind(e.proxy)),$watch:e=>bg.bind(e)}),zc=(e,t)=>e!==Vt&&!e.__isScriptSetup&&Dt(e,t),Rg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:s,props:i,accessCache:r,type:u,appContext:d}=e;if(t[0]!=="$"){const y=r[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return s[t];case 4:return o[t];case 3:return i[t]}else{if(zc(a,t))return r[t]=1,a[t];if(s!==Vt&&Dt(s,t))return r[t]=2,s[t];if(Dt(i,t))return r[t]=3,i[t];if(o!==Vt&&Dt(o,t))return r[t]=4,o[t];du&&(r[t]=0)}}const h=Il[t];let p,g;if(h)return t==="$attrs"&&Rn(e.attrs,"get",""),h(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Vt&&Dt(o,t))return r[t]=4,o[t];if(g=d.config.globalProperties,Dt(g,t))return g[t]},set({_:e},t,o){const{data:a,setupState:s,ctx:i}=e;return zc(s,t)?(s[t]=o,!0):a!==Vt&&Dt(a,t)?(a[t]=o,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:s,props:i,type:r}},u){let d;return!!(o[u]||e!==Vt&&u[0]!=="$"&&Dt(e,u)||zc(t,u)||Dt(i,u)||Dt(a,u)||Dt(Il,u)||Dt(s.config.globalProperties,u)||(d=r.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Dt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Gd(e){return lt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let du=!0;function Bg(e){const t=xp(e),o=e.proxy,a=e.ctx;du=!1,t.beforeCreate&&jd(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:r,watch:u,provide:d,inject:h,created:p,beforeMount:g,mounted:y,beforeUpdate:_,updated:b,activated:C,deactivated:I,beforeDestroy:$,beforeUnmount:x,destroyed:S,unmounted:B,render:E,renderTracked:q,renderTriggered:P,errorCaptured:F,serverPrefetch:R,expose:j,inheritAttrs:O,components:G,directives:Q,filters:se}=t;if(h&&Ng(h,a,null),r)for(const te in r){const z=r[te];pt(z)&&(a[te]=z.bind(o))}if(s){const te=s.call(o,o);Ft(te)&&(e.data=ui(te))}if(du=!0,i)for(const te in i){const z=i[te],Y=pt(z)?z.bind(o,o):pt(z.get)?z.get.bind(o,o):Xo,ue=!pt(z)&&pt(z.set)?z.set.bind(o):Xo,ke=U({get:Y,set:ue});Object.defineProperty(a,te,{enumerable:!0,configurable:!0,get:()=>ke.value,set:Re=>ke.value=Re})}if(u)for(const te in u)Ip(u[te],a,o,te);if(d){const te=pt(d)?d.call(o):d;Reflect.ownKeys(te).forEach(z=>{Cl(z,te[z])})}p&&jd(p,e,"c");function ee(te,z){lt(z)?z.forEach(Y=>te(Y.bind(o))):z&&te(z.bind(o))}if(ee(Tg,g),ee(Qt,y),ee(kp,_),ee(Mg,b),ee(Ig,C),ee(xg,I),ee(Dg,F),ee(Pg,q),ee(Eg,P),ee(_p,x),ee(kn,B),ee(Ag,R),lt(j))if(j.length){const te=e.exposed||(e.exposed={});j.forEach(z=>{Object.defineProperty(te,z,{get:()=>o[z],set:Y=>o[z]=Y,enumerable:!0})})}else e.exposed||(e.exposed={});E&&e.render===Xo&&(e.render=E),O!=null&&(e.inheritAttrs=O),G&&(e.components=G),Q&&(e.directives=Q),R&&gp(e)}function Ng(e,t,o=Xo){lt(e)&&(e=hu(e));for(const a in e){const s=e[a];let i;Ft(s)?"default"in s?i=uo(s.from||a,s.default,!0):i=uo(s.from||a):i=uo(s),Yt(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:r=>i.value=r}):t[a]=i}}function jd(e,t,o){os(lt(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function Ip(e,t,o,a){let s=a.includes(".")?ip(o,a):()=>o[a];if(Xt(e)){const i=t[e];pt(i)&&Ze(s,i)}else if(pt(e))Ze(s,e.bind(o));else if(Ft(e))if(lt(e))e.forEach(i=>Ip(i,t,o,a));else{const i=pt(e.handler)?e.handler.bind(o):t[e.handler];pt(i)&&Ze(s,i,e)}}function xp(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:r}}=e.appContext,u=i.get(t);let d;return u?d=u:!s.length&&!o&&!a?d=t:(d={},s.length&&s.forEach(h=>Or(d,h,r,!0)),Or(d,t,r)),Ft(t)&&i.set(t,d),d}function Or(e,t,o,a=!1){const{mixins:s,extends:i}=t;i&&Or(e,i,o,!0),s&&s.forEach(r=>Or(e,r,o,!0));for(const r in t)if(!(a&&r==="expose")){const u=Fg[r]||o&&o[r];e[r]=u?u(e[r],t[r]):t[r]}return e}const Fg={data:Zd,props:qd,emits:qd,methods:ml,computed:ml,beforeCreate:Zn,created:Zn,beforeMount:Zn,mounted:Zn,beforeUpdate:Zn,updated:Zn,beforeDestroy:Zn,beforeUnmount:Zn,destroyed:Zn,unmounted:Zn,activated:Zn,deactivated:Zn,errorCaptured:Zn,serverPrefetch:Zn,components:ml,directives:ml,watch:zg,provide:Zd,inject:Ug};function Zd(e,t){return t?e?function(){return yn(pt(e)?e.call(this,this):e,pt(t)?t.call(this,this):t)}:t:e}function Ug(e,t){return ml(hu(e),hu(t))}function hu(e){if(lt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Zn(e,t){return e?[...new Set([].concat(e,t))]:t}function ml(e,t){return e?yn(Object.create(null),e,t):t}function qd(e,t){return e?lt(e)&&lt(t)?[...new Set([...e,...t])]:yn(Object.create(null),Gd(e),Gd(t??{})):t}function zg(e,t){if(!e)return t;if(!t)return e;const o=yn(Object.create(null),e);for(const a in t)o[a]=Zn(e[a],t[a]);return o}function $p(){return{app:null,config:{isNativeTag:Sf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Hg=0;function Vg(e,t){return function(a,s=null){pt(a)||(a=yn({},a)),s!=null&&!Ft(s)&&(s=null);const i=$p(),r=new WeakSet,u=[];let d=!1;const h=i.app={_uid:Hg++,_component:a,_props:s,_container:null,_context:i,_instance:null,version:_y,get config(){return i.config},set config(p){},use(p,...g){return r.has(p)||(p&&pt(p.install)?(r.add(p),p.install(h,...g)):pt(p)&&(r.add(p),p(h,...g))),h},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),h},component(p,g){return g?(i.components[p]=g,h):i.components[p]},directive(p,g){return g?(i.directives[p]=g,h):i.directives[p]},mount(p,g,y){if(!d){const _=h._ceVNode||Ee(a,s);return _.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(_,p,y),d=!0,h._container=p,p.__vue_app__=h,hc(_.component)}},onUnmount(p){u.push(p)},unmount(){d&&(os(u,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(p,g){return i.provides[p]=g,h},runWithContext(p){const g=ai;ai=h;try{return p()}finally{ai=g}}};return h}}let ai=null;const Gg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ro(t)}Modifiers`]||e[`${Ta(t)}Modifiers`];function jg(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Vt;let s=o;const i=t.startsWith("update:"),r=i&&Gg(a,t.slice(7));r&&(r.trim&&(s=o.map(p=>Xt(p)?p.trim():p)),r.number&&(s=o.map(nc)));let u,d=a[u=Oc(t)]||a[u=Oc(Ro(t))];!d&&i&&(d=a[u=Oc(Ta(t))]),d&&os(d,e,6,s);const h=a[u+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,os(h,e,6,s)}}const Zg=new WeakMap;function Tp(e,t,o=!1){const a=o?Zg:t.emitsCache,s=a.get(e);if(s!==void 0)return s;const i=e.emits;let r={},u=!1;if(!pt(e)){const d=h=>{const p=Tp(h,t,!0);p&&(u=!0,yn(r,p))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(Ft(e)&&a.set(e,null),null):(lt(i)?i.forEach(d=>r[d]=null):yn(r,i),Ft(e)&&a.set(e,r),r)}function cc(e,t){return!e||!Xr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,Ta(t))||Dt(e,t))}function Wd(e){const{type:t,vnode:o,proxy:a,withProxy:s,propsOptions:[i],slots:r,attrs:u,emit:d,render:h,renderCache:p,props:g,data:y,setupState:_,ctx:b,inheritAttrs:C}=e,I=Pr(e);let $,x;try{if(o.shapeFlag&4){const B=s||a,E=B;$=ps(h.call(E,B,p,g,_,y,b)),x=u}else{const B=t;$=ps(B.length>1?B(g,{attrs:u,slots:r,emit:d}):B(g,null)),x=t.props?u:qg(u)}}catch(B){$l.length=0,ic(B,e,1),$=Ee(Bn)}let S=$;if(x&&C!==!1){const B=Object.keys(x),{shapeFlag:E}=S;B.length&&E&7&&(i&&B.some(Fu)&&(x=Wg(x,i)),S=Ia(S,x,!1,!0))}return o.dirs&&(S=Ia(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(o.dirs):o.dirs),o.transition&&Rl(S,o.transition),$=S,Pr(I),$}const qg=e=>{let t;for(const o in e)(o==="class"||o==="style"||Xr(o))&&((t||(t={}))[o]=e[o]);return t},Wg=(e,t)=>{const o={};for(const a in e)(!Fu(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function Kg(e,t,o){const{props:a,children:s,component:i}=e,{props:r,children:u,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?Kd(a,r,h):!!r;if(d&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const y=p[g];if(r[y]!==a[y]&&!cc(h,y))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:a===r?!1:a?r?Kd(a,r,h):!0:!!r;return!1}function Kd(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let s=0;s<a.length;s++){const i=a[s];if(t[i]!==e[i]&&!cc(o,i))return!0}return!1}function Jg({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const Mp={},Ap=()=>Object.create(Mp),Ep=e=>Object.getPrototypeOf(e)===Mp;function Yg(e,t,o,a=!1){const s={},i=Ap();e.propsDefaults=Object.create(null),Pp(e,t,s,i);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);o?e.props=a?s:Jf(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function Xg(e,t,o,a){const{props:s,attrs:i,vnode:{patchFlag:r}}=e,u=Mt(s),[d]=e.propsOptions;let h=!1;if((a||r>0)&&!(r&16)){if(r&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let y=p[g];if(cc(e.emitsOptions,y))continue;const _=t[y];if(d)if(Dt(i,y))_!==i[y]&&(i[y]=_,h=!0);else{const b=Ro(y);s[b]=fu(d,u,b,_,e,!1)}else _!==i[y]&&(i[y]=_,h=!0)}}}else{Pp(e,t,s,i)&&(h=!0);let p;for(const g in u)(!t||!Dt(t,g)&&((p=Ta(g))===g||!Dt(t,p)))&&(d?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=fu(d,u,g,void 0,e,!0)):delete s[g]);if(i!==u)for(const g in i)(!t||!Dt(t,g))&&(delete i[g],h=!0)}h&&Ds(e.attrs,"set","")}function Pp(e,t,o,a){const[s,i]=e.propsOptions;let r=!1,u;if(t)for(let d in t){if(_l(d))continue;const h=t[d];let p;s&&Dt(s,p=Ro(d))?!i||!i.includes(p)?o[p]=h:(u||(u={}))[p]=h:cc(e.emitsOptions,d)||(!(d in a)||h!==a[d])&&(a[d]=h,r=!0)}if(i){const d=Mt(o),h=u||Vt;for(let p=0;p<i.length;p++){const g=i[p];o[g]=fu(s,d,g,h[g],e,!Dt(h,g))}}return r}function fu(e,t,o,a,s,i){const r=e[o];if(r!=null){const u=Dt(r,"default");if(u&&a===void 0){const d=r.default;if(r.type!==Function&&!r.skipFactory&&pt(d)){const{propsDefaults:h}=s;if(o in h)a=h[o];else{const p=Zl(s);a=h[o]=d.call(null,t),p()}}else a=d;s.ce&&s.ce._setProp(o,a)}r[0]&&(i&&!u?a=!1:r[1]&&(a===""||a===Ta(o))&&(a=!0))}return a}const Qg=new WeakMap;function Dp(e,t,o=!1){const a=o?Qg:t.propsCache,s=a.get(e);if(s)return s;const i=e.props,r={},u=[];let d=!1;if(!pt(e)){const p=g=>{d=!0;const[y,_]=Dp(g,t,!0);yn(r,y),_&&u.push(..._)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!i&&!d)return Ft(e)&&a.set(e,Ni),Ni;if(lt(i))for(let p=0;p<i.length;p++){const g=Ro(i[p]);Jd(g)&&(r[g]=Vt)}else if(i)for(const p in i){const g=Ro(p);if(Jd(g)){const y=i[p],_=r[g]=lt(y)||pt(y)?{type:y}:yn({},y),b=_.type;let C=!1,I=!0;if(lt(b))for(let $=0;$<b.length;++$){const x=b[$],S=pt(x)&&x.name;if(S==="Boolean"){C=!0;break}else S==="String"&&(I=!1)}else C=pt(b)&&b.name==="Boolean";_[0]=C,_[1]=I,(C||Dt(_,"default"))&&u.push(g)}}const h=[r,u];return Ft(e)&&a.set(e,h),h}function Jd(e){return e[0]!=="$"&&!_l(e)}const Yu=e=>e==="_"||e==="_ctx"||e==="$stable",Xu=e=>lt(e)?e.map(ps):[ps(e)],ey=(e,t,o)=>{if(t._n)return t;const a=He((...s)=>Xu(t(...s)),o);return a._c=!1,a},Op=(e,t,o)=>{const a=e._ctx;for(const s in e){if(Yu(s))continue;const i=e[s];if(pt(i))t[s]=ey(s,i,a);else if(i!=null){const r=Xu(i);t[s]=()=>r}}},Rp=(e,t)=>{const o=Xu(t);e.slots.default=()=>o},Bp=(e,t,o)=>{for(const a in t)(o||!Yu(a))&&(e[a]=t[a])},ty=(e,t,o)=>{const a=e.slots=Ap();if(e.vnode.shapeFlag&32){const s=t._;s?(Bp(a,t,o),o&&Tf(a,"_",s,!0)):Op(t,a)}else t&&Rp(e,t)},ny=(e,t,o)=>{const{vnode:a,slots:s}=e;let i=!0,r=Vt;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:Bp(s,t,o):(i=!t.$stable,Op(t,s)),r=t}else t&&(Rp(e,t),r={default:1});if(i)for(const u in s)!Yu(u)&&r[u]==null&&delete s[u]},qn=ly;function oy(e){return sy(e)}function sy(e,t){const o=oc();o.__VUE__=!0;const{insert:a,remove:s,patchProp:i,createElement:r,createText:u,createComment:d,setText:h,setElementText:p,parentNode:g,nextSibling:y,setScopeId:_=Xo,insertStaticContent:b}=e,C=(N,K,ae,Te=null,Be=null,De=null,Se=void 0,J=null,he=!!K.dynamicChildren)=>{if(N===K)return;N&&!Xa(N,K)&&(Te=X(N),Re(N,Be,De,!0),N=null),K.patchFlag===-2&&(he=!1,K.dynamicChildren=null);const{type:xe,ref:Ie,shapeFlag:be}=K;switch(xe){case uc:I(N,K,ae,Te);break;case Bn:$(N,K,ae,Te);break;case xl:N==null&&x(K,ae,Te,Se);break;case Me:G(N,K,ae,Te,Be,De,Se,J,he);break;default:be&1?E(N,K,ae,Te,Be,De,Se,J,he):be&6?Q(N,K,ae,Te,Be,De,Se,J,he):(be&64||be&128)&&xe.process(N,K,ae,Te,Be,De,Se,J,he,me)}Ie!=null&&Be?Sl(Ie,N&&N.ref,De,K||N,!K):Ie==null&&N&&N.ref!=null&&Sl(N.ref,null,De,N,!0)},I=(N,K,ae,Te)=>{if(N==null)a(K.el=u(K.children),ae,Te);else{const Be=K.el=N.el;K.children!==N.children&&h(Be,K.children)}},$=(N,K,ae,Te)=>{N==null?a(K.el=d(K.children||""),ae,Te):K.el=N.el},x=(N,K,ae,Te)=>{[N.el,N.anchor]=b(N.children,K,ae,Te,N.el,N.anchor)},S=({el:N,anchor:K},ae,Te)=>{let Be;for(;N&&N!==K;)Be=y(N),a(N,ae,Te),N=Be;a(K,ae,Te)},B=({el:N,anchor:K})=>{let ae;for(;N&&N!==K;)ae=y(N),s(N),N=ae;s(K)},E=(N,K,ae,Te,Be,De,Se,J,he)=>{if(K.type==="svg"?Se="svg":K.type==="math"&&(Se="mathml"),N==null)q(K,ae,Te,Be,De,Se,J,he);else{const xe=N.el&&N.el._isVueCE?N.el:null;try{xe&&xe._beginPatch(),R(N,K,Be,De,Se,J,he)}finally{xe&&xe._endPatch()}}},q=(N,K,ae,Te,Be,De,Se,J)=>{let he,xe;const{props:Ie,shapeFlag:be,transition:de,dirs:fe}=N;if(he=N.el=r(N.type,De,Ie&&Ie.is,Ie),be&8?p(he,N.children):be&16&&F(N.children,he,null,Te,Be,Hc(N,De),Se,J),fe&&Za(N,null,Te,"created"),P(he,N,N.scopeId,Se,Te),Ie){for(const W in Ie)W!=="value"&&!_l(W)&&i(he,W,null,Ie[W],De,Te);"value"in Ie&&i(he,"value",null,Ie.value,De),(xe=Ie.onVnodeBeforeMount)&&us(xe,Te,N)}fe&&Za(N,null,Te,"beforeMount");const Z=ay(Be,de);Z&&de.beforeEnter(he),a(he,K,ae),((xe=Ie&&Ie.onVnodeMounted)||Z||fe)&&qn(()=>{xe&&us(xe,Te,N),Z&&de.enter(he),fe&&Za(N,null,Te,"mounted")},Be)},P=(N,K,ae,Te,Be)=>{if(ae&&_(N,ae),Te)for(let De=0;De<Te.length;De++)_(N,Te[De]);if(Be){let De=Be.subTree;if(K===De||Up(De.type)&&(De.ssContent===K||De.ssFallback===K)){const Se=Be.vnode;P(N,Se,Se.scopeId,Se.slotScopeIds,Be.parent)}}},F=(N,K,ae,Te,Be,De,Se,J,he=0)=>{for(let xe=he;xe<N.length;xe++){const Ie=N[xe]=J?ga(N[xe]):ps(N[xe]);C(null,Ie,K,ae,Te,Be,De,Se,J)}},R=(N,K,ae,Te,Be,De,Se)=>{const J=K.el=N.el;let{patchFlag:he,dynamicChildren:xe,dirs:Ie}=K;he|=N.patchFlag&16;const be=N.props||Vt,de=K.props||Vt;let fe;if(ae&&qa(ae,!1),(fe=de.onVnodeBeforeUpdate)&&us(fe,ae,K,N),Ie&&Za(K,N,ae,"beforeUpdate"),ae&&qa(ae,!0),(be.innerHTML&&de.innerHTML==null||be.textContent&&de.textContent==null)&&p(J,""),xe?j(N.dynamicChildren,xe,J,ae,Te,Hc(K,Be),De):Se||z(N,K,J,null,ae,Te,Hc(K,Be),De,!1),he>0){if(he&16)O(J,be,de,ae,Be);else if(he&2&&be.class!==de.class&&i(J,"class",null,de.class,Be),he&4&&i(J,"style",be.style,de.style,Be),he&8){const Z=K.dynamicProps;for(let W=0;W<Z.length;W++){const ie=Z[W],Ue=be[ie],Xe=de[ie];(Xe!==Ue||ie==="value")&&i(J,ie,Ue,Xe,Be,ae)}}he&1&&N.children!==K.children&&p(J,K.children)}else!Se&&xe==null&&O(J,be,de,ae,Be);((fe=de.onVnodeUpdated)||Ie)&&qn(()=>{fe&&us(fe,ae,K,N),Ie&&Za(K,N,ae,"updated")},Te)},j=(N,K,ae,Te,Be,De,Se)=>{for(let J=0;J<K.length;J++){const he=N[J],xe=K[J],Ie=he.el&&(he.type===Me||!Xa(he,xe)||he.shapeFlag&198)?g(he.el):ae;C(he,xe,Ie,null,Te,Be,De,Se,!0)}},O=(N,K,ae,Te,Be)=>{if(K!==ae){if(K!==Vt)for(const De in K)!_l(De)&&!(De in ae)&&i(N,De,K[De],null,Be,Te);for(const De in ae){if(_l(De))continue;const Se=ae[De],J=K[De];Se!==J&&De!=="value"&&i(N,De,J,Se,Be,Te)}"value"in ae&&i(N,"value",K.value,ae.value,Be)}},G=(N,K,ae,Te,Be,De,Se,J,he)=>{const xe=K.el=N?N.el:u(""),Ie=K.anchor=N?N.anchor:u("");let{patchFlag:be,dynamicChildren:de,slotScopeIds:fe}=K;fe&&(J=J?J.concat(fe):fe),N==null?(a(xe,ae,Te),a(Ie,ae,Te),F(K.children||[],ae,Ie,Be,De,Se,J,he)):be>0&&be&64&&de&&N.dynamicChildren&&N.dynamicChildren.length===de.length?(j(N.dynamicChildren,de,ae,Be,De,Se,J),(K.key!=null||Be&&K===Be.subTree)&&Qu(N,K,!0)):z(N,K,ae,Ie,Be,De,Se,J,he)},Q=(N,K,ae,Te,Be,De,Se,J,he)=>{K.slotScopeIds=J,N==null?K.shapeFlag&512?Be.ctx.activate(K,ae,Te,Se,he):se(K,ae,Te,Be,De,Se,he):pe(N,K,he)},se=(N,K,ae,Te,Be,De,Se)=>{const J=N.component=fy(N,Te,Be);if(lc(N)&&(J.ctx.renderer=me),py(J,!1,Se),J.asyncDep){if(Be&&Be.registerDep(J,ee,Se),!N.el){const he=J.subTree=Ee(Bn);$(null,he,K,ae),N.placeholder=he.el}}else ee(J,N,K,ae,Be,De,Se)},pe=(N,K,ae)=>{const Te=K.component=N.component;if(Kg(N,K,ae))if(Te.asyncDep&&!Te.asyncResolved){te(Te,K,ae);return}else Te.next=K,Te.update();else K.el=N.el,Te.vnode=K},ee=(N,K,ae,Te,Be,De,Se)=>{const J=()=>{if(N.isMounted){let{next:be,bu:de,u:fe,parent:Z,vnode:W}=N;{const _t=Np(N);if(_t){be&&(be.el=W.el,te(N,be,Se)),_t.asyncDep.then(()=>{N.isUnmounted||J()});return}}let ie=be,Ue;qa(N,!1),be?(be.el=W.el,te(N,be,Se)):be=W,de&&_r(de),(Ue=be.props&&be.props.onVnodeBeforeUpdate)&&us(Ue,Z,be,W),qa(N,!0);const Xe=Wd(N),mt=N.subTree;N.subTree=Xe,C(mt,Xe,g(mt.el),X(mt),N,Be,De),be.el=Xe.el,ie===null&&Jg(N,Xe.el),fe&&qn(fe,Be),(Ue=be.props&&be.props.onVnodeUpdated)&&qn(()=>us(Ue,Z,be,W),Be)}else{let be;const{el:de,props:fe}=K,{bm:Z,m:W,parent:ie,root:Ue,type:Xe}=N,mt=zi(K);qa(N,!1),Z&&_r(Z),!mt&&(be=fe&&fe.onVnodeBeforeMount)&&us(be,ie,K),qa(N,!0);{Ue.ce&&Ue.ce._def.shadowRoot!==!1&&Ue.ce._injectChildStyle(Xe);const _t=N.subTree=Wd(N);C(null,_t,ae,Te,N,Be,De),K.el=_t.el}if(W&&qn(W,Be),!mt&&(be=fe&&fe.onVnodeMounted)){const _t=K;qn(()=>us(be,ie,_t),Be)}(K.shapeFlag&256||ie&&zi(ie.vnode)&&ie.vnode.shapeFlag&256)&&N.a&&qn(N.a,Be),N.isMounted=!0,K=ae=Te=null}};N.scope.on();const he=N.effect=new Rf(J);N.scope.off();const xe=N.update=he.run.bind(he),Ie=N.job=he.runIfDirty.bind(he);Ie.i=N,Ie.id=N.uid,he.scheduler=()=>Ku(Ie),qa(N,!0),xe()},te=(N,K,ae)=>{K.component=N;const Te=N.vnode.props;N.vnode=K,N.next=null,Xg(N,K.props,Te,ae),ny(N,K.children,ae),zs(),Bd(N),Hs()},z=(N,K,ae,Te,Be,De,Se,J,he=!1)=>{const xe=N&&N.children,Ie=N?N.shapeFlag:0,be=K.children,{patchFlag:de,shapeFlag:fe}=K;if(de>0){if(de&128){ue(xe,be,ae,Te,Be,De,Se,J,he);return}else if(de&256){Y(xe,be,ae,Te,Be,De,Se,J,he);return}}fe&8?(Ie&16&&We(xe,Be,De),be!==xe&&p(ae,be)):Ie&16?fe&16?ue(xe,be,ae,Te,Be,De,Se,J,he):We(xe,Be,De,!0):(Ie&8&&p(ae,""),fe&16&&F(be,ae,Te,Be,De,Se,J,he))},Y=(N,K,ae,Te,Be,De,Se,J,he)=>{N=N||Ni,K=K||Ni;const xe=N.length,Ie=K.length,be=Math.min(xe,Ie);let de;for(de=0;de<be;de++){const fe=K[de]=he?ga(K[de]):ps(K[de]);C(N[de],fe,ae,null,Be,De,Se,J,he)}xe>Ie?We(N,Be,De,!0,!1,be):F(K,ae,Te,Be,De,Se,J,he,be)},ue=(N,K,ae,Te,Be,De,Se,J,he)=>{let xe=0;const Ie=K.length;let be=N.length-1,de=Ie-1;for(;xe<=be&&xe<=de;){const fe=N[xe],Z=K[xe]=he?ga(K[xe]):ps(K[xe]);if(Xa(fe,Z))C(fe,Z,ae,null,Be,De,Se,J,he);else break;xe++}for(;xe<=be&&xe<=de;){const fe=N[be],Z=K[de]=he?ga(K[de]):ps(K[de]);if(Xa(fe,Z))C(fe,Z,ae,null,Be,De,Se,J,he);else break;be--,de--}if(xe>be){if(xe<=de){const fe=de+1,Z=fe<Ie?K[fe].el:Te;for(;xe<=de;)C(null,K[xe]=he?ga(K[xe]):ps(K[xe]),ae,Z,Be,De,Se,J,he),xe++}}else if(xe>de)for(;xe<=be;)Re(N[xe],Be,De,!0),xe++;else{const fe=xe,Z=xe,W=new Map;for(xe=Z;xe<=de;xe++){const bt=K[xe]=he?ga(K[xe]):ps(K[xe]);bt.key!=null&&W.set(bt.key,xe)}let ie,Ue=0;const Xe=de-Z+1;let mt=!1,_t=0;const gt=new Array(Xe);for(xe=0;xe<Xe;xe++)gt[xe]=0;for(xe=fe;xe<=be;xe++){const bt=N[xe];if(Ue>=Xe){Re(bt,Be,De,!0);continue}let Ut;if(bt.key!=null)Ut=W.get(bt.key);else for(ie=Z;ie<=de;ie++)if(gt[ie-Z]===0&&Xa(bt,K[ie])){Ut=ie;break}Ut===void 0?Re(bt,Be,De,!0):(gt[Ut-Z]=xe+1,Ut>=_t?_t=Ut:mt=!0,C(bt,K[Ut],ae,null,Be,De,Se,J,he),Ue++)}const St=mt?iy(gt):Ni;for(ie=St.length-1,xe=Xe-1;xe>=0;xe--){const bt=Z+xe,Ut=K[bt],Bt=K[bt+1],ut=bt+1<Ie?Bt.el||Fp(Bt):Te;gt[xe]===0?C(null,Ut,ae,ut,Be,De,Se,J,he):mt&&(ie<0||xe!==St[ie]?ke(Ut,ae,ut,2):ie--)}}},ke=(N,K,ae,Te,Be=null)=>{const{el:De,type:Se,transition:J,children:he,shapeFlag:xe}=N;if(xe&6){ke(N.component.subTree,K,ae,Te);return}if(xe&128){N.suspense.move(K,ae,Te);return}if(xe&64){Se.move(N,K,ae,me);return}if(Se===Me){a(De,K,ae);for(let be=0;be<he.length;be++)ke(he[be],K,ae,Te);a(N.anchor,K,ae);return}if(Se===xl){S(N,K,ae);return}if(Te!==2&&xe&1&&J)if(Te===0)J.beforeEnter(De),a(De,K,ae),qn(()=>J.enter(De),Be);else{const{leave:be,delayLeave:de,afterLeave:fe}=J,Z=()=>{N.ctx.isUnmounted?s(De):a(De,K,ae)},W=()=>{De._isLeaving&&De[Ps](!0),be(De,()=>{Z(),fe&&fe()})};de?de(De,Z,W):W()}else a(De,K,ae)},Re=(N,K,ae,Te=!1,Be=!1)=>{const{type:De,props:Se,ref:J,children:he,dynamicChildren:xe,shapeFlag:Ie,patchFlag:be,dirs:de,cacheIndex:fe}=N;if(be===-2&&(Be=!1),J!=null&&(zs(),Sl(J,null,ae,N,!0),Hs()),fe!=null&&(K.renderCache[fe]=void 0),Ie&256){K.ctx.deactivate(N);return}const Z=Ie&1&&de,W=!zi(N);let ie;if(W&&(ie=Se&&Se.onVnodeBeforeUnmount)&&us(ie,K,N),Ie&6)Ke(N.component,ae,Te);else{if(Ie&128){N.suspense.unmount(ae,Te);return}Z&&Za(N,null,K,"beforeUnmount"),Ie&64?N.type.remove(N,K,ae,me,Te):xe&&!xe.hasOnce&&(De!==Me||be>0&&be&64)?We(xe,K,ae,!1,!0):(De===Me&&be&384||!Be&&Ie&16)&&We(he,K,ae),Te&&Ye(N)}(W&&(ie=Se&&Se.onVnodeUnmounted)||Z)&&qn(()=>{ie&&us(ie,K,N),Z&&Za(N,null,K,"unmounted")},ae)},Ye=N=>{const{type:K,el:ae,anchor:Te,transition:Be}=N;if(K===Me){Ne(ae,Te);return}if(K===xl){B(N);return}const De=()=>{s(ae),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(N.shapeFlag&1&&Be&&!Be.persisted){const{leave:Se,delayLeave:J}=Be,he=()=>Se(ae,De);J?J(N.el,De,he):he()}else De()},Ne=(N,K)=>{let ae;for(;N!==K;)ae=y(N),s(N),N=ae;s(K)},Ke=(N,K,ae)=>{const{bum:Te,scope:Be,job:De,subTree:Se,um:J,m:he,a:xe}=N;Yd(he),Yd(xe),Te&&_r(Te),Be.stop(),De&&(De.flags|=8,Re(Se,N,K,ae)),J&&qn(J,K),qn(()=>{N.isUnmounted=!0},K)},We=(N,K,ae,Te=!1,Be=!1,De=0)=>{for(let Se=De;Se<N.length;Se++)Re(N[Se],K,ae,Te,Be)},X=N=>{if(N.shapeFlag&6)return X(N.component.subTree);if(N.shapeFlag&128)return N.suspense.next();const K=y(N.anchor||N.el),ae=K&&K[lp];return ae?y(ae):K};let _e=!1;const Le=(N,K,ae)=>{let Te;N==null?K._vnode&&(Re(K._vnode,null,null,!0),Te=K._vnode.component):C(K._vnode||null,N,K,null,null,null,ae),K._vnode=N,_e||(_e=!0,Bd(Te),np(),_e=!1)},me={p:C,um:Re,m:ke,r:Ye,mt:se,mc:F,pc:z,pbc:j,n:X,o:e};return{render:Le,hydrate:void 0,createApp:Vg(Le)}}function Hc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function qa({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function ay(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Qu(e,t,o=!1){const a=e.children,s=t.children;if(lt(a)&&lt(s))for(let i=0;i<a.length;i++){const r=a[i];let u=s[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[i]=ga(s[i]),u.el=r.el),!o&&u.patchFlag!==-2&&Qu(r,u)),u.type===uc&&(u.patchFlag!==-1?u.el=r.el:u.__elIndex=i+(e.type===Me?1:0)),u.type===Bn&&!u.el&&(u.el=r.el)}}function iy(e){const t=e.slice(),o=[0];let a,s,i,r,u;const d=e.length;for(a=0;a<d;a++){const h=e[a];if(h!==0){if(s=o[o.length-1],e[s]<h){t[a]=s,o.push(a);continue}for(i=0,r=o.length-1;i<r;)u=i+r>>1,e[o[u]]<h?i=u+1:r=u;h<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,r=o[i-1];i-- >0;)o[i]=r,r=t[r];return o}function Np(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Np(t)}function Yd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Fp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Fp(t.subTree):null}const Up=e=>e.__isSuspense;function ly(e,t){t&&t.pendingBranch?lt(e)?t.effects.push(...e):t.effects.push(e):tp(e)}const Me=Symbol.for("v-fgt"),uc=Symbol.for("v-txt"),Bn=Symbol.for("v-cmt"),xl=Symbol.for("v-stc"),$l=[];let Lo=null;function v(e=!1){$l.push(Lo=e?null:[])}function ry(){$l.pop(),Lo=$l[$l.length-1]||null}let Bl=1;function Rr(e,t=!1){Bl+=e,e<0&&Lo&&t&&(Lo.hasOnce=!0)}function zp(e){return e.dynamicChildren=Bl>0?Lo||Ni:null,ry(),Bl>0&&Lo&&Lo.push(e),e}function m(e,t,o,a,s,i){return zp(l(e,t,o,a,s,i,!0))}function qe(e,t,o,a,s){return zp(Ee(e,t,o,a,s,!0))}function Nl(e){return e?e.__v_isVNode===!0:!1}function Xa(e,t){return e.type===t.type&&e.key===t.key}const Hp=({key:e})=>e??null,wr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Xt(e)||Yt(e)||pt(e)?{i:xn,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,a=0,s=null,i=e===Me?0:1,r=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Hp(t),ref:t&&wr(t),scopeId:sp,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:xn};return u?(ed(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=Xt(o)?8:16),Bl>0&&!r&&Lo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&Lo.push(d),d}const Ee=cy;function cy(e,t=null,o=null,a=0,s=null,i=!1){if((!e||e===wp)&&(e=Bn),Nl(e)){const u=Ia(e,t,!0);return o&&ed(u,o),Bl>0&&!i&&Lo&&(u.shapeFlag&6?Lo[Lo.indexOf(e)]=u:Lo.push(u)),u.patchFlag=-2,u}if(ky(e)&&(e=e.__vccOpts),t){t=uy(t);let{class:u,style:d}=t;u&&!Xt(u)&&(t.class=ve(u)),Ft(d)&&(ac(d)&&!lt(d)&&(d=yn({},d)),t.style=et(d))}const r=Xt(e)?1:Up(e)?128:rp(e)?64:Ft(e)?4:pt(e)?2:0;return l(e,t,o,a,s,r,i,!0)}function uy(e){return e?ac(e)||Ep(e)?yn({},e):e:null}function Ia(e,t,o=!1,a=!1){const{props:s,ref:i,patchFlag:r,children:u,transition:d}=e,h=t?Vp(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Hp(h),ref:t&&t.ref?o&&i?lt(i)?i.concat(wr(t)):[i,wr(t)]:wr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Me?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ia(e.ssContent),ssFallback:e.ssFallback&&Ia(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Rl(p,d.clone(p)),p}function Qe(e=" ",t=0){return Ee(uc,null,e,t)}function Br(e,t){const o=Ee(xl,null,e);return o.staticCount=t,o}function A(e="",t=!1){return t?(v(),qe(Bn,null,e)):Ee(Bn,null,e)}function ps(e){return e==null||typeof e=="boolean"?Ee(Bn):lt(e)?Ee(Me,null,e.slice()):Nl(e)?ga(e):Ee(uc,null,String(e))}function ga(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ia(e)}function ed(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(lt(t))o=16;else if(typeof t=="object")if(a&65){const s=t.default;s&&(s._c&&(s._d=!1),ed(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Ep(t)?t._ctx=xn:s===3&&xn&&(xn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else pt(t)?(t={default:t,_ctx:xn},o=32):(t=String(t),a&64?(o=16,t=[Qe(t)]):o=8);e.children=t,e.shapeFlag|=o}function Vp(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const s in a)if(s==="class")t.class!==a.class&&(t.class=ve([t.class,a.class]));else if(s==="style")t.style=et([t.style,a.style]);else if(Xr(s)){const i=t[s],r=a[s];r&&i!==r&&!(lt(i)&&i.includes(r))&&(t[s]=i?[].concat(i,r):r)}else s!==""&&(t[s]=a[s])}return t}function us(e,t,o,a=null){os(e,t,7,[o,a])}const dy=$p();let hy=0;function fy(e,t,o){const a=e.type,s=(t?t.appContext:e.appContext)||dy,i={uid:hy++,vnode:e,type:a,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Pf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Dp(a,s),emitsOptions:Tp(a,s),emit:null,emitted:null,propsDefaults:Vt,inheritAttrs:a.inheritAttrs,ctx:Vt,data:Vt,props:Vt,attrs:Vt,slots:Vt,refs:Vt,setupState:Vt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=jg.bind(null,i),e.ce&&e.ce(i),i}let Nn=null;const dc=()=>Nn||xn;let Nr,pu;{const e=oc(),t=(o,a)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(a),i=>{s.length>1?s.forEach(r=>r(i)):s[0](i)}};Nr=t("__VUE_INSTANCE_SETTERS__",o=>Nn=o),pu=t("__VUE_SSR_SETTERS__",o=>Fl=o)}const Zl=e=>{const t=Nn;return Nr(e),e.scope.on(),()=>{e.scope.off(),Nr(t)}},Xd=()=>{Nn&&Nn.scope.off(),Nr(null)};function Gp(e){return e.vnode.shapeFlag&4}let Fl=!1;function py(e,t=!1,o=!1){t&&pu(t);const{props:a,children:s}=e.vnode,i=Gp(e);Yg(e,a,i,t),ty(e,s,o||t);const r=i?vy(e,t):void 0;return t&&pu(!1),r}function vy(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Rg);const{setup:a}=o;if(a){zs();const s=e.setupContext=a.length>1?gy(e):null,i=Zl(e),r=jl(a,e,0,[e.props,s]),u=If(r);if(Hs(),i(),(u||e.sp)&&!zi(e)&&gp(e),u){if(r.then(Xd,Xd),t)return r.then(d=>{Qd(e,d)}).catch(d=>{ic(d,e,0)});e.asyncDep=r}else Qd(e,r)}else jp(e)}function Qd(e,t,o){pt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ft(t)&&(e.setupState=Xf(t)),jp(e)}function jp(e,t,o){const a=e.type;e.render||(e.render=a.render||Xo);{const s=Zl(e);zs();try{Bg(e)}finally{Hs(),s()}}}const my={get(e,t){return Rn(e,"get",""),e[t]}};function gy(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,my),slots:e.slots,emit:e.emit,expose:t}}function hc(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Xf(Wu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Il)return Il[o](e)},has(t,o){return o in t||o in Il}})):e.proxy}function yy(e,t=!0){return pt(e)?e.displayName||e.name:e.name||t&&e.__name}function ky(e){return pt(e)&&"__vccOpts"in e}const U=(e,t)=>fg(e,t,Fl);function td(e,t,o){try{Rr(-1);const a=arguments.length;return a===2?Ft(t)&&!lt(t)?Nl(t)?Ee(e,null,[t]):Ee(e,t):Ee(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&Nl(o)&&(o=[o]),Ee(e,t,o))}finally{Rr(1)}}const _y="3.5.26";let vu;const eh=typeof window<"u"&&window.trustedTypes;if(eh)try{vu=eh.createPolicy("vue",{createHTML:e=>e})}catch{}const Zp=vu?e=>vu.createHTML(e):e=>e,by="http://www.w3.org/2000/svg",wy="http://www.w3.org/1998/Math/MathML",Es=typeof document<"u"?document:null,th=Es&&Es.createElement("template"),Cy={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const s=t==="svg"?Es.createElementNS(by,e):t==="mathml"?Es.createElementNS(wy,e):o?Es.createElement(e,{is:o}):Es.createElement(e);return e==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:e=>Es.createTextNode(e),createComment:e=>Es.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Es.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,s,i){const r=o?o.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===i||!(s=s.nextSibling)););else{th.innerHTML=Zp(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=th.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[r?r.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},da="transition",hl="animation",Ul=Symbol("_vtc"),qp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Ly=yn({},dp,qp),Sy=e=>(e.displayName="Transition",e.props=Ly,e),es=Sy((e,{slots:t})=>td(Sg,Iy(e),t)),Wa=(e,t=[])=>{lt(e)?e.forEach(o=>o(...t)):e&&e(...t)},nh=e=>e?lt(e)?e.some(t=>t.length>1):e.length>1:!1;function Iy(e){const t={};for(const G in e)G in qp||(t[G]=e[G]);if(e.css===!1)return t;const{name:o="v",type:a,duration:s,enterFromClass:i=`${o}-enter-from`,enterActiveClass:r=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:h=r,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:_=`${o}-leave-to`}=e,b=xy(s),C=b&&b[0],I=b&&b[1],{onBeforeEnter:$,onEnter:x,onEnterCancelled:S,onLeave:B,onLeaveCancelled:E,onBeforeAppear:q=$,onAppear:P=x,onAppearCancelled:F=S}=t,R=(G,Q,se,pe)=>{G._enterCancelled=pe,Ka(G,Q?p:u),Ka(G,Q?h:r),se&&se()},j=(G,Q)=>{G._isLeaving=!1,Ka(G,g),Ka(G,_),Ka(G,y),Q&&Q()},O=G=>(Q,se)=>{const pe=G?P:x,ee=()=>R(Q,G,se);Wa(pe,[Q,ee]),oh(()=>{Ka(Q,G?d:i),Ms(Q,G?p:u),nh(pe)||sh(Q,a,C,ee)})};return yn(t,{onBeforeEnter(G){Wa($,[G]),Ms(G,i),Ms(G,r)},onBeforeAppear(G){Wa(q,[G]),Ms(G,d),Ms(G,h)},onEnter:O(!1),onAppear:O(!0),onLeave(G,Q){G._isLeaving=!0;const se=()=>j(G,Q);Ms(G,g),G._enterCancelled?(Ms(G,y),lh(G)):(lh(G),Ms(G,y)),oh(()=>{G._isLeaving&&(Ka(G,g),Ms(G,_),nh(B)||sh(G,a,I,se))}),Wa(B,[G,se])},onEnterCancelled(G){R(G,!1,void 0,!0),Wa(S,[G])},onAppearCancelled(G){R(G,!0,void 0,!0),Wa(F,[G])},onLeaveCancelled(G){j(G),Wa(E,[G])}})}function xy(e){if(e==null)return null;if(Ft(e))return[Vc(e.enter),Vc(e.leave)];{const t=Vc(e);return[t,t]}}function Vc(e){return Am(e)}function Ms(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Ul]||(e[Ul]=new Set)).add(t)}function Ka(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Ul];o&&(o.delete(t),o.size||(e[Ul]=void 0))}function oh(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let $y=0;function sh(e,t,o,a){const s=e._endId=++$y,i=()=>{s===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:r,timeout:u,propCount:d}=Ty(e,t);if(!r)return a();const h=r+"end";let p=0;const g=()=>{e.removeEventListener(h,y),i()},y=_=>{_.target===e&&++p>=d&&g()};setTimeout(()=>{p<d&&g()},u+1),e.addEventListener(h,y)}function Ty(e,t){const o=window.getComputedStyle(e),a=b=>(o[b]||"").split(", "),s=a(`${da}Delay`),i=a(`${da}Duration`),r=ah(s,i),u=a(`${hl}Delay`),d=a(`${hl}Duration`),h=ah(u,d);let p=null,g=0,y=0;t===da?r>0&&(p=da,g=r,y=i.length):t===hl?h>0&&(p=hl,g=h,y=d.length):(g=Math.max(r,h),p=g>0?r>h?da:hl:null,y=p?p===da?i.length:d.length:0);const _=p===da&&/\b(?:transform|all)(?:,|$)/.test(a(`${da}Property`).toString());return{type:p,timeout:g,propCount:y,hasTransform:_}}function ah(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>ih(o)+ih(e[a])))}function ih(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function lh(e){return(e?e.ownerDocument:document).body.offsetHeight}function My(e,t,o){const a=e[Ul];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Fr=Symbol("_vod"),Wp=Symbol("_vsh"),ys={name:"show",beforeMount(e,{value:t},{transition:o}){e[Fr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):fl(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),fl(e,!0),a.enter(e)):a.leave(e,()=>{fl(e,!1)}):fl(e,t))},beforeUnmount(e,{value:t}){fl(e,t)}};function fl(e,t){e.style.display=t?e[Fr]:"none",e[Wp]=!t}const Kp=Symbol("");function Ay(e){const t=dc();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Ur(i,s))},a=()=>{const s=e(t.proxy);t.ce?Ur(t.ce,s):mu(t.subTree,s),o(s)};kp(()=>{tp(a)}),Qt(()=>{Ze(a,Xo,{flush:"post"});const s=new MutationObserver(a);s.observe(t.subTree.el.parentNode,{childList:!0}),kn(()=>s.disconnect())})}function mu(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{mu(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Ur(e.el,t);else if(e.type===Me)e.children.forEach(o=>mu(o,t));else if(e.type===xl){let{el:o,anchor:a}=e;for(;o&&(Ur(o,t),o!==a);)o=o.nextSibling}}function Ur(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const s in t){const i=Fm(t[s]);o.setProperty(`--${s}`,i),a+=`--${s}: ${i};`}o[Kp]=a}}const Ey=/(?:^|;)\s*display\s*:/;function Py(e,t,o){const a=e.style,s=Xt(o);let i=!1;if(o&&!s){if(t)if(Xt(t))for(const r of t.split(";")){const u=r.slice(0,r.indexOf(":")).trim();o[u]==null&&Cr(a,u,"")}else for(const r in t)o[r]==null&&Cr(a,r,"");for(const r in o)r==="display"&&(i=!0),Cr(a,r,o[r])}else if(s){if(t!==o){const r=a[Kp];r&&(o+=";"+r),a.cssText=o,i=Ey.test(o)}}else t&&e.removeAttribute("style");Fr in e&&(e[Fr]=i?a.display:"",e[Wp]&&(a.display="none"))}const rh=/\s*!important$/;function Cr(e,t,o){if(lt(o))o.forEach(a=>Cr(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Dy(e,t);rh.test(o)?e.setProperty(Ta(a),o.replace(rh,""),"important"):e[a]=o}}const ch=["Webkit","Moz","ms"],Gc={};function Dy(e,t){const o=Gc[t];if(o)return o;let a=Ro(t);if(a!=="filter"&&a in e)return Gc[t]=a;a=tc(a);for(let s=0;s<ch.length;s++){const i=ch[s]+a;if(i in e)return Gc[t]=i}return t}const uh="http://www.w3.org/1999/xlink";function dh(e,t,o,a,s,i=Bm(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(uh,t.slice(6,t.length)):e.setAttributeNS(uh,t,o):o==null||i&&!Mf(o)?e.removeAttribute(t):e.setAttribute(t,i?"":ts(o)?String(o):o)}function hh(e,t,o,a,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Zp(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let r=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Mf(o):o==null&&u==="string"?(o="",r=!0):u==="number"&&(o=0,r=!0)}try{e[t]=o}catch{}r&&e.removeAttribute(s||t)}function Rs(e,t,o,a){e.addEventListener(t,o,a)}function Oy(e,t,o,a){e.removeEventListener(t,o,a)}const fh=Symbol("_vei");function Ry(e,t,o,a,s=null){const i=e[fh]||(e[fh]={}),r=i[t];if(a&&r)r.value=a;else{const[u,d]=By(t);if(a){const h=i[t]=Uy(a,s);Rs(e,u,h,d)}else r&&(Oy(e,u,r,d),i[t]=void 0)}}const ph=/(?:Once|Passive|Capture)$/;function By(e){let t;if(ph.test(e)){t={};let a;for(;a=e.match(ph);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ta(e.slice(2)),t]}let jc=0;const Ny=Promise.resolve(),Fy=()=>jc||(Ny.then(()=>jc=0),jc=Date.now());function Uy(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;os(zy(a,o.value),t,5,[a])};return o.value=e,o.attached=Fy(),o}function zy(e,t){if(lt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>s=>!s._stopped&&a&&a(s))}else return t}const vh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Hy=(e,t,o,a,s,i)=>{const r=s==="svg";t==="class"?My(e,a,r):t==="style"?Py(e,o,a):Xr(t)?Fu(t)||Ry(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Vy(e,t,a,r))?(hh(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&dh(e,t,a,r,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Xt(a))?hh(e,Ro(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),dh(e,t,a,r))};function Vy(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&vh(t)&&pt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return vh(t)&&Xt(o)?!1:t in e}const xa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return lt(t)?o=>_r(t,o):t};function Gy(e){e.target.composing=!0}function mh(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Oo=Symbol("_assign");function gh(e,t,o){return t&&(e=e.trim()),o&&(e=nc(e)),e}const tt={created(e,{modifiers:{lazy:t,trim:o,number:a}},s){e[Oo]=xa(s);const i=a||s.props&&s.props.type==="number";Rs(e,t?"change":"input",r=>{r.target.composing||e[Oo](gh(e.value,o,i))}),(o||i)&&Rs(e,"change",()=>{e.value=gh(e.value,o,i)}),t||(Rs(e,"compositionstart",Gy),Rs(e,"compositionend",mh),Rs(e,"change",mh))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:s,number:i}},r){if(e[Oo]=xa(r),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?nc(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Gs={deep:!0,created(e,t,o){e[Oo]=xa(o),Rs(e,"change",()=>{const a=e._modelValue,s=Gi(e),i=e.checked,r=e[Oo];if(lt(a)){const u=zu(a,s),d=u!==-1;if(i&&!d)r(a.concat(s));else if(!i&&d){const h=[...a];h.splice(u,1),r(h)}}else if(Wi(a)){const u=new Set(a);i?u.add(s):u.delete(s),r(u)}else r(Jp(e,i))})},mounted:yh,beforeUpdate(e,t,o){e[Oo]=xa(o),yh(e,t,o)}};function yh(e,{value:t,oldValue:o},a){e._modelValue=t;let s;if(lt(t))s=zu(t,a.props.value)>-1;else if(Wi(t))s=t.has(a.props.value);else{if(t===o)return;s=ri(t,Jp(e,!0))}e.checked!==s&&(e.checked=s)}const kh={created(e,{value:t},o){e.checked=ri(t,o.props.value),e[Oo]=xa(o),Rs(e,"change",()=>{e[Oo](Gi(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Oo]=xa(a),t!==o&&(e.checked=ri(t,a.props.value))}},Fn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const s=Wi(t);Rs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,r=>r.selected).map(r=>o?nc(Gi(r)):Gi(r));e[Oo](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,sn(()=>{e._assigning=!1})}),e[Oo]=xa(a)},mounted(e,{value:t}){_h(e,t)},beforeUpdate(e,t,o){e[Oo]=xa(o)},updated(e,{value:t}){e._assigning||_h(e,t)}};function _h(e,t){const o=e.multiple,a=lt(t);if(!(o&&!a&&!Wi(t))){for(let s=0,i=e.options.length;s<i;s++){const r=e.options[s],u=Gi(r);if(o)if(a){const d=typeof u;d==="string"||d==="number"?r.selected=t.some(h=>String(h)===String(u)):r.selected=zu(t,u)>-1}else r.selected=t.has(u);else if(ri(Gi(r),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Gi(e){return"_value"in e?e._value:e.value}function Jp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const jy=["ctrl","shift","alt","meta"],Zy={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>jy.some(o=>e[`${o}Key`]&&!t.includes(o))},it=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((s,...i)=>{for(let r=0;r<t.length;r++){const u=Zy[t[r]];if(u&&u(s,t))return}return e(s,...i)}))},qy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Jo=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(s=>{if(!("key"in s))return;const i=Ta(s.key);if(t.some(r=>r===i||qy[r]===i))return e(s)}))},Wy=yn({patchProp:Hy},Cy);let bh;function Ky(){return bh||(bh=oy(Wy))}const Jy=((...e)=>{const t=Ky().createApp(...e),{mount:o}=t;return t.mount=a=>{const s=Xy(a);if(!s)return;const i=t._component;!pt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const r=o(s,!1,Yy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t});function Yy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Xy(e){return Xt(e)?document.querySelector(e):e}let Yp;const fc=e=>Yp=e,Xp=Symbol();function gu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Tl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Tl||(Tl={}));function Qy(){const e=Df(!0),t=e.run(()=>M({}));let o=[],a=[];const s=Wu({install(i){fc(s),s._a=i,i.provide(Xp,s),i.config.globalProperties.$pinia=s,a.forEach(r=>o.push(r)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Qp=()=>{};function wh(e,t,o,a=Qp){e.add(t);const s=()=>{e.delete(t)&&a()};return!o&&Of()&&Um(s),s}function Ei(e,...t){e.forEach(o=>{o(...t)})}const e1=e=>e(),Ch=Symbol(),Zc=Symbol();function yu(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],s=e[o];gu(s)&&gu(a)&&e.hasOwnProperty(o)&&!Yt(a)&&!Us(a)?e[o]=yu(s,a):e[o]=a}return e}const t1=Symbol();function n1(e){return!gu(e)||!Object.prototype.hasOwnProperty.call(e,t1)}const{assign:fa}=Object;function o1(e){return!!(Yt(e)&&e.effect)}function s1(e,t,o,a){const{state:s,actions:i,getters:r}=t,u=o.state.value[e];let d;function h(){u||(o.state.value[e]=s?s():{});const p=cg(o.state.value[e]);return fa(p,i,Object.keys(r||{}).reduce((g,y)=>(g[y]=Wu(U(()=>{fc(o);const _=o._s.get(e);return r[y].call(_,_)})),g),{}))}return d=ev(e,h,t,o,a,!0),d}function ev(e,t,o={},a,s,i){let r;const u=fa({actions:{}},o),d={deep:!0};let h,p,g=new Set,y=new Set,_;const b=a.state.value[e];!i&&!b&&(a.state.value[e]={}),M({});let C;function I(F){let R;h=p=!1,typeof F=="function"?(F(a.state.value[e]),R={type:Tl.patchFunction,storeId:e,events:_}):(yu(a.state.value[e],F),R={type:Tl.patchObject,payload:F,storeId:e,events:_});const j=C=Symbol();sn().then(()=>{C===j&&(h=!0)}),p=!0,Ei(g,R,a.state.value[e])}const $=i?function(){const{state:R}=o,j=R?R():{};this.$patch(O=>{fa(O,j)})}:Qp;function x(){r.stop(),g.clear(),y.clear(),a._s.delete(e)}const S=(F,R="")=>{if(Ch in F)return F[Zc]=R,F;const j=function(){fc(a);const O=Array.from(arguments),G=new Set,Q=new Set;function se(te){G.add(te)}function pe(te){Q.add(te)}Ei(y,{args:O,name:j[Zc],store:E,after:se,onError:pe});let ee;try{ee=F.apply(this&&this.$id===e?this:E,O)}catch(te){throw Ei(Q,te),te}return ee instanceof Promise?ee.then(te=>(Ei(G,te),te)).catch(te=>(Ei(Q,te),Promise.reject(te))):(Ei(G,ee),ee)};return j[Ch]=!0,j[Zc]=R,j},B={_p:a,$id:e,$onAction:wh.bind(null,y),$patch:I,$reset:$,$subscribe(F,R={}){const j=wh(g,F,R.detached,()=>O()),O=r.run(()=>Ze(()=>a.state.value[e],G=>{(R.flush==="sync"?p:h)&&F({storeId:e,type:Tl.direct,events:_},G)},fa({},d,R)));return j},$dispose:x},E=ui(B);a._s.set(e,E);const P=(a._a&&a._a.runWithContext||e1)(()=>a._e.run(()=>(r=Df()).run(()=>t({action:S}))));for(const F in P){const R=P[F];if(Yt(R)&&!o1(R)||Us(R))i||(b&&n1(R)&&(Yt(R)?R.value=b[F]:yu(R,b[F])),a.state.value[e][F]=R);else if(typeof R=="function"){const j=S(R,F);P[F]=j,u.actions[F]=R}}return fa(E,P),fa(Mt(E),P),Object.defineProperty(E,"$state",{get:()=>a.state.value[e],set:F=>{I(R=>{fa(R,F)})}}),a._p.forEach(F=>{fa(E,r.run(()=>F({store:E,app:a._a,pinia:a,options:u})))}),b&&i&&o.hydrate&&o.hydrate(E.$state,b),h=!0,p=!0,E}function nd(e,t,o){let a;const s=typeof t=="function";a=s?o:t;function i(r,u){const d=yg();return r=r||(d?uo(Xp,null):null),r&&fc(r),r=Yp,r._s.has(e)||(s?ev(e,t,a,r):s1(e,a,r)),r._s.get(e)}return i.$id=e,i}const Di=typeof document<"u";function tv(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function a1(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&tv(e.default)}const Pt=Object.assign;function qc(e,t){const o={};for(const a in t){const s=t[a];o[a]=ss(s)?s.map(e):e(s)}return o}const Ml=()=>{},ss=Array.isArray;function Lh(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const nv=/#/g,i1=/&/g,l1=/\//g,r1=/=/g,c1=/\?/g,ov=/\+/g,u1=/%5B/g,d1=/%5D/g,sv=/%5E/g,h1=/%60/g,av=/%7B/g,f1=/%7C/g,iv=/%7D/g,p1=/%20/g;function od(e){return e==null?"":encodeURI(""+e).replace(f1,"|").replace(u1,"[").replace(d1,"]")}function v1(e){return od(e).replace(av,"{").replace(iv,"}").replace(sv,"^")}function ku(e){return od(e).replace(ov,"%2B").replace(p1,"+").replace(nv,"%23").replace(i1,"%26").replace(h1,"`").replace(av,"{").replace(iv,"}").replace(sv,"^")}function m1(e){return ku(e).replace(r1,"%3D")}function g1(e){return od(e).replace(nv,"%23").replace(c1,"%3F")}function y1(e){return g1(e).replace(l1,"%2F")}function zl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const k1=/\/$/,_1=e=>e.replace(k1,"");function Wc(e,t,o="/"){let a,s={},i="",r="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),s=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),r=t.slice(u,t.length)),a=L1(a??t,o),{fullPath:a+i+r,path:a,query:s,hash:zl(r)}}function b1(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function Sh(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function w1(e,t,o){const a=t.matched.length-1,s=o.matched.length-1;return a>-1&&a===s&&ji(t.matched[a],o.matched[s])&&lv(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function ji(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function lv(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!C1(e[o],t[o]))return!1;return!0}function C1(e,t){return ss(e)?Ih(e,t):ss(t)?Ih(t,e):e?.valueOf()===t?.valueOf()}function Ih(e,t){return ss(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function L1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),s=a[a.length-1];(s===".."||s===".")&&a.push("");let i=o.length-1,r,u;for(r=0;r<a.length;r++)if(u=a[r],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(r).join("/")}const ha={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let _u=(function(e){return e.pop="pop",e.push="push",e})({}),Kc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function S1(e){if(!e)if(Di){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),_1(e)}const I1=/^[^#]+#/;function x1(e,t){return e.replace(I1,"#")+t}function $1(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const pc=()=>({left:window.scrollX,top:window.scrollY});function T1(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=$1(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function xh(e,t){return(history.state?history.state.position-t:-1)+e}const bu=new Map;function M1(e,t){bu.set(e,t)}function A1(e){const t=bu.get(e);return bu.delete(e),t}function E1(e){return typeof e=="string"||e&&typeof e=="object"}function rv(e){return typeof e=="string"||typeof e=="symbol"}let tn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const cv=Symbol("");tn.MATCHER_NOT_FOUND+"",tn.NAVIGATION_GUARD_REDIRECT+"",tn.NAVIGATION_ABORTED+"",tn.NAVIGATION_CANCELLED+"",tn.NAVIGATION_DUPLICATED+"";function Zi(e,t){return Pt(new Error,{type:e,[cv]:!0},t)}function As(e,t){return e instanceof Error&&cv in e&&(t==null||!!(e.type&t))}const P1=["params","query","hash"];function D1(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of P1)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function O1(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const s=o[a].replace(ov," "),i=s.indexOf("="),r=zl(i<0?s:s.slice(0,i)),u=i<0?null:zl(s.slice(i+1));if(r in t){let d=t[r];ss(d)||(d=t[r]=[d]),d.push(u)}else t[r]=u}return t}function $h(e){let t="";for(let o in e){const a=e[o];if(o=m1(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(ss(a)?a.map(s=>s&&ku(s)):[a&&ku(a)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function R1(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=ss(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return t}const B1=Symbol(""),Th=Symbol(""),vc=Symbol(""),sd=Symbol(""),wu=Symbol("");function pl(){let e=[];function t(a){return e.push(a),()=>{const s=e.indexOf(a);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function ya(e,t,o,a,s,i=r=>r()){const r=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const h=y=>{y===!1?d(Zi(tn.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):E1(y)?d(Zi(tn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(r&&a.enterCallbacks[s]===r&&typeof y=="function"&&r.push(y),u())},p=i(()=>e.call(a&&a.instances[s],t,o,h));let g=Promise.resolve(p);e.length<3&&(g=g.then(h)),g.catch(y=>d(y))})}function Jc(e,t,o,a,s=i=>i()){const i=[];for(const r of e)for(const u in r.components){let d=r.components[u];if(!(t!=="beforeRouteEnter"&&!r.instances[u]))if(tv(d)){const h=(d.__vccOpts||d)[t];h&&i.push(ya(h,o,a,r,u,s))}else{let h=d();i.push(()=>h.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${r.path}"`);const g=a1(p)?p.default:p;r.mods[u]=p,r.components[u]=g;const y=(g.__vccOpts||g)[t];return y&&ya(y,o,a,r,u,s)()}))}}return i}function N1(e,t){const o=[],a=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let r=0;r<i;r++){const u=t.matched[r];u&&(e.matched.find(h=>ji(h,u))?a.push(u):o.push(u));const d=e.matched[r];d&&(t.matched.find(h=>ji(h,d))||s.push(d))}return[o,a,s]}let F1=()=>location.protocol+"//"+location.host;function uv(e,t){const{pathname:o,search:a,hash:s}=t,i=e.indexOf("#");if(i>-1){let r=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(r);return u[0]!=="/"&&(u="/"+u),Sh(u,"")}return Sh(o,e)+a+s}function U1(e,t,o,a){let s=[],i=[],r=null;const u=({state:y})=>{const _=uv(e,location),b=o.value,C=t.value;let I=0;if(y){if(o.value=_,t.value=y,r&&r===b){r=null;return}I=C?y.position-C.position:0}else a(_);s.forEach($=>{$(o.value,b,{delta:I,type:_u.pop,direction:I?I>0?Kc.forward:Kc.back:Kc.unknown})})};function d(){r=o.value}function h(y){s.push(y);const _=()=>{const b=s.indexOf(y);b>-1&&s.splice(b,1)};return i.push(_),_}function p(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Pt({},y.state,{scroll:pc()}),"")}}function g(){for(const y of i)y();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:d,listen:h,destroy:g}}function Mh(e,t,o,a=!1,s=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:s?pc():null}}function z1(e){const{history:t,location:o}=window,a={value:uv(e,o)},s={value:t.state};s.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,p){const g=e.indexOf("#"),y=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:F1()+e+d;try{t[p?"replaceState":"pushState"](h,"",y),s.value=h}catch(_){console.error(_),o[p?"replace":"assign"](y)}}function r(d,h){i(d,Pt({},t.state,Mh(s.value.back,d,s.value.forward,!0),h,{position:s.value.position}),!0),a.value=d}function u(d,h){const p=Pt({},s.value,t.state,{forward:d,scroll:pc()});i(p.current,p,!0),i(d,Pt({},Mh(a.value,d,null),{position:p.position+1},h),!1),a.value=d}return{location:a,state:s,push:u,replace:r}}function H1(e){e=S1(e);const t=z1(e),o=U1(e,t.state,t.location,t.replace);function a(i,r=!0){r||o.pauseListeners(),history.go(i)}const s=Pt({location:"",base:e,go:a,createHref:x1.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function V1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),H1(e)}let ni=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var fn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(fn||{});const G1={type:ni.Static,value:""},j1=/[a-zA-Z0-9_]/;function Z1(e){if(!e)return[[]];if(e==="/")return[[G1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(_){throw new Error(`ERR (${o})/"${h}": ${_}`)}let o=fn.Static,a=o;const s=[];let i;function r(){i&&s.push(i),i=[]}let u=0,d,h="",p="";function g(){h&&(o===fn.Static?i.push({type:ni.Static,value:h}):o===fn.Param||o===fn.ParamRegExp||o===fn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:ni.Param,value:h,regexp:p,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==fn.ParamRegExp){a=o,o=fn.EscapeNext;continue}switch(o){case fn.Static:d==="/"?(h&&g(),r()):d===":"?(g(),o=fn.Param):y();break;case fn.EscapeNext:y(),o=a;break;case fn.Param:d==="("?o=fn.ParamRegExp:j1.test(d)?y():(g(),o=fn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case fn.ParamRegExp:d===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+d:o=fn.ParamRegExpEnd:p+=d;break;case fn.ParamRegExpEnd:g(),o=fn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===fn.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),g(),r(),s}const Ah="[^/]+?",q1={sensitive:!1,strict:!1,start:!0,end:!0};var Wn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Wn||{});const W1=/[.+*?^${}()[\]/\\]/g;function K1(e,t){const o=Pt({},q1,t),a=[];let s=o.start?"^":"";const i=[];for(const h of e){const p=h.length?[]:[Wn.Root];o.strict&&!h.length&&(s+="/");for(let g=0;g<h.length;g++){const y=h[g];let _=Wn.Segment+(o.sensitive?Wn.BonusCaseSensitive:0);if(y.type===ni.Static)g||(s+="/"),s+=y.value.replace(W1,"\\$&"),_+=Wn.Static;else if(y.type===ni.Param){const{value:b,repeatable:C,optional:I,regexp:$}=y;i.push({name:b,repeatable:C,optional:I});const x=$||Ah;if(x!==Ah){_+=Wn.BonusCustomRegExp;try{`${x}`}catch(B){throw new Error(`Invalid custom RegExp for param "${b}" (${x}): `+B.message)}}let S=C?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;g||(S=I&&h.length<2?`(?:/${S})`:"/"+S),I&&(S+="?"),s+=S,_+=Wn.Dynamic,I&&(_+=Wn.BonusOptional),C&&(_+=Wn.BonusRepeatable),x===".*"&&(_+=Wn.BonusWildcard)}p.push(_)}a.push(p)}if(o.strict&&o.end){const h=a.length-1;a[h][a[h].length-1]+=Wn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const r=new RegExp(s,o.sensitive?"":"i");function u(h){const p=h.match(r),g={};if(!p)return null;for(let y=1;y<p.length;y++){const _=p[y]||"",b=i[y-1];g[b.name]=_&&b.repeatable?_.split("/"):_}return g}function d(h){let p="",g=!1;for(const y of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const _ of y)if(_.type===ni.Static)p+=_.value;else if(_.type===ni.Param){const{value:b,repeatable:C,optional:I}=_,$=b in h?h[b]:"";if(ss($)&&!C)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const x=ss($)?$.join("/"):$;if(!x)if(I)y.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${b}"`);p+=x}}return p||"/"}return{re:r,score:a,keys:i,parse:u,stringify:d}}function J1(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Wn.Static+Wn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Wn.Static+Wn.Segment?1:-1:0}function dv(e,t){let o=0;const a=e.score,s=t.score;for(;o<a.length&&o<s.length;){const i=J1(a[o],s[o]);if(i)return i;o++}if(Math.abs(s.length-a.length)===1){if(Eh(a))return 1;if(Eh(s))return-1}return s.length-a.length}function Eh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Y1={strict:!1,end:!0,sensitive:!1};function X1(e,t,o){const a=K1(Z1(e.path),o),s=Pt(a,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function Q1(e,t){const o=[],a=new Map;t=Lh(Y1,t);function s(g){return a.get(g)}function i(g,y,_){const b=!_,C=Dh(g);C.aliasOf=_&&_.record;const I=Lh(t,g),$=[C];if("alias"in g){const B=typeof g.alias=="string"?[g.alias]:g.alias;for(const E of B)$.push(Dh(Pt({},C,{components:_?_.record.components:C.components,path:E,aliasOf:_?_.record:C})))}let x,S;for(const B of $){const{path:E}=B;if(y&&E[0]!=="/"){const q=y.record.path,P=q[q.length-1]==="/"?"":"/";B.path=y.record.path+(E&&P+E)}if(x=X1(B,y,I),_?_.alias.push(x):(S=S||x,S!==x&&S.alias.push(x),b&&g.name&&!Oh(x)&&r(g.name)),hv(x)&&d(x),C.children){const q=C.children;for(let P=0;P<q.length;P++)i(q[P],x,_&&_.children[P])}_=_||x}return S?()=>{r(S)}:Ml}function r(g){if(rv(g)){const y=a.get(g);y&&(a.delete(g),o.splice(o.indexOf(y),1),y.children.forEach(r),y.alias.forEach(r))}else{const y=o.indexOf(g);y>-1&&(o.splice(y,1),g.record.name&&a.delete(g.record.name),g.children.forEach(r),g.alias.forEach(r))}}function u(){return o}function d(g){const y=nk(g,o);o.splice(y,0,g),g.record.name&&!Oh(g)&&a.set(g.record.name,g)}function h(g,y){let _,b={},C,I;if("name"in g&&g.name){if(_=a.get(g.name),!_)throw Zi(tn.MATCHER_NOT_FOUND,{location:g});I=_.record.name,b=Pt(Ph(y.params,_.keys.filter(S=>!S.optional).concat(_.parent?_.parent.keys.filter(S=>S.optional):[]).map(S=>S.name)),g.params&&Ph(g.params,_.keys.map(S=>S.name))),C=_.stringify(b)}else if(g.path!=null)C=g.path,_=o.find(S=>S.re.test(C)),_&&(b=_.parse(C),I=_.record.name);else{if(_=y.name?a.get(y.name):o.find(S=>S.re.test(y.path)),!_)throw Zi(tn.MATCHER_NOT_FOUND,{location:g,currentLocation:y});I=_.record.name,b=Pt({},y.params,g.params),C=_.stringify(b)}const $=[];let x=_;for(;x;)$.unshift(x.record),x=x.parent;return{name:I,path:C,params:b,matched:$,meta:tk($)}}e.forEach(g=>i(g));function p(){o.length=0,a.clear()}return{addRoute:i,resolve:h,removeRoute:r,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function Ph(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function Dh(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:ek(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function ek(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function Oh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function tk(e){return e.reduce((t,o)=>Pt(t,o.meta),{})}function nk(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;dv(e,t[i])<0?a=i:o=i+1}const s=ok(e);return s&&(a=t.lastIndexOf(s,a-1)),a}function ok(e){let t=e;for(;t=t.parent;)if(hv(t)&&dv(e,t)===0)return t}function hv({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Rh(e){const t=uo(vc),o=uo(sd),a=U(()=>{const d=D(e.to);return t.resolve(d)}),s=U(()=>{const{matched:d}=a.value,{length:h}=d,p=d[h-1],g=o.matched;if(!p||!g.length)return-1;const y=g.findIndex(ji.bind(null,p));if(y>-1)return y;const _=Bh(d[h-2]);return h>1&&Bh(p)===_&&g[g.length-1].path!==_?g.findIndex(ji.bind(null,d[h-2])):y}),i=U(()=>s.value>-1&&rk(o.params,a.value.params)),r=U(()=>s.value>-1&&s.value===o.matched.length-1&&lv(o.params,a.value.params));function u(d={}){if(lk(d)){const h=t[D(e.replace)?"replace":"push"](D(e.to)).catch(Ml);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:a,href:U(()=>a.value.href),isActive:i,isExactActive:r,navigate:u}}function sk(e){return e.length===1?e[0]:e}const ak=mp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Rh,setup(e,{slots:t}){const o=ui(Rh(e)),{options:a}=uo(vc),s=U(()=>({[Nh(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[Nh(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&sk(t.default(o));return e.custom?i:td("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},i)}}}),ik=ak;function lk(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function rk(e,t){for(const o in t){const a=t[o],s=e[o];if(typeof a=="string"){if(a!==s)return!1}else if(!ss(s)||s.length!==a.length||a.some((i,r)=>i.valueOf()!==s[r].valueOf()))return!1}return!0}function Bh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Nh=(e,t,o)=>e??t??o,ck=mp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=uo(wu),s=U(()=>e.route||a.value),i=uo(Th,0),r=U(()=>{let h=D(i);const{matched:p}=s.value;let g;for(;(g=p[h])&&!g.components;)h++;return h}),u=U(()=>s.value.matched[r.value]);Cl(Th,U(()=>r.value+1)),Cl(B1,u),Cl(wu,s);const d=M();return Ze(()=>[d.value,u.value,e.name],([h,p,g],[y,_,b])=>{p&&(p.instances[g]=h,_&&_!==p&&h&&h===y&&(p.leaveGuards.size||(p.leaveGuards=_.leaveGuards),p.updateGuards.size||(p.updateGuards=_.updateGuards))),h&&p&&(!_||!ji(p,_)||!y)&&(p.enterCallbacks[g]||[]).forEach(C=>C(h))},{flush:"post"}),()=>{const h=s.value,p=e.name,g=u.value,y=g&&g.components[p];if(!y)return Fh(o.default,{Component:y,route:h});const _=g.props[p],b=_?_===!0?h.params:typeof _=="function"?_(h):_:null,I=td(y,Pt({},b,t,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(g.instances[p]=null)},ref:d}));return Fh(o.default,{Component:I,route:h})||I}}});function Fh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const uk=ck;function dk(e){const t=Q1(e.routes,e),o=e.parseQuery||O1,a=e.stringifyQuery||$h,s=e.history,i=pl(),r=pl(),u=pl(),d=ig(ha);let h=ha;Di&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=qc.bind(null,X=>""+X),g=qc.bind(null,y1),y=qc.bind(null,zl);function _(X,_e){let Le,me;return rv(X)?(Le=t.getRecordMatcher(X),me=_e):me=X,t.addRoute(me,Le)}function b(X){const _e=t.getRecordMatcher(X);_e&&t.removeRoute(_e)}function C(){return t.getRoutes().map(X=>X.record)}function I(X){return!!t.getRecordMatcher(X)}function $(X,_e){if(_e=Pt({},_e||d.value),typeof X=="string"){const ae=Wc(o,X,_e.path),Te=t.resolve({path:ae.path},_e),Be=s.createHref(ae.fullPath);return Pt(ae,Te,{params:y(Te.params),hash:zl(ae.hash),redirectedFrom:void 0,href:Be})}let Le;if(X.path!=null)Le=Pt({},X,{path:Wc(o,X.path,_e.path).path});else{const ae=Pt({},X.params);for(const Te in ae)ae[Te]==null&&delete ae[Te];Le=Pt({},X,{params:g(ae)}),_e.params=g(_e.params)}const me=t.resolve(Le,_e),ce=X.hash||"";me.params=p(y(me.params));const N=b1(a,Pt({},X,{hash:v1(ce),path:me.path})),K=s.createHref(N);return Pt({fullPath:N,hash:ce,query:a===$h?R1(X.query):X.query||{}},me,{redirectedFrom:void 0,href:K})}function x(X){return typeof X=="string"?Wc(o,X,d.value.path):Pt({},X)}function S(X,_e){if(h!==X)return Zi(tn.NAVIGATION_CANCELLED,{from:_e,to:X})}function B(X){return P(X)}function E(X){return B(Pt(x(X),{replace:!0}))}function q(X,_e){const Le=X.matched[X.matched.length-1];if(Le&&Le.redirect){const{redirect:me}=Le;let ce=typeof me=="function"?me(X,_e):me;return typeof ce=="string"&&(ce=ce.includes("?")||ce.includes("#")?ce=x(ce):{path:ce},ce.params={}),Pt({query:X.query,hash:X.hash,params:ce.path!=null?{}:X.params},ce)}}function P(X,_e){const Le=h=$(X),me=d.value,ce=X.state,N=X.force,K=X.replace===!0,ae=q(Le,me);if(ae)return P(Pt(x(ae),{state:typeof ae=="object"?Pt({},ce,ae.state):ce,force:N,replace:K}),_e||Le);const Te=Le;Te.redirectedFrom=_e;let Be;return!N&&w1(a,me,Le)&&(Be=Zi(tn.NAVIGATION_DUPLICATED,{to:Te,from:me}),ke(me,me,!0,!1)),(Be?Promise.resolve(Be):j(Te,me)).catch(De=>As(De)?As(De,tn.NAVIGATION_GUARD_REDIRECT)?De:ue(De):z(De,Te,me)).then(De=>{if(De){if(As(De,tn.NAVIGATION_GUARD_REDIRECT))return P(Pt({replace:K},x(De.to),{state:typeof De.to=="object"?Pt({},ce,De.to.state):ce,force:N}),_e||Te)}else De=G(Te,me,!0,K,ce);return O(Te,me,De),De})}function F(X,_e){const Le=S(X,_e);return Le?Promise.reject(Le):Promise.resolve()}function R(X){const _e=Ne.values().next().value;return _e&&typeof _e.runWithContext=="function"?_e.runWithContext(X):X()}function j(X,_e){let Le;const[me,ce,N]=N1(X,_e);Le=Jc(me.reverse(),"beforeRouteLeave",X,_e);for(const ae of me)ae.leaveGuards.forEach(Te=>{Le.push(ya(Te,X,_e))});const K=F.bind(null,X,_e);return Le.push(K),We(Le).then(()=>{Le=[];for(const ae of i.list())Le.push(ya(ae,X,_e));return Le.push(K),We(Le)}).then(()=>{Le=Jc(ce,"beforeRouteUpdate",X,_e);for(const ae of ce)ae.updateGuards.forEach(Te=>{Le.push(ya(Te,X,_e))});return Le.push(K),We(Le)}).then(()=>{Le=[];for(const ae of N)if(ae.beforeEnter)if(ss(ae.beforeEnter))for(const Te of ae.beforeEnter)Le.push(ya(Te,X,_e));else Le.push(ya(ae.beforeEnter,X,_e));return Le.push(K),We(Le)}).then(()=>(X.matched.forEach(ae=>ae.enterCallbacks={}),Le=Jc(N,"beforeRouteEnter",X,_e,R),Le.push(K),We(Le))).then(()=>{Le=[];for(const ae of r.list())Le.push(ya(ae,X,_e));return Le.push(K),We(Le)}).catch(ae=>As(ae,tn.NAVIGATION_CANCELLED)?ae:Promise.reject(ae))}function O(X,_e,Le){u.list().forEach(me=>R(()=>me(X,_e,Le)))}function G(X,_e,Le,me,ce){const N=S(X,_e);if(N)return N;const K=_e===ha,ae=Di?history.state:{};Le&&(me||K?s.replace(X.fullPath,Pt({scroll:K&&ae&&ae.scroll},ce)):s.push(X.fullPath,ce)),d.value=X,ke(X,_e,Le,K),ue()}let Q;function se(){Q||(Q=s.listen((X,_e,Le)=>{if(!Ke.listening)return;const me=$(X),ce=q(me,Ke.currentRoute.value);if(ce){P(Pt(ce,{replace:!0,force:!0}),me).catch(Ml);return}h=me;const N=d.value;Di&&M1(xh(N.fullPath,Le.delta),pc()),j(me,N).catch(K=>As(K,tn.NAVIGATION_ABORTED|tn.NAVIGATION_CANCELLED)?K:As(K,tn.NAVIGATION_GUARD_REDIRECT)?(P(Pt(x(K.to),{force:!0}),me).then(ae=>{As(ae,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&!Le.delta&&Le.type===_u.pop&&s.go(-1,!1)}).catch(Ml),Promise.reject()):(Le.delta&&s.go(-Le.delta,!1),z(K,me,N))).then(K=>{K=K||G(me,N,!1),K&&(Le.delta&&!As(K,tn.NAVIGATION_CANCELLED)?s.go(-Le.delta,!1):Le.type===_u.pop&&As(K,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),O(me,N,K)}).catch(Ml)}))}let pe=pl(),ee=pl(),te;function z(X,_e,Le){ue(X);const me=ee.list();return me.length?me.forEach(ce=>ce(X,_e,Le)):console.error(X),Promise.reject(X)}function Y(){return te&&d.value!==ha?Promise.resolve():new Promise((X,_e)=>{pe.add([X,_e])})}function ue(X){return te||(te=!X,se(),pe.list().forEach(([_e,Le])=>X?Le(X):_e()),pe.reset()),X}function ke(X,_e,Le,me){const{scrollBehavior:ce}=e;if(!Di||!ce)return Promise.resolve();const N=!Le&&A1(xh(X.fullPath,0))||(me||!Le)&&history.state&&history.state.scroll||null;return sn().then(()=>ce(X,_e,N)).then(K=>K&&T1(K)).catch(K=>z(K,X,_e))}const Re=X=>s.go(X);let Ye;const Ne=new Set,Ke={currentRoute:d,listening:!0,addRoute:_,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:I,getRoutes:C,resolve:$,options:e,push:B,replace:E,go:Re,back:()=>Re(-1),forward:()=>Re(1),beforeEach:i.add,beforeResolve:r.add,afterEach:u.add,onError:ee.add,isReady:Y,install(X){X.component("RouterLink",ik),X.component("RouterView",uk),X.config.globalProperties.$router=Ke,Object.defineProperty(X.config.globalProperties,"$route",{enumerable:!0,get:()=>D(d)}),Di&&!Ye&&d.value===ha&&(Ye=!0,B(s.location).catch(me=>{}));const _e={};for(const me in ha)Object.defineProperty(_e,me,{get:()=>d.value[me],enumerable:!0});X.provide(vc,Ke),X.provide(sd,Jf(_e)),X.provide(wu,d);const Le=X.unmount;Ne.add(X),X.unmount=function(){Ne.delete(X),Ne.size<1&&(h=ha,Q&&Q(),Q=null,d.value=ha,Ye=!1,te=!1),Le()}}};function We(X){return X.reduce((_e,Le)=>_e.then(()=>R(Le)),Promise.resolve())}return Ke}function Ki(){return uo(vc)}function mc(e){return uo(sd)}const hk=500,fk=3e3,pk=500,Qa=M(new Map),ad=M(!1),zr=M("");let vk=0,Al=null;function mk(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:hk}:{message:"Loading...",delay:fk}}function gk(){Al&&(clearTimeout(Al),Al=null)}function yk(e){gk();const t=++vk,{message:o,delay:a}=mk(e.method),s=setTimeout(()=>{Qa.value.has(t)&&(zr.value=o,ad.value=!0)},a);return Qa.value.set(t,{config:e,message:o,timeoutId:s}),e._loadingRequestId=t,t}function Uh(e){const t=Qa.value.get(e);if(t)if(clearTimeout(t.timeoutId),Qa.value.delete(e),Qa.value.size===0)Al=setTimeout(()=>{Qa.value.size===0&&(ad.value=!1,zr.value=""),Al=null},pk);else{const o=Qa.value.values().next().value;o&&(zr.value=o.message)}}function zh(e){return e?._loadingRequestId}function kk(){return{showOverlay:ad,overlayMessage:zr}}const Ge=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o},_k={key:0,class:"loading-overlay"},bk={class:"loading-content"},wk={class:"loading-message"},Ck={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:o}=kk();return(a,s)=>(v(),qe(es,{name:"fade"},{default:He(()=>[D(t)?(v(),m("div",_k,[l("div",bk,[s[0]||(s[0]=l("div",{class:"spinner"},null,-1)),l("p",wk,w(D(o)||"Loading..."),1)])])):A("",!0)]),_:1}))}},Lk=Ge(Ck,[["__scopeId","data-v-fdee3530"]]),Sk={__name:"App",setup(e){const t=Ki(),o=M(""),a=["/","/sessions"];return Ze(()=>t.currentRoute.value,(s,i)=>{if(!i?.path){o.value="";return}const r=a.indexOf(s.path),u=a.indexOf(i.path);r!==-1&&u!==-1?o.value=r>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(s,i)=>{const r=Ju("router-view");return v(),m(Me,null,[Ee(r,null,{default:He(({Component:u,route:d})=>[Ee(es,{name:o.value,mode:"out-in"},{default:He(()=>[(v(),qe(Og(u),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Ee(Lk)],64)}}},Ji="marshalSessions",Ik=30;function Hr(e,t){return`${e}:${t}`}function id(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function Ma(){try{return JSON.parse(localStorage.getItem(Ji)||"{}")}catch{return{}}}function Vr(e){const t=Ma(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,s])=>({sessionKey:a,...s}));return o.length===0?null:(o.sort((a,s)=>new Date(s.lastAccessed)-new Date(a.lastAccessed)),o[0])}function Hh(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=Ma(),a=Hr(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(Ji,JSON.stringify(o))}function Cu(e){const t=Ma(),{eventId:o,marshalId:a}=id(e);delete t[e],localStorage.setItem(Ji,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function fv(e,t){const o=Ma(),a=Hr(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(Ji,JSON.stringify(o)))}function pv(){const e=Ma(),t=new Date;t.setDate(t.getDate()-Ik);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:r}=id(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${r}`),o=!0}o&&localStorage.setItem(Ji,JSON.stringify(e))}function vv(){const e=Ma(),t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);if(s&&s.startsWith("marshal_")&&!s.startsWith("marshalCode_")&&!s.startsWith("marshalSessions")){const i=s.replace("marshal_",""),r=localStorage.getItem(s);if(r){const u=Hr(i,r);e[u]||(e[u]={marshalId:r,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(s)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const s=e[a];if(s&&s.marshalId){const i=Hr(a,s.marshalId);e[i]||(e[i]={...s,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(Ji,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function xk(){const e=Ma();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:s}=id(t);return{sessionKey:t,eventId:a,marshalId:s,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function mv(){const e=Ma();return Object.values(e).some(t=>t.token)}function gv(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function $k(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function yv(e,t){return function(){return e.apply(t,arguments)}}const{toString:Tk}=Object.prototype,{getPrototypeOf:ld}=Object,{iterator:gc,toStringTag:kv}=Symbol,yc=(e=>t=>{const o=Tk.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),as=e=>(e=e.toLowerCase(),t=>yc(t)===e),kc=e=>t=>typeof t===e,{isArray:Yi}=Array,qi=kc("undefined");function ql(e){return e!==null&&!qi(e)&&e.constructor!==null&&!qi(e.constructor)&&ho(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _v=as("ArrayBuffer");function Mk(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_v(e.buffer),t}const Ak=kc("string"),ho=kc("function"),bv=kc("number"),Wl=e=>e!==null&&typeof e=="object",Ek=e=>e===!0||e===!1,Lr=e=>{if(yc(e)!=="object")return!1;const t=ld(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(kv in e)&&!(gc in e)},Pk=e=>{if(!Wl(e)||ql(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Dk=as("Date"),Ok=as("File"),Rk=as("Blob"),Bk=as("FileList"),Nk=e=>Wl(e)&&ho(e.pipe),Fk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ho(e.append)&&((t=yc(e))==="formdata"||t==="object"&&ho(e.toString)&&e.toString()==="[object FormData]"))},Uk=as("URLSearchParams"),[zk,Hk,Vk,Gk]=["ReadableStream","Request","Response","Headers"].map(as),jk=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Kl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),Yi(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(ql(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let u;for(a=0;a<r;a++)u=i[a],t.call(null,e[u],u,e)}}function wv(e,t){if(ql(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,s;for(;a-- >0;)if(s=o[a],t===s.toLowerCase())return s;return null}const oi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Cv=e=>!qi(e)&&e!==oi;function Lu(){const{caseless:e,skipUndefined:t}=Cv(this)&&this||{},o={},a=(s,i)=>{const r=e&&wv(o,i)||i;Lr(o[r])&&Lr(s)?o[r]=Lu(o[r],s):Lr(s)?o[r]=Lu({},s):Yi(s)?o[r]=s.slice():(!t||!qi(s))&&(o[r]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Kl(arguments[s],a);return o}const Zk=(e,t,o,{allOwnKeys:a}={})=>(Kl(t,(s,i)=>{o&&ho(s)?e[i]=yv(s,o):e[i]=s},{allOwnKeys:a}),e),qk=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Wk=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Kk=(e,t,o,a)=>{let s,i,r;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)r=s[i],(!a||a(r,e,t))&&!u[r]&&(t[r]=e[r],u[r]=!0);e=o!==!1&&ld(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},Jk=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},Yk=e=>{if(!e)return null;if(Yi(e))return e;let t=e.length;if(!bv(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},Xk=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ld(Uint8Array)),Qk=(e,t)=>{const a=(e&&e[gc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},e_=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},t_=as("HTMLFormElement"),n_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,s){return a.toUpperCase()+s}),Vh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),o_=as("RegExp"),Lv=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};Kl(o,(s,i)=>{let r;(r=t(s,i,e))!==!1&&(a[i]=r||s)}),Object.defineProperties(e,a)},s_=e=>{Lv(e,(t,o)=>{if(ho(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(ho(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},a_=(e,t)=>{const o={},a=s=>{s.forEach(i=>{o[i]=!0})};return Yi(e)?a(e):a(String(e).split(t)),o},i_=()=>{},l_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function r_(e){return!!(e&&ho(e.append)&&e[kv]==="FormData"&&e[gc])}const c_=e=>{const t=new Array(10),o=(a,s)=>{if(Wl(a)){if(t.indexOf(a)>=0)return;if(ql(a))return a;if(!("toJSON"in a)){t[s]=a;const i=Yi(a)?[]:{};return Kl(a,(r,u)=>{const d=o(r,s+1);!qi(d)&&(i[u]=d)}),t[s]=void 0,i}}return a};return o(e,0)},u_=as("AsyncFunction"),d_=e=>e&&(Wl(e)||ho(e))&&ho(e.then)&&ho(e.catch),Sv=((e,t)=>e?setImmediate:t?((o,a)=>(oi.addEventListener("message",({source:s,data:i})=>{s===oi&&i===o&&a.length&&a.shift()()},!1),s=>{a.push(s),oi.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",ho(oi.postMessage)),h_=typeof queueMicrotask<"u"?queueMicrotask.bind(oi):typeof process<"u"&&process.nextTick||Sv,f_=e=>e!=null&&ho(e[gc]),Pe={isArray:Yi,isArrayBuffer:_v,isBuffer:ql,isFormData:Fk,isArrayBufferView:Mk,isString:Ak,isNumber:bv,isBoolean:Ek,isObject:Wl,isPlainObject:Lr,isEmptyObject:Pk,isReadableStream:zk,isRequest:Hk,isResponse:Vk,isHeaders:Gk,isUndefined:qi,isDate:Dk,isFile:Ok,isBlob:Rk,isRegExp:o_,isFunction:ho,isStream:Nk,isURLSearchParams:Uk,isTypedArray:Xk,isFileList:Bk,forEach:Kl,merge:Lu,extend:Zk,trim:jk,stripBOM:qk,inherits:Wk,toFlatObject:Kk,kindOf:yc,kindOfTest:as,endsWith:Jk,toArray:Yk,forEachEntry:Qk,matchAll:e_,isHTMLForm:t_,hasOwnProperty:Vh,hasOwnProp:Vh,reduceDescriptors:Lv,freezeMethods:s_,toObjectSet:a_,toCamelCase:n_,noop:i_,toFiniteNumber:l_,findKey:wv,global:oi,isContextDefined:Cv,isSpecCompliantForm:r_,toJSONObject:c_,isAsyncFn:u_,isThenable:d_,setImmediate:Sv,asap:h_,isIterable:f_};function yt(e,t,o,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}Pe.inherits(yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pe.toJSONObject(this.config),code:this.code,status:this.status}}});const Iv=yt.prototype,xv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{xv[e]={value:e}});Object.defineProperties(yt,xv);Object.defineProperty(Iv,"isAxiosError",{value:!0});yt.from=(e,t,o,a,s,i)=>{const r=Object.create(Iv);Pe.toFlatObject(e,r,function(p){return p!==Error.prototype},h=>h!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return yt.call(r,u,d,o,a,s),e&&r.cause==null&&Object.defineProperty(r,"cause",{value:e,configurable:!0}),r.name=e&&e.name||"Error",i&&Object.assign(r,i),r};const p_=null;function Su(e){return Pe.isPlainObject(e)||Pe.isArray(e)}function $v(e){return Pe.endsWith(e,"[]")?e.slice(0,-2):e}function Gh(e,t,o){return e?e.concat(t).map(function(s,i){return s=$v(s),!o&&i?"["+s+"]":s}).join(o?".":""):t}function v_(e){return Pe.isArray(e)&&!e.some(Su)}const m_=Pe.toFlatObject(Pe,{},null,function(t){return/^is[A-Z]/.test(t)});function _c(e,t,o){if(!Pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Pe.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,I){return!Pe.isUndefined(I[C])});const a=o.metaTokens,s=o.visitor||p,i=o.dots,r=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Pe.isSpecCompliantForm(t);if(!Pe.isFunction(s))throw new TypeError("visitor must be a function");function h(b){if(b===null)return"";if(Pe.isDate(b))return b.toISOString();if(Pe.isBoolean(b))return b.toString();if(!d&&Pe.isBlob(b))throw new yt("Blob is not supported. Use a Buffer instead.");return Pe.isArrayBuffer(b)||Pe.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function p(b,C,I){let $=b;if(b&&!I&&typeof b=="object"){if(Pe.endsWith(C,"{}"))C=a?C:C.slice(0,-2),b=JSON.stringify(b);else if(Pe.isArray(b)&&v_(b)||(Pe.isFileList(b)||Pe.endsWith(C,"[]"))&&($=Pe.toArray(b)))return C=$v(C),$.forEach(function(S,B){!(Pe.isUndefined(S)||S===null)&&t.append(r===!0?Gh([C],B,i):r===null?C:C+"[]",h(S))}),!1}return Su(b)?!0:(t.append(Gh(I,C,i),h(b)),!1)}const g=[],y=Object.assign(m_,{defaultVisitor:p,convertValue:h,isVisitable:Su});function _(b,C){if(!Pe.isUndefined(b)){if(g.indexOf(b)!==-1)throw Error("Circular reference detected in "+C.join("."));g.push(b),Pe.forEach(b,function($,x){(!(Pe.isUndefined($)||$===null)&&s.call(t,$,Pe.isString(x)?x.trim():x,C,y))===!0&&_($,C?C.concat(x):[x])}),g.pop()}}if(!Pe.isObject(e))throw new TypeError("data must be an object");return _(e),t}function jh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function rd(e,t){this._pairs=[],e&&_c(e,this,t)}const Tv=rd.prototype;Tv.append=function(t,o){this._pairs.push([t,o])};Tv.toString=function(t){const o=t?function(a){return t.call(this,a,jh)}:jh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function g_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Mv(e,t,o){if(!t)return e;const a=o&&o.encode||g_;Pe.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let i;if(s?i=s(t,o):i=Pe.isURLSearchParams(t)?t.toString():new rd(t,o).toString(a),i){const r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Zh{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Pe.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Av={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},y_=typeof URLSearchParams<"u"?URLSearchParams:rd,k_=typeof FormData<"u"?FormData:null,__=typeof Blob<"u"?Blob:null,b_={isBrowser:!0,classes:{URLSearchParams:y_,FormData:k_,Blob:__},protocols:["http","https","file","blob","url","data"]},cd=typeof window<"u"&&typeof document<"u",Iu=typeof navigator=="object"&&navigator||void 0,w_=cd&&(!Iu||["ReactNative","NativeScript","NS"].indexOf(Iu.product)<0),C_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",L_=cd&&window.location.href||"http://localhost",S_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:cd,hasStandardBrowserEnv:w_,hasStandardBrowserWebWorkerEnv:C_,navigator:Iu,origin:L_},Symbol.toStringTag,{value:"Module"})),Un={...S_,...b_};function I_(e,t){return _c(e,new Un.classes.URLSearchParams,{visitor:function(o,a,s,i){return Un.isNode&&Pe.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function x_(e){return Pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function $_(e){const t={},o=Object.keys(e);let a;const s=o.length;let i;for(a=0;a<s;a++)i=o[a],t[i]=e[i];return t}function Ev(e){function t(o,a,s,i){let r=o[i++];if(r==="__proto__")return!0;const u=Number.isFinite(+r),d=i>=o.length;return r=!r&&Pe.isArray(s)?s.length:r,d?(Pe.hasOwnProp(s,r)?s[r]=[s[r],a]:s[r]=a,!u):((!s[r]||!Pe.isObject(s[r]))&&(s[r]=[]),t(o,a,s[r],i)&&Pe.isArray(s[r])&&(s[r]=$_(s[r])),!u)}if(Pe.isFormData(e)&&Pe.isFunction(e.entries)){const o={};return Pe.forEachEntry(e,(a,s)=>{t(x_(a),s,o,0)}),o}return null}function T_(e,t,o){if(Pe.isString(e))try{return(t||JSON.parse)(e),Pe.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const Jl={transitional:Av,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",s=a.indexOf("application/json")>-1,i=Pe.isObject(t);if(i&&Pe.isHTMLForm(t)&&(t=new FormData(t)),Pe.isFormData(t))return s?JSON.stringify(Ev(t)):t;if(Pe.isArrayBuffer(t)||Pe.isBuffer(t)||Pe.isStream(t)||Pe.isFile(t)||Pe.isBlob(t)||Pe.isReadableStream(t))return t;if(Pe.isArrayBufferView(t))return t.buffer;if(Pe.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return I_(t,this.formSerializer).toString();if((u=Pe.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return _c(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||s?(o.setContentType("application/json",!1),T_(t)):t}],transformResponse:[function(t){const o=this.transitional||Jl.transitional,a=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Pe.isResponse(t)||Pe.isReadableStream(t))return t;if(t&&Pe.isString(t)&&(a&&!this.responseType||s)){const r=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(r)throw u.name==="SyntaxError"?yt.from(u,yt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Un.classes.FormData,Blob:Un.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pe.forEach(["delete","get","head","post","put","patch"],e=>{Jl.headers[e]={}});const M_=Pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),A_=e=>{const t={};let o,a,s;return e&&e.split(`
`).forEach(function(r){s=r.indexOf(":"),o=r.substring(0,s).trim().toLowerCase(),a=r.substring(s+1).trim(),!(!o||t[o]&&M_[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},qh=Symbol("internals");function vl(e){return e&&String(e).trim().toLowerCase()}function Sr(e){return e===!1||e==null?e:Pe.isArray(e)?e.map(Sr):String(e)}function E_(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const P_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Yc(e,t,o,a,s){if(Pe.isFunction(a))return a.call(this,t,o);if(s&&(t=o),!!Pe.isString(t)){if(Pe.isString(a))return t.indexOf(a)!==-1;if(Pe.isRegExp(a))return a.test(t)}}function D_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function O_(e,t){const o=Pe.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(s,i,r){return this[a].call(this,t,s,i,r)},configurable:!0})})}let fo=class{constructor(t){t&&this.set(t)}set(t,o,a){const s=this;function i(u,d,h){const p=vl(d);if(!p)throw new Error("header name must be a non-empty string");const g=Pe.findKey(s,p);(!g||s[g]===void 0||h===!0||h===void 0&&s[g]!==!1)&&(s[g||d]=Sr(u))}const r=(u,d)=>Pe.forEach(u,(h,p)=>i(h,p,d));if(Pe.isPlainObject(t)||t instanceof this.constructor)r(t,o);else if(Pe.isString(t)&&(t=t.trim())&&!P_(t))r(A_(t),o);else if(Pe.isObject(t)&&Pe.isIterable(t)){let u={},d,h;for(const p of t){if(!Pe.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[h=p[0]]=(d=u[h])?Pe.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}r(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=vl(t),t){const a=Pe.findKey(this,t);if(a){const s=this[a];if(!o)return s;if(o===!0)return E_(s);if(Pe.isFunction(o))return o.call(this,s,a);if(Pe.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=vl(t),t){const a=Pe.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||Yc(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let s=!1;function i(r){if(r=vl(r),r){const u=Pe.findKey(a,r);u&&(!o||Yc(a,a[u],u,o))&&(delete a[u],s=!0)}}return Pe.isArray(t)?t.forEach(i):i(t),s}clear(t){const o=Object.keys(this);let a=o.length,s=!1;for(;a--;){const i=o[a];(!t||Yc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const o=this,a={};return Pe.forEach(this,(s,i)=>{const r=Pe.findKey(a,i);if(r){o[r]=Sr(s),delete o[i];return}const u=t?D_(i):String(i).trim();u!==i&&delete o[i],o[u]=Sr(s),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Pe.forEach(this,(a,s)=>{a!=null&&a!==!1&&(o[s]=t&&Pe.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[qh]=this[qh]={accessors:{}}).accessors,s=this.prototype;function i(r){const u=vl(r);a[u]||(O_(s,r),a[u]=!0)}return Pe.isArray(t)?t.forEach(i):i(t),this}};fo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Pe.reduceDescriptors(fo.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});Pe.freezeMethods(fo);function Xc(e,t){const o=this||Jl,a=t||o,s=fo.from(a.headers);let i=a.data;return Pe.forEach(e,function(u){i=u.call(o,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Pv(e){return!!(e&&e.__CANCEL__)}function Xi(e,t,o){yt.call(this,e??"canceled",yt.ERR_CANCELED,t,o),this.name="CanceledError"}Pe.inherits(Xi,yt,{__CANCEL__:!0});function Dv(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new yt("Request failed with status code "+o.status,[yt.ERR_BAD_REQUEST,yt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function R_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function B_(e,t){e=e||10;const o=new Array(e),a=new Array(e);let s=0,i=0,r;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),p=a[i];r||(r=h),o[s]=d,a[s]=h;let g=i,y=0;for(;g!==s;)y+=o[g++],g=g%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),h-r<t)return;const _=p&&h-p;return _?Math.round(y*1e3/_):void 0}}function N_(e,t){let o=0,a=1e3/t,s,i;const r=(h,p=Date.now())=>{o=p,s=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const p=Date.now(),g=p-o;g>=a?r(h,p):(s=h,i||(i=setTimeout(()=>{i=null,r(s)},a-g)))},()=>s&&r(s)]}const Gr=(e,t,o=3)=>{let a=0;const s=B_(50,250);return N_(i=>{const r=i.loaded,u=i.lengthComputable?i.total:void 0,d=r-a,h=s(d),p=r<=u;a=r;const g={loaded:r,total:u,progress:u?r/u:void 0,bytes:d,rate:h||void 0,estimated:h&&u&&p?(u-r)/h:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},Wh=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Kh=e=>(...t)=>Pe.asap(()=>e(...t)),F_=Un.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Un.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Un.origin),Un.navigator&&/(msie|trident)/i.test(Un.navigator.userAgent)):()=>!0,U_=Un.hasStandardBrowserEnv?{write(e,t,o,a,s,i,r){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Pe.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Pe.isString(a)&&u.push(`path=${a}`),Pe.isString(s)&&u.push(`domain=${s}`),i===!0&&u.push("secure"),Pe.isString(r)&&u.push(`SameSite=${r}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function z_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function H_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ov(e,t,o){let a=!z_(t);return e&&(a||o==!1)?H_(e,t):t}const Jh=e=>e instanceof fo?{...e}:e;function ci(e,t){t=t||{};const o={};function a(h,p,g,y){return Pe.isPlainObject(h)&&Pe.isPlainObject(p)?Pe.merge.call({caseless:y},h,p):Pe.isPlainObject(p)?Pe.merge({},p):Pe.isArray(p)?p.slice():p}function s(h,p,g,y){if(Pe.isUndefined(p)){if(!Pe.isUndefined(h))return a(void 0,h,g,y)}else return a(h,p,g,y)}function i(h,p){if(!Pe.isUndefined(p))return a(void 0,p)}function r(h,p){if(Pe.isUndefined(p)){if(!Pe.isUndefined(h))return a(void 0,h)}else return a(void 0,p)}function u(h,p,g){if(g in t)return a(h,p);if(g in e)return a(void 0,h)}const d={url:i,method:i,data:i,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:u,headers:(h,p,g)=>s(Jh(h),Jh(p),g,!0)};return Pe.forEach(Object.keys({...e,...t}),function(p){const g=d[p]||s,y=g(e[p],t[p],p);Pe.isUndefined(y)&&g!==u||(o[p]=y)}),o}const Rv=e=>{const t=ci({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:r,auth:u}=t;if(t.headers=r=fo.from(r),t.url=Mv(Ov(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&r.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Pe.isFormData(o)){if(Un.hasStandardBrowserEnv||Un.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if(Pe.isFunction(o.getHeaders)){const d=o.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([p,g])=>{h.includes(p.toLowerCase())&&r.set(p,g)})}}if(Un.hasStandardBrowserEnv&&(a&&Pe.isFunction(a)&&(a=a(t)),a||a!==!1&&F_(t.url))){const d=s&&i&&U_.read(i);d&&r.set(s,d)}return t},V_=typeof XMLHttpRequest<"u",G_=V_&&function(e){return new Promise(function(o,a){const s=Rv(e);let i=s.data;const r=fo.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:h}=s,p,g,y,_,b;function C(){_&&_(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let I=new XMLHttpRequest;I.open(s.method.toUpperCase(),s.url,!0),I.timeout=s.timeout;function $(){if(!I)return;const S=fo.from("getAllResponseHeaders"in I&&I.getAllResponseHeaders()),E={data:!u||u==="text"||u==="json"?I.responseText:I.response,status:I.status,statusText:I.statusText,headers:S,config:e,request:I};Dv(function(P){o(P),C()},function(P){a(P),C()},E),I=null}"onloadend"in I?I.onloadend=$:I.onreadystatechange=function(){!I||I.readyState!==4||I.status===0&&!(I.responseURL&&I.responseURL.indexOf("file:")===0)||setTimeout($)},I.onabort=function(){I&&(a(new yt("Request aborted",yt.ECONNABORTED,e,I)),I=null)},I.onerror=function(B){const E=B&&B.message?B.message:"Network Error",q=new yt(E,yt.ERR_NETWORK,e,I);q.event=B||null,a(q),I=null},I.ontimeout=function(){let B=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const E=s.transitional||Av;s.timeoutErrorMessage&&(B=s.timeoutErrorMessage),a(new yt(B,E.clarifyTimeoutError?yt.ETIMEDOUT:yt.ECONNABORTED,e,I)),I=null},i===void 0&&r.setContentType(null),"setRequestHeader"in I&&Pe.forEach(r.toJSON(),function(B,E){I.setRequestHeader(E,B)}),Pe.isUndefined(s.withCredentials)||(I.withCredentials=!!s.withCredentials),u&&u!=="json"&&(I.responseType=s.responseType),h&&([y,b]=Gr(h,!0),I.addEventListener("progress",y)),d&&I.upload&&([g,_]=Gr(d),I.upload.addEventListener("progress",g),I.upload.addEventListener("loadend",_)),(s.cancelToken||s.signal)&&(p=S=>{I&&(a(!S||S.type?new Xi(null,e,I):S),I.abort(),I=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const x=R_(s.url);if(x&&Un.protocols.indexOf(x)===-1){a(new yt("Unsupported protocol "+x+":",yt.ERR_BAD_REQUEST,e));return}I.send(i||null)})},j_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,s;const i=function(h){if(!s){s=!0,u();const p=h instanceof Error?h:this.reason;a.abort(p instanceof yt?p:new Xi(p instanceof Error?p.message:p))}};let r=t&&setTimeout(()=>{r=null,i(new yt(`timeout ${t} of ms exceeded`,yt.ETIMEDOUT))},t);const u=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Pe.asap(u),d}},Z_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,s;for(;a<o;)s=a+t,yield e.slice(a,s),a=s},q_=async function*(e,t){for await(const o of W_(e))yield*Z_(o,t)},W_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Yh=(e,t,o,a)=>{const s=q_(e,t);let i=0,r,u=d=>{r||(r=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:h,value:p}=await s.next();if(h){u(),d.close();return}let g=p.byteLength;if(o){let y=i+=g;o(y)}d.enqueue(new Uint8Array(p))}catch(h){throw u(h),h}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Xh=64*1024,{isFunction:mr}=Pe,K_=(({Request:e,Response:t})=>({Request:e,Response:t}))(Pe.global),{ReadableStream:Qh,TextEncoder:ef}=Pe.global,tf=(e,...t)=>{try{return!!e(...t)}catch{return!1}},J_=e=>{e=Pe.merge.call({skipUndefined:!0},K_,e);const{fetch:t,Request:o,Response:a}=e,s=t?mr(t):typeof fetch=="function",i=mr(o),r=mr(a);if(!s)return!1;const u=s&&mr(Qh),d=s&&(typeof ef=="function"?(b=>C=>b.encode(C))(new ef):async b=>new Uint8Array(await new o(b).arrayBuffer())),h=i&&u&&tf(()=>{let b=!1;const C=new o(Un.origin,{body:new Qh,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!C}),p=r&&u&&tf(()=>Pe.isReadableStream(new a("").body)),g={stream:p&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!g[b]&&(g[b]=(C,I)=>{let $=C&&C[b];if($)return $.call(C);throw new yt(`Response type '${b}' is not supported`,yt.ERR_NOT_SUPPORT,I)})});const y=async b=>{if(b==null)return 0;if(Pe.isBlob(b))return b.size;if(Pe.isSpecCompliantForm(b))return(await new o(Un.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Pe.isArrayBufferView(b)||Pe.isArrayBuffer(b))return b.byteLength;if(Pe.isURLSearchParams(b)&&(b=b+""),Pe.isString(b))return(await d(b)).byteLength},_=async(b,C)=>{const I=Pe.toFiniteNumber(b.getContentLength());return I??y(C)};return async b=>{let{url:C,method:I,data:$,signal:x,cancelToken:S,timeout:B,onDownloadProgress:E,onUploadProgress:q,responseType:P,headers:F,withCredentials:R="same-origin",fetchOptions:j}=Rv(b),O=t||fetch;P=P?(P+"").toLowerCase():"text";let G=j_([x,S&&S.toAbortSignal()],B),Q=null;const se=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let pe;try{if(q&&h&&I!=="get"&&I!=="head"&&(pe=await _(F,$))!==0){let ke=new o(C,{method:"POST",body:$,duplex:"half"}),Re;if(Pe.isFormData($)&&(Re=ke.headers.get("content-type"))&&F.setContentType(Re),ke.body){const[Ye,Ne]=Wh(pe,Gr(Kh(q)));$=Yh(ke.body,Xh,Ye,Ne)}}Pe.isString(R)||(R=R?"include":"omit");const ee=i&&"credentials"in o.prototype,te={...j,signal:G,method:I.toUpperCase(),headers:F.normalize().toJSON(),body:$,duplex:"half",credentials:ee?R:void 0};Q=i&&new o(C,te);let z=await(i?O(Q,j):O(C,te));const Y=p&&(P==="stream"||P==="response");if(p&&(E||Y&&se)){const ke={};["status","statusText","headers"].forEach(Ke=>{ke[Ke]=z[Ke]});const Re=Pe.toFiniteNumber(z.headers.get("content-length")),[Ye,Ne]=E&&Wh(Re,Gr(Kh(E),!0))||[];z=new a(Yh(z.body,Xh,Ye,()=>{Ne&&Ne(),se&&se()}),ke)}P=P||"text";let ue=await g[Pe.findKey(g,P)||"text"](z,b);return!Y&&se&&se(),await new Promise((ke,Re)=>{Dv(ke,Re,{data:ue,headers:fo.from(z.headers),status:z.status,statusText:z.statusText,config:b,request:Q})})}catch(ee){throw se&&se(),ee&&ee.name==="TypeError"&&/Load failed|fetch/i.test(ee.message)?Object.assign(new yt("Network Error",yt.ERR_NETWORK,b,Q),{cause:ee.cause||ee}):yt.from(ee,ee&&ee.code,b,Q)}}},Y_=new Map,Bv=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:s}=t,i=[a,s,o];let r=i.length,u=r,d,h,p=Y_;for(;u--;)d=i[u],h=p.get(d),h===void 0&&p.set(d,h=u?new Map:J_(t)),p=h;return h};Bv();const ud={http:p_,xhr:G_,fetch:{get:Bv}};Pe.forEach(ud,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const nf=e=>`- ${e}`,X_=e=>Pe.isFunction(e)||e===null||e===!1;function Q_(e,t){e=Pe.isArray(e)?e:[e];const{length:o}=e;let a,s;const i={};for(let r=0;r<o;r++){a=e[r];let u;if(s=a,!X_(a)&&(s=ud[(u=String(a)).toLowerCase()],s===void 0))throw new yt(`Unknown adapter '${u}'`);if(s&&(Pe.isFunction(s)||(s=s.get(t))))break;i[u||"#"+r]=s}if(!s){const r=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=o?r.length>1?`since :
`+r.map(nf).join(`
`):" "+nf(r[0]):"as no adapter specified";throw new yt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Nv={getAdapter:Q_,adapters:ud};function Qc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Xi(null,e)}function of(e){return Qc(e),e.headers=fo.from(e.headers),e.data=Xc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Nv.getAdapter(e.adapter||Jl.adapter,e)(e).then(function(a){return Qc(e),a.data=Xc.call(e,e.transformResponse,a),a.headers=fo.from(a.headers),a},function(a){return Pv(a)||(Qc(e),a&&a.response&&(a.response.data=Xc.call(e,e.transformResponse,a.response),a.response.headers=fo.from(a.response.headers))),Promise.reject(a)})}const Fv="1.13.2",bc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{bc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const sf={};bc.transitional=function(t,o,a){function s(i,r){return"[Axios v"+Fv+"] Transitional option '"+i+"'"+r+(a?". "+a:"")}return(i,r,u)=>{if(t===!1)throw new yt(s(r," has been removed"+(o?" in "+o:"")),yt.ERR_DEPRECATED);return o&&!sf[r]&&(sf[r]=!0,console.warn(s(r," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,r,u):!0}};bc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function eb(e,t,o){if(typeof e!="object")throw new yt("options must be an object",yt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],r=t[i];if(r){const u=e[i],d=u===void 0||r(u,i,e);if(d!==!0)throw new yt("option "+i+" must be "+d,yt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new yt("Unknown option "+i,yt.ERR_BAD_OPTION)}}const Ir={assertOptions:eb,validators:bc},ds=Ir.validators;let ii=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Zh,response:new Zh}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ci(this.defaults,o);const{transitional:a,paramsSerializer:s,headers:i}=o;a!==void 0&&Ir.assertOptions(a,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(Pe.isFunction(s)?o.paramsSerializer={serialize:s}:Ir.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Ir.assertOptions(o,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let r=i&&Pe.merge(i.common,i[o.method]);i&&Pe.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),o.headers=fo.concat(r,i);const u=[];let d=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(o)===!1||(d=d&&C.synchronous,u.unshift(C.fulfilled,C.rejected))});const h=[];this.interceptors.response.forEach(function(C){h.push(C.fulfilled,C.rejected)});let p,g=0,y;if(!d){const b=[of.bind(this),void 0];for(b.unshift(...u),b.push(...h),y=b.length,p=Promise.resolve(o);g<y;)p=p.then(b[g++],b[g++]);return p}y=u.length;let _=o;for(;g<y;){const b=u[g++],C=u[g++];try{_=b(_)}catch(I){C.call(this,I);break}}try{p=of.call(this,_)}catch(b){return Promise.reject(b)}for(g=0,y=h.length;g<y;)p=p.then(h[g++],h[g++]);return p}getUri(t){t=ci(this.defaults,t);const o=Ov(t.baseURL,t.url,t.allowAbsoluteUrls);return Mv(o,t.params,t.paramsSerializer)}};Pe.forEach(["delete","get","head","options"],function(t){ii.prototype[t]=function(o,a){return this.request(ci(a||{},{method:t,url:o,data:(a||{}).data}))}});Pe.forEach(["post","put","patch"],function(t){function o(a){return function(i,r,u){return this.request(ci(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:r}))}}ii.prototype[t]=o(),ii.prototype[t+"Form"]=o(!0)});let tb=class Uv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const r=new Promise(u=>{a.subscribe(u),i=u}).then(s);return r.cancel=function(){a.unsubscribe(i)},r},t(function(i,r,u){a.reason||(a.reason=new Xi(i,r,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Uv(function(s){t=s}),cancel:t}}};function nb(e){return function(o){return e.apply(null,o)}}function ob(e){return Pe.isObject(e)&&e.isAxiosError===!0}const xu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(xu).forEach(([e,t])=>{xu[t]=e});function zv(e){const t=new ii(e),o=yv(ii.prototype.request,t);return Pe.extend(o,ii.prototype,t,{allOwnKeys:!0}),Pe.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return zv(ci(e,s))},o}const an=zv(Jl);an.Axios=ii;an.CanceledError=Xi;an.CancelToken=tb;an.isCancel=Pv;an.VERSION=Fv;an.toFormData=_c;an.AxiosError=yt;an.Cancel=an.CanceledError;an.all=function(t){return Promise.all(t)};an.spread=nb;an.isAxiosError=ob;an.mergeConfig=ci;an.AxiosHeaders=fo;an.formToJSON=e=>Ev(Pe.isHTMLForm(e)?new FormData(e):e);an.getAdapter=Nv.getAdapter;an.HttpStatusCode=xu;an.default=an;const{Axios:_V,AxiosError:bV,CanceledError:wV,isCancel:CV,CancelToken:LV,VERSION:SV,all:IV,Cancel:xV,isAxiosError:$V,spread:TV,toFormData:MV,AxiosHeaders:AV,HttpStatusCode:EV,formToJSON:PV,getAdapter:DV,mergeConfig:OV}=an,ka="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",sb="VolunteerCheckinOffline",ab=1;let Yo=null;async function qs(){return Yo||new Promise((e,t)=>{const o=indexedDB.open(sb,ab);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Yo=o.result,e(Yo)},o.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Hl(e,t){return await qs(),new Promise((o,a)=>{const s=Yo.transaction(["eventData","syncMeta"],"readwrite"),i=s.objectStore("eventData"),r=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),r.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function La(e){return await qs(),new Promise((t,o)=>{const i=Yo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function xr(e,t,o){const a=await La(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await Hl(e,a))}async function ib(e){return await qs(),new Promise((t,o)=>{const s=Yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},r=s.add(i);r.onsuccess=()=>t(r.result),r.onerror=()=>o(r.error)})}async function Hv(){return await qs(),new Promise((e,t)=>{const i=Yo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const r=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(r)},i.onerror=()=>t(i.error)})}async function jr(){return(await Hv()).length}async function af(e,t){return await qs(),new Promise((o,a)=>{const s=Yo.transaction(["pendingActions"],"readwrite"),i=s.objectStore("pendingActions"),r=i.get(e);r.onsuccess=()=>{const u=r.result;u&&(Object.assign(u,t),i.put(u))},s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function lf(e){return await qs(),new Promise((t,o)=>{const i=Yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function lb(e){return await qs(),new Promise((t,o)=>{const i=Yo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const Je=an.create({baseURL:ka,headers:{"Content-Type":"application/json"},timeout:15e3});let $u=!1,Vv={type:null,eventId:null};function Co(e,t=null){Vv={type:e,eventId:t}}async function rb(){}function rf(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function cb(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Gv(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Vv}const ub=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];Je.interceptors.request.use(e=>{if(ub.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Gv();let s=null;if(a.type==="marshal"&&a.eventId){const i=Vr(a.eventId);i?.token&&(s=i.token)}return s||(s=localStorage.getItem("sessionToken")),s&&(e.headers.Authorization=`Bearer ${s}`),yk(e),e});let Zr=0;const db=2;function hb(){if(Zr++,Zr>=db&&Gv().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function fb(){Zr=0}function eu(){Zr=0}function pb(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const s=window.location.hash||"";return!!(s.match(/#\/event\/[^/?]+/)||s==="#/marshal"||s.startsWith("#/marshal?"))}Je.interceptors.response.use(e=>{const t=zh(e.config);t&&Uh(t),$u=!1,fb();const o=e.config.url,a=rf(o);return e.config.method,e},async e=>{const t=e.config,o=zh(t);if(o&&Uh(o),e.response&&(e.response.status===401||e.response.status===403))return pb(t)||hb(),Promise.reject(e);if(cb(e)&&($u=!0,t.method==="get")){const a=rf(t.url);if(a){const s=await La(a);if(s)return console.log("Returning cached data for:",t.url),Promise.resolve({data:s,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function wo(e,t,o){return await ib({type:e,payload:t,eventId:t.eventId}),await rb(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function On(){return $u||!navigator.onLine}const vb={check:()=>Je.head("/health")},Tu=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),ms={requestLogin:e=>Je.post("/auth/request-login",{email:e,frontendUrl:Tu()}),verifyToken:e=>Je.post("/auth/verify-token",{token:e}),instantLogin:e=>Je.post("/auth/instant-login",{email:e}),createAdmin:e=>Je.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Je.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Je.get("/auth/me",{params:{eventId:e}}),logout:()=>Je.post("/auth/logout")},gr={getProfile:()=>Je.get("/auth/profile"),updateProfile:e=>Je.put("/auth/profile",e),getPerson:(e,t)=>Je.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Je.put(`/people/${e}`,o,{params:{eventId:t}})},_a={create:e=>Je.post("/events",e),getAll:()=>Je.get("/events"),getById:e=>Je.get(`/events/${e}`),update:(e,t)=>Je.put(`/events/${e}`,t),delete:e=>Je.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Je.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Jn={create:e=>Je.post("/locations",e),getById:(e,t)=>Je.get(`/locations/${e}/${t}`),getByEvent:e=>Je.get(`/events/${e}/locations`),update:(e,t,o)=>Je.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),Je.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Je.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Je.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Je.get(`/events/${e}/dynamic-checkpoints`)},gl={create:e=>Je.post("/assignments",e),getById:(e,t)=>Je.get(`/assignments/${e}/${t}`),getByEvent:e=>Je.get(`/assignments/event/${e}`),delete:(e,t)=>Je.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Je.get(`/events/${e}/status`)},Sa={checkIn:e=>Je.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:s}={})=>Je.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:s??null}),adminCheckIn:(e,t)=>Je.post(`/checkin/admin/${e}/${t}`)},tu={getAdmins:e=>Je.get(`/events/${e}/admins`),addAdmin:(e,t)=>Je.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Je.delete(`/events/${e}/admins/${t}`)},gs={create:e=>Je.post("/marshals",e),getByEvent:e=>Je.get(`/events/${e}/marshals`),getById:(e,t)=>Je.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Je.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Je.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Tu()}}),sendMagicLink:(e,t)=>Je.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Tu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Je.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},ba={create:e=>Je.post("/areas",e),getByEvent:e=>Je.get(`/events/${e}/areas`),getById:(e,t)=>Je.get(`/areas/${e}/${t}`),update:(e,t,o)=>Je.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/areas/${e}/${t}`),recalculate:e=>Je.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Je.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Je.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>Je.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Je.get(`/events/${e}/checklist-items`),getById:(e,t)=>Je.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Je.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/checklist-items/${e}/${t}`),getReport:e=>Je.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Je.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Je.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Je.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/uncomplete`,o)},fs={create:(e,t)=>Je.post(`/events/${e}/notes`,t),getByEvent:e=>Je.get(`/events/${e}/notes`),getById:(e,t)=>Je.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Je.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Je.get(`/events/${e}/my-notes`)},pa={create:(e,t)=>Je.post(`/events/${e}/contacts`,t),getByEvent:e=>Je.get(`/events/${e}/contacts`),getById:(e,t)=>Je.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Je.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Je.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Je.get(`/events/${e}/my-contacts`)},vs={create:(e,t)=>Je.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Je.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Je.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Je.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Je.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Je.post(`/events/${e}/incidents/${t}/notes`,{note:o})},mb={class:"hero-animation-container"},gb={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=M(!1);return Qt(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,s)=>(v(),m("div",mb,[(v(),m("svg",{viewBox:"0 0 400 350",class:ve(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...s[0]||(s[0]=[Br(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},yb=Ge(gb,[["__scopeId","data-v-cec8ae43"]]),kb={class:"hero-header"},_b={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=M(!1);return Qt(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),m("div",kb,[Ee(yb,{animate:t.value},null,8,["animate"]),e.title?(v(),m("div",{key:0,class:ve(["hero-overlay",{"no-animate":!t.value}])},[l("h1",null,w(e.title),1)],2)):A("",!0)]))}},jv=Ge(_b,[["__scopeId","data-v-c824ab01"]]),Yl=nd("auth",()=>{const e=M(localStorage.getItem("adminEmail")||null),t=M(!!e.value),o=M(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ms.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ms.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),Co("admin")),d.data},instantLogin:async u=>{const d=await ms.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),Co("admin")),d.data},logout:async()=>{try{await ms.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),Co(null)}}}),bb={class:"modal-card"},wb={key:0,class:"email-sent"},Cb={key:1},Lb={class:"form-group"},Sb=["disabled"],Ib={key:0,class:"error"},xb={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,s=Yl(),i=M(""),r=M(!1),u=M(null),d=M(!1);async function h(){r.value=!0,u.value=null;try{const y=await s.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):u.value=y.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{r.value=!1}}function p(){i.value="",d.value=!1,u.value=null}function g(){a("close")}return Ze(()=>o.show,y=>{y||setTimeout(()=>{p()},200)}),(y,_)=>(v(),qe(Ol,{to:"body"},[Ee(es,{name:"modal"},{default:He(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",style:et({zIndex:e.zIndex}),onClick:it(g,["self"])},[l("div",bb,[l("button",{class:"modal-close",onClick:g},""),d.value?(v(),m("div",wb,[_[2]||(_[2]=l("div",{class:"check-icon"},"",-1)),_[3]||(_[3]=l("h3",null,"Check your email!",-1)),l("p",null,[_[1]||(_[1]=Qe("We've sent a login link to ",-1)),l("strong",null,w(i.value),1)]),_[4]||(_[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:p,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",Cb,[_[5]||(_[5]=l("h2",null,"Join us or login",-1)),_[6]||(_[6]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:it(h,["prevent"])},[l("div",Lb,[ze(l("input",{"onUpdate:modelValue":_[0]||(_[0]=b=>i.value=b),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[tt,i.value]])]),l("button",{type:"submit",class:"btn btn-primary btn-full",disabled:r.value},w(r.value?"Sending...":"Send login link"),9,Sb)],32),u.value?(v(),m("div",Ib,w(u.value),1)):A("",!0)]))])],4)):A("",!0)]),_:1})]))}},Zv=Ge(xb,[["__scopeId","data-v-7c646305"]]),$b={class:"home"},Tb={class:"hero-section"},Mb={class:"content-section"},Ab={class:"container"},Eb={class:"carousel"},Pb={class:"carousel-indicators"},Db=["onClick"],Ob={__name:"Home",setup(e){const t=mc(),o=Ki();function a(){const y=!!localStorage.getItem("adminEmail"),_=mv();return y||_}function s(){a()?o.push("/sessions"):p.value=!0}const i=M(0);let r=null;function u(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){r&&clearInterval(r),r=setInterval(d,1e4)}const p=M(!1);function g(){p.value=!1,t.query.login&&o.replace({query:{}})}return Qt(()=>{h(),t.query.login&&(a()?o.replace("/sessions"):p.value=!0)}),kn(()=>{r&&clearInterval(r)}),(y,_)=>(v(),m("div",$b,[l("section",Tb,[Ee(jv,{title:"OnTheDay"}),_[0]||(_[0]=l("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),l("button",{class:"btn btn-primary",onClick:s}," Join us or login ")]),l("section",Mb,[l("div",Ab,[_[2]||(_[2]=Br('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),l("div",Eb,[l("div",{class:"carousel-track",style:et({transform:`translateX(-${i.value*100}%)`})},[..._[1]||(_[1]=[Br('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),l("div",Pb,[(v(),m(Me,null,Fe(2,(b,C)=>l("button",{key:C,class:ve(["indicator",{active:i.value===C}]),onClick:I=>u(C)},null,10,Db)),64))])])])]),Ee(Zv,{show:p.value,onClose:g},null,8,["show"])]))}},Rb=Ge(Ob,[["__scopeId","data-v-aaecbd22"]]),Bb={class:"admin-login"},Nb={class:"login-card"},Fb={key:0,class:"email-sent"},Ub={class:"form-group"},zb=["disabled"],Hb={key:0,class:"error"},Vb={__name:"AdminLogin",setup(e){const t=Yl(),o=M(""),a=M(!1),s=M(null),i=M(!1),r=async()=>{a.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,s.value=null};return(d,h)=>{const p=Ju("router-link");return v(),m("div",Bb,[l("div",Nb,[h[7]||(h[7]=l("h2",null,"Admin login",-1)),i.value?(v(),m("div",Fb,[h[2]||(h[2]=l("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=l("h3",null,"Check your email!",-1)),l("p",null,[h[1]||(h[1]=Qe("We've sent a login link to ",-1)),l("strong",null,w(o.value),1)]),h[4]||(h[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(Me,{key:1},[h[5]||(h[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",Ub,[ze(l("input",{"onUpdate:modelValue":h[0]||(h[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[tt,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:a.value},w(a.value?"Sending...":"Send login link"),9,zb)],32),s.value?(v(),m("div",Hb,w(s.value),1)):A("",!0)],64)),Ee(p,{to:"/",class:"back-link"},{default:He(()=>[...h[6]||(h[6]=[Qe(" Back to Home",-1)])]),_:1})])])}}},Gb=Ge(Vb,[["__scopeId","data-v-5d0a88c2"]]),jb={class:"admin-verify"},Zb={class:"verify-card"},qb={key:0,class:"status"},Wb={key:1,class:"status error"},Kb={key:2,class:"status success"},Jb={__name:"AdminVerify",setup(e){const t=Ki(),o=mc(),a=Yl(),s=M(!0),i=M(null);return Qt(async()=>{const r=o.query.token;if(!r){i.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await a.verifyToken(r);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(r,u)=>{const d=Ju("router-link");return v(),m("div",jb,[l("div",Zb,[s.value?(v(),m("div",qb,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),m("div",Wb,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,w(i.value),1),Ee(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:He(()=>[...u[1]||(u[1]=[Qe(" Try again ",-1)])]),_:1})])):(v(),m("div",Kb,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to your sessions...",-1)])]))])])}}},Yb=Ge(Jb,[["__scopeId","data-v-b2435a84"]]),qv=nd("events",()=>{const e=M([]),t=M(null),o=M([]),a=M([]),s=M(null),i=M(!1),r=M(null),u=async()=>{i.value=!0,r.value=null;try{const q=await _a.getAll();e.value=q.data}catch(q){throw r.value=q.message,q}finally{i.value=!1}},d=async q=>{i.value=!0,r.value=null;try{const P=await _a.getById(q);t.value=P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},h=async q=>{i.value=!0,r.value=null;try{const P=await _a.create(q);return e.value.push(P.data),P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},p=async(q,P)=>{i.value=!0,r.value=null;try{const F=await _a.update(q,P),R=e.value.findIndex(j=>j.id===q);return R!==-1&&(e.value[R]=F.data),t.value?.id===q&&(t.value=F.data),F.data}catch(F){throw r.value=F.message,F}finally{i.value=!1}},g=async q=>{i.value=!0,r.value=null;try{await _a.delete(q),e.value=e.value.filter(P=>P.id!==q)}catch(P){throw r.value=P.message,P}finally{i.value=!1}},y=async q=>{i.value=!0,r.value=null;try{const P=await Jn.getByEvent(q);o.value=P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:s,loading:i,error:r,fetchEvents:u,fetchEvent:d,createEvent:h,updateEvent:p,deleteEvent:g,fetchLocations:y,createLocation:async q=>{i.value=!0,r.value=null;try{const P=await Jn.create(q);return o.value.push(P.data),P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},updateLocation:async(q,P,F)=>{i.value=!0,r.value=null;try{const R=await Jn.update(q,P,F),j=o.value.findIndex(O=>O.id===P);return j!==-1&&(o.value[j]=R.data),R.data}catch(R){throw r.value=R.message,R}finally{i.value=!1}},deleteLocation:async(q,P)=>{i.value=!0,r.value=null;try{await Jn.delete(q,P),o.value=o.value.filter(F=>F.id!==P)}catch(F){throw r.value=F.message,F}finally{i.value=!1}},bulkUpdateLocationTimes:async(q,P)=>{i.value=!0,r.value=null;try{const F=await Jn.bulkUpdateTimes(q,P);return await y(q),F.data}catch(F){throw r.value=F.message,F}finally{i.value=!1}},fetchAssignments:async q=>{i.value=!0,r.value=null;try{const P=await gl.getByEvent(q);a.value=P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},createAssignment:async q=>{i.value=!0,r.value=null;try{const P=await gl.create(q);return a.value.push(P.data),P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},deleteAssignment:async(q,P)=>{i.value=!0,r.value=null;try{await gl.delete(q,P),a.value=a.value.filter(F=>F.id!==P)}catch(F){throw r.value=F.message,F}finally{i.value=!1}},fetchEventStatus:async q=>{i.value=!0,r.value=null;try{const P=await gl.getEventStatus(q);return s.value=P.data,P.data}catch(P){throw r.value=P.message,P}finally{i.value=!1}},updateAssignmentCheckIn:q=>{const P=a.value.findIndex(F=>F.id===q.id);P!==-1&&(a.value[P]=q),s.value&&s.value.locations.forEach(F=>{const R=F.assignments.findIndex(j=>j.id===q.id);R!==-1&&(F.assignments[R]=q,F.checkedInCount=F.assignments.filter(j=>j.isCheckedIn).length)})}}});function Wv(e="details",t=[]){const o=M(e),a=g=>{o.value=g},s=()=>{o.value=e},i=g=>o.value===g,r=U(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const y=r.value;if(y===-1)return;const _=y+1;_<t.length?o.value=t[_]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const y=r.value;if(y===-1)return;const _=y-1;_>=0?o.value=t[_]:g&&(o.value=t[t.length-1])},h=U(()=>{if(t.length===0)return!1;const g=r.value;return g!==-1&&g<t.length-1}),p=U(()=>t.length===0?!1:r.value>0);return{activeTab:o,activeTabIndex:r,hasNextTab:h,hasPreviousTab:p,switchTab:a,resetTab:s,isActiveTab:i,nextTab:u,previousTab:d}}function Xb(){const e=M(!1),t=M(""),o=M(""),a=M(null),s=M(!1),i=M("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:i,showConfirm:(p,g,y,_={})=>{t.value=p,o.value=g,a.value=y,s.value=_.isDanger||!1,i.value=_.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Oi=M({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Ns={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Bs={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function ei(e,t,o="Marshals"){if(!t)return"";const a=Ns[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Ns.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Kv(e,t,o="Marshals"){if(!t)return"";const a=Ns[e]?.[t];return t==="Person points"?`${Ns.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function Mu(e,t){return e==="Person points"?`${Ns.people[t]?.singular||"Person"} points`:e}function Au(e){e&&(Oi.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const qo=e=>e.toLowerCase(),Wo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ct(){const e=p=>{const g=Oi.value[p],y=Ns[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const _=Oi.value.people;return`${Ns.people[_]?.singular||"Person"} point`}return y?.singular||g},t=p=>{const g=Oi.value[p],y=Ns[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const _=Oi.value.people;return`${Ns.people[_]?.singular||"Person"} points`}return y?.plural||g},o=U(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=U(()=>({person:qo(e("people")),checkpoint:qo(e("checkpoint")),area:qo(e("area")),checklist:qo(e("checklist")),course:qo(e("course")),people:qo(t("people")),checkpoints:qo(t("checkpoint")),areas:qo(t("area")),checklists:qo(t("checklist")),courses:qo(t("course"))})),s=U(()=>({person:Wo(e("people")),checkpoint:Wo(e("checkpoint")),area:Wo(e("area")),checklist:Wo(e("checklist")),course:Wo(e("course")),people:Wo(t("people")),checkpoints:Wo(t("checkpoint")),areas:Wo(t("area")),checklists:Wo(t("checklist")),courses:Wo(t("course"))})),i=U(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:s,tabLabels:i,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>qo(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>Wo(g?t(p):e(p)),terminology:Oi}}function Qb(){const e=M(!1),t=M(null),o=M({}),a=M(null),s=M(null),i=M([]),r=M(null),u=M(null),d=M(!1),h=M(!1),p=M(1),g=U(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),y=Q=>{if(Q){const se=Q.getMapCenter?.(),pe=Q.getMapZoom?.();se&&pe!==null&&(r.value=se,u.value=pe)}},_=(Q={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Q.title||"Select checkpoint location",description:Q.description||"Click on the map to set the location. Click again to reposition."}},b=(Q,se="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${se}: ${Q}`,description:"Click on the map to set the new location"}},C=(Q={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:Q.title||"Draw area boundary",description:Q.description||"Click to add points. Click Done when finished to complete the area."}},I=(Q=1)=>{p.value=Q,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},$=Q=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=Q:t.value==="add-multiple"&&x(Q)},x=Q=>{i.value.push({id:`temp-${p.value}`,name:`Checkpoint ${p.value}`,description:"",latitude:Q.lat,longitude:Q.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),p.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},S=Q=>{s.value=Q},B=()=>s.value&&s.value.length>=3?s.value.map(Q=>({lat:Q.lat,lng:Q.lng})):null,E=()=>{e.value=!1,t.value=null,o.value={},a.value=null,r.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:s,tempCheckpoints:i,savedMapCenter:r,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:p,canCompleteFullscreen:g,saveMapState:y,enterPlaceCheckpointMode:_,enterMoveCheckpointMode:b,enterDrawAreaMode:C,enterAddMultipleMode:I,handleFullscreenMapClick:$,handlePolygonDrawing:S,getCompletedPolygon:B,exitFullscreen:E,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),E()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(Q,se,pe)=>U(()=>{const ee=[...Q.value];return t.value==="place-checkpoint"&&a.value&&ee.push({id:"temp-single",name:se.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:se.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&pe.value&&ee.push({id:"temp-move",name:pe.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:pe.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&ee.push(...i.value),ee}),createDisplayAreas:(Q,se)=>U(()=>{const pe=[...Q.value];if(t.value==="draw-area"&&se.value?.polygon?.length>0){const ee=pe.findIndex(te=>te.id===se.value.id);ee>=0?pe[ee]={...se.value}:pe.push({...se.value,id:se.value.id||"temp-area"})}return pe}),calculateStartingNumber:Q=>{const se=Q.value.map(pe=>{const ee=pe.name.match(/^Checkpoint (\d+)$/);return ee?parseInt(ee[1]):0}).filter(pe=>pe>0);return se.length>0?Math.max(...se)+1:1}}}function e0(e){const t=M([]),o=M(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await tu.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await tu.addAdmin(e.value,d)},removeAdmin:async d=>{await tu.removeAdmin(e.value,d)}}}function t0(e){const t=M(!1),o=M(!1),a=M(!1),s=M(!1),i=M(!1),r=M(!1),u=M(null),d=M(null),h=M(null),p=M(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:s,importing:i,importingMarshals:r,uploadError:u,importError:d,importResult:h,importMarshalsResult:p,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async E=>{if(!E)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await _a.uploadGpx(e.value,E),!0}catch(q){return console.error("Failed to upload route:",q),u.value=q.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,h.value=null},importLocations:async(E,q)=>{if(!E)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const P=await Jn.importCsv(e.value,E,q);return h.value=P.data,P.data}catch(P){return console.error("Failed to import locations:",P),d.value=P.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,p.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,p.value=null},importMarshals:async E=>{if(!E)return d.value="Please select a CSV file",null;r.value=!0,d.value=null,p.value=null;try{const q=await gs.importCsv(e.value,E);return p.value=q.data,q.data}catch(q){return console.error("Failed to import marshals:",q),d.value=q.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{r.value=!1}},formatImportResultMessage:(E,q="location")=>{const P=q==="location"?"location(s)":"marshal(s)";let R=`<p>Created <strong>${E[q==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${P} and <strong>${E.assignmentsCreated}</strong> assignment(s)</p>`;return E.errors&&E.errors.length>0&&(R+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',E.errors.forEach(j=>{R+=`<li>${j}</li>`}),R+="</ul>"),R}}}const Jv="admin-theme-preference",Ja=M(n0());function n0(){return typeof window>"u"?"system":localStorage.getItem(Jv)||"system"}function o0(e){localStorage.setItem(Jv,e)}function Yv(){const e=U(()=>Ja.value==="system"?"light dark":Ja.value),t=(s,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Ja.value=s,o0(s)},o=()=>{const s=["system","light","dark"],r=(s.indexOf(Ja.value)+1)%s.length;t(s[r])},a=U(()=>Ja.value==="dark"?!0:Ja.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Ja,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const Xv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Vl=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${s}T${i}:${r}`},qr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},di=(e,t,o,a)=>{const i=e*Math.PI/180,r=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,h=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(r)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},s0=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function a0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yl={exports:{}};var i0=yl.exports,cf;function l0(){return cf||(cf=1,(function(e,t){(function(o,a){a(t)})(i0,(function(o){var a="1.9.4";function s(n){var c,f,k,T;for(f=1,k=arguments.length;f<k;f++){T=arguments[f];for(c in T)n[c]=T[c]}return n}var i=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function r(n,c){var f=Array.prototype.slice;if(n.bind)return n.bind.apply(n,f.call(arguments,1));var k=f.call(arguments,2);return function(){return n.apply(c,k.length?k.concat(f.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function h(n,c,f){var k,T,V,ne;return ne=function(){k=!1,T&&(V.apply(f,T),T=!1)},V=function(){k?T=arguments:(n.apply(f,arguments),setTimeout(ne,c),k=!0)},V}function p(n,c,f){var k=c[1],T=c[0],V=k-T;return n===k&&f?n:((n-T)%V+V)%V+T}function g(){return!1}function y(n,c){if(c===!1)return n;var f=Math.pow(10,c===void 0?6:c);return Math.round(n*f)/f}function _(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function b(n){return _(n).split(/\s+/)}function C(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var f in c)n.options[f]=c[f];return n.options}function I(n,c,f){var k=[];for(var T in n)k.push(encodeURIComponent(f?T.toUpperCase():T)+"="+encodeURIComponent(n[T]));return(!c||c.indexOf("?")===-1?"?":"&")+k.join("&")}var $=/\{ *([\w_ -]+) *\}/g;function x(n,c){return n.replace($,function(f,k){var T=c[k];if(T===void 0)throw new Error("No value provided for variable "+f);return typeof T=="function"&&(T=T(c)),T})}var S=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function B(n,c){for(var f=0;f<n.length;f++)if(n[f]===c)return f;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function q(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var P=0;function F(n){var c=+new Date,f=Math.max(0,16-(c-P));return P=c+f,window.setTimeout(n,f)}var R=window.requestAnimationFrame||q("RequestAnimationFrame")||F,j=window.cancelAnimationFrame||q("CancelAnimationFrame")||q("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function O(n,c,f){if(f&&R===F)n.call(c);else return R.call(window,r(n,c))}function G(n){n&&j.call(window,n)}var Q={__proto__:null,extend:s,create:i,bind:r,get lastId(){return u},stamp:d,throttle:h,wrapNum:p,falseFn:g,formatNum:y,trim:_,splitWords:b,setOptions:C,getParamString:I,template:x,isArray:S,indexOf:B,emptyImageUrl:E,requestFn:R,cancelFn:j,requestAnimFrame:O,cancelAnimFrame:G};function se(){}se.extend=function(n){var c=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=c.__super__=this.prototype,k=i(f);k.constructor=c,c.prototype=k;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return n.statics&&s(c,n.statics),n.includes&&(pe(n.includes),s.apply(null,[k].concat(n.includes))),s(k,n),delete k.statics,delete k.includes,k.options&&(k.options=f.options?i(f.options):{},s(k.options,n.options)),k._initHooks=[],k.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var V=0,ne=k._initHooks.length;V<ne;V++)k._initHooks[V].call(this)}},c},se.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},se.mergeOptions=function(n){return s(this.prototype.options,n),this},se.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),f=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function pe(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=S(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ee={on:function(n,c,f){if(typeof n=="object")for(var k in n)this._on(k,n[k],c);else{n=b(n);for(var T=0,V=n.length;T<V;T++)this._on(n[T],c,f)}return this},off:function(n,c,f){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var k in n)this._off(k,n[k],c);else{n=b(n);for(var T=arguments.length===1,V=0,ne=n.length;V<ne;V++)T?this._off(n[V]):this._off(n[V],c,f)}return this},_on:function(n,c,f,k){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,f)===!1){f===this&&(f=void 0);var T={fn:c,ctx:f};k&&(T.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(T)}},_off:function(n,c,f){var k,T,V;if(this._events&&(k=this._events[n],!!k)){if(arguments.length===1){if(this._firingCount)for(T=0,V=k.length;T<V;T++)k[T].fn=g;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var ne=this._listens(n,c,f);if(ne!==!1){var Ce=k[ne];this._firingCount&&(Ce.fn=g,this._events[n]=k=k.slice()),k.splice(ne,1)}}},fire:function(n,c,f){if(!this.listens(n,f))return this;var k=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[n];if(T){this._firingCount=this._firingCount+1||1;for(var V=0,ne=T.length;V<ne;V++){var Ce=T[V],Ae=Ce.fn;Ce.once&&this.off(n,Ae,Ce.ctx),Ae.call(Ce.ctx||this,k)}this._firingCount--}}return f&&this._propagateEvent(k),this},listens:function(n,c,f,k){typeof n!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(k=!!c,T=void 0,f=void 0);var V=this._events&&this._events[n];if(V&&V.length&&this._listens(n,T,f)!==!1)return!0;if(k){for(var ne in this._eventParents)if(this._eventParents[ne].listens(n,c,f,k))return!0}return!1},_listens:function(n,c,f){if(!this._events)return!1;var k=this._events[n]||[];if(!c)return!!k.length;f===this&&(f=void 0);for(var T=0,V=k.length;T<V;T++)if(k[T].fn===c&&k[T].ctx===f)return T;return!1},once:function(n,c,f){if(typeof n=="object")for(var k in n)this._on(k,n[k],c,!0);else{n=b(n);for(var T=0,V=n.length;T<V;T++)this._on(n[T],c,f,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};ee.addEventListener=ee.on,ee.removeEventListener=ee.clearAllEventListeners=ee.off,ee.addOneTimeEventListener=ee.once,ee.fireEvent=ee.fire,ee.hasEventListeners=ee.listens;var te=se.extend(ee);function z(n,c,f){this.x=f?Math.round(n):n,this.y=f?Math.round(c):c}var Y=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};z.prototype={clone:function(){return new z(this.x,this.y)},add:function(n){return this.clone()._add(ue(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(ue(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new z(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new z(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Y(this.x),this.y=Y(this.y),this},distanceTo:function(n){n=ue(n);var c=n.x-this.x,f=n.y-this.y;return Math.sqrt(c*c+f*f)},equals:function(n){return n=ue(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=ue(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ue(n,c,f){return n instanceof z?n:S(n)?new z(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new z(n.x,n.y):new z(n,c,f)}function ke(n,c){if(n)for(var f=c?[n,c]:n,k=0,T=f.length;k<T;k++)this.extend(f[k])}ke.prototype={extend:function(n){var c,f;if(!n)return this;if(n instanceof z||typeof n[0]=="number"||"x"in n)c=f=ue(n);else if(n=Re(n),c=n.min,f=n.max,!c||!f)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=f.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(n){return ue((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return ue(this.min.x,this.max.y)},getTopRight:function(){return ue(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,f;return typeof n[0]=="number"||n instanceof z?n=ue(n):n=Re(n),n instanceof ke?(c=n.min,f=n.max):c=f=n,c.x>=this.min.x&&f.x<=this.max.x&&c.y>=this.min.y&&f.y<=this.max.y},intersects:function(n){n=Re(n);var c=this.min,f=this.max,k=n.min,T=n.max,V=T.x>=c.x&&k.x<=f.x,ne=T.y>=c.y&&k.y<=f.y;return V&&ne},overlaps:function(n){n=Re(n);var c=this.min,f=this.max,k=n.min,T=n.max,V=T.x>c.x&&k.x<f.x,ne=T.y>c.y&&k.y<f.y;return V&&ne},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,f=this.max,k=Math.abs(c.x-f.x)*n,T=Math.abs(c.y-f.y)*n;return Re(ue(c.x-k,c.y-T),ue(f.x+k,f.y+T))},equals:function(n){return n?(n=Re(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Re(n,c){return!n||n instanceof ke?n:new ke(n,c)}function Ye(n,c){if(n)for(var f=c?[n,c]:n,k=0,T=f.length;k<T;k++)this.extend(f[k])}Ye.prototype={extend:function(n){var c=this._southWest,f=this._northEast,k,T;if(n instanceof Ke)k=n,T=n;else if(n instanceof Ye){if(k=n._southWest,T=n._northEast,!k||!T)return this}else return n?this.extend(We(n)||Ne(n)):this;return!c&&!f?(this._southWest=new Ke(k.lat,k.lng),this._northEast=new Ke(T.lat,T.lng)):(c.lat=Math.min(k.lat,c.lat),c.lng=Math.min(k.lng,c.lng),f.lat=Math.max(T.lat,f.lat),f.lng=Math.max(T.lng,f.lng)),this},pad:function(n){var c=this._southWest,f=this._northEast,k=Math.abs(c.lat-f.lat)*n,T=Math.abs(c.lng-f.lng)*n;return new Ye(new Ke(c.lat-k,c.lng-T),new Ke(f.lat+k,f.lng+T))},getCenter:function(){return new Ke((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ke(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ke(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Ke||"lat"in n?n=We(n):n=Ne(n);var c=this._southWest,f=this._northEast,k,T;return n instanceof Ye?(k=n.getSouthWest(),T=n.getNorthEast()):k=T=n,k.lat>=c.lat&&T.lat<=f.lat&&k.lng>=c.lng&&T.lng<=f.lng},intersects:function(n){n=Ne(n);var c=this._southWest,f=this._northEast,k=n.getSouthWest(),T=n.getNorthEast(),V=T.lat>=c.lat&&k.lat<=f.lat,ne=T.lng>=c.lng&&k.lng<=f.lng;return V&&ne},overlaps:function(n){n=Ne(n);var c=this._southWest,f=this._northEast,k=n.getSouthWest(),T=n.getNorthEast(),V=T.lat>c.lat&&k.lat<f.lat,ne=T.lng>c.lng&&k.lng<f.lng;return V&&ne},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=Ne(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ne(n,c){return n instanceof Ye?n:new Ye(n,c)}function Ke(n,c,f){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,f!==void 0&&(this.alt=+f)}Ke.prototype={equals:function(n,c){if(!n)return!1;n=We(n);var f=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return f<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return _e.distance(this,We(n))},wrap:function(){return _e.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,f=c/Math.cos(Math.PI/180*this.lat);return Ne([this.lat-c,this.lng-f],[this.lat+c,this.lng+f])},clone:function(){return new Ke(this.lat,this.lng,this.alt)}};function We(n,c,f){return n instanceof Ke?n:S(n)&&typeof n[0]!="object"?n.length===3?new Ke(n[0],n[1],n[2]):n.length===2?new Ke(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Ke(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new Ke(n,c,f)}var X={latLngToPoint:function(n,c){var f=this.projection.project(n),k=this.scale(c);return this.transformation._transform(f,k)},pointToLatLng:function(n,c){var f=this.scale(c),k=this.transformation.untransform(n,f);return this.projection.unproject(k)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,f=this.scale(n),k=this.transformation.transform(c.min,f),T=this.transformation.transform(c.max,f);return new ke(k,T)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,f=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,k=n.alt;return new Ke(f,c,k)},wrapLatLngBounds:function(n){var c=n.getCenter(),f=this.wrapLatLng(c),k=c.lat-f.lat,T=c.lng-f.lng;if(k===0&&T===0)return n;var V=n.getSouthWest(),ne=n.getNorthEast(),Ce=new Ke(V.lat-k,V.lng-T),Ae=new Ke(ne.lat-k,ne.lng-T);return new Ye(Ce,Ae)}},_e=s({},X,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var f=Math.PI/180,k=n.lat*f,T=c.lat*f,V=Math.sin((c.lat-n.lat)*f/2),ne=Math.sin((c.lng-n.lng)*f/2),Ce=V*V+Math.cos(k)*Math.cos(T)*ne*ne,Ae=2*Math.atan2(Math.sqrt(Ce),Math.sqrt(1-Ce));return this.R*Ae}}),Le=6378137,me={R:Le,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,f=this.MAX_LATITUDE,k=Math.max(Math.min(f,n.lat),-f),T=Math.sin(k*c);return new z(this.R*n.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(n){var c=180/Math.PI;return new Ke((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=Le*Math.PI;return new ke([-n,-n],[n,n])})()};function ce(n,c,f,k){if(S(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=f,this._d=k}ce.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new z((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function N(n,c,f,k){return new ce(n,c,f,k)}var K=s({},_e,{code:"EPSG:3857",projection:me,transformation:(function(){var n=.5/(Math.PI*me.R);return N(n,.5,-n,.5)})()}),ae=s({},K,{code:"EPSG:900913"});function Te(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Be(n,c){var f="",k,T,V,ne,Ce,Ae;for(k=0,V=n.length;k<V;k++){for(Ce=n[k],T=0,ne=Ce.length;T<ne;T++)Ae=Ce[T],f+=(T?"L":"M")+Ae.x+" "+Ae.y;f+=c?je.svg?"z":"x":""}return f||"M0 0"}var De=document.documentElement.style,Se="ActiveXObject"in window,J=Se&&!document.addEventListener,he="msLaunchUri"in navigator&&!("documentMode"in document),xe=at("webkit"),Ie=at("android"),be=at("android 2")||at("android 3"),de=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fe=Ie&&at("Google")&&de<537&&!("AudioNode"in window),Z=!!window.opera,W=!he&&at("chrome"),ie=at("gecko")&&!xe&&!Z&&!Se,Ue=!W&&at("safari"),Xe=at("phantom"),mt="OTransition"in De,_t=navigator.platform.indexOf("Win")===0,gt=Se&&"transition"in De,St="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!be,bt="MozPerspective"in De,Ut=!window.L_DISABLE_3D&&(gt||St||bt)&&!mt&&!Xe,Bt=typeof orientation<"u"||at("mobile"),ut=Bt&&xe,ln=Bt&&St,un=!window.PointerEvent&&window.MSPointerEvent,Nt=!!(window.PointerEvent||un),wt="ontouchstart"in window||!!window.TouchEvent,Xn=!window.L_NO_TOUCH&&(wt||Nt),zn=Bt&&Z,Qn=Bt&&ie,_n=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kt=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return n})(),ks=(function(){return!!document.createElement("canvas").getContext})(),eo=!!(document.createElementNS&&Te("svg").createSVGRect),Io=!!eo&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),le=!eo&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),re=navigator.platform.indexOf("Mac")===0,ye=navigator.platform.indexOf("Linux")===0;function at(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var je={ie:Se,ielt9:J,edge:he,webkit:xe,android:Ie,android23:be,androidStock:fe,opera:Z,chrome:W,gecko:ie,safari:Ue,phantom:Xe,opera12:mt,win:_t,ie3d:gt,webkit3d:St,gecko3d:bt,any3d:Ut,mobile:Bt,mobileWebkit:ut,mobileWebkit3d:ln,msPointer:un,pointer:Nt,touch:Xn,touchNative:wt,mobileOpera:zn,mobileGecko:Qn,retina:_n,passiveEvents:Kt,canvas:ks,svg:eo,vml:le,inlineSvg:Io,mac:re,linux:ye},xt=je.msPointer?"MSPointerDown":"pointerdown",Jt=je.msPointer?"MSPointerMove":"pointermove",en=je.msPointer?"MSPointerUp":"pointerup",Bo=je.msPointer?"MSPointerCancel":"pointercancel",po={touchstart:xt,touchmove:Jt,touchend:en,touchcancel:Bo},No={touchstart:xo,touchmove:dn,touchend:dn,touchcancel:dn},Hn={},Aa=!1;function _s(n,c,f){return c==="touchstart"&&Ks(),No[c]?(f=No[c].bind(this,f),n.addEventListener(po[c],f,!1),f):(console.warn("wrong event specified:",c),g)}function Fo(n,c,f){if(!po[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(po[c],f,!1)}function is(n){Hn[n.pointerId]=n}function Ws(n){Hn[n.pointerId]&&(Hn[n.pointerId]=n)}function Vn(n){delete Hn[n.pointerId]}function Ks(){Aa||(document.addEventListener(xt,is,!0),document.addEventListener(Jt,Ws,!0),document.addEventListener(en,Vn,!0),document.addEventListener(Bo,Vn,!0),Aa=!0)}function dn(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var f in Hn)c.touches.push(Hn[f]);c.changedTouches=[c],n(c)}}function xo(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Wt(c),dn(n,c)}function $o(n){var c={},f,k;for(k in n)f=n[k],c[k]=f&&f.bind?f.bind(n):f;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var bs=200;function vo(n,c){n.addEventListener("dblclick",c);var f=0,k;function T(V){if(V.detail!==1){k=V.detail;return}if(!(V.pointerType==="mouse"||V.sourceCapabilities&&!V.sourceCapabilities.firesTouchEvents)){var ne=Da(V);if(!(ne.some(function(Ae){return Ae instanceof HTMLLabelElement&&Ae.attributes.for})&&!ne.some(function(Ae){return Ae instanceof HTMLInputElement||Ae instanceof HTMLSelectElement}))){var Ce=Date.now();Ce-f<=bs?(k++,k===2&&c($o(V))):k=1,f=Ce}}}return n.addEventListener("click",T),{dblclick:c,simDblclick:T}}function mo(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var to=ls(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),To=ls(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),pn=To==="webkitTransition"||To==="OTransition"?To+"End":"transitionend";function go(n){return typeof n=="string"?document.getElementById(n):n}function no(n,c){var f=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!f||f==="auto")&&document.defaultView){var k=document.defaultView.getComputedStyle(n,null);f=k?k[c]:null}return f==="auto"?null:f}function kt(n,c,f){var k=document.createElement(n);return k.className=c||"",f&&f.appendChild(k),k}function Et(n){var c=n.parentNode;c&&c.removeChild(n)}function Mo(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Uo(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function yo(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Js(n,c){if(n.classList!==void 0)return n.classList.contains(c);var f=ws(n);return f.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(f)}function ht(n,c){if(n.classList!==void 0)for(var f=b(c),k=0,T=f.length;k<T;k++)n.classList.add(f[k]);else if(!Js(n,c)){var V=ws(n);Ea(n,(V?V+" ":"")+c)}}function zt(n,c){n.classList!==void 0?n.classList.remove(c):Ea(n,_((" "+ws(n)+" ").replace(" "+c+" "," ")))}function Ea(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function ws(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function $n(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&el(n,c)}function el(n,c){var f=!1,k="DXImageTransform.Microsoft.Alpha";try{f=n.filters.item(k)}catch{if(c===1)return}c=Math.round(c*100),f?(f.Enabled=c!==100,f.Opacity=c):n.style.filter+=" progid:"+k+"(opacity="+c+")"}function ls(n){for(var c=document.documentElement.style,f=0;f<n.length;f++)if(n[f]in c)return n[f];return!1}function Ao(n,c,f){var k=c||new z(0,0);n.style[to]=(je.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(f?" scale("+f+")":"")}function qt(n,c){n._leaflet_pos=c,je.any3d?Ao(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function zo(n){return n._leaflet_pos||new z(0,0)}var Ho,Cs,Pa;if("onselectstart"in document)Ho=function(){rt(window,"selectstart",Wt)},Cs=function(){$t(window,"selectstart",Wt)};else{var bn=ls(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ho=function(){if(bn){var n=document.documentElement.style;Pa=n[bn],n[bn]="none"}},Cs=function(){bn&&(document.documentElement.style[bn]=Pa,Pa=void 0)}}function oo(){rt(window,"dragstart",Wt)}function jt(){$t(window,"dragstart",Wt)}var wn,Ys;function Xs(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Qs(),wn=n,Ys=n.style.outlineStyle,n.style.outlineStyle="none",rt(window,"keydown",Qs))}function Qs(){wn&&(wn.style.outlineStyle=Ys,wn=void 0,Ys=void 0,$t(window,"keydown",Qs))}function fi(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Tn(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var ea={__proto__:null,TRANSFORM:to,TRANSITION:To,TRANSITION_END:pn,get:go,getStyle:no,create:kt,remove:Et,empty:Mo,toFront:Uo,toBack:yo,hasClass:Js,addClass:ht,removeClass:zt,setClass:Ea,getClass:ws,setOpacity:$n,testProp:ls,setTransform:Ao,setPosition:qt,getPosition:zo,get disableTextSelection(){return Ho},get enableTextSelection(){return Cs},disableImageDrag:oo,enableImageDrag:jt,preventOutline:Xs,restoreOutline:Qs,getSizedParentNode:fi,getScale:Tn};function rt(n,c,f,k){if(c&&typeof c=="object")for(var T in c)ta(n,T,c[T],f);else{c=b(c);for(var V=0,ne=c.length;V<ne;V++)ta(n,c[V],f,k)}return this}var hn="_leaflet_events";function $t(n,c,f,k){if(arguments.length===1)so(n),delete n[hn];else if(c&&typeof c=="object")for(var T in c)na(n,T,c[T],f);else if(c=b(c),arguments.length===2)so(n,function(Ce){return B(c,Ce)!==-1});else for(var V=0,ne=c.length;V<ne;V++)na(n,c[V],f,k);return this}function so(n,c){for(var f in n[hn]){var k=f.split(/\d/)[0];(!c||c(k))&&na(n,k,null,null,f)}}var ko={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ta(n,c,f,k){var T=c+d(f)+(k?"_"+d(k):"");if(n[hn]&&n[hn][T])return this;var V=function(Ce){return f.call(k||n,Ce||window.event)},ne=V;!je.touchNative&&je.pointer&&c.indexOf("touch")===0?V=_s(n,c,V):je.touch&&c==="dblclick"?V=vo(n,V):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(ko[c]||c,V,je.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(V=function(Ce){Ce=Ce||window.event,oa(n,Ce)&&ne(Ce)},n.addEventListener(ko[c],V,!1)):n.addEventListener(c,ne,!1):n.attachEvent("on"+c,V),n[hn]=n[hn]||{},n[hn][T]=V}function na(n,c,f,k,T){T=T||c+d(f)+(k?"_"+d(k):"");var V=n[hn]&&n[hn][T];if(!V)return this;!je.touchNative&&je.pointer&&c.indexOf("touch")===0?Fo(n,c,V):je.touch&&c==="dblclick"?mo(n,V):"removeEventListener"in n?n.removeEventListener(ko[c]||c,V,!1):n.detachEvent("on"+c,V),n[hn][T]=null}function Mn(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Ls(n){return ta(n,"wheel",Mn),this}function Gn(n){return rt(n,"mousedown touchstart dblclick contextmenu",Mn),n._leaflet_disable_click=!0,this}function Wt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Eo(n){return Wt(n),Mn(n),this}function Da(n){if(n.composedPath)return n.composedPath();for(var c=[],f=n.target;f;)c.push(f),f=f.parentNode;return c}function Ss(n,c){if(!c)return new z(n.clientX,n.clientY);var f=Tn(c),k=f.boundingClientRect;return new z((n.clientX-k.left)/f.x-c.clientLeft,(n.clientY-k.top)/f.y-c.clientTop)}var tl=je.linux&&je.chrome?window.devicePixelRatio:je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function pi(n){return je.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/tl:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function oa(n,c){var f=c.relatedTarget;if(!f)return!0;try{for(;f&&f!==n;)f=f.parentNode}catch{return!1}return f!==n}var nl={__proto__:null,on:rt,off:$t,stopPropagation:Mn,disableScrollPropagation:Ls,disableClickPropagation:Gn,preventDefault:Wt,stop:Eo,getPropagationPath:Da,getMousePosition:Ss,getWheelDelta:pi,isExternalTarget:oa,addListener:rt,removeListener:$t},vi=te.extend({run:function(n,c,f,k){this.stop(),this._el=n,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(k||.5,.2),this._startPos=zo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,f=this._duration*1e3;c<f?this._runFrame(this._easeOut(c/f),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var f=this._startPos.add(this._offset.multiplyBy(n));c&&f._round(),qt(this._el,f),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Ct=te.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=C(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(We(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=To&&je.any3d&&!je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,pn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,f){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(We(n),c,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=s({animate:f.animate},f.zoom),f.pan=s({animate:f.animate,duration:f.duration},f.pan));var k=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,f.zoom):this._tryAnimatedPan(n,f.pan);if(k)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,f.pan&&f.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,f){var k=this.getZoomScale(c),T=this.getSize().divideBy(2),V=n instanceof z?n:this.latLngToContainerPoint(n),ne=V.subtract(T).multiplyBy(1-1/k),Ce=this.containerPointToLatLng(T.add(ne));return this.setView(Ce,c,{zoom:f})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():Ne(n);var f=ue(c.paddingTopLeft||c.padding||[0,0]),k=ue(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(n,!1,f.add(k));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:n.getCenter(),zoom:T};var V=k.subtract(f).divideBy(2),ne=this.project(n.getSouthWest(),T),Ce=this.project(n.getNorthEast(),T),Ae=this.unproject(ne.add(Ce).divideBy(2).add(V),T);return{center:Ae,zoom:T}},fitBounds:function(n,c){if(n=Ne(n),!n.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(n,c);return this.setView(f.center,f.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=ue(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new vi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,f,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,f){if(f=f||{},f.animate===!1||!je.any3d)return this.setView(n,c,f);this._stop();var k=this.project(this.getCenter()),T=this.project(n),V=this.getSize(),ne=this._zoom;n=We(n),c=c===void 0?ne:c;var Ce=Math.max(V.x,V.y),Ae=Ce*this.getZoomScale(ne,c),Ve=T.distanceTo(k)||1,st=1.42,dt=st*st;function Lt(rn){var ur=rn?-1:1,Cm=rn?Ae:Ce,Lm=Ae*Ae-Ce*Ce+ur*dt*dt*Ve*Ve,Sm=2*Cm*dt*Ve,Dc=Lm/Sm,Ed=Math.sqrt(Dc*Dc+1)-Dc,Im=Ed<1e-9?-18:Math.log(Ed);return Im}function jn(rn){return(Math.exp(rn)-Math.exp(-rn))/2}function gn(rn){return(Math.exp(rn)+Math.exp(-rn))/2}function Po(rn){return jn(rn)/gn(rn)}var ro=Lt(0);function Mi(rn){return Ce*(gn(ro)/gn(ro+st*rn))}function km(rn){return Ce*(gn(ro)*Po(ro+st*rn)-jn(ro))/dt}function _m(rn){return 1-Math.pow(1-rn,1.5)}var bm=Date.now(),Md=(Lt(1)-ro)/st,wm=f.duration?1e3*f.duration:1e3*Md*.8;function Ad(){var rn=(Date.now()-bm)/wm,ur=_m(rn)*Md;rn<=1?(this._flyToFrame=O(Ad,this),this._move(this.unproject(k.add(T.subtract(k).multiplyBy(km(ur)/Ve)),ne),this.getScaleZoom(Ce/Mi(ur),ne),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),Ad.call(this),this},flyToBounds:function(n,c){var f=this._getBoundsCenterZoom(n,c);return this.flyTo(f.center,f.zoom,c)},setMaxBounds:function(n){return n=Ne(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var f=this.getCenter(),k=this._limitCenter(f,this._zoom,Ne(n));return f.equals(k)||this.panTo(k,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var f=ue(c.paddingTopLeft||c.padding||[0,0]),k=ue(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),V=this.project(n),ne=this.getPixelBounds(),Ce=Re([ne.min.add(f),ne.max.subtract(k)]),Ae=Ce.getSize();if(!Ce.contains(V)){this._enforcingBounds=!0;var Ve=V.subtract(Ce.getCenter()),st=Ce.extend(V).getSize().subtract(Ae);T.x+=Ve.x<0?-st.x:st.x,T.y+=Ve.y<0?-st.y:st.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),k=c.divideBy(2).round(),T=f.divideBy(2).round(),V=k.subtract(T);return!V.x&&!V.y?this:(n.animate&&n.pan?this.panBy(V):(n.pan&&this._rawPanBy(V),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=r(this._handleGeolocationResponse,this),f=r(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,f,n):navigator.geolocation.getCurrentPosition(c,f,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,f=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,f=n.coords.longitude,k=new Ke(c,f),T=k.toBounds(n.coords.accuracy*2),V=this._locateOptions;if(V.setView){var ne=this.getBoundsZoom(T);this.setView(k,V.maxZoom?Math.min(ne,V.maxZoom):ne)}var Ce={latlng:k,bounds:T,timestamp:n.timestamp};for(var Ae in n.coords)typeof n.coords[Ae]=="number"&&(Ce[Ae]=n.coords[Ae]);this.fire("locationfound",Ce)}},addHandler:function(n,c){if(!c)return this;var f=this[n]=new c(this);return this._handlers.push(f),this.options[n]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Et(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var f="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),k=kt("div",f,c||this._mapPane);return n&&(this._panes[n]=k),k},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),f=this.unproject(n.getTopRight());return new Ye(c,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,f){n=Ne(n),f=ue(f||[0,0]);var k=this.getZoom()||0,T=this.getMinZoom(),V=this.getMaxZoom(),ne=n.getNorthWest(),Ce=n.getSouthEast(),Ae=this.getSize().subtract(f),Ve=Re(this.project(Ce,k),this.project(ne,k)).getSize(),st=je.any3d?this.options.zoomSnap:1,dt=Ae.x/Ve.x,Lt=Ae.y/Ve.y,jn=c?Math.max(dt,Lt):Math.min(dt,Lt);return k=this.getScaleZoom(jn,k),st&&(k=Math.round(k/(st/100))*(st/100),k=c?Math.ceil(k/st)*st:Math.floor(k/st)*st),Math.max(T,Math.min(V,k))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var f=this._getTopLeftPoint(n,c);return new ke(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var f=this.options.crs;return c=c===void 0?this._zoom:c,f.scale(n)/f.scale(c)},getScaleZoom:function(n,c){var f=this.options.crs;c=c===void 0?this._zoom:c;var k=f.zoom(n*f.scale(c));return isNaN(k)?1/0:k},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(We(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ue(n),c)},layerPointToLatLng:function(n){var c=ue(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(We(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(We(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Ne(n))},distance:function(n,c){return this.options.crs.distance(We(n),We(c))},containerPointToLayerPoint:function(n){return ue(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return ue(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(ue(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(We(n)))},mouseEventToContainerPoint:function(n){return Ss(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=go(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&je.any3d,ht(n,"leaflet-container"+(je.touch?" leaflet-touch":"")+(je.retina?" leaflet-retina":"")+(je.ielt9?" leaflet-oldie":"")+(je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=no(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qt(this._mapPane,new z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(n.markerPane,"leaflet-zoom-hide"),ht(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,f){qt(this._mapPane,new z(0,0));var k=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,f)._move(n,c)._moveEnd(T),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,f,k){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),k?f&&f.pinch&&this.fire("zoom",f):((T||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){qt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?$t:rt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),je.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var f=[],k,T=c==="mouseout"||c==="mouseover",V=n.target||n.srcElement,ne=!1;V;){if(k=this._targets[d(V)],k&&(c==="click"||c==="preclick")&&this._draggableMoved(k)){ne=!0;break}if(k&&k.listens(c,!0)&&(T&&!oa(V,n)||(f.push(k),T))||V===this._container)break;V=V.parentNode}return!f.length&&!ne&&!T&&this.listens(c,!0)&&(f=[this]),f},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var f=n.type;f==="mousedown"&&Xs(c),this._fireDOMEvent(n,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,f){if(n.type==="click"){var k=s({},n);k.type="preclick",this._fireDOMEvent(k,k.type,f)}var T=this._findEventTargets(n,c);if(f){for(var V=[],ne=0;ne<f.length;ne++)f[ne].listens(c,!0)&&V.push(f[ne]);T=V.concat(T)}if(T.length){c==="contextmenu"&&Wt(n);var Ce=T[0],Ae={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ve=Ce.getLatLng&&(!Ce._radius||Ce._radius<=10);Ae.containerPoint=Ve?this.latLngToContainerPoint(Ce.getLatLng()):this.mouseEventToContainerPoint(n),Ae.layerPoint=this.containerPointToLayerPoint(Ae.containerPoint),Ae.latlng=Ve?Ce.getLatLng():this.layerPointToLatLng(Ae.layerPoint)}for(ne=0;ne<T.length;ne++)if(T[ne].fire(c,Ae,!0),Ae.originalEvent._stopped||T[ne].options.bubblingMouseEvents===!1&&B(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return zo(this._mapPane)||new z(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var f=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var f=this.getSize()._divideBy(2);return this.project(n,c)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,f){var k=this._getNewPixelOrigin(f,c);return this.project(n,c)._subtract(k)},_latLngBoundsToNewLayerBounds:function(n,c,f){var k=this._getNewPixelOrigin(f,c);return Re([this.project(n.getSouthWest(),c)._subtract(k),this.project(n.getNorthWest(),c)._subtract(k),this.project(n.getSouthEast(),c)._subtract(k),this.project(n.getNorthEast(),c)._subtract(k)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,f){if(!f)return n;var k=this.project(n,c),T=this.getSize().divideBy(2),V=new ke(k.subtract(T),k.add(T)),ne=this._getBoundsOffset(V,f,c);return Math.abs(ne.x)<=1&&Math.abs(ne.y)<=1?n:this.unproject(k.add(ne),c)},_limitOffset:function(n,c){if(!c)return n;var f=this.getPixelBounds(),k=new ke(f.min.add(n),f.max.add(n));return n.add(this._getBoundsOffset(k,c))},_getBoundsOffset:function(n,c,f){var k=Re(this.project(c.getNorthEast(),f),this.project(c.getSouthWest(),f)),T=k.min.subtract(n.min),V=k.max.subtract(n.max),ne=this._rebound(T.x,-V.x),Ce=this._rebound(T.y,-V.y);return new z(ne,Ce)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),f=this.getMaxZoom(),k=je.any3d?this.options.zoomSnap:1;return k&&(n=Math.round(n/k)*k),Math.max(c,Math.min(f,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){zt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var f=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,c),!0)},_createAnimProxy:function(){var n=this._proxy=kt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var f=to,k=this._proxy.style[f];Ao(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),k===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();Ao(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var k=this.getZoomScale(c),T=this._getCenterOffset(n)._divideBy(1-1/k);return f.animate!==!0&&!this.getSize().contains(T)?!1:(O(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,f,k){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:k}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&zt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function mi(n,c){return new Ct(n,c)}var vn=se.extend({options:{position:"topright"},initialize:function(n){C(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),f=this.getPosition(),k=n._controlCorners[f];return ht(c,"leaflet-control"),f.indexOf("bottom")!==-1?k.insertBefore(c,k.firstChild):k.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Vo=function(n){return new vn(n)};Ct.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",f=this._controlContainer=kt("div",c+"control-container",this._container);function k(T,V){var ne=c+T+" "+c+V;n[T+V]=kt("div",ne,f)}k("top","left"),k("top","right"),k("bottom","left"),k("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Et(this._controlCorners[n]);Et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oa=vn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,f,k){return f<k?-1:k<f?1:0}},initialize:function(n,c,f){C(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var k in n)this._addLayer(n[k],k);for(k in c)this._addLayer(c[k],k,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return vn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):zt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return zt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=kt("div",n),f=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Gn(c),Ls(c);var k=this._section=kt("section",n+"-list");f&&(this._map.on("click",this.collapse,this),rt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=kt("a",n+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),rt(T,{keydown:function(V){V.keyCode===13&&this._expandSafely()},click:function(V){Wt(V),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=kt("div",n+"-base",k),this._separator=kt("div",n+"-separator",k),this._overlaysList=kt("div",n+"-overlays",k),c.appendChild(k)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,f){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:f}),this.options.sortLayers&&this._layers.sort(r(function(k,T){return this.options.sortFunction(k.layer,T.layer,k.name,T.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Mo(this._baseLayersList),Mo(this._overlaysList),this._layerControlInputs=[];var n,c,f,k,T=0;for(f=0;f<this._layers.length;f++)k=this._layers[f],this._addItem(k),c=c||k.overlay,n=n||!k.overlay,T+=k.overlay?0:1;return this.options.hideSingleBase&&(n=n&&T>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),f=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;f&&this._map.fire(f,c)},_createRadioElement:function(n,c){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",k=document.createElement("div");return k.innerHTML=f,k.firstChild},_addItem:function(n){var c=document.createElement("label"),f=this._map.hasLayer(n.layer),k;n.overlay?(k=document.createElement("input"),k.type="checkbox",k.className="leaflet-control-layers-selector",k.defaultChecked=f):k=this._createRadioElement("leaflet-base-layers_"+d(this),f),this._layerControlInputs.push(k),k.layerId=d(n.layer),rt(k,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+n.name;var V=document.createElement("span");c.appendChild(V),V.appendChild(k),V.appendChild(T);var ne=n.overlay?this._overlaysList:this._baseLayersList;return ne.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,f,k=[],T=[];this._handlingClick=!0;for(var V=n.length-1;V>=0;V--)c=n[V],f=this._getLayer(c.layerId).layer,c.checked?k.push(f):c.checked||T.push(f);for(V=0;V<T.length;V++)this._map.hasLayer(T[V])&&this._map.removeLayer(T[V]);for(V=0;V<k.length;V++)this._map.hasLayer(k[V])||this._map.addLayer(k[V]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,f,k=this._map.getZoom(),T=n.length-1;T>=0;T--)c=n[T],f=this._getLayer(c.layerId).layer,c.disabled=f.options.minZoom!==void 0&&k<f.options.minZoom||f.options.maxZoom!==void 0&&k>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,rt(n,"click",Wt),this.expand();var c=this;setTimeout(function(){$t(n,"click",Wt),c._preventClick=!1})}}),ol=function(n,c,f){return new Oa(n,c,f)},Ra=vn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",f=kt("div",c+" leaflet-bar"),k=this.options;return this._zoomInButton=this._createButton(k.zoomInText,k.zoomInTitle,c+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(k.zoomOutText,k.zoomOutTitle,c+"-out",f,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,f,k,T){var V=kt("a",f,k);return V.innerHTML=n,V.href="#",V.title=c,V.setAttribute("role","button"),V.setAttribute("aria-label",c),Gn(V),rt(V,"click",Eo),rt(V,"click",T,this),rt(V,"click",this._refocusOnMap,this),V},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";zt(this._zoomInButton,c),zt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ht(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ht(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ra,this.addControl(this.zoomControl))});var Ba=function(n){return new Ra(n)},Na=vn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",f=kt("div",c),k=this.options;return this._addScales(k,c+"-line",f),n.on(k.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),f},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,f){n.metric&&(this._mScale=kt("div",c,f)),n.imperial&&(this._iScale=kt("div",c,f))},_update:function(){var n=this._map,c=n.getSize().y/2,f=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(f)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),f=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,f,c/n)},_updateImperial:function(n){var c=n*3.2808399,f,k,T;c>5280?(f=c/5280,k=this._getRoundNum(f),this._updateScale(this._iScale,k+" mi",k/f)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(n,c,f){n.style.width=Math.round(this.options.maxWidth*f)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),f=n/c;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,c*f}}),gi=function(n){return new Na(n)},yi='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Fa=vn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(je.inlineSvg?yi+" ":"")+"Leaflet</a>"},initialize:function(n){C(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=kt("div","leaflet-control-attribution"),Gn(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var f=[];this.options.prefix&&f.push(this.options.prefix),n.length&&f.push(n.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new Fa().addTo(this)});var Oe=function(n){return new Fa(n)};vn.Layers=Oa,vn.Zoom=Ra,vn.Scale=Na,vn.Attribution=Fa,Vo.layers=ol,Vo.zoom=Ba,Vo.scale=gi,Vo.attribution=Oe;var $e=se.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});$e.addTo=function(n,c){return n.addHandler(c,this),this};var nt={Events:ee},ft=je.touch?"touchstart mousedown":"mousedown",vt=te.extend({options:{clickTolerance:3},initialize:function(n,c,f,k){C(this,k),this._element=n,this._dragStartTarget=c||n,this._preventOutline=f},enable:function(){this._enabled||(rt(this._dragStartTarget,ft,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(vt._dragging===this&&this.finishDrag(!0),$t(this._dragStartTarget,ft,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Js(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){vt._dragging===this&&this.finishDrag();return}if(!(vt._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(vt._dragging=this,this._preventOutline&&Xs(this._element),oo(),Ho(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,f=fi(this._element);this._startPoint=new z(c.clientX,c.clientY),this._startPos=zo(this._element),this._parentScale=Tn(f);var k=n.type==="mousedown";rt(document,k?"mousemove":"touchmove",this._onMove,this),rt(document,k?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,f=new z(c.clientX,c.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,Wt(n),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),qt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){zt(document.body,"leaflet-dragging"),this._lastTarget&&(zt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),$t(document,"mousemove touchmove",this._onMove,this),$t(document,"mouseup touchend touchcancel",this._onUp,this),jt(),Cs();var c=this._moved&&this._moving;this._moving=!1,vt._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function nn(n,c,f){var k,T=[1,4,2,8],V,ne,Ce,Ae,Ve,st,dt,Lt;for(V=0,st=n.length;V<st;V++)n[V]._code=rs(n[V],c);for(Ce=0;Ce<4;Ce++){for(dt=T[Ce],k=[],V=0,st=n.length,ne=st-1;V<st;ne=V++)Ae=n[V],Ve=n[ne],Ae._code&dt?Ve._code&dt||(Lt=ki(Ve,Ae,dt,c,f),Lt._code=rs(Lt,c),k.push(Lt)):(Ve._code&dt&&(Lt=ki(Ve,Ae,dt,c,f),Lt._code=rs(Lt,c),k.push(Lt)),k.push(Ae));n=k}return n}function Cn(n,c){var f,k,T,V,ne,Ce,Ae,Ve,st;if(!n||n.length===0)throw new Error("latlngs not passed");lo(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var dt=We([0,0]),Lt=Ne(n),jn=Lt.getNorthWest().distanceTo(Lt.getSouthWest())*Lt.getNorthEast().distanceTo(Lt.getNorthWest());jn<1700&&(dt=An(n));var gn=n.length,Po=[];for(f=0;f<gn;f++){var ro=We(n[f]);Po.push(c.project(We([ro.lat-dt.lat,ro.lng-dt.lng])))}for(Ce=Ae=Ve=0,f=0,k=gn-1;f<gn;k=f++)T=Po[f],V=Po[k],ne=T.y*V.x-V.y*T.x,Ae+=(T.x+V.x)*ne,Ve+=(T.y+V.y)*ne,Ce+=ne*3;Ce===0?st=Po[0]:st=[Ae/Ce,Ve/Ce];var Mi=c.unproject(ue(st));return We([Mi.lat+dt.lat,Mi.lng+dt.lng])}function An(n){for(var c=0,f=0,k=0,T=0;T<n.length;T++){var V=We(n[T]);c+=V.lat,f+=V.lng,k++}return We([c/k,f/k])}var Ht={__proto__:null,clipPolygon:nn,polygonCenter:Cn,centroid:An};function En(n,c){if(!c||!n.length)return n.slice();var f=c*c;return n=_o(n,f),n=ao(n,f),n}function Tt(n,c,f){return Math.sqrt(sa(n,c,f,!0))}function on(n,c,f){return sa(n,c,f)}function ao(n,c){var f=n.length,k=typeof Uint8Array<"u"?Uint8Array:Array,T=new k(f);T[0]=T[f-1]=1,io(n,T,c,0,f-1);var V,ne=[];for(V=0;V<f;V++)T[V]&&ne.push(n[V]);return ne}function io(n,c,f,k,T){var V=0,ne,Ce,Ae;for(Ce=k+1;Ce<=T-1;Ce++)Ae=sa(n[Ce],n[k],n[T],!0),Ae>V&&(ne=Ce,V=Ae);V>f&&(c[ne]=1,io(n,c,f,k,ne),io(n,c,f,ne,T))}function _o(n,c){for(var f=[n[0]],k=1,T=0,V=n.length;k<V;k++)Sc(n[k],n[T])>c&&(f.push(n[k]),T=k);return T<V-1&&f.push(n[V-1]),f}var Ua;function za(n,c,f,k,T){var V=k?Ua:rs(n,f),ne=rs(c,f),Ce,Ae,Ve;for(Ua=ne;;){if(!(V|ne))return[n,c];if(V&ne)return!1;Ce=V||ne,Ae=ki(n,c,Ce,f,T),Ve=rs(Ae,f),Ce===V?(n=Ae,V=Ve):(c=Ae,ne=Ve)}}function ki(n,c,f,k,T){var V=c.x-n.x,ne=c.y-n.y,Ce=k.min,Ae=k.max,Ve,st;return f&8?(Ve=n.x+V*(Ae.y-n.y)/ne,st=Ae.y):f&4?(Ve=n.x+V*(Ce.y-n.y)/ne,st=Ce.y):f&2?(Ve=Ae.x,st=n.y+ne*(Ae.x-n.x)/V):f&1&&(Ve=Ce.x,st=n.y+ne*(Ce.x-n.x)/V),new z(Ve,st,T)}function rs(n,c){var f=0;return n.x<c.min.x?f|=1:n.x>c.max.x&&(f|=2),n.y<c.min.y?f|=4:n.y>c.max.y&&(f|=8),f}function Sc(n,c){var f=c.x-n.x,k=c.y-n.y;return f*f+k*k}function sa(n,c,f,k){var T=c.x,V=c.y,ne=f.x-T,Ce=f.y-V,Ae=ne*ne+Ce*Ce,Ve;return Ae>0&&(Ve=((n.x-T)*ne+(n.y-V)*Ce)/Ae,Ve>1?(T=f.x,V=f.y):Ve>0&&(T+=ne*Ve,V+=Ce*Ve)),ne=n.x-T,Ce=n.y-V,k?ne*ne+Ce*Ce:new z(T,V)}function lo(n){return!S(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function tr(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),lo(n)}function nr(n,c){var f,k,T,V,ne,Ce,Ae,Ve;if(!n||n.length===0)throw new Error("latlngs not passed");lo(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var st=We([0,0]),dt=Ne(n),Lt=dt.getNorthWest().distanceTo(dt.getSouthWest())*dt.getNorthEast().distanceTo(dt.getNorthWest());Lt<1700&&(st=An(n));var jn=n.length,gn=[];for(f=0;f<jn;f++){var Po=We(n[f]);gn.push(c.project(We([Po.lat-st.lat,Po.lng-st.lng])))}for(f=0,k=0;f<jn-1;f++)k+=gn[f].distanceTo(gn[f+1])/2;if(k===0)Ve=gn[0];else for(f=0,V=0;f<jn-1;f++)if(ne=gn[f],Ce=gn[f+1],T=ne.distanceTo(Ce),V+=T,V>k){Ae=(V-k)/T,Ve=[Ce.x-Ae*(Ce.x-ne.x),Ce.y-Ae*(Ce.y-ne.y)];break}var ro=c.unproject(ue(Ve));return We([ro.lat+st.lat,ro.lng+st.lng])}var Ic={__proto__:null,simplify:En,pointToSegmentDistance:Tt,closestPointOnSegment:on,clipSegment:za,_getEdgeIntersection:ki,_getBitCode:rs,_sqClosestPointOnSegment:sa,isFlat:lo,_flat:tr,polylineCenter:nr},sl={project:function(n){return new z(n.lng,n.lat)},unproject:function(n){return new Ke(n.y,n.x)},bounds:new ke([-180,-90],[180,90])},al={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ke([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,f=this.R,k=n.lat*c,T=this.R_MINOR/f,V=Math.sqrt(1-T*T),ne=V*Math.sin(k),Ce=Math.tan(Math.PI/4-k/2)/Math.pow((1-ne)/(1+ne),V/2);return k=-f*Math.log(Math.max(Ce,1e-10)),new z(n.lng*c*f,k)},unproject:function(n){for(var c=180/Math.PI,f=this.R,k=this.R_MINOR/f,T=Math.sqrt(1-k*k),V=Math.exp(-n.y/f),ne=Math.PI/2-2*Math.atan(V),Ce=0,Ae=.1,Ve;Ce<15&&Math.abs(Ae)>1e-7;Ce++)Ve=T*Math.sin(ne),Ve=Math.pow((1-Ve)/(1+Ve),T/2),Ae=Math.PI/2-2*Math.atan(V*Ve)-ne,ne+=Ae;return new Ke(ne*c,n.x*c/f)}},xc={__proto__:null,LonLat:sl,Mercator:al,SphericalMercator:me},$c=s({},_e,{code:"EPSG:3395",projection:al,transformation:(function(){var n=.5/(Math.PI*al.R);return N(n,.5,-n,.5)})()}),or=s({},_e,{code:"EPSG:4326",projection:sl,transformation:N(1/180,1,-1/180,.5)}),Tc=s({},X,{projection:sl,transformation:N(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var f=c.lng-n.lng,k=c.lat-n.lat;return Math.sqrt(f*f+k*k)},infinite:!0});X.Earth=_e,X.EPSG3395=$c,X.EPSG3857=K,X.EPSG900913=ae,X.EPSG4326=or,X.Simple=Tc;var bo=te.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var f=this.getEvents();c.on(f,this),this.once("remove",function(){c.off(f,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var f in this._layers)n.call(c,this._layers[f]);return this},_addLayers:function(n){n=n?S(n)?n:[n]:[];for(var c=0,f=n.length;c<f;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,f=this._getZoomSpan();for(var k in this._zoomBoundLayers){var T=this._zoomBoundLayers[k].options;n=T.minZoom===void 0?n:Math.min(n,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var aa=bo.extend({initialize:function(n,c){C(this,c),this._layers={};var f,k;if(n)for(f=0,k=n.length;f<k;f++)this.addLayer(n[f])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),f,k;for(f in this._layers)k=this._layers[f],k[n]&&k[n].apply(k,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var f in this._layers)n.call(c,this._layers[f]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),_i=function(n,c){return new aa(n,c)},Go=aa.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),aa.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),aa.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Ye;for(var c in this._layers){var f=this._layers[c];n.extend(f.getBounds?f.getBounds():f.getLatLng())}return n}}),bi=function(n,c){return new Go(n,c)},ia=se.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){C(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var f=this._getIconUrl(n);if(!f){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var k=this._createImg(f,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(k,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),k},_setIconStyles:function(n,c){var f=this.options,k=f[c+"Size"];typeof k=="number"&&(k=[k,k]);var T=ue(k),V=ue(c==="shadow"&&f.shadowAnchor||f.iconAnchor||T&&T.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(f.className||""),V&&(n.style.marginLeft=-V.x+"px",n.style.marginTop=-V.y+"px"),T&&(n.style.width=T.x+"px",n.style.height=T.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return je.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function sr(n){return new ia(n)}var Is=ia.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Is.imagePath!="string"&&(Is.imagePath=this._detectIconPath()),(this.options.imagePath||Is.imagePath)+ia.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(f,k,T){var V=k.exec(f);return V&&V[T]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=kt("div","leaflet-default-icon-path",document.body),c=no(n,"background-image")||no(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),wi=$e.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new vt(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&zt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,f=c._map,k=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,V=zo(c._icon),ne=f.getPixelBounds(),Ce=f.getPixelOrigin(),Ae=Re(ne.min._subtract(Ce).add(T),ne.max._subtract(Ce).subtract(T));if(!Ae.contains(V)){var Ve=ue((Math.max(Ae.max.x,V.x)-Ae.max.x)/(ne.max.x-Ae.max.x)-(Math.min(Ae.min.x,V.x)-Ae.min.x)/(ne.min.x-Ae.min.x),(Math.max(Ae.max.y,V.y)-Ae.max.y)/(ne.max.y-Ae.max.y)-(Math.min(Ae.min.y,V.y)-Ae.min.y)/(ne.min.y-Ae.min.y)).multiplyBy(k);f.panBy(Ve,{animate:!1}),this._draggable._newPos._add(Ve),this._draggable._startPos._add(Ve),qt(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=O(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,f=c._shadow,k=zo(c._icon),T=c._map.layerPointToLatLng(k);f&&qt(f,k),c._latlng=T,n.latlng=T,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Ci=bo.extend({options:{icon:new Is,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){C(this,c),this._latlng=We(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=We(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=n.icon.createIcon(this._icon),k=!1;f!==this._icon&&(this._icon&&this._removeIcon(),k=!0,n.title&&(f.title=n.title),f.tagName==="IMG"&&(f.alt=n.alt||"")),ht(f,c),n.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(f,"focus",this._panOnFocus,this);var T=n.icon.createShadow(this._shadow),V=!1;T!==this._shadow&&(this._removeShadow(),V=!0),T&&(ht(T,c),T.alt=""),this._shadow=T,n.opacity<1&&this._updateOpacity(),k&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&V&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$t(this._icon,"focus",this._panOnFocus,this),Et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Et(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&qt(this._icon,n),this._shadow&&qt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),wi)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new wi(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&$n(this._icon,n),this._shadow&&$n(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,f=c.iconSize?ue(c.iconSize):ue(0,0),k=c.iconAnchor?ue(c.iconAnchor):ue(0,0);n.panInside(this._latlng,{paddingTopLeft:k,paddingBottomRight:f.subtract(k)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Mc(n,c){return new Ci(n,c)}var cs=bo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return C(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Li=cs.extend({options:{fill:!0,radius:10},initialize:function(n,c){C(this,c),this._latlng=We(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=We(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return cs.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,f=this._clickTolerance(),k=[n+f,c+f];this._pxBounds=new ke(this._point.subtract(k),this._point.add(k))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ac(n,c){return new Li(n,c)}var il=Li.extend({initialize:function(n,c,f){if(typeof c=="number"&&(c=s({},f,{radius:c})),C(this,c),this._latlng=We(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Ye(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:cs.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,f=this._map,k=f.options.crs;if(k.distance===_e.distance){var T=Math.PI/180,V=this._mRadius/_e.R/T,ne=f.project([c+V,n]),Ce=f.project([c-V,n]),Ae=ne.add(Ce).divideBy(2),Ve=f.unproject(Ae).lat,st=Math.acos((Math.cos(V*T)-Math.sin(c*T)*Math.sin(Ve*T))/(Math.cos(c*T)*Math.cos(Ve*T)))/T;(isNaN(st)||st===0)&&(st=V/Math.cos(Math.PI/180*c)),this._point=Ae.subtract(f.getPixelOrigin()),this._radius=isNaN(st)?0:Ae.x-f.project([Ve,n-st]).x,this._radiusY=Ae.y-ne.y}else{var dt=k.unproject(k.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(dt).x}this._updateBounds()}});function Ec(n,c,f){return new il(n,c,f)}var jo=cs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){C(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,f=null,k=sa,T,V,ne=0,Ce=this._parts.length;ne<Ce;ne++)for(var Ae=this._parts[ne],Ve=1,st=Ae.length;Ve<st;Ve++){T=Ae[Ve-1],V=Ae[Ve];var dt=k(n,T,V,!0);dt<c&&(c=dt,f=k(n,T,V))}return f&&(f.distance=Math.sqrt(c)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return nr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=We(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Ye,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return lo(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],f=lo(n),k=0,T=n.length;k<T;k++)f?(c[k]=We(n[k]),this._bounds.extend(c[k])):c[k]=this._convertLatLngs(n[k]);return c},_project:function(){var n=new ke;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new z(n,n);this._rawPxBounds&&(this._pxBounds=new ke([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,f){var k=n[0]instanceof Ke,T=n.length,V,ne;if(k){for(ne=[],V=0;V<T;V++)ne[V]=this._map.latLngToLayerPoint(n[V]),f.extend(ne[V]);c.push(ne)}else for(V=0;V<T;V++)this._projectLatlngs(n[V],c,f)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,f,k,T,V,ne,Ce,Ae;for(f=0,T=0,V=this._rings.length;f<V;f++)for(Ae=this._rings[f],k=0,ne=Ae.length;k<ne-1;k++)Ce=za(Ae[k],Ae[k+1],n,k,!0),Ce&&(c[T]=c[T]||[],c[T].push(Ce[0]),(Ce[1]!==Ae[k+1]||k===ne-2)&&(c[T].push(Ce[1]),T++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,f=0,k=n.length;f<k;f++)n[f]=En(n[f],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var f,k,T,V,ne,Ce,Ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(f=0,V=this._parts.length;f<V;f++)for(Ce=this._parts[f],k=0,ne=Ce.length,T=ne-1;k<ne;T=k++)if(!(!c&&k===0)&&Tt(n,Ce[T],Ce[k])<=Ae)return!0;return!1}});function Pc(n,c){return new jo(n,c)}jo._flat=tr;var la=jo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Cn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=jo.prototype._convertLatLngs.call(this,n),f=c.length;return f>=2&&c[0]instanceof Ke&&c[0].equals(c[f-1])&&c.pop(),c},_setLatLngs:function(n){jo.prototype._setLatLngs.call(this,n),lo(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return lo(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,f=new z(c,c);if(n=new ke(n.min.subtract(f),n.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var k=0,T=this._rings.length,V;k<T;k++)V=nn(this._rings[k],n,!0),V.length&&this._parts.push(V)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,f,k,T,V,ne,Ce,Ae,Ve;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(V=0,Ae=this._parts.length;V<Ae;V++)for(f=this._parts[V],ne=0,Ve=f.length,Ce=Ve-1;ne<Ve;Ce=ne++)k=f[ne],T=f[Ce],k.y>n.y!=T.y>n.y&&n.x<(T.x-k.x)*(n.y-k.y)/(T.y-k.y)+k.x&&(c=!c);return c||jo.prototype._containsPoint.call(this,n,!0)}});function ar(n,c){return new la(n,c)}var Zo=Go.extend({initialize:function(n,c){C(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=S(n)?n:n.features,f,k,T;if(c){for(f=0,k=c.length;f<k;f++)T=c[f],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var V=this.options;if(V.filter&&!V.filter(n))return this;var ne=Ha(n,V);return ne?(ne.feature=xi(n),ne.defaultOptions=ne.options,this.resetStyle(ne),V.onEachFeature&&V.onEachFeature(n,ne),this.addLayer(ne)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function Ha(n,c){var f=n.type==="Feature"?n.geometry:n,k=f?f.coordinates:null,T=[],V=c&&c.pointToLayer,ne=c&&c.coordsToLatLng||ll,Ce,Ae,Ve,st;if(!k&&!f)return null;switch(f.type){case"Point":return Ce=ne(k),ir(V,n,Ce,c);case"MultiPoint":for(Ve=0,st=k.length;Ve<st;Ve++)Ce=ne(k[Ve]),T.push(ir(V,n,Ce,c));return new Go(T);case"LineString":case"MultiLineString":return Ae=Si(k,f.type==="LineString"?0:1,ne),new jo(Ae,c);case"Polygon":case"MultiPolygon":return Ae=Si(k,f.type==="Polygon"?1:2,ne),new la(Ae,c);case"GeometryCollection":for(Ve=0,st=f.geometries.length;Ve<st;Ve++){var dt=Ha({geometry:f.geometries[Ve],type:"Feature",properties:n.properties},c);dt&&T.push(dt)}return new Go(T);case"FeatureCollection":for(Ve=0,st=f.features.length;Ve<st;Ve++){var Lt=Ha(f.features[Ve],c);Lt&&T.push(Lt)}return new Go(T);default:throw new Error("Invalid GeoJSON object.")}}function ir(n,c,f,k){return n?n(c,f):new Ci(f,k&&k.markersInheritOptions&&k)}function ll(n){return new Ke(n[1],n[0],n[2])}function Si(n,c,f){for(var k=[],T=0,V=n.length,ne;T<V;T++)ne=c?Si(n[T],c-1,f):(f||ll)(n[T]),k.push(ne);return k}function Va(n,c){return n=We(n),n.alt!==void 0?[y(n.lng,c),y(n.lat,c),y(n.alt,c)]:[y(n.lng,c),y(n.lat,c)]}function Ii(n,c,f,k){for(var T=[],V=0,ne=n.length;V<ne;V++)T.push(c?Ii(n[V],lo(n[V])?0:c-1,f,k):Va(n[V],k));return!c&&f&&T.length>0&&T.push(T[0].slice()),T}function ra(n,c){return n.feature?s({},n.feature,{geometry:c}):xi(c)}function xi(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var $i={toGeoJSON:function(n){return ra(this,{type:"Point",coordinates:Va(this.getLatLng(),n)})}};Ci.include($i),il.include($i),Li.include($i),jo.include({toGeoJSON:function(n){var c=!lo(this._latlngs),f=Ii(this._latlngs,c?1:0,!1,n);return ra(this,{type:(c?"Multi":"")+"LineString",coordinates:f})}}),la.include({toGeoJSON:function(n){var c=!lo(this._latlngs),f=c&&!lo(this._latlngs[0]),k=Ii(this._latlngs,f?2:c?1:0,!0,n);return c||(k=[k]),ra(this,{type:(f?"Multi":"")+"Polygon",coordinates:k})}}),aa.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(f){c.push(f.toGeoJSON(n).geometry.coordinates)}),ra(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var f=c==="GeometryCollection",k=[];return this.eachLayer(function(T){if(T.toGeoJSON){var V=T.toGeoJSON(n);if(f)k.push(V.geometry);else{var ne=xi(V);ne.type==="FeatureCollection"?k.push.apply(k,ne.features):k.push(ne)}}}),f?ra(this,{geometries:k,type:"GeometryCollection"}):{type:"FeatureCollection",features:k}}});function lr(n,c){return new Zo(n,c)}var Ga=lr,ja=bo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,f){this._url=n,this._bounds=Ne(c),C(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Uo(this._image),this},bringToBack:function(){return this._map&&yo(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Ne(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:kt("img");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=r(this.fire,this,"load"),c.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Ao(this._image,f,c)},_reset:function(){var n=this._image,c=new ke(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=c.getSize();qt(n,c.min),n.style.width=f.x+"px",n.style.height=f.y+"px"},_updateOpacity:function(){$n(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),rr=function(n,c,f){return new ja(n,c,f)},rl=ja.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:kt("video");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=r(this.fire,this,"load"),n){for(var f=c.getElementsByTagName("source"),k=[],T=0;T<f.length;T++)k.push(f[T].src);this._url=f.length>0?k:[c.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var V=0;V<this._url.length;V++){var ne=kt("source");ne.src=this._url[V],c.appendChild(ne)}}});function H(n,c,f){return new rl(n,c,f)}var oe=ja.extend({_initImage:function(){var n=this._image=this._url;ht(n,"leaflet-image-layer"),this._zoomAnimated&&ht(n,"leaflet-zoom-animated"),this.options.className&&ht(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function ge(n,c,f){return new oe(n,c,f)}var we=bo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof Ke||S(n))?(this._latlng=We(n),C(this,c)):(C(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&$n(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&$n(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?($n(this._container,0),this._removeTimeout=setTimeout(r(Et,void 0,this._container),200)):Et(this._container),this.options.interactive&&(zt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=We(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Uo(this._container),this},bringToBack:function(){return this._map&&yo(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof Go){c=null;var f=this._source._layers;for(var k in f)if(f[k]._map){c=f[k];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=ue(this.options.offset),f=this._getAnchor();this._zoomAnimated?qt(this._container,n.add(f)):c=c.add(n).add(f);var k=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=k+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(n,c,f,k){var T=c;return T instanceof n||(T=new n(k).setContent(c)),f&&T.setLatLng(f),T}}),bo.include({_initOverlay:function(n,c,f,k){var T=f;return T instanceof n?(C(T,k),T._source=this):(T=c&&!k?c:new n(k,this),T.setContent(f)),T}});var ot=we.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,we.prototype.openOn.call(this,n)},onAdd:function(n){we.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof cs||this._source.on("preclick",Mn))},onRemove:function(n){we.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof cs||this._source.off("preclick",Mn))},getEvents:function(){var n=we.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=kt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=kt("div",n+"-content-wrapper",c);if(this._contentNode=kt("div",n+"-content",f),Gn(c),Ls(this._contentNode),rt(c,"contextmenu",Mn),this._tipContainer=kt("div",n+"-tip-container",c),this._tip=kt("div",n+"-tip",this._tipContainer),this.options.closeButton){var k=this._closeButton=kt("a",n+"-close-button",c);k.setAttribute("role","button"),k.setAttribute("aria-label","Close popup"),k.href="#close",k.innerHTML='<span aria-hidden="true">&#215;</span>',rt(k,"click",function(T){Wt(T),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var f=n.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),c.width=f+1+"px",c.whiteSpace="",c.height="";var k=n.offsetHeight,T=this.options.maxHeight,V="leaflet-popup-scrolled";T&&k>T?(c.height=T+"px",ht(n,V)):zt(n,V),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),f=this._getAnchor();qt(this._container,c.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(no(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+c,k=this._containerWidth,T=new z(this._containerLeft,-f-this._containerBottom);T._add(zo(this._container));var V=n.layerPointToContainerPoint(T),ne=ue(this.options.autoPanPadding),Ce=ue(this.options.autoPanPaddingTopLeft||ne),Ae=ue(this.options.autoPanPaddingBottomRight||ne),Ve=n.getSize(),st=0,dt=0;V.x+k+Ae.x>Ve.x&&(st=V.x+k-Ve.x+Ae.x),V.x-st-Ce.x<0&&(st=V.x-Ce.x),V.y+f+Ae.y>Ve.y&&(dt=V.y+f-Ve.y+Ae.y),V.y-dt-Ce.y<0&&(dt=V.y-Ce.y),(st||dt)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([st,dt]))}},_getAnchor:function(){return ue(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),It=function(n,c){return new ot(n,c)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(n,c,f){return this._initOverlay(ot,n,c,f).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),bo.include({bindPopup:function(n,c){return this._popup=this._initOverlay(ot,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Go||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Eo(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof cs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var At=we.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){we.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){we.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=we.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=kt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,f,k=this._map,T=this._container,V=k.latLngToContainerPoint(k.getCenter()),ne=k.layerPointToContainerPoint(n),Ce=this.options.direction,Ae=T.offsetWidth,Ve=T.offsetHeight,st=ue(this.options.offset),dt=this._getAnchor();Ce==="top"?(c=Ae/2,f=Ve):Ce==="bottom"?(c=Ae/2,f=0):Ce==="center"?(c=Ae/2,f=Ve/2):Ce==="right"?(c=0,f=Ve/2):Ce==="left"?(c=Ae,f=Ve/2):ne.x<V.x?(Ce="right",c=0,f=Ve/2):(Ce="left",c=Ae+(st.x+dt.x)*2,f=Ve/2),n=n.subtract(ue(c,f,!0)).add(st).add(dt),zt(T,"leaflet-tooltip-right"),zt(T,"leaflet-tooltip-left"),zt(T,"leaflet-tooltip-top"),zt(T,"leaflet-tooltip-bottom"),ht(T,"leaflet-tooltip-"+Ce),qt(T,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&$n(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return ue(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),mn=function(n,c){return new At(n,c)};Ct.include({openTooltip:function(n,c,f){return this._initOverlay(At,n,c,f).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),bo.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(At,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[c](f),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Go||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(rt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),rt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,f,k;this._tooltip.options.sticky&&n.originalEvent&&(f=this._map.mouseEventToContainerPoint(n.originalEvent),k=this._map.containerPointToLayerPoint(f),c=this._map.layerPointToLatLng(k)),this._tooltip.setLatLng(c)}});var ca=ia.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),f=this.options;if(f.html instanceof Element?(Mo(c),c.appendChild(f.html)):c.innerHTML=f.html!==!1?f.html:"",f.bgPos){var k=ue(f.bgPos);c.style.backgroundPosition=-k.x+"px "+-k.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Ti(n){return new ca(n)}ia.Default=Is;var xs=bo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){C(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Et(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Uo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(yo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof z?n:new z(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,f=-n(-1/0,1/0),k=0,T=c.length,V;k<T;k++)V=c[k].style.zIndex,c[k]!==this._container&&V&&(f=n(f,+V));isFinite(f)&&(this.options.zIndex=f+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!je.ielt9){$n(this._container,this.options.opacity);var n=+new Date,c=!1,f=!1;for(var k in this._tiles){var T=this._tiles[k];if(!(!T.current||!T.loaded)){var V=Math.min(1,(n-T.loaded)/200);$n(T.el,V),V<1?c=!0:(T.active?f=!0:this._onOpaqueTile(T),T.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=kt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===n?(this._levels[f].el.style.zIndex=c-Math.abs(n-f),this._onUpdateLevel(f)):(Et(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var k=this._levels[n],T=this._map;return k||(k=this._levels[n]={},k.el=kt("div","leaflet-tile-container leaflet-zoom-animated",this._container),k.el.style.zIndex=c,k.origin=T.project(T.unproject(T.getPixelOrigin()),n).round(),k.zoom=n,this._setZoomTransform(k,T.getCenter(),T.getZoom()),g(k.el.offsetWidth),this._onCreateLevel(k)),this._level=k,k}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,c,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var k=c.coords;this._retainParent(k.x,k.y,k.z,k.z-5)||this._retainChildren(k.x,k.y,k.z,k.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Et(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,f,k){var T=Math.floor(n/2),V=Math.floor(c/2),ne=f-1,Ce=new z(+T,+V);Ce.z=+ne;var Ae=this._tileCoordsToKey(Ce),Ve=this._tiles[Ae];return Ve&&Ve.active?(Ve.retain=!0,!0):(Ve&&Ve.loaded&&(Ve.retain=!0),ne>k?this._retainParent(T,V,ne,k):!1)},_retainChildren:function(n,c,f,k){for(var T=2*n;T<2*n+2;T++)for(var V=2*c;V<2*c+2;V++){var ne=new z(T,V);ne.z=f+1;var Ce=this._tileCoordsToKey(ne),Ae=this._tiles[Ce];if(Ae&&Ae.active){Ae.retain=!0;continue}else Ae&&Ae.loaded&&(Ae.retain=!0);f+1<k&&this._retainChildren(T,V,f+1,k)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,f,k){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var V=this.options.updateWhenZooming&&T!==this._tileZoom;(!k||V)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(n),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var f in this._levels)this._setZoomTransform(this._levels[f],n,c)},_setZoomTransform:function(n,c,f){var k=this._map.getZoomScale(f,n.zoom),T=n.origin.multiplyBy(k).subtract(this._map._getNewPixelOrigin(c,f)).round();je.any3d?Ao(n.el,T,k):qt(n.el,T)},_resetGrid:function(){var n=this._map,c=n.options.crs,f=this._tileSize=this.getTileSize(),k=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],k).x/f.x),Math.ceil(n.project([0,c.wrapLng[1]],k).x/f.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],k).y/f.x),Math.ceil(n.project([c.wrapLat[1],0],k).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,f=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),k=c.getZoomScale(f,this._tileZoom),T=c.project(n,this._tileZoom).floor(),V=c.getSize().divideBy(k*2);return new ke(T.subtract(V),T.add(V))},_update:function(n){var c=this._map;if(c){var f=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var k=this._getTiledPixelBounds(n),T=this._pxBoundsToTileRange(k),V=T.getCenter(),ne=[],Ce=this.options.keepBuffer,Ae=new ke(T.getBottomLeft().subtract([Ce,-Ce]),T.getTopRight().add([Ce,-Ce]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ve in this._tiles){var st=this._tiles[Ve].coords;(st.z!==this._tileZoom||!Ae.contains(new z(st.x,st.y)))&&(this._tiles[Ve].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(n,f);return}for(var dt=T.min.y;dt<=T.max.y;dt++)for(var Lt=T.min.x;Lt<=T.max.x;Lt++){var jn=new z(Lt,dt);if(jn.z=this._tileZoom,!!this._isValidTile(jn)){var gn=this._tiles[this._tileCoordsToKey(jn)];gn?gn.current=!0:ne.push(jn)}}if(ne.sort(function(ro,Mi){return ro.distanceTo(V)-Mi.distanceTo(V)}),ne.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Po=document.createDocumentFragment();for(Lt=0;Lt<ne.length;Lt++)this._addTile(ne[Lt],Po);this._level.el.appendChild(Po)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var f=this._globalTileRange;if(!c.wrapLng&&(n.x<f.min.x||n.x>f.max.x)||!c.wrapLat&&(n.y<f.min.y||n.y>f.max.y))return!1}if(!this.options.bounds)return!0;var k=this._tileCoordsToBounds(n);return Ne(this.options.bounds).overlaps(k)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,f=this.getTileSize(),k=n.scaleBy(f),T=k.add(f),V=c.unproject(k,n.z),ne=c.unproject(T,n.z);return[V,ne]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),f=new Ye(c[0],c[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),f=new z(+c[0],+c[1]);return f.z=+c[2],f},_removeTile:function(n){var c=this._tiles[n];c&&(Et(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ht(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=g,n.onmousemove=g,je.ielt9&&this.options.opacity<1&&$n(n,this.options.opacity)},_addTile:function(n,c){var f=this._getTilePos(n),k=this._tileCoordsToKey(n),T=this.createTile(this._wrapCoords(n),r(this._tileReady,this,n));this._initTile(T),this.createTile.length<2&&O(r(this._tileReady,this,n,null,T)),qt(T,f),this._tiles[k]={el:T,coords:n,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:n})},_tileReady:function(n,c,f){c&&this.fire("tileerror",{error:c,tile:f,coords:n});var k=this._tileCoordsToKey(n);f=this._tiles[k],f&&(f.loaded=+new Date,this._map._fadeAnimated?($n(f.el,0),G(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),c||(ht(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),je.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new z(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new ke(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function ua(n){return new xs(n)}var Ln=xs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=C(this,c),c.detectRetina&&je.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var f=document.createElement("img");return rt(f,"load",r(this._tileOnLoad,this,c,f)),rt(f,"error",r(this._tileOnError,this,c,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(n),f},getTileUrl:function(n){var c={r:je.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=f),c["-y"]=f}return x(this._url,s(c,this.options))},_tileOnLoad:function(n,c){je.ielt9?setTimeout(r(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,f){var k=this.options.errorTileUrl;k&&c.getAttribute("src")!==k&&(c.src=k),n(f,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,f=this.options.zoomReverse,k=this.options.zoomOffset;return f&&(n=c-n),n+k},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=g,c.onerror=g,!c.complete)){c.src=E;var f=this._tiles[n].coords;Et(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:f})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",E),xs.prototype._removeTile.call(this,n)},_tileReady:function(n,c,f){if(!(!this._map||f&&f.getAttribute("src")===E))return xs.prototype._tileReady.call(this,n,c,f)}});function gd(n,c){return new Ln(n,c)}var yd=Ln.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var f=s({},this.defaultWmsParams);for(var k in c)k in this.options||(f[k]=c[k]);c=C(this,c);var T=c.detectRetina&&je.retina?2:1,V=this.getTileSize();f.width=V.x*T,f.height=V.y*T,this.wmsParams=f},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Ln.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),f=this._crs,k=Re(f.project(c[0]),f.project(c[1])),T=k.min,V=k.max,ne=(this._wmsVersion>=1.3&&this._crs===or?[T.y,T.x,V.y,V.x]:[T.x,T.y,V.x,V.y]).join(","),Ce=Ln.prototype.getTileUrl.call(this,n);return Ce+I(this.wmsParams,Ce,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ne},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function pm(n,c){return new yd(n,c)}Ln.WMS=yd,gd.wms=pm;var $s=bo.extend({options:{padding:.1},initialize:function(n){C(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var f=this._map.getZoomScale(c,this._zoom),k=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),V=k.multiplyBy(-f).add(T).subtract(this._map._getNewPixelOrigin(n,c));je.any3d?Ao(this._container,V,f):qt(this._container,V)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),f=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new ke(f,f.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),kd=$s.extend({options:{tolerance:0},getEvents:function(){var n=$s.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){$s.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");rt(n,"mousemove",this._onMouseMove,this),rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,Et(this._container),$t(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$s.prototype._update.call(this);var n=this._bounds,c=this._container,f=n.getSize(),k=je.retina?2:1;qt(c,n.min),c.width=k*f.x,c.height=k*f.y,c.style.width=f.x+"px",c.style.height=f.y+"px",je.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){$s.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,f=c.next,k=c.prev;f?f.prev=k:this._drawLast=k,k?k.next=f:this._drawFirst=f,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),f=[],k,T;for(T=0;T<c.length;T++){if(k=Number(c[T]),isNaN(k))return;f.push(k)}n.options._dashArray=f}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ke,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var f=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var k=this._drawFirst;k;k=k.next)n=k.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var f,k,T,V,ne=n._parts,Ce=ne.length,Ae=this._ctx;if(Ce){for(Ae.beginPath(),f=0;f<Ce;f++){for(k=0,T=ne[f].length;k<T;k++)V=ne[f][k],Ae[k?"lineTo":"moveTo"](V.x,V.y);c&&Ae.closePath()}this._fillStroke(Ae,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,f=this._ctx,k=Math.max(Math.round(n._radius),1),T=(Math.max(Math.round(n._radiusY),1)||k)/k;T!==1&&(f.save(),f.scale(1,T)),f.beginPath(),f.arc(c.x,c.y/T,k,0,Math.PI*2,!1),T!==1&&f.restore(),this._fillStroke(f,n)}},_fillStroke:function(n,c){var f=c.options;f.fill&&(n.globalAlpha=f.fillOpacity,n.fillStyle=f.fillColor||f.color,n.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=f.opacity,n.lineWidth=f.weight,n.strokeStyle=f.color,n.lineCap=f.lineCap,n.lineJoin=f.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),f,k,T=this._drawFirst;T;T=T.next)f=T.layer,f.options.interactive&&f._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(f))&&(k=f);this._fireEvent(k?[k]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(zt(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var f,k,T=this._drawFirst;T;T=T.next)f=T.layer,f.options.interactive&&f._containsPoint(c)&&(k=f);k!==this._hoveredLayer&&(this._handleMouseOut(n),k&&(ht(this._container,"leaflet-interactive"),this._fireEvent([k],n,"mouseover"),this._hoveredLayer=k)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,f){this._map._fireDOMEvent(c,f||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var f=c.next,k=c.prev;if(f)f.prev=k;else return;k?k.next=f:f&&(this._drawFirst=f),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var f=c.next,k=c.prev;if(k)k.next=f;else return;f?f.prev=k:k&&(this._drawLast=k),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function _d(n){return je.canvas?new kd(n):null}var cl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),vm={_initContainer:function(){this._container=kt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||($s.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=cl("shape");ht(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=cl("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;Et(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,f=n._fill,k=n.options,T=n._container;T.stroked=!!k.stroke,T.filled=!!k.fill,k.stroke?(c||(c=n._stroke=cl("stroke")),T.appendChild(c),c.weight=k.weight+"px",c.color=k.color,c.opacity=k.opacity,k.dashArray?c.dashStyle=S(k.dashArray)?k.dashArray.join(" "):k.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=k.lineCap.replace("butt","flat"),c.joinstyle=k.lineJoin):c&&(T.removeChild(c),n._stroke=null),k.fill?(f||(f=n._fill=cl("fill")),T.appendChild(f),f.color=k.fillColor||k.color,f.opacity=k.fillOpacity):f&&(T.removeChild(f),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),f=Math.round(n._radius),k=Math.round(n._radiusY||f);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+f+","+k+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){Uo(n._container)},_bringToBack:function(n){yo(n._container)}},cr=je.vml?cl:Te,ul=$s.extend({_initContainer:function(){this._container=cr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=cr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Et(this._container),$t(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$s.prototype._update.call(this);var n=this._bounds,c=n.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,f.setAttribute("width",c.x),f.setAttribute("height",c.y)),qt(f,n.min),f.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=cr("path");n.options.className&&ht(c,n.options.className),n.options.interactive&&ht(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Et(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,f=n.options;c&&(f.stroke?(c.setAttribute("stroke",f.color),c.setAttribute("stroke-opacity",f.opacity),c.setAttribute("stroke-width",f.weight),c.setAttribute("stroke-linecap",f.lineCap),c.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?c.setAttribute("stroke-dasharray",f.dashArray):c.removeAttribute("stroke-dasharray"),f.dashOffset?c.setAttribute("stroke-dashoffset",f.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),f.fill?(c.setAttribute("fill",f.fillColor||f.color),c.setAttribute("fill-opacity",f.fillOpacity),c.setAttribute("fill-rule",f.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,Be(n._parts,c))},_updateCircle:function(n){var c=n._point,f=Math.max(Math.round(n._radius),1),k=Math.max(Math.round(n._radiusY),1)||f,T="a"+f+","+k+" 0 1,0 ",V=n._empty()?"M0 0":"M"+(c.x-f)+","+c.y+T+f*2+",0 "+T+-f*2+",0 ";this._setPath(n,V)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){Uo(n._path)},_bringToBack:function(n){yo(n._path)}});je.vml&&ul.include(vm);function bd(n){return je.svg||je.vml?new ul(n):null}Ct.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&_d(n)||bd(n)}});var wd=la.extend({initialize:function(n,c){la.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Ne(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function mm(n,c){return new wd(n,c)}ul.create=cr,ul.pointsToPath=Be,Zo.geometryToLayer=Ha,Zo.coordsToLatLng=ll,Zo.coordsToLatLngs=Si,Zo.latLngToCoords=Va,Zo.latLngsToCoords=Ii,Zo.getFeature=ra,Zo.asFeature=xi,Ct.mergeOptions({boxZoom:!0});var Cd=$e.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){$t(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ho(),oo(),this._startPoint=this._map.mouseEventToContainerPoint(n),rt(document,{contextmenu:Eo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=kt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new ke(this._point,this._startPoint),f=c.getSize();qt(this._box,c.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(Et(this._box),zt(this._container,"leaflet-crosshair")),Cs(),jt(),$t(document,{contextmenu:Eo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var c=new Ye(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",Cd),Ct.mergeOptions({doubleClickZoom:!0});var Ld=$e.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,f=c.getZoom(),k=c.options.zoomDelta,T=n.originalEvent.shiftKey?f-k:f+k;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(n.containerPoint,T)}});Ct.addInitHook("addHandler","doubleClickZoom",Ld),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Sd=$e.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new vt(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){zt(this._map._container,"leaflet-grab"),zt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Ne(this._map.options.maxBounds);this._offsetLimit=Re(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),f=this._initialWorldOffset,k=this._draggable._newPos.x,T=(k-c+f)%n+c-f,V=(k+c+f)%n-c-f,ne=Math.abs(T+f)<Math.abs(V+f)?T:V;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ne},_onDragEnd:function(n){var c=this._map,f=c.options,k=!f.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),k)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),V=(this._lastTime-this._times[0])/1e3,ne=f.easeLinearity,Ce=T.multiplyBy(ne/V),Ae=Ce.distanceTo([0,0]),Ve=Math.min(f.inertiaMaxSpeed,Ae),st=Ce.multiplyBy(Ve/Ae),dt=Ve/(f.inertiaDeceleration*ne),Lt=st.multiplyBy(-dt/2).round();!Lt.x&&!Lt.y?c.fire("moveend"):(Lt=c._limitOffset(Lt,c.options.maxBounds),O(function(){c.panBy(Lt,{duration:dt,easeLinearity:ne,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",Sd),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Id=$e.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),$t(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,f=n.scrollTop||c.scrollTop,k=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(k,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},f=this.keyCodes,k,T;for(k=0,T=f.left.length;k<T;k++)c[f.left[k]]=[-1*n,0];for(k=0,T=f.right.length;k<T;k++)c[f.right[k]]=[n,0];for(k=0,T=f.down.length;k<T;k++)c[f.down[k]]=[0,n];for(k=0,T=f.up.length;k<T;k++)c[f.up[k]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},f=this.keyCodes,k,T;for(k=0,T=f.zoomIn.length;k<T;k++)c[f.zoomIn[k]]=n;for(k=0,T=f.zoomOut.length;k<T;k++)c[f.zoomOut[k]]=-n},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){$t(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,f=this._map,k;if(c in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(k=this._panKeys[c],n.shiftKey&&(k=ue(k).multiplyBy(3)),f.options.maxBounds&&(k=f._limitOffset(ue(k),f.options.maxBounds)),f.options.worldCopyJump){var T=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(k)));f.panTo(T)}else f.panBy(k)}else if(c in this._zoomKeys)f.setZoom(f.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;Eo(n)}}});Ct.addInitHook("addHandler","keyboard",Id),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var xd=$e.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){$t(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=pi(n),f=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var k=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),k),Eo(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),f=this._map.options.zoomSnap||0;n._stop();var k=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(k))))/Math.LN2,V=f?Math.ceil(T/f)*f:T,ne=n._limitZoom(c+(this._delta>0?V:-V))-c;this._delta=0,this._startTime=null,ne&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+ne):n.setZoomAround(this._lastMousePos,c+ne))}});Ct.addInitHook("addHandler","scrollWheelZoom",xd);var gm=600;Ct.mergeOptions({tapHold:je.touchNative&&je.safari&&je.mobile,tapTolerance:15});var $d=$e.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){$t(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new z(c.clientX,c.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Wt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),gm),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){$t(document,"touchend",Wt),$t(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),$t(document,"touchend touchcancel contextmenu",this._cancel,this),$t(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new z(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var f=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});f._simulated=!0,c.target.dispatchEvent(f)}});Ct.addInitHook("addHandler","tapHold",$d),Ct.mergeOptions({touchZoom:je.touch,bounceAtZoomLimits:!0});var Td=$e.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){zt(this._map._container,"leaflet-touch-zoom"),$t(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var f=c.mouseEventToContainerPoint(n.touches[0]),k=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(f.add(k)._divideBy(2))),this._startDist=f.distanceTo(k),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Wt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,f=c.mouseEventToContainerPoint(n.touches[0]),k=c.mouseEventToContainerPoint(n.touches[1]),T=f.distanceTo(k)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var V=f._add(k)._divideBy(2)._subtract(this._centerPoint);if(T===1&&V.x===0&&V.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(V),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var ne=r(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(ne,this,!0),Wt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),$t(document,"touchmove",this._onTouchMove,this),$t(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",Td),Ct.BoxZoom=Cd,Ct.DoubleClickZoom=Ld,Ct.Drag=Sd,Ct.Keyboard=Id,Ct.ScrollWheelZoom=xd,Ct.TapHold=$d,Ct.TouchZoom=Td,o.Bounds=ke,o.Browser=je,o.CRS=X,o.Canvas=kd,o.Circle=il,o.CircleMarker=Li,o.Class=se,o.Control=vn,o.DivIcon=ca,o.DivOverlay=we,o.DomEvent=nl,o.DomUtil=ea,o.Draggable=vt,o.Evented=te,o.FeatureGroup=Go,o.GeoJSON=Zo,o.GridLayer=xs,o.Handler=$e,o.Icon=ia,o.ImageOverlay=ja,o.LatLng=Ke,o.LatLngBounds=Ye,o.Layer=bo,o.LayerGroup=aa,o.LineUtil=Ic,o.Map=Ct,o.Marker=Ci,o.Mixin=nt,o.Path=cs,o.Point=z,o.PolyUtil=Ht,o.Polygon=la,o.Polyline=jo,o.Popup=ot,o.PosAnimation=vi,o.Projection=xc,o.Rectangle=wd,o.Renderer=$s,o.SVG=ul,o.SVGOverlay=oe,o.TileLayer=Ln,o.Tooltip=At,o.Transformation=ce,o.Util=Q,o.VideoOverlay=rl,o.bind=r,o.bounds=Re,o.canvas=_d,o.circle=Ec,o.circleMarker=Ac,o.control=Vo,o.divIcon=Ti,o.extend=s,o.featureGroup=bi,o.geoJSON=lr,o.geoJson=Ga,o.gridLayer=ua,o.icon=sr,o.imageOverlay=rr,o.latLng=We,o.latLngBounds=Ne,o.layerGroup=_i,o.map=mi,o.marker=Mc,o.point=ue,o.polygon=ar,o.polyline=Pc,o.popup=It,o.rectangle=mm,o.setOptions=C,o.stamp=d,o.svg=bd,o.svgOverlay=ge,o.tileLayer=gd,o.tooltip=mn,o.transformation=N,o.version=a,o.videoOverlay=H;var ym=window.L;o.noConflict=function(){return window.L=ym,this},window.L=o}))})(yl,yl.exports)),yl.exports}var r0=l0();const Ot=a0(r0);(function(e,t,o){function a(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,r=i.getLatLngs(),u=r.splice(-1,1)[0];this._poly.setLatLngs(r),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),r=this._map.layerPointToLatLng(i);this._currentLatLng=r,this._updateTooltip(r),this._updateGuide(i),this._mouseMarker.setLatLng(r),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,r=i.clientX,u=i.clientY;this._startPoint.call(this,r,u)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,r=i.clientX,u=i.clientY;this._endPoint.call(this,r,u,s),this._clickHandled=null},_endPoint:function(s,i,r){if(this._mouseDownOrigin){var u=L.point(s,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(r.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(r.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(r.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,r,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,r=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,r),this._endPoint.call(this,i,r,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var r;if(this.type===L.Draw.Polyline.TYPE)r=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;r=this._markers[0]}var u=this._map.latLngToContainerPoint(r.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var r,u,d,h=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=h>g?h-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)r=y/h,u={x:Math.floor(s.x*(1-r)+r*i.x),y:Math.floor(s.y*(1-r)+r*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,r=this._guidesContainer.childNodes.length;i<r;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,r=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=r?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var r,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(r=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[r].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[r].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,r=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?r&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(r)*(this.options.factor||1):this._measurementRunningTotal||0:r&&i?this._measurementRunningTotal+this._map.distance(i,r)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var r;!this.options.allowIntersection&&this.options.showArea&&(r=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(r)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,r,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),r=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:r}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,r=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(r),this._isDrawing){this._drawShape(r),i=this._shape.getRadius().toFixed(1);var h="";u&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var r=parseInt(s.style.marginTop,10)-i,u=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=r+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,r){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,r&&r.drawError&&(r.drawError=L.Util.extend({},this.options.drawError,r.drawError)),this._latlngs=i,L.setOptions(this,r)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,r,u,d=this._defaultShape();for(s=0,r=d.length;s<r;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var h,p;for(s=0,i=r-1;s<r;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],p=this._markers[s],this._createMiddleMarker(h,p),this._updatePrevNext(h,p))},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return r._origLatLng=s,r._index=i,r.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(r),r},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,r=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),r.options.poly){var d=r._map._editTooltip;if(!r.options.poly.allowIntersection&&r.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var h=r.options.color;r.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){r.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,r=s.target;this._defaultShape().length<i||(this._removeMarker(r),this._updatePrevNext(r._prev,r._next),r._middleLeft&&this._markerGroup.removeLayer(r._middleLeft),r._middleRight&&this._markerGroup.removeLayer(r._middleRight),r._prev&&r._next?this._createMiddleMarker(r._prev,r._next):r._prev?r._next||(r._prev._middleRight=null):r._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i),u=s.target;L.extend(u._origLatLng,r),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(r){r._index>s&&(r._index+=i)})},_createMiddleMarker:function(s,i){var r,u,d,h=this._getMiddleLatLng(s,i),p=this._createMarker(h);p.setOpacity(.6),s._middleRight=i._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=i._index;p._index=g,p.off("click",r,this).on("click",this._onMarkerClick,this),h.lat=p.getLatLng().lat,h.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,h),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),i._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,i),this._poly.fire("editstart")},d=function(){p.off("dragstart",u,this),p.off("dragend",d,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,i)},r=function(){u.call(this),d.call(this),this._fireEdit()},p.on("click",r,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var r=this._poly._map,u=r.project(s.getLatLng()),d=r.project(i.getLatLng());return r.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(r),this._markerGroup.addLayer(r),r},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,r=i.getLatLng();i===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),r=s.target,u=r._cornerIndex;r.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,r=s.length;i<r;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),r=s.target,u=r._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var i,r,u=s.target;u===this._moveMarker&&(i=this._shape.getBounds(),r=i.getCenter(),u.setLatLng(r)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,r=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),h=[],p=0,g=r.length;p<g;p++)i=[r[p].lat-d.lat,r[p].lng-d.lng],h.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),r=this._map.project(s);return this._map.unproject([r.x+i,r.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var r={};if(s.touches!==void 0){if(!s.touches.length)return;r=s.touches[0]}else if(s.pointerType!=="touch"||(r=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(r),d=this._map.mouseEventToLayerPoint(r),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:u,pageX:r.pageX,pageY:r.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,r=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return r&&r>100&&r<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var r=0;r<i.length;r++)L.DomEvent.on(s,i[r],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],r=0,u=s.length;r<u;r++)Array.isArray(s[r])?i.push(L.LatLngUtil.cloneLatLngs(s[r])):i.push(this.cloneLatLng(s[r]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var r,u,d=i.length,h=0,p=Math.PI/180;if(d>2){for(var g=0;g<d;g++)r=i[g],u=i[(g+1)%d],h+=(u.lng-r.lng)*p*(2+Math.sin(r.lat*p)+Math.sin(u.lat*p));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,r){var u=parseFloat(i).toFixed(r),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,p=h&&h.thousands,g=h&&h.decimal;if(p||g){var y=u.split(".");u=p?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):y[0],g=g||".",y.length>1&&(u=u+g+y[1])}return u},readableArea:function(i,r,p){var d,h,p=L.Util.extend({},s,p);return r?(h=["ha","m"],type=typeof r,type==="string"?h=[r]:type!=="boolean"&&(h=r),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,p.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,p.ha)+" ha":L.GeometryUtil.formattedNumber(i,p.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,p.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(i,p.yd)+" yd"),d},readableDistance:function(i,r,u,d,g){var p,g=L.Util.extend({},s,g);switch(r?typeof r=="string"?r:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":p=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(i,g.m)+" m";break;case"feet":i*=3.28083,p=L.GeometryUtil.formattedNumber(i,g.ft)+" ft";break;case"nauticalMile":i*=.53996,p=L.GeometryUtil.formattedNumber(i/1e3,g.nm)+" nm";break;default:i*=1.09361,p=i>1760?L.GeometryUtil.formattedNumber(i/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(i,g.yd)+" yd"}return p},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,r,u){return this._checkCounterclockwise(s,r,u)!==this._checkCounterclockwise(i,r,u)&&this._checkCounterclockwise(s,i,r)!==this._checkCounterclockwise(s,i,u)},_checkCounterclockwise:function(s,i,r){return(r.y-s.y)*(i.x-s.x)>(i.y-s.y)*(r.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,r,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(i=u[s-1],r=u[s],this._lineSegmentsIntersectsRange(i,r,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var r=this._getProjectedPoints(),u=r?r.length:0,d=r?r[u-1]:null,h=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,h,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),r=i?i.length:0;return r+=s||0,!i||r<=3},_lineSegmentsIntersectsRange:function(s,i,r,u){var d,h,p=this._getProjectedPoints();u=u||0;for(var g=r;g>u;g--)if(d=p[g-1],h=p[g],L.LineUtil.segmentsIntersect(s,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),r=0;r<i.length;r++)s.push(this._map.latLngToLayerPoint(i[r]));return s}}),L.Polygon.include({intersects:function(){var s,i,r,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,i=d[0],r=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(r,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,r=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),r.appendChild(i));return r},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var r in this._toolbars)this._toolbars[r]!==i&&this._toolbars[r].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,r=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",h=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,u++,d,h[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),r.appendChild(this._toolbarContainer),r.appendChild(this._actionsContainer),r},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,r=this._actionButtons.length;i<r;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,r,u,d){var h=s.type;this._modes[h]={},this._modes[h].handler=s,this._modes[h].button=this._createButton({type:h,title:d,className:u+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=r,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),r=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(r),s.title&&(i.title=s.title,r.innerHTML=s.title),s.text&&(i.innerHTML=s.text,r.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,s.callback,s.context),i},_disposeButton:function(s,i){var r=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,r,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,r,u,d,h=this._actionsContainer,p=this.getActions(s),g=p.length;for(r=0,u=this._actionButtons.length;r<u;r++)this._disposeButton(this._actionButtons[r].button,this._actionButtons[r].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<g;y++)"enabled"in p[y]&&!p[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:p[y].title,text:p[y].text,container:i,callback:p[y].callback,context:p[y].context}),this._actionButtons.push({button:d,callback:p[y].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,r=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=r+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),r=this._container;return this._container&&(this._visible&&(r.style.visibility="inherit"),L.DomUtil.setPosition(r,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,r=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,r,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(r=L.Util.extend({},this.options.poly),u.options.poly=r),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],r=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(r);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Qv=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",uf=e=>e.length*6+12,nu=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),c0=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(r=>{if(a.contains(r.getLatLng())){const u=e.latLngToContainerPoint(r.getLatLng()),d=r.locationData;d&&o.push({marker:r,pixelPos:u,location:d})}});const s=o.map(({marker:r,pixelPos:u,location:d})=>{const g=uf(d.name),y=d.description?uf(`${d.name}: ${Qv(d.description,50)}`):g;return{marker:r,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return s.forEach(({marker:r,location:u,markerBox:d,baseLabelBox:h,descLabelBox:p},g)=>{if(!u.description)return;let y=!1;for(let _=0;_<s.length;_++){if(g===_)continue;const b=s[_];if(nu(p,b.markerBox)||nu(p,b.baseLabelBox)){y=!0;break}if(b.descLabelBox&&i.has(b.location.id)&&nu(p,b.descLabelBox)){y=!0;break}}y||i.add(u.id)}),i},yr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],u0=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Wr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function li(e){return Wr.find(t=>t.value===e)||Wr[0]}function d0(e){return li(e).defaultColor||"#667eea"}function h0(e,t){return t||d0(e)}const Eu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,s=t-4,i=4,r=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${r},${s} ${i},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-s} ${o+s},${a} ${o},${a+s} ${o-s},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-3,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${o+s*Math.cos(d)},${a+s*Math.sin(d)}`);const h=d+Math.PI/5;r.push(`${o+i*Math.cos(h)},${a+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${r.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<6;r++){const u=Math.PI/6+r*Math.PI/3;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<5;r++){const u=Math.PI/2*-1+r*2*Math.PI/5;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},df={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Ri={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<6;i++){const r=Math.PI/6+i*Math.PI/3;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<5;i++){const r=Math.PI/2*-1+i*2*Math.PI/5;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=13,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const h=d+Math.PI/5;r.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${r.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},hf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Sn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:s,size:i="100",outputSize:r=null}){if(!e||e==="default"){if(!(o||a||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=li(e),d=parseInt(i,10)/100,h=r||Math.round(32*d);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",y=a||"#fff";if(Ri[e])p=Ri[e]({backgroundColor:g,borderColor:y});else return Eu[e]?.(g,h)||null}else{const g=o||"#667eea",y=a||"#fff",_=s||"#fff",b=t||"circle";b!=="none"&&Ri[b]&&(p+=Ri[b]({backgroundColor:g,borderColor:y})),hf[e]&&(p+=hf[e](_,g))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const f0={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function p0(e,t){return e===0?"missing":e>=t?"full":"partial"}function Pu(e,t){const o=p0(e,t);return f0[o]}function v0(e,t,o=32){if(e==="default")return null;if(df[e])return df[e](o);if(Eu[e]){const a=t||"#667eea";return Eu[e](a,o)}return null}const m0=["circle","square","hexagon","pentagon"];function g0(e){return m0.includes(e)}function y0(e,t,o,a,s=32,i=!0){const r=v0(e,t,s),u=Pu(o,a);if(!r)return null;const d=i&&g0(e),h=h0(e,t),p=_0(h),g=em(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=s>=36?"12px":"10px",_=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${r}
      ${_}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function k0(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function em(e){return!e||e.length<6?!1:k0(e)>.4}function _0(e){return em(e)?"#1F2937":"#FFFFFF"}const b0={class:"map-container-wrapper"},w0="#667eea",C0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null);let r=null;const u=M([]),d=M([]),h=M([]);let p=null,g=null;const y=M([]);let _=null,b=null,C=!1;const I=M(!1),$=()=>{if(r){const Ie=r.getCenter();return{lat:Ie.lat,lng:Ie.lng}}return null},x=()=>r?r.getZoom():null,S=()=>{if(u.value.length>0){h.value.push([...u.value]);const Ie=d.value.pop()||[];u.value=Ie,Te(),s("polygon-drawing",u.value)}},B=()=>{if(h.value.length>0){d.value.push([...u.value]);const Ie=h.value.pop();u.value=Ie,Te(),s("polygon-drawing",u.value)}},E=()=>u.value.length>0,q=()=>h.value.length>0,P=()=>u.value.length,F=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),R())},R=()=>{u.value=[],d.value=[],h.value=[],Te()},j=()=>{!r||!a.userLocation||(r.setView([a.userLocation.lat,a.userLocation.lng],r.getZoom(),{animate:!0,duration:.5}),I.value=!0)},O=(Ie,be,de=null)=>{if(!r||Ie==null||be==null)return;r.setView([Ie,be],de??r.getZoom(),{animate:!0,duration:.5});const fe=a.center&&Math.abs(a.center.lat-Ie)<1e-4&&Math.abs(a.center.lng-be)<1e-4;I.value=!fe},G=M(!0),Q=M(!0),se=(Ie,be)=>{if(!r||Ie==null||be==null)return!0;const de=r.getBounds(),fe=Ot.latLng(Ie,be);return de.contains(fe)};t({getMapCenter:$,getMapZoom:x,undoPolygonPoint:S,redoPolygonPoint:B,canUndo:E,canRedo:q,getPolygonPointCount:P,completePolygon:F,clearPolygonDrawing:R,recenterOnUserLocation:j,recenterOnLocation:O,isLocationInView:se,userLocationInView:Q,highlightedLocationInView:G});const pe=M([]);let ee=null;const te=M(!0),z=M(!1),Y=M(new Set),ue=M([]);let ke=null,Re=null;const Ye=U(()=>a.hideRecenterButton||!a.highlightLocationId||!I.value?!1:!G.value),Ne=M({}),Ke=()=>{const Ie={};if(a.highlightLocationId){const be=a.locations.find(de=>de.id===a.highlightLocationId);if(be?.latitude&&be?.longitude){const de=se(be.latitude,be.longitude);G.value=de,Ie[a.highlightLocationId]=de,Ne.value=Ie;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let be=!0;for(const de of a.highlightLocationIds){const fe=a.locations.find(Z=>Z.id===de);if(fe?.latitude&&fe?.longitude){const Z=se(fe.latitude,fe.longitude);Ie[de]=Z,Z||(be=!1)}else Ie[de]=!0}G.value=be,Ne.value=Ie;return}if(!r){G.value=!0,Ne.value={};return}G.value=!0,Ne.value={}},We=()=>{if(!r||!a.userLocation){Q.value=!0;return}Q.value=se(a.userLocation.lat,a.userLocation.lng)},X=()=>{Ke(),We(),s("visibility-change",{userLocationInView:Q.value,highlightedLocationInView:G.value,highlightedLocationsVisibility:Ne.value})},_e=()=>{if(!r||!a.highlightLocationId)return;const Ie=a.locations.find(be=>be.id===a.highlightLocationId);!Ie||!Ie.latitude||!Ie.longitude||(r.setView([Ie.latitude,Ie.longitude],r.getZoom(),{animate:!0,duration:.5}),I.value=!1,G.value=!0)},Le=(Ie,be,de,fe,Z=!1)=>{const W=de?"36px":fe?"20px":"30px",ie=de?"#667eea":"white",Ue=Z?"":Pu(Ie,be);return`
    <div style="position: relative; width: ${W}; height: ${W};">
      <div style="
        background-color: ${w0};
        width: ${W};
        height: ${W};
        border-radius: 50%;
        border: 3px solid ${ie};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${Z?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Ue}
      </div>`}
    </div>
  `},me=()=>{if(!r)return;const Ie=c0(r,pe.value),be=Array.from(Y.value).sort().join(","),de=Array.from(Ie).sort().join(",");be!==de&&(Y.value=Ie,xe())},ce=()=>{if(Re&&(Re.remove(),Re=null),!r||!a.userLocation)return;const Ie=Ot.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Re=Ot.marker([a.userLocation.lat,a.userLocation.lng],{icon:Ie}).addTo(r).bindPopup("Your location")},N=()=>{if(!i.value)return;let Ie=51.505,be=-.09,de=13;const fe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Z=(ie,Ue)=>ie!=null&&Ue!=null&&!(ie===0&&Ue===0),W=[];fe.length>0&&W.push(...fe.filter(ie=>Z(ie.latitude,ie.longitude)).map(ie=>({lat:ie.latitude,lng:ie.longitude}))),a.route&&a.route.length>0&&W.push(...a.route.filter(ie=>Z(ie.lat,ie.lng)).map(ie=>({lat:ie.lat,lng:ie.lng}))),a.center?(Ie=a.center.lat,be=a.center.lng,de=a.zoom??13):W.length>0&&(Ie=W.reduce((ie,Ue)=>ie+Ue.lat,0)/W.length,be=W.reduce((ie,Ue)=>ie+Ue.lng,0)/W.length,de=10),r=Ot.map(i.value).setView([Ie,be],de),Ot.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(r),a.clickable&&r.on("click",ie=>{a.drawingMode||s("map-click",{lat:ie.latlng.lat,lng:ie.latlng.lng})}),r.on("zoomstart",()=>{he=!0}),r.on("zoomend moveend",()=>{he=!1,J?xe():me(),X()}),r.on("dragstart",()=>{I.value=!0}),xe(),K(),ae(),ce(),Se(),De(),r.whenReady(()=>{X()})},K=()=>{if(ee&&(ee.remove(),ee=null),!r||a.route.length===0)return;const Ie=a.route.map(be=>[be.lat,be.lng]);ee=Ot.polyline(Ie,{color:"blue",weight:4,opacity:.7}).addTo(r)},ae=()=>{ue.value.forEach(Ie=>Ie.remove()),ue.value=[],!(!r||a.areas.length===0)&&a.areas.forEach(Ie=>{const be=typeof Ie.polygon=="string"?JSON.parse(Ie.polygon):Ie.polygon;if(!be||be.length===0)return;const de=be.map(ie=>[ie.lat,ie.lng]),fe=Ie.id===a.selectedAreaId,Z=Ie.color||"#667eea",W=Ot.polygon(de,{color:Z,fillColor:Z,fillOpacity:fe?.4:.2,weight:fe?3:2,opacity:.8}).addTo(r);W.setStyle({pane:"overlayPane"}),a.drawingMode||(W.on("click",()=>s("area-click",Ie)),W.on("mouseover",()=>{W.setStyle({fillOpacity:.4})}),W.on("mouseout",()=>{W.setStyle({fillOpacity:fe?.4:.2})})),ue.value.push(W)})},Te=()=>{if(r&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=Ot.layerGroup().addTo(r),u.value.forEach((Ie,be)=>{const de=be===0,fe=be===u.value.length-1,Z=Ot.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${de?"16px":"12px"};
        height: ${de?"16px":"12px"};
        background-color: ${de?"#667eea":fe?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[de?16:12,de?16:12],iconAnchor:[de?8:6,de?8:6]});Ot.marker([Ie.lat,Ie.lng],{icon:Z,interactive:!1}).addTo(g)}),u.value.length>=2))){const Ie=u.value.map(be=>[be.lat,be.lng]);u.value.length>=3&&Ie.push(Ie[0]),p=Ot.polyline(Ie,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(r)}},Be=()=>{if(!r||(_&&(_.remove(),_=null),b&&(b.remove(),b=null),y.value.length===0))return;const Ie=y.value.map(de=>[de.lat,de.lng]);_=Ot.polygon(Ie,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(r),_.bringToFront(),b=Ot.layerGroup({pane:"markerPane"}).addTo(r);const be=de=>{y.value.length<=3||(y.value.splice(de,1),C=!0,s("polygon-update",[...y.value]),Be())};y.value.forEach((de,fe)=>{const Z=y.value.length>3,W=Ot.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),ie=Ot.marker([de.lat,de.lng],{icon:W,draggable:!0}).addTo(b);if(ie.on("drag",Ue=>{const Xe=Ue.target.getLatLng();y.value[fe]={lat:Xe.lat,lng:Xe.lng};const mt=y.value.map(_t=>[_t.lat,_t.lng]);_.setLatLngs(mt)}),ie.on("dragend",()=>{C=!0,s("polygon-update",[...y.value])}),ie.on("contextmenu",Ue=>{Ot.DomEvent.preventDefault(Ue),Z&&be(fe)}),Z){const Ue=document.createElement("div"),Xe=document.createElement("button");Xe.textContent="Delete point",Xe.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const mt=_t=>{_t.preventDefault(),_t.stopPropagation(),ie.closePopup(),be(fe)};Xe.addEventListener("click",mt),Xe.addEventListener("touchend",mt),Ue.appendChild(Xe),ie.bindPopup(Ue,{closeButton:!1,className:"vertex-popup"})}})},De=(Ie=!0)=>{if(r){if(!a.editingPolygon||a.editingPolygon.length===0){_&&(_.remove(),_=null),b&&(b.remove(),b=null),y.value=[];return}if(y.value=a.editingPolygon.map(be=>({lat:be.lat,lng:be.lng})),Be(),Ie&&y.value.length>=3){const be=Ot.latLngBounds(y.value.map(de=>[de.lat,de.lng]));r.fitBounds(be,{padding:[50,50]})}}},Se=()=>{if(!r)return;if(ke||(ke=new Ot.FeatureGroup,r.addLayer(ke)),r._customDrawingHandlers&&(r.off("click",r._customDrawingHandlers.handleClick),r.getContainer().removeEventListener("touchstart",r._customDrawingHandlers.handleTouchStart),r.getContainer().removeEventListener("touchend",r._customDrawingHandlers.handleTouchEnd),r.getContainer().removeEventListener("touchmove",r._customDrawingHandlers.handleTouchMove),delete r._customDrawingHandlers),!a.drawingMode){R(),ke&&ke.clearLayers();return}let Ie=0,be=null,de=!1,fe=!1;const Z=300,W=15,ie=gt=>{d.value.push([...u.value]),h.value=[],u.value.push({lat:gt.lat,lng:gt.lng}),Te(),s("polygon-drawing",u.value)},Ue=gt=>{gt.originalEvent&&gt.originalEvent.sourceCapabilities?.firesTouchEvents||ie(gt.latlng)},Xe=gt=>{if(gt.touches.length>1){fe=!0;return}fe=!1,Ie=Date.now(),be={x:gt.touches[0].clientX,y:gt.touches[0].clientY},de=!1},mt=gt=>{if(!be||fe)return;const St=gt.touches[0].clientX-be.x,bt=gt.touches[0].clientY-be.y;Math.sqrt(St*St+bt*bt)>W&&(de=!0)},_t=gt=>{if(fe){fe=!1,be=null;return}if(Date.now()-Ie<Z&&!de&&be){const bt=gt.changedTouches[0],Ut=Ot.point(bt.clientX-r.getContainer().getBoundingClientRect().left,bt.clientY-r.getContainer().getBoundingClientRect().top),Bt=r.containerPointToLatLng(Ut);gt.preventDefault(),gt.stopPropagation(),ie(Bt)}be=null,de=!1};r.on("click",Ue),r.getContainer().addEventListener("touchstart",Xe,{passive:!0}),r.getContainer().addEventListener("touchmove",mt,{passive:!0}),r.getContainer().addEventListener("touchend",_t,{passive:!1}),r._customDrawingHandlers={handleClick:Ue,handleTouchStart:Xe,handleTouchMove:mt,handleTouchEnd:_t},Te()};let J=!1,he=!1;const xe=()=>{if(r&&(r._animatingZoom||he)){J=!0;return}if(J=!1,pe.value.forEach(de=>{de._map&&(de.off(),de.remove())}),pe.value=[],!r)return;const Ie=i.value?.clientWidth||400,be=Math.floor(Ie*.75);if(a.locations.forEach(de=>{const fe=de.latitude??de.Latitude,Z=de.longitude??de.Longitude;if(fe==null||Z==null||fe===0&&Z===0)return;const W=de.checkedInCount||0,ie=de.requiredMarshals||1,Ue=a.highlightLocationId===de.id||a.highlightLocationIds.includes(de.id),Xe=a.simplifyNonHighlighted&&!Ue,mt=de.resolvedStyleType||de.ResolvedStyleType,_t=de.resolvedStyleBackgroundColor||de.ResolvedStyleBackgroundColor||de.resolvedStyleColor||de.ResolvedStyleColor,gt=de.resolvedStyleBorderColor||de.ResolvedStyleBorderColor,St=de.resolvedStyleIconColor||de.ResolvedStyleIconColor,bt=de.resolvedStyleBackgroundShape||de.ResolvedStyleBackgroundShape,Ut=mt&&mt!=="default"||_t||gt||St||bt&&bt!=="circle"&&bt!=="default",Bt=de.resolvedStyleMapRotation??de.ResolvedStyleMapRotation??de.styleMapRotation??de.StyleMapRotation??0,ut=parseInt(Bt,10)||0,ln=de.areaColor||"#999",un=de.areaId&&!a.marshalMode,wt=Y.value.has(de.id)&&de.description?`${de.name}: ${Qv(de.description,50)}`:de.name,Xn=Ue?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",zn=Ue?"#667eea":Xe?"#e0e0e0":"white",Qn=Ue?"white":Xe?"#888":"#333";let _n;if(Xe){const at="20px";_n=`
        <div style="
          background-color: #999;
          width: ${at};
          height: ${at};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Kt=!a.marshalMode,ks=Pu(W,ie),eo=Kt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${W}/${ie}</div>`:"";if(!Xe&&Ut){const at=Ue?40:32,je=de.resolvedStyleSize||de.ResolvedStyleSize||"100",xt=Sn({type:de.resolvedStyleType||de.ResolvedStyleType,backgroundShape:de.resolvedStyleBackgroundShape||de.ResolvedStyleBackgroundShape||"circle",backgroundColor:de.resolvedStyleBackgroundColor||de.ResolvedStyleBackgroundColor||de.resolvedStyleColor||de.ResolvedStyleColor||"",borderColor:de.resolvedStyleBorderColor||de.ResolvedStyleBorderColor||"",iconColor:de.resolvedStyleIconColor||de.ResolvedStyleIconColor||"",size:je});xt?_n=xt:_n=y0(de.resolvedStyleType,de.resolvedStyleColor,W,ie,at,Kt)||Le(W,ie,Ue,a.marshalMode,!0)}else Xe||(_n=Le(W,ie,Ue,a.marshalMode,!0));const Io=ut!==0?`transform: rotate(${ut}deg);`:"",le=Ot.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Xn}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${un?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ln};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Io}">
                ${_n}
              </div>
              ${Xe?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${ks}
              </div>`}
              ${Xe?"":eo}
            </div>
          </div>
          <div style="
            background-color: ${zn};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${Ue?"12px":"11px"};
            font-weight: bold;
            color: ${Qn};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${be}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${wt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),re=a.marshalMode?`<b>${de.name}</b>${de.description?`<br>${de.description}`:""}`:`<b>${de.name}</b><br>${de.description||""}<br>Checked in: ${W}/${ie}`,ye=Ot.marker([de.latitude,de.longitude],{icon:le}).addTo(r).bindPopup(re);ye.on("click",()=>{s("location-click",de)}),ye.locationData=de,pe.value.push(ye)}),r&&te.value&&!a.center&&!z.value){const de=[],fe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Z=(W,ie)=>W!=null&&ie!=null&&!(W===0&&ie===0);if(fe.length>0&&de.push(...fe.filter(W=>Z(W.latitude,W.longitude)).map(W=>[W.latitude,W.longitude])),a.route.length>0&&de.push(...a.route.filter(W=>Z(W.lat,W.lng)).map(W=>[W.lat,W.lng])),de.length>0){const W=Ot.latLngBounds(de);r.fitBounds(W,{padding:[50,50]}),te.value=!1,z.value=!0}}else a.center&&(te.value=!1);setTimeout(()=>{r&&!r._animatingZoom&&me()},100)};return Qt(()=>{z.value=!1,te.value=!0,N();let Ie,be=0,de=0;const fe=new ResizeObserver(Z=>{if(r&&Z.length>0){const{width:W,height:ie}=Z[0].contentRect;(Math.abs(W-be)>10||Math.abs(ie-de)>10)&&(be=W,de=ie,clearTimeout(Ie),Ie=setTimeout(()=>{r.invalidateSize()},150))}});i.value&&fe.observe(i.value),kn(()=>{clearTimeout(Ie),fe.disconnect()})}),Ze(()=>a.locations,Ie=>{if(xe(),r&&!z.value&&Ie.length>0&&!a.center){const be=Ie.map(W=>W.latitude),de=Ie.map(W=>W.longitude),fe=be.reduce((W,ie)=>W+ie,0)/be.length,Z=de.reduce((W,ie)=>W+ie,0)/de.length;r.setView([fe,Z],10),z.value=!0,te.value=!1}r&&setTimeout(()=>X(),50)},{deep:!0}),Ze(()=>a.route,Ie=>{if(K(),xe(),r&&!z.value&&Ie&&Ie.length>0&&!a.center){const be=Ie.map(W=>W.lat),de=Ie.map(W=>W.lng),fe=be.reduce((W,ie)=>W+ie,0)/be.length,Z=de.reduce((W,ie)=>W+ie,0)/de.length;r.setView([fe,Z],10),z.value=!0,te.value=!1}},{deep:!0}),Ze(()=>a.center,(Ie,be)=>{r&&!I.value&&(!be||Math.abs(Ie.lat-be.lat)>1e-6||Math.abs(Ie.lng-be.lng)>1e-6)&&r.setView([Ie.lat,Ie.lng],a.zoom)}),Ze(()=>a.areas,()=>{ae()},{deep:!0}),Ze(()=>a.selectedAreaId,()=>{ae()}),Ze(()=>a.drawingMode,()=>{Se()}),Ze(()=>a.editingPolygon,()=>{if(C){C=!1;return}De()},{deep:!0}),Ze(()=>a.userLocation,()=>{ce()},{deep:!0}),Ze(()=>a.highlightLocationId,()=>{xe()}),Ze(()=>a.highlightLocationIds,()=>{xe(),r&&setTimeout(()=>X(),50)},{deep:!0}),Ze(()=>a.marshalMode,()=>{xe()}),Ze(()=>a.simplifyNonHighlighted,()=>{xe()}),Ze(()=>a.clickable,Ie=>{r&&(r.off("click"),Ie&&r.on("click",be=>{a.drawingMode||s("map-click",{lat:be.latlng.lat,lng:be.latlng.lng})}))}),(Ie,be)=>(v(),m("div",b0,[l("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),Ye.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:_e,title:"Recenter on checkpoint"},[...be[0]||(be[0]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),l("span",null,"Recenter",-1)])])):A("",!0)]))}},Du=Ge(C0,[["__scopeId","data-v-91272c81"]]);function js(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const L0={class:"areas-selection"},S0={key:0,class:"areas-selection-header"},I0={class:"areas-list"},x0=["checked","onChange"],$0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>[...o.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:js(d.name,h.name))),i=U(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),r=d=>{const h=[...o.selectedAreaIds],p=h.indexOf(d);p>=0?h.splice(p,1):h.push(d),a("update:selectedAreaIds",h)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,h)=>(v(),m("div",L0,[e.areas.length>1?(v(),m("div",S0,[l("button",{onClick:u,class:"toggle-all-btn"},w(i.value?"Deselect all":"Select all"),1)])):A("",!0),l("div",I0,[(v(!0),m(Me,null,Fe(s.value,p=>(v(),m("label",{class:"area-checkbox",key:p.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>r(p.id)},null,40,x0),l("span",{class:"area-color-dot",style:et({backgroundColor:p.color||"#667eea"})},null,4),Qe(" "+w(p.name),1)]))),128))])]))}},T0=Ge($0,[["__scopeId","data-v-ba19009b"]]),M0={key:1,class:"toolbar-btn-wrapper filters-wrapper"},A0={key:1,class:"dropdown-content filters-dropdown"},E0={class:"filters-header"},P0={class:"filter-section"},D0={class:"filter-checkbox"},O0=["checked"],R0={class:"filter-section"},B0={class:"filter-checkbox"},N0=["checked"],F0={class:"filter-checkbox"},U0=["checked"],z0={class:"filter-checkbox"},H0=["checked"],V0={key:0,class:"filter-section"},G0=["onClick","title"],j0={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Z0={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},q0=["innerHTML"],W0={key:0,class:"dropdown-content action-dropdown"},K0=["onClick"],J0={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=ct(),s=e,i=o,r=M(!1),u=M(null),d=U(()=>u.value!==null),h=()=>{r.value=!r.value,r.value&&(u.value=null)},p=(b,C)=>{i("filter-change",{...s.filters,[b]:C})},g=b=>{b.items&&b.items.length>0?u.value===b.id?u.value=null:(u.value=b.id,r.value=!1):i("action-click",{actionId:b.id})},y=(b,C)=>{u.value=null,i("action-click",{actionId:b,itemId:C})};return t({closeDropdowns:()=>{r.value=!1,u.value=null}}),(b,C)=>(v(),m("div",{class:ve(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:C[0]||(C[0]=I=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...C[8]||(C[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):A("",!0),e.showFilters&&!d.value?(v(),m("div",M0,[r.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:C[1]||(C[1]=I=>r.value=!1)})):A("",!0),l("button",{class:ve(["toolbar-btn",{active:r.value}]),onClick:h,title:"Show/hide options"},[...C[9]||(C[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),r.value?(v(),m("div",A0,[l("div",E0,[C[11]||(C[11]=l("span",{class:"filters-title"},"Map filters",-1)),l("button",{class:"close-filters-btn",onClick:C[2]||(C[2]=I=>r.value=!1),title:"Close"},[...C[10]||(C[10]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),l("div",P0,[C[12]||(C[12]=l("h4",null,"Display",-1)),l("label",D0,[l("input",{type:"checkbox",checked:e.filters.showRoute,onChange:C[3]||(C[3]=I=>p("showRoute",I.target.checked))},null,40,O0),l("span",null,w(D(a).course)+" line",1)])]),l("div",R0,[l("h4",null,w(D(a).checkpoints),1),l("label",B0,[l("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:C[4]||(C[4]=I=>p("showUncheckedIn",I.target.checked))},null,40,N0),C[13]||(C[13]=l("span",{class:"status-indicator unchecked"},null,-1)),C[14]||(C[14]=l("span",null,"Unchecked-in",-1))]),l("label",F0,[l("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:C[5]||(C[5]=I=>p("showPartiallyCheckedIn",I.target.checked))},null,40,U0),C[15]||(C[15]=l("span",{class:"status-indicator partial"},null,-1)),C[16]||(C[16]=l("span",null,"Partially checked-in",-1))]),l("label",z0,[l("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:C[6]||(C[6]=I=>p("showFullyCheckedIn",I.target.checked))},null,40,H0),C[17]||(C[17]=l("span",{class:"status-indicator full"},null,-1)),C[18]||(C[18]=l("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",V0,[l("h4",null,w(D(a).areas),1),Ee(T0,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":C[7]||(C[7]=I=>p("selectedAreaIds",I))},null,8,["areas","selected-area-ids"])])):A("",!0)])):A("",!0)])):A("",!0),(v(!0),m(Me,null,Fe(e.actions,I=>(v(),m("div",{key:I.id,class:ve(["toolbar-btn-wrapper",{hidden:r.value}])},[l("button",{class:ve(["toolbar-btn",{active:u.value===I.id}]),onClick:$=>g(I),title:I.label||I.id},[I.icon==="plus"?(v(),m("svg",j0,[...C[19]||(C[19]=[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):I.icon==="edit"?(v(),m("svg",Z0,[...C[20]||(C[20]=[l("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),l("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):I.icon==="custom"?(v(),m("span",{key:2,innerHTML:I.customIcon},null,8,q0)):A("",!0)],10,G0),I.items&&u.value===I.id?(v(),m("div",W0,[(v(!0),m(Me,null,Fe(I.items,$=>(v(),m("button",{key:$.id,onClick:x=>y(I.id,$.id),class:"dropdown-item"},w($.label),9,K0))),128))])):A("",!0)],2))),128))],2))}},Y0=Ge(J0,[["__scopeId","data-v-d04b549d"]]),X0={key:0,class:"drawing-controls"},Q0={class:"point-count"},ew={class:"undo-redo-buttons"},tw=["disabled"],nw=["disabled"],ow={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>o.show&&o.pointCount>0),i=r=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?r.metaKey:r.ctrlKey;d&&r.key==="z"&&!r.shiftKey?(r.preventDefault(),o.canUndo&&a("undo")):d&&(r.key==="y"||r.key==="z"&&r.shiftKey)&&(r.preventDefault(),o.canRedo&&a("redo"))};return Qt(()=>{document.addEventListener("keydown",i)}),kn(()=>{document.removeEventListener("keydown",i)}),(r,u)=>s.value?(v(),m("div",X0,[l("div",Q0,w(e.pointCount)+" point"+w(e.pointCount!==1?"s":""),1),l("div",ew,[l("button",{onClick:u[0]||(u[0]=d=>r.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,tw),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,nw)])])):A("",!0)}},ff=Ge(ow,[["__scopeId","data-v-6cd009cb"]]),sw={class:"context-info"},aw={class:"action-buttons"},iw=["disabled"],lw={key:0,class:"fullscreen-map-banner"},rw={class:"fullscreen-map-container"},cw={key:1,class:"fullscreen-map-footer"},uw={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=U(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,i=()=>{s("done")},r=()=>{s("cancel")},u=()=>{s("close")},d=h=>{h.key==="Escape"&&o.show&&(o.mode==="view"?u():r())};return Ze(()=>o.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),Qt(()=>{document.addEventListener("keydown",d)}),kn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,p)=>(v(),qe(Ol,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:p[0]||(p[0]=it(()=>{},["prevent","self"]))},[l("div",{class:"fullscreen-map-header",style:et(e.headerStyle)},[l("div",sw,[l("h3",{style:et({color:e.headerTextColor})},w(e.title),5),e.description?(v(),m("p",{key:0,style:et({color:e.headerTextColor,opacity:.85})},w(e.description),5)):A("",!0)]),l("div",aw,[co(h.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:it(u,["stop"]),class:"btn btn-close-x",style:et(a.value),title:"Close"},[...p[1]||(p[1]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(Me,{key:1},[l("button",{type:"button",onClick:r,class:"btn btn-cancel"}," Cancel "),l("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,iw)],64))])],4),h.$slots.banner?(v(),m("div",lw,[co(h.$slots,"banner",{},void 0)])):A("",!0),l("div",rw,[co(h.$slots,"default",{},void 0)]),h.$slots.footer?(v(),m("div",cw,[co(h.$slots,"footer",{},void 0)])):A("",!0)],32)):A("",!0)]))}},dw=Ge(uw,[["__scopeId","data-v-b5d05af4"]]),hw={class:"map-wrapper"},fw={class:"fullscreen-map-wrapper"},pw={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null),r=M(null),u=M(null),d=M(!1),h=M(0),p=M(!1),g=M(!1),y=M({...a.filters});Ze(()=>a.filters,pe=>{y.value={...pe}},{deep:!0}),Ze(()=>a.areas,pe=>{a.showFilters&&pe.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0)&&(y.value.selectedAreaIds=pe.map(ee=>ee.id))},{immediate:!0});const _=U(()=>a.showFilters?a.locations.filter(pe=>{const ee=pe.checkedInCount||0,te=pe.requiredMarshals||1,z=ee===0,Y=ee>0&&ee<te,ue=ee>=te;if(z&&!y.value.showUncheckedIn||Y&&!y.value.showPartiallyCheckedIn||ue&&!y.value.showFullyCheckedIn)return!1;const ke=pe.areaIds||pe.AreaIds||[];return!(a.areas.length>0&&ke.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0||!ke.some(Ye=>y.value.selectedAreaIds.includes(Ye))))}):a.locations),b=U(()=>a.showFilters?y.value.showRoute?a.route:[]:a.route),C=U(()=>a.showFilters?y.value.selectedAreaIds&&y.value.selectedAreaIds.length>0?a.areas.filter(pe=>y.value.selectedAreaIds.includes(pe.id)):a.areas.length>0?[]:a.areas:a.areas),I=U(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?h.value>=3:!0),$=()=>d.value?r.value:i.value,x=()=>{d.value=!0,s("fullscreen-change",!0)},S=()=>{d.value=!1,s("fullscreen-change",!1)},B=()=>{if(a.mode==="draw-polygon"){const pe=$();pe&&pe.clearPolygonDrawing(),h.value=0,p.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},E=()=>{if(a.mode==="draw-polygon"&&h.value>=3){const pe=$();pe&&pe.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},q=pe=>{y.value=pe,s("filter-change",pe)},P=pe=>{a.mode==="select-point"&&s("point-selected",pe),s("map-click",pe)},F=pe=>{h.value=pe?.length||0,O(),s("polygon-drawing",pe)},R=pe=>{s("polygon-complete",pe),h.value=0,p.value=!1,g.value=!1},j=pe=>{s("polygon-update",pe)},O=()=>{const pe=$();pe&&(p.value=pe.canUndo?pe.canUndo():!1,g.value=pe.canRedo?pe.canRedo():!1)},G=()=>{const pe=$();pe&&pe.undoPolygonPoint&&(pe.undoPolygonPoint(),O())},Q=()=>{const pe=$();pe&&pe.redoPolygonPoint&&(pe.redoPolygonPoint(),O())};return t({getMapCenter:()=>$()?.getMapCenter?.(),getMapZoom:()=>$()?.getMapZoom?.(),undoPolygonPoint:G,redoPolygonPoint:Q,canUndo:()=>p.value,canRedo:()=>g.value,getPolygonPointCount:()=>h.value,completePolygon:()=>$()?.completePolygon?.(),clearPolygonDrawing:()=>{$()?.clearPolygonDrawing?.(),h.value=0,p.value=!1,g.value=!1},recenterOnUserLocation:()=>$()?.recenterOnUserLocation?.(),recenterOnLocation:(pe,ee,te)=>$()?.recenterOnLocation?.(pe,ee,te),isLocationInView:(pe,ee)=>$()?.isLocationInView?.(pe,ee)??!0,getUserLocationInView:()=>$()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>$()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:S,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(pe,ee)=>(v(),m("div",{class:"common-map",style:et({height:e.height})},[l("div",hw,[Ee(Du,{ref_key:"mapViewRef",ref:i,locations:_.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ee[0]||(ee[0]=te=>pe.$emit("location-click",te)),onMapClick:P,onAreaClick:ee[1]||(ee[1]=te=>pe.$emit("area-click",te)),onPolygonComplete:R,onPolygonDrawing:F,onPolygonUpdate:j,onVisibilityChange:ee[2]||(ee[2]=te=>pe.$emit("visibility-change",te))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(Y0,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:y.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:x,onFilterChange:q,onActionClick:ee[3]||(ee[3]=te=>pe.$emit("action-click",te))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ee(ff,{show:e.mode==="draw-polygon","point-count":h.value,"can-undo":p.value,"can-redo":g.value,onUndo:G,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])]),Ee(dw,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":I.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:E,onCancel:B,onClose:S},{actions:He(()=>[co(pe.$slots,"fullscreen-actions",{},void 0,!0)]),banner:He(()=>[co(pe.$slots,"fullscreen-banner",{},void 0,!0)]),footer:He(()=>[co(pe.$slots,"fullscreen-footer",{},void 0,!0)]),default:He(()=>[l("div",fw,[Ee(Du,{ref_key:"fullscreenMapViewRef",ref:r,locations:_.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ee[4]||(ee[4]=te=>pe.$emit("location-click",te)),onMapClick:P,onAreaClick:ee[5]||(ee[5]=te=>pe.$emit("area-click",te)),onPolygonComplete:R,onPolygonDrawing:F,onPolygonUpdate:j,onVisibilityChange:ee[6]||(ee[6]=te=>pe.$emit("visibility-change",te))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(ff,{show:e.mode==="draw-polygon","point-count":h.value,"can-undo":p.value,"can-redo":g.value,onUndo:G,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},hi=Ge(pw,[["__scopeId","data-v-d6bcac0e"]]),vw={class:"course-areas-tab"},mw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ct(),i=e,r=o,u=M(null),d=M(null),h=M(0),p=M({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=U(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),y=({actionId:x,itemId:S})=>{x==="add"&&(S==="checkpoint"?(r("add-checkpoint-from-map"),C()):S==="many-checkpoints"?(r("add-many-checkpoints-from-map"),C()):S==="area"?(r("add-area-from-map"),C()):S==="import"?r("import-checkpoints"):S==="upload"&&r("upload-route"))},_=x=>{p.value=x},b=x=>{h.value=x?.length||0},C=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:C,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ze(()=>i.areas,x=>{if(x.length>0){const S=new Set(p.value.selectedAreaIds);x.forEach(B=>{S.has(B.id)||p.value.selectedAreaIds.push(B.id)}),p.value.selectedAreaIds=p.value.selectedAreaIds.filter(B=>x.some(E=>E.id===B))}},{immediate:!0}),Ze(()=>i.drawingMode,x=>{x||(h.value=0)}),(x,S)=>(v(),m("div",vw,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ee(hi,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:p.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${D(s).area} boundary`:D(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:S[0]||(S[0]=B=>x.$emit("map-click",B)),onLocationClick:S[1]||(S[1]=B=>x.$emit("location-click",B)),onAreaClick:S[2]||(S[2]=B=>x.$emit("area-click",B)),onPolygonComplete:S[3]||(S[3]=B=>x.$emit("polygon-complete",B)),onPolygonDrawing:b,onFilterChange:_,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},gw=Ge(mw,[["__scopeId","data-v-c0e54ae9"]]),yw=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),s=parseFloat(o),i=parseFloat(a),r=!isNaN(s)&&String(s)===o,u=!isNaN(i)&&String(i)===a;return r&&u?s-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},kw={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:ve(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[co(t.$slots,"default",{},void 0)],2))}},In=Ge(kw,[["__scopeId","data-v-a94deea5"]]),_w={class:"check-in-toggle-container"},bw=["disabled"],ww={key:0,class:"toggle-spinner"},Cw={key:1,class:"toggle-icon"},Lw={class:"toggle-label"},Sw={key:0,class:"check-in-details"},Iw={key:0,class:"check-in-method"},xw={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,o=U(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),a=U(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),s=U(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=U(()=>{const{checkedInBy:u,checkInMethod:d,marshalName:h}=t;return u&&u!==h?u:d||""}),r=u=>u?new Date(u).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(u,d)=>(v(),m("div",_w,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>u.$emit("toggle"))},[e.isLoading?(v(),m("span",ww)):e.isCheckedIn?(v(),m("span",Cw,"")):A("",!0),l("span",Lw,w(s.value),1)],10,bw),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),m("span",Sw,[Qe(w(r(e.checkInTime))+" ",1),i.value?(v(),m("span",Iw,"("+w(i.value)+")",1)):A("",!0),o.value?(v(),m("span",{key:1,class:ve(["check-in-distance",a.value]),onClick:d[1]||(d[1]=it(h=>u.$emit("distance-click"),["stop"]))},w(o.value),3)):A("",!0)])):A("",!0)]))}},Kr=Ge(xw,[["__scopeId","data-v-f08ae7ff"]]),$w={class:"confirm-modal"},Tw={class:"confirm-actions"},Mw={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},s=()=>{o("cancel")};return(i,r)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:it(s,["self"])},[l("div",$w,[l("h3",null,w(e.title),1),l("p",null,w(e.message),1),l("div",Tw,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},w(e.cancelText),1)):A("",!0),l("button",{onClick:a,class:ve(["btn",e.isDanger?"btn-danger":"btn-primary"])},w(e.confirmText),3)])])])):A("",!0)}},$a=Ge(Mw,[["__scopeId","data-v-bead7a29"]]),Aw={class:"base-modal-header"},Ew={class:"base-modal-header-content"},Pw={key:0,class:"base-modal-title"},Dw={key:0,class:"base-modal-tab-header"},Ow={key:1,class:"base-modal-footer"},Rw={key:0,class:"base-modal-actions"},Bw={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const S=document.documentElement,B=getComputedStyle(S).getPropertyValue("--modal-resize-duration").trim();return B.endsWith("s")?parseFloat(B)*1e3:300},a=e,s=t,i=M(!1),r=M(!1),u=M(null),d=M(null);let h=null,p=!1,g=0;const y=()=>{if(!d.value||!u.value||p)return;const S=d.value.scrollHeight,B=g;if(B===S||g===0){g=S;return}p=!0,d.value.style.height=`${B}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${S}px`;const E=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),p=!1,g=S},E)},_=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),h=new MutationObserver(()=>{sn(()=>{y()})}),h.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{h&&(h.disconnect(),h=null)};Qt(()=>{sn(()=>{a.show&&_()})}),kn(()=>{b()}),Ze(()=>a.show,S=>{S?sn(()=>{g=0,_()}):b()});const C=()=>{a.closeOnOverlay&&I()},I=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:s("close")},$=()=>{i.value=!1,s("close")},x=()=>{i.value=!1};return(S,B)=>(v(),qe(es,{name:"modal",appear:""},{default:He(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:et({zIndex:e.zIndex}),onClick:it(C,["self"])},[l("div",{class:ve(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",Aw,[l("div",Ew,[co(S.$slots,"header",{},()=>[e.title?(v(),m("h2",Pw,w(e.title),1)):A("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:I,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):A("",!0)]),S.$slots["tab-header"]?(v(),m("div",Dw,[co(S.$slots,"tab-header",{},void 0,!0)])):A("",!0),l("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[l("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[co(S.$slots,"default",{},void 0,!0)],512)],512),S.$slots.footer||S.$slots.actions?(v(),m("div",Ow,[co(S.$slots,"footer",{},()=>[S.$slots.actions?(v(),m("div",Rw,[co(S.$slots,"actions",{},void 0,!0)])):A("",!0)],!0)])):A("",!0)],2),e.confirmOnClose&&!r.value?(v(),qe($a,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:$,onCancel:x},null,8,["show"])):A("",!0)],4)):A("",!0)]),_:3}))}},Gt=Ge(Bw,[["__scopeId","data-v-141bdab1"]]),Nw={class:"map-modal-content"},Fw={class:"location-info"},Uw={key:0,class:"info-row"},zw={class:"info-value"},Hw={key:1,class:"info-row"},Vw={class:"info-label"},Gw={class:"info-value"},jw={key:2,class:"info-row distance-row"},Zw={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=ct(),o=e,a=M(null);let s=null,i=null,r=null;const u=U(()=>t.value.checkpoint),d=U(()=>o.marshalName&&o.checkpointName?`${o.marshalName} - ${o.checkpointName}`:o.marshalName?o.marshalName:"Check-in location"),h=U(()=>o.distance===null?"":o.distance<1e3?`${Math.round(o.distance)} m`:`${(o.distance/1e3).toFixed(2)} km`),p=U(()=>o.distance===null?"":o.distance<=50?"distance-close":o.distance<=100?"distance-medium":"distance-far"),g=(C,I)=>C==null||I==null?"Unknown":`${C.toFixed(6)}, ${I.toFixed(6)}`,y=()=>{if(!a.value||s)return;let C=[51.505,-.09],I=15;o.checkInLocation&&(C=[o.checkInLocation.lat,o.checkInLocation.lng]),s=Ot.map(a.value).setView(C,I),Ot.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(s),_()},_=()=>{if(!s)return;i&&(i.remove(),i=null),r&&(r.remove(),r=null);const C=[];if(o.checkInLocation){const I=Ot.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Ot.marker([o.checkInLocation.lat,o.checkInLocation.lng],{icon:I}).addTo(s).bindPopup(`<b>${o.marshalName||"Marshal"}</b><br>Check-in location`),C.push([o.checkInLocation.lat,o.checkInLocation.lng])}if(o.checkpointLocation&&o.checkpointLocation.lat&&o.checkpointLocation.lng){const I=Ot.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${o.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});r=Ot.marker([o.checkpointLocation.lat,o.checkpointLocation.lng],{icon:I}).addTo(s).bindPopup(`<b>${o.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),C.push([o.checkpointLocation.lat,o.checkpointLocation.lng])}if(C.length===2){const I=Ot.latLngBounds(C);s.fitBounds(I,{padding:[50,50],maxZoom:17})}else C.length===1&&s.setView(C[0],16)},b=()=>{s&&(s.remove(),s=null,i=null,r=null)};return Ze(()=>o.show,async C=>{C?(await sn(),setTimeout(()=>{y()},100)):b()}),Ze([()=>o.checkInLocation,()=>o.checkpointLocation],()=>{s&&_()},{deep:!0}),Qt(()=>{o.show&&sn(()=>{setTimeout(()=>{y()},100)})}),kn(()=>{b()}),(C,I)=>(v(),qe(Gt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:I[0]||(I[0]=$=>C.$emit("close"))},{default:He(()=>[l("div",Nw,[l("div",{class:"map-container",ref_key:"mapContainer",ref:a},null,512),l("div",Fw,[e.checkInLocation?(v(),m("div",Uw,[I[1]||(I[1]=l("span",{class:"info-label"},"Check-in location:",-1)),l("span",zw,w(g(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):A("",!0),e.checkpointLocation?(v(),m("div",Hw,[l("span",Vw,w(u.value)+" location:",1),l("span",Gw,w(g(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):A("",!0),e.distance!==null?(v(),m("div",jw,[I[2]||(I[2]=l("span",{class:"info-label"},"Distance:",-1)),l("span",{class:ve(["info-value distance-value",p.value])},w(h.value),3)])):A("",!0)])])]),_:1},8,["show","title","z-index"]))}},dd=Ge(Zw,[["__scopeId","data-v-011fa479"]]),qw={class:"marshals-tab"},Ww={class:"tab-header"},Kw={class:"button-group"},Jw={key:0,class:"status-pills"},Yw={class:"filters-section"},Xw={class:"search-group"},Qw={class:"marshals-grid"},eC={class:"marshals-table"},tC={key:0,class:"sort-indicator"},nC={key:0,class:"sort-indicator"},oC={key:0,class:"sort-indicator"},sC={key:0,class:"sort-indicator"},aC=["onClick"],iC=["rowspan"],lC={class:"checkpoint-cell"},rC={class:"checkpoint-name"},cC={key:0,class:"checkpoint-description"},uC=["rowspan"],dC={key:0,class:"last-active-text"},hC={key:1,class:"last-active-never"},fC=["onClick"],pC={class:"no-checkpoint-text"},vC={class:"hide-on-mobile last-active-cell"},mC={key:0,class:"last-active-text"},gC={key:1,class:"last-active-never"},yC={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=ct(),s=e,i=o,r=M(null),u=M(!1),d=M(null),h=X=>{r.value=X},p=X=>{d.value=X,u.value=!0},g=()=>{u.value=!1,d.value=null},y=U(()=>d.value?Re(d.value.marshalId):""),_=U(()=>d.value?ue(d.value.locationId):""),b=U(()=>{if(!d.value)return null;const{checkInLatitude:X,checkInLongitude:_e}=d.value;return!X||!_e?null:{lat:X,lng:_e}}),C=U(()=>{if(!d.value)return null;const X=Y(d.value.locationId);return!X?.latitude||!X?.longitude?null:{lat:X.latitude,lng:X.longitude}}),I=U(()=>d.value?Ye(d.value):null),$=M(!1),x=M(null),S=X=>{X.isCheckedIn?(x.value=X,$.value=!0):i("toggle-check-in",X)},B=()=>{x.value&&i("toggle-check-in",x.value),$.value=!1,x.value=null},E=()=>{$.value=!1,x.value=null},q=U(()=>x.value?`Are you sure you want to undo ${Re(x.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const P=M("name"),F=M("asc"),R=M(""),j=M("all"),O=X=>{j.value=X},G=X=>{P.value===X?F.value=F.value==="asc"?"desc":"asc":(P.value=X,F.value="asc")},Q=X=>s.assignments.filter(_e=>_e.marshalId===X),se=U(()=>new Set(s.assignments.filter(X=>X.isCheckedIn).map(X=>X.marshalId))),pe=U(()=>new Set(s.assignments.map(X=>X.marshalId))),ee=U(()=>se.value.size),te=U(()=>s.marshals.filter(X=>!pe.value.has(X.id)).length),z=U(()=>s.marshals.filter(X=>pe.value.has(X.id)&&!se.value.has(X.id)).length),Y=X=>s.locations.find(_e=>_e.id===X),ue=X=>{const _e=Y(X);return _e?_e.name:"Unknown"},ke=X=>{const _e=Y(X);return _e?_e.description:""},Re=X=>{const _e=s.marshals.find(Le=>Le.id===X);return _e?_e.name:""},Ye=X=>{const{checkInLatitude:_e,checkInLongitude:Le,locationId:me}=X,ce=Y(me);return!_e||!Le||!ce?.latitude||!ce?.longitude?null:di(_e,Le,ce.latitude,ce.longitude)},Ne=X=>{if(!X)return"";const _e=new Date(X),me=new Date-_e,ce=Math.floor(me/6e4),N=Math.floor(ce/60),K=Math.floor(N/24);return ce<1?"just now":ce<60?`${ce}m ago`:N<24?`${N}h ago`:K===1?"yesterday":K<7?`${K}d ago`:_e.toLocaleDateString()},Ke=U(()=>{let X=s.marshals;if(j.value==="unassigned"?X=X.filter(_e=>!pe.value.has(_e.id)):j.value==="checked-in"?X=X.filter(_e=>se.value.has(_e.id)):j.value==="not-checked-in"&&(X=X.filter(_e=>pe.value.has(_e.id)&&!se.value.has(_e.id))),R.value.trim()){const _e=R.value.toLowerCase().trim().split(/\s+/);X=X.filter(Le=>{const ce=Q(Le.id).map(K=>{const ae=Y(K.locationId);return ae?`${ae.name||""} ${ae.description||""}`:""}).join(" "),N=`${Le.name} ${ce}`.toLowerCase();return _e.every(K=>N.includes(K))})}return X}),We=U(()=>{const X=[...Ke.value];return X.sort((_e,Le)=>{let me=0;if(P.value==="name")me=_e.name.localeCompare(Le.name);else if(P.value==="checkpoint"){const ce=Q(_e.id),N=Q(Le.id),K=ce.length>0?ue(ce[0].locationId):"",ae=N.length>0?ue(N[0].locationId):"";me=yw(K,ae)}else if(P.value==="status"){const ce=Q(_e.id),N=Q(Le.id),K=ce.length>0&&ce[0].isCheckedIn?1:0;me=(N.length>0&&N[0].isCheckedIn?1:0)-K}else if(P.value==="lastActive"){const ce=_e.lastAccessedDate?new Date(_e.lastAccessedDate).getTime():0;me=(Le.lastAccessedDate?new Date(Le.lastAccessedDate).getTime():0)-ce}return F.value==="asc"?me:-me}),X});return(X,_e)=>(v(),m("div",qw,[l("div",Ww,[l("div",Kw,[l("button",{onClick:_e[0]||(_e[0]=Le=>X.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(D(a).person.toLowerCase()),1),l("button",{onClick:_e[1]||(_e[1]=Le=>X.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",Jw,[Ee(In,{variant:"neutral",active:j.value==="all",onClick:_e[2]||(_e[2]=Le=>O("all"))},{default:He(()=>[Qe(w(e.marshals.length)+" total ",1)]),_:1},8,["active"]),te.value>0?(v(),qe(In,{key:0,variant:"warning",active:j.value==="unassigned",onClick:_e[3]||(_e[3]=Le=>O("unassigned"))},{default:He(()=>[Qe(w(te.value)+" unassigned ",1)]),_:1},8,["active"])):A("",!0),ee.value>0?(v(),qe(In,{key:1,variant:"success",active:j.value==="checked-in",onClick:_e[4]||(_e[4]=Le=>O("checked-in"))},{default:He(()=>[Qe(w(ee.value)+" checked in ",1)]),_:1},8,["active"])):A("",!0),z.value>0?(v(),qe(In,{key:2,variant:"danger",active:j.value==="not-checked-in",onClick:_e[5]||(_e[5]=Le=>O("not-checked-in"))},{default:He(()=>[Qe(w(z.value)+" not checked in ",1)]),_:1},8,["active"])):A("",!0)])):A("",!0)]),l("div",Yw,[l("div",Xw,[ze(l("input",{"onUpdate:modelValue":_e[6]||(_e[6]=Le=>R.value=Le),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[tt,R.value]])])]),l("div",Qw,[l("table",eC,[l("thead",null,[l("tr",null,[l("th",{onClick:_e[7]||(_e[7]=Le=>G("name")),class:"sortable"},[_e[12]||(_e[12]=Qe(" Name ",-1)),P.value==="name"?(v(),m("span",tC,w(F.value==="asc"?"":""),1)):A("",!0)]),l("th",{onClick:_e[8]||(_e[8]=Le=>G("checkpoint")),class:"sortable"},[Qe(w(D(a).checkpoint)+" ",1),P.value==="checkpoint"?(v(),m("span",nC,w(F.value==="asc"?"":""),1)):A("",!0)]),l("th",{onClick:_e[9]||(_e[9]=Le=>G("status")),class:"sortable"},[_e[13]||(_e[13]=Qe(" Status ",-1)),P.value==="status"?(v(),m("span",oC,w(F.value==="asc"?"":""),1)):A("",!0)]),l("th",{onClick:_e[10]||(_e[10]=Le=>G("lastActive")),class:"sortable hide-on-mobile"},[_e[14]||(_e[14]=Qe(" Last active ",-1)),P.value==="lastActive"?(v(),m("span",sC,w(F.value==="asc"?"":""),1)):A("",!0)])])]),l("tbody",null,[(v(!0),m(Me,null,Fe(We.value,Le=>(v(),m(Me,{key:Le.id},[Q(Le.id).length>0?(v(!0),m(Me,{key:0},Fe(Q(Le.id),(me,ce)=>(v(),m("tr",{key:`${Le.id}-${me.id}`,class:"marshal-row",onClick:N=>X.$emit("select-marshal",Le)},[ce===0?(v(),m("td",{key:0,rowspan:Q(Le.id).length},w(Le.name),9,iC)):A("",!0),l("td",lC,[l("div",rC,w(ue(me.locationId)),1),ke(me.locationId)?(v(),m("div",cC,w(ke(me.locationId)),1)):A("",!0)]),l("td",{onClick:_e[11]||(_e[11]=it(()=>{},["stop"])),class:"check-in-cell"},[Ee(Kr,{"is-checked-in":me.isCheckedIn,"check-in-time":me.checkInTime,"check-in-method":me.checkInMethod,"checked-in-by":me.checkedInBy,"marshal-name":Re(me.marshalId),"is-loading":r.value===me.id,distance:Ye(me),onToggle:N=>S(me),onDistanceClick:N=>p(me)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),ce===0?(v(),m("td",{key:1,rowspan:Q(Le.id).length,class:"hide-on-mobile last-active-cell"},[Le.lastAccessedDate?(v(),m("span",dC,w(Ne(Le.lastAccessedDate)),1)):(v(),m("span",hC,"Never"))],8,uC)):A("",!0)],8,aC))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:me=>X.$emit("select-marshal",Le)},[l("td",null,w(Le.name),1),l("td",pC,"No "+w(D(a).checkpoint.toLowerCase())+" assigned",1),_e[15]||(_e[15]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),l("td",vC,[Le.lastAccessedDate?(v(),m("span",mC,w(Ne(Le.lastAccessedDate)),1)):(v(),m("span",gC,"Never"))])],8,fC))],64))),128))])])]),Ee(dd,{show:u.value,"marshal-name":y.value,"checkpoint-name":_.value,"check-in-location":b.value,"checkpoint-location":C.value,distance:I.value,onClose:g},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Ee($a,{show:$.value,title:"Confirm check-out",message:q.value,"confirm-text":"Check out","is-danger":!0,onConfirm:B,onCancel:E},null,8,["show","message"])]))}},kC=Ge(yC,[["__scopeId","data-v-f74695a8"]]),_C={class:"assignment-pills"},bC={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:o}=ct(),a=e,s=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${o.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",r=(h,p)=>p==="Area"?a.areas.find(y=>y.id===h)?.name||h:p==="Checkpoint"?a.locations.find(y=>y.id===h)?.name||h:p==="Marshal"&&a.marshals.find(y=>y.id===h)?.name||h,u=h=>{if(!h)return[];const p=s(h.scope),g=h.ids||[];if(h.itemType===null||g.length===0)return[p];if(g.includes("ALL_MARSHALS"))return["Everyone"];if(g.includes("ALL_AREAS"))return[`${p} (All ${o.value.areas})`];if(g.includes("ALL_CHECKPOINTS"))return[`${p} (All ${o.value.checkpoints})`];if(g.length>a.maxExpandedItems)return[`${p} (${g.length})`];const y=i(h.scope);return g.map(_=>{const b=r(_,h.itemType);return y?`${y} ${b}`:b})},d=U(()=>{if(!a.scopeConfigurations||a.scopeConfigurations.length===0)return[];const h=[];for(const p of a.scopeConfigurations)h.push(...u(p));return h});return(h,p)=>(v(),m("div",_C,[(v(!0),m(Me,null,Fe(d.value,(g,y)=>(v(),m("span",{key:y,class:"scope-badge",onClick:p[0]||(p[0]=_=>h.$emit("click"))},w(g),1))),128))]))}},Xl=Ge(bC,[["__scopeId","data-v-13785e5c"]]),wC={class:"checklists-tab"},CC={class:"checklists-tab-header"},LC={class:"button-group"},SC={class:"filters-section"},IC={class:"search-group"},xC=["placeholder"],$C={class:"checklist-items-list"},TC={key:0,class:"empty-state"},MC={class:"checklist-item-content"},AC=["onClick"],EC={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=M(""),i=U(()=>{if(!s.value.trim())return a.checklistItems;const u=s.value.toLowerCase().trim().split(/\s+/);return a.checklistItems.filter(d=>{const h=(d.text||"").toLowerCase();return u.every(p=>h.includes(p))})}),r=U(()=>[...i.value].sort((u,d)=>u.displayOrder!==d.displayOrder?u.displayOrder-d.displayOrder:js(u.text,d.text)));return(u,d)=>(v(),m("div",wC,[l("div",CC,[l("div",LC,[l("button",{onClick:d[0]||(d[0]=h=>u.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(D(o).checklist),1)])]),l("div",SC,[l("div",IC,[ze(l("input",{"onUpdate:modelValue":d[1]||(d[1]=h=>s.value=h),type:"text",class:"search-input",placeholder:`Search ${D(o).checklists}...`},null,8,xC),[[tt,s.value]])])]),l("div",$C,[i.value.length===0?(v(),m("div",TC,[l("p",null,w(s.value?`No ${D(o).checklists} match your search.`:`No ${D(o).checklists} yet. Create one to get started!`),1)])):A("",!0),(v(!0),m(Me,null,Fe(r.value,h=>(v(),m("div",{key:h.itemId,class:"checklist-item-card"},[l("div",MC,[l("div",{class:"checklist-item-title",onClick:p=>u.$emit("select-checklist-item",h,"details")},[l("strong",null,w(h.text),1)],8,AC),Ee(Xl,{class:"checklist-item-scopes","scope-configurations":h.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:p=>u.$emit("select-checklist-item",h,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])]))),128))])]))}},PC=Ge(EC,[["__scopeId","data-v-4ea79496"]]),DC={class:"notes-tab"},OC={class:"tab-header"},RC={class:"button-group"},BC={class:"filters-section"},NC={class:"search-group"},FC={class:"notes-list"},UC={key:0,class:"empty-state"},zC=["onClick"],HC={class:"note-header"},VC={class:"note-title-row"},GC={key:0,class:"pin-icon",title:"Pinned"},jC={key:1,class:"emergency-indicator",title:"Shown in emergency info"},ZC={class:"note-meta"},qC={key:0,class:"category-badge"},WC={class:"created-info"},KC={key:0,class:"note-preview"},JC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const o=e,a=M(""),s=U(()=>{if(!a.value.trim())return o.notes;const d=a.value.toLowerCase().trim().split(/\s+/);return o.notes.filter(h=>{const p=`${h.title||""} ${h.content||""} ${h.priority||""}`.toLowerCase();return d.every(g=>p.includes(g))})}),i=U(()=>{const d={Urgent:0,High:1,Normal:2,Low:3};return[...s.value].sort((h,p)=>{if(h.isPinned!==p.isPinned)return h.isPinned?-1:1;const g=d[h.priority]??2,y=d[p.priority]??2;return g!==y?g-y:h.displayOrder!==p.displayOrder?h.displayOrder-p.displayOrder:js(h.title,p.title)})}),r=d=>{if(!d)return"";const h=150;return d.length<=h?d:d.substring(0,h)+"..."},u=d=>{if(!d)return"";const h=new Date(d),g=new Date-h,y=Math.floor(g/6e4),_=Math.floor(g/36e5),b=Math.floor(g/864e5);return y<1?"Just now":y<60?`${y}m ago`:_<24?`${_}h ago`:b<7?`${b}d ago`:h.toLocaleDateString()};return(d,h)=>(v(),m("div",DC,[l("div",OC,[l("div",RC,[l("button",{onClick:h[0]||(h[0]=p=>d.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",BC,[l("div",NC,[ze(l("input",{"onUpdate:modelValue":h[1]||(h[1]=p=>a.value=p),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[tt,a.value]])])]),l("div",FC,[s.value.length===0?(v(),m("div",UC,[l("p",null,w(a.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):A("",!0),(v(!0),m(Me,null,Fe(i.value,p=>(v(),m("div",{key:p.noteId,class:ve(["note-card",{pinned:p.isPinned}]),onClick:g=>d.$emit("select-note",p)},[l("div",HC,[l("div",VC,[p.isPinned?(v(),m("span",GC,"")):A("",!0),l("span",{class:ve(["priority-indicator",p.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,w(p.title),1),p.showInEmergencyInfo?(v(),m("span",jC,"")):A("",!0)]),l("div",ZC,[p.category?(v(),m("span",qC,w(p.category),1)):A("",!0),l("span",WC,w(u(p.createdAt)),1)])]),p.content?(v(),m("div",KC,w(r(p.content)),1)):A("",!0),Ee(Xl,{"scope-configurations":p.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],10,zC))),128))])]))}},YC=Ge(JC,[["__scopeId","data-v-93bd2dc4"]]),XC={key:0,class:"empty-state"},QC={key:0,class:"empty-hint"},e2={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",XC,[l("p",null,w(e.emptyMessage),1),e.emptyHint?(v(),m("p",QC,w(e.emptyHint),1)):A("",!0)])):(v(),m("div",{key:1,class:ve(["cards-grid",e.gridClass])},[co(t.$slots,"default",{},void 0)],2))}},Ql=Ge(e2,[["__scopeId","data-v-a842b7b1"]]),t2={class:"contact-card-header"},n2={class:"contact-name-row"},o2={key:0,class:"pin-icon",title:"Pinned"},s2={key:1,class:"primary-badge",title:"Primary contact"},a2={class:"contact-name"},i2={key:0,class:"contact-role"},l2={key:0,class:"emergency-indicator",title:"Shown in emergency info"},r2={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},c2=["title"],u2={key:0,class:"contact-card-details"},d2={key:0,class:"contact-phone"},h2={key:1,class:"contact-email"},f2={key:1,class:"contact-card-notes"},p2={key:3,class:"contact-card-badge"},v2={key:4,class:"contact-card-badge"},m2={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,s=t,i=U(()=>{const h=a.contact.scopeConfigurations;return!h||h.length===0}),r=()=>{a.clickable&&!a.isPending&&!a.isMarkedForRemoval&&s("click",a.contact)},u=h=>h?h==="AreaLead"?`${o.value.area} Lead`:h.replace(/([A-Z])/g," $1").replace(/^./,p=>p.toUpperCase()).trim():"",d=h=>{if(!h)return"";const p=100;return h.length<=p?h:h.substring(0,p)+"..."};return(h,p)=>(v(),m("div",{class:ve(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:r},[l("div",t2,[l("div",{class:ve(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[l("div",n2,[e.contact.isPinned&&!e.isMarkedForRemoval?(v(),m("span",o2,"")):A("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",s2,"")):A("",!0),l("span",a2,w(e.contact.name),1)]),e.contact.role?(v(),m("span",i2,w(u(e.contact.role)),1)):A("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(v(),m("span",l2,"")):A("",!0),i.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",r2,"!")):A("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:p[0]||(p[0]=it(g=>h.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,c2)):A("",!0),e.isMarkedForRemoval?(v(),m("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:p[1]||(p[1]=it(g=>h.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):A("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",u2,[e.contact.phone?(v(),m("span",d2,w(e.contact.phone),1)):A("",!0),e.contact.email?(v(),m("span",h2,w(e.contact.email),1)):A("",!0)])):A("",!0),e.contact.notes&&e.showNotes?(v(),m("div",f2,w(d(e.contact.notes)),1)):A("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),qe(Xl,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):A("",!0),e.isPending?(v(),m("div",p2,[...p[2]||(p[2]=[l("span",{class:"pending-indicator"},"Will be added on save",-1)])])):A("",!0),e.isMarkedForRemoval?(v(),m("div",v2,[...p[3]||(p[3]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):A("",!0)],2))}},g2=Ge(m2,[["__scopeId","data-v-119c6276"]]),tm={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,a=s=>!s.isPending;return(s,i)=>(v(),qe(Ql,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:He(()=>[(v(!0),m(Me,null,Fe(e.contacts,r=>(v(),qe(g2,{key:r.contactId,contact:r,"is-pending":r.isPending,"is-marked-for-removal":r.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(r),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(r),areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:u=>s.$emit("select",r),onRemove:i[0]||(i[0]=u=>s.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},y2={class:"contacts-tab"},k2={class:"tab-header"},_2={class:"button-group"},b2={key:0,class:"status-pills"},w2={class:"filters-section"},C2={class:"search-group"},L2={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=M(""),s=M("all"),i=U(()=>o.contacts.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0).length),r=U(()=>o.contacts.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0).length),u=_=>{s.value=_},d=_=>_?_.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",h=_=>_?_.replace(/([A-Z])/g," $1").replace(/^./,b=>b.toUpperCase()).trim():"",p=U(()=>{let _=o.contacts;if(s.value==="no-scope"?_=_.filter(b=>!b.scopeConfigurations||b.scopeConfigurations.length===0):s.value==="with-scope"&&(_=_.filter(b=>b.scopeConfigurations&&b.scopeConfigurations.length>0)),a.value.trim()){const C=d(a.value).split(" ").filter(I=>I.length>0);_=_.filter(I=>{const $=h(I.role),x=d(`${I.name||""} ${$} ${I.email||""} ${I.phone||""}`);return C.every(S=>x.includes(S))})}return _}),g=U(()=>[...p.value].sort((_,b)=>{if(_.isPinned!==b.isPinned)return _.isPinned?-1:1;const C=_.displayOrder||0,I=b.displayOrder||0;return C!==I?C-I:(_.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"})})),y=U(()=>{const _=a.value.trim();return s.value==="no-scope"?_?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?_?"No assigned contacts match your search.":"No contacts are assigned yet.":_?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(_,b)=>(v(),m("div",y2,[l("div",k2,[l("div",_2,[l("button",{onClick:b[0]||(b[0]=C=>_.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",b2,[Ee(In,{variant:"neutral",active:s.value==="all",onClick:b[1]||(b[1]=C=>u("all"))},{default:He(()=>[Qe(w(e.contacts.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(In,{key:0,variant:"success",active:s.value==="with-scope",onClick:b[2]||(b[2]=C=>u("with-scope"))},{default:He(()=>[Qe(w(r.value)+" assigned ",1)]),_:1},8,["active"])):A("",!0),i.value>0?(v(),qe(In,{key:1,variant:"danger",active:s.value==="no-scope",onClick:b[3]||(b[3]=C=>u("no-scope"))},{default:He(()=>[Qe(w(i.value)+" unassigned ",1)]),_:1},8,["active"])):A("",!0)])):A("",!0)]),l("div",w2,[l("div",C2,[ze(l("input",{"onUpdate:modelValue":b[4]||(b[4]=C=>a.value=C),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[tt,a.value]])])]),Ee(tm,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":y.value,areas:e.areas,locations:e.locations,marshals:e.marshals,onSelect:b[5]||(b[5]=C=>_.$emit("select-contact",C))},null,8,["contacts","empty-message","areas","locations","marshals"])]))}},S2=Ge(L2,[["__scopeId","data-v-4cc6bcc1"]]),nm=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],I2={class:"event-details-tab"},x2={class:"event-info-card"},$2={class:"form-group"},T2={class:"form-group"},M2={class:"form-row"},A2={class:"form-group"},E2={class:"form-group"},P2=["value"],D2={class:"form-actions"},O2=["disabled"],R2={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,s=M({...o.eventData});Ze(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},r=()=>{a("submit",{...s.value})};return(u,d)=>(v(),m("div",I2,[l("div",x2,[l("form",{onSubmit:it(r,["prevent"]),class:"event-details-form"},[l("div",$2,[d[4]||(d[4]=l("label",null,"Event name",-1)),ze(l("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>s.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[tt,s.value.name]])]),l("div",T2,[d[5]||(d[5]=l("label",null,"Description",-1)),ze(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>s.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[tt,s.value.description]])]),l("div",M2,[l("div",A2,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),ze(l("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>s.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[tt,s.value.eventDate]])]),l("div",E2,[d[7]||(d[7]=l("label",null,"Time zone",-1)),ze(l("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>s.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(v(!0),m(Me,null,Fe(D(nm),h=>(v(),m("option",{key:h.value,value:h.value},w(h.label),9,P2))),128))],544),[[Fn,s.value.timeZoneId]])])]),l("div",D2,[l("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,O2)])],32)])]))}},B2=Ge(R2,[["__scopeId","data-v-2754c3cc"]]),N2={class:"admins-list"},F2={class:"admin-info"},U2={class:"admin-role"},z2=["onClick"],H2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[l("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",N2,[(v(!0),m(Me,null,Fe(e.admins,a=>(v(),m("div",{key:a.userEmail,class:"admin-item"},[l("div",F2,[l("strong",null,w(a.userEmail),1),l("span",U2,w(a.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,z2)):A("",!0)]))),128))])]))}},V2=Ge(H2,[["__scopeId","data-v-e526860b"]]),Pn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],$r="#667eea";function G2(e){const t=e.map(a=>a.color);return Pn.find(a=>!t.includes(a.hex))?.hex||$r}const j2={class:"modal-content"},Z2={class:"modal-body"},q2={class:"preview-section"},W2={class:"map-preview"},K2=["innerHTML"],J2={class:"options-grid"},Y2={class:"option-button-content"},X2={class:"option-button-value icon-value"},Q2=["innerHTML"],eL={class:"option-button-content"},tL={class:"option-button-value color-value"},nL=["disabled"],oL={class:"option-button-content"},sL={class:"option-button-value color-value"},aL={class:"option-button-content"},iL={class:"option-button-value icon-value"},lL=["innerHTML"],rL=["disabled"],cL={class:"option-button-content"},uL={class:"option-button-value color-value"},dL={class:"option-button-content"},hL={class:"option-button-value"},fL={class:"option-button-content"},pL={class:"option-button-value"},vL={key:0,class:"centered-popup"},mL={class:"popup-grid"},gL=["onClick"],yL=["innerHTML"],kL={key:0},_L={key:1,class:"centered-popup"},bL={class:"popup-grid"},wL=["title","onClick"],CL=["innerHTML"],LL={key:0},SL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},IL={key:1,class:"custom-check-mark"},xL={key:0,class:"custom-hex-input"},$L={class:"hex-input-row"},TL=["disabled"],ML={key:0,class:"hex-error"},AL={key:2,class:"centered-popup"},EL={class:"popup-grid"},PL=["title","onClick"],DL=["innerHTML"],OL={key:0},RL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},BL={key:1,class:"custom-check-mark"},NL={key:0,class:"custom-hex-input"},FL={class:"hex-input-row"},UL=["disabled"],zL={key:0,class:"hex-error"},HL={key:3,class:"centered-popup icon-popup"},VL={class:"popup-grid"},GL=["onClick"],jL=["innerHTML"],ZL={key:0},qL={key:4,class:"centered-popup"},WL={class:"popup-grid"},KL=["title","onClick"],JL=["innerHTML"],YL={key:0},XL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},QL={key:1,class:"custom-check-mark"},eS={key:0,class:"custom-hex-input"},tS={class:"hex-input-row"},nS=["disabled"],oS={key:0,class:"hex-error"},sS={key:5,class:"centered-popup"},aS={class:"size-grid"},iS=["onClick"],lS=["innerHTML"],rS={key:6,class:"centered-popup"},cS={class:"rotation-content"},uS={class:"rotation-preview-container"},dS=["innerHTML"],hS={class:"rotation-control"},fS={class:"rotation-slider-container"},pS=["value"],vS={class:"rotation-value"},mS={class:"rotation-presets"},gS="#667eea",yS={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,s=M(o.backgroundShape||"circle"),i=M(o.iconType||"none"),r=M(o.backgroundColor||""),u=M(o.borderColor||""),d=M(o.iconColor||""),h=M(o.size||"100"),p=M(o.mapRotation??""),g=M(null),y=M(!1),_=M(!1),b=M(!1),C=M(""),I=M(""),$=M(""),x=M(null),S=M(null),B=M(null),E=le=>le==="default"?o.inheritedBackgroundShape||"circle":le==="none"?"none":le||"circle",q=le=>le==="default"||!le?z():le==="none"?"transparent":le,P=le=>le==="default"?o.inheritedBorderColor||"#ffffff":le==="none"||!le?"transparent":le,F=le=>{if(le==="default"){const re=o.inheritedType;return re&&re!=="default"&&li(re).category==="content"?re:"none"}return le==="none"||!le?"none":le},R=le=>le==="default"||!le?o.inheritedIconColor||"#ffffff":le==="none"?"transparent":le,j=le=>le==="default"?o.inheritedSize||"100":le||"100",O=le=>{if(le==="default"||le===""){const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&parseInt(re,10)||0}return parseInt(le,10)||0},G=U(()=>{const le=o.inheritedBackgroundShape||"circle",re=yr.find(ye=>ye.value===le)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${re})`,showLabel:!0},...yr.filter(ye=>ye.value!=="none").map(ye=>({...ye,showLabel:!1}))]}),Q=U(()=>{const le=Wr.filter(at=>at.category==="content"),re=[{value:"none",label:"None",category:"content",showLabel:!0}],ye=o.inheritedType;if(ye&&ye!=="default"){const at=li(ye);at.category==="content"&&re.push({value:"default",label:`Default (${at.label||ye})`,category:"content",showLabel:!0})}return re.push(...le.map(at=>({...at,showLabel:!1}))),re}),se=U(()=>{const le={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${le[o.inheritedSize]||"Normal"})`},...u0.map(ye=>({value:ye.value,label:le[ye.value]||ye.label}))]}),pe=U(()=>E(s.value)!=="none"),ee=U(()=>F(i.value)!=="none"),te=U(()=>{const le=o.inheritedBackgroundColor;return le&&le!=="default"&&le.startsWith("#")?le:gS}),z=()=>te.value,Y=U(()=>r.value&&r.value!=="default"?r.value:z()),ue=U(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),ke=U(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Re=U(()=>{const le=te.value,re=Pn.find(ye=>ye.hex.toLowerCase()===le.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},...Pn.map(ye=>({hex:ye.hex,name:ye.name,showLabel:!1}))]}),Ye=U(()=>{const le=o.inheritedBorderColor||"#ffffff",re=le==="#ffffff"?"White":Pn.find(ye=>ye.hex===le)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(ye=>ye.hex!=="#ffffff").map(ye=>({hex:ye.hex,name:ye.name,showLabel:!1}))]}),Ne=U(()=>{const le=o.inheritedIconColor||"#ffffff",re=le==="#ffffff"?"White":Pn.find(ye=>ye.hex===le)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(ye=>ye.hex!=="#ffffff").map(ye=>({hex:ye.hex,name:ye.name,showLabel:!1}))]}),Ke=le=>le==="default"?!r.value||r.value==="default":r.value===le,We=le=>le==="#ffffff"?!d.value||d.value==="#ffffff":d.value===le,X=U(()=>{const le=r.value;return!le||le==="default"||le==="none"?!1:!Pn.some(re=>re.hex.toLowerCase()===le.toLowerCase())}),_e=U(()=>{const le=u.value;return!le||le==="default"||le==="none"||le==="#ffffff"||le==="#000000"?!1:!Pn.some(re=>re.hex.toLowerCase()===le.toLowerCase())}),Le=U(()=>{const le=d.value;return!le||le==="default"||le==="none"||le==="#ffffff"||le==="#000000"?!1:!Pn.some(re=>re.hex.toLowerCase()===le.toLowerCase())}),me=U(()=>{if(!C.value)return!1;const le=C.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),ce=U(()=>{if(!I.value)return!1;const le=I.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),N=U(()=>{if(!$.value)return!1;const le=$.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),K=le=>{if(le==="none")return"None";if(le==="default"){const ye=o.inheritedBackgroundShape;return ye?`Default (${yr.find(je=>je.value===ye)?.label||"Circle"})`:"Default (Circle)"}const re=yr.find(ye=>ye.value===le);return re?re.label:"Circle"},ae=le=>{if(le==="none")return"None";if(le==="default"){const ye=o.inheritedType;if(ye&&ye!=="default"){const at=li(ye);if(at.category==="content")return`Default (${at.label||ye})`}return"Default"}const re=Wr.find(ye=>ye.value===le);return re?re.label:"None"},Te=le=>{if(le==="none")return"None";if(!le||le==="default"){const ye=te.value;return`Default (${Pn.find(je=>je.hex.toLowerCase()===ye.toLowerCase())?.name||"Custom"})`}const re=[...Pn].find(ye=>ye.hex.toLowerCase()===le.toLowerCase());return re?re.name:le},Be=le=>{if(le==="none")return"None";if(le==="default"){const ye=o.inheritedBorderColor;return ye&&ye!=="none"?`Default (${ye==="#ffffff"?"White":Pn.find(je=>je.hex===ye)?.name||"Custom"})`:"Default (White)"}if(!le||le==="#ffffff")return"White";const re=[...Ye.value].find(ye=>ye.hex===le);return re?re.name:le},De=le=>{if(le==="none")return"None";if(le==="default"){const ye=o.inheritedIconColor;return ye?`Default (${ye==="#ffffff"?"White":Pn.find(je=>je.hex===ye)?.name||"Custom"})`:"Default (White)"}if(!le||le==="#ffffff")return"White";const re=[...Ne.value].find(ye=>ye.hex===le);return re?re.name:le},Se=le=>{const re={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(le==="default"){const ye=o.inheritedSize;return`Default (${re[ye]||"Normal"})`}return re[le]||"Normal"},J=le=>{if(le==="default"||le===""||le===void 0||le===null){const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null?`Default (${re})`:"Default (0)"}return`${le}`},he=le=>{if(le==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const re=E(le),ye=q(r.value),at=P(u.value);return Ri[re]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Ri[re]({backgroundColor:ye,borderColor:at==="transparent"?"none":at})}</svg>`:""},xe=le=>{const re=F(le);return re==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Sn({type:re,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Ie=le=>{const re=E(le);if(re==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const ye=q(r.value),at=P(u.value),je=F(i.value),xt=R(d.value);return Sn({type:je!=="none"?je:re,backgroundShape:re,backgroundColor:ye,borderColor:at==="transparent"?"none":at,iconColor:xt,size:"100",outputSize:28})},be=le=>{const re=q(le),ye=E(s.value),at=P(u.value),je=F(i.value),xt=R(d.value);return ye==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${re==="transparent"?"#e2e8f0":re}"/>
    </svg>`:Sn({type:je!=="none"?je:ye,backgroundShape:ye,backgroundColor:re==="transparent"?"#e2e8f0":re,borderColor:at==="transparent"?"none":at,iconColor:xt,size:"100",outputSize:28})},de=le=>{const re=P(le),ye=E(s.value),at=q(r.value),je=F(i.value),xt=R(d.value);return ye==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${re}" stroke-width="2"/>
    </svg>`:Sn({type:je!=="none"?je:ye,backgroundShape:ye,backgroundColor:at,borderColor:re==="transparent"?"none":re,iconColor:xt,size:"100",outputSize:28})},fe=le=>{const re=F(le),ye=E(s.value),at=q(r.value),je=P(u.value),xt=R(d.value);if(re==="none"&&ye==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const Jt=ye!=="none"?ye:"circle";return Sn({type:re!=="none"?re:Jt,backgroundShape:Jt,backgroundColor:at,borderColor:je==="transparent"?"none":je,iconColor:xt,size:"100",outputSize:42})},Z=le=>{const re=R(le),ye=E(s.value),at=q(r.value),je=P(u.value),xt=F(i.value);return xt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${re==="transparent"?"#e2e8f0":re}"/>
    </svg>`:Sn({type:xt,backgroundShape:ye!=="none"?ye:"circle",backgroundColor:at,borderColor:je==="transparent"?"none":je,iconColor:re==="transparent"?"#e2e8f0":re,size:"100",outputSize:28})},W=le=>{const re=j(le),ye=E(s.value),at=q(r.value),je=P(u.value),xt=F(i.value),Jt=R(d.value);if(ye==="none"&&xt==="none")return"";const en=ye!=="none"?ye:"circle";return Sn({type:xt!=="none"?xt:en,backgroundShape:en,backgroundColor:at,borderColor:je==="transparent"?"none":je,iconColor:Jt,size:re})},ie=U(()=>{const le=E(s.value),re=q(r.value),ye=P(u.value),at=F(i.value),je=R(d.value),xt=j(h.value);return le==="none"&&at==="none"?"":Sn(le==="none"&&at!=="none"?{type:at,backgroundShape:"none",backgroundColor:re,borderColor:"none",iconColor:je,size:xt}:{type:at!=="none"?at:le,backgroundShape:le,backgroundColor:re,borderColor:ye==="transparent"?"none":ye,iconColor:je,size:xt})}),Ue=le=>{g.value=g.value===le?null:le},Xe=()=>{g.value=null,y.value=!1,_.value=!1,b.value=!1},mt=le=>{s.value=le,Xe()},_t=le=>{r.value=le,Xe()},gt=le=>{u.value=le,Xe()},St=le=>{i.value=le,Xe()},bt=le=>{d.value=le,Xe()},Ut=le=>{h.value=le,Xe()},Bt=le=>{p.value=le,Xe()},ut=()=>{y.value=!y.value,y.value&&(X.value?C.value=r.value.replace(/^#/,""):C.value="",sn(()=>x.value?.focus()))},ln=()=>{_.value=!_.value,_.value&&(_e.value?I.value=u.value.replace(/^#/,""):I.value="",sn(()=>S.value?.focus()))},un=()=>{b.value=!b.value,b.value&&(Le.value?$.value=d.value.replace(/^#/,""):$.value="",sn(()=>B.value?.focus()))},Nt=()=>{C.value=C.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},wt=()=>{I.value=I.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Xn=()=>{$.value=$.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},zn=le=>le.length===3?le[0]+le[0]+le[1]+le[1]+le[2]+le[2]:le,Qn=()=>{if(!me.value)return;const le=zn(C.value);r.value="#"+le,y.value=!1,Xe()},_n=()=>{if(!ce.value)return;const le=zn(I.value);u.value="#"+le,_.value=!1,Xe()},Kt=()=>{if(!N.value)return;const le=zn($.value);d.value="#"+le,b.value=!1,Xe()},ks=le=>{p.value=le};Ze(()=>o.isOpen,le=>{if(le){const re=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",ye=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",at=o.backgroundColor&&o.backgroundColor!=="",je=o.borderColor&&o.borderColor!=="",xt=o.iconColor&&o.iconColor!=="",Jt=o.size&&o.size!==""&&o.size!=="100",en=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;re||ye||at||je||xt||Jt||en?(s.value=o.backgroundShape||"default",i.value=o.iconType||"default",r.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",h.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",i.value="default",r.value="default",u.value="default",d.value="default",h.value="default",p.value="default"),g.value=null}});const eo=()=>{Xe(),a("update:isOpen",!1),a("cancel")},Io=()=>{Xe();const le=at=>at==="default"?"":at;let re="";i.value==="none"?re="none":i.value&&i.value!=="default"&&(re=i.value);let ye="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(ye=parseInt(p.value,10)||0),a("apply",{iconType:re,backgroundShape:le(s.value),backgroundColor:le(r.value),borderColor:le(u.value),iconColor:le(d.value),size:le(h.value),mapRotation:ye}),a("update:isOpen",!1)};return(le,re)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:it(eo,["self"])},[l("div",j2,[l("div",{class:"modal-header"},[re[18]||(re[18]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:eo},"")]),l("div",Z2,[l("div",q2,[l("div",W2,[re[19]||(re[19]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:et({transform:`rotate(${O(p.value)}deg)`}),innerHTML:ie.value},null,12,K2)])]),l("div",J2,[l("button",{type:"button",class:ve(["option-button",{active:g.value==="shape"}]),onClick:re[0]||(re[0]=ye=>Ue("shape"))},[l("div",Y2,[re[20]||(re[20]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",X2,[l("div",{class:"icon-preview-small",innerHTML:he(s.value)},null,8,Q2),l("span",null,w(K(s.value)),1)])]),re[21]||(re[21]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="bgColor"}]),onClick:re[1]||(re[1]=ye=>Ue("bgColor"))},[l("div",eL,[re[22]||(re[22]=l("span",{class:"option-button-label"},"Background",-1)),l("div",tL,[l("span",{class:"color-swatch",style:et({backgroundColor:Y.value})},null,4),l("span",null,w(Te(r.value)),1)])]),re[23]||(re[23]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="borderColor",disabled:!pe.value}]),disabled:!pe.value,onClick:re[2]||(re[2]=ye=>Ue("borderColor"))},[l("div",oL,[re[24]||(re[24]=l("span",{class:"option-button-label"},"Border",-1)),l("div",sL,[l("span",{class:ve(["color-swatch",{"no-border":u.value==="none"}]),style:et(u.value!=="none"?{backgroundColor:ue.value}:{})},null,6),l("span",null,w(Be(u.value)),1)])]),re[25]||(re[25]=l("span",{class:"option-button-arrow"},"",-1))],10,nL),l("button",{type:"button",class:ve(["option-button",{active:g.value==="icon"}]),onClick:re[3]||(re[3]=ye=>Ue("icon"))},[l("div",aL,[re[26]||(re[26]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",iL,[l("div",{class:"icon-preview-small",innerHTML:xe(i.value)},null,8,lL),l("span",null,w(ae(i.value)),1)])]),re[27]||(re[27]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="iconColor",disabled:!ee.value}]),disabled:!ee.value,onClick:re[4]||(re[4]=ye=>Ue("iconColor"))},[l("div",cL,[re[28]||(re[28]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",uL,[l("span",{class:"color-swatch",style:et({backgroundColor:ke.value})},null,4),l("span",null,w(De(d.value)),1)])]),re[29]||(re[29]=l("span",{class:"option-button-arrow"},"",-1))],10,rL),l("button",{type:"button",class:ve(["option-button",{active:g.value==="size"}]),onClick:re[5]||(re[5]=ye=>Ue("size"))},[l("div",dL,[re[30]||(re[30]=l("span",{class:"option-button-label"},"Size",-1)),l("span",hL,w(Se(h.value)),1)]),re[31]||(re[31]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:re[6]||(re[6]=ye=>Ue("mapRotation"))},[l("div",fL,[re[32]||(re[32]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",pL,w(J(p.value)),1)]),re[33]||(re[33]=l("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",vL,[l("div",{class:"popup-header"},[re[34]||(re[34]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",mL,[(v(!0),m(Me,null,Fe(G.value,ye=>(v(),m("button",{key:ye.value,type:"button",class:ve(["popup-grid-item",{selected:s.value===ye.value}]),onClick:at=>mt(ye.value)},[l("div",{class:"popup-item-preview",innerHTML:Ie(ye.value)},null,8,yL),ye.showLabel?(v(),m("span",kL,w(ye.label),1)):A("",!0)],10,gL))),128))])])):A("",!0),g.value==="bgColor"?(v(),m("div",_L,[l("div",{class:"popup-header"},[re[35]||(re[35]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",bL,[(v(!0),m(Me,null,Fe(Re.value,ye=>(v(),m("button",{key:ye.hex,type:"button",class:ve(["popup-grid-item",{selected:Ke(ye.hex)}]),title:ye.name,onClick:at=>_t(ye.hex)},[l("div",{class:"popup-item-preview",innerHTML:be(ye.hex)},null,8,CL),ye.showLabel?(v(),m("span",LL,w(ye.name),1)):A("",!0)],10,wL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:X.value}]),style:et(X.value?{"--custom-color":r.value}:{}),title:"Custom colour",onClick:ut},[l("div",{class:"popup-item-preview custom-color-preview",style:et(X.value?{backgroundColor:r.value}:{})},[X.value?A("",!0):(v(),m("svg",SL,[...re[36]||(re[36]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),X.value?(v(),m("span",IL,"")):A("",!0)],4),re[37]||(re[37]=l("span",null,"Custom",-1))],6)]),y.value?(v(),m("div",xL,[re[39]||(re[39]=l("label",null,"Enter hex code",-1)),l("div",$L,[re[38]||(re[38]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"bgHexInput",ref:x,"onUpdate:modelValue":re[7]||(re[7]=ye=>C.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:C.value&&!me.value}]),onInput:Nt,onKeydown:Jo(Qn,["enter"])},null,34),[[tt,C.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:me.value?"#"+C.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!me.value,onClick:Qn}," Apply ",8,TL)]),C.value&&!me.value?(v(),m("span",ML," Invalid hex code ")):A("",!0)])):A("",!0)])):A("",!0),g.value==="borderColor"?(v(),m("div",AL,[l("div",{class:"popup-header"},[re[40]||(re[40]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",EL,[(v(!0),m(Me,null,Fe(Ye.value,ye=>(v(),m("button",{key:ye.hex,type:"button",class:ve(["popup-grid-item",{selected:u.value===ye.hex}]),title:ye.name,onClick:at=>gt(ye.hex)},[l("div",{class:"popup-item-preview",innerHTML:de(ye.hex)},null,8,DL),ye.showLabel?(v(),m("span",OL,w(ye.name),1)):A("",!0)],10,PL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:_e.value}]),style:et(_e.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:ln},[l("div",{class:"popup-item-preview custom-color-preview",style:et(_e.value?{backgroundColor:u.value}:{})},[_e.value?A("",!0):(v(),m("svg",RL,[...re[41]||(re[41]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),_e.value?(v(),m("span",BL,"")):A("",!0)],4),re[42]||(re[42]=l("span",null,"Custom",-1))],6)]),_.value?(v(),m("div",NL,[re[44]||(re[44]=l("label",null,"Enter hex code",-1)),l("div",FL,[re[43]||(re[43]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"borderHexInput",ref:S,"onUpdate:modelValue":re[8]||(re[8]=ye=>I.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!ce.value}]),onInput:wt,onKeydown:Jo(_n,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:ce.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!ce.value,onClick:_n}," Apply ",8,UL)]),I.value&&!ce.value?(v(),m("span",zL," Invalid hex code ")):A("",!0)])):A("",!0)])):A("",!0),g.value==="icon"?(v(),m("div",HL,[l("div",{class:"popup-header"},[re[45]||(re[45]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",VL,[(v(!0),m(Me,null,Fe(Q.value,ye=>(v(),m("button",{key:ye.value,type:"button",class:ve(["popup-grid-item",{selected:i.value===ye.value}]),onClick:at=>St(ye.value)},[l("div",{class:"popup-item-preview",innerHTML:fe(ye.value)},null,8,jL),ye.showLabel?(v(),m("span",ZL,w(ye.label),1)):A("",!0)],10,GL))),128))])])):A("",!0),g.value==="iconColor"?(v(),m("div",qL,[l("div",{class:"popup-header"},[re[46]||(re[46]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",WL,[(v(!0),m(Me,null,Fe(Ne.value,ye=>(v(),m("button",{key:ye.hex,type:"button",class:ve(["popup-grid-item",{selected:We(ye.hex)}]),title:ye.name,onClick:at=>bt(ye.hex)},[l("div",{class:"popup-item-preview",innerHTML:Z(ye.hex)},null,8,JL),ye.showLabel?(v(),m("span",YL,w(ye.name),1)):A("",!0)],10,KL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:Le.value}]),style:et(Le.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:un},[l("div",{class:"popup-item-preview custom-color-preview",style:et(Le.value?{backgroundColor:d.value}:{})},[Le.value?A("",!0):(v(),m("svg",XL,[...re[47]||(re[47]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Le.value?(v(),m("span",QL,"")):A("",!0)],4),re[48]||(re[48]=l("span",null,"Custom",-1))],6)]),b.value?(v(),m("div",eS,[re[50]||(re[50]=l("label",null,"Enter hex code",-1)),l("div",tS,[re[49]||(re[49]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"iconHexInput",ref:B,"onUpdate:modelValue":re[9]||(re[9]=ye=>$.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:$.value&&!N.value}]),onInput:Xn,onKeydown:Jo(Kt,["enter"])},null,34),[[tt,$.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:N.value?"#"+$.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!N.value,onClick:Kt}," Apply ",8,nS)]),$.value&&!N.value?(v(),m("span",oS," Invalid hex code ")):A("",!0)])):A("",!0)])):A("",!0),g.value==="size"?(v(),m("div",sS,[l("div",{class:"popup-header"},[re[51]||(re[51]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",aS,[(v(!0),m(Me,null,Fe(se.value,ye=>(v(),m("button",{key:ye.value,type:"button",class:ve(["size-grid-item",{selected:h.value===ye.value}]),onClick:at=>Ut(ye.value)},[l("div",{class:"size-preview",innerHTML:W(ye.value)},null,8,lS),l("span",null,w(ye.label),1)],10,iS))),128))])])):A("",!0),g.value==="mapRotation"?(v(),m("div",rS,[l("div",{class:"popup-header"},[re[52]||(re[52]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:Xe},"")]),l("div",cS,[l("div",uS,[l("div",{class:"rotation-preview-icon",style:et({transform:`rotate(${O(p.value)}deg)`}),innerHTML:ie.value},null,12,dS)]),re[53]||(re[53]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",hS,[l("button",{type:"button",class:ve(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:re[10]||(re[10]=ye=>Bt("default"))}," Default ",2),l("div",fS,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:re[11]||(re[11]=ye=>ks(parseInt(ye.target.value,10)))},null,40,pS),l("div",vS,w(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),l("div",mS,[l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===-90}]),onClick:re[12]||(re[12]=ye=>Bt(-90))},"-90",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===-45}]),onClick:re[13]||(re[13]=ye=>Bt(-45))},"-45",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===0}]),onClick:re[14]||(re[14]=ye=>Bt(0))},"0",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===45}]),onClick:re[15]||(re[15]=ye=>Bt(45))},"+45",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===90}]),onClick:re[16]||(re[16]=ye=>Bt(90))},"+90",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===180}]),onClick:re[17]||(re[17]=ye=>Bt(180))},"180",2)])])])):A("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:eo},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:Io},"Apply")])])])):A("",!0)}},kS=Ge(yS,[["__scopeId","data-v-bbab1a46"]]),_S={class:"checkpoint-style-picker"},bS={class:"form-group"},wS={class:"style-options"},CS=["innerHTML"],LS={class:"option-label"},SS=["innerHTML"],IS="#667eea",xS={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,s=M(o.styleType),i=M(o.styleColor||""),r=M(o.styleBackgroundShape||"default"),u=M(o.styleBackgroundColor||""),d=M(o.styleBorderColor||""),h=M(o.styleIconColor||""),p=M(o.styleSize||"default"),g=M(o.styleMapRotation||""),y=O=>!O||O==="default"?!1:li(O).category==="content",_=M(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),b=M(!1),C=U(()=>!!(s.value&&s.value!=="default"||r.value&&r.value!=="default"&&r.value!=="circle"||u.value||d.value||h.value||p.value&&p.value!=="default"&&p.value!=="100")),I=O=>O&&O!==""&&O!=="default",$=O=>O&&O.startsWith("#"),x=U(()=>{const G=I(o.inheritedStyleType),Q=I(o.inheritedBackgroundShape),se=$(o.inheritedBackgroundColor)||$(o.inheritedStyleColor),pe=$(o.inheritedBorderColor),ee=$(o.inheritedIconColor),te=I(o.inheritedSize);if(G||Q||se||pe||ee||te){const Y=G?o.inheritedStyleType:Q?o.inheritedBackgroundShape:"circle",ue=($(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||($(o.inheritedStyleColor)?o.inheritedStyleColor:null)||IS;return Sn({type:Y,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:ue,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),S=U(()=>{const O=o.inheritedMapRotation;return O!==""&&O!==void 0&&O!==null&&O!==0?{transform:`rotate(${O}deg)`}:{}}),B=U(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const G=parseInt(g.value,10)||0;if(G!==0)return{transform:`rotate(${G}deg)`}}const O=o.inheritedMapRotation;return O!==""&&O!==void 0&&O!==null&&O!==0?{transform:`rotate(${O}deg)`}:{}}),E=U(()=>{if(C.value){const O=_.value&&_.value!=="none"&&_.value!=="default";let G=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&li(o.inheritedStyleType).category==="content"&&(G=o.inheritedStyleType);const Q=_.value==="default"&&G,se=O||Q,pe=O?_.value:Q?G:null,ee=r.value&&r.value!=="default"?r.value:o.inheritedBackgroundShape||"circle",te=se?pe:ee,z=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Y=d.value||o.inheritedBorderColor||"#ffffff",ue=h.value||o.inheritedIconColor||"#ffffff";return Sn({type:te,backgroundShape:ee,backgroundColor:z,borderColor:Y,iconColor:ue,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),q=()=>{s.value="default",_.value="default",a("update:styleType","default"),r.value="default",u.value="",i.value="",d.value="",h.value="",p.value="default",g.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),j()},P=()=>{b.value=!0},F=O=>{O.iconType==="none"?_.value="none":O.iconType?_.value=O.iconType:_.value="default",r.value=O.backgroundShape||"default",u.value=O.backgroundColor||"",d.value=O.borderColor||"",h.value=O.iconColor||"",p.value=O.size||"default",g.value=O.mapRotation??"";const G=O.iconType==="none"||O.iconType&&O.iconType!==""||O.backgroundShape||O.backgroundColor||O.borderColor||O.iconColor||O.size||O.mapRotation!==""&&O.mapRotation!==0;O.iconType&&O.iconType!=="none"?s.value=O.iconType:G?s.value="custom":s.value="default",a("update:styleType",s.value),a("update:styleBackgroundShape",O.backgroundShape),a("update:styleBackgroundColor",O.backgroundColor),a("update:styleBorderColor",O.borderColor),a("update:styleIconColor",O.iconColor),a("update:styleSize",O.size),a("update:styleMapRotation",O.mapRotation??""),j()},R=()=>{},j=()=>{a("change",{styleType:s.value,styleColor:u.value||i.value,styleBackgroundShape:r.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:p.value,styleMapRotation:g.value})};return Ze(()=>o.styleType,O=>{s.value=O,O&&O!=="default"&&O!=="custom"&&y(O)?_.value=O:_.value="default"}),Ze(()=>o.styleColor,O=>{i.value=O||""}),Ze(()=>o.styleBackgroundShape,O=>{r.value=O||"default"}),Ze(()=>o.styleBackgroundColor,O=>{u.value=O||""}),Ze(()=>o.styleBorderColor,O=>{d.value=O||""}),Ze(()=>o.styleIconColor,O=>{h.value=O||""}),Ze(()=>o.styleSize,O=>{p.value=O||"default"}),Ze(()=>o.styleMapRotation,O=>{g.value=O??""}),(O,G)=>(v(),m("div",_S,[l("div",bS,[l("label",null,w(e.iconLabel),1),l("div",wS,[l("button",{type:"button",class:ve(["style-option-button",{selected:!C.value}]),onClick:q},[l("div",{class:"option-preview",style:et(S.value),innerHTML:x.value},null,12,CS),l("span",LS,w(e.defaultLabel),1)],2),l("button",{type:"button",class:ve(["style-option-button",{selected:C.value}]),onClick:P},[l("div",{class:"option-preview",style:et(B.value),innerHTML:E.value},null,12,SS),G[1]||(G[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Ee(kS,{isOpen:b.value,"onUpdate:isOpen":G[0]||(G[0]=Q=>b.value=Q),"icon-type":_.value,"background-shape":r.value,"background-color":u.value,"border-color":d.value,"icon-color":h.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:F,onCancel:R},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},hd=Ge(xS,[["__scopeId","data-v-c066da64"]]),$S={class:"logo-uploader"},TS={key:0,class:"logo-preview"},MS=["src"],AS=["disabled"],ES={key:0,class:"upload-progress"},PS={key:1,class:"upload-prompt"},DS={key:2,class:"error-message"},pf=5*1024*1024,OS={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=ee=>ee?ee.startsWith("/api")?ka+ee.substring(4):ee:"",s=e;function i(){const ee={},te=localStorage.getItem("adminEmail");te&&(ee["X-Admin-Email"]=te);const z=localStorage.getItem("sessionToken");return z&&(ee.Authorization=`Bearer ${z}`),ee}const r=o;function u(){r("staged-change",{hasPendingChanges:_.value!==null||C.value,isPendingDelete:C.value,displayUrl:b.value||(C.value?"":s.modelValue)||""})}const d=M(null),h=M(!1),p=M(!1),g=M(""),y=M(Date.now()),_=M(null),b=M(""),C=M(!1),I=U(()=>{if(s.staged){if(b.value)return!0;if(C.value)return!1}return!!s.modelValue}),$=U(()=>{if(s.staged&&C.value)return"";if(s.staged&&b.value)return b.value;if(!s.modelValue)return"";const ee=a(s.modelValue),te=ee.includes("?")?"&":"?";return`${ee}${te}_t=${y.value}`});function x(){b.value&&(URL.revokeObjectURL(b.value),b.value="")}kn(()=>{x()});const S=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function B(){h.value||d.value?.click()}function E(ee){const te=ee.target.files?.[0];te&&P(te),d.value&&(d.value.value="")}function q(ee){p.value=!1;const te=ee.dataTransfer?.files?.[0];te&&P(te)}async function P(ee){if(g.value="",!S.includes(ee.type)){g.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(ee.size>pf){g.value=`File too large. Maximum size is ${pf/(1024*1024)}MB.`;return}if(s.staged){x(),_.value=ee,b.value=URL.createObjectURL(ee),C.value=!1,u();return}h.value=!0;try{const te=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":ee.type,...i()},body:ee});if(!te.ok){const Y=await te.text().catch(()=>"");let ue=`Upload failed (${te.status})`;try{ue=JSON.parse(Y).message||ue}catch{Y&&(ue=Y)}throw new Error(ue)}const z=await te.json();y.value=Date.now(),r("update:modelValue",z.logoUrl)}catch(te){console.error("Logo upload error:",te),te.name==="TypeError"&&te.message==="Failed to fetch"?g.value="Network error. Check your connection or try a smaller file.":te.message?.includes("401")||te.message?.includes("403")?g.value="Not authorized. Please refresh the page and try again.":g.value=te.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function F(){if(g.value="",s.staged){_.value?(x(),_.value=null):s.modelValue&&(C.value=!0),u();return}h.value=!0;try{const ee=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!ee.ok){const te=await ee.json().catch(()=>({}));throw new Error(te.message||"Delete failed")}r("update:modelValue","")}catch(ee){console.error("Logo delete error:",ee),g.value=ee.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function R(){if(!_.value)return{success:!0,logoUrl:C.value?"":s.modelValue};h.value=!0,g.value="";try{const ee=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":_.value.type,...i()},body:_.value});if(!ee.ok){const z=await ee.text().catch(()=>"");let Y=`Upload failed (${ee.status})`;try{Y=JSON.parse(z).message||Y}catch{z&&(Y=z)}throw new Error(Y)}const te=await ee.json();return y.value=Date.now(),x(),_.value=null,C.value=!1,{success:!0,logoUrl:te.logoUrl}}catch(ee){return console.error("Logo upload error:",ee),g.value=ee.message||"Failed to upload logo. Please try again.",{success:!1,error:ee.message}}finally{h.value=!1}}async function j(){if(!C.value)return{success:!0};h.value=!0,g.value="";try{const ee=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!ee.ok){const te=await ee.json().catch(()=>({}));throw new Error(te.message||"Delete failed")}return C.value=!1,{success:!0}}catch(ee){return console.error("Logo delete error:",ee),g.value=ee.message||"Failed to remove logo. Please try again.",{success:!1,error:ee.message}}finally{h.value=!1}}function O(){return _.value!==null||C.value}function G(){return _.value}function Q(){return C.value}function se(){return b.value?b.value:C.value?"":a(s.modelValue)||""}function pe(){x(),_.value=null,C.value=!1}return t({uploadStagedFile:R,deleteStagedLogo:j,hasPendingChanges:O,getStagedFile:G,isPendingDelete:Q,getDisplayUrl:se,resetStagedState:pe}),(ee,te)=>(v(),m("div",$S,[te[4]||(te[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),I.value?(v(),m("div",TS,[l("img",{src:$.value,alt:"Event logo",class:"logo-image"},null,8,MS),l("button",{type:"button",class:"remove-btn",onClick:F,disabled:h.value}," Remove ",8,AS)])):(v(),m("div",{key:1,class:ve(["upload-area",{"drag-over":p.value,uploading:h.value}]),onDragover:te[0]||(te[0]=it(z=>p.value=!0,["prevent"])),onDragleave:te[1]||(te[1]=it(z=>p.value=!1,["prevent"])),onDrop:it(q,["prevent"]),onClick:B},[l("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:E},null,544),h.value?(v(),m("div",ES,[...te[2]||(te[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),m("div",PS,[...te[3]||(te[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),g.value?(v(),m("div",DS,w(g.value),1)):A("",!0)]))}},RS=Ge(OS,[["__scopeId","data-v-bfb1b332"]]),om=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function BS(){return{...om[0]}}function NS(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function Ou(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function Ru(e){return!e||e===""?"#ffffff":Ou(e)>.179?"#333333":"#ffffff"}function sm(e,t){const o=e||cn.headerGradientStart,a=t||cn.headerGradientEnd,s=Ou(o),i=Ou(a);return(s+i)/2>.35?"#333333":"#ffffff"}const cn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},FS={class:"marshal-mockup-container"},US={class:"presets-section"},zS={class:"presets-row"},HS=["title","onClick"],VS={class:"preset-name"},GS={class:"mockup-frame"},jS={key:0,class:"logo-cover-bg"},ZS=["src"],qS=["src"],WS={class:"header-center"},KS={class:"event-name"},JS={class:"mockup-buttons"},YS=["src"],XS={class:"mockup-body"},QS={class:"mockup-card"},eI={class:"card-content"},tI={class:"editor-header"},nI={class:"editor-content"},oI={class:"color-grid-inline"},sI={class:"color-field"},aI={class:"color-swatches"},iI=["title","onClick"],lI={key:0,class:"check"},rI={class:"custom-color-wrapper"},cI={class:"hex-popup-header"},uI={class:"hex-input-row"},dI=["disabled"],hI={key:0,class:"hex-error"},fI={class:"gradient-toggle"},pI={key:0,class:"color-field"},vI={class:"color-swatches"},mI=["title","onClick"],gI={key:0,class:"check"},yI={class:"custom-color-wrapper"},kI={class:"hex-popup-header"},_I={class:"hex-input-row"},bI=["disabled"],wI={key:0,class:"hex-error"},CI={key:1,class:"logo-position-section"},LI={class:"position-buttons"},SI={class:"color-swatches"},II=["title","onClick"],xI={key:0,class:"check"},$I={class:"custom-color-wrapper"},TI={class:"hex-popup-header"},MI={class:"hex-input-row"},AI=["disabled"],EI={key:0,class:"hex-error"},PI={class:"color-grid-inline"},DI={class:"color-field"},OI={class:"color-swatches"},RI=["title","onClick"],BI={key:0,class:"check"},NI={class:"custom-color-wrapper"},FI={class:"hex-popup-header"},UI={class:"hex-input-row"},zI=["disabled"],HI={key:0,class:"hex-error"},VI={class:"gradient-toggle"},GI={key:0,class:"color-field"},jI={class:"color-swatches"},ZI=["title","onClick"],qI={key:0,class:"check"},WI={class:"custom-color-wrapper"},KI={class:"hex-popup-header"},JI={class:"hex-input-row"},YI=["disabled"],XI={key:0,class:"hex-error"},QI={class:"editor-footer"},ex={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=Se=>Se?Se.startsWith("/api")?ka+Se.substring(4):Se:"",s=Pn,i=e,r=o,u=M(null),d=om,h=M(!1),p=M(!1),g=M(null),y=M(!1),_=M(""),b=Se=>{typeof Se=="object"&&Se!==null?(y.value=Se.isPendingDelete,_.value=Se.displayUrl||"",r("logo-staged-change",Se.hasPendingChanges)):(g.value&&(y.value=g.value.isPendingDelete(),_.value=g.value.getDisplayUrl()||""),r("logo-staged-change",!!Se))},C=M(null),I=M(""),$=M(null),x=M(null),S=M({left:"50%",right:"auto",transform:"translateX(-50%)"}),B=Se=>Se?!s.some(J=>J.hex.toLowerCase()===Se.toLowerCase()):!1,E=Se=>!Se||!B(Se)?"#666666":Ru(Se),q=Se=>!Se||!B(Se)?"#e0e0e0":Se,P=U(()=>{if(!I.value)return!1;const Se=I.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Se)||/^[0-9A-Fa-f]{3}$/.test(Se)}),F=(Se,J)=>{if(C.value===Se)C.value=null;else{C.value=Se;let he="";switch(Se){case"headerStart":he=i.branding.headerGradientStart;break;case"headerEnd":he=i.branding.headerGradientEnd;break;case"pageStart":he=i.branding.pageGradientStart;break;case"pageEnd":he=i.branding.pageGradientEnd;break;case"accent":he=i.branding.accentColor;break}if(he&&B(he)?I.value=he.replace(/^#/,""):I.value="",J&&x.value){const xe=J.currentTarget,Ie=x.value,be=xe.getBoundingClientRect(),de=Ie.getBoundingClientRect(),fe=220,Z=12,W=be.left+be.width/2-de.left,ie=de.width,Ue=W-fe/2;W+fe/2>ie-Z?S.value={left:"auto",right:"0",transform:"none"}:Ue<Z?S.value={left:"0",right:"auto",transform:"none"}:S.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}sn(()=>$.value?.focus())}},R=()=>{I.value=I.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},j=()=>{if(!P.value||!C.value)return;let Se=I.value;Se.length===3&&(Se=Se[0]+Se[0]+Se[1]+Se[1]+Se[2]+Se[2]);const J="#"+Se;switch(C.value){case"headerStart":_e("start",J);break;case"headerEnd":X("headerGradientEnd",J);break;case"pageStart":Le("start",J);break;case"pageEnd":X("pageGradientEnd",J);break;case"accent":X("accentColor",J);break}C.value=null};Ze(u,Se=>{if(C.value=null,I.value="",Se==="header"){const J=i.branding.headerGradientStart||cn.headerGradientStart,he=i.branding.headerGradientEnd||cn.headerGradientEnd;h.value=J!==he}else if(Se==="page"){const J=i.branding.pageGradientStart||cn.pageGradientStart,he=i.branding.pageGradientEnd||cn.pageGradientEnd;p.value=J!==he}});const O={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},G=U(()=>i.branding.headerGradientStart||cn.headerGradientStart),Q=U(()=>i.branding.headerGradientEnd||cn.headerGradientEnd),se=U(()=>i.branding.accentColor||cn.accentColor),pe=U(()=>i.branding.pageGradientStart||cn.pageGradientStart),ee=U(()=>i.branding.pageGradientEnd||cn.pageGradientEnd),te=U(()=>i.branding.logoPosition||"left"),z=M(Date.now());Ze(()=>i.branding.logoUrl,()=>{z.value=Date.now(),y.value=!1,_.value=""});const Y=U(()=>y.value?!1:!!(_.value||i.branding.logoUrl)),ue=U(()=>{if(y.value)return"";if(_.value){if(_.value.startsWith("blob:"))return _.value;const he=a(_.value),xe=he.includes("?")?"&":"?";return`${he}${xe}_t=${z.value}`}if(!i.branding.logoUrl)return"";const Se=a(i.branding.logoUrl),J=Se.includes("?")?"&":"?";return`${Se}${J}_t=${z.value}`}),ke=U(()=>({background:`linear-gradient(135deg, ${G.value} 0%, ${Q.value} 100%)`})),Re=U(()=>sm(G.value,Q.value)),Ye=U(()=>({background:se.value,color:Ru(se.value)})),Ne=U(()=>({background:`linear-gradient(135deg, ${pe.value} 0%, ${ee.value} 100%)`}));function Ke(Se){u.value=u.value===Se?null:Se}function We(Se){!Y.value&&Se&&X("logoPosition",Se),Ke("logo")}function X(Se,J){r("update:branding",{...i.branding,[Se]:J})}function _e(Se,J){h.value?X("headerGradientStart",J):r("update:branding",{...i.branding,headerGradientStart:J,headerGradientEnd:J})}function Le(Se,J){p.value?X("pageGradientStart",J):r("update:branding",{...i.branding,pageGradientStart:J,pageGradientEnd:J})}function me(){if(!h.value){const Se=i.branding.headerGradientStart||cn.headerGradientStart;X("headerGradientEnd",Se)}}function ce(){if(!p.value){const Se=i.branding.pageGradientStart||cn.pageGradientStart;X("pageGradientEnd",Se)}}function N(Se){r("update:branding",NS(i.branding,Se)),u.value=null}async function K(){return g.value?await g.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ae(){return g.value?await g.value.deleteStagedLogo():{success:!0}}function Te(){return g.value?.hasPendingChanges()||!1}function Be(){return g.value?.isPendingDelete()||!1}function De(){g.value&&g.value.resetStagedState(),y.value=!1,_.value=""}return t({uploadStagedLogo:K,deleteStagedLogo:ae,hasLogoChanges:Te,isLogoPendingDelete:Be,resetLogo:De}),(Se,J)=>(v(),m("div",FS,[l("div",US,[J[32]||(J[32]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",zS,[(v(!0),m(Me,null,Fe(D(d),he=>(v(),m("button",{key:he.name,type:"button",class:"preset-btn",title:he.name,onClick:xe=>N(he)},[l("span",{class:"preset-preview",style:et({background:`linear-gradient(135deg, ${he.pageGradientStart} 0%, ${he.pageGradientEnd} 100%)`})},null,4),l("span",VS,w(he.name),1)],8,HS))),128))])]),l("div",GS,[l("div",{class:ve(["mockup-page",{"region-active":u.value==="page"}]),style:et(Ne.value),onClick:J[7]||(J[7]=he=>Ke("page"))},[l("div",{class:ve(["mockup-header",[{"region-active":u.value==="header"},Y.value?`logo-${te.value}`:"logo-none"]]),style:et(ke.value),onClick:J[5]||(J[5]=it(he=>Ke("header"),["stop"]))},[Y.value&&te.value==="cover"?(v(),m("div",jS,[l("img",{src:ue.value,alt:"Logo",class:"logo-cover-img"},null,8,ZS)])):A("",!0),Y.value&&te.value==="cover"?(v(),m("button",{key:1,type:"button",class:ve(["logo-cover-edit-btn",{"region-active":u.value==="logo"}]),onClick:J[0]||(J[0]=it(he=>Ke("logo"),["stop"])),title:"Edit logo"},[...J[33]||(J[33]=[l("span",null,"",-1)])],2)):A("",!0),Y.value&&te.value==="left"?(v(),m("div",{key:2,class:ve(["mockup-logo logo-left",{"region-active":u.value==="logo"}]),onClick:J[1]||(J[1]=it(he=>Ke("logo"),["stop"]))},[l("img",{src:ue.value,alt:"Logo",class:"logo-img"},null,8,qS)],2)):A("",!0),Y.value?A("",!0):(v(),m("div",{key:3,class:ve(["logo-add-area logo-add-left",{"region-active":u.value==="logo"}]),onClick:J[2]||(J[2]=it(he=>We("left"),["stop"]))},[...J[34]||(J[34]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),l("div",WS,[l("div",{class:"mockup-title",style:et({color:Re.value})},[l("span",KS,w(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:et({color:Re.value})},w(e.eventDate||"Event Date"),5),l("div",JS,[J[35]||(J[35]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:et({color:Re.value})},"Logout",4)])]),Y.value&&te.value==="right"?(v(),m("div",{key:4,class:ve(["mockup-logo logo-right",{"region-active":u.value==="logo"}]),onClick:J[3]||(J[3]=it(he=>Ke("logo"),["stop"]))},[l("img",{src:ue.value,alt:"Logo",class:"logo-img"},null,8,YS)],2)):A("",!0),Y.value?A("",!0):(v(),m("div",{key:5,class:ve(["logo-add-area logo-add-right",{"region-active":u.value==="logo"}]),onClick:J[4]||(J[4]=it(he=>We("right"),["stop"]))},[...J[36]||(J[36]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),l("div",XS,[l("div",QS,[J[37]||(J[37]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",eI,[l("div",{class:ve(["mockup-checkin-btn",{"region-active":u.value==="accent"}]),style:et(Ye.value),onClick:J[6]||(J[6]=it(he=>Ke("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),ze(l("div",{class:"editor-overlay",onClick:J[31]||(J[31]=it(he=>u.value=null,["self"]))},[l("div",{ref_key:"editorModalRef",ref:x,class:"editor-modal"},[l("div",tI,[l("span",null,w(O[u.value]),1),l("button",{type:"button",class:"editor-close",onClick:J[8]||(J[8]=he=>u.value=null)},"")]),l("div",nI,[u.value==="header"?(v(),m(Me,{key:0},[J[46]||(J[46]=l("p",{class:"editor-description"},"Choose the colour for the header.",-1)),l("div",oI,[l("div",sI,[l("label",null,w(h.value?"Start colour":"Colour"),1),l("div",aI,[(v(!0),m(Me,null,Fe(D(s),he=>(v(),m("button",{key:"hs-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientStart===he.hex}]),style:et({backgroundColor:he.hex}),title:he.name,onClick:xe=>_e("start",he.hex)},[e.branding.headerGradientStart===he.hex?(v(),m("span",lI,"")):A("",!0)],14,iI))),128)),l("div",rI,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.headerGradientStart)}]),style:et({backgroundColor:q(e.branding.headerGradientStart)}),title:"Custom colour",onClick:J[9]||(J[9]=he=>F("headerStart",he))},[(v(),m("svg",{class:"custom-icon",style:et({color:E(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...J[38]||(J[38]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="headerStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",cI,[J[39]||(J[39]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:J[10]||(J[10]=he=>C.value=null)},"")]),l("div",uI,[J[40]||(J[40]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":J[11]||(J[11]=he=>I.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!P.value}]),onInput:R,onKeydown:Jo(j,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:P.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!P.value,onClick:j}," Apply ",8,dI)]),I.value&&!P.value?(v(),m("span",hI,"Invalid hex code")):A("",!0)],4)):A("",!0)])]),l("label",fI,[ze(l("input",{type:"checkbox","onUpdate:modelValue":J[12]||(J[12]=he=>h.value=he),onChange:me},null,544),[[Gs,h.value]]),J[41]||(J[41]=l("span",null,"Use gradient",-1))])]),h.value?(v(),m("div",pI,[J[45]||(J[45]=l("label",null,"End colour",-1)),l("div",vI,[(v(!0),m(Me,null,Fe(D(s),he=>(v(),m("button",{key:"he-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientEnd===he.hex}]),style:et({backgroundColor:he.hex}),title:he.name,onClick:xe=>X("headerGradientEnd",he.hex)},[e.branding.headerGradientEnd===he.hex?(v(),m("span",gI,"")):A("",!0)],14,mI))),128)),l("div",yI,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.headerGradientEnd)}]),style:et({backgroundColor:q(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:J[13]||(J[13]=he=>F("headerEnd",he))},[(v(),m("svg",{class:"custom-icon",style:et({color:E(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...J[42]||(J[42]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="headerEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",kI,[J[43]||(J[43]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:J[14]||(J[14]=he=>C.value=null)},"")]),l("div",_I,[J[44]||(J[44]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":J[15]||(J[15]=he=>I.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!P.value}]),onInput:R,onKeydown:Jo(j,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:P.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!P.value,onClick:j}," Apply ",8,bI)]),I.value&&!P.value?(v(),m("span",wI,"Invalid hex code")):A("",!0)],4)):A("",!0)])])])):A("",!0)])],64)):A("",!0),u.value==="logo"?(v(),m("div",CI,[J[47]||(J[47]=l("label",{class:"editor-label"},"Position",-1)),l("div",LI,[l("button",{type:"button",class:ve(["position-btn",{selected:te.value==="left"}]),onClick:J[16]||(J[16]=he=>X("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:ve(["position-btn",{selected:te.value==="cover"}]),onClick:J[17]||(J[17]=he=>X("logoPosition","cover"))}," Cover ",2),l("button",{type:"button",class:ve(["position-btn",{selected:te.value==="right"}]),onClick:J[18]||(J[18]=he=>X("logoPosition","right"))}," Right ",2)])])):A("",!0),ze(Ee(RS,{ref_key:"logoUploaderRef",ref:g,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":J[19]||(J[19]=he=>X("logoUrl",he)),onStagedChange:b},null,8,["model-value","event-id","admin-email"]),[[ys,u.value==="logo"]]),u.value==="accent"?(v(),m(Me,{key:2},[J[51]||(J[51]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",SI,[(v(!0),m(Me,null,Fe(D(s),he=>(v(),m("button",{key:"ac-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.accentColor===he.hex}]),style:et({backgroundColor:he.hex}),title:he.name,onClick:xe=>X("accentColor",he.hex)},[e.branding.accentColor===he.hex?(v(),m("span",xI,"")):A("",!0)],14,II))),128)),l("div",$I,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.accentColor)}]),style:et({backgroundColor:q(e.branding.accentColor)}),title:"Custom colour",onClick:J[20]||(J[20]=he=>F("accent",he))},[(v(),m("svg",{class:"custom-icon",style:et({color:E(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...J[48]||(J[48]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="accent"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",TI,[J[49]||(J[49]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:J[21]||(J[21]=he=>C.value=null)},"")]),l("div",MI,[J[50]||(J[50]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":J[22]||(J[22]=he=>I.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!P.value}]),onInput:R,onKeydown:Jo(j,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:P.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!P.value,onClick:j}," Apply ",8,AI)]),I.value&&!P.value?(v(),m("span",EI,"Invalid hex code")):A("",!0)],4)):A("",!0)])])],64)):A("",!0),u.value==="page"?(v(),m(Me,{key:3},[J[60]||(J[60]=l("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),l("div",PI,[l("div",DI,[l("label",null,w(p.value?"Start colour":"Colour"),1),l("div",OI,[(v(!0),m(Me,null,Fe(D(s),he=>(v(),m("button",{key:"ps-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientStart===he.hex}]),style:et({backgroundColor:he.hex}),title:he.name,onClick:xe=>Le("start",he.hex)},[e.branding.pageGradientStart===he.hex?(v(),m("span",BI,"")):A("",!0)],14,RI))),128)),l("div",NI,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.pageGradientStart)}]),style:et({backgroundColor:q(e.branding.pageGradientStart)}),title:"Custom colour",onClick:J[23]||(J[23]=he=>F("pageStart",he))},[(v(),m("svg",{class:"custom-icon",style:et({color:E(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...J[52]||(J[52]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="pageStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",FI,[J[53]||(J[53]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:J[24]||(J[24]=he=>C.value=null)},"")]),l("div",UI,[J[54]||(J[54]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":J[25]||(J[25]=he=>I.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!P.value}]),onInput:R,onKeydown:Jo(j,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:P.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!P.value,onClick:j}," Apply ",8,zI)]),I.value&&!P.value?(v(),m("span",HI,"Invalid hex code")):A("",!0)],4)):A("",!0)])]),l("label",VI,[ze(l("input",{type:"checkbox","onUpdate:modelValue":J[26]||(J[26]=he=>p.value=he),onChange:ce},null,544),[[Gs,p.value]]),J[55]||(J[55]=l("span",null,"Use gradient",-1))])]),p.value?(v(),m("div",GI,[J[59]||(J[59]=l("label",null,"End colour",-1)),l("div",jI,[(v(!0),m(Me,null,Fe(D(s),he=>(v(),m("button",{key:"pe-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientEnd===he.hex}]),style:et({backgroundColor:he.hex}),title:he.name,onClick:xe=>X("pageGradientEnd",he.hex)},[e.branding.pageGradientEnd===he.hex?(v(),m("span",qI,"")):A("",!0)],14,ZI))),128)),l("div",WI,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.pageGradientEnd)}]),style:et({backgroundColor:q(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:J[27]||(J[27]=he=>F("pageEnd",he))},[(v(),m("svg",{class:"custom-icon",style:et({color:E(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...J[56]||(J[56]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="pageEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",KI,[J[57]||(J[57]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:J[28]||(J[28]=he=>C.value=null)},"")]),l("div",JI,[J[58]||(J[58]=l("span",{class:"hex-prefix"},"#",-1)),ze(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":J[29]||(J[29]=he=>I.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:I.value&&!P.value}]),onInput:R,onKeydown:Jo(j,["enter"])},null,34),[[tt,I.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:P.value?"#"+I.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!P.value,onClick:j}," Apply ",8,YI)]),I.value&&!P.value?(v(),m("span",XI,"Invalid hex code")):A("",!0)],4)):A("",!0)])])])):A("",!0)])],64)):A("",!0)]),l("div",QI,[l("button",{type:"button",class:"btn-done",onClick:J[30]||(J[30]=he=>u.value=null)},"Done")])],512)],512),[[ys,u.value]]),J[61]||(J[61]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},tx=Ge(ex,[["__scopeId","data-v-01af4f2d"]]),nx={class:"settings-tab"},ox={class:"accordion"},sx={class:"accordion-section"},ax={class:"accordion-title"},ix={class:"accordion-icon"},lx={key:0,class:"accordion-content"},rx={class:"accordion-section"},cx={class:"accordion-icon"},ux={key:0,class:"accordion-content"},dx={class:"terminology-grid"},hx={class:"term-group"},fx=["value"],px={class:"term-group"},vx=["value"],mx={class:"term-group"},gx=["value"],yx={class:"term-group"},kx=["value"],_x={class:"term-group"},bx=["value"],wx={class:"form-actions"},Cx=["disabled"],Lx={class:"accordion-section"},Sx={class:"accordion-title"},Ix={class:"accordion-icon"},xx={key:0,class:"accordion-content"},$x={class:"section-description"},Tx={class:"form-actions"},Mx=["disabled"],Ax={class:"accordion-section"},Ex={class:"accordion-title"},Px={class:"accordion-icon"},Dx={key:0,class:"accordion-content"},Ox={class:"section-description"},Rx={class:"form-actions"},Bx=["disabled"],Nx=["disabled"],vf="admin_settings_accordion",Fx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=Yl(),i=U(()=>s.adminEmail||""),r=e,u=t,d=M({...r.eventData}),h=M(null),p=M(!1),g=()=>r.eventId?`${vf}_${r.eventId}`:vf,y=M(null);Qt(()=>{const P=localStorage.getItem(g());P&&(y.value=P)});const _=U(()=>{const P=d.value.peopleTerm||"Marshals";return Bs.checkpoint.map(F=>({value:F,label:Mu(F,P)}))}),b=P=>{const F=y.value===P?null:P;y.value=F,F?localStorage.setItem(g(),F):localStorage.removeItem(g())};Ze(()=>r.eventData,P=>{d.value={...P},x.value=!1},{deep:!0});const C=()=>{u("update:formDirty",!0)},I=(P,F)=>{d.value[P]=F,C()},$=U(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),x=M(!1),S=P=>{x.value=P},B=P=>{d.value.brandingHeaderGradientStart=P.headerGradientStart,d.value.brandingHeaderGradientEnd=P.headerGradientEnd,d.value.brandingLogoUrl=P.logoUrl,d.value.brandingLogoPosition=P.logoPosition,d.value.brandingAccentColor=P.accentColor,d.value.brandingPageGradientStart=P.pageGradientStart,d.value.brandingPageGradientEnd=P.pageGradientEnd,C()},E=()=>{BS(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",x.value=!1,h.value?.resetLogo(),C()},q=async()=>{if(!p.value){p.value=!0;try{if(x.value&&h.value){if(h.value.isLogoPendingDelete()){const F=await h.value.deleteStagedLogo();if(!F.success){console.error("Failed to delete logo:",F.error);return}d.value.brandingLogoUrl=""}else{const F=await h.value.uploadStagedLogo();if(!F.success){console.error("Failed to upload logo:",F.error);return}F.logoUrl&&!F.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=F.logoUrl)}x.value=!1}u("submit",{...d.value})}finally{p.value=!1}}};return(P,F)=>(v(),m("div",nx,[l("div",ox,[l("div",sx,[l("button",{class:ve(["accordion-header",{active:y.value==="admins"}]),onClick:F[0]||(F[0]=R=>b("admins"))},[l("span",ax,"Administrators ("+w(e.admins.length)+")",1),l("span",ix,w(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(v(),m("div",lx,[Ee(V2,{admins:e.admins,onAddAdmin:F[1]||(F[1]=R=>P.$emit("add-admin")),onRemoveAdmin:F[2]||(F[2]=R=>P.$emit("remove-admin",R))},null,8,["admins"])])):A("",!0)]),l("div",rx,[l("button",{class:ve(["accordion-header",{active:y.value==="terminology"}]),onClick:F[3]||(F[3]=R=>b("terminology"))},[F[19]||(F[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",cx,w(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(v(),m("div",ux,[F[20]||(F[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",dx,[l("div",hx,[l("label",null,w(D(o).people)+" are called",1),ze(l("select",{"onUpdate:modelValue":F[4]||(F[4]=R=>d.value.peopleTerm=R),class:"form-input",onChange:C},[(v(!0),m(Me,null,Fe(D(Bs).people,R=>(v(),m("option",{key:R,value:R},w(R),9,fx))),128))],544),[[Fn,d.value.peopleTerm]])]),l("div",px,[l("label",null,w(D(o).checkpoints)+" are called",1),ze(l("select",{"onUpdate:modelValue":F[5]||(F[5]=R=>d.value.checkpointTerm=R),class:"form-input",onChange:C},[(v(!0),m(Me,null,Fe(_.value,R=>(v(),m("option",{key:R.value,value:R.value},w(R.label),9,vx))),128))],544),[[Fn,d.value.checkpointTerm]])]),l("div",mx,[l("label",null,w(D(o).areas)+" are called",1),ze(l("select",{"onUpdate:modelValue":F[6]||(F[6]=R=>d.value.areaTerm=R),class:"form-input",onChange:C},[(v(!0),m(Me,null,Fe(D(Bs).area,R=>(v(),m("option",{key:R,value:R},w(R),9,gx))),128))],544),[[Fn,d.value.areaTerm]])]),l("div",yx,[l("label",null,w(D(o).checklists)+" are called",1),ze(l("select",{"onUpdate:modelValue":F[7]||(F[7]=R=>d.value.checklistTerm=R),class:"form-input",onChange:C},[(v(!0),m(Me,null,Fe(D(Bs).checklist,R=>(v(),m("option",{key:R,value:R},w(R),9,kx))),128))],544),[[Fn,d.value.checklistTerm]])]),l("div",_x,[l("label",null,w(D(o).course)+" is called",1),ze(l("select",{"onUpdate:modelValue":F[8]||(F[8]=R=>d.value.courseTerm=R),class:"form-input",onChange:C},[(v(!0),m(Me,null,Fe(D(Bs).course,R=>(v(),m("option",{key:R,value:R},w(R),9,bx))),128))],544),[[Fn,d.value.courseTerm]])])]),l("div",wx,[l("button",{onClick:q,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Cx)])])):A("",!0)]),l("div",Lx,[l("button",{class:ve(["accordion-header",{active:y.value==="appearance"}]),onClick:F[9]||(F[9]=R=>b("appearance"))},[l("span",Sx,w(D(o).checkpoint)+" appearance",1),l("span",Ix,w(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(v(),m("div",xx,[l("p",$x," Set the default marker style for all "+w(D(a).checkpoints)+" in this event. Individual "+w(D(a).areas)+" and "+w(D(a).checkpoints)+" can override this setting. ",1),Ee(hd,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":F[10]||(F[10]=R=>I("defaultCheckpointStyleType",R)),"onUpdate:styleColor":F[11]||(F[11]=R=>I("defaultCheckpointStyleColor",R)),"onUpdate:styleBackgroundShape":F[12]||(F[12]=R=>I("defaultCheckpointStyleBackgroundShape",R)),"onUpdate:styleBackgroundColor":F[13]||(F[13]=R=>I("defaultCheckpointStyleBackgroundColor",R)),"onUpdate:styleBorderColor":F[14]||(F[14]=R=>I("defaultCheckpointStyleBorderColor",R)),"onUpdate:styleIconColor":F[15]||(F[15]=R=>I("defaultCheckpointStyleIconColor",R)),"onUpdate:styleSize":F[16]||(F[16]=R=>I("defaultCheckpointStyleSize",R)),"onUpdate:styleMapRotation":F[17]||(F[17]=R=>I("defaultCheckpointStyleMapRotation",R))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",Tx,[l("button",{onClick:q,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Mx)])])):A("",!0)]),l("div",Ax,[l("button",{class:ve(["accordion-header",{active:y.value==="branding"}]),onClick:F[18]||(F[18]=R=>b("branding"))},[l("span",Ex,w(D(o).person)+" branding",1),l("span",Px,w(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(v(),m("div",Dx,[l("p",Ox," Customise the appearance of the "+w(D(a).person)+" view to match your organisation's branding. ",1),Ee(tx,{ref_key:"brandingMockupRef",ref:h,branding:$.value,"event-name":d.value.name,"event-date":D(Xv)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":B,onLogoStagedChange:S},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",Rx,[l("button",{onClick:E,class:"btn btn-secondary",disabled:p.value}," Reset to default ",8,Bx),l("button",{onClick:q,class:"btn btn-primary",disabled:!e.formDirty&&!x.value||p.value},w(p.value?"Saving...":"Save"),9,Nx)])])):A("",!0)])])]))}},Ux=Ge(Fx,[["__scopeId","data-v-bb7e241a"]]),zx={class:"incident-header"},Hx={class:"incident-title-row"},Vx={class:"incident-title"},Gx={class:"incident-badges"},jx={key:0,class:"incident-description"},Zx={class:"incident-context"},qx={key:0,class:"context-item"},Wx={key:1,class:"context-item"},Kx={key:2,class:"context-item"},Jx={class:"incident-footer"},Yx={class:"reporter-info"},Xx={class:"time-info"},Qx={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=U(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",r=u=>{if(!u)return"";const d=new Date(u),p=new Date-d,g=Math.floor(p/6e4),y=Math.floor(p/36e5),_=Math.floor(p/864e5);return g<1?"just now":g<60?`${g}m ago`:y<24?`${y}h ago`:_<7?`${_}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:ve(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>u.$emit("select",e.incident))},[l("div",zx,[l("div",Hx,[l("span",{class:ve(["severity-indicator",e.incident.severity])},null,2),l("strong",Vx,w(o.value),1)]),l("div",Gx,[l("span",{class:ve(["severity-badge",e.incident.severity])},w(a(e.incident.severity)),3),l("span",{class:ve(["status-badge",e.incident.status])},w(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",jx,w(i(e.incident.description)),1)):A("",!0),l("div",Zx,[e.incident.context?.checkpoint?(v(),m("div",qx,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",Wx,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):A("",!0),e.incident.area?(v(),m("div",Kx,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.area.areaName),1)])):A("",!0)]),l("div",Jx,[l("span",Yx," Reported by "+w(e.incident.reportedBy?.name||"Unknown"),1),l("span",Xx,w(r(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},er=Ge(Qx,[["__scopeId","data-v-690fd385"]]),e$={class:"incidents-tab"},t$={class:"tab-header"},n$={class:"button-group"},o$={key:0,class:"status-pills"},s$={class:"filters-section"},a$={class:"search-group"},i$={class:"incidents-list"},l$={key:0,class:"loading-state"},r$={key:1,class:"empty-state"},c$={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=M(""),s=M("all"),i=y=>{s.value=y},r=U(()=>o.incidents.filter(y=>y.status==="open").length),u=U(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=U(()=>o.incidents.filter(y=>y.status==="resolved").length),h=U(()=>o.incidents.filter(y=>y.status==="closed").length),p=U(()=>{let y=o.incidents;if(s.value==="open"?y=y.filter(_=>_.status==="open"):s.value==="in-progress"?y=y.filter(_=>_.status==="in_progress"||_.status==="acknowledged"):s.value==="resolved"?y=y.filter(_=>_.status==="resolved"):s.value==="closed"&&(y=y.filter(_=>_.status==="closed")),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(b=>{const C=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,I=b.area?.areaName||"",$=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map(B=>B.name||"")].join(" "),x=(b.updates||[]).map(B=>B.note||"").join(" "),S=`${b.title||""} ${b.description||""} ${C} ${I} ${$} ${x}`.toLowerCase();return _.every(B=>S.includes(B))})}return y}),g=U(()=>[...p.value].sort((y,_)=>new Date(_.incidentTime||_.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,_)=>(v(),m("div",e$,[l("div",t$,[l("div",n$,[l("button",{onClick:_[0]||(_[0]=b=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",o$,[Ee(In,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=b=>i("all"))},{default:He(()=>[Qe(w(e.incidents.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(In,{key:0,variant:"info",active:s.value==="open",onClick:_[2]||(_[2]=b=>i("open"))},{default:He(()=>[Qe(w(r.value)+" open ",1)]),_:1},8,["active"])):A("",!0),u.value>0?(v(),qe(In,{key:1,variant:"purple",active:s.value==="in-progress",onClick:_[3]||(_[3]=b=>i("in-progress"))},{default:He(()=>[Qe(w(u.value)+" in progress ",1)]),_:1},8,["active"])):A("",!0),d.value>0?(v(),qe(In,{key:2,variant:"success",active:s.value==="resolved",onClick:_[4]||(_[4]=b=>i("resolved"))},{default:He(()=>[Qe(w(d.value)+" resolved ",1)]),_:1},8,["active"])):A("",!0),h.value>0?(v(),qe(In,{key:3,variant:"neutral",active:s.value==="closed",onClick:_[5]||(_[5]=b=>i("closed"))},{default:He(()=>[Qe(w(h.value)+" closed ",1)]),_:1},8,["active"])):A("",!0)])):A("",!0)]),l("div",s$,[l("div",a$,[ze(l("input",{"onUpdate:modelValue":_[6]||(_[6]=b=>a.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[tt,a.value]])])]),l("div",i$,[e.loading?(v(),m("div",l$," Loading incidents... ")):p.value.length===0?(v(),m("div",r$,[l("p",null,w(a.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):A("",!0),(v(!0),m(Me,null,Fe(g.value,b=>(v(),qe(er,{key:b.incidentId,incident:b,onSelect:C=>y.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},u$=Ge(c$,[["__scopeId","data-v-56bde653"]]),d$={class:"checkpoint-card-header"},h$={class:"checkpoint-name-row"},f$=["innerHTML"],p$={class:"checkpoint-name"},v$={key:0,class:"checkpoint-description"},m$={key:0,class:"checkpoint-card-areas"},g$={class:"checkpoint-card-stats"},y$={key:1,class:"checkpoint-card-marshals"},k$={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=I=>{const $=o.areas.find(x=>x.id===I);return $?$.name:null},r=I=>{const $=o.areas.find(x=>x.id===I);return $?$.color:"#999"},u=U(()=>{const I=o.checkpoint,$=I.resolvedStyleBackgroundColor||I.ResolvedStyleBackgroundColor||I.resolvedStyleColor||I.ResolvedStyleColor;return $||(s.value.length>0?r(s.value[0]):"#667eea")}),d=U(()=>{const I=o.checkpoint;return I.requiredMarshals===0?null:I.checkedInCount>=I.requiredMarshals?"full":I.checkedInCount>0?"partial":"none"}),h=U(()=>[...o.checkpoint.assignments||[]].sort(($,x)=>($.marshalName||"").localeCompare(x.marshalName||"",void 0,{sensitivity:"base"}))),p=U(()=>(o.checkpoint.assignments||[]).length),g=U(()=>(o.checkpoint.assignments||[]).filter(I=>I.isCheckedIn).length),y=U(()=>d.value?`staffing-${d.value}`:""),_=U(()=>{const I=p.value,$=g.value;return I===0?"":$===0?"checkin-none":$>=I?"checkin-full":"checkin-partial"}),b=U(()=>{const I=o.checkpoint,$=I.resolvedStyleType||I.ResolvedStyleType,x=I.resolvedStyleBackgroundColor||I.ResolvedStyleBackgroundColor||I.resolvedStyleColor||I.ResolvedStyleColor,S=I.resolvedStyleBorderColor||I.ResolvedStyleBorderColor,B=I.resolvedStyleIconColor||I.ResolvedStyleIconColor,E=I.resolvedStyleBackgroundShape||I.ResolvedStyleBackgroundShape;return $&&$!=="default"||x||S||B||E&&E!=="circle"?Sn({type:$||"circle",backgroundShape:E||"circle",backgroundColor:x||"#667eea",borderColor:S||"#ffffff",iconColor:B||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),C=()=>{o.clickable&&a("click",o.checkpoint)};return(I,$)=>(v(),m("div",{class:ve(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:et({borderLeftColor:u.value}),onClick:C},[l("div",d$,[l("div",{class:ve(["checkpoint-card-title",{clickable:e.clickable}])},[l("span",h$,[l("span",{class:"checkpoint-icon",innerHTML:b.value},null,8,f$),l("span",p$,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",v$,"  "+w(e.checkpoint.description),1)):A("",!0)])],2)]),s.value.length>0?(v(),m("div",m$,[(v(!0),m(Me,null,Fe(s.value,x=>(v(),m("span",{key:x,class:"area-badge",style:et({backgroundColor:r(x)})},w(i(x)),5))),128))])):A("",!0),l("div",g$,[l("span",{class:ve(["stat-badge staffing-badge",y.value])},w(e.checkpoint.checkedInCount)+"/"+w(e.checkpoint.requiredMarshals)+" staffed ",3),p.value>0?(v(),m("span",{key:0,class:ve(["stat-badge",_.value])},w(g.value)+"/"+w(p.value)+" checked in ",3)):A("",!0)]),h.value.length>0?(v(),m("div",y$,[(v(!0),m(Me,null,Fe(h.value,x=>(v(),m("span",{key:x.id,class:ve(["marshal-badge",{"checked-in":x.isCheckedIn}])},w(x.marshalName),3))),128))])):A("",!0)],6))}},_$=Ge(k$,[["__scopeId","data-v-da001590"]]),am={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(Ql,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:He(()=>[(v(!0),m(Me,null,Fe(e.checkpoints,a=>(v(),qe(_$,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},b$={class:"checkpoints-tab"},w$={class:"tab-header"},C$={class:"button-group"},L$={key:0,class:"status-pills"},S$={class:"filters-section"},I$={class:"search-group"},x$=["placeholder"],$$={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ct(),o=e,a=M(""),s=M("all"),i=_=>{s.value=_},r=U(()=>o.locations.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0).length),u=U(()=>o.locations.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals).length),d=U(()=>o.locations.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0).length),h=_=>{const b=o.areas.find(C=>C.id===_);return b?b.name:null},p=U(()=>{let _=o.locations;if(s.value==="full"?_=_.filter(b=>b.checkedInCount>=b.requiredMarshals&&b.requiredMarshals>0):s.value==="partial"?_=_.filter(b=>b.checkedInCount>0&&b.checkedInCount<b.requiredMarshals):s.value==="missing"&&(_=_.filter(b=>b.checkedInCount===0&&b.requiredMarshals>0)),a.value.trim()){const b=a.value.toLowerCase().trim().split(/\s+/);_=_.filter(C=>{const $=(C.areaIds||C.AreaIds||[]).map(B=>h(B)||"").join(" "),x=(C.assignments||[]).map(B=>B.marshalName||"").join(" "),S=`${C.name||""} ${C.description||""} ${$} ${x}`.toLowerCase();return b.every(B=>S.includes(B))})}return _}),g=U(()=>[...p.value].sort((_,b)=>js(_.name,b.name))),y=U(()=>{const _=a.value.trim();return s.value==="full"?_?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?_?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?_?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:_?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(_,b)=>(v(),m("div",b$,[l("div",w$,[l("div",C$,[l("button",{onClick:b[0]||(b[0]=C=>_.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+w(D(t).checkpoint),1),l("button",{onClick:b[1]||(b[1]=C=>_.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",L$,[Ee(In,{variant:"neutral",active:s.value==="all",onClick:b[2]||(b[2]=C=>i("all"))},{default:He(()=>[Qe(w(e.locations.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(In,{key:0,variant:"success",active:s.value==="full",onClick:b[3]||(b[3]=C=>i("full"))},{default:He(()=>[Qe(w(r.value)+" fully staffed ",1)]),_:1},8,["active"])):A("",!0),u.value>0?(v(),qe(In,{key:1,variant:"warning",active:s.value==="partial",onClick:b[4]||(b[4]=C=>i("partial"))},{default:He(()=>[Qe(w(u.value)+" partial ",1)]),_:1},8,["active"])):A("",!0),d.value>0?(v(),qe(In,{key:2,variant:"danger",active:s.value==="missing",onClick:b[5]||(b[5]=C=>i("missing"))},{default:He(()=>[Qe(w(d.value)+" unstaffed ",1)]),_:1},8,["active"])):A("",!0)])):A("",!0)]),l("div",S$,[l("div",I$,[ze(l("input",{"onUpdate:modelValue":b[6]||(b[6]=C=>a.value=C),type:"text",class:"search-input",placeholder:`Search by name, description, ${D(t).area}, or ${D(t).person}...`},null,8,x$),[[tt,a.value]])])]),Ee(am,{checkpoints:g.value,areas:e.areas,"empty-message":y.value,onSelect:b[7]||(b[7]=C=>_.$emit("select-location",C))},null,8,["checkpoints","areas","empty-message"])]))}},T$=Ge($$,[["__scopeId","data-v-35be2364"]]),M$={class:"area-card-header"},A$={class:"area-name-row"},E$={class:"area-name"},P$={key:0,class:"default-badge"},D$={key:0,class:"area-description"},O$={class:"area-card-stats"},R$={class:"stat-badge"},B$={class:"stat-badge"},N$={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(o.area.id)||p.areaId===o.area.id).length),i=U(()=>o.contacts.filter(p=>p.scopeConfigurations?p.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),r=U(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=U(()=>{const p=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?ei("checkpoint",p,r.value):Kv("checkpoint",p,r.value)}),d=U(()=>`${s.value} ${u.value.toLowerCase()}`),h=()=>{o.clickable&&a("click",o.area)};return(p,g)=>(v(),m("div",{class:ve(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:et({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[l("div",M$,[l("div",{class:ve(["area-card-title",{clickable:e.clickable}])},[l("div",A$,[l("span",E$,w(e.area.name),1),e.area.isDefault?(v(),m("span",P$,"Default")):A("",!0)]),e.area.description?(v(),m("span",D$,w(e.area.description),1)):A("",!0)],2)]),l("div",O$,[l("span",R$,w(d.value),1),l("span",B$,w(i.value)+" contact"+w(i.value===1?"":"s"),1)])],6))}},F$=Ge(N$,[["__scopeId","data-v-8ac20bf2"]]),U$={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(Ql,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:He(()=>[(v(!0),m(Me,null,Fe(e.areas,a=>(v(),qe(F$,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},z$={class:"areas-tab"},H$={class:"tab-header"},V$={class:"button-group"},G$={key:0,class:"status-pills"},j$={class:"filters-section"},Z$={class:"search-group"},q$=["placeholder"],W$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ct(),o=e,a=M(""),s=d=>o.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=U(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(h=>{const g=s(h.id).map(_=>`${_.name||""} ${_.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${g}`.toLowerCase();return d.every(_=>y.includes(_))})}),r=U(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:js(d.name,h.name))),u=U(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(v(),m("div",z$,[l("div",H$,[l("div",V$,[l("button",{onClick:h[0]||(h[0]=p=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+w(D(t).area),1)]),e.areas.length>0?(v(),m("div",G$,[Ee(In,{variant:"neutral",active:!1},{default:He(()=>[Qe(w(e.areas.length)+" "+w(e.areas.length===1?D(t).area:D(t).areas),1)]),_:1})])):A("",!0)]),l("div",j$,[l("div",Z$,[ze(l("input",{"onUpdate:modelValue":h[1]||(h[1]=p=>a.value=p),type:"text",class:"search-input",placeholder:`Search by ${D(t).area} name or ${D(t).checkpoint} name...`},null,8,q$),[[tt,a.value]])])]),Ee(U$,{areas:r.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:h[2]||(h[2]=p=>d.$emit("select-area",p))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},K$=Ge(W$,[["__scopeId","data-v-203f9606"]]),J$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Yn=e=>J$[e]||"",Y$={class:"responsive-tabs"},X$=["onClick"],Q$=["innerHTML"],eT=["innerHTML"],tT={class:"hamburger-label"},nT=["onClick"],oT=["innerHTML"],sT={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(null),r=M(null),u=M(!1),d=M({}),h=M(!1),p=U(()=>o.tabs.find($=>$.value===o.modelValue)),g=U(()=>p.value?p.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&i.value){const $=i.value.getBoundingClientRect();d.value={top:`${$.bottom+4}px`}}},_=$=>{a("update:modelValue",$),u.value=!1},b=$=>{if(!s.value)return;const x=s.value.contains($.target);u.value&&!x&&(u.value=!1)},C=()=>{if(!r.value)return;const $=r.value,x=h.value;x&&($.style.visibility="visible",$.style.position="static");const S=$.scrollWidth>$.clientWidth;x&&($.style.visibility="",$.style.position=""),h.value=S};let I=null;return Qt(()=>{document.addEventListener("click",b),sn(()=>{C()}),sn(()=>{const $=r.value?.parentElement;$&&(I=new ResizeObserver(()=>{C()}),I.observe($))})}),kn(()=>{document.removeEventListener("click",b),I&&I.disconnect()}),Ze(()=>o.tabs,()=>{sn(()=>{C()})},{deep:!0}),($,x)=>(v(),m("div",Y$,[l("div",{ref_key:"visibleTabsRef",ref:r,class:ve(["visible-tabs",{"is-hidden":h.value}])},[(v(!0),m(Me,null,Fe(e.tabs,S=>(v(),m("button",{key:S.value,class:ve(["tab-button",{active:e.modelValue===S.value}]),onClick:B=>$.$emit("update:modelValue",S.value),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Yn)(S.icon)},null,8,Q$)):A("",!0),Qe(" "+w(S.label),1)],10,X$))),128))],2),l("div",{class:ve(["hamburger-only",{"is-visible":h.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:i,class:ve(["hamburger-button",{active:u.value}]),onClick:it(y,["stop"]),type:"button"},[x[1]||(x[1]=l("span",{class:"hamburger-icon"},"",-1)),p.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Yn)(p.value.icon)},null,8,eT)):A("",!0),l("span",tT,w(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:et(d.value),onClick:x[0]||(x[0]=it(()=>{},["stop"]))},[(v(!0),m(Me,null,Fe(e.tabs,S=>(v(),m("button",{key:S.value,class:ve(["dropdown-item",{active:e.modelValue===S.value}]),onClick:it(B=>_(S.value),["stop"]),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Yn)(S.icon)},null,8,oT)):A("",!0),Qe(" "+w(S.label),1)],10,nT))),128))],4)):A("",!0)],512)],2)]))}},aT=Ge(sT,[["__scopeId","data-v-2467c6fc"]]),iT={class:"instruction"},lT={class:"share-link-container"},rT=["value"],cT={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=t,i=M(!1),r=M(null),u=()=>{r.value&&(r.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{s("close")};return(h,p)=>(v(),qe(Gt,{show:e.show,title:`${D(o).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:He(()=>[l("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:He(()=>[l("p",iT,"Share this link with "+w(D(a).peoplePlural)+" so they can check in:",1),l("div",lT,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:r},null,8,rT),l("button",{onClick:u,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},uT=Ge(cT,[["__scopeId","data-v-b037c39b"]]),dT={class:"success-content"},hT={class:"success-message"},fT={class:"link-section"},pT={class:"help-text"},vT={key:0,class:"loading-text"},mT={key:1,class:"magic-link-container"},gT=["value"],yT={class:"magic-link-actions"},kT=["disabled"],_T={key:0,class:"success-text"},bT={key:1,class:"error-text"},wT={key:2,class:"error-text"},CT={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,s=t,i=M(""),r=M(!1),u=M(!1),d=M(""),h=M(!1),p=M(!1),g=M(!1),y=M(""),_=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const $=await gs.getMagicLink(a.eventId,a.marshalId);i.value=$.data.magicLink,r.value=$.data.hasEmail}catch($){console.error("Failed to fetch magic link:",$),d.value="Failed to load login link"}finally{u.value=!1}}},b=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const $=document.createElement("textarea");$.value=i.value,$.style.position="fixed",$.style.left="-9999px",document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch($){console.error("Failed to copy:",$)}},C=async()=>{if(!(!a.eventId||!a.marshalId)){p.value=!0,g.value=!1,y.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch($){console.error("Failed to send email:",$),y.value=$.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},I=()=>{s("close")};return Ze(()=>a.show,$=>{$&&a.marshalId?_():(i.value="",r.value=!1,d.value="",h.value=!1,g.value=!1,y.value="")},{immediate:!0}),($,x)=>(v(),qe(Gt,{show:e.show,title:`${D(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:I},{actions:He(()=>[l("button",{onClick:I,class:"btn btn-primary"},"Done")]),default:He(()=>[l("div",dT,[x[2]||(x[2]=l("div",{class:"success-icon"},"",-1)),l("p",hT,[l("strong",null,w(e.marshalName),1),x[1]||(x[1]=Qe(" has been added successfully. ",-1))])]),l("div",fT,[x[3]||(x[3]=l("label",null,"Login link",-1)),l("p",pT," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",vT,"Loading link...")):i.value?(v(),m("div",mT,[l("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:x[0]||(x[0]=S=>S.target.select())},null,40,gT),l("div",yT,[l("button",{type:"button",class:"btn btn-secondary",onClick:b},w(h.value?"Copied!":"Copy link"),1),r.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:C},w(p.value?"Sending...":"Send via email"),9,kT)):A("",!0)]),g.value?(v(),m("p",_T,"Email sent successfully!")):A("",!0),y.value?(v(),m("p",bT,w(y.value),1)):A("",!0)])):d.value?(v(),m("div",wT,w(d.value),1)):A("",!0)])]),_:1},8,["show","title"]))}},LT=Ge(CT,[["__scopeId","data-v-e99677e9"]]),ST={class:"form-group"},IT={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M("");Ze(()=>o.show,d=>{d||(s.value="")});const i=()=>{a("update:isDirty",!0)},r=()=>{a("submit",s.value)},u=()=>{a("close")};return(d,h)=>(v(),qe(Gt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:He(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary"}," Add administrator ")]),default:He(()=>[h[2]||(h[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",ST,[h[1]||(h[1]=l("label",null,"Email address",-1)),ze(l("input",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[tt,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},xT=Ge(IT,[["__scopeId","data-v-a82da194"]]),$T={class:"form-group"},TT={key:0,class:"error"},MT=["disabled"],AT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M(null);Ze(()=>o.show,d=>{d||(s.value=null)});const i=d=>{s.value=d.target.files[0],a("update:isDirty",!0)},r=()=>{s.value&&a("submit",s.value)},u=()=>{a("close")};return(d,h)=>(v(),qe(Gt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:He(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,MT)]),default:He(()=>[h[1]||(h[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",$T,[h[0]||(h[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",TT,w(e.error),1)):A("",!0)],32)]),_:1},8,["show","is-dirty"]))}},ET=Ge(AT,[["__scopeId","data-v-317975db"]]),PT={class:"instruction"},DT={class:"form-group"},OT={class:"form-group"},RT={class:"checkbox-label"},BT={key:0,class:"error"},NT={key:1,class:"import-result"},FT={key:0,class:"import-errors"},UT=["disabled"],zT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=e,i=t,r=M(null),u=M(!1);Ze(()=>s.show,y=>{y||(r.value=null,u.value=!1)});const d=y=>{r.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},p=()=>{r.value&&i("submit",{file:r.value,deleteExisting:u.value})},g=()=>{i("close")};return(y,_)=>(v(),qe(Gt,{show:e.show,title:`Import ${D(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:He(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${D(a).checkpoints}`),9,UT)]),default:He(()=>[l("p",PT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(D(o).people)+" (optional)",1),_[3]||(_[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:it(p,["prevent"])},[l("div",DT,[_[1]||(_[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",OT,[l("label",RT,[ze(l("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=b=>u.value=b),onChange:h},null,544),[[Gs,u.value]]),Qe(" Delete existing "+w(D(a).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",BT,w(e.error),1)):A("",!0),e.result?(v(),m("div",NT,[l("p",null,"Created "+w(e.result.locationsCreated)+" "+w(D(a).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",FT,[_[2]||(_[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Me,null,Fe(e.result.errors,(b,C)=>(v(),m("li",{key:C},w(b),1))),128))])])):A("",!0)])):A("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},HT=Ge(zT,[["__scopeId","data-v-75c79d31"]]),VT={class:"instruction"},GT={class:"form-group"},jT={key:0,class:"error"},ZT={key:1,class:"import-result"},qT={key:0,class:"import-errors"},WT=["disabled"],KT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=e,i=t,r=M(null);Ze(()=>s.show,p=>{p||(r.value=null)});const u=p=>{r.value=p.target.files[0],i("update:isDirty",!0)},d=()=>{r.value&&i("submit",r.value)},h=()=>{i("close")};return(p,g)=>(v(),qe(Gt,{show:e.show,title:`Import ${D(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:He(()=>[l("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${D(a).people}`),9,WT)]),default:He(()=>[l("p",VT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(D(o).checkpoint)+" (optional)",1),g[2]||(g[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:it(d,["prevent"])},[l("div",GT,[g[0]||(g[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",jT,w(e.error),1)):A("",!0),e.result?(v(),m("div",ZT,[l("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(D(a).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",qT,[g[1]||(g[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Me,null,Fe(e.result.errors,(y,_)=>(v(),m("li",{key:_},w(y),1))),128))])])):A("",!0)])):A("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},JT=Ge(KT,[["__scopeId","data-v-be89bf1f"]]),YT=["onClick"],XT=["innerHTML"],QT={class:"hamburger-nav"},eM=["disabled"],tM=["innerHTML"],nM={class:"current-tab-label"},oM=["disabled"],sM={key:0,class:"hamburger-menu"},aM=["onClick"],iM=["innerHTML"],lM=400,rM={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(null),r=M(null),u=M(!1),d=M(!1),h=U(()=>{const E=o.tabs.find(q=>q.value===o.modelValue);return E?E.label:""}),p=U(()=>o.tabs.find(q=>q.value===o.modelValue)?.icon||null),g=U(()=>o.tabs.findIndex(E=>E.value===o.modelValue)),y=U(()=>g.value>0),_=U(()=>g.value<o.tabs.length-1),b=()=>{y.value&&a("update:modelValue",o.tabs[g.value-1].value)},C=()=>{_.value&&a("update:modelValue",o.tabs[g.value+1].value)},I=()=>{if(!s.value)return;const E=s.value.clientWidth;if(E<lM){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>E&&(u.value=!0);return}const q=o.tabs.some(R=>R.icon)?110:90,P=o.tabs.length*q,F=(o.tabs.length-1)*8;P+F<=E&&(u.value=!1,sn(()=>{i.value&&i.value.scrollWidth>E&&(u.value=!0)}))},$=()=>{d.value=!d.value},x=E=>{a("update:modelValue",E),d.value=!1},S=E=>{r.value&&!r.value.contains(E.target)&&(d.value=!1)};let B=null;return Qt(()=>{sn(()=>{I(),s.value&&typeof ResizeObserver<"u"&&(B=new ResizeObserver(()=>{I()}),B.observe(s.value)),document.addEventListener("click",S)})}),kn(()=>{B&&B.disconnect(),document.removeEventListener("click",S)}),Ze(()=>o.tabs,()=>{sn(()=>{I()})},{deep:!0}),(E,q)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:r},[l("div",QT,[l("button",{class:ve(["nav-arrow",{invisible:!y.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,eM),l("button",{class:"hamburger-button",onClick:$,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:D(Yn)(p.value)},null,8,tM)):A("",!0),l("span",nM,w(h.value),1),q[0]||(q[0]=l("span",{class:"hamburger-chevron"},"",-1))]),l("button",{class:ve(["nav-arrow",{invisible:!_.value}]),onClick:C,type:"button","aria-label":"Next tab",disabled:!_.value},"  ",10,oM)]),d.value?(v(),m("div",sM,[(v(!0),m(Me,null,Fe(e.tabs,P=>(v(),m("button",{key:P.value,class:ve(["menu-item",{active:e.modelValue===P.value}]),onClick:F=>x(P.value),type:"button"},[P.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Yn)(P.icon)},null,8,iM)):A("",!0),Qe(" "+w(P.label),1)],10,aM))),128))])):A("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),m(Me,null,Fe(e.tabs,P=>(v(),m("button",{key:P.value,class:ve(["tab-button",{active:e.modelValue===P.value}]),onClick:F=>E.$emit("update:modelValue",P.value),type:"button"},[P.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Yn)(P.icon)},null,8,XT)):A("",!0),Qe(" "+w(P.label),1)],10,YT))),128))],512))],512))}},Qi=Ge(rM,[["__scopeId","data-v-736c5d0a"]]),cM={class:"tab-content"},uM={class:"form-group"},dM=["value"],hM={class:"form-group"},fM=["value"],pM={class:"form-group"},vM={class:"area-display"},mM={key:0,class:"no-area"},gM={class:"form-help"},yM={class:"form-group checkbox-group"},kM={class:"checkbox-label"},_M=["checked"],bM={class:"form-help"},wM={key:0,class:"custom-times-section"},CM={class:"form-group"},LM=["value"],SM={class:"form-help"},IM={class:"form-group"},xM=["value"],$M={class:"form-help"},TM={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},r=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const h=Vl(o.eventDate);d.startTime=h,d.endTime=h}a("update:form",d),a("input")};return(u,d)=>(v(),m("div",cM,[l("form",{onSubmit:d[5]||(d[5]=it(h=>u.$emit("save"),["prevent"]))},[l("div",uM,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,dM)]),l("div",hM,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,fM)]),l("div",pM,[l("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",vM,[s.value.length===0?(v(),m("span",mM," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):A("",!0),(v(!0),m(Me,null,Fe(s.value,h=>(v(),m("span",{key:h.id,class:"area-badge",style:et({backgroundColor:h.color||"var(--brand-primary)"})},w(h.name),5))),128))]),l("small",gM,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",yM,[l("label",kM,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>r(h.target.checked)),type:"checkbox"},null,40,_M),l("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("small",bM," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",wM,[l("div",CM,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,LM),l("small",SM," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("div",IM,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,xM),l("small",$M," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):A("",!0)],32)]))}},MM=Ge(TM,[["__scopeId","data-v-aa628901"]]),AM={class:"scope-configuration-editor"},EM={class:"editor-header"},PM={class:"scope-types-list"},DM=["onClick"],OM={class:"scope-type-label"},RM={class:"scope-type-pill"},BM={class:"expand-label"},NM={class:"expand-icon"},FM={class:"modal-content"},UM={class:"modal-header"},zM={class:"modal-body"},HM={class:"scope-help"},VM={key:0,class:"form-group"},GM={class:"checkbox-label special-option"},jM=["checked"],ZM={key:0,class:"specific-selection"},qM=["placeholder"],WM={class:"checkbox-group scrollable"},KM=["checked","onChange"],JM={key:1,class:"form-group"},YM={class:"checkbox-label special-option"},XM=["checked"],QM={key:0,class:"specific-selection"},eA={class:"checkbox-group scrollable"},tA=["checked","onChange"],nA={key:2,class:"form-group"},oA={class:"checkbox-label special-option"},sA=["checked"],aA={key:0,class:"specific-selection"},iA=["placeholder"],lA={class:"checkbox-group scrollable"},rA={key:0,class:"checkbox-label this-checkpoint-option"},cA=["checked"],uA={class:"checkpoint-info"},dA={class:"checkpoint-name"},hA=["checked","onChange"],fA={class:"checkpoint-info"},pA={class:"checkpoint-name"},vA={key:0,class:"checkpoint-description"},mA={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=U(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),r=M({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=M(null),d=M(""),h=M(""),p=M(!a.isEditing);let g=!0,y=!1;const _=U(()=>i.value.filter(me=>!a.excludeScopes.includes(me.scope))),b=U(()=>p.value?_.value:_.value.filter(me=>j(me.scope))),C=U(()=>_.value.filter(ce=>j(ce.scope)).length<_.value.length),I=U(()=>{const me=_.value.filter(ce=>j(ce.scope)).length;return _.value.length-me}),$=U(()=>!a.currentCheckpointId&&a.intent==="location-update");Ze(()=>a.modelValue,me=>{if(me){if(y){y=!1;return}g=!0,Object.keys(r.value).forEach(ce=>{r.value[ce]={enabled:!1,ids:[]}}),me.forEach(ce=>{ce.scope==="Everyone"?r.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:ce.scope==="AreaLead"?r.value.EveryAreaLead={enabled:!0,ids:[...ce.ids]}:r.value[ce.scope]&&(r.value[ce.scope]={enabled:!0,ids:[...ce.ids]})}),g=!1}},{immediate:!0});const x=()=>{const me=[];return Object.keys(r.value).forEach(ce=>{const N=r.value[ce];if(N.enabled){const K={scope:ce,itemType:S(ce),ids:[...N.ids]};me.push(K)}}),me};Ze(r,()=>{if(g)return;if(Object.keys(r.value).some(N=>N!=="SpecificPeople"&&r.value[N].enabled)&&r.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const N=r.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");r.value.SpecificPeople.ids.splice(N,1),r.value.SpecificPeople.ids.length===0&&(r.value.SpecificPeople.enabled=!1)}y=!0;const ce=x();s("update:modelValue",ce),s("user-changed")},{deep:!0});const S=me=>B(me)?"Area":E(me)?"Checkpoint":q(me)?"Marshal":null,B=me=>me==="EveryoneInAreas"||me==="OnePerArea"||me==="EveryAreaLead"||me==="OneLeadPerArea",E=me=>me==="EveryoneAtCheckpoints"||me==="OnePerCheckpoint",q=me=>me==="SpecificPeople",P=me=>{const ce=i.value.find(N=>N.scope===me);return ce?ce.label:me},F=U(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${o.value.checklist}?`),R=me=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[me]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[me]||"",j=me=>r.value[me]?.enabled||!1,O=me=>{const ce=r.value[me];if(!ce||!ce.enabled)return"No";const N=ce.ids||[];if(B(me)){if(N.includes("ALL_AREAS"))return`All ${o.value.areas}`;const K=N.length;return K>0?`${K} ${K!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(E(me)){if(N.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(N.length===1&&N[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const K=N.length;return K>0?`${K} ${K!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(q(me)){if(N.includes("ALL_MARSHALS"))return"Everyone";const K=N.length;return K>0?`${K} ${K!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},G=me=>{u.value=me,d.value="",h.value=""},Q=()=>{u.value=null},se=()=>{u.value&&(r.value[u.value]={enabled:!1,ids:[]}),Q()},pe=()=>u.value&&r.value[u.value]?.ids.includes("ALL_MARSHALS"),ee=()=>{if(!u.value)return;const me=r.value[u.value];pe()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_MARSHALS"],me.enabled=!0)},te=me=>u.value&&r.value[u.value]?.ids.includes(me),z=me=>{if(!u.value)return;const ce=r.value[u.value],N=ce.ids.indexOf(me);N>=0?(ce.ids.splice(N,1),ce.ids.length===0&&(ce.enabled=!1)):(ce.ids.push(me),ce.enabled=!0)},Y=()=>{let me=a.marshals;if(h.value){const N=h.value.toLowerCase();me=me.filter(K=>K.name.toLowerCase().includes(N)||K.email&&K.email.toLowerCase().includes(N))}const ce=u.value?r.value[u.value]?.ids||[]:[];return[...me].sort((N,K)=>{const ae=ce.includes(N.id),Te=ce.includes(K.id);return ae&&!Te?-1:!ae&&Te?1:N.name.localeCompare(K.name,void 0,{sensitivity:"base"})})},ue=()=>u.value&&r.value[u.value]?.ids.includes("ALL_AREAS"),ke=()=>{if(!u.value)return;const me=r.value[u.value];ue()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_AREAS"],me.enabled=!0)},Re=me=>u.value&&r.value[u.value]?.ids.includes(me),Ye=()=>{const me=u.value?r.value[u.value]?.ids||[]:[];return[...a.areas].sort((ce,N)=>{const K=me.includes(ce.id),ae=me.includes(N.id);return K&&!ae?-1:!K&&ae?1:ce.name.localeCompare(N.name,void 0,{sensitivity:"base"})})},Ne=me=>{if(!u.value)return;const ce=r.value[u.value],N=ce.ids.indexOf(me);N>=0?(ce.ids.splice(N,1),ce.ids.length===0&&(ce.enabled=!1)):(ce.ids.push(me),ce.enabled=!0)},Ke=()=>u.value&&r.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),We=()=>{if(!u.value)return;const me=r.value[u.value];Ke()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_CHECKPOINTS"],me.enabled=!0)},X=me=>u.value&&r.value[u.value]?.ids.includes(me),_e=me=>{if(!u.value)return;const ce=r.value[u.value],N=ce.ids.indexOf(me);N>=0?(ce.ids.splice(N,1),ce.ids.length===0&&(ce.enabled=!1)):(ce.ids.push(me),ce.enabled=!0)},Le=()=>{let me=a.locations;if(d.value){const N=d.value.toLowerCase();me=me.filter(K=>K.name.toLowerCase().includes(N)||K.description&&K.description.toLowerCase().includes(N))}const ce=u.value?r.value[u.value]?.ids||[]:[];return[...me].sort((N,K)=>{const ae=ce.includes(N.id),Te=ce.includes(K.id);return ae&&!Te?-1:!ae&&Te?1:js(N.name,K.name)})};return(me,ce)=>(v(),m("div",AM,[l("div",EM,[l("h4",null,w(F.value),1)]),l("div",PM,[(v(!0),m(Me,null,Fe(b.value,N=>(v(),m("div",{key:N.scope,class:ve(["scope-type-row",{active:j(N.scope)}]),onClick:K=>G(N.scope)},[l("div",OM,w(N.label),1),l("div",RM,w(O(N.scope)),1)],10,DM))),128)),C.value?(v(),m("div",{key:0,class:"expand-row",onClick:ce[0]||(ce[0]=N=>p.value=!p.value)},[l("div",BM,w(p.value?"Show less":`Show ${I.value} more option${I.value!==1?"s":""}...`),1),l("div",NM,w(p.value?"":""),1)])):A("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:it(Q,["self"])},[l("div",FM,[l("div",UM,[l("h5",null,w(P(u.value)),1),l("button",{onClick:Q,class:"btn-close",type:"button"},"")]),l("div",zM,[l("p",HM,w(R(u.value)),1),q(u.value)?(v(),m("div",VM,[l("label",GM,[l("input",{type:"checkbox",checked:pe(),onChange:ee},null,40,jM),l("span",null,[ce[4]||(ce[4]=l("strong",null,"Everyone at the event",-1)),Qe(" (all current and future "+w(D(o).people)+")",1)])]),pe()?A("",!0):(v(),m("div",ZM,[ze(l("input",{"onUpdate:modelValue":ce[1]||(ce[1]=N=>h.value=N),type:"text",placeholder:`Search ${D(o).people}...`,class:"search-input"},null,8,qM),[[tt,h.value]]),l("div",WM,[(v(!0),m(Me,null,Fe(Y(),N=>(v(),m("label",{key:N.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:te(N.id),onChange:K=>z(N.id)},null,40,KM),l("span",null,w(N.name),1)]))),128))])]))])):A("",!0),B(u.value)?(v(),m("div",JM,[l("label",YM,[l("input",{type:"checkbox",checked:ue(),onChange:ke},null,40,XM),l("span",null,[l("strong",null,"All "+w(D(o).areas),1),Qe(" (includes future "+w(D(o).areas)+")",1)])]),ue()?A("",!0):(v(),m("div",QM,[l("div",eA,[(v(!0),m(Me,null,Fe(Ye(),N=>(v(),m("label",{key:N.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Re(N.id),onChange:K=>Ne(N.id)},null,40,tA),l("span",{class:"area-color-dot",style:et({backgroundColor:N.color||"#667eea"})},null,4),l("span",null,w(N.name),1)]))),128))])]))])):A("",!0),E(u.value)?(v(),m("div",nA,[l("label",oA,[l("input",{type:"checkbox",checked:Ke(),onChange:We},null,40,sA),l("span",null,[l("strong",null,"All "+w(D(o).checkpoints),1),Qe(" (includes future "+w(D(o).checkpoints)+")",1)])]),Ke()?A("",!0):(v(),m("div",aA,[ze(l("input",{"onUpdate:modelValue":ce[2]||(ce[2]=N=>d.value=N),type:"text",placeholder:`Search ${D(o).checkpoints}...`,class:"search-input"},null,8,iA),[[tt,d.value]]),l("div",lA,[$.value?(v(),m("label",rA,[l("input",{type:"checkbox",checked:X("THIS_CHECKPOINT"),onChange:ce[3]||(ce[3]=N=>_e("THIS_CHECKPOINT"))},null,40,cA),l("div",uA,[l("span",dA,[l("strong",null,"This "+w(D(o).checkpoint),1)])])])):A("",!0),(v(!0),m(Me,null,Fe(Le(),N=>(v(),m("label",{key:N.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:X(N.id),onChange:K=>_e(N.id)},null,40,hA),l("div",fA,[l("span",pA,w(N.name),1),N.description?(v(),m("span",vA," - "+w(N.description),1)):A("",!0)])]))),128))])]))])):A("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:se,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:Q,class:"btn btn-primary",type:"button"},"Done")])])])):A("",!0)]))}},wc=Ge(mA,[["__scopeId","data-v-d465703e"]]),gA={class:"tab-content"},yA={class:"form-group"},kA=["value"],_A={key:0,class:"form-error"},bA={class:"form-row"},wA={class:"form-group"},CA=["disabled"],LA={class:"form-group"},SA=["disabled"],IA={class:"form-group"},xA={class:"accordion-item"},$A={class:"accordion-preview"},TA={class:"accordion-arrow"},MA={key:0,class:"accordion-content"},AA={class:"section-description"},EA={class:"dynamic-checkbox"},PA=["checked"],DA={key:0,class:"dynamic-settings"},OA={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,s=M(!1),i=M(""),r=M(""),u=_=>_==null||_===""||isNaN(_)?"":Number(_).toFixed(6);Ze(()=>o.form.longitude,_=>{i.value=u(_)},{immediate:!0}),Ze(()=>o.form.latitude,_=>{r.value=u(_)},{immediate:!0});const d=_=>{const b=_==="longitude"?i:r,C=parseFloat(b.value);isNaN(C)?b.value.trim()===""&&(a("update:form",{...o.form,[_]:0}),a("input"),b.value=u(0)):(a("update:form",{...o.form,[_]:C}),a("input"),b.value=u(C))},h=(_,b)=>{a("update:form",{...o.form,[_]:b}),a("input")},p=_=>{if(_){const C=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[o.form.id||"THIS_CHECKPOINT"]}];a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:C})}else a("update:form",{...o.form,isDynamic:!1});a("input")},g=_=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:_}),a("input")},y=_=>{if(!_)return!0;const b=_.includes(".")?_.split("."):_.split("/");if(b.length!==3)return!1;const C=/^[a-z]{1,20}$/;return b.every(I=>C.test(I))};return(_,b)=>(v(),m("div",gA,[l("form",{onSubmit:b[6]||(b[6]=it(C=>_.$emit("save"),["prevent"]))},[l("div",yA,[b[10]||(b[10]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=C=>h("what3Words",C.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,kA),e.form.what3Words&&!y(e.form.what3Words)?(v(),m("small",_A," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):A("",!0)]),e.form.isDynamic?A("",!0):(v(),m(Me,{key:0},[l("div",bA,[l("div",wA,[b[11]||(b[11]=l("label",null,"Longitude",-1)),ze(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>i.value=C),onBlur:b[2]||(b[2]=C=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,CA),[[tt,i.value]])]),l("div",LA,[b[12]||(b[12]=l("label",null,"Latitude",-1)),ze(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>r.value=C),onBlur:b[4]||(b[4]=C=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,SA),[[tt,r.value]])])]),l("div",IA,[l("button",{type:"button",onClick:b[5]||(b[5]=C=>_.$emit("move-location")),class:ve(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Qe(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",xA,[l("button",{type:"button",class:ve(["accordion-header",{expanded:s.value}]),onClick:b[7]||(b[7]=C=>s.value=!s.value)},[b[14]||(b[14]=Br('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),l("span",$A,w(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",TA,w(s.value?"":""),1)],2),s.value?(v(),m("div",MA,[l("p",AA," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",EA,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=C=>p(C.target.checked))},null,40,PA),l("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",DA,[Ee(wc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:b[9]||(b[9]=C=>_.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):A("",!0)])):A("",!0)])]))}},RA=Ge(OA,[["__scopeId","data-v-bd432637"]]);function im(e){const t=M(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const y=!o(p);y===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,y),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const BA={class:"card-main"},NA={class:"card-title"},FA={class:"marshal-name"},UA={key:0,class:"card-check-in"},zA={class:"toggle-icon"},HA={class:"toggle-label"},VA={key:0,class:"check-in-time"},GA={key:0,class:"check-in-method"},jA={key:1,class:"unsaved-indicator"},ZA={key:1,class:"card-status-readonly"},qA={class:"status-icon"},WA={key:0,class:"check-in-time"},KA={key:0,class:"check-in-method"},JA={key:2,class:"card-badge"},YA={key:3,class:"card-badge"},XA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const o=e,a=t,s=()=>{a("distance-click",o.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",r=U(()=>{const{checkedInBy:y,checkInMethod:_,marshalName:b}=o.assignment;return y&&y!==b?y:_||""}),u=U(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),d=U(()=>{const{checkInLatitude:y,checkInLongitude:_}=o.assignment,b=o.location;return!y||!_||!b?.latitude||!b?.longitude?null:di(y,_,b.latitude,b.longitude)}),h=U(()=>d.value===null?null:s0(d.value)),p=U(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),g=()=>{u.value&&a("click",o.assignment)};return(y,_)=>(v(),m("div",{class:ve(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":u.value}]),onClick:g},[l("div",BA,[l("div",NA,[l("span",FA,w(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",UA,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:_[0]||(_[0]=it(b=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[l("span",zA,w(e.effectiveCheckInStatus?"":""),1),l("span",HA,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",VA,[Qe(w(i(e.assignment.checkInTime))+" ",1),r.value?(v(),m("span",GA,"("+w(r.value)+")",1)):A("",!0),h.value?(v(),m("span",{key:1,class:ve(["check-in-distance",p.value]),onClick:it(s,["stop"])},w(h.value),3)):A("",!0)])):e.hasUnsavedChanges?(v(),m("span",jA," Unsaved ")):A("",!0)])):A("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",ZA,[l("span",{class:ve(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[l("span",qA,w(e.effectiveCheckInStatus?"":""),1),Qe(" "+w(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",WA,[Qe(w(i(e.assignment.checkInTime))+" ",1),r.value?(v(),m("span",KA,"("+w(r.value)+")",1)):A("",!0),h.value?(v(),m("span",{key:1,class:ve(["check-in-distance",p.value]),onClick:it(s,["stop"])},w(h.value),3)):A("",!0)])):A("",!0)])):A("",!0),e.assignment.isPending?(v(),m("div",JA,[..._[3]||(_[3]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):A("",!0),e.isMarkedForRemoval?(v(),m("div",YA,[..._[4]||(_[4]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):A("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:_[1]||(_[1]=it(b=>y.$emit("remove",e.assignment),["stop"]))},"  ")):A("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:_[2]||(_[2]=it(b=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):A("",!0)],2))}},QA=Ge(XA,[["__scopeId","data-v-85a18d73"]]),eE={class:"tab-content"},tE={key:0,class:"read-only-notice"},nE={key:1,class:"form-group"},oE=["value"],sE={class:"section-title"},aE={key:2,class:"assign-section"},iE={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:o}){const a=e,s=U(()=>a.peopleTerm.toLowerCase()),i=U(()=>a.personTerm.toLowerCase()),r=U(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:p}=im(()=>u("input")),g=M(new Set),y=U(()=>a.assignments?.length||0),_=U(()=>a.assignments?[...a.assignments].sort((R,j)=>(R.marshalName||"").localeCompare(j.marshalName||"",void 0,{sensitivity:"base"})):[]),b=R=>g.value.has(R),C=R=>{R.isPending||u("select-marshal",R)},I=M(!1),$=M(null),x=R=>{h(R)?($.value=R,I.value=!0):p(R)},S=()=>{$.value&&p($.value),I.value=!1,$.value=null},B=()=>{I.value=!1,$.value=null},E=U(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),q=R=>{R.isPending?u("remove-assignment",R):(g.value.add(R.id),u("input"))},P=R=>{g.value.delete(R.id),u("input")},F=(R,j)=>{u("update:form",{...a.form,[R]:Number(j)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([R,j])=>({assignmentId:R,shouldBeCheckedIn:j})),getMarkedForRemoval:()=>Array.from(g.value)}),(R,j)=>(v(),m("div",eE,[e.readOnly?(v(),m("div",tE," Viewing from "+w(i.value)+" - "+w(s.value)+" cannot be modified here. ",1)):A("",!0),e.readOnly?A("",!0):(v(),m("div",nE,[l("label",null,"Required "+w(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:j[0]||(j[0]=O=>F("requiredMarshals",O.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,oE)])),l("h3",sE,"Assigned "+w(s.value)+" ("+w(y.value)+")",1),Ee(Ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${r.value}.`},{default:He(()=>[(v(!0),m(Me,null,Fe(_.value,O=>(v(),qe(QA,{key:O.id,assignment:O,"effective-check-in-status":D(h)(O),"has-unsaved-changes":D(d).has(O.id),"is-marked-for-removal":b(O.id),"read-only":e.readOnly,location:e.form,onClick:C,onToggleCheckIn:x,onRemove:q,onUndoRemove:P,onDistanceClick:j[1]||(j[1]=G=>R.$emit("distance-click",G))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?A("",!0):(v(),m("div",aE,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:j[2]||(j[2]=O=>R.$emit("open-assign-modal"))}," + Assign "+w(i.value)+"... ",1)])),Ee($a,{show:I.value,title:"Confirm check-out",message:E.value,"confirm-text":"Check out","is-danger":!0,onConfirm:S,onCancel:B},null,8,["show","message"])]))}},lE=Ge(iE,[["__scopeId","data-v-7124720e"]]),rE={class:"grouped-tasks-list"},cE={key:0,class:"empty-state"},uE={key:1,class:"task-groups"},dE=["onClick"],hE={class:"task-header-content"},fE={class:"task-checkbox-area"},pE={class:"task-info"},vE={class:"task-name"},mE={class:"task-summary"},gE={key:0,class:"modified-badge"},yE={class:"task-scope"},kE=["title"],_E={class:"expand-arrow"},bE={key:0,class:"task-group-details"},wE={class:"detail-checkbox"},CE=["checked","disabled","onChange"],LE={class:"detail-content"},SE={class:"detail-context"},IE={key:0,class:"detail-completion"},xE={key:0,class:"pending-text"},$E={class:"completion-text"},TE={class:"completion-time"},ME={key:1,class:"detail-uncomplete"},AE={key:2,class:"detail-disabled"},EE={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=e,i=M(new Set),r=U(()=>{const b=new Map;for(const C of s.items){b.has(C.itemId)||b.set(C.itemId,{itemId:C.itemId,text:C.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const I=b.get(C.itemId);I.items.push(C),I.totalCount++,C.localIsCompleted&&I.completedCount++,C.isModified&&(I.hasModified=!0)}for(const C of b.values())C.allCompleted=C.completedCount===C.totalCount,C.items.sort((I,$)=>{const x=y(I),S=y($);return x.localeCompare(S,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(b.values()).sort((C,I)=>C.text.localeCompare(I.text,void 0,{sensitivity:"base"}))}),u=b=>{i.value.has(b)?i.value.delete(b):i.value.add(b),i.value=new Set(i.value)},d=b=>b.hasModified?"status-modified":b.allCompleted?"status-completed":b.completedCount>0?"status-partial":"status-pending",h=b=>b.allCompleted?"":b.completedCount>0?"":"",p=b=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[b.matchedScope]||b.matchedScope,g=b=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[b.matchedScope]||"",y=b=>{if(!b.completionContextType||!b.completionContextId)return"Everyone";if(b.completionContextType==="Checkpoint"){const C=s.locations.find(I=>I.id===b.completionContextId);return C?C.description?`${C.name} - ${C.description}`:C.name:`${o.value.checkpoint} (unknown)`}if(b.completionContextType==="Area"){const C=s.areas.find(I=>I.id===b.completionContextId);return C?C.name:`${o.value.area} (unknown)`}if(b.completionContextType==="Personal"){if(b.contextOwnerName)return b.contextOwnerName;if(b.completionContextId&&s.marshals.length>0){const C=s.marshals.find(I=>I.id===b.completionContextId||I.marshalId===b.completionContextId);if(C)return C.name||C.marshalName}return"Assigned individually"}return b.completionContextType},_=b=>b?new Date(b).toLocaleString():"";return(b,C)=>(v(),m("div",rE,[r.value.length===0?(v(),m("div",cE,[...C[0]||(C[0]=[l("p",null,"No tasks available.",-1)])])):(v(),m("div",uE,[(v(!0),m(Me,null,Fe(r.value,I=>(v(),m("div",{key:I.itemId,class:ve(["task-group",{"all-completed":I.allCompleted,"has-modified":I.hasModified}])},[l("button",{type:"button",class:"task-group-header",onClick:$=>u(I.itemId)},[l("div",hE,[l("div",fE,[l("span",{class:ve(["task-status-icon",d(I)])},w(h(I)),3)]),l("div",pE,[l("div",vE,w(I.text),1),l("div",mE,[l("span",{class:ve(["completion-count",{"all-done":I.allCompleted}])},w(I.completedCount)+"/"+w(I.totalCount)+" completed ",3),I.hasModified?(v(),m("span",gE," Modified ")):A("",!0)])]),l("div",yE,[I.items[0]?.scopeConfigurations?.length?(v(),qe(Xl,{key:0,"scope-configurations":I.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(v(),m("span",{key:1,class:"scope-pill",title:g(I.items[0])},w(p(I.items[0])),9,kE))])]),l("span",_E,w(i.value.has(I.itemId)?"":""),1)],8,dE),i.value.has(I.itemId)?(v(),m("div",bE,[(v(!0),m(Me,null,Fe(I.items,$=>(v(),m("div",{key:`${$.itemId}-${$.completionContextId}`,class:ve(["task-detail-item",{"item-completed":$.localIsCompleted,"item-modified":$.isModified}])},[l("div",wE,[l("input",{type:"checkbox",checked:$.localIsCompleted,disabled:!$.canBeCompletedByMe&&!$.localIsCompleted,onChange:x=>b.$emit("toggle-complete",$)},null,40,CE)]),l("div",LE,[l("div",SE,w(y($)),1),$.localIsCompleted?(v(),m("div",IE,[$.isModified&&!$.isCompleted?(v(),m("span",xE," Will be marked as completed ")):(v(),m(Me,{key:1},[l("span",$E,w($.completedByActorName||"Unknown"),1),l("span",TE,w(_($.completedAt)),1)],64))])):$.isModified&&$.isCompleted?(v(),m("div",ME,[...C[1]||(C[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):$.canBeCompletedByMe?A("",!0):(v(),m("div",AE," Already completed by someone else "))])],2))),128))])):A("",!0)],2))),128))]))]))}},fd=Ge(EE,[["__scopeId","data-v-3e492b49"]]),PE={class:"checkpoint-checklist-view"},DE={key:0,class:"loading-state"},OE={key:1,class:"error-state"},RE={key:2,class:"empty-state"},BE={class:"help-text"},NE={key:3,class:"empty-state"},FE={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),s=e,i=o,r=M([]),u=M(!1),d=M(null),h=M(new Map),p=U(()=>s.assignments.length===0),g=U(()=>r.value.map(I=>{const $=h.value.get(`${I.itemId}|||${I.completionContextId}`),x=$!==void 0?$.complete:I.isCompleted,S=$!==void 0&&$.complete!==I.isCompleted;return{...I,localIsCompleted:x,isModified:S}})),y=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const I=s.locationId?await Rt.getCheckpointChecklist(s.eventId,s.locationId):await Rt.getAreaChecklist(s.eventId,s.areaId);if(r.value=I.data||[],s.modelValue&&s.modelValue.length>0){const $=new Map;s.modelValue.forEach(x=>{$.set(`${x.itemId}|||${x.contextId}`,{complete:x.complete,contextType:x.contextType,contextId:x.contextId})}),h.value=$}}catch(I){console.error("Failed to load checklist:",I),d.value=I.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},_=I=>{const $=I.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!$)return;const x=`${I.itemId}|||${I.completionContextId}`,S=h.value.get(x),B=S!==void 0?S.complete:I.isCompleted;h.value.set(x,{complete:!B,contextType:I.completionContextType,contextId:I.completionContextId,marshalId:$}),b()},b=()=>{const I=[];for(const[$,x]of h.value.entries()){const[S,B]=$.split("|||"),E=r.value.find(q=>q.itemId===S&&q.completionContextId===B);E&&x.complete!==E.isCompleted&&I.push({itemId:S,complete:x.complete,contextType:x.contextType,contextId:x.contextId,marshalId:x.marshalId})}i("update:modelValue",I),i("change",I)};return t({resetLocalState:()=>{if(h.value=new Map,s.modelValue&&s.modelValue.length>0){const I=new Map;s.modelValue.forEach($=>{I.set(`${$.itemId}|||${$.contextId}`,{complete:$.complete,contextType:$.contextType,contextId:$.contextId,marshalId:$.marshalId})}),h.value=I}},loadChecklist:y}),Ze(()=>[s.eventId,s.locationId,s.areaId],()=>{y()},{immediate:!0}),(I,$)=>(v(),m("div",PE,[u.value?(v(),m("div",DE," Loading checklist... ")):d.value?(v(),m("div",OE,[l("p",null,w(d.value),1),l("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):p.value?(v(),m("div",RE,[l("p",null,"No "+w(D(a).peoplePlural)+" assigned to this "+w(D(a).checkpoint)+" yet.",1),l("p",BE,"Assign "+w(D(a).peoplePlural)+" to enable "+w(D(a).checklist)+" completion.",1)])):r.value.length===0?(v(),m("div",NE,[l("p",null,"No checklist items for this "+w(D(a).checkpoint)+".",1)])):(v(),qe(fd,{key:4,items:g.value,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:_},null,8,["items","locations","areas","marshals"]))]))}},lm=Ge(FE,[["__scopeId","data-v-d5d67805"]]),UE={class:"notes-view"},zE={key:0,class:"loading-state"},HE={key:1,class:"error-state"},VE={key:2,class:"empty-state"},GE={key:3,class:"notes-list"},jE={class:"note-header"},ZE={class:"note-title-row"},qE={key:0,class:"pin-icon",title:"Pinned"},WE={class:"note-title"},KE={class:"note-meta"},JE={key:0,class:"category-badge"},YE={key:0,class:"note-content"},XE={class:"note-footer"},QE={class:"created-info"},e4={key:1,class:"scope-info"},t4={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=M([]),s=M(!1),i=M(null),r=U(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=U(()=>o.areaId?o.locations.filter($=>$.areaIds&&$.areaIds.includes(o.areaId)):[]),d=U(()=>u.value.map($=>$.id)),h=U(()=>{if(!o.areaId)return[];const $=new Set;return o.assignments.filter(x=>d.value.includes(x.locationId)).forEach(x=>$.add(x.marshalId)),Array.from($)}),p=$=>o.assignments.filter(x=>x.marshalId===$).map(x=>x.locationId),g=$=>{const x=p($),S=new Set;for(const B of x){const E=o.locations.find(q=>q.id===B);E?.areaIds&&E.areaIds.forEach(q=>S.add(q))}return Array.from(S)},y=($,x)=>{if(!$.scopeConfigurations)return null;for(const S of $.scopeConfigurations){if(S.itemType==="Area"){if(x.type==="area"&&(S.ids.includes(x.areaId)||S.ids.includes("ALL_AREAS")))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"};if(x.type==="checkpoint"){const E=o.locations.find(q=>q.id===x.locationId)?.areaIds||[];if(S.ids.includes("ALL_AREAS")||E.some(q=>S.ids.includes(q)))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(S.itemType==="Checkpoint"){if(x.type==="checkpoint"&&(S.ids.includes(x.locationId)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(x.type==="area"&&x.checkpointIds.some(E=>S.ids.includes(E)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(S.itemType==="Marshal"){if(x.type==="marshal"&&(S.ids.includes(x.marshalId)||S.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(x.type==="checkpoint"){const B=o.assignments.filter(q=>q.locationId===x.locationId).map(q=>q.marshalId);if(S.ids.includes("ALL_MARSHALS")||B.some(q=>S.ids.includes(q)))return{matched:!0,scope:"Marshal at checkpoint"}}if(x.type==="area"&&(S.ids.includes("ALL_MARSHALS")||x.marshalIds.some(E=>S.ids.includes(E))))return{matched:!0,scope:"Marshal in area"}}if(x.type==="marshal"&&x.checkpointIds&&x.areaIds){if(S.itemType==="Checkpoint"&&(S.ids.includes("ALL_CHECKPOINTS")||x.checkpointIds.some(E=>S.ids.includes(E))))return{matched:!0,scope:"Assigned checkpoint"};if(S.itemType==="Area"&&(S.ids.includes("ALL_AREAS")||x.areaIds.some(E=>S.ids.includes(E))))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},_=U(()=>{const $=o.allNotes||a.value;if(!$||$.length===0)return[];if(o.areaId&&o.allNotes){const x={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:h.value},S=[],B=new Set;for(const E of $){if(B.has(E.noteId))continue;const q=y(E,x);q&&(B.add(E.noteId),S.push({...E,matchedScope:q.scope}))}return S}if(o.locationId&&o.allNotes){const x={type:"checkpoint",locationId:o.locationId},S=[],B=new Set;for(const E of $){if(B.has(E.noteId))continue;const q=y(E,x);q&&(B.add(E.noteId),S.push({...E,matchedScope:q.scope}))}return S}if(o.marshalId&&o.allNotes){const x=p(o.marshalId),S=g(o.marshalId),B={type:"marshal",marshalId:o.marshalId,checkpointIds:x,areaIds:S},E=[],q=new Set;for(const P of $){if(q.has(P.noteId))continue;const F=y(P,B);F&&(q.add(P.noteId),E.push({...P,matchedScope:F.scope}))}return E}return $}),b=U(()=>{const $={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[..._.value].sort((x,S)=>{if(x.isPinned!==S.isPinned)return x.isPinned?-1:1;const B=$[x.priority]??2,E=$[S.priority]??2;return B!==E?B-E:x.displayOrder!==S.displayOrder?x.displayOrder-S.displayOrder:new Date(S.createdAt)-new Date(x.createdAt)})}),C=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,i.value=null;try{let $;o.marshalId?$=await fs.getMarshalNotes(o.eventId,o.marshalId):$=await fs.getByEvent(o.eventId),a.value=$.data||[]}catch($){console.error("Failed to load notes:",$),i.value=$.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ze(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&C()},{immediate:!0});const I=$=>{if(!$)return"";const x=new Date($),B=new Date-x,E=Math.floor(B/6e4),q=Math.floor(B/36e5),P=Math.floor(B/864e5);return E<1?"just now":E<60?`${E}m ago`:q<24?`${q}h ago`:P<7?`${P}d ago`:x.toLocaleDateString()};return t({loadNotes:C}),($,x)=>(v(),m("div",UE,[s.value?(v(),m("div",zE," Loading notes... ")):i.value?(v(),m("div",HE,[l("p",null,w(i.value),1),l("button",{onClick:C,class:"btn btn-secondary btn-small"}," Retry ")])):_.value.length===0?(v(),m("div",VE,[l("p",null,w(r.value),1)])):(v(),m("div",GE,[(v(!0),m(Me,null,Fe(b.value,S=>(v(),m("div",{key:S.noteId,class:ve(["note-item",{pinned:S.isPinned}])},[l("div",jE,[l("div",ZE,[S.isPinned?(v(),m("span",qE,"")):A("",!0),l("span",{class:ve(["priority-indicator",(S.priority||"Normal").toLowerCase()])},null,2),l("strong",WE,w(S.title),1)]),l("div",KE,[S.category?(v(),m("span",JE,w(S.category),1)):A("",!0),l("span",{class:ve(["priority-badge",(S.priority||"Normal").toLowerCase()])},w(S.priority||"Normal"),3)])]),S.content?(v(),m("div",YE,w(S.content),1)):A("",!0),l("div",XE,[l("span",QE," Created by "+w(S.createdByName||"Unknown")+"  "+w(I(S.createdAt)),1),S.scopeConfigurations?.length&&e.showScope?(v(),qe(Xl,{key:0,class:"scope-pills","scope-configurations":S.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):S.matchedScope&&e.showScope?(v(),m("span",e4,w(S.matchedScope),1)):A("",!0)])],2))),128))]))]))}},Cc=Ge(t4,[["__scopeId","data-v-9887fcb2"]]),n4={class:"checklist-preview"},o4={class:"preview-actions"},s4={class:"preview-header"},a4={key:0,class:"add-item-form"},i4=["placeholder"],l4=["disabled"],r4={key:1,class:"pending-items"},c4={class:"item-content"},u4={class:"item-header"},d4={class:"item-text"},h4={class:"item-scope"},f4=["onClick"],p4={key:2,class:"empty-state"},v4={key:0,class:"help-text"},m4={key:3,class:"checklist-items"},g4={class:"item-content"},y4={class:"item-header"},k4={class:"item-text"},_4={class:"item-scope"},b4=["title"],w4={key:0,class:"item-context"},C4={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=e,i=U(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():a.value.checkpoint),r=t,u=M(!1),d=M(""),h=M([...s.modelValue]);Ze(()=>s.modelValue,S=>{h.value=[...S]},{deep:!0});const p=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},g=S=>{h.value.splice(S,1),y()},y=()=>{r("update:modelValue",[...h.value]),r("change")},_=S=>{const B=S.scope,E=S.itemType,q=S.ids||[];return(B==="EveryoneAtCheckpoints"||B==="OnePerCheckpoint")&&E==="Checkpoint"?q.includes("ALL_CHECKPOINTS"):B==="OnePerCheckpoint"&&E==="Area"?q.includes("ALL_AREAS")?!0:q.some(P=>s.pendingAreaIds.includes(P)):(B==="EveryoneInAreas"||B==="OnePerArea"||B==="EveryAreaLead"||B==="OneLeadPerArea")&&E==="Area"?q.includes("ALL_AREAS")?!0:q.some(P=>s.pendingAreaIds.includes(P)):!1},b=U(()=>s.allChecklistItems.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>_(B)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[S]||S,I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(q=>_(q));if(!B)return C(S.scopeConfigurations[0].scope);const E=B.ids||[];return E.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${a.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(q=>_(q));return B&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[B.scope]||""},x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(P=>_(P));if(!B)return null;const E=B.itemType,q=B.ids||[];if(q.includes("ALL_CHECKPOINTS")||q.includes("ALL_AREAS"))return null;if(E==="Area"){const P=s.areas.filter(F=>q.includes(F.id)&&s.pendingAreaIds.includes(F.id)).map(F=>F.name);if(P.length>0)return`In: ${P.join(", ")}`}return null};return(S,B)=>(v(),m("div",n4,[l("div",o4,[l("p",s4,w(e.isEditing?`Add new ${D(a).checklist} for this ${i.value}:`:`${D(o).checklists} that will apply at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=E=>u.value=!u.value)},w(u.value?"Cancel":`Add ${D(a).checklist}`),1)]),u.value?(v(),m("div",a4,[ze(l("input",{"onUpdate:modelValue":B[1]||(B[1]=E=>d.value=E),type:"text",placeholder:`Enter ${D(a).checklist} text...`,class:"add-item-input",onKeyup:Jo(p,["enter"])},null,40,i4),[[tt,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:p}," Add ",8,l4)])):A("",!0),h.value.length>0?(v(),m("div",r4,[(v(!0),m(Me,null,Fe(h.value,(E,q)=>(v(),m("div",{key:`pending-${q}`,class:"checklist-item pending"},[B[3]||(B[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",c4,[l("div",u4,[l("div",d4,w(E.text),1),l("div",h4,[B[2]||(B[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:P=>g(q),title:"Remove"},"  ",8,f4)])])])]))),128))])):A("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(v(),m("div",p4,[l("p",null,"No "+w(D(a).checklists)+" will apply based on the current "+w(D(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",v4," Assign "+w(D(a).areas)+" to see relevant "+w(D(a).checklists)+". ",1)):A("",!0)])):A("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",m4,[(v(!0),m(Me,null,Fe(b.value,E=>(v(),m("div",{key:E.id,class:"checklist-item"},[B[4]||(B[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",g4,[l("div",y4,[l("div",k4,w(E.text),1),l("div",_4,[l("span",{class:"scope-pill",title:$(E)},w(I(E)),9,b4)])]),x(E)?(v(),m("div",w4,w(x(E)),1)):A("",!0)])]))),128))])):A("",!0)]))}},L4=Ge(C4,[["__scopeId","data-v-7d943b21"]]),S4={class:"notes-preview"},I4={class:"preview-actions"},x4={class:"preview-header"},$4={key:0,class:"add-item-form"},T4={class:"add-form-fields"},M4=["disabled"],A4={key:1,class:"pending-items"},E4={class:"note-header"},P4={class:"note-title"},D4={class:"note-actions"},O4=["onClick"],R4={key:0,class:"note-content"},B4={key:2,class:"empty-state"},N4={key:0,class:"help-text"},F4={key:3,class:"notes-list"},U4={class:"note-header"},z4={class:"note-title"},H4=["title"],V4={key:0,class:"note-content"},G4={key:1,class:"note-context"},j4={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=U(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),r=M(!1),u=M(""),d=M(""),h=M([...a.modelValue]);Ze(()=>a.modelValue,S=>{h.value=[...S]},{deep:!0});const p=()=>{!u.value.trim()&&!d.value.trim()||(h.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",r.value=!1,y())},g=S=>{h.value.splice(S,1),y()},y=()=>{s("update:modelValue",[...h.value]),s("change")},_=S=>{const B=S.scope,E=S.itemType,q=S.ids||[];return B==="EveryoneAtCheckpoints"&&E==="Checkpoint"?q.includes("ALL_CHECKPOINTS"):B==="EveryoneInAreas"&&E==="Area"?q.includes("ALL_AREAS")?!0:q.some(P=>a.pendingAreaIds.includes(P)):!1},b=U(()=>a.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>_(B)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(q=>_(q));if(!B)return C(S.scopeConfigurations[0].scope);const E=B.ids||[];return E.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${o.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(q=>_(q));return B&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[B.scope]||""},x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(P=>_(P));if(!B)return null;const E=B.itemType,q=B.ids||[];if(q.includes("ALL_CHECKPOINTS")||q.includes("ALL_AREAS"))return null;if(E==="Area"){const P=a.areas.filter(F=>q.includes(F.id)&&a.pendingAreaIds.includes(F.id)).map(F=>F.name);if(P.length>0)return`In: ${P.join(", ")}`}return null};return(S,B)=>(v(),m("div",S4,[l("div",I4,[l("p",x4,w(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=E=>r.value=!r.value)},w(r.value?"Cancel":"Add note"),1)]),r.value?(v(),m("div",$4,[l("div",T4,[ze(l("input",{"onUpdate:modelValue":B[1]||(B[1]=E=>u.value=E),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[tt,u.value]]),ze(l("textarea",{"onUpdate:modelValue":B[2]||(B[2]=E=>d.value=E),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[tt,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:p}," Add ",8,M4)])):A("",!0),h.value.length>0?(v(),m("div",A4,[(v(!0),m(Me,null,Fe(h.value,(E,q)=>(v(),m("div",{key:`pending-${q}`,class:"note-item pending"},[l("div",E4,[l("span",P4,w(E.title||"Untitled"),1),l("div",D4,[B[3]||(B[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:P=>g(q),title:"Remove"},"  ",8,O4)])]),E.content?(v(),m("div",R4,w(E.content),1)):A("",!0)]))),128))])):A("",!0),!e.isEditing&&b.value.length===0&&h.value.length===0?(v(),m("div",B4,[l("p",null,"No notes will apply based on the current "+w(D(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",N4," Assign "+w(D(o).areas)+" to see relevant notes. ",1)):A("",!0)])):A("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",F4,[(v(!0),m(Me,null,Fe(b.value,E=>(v(),m("div",{key:E.id,class:"note-item"},[l("div",U4,[l("span",z4,w(E.title||"Untitled"),1),l("span",{class:"scope-pill",title:$(E)},w(I(E)),9,H4)]),E.content?(v(),m("div",V4,w(E.content),1)):A("",!0),x(E)?(v(),m("div",G4,w(x(E)),1)):A("",!0)]))),128))])):A("",!0)]))}},Z4=Ge(j4,[["__scopeId","data-v-71646c3f"]]),q4={class:"base-modal-title modal-title-with-icon"},W4=["innerHTML"],K4={key:7,class:"tab-content appearance-tab"},J4={class:"accordion-item"},Y4=["innerHTML"],X4={class:"accordion-title"},Q4={class:"accordion-arrow"},e3={key:0,class:"accordion-content"},t3={class:"section-description"},n3={class:"accordion-item"},o3={class:"accordion-preview"},s3={class:"accordion-arrow"},a3={key:0,class:"accordion-content"},i3={class:"section-description"},l3={class:"terminology-row"},r3={class:"terminology-field"},c3=["value"],u3={value:""},d3=["value"],h3={class:"terminology-field"},f3=["value"],p3={value:""},v3=["value"],m3={key:8,class:"tab-content incidents-tab"},g3={class:"incidents-list"},y3={class:"custom-footer"},k3={class:"footer-left"},mf="edit_location_accordion",_3={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,s=t,i=M("details"),r=M(!1),u=M(null),d=M(null),h=M([]),p=M([]),g=M([]),y=M({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),_=M(!1),b=M(null),C=fe=>{b.value=fe,_.value=!0},I=()=>{_.value=!1,b.value=null},$=U(()=>b.value&&b.value.marshalName||""),x=U(()=>y.value.name||a.location?.name||""),S=U(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:Z}=b.value;return!fe||!Z?null:{lat:fe,lng:Z}}),B=U(()=>{const fe=y.value.latitude,Z=y.value.longitude;return!fe||!Z?null:{lat:fe,lng:Z}}),E=U(()=>{if(!b.value)return null;const{checkInLatitude:fe,checkInLongitude:Z}=b.value,W=y.value.latitude,ie=y.value.longitude;return!fe||!Z||!W||!ie?null:di(fe,Z,W,ie)}),q=()=>a.eventId?`${mf}_${a.eventId}`:mf,P=M({iconStyle:!1,terminology:!1});Qt(()=>{const fe=localStorage.getItem(q());if(fe)try{const Z=JSON.parse(fe);P.value={...P.value,...Z}}catch{}});const F=fe=>{P.value[fe]=!P.value[fe],localStorage.setItem(q(),JSON.stringify(P.value))},R=U(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const Z=a.areas.filter(W=>fe.includes(W.id)&&W.peopleTerm).sort((W,ie)=>(W.checkpointCount||0)-(ie.checkpointCount||0));if(Z.length>0)return Z[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),j=U(()=>y.value.peopleTerm?y.value.peopleTerm:R.value),O=U(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const Z=a.areas.filter(W=>fe.includes(W.id)&&W.checkpointTerm).sort((W,ie)=>(W.checkpointCount||0)-(ie.checkpointCount||0));if(Z.length>0)return Z[0].checkpointTerm}return o.value.checkpoint});U(()=>O.value.toLowerCase());const G=U(()=>{const fe=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(fe)return ei("checkpoint",fe,j.value);const Z=y.value.areaIds||[];let W=null;if(Z.length>0){const ie=a.areas.filter(Ue=>Z.includes(Ue.id)&&Ue.checkpointTerm).sort((Ue,Xe)=>(Ue.checkpointCount||0)-(Xe.checkpointCount||0));ie.length>0&&(W=ie[0].checkpointTerm)}return W?ei("checkpoint",W,j.value):o.value.checkpoint}),Q=U(()=>G.value.toLowerCase()),se=U(()=>{const fe=j.value;return ei("people",fe)});U(()=>se.value.toLowerCase());const pe=U(()=>o.value.area);U(()=>pe.value.toLowerCase());const ee=U(()=>o.value.area),te=U(()=>ee.value.toLowerCase()),z=U(()=>o.value.areas),Y=U(()=>!!(a.location&&a.location.id)),ue=U(()=>Y.value?`Edit ${Q.value}: ${a.location?.name||""}`:`Add ${Q.value}`),ke=U(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:j.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),Re=U(()=>ke.value.findIndex(fe=>fe.value===i.value)),Ye=U(()=>Re.value===ke.value.length-1),Ne=U(()=>{const fe=y.value.areaIds||[],Z=a.areas.filter(ut=>fe.includes(ut.id)).sort((ut,ln)=>(ut.checkpointCount||0)-(ln.checkpointCount||0)),W=(ut,ln)=>{for(const un of Z){const Nt=ut(un);if(Nt&&Nt!=="default")return{value:Nt,source:"area"}}return ln&&ln!=="default"?{value:ln,source:"event"}:{value:"",source:"none"}},ie=W(ut=>ut.checkpointStyleType||ut.CheckpointStyleType,a.eventDefaultStyleType),Ue=W(ut=>ut.checkpointStyleColor||ut.CheckpointStyleColor,a.eventDefaultStyleColor),Xe=W(ut=>ut.checkpointStyleBackgroundShape||ut.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),mt=W(ut=>ut.checkpointStyleBackgroundColor||ut.CheckpointStyleBackgroundColor||ut.checkpointStyleColor||ut.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),_t=W(ut=>ut.checkpointStyleBorderColor||ut.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),gt=W(ut=>ut.checkpointStyleIconColor||ut.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),St=W(ut=>ut.checkpointStyleSize||ut.CheckpointStyleSize,a.eventDefaultStyleSize),bt=W(ut=>ut.checkpointStyleMapRotation??ut.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Bt=[ie,Xe,mt,_t,gt,St,bt].some(ut=>ut.source==="area");return{type:ie.value||"default",color:Ue.value,backgroundShape:Xe.value,backgroundColor:mt.value,borderColor:_t.value,iconColor:gt.value,size:St.value,mapRotation:bt.value,source:Bt?"area":ie.value?"event":"none"}}),Ke=U(()=>Ne.value.source==="area"?`${ee.value} default`:"Event default"),We=U(()=>{const fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,Z=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",W=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",ie=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",Ue=y.value.styleIconColor||Ne.value.iconColor||"#ffffff";return Sn({type:fe||"circle",backgroundShape:Z,backgroundColor:W,borderColor:ie,iconColor:Ue,size:"100"})}),X=U(()=>{let fe,Z,W,ie,Ue;return Y.value&&a.location?(fe=a.location.resolvedStyleType||a.location.ResolvedStyleType,Z=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",W=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",ie=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",Ue=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,Z=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",W=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",ie=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",Ue=y.value.styleIconColor||Ne.value.iconColor||"#ffffff"),Sn({type:fe||"circle",backgroundShape:Z,backgroundColor:W,borderColor:ie,iconColor:Ue,size:"100",outputSize:28})}),_e=U(()=>{const fe=!!y.value.checkpointTerm,Z=!!y.value.peopleTerm;return fe&&Z?`${ei("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:fe?ei("checkpoint",y.value.checkpointTerm,j.value):Z?y.value.peopleTerm:"Using defaults"}),Le=U(()=>Ye.value?null:ke.value[Re.value+1]),me=U(()=>Le.value?`${Le.value.label}...`:""),ce=M(!1),N=M(null);Ze(()=>a.location,fe=>{if(fe){const Z=fe.id||"new";if(N.value!==Z){N.value=Z,ce.value=!0;let W="",ie="";fe.startTime&&(W=Vl(fe.startTime)),fe.endTime&&(ie=Vl(fe.endTime)),y.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:W,endTime:ie,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ze(()=>a.show,fe=>{fe?(i.value="details",r.value=!1,h.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(N.value=null,ce.value=!1)});const K=fe=>{y.value=fe},ae=()=>{s("update:isDirty",!0)},Te=()=>{r.value=!r.value,s("move-location",{isMoving:r.value,formData:{...y.value}})},Be=fe=>{h.value=fe,ae()},De=()=>{Le.value&&(i.value=Le.value.value)},Se=()=>{const fe={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:a.assignments.filter(Z=>Z.isPending).map(Z=>({marshalId:Z.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",fe)},J=()=>{a.location&&a.location.id&&s("delete",a.location.id)},he=fe=>{s("remove-assignment",fe)},xe=()=>{s("open-assign-modal")},Ie=fe=>{s("select-marshal",fe)},be=()=>{s("close")},de=(fe,Z)=>{y.value[fe]=Z,ae()};return(fe,Z)=>(v(),qe(Gt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:be},{header:He(()=>[l("h2",q4,[X.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:X.value},null,8,W4)):A("",!0),Qe(" "+w(ue.value),1)])]),"tab-header":He(()=>[Ee(Qi,{modelValue:i.value,"onUpdate:modelValue":Z[0]||(Z[0]=W=>i.value=W),tabs:ke.value},null,8,["modelValue","tabs"])]),footer:He(()=>[l("div",y3,[l("div",k3,[Y.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:J,class:"btn btn-danger"}," Delete ")):A("",!0),!Y.value&&!Ye.value?(v(),m("button",{key:1,type:"button",onClick:De,class:"btn btn-secondary mobile-only"},w(me.value),1)):A("",!0)]),l("button",{type:"button",onClick:Se,class:"btn btn-success"}," Save ")])]),default:He(()=>[i.value==="details"?(v(),qe(MM,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":ee.value,"area-term-plural":z.value,"checkpoint-term-singular":G.value,"people-term-plural":j.value,"onUpdate:form":K,onInput:ae,onSave:Se},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):A("",!0),i.value==="location"?(v(),qe(RA,{key:1,form:y.value,"is-moving":r.value,"checkpoint-term-singular":G.value,"people-term-plural":j.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":Y.value,"onUpdate:form":K,onInput:ae,onSave:Se,onMoveLocation:Te},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):A("",!0),i.value==="marshals"?(v(),qe(lE,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":j.value,"person-term":se.value,"checkpoint-term":G.value,"read-only":e.lockedFromMarshal,"onUpdate:form":K,onInput:ae,onRemoveAssignment:he,onOpenAssignModal:xe,onSelectMarshal:Ie,onDistanceClick:C},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):A("",!0),i.value==="checklists"&&Y.value?(v(),qe(lm,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":Z[1]||(Z[1]=W=>h.value=W),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,onChange:Be},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):A("",!0),i.value==="checklists"?(v(),qe(L4,{key:4,modelValue:p.value,"onUpdate:modelValue":Z[2]||(Z[2]=W=>p.value=W),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":G.value,onChange:ae},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):A("",!0),i.value==="notes"&&Y.value?(v(),qe(Cc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):A("",!0),i.value==="notes"?(v(),qe(Z4,{key:6,modelValue:g.value,"onUpdate:modelValue":Z[3]||(Z[3]=W=>g.value=W),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":G.value,onChange:ae},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):A("",!0),i.value==="appearance"?(v(),m("div",K4,[l("div",J4,[l("button",{type:"button",class:ve(["accordion-header",{expanded:P.value.iconStyle}]),onClick:Z[4]||(Z[4]=W=>F("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:We.value},null,8,Y4),l("span",X4,w(G.value)+" marker style",1),l("span",Q4,w(P.value.iconStyle?"":""),1)],2),P.value.iconStyle?(v(),m("div",e3,[l("p",t3," Choose a custom icon for this "+w(Q.value)+", or leave as Default to inherit from "+w(te.value)+" or event settings. ",1),Ee(hd,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":Ne.value.type,"inherited-style-color":Ne.value.color,"inherited-background-shape":Ne.value.backgroundShape||"","inherited-background-color":Ne.value.backgroundColor||Ne.value.color||"","inherited-border-color":Ne.value.borderColor||"","inherited-icon-color":Ne.value.iconColor||"","inherited-size":Ne.value.size||"","inherited-map-rotation":Ne.value.mapRotation??"","default-label":Ke.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":Z[5]||(Z[5]=W=>de("styleType",W)),"onUpdate:styleColor":Z[6]||(Z[6]=W=>de("styleColor",W)),"onUpdate:styleBackgroundShape":Z[7]||(Z[7]=W=>de("styleBackgroundShape",W)),"onUpdate:styleBackgroundColor":Z[8]||(Z[8]=W=>de("styleBackgroundColor",W)),"onUpdate:styleBorderColor":Z[9]||(Z[9]=W=>de("styleBorderColor",W)),"onUpdate:styleIconColor":Z[10]||(Z[10]=W=>de("styleIconColor",W)),"onUpdate:styleSize":Z[11]||(Z[11]=W=>de("styleSize",W)),"onUpdate:styleMapRotation":Z[12]||(Z[12]=W=>de("styleMapRotation",W))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):A("",!0)]),l("div",n3,[l("button",{type:"button",class:ve(["accordion-header",{expanded:P.value.terminology}]),onClick:Z[13]||(Z[13]=W=>F("terminology"))},[Z[17]||(Z[17]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),Z[18]||(Z[18]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",o3,w(_e.value),1),l("span",s3,w(P.value.terminology?"":""),1)],2),P.value.terminology?(v(),m("div",a3,[l("p",i3," Customise what this "+w(Q.value)+" and its "+w(j.value.toLowerCase())+" are called. ",1),l("div",l3,[l("div",r3,[l("label",null,"What is this "+w(Q.value)+" called?",1),l("select",{value:y.value.checkpointTerm,class:"form-input",onChange:Z[14]||(Z[14]=W=>{K({...y.value,checkpointTerm:W.target.value}),ae()})},[l("option",u3,"Use "+w(te.value)+" default ("+w(G.value)+")",1),Z[19]||(Z[19]=l("option",{value:"Vehicle"},"Vehicle",-1)),Z[20]||(Z[20]=l("option",{value:"Car"},"Car",-1)),Z[21]||(Z[21]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),m(Me,null,Fe(D(Bs).checkpoint,W=>(v(),m("option",{key:W,value:W},w(W),9,d3))),128))],40,c3)]),l("div",h3,[l("label",null,"What are "+w(j.value.toLowerCase())+" called here?",1),l("select",{value:y.value.peopleTerm,class:"form-input",onChange:Z[15]||(Z[15]=W=>{K({...y.value,peopleTerm:W.target.value}),ae()})},[l("option",p3,"Use "+w(te.value)+" default ("+w(R.value)+")",1),(v(!0),m(Me,null,Fe(D(Bs).people,W=>(v(),m("option",{key:W,value:W},w(W),9,v3))),128))],40,f3)])])])):A("",!0)])])):A("",!0),i.value==="incidents"?(v(),m("div",m3,[l("div",g3,[(v(!0),m(Me,null,Fe(e.incidents,W=>(v(),qe(er,{key:W.incidentId,incident:W,onSelect:Z[16]||(Z[16]=ie=>fe.$emit("select-incident",ie))},null,8,["incident"]))),128))])])):A("",!0),Ee(dd,{show:_.value,"marshal-name":$.value,"checkpoint-name":x.value,"check-in-location":S.value,"checkpoint-location":B.value,distance:E.value,"z-index":e.zIndex+100,onClose:I},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},b3=Ge(_3,[["__scopeId","data-v-4058e569"]]),w3={class:"tab-content"},C3={key:0,class:"error-banner"},L3=["value"],S3={key:0,class:"field-error"},I3={class:"contact-row"},x3=["value"],$3={key:0,class:"field-error"},T3=["value"],M3={key:0,class:"field-error"},A3=["value"],E3={key:0,class:"field-error"},P3={key:1,class:"magic-link-section"},D3={key:0,class:"loading-text"},O3={key:1,class:"magic-link-container"},R3={class:"magic-link-row"},B3=["value"],N3={key:0,class:"error-text"},F3={key:1,class:"magic-link-actions"},U3=["disabled"],z3={key:2,class:"success-text"},H3={key:3,class:"error-text"},V3={key:2,class:"error-text"},G3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null),r=M(null),u=M(null),d=M(null),h=M(""),p=M(!1),g=M(!1),y=M(""),_=M(!1),b=M(!1),C=M(!1),I=M(""),$=(P,F)=>{s("update:form",{...a.form,[P]:F}),s("input")},x=async()=>{if(!(!a.eventId||!a.marshalId)){g.value=!0,y.value="";try{const P=await gs.getMagicLink(a.eventId,a.marshalId);h.value=P.data.magicLink,p.value=P.data.hasEmail}catch(P){console.error("Failed to fetch magic link:",P),y.value="Failed to load login link"}finally{g.value=!1}}},S=M(""),B=async()=>{S.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),_.value=!0,setTimeout(()=>{_.value=!1},2e3);return}}catch(P){console.warn("Clipboard API failed, trying fallback:",P)}try{const P=document.createElement("textarea");P.value=h.value,P.style.position="fixed",P.style.left="-9999px",P.style.top="0",document.body.appendChild(P),P.focus(),P.select();const F=document.execCommand("copy");document.body.removeChild(P),F?(_.value=!0,setTimeout(()=>{_.value=!1},2e3)):(S.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3))}catch(P){console.error("Fallback copy failed:",P),S.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3)}},E=async()=>{if(!(!a.eventId||!a.marshalId)){b.value=!0,C.value=!1,I.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),C.value=!0,setTimeout(()=>{C.value=!1},3e3)}catch(P){console.error("Failed to send email:",P),I.value=P.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ze(()=>a.marshalId,P=>{P?x():(h.value="",p.value=!1)},{immediate:!0}),t({focusField:P=>{sn(()=>{const R={name:i,email:r,phoneNumber:u,notes:d}[P];R?.value&&(R.value.focus(),R.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(P,F)=>(v(),m("div",w3,[e.validationErrors.general?(v(),m("div",C3,w(e.validationErrors.general),1)):A("",!0),l("div",{class:ve(["form-group",{"has-error":e.validationErrors.name}])},[F[5]||(F[5]=l("label",null,"Name *",-1)),l("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:F[0]||(F[0]=R=>$("name",R.target.value)),type:"text",required:"",class:ve(["form-input",{"input-error":e.validationErrors.name}])},null,42,L3),e.validationErrors.name?(v(),m("span",S3,w(e.validationErrors.name),1)):A("",!0)],2),l("div",I3,[l("div",{class:ve(["form-group contact-email",{"has-error":e.validationErrors.email}])},[F[6]||(F[6]=l("label",null,"Email",-1)),l("input",{ref_key:"emailInputRef",ref:r,value:e.form.email,onInput:F[1]||(F[1]=R=>$("email",R.target.value)),type:"email",class:ve(["form-input",{"input-error":e.validationErrors.email}])},null,42,x3),e.validationErrors.email?(v(),m("span",$3,w(e.validationErrors.email),1)):A("",!0)],2),l("div",{class:ve(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[F[7]||(F[7]=l("label",null,"Phone number",-1)),l("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:F[2]||(F[2]=R=>$("phoneNumber",R.target.value)),type:"tel",class:ve(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,T3),e.validationErrors.phoneNumber?(v(),m("span",M3,w(e.validationErrors.phoneNumber),1)):A("",!0)],2)]),l("div",{class:ve(["form-group",{"has-error":e.validationErrors.notes}])},[F[8]||(F[8]=l("label",null,"Notes",-1)),l("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:F[3]||(F[3]=R=>$("notes",R.target.value)),class:ve(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,A3),e.validationErrors.notes?(v(),m("span",E3,w(e.validationErrors.notes),1)):A("",!0)],2),e.marshalId?(v(),m("div",P3,[F[9]||(F[9]=l("label",null,"Login link",-1)),F[10]||(F[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",D3,"Loading link...")):h.value?(v(),m("div",O3,[l("div",R3,[l("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:F[4]||(F[4]=R=>R.target.select())},null,40,B3),l("button",{type:"button",class:"btn btn-secondary",onClick:B},w(_.value?"Copied!":"Copy link"),1)]),S.value?(v(),m("p",N3,w(S.value),1)):A("",!0),p.value?(v(),m("div",F3,[l("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:E},w(b.value?"Sending...":"Send via email"),9,U3)])):A("",!0),C.value?(v(),m("p",z3,"Email sent successfully!")):A("",!0),I.value?(v(),m("p",H3,w(I.value),1)):A("",!0)])):y.value?(v(),m("div",V3,w(y.value),1)):A("",!0)])):A("",!0)]))}},j3=Ge(G3,[["__scopeId","data-v-16ffb81b"]]),Z3={class:"card-header"},q3={class:"checkpoint-name-row"},W3=["innerHTML"],K3={class:"checkpoint-name"},J3={key:0,class:"checkpoint-description"},Y3={key:0,class:"card-areas"},X3={key:1,class:"card-check-in"},Q3={key:0,class:"check-in-time"},eP={key:0,class:"check-in-method"},tP={key:1,class:"unsaved-indicator"},nP={key:2,class:"card-locked"},oP={class:"locked-badge"},sP={key:3,class:"card-badge"},aP={key:4,class:"card-badge"},iP={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=U(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),r=U(()=>i.value.map($=>{const x=a.areas.find(S=>S.id===$);return x?x.name:null}).filter(Boolean)),u=U(()=>i.value.map($=>{const x=a.areas.find(S=>S.id===$);return x?x.color:"#999"})),d=U(()=>{if(!a.location)return"#667eea";const $=a.location,x=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor;if(x)return x;if(i.value.length>0){const S=a.areas.find(B=>B.id===i.value[0]);if(S)return S.color}return"#667eea"}),h=U(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const $=a.location,x=$.resolvedStyleType||$.ResolvedStyleType,S=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor,B=$.resolvedStyleBorderColor||$.ResolvedStyleBorderColor,E=$.resolvedStyleIconColor||$.ResolvedStyleIconColor,q=$.resolvedStyleBackgroundShape||$.ResolvedStyleBackgroundShape;return x&&x!=="default"||S||B||E||q&&q!=="circle"?Sn({type:x||"circle",backgroundShape:q||"circle",backgroundColor:S||"#667eea",borderColor:B||"#ffffff",iconColor:E||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),p=$=>$?new Date($).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=U(()=>{const{checkedInBy:$,checkInMethod:x,marshalName:S}=a.assignment;return $&&$!==S?$:x||""}),y=U(()=>{const{checkInLatitude:$,checkInLongitude:x}=a.assignment,S=a.location;return!$||!x||!S?.latitude||!S?.longitude?null:di($,x,S.latitude,S.longitude)}),_=U(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),b=U(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),C=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&s("click",a.assignment)},I=()=>{s("distance-click",a.assignment)};return($,x)=>(v(),m("div",{class:ve(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:et({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[l("div",Z3,[l("div",{class:"card-title",onClick:C},[l("span",q3,[l("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,W3),l("span",K3,w(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",J3,"  "+w(e.assignment.locationDescription),1)):A("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:x[0]||(x[0]=it(S=>$.$emit("remove",e.assignment),["stop"]))},"  ")):A("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:x[1]||(x[1]=it(S=>$.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):A("",!0)]),r.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",Y3,[(v(!0),m(Me,null,Fe(r.value,(S,B)=>(v(),m("span",{key:B,class:"area-badge",style:et({backgroundColor:u.value[B]})},w(S),5))),128))])):A("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",X3,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:x[2]||(x[2]=S=>$.$emit("toggle-check-in",e.assignment))},[...x[3]||(x[3]=[l("span",{class:"toggle-icon"},"",-1),l("span",{class:"toggle-label-wrapper"},[l("span",{class:"toggle-label toggle-label-check-in"},"Check in"),l("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",Q3,[Qe(w(p(e.assignment.checkInTime))+" ",1),g.value?(v(),m("span",eP,"("+w(g.value)+")",1)):A("",!0),_.value?(v(),m("span",{key:1,class:ve(["check-in-distance",b.value]),onClick:it(I,["stop"])},w(_.value),3)):A("",!0)])):e.hasUnsavedChanges?(v(),m("span",tP," Unsaved ")):A("",!0)])):A("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",nP,[l("span",oP,"Viewing from this "+w(D(o).checkpoint),1)])):A("",!0),e.assignment.isPending?(v(),m("div",sP,[...x[4]||(x[4]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):A("",!0),e.isMarkedForRemoval?(v(),m("div",aP,[...x[5]||(x[5]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):A("",!0)],6))}},lP=Ge(iP,[["__scopeId","data-v-d3de6925"]]),rP={class:"tab-content"},cP={key:0,class:"read-only-notice"},uP={class:"section-title"},dP={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},hP={value:""},fP=["value"],pP={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),s=e,i=o,{pendingCheckInChanges:r,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=im(()=>i("input")),h=M(""),p=M(new Set),g=U(()=>s.assignments?.length||0),y=j=>s.allLocations&&s.allLocations.find(O=>O.id===j)||null,_=U(()=>[...s.assignments].sort((j,O)=>(j.locationName||"").localeCompare(O.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=j=>p.value.has(j),C=j=>{j.isPending||i("select-checkpoint",j)},I=M(!1),$=M(null),x=j=>{u(j)?($.value=j,I.value=!0):d(j)},S=()=>{$.value&&d($.value),I.value=!1,$.value=null},B=()=>{I.value=!1,$.value=null},E=U(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),q=j=>{j.isPending?i("remove-assignment",j):(p.value.add(j.id),i("input"))},P=j=>{p.value.delete(j.id),i("input")},F=U(()=>{const j=[...s.availableLocations];return j.sort((O,G)=>O.name.localeCompare(G.name,void 0,{numeric:!0,sensitivity:"base"})),j}),R=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:r,clearPendingChanges:()=>{r.value.clear(),p.value.clear(),h.value=""},getPendingChanges:()=>Array.from(r.value.entries()).map(([j,O])=>({assignmentId:j,shouldBeCheckedIn:O})),getMarkedForRemoval:()=>Array.from(p.value)}),(j,O)=>(v(),m("div",rP,[e.lockedCheckpointId?(v(),m("div",cP," Viewing from "+w(D(a).checkpoint)+" - "+w(D(a).checkpoints)+" cannot be modified here. ",1)):A("",!0),l("h3",uP,"Assigned "+w(D(a).checkpoints)+" ("+w(g.value)+")",1),Ee(Ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${D(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${D(a).person} to ${D(a).checkpoints}.`},{default:He(()=>[(v(!0),m(Me,null,Fe(_.value,G=>(v(),qe(lP,{key:G.id,assignment:G,location:y(G.locationId),areas:e.areas,"effective-check-in-status":D(u)(G),"has-unsaved-changes":D(r).has(G.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b(G.id),onClick:C,onToggleCheckIn:x,onRemove:q,onUndoRemove:P,onDistanceClick:O[0]||(O[0]=Q=>j.$emit("distance-click",Q))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&F.value.length>0?(v(),m("div",dP,[l("label",null,"Assign to "+w(D(a).checkpoint),1),ze(l("select",{"onUpdate:modelValue":O[1]||(O[1]=G=>h.value=G),class:"form-input",onChange:R},[l("option",hP,"Select a "+w(D(a).checkpoint)+"...",1),(v(!0),m(Me,null,Fe(F.value,G=>(v(),m("option",{key:G.id,value:G.id},[Qe(w(G.name),1),G.description?(v(),m(Me,{key:0},[Qe(" - "+w(G.description),1)],64)):A("",!0)],8,fP))),128))],544),[[Fn,h.value]])])):A("",!0),Ee($a,{show:I.value,title:"Confirm check-out",message:E.value,"confirm-text":"Check out","is-danger":!0,onConfirm:S,onCancel:B},null,8,["show","message"])]))}},vP=Ge(pP,[["__scopeId","data-v-07754949"]]),mP={class:"marshal-checklist-view"},gP={key:0,class:"loading-state"},yP={key:1,class:"error-state"},kP={key:2,class:"empty-state"},_P={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),s=e,i=o,r=M([]),u=M(!1),d=M(null),h=M(new Map),p=U(()=>r.value.map(C=>{const I=h.value.get(C.itemId),$=I!==void 0?I.complete:C.isCompleted,x=I!==void 0&&I.complete!==C.isCompleted;return{...C,localIsCompleted:$,isModified:x}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const C=await Rt.getMarshalChecklist(s.eventId,s.marshalId);if(r.value=C.data||[],s.modelValue&&s.modelValue.length>0){const I=new Map;s.modelValue.forEach($=>{I.set($.itemId,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),h.value=I}}catch(C){console.error("Failed to load checklist:",C),d.value=C.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=C=>{const I=h.value.get(C.itemId),$=I!==void 0?I.complete:C.isCompleted;h.value.set(C.itemId,{complete:!$,contextType:C.completionContextType,contextId:C.completionContextId}),_()},_=()=>{const C=[];for(const[I,$]of h.value.entries()){const x=r.value.find(S=>S.itemId===I);x&&$.complete!==x.isCompleted&&C.push({itemId:I,complete:$.complete,contextType:$.contextType,contextId:$.contextId})}i("update:modelValue",C),i("change",C)};return t({resetLocalState:()=>{if(h.value=new Map,s.modelValue&&s.modelValue.length>0){const C=new Map;s.modelValue.forEach(I=>{C.set(I.itemId,{complete:I.complete,contextType:I.contextType,contextId:I.contextId})}),h.value=C}},loadChecklist:g}),Ze(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(C,I)=>(v(),m("div",mP,[u.value?(v(),m("div",gP," Loading checklist... ")):d.value?(v(),m("div",yP,[l("p",null,w(d.value),1),l("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):r.value.length===0?(v(),m("div",kP,[l("p",null,"No checklist items for this "+w(D(a).person)+".",1)])):(v(),qe(fd,{key:3,items:p.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},bP=Ge(_P,[["__scopeId","data-v-7460304c"]]),wP={class:"checklist-preview"},CP={class:"preview-actions"},LP={class:"preview-header"},SP={key:0,class:"add-item-form"},IP=["placeholder"],xP=["disabled"],$P={key:1,class:"pending-items"},TP={class:"item-content"},MP={class:"item-header"},AP={class:"item-text"},EP={class:"item-scope"},PP=["onClick"],DP={key:2,class:"empty-state"},OP={key:0,class:"help-text"},RP={key:3,class:"checklist-items"},BP={class:"item-content"},NP={class:"item-header"},FP={class:"item-text"},UP={class:"item-scope"},zP=["title"],HP={key:0,class:"item-context"},VP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M([...a.modelValue]);Ze(()=>a.modelValue,x=>{u.value=[...x]},{deep:!0});const d=()=>{r.value.trim()&&(u.value.push({text:r.value.trim(),isNew:!0}),r.value="",i.value=!1,p())},h=x=>{u.value.splice(x,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=U(()=>{const x=new Set;for(const S of a.pendingLocationIds){const B=a.allLocations.find(E=>E.id===S);B&&(B.areaIds||B.AreaIds||[]).forEach(q=>x.add(q))}return[...x]}),y=x=>{const S=x.scope,B=x.itemType,E=x.ids||[];return S==="SpecificPeople"&&B==="Marshal"?E.includes("ALL_MARSHALS"):(S==="EveryoneAtCheckpoints"||S==="OnePerCheckpoint")&&B==="Checkpoint"?E.includes("ALL_CHECKPOINTS")?!0:E.some(q=>a.pendingLocationIds.includes(q)):S==="OnePerCheckpoint"&&B==="Area"?E.includes("ALL_AREAS")?!0:E.some(q=>g.value.includes(q)):(S==="EveryoneInAreas"||S==="OnePerArea"||S==="EveryAreaLead"||S==="OneLeadPerArea")&&B==="Area"?E.includes("ALL_AREAS")?!0:E.some(q=>g.value.includes(q)):!1},_=U(()=>a.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(S=>y(S)):!1)),b=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[x]||x,C=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const S=x.scopeConfigurations.find(E=>y(E));if(!S)return b(x.scopeConfigurations[0].scope);const B=S.ids||[];return B.includes("ALL_MARSHALS")?"Everyone":B.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:B.includes("ALL_AREAS")?`All ${o.value.areas}`:b(S.scope)},I=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const S=x.scopeConfigurations.find(E=>y(E));return S&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[S.scope]||""},$=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const S=x.scopeConfigurations.find(q=>y(q));if(!S)return null;const B=S.itemType,E=S.ids||[];if(E.includes("ALL_MARSHALS")||E.includes("ALL_CHECKPOINTS")||E.includes("ALL_AREAS"))return null;if(B==="Checkpoint"){const q=a.allLocations.filter(P=>E.includes(P.id)&&a.pendingLocationIds.includes(P.id)).map(P=>P.name);if(q.length>0)return`At: ${q.join(", ")}`}if(B==="Area"){const q=a.areas.filter(P=>E.includes(P.id)&&g.value.includes(P.id)).map(P=>P.name);if(q.length>0)return`In: ${q.join(", ")}`}return null};return(x,S)=>(v(),m("div",wP,[l("div",CP,[l("p",LP,w(e.isEditing?`Add new ${D(o).checklist} for this ${D(o).person}:`:`${D(o).checklists} that will apply to this ${D(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=B=>i.value=!i.value)},w(i.value?"Cancel":`Add ${D(o).checklist}`),1)]),i.value?(v(),m("div",SP,[ze(l("input",{"onUpdate:modelValue":S[1]||(S[1]=B=>r.value=B),type:"text",placeholder:`Enter ${D(o).checklist} text...`,class:"add-item-input",onKeyup:Jo(d,["enter"])},null,40,IP),[[tt,r.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim(),onClick:d}," Add ",8,xP)])):A("",!0),u.value.length>0?(v(),m("div",$P,[(v(!0),m(Me,null,Fe(u.value,(B,E)=>(v(),m("div",{key:`pending-${E}`,class:"checklist-item pending"},[S[3]||(S[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",TP,[l("div",MP,[l("div",AP,w(B.text),1),l("div",EP,[S[2]||(S[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:q=>h(E),title:"Remove"},"  ",8,PP)])])])]))),128))])):A("",!0),!e.isEditing&&_.value.length===0&&u.value.length===0?(v(),m("div",DP,[l("p",null,"No "+w(D(o).checklists)+" will apply based on the current "+w(D(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",OP," Assign "+w(D(o).checkpoints)+" to see relevant "+w(D(o).checklists)+". ",1)):A("",!0)])):A("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",RP,[(v(!0),m(Me,null,Fe(_.value,B=>(v(),m("div",{key:B.id,class:"checklist-item"},[S[4]||(S[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",BP,[l("div",NP,[l("div",FP,w(B.text),1),l("div",UP,[l("span",{class:"scope-pill",title:I(B)},w(C(B)),9,zP)])]),$(B)?(v(),m("div",HP,w($(B)),1)):A("",!0)])]))),128))])):A("",!0)]))}},GP=Ge(VP,[["__scopeId","data-v-6deaacc2"]]),jP={class:"notes-preview"},ZP={class:"preview-actions"},qP={class:"preview-header"},WP={key:0,class:"add-item-form"},KP={class:"add-form-fields"},JP=["disabled"],YP={key:1,class:"pending-items"},XP={class:"note-header"},QP={class:"note-title"},e6={class:"note-actions"},t6=["onClick"],n6={key:0,class:"note-content"},o6={key:2,class:"empty-state"},s6={key:0,class:"help-text"},a6={key:3,class:"notes-list"},i6={class:"note-header"},l6={class:"note-title"},r6=["title"],c6={key:0,class:"note-content"},u6={key:1,class:"note-context"},d6={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M(""),d=M([...a.modelValue]);Ze(()=>a.modelValue,S=>{d.value=[...S]},{deep:!0});const h=()=>{!r.value.trim()&&!u.value.trim()||(d.value.push({title:r.value.trim(),content:u.value.trim(),isNew:!0}),r.value="",u.value="",i.value=!1,g())},p=S=>{d.value.splice(S,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},y=U(()=>{const S=new Set;for(const B of a.pendingLocationIds){const E=a.allLocations.find(q=>q.id===B);E&&(E.areaIds||E.AreaIds||[]).forEach(P=>S.add(P))}return[...S]}),_=S=>{const B=S.scope,E=S.itemType,q=S.ids||[];return B==="SpecificPeople"&&E==="Marshal"?q.includes("ALL_MARSHALS"):B==="EveryoneAtCheckpoints"&&E==="Checkpoint"?q.includes("ALL_CHECKPOINTS")?!0:q.some(P=>a.pendingLocationIds.includes(P)):B==="EveryoneInAreas"&&E==="Area"?q.includes("ALL_AREAS")?!0:q.some(P=>y.value.includes(P)):!1},b=U(()=>a.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>_(B)):!1)),C=S=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(q=>_(q));if(!B)return C(S.scopeConfigurations[0].scope);const E=B.ids||[];return E.includes("ALL_MARSHALS")?"Everyone":E.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${o.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(q=>_(q));return B&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[B.scope]||""},x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(P=>_(P));if(!B)return null;const E=B.itemType,q=B.ids||[];if(q.includes("ALL_MARSHALS")||q.includes("ALL_CHECKPOINTS")||q.includes("ALL_AREAS"))return null;if(E==="Checkpoint"){const P=a.allLocations.filter(F=>q.includes(F.id)&&a.pendingLocationIds.includes(F.id)).map(F=>F.name);if(P.length>0)return`At: ${P.join(", ")}`}if(E==="Area"){const P=a.areas.filter(F=>q.includes(F.id)&&y.value.includes(F.id)).map(F=>F.name);if(P.length>0)return`In: ${P.join(", ")}`}return null};return(S,B)=>(v(),m("div",jP,[l("div",ZP,[l("p",qP,w(e.isEditing?`Add new note for this ${D(o).person}:`:`Notes that will be visible to this ${D(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=E=>i.value=!i.value)},w(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",WP,[l("div",KP,[ze(l("input",{"onUpdate:modelValue":B[1]||(B[1]=E=>r.value=E),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[tt,r.value]]),ze(l("textarea",{"onUpdate:modelValue":B[2]||(B[2]=E=>u.value=E),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[tt,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim()&&!u.value.trim(),onClick:h}," Add ",8,JP)])):A("",!0),d.value.length>0?(v(),m("div",YP,[(v(!0),m(Me,null,Fe(d.value,(E,q)=>(v(),m("div",{key:`pending-${q}`,class:"note-item pending"},[l("div",XP,[l("span",QP,w(E.title||"Untitled"),1),l("div",e6,[B[3]||(B[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:P=>p(q),title:"Remove"},"  ",8,t6)])]),E.content?(v(),m("div",n6,w(E.content),1)):A("",!0)]))),128))])):A("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(v(),m("div",o6,[l("p",null,"No notes will be visible based on the current "+w(D(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",s6," Assign "+w(D(o).checkpoints)+" to see relevant notes. ",1)):A("",!0)])):A("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",a6,[(v(!0),m(Me,null,Fe(b.value,E=>(v(),m("div",{key:E.id,class:"note-item"},[l("div",i6,[l("span",l6,w(E.title||"Untitled"),1),l("span",{class:"scope-pill",title:$(E)},w(I(E)),9,r6)]),E.content?(v(),m("div",c6,w(E.content),1)):A("",!0),x(E)?(v(),m("div",u6,w(x(E)),1)):A("",!0)]))),128))])):A("",!0)]))}},h6=Ge(d6,[["__scopeId","data-v-e8e0946a"]]),f6={key:6,class:"tab-content incidents-tab"},p6={class:"incidents-list"},v6={class:"custom-footer"},m6={class:"footer-left"},g6={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ct(),i=e,r=o,u=M("details"),d=M(null),h=M(null),p=M(null),g=M([]),y=M([]),_=M([]),b=M([]),C=M({name:"",email:"",phoneNumber:"",notes:""}),I=M(!1),$=M(null),x=ce=>{$.value=ce,I.value=!0},S=()=>{I.value=!1,$.value=null},B=ce=>i.allLocations.find(N=>N.id===ce),E=U(()=>C.value.name||i.marshal?.name||""),q=U(()=>$.value&&B($.value.locationId)?.name||""),P=U(()=>{if(!$.value)return null;const{checkInLatitude:ce,checkInLongitude:N}=$.value;return!ce||!N?null:{lat:ce,lng:N}}),F=U(()=>{if(!$.value)return null;const ce=B($.value.locationId);return!ce?.latitude||!ce?.longitude?null:{lat:ce.latitude,lng:ce.longitude}}),R=U(()=>{if(!$.value)return null;const{checkInLatitude:ce,checkInLongitude:N,locationId:K}=$.value,ae=B(K);return!ce||!N||!ae?.latitude||!ae?.longitude?null:di(ce,N,ae.latitude,ae.longitude)}),j=U(()=>{const ce=i.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,N=C.value.name?.trim();return N?`${ce} - ${N}`:ce}),O=U(()=>{const ce=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ce.push({value:"incidents",label:"Incidents",icon:"incidents"}),ce}),G=U(()=>O.value.findIndex(ce=>ce.value===u.value)),Q=U(()=>G.value===O.value.length-1),se=U(()=>Q.value?null:O.value[G.value+1]),pe=U(()=>se.value?`${se.value.label}...`:""),ee=U(()=>y.value.map(ce=>ce.locationId)),te=U(()=>i.isEditing?i.assignments:y.value.map(ce=>({id:`pending-${ce.locationId}`,locationId:ce.locationId,locationName:i.allLocations.find(N=>N.id===ce.locationId)?.name||"Unknown",isPending:!0}))),z=U(()=>{if(i.isEditing)return i.availableLocations;const ce=y.value.map(N=>N.locationId);return i.allLocations.filter(N=>!ce.includes(N.id))});Ze(()=>i.marshal,ce=>{ce?C.value={name:ce.name||"",email:ce.email||"",phoneNumber:ce.phoneNumber||"",notes:ce.notes||""}:C.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ze(()=>i.show,ce=>{ce&&(u.value="details",g.value=[],y.value=[],_.value=[],b.value=[],i.isEditing||(C.value={name:"",email:"",phoneNumber:"",notes:""}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),p.value?.resetLocalState&&p.value.resetLocalState())});const Y=ce=>{C.value=ce},ue=()=>{r("update:isDirty",!0)},ke=()=>{r("update:isDirty",!0)},Re=()=>{se.value&&(u.value=se.value.value)},Ye=()=>{const ce={...C.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:g.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:_.value,pendingNewNotes:b.value};r("save",ce)},Ne=()=>{r("delete")},Ke=ce=>{!i.isEditing&&ce.isPending?y.value=y.value.filter(N=>N.locationId!==ce.locationId):r("remove-assignment",ce)},We=ce=>{i.isEditing?r("assign-to-location",ce):(y.value.push({locationId:ce}),r("update:isDirty",!0))},X=ce=>{r("select-checkpoint",ce)},_e=()=>{r("close")};return t({switchToTab:ce=>{u.value=ce},focusField:ce=>{d.value?.focusField&&d.value.focusField(ce)}}),(ce,N)=>(v(),qe(Gt,{show:e.show,title:j.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:_e},{"tab-header":He(()=>[Ee(Qi,{modelValue:u.value,"onUpdate:modelValue":N[0]||(N[0]=K=>u.value=K),tabs:O.value},null,8,["modelValue","tabs"])]),footer:He(()=>[l("div",v6,[l("div",m6,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:Ne,class:"btn btn-danger"}," Delete ")):A("",!0),!e.isEditing&&!Q.value?(v(),m("button",{key:1,type:"button",onClick:Re,class:"btn btn-secondary mobile-only"},w(pe.value),1)):A("",!0)]),l("button",{type:"button",onClick:Ye,class:"btn btn-success"}," Save ")])]),default:He(()=>[u.value==="details"?(v(),qe(j3,{key:0,ref_key:"detailsTabRef",ref:d,form:C.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Y,onInput:ue},null,8,["form","event-id","marshal-id","validation-errors"])):A("",!0),u.value==="checkpoints"?(v(),qe(vP,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:te.value,"available-locations":z.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:ue,onRemoveAssignment:Ke,onAssignToLocation:We,onSelectCheckpoint:X,onDistanceClick:x},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):A("",!0),u.value==="checklists"&&e.isEditing?(v(),qe(bP,{key:2,ref_key:"checklistTabRef",ref:p,modelValue:g.value,"onUpdate:modelValue":N[1]||(N[1]=K=>g.value=K),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ke},null,8,["modelValue","event-id","marshal-id","locations","areas"])):A("",!0),u.value==="checklists"?(v(),qe(GP,{key:3,modelValue:_.value,"onUpdate:modelValue":N[2]||(N[2]=K=>_.value=K),"all-checklist-items":e.allChecklistItems,"pending-location-ids":ee.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):A("",!0),u.value==="notes"&&e.isEditing?(v(),qe(Cc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):A("",!0),u.value==="notes"?(v(),qe(h6,{key:5,modelValue:b.value,"onUpdate:modelValue":N[3]||(N[3]=K=>b.value=K),"all-notes":e.eventNotes,"pending-location-ids":ee.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ue},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):A("",!0),u.value==="incidents"?(v(),m("div",f6,[l("div",p6,[(v(!0),m(Me,null,Fe(e.incidents,K=>(v(),qe(er,{key:K.incidentId,incident:K,onSelect:N[4]||(N[4]=ae=>ce.$emit("select-incident",ae))},null,8,["incident"]))),128))])])):A("",!0),Ee(dd,{show:I.value,"marshal-name":E.value,"checkpoint-name":q.value,"check-in-location":P.value,"checkpoint-location":F.value,distance:R.value,"z-index":e.zIndex+100,onClose:S},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},y6=Ge(g6,[["__scopeId","data-v-f4e8a66c"]]),k6={class:"locations-list"},_6={class:"conflict-actions"},b6={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=t,i=u=>{s("choice",u)},r=()=>{s("close")};return(u,d)=>(v(),qe(Gt,{show:e.show,title:`${D(o).person} already assigned`,size:"medium","z-index":1100,onClose:r},{actions:He(()=>[l("div",_6,[l("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+w(D(a).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:He(()=>[l("p",null,[l("strong",null,w(e.conflictData.marshalName),1),d[4]||(d[4]=Qe(" is currently assigned to: ",-1))]),l("ul",k6,[(v(!0),m(Me,null,Fe(e.conflictData.locations,h=>(v(),m("li",{key:h},w(h),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},w6=Ge(b6,[["__scopeId","data-v-997e8aaa"]]),C6={key:0,class:"assign-marshal-section"},L6={value:""},S6=["value"],I6=["disabled"],x6={key:1,class:"assign-marshal-section create-mode"},$6={class:"form-group"},T6={class:"form-group"},M6={class:"form-group"},A6={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M({name:"",email:"",phoneNumber:""});Ze(()=>a.show,_=>{_||(i.value=!1,r.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{r.value&&s("assign-existing",r.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{s("close")};return(_,b)=>(v(),qe(Gt,{show:e.show,title:i.value?`Create new ${D(o).person}`:`Assign ${D(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:He(()=>[i.value?(v(),m(Me,{key:0},[l("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):A("",!0)]),default:He(()=>[i.value?(v(),m("div",x6,[l("h3",null,"Create new "+w(D(o).person),1),l("div",$6,[b[5]||(b[5]=l("label",null,"Name *",-1)),ze(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>u.value.name=C),type:"text",required:"",class:"form-input"},null,512),[[tt,u.value.name]])]),l("div",T6,[b[6]||(b[6]=l("label",null,"Email",-1)),ze(l("input",{"onUpdate:modelValue":b[2]||(b[2]=C=>u.value.email=C),type:"email",class:"form-input"},null,512),[[tt,u.value.email]])]),l("div",M6,[b[7]||(b[7]=l("label",null,"Phone",-1)),ze(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>u.value.phoneNumber=C),type:"tel",class:"form-input"},null,512),[[tt,u.value.phoneNumber]])])])):(v(),m("div",C6,[l("h3",null,"Select existing "+w(D(o).person),1),ze(l("select",{"onUpdate:modelValue":b[0]||(b[0]=C=>r.value=C),class:"form-input"},[l("option",L6,"Choose a "+w(D(o).person)+"...",1),(v(!0),m(Me,null,Fe(e.marshals,C=>(v(),m("option",{key:C.id,value:C.id},[Qe(w(C.name)+" ",1),C.assignedLocationIds&&C.assignedLocationIds.length>0?(v(),m(Me,{key:0},[Qe(" (assigned to "+w(C.assignedLocationIds.length)+" "+w(C.assignedLocationIds.length>1?D(o).checkpoints:D(o).checkpoint)+") ",1)],64)):A("",!0)],8,S6))),128))],512),[[Fn,r.value]]),l("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!r.value}," Assign selected "+w(D(o).person),9,I6),b[4]||(b[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+w(D(o).person),1)]))]),_:1},8,["show","title"]))}},E6=Ge(A6,[["__scopeId","data-v-fa70b913"]]),P6={class:"shift-times-content"},D6={class:"info-text"},O6={class:"time-delta-info"},R6={class:"delta-detail"},B6={class:"delta-detail"},N6={class:"delta-summary"},F6={class:"affected-checkpoints"},U6={class:"option-selection"},z6={class:"radio-option"},H6={class:"radio-option"},V6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),s=e,i=t,r=M("shift"),u=U(()=>{const y=new Date(s.oldEventDate);return new Date(s.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const _=Math.abs(y),b=y>=0?"+":"-",C=Math.floor(_/(1e3*60*60*24)),I=Math.floor(_%(1e3*60*60*24)/(1e3*60*60)),$=Math.floor(_%(1e3*60*60)/(1e3*60)),x=[];return C>0&&x.push(`${C}d`),I>0&&x.push(`${I}h`),$>0&&x.push(`${$}m`),`${b}${x.join(" ")}`},p=()=>{i("confirm",{shouldShift:r.value==="shift",timeDelta:u.value})},g=()=>{i("cancel")};return(y,_)=>(v(),qe(Gt,{show:e.show,title:`Shift ${D(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:He(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary"},w(r.value==="shift"?"Shift Times":"Keep Times"),1)]),default:He(()=>[l("div",P6,[l("p",D6," You've changed the event date/time. Some "+w(D(a).checkpoints)+" have custom times set. ",1),l("div",O6,[_[2]||(_[2]=l("strong",null,"Event time change:",-1)),l("div",R6," Old: "+w(d(e.oldEventDate)),1),l("div",B6," New: "+w(d(e.newEventDate)),1),l("div",N6," Delta: "+w(h(u.value)),1)]),l("p",F6,[l("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?D(a).checkpoint:D(a).checkpoints),1),_[3]||(_[3]=Qe(" with custom times will be shifted by the same amount. ",-1))]),l("div",U6,[l("label",z6,[ze(l("input",{"onUpdate:modelValue":_[0]||(_[0]=b=>r.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[kh,r.value]]),l("div",null,[l("strong",null,"Shift all "+w(D(a).checkpoint)+" times",1),_[4]||(_[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",H6,[ze(l("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>r.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[kh,r.value]]),l("div",null,[l("strong",null,"Keep "+w(D(a).checkpoint)+" times unchanged",1),l("small",null,w(D(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},G6=Ge(V6,[["__scopeId","data-v-a6454aff"]]),j6={class:"checklist-preview"},Z6={class:"preview-actions"},q6={class:"preview-header"},W6={key:0,class:"add-item-form"},K6=["placeholder"],J6=["disabled"],Y6={key:1,class:"pending-items"},X6={class:"item-content"},Q6={class:"item-header"},e5={class:"item-text"},t5={class:"item-scope"},n5=["onClick"],o5={key:2,class:"empty-state"},s5={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M([...a.modelValue]);Ze(()=>a.modelValue,g=>{u.value=[...g]},{deep:!0});const d=()=>{r.value.trim()&&(u.value.push({text:r.value.trim(),isNew:!0}),r.value="",i.value=!1,p())},h=g=>{u.value.splice(g,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")};return(g,y)=>(v(),m("div",j6,[l("div",Z6,[l("p",q6," Add new "+w(D(o).checklist)+" for this "+w(D(o).area)+": ",1),l("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=_=>i.value=!i.value)},w(i.value?"Cancel":`Add ${D(o).checklist}`),1)]),i.value?(v(),m("div",W6,[ze(l("input",{"onUpdate:modelValue":y[1]||(y[1]=_=>r.value=_),type:"text",placeholder:`Enter ${D(o).checklist} text...`,class:"add-item-input",onKeyup:Jo(d,["enter"])},null,40,K6),[[tt,r.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim(),onClick:d}," Add ",8,J6)])):A("",!0),u.value.length>0?(v(),m("div",Y6,[(v(!0),m(Me,null,Fe(u.value,(_,b)=>(v(),m("div",{key:`pending-${b}`,class:"checklist-item pending"},[y[3]||(y[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",X6,[l("div",Q6,[l("div",e5,w(_.text),1),l("div",t5,[y[2]||(y[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:C=>h(b),title:"Remove"},"  ",8,n5)])])])]))),128))])):A("",!0),u.value.length===0&&!i.value?(v(),m("div",o5,[l("p",null,"No new "+w(D(o).checklists)+" to add. Click the button above to create one.",1)])):A("",!0)]))}},a5=Ge(s5,[["__scopeId","data-v-a394c400"]]),i5={class:"notes-preview"},l5={class:"preview-actions"},r5={class:"preview-header"},c5={key:0,class:"add-item-form"},u5={class:"add-form-fields"},d5=["disabled"],h5={key:1,class:"pending-items"},f5={class:"note-header"},p5={class:"note-title"},v5={class:"note-actions"},m5=["onClick"],g5={key:0,class:"note-content"},y5={key:2,class:"empty-state"},k5={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M(""),d=M([...a.modelValue]);Ze(()=>a.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!r.value.trim()&&!u.value.trim()||(d.value.push({title:r.value.trim(),content:u.value.trim(),isNew:!0}),r.value="",u.value="",i.value=!1,g())},p=y=>{d.value.splice(y,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")};return(y,_)=>(v(),m("div",i5,[l("div",l5,[l("p",r5," Add new note for this "+w(D(o).area)+": ",1),l("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=b=>i.value=!i.value)},w(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",c5,[l("div",u5,[ze(l("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>r.value=b),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[tt,r.value]]),ze(l("textarea",{"onUpdate:modelValue":_[2]||(_[2]=b=>u.value=b),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[tt,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim()&&!u.value.trim(),onClick:h}," Add ",8,d5)])):A("",!0),d.value.length>0?(v(),m("div",h5,[(v(!0),m(Me,null,Fe(d.value,(b,C)=>(v(),m("div",{key:`pending-${C}`,class:"note-item pending"},[l("div",f5,[l("span",p5,w(b.title||"Untitled"),1),l("div",v5,[_[3]||(_[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:I=>p(C),title:"Remove"},"  ",8,m5)])]),b.content?(v(),m("div",g5,w(b.content),1)):A("",!0)]))),128))])):A("",!0),d.value.length===0&&!i.value?(v(),m("div",y5,[..._[4]||(_[4]=[l("p",null,"No new notes to add. Click the button above to create one.",-1)])])):A("",!0)]))}},_5=Ge(k5,[["__scopeId","data-v-5e6bdcab"]]),b5={class:"search-section"},w5={class:"form-group"},C5={class:"suggestions-list"},L5={class:"suggestion-content"},S5={key:0,class:"suggestion-detail"},I5=["onClick"],x5={class:"suggestion-content"},$5={class:"suggestion-name"},T5={key:0,class:"suggestion-detail"},M5=["onClick"],A5={class:"suggestion-content"},E5={class:"suggestion-name"},P5={key:0,class:"suggestion-detail"},D5={key:1,class:"no-results"},O5={key:2,class:"no-results"},R5={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,s=t,i=M(""),r=M(null),u=U(()=>a.contacts.filter(P=>a.excludeContactIds.includes(P.contactId)&&P.marshalId).map(P=>P.marshalId)),d=U(()=>a.contacts.filter(P=>P.marshalId).map(P=>P.marshalId)),h=U(()=>a.contacts.filter(P=>!a.excludeContactIds.includes(P.contactId))),p=U(()=>a.marshals.filter(P=>!u.value.includes(P.id)&&!d.value.includes(P.id))),g=P=>P?P.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=U(()=>{const P=g(i.value);return P?P.split(" ").filter(F=>F.length>0):[]}),_=(P,F)=>{if(F.length===0)return{score:1,isPartial:!1};const R=g(P);let j=0;for(const O of F)R.includes(O)&&j++;return{score:j,isPartial:j>0&&j<F.length,isFullMatch:j===F.length}},b=U(()=>{const P=y.value,F=[];return h.value.forEach(R=>{const j=`${R.name||""} ${R.role||""}`,O=_(j,P);(P.length===0||O.score>0)&&F.push({key:`contact-${R.contactId}`,type:"contact",name:R.name,detail:R.role?q(R.role):null,data:R,matchScore:O.score,isPartial:O.isPartial,isFullMatch:O.isFullMatch})}),p.value.forEach(R=>{const j=`${R.name||""} ${R.email||""}`,O=_(j,P);(P.length===0||O.score>0)&&F.push({key:`marshal-${R.id}`,type:"marshal",name:R.name,detail:R.email||R.phoneNumber||null,data:R,matchScore:O.score,isPartial:O.isPartial,isFullMatch:O.isFullMatch})}),F.sort((R,j)=>j.matchScore!==R.matchScore?j.matchScore-R.matchScore:R.name.localeCompare(j.name,void 0,{sensitivity:"base"})),F}),C=U(()=>y.value.length===0?b.value:b.value.filter(P=>P.isFullMatch)),I=U(()=>y.value.length===0?[]:b.value.filter(P=>P.isPartial)),$=U(()=>I.value.length>0);Ze(()=>a.show,async P=>{P&&(i.value="",await sn(),r.value?.focus())});const x=P=>{const F=a.contacts.find(R=>R.marshalId===P.id);if(F){if(a.excludeContactIds.includes(F.contactId))return;s("select-contact",F)}else s("create-from-marshal",P)},S=P=>{s("select-contact",P)},B=()=>{s("create-new",i.value.trim())},E=()=>{s("close")},q=P=>P?P.replace(/([A-Z])/g," $1").replace(/^./,F=>F.toUpperCase()).trim():"";return(P,F)=>(v(),qe(Gt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:E},{actions:He(()=>[l("button",{onClick:E,class:"btn btn-secondary"}," Cancel ")]),default:He(()=>[l("div",b5,[l("div",w5,[F[1]||(F[1]=l("label",null,"Search or create",-1)),ze(l("input",{ref_key:"searchInputRef",ref:r,"onUpdate:modelValue":F[0]||(F[0]=R=>i.value=R),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[tt,i.value]])]),l("div",C5,[l("div",{class:"suggestion-item create-new",onClick:B},[F[3]||(F[3]=l("span",{class:"suggestion-icon create-icon"},"+",-1)),l("div",L5,[F[2]||(F[2]=l("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),m("span",S5,'"'+w(i.value.trim())+'"',1)):A("",!0)])]),(v(!0),m(Me,null,Fe(C.value,R=>(v(),m("div",{key:R.key,class:"suggestion-item",onClick:j=>R.type==="marshal"?x(R.data):S(R.data)},[l("span",{class:ve(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},w(R.type==="marshal"?"M":"C"),3),l("div",x5,[l("span",$5,w(R.name),1),R.detail?(v(),m("span",T5,w(R.detail),1)):A("",!0)]),l("span",{class:ve(["suggestion-badge",{"contact-badge":R.type==="contact"}])},w(R.type==="marshal"?D(o).person:"Contact"),3)],8,I5))),128)),$.value?(v(),m(Me,{key:0},[F[4]||(F[4]=l("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(Me,null,Fe(I.value,R=>(v(),m("div",{key:R.key,class:"suggestion-item",onClick:j=>R.type==="marshal"?x(R.data):S(R.data)},[l("span",{class:ve(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},w(R.type==="marshal"?"M":"C"),3),l("div",A5,[l("span",E5,w(R.name),1),R.detail?(v(),m("span",P5,w(R.detail),1)):A("",!0)]),l("span",{class:ve(["suggestion-badge",{"contact-badge":R.type==="contact"}])},w(R.type==="marshal"?D(o).person:"Contact"),3)],8,M5))),128))],64)):A("",!0),i.value.trim()&&C.value.length===0&&I.value.length===0?(v(),m("div",D5," No matching "+w(D(o).people.toLowerCase())+" or contacts found. ",1)):A("",!0),!i.value.trim()&&C.value.length===0?(v(),m("div",O5," No "+w(D(o).people.toLowerCase())+" or contacts available to add. ",1)):A("",!0)])])]),_:1},8,["show","title"]))}},B5=Ge(R5,[["__scopeId","data-v-e25ca97b"]]),N5={key:0,class:"tab-content"},F5={class:"form-group"},U5=["disabled"],z5={class:"form-group"},H5={key:1,class:"tab-content"},V5={class:"boundary-section"},G5={key:0,class:"boundary-preview"},j5={class:"boundary-actions"},Z5={key:2,class:"tab-content"},q5={class:"contacts-header"},W5={class:"section-title"},K5={key:3,class:"tab-content"},J5={class:"section-title"},Y5={key:4,class:"placeholder-message"},X5={key:7,class:"placeholder-message"},Q5={key:10,class:"placeholder-message"},e8={key:11,class:"tab-content appearance-tab"},t8={class:"accordion-item"},n8=["innerHTML"],o8={class:"accordion-title"},s8={class:"accordion-arrow"},a8={key:0,class:"accordion-content"},i8={class:"section-description"},l8={class:"color-picker"},r8=["title","onClick"],c8={class:"accordion-item"},u8=["innerHTML"],d8={class:"accordion-title"},h8={class:"accordion-arrow"},f8={key:0,class:"accordion-content"},p8={class:"section-description"},v8={class:"accordion-item"},m8={class:"accordion-title"},g8={class:"accordion-preview"},y8={class:"accordion-arrow"},k8={key:0,class:"accordion-content"},_8={class:"section-description"},b8={class:"form-group"},w8={value:""},C8=["value"],L8={class:"accordion-item"},S8={class:"accordion-title"},I8={class:"accordion-preview"},x8={class:"accordion-arrow"},$8={key:0,class:"accordion-content"},T8={class:"section-description"},M8={class:"form-group"},A8={value:""},E8=["value"],P8={key:12,class:"tab-content incidents-tab"},D8={class:"incidents-list"},O8={class:"custom-footer"},R8={class:"footer-left"},gf="edit_area_accordion",B8={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ct(),i=()=>E.value.peopleTerm?E.value.peopleTerm:d.eventPeopleTerm||"Marshals",r=(Z=!0)=>{const W=E.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",ie=i();return Z?Kv("checkpoint",W,ie):ei("checkpoint",W,ie)},u=(Z=!0)=>r(Z).toLowerCase(),d=e,h=o,p=M("details"),g=M(null),y=M([]),_=M({}),b=M({}),C=M(!1),I=M(!1),$=M([]),x=M([]),S=M([]),B=M([]),E=M({name:"",description:"",color:$r,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),q=()=>({name:"",description:"",color:G2(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),P=()=>d.eventId?`${gf}_${d.eventId}`:gf,F=M({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});Qt(()=>{const Z=localStorage.getItem(P());if(Z)try{const W=JSON.parse(Z);F.value={...F.value,...W}}catch{}});const R=Z=>{F.value[Z]=!F.value[Z],localStorage.setItem(P(),JSON.stringify(F.value))},j=U(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${E.value.color||$r}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),O=U(()=>{const Z=E.value.checkpointStyleType!=="default"||E.value.checkpointStyleBackgroundShape||E.value.checkpointStyleBackgroundColor||E.value.checkpointStyleBorderColor||E.value.checkpointStyleIconColor||E.value.checkpointStyleSize,W=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!Z&&!W)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const ie=E.value.checkpointStyleType&&E.value.checkpointStyleType!=="default"?E.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",Ue=E.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Xe=E.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",mt=E.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",_t=E.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",gt=E.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Sn({type:ie!=="default"?ie:Ue,backgroundShape:Ue,backgroundColor:Xe,borderColor:mt,iconColor:_t,size:gt,outputSize:24})}),G=U(()=>d.area&&d.area.id),Q=U(()=>!E.value.polygon||E.value.polygon.length===0?[]:E.value.polygon.map((Z,W)=>({id:`polygon-point-${W}`,latitude:Z.lat,longitude:Z.lng}))),se=U(()=>d.area?.id?d.areas.filter(Z=>Z.id!==d.area.id).map(Z=>({...Z,color:"#999999"})):d.areas.map(Z=>({...Z,color:"#999999"})));U(()=>ke.value.map(Z=>Z.id));const pe=U(()=>{const Z=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:r(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&Z.push({value:"incidents",label:"Incidents",icon:"incidents"}),Z}),ee=U(()=>pe.value.findIndex(Z=>Z.value===p.value)),te=U(()=>ee.value===pe.value.length-1),z=U(()=>te.value?null:pe.value[ee.value+1]),Y=U(()=>z.value?`${z.value.label}...`:""),ue=U(()=>{if(!d.area||!d.area.id)return[];const Z=d.checkpoints.filter(W=>W.areaIds&&W.areaIds.includes(d.area.id)).map(W=>W.id);return d.assignments.filter(W=>Z.includes(W.locationId))}),ke=U(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(Z=>Z.areaIds&&Z.areaIds.includes(d.area.id))),Re=U(()=>{const Z=[...ke.value];return Z.sort((W,ie)=>{const Ue=W.name.match(/^(\d+)/),Xe=ie.name.match(/^(\d+)/);if(Ue&&Xe){const mt=parseInt(Ue[1]),_t=parseInt(Xe[1]);if(mt!==_t)return mt-_t}return W.name.localeCompare(ie.name,void 0,{numeric:!0,sensitivity:"base"})}),Z}),Ye=U(()=>!d.area||!d.area.id?[]:d.contacts.filter(Z=>Z.scopeConfigurations?Z.scopeConfigurations.some(W=>W.scope==="EveryoneInAreas"&&W.itemType==="Area"?W.ids?.includes("ALL_AREAS")?!0:W.ids?.includes(d.area.id):!1):!1)),Ne=U(()=>{const Z=new Set(Ye.value.map(Ue=>Ue.contactId)),W=Ye.value.map(Ue=>({...Ue,isPending:!1,isExisting:!0,isMarkedForRemoval:x.value.includes(Ue.contactId)})),ie=$.value.filter(Ue=>!Z.has(Ue.contactId)).map(Ue=>({...Ue,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...W,...ie].sort((Ue,Xe)=>Ue.name.localeCompare(Xe.name,void 0,{sensitivity:"base"}))}),Ke=U(()=>{const Z=Ye.value.map(ie=>ie.contactId),W=$.value.map(ie=>ie.contactId);return[...Z,...W]}),We=async Z=>{if(!(_.value[Z]||b.value[Z])){b.value[Z]=!0;try{const ie=(await Rt.getCheckpointChecklist(d.eventId,Z)).data||[];_.value[Z]={total:ie.length,completed:ie.filter(Ue=>Ue.isCompleted).length}}catch(W){console.error("Failed to load checklist status for checkpoint:",Z,W),_.value[Z]={total:0,completed:0}}finally{b.value[Z]=!1}}};Ze(()=>d.area,Z=>{if(Z){const W=Z.polygon?typeof Z.polygon=="string"?JSON.parse(Z.polygon):Z.polygon:[];E.value={name:Z.name||"",description:Z.description||"",color:Z.color||$r,displayOrder:Z.displayOrder||0,isDefault:Z.isDefault||!1,polygon:W,checkpointStyleType:Z.checkpointStyleType||"default",checkpointStyleColor:Z.checkpointStyleColor||"",checkpointStyleBackgroundShape:Z.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:Z.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:Z.checkpointStyleBorderColor||"",checkpointStyleIconColor:Z.checkpointStyleIconColor||"",checkpointStyleSize:Z.checkpointStyleSize||"",checkpointStyleMapRotation:Z.checkpointStyleMapRotation??"",peopleTerm:Z.peopleTerm||"",checkpointTerm:Z.checkpointTerm||""}}else E.value=q()},{immediate:!0,deep:!0}),Ze(()=>d.show,Z=>{Z&&(p.value=d.initialTab||"details",y.value=[],_.value={},b.value={},$.value=[],x.value=[],S.value=[],B.value=[],I.value=!1,G.value||(E.value=q()),g.value?.resetLocalState&&g.value.resetLocalState())}),Ze(p,Z=>{Z==="checkpoints"&&d.area&&d.area.id&&ke.value.forEach(W=>{setTimeout(()=>We(W.id),0)})});const X=()=>{h("update:isDirty",!0)},_e=Z=>{E.value.color=Z,X()},Le=(Z,W)=>{E.value[Z]=W,X()},me=()=>{h("draw-boundary",E.value)},ce=Z=>{E.value.polygon=Z,X()},N=()=>{E.value.polygon=[],C.value=!1,X()},K=Z=>{I.value=!1,h("create-contact-from-marshal",{marshal:Z,area:d.area})},ae=Z=>{I.value=!1,h("create-new-contact",{name:Z,area:d.area})},Te=Z=>{$.value.find(W=>W.contactId===Z.contactId)||($.value.push(Z),X()),I.value=!1},Be=Z=>{$.value=$.value.filter(W=>W.contactId!==Z),X()},De=Z=>{x.value.includes(Z)||(x.value.push(Z),X())},Se=Z=>Z.isPending?"Remove pending contact":`Remove from ${s.value.area}`,J=Z=>{Ne.value.find(ie=>ie.contactId===Z)?.isPending?Be(Z):De(Z)},he=Z=>{x.value=x.value.filter(W=>W!==Z),X()},xe=Z=>{y.value=Z,X()},Ie=()=>{z.value&&(p.value=z.value.value)},be=()=>{const Z=d.area?{name:E.value.name,description:E.value.description,color:E.value.color,polygon:E.value.polygon.length>0?E.value.polygon:null,displayOrder:E.value.displayOrder,checkpointStyleType:E.value.checkpointStyleType,checkpointStyleColor:E.value.checkpointStyleColor,checkpointStyleBackgroundShape:E.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:E.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:E.value.checkpointStyleBorderColor,checkpointStyleIconColor:E.value.checkpointStyleIconColor,checkpointStyleSize:E.value.checkpointStyleSize,checkpointStyleMapRotation:E.value.checkpointStyleMapRotation!=null&&E.value.checkpointStyleMapRotation!==""?String(E.value.checkpointStyleMapRotation):null,peopleTerm:E.value.peopleTerm,checkpointTerm:E.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:$.value||[],contactsToRemove:x.value||[],pendingNewChecklistItems:S.value||[],pendingNewNotes:B.value||[]}:{name:E.value.name,description:E.value.description,color:E.value.color,polygon:E.value.polygon.length>0?E.value.polygon:null,checkpointStyleType:E.value.checkpointStyleType,checkpointStyleColor:E.value.checkpointStyleColor,checkpointStyleBackgroundShape:E.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:E.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:E.value.checkpointStyleBorderColor,checkpointStyleIconColor:E.value.checkpointStyleIconColor,checkpointStyleSize:E.value.checkpointStyleSize,checkpointStyleMapRotation:E.value.checkpointStyleMapRotation!=null&&E.value.checkpointStyleMapRotation!==""?String(E.value.checkpointStyleMapRotation):null,peopleTerm:E.value.peopleTerm,checkpointTerm:E.value.checkpointTerm,pendingContacts:$.value||[]};h("save",Z)},de=()=>{h("delete",d.area.id)},fe=()=>{h("close")};return t({addPendingContact:Z=>{Z&&!$.value.find(W=>W.contactId===Z.contactId)&&($.value.push(Z),X())},removeContactById:Z=>{const W=$.value.some(ie=>ie.contactId===Z);$.value=$.value.filter(ie=>ie.contactId!==Z),x.value=x.value.filter(ie=>ie!==Z),W&&X()}}),(Z,W)=>(v(),qe(Gt,{show:e.show,title:e.area&&e.area.id?`Edit ${D(s).area}: ${e.area.name}`:`Create new ${D(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:fe},{"tab-header":He(()=>[Ee(Qi,{modelValue:p.value,"onUpdate:modelValue":W[0]||(W[0]=ie=>p.value=ie),tabs:pe.value},null,8,["modelValue","tabs"])]),footer:He(()=>[l("div",O8,[l("div",R8,[G.value&&!E.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:de,class:"btn btn-danger"}," Delete ")):A("",!0),!G.value&&!te.value?(v(),m("button",{key:1,type:"button",onClick:Ie,class:"btn btn-secondary mobile-only"},w(Y.value),1)):A("",!0)]),l("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:He(()=>[p.value==="details"?(v(),m("div",N5,[l("form",{onSubmit:it(be,["prevent"])},[l("div",F5,[W[27]||(W[27]=l("label",null,"Name *",-1)),ze(l("input",{"onUpdate:modelValue":W[1]||(W[1]=ie=>E.value.name=ie),type:"text",required:"",class:"form-input",disabled:E.value.isDefault,onInput:X},null,40,U5),[[tt,E.value.name]])]),l("div",z5,[W[28]||(W[28]=l("label",null,"Description",-1)),ze(l("textarea",{"onUpdate:modelValue":W[2]||(W[2]=ie=>E.value.description=ie),class:"form-input",rows:"3",onInput:X},null,544),[[tt,E.value.description]])])],32)])):A("",!0),p.value==="boundary"?(v(),m("div",H5,[l("div",V5,[E.value.polygon&&E.value.polygon.length>0?(v(),m("div",G5,[Ee(hi,{mode:"edit-polygon","editing-polygon":E.value.polygon,route:e.route,locations:e.checkpoints,areas:se.value,"all-locations-for-bounds":Q.value,height:"300px",onPolygonUpdate:ce},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),W[29]||(W[29]=l("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):A("",!0),l("div",j5,[!E.value.polygon||E.value.polygon.length===0?(v(),m("button",{key:0,onClick:me,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(Me,{key:1},[l("button",{onClick:me,class:"btn btn-secondary"}," Redraw "),l("button",{onClick:W[3]||(W[3]=ie=>C.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):A("",!0),Ee($a,{show:C.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:N,onCancel:W[4]||(W[4]=ie=>C.value=!1)},null,8,["show"]),p.value==="contacts"?(v(),m("div",Z5,[l("div",q5,[l("h3",W5,w(D(a).area)+" contacts ("+w(Ne.value.length)+")",1),l("button",{onClick:W[5]||(W[5]=ie=>I.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ee(tm,{contacts:Ne.value,"show-remove-button":!0,"remove-title":Se,"empty-message":`No contacts assigned to this ${D(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${D(s).people} in this ${D(s).area}.`,onSelect:W[6]||(W[6]=ie=>Z.$emit("edit-contact",ie)),onRemove:J,onUndoRemove:he},null,8,["contacts","empty-message","empty-hint"])])):A("",!0),Ee(B5,{show:I.value,"area-name":E.value.name||"this "+D(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Ke.value,onClose:W[7]||(W[7]=ie=>I.value=!1),onSelectContact:Te,onCreateFromMarshal:K,onCreateNew:ae},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),p.value==="checkpoints"&&G.value?(v(),m("div",K5,[l("h3",J5,w(r())+" in "+w(e.area?.name)+" ("+w(ke.value.length)+")",1),Ee(am,{checkpoints:Re.value,areas:e.areas,"empty-message":`No ${u()} in this ${D(s).area} yet.`,onSelect:W[8]||(W[8]=ie=>Z.$emit("select-checkpoint",ie))},null,8,["checkpoints","areas","empty-message"])])):A("",!0),p.value==="checkpoints"&&!G.value?(v(),m("div",Y5,[l("p",null,w(r())+" will be automatically assigned based on boundaries after the "+w(D(s).area)+" is created.",1)])):A("",!0),p.value==="checklists"&&G.value?(v(),qe(lm,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:y.value,"onUpdate:modelValue":W[9]||(W[9]=ie=>y.value=ie),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ue.value,marshals:e.marshals,onChange:xe},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):A("",!0),p.value==="checklists"&&G.value?(v(),qe(a5,{key:6,modelValue:S.value,"onUpdate:modelValue":W[10]||(W[10]=ie=>S.value=ie),onChange:X},null,8,["modelValue"])):A("",!0),p.value==="checklists"&&!G.value?(v(),m("div",X5,[l("p",null,w(D(a).checklists)+" can be assigned after the "+w(D(s).area)+" is created.",1)])):A("",!0),p.value==="notes"&&G.value?(v(),qe(Cc,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):A("",!0),p.value==="notes"&&G.value?(v(),qe(_5,{key:9,modelValue:B.value,"onUpdate:modelValue":W[11]||(W[11]=ie=>B.value=ie),onChange:X},null,8,["modelValue"])):A("",!0),p.value==="notes"&&!G.value?(v(),m("div",Q5,[l("p",null,"Notes can be viewed after the "+w(D(s).area)+" is created.",1)])):A("",!0),p.value==="appearance"?(v(),m("div",e8,[l("div",t8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:F.value.polygonColor}]),onClick:W[12]||(W[12]=ie=>R("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:j.value},null,8,n8),l("span",o8,w(D(a).area)+" polygon colour",1),l("span",s8,w(F.value.polygonColor?"":""),1)],2),F.value.polygonColor?(v(),m("div",a8,[l("p",i8," Choose a colour for this "+w(D(s).area)+"'s boundary on the map. ",1),l("div",l8,[(v(!0),m(Me,null,Fe(D(Pn),ie=>(v(),m("div",{key:ie.hex,class:ve(["color-swatch",{selected:E.value.color===ie.hex}]),style:et({backgroundColor:ie.hex}),title:ie.name,onClick:Ue=>_e(ie.hex)},null,14,r8))),128))])])):A("",!0)]),l("div",c8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:F.value.iconStyle}]),onClick:W[13]||(W[13]=ie=>R("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:O.value},null,8,u8),l("span",d8,w(r(!1))+" marker style",1),l("span",h8,w(F.value.iconStyle?"":""),1)],2),F.value.iconStyle?(v(),m("div",f8,[l("p",p8," Set a default marker style for all "+w(u())+" in this "+w(D(s).area)+". Individual "+w(u())+" can override this setting. ",1),Ee(hd,{"style-type":E.value.checkpointStyleType||"default","style-color":E.value.checkpointStyleColor||"","style-background-shape":E.value.checkpointStyleBackgroundShape||"","style-background-color":E.value.checkpointStyleBackgroundColor||"","style-border-color":E.value.checkpointStyleBorderColor||"","style-icon-color":E.value.checkpointStyleIconColor||"","style-size":E.value.checkpointStyleSize||"","style-map-rotation":E.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":W[14]||(W[14]=ie=>Le("checkpointStyleType",ie)),"onUpdate:styleColor":W[15]||(W[15]=ie=>Le("checkpointStyleColor",ie)),"onUpdate:styleBackgroundShape":W[16]||(W[16]=ie=>Le("checkpointStyleBackgroundShape",ie)),"onUpdate:styleBackgroundColor":W[17]||(W[17]=ie=>Le("checkpointStyleBackgroundColor",ie)),"onUpdate:styleBorderColor":W[18]||(W[18]=ie=>Le("checkpointStyleBorderColor",ie)),"onUpdate:styleIconColor":W[19]||(W[19]=ie=>Le("checkpointStyleIconColor",ie)),"onUpdate:styleSize":W[20]||(W[20]=ie=>Le("checkpointStyleSize",ie)),"onUpdate:styleMapRotation":W[21]||(W[21]=ie=>Le("checkpointStyleMapRotation",ie))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):A("",!0)]),l("div",v8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:F.value.peopleTerm}]),onClick:W[22]||(W[22]=ie=>R("peopleTerm"))},[W[30]||(W[30]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",m8,w(i())+" terminology",1),l("span",g8,w(E.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",y8,w(F.value.peopleTerm?"":""),1)],2),F.value.peopleTerm?(v(),m("div",k8,[l("p",_8," Choose what "+w(i().toLowerCase())+" are called in this "+w(D(s).area)+". This will be inherited by "+w(u())+" unless they override it. ",1),l("div",b8,[W[31]||(W[31]=l("label",null,"What are people called?",-1)),ze(l("select",{"onUpdate:modelValue":W[23]||(W[23]=ie=>E.value.peopleTerm=ie),class:"form-input",onChange:X},[l("option",w8,"Use event default ("+w(e.eventPeopleTerm)+")",1),(v(!0),m(Me,null,Fe(D(Bs).people,ie=>(v(),m("option",{key:ie,value:ie},w(ie),9,C8))),128))],544),[[Fn,E.value.peopleTerm]])])])):A("",!0)]),l("div",L8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:F.value.checkpointTerm}]),onClick:W[24]||(W[24]=ie=>R("checkpointTerm"))},[W[32]||(W[32]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",S8,w(r(!1))+" terminology",1),l("span",I8,w(E.value.checkpointTerm?D(Mu)(E.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),l("span",x8,w(F.value.checkpointTerm?"":""),1)],2),F.value.checkpointTerm?(v(),m("div",$8,[l("p",T8," Choose what "+w(u())+" are called in this "+w(D(s).area)+". ",1),l("div",M8,[l("label",null,"What are "+w(u())+" called?",1),ze(l("select",{"onUpdate:modelValue":W[25]||(W[25]=ie=>E.value.checkpointTerm=ie),class:"form-input",onChange:X},[l("option",A8,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(v(!0),m(Me,null,Fe(D(Bs).checkpoint,ie=>(v(),m("option",{key:ie,value:ie},w(D(Mu)(ie,i())),9,E8))),128))],544),[[Fn,E.value.checkpointTerm]])])])):A("",!0)])])):A("",!0),p.value==="incidents"?(v(),m("div",P8,[l("div",D8,[(v(!0),m(Me,null,Fe(e.incidents,ie=>(v(),qe(er,{key:ie.incidentId,incident:ie,onSelect:W[26]||(W[26]=Ue=>Z.$emit("select-incident",Ue))},null,8,["incident"]))),128))])])):A("",!0)]),_:1},8,["show","title","is-dirty"]))}},N8=Ge(B8,[["__scopeId","data-v-1f35a436"]]),F8=["innerHTML"],U8={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(s,i)=>(v(),qe(Gt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:He(()=>[l("button",{onClick:a,class:"btn btn-primary"},w(e.okText),1)]),default:He(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,F8)]),_:1},8,["show","title"]))}},Lc=Ge(U8,[["__scopeId","data-v-a6e7148c"]]),z8={class:"tab-content"},H8={class:"form-group"},V8={for:"text"},G8=["placeholder"],j8={key:0,class:"checkbox-label-inline create-separate-items"},Z8={class:"tab-content"},q8={class:"custom-footer"},W8={class:"footer-left"},K8={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:o,termsSentence:a}=ct(),s=e,i=t,r=M(!1),u=M(""),d=M("details"),h=M({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),p=U(()=>!!s.checklistItem),g=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],y=U(()=>g.findIndex(P=>P.value===d.value)),_=U(()=>y.value===g.length-1),b=U(()=>_.value?"":g[y.value+1]?.label||"");Ze(()=>s.show,P=>{P&&(d.value=s.initialTab,s.checklistItem?h.value={text:s.checklistItem.text||"",scopeConfigurations:s.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(s.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:s.checklistItem.displayOrder||0,isRequired:s.checklistItem.isRequired!==!1,visibleFrom:s.checklistItem.visibleFrom?C(s.checklistItem.visibleFrom):null,visibleUntil:s.checklistItem.visibleUntil?C(s.checklistItem.visibleUntil):null,mustCompleteBy:s.checklistItem.mustCompleteBy?C(s.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const C=P=>{if(!P)return null;const F=new Date(P),R=F.getTimezoneOffset();return new Date(F.getTime()-R*60*1e3).toISOString().slice(0,16)},I=P=>P?new Date(P).toISOString():null,$=()=>{i("update:isDirty",!0)},x=()=>{i("close")},S=()=>{_.value||(d.value=g[y.value+1].value)},B=P=>{u.value=P,r.value=!0},E=()=>{if(!h.value.text||!h.value.text.trim()){B(`Please enter ${o.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){B("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){B("Please configure at least one scope with valid selections");return}const F={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:I(h.value.visibleFrom),visibleUntil:I(h.value.visibleUntil),mustCompleteBy:I(h.value.mustCompleteBy)};p.value||(F.createSeparateItems=h.value.createSeparateItems),i("save",F)},q=()=>{i("delete",s.checklistItem.itemId)};return(P,F)=>(v(),m(Me,null,[Ee(Gt,{show:e.show,title:p.value?`Edit ${D(o).checklist}`:`Create ${D(o).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{"tab-header":He(()=>[Ee(Qi,{modelValue:d.value,"onUpdate:modelValue":F[0]||(F[0]=R=>d.value=R),tabs:g},null,8,["modelValue"])]),footer:He(()=>[l("div",q8,[l("div",W8,[p.value?(v(),m("button",{key:0,type:"button",onClick:q,class:"btn btn-danger"}," Delete ")):A("",!0),!p.value&&!_.value?(v(),m("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},w(b.value)+"... ",1)):A("",!0)]),l("button",{type:"button",onClick:E,class:"btn btn-success"}," Save ")])]),default:He(()=>[l("form",{onSubmit:it(E,["prevent"]),class:"checklist-form"},[ze(l("div",z8,[l("div",H8,[l("label",V8,w(D(a).checklist)+" text: *",1),ze(l("textarea",{id:"text","onUpdate:modelValue":F[1]||(F[1]=R=>h.value.text=R),onInput:$,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${D(o).checklists}, one per line...`:`Enter the ${D(o).checklist} text...`},null,40,G8),[[tt,h.value.text]]),p.value?A("",!0):(v(),m("label",j8,[ze(l("input",{type:"checkbox","onUpdate:modelValue":F[2]||(F[2]=R=>h.value.createSeparateItems=R),onChange:$},null,544),[[Gs,h.value.createSeparateItems]]),F[5]||(F[5]=l("span",null,"Each line creates a new item",-1))]))])],512),[[ys,d.value==="details"]]),ze(l("div",Z8,[Ee(wc,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":F[3]||(F[3]=R=>h.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,onUserChanged:$},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(Lc,{show:r.value,title:"Validation error",message:u.value,onClose:F[4]||(F[4]=R=>r.value=!1)},null,8,["show","message"])],64))}},J8=Ge(K8,[["__scopeId","data-v-eddaaf3c"]]),Y8={class:"tab-content"},X8={class:"form-group"},Q8={class:"form-group"},eD={class:"form-row"},tD={class:"form-group"},nD={class:"checkbox-label-inline show-emergency-checkbox"},oD={class:"form-group"},sD={class:"form-row"},aD={class:"form-group"},iD={class:"form-group checkbox-group-inline"},lD={class:"checkbox-label-inline"},rD={class:"tab-content"},cD={class:"custom-footer"},uD={class:"footer-left"},dD={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M(!1),i=M(""),r=M("details"),u=M({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=B=>B==="Urgent"||B==="Emergency",h=U(()=>!!o.note),p=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],g=U(()=>p.findIndex(B=>B.value===r.value)),y=U(()=>g.value===p.length-1),_=U(()=>y.value?"":p[g.value+1]?.label||"");Ze(()=>o.show,B=>{B&&(r.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1,showInEmergencyInfo:o.note.showInEmergencyInfo??d(o.note.priority)}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),Ze(()=>u.value.priority,(B,E)=>{!h.value&&B!==E&&(d(B)?u.value.showInEmergencyInfo=!0:d(E)&&(u.value.showInEmergencyInfo=!1))});const b=()=>{a("update:isDirty",!0)},C=()=>{a("close")},I=()=>{y.value||(r.value=p[g.value+1].value)},$=B=>{i.value=B,s.value=!0},x=()=>{if(!u.value.title||!u.value.title.trim()){$("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){$("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(q=>!(q.itemType!==null&&(!q.ids||q.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const E={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1,showInEmergencyInfo:u.value.showInEmergencyInfo};a("save",E)},S=()=>{a("delete",o.note.noteId)};return(B,E)=>(v(),m(Me,null,[Ee(Gt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":He(()=>[Ee(Qi,{modelValue:r.value,"onUpdate:modelValue":E[0]||(E[0]=q=>r.value=q),tabs:p},null,8,["modelValue"])]),footer:He(()=>[l("div",cD,[l("div",uD,[h.value?(v(),m("button",{key:0,type:"button",onClick:S,class:"btn btn-danger"}," Delete ")):A("",!0),!h.value&&!y.value?(v(),m("button",{key:1,type:"button",onClick:I,class:"btn btn-secondary mobile-only"},w(_.value)+"... ",1)):A("",!0)]),l("button",{type:"button",onClick:x,class:"btn btn-success"}," Save ")])]),default:He(()=>[l("form",{onSubmit:it(x,["prevent"]),class:"note-form"},[ze(l("div",Y8,[l("div",X8,[E[10]||(E[10]=l("label",{for:"title"},"Title: *",-1)),ze(l("input",{id:"title","onUpdate:modelValue":E[1]||(E[1]=q=>u.value.title=q),type:"text",onInput:b,required:"",placeholder:"Enter note title..."},null,544),[[tt,u.value.title]])]),l("div",Q8,[E[11]||(E[11]=l("label",{for:"content"},"Content:",-1)),ze(l("textarea",{id:"content","onUpdate:modelValue":E[2]||(E[2]=q=>u.value.content=q),onInput:b,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[tt,u.value.content]])]),l("div",eD,[l("div",tD,[E[14]||(E[14]=l("label",{for:"priority"},"Priority:",-1)),ze(l("select",{id:"priority","onUpdate:modelValue":E[3]||(E[3]=q=>u.value.priority=q),onChange:b},[...E[12]||(E[12]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[Fn,u.value.priority]]),l("label",nD,[ze(l("input",{type:"checkbox","onUpdate:modelValue":E[4]||(E[4]=q=>u.value.showInEmergencyInfo=q),onChange:b},null,544),[[Gs,u.value.showInEmergencyInfo]]),E[13]||(E[13]=l("span",null,"Show in emergency info",-1))])]),l("div",oD,[E[15]||(E[15]=l("label",{for:"category"},"Category:",-1)),ze(l("input",{id:"category","onUpdate:modelValue":E[5]||(E[5]=q=>u.value.category=q),type:"text",onInput:b,placeholder:"e.g., Safety, Logistics..."},null,544),[[tt,u.value.category]])])]),l("div",sD,[l("div",aD,[E[16]||(E[16]=l("label",{for:"displayOrder"},"Display order:",-1)),ze(l("input",{id:"displayOrder","onUpdate:modelValue":E[6]||(E[6]=q=>u.value.displayOrder=q),type:"number",onInput:b,min:"0"},null,544),[[tt,u.value.displayOrder,void 0,{number:!0}]]),E[17]||(E[17]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",iD,[l("label",lD,[ze(l("input",{type:"checkbox","onUpdate:modelValue":E[7]||(E[7]=q=>u.value.isPinned=q),onChange:b},null,544),[[Gs,u.value.isPinned]]),E[18]||(E[18]=l("span",null,"Pin to top",-1))]),E[19]||(E[19]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ys,r.value==="details"]]),ze(l("div",rD,[Ee(wc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":E[8]||(E[8]=q=>u.value.scopeConfigurations=q),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:b},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,r.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(Lc,{show:s.value,title:"Validation error",message:i.value,onClose:E[9]||(E[9]=q=>s.value=!1)},null,8,["show","message"])],64))}},hD=Ge(dD,[["__scopeId","data-v-e8488047"]]),fD={class:"incident-detail-header"},pD={class:"header-title-row"},vD={class:"modal-title"},mD={class:"header-badges"},gD=["disabled"],yD={key:0,class:"status-dropdown-menu"},kD=["onClick","disabled"],_D={key:0,class:"incident-detail-content"},bD={class:"accordion-section"},wD={class:"accordion-arrow"},CD={key:0,class:"accordion-content"},LD={class:"description-text"},SD={class:"accordion-section"},ID={class:"accordion-arrow"},xD={key:0,class:"accordion-content"},$D={class:"info-grid"},TD={class:"info-item"},MD={class:"info-value"},AD={class:"info-item"},ED={class:"info-value"},PD={key:0,class:"info-item"},DD={class:"info-label"},OD={class:"info-value"},RD={key:1,class:"info-item"},BD={class:"info-label"},ND={class:"info-value"},FD={key:2,class:"info-item"},UD={class:"info-value"},zD={key:0,class:"incident-map-container"},HD={class:"accordion-section"},VD={class:"accordion-preview"},GD={class:"accordion-arrow"},jD={key:0,class:"accordion-content"},ZD={class:"reporter-info"},qD={class:"reporter-name"},WD={key:0,class:"accordion-section"},KD={class:"accordion-title"},JD={class:"accordion-preview"},YD={class:"accordion-arrow"},XD={key:0,class:"accordion-content"},QD={class:"marshals-list"},eO={class:"marshal-name"},tO={key:0,class:"checkin-badge success"},nO={key:1,class:"checkin-badge not-checked-in"},oO={class:"accordion-section"},sO={key:0,class:"accordion-preview"},aO={class:"accordion-arrow"},iO={key:0,class:"accordion-content"},lO={key:0,class:"notes-timeline"},rO={class:"note-header"},cO={class:"note-author"},uO={class:"note-time"},dO={key:0,class:"note-status-change"},hO={key:1,class:"note-text"},fO={key:1,class:"no-notes"},pO={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:o,termsSentence:a}=ct(),s=e,i=t,r=M(!1),u=M(!1),d=M(null),h=M({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ze(()=>s.show,j=>{j&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},u.value=!1)});const p=j=>{d.value&&!d.value.contains(j.target)&&(u.value=!1)};Ze(u,j=>{j?document.addEventListener("click",p):document.removeEventListener("click",p)});const g=()=>{u.value=!u.value},y=j=>{s.incident?.status!==j&&(u.value=!1,R(j))},_=j=>{const O=h.value[j];Object.keys(h.value).forEach(G=>{h.value[G]=!1}),O||(h.value[j]=!0)},b=U(()=>s.incident?.latitude!=null&&s.incident?.longitude!=null),C=U(()=>b.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),I=U(()=>b.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),$=U(()=>{if(!s.incident)return"Incident Details";if(s.incident.title)return s.incident.title;const j=s.incident.description||"";return j.length<=50?j:j.substring(0,47)+"..."}),x=U(()=>[...s.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((O,G)=>(O.name||"").localeCompare(G.name||"",void 0,{sensitivity:"base"}))),S=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],B=j=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[j]||j,E=j=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[j]||j,q=j=>{if(!j)return"";let O=j.name||"";if(j.description){const G=j.description,Q=40,se=G.length>Q?G.substring(0,Q-3)+"...":G;O+=` - ${se}`}return O},P=j=>j?new Date(j).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",F=j=>{if(!j)return"";const O=new Date(j),Q=new Date-O,se=Math.floor(Q/6e4),pe=Math.floor(Q/36e5),ee=Math.floor(Q/864e5);return se<1?"just now":se<60?`${se}m ago`:pe<24?`${pe}h ago`:ee<7?`${ee}d ago`:O.toLocaleDateString()},R=async j=>{if(s.incident?.status!==j){r.value=!0;try{i("status-change",{incidentId:s.incident.incidentId,status:j})}finally{r.value=!1}}};return(j,O)=>(v(),qe(Gt,{show:e.show,title:$.value,size:"large",onClose:O[7]||(O[7]=G=>j.$emit("close"))},{header:He(()=>[l("div",fD,[l("div",pD,[l("span",{class:ve(["severity-indicator",e.incident?.severity])},null,2),l("h2",vD,w($.value),1)]),l("div",mD,[l("span",{class:ve(["severity-badge",e.incident?.severity])},w(B(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[l("button",{type:"button",class:ve(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:g,disabled:r.value},[Qe(w(E(e.incident?.status))+" ",1),O[8]||(O[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,gD),u.value?(v(),m("div",yD,[(v(),m(Me,null,Fe(S,G=>l("button",{key:G.value,type:"button",class:ve(["status-dropdown-item",{active:e.incident?.status===G.value}]),onClick:Q=>y(G.value),disabled:e.incident?.status===G.value},[l("span",{class:ve(["status-dot",G.value])},null,2),Qe(" "+w(G.label),1)],10,kD)),64))])):A("",!0)],512)):(v(),m("span",{key:1,class:ve(["status-badge",e.incident?.status])},w(E(e.incident?.status)),3))])])]),footer:He(()=>[l("button",{class:"btn btn-secondary",onClick:O[6]||(O[6]=G=>j.$emit("close"))},"Close")]),default:He(()=>[e.incident?(v(),m("div",_D,[l("div",bD,[l("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.description}]),onClick:O[0]||(O[0]=G=>_("description"))},[O[9]||(O[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",wD,w(h.value.description?"":""),1)],2),h.value.description?(v(),m("div",CD,[l("p",LD,w(e.incident.description),1)])):A("",!0)]),l("div",SD,[l("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.timeLocation}]),onClick:O[1]||(O[1]=G=>_("timeLocation"))},[O[10]||(O[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",ID,w(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(v(),m("div",xD,[l("div",$D,[l("div",TD,[O[11]||(O[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",MD,w(P(e.incident.incidentTime)),1)]),l("div",AD,[O[12]||(O[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",ED,w(P(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",PD,[l("span",DD,w(D(a).checkpoint),1),l("span",OD,w(q(e.incident.context.checkpoint)),1)])):A("",!0),e.incident.area?(v(),m("div",RD,[l("span",BD,w(D(a).area),1),l("span",ND,w(e.incident.area.areaName),1)])):A("",!0),b.value?(v(),m("div",FD,[O[13]||(O[13]=l("span",{class:"info-label"},"GPS location",-1)),l("span",UD,w(e.incident.latitude.toFixed(6))+", "+w(e.incident.longitude.toFixed(6)),1)])):A("",!0)]),b.value?(v(),m("div",zD,[Ee(hi,{locations:e.checkpoints,route:e.route,center:C.value,zoom:15,"user-location":I.value,height:"200px"},null,8,["locations","route","center","user-location"])])):A("",!0)])):A("",!0)]),l("div",HD,[l("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.reporter}]),onClick:O[2]||(O[2]=G=>_("reporter"))},[O[14]||(O[14]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",VD,w(e.incident.reportedBy?.name||"Unknown"),1),l("span",GD,w(h.value.reporter?"":""),1)],2),h.value.reporter?(v(),m("div",jD,[l("div",ZD,[l("span",qD,w(e.incident.reportedBy?.name||"Unknown"),1)])])):A("",!0)]),x.value.length?(v(),m("div",WD,[l("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.marshals}]),onClick:O[3]||(O[3]=G=>_("marshals"))},[l("span",KD,w(D(o).peoplePlural)+" at "+w(D(o).checkpoint.toLowerCase()),1),l("span",JD,w(x.value.length),1),l("span",YD,w(h.value.marshals?"":""),1)],2),h.value.marshals?(v(),m("div",XD,[l("div",QD,[(v(!0),m(Me,null,Fe(x.value,G=>(v(),m("div",{key:G.marshalId,class:ve(["marshal-item",{"checked-in":G.wasCheckedIn}])},[l("span",eO,w(G.name),1),G.wasCheckedIn?(v(),m("span",tO," Checked in "+w(F(G.checkInTime)),1)):(v(),m("span",nO," Not checked in "))],2))),128))])])):A("",!0)])):A("",!0),l("div",oO,[l("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.notes}]),onClick:O[4]||(O[4]=G=>_("notes"))},[O[15]||(O[15]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",sO,w(e.incident.updates.length),1)):A("",!0),l("span",aO,w(h.value.notes?"":""),1)],2),h.value.notes?(v(),m("div",iO,[e.incident.updates?.length?(v(),m("div",lO,[(v(!0),m(Me,null,Fe(e.incident.updates,(G,Q)=>(v(),m("div",{key:Q,class:"note-item"},[l("div",rO,[l("span",cO,w(G.authorName||"System"),1),l("span",uO,w(F(G.timestamp)),1)]),G.statusChange?(v(),m("div",dO,[O[16]||(O[16]=Qe(" Status changed to ",-1)),l("span",{class:ve(["status-badge",G.statusChange])},w(E(G.statusChange)),3)])):G.note?(v(),m("p",hO,w(G.note),1)):A("",!0)]))),128))])):(v(),m("div",fO," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:O[5]||(O[5]=G=>j.$emit("open-add-note"))}," Add update ")])):A("",!0)])])):A("",!0)]),_:1},8,["show","title"]))}},rm=Ge(pO,[["__scopeId","data-v-df0707d4"]]),vO={class:"form-group"},mO={class:"form-group"},gO={class:"form-row"},yO={class:"form-group form-group-half"},kO=["value"],_O={class:"form-group form-group-half"},bO={key:0,class:"form-group"},wO={for:"checkpoint",class:"form-label"},CO=["value"],LO={key:1,class:"form-group"},SO={class:"form-label"},IO={class:"checkpoint-toggle"},xO={class:"checkbox-label"},$O={class:"checkpoint-name"},TO={key:0,class:"checkpoint-description"},MO={class:"form-group"},AO={class:"location-options"},EO={class:"location-buttons"},PO={key:0,class:"location-status"},DO={key:0,class:"location-getting"},OO={key:1,class:"location-display"},RO={key:0,class:"location-accuracy"},BO={key:2,class:"location-error"},NO={key:1,class:"map-picker-container"},FO={key:0,class:"map-picker-hint"},UO={key:2,class:"location-display"},zO={key:2,class:"error-message"},HO={class:"modal-actions"},VO=["disabled"],GO={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:o}=ct(),a=e,s=t,i=M({title:"",description:"",severity:"medium",incidentTime:""}),r=M(""),u=M(!0),d=M("none"),h=M(!1),p=M(null),g=M(null),y=M(null),_=M(!1),b=M(!1),C=M(null),I=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],$=()=>{const G=new Date,Q=G.getFullYear(),se=String(G.getMonth()+1).padStart(2,"0"),pe=String(G.getDate()).padStart(2,"0"),ee=String(G.getHours()).padStart(2,"0"),te=String(G.getMinutes()).padStart(2,"0");return`${Q}-${se}-${pe}T${ee}:${te}`},x=G=>G?new Date(G).toISOString():null,S=U(()=>a.checkpoints||[]),B=U(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(r.value){const G=S.value.find(Q=>Q.id===r.value);if(G?.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(S.value.length>0){const G=S.value[0];if(G.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.route?.length>0){const G=a.route[0];if(G?.lat!=null)return{lat:G.lat,lng:G.lng}}return{lat:-33.9,lng:151.2}}),E=U(()=>i.value.description.trim()!==""),q=U(()=>i.value.description.trim()!=="");Ze(()=>a.show,G=>{G&&(i.value={title:"",description:"",severity:"medium",incidentTime:$()},r.value="",u.value=!0,b.value=!1,C.value=null,y.value=null,p.value=null,g.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),a.checkpoint&&(r.value=a.checkpoint.locationId||a.checkpoint.id||""))});const P=G=>{y.value=null,G==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,g.value=null):G==="gps"?(d.value="gps",h.value=!1,R()):(d.value="none",h.value=!1,p.value=null,g.value=null)},F=G=>{p.value={latitude:G.lat,longitude:G.lng},g.value=null,h.value=!1},R=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}_.value=!0,navigator.geolocation.getCurrentPosition(G=>{p.value={latitude:G.coords.latitude,longitude:G.coords.longitude},g.value=G.coords.accuracy,_.value=!1},G=>{y.value="Unable to get your location.",_.value=!1},{enableHighAccuracy:!0,timeout:1e4})},j=async()=>{if(!(!q.value||b.value)){b.value=!0,C.value=null;try{const G=(d.value==="gps"||d.value==="map")&&p.value;let Q=null,se=!1;S.value.length>0?r.value?Q=r.value:se=!0:a.checkpoint&&(u.value?Q=a.checkpoint.locationId||a.checkpoint.id||null:se=!0);const pe={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:x(i.value.incidentTime),latitude:G?p.value.latitude:null,longitude:G?p.value.longitude:null,checkpointId:Q,skipCheckpointAutoAssign:se};s("submit",pe)}catch(G){C.value=G.message||"Failed to report incident. Please try again.",b.value=!1}}},O=()=>{s("close")};return(G,Q)=>(v(),qe(Gt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":E.value,onClose:O},{footer:He(()=>[l("div",HO,[l("button",{type:"button",class:"btn btn-secondary",onClick:O}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:j,disabled:!q.value||b.value},w(b.value?"Reporting...":"Report Incident"),9,VO)])]),default:He(()=>[l("form",{onSubmit:it(j,["prevent"]),class:"incident-form"},[l("div",vO,[Q[10]||(Q[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),ze(l("input",{id:"title","onUpdate:modelValue":Q[0]||(Q[0]=se=>i.value.title=se),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[tt,i.value.title]])]),l("div",mO,[Q[11]||(Q[11]=l("label",{for:"description",class:"form-label"},[Qe("Description "),l("span",{class:"required"},"*")],-1)),ze(l("textarea",{id:"description","onUpdate:modelValue":Q[1]||(Q[1]=se=>i.value.description=se),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[tt,i.value.description]])]),l("div",gO,[l("div",yO,[Q[12]||(Q[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),ze(l("select",{id:"severity","onUpdate:modelValue":Q[2]||(Q[2]=se=>i.value.severity=se),class:"form-input form-select"},[(v(),m(Me,null,Fe(I,se=>l("option",{key:se.value,value:se.value},w(se.label),9,kO)),64))],512),[[Fn,i.value.severity]])]),l("div",_O,[Q[13]||(Q[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),ze(l("input",{id:"incidentTime","onUpdate:modelValue":Q[3]||(Q[3]=se=>i.value.incidentTime=se),type:"datetime-local",class:"form-input"},null,512),[[tt,i.value.incidentTime]])])]),S.value.length>0?(v(),m("div",bO,[l("label",wO,w(D(o).checkpoint),1),ze(l("select",{id:"checkpoint","onUpdate:modelValue":Q[4]||(Q[4]=se=>r.value=se),class:"form-input form-select"},[Q[14]||(Q[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(Me,null,Fe(S.value,se=>(v(),m("option",{key:se.id,value:se.id},w(se.name)+w(se.description?` - ${se.description}`:""),9,CO))),128))],512),[[Fn,r.value]])])):e.checkpoint?(v(),m("div",LO,[l("label",SO,w(D(o).checkpoint),1),l("div",IO,[l("label",xO,[ze(l("input",{type:"checkbox","onUpdate:modelValue":Q[5]||(Q[5]=se=>u.value=se)},null,512),[[Gs,u.value]]),l("span",$O,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",TO," - "+w(e.checkpoint.description),1)):A("",!0)])])])):A("",!0),l("div",MO,[Q[15]||(Q[15]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",AO,[l("div",EO,[l("button",{type:"button",class:ve(["location-btn",{active:d.value==="gps"}]),onClick:Q[6]||(Q[6]=se=>P("gps"))}," GPS ",2),l("button",{type:"button",class:ve(["location-btn",{active:d.value==="map"}]),onClick:Q[7]||(Q[7]=se=>P("map"))}," Pick on map ",2),l("button",{type:"button",class:ve(["location-btn",{active:d.value==="none"}]),onClick:Q[8]||(Q[8]=se=>P("none"))}," None ",2)]),d.value==="gps"?(v(),m("div",PO,[_.value?(v(),m("div",DO," Getting location... ")):p.value&&p.value.latitude!=null?(v(),m("div",OO,[l("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),g.value?(v(),m("span",RO,"("+w(Math.round(g.value))+"m)",1)):A("",!0)])):y.value?(v(),m("div",BO,w(y.value),1)):A("",!0)])):A("",!0),d.value==="map"?(v(),m("div",NO,[h.value?(v(),m("div",FO,"Tap to select location")):A("",!0),h.value?(v(),qe(hi,{key:1,locations:S.value,route:e.route,center:B.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":r.value,height:"150px",onPointSelected:F},null,8,["locations","route","center","user-location","highlight-location-id"])):A("",!0),p.value&&p.value.latitude!=null?(v(),m("div",UO,[l("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),h.value?A("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:Q[9]||(Q[9]=se=>h.value=!0)},"Edit"))])):A("",!0)])):A("",!0)])]),C.value?(v(),m("div",zO,w(C.value),1)):A("",!0)],32)]),_:1},8,["show","is-dirty"]))}},cm=Ge(GO,[["__scopeId","data-v-20b520b6"]]),jO={class:"tab-content"},ZO={key:0,class:"form-group"},qO={for:"marshalId"},WO=["value"],KO={class:"help-text"},JO={key:1,class:"form-group"},YO={class:"linked-marshal-info"},XO={class:"linked-marshal-name"},QO={class:"linked-marshal-hint"},eR={key:2,class:"form-group"},tR={class:"form-group"},nR={class:"role-input-group"},oR={key:0,label:"Built-in Roles"},sR=["value"],aR={key:1,label:"Custom Roles"},iR=["value"],lR={class:"checkbox-label-inline show-emergency-checkbox"},rR={class:"form-row"},cR={class:"form-group"},uR={class:"form-group"},dR={class:"form-group"},hR={class:"form-row"},fR={class:"form-group"},pR={class:"form-group checkbox-group-inline"},vR={class:"checkbox-label-inline"},mR={class:"tab-content"},gR={class:"custom-footer"},yR={class:"footer-left"},kR=["disabled"],_R={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,s=t,i=M(!1),r=M(""),u=M("details"),d=M(!1),h=M({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=j=>j==="EmergencyContact",g=U(()=>!!a.contact),y=U(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),_=U(()=>!!h.value.marshalId),b=U(()=>!g.value&&!!a.prefilledMarshalId),C=U(()=>g.value&&!!a.contact?.marshalId),I=U(()=>a.contact?.marshalId?a.marshals.find(O=>O.id===a.contact.marshalId)?.name||"Unknown":""),$=U(()=>[...a.marshals].sort((j,O)=>js(j.name,O.name)));Ze(()=>a.show,j=>{if(j){if(u.value=a.initialTab,a.contact){const O=[...a.availableRoles.builtInRoles||[],...a.availableRoles.customRoles||[]];d.value=a.contact.role&&!O.includes(a.contact.role),h.value={role:a.contact.role||"",name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??p(a.contact.role),displayOrder:a.contact.displayOrder||0,isPinned:a.contact.isPinned||!1,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let O;a.createFromAreaContext?O=[]:a.preselectedArea?O=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:O=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let G={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const Q=a.marshals.find(se=>se.id===a.prefilledMarshalId);Q&&(G={name:Q.name||"",phone:Q.phoneNumber||"",email:Q.email||""})}h.value={role:"",name:G.name,phone:G.phone,email:G.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:O}}s("update:isDirty",!1)}}),Ze(()=>h.value.role,(j,O)=>{!g.value&&j!==O&&(p(j)?h.value.showInEmergencyInfo=!0:p(O)&&(h.value.showInEmergencyInfo=!1))});const x=j=>j?j==="AreaLead"?`${o.value.area} Lead`:j.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"",S=()=>{s("update:isDirty",!0)},B=()=>{if(h.value.marshalId){const j=a.marshals.find(O=>O.id===h.value.marshalId);j&&(h.value.name=j.name,!h.value.phone&&j.phoneNumber&&(h.value.phone=j.phoneNumber),!h.value.email&&j.email&&(h.value.email=j.email))}S()},E=()=>{s("close")},q=()=>{if(!h.value.role||!h.value.role.trim()){P("Please select or enter a role");return}if(!h.value.name||!h.value.name.trim()){P("Please enter a contact name");return}u.value="visibility"},P=j=>{r.value=j,i.value=!0},F=()=>{if(!h.value.role||!h.value.role.trim()){P("Please select or enter a role");return}if(!h.value.name||!h.value.name.trim()){P("Please enter a contact name");return}if(!a.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){P("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(G=>!(G.itemType!==null&&(!G.ids||G.ids.length===0)))){P("Please configure at least one scope with valid selections");return}}const j={role:h.value.role.trim(),name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};s("save",j)},R=()=>{s("delete",a.contact.contactId)};return(j,O)=>(v(),m(Me,null,[Ee(Gt,{show:e.show,title:g.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:E},{"tab-header":He(()=>[Ee(Qi,{modelValue:u.value,"onUpdate:modelValue":O[0]||(O[0]=G=>u.value=G),tabs:y.value},null,8,["modelValue","tabs"])]),footer:He(()=>[l("div",gR,[l("div",yR,[g.value?(v(),m("button",{key:0,type:"button",onClick:R,class:"btn btn-danger"}," Delete ")):A("",!0),!g.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:q,class:"btn btn-secondary mobile-only"}," Visibility... ")):A("",!0)]),l("button",{type:"button",onClick:F,class:"btn btn-success",disabled:g.value&&!e.isDirty}," Save ",8,kR)])]),default:He(()=>[l("form",{onSubmit:it(F,["prevent"]),class:"contact-form"},[ze(l("div",jO,[!b.value&&!C.value?(v(),m("div",ZO,[l("label",qO,"Link to "+w(D(o).person.toLowerCase())+":",1),ze(l("select",{id:"marshalId","onUpdate:modelValue":O[1]||(O[1]=G=>h.value.marshalId=G),onChange:B},[O[14]||(O[14]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),m(Me,null,Fe($.value,G=>(v(),m("option",{key:G.id,value:G.id},w(G.name),9,WO))),128))],544),[[Fn,h.value.marshalId]]),l("span",KO,"Optionally link to an existing "+w(D(o).person.toLowerCase())+" in the system",1)])):A("",!0),C.value?(v(),m("div",JO,[l("label",null,"Linked "+w(D(o).person.toLowerCase())+":",1),l("div",YO,[l("span",XO,w(I.value),1),l("span",QO,"Contact details are synced with this "+w(D(o).person.toLowerCase()),1)])])):A("",!0),_.value?A("",!0):(v(),m("div",eR,[O[15]||(O[15]=l("label",{for:"name"},"Name: *",-1)),ze(l("input",{id:"name","onUpdate:modelValue":O[2]||(O[2]=G=>h.value.name=G),type:"text",onInput:S,placeholder:"Contact name..."},null,544),[[tt,h.value.name]])])),l("div",tR,[O[18]||(O[18]=l("label",{for:"role"},"Role: *",-1)),l("div",nR,[d.value?ze((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":O[4]||(O[4]=G=>h.value.role=G),type:"text",onInput:S,placeholder:"Enter custom role name..."},null,544)),[[tt,h.value.role]]):ze((v(),m("select",{key:0,id:"role","onUpdate:modelValue":O[3]||(O[3]=G=>h.value.role=G),onChange:S},[O[16]||(O[16]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",oR,[(v(!0),m(Me,null,Fe(e.availableRoles.builtInRoles,G=>(v(),m("option",{key:G,value:G},w(x(G)),9,sR))),128))])):A("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",aR,[(v(!0),m(Me,null,Fe(e.availableRoles.customRoles,G=>(v(),m("option",{key:G,value:G},w(x(G)),9,iR))),128))])):A("",!0)],544)),[[Fn,h.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:O[5]||(O[5]=G=>d.value=!d.value)},w(d.value?"Use existing":"Custom"),1)]),l("label",lR,[ze(l("input",{type:"checkbox","onUpdate:modelValue":O[6]||(O[6]=G=>h.value.showInEmergencyInfo=G),onChange:S},null,544),[[Gs,h.value.showInEmergencyInfo]]),O[17]||(O[17]=l("span",null,"Show in emergency info",-1))])]),l("div",rR,[l("div",cR,[O[19]||(O[19]=l("label",{for:"phone"},"Phone:",-1)),ze(l("input",{id:"phone","onUpdate:modelValue":O[7]||(O[7]=G=>h.value.phone=G),type:"tel",onInput:S,placeholder:"Phone number..."},null,544),[[tt,h.value.phone]])]),l("div",uR,[O[20]||(O[20]=l("label",{for:"email"},"Email:",-1)),ze(l("input",{id:"email","onUpdate:modelValue":O[8]||(O[8]=G=>h.value.email=G),type:"email",onInput:S,placeholder:"Email address..."},null,544),[[tt,h.value.email]])])]),l("div",dR,[O[21]||(O[21]=l("label",{for:"notes"},"Notes / Instructions:",-1)),ze(l("textarea",{id:"notes","onUpdate:modelValue":O[9]||(O[9]=G=>h.value.notes=G),onInput:S,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[tt,h.value.notes]])]),l("div",hR,[l("div",fR,[O[22]||(O[22]=l("label",{for:"displayOrder"},"Display order:",-1)),ze(l("input",{id:"displayOrder","onUpdate:modelValue":O[10]||(O[10]=G=>h.value.displayOrder=G),type:"number",onInput:S,min:"0"},null,544),[[tt,h.value.displayOrder,void 0,{number:!0}]]),O[23]||(O[23]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",pR,[l("label",vR,[ze(l("input",{type:"checkbox","onUpdate:modelValue":O[11]||(O[11]=G=>h.value.isPinned=G),onChange:S},null,544),[[Gs,h.value.isPinned]]),O[24]||(O[24]=l("span",null,"Pin to top",-1))]),O[25]||(O[25]=l("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[ys,u.value==="details"]]),ze(l("div",mR,[Ee(wc,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":O[12]||(O[12]=G=>h.value.scopeConfigurations=G),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":g.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:S},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(Lc,{show:i.value,title:"Validation error",message:r.value,onClose:O[13]||(O[13]=G=>i.value=!1)},null,8,["show","message"])],64))}},bR=Ge(_R,[["__scopeId","data-v-21d18628"]]),wR={key:0,class:"fullscreen-map-overlay"},CR={class:"fullscreen-map-header"},LR={class:"context-info"},SR={key:0},IR={class:"action-buttons"},xR=["disabled"],$R={class:"fullscreen-map-container"},TR={key:0,class:"drawing-controls"},MR={class:"point-count"},AR={class:"undo-redo-buttons"},ER=["disabled"],PR=["disabled"],DR=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(0),r=M(!1),u=M(!1),d=()=>{a("done")},h=()=>{a("cancel")},p=C=>{i.value=C?.length||0,g(),a("polygon-drawing",C)},g=()=>{s.value&&(r.value=s.value.canUndo(),u.value=s.value.canRedo())},y=()=>{s.value&&(s.value.undoPolygonPoint(),g())},_=()=>{s.value&&(s.value.redoPolygonPoint(),g())};Ze(()=>o.show,C=>{C||(i.value=0,r.value=!1,u.value=!1)});const b=C=>{C.key==="Escape"&&o.show&&h(),o.show&&o.drawingMode&&((C.ctrlKey||C.metaKey)&&C.key==="z"&&!C.shiftKey?(C.preventDefault(),y()):(C.ctrlKey||C.metaKey)&&(C.key==="y"||C.key==="z"&&C.shiftKey)&&(C.preventDefault(),_()))};return Qt(()=>{document.addEventListener("keydown",b)}),kn(()=>{document.removeEventListener("keydown",b)}),(C,I)=>(v(),qe(Ol,{to:"body"},[e.show?(v(),m("div",wR,[l("div",CR,[l("div",LR,[l("h3",null,w(e.contextTitle),1),e.contextDescription?(v(),m("p",SR,w(e.contextDescription),1)):A("",!0)]),l("div",IR,[e.mode==="view"?(v(),m("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(v(),m(Me,{key:1},[l("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,xR)],64))])]),l("div",$R,[Ee(Du,Vp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},C.$attrs,{onMapClick:I[0]||(I[0]=$=>C.$emit("map-click",$)),onPolygonComplete:I[1]||(I[1]=$=>C.$emit("polygon-complete",$)),onPolygonDrawing:p,onLocationClick:I[2]||(I[2]=$=>C.$emit("location-click",$)),onAreaClick:I[3]||(I[3]=$=>C.$emit("area-click",$))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),m("div",TR,[l("div",MR,w(i.value)+" point"+w(i.value!==1?"s":""),1),l("div",AR,[l("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!r.value,title:"Undo last point"},"  Undo ",8,ER),l("button",{onClick:_,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,PR)])])):A("",!0)])])):A("",!0)]))}}),OR=Ge(DR,[["__scopeId","data-v-9ce62b55"]]),RR={class:"form-group"},BR={class:"form-group"},NR={class:"form-group"},FR={key:0,class:"form-error"},UR={class:"form-row"},zR={class:"form-group",style:{flex:"1"}},HR={class:"form-group",style:{flex:"1"}},VR={class:"form-group",style:{flex:"0 0 auto"}},GR={class:"form-group"},jR={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,s=t,i=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ze(()=>a.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const r=()=>{s("update:isDirty",!0),s("update:location",{...i.value})},u=()=>{if(!qr(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}s("save",i.value)},d=()=>{s("close")};return(h,p)=>(v(),qe(Gt,{show:e.show,title:`Add ${D(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:He(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+w(D(o).checkpoint),1)]),default:He(()=>[l("form",{onSubmit:it(u,["prevent"])},[l("div",RR,[p[7]||(p[7]=l("label",null,"Name",-1)),ze(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>i.value.name=g),type:"text",required:"",class:"form-input",onInput:r},null,544),[[tt,i.value.name]])]),l("div",BR,[p[8]||(p[8]=l("label",null,"Description",-1)),ze(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>i.value.description=g),type:"text",class:"form-input",onInput:r},null,544),[[tt,i.value.description]])]),l("div",NR,[p[9]||(p[9]=l("label",null,"What3Words (optional)",-1)),ze(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>i.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:r},null,544),[[tt,i.value.what3Words]]),i.value.what3Words&&!D(qr)(i.value.what3Words)?(v(),m("small",FR," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):A("",!0)]),l("div",UR,[l("div",zR,[p[10]||(p[10]=l("label",null,"Longitude",-1)),ze(l("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>i.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[tt,i.value.longitude,void 0,{number:!0}]])]),l("div",HR,[p[11]||(p[11]=l("label",null,"Latitude",-1)),ze(l("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>i.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[tt,i.value.latitude,void 0,{number:!0}]])]),l("div",VR,[p[12]||(p[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>h.$emit("set-on-map"))},"  ")])]),l("div",GR,[l("label",null,"Required "+w(D(o).people),1),ze(l("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>i.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:r},null,544),[[tt,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},ZR=Ge(jR,[["__scopeId","data-v-fb51fed0"]]),qR=["aria-expanded","title"],WR=["innerHTML"],KR={key:0,class:"dropdown-menu"},JR=["onClick"],YR=["innerHTML"],XR={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=Yv(),s=M(!1),i=M(null),r={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:r.system},{value:"light",label:"Light",icon:r.light},{value:"dark",label:"Dark",icon:r.dark}],d=U(()=>o.value?r.dark:r.light),h=()=>{s.value=!s.value},p=y=>{a(y),s.value=!1},g=y=>{i.value&&!i.value.contains(y.target)&&(s.value=!1)};return Qt(()=>{document.addEventListener("click",g)}),kn(()=>{document.removeEventListener("click",g)}),(y,_)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[l("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":s.value,title:D(o)?"Dark mode":"Light mode"},[l("span",{class:"theme-icon",innerHTML:d.value},null,8,WR)],8,qR),s.value?(v(),m("div",KR,[(v(),m(Me,null,Fe(u,b=>l("button",{key:b.value,class:ve(["dropdown-item",{active:D(t)===b.value}]),onClick:C=>p(b.value)},[l("span",{class:"option-icon",innerHTML:b.icon},null,8,YR),l("span",null,w(b.label),1)],10,JR)),64))])):A("",!0)],512))}},QR=Ge(XR,[["__scopeId","data-v-969124a4"]]),eB={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},tB=["id"],nB=["filter"],oB={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){Ay(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=U(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),m("svg",eB,[l("defs",null,[l("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[l("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,tB)]),l("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,nB),a[2]||(a[2]=l("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),l("g",{class:ve({"marshal-figure":e.animate})},[...a[1]||(a[1]=[l("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),l("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},sB=Ge(oB,[["__scopeId","data-v-3e647831"]]),aB={class:"header"},iB={class:"header-left"},lB={key:0},rB={class:"event-date"},cB={class:"header-actions"},uB={class:"container"},dB={class:"tabs-nav"},hB={class:"tab-content-wrapper"},fB={class:"add-note-form"},pB={class:"modal-footer-actions"},vB=["disabled"],mB=6e4,gB={__name:"AdminEventManage",setup(e){const t=mc(),o=Ki(),a=qv(),s=U(()=>t.params.eventId),{activeTab:i,switchTab:r}=Wv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:p,confirmModalConfirmText:g,showConfirm:y,handleConfirmModalConfirm:_,handleConfirmModalCancel:b}=Xb(),{tabLabels:C,terms:I,termsLower:$}=ct(),x=Qb(),S=t0(s),B=e0(s),{colorScheme:E}=Yv(),q=U(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:C.value.course,icon:"course"},{value:"areas",label:C.value.areas,icon:"area"},{value:"checkpoints",label:C.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:C.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:C.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),P=M(null),F=M([]),R=M([]),j=M({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),O=M(null),G=M(!1),Q=M(!1),se=M(null),pe=M(null),ee=M(!1),te=M(!1),z=M(null),Y=M(""),ue=B.eventAdmins,ke=B.showAddAdmin,Re=S.showUploadRoute,Ye=S.uploading,Ne=S.uploadError,Ke=S.showImportLocations,We=S.showImportMarshals,X=S.importing,_e=S.importingMarshals,Le=S.importError,me=S.importResult,ce=S.importMarshalsResult,N=M(!1),K=M(!1),ae=M({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Te=M(!1),Be=M(!1),De=M({marshalName:"",locations:[],marshal:null}),Se=M(null),J=M([]),he=M(!1),xe=M(null),Ie=M(null),be=M(null),de=M({}),fe=M({id:"",name:"",email:"",phoneNumber:"",notes:""}),Z=M(!1),W=M([]),ie=M([]),Ue=M([]),Xe=M([]),mt=M(!1),_t=M(""),gt=M(""),St=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),bt=M(!1),Ut=M(!1),Bt=M(""),ut=M(""),ln=M(0),un=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Nt=M([]),wt=M(null),Xn=M(!1),zn=M("details"),Qn=M(null),_n=M(null),Kt=M(null),ks=x.isAddingMultipleCheckpoints,eo=x.multiCheckpointCounter,Io=x.isFullscreenMapActive,le=x.fullscreenMode,re=x.fullscreenContext,ye=x.tempLocationCoords,at=x.tempCheckpoints,je=x.savedMapCenter,xt=x.savedMapZoom,Jt=x.isDrawingAreaBoundary,en=M(null),Bo=M([]),po=M(null),No=M(!1),Hn=M("details"),Aa=M(null),_s=M([]),Fo=M(null),is=M(!1),Ws=M("details"),Vn=M([]),Ks=M(!1),dn=M(null),xo=M(!1),$o=M(!1),bs=M(!1),vo=M(""),mo=M(!1),to=M([]),To=M({builtInRoles:[],customRoles:[]}),pn=M(null),go=M(!1),no=M("details"),kt=M(null),Et=M(""),Mo=M(null),Uo=M(null),yo=U(()=>Uo.value?.marshalId!=null),Js=()=>{o.push(`/event/${t.params.eventId}`)},ht=U(()=>`${window.location.origin}/#/event/${t.params.eventId}`),zt=U(()=>{const H=[];return R.value.forEach(oe=>{oe.assignments&&H.push(...oe.assignments)}),H}),Ea=U(()=>{if(!xe.value)return R.value;const H=xe.value.assignedLocationIds||[],oe=Ue.value.map(we=>we.locationId),ge=Xe.value;return R.value.filter(we=>!H.includes(we.id)&&!oe.includes(we.id)||ge.includes(we.id))}),ws=U(()=>{let H=J.value;if(O.value){const oe=O.value.assignments.map(we=>we.marshalName),ge=W.value.map(we=>we.marshalName);H=J.value.filter(we=>!oe.includes(we.name)&&!ge.includes(we.name))}return H.slice().sort((oe,ge)=>oe.name.localeCompare(ge.name))}),$n=U(()=>le.value==="draw-area"&&wt.value?.polygon?.length>0||x.canCompleteFullscreen.value),el=U(()=>le.value==="move-checkpoint"&&O.value?.id?O.value.id:null),ls=U(()=>{const H=[...R.value];return le.value==="place-checkpoint"&&ye.value&&H.push({id:"temp-single",name:un.value.name||"New Checkpoint",latitude:ye.value.lat,longitude:ye.value.lng,requiredMarshals:un.value.requiredMarshals||1,assignments:[],isTemporary:!0}),le.value==="move-checkpoint"&&ye.value&&O.value&&H.push({id:"temp-move",name:O.value.name+" (new position)",latitude:ye.value.lat,longitude:ye.value.lng,requiredMarshals:O.value.requiredMarshals,assignments:[],isTemporary:!0}),le.value==="add-multiple"&&H.push(...at.value),H}),Ao=U(()=>{let H=[...Nt.value];return le.value==="draw-area"&&wt.value?.id&&(H=H.filter(oe=>oe.id!==wt.value.id)),le.value==="draw-area"&&wt.value?.polygon?.length>0&&H.push({...wt.value,id:wt.value.id||"temp-area"}),H}),qt=U(()=>{if(!xe.value||!Vn.value.length)return[];const H=xe.value.id,oe=xe.value.assignedLocationIds||[];return Vn.value.filter(ge=>{if(ge.reportedBy?.marshalId===H)return!0;const we=ge.context?.checkpoint?.checkpointId;return!!(we&&oe.includes(we))}).sort((ge,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),zo=U(()=>{if(!O.value||!Vn.value.length)return[];const H=O.value.id;return Vn.value.filter(oe=>oe.context?.checkpoint?.checkpointId===H).sort((oe,ge)=>new Date(ge.incidentTime||ge.createdAt)-new Date(oe.incidentTime||oe.createdAt))}),Ho=U(()=>{if(!wt.value||!Vn.value.length)return[];const H=wt.value.id,oe=R.value.filter(ge=>ge.areaIds&&ge.areaIds.includes(H)).map(ge=>ge.id);return Vn.value.filter(ge=>{const we=ge.context?.checkpoint?.checkpointId;return we&&oe.includes(we)}).sort((ge,we)=>new Date(we.incidentTime||we.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),Cs=H=>{dn.value=H,xo.value=!0},Pa=H=>{dn.value=H,xo.value=!0},bn=H=>{dn.value=H,xo.value=!0},oo=()=>{o.push("/sessions")},jt=(H=!0)=>{Z.value=H},wn=()=>{bt.value=!0},Ys=async H=>{try{H&&(St.value={...H});const oe=Vl(P.value.eventDate),ge=St.value.eventDate;if(oe!==ge){const we=F.value.filter(ot=>ot.startTime||ot.endTime);if(we.length>0){Bt.value=oe,ut.value=ge,ln.value=we.length,Ut.value=!0;return}}await Xs(!1,null)}catch(oe){console.error("Failed to update event:",oe),alert("Failed to update event. Please try again.")}},Xs=async(H,oe)=>{try{if(await a.updateEvent(t.params.eventId,{...St.value,defaultCheckpointStyleMapRotation:St.value.defaultCheckpointStyleMapRotation!=null?String(St.value.defaultCheckpointStyleMapRotation):null}),H&&oe!==null){const ge=Math.floor(Math.abs(oe)/1e3),we=oe<0,ot=Math.floor(ge/3600),It=Math.floor(ge%3600/60),At=ge%60,mn=`${we?"-":""}${ot.toString().padStart(2,"0")}:${It.toString().padStart(2,"0")}:${At.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,mn)}await Tn(),bt.value=!1}catch(ge){console.error("Failed to update event:",ge),alert("Failed to update event. Please try again.")}},Qs=async({shouldShift:H,timeDelta:oe})=>{Ut.value=!1,await Xs(H,oe)},fi=()=>{Ut.value=!1,Tn()},Tn=async()=>{try{await a.fetchEvent(t.params.eventId),P.value=a.currentEvent,P.value&&(St.value={name:P.value.name||"",description:P.value.description||"",eventDate:Vl(P.value.eventDate),timeZoneId:P.value.timeZoneId||"UTC",peopleTerm:P.value.peopleTerm||"Marshals",checkpointTerm:P.value.checkpointTerm||"Checkpoints",areaTerm:P.value.areaTerm||"Areas",checklistTerm:P.value.checklistTerm||"Checklists",courseTerm:P.value.courseTerm||"Course",defaultCheckpointStyleType:P.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:P.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:P.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:P.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:P.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:P.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:P.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:P.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:P.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:P.value.brandingHeaderGradientEnd||"",brandingLogoUrl:P.value.brandingLogoUrl||"",brandingLogoPosition:P.value.brandingLogoPosition||"",brandingAccentColor:P.value.brandingAccentColor||"",brandingPageGradientStart:P.value.brandingPageGradientStart||"",brandingPageGradientEnd:P.value.brandingPageGradientEnd||""},bt.value=!1,Au(P.value));const H=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),io(),ea(),rt(),hn(),$t(),so(),ko()]);F.value=a.locations,R.value=a.eventStatus.locations,H.forEach((oe,ge)=>{oe.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][ge]}:`,oe.reason)})}catch(H){console.error("Failed to load event data:",H)}},ea=async()=>{try{const H=await gs.getByEvent(t.params.eventId);J.value=H.data,j.value.marshals=Date.now()}catch(H){console.error("Failed to load marshals:",H)}},rt=async()=>{try{const H=await ba.getByEvent(t.params.eventId);Nt.value=H.data,j.value.areas=Date.now()}catch(H){console.error("Failed to load areas:",H)}},hn=async()=>{try{const[H,oe]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);Bo.value=H.data,Aa.value=oe.data,j.value.checklists=Date.now()}catch(H){console.error("Failed to load checklists:",H)}},$t=async()=>{try{const H=await fs.getByEvent(t.params.eventId);_s.value=H.data,j.value.notes=Date.now()}catch(H){console.error("Failed to load notes:",H)}},so=async()=>{Ks.value=!0;try{const H=await vs.getAll(t.params.eventId);Vn.value=H.data.incidents||[],j.value.incidents=Date.now()}catch(H){console.error("Failed to load incidents:",H)}finally{Ks.value=!1}},ko=async()=>{try{const[H,oe]=await Promise.all([pa.getByEvent(t.params.eventId),pa.getRoles(t.params.eventId)]);to.value=H.data,To.value=oe.data,j.value.contacts=Date.now()}catch(H){console.error("Failed to load contacts:",H)}},ta=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),F.value=a.locations,j.value.checkpoints=Date.now(),R.value=a.eventStatus.locations},na=async()=>{await Promise.all([ea(),a.fetchEventStatus(t.params.eventId)]),R.value=a.eventStatus.locations},Mn=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),rt()]),F.value=a.locations,R.value=a.eventStatus.locations},Ls=async()=>{await a.fetchEventStatus(t.params.eventId),R.value=a.eventStatus.locations},Gn=()=>{wt.value=null,zn.value="details",Z.value=!1,Xn.value=!0},Wt=H=>{wt.value=H,_n.value=H.id,zn.value="details",Z.value=!1,Xn.value=!0},Eo=async H=>{try{let oe;if(wt.value&&wt.value.id){if(oe=wt.value.id,await ba.update(t.params.eventId,oe,H),H.checklistChanges&&H.checklistChanges.length>0)for(const ge of H.checklistChanges)try{ge.complete?await Rt.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Rt.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(we){console.error("Failed to update checklist item:",ge,we)}}else oe=(await ba.create({eventId:t.params.eventId,...H})).data.id;if(H.pendingContacts&&H.pendingContacts.length>0&&oe)for(const ge of H.pendingContacts)try{const we=ge.scopeConfigurations?JSON.parse(JSON.stringify(ge.scopeConfigurations)):[],ot=we.find(It=>It.scope==="EveryoneInAreas"&&It.itemType==="Area");ot?(ot.ids||(ot.ids=[]),ot.ids.includes(oe)||ot.ids.push(oe)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}),await pa.update(t.params.eventId,ge.contactId,{...ge,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",ge,we)}if(H.contactsToRemove&&H.contactsToRemove.length>0&&oe)for(const ge of H.contactsToRemove)try{const we=to.value.find(At=>At.contactId===ge);if(!we)continue;const ot=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],It=ot.find(At=>At.scope==="EveryoneInAreas"&&At.itemType==="Area");if(It&&It.ids){It.ids=It.ids.filter(mn=>mn!==oe);const At=It.ids.length>0?ot:ot.filter(mn=>!(mn.scope==="EveryoneInAreas"&&mn.itemType==="Area"));await pa.update(t.params.eventId,ge,{...we,scopeConfigurations:At})}}catch(we){console.error("Failed to remove area from contact:",ge,we)}if((H.pendingContacts&&H.pendingContacts.length>0||H.contactsToRemove&&H.contactsToRemove.length>0)&&await ko(),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0&&oe){for(const ge of H.pendingNewChecklistItems)if(ge.text?.trim())try{await Rt.create(t.params.eventId,{text:ge.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}],displayOrder:0,isRequired:!1})}catch(we){console.error("Failed to create checklist item:",ge,we)}await hn()}if(H.pendingNewNotes&&H.pendingNewNotes.length>0&&oe){for(const ge of H.pendingNewNotes)if(!(!ge.title?.trim()&&!ge.content?.trim()))try{await fs.create(t.params.eventId,{title:ge.title||"Untitled",content:ge.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[oe]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(we){console.error("Failed to create note:",ge,we)}await $t()}await rt(),await Tn(),Ss()}catch(oe){console.error("Failed to save area:",oe),alert(oe.response?.data?.message||"Failed to save area. Please try again.")}},Da=async H=>{y(`Delete ${$.value.area}`,`Are you sure you want to delete this ${$.value.area}? ${I.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ba.delete(t.params.eventId,H),await ba.recalculate(t.params.eventId),await rt(),await Tn(),Ss()}catch(oe){console.error(`Failed to delete ${$.value.area}:`,oe),alert(oe.response?.data?.message||`Failed to delete ${$.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ss=()=>{Xn.value=!1,wt.value=null,_n.value=null,Z.value=!1,Jt.value=!1,Kt.value=null},tl=({marshal:H,area:oe})=>{pn.value=null,no.value="details",Z.value=!1,kt.value=oe,Et.value="",Mo.value=H.id,go.value=!0},pi=({name:H,area:oe})=>{pn.value=null,no.value="details",Z.value=!1,kt.value=oe,Et.value=H,Mo.value=null,go.value=!0},oa=H=>{pn.value=H,no.value="details",Z.value=!1,go.value=!0},nl=()=>{po.value=null,Hn.value="details",Z.value=!1,No.value=!0},vi=(H,oe="details")=>{po.value=H,Hn.value=oe,Z.value=!1,No.value=!0},Ct=async H=>{try{if(po.value&&po.value.itemId)await Rt.update(t.params.eventId,po.value.itemId,H);else{const oe=await Rt.create(t.params.eventId,H);oe.data.count&&oe.data.count>1&&(_t.value="Checklist Items Created",gt.value=`Successfully created ${oe.data.count} checklist items.`,mt.value=!0)}await hn(),vn()}catch(oe){console.error("Failed to save checklist item:",oe);const ge=oe.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ge)}},mi=async H=>{y(`Delete ${$.value.checklist}`,`Are you sure you want to delete this ${$.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,H),await hn(),vn()}catch(oe){console.error(`Failed to delete ${$.value.checklist}:`,oe),alert(oe.response?.data?.message||`Failed to delete ${$.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},vn=()=>{No.value=!1,po.value=null,Z.value=!1},Vo=()=>{Fo.value=null,Ws.value="details",Z.value=!1,is.value=!0},Oa=H=>{Fo.value=H,Ws.value="details",Z.value=!1,is.value=!0},ol=async H=>{try{Fo.value&&Fo.value.noteId?await fs.update(t.params.eventId,Fo.value.noteId,H):await fs.create(t.params.eventId,H),await $t(),Ba()}catch(oe){console.error("Failed to save note:",oe);const ge=oe.response?.data?.message||"Failed to save note. Please try again.";alert(ge)}},Ra=async H=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await fs.delete(t.params.eventId,H),await $t(),Ba()}catch(oe){console.error("Failed to delete note:",oe),alert(oe.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ba=()=>{is.value=!1,Fo.value=null,Z.value=!1},Na=()=>{$o.value=!0},gi=async H=>{try{await vs.create(t.params.eventId,H),$o.value=!1,await so()}catch(oe){console.error("Failed to report incident:",oe),alert(oe.response?.data?.message||"Failed to report incident. Please try again.")}},yi=H=>{dn.value=H,xo.value=!0},Fa=()=>{xo.value=!1,dn.value=null},Oe=async({incidentId:H,status:oe})=>{try{if(await vs.updateStatus(t.params.eventId,H,{status:oe}),await so(),dn.value?.incidentId===H){const ge=Vn.value.find(we=>we.incidentId===H);ge&&(dn.value=ge)}}catch(ge){console.error("Failed to update incident status:",ge),alert(ge.response?.data?.message||"Failed to update status. Please try again.")}},$e=()=>{vo.value="",bs.value=!0},nt=()=>{bs.value=!1,vo.value=""},ft=async()=>{if(!(!vo.value.trim()||!dn.value)){mo.value=!0;try{await vs.addNote(t.params.eventId,dn.value.incidentId,vo.value.trim()),nt(),await so();const H=Vn.value.find(oe=>oe.incidentId===dn.value.incidentId);H&&(dn.value=H)}catch(H){console.error("Failed to add note to incident:",H),alert(H.response?.data?.message||"Failed to add note. Please try again.")}finally{mo.value=!1}}},vt=()=>{pn.value=null,no.value="details",kt.value=null,Z.value=!1,go.value=!0},nn=H=>{pn.value=H,no.value="details",Z.value=!1,go.value=!0},Cn=async H=>{try{let oe=null;const ge=!pn.value||!pn.value.contactId,we=!!kt.value;if(pn.value&&pn.value.contactId)await pa.update(t.params.eventId,pn.value.contactId,H);else{const ot=await pa.create(t.params.eventId,H);oe=ot.data?.contactId||ot.data?.id}if(await ko(),ge&&we&&oe&&Qn.value){const ot=to.value.find(It=>It.contactId===oe);ot&&Qn.value.addPendingContact(ot)}Ht()}catch(oe){console.error("Failed to save contact:",oe);const ge=oe.response?.data?.message||"Failed to save contact. Please try again.";alert(ge)}},An=async H=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await pa.delete(t.params.eventId,H),await ko(),Qn.value&&Qn.value.removeContactById(H),Ht()}catch(oe){console.error("Failed to delete contact:",oe),alert(oe.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ht=()=>{go.value=!1,pn.value=null,kt.value=null,Et.value="",Mo.value=null,Z.value=!1},En=H=>{Kt.value={...H,id:wt.value?.id};const oe={...H,id:wt.value?.id,polygon:[]};wt.value=oe;let ge=!1;if(H.polygon&&H.polygon.length>0){const we=H.polygon.map(Ln=>Ln.lat||Ln[0]),ot=H.polygon.map(Ln=>Ln.lng||Ln[1]),It=Math.min(...we),At=Math.max(...we),mn=Math.min(...ot),ca=Math.max(...ot);je.value={lat:(It+At)/2,lng:(mn+ca)/2};const Ti=At-It,xs=ca-mn,ua=Math.max(Ti,xs);xt.value=ua<.005?17:ua<.01?16:ua<.02?15:ua<.05?14:13,ge=!0}if(!ge&&H.checkpointIds&&H.checkpointIds.length>0){const we=R.value.filter(ot=>H.checkpointIds.includes(ot.id));if(we.length>0){const ot=we.map(At=>At.latitude).filter(Boolean),It=we.map(At=>At.longitude).filter(Boolean);if(ot.length>0&&It.length>0){const At=Math.min(...ot),mn=Math.max(...ot),ca=Math.min(...It),Ti=Math.max(...It);je.value={lat:(At+mn)/2,lng:(ca+Ti)/2};const xs=mn-At,ua=Ti-ca,Ln=Math.max(xs,ua);xt.value=Ln<.005?16:Ln<.01?15:Ln<.02?14:Ln<.05?13:12,ge=!0}}}if(!ge&&se.value){const we=se.value.getMapCenter(),ot=se.value.getMapZoom();we&&ot!==null&&(je.value=we,xt.value=ot)}Io.value=!0,le.value="draw-area",Jt.value=!0,re.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},Tt=H=>{Kt.value?wt.value={...wt.value||{},...Kt.value,polygon:H}:wt.value={...wt.value,polygon:H}},on=H=>{x.handlePolygonDrawing(H)},ao=()=>{Jt.value=!1,Kt.value&&(wt.value=Kt.value,Xn.value=!0,Kt.value=null)},io=()=>B.loadEventAdmins(),_o=async H=>{try{await B.addAdmin(H),await io(),za()}catch(oe){console.error("Failed to add admin:",oe),alert(oe.response?.data?.message||"Failed to add administrator. Please try again.")}},Ua=async H=>{y("Remove administrator",`Remove ${H} as an administrator?`,async()=>{try{await B.removeAdmin(H),await io()}catch(oe){console.error("Failed to remove admin:",oe),alert(oe.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},za=()=>{B.closeAddAdminModal(),Z.value=!1},ki=async H=>{await S.uploadRoute(H)&&(await ta(),rs())},rs=()=>{S.closeUploadRouteModal()},Sc=async({file:H,deleteExisting:oe})=>{const ge=await S.importLocations(H,oe);if(ge){await Mn(),sa();const we=S.formatImportResultMessage(ge,"location");_t.value="Import Complete",gt.value=we,mt.value=!0}},sa=()=>{S.closeImportLocationsModal()},lo=async H=>{if(Q.value)un.value.latitude=H.lat,un.value.longitude=H.lng;else if(K.value)ae.value.latitude=H.lat,ae.value.longitude=H.lng,O.value&&(O.value={...O.value,latitude:H.lat,longitude:H.lng}),K.value=!1,N.value=!0,jt();else if(ks.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${eo.value}`,description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""}),eo.value++,await Tn()}catch(oe){console.error("Failed to create checkpoint:",oe),alert("Failed to create checkpoint. Please try again.")}},tr=H=>{x.handleFullscreenMapClick(H)},nr=H=>{un.value={...H}},Ic=()=>{Q.value=!1,x.enterPlaceCheckpointMode()},sl=()=>{x.saveMapState(se.value),un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},x.enterPlaceCheckpointMode()},al=()=>{x.saveMapState(se.value),Io.value=!0,le.value="view",re.value={title:"Course map",description:""}},xc=()=>{x.saveMapState(se.value),wt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Nt.value.length},x.enterDrawAreaMode()},$c=()=>{O.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ae.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=[],ie.value=[],Z.value=!1,N.value=!0},or=()=>{const H=x.calculateStartingNumber(R);x.saveMapState(se.value),x.enterAddMultipleMode(H)},Tc=()=>{if(le.value==="place-checkpoint"){const H=x.getPlacedCoords()||{lat:0,lng:0};O.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ae.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""},W.value=[],ie.value=[],Z.value=!1,_i(),N.value=!0}else if(le.value==="move-checkpoint"){const H=x.getPlacedCoords();H&&(ae.value.latitude=H.lat,ae.value.longitude=H.lng,O.value&&(O.value={...O.value,...en.value||{},latitude:H.lat,longitude:H.lng}),jt()),en.value=null,_i(),N.value=!0}else if(le.value==="draw-area"){const H=x.getCompletedPolygon();H&&(Kt.value?wt.value={...wt.value||{},...Kt.value,polygon:H}:wt.value={...wt.value||{},polygon:H}),Kt.value=null,_i()}else le.value==="add-multiple"&&bo()},bo=async()=>{const H=x.getTempCheckpoints();try{for(const oe of H)await a.createLocation({eventId:t.params.eventId,name:oe.name,description:oe.description,latitude:oe.latitude,longitude:oe.longitude,requiredMarshals:oe.requiredMarshals,what3Words:oe.what3Words});x.clearTempCheckpoints(),_i(),await Tn()}catch(oe){console.error("Failed to create checkpoints:",oe),alert("Failed to create checkpoints. Please try again.")}},aa=()=>{le.value==="draw-area"?Kt.value&&(wt.value=Kt.value,Kt.value=null):le.value==="move-checkpoint"&&(en.value&&O.value&&Object.assign(O.value,en.value),N.value=!0,K.value=!1),x.cancelFullscreen()},_i=()=>{x.exitFullscreen()},Go=H=>{bi(H)},bi=H=>{O.value=H,ae.value={id:H.id,name:H.name,description:H.description||"",latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||""},W.value=[],ie.value=[],Z.value=!1,N.value=!0,setTimeout(()=>{se.value?.scrollMapIntoView()},100)},ia=async H=>{if(!qr(H.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...H}),await Tn(),sr()}catch(oe){console.error("Failed to save location:",oe),alert("Failed to save location. Please try again.")}},sr=()=>{Q.value=!1,un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Z.value=!1,Z.value=!1},Is=()=>{N.value=!1,O.value=null,G.value=!1,K.value=!1,Te.value=!1,en.value=null,ae.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=[],ie.value=[],Z.value=!1},wi=()=>{Te.value=!1},Ci=()=>{Te.value=!0},Mc=H=>{H?.formData&&(en.value=H.formData),N.value=!1,ye.value=null;const oe=en.value?.latitude??O.value?.latitude,ge=en.value?.longitude??O.value?.longitude;if(oe&&ge)je.value={lat:oe,lng:ge},xt.value=16;else if(se.value){const ot=se.value.getMapCenter(),It=se.value.getMapZoom();ot&&It!==null&&(je.value=ot,xt.value=It)}const we=en.value?.name||O.value?.name;Io.value=!0,le.value="move-checkpoint",re.value={title:`Move ${$.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},cs=async H=>{if(!qr(H.what3Words)){alert("Invalid What3Words format.");return}try{const oe=!O.value.id;if(oe){const ge=await a.createLocation({eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const we of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ge.id,marshalId:we.marshalId})}else{const ge=O.value.id;if(await Jn.update(t.params.eventId,ge,{eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const we of H.pendingNewChecklistItems)we.text?.trim()&&await Rt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const we of H.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await fs.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of ie.value)await a.deleteAssignment(t.params.eventId,we);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const we of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of W.value)await a.createAssignment({eventId:t.params.eventId,locationId:O.value.id,marshalId:we.marshalId});if(H.checkInChanges&&H.checkInChanges.length>0)for(const we of H.checkInChanges){const ot=O.value.assignments.find(It=>It.id===we.assignmentId);ot&&ot.isCheckedIn!==we.shouldBeCheckedIn&&await Sa.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!oe&&H.checklistChanges&&H.checklistChanges.length>0)for(const ge of H.checklistChanges)try{ge.complete?await Rt.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Rt.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(we){console.error("Failed to update checklist item:",ge,we)}await Tn(),Is()}catch(oe){console.error("Failed to update location:",oe),alert("Failed to update location. Please try again.")}},Li=async H=>{y(`Delete ${$.value.checkpoint}`,`Are you sure you want to delete this ${$.value.checkpoint}?`,async()=>{try{await Jn.delete(t.params.eventId,H),await Mn(),Is()}catch(oe){console.error(`Failed to delete ${$.value.checkpoint}:`,oe),alert(`Failed to delete ${$.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ac=async H=>{try{if(pe.value&&pe.value.setCheckingIn(H.id),await Sa.adminCheckIn(t.params.eventId,H.id),await Ls(),O.value){const oe=R.value.find(ge=>ge.id===O.value.id);oe&&(O.value=oe)}}catch(oe){console.error("Failed to toggle check-in:",oe),alert("Failed to toggle check-in. Please try again.")}finally{pe.value&&pe.value.setCheckingIn(null)}},il=H=>{const oe=H?.id??H;if(oe?.toString().startsWith("temp-")){const ge=O.value.assignments.find(we=>we.id===oe);ge&&(W.value=W.value.filter(we=>we.marshalId!==ge.marshalId)),O.value.assignments=O.value.assignments.filter(we=>we.id!==oe),jt()}else ie.value.includes(oe)||(ie.value.push(oe),O.value.assignments=O.value.assignments.filter(ge=>ge.id!==oe),jt())},Ec=async H=>{const oe=J.value.find(we=>we.id===H);if(!oe)return;const ge=R.value.filter(we=>we.assignments?.some(ot=>ot.marshalId===H&&we.id!==O.value.id));if(ge.length>0){De.value={marshalName:oe.name,locations:ge.map(ot=>ot.name),marshal:oe};const we=await new Promise(ot=>{Se.value=ot,Be.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const ot of ge){const It=ot.assignments.find(At=>At.marshalId===H);if(It){ie.value.push(It.id);const At=R.value.findIndex(mn=>mn.id===ot.id);At!==-1&&(R.value[At].assignments=R.value[At].assignments.filter(mn=>mn.id!==It.id))}}}W.value.push({marshalId:oe.id,marshalName:oe.name}),O.value.assignments||(O.value.assignments=[]),O.value.assignments.push({id:`temp-${Date.now()}`,marshalId:oe.id,marshalName:oe.name,locationId:O.value.id,isCheckedIn:!1,isPending:!0}),jt(),wi()},jo=async H=>{try{const ge=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber})).data;await ea(),W.value.push({marshalId:ge.id,marshalName:ge.name}),O.value&&(O.value.assignments||(O.value.assignments=[]),O.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ge.id,marshalName:ge.name,locationId:O.value.id,isCheckedIn:!1,isPending:!0})),jt(),wi()}catch(oe){console.error("Failed to create marshal:",oe),alert("Failed to create marshal. Please try again.")}},Pc=()=>{xe.value=null,de.value={},fe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ue.value=[],Xe.value=[],Z.value=!1,he.value=!0},la=H=>{xe.value=H,de.value={},fe.value={id:H.id,name:H.name,email:H.email||"",phoneNumber:H.phoneNumber||"",notes:H.notes||""},Ue.value=[],Xe.value=[],Z.value=!1,he.value=!0},ar=U(()=>{if(!xe.value)return[];const H=[];return R.value.forEach(oe=>{oe.assignments.filter(we=>we.marshalName===xe.value.name&&!Xe.value.includes(we.id)).forEach(we=>{H.push({...we,locationName:oe.name,locationDescription:oe.description||""})})}),Ue.value.forEach((oe,ge)=>{const we=R.value.find(ot=>ot.id===oe.locationId);we&&H.push({id:`pending-${ge}`,locationId:oe.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:xe.value.id,marshalName:xe.value.name,isCheckedIn:!1,isPending:!0})}),H}),Zo=async H=>{try{let oe=xe.value?.id,ge=!1;if(xe.value){if(await gs.update(t.params.eventId,xe.value.id,{name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const we of H.pendingNewChecklistItems)we.text?.trim()&&await Rt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const we of H.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await fs.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,priority:"Normal",isPinned:!1})}else oe=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]})).data.id,ge=!0;for(const we of Xe.value)await a.deleteAssignment(t.params.eventId,we);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const we of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of Ue.value)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:oe});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const we of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:oe});if(H.checkInChanges&&H.checkInChanges.length>0){const we=ar.value;for(const ot of H.checkInChanges){const It=we.find(At=>At.id===ot.assignmentId);It&&It.isCheckedIn!==ot.shouldBeCheckedIn&&await Sa.adminCheckIn(t.params.eventId,ot.assignmentId)}}if(H.checklistChanges&&H.checklistChanges.length>0)for(const we of H.checklistChanges)try{const ot={marshalId:oe};we.contextType&&we.contextId&&(ot.contextType=we.contextType,ot.contextId=we.contextId),we.complete?await Rt.complete(t.params.eventId,we.itemId,ot):await Rt.uncomplete(t.params.eventId,we.itemId,ot)}catch(ot){console.error("Failed to process checklist change:",ot);const It=ot.response?.data?.message||"Failed to update checklist item";alert(`Error: ${It}`)}if(await Tn(),O.value){const we=R.value.find(ot=>ot.id===O.value.id);we&&(O.value=we)}Va(),ge&&(z.value=oe,Y.value=H.name,te.value=!0)}catch(oe){console.error("Failed to save marshal:",oe);const ge=oe.response?.data?.message||"Failed to save marshal. Please try again.";if(oe.response?.status===400){const we=ge.toLowerCase();we.includes("name")?(de.value={name:ge},be.value&&(be.value.switchToTab("details"),be.value.focusField("name"))):we.includes("email")?(de.value={email:ge},be.value&&(be.value.switchToTab("details"),be.value.focusField("email"))):(de.value={general:ge},be.value&&be.value.switchToTab("details"))}else de.value={general:ge},be.value&&be.value.switchToTab("details")}},Ha=async H=>{const oe=H||xe.value?.id;if(!oe){console.error("No marshal ID to delete");return}const ge=$.value.person;y(`Delete ${ge}`,`Are you sure you want to delete this ${ge}?`,async()=>{try{await gs.delete(t.params.eventId,oe),await na(),Va()}catch(we){console.error(`Failed to delete ${ge}:`,we),alert(`Failed to delete ${ge}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},ir=H=>{Ha(H.id)},ll=H=>{const oe=H?.id??H;if(oe?.toString().startsWith("pending-")){const ge=H?.locationId;ge&&(Ue.value=Ue.value.filter(we=>we.locationId!==ge)),jt()}else Xe.value.includes(oe)||(Xe.value.push(oe),jt())},Si=H=>{Ue.value.push({locationId:H}),jt()},Va=()=>{he.value=!1,xe.value=null,Ie.value=null,de.value={},fe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ue.value=[],Xe.value=[],Z.value=!1},Ii=async H=>{const oe=J.value.find(ge=>ge.id===H.marshalId);if(!oe){console.error("Marshal not found:",H.marshalId);return}Ie.value=O.value?.id||null,Z.value=!1,xe.value=oe,he.value=!0},ra=H=>{const oe=R.value.find(ge=>ge.id===H.locationId);if(!oe){console.error("Location not found:",H.locationId);return}G.value=!0,Z.value=!1,O.value=oe,N.value=!0},xi=async({file:H})=>{const oe=await S.importMarshals(H);if(oe){await na(),$i();const ge=S.formatImportResultMessage(oe,"marshal");_t.value="Import Complete",gt.value=ge,mt.value=!0}},$i=()=>{S.closeImportMarshalsModal()},lr=H=>{Se.value&&(Se.value(H),Se.value=null),Be.value=!1};let Ga=null;const ja=async()=>{try{const H=t.params.eventId,oe=await Jn.getDynamicCheckpoints(H);if(oe.data&&Array.isArray(oe.data))for(const ge of oe.data){const we=R.value.find(ot=>ot.id===ge.checkpointId);we&&(we.latitude=ge.latitude,we.longitude=ge.longitude,we.lastLocationUpdate=ge.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},rr=()=>{Ga||!R.value.some(oe=>oe.isDynamic||oe.IsDynamic)||(ja(),Ga=setInterval(ja,6e4))},rl=()=>{Ga&&(clearInterval(Ga),Ga=null)};return Ze(i,H=>{H==="course"?rr():rl();const oe=Date.now(),ge=we=>oe-j.value[we]>mB;switch(H){case"marshals":ge("marshals")&&ea();break;case"areas":ge("areas")&&rt();break;case"checkpoints":ge("checkpoints")&&ta();break;case"checklists":ge("checklists")&&hn();break;case"notes":ge("notes")&&$t();break;case"incidents":ge("incidents")&&so();break;case"contacts":ge("contacts")&&ko();break}}),Qt(async()=>{await Tn();try{const H=await ms.getMe(t.params.eventId);Uo.value=H.data}catch(H){console.warn("Failed to fetch user claims:",H)}i.value==="course"&&rr()}),Ze(P,H=>{H&&(document.title="OnTheDay App - Admin")},{immediate:!0}),kn(()=>{rl()}),(H,oe)=>(v(),m("div",{class:"admin-event-manage",style:et({colorScheme:D(E)})},[l("header",aB,[l("div",iB,[l("button",{onClick:oo,class:"btn-back",title:"Back to sessions"},[Ee(sB,{size:48,animate:""})]),P.value?(v(),m("div",lB,[l("h1",null,w(P.value.name),1),l("p",rB,w(D(Xv)(P.value.eventDate)),1)])):A("",!0)]),l("div",cB,[yo.value?(v(),m("button",{key:0,onClick:Js,class:"btn btn-marshal-mode"}," Switch to Marshal ")):A("",!0)]),Ee(QR,{class:"theme-toggle-fixed"})]),l("div",uB,[l("div",dB,[Ee(aT,{tabs:q.value,"model-value":D(i),"onUpdate:modelValue":D(r)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",hB,[D(i)==="course"?(v(),qe(gw,{key:0,ref_key:"courseAreasTab",ref:se,checkpoints:R.value,areas:Nt.value,route:P.value?.route||[],"selected-area-id":_n.value,"drawing-mode":D(Jt),onMapClick:lo,onLocationClick:Go,onAreaClick:Wt,onImportCheckpoints:oe[0]||(oe[0]=ge=>Ke.value=!0),onUploadRoute:oe[1]||(oe[1]=ge=>Re.value=!0),onSelectLocation:bi,onAddArea:Gn,onSelectArea:Wt,onPolygonComplete:Tt,onCancelDrawing:ao,onAddCheckpointFromMap:sl,onAddManyCheckpointsFromMap:or,onAddAreaFromMap:xc,onFullscreen:al},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):A("",!0),D(i)==="checkpoints"?(v(),qe(T$,{key:1,locations:R.value,areas:Nt.value,onAddCheckpointManually:$c,onImportCheckpoints:oe[2]||(oe[2]=ge=>Ke.value=!0),onSelectLocation:bi},null,8,["locations","areas"])):A("",!0),D(i)==="areas"?(v(),qe(K$,{key:2,areas:Nt.value,checkpoints:R.value,contacts:to.value,"event-people-term":P.value?.peopleTerm||"Marshals","event-checkpoint-term":P.value?.checkpointTerm||"Checkpoints",onAddArea:Gn,onSelectArea:Wt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):A("",!0),D(i)==="marshals"?(v(),qe(kC,{key:3,ref_key:"marshalsTabRef",ref:pe,marshals:J.value,assignments:zt.value,locations:R.value,onAddMarshal:Pc,onImportMarshals:oe[3]||(oe[3]=ge=>We.value=!0),onSelectMarshal:la,onDeleteMarshal:ir,onToggleCheckIn:Ac},null,8,["marshals","assignments","locations"])):A("",!0),D(i)==="checklists"?(v(),qe(PC,{key:4,"checklist-items":Bo.value,areas:Nt.value,locations:R.value,marshals:J.value,"completion-report":Aa.value,onAddChecklistItem:nl,onSelectChecklistItem:vi},null,8,["checklist-items","areas","locations","marshals","completion-report"])):A("",!0),D(i)==="notes"?(v(),qe(YC,{key:5,notes:_s.value,areas:Nt.value,locations:R.value,marshals:J.value,onAddNote:Vo,onSelectNote:Oa},null,8,["notes","areas","locations","marshals"])):A("",!0),D(i)==="incidents"?(v(),qe(u$,{key:6,incidents:Vn.value,areas:Nt.value,loading:Ks.value,onSelectIncident:yi,onReportIncident:Na},null,8,["incidents","areas","loading"])):A("",!0),D(i)==="contacts"?(v(),qe(S2,{key:7,contacts:to.value,areas:Nt.value,locations:R.value,marshals:J.value,"available-roles":To.value,onAddContact:vt,onSelectContact:nn},null,8,["contacts","areas","locations","marshals","available-roles"])):A("",!0),D(i)==="details"?(v(),qe(B2,{key:8,"event-data":St.value,"form-dirty":bt.value,onSubmit:Ys,"onUpdate:formDirty":wn},null,8,["event-data","form-dirty"])):A("",!0),D(i)==="settings"?(v(),qe(Ux,{key:9,"event-data":St.value,"event-id":D(t).params.eventId,admins:D(ue),"form-dirty":bt.value,onSubmit:Ys,onAddAdmin:oe[4]||(oe[4]=ge=>ke.value=!0),onRemoveAdmin:Ua,"onUpdate:formDirty":wn},null,8,["event-data","event-id","admins","form-dirty"])):A("",!0)])]),Ee(ZR,{show:Q.value,location:un.value,"is-dirty":Z.value,onClose:sr,onSave:ia,onSetOnMap:Ic,"onUpdate:isDirty":jt,"onUpdate:location":nr},null,8,["show","location","is-dirty"]),Ee(b3,{show:N.value,location:O.value,assignments:O.value?.assignments||[],"event-date":P.value?.eventDate||"",areas:Nt.value,"event-id":D(t).params.eventId,"all-locations":R.value,notes:_s.value,"available-marshals":ws.value,"all-marshals":J.value,"all-checklist-items":Bo.value,incidents:zo.value,"is-dirty":Z.value,"event-default-style-type":P.value?.defaultCheckpointStyleType||P.value?.DefaultCheckpointStyleType||"default","event-default-style-color":P.value?.defaultCheckpointStyleColor||P.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":P.value?.defaultCheckpointStyleBackgroundShape||P.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":P.value?.defaultCheckpointStyleBackgroundColor||P.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":P.value?.defaultCheckpointStyleBorderColor||P.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":P.value?.defaultCheckpointStyleIconColor||P.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":P.value?.defaultCheckpointStyleSize||P.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":P.value?.defaultCheckpointStyleMapRotation??P.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":P.value?.peopleTerm||"Marshals","z-index":Xn.value?1200:G.value?1100:1e3,"locked-from-marshal":G.value,onClose:Is,onSave:cs,onDelete:Li,onMoveLocation:Mc,onRemoveAssignment:il,onOpenAssignModal:Ci,"onUpdate:isDirty":jt,onSelectIncident:Pa,onSelectMarshal:Ii},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ee(uT,{show:ee.value,link:ht.value,"is-dirty":!1,onClose:oe[5]||(oe[5]=ge=>ee.value=!1)},null,8,["show","link"]),Ee(LT,{show:te.value,"event-id":D(t).params.eventId,"marshal-id":z.value,"marshal-name":Y.value,onClose:oe[6]||(oe[6]=ge=>te.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ee(xT,{show:D(ke),"is-dirty":Z.value,onClose:za,onSubmit:_o,"onUpdate:isDirty":jt},null,8,["show","is-dirty"]),Ee(ET,{show:D(Re),uploading:D(Ye),error:D(Ne),"is-dirty":Z.value,onClose:rs,onSubmit:ki,"onUpdate:isDirty":jt},null,8,["show","uploading","error","is-dirty"]),Ee(HT,{show:D(Ke),importing:D(X),error:D(Le),result:D(me),"is-dirty":Z.value,onClose:sa,onSubmit:Sc,"onUpdate:isDirty":jt},null,8,["show","importing","error","result","is-dirty"]),Ee(y6,{ref_key:"editMarshalModalRef",ref:be,show:he.value,marshal:xe.value,"event-id":D(t).params.eventId,assignments:ar.value,"available-locations":Ea.value,"all-locations":R.value,areas:Nt.value,"is-editing":!!xe.value,"event-notes":_s.value,"all-checklist-items":Bo.value,incidents:qt.value,"all-marshals":J.value,"is-dirty":Z.value,"validation-errors":de.value,"locked-checkpoint-id":Ie.value,"z-index":Ie.value?1100:1e3,onClose:Va,onSave:Zo,onDelete:Ha,onRemoveAssignment:ll,onAssignToLocation:Si,"onUpdate:isDirty":jt,onSelectIncident:Cs,onSelectCheckpoint:ra},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ee(JT,{show:D(We),importing:D(_e),error:D(Le),result:D(ce),"is-dirty":Z.value,onClose:$i,onSubmit:xi,"onUpdate:isDirty":jt},null,8,["show","importing","error","result","is-dirty"]),Ee(w6,{show:Be.value,"conflict-data":De.value,onClose:oe[7]||(oe[7]=ge=>Be.value=!1),onChoice:lr},null,8,["show","conflict-data"]),Ee(E6,{show:Te.value,"location-name":O.value?.name||"",marshals:ws.value,onClose:wi,onAssignExisting:Ec,onCreateAndAssign:jo},null,8,["show","location-name","marshals"]),Ee(G6,{show:Ut.value,"old-event-date":Bt.value,"new-event-date":ut.value,"affected-checkpoints-count":ln.value,onConfirm:Qs,onCancel:fi},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ee(N8,{ref_key:"editAreaModalRef",ref:Qn,show:Xn.value,area:wt.value,"initial-tab":zn.value,checkpoints:R.value,marshals:J.value,areas:Nt.value,route:P.value?.route||[],"is-dirty":Z.value,"event-id":D(t).params.eventId,"all-locations":R.value,assignments:zt.value,notes:_s.value,contacts:to.value,incidents:Ho.value,"event-default-style-type":P.value?.defaultCheckpointStyleType||P.value?.DefaultCheckpointStyleType||"default","event-default-style-color":P.value?.defaultCheckpointStyleColor||P.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":P.value?.defaultCheckpointStyleBackgroundShape||P.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":P.value?.defaultCheckpointStyleBackgroundColor||P.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":P.value?.defaultCheckpointStyleBorderColor||P.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":P.value?.defaultCheckpointStyleIconColor||P.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":P.value?.defaultCheckpointStyleSize||P.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":P.value?.defaultCheckpointStyleMapRotation??P.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":P.value?.peopleTerm||"Marshals","event-checkpoint-term":P.value?.checkpointTerm||"Checkpoints",onClose:Ss,onSave:Eo,onDelete:Da,onDrawBoundary:En,"onUpdate:isDirty":jt,onSelectCheckpoint:bi,onCreateContactFromMarshal:tl,onCreateNewContact:pi,onEditContact:oa,onSelectIncident:bn},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ee(J8,{show:No.value,"checklist-item":po.value,"initial-tab":Hn.value,areas:Nt.value,locations:R.value,marshals:J.value,"is-dirty":Z.value,onClose:vn,onSave:Ct,onDelete:mi,"onUpdate:isDirty":jt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ee(hD,{show:is.value,note:Fo.value,"initial-tab":Ws.value,areas:Nt.value,locations:R.value,marshals:J.value,"is-dirty":Z.value,onClose:Ba,onSave:ol,onDelete:Ra,"onUpdate:isDirty":jt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ee(rm,{show:xo.value,incident:dn.value,route:P.value?.route||[],checkpoints:R.value,"can-manage":!0,onClose:Fa,onStatusChange:Oe,onOpenAddNote:$e},null,8,["show","incident","route","checkpoints"]),Ee(Gt,{show:bs.value,title:"Add update",size:"small",onClose:nt},{footer:He(()=>[l("div",pB,[l("button",{type:"button",class:"btn btn-secondary",onClick:nt}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:ft,disabled:!vo.value.trim()||mo.value},w(mo.value?"Adding...":"Add update"),9,vB)])]),default:He(()=>[l("div",fB,[ze(l("textarea",{"onUpdate:modelValue":oe[8]||(oe[8]=ge=>vo.value=ge),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[tt,vo.value]])])]),_:1},8,["show"]),Ee(cm,{show:$o.value,"event-id":D(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:R.value,route:P.value?.route||[],onClose:oe[9]||(oe[9]=ge=>$o.value=!1),onSubmit:gi},null,8,["show","event-id","checkpoints","route"]),Ee(bR,{show:go.value,contact:pn.value,"initial-tab":no.value,areas:Nt.value,locations:R.value,marshals:J.value,"available-roles":To.value,"is-dirty":Z.value,"prefilled-name":Et.value,"prefilled-marshal-id":Mo.value,"create-from-area-context":!!kt.value,onClose:Ht,onSave:Cn,onDelete:An,"onUpdate:isDirty":jt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ee(OR,{show:D(Io),mode:D(le),"context-title":D(re).title,"context-description":D(re).description,"can-complete":$n.value,clickable:D(le)!=="draw-area","drawing-mode":D(le)==="draw-area"&&D(Jt),locations:ls.value,areas:Ao.value,route:P.value?.route||[],"selected-area-id":_n.value,center:D(je),zoom:D(xt),"highlight-location-id":el.value,onMapClick:tr,onPolygonComplete:Tt,onPolygonDrawing:on,onDone:Tc,onCancel:aa},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ee(Lc,{show:mt.value,title:_t.value,message:gt.value,onClose:oe[10]||(oe[10]=ge=>mt.value=!1)},null,8,["show","title","message"]),Ee($a,{show:D(u),title:D(d),message:D(h),"is-danger":D(p),"confirm-text":D(g),onConfirm:D(_),onCancel:D(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},yB=Ge(gB,[["__scopeId","data-v-bc66ef57"]]),kB={key:0,class:"emergency-notes-section"},_B={class:"emergency-notes-list"},bB={class:"note-header"},wB={key:0,class:"note-content"},CB={key:1,class:"emergency-contacts-section"},LB={class:"emergency-contacts-list"},SB={class:"contact-header"},IB={key:0,class:"role-badge"},xB={class:"contact-details"},$B={key:0,class:"info-section"},TB=["href"],MB={key:1,class:"info-section"},AB=["href"],EB={key:2,class:"info-section"},PB=["href"],DB={key:2,class:"no-contacts"},OB={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,s=U(()=>o.notes?[...o.notes].filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,h)=>{const p=d.isPinned||d.IsPinned,g=h.isPinned||h.IsPinned;if(p!==g)return p?-1:1;const y=d.displayOrder||d.DisplayOrder||0,_=h.displayOrder||h.DisplayOrder||0;if(y!==_)return y-_;const b=d.priority||d.Priority,C=h.priority||h.Priority;return b==="Emergency"&&C!=="Emergency"?-1:C==="Emergency"&&b!=="Emergency"?1:0}):[]),i=U(()=>o.contacts?o.contacts.filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,h)=>{const p=d.isPinned||d.IsPinned,g=h.isPinned||h.IsPinned;if(p!==g)return p?-1:1;const y=d.displayOrder||d.DisplayOrder||0,_=h.displayOrder||h.DisplayOrder||0;if(y!==_)return y-_;const b=d.name||d.Name||"",C=h.name||h.Name||"";return b.localeCompare(C,void 0,{sensitivity:"base"})}):[]),r=()=>{a("close")},u=d=>d?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[d]||d.replace(/([A-Z])/g," $1").trim():"";return(d,h)=>(v(),qe(Gt,{show:e.show,title:"Emergency information",size:"medium",onClose:r},{actions:He(()=>[l("button",{onClick:r,class:"btn btn-secondary"},"Close")]),default:He(()=>[s.value.length>0?(v(),m("div",kB,[h[0]||(h[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",_B,[(v(!0),m(Me,null,Fe(s.value,p=>(v(),m("div",{key:p.noteId||p.NoteId,class:ve(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[l("div",bB,[l("h3",null,w(p.title||p.Title),1),l("span",{class:ve(["priority-badge",(p.priority||p.Priority).toLowerCase()])},w(p.priority||p.Priority),3)]),p.content||p.Content?(v(),m("div",wB,w(p.content||p.Content),1)):A("",!0)],2))),128))])])):A("",!0),i.value&&i.value.length>0?(v(),m("div",CB,[h[4]||(h[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",LB,[(v(!0),m(Me,null,Fe(i.value,p=>(v(),m("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[l("div",SB,[l("h3",null,w(p.name),1),p.role?(v(),m("span",IB,w(u(p.role)),1)):A("",!0)]),l("div",xB,[p.phone?(v(),m("div",$B,[h[1]||(h[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${p.phone}`,class:"phone-link"},w(p.phone),9,TB)])):A("",!0),p.email?(v(),m("div",MB,[h[2]||(h[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${p.email}`,class:"email-link"},w(p.email),9,AB)])):A("",!0),p.notes||p.details?(v(),m("div",EB,[h[3]||(h[3]=l("label",null,"Details",-1)),l("p",null,w(p.notes||p.details),1)])):A("",!0)]),p.phone?(v(),m("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+w(p.name),9,PB)):A("",!0)]))),128))])])):A("",!0),i.value.length===0&&s.value.length===0?(v(),m("div",DB,[...h[5]||(h[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):A("",!0)]),_:1},8,["show"]))}},RB=Ge(OB,[["__scopeId","data-v-57827f4f"]]),kl=M(navigator.onLine),Fs=M(!0),wa=M(0),kr=M(null),ti=M("idle"),Hi=M(null),Bu=M(!1);let yf=null,ou=!1,Ko=null,kf=0;function BB(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Jr(){Ko&&(clearTimeout(Ko),Ko=null);const e=BB(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Ko=setTimeout(async()=>{if(Ko=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await jr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Yr();const o=await jr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Jr())},e)}async function Bi(){if(!navigator.onLine)return Fs.value=!1,!1;try{return await vb.check(),Fs.value=!0,!0}catch(e){return e.response?.status===404?(Fs.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Fs.value=!1,!1)}}async function pd(){const e=Date.now();if(e-kf<2e3)return;kf=e;const t=navigator.onLine;if(kl.value=t,!t){Fs.value=!1;return}Bu.value=!0;try{await Bi()&&wa.value>0&&Jr()}finally{Bu.value=!1}}function _f(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),pd())}function bf(){console.log("Window focused, checking connectivity..."),pd()}async function NB(e){try{switch(e.type){case"checkin":await Sa.checkIn(e.payload);break;case"checkin_toggle":await Sa.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await Sa.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Yr(){if(!ou&&navigator.onLine){ou=!0,ti.value="syncing",Hi.value=null;try{const e=await Hv();if(e.length===0){ti.value="success",wa.value=0;return}let t=0,o=0;for(const a of e){const s=await NB(a);if(s===!0)await lf(a.id),t++;else if(s==="permanent_failure")await lf(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await af(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await af(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}wa.value=await jr(),o>0?(ti.value="error",Hi.value=`${o} action(s) failed to sync`):ti.value="success"}catch(e){console.error("Sync error:",e),ti.value="error",Hi.value="Failed to sync pending actions"}finally{ou=!1}}}function FB(){yf||(yf=setInterval(async()=>{navigator.onLine&&(await Bi(),Fs.value&&wa.value>0&&await Yr())},3e4))}function vd(){const e=U(()=>kl.value&&Fs.value);async function t(){wa.value=await jr()}async function o(){kl.value=!0,await Bi()&&wa.value>0&&Jr()}function a(){kl.value=!1,Fs.value=!1,Ko&&(clearTimeout(Ko),Ko=null)}Qt(async()=>{await qs(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",_f),window.addEventListener("focus",bf),navigator.onLine&&await Bi()&&wa.value>0&&Jr(),FB()}),kn(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",_f),window.removeEventListener("focus",bf),Ko&&(clearTimeout(Ko),Ko=null)});async function s(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await h();return await Hl(d,p),kr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function i(d){const h=await La(d);return h&&(kr.value=h.cachedAt),h}async function r(d){kr.value=await lb(d)}async function u(){return navigator.onLine?await Bi()?(await Yr(),ti.value==="success"):(Hi.value="Server is not responding",!1):(Hi.value="Cannot sync while offline",!1)}return{isOnline:kl,isServerHealthy:Fs,isFullyOnline:e,isCheckingStatus:Bu,pendingActionsCount:wa,lastSyncTime:kr,syncStatus:ti,syncError:Hi,checkServerHealth:Bi,quickConnectivityCheck:pd,syncPendingActions:Yr,updatePendingCount:t,refreshCache:s,getCachedData:i,loadLastSyncTime:r,forcSync:u}}const UB={class:"offline-indicator-container"},zB={class:"offline-icon"},HB={key:0,viewBox:"0 0 24 24",fill:"currentColor"},VB={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},GB={class:"offline-text"},jB={key:0,class:"last-sync"},ZB={class:"pending-text"},qB={key:0,class:"pending-subtext"},WB={key:1,class:"syncing-text"},KB={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:s,lastSyncTime:i,syncStatus:r,syncError:u,forcSync:d}=vd(),h=M(!1),p=M(""),g=M(""),y=U(()=>{if(!i.value)return"";const b=new Date(i.value),I=new Date-b,$=Math.floor(I/6e4),x=Math.floor($/60);return $<1?"just now":$<60?`${$}m ago`:x<24?`${x}h ago`:b.toLocaleDateString()}),_=async()=>{await d()};return Ze(r,b=>{b==="success"&&s.value===0?(p.value="All actions synced successfully!",g.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):b==="error"&&(p.value=u.value||"Sync failed",g.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(b,C)=>(v(),m("div",UB,[Ee(es,{name:"slide"},{default:He(()=>[D(o)?A("",!0):(v(),m("div",{key:0,class:ve(["offline-banner",{checking:D(a)}])},[l("span",zB,[D(a)?(v(),m("svg",VB,[...C[1]||(C[1]=[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",HB,[...C[0]||(C[0]=[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),l("span",GB,w(D(a)?"Checking connection...":D(t)?"Server unavailable":"You're offline"),1),D(i)&&!D(a)?(v(),m("span",jB," Last synced: "+w(y.value),1)):A("",!0)],2))]),_:1}),Ee(es,{name:"fade"},{default:He(()=>[D(s)>0?(v(),m("div",{key:0,class:ve(["pending-banner",{"offline-pending":!D(o)}])},[C[2]||(C[2]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",ZB,[Qe(w(D(s))+" pending action"+w(D(s)!==1?"s":"")+" ",1),D(o)?A("",!0):(v(),m("span",qB,"(will sync when online)"))]),D(o)&&D(r)!=="syncing"?(v(),m("button",{key:0,onClick:_,class:"sync-button"}," Sync Now ")):D(r)==="syncing"?(v(),m("span",WB,"Syncing...")):A("",!0)],2)):A("",!0)]),_:1}),Ee(es,{name:"fade"},{default:He(()=>[h.value?(v(),m("div",{key:0,class:ve(["sync-toast",g.value])},w(p.value),3)):A("",!0)]),_:1})]))}},JB=Ge(KB,[["__scopeId","data-v-9c1e58f4"]]),YB={class:"modal-content check-in-reminder-modal"},XB={class:"modal-header warning"},QB={class:"modal-body"},eN={class:"reminder-message"},tN={key:0},nN={class:"reminder-hint"},oN={class:"modal-footer"},sN={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ct();return(o,a)=>(v(),qe(es,{name:"modal"},{default:He(()=>[e.show&&e.checkpoint?(v(),m("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=it(s=>o.$emit("dismiss"),["self"]))},[l("div",YB,[l("div",XB,[a[4]||(a[4]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:a[0]||(a[0]=s=>o.$emit("dismiss"))},"")]),l("div",QB,[a[6]||(a[6]=l("div",{class:"reminder-icon"},"",-1)),l("p",eN,[Qe(" You have not checked in yet to "+w(D(t).checkpoint)+" ",1),l("strong",null,w(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),m("span",tN," - "+w(e.checkpoint.location.description),1)):A("",!0),a[5]||(a[5]=Qe(". ",-1))]),l("p",nN," Please check in when you arrive at your "+w(D(t).checkpoint)+". ",1)]),l("div",oN,[l("button",{onClick:a[1]||(a[1]=s=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:a[2]||(a[2]=s=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:et(e.accentButtonStyle)}," Go to "+w(D(t).checkpoint),5)])])])):A("",!0)]),_:1}))}},aN=Ge(sN,[["__scopeId","data-v-4761fdb9"]]),iN={class:"modal-content location-update-modal"},lN={class:"modal-header"},rN={class:"modal-body"},cN={key:0,class:"success-message"},uN={key:1},dN={class:"modal-description"},hN={key:0,class:"last-update-info"},fN={key:1,class:"gps-status active"},pN={class:"update-option"},vN=["disabled"],mN={class:"update-option auto-update-option"},gN={class:"checkbox-label"},yN=["checked"],kN={class:"option-hint"},_N={class:"update-option"},bN=["disabled"],wN={class:"update-option"},CN={class:"option-label"},LN={key:0,class:"checkpoint-list"},SN=["onClick","disabled"],IN={class:"checkpoint-name"},xN={key:0,class:"checkpoint-description"},$N={key:1,class:"no-checkpoints"},TN={key:2,class:"error"},MN={class:"modal-footer"},AN={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ct(),o=s=>s?new Date(s).toLocaleString():"",a=(s,i=50)=>s?s.length<=i?s:s.substring(0,i).trim()+"...":"";return(s,i)=>(v(),qe(es,{name:"modal"},{default:He(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=it(r=>s.$emit("close"),["self"]))},[l("div",iN,[l("div",lN,[l("h3",null,"Update "+w(D(t).checkpoint)+" location",1),l("button",{class:"modal-close",onClick:i[0]||(i[0]=r=>s.$emit("close"))},"")]),l("div",rN,[e.success?(v(),m("div",cN,w(e.success),1)):(v(),m("div",uN,[l("p",dN,[i[6]||(i[6]=Qe(" Update the position of ",-1)),l("strong",null,w(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),m("div",hN," Last updated: "+w(o(e.assignment.location.lastLocationUpdate)),1)):A("",!0),e.userLocation?(v(),m("div",fN,[...i[7]||(i[7]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Qe(" GPS active ",-1)])])):A("",!0),l("div",pN,[l("button",{onClick:i[1]||(i[1]=r=>s.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:et(e.accentButtonStyle)},[i[8]||(i[8]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Qe(" "+w(e.updating?"Updating...":"Use current GPS location"),1)],12,vN)]),l("div",mN,[l("label",gN,[l("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=r=>s.$emit("toggle-auto-update"))},null,40,yN),i[9]||(i[9]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",kN,"Automatically updates the "+w(D(t).checkpoint)+" location using your GPS every minute.",1)]),l("div",_N,[l("button",{onClick:i[3]||(i[3]=r=>s.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Qe(" Select location on map ",-1)])],8,bN)]),l("div",wN,[l("label",CN,"Or copy location from another "+w(D(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),m("div",LN,[(v(!0),m(Me,null,Fe(e.availableCheckpoints,r=>(v(),m("button",{key:r.id,onClick:u=>s.$emit("copy-from-checkpoint",r.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[l("span",IN,w(r.name),1),r.description?(v(),m("span",xN,w(a(r.description)),1)):A("",!0)],8,SN))),128))])):(v(),m("p",$N," No other "+w(D(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),m("div",TN,w(e.error),1)):A("",!0)]))]),l("div",MN,[l("button",{onClick:i[4]||(i[4]=r=>s.$emit("close")),class:"btn btn-secondary"},w(e.success?"Ok":"Cancel"),1)])])])):A("",!0)]),_:1}))}},EN=Ge(AN,[["__scopeId","data-v-b3924a32"]]),PN={class:"contact-info"},DN={class:"contact-name-row"},ON={key:0,class:"primary-badge"},RN={class:"contact-name"},BN={key:0,class:"contact-notes-text"},NN={key:1,class:"contact-detail"},FN={key:2,class:"contact-detail"},UN={class:"contact-actions"},zN=["href"],HN=["href"],VN=["href"],GN={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],a=U(()=>t.role?o.some(i=>t.role.toLowerCase().includes(i.toLowerCase())):!1),s=U(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,i=>i.toUpperCase()).trim():"");return(i,r)=>(v(),m("div",{class:ve(["contact-item",{"primary-contact":e.isPrimary}])},[l("div",PN,[l("div",DN,[e.isPrimary?(v(),m("span",ON,"")):A("",!0),l("span",RN,w(e.name),1),e.role?(v(),m("span",{key:1,class:ve(["contact-role-badge",{"emergency-role":a.value}])},w(s.value),3)):A("",!0)]),e.notes?(v(),m("div",BN,w(e.notes),1)):A("",!0),e.phone?(v(),m("div",NN,w(e.phone),1)):A("",!0),e.email?(v(),m("div",FN,w(e.email),1)):A("",!0)]),l("div",UN,[e.phone?(v(),m("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...r[0]||(r[0]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Qe(" Call ",-1)])],8,zN)):A("",!0),e.phone?(v(),m("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...r[1]||(r[1]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Qe(" Text ",-1)])],8,HN)):A("",!0),e.email?(v(),m("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...r[2]||(r[2]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Qe(" Email ",-1)])],8,VN)):A("",!0)])],2))}},um=Ge(GN,[["__scopeId","data-v-6cf4fca2"]]),jN={key:0,class:"accordion-section"},ZN={class:"accordion-title"},qN=["innerHTML"],WN={class:"accordion-icon"},KN={key:0,class:"accordion-content"},JN={key:0,class:"loading"},YN={key:1,class:"contact-list"},XN={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),m("div",jN,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",ZN,[l("span",{class:"section-icon",innerHTML:D(Yn)("contacts")},null,8,qN),Qe(" Your "+w(e.contacts.length===1?"contact":"contacts")+w(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),l("span",WN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",KN,[e.loading?(v(),m("div",JN,"Loading contacts...")):(v(),m("div",YN,[(v(!0),m(Me,null,Fe(e.contacts,a=>(v(),qe(um,{key:a.contactId,name:a.name,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):A("",!0)])):A("",!0)}},QN=Ge(XN,[["__scopeId","data-v-246302be"]]),e9={key:0,class:"accordion-section"},t9={class:"accordion-title"},n9=["innerHTML"],o9={class:"accordion-icon"},s9={key:0,class:"accordion-content"},a9={key:0,class:"loading-state"},i9={key:1,class:"empty-state"},l9={key:2,class:"incidents-list"},r9={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),m("div",e9,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",t9,[l("span",{class:"section-icon",innerHTML:D(Yn)("incidents")},null,8,n9),Qe(" Your "+w(e.incidents.length===1?"incident":"incidents")+w(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),l("span",o9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",s9,[e.loading?(v(),m("div",a9," Loading incidents... ")):e.incidents.length===0?(v(),m("div",i9,[...o[1]||(o[1]=[l("p",null,"No incidents to show.",-1)])])):(v(),m("div",l9,[(v(!0),m(Me,null,Fe(e.incidents,a=>(v(),qe(er,{key:a.incidentId,incident:a,onSelect:s=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):A("",!0)])):A("",!0)}},c9=Ge(r9,[["__scopeId","data-v-e84cbdf1"]]),u9={key:0,class:"accordion-section"},d9={class:"accordion-title"},h9=["innerHTML"],f9={class:"accordion-icon"},p9={key:0,class:"accordion-content"},v9={class:"event-details"},m9={key:0,class:"event-detail-row"},g9={class:"detail-value"},y9={key:1,class:"event-description"},k9={class:"detail-value"},_9={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),m("div",u9,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=s=>o.$emit("toggle"))},[l("span",d9,[l("span",{class:"section-icon",innerHTML:D(Yn)("event")},null,8,h9),a[1]||(a[1]=Qe(" Event details ",-1))]),l("span",f9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",p9,[l("div",v9,[e.eventDate?(v(),m("div",m9,[a[2]||(a[2]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",g9,w(t(e.eventDate)),1)])):A("",!0),e.description?(v(),m("div",y9,[a[3]||(a[3]=l("span",{class:"detail-label"},"Description",-1)),l("p",k9,w(e.description),1)])):A("",!0)])])):A("",!0)])):A("",!0)}},b9=Ge(_9,[["__scopeId","data-v-7c880ad1"]]),w9={class:"accordion-section"},C9={class:"accordion-title"},L9=["innerHTML"],S9={class:"accordion-icon"},I9={key:0,class:"accordion-content"},x9={key:0,class:"loading"},$9={key:1,class:"error"},T9={key:2,class:"empty-state"},M9={class:"checklist-section"},A9={key:0,class:"empty-state small"},E9={key:1,class:"my-jobs-list"},P9=["checked","disabled","onChange"],D9={key:0,class:"checklist-section"},O9={class:"checklist-section-title"},R9={key:0,class:"checklist-items"},B9={class:"item-checkbox"},N9=["checked","disabled","onChange"],F9={class:"item-content"},U9={key:0,class:"item-context"},z9={key:1,class:"completion-info"},H9={class:"completion-text"},V9={class:"completion-time"},G9={key:1,class:"checklist-groups"},j9=["onClick"],Z9={class:"group-title"},q9={class:"group-status"},W9={class:"group-count"},K9={class:"group-expand-icon"},J9={key:0,class:"checklist-group-items"},Y9={class:"item-checkbox"},X9=["checked","disabled","onChange"],Q9={class:"item-content"},eF={key:0,class:"completion-info"},tF={class:"completion-text"},nF={class:"completion-time"},oF={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ct(),o=e,a=U(()=>o.visibleItems.length),s=i=>i?new Date(i).toLocaleString():"";return(i,r)=>(v(),m("div",w9,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[l("span",C9,[l("span",{class:"section-icon",innerHTML:D(Yn)("checklist")},null,8,L9),Qe(" Your "+w(D(t).checklists)+" ("+w(e.completedCount)+" of "+w(a.value)+" complete) ",1)]),l("span",S9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",I9,[e.loading?(v(),m("div",x9,"Loading checklist...")):e.error?(v(),m("div",$9,w(e.error),1)):a.value===0?(v(),m("div",T9,[l("p",null,"No "+w(D(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),m(Me,{key:3},[l("div",M9,[r[3]||(r[3]=l("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),m("div",A9,[...r[2]||(r[2]=[l("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",E9,[(v(!0),m(Me,null,Fe(e.myItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,P9),l("span",{class:ve(["my-job-text",{completed:u.isCompleted}])},w(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),m("div",D9,[l("h4",O9,"Your "+w(D(t).area)+"'s jobs",1),Ee(fd,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:r[1]||(r[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):A("",!0)],64)):(v(),m(Me,{key:4},[e.effectiveGroupBy==="none"?(v(),m("div",R9,[(v(!0),m(Me,null,Fe(e.visibleItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:ve(["checklist-item",{"item-completed":u.isCompleted}])},[l("div",B9,[l("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,N9)]),l("div",F9,[l("div",{class:ve(["item-text",{"text-completed":u.isCompleted}])},w(u.text),3),e.getContextName(u)?(v(),m("div",U9,w(e.getContextName(u)),1)):A("",!0),u.isCompleted?(v(),m("div",z9,[l("span",H9," Completed by "+w(u.completedByActorName||"Unknown"),1),l("span",V9,w(s(u.completedAt)),1)])):A("",!0)])],2))),128))])):(v(),m("div",G9,[(v(!0),m(Me,null,Fe(e.groupedItems,u=>(v(),m("div",{key:u.key,class:"checklist-group"},[l("button",{class:ve(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[l("span",Z9,w(u.name),1),l("span",q9,[l("span",W9,w(u.completedCount)+"/"+w(u.items.length),1),l("span",K9,w(e.expandedGroup===u.key?"":"+"),1)])],10,j9),e.expandedGroup===u.key?(v(),m("div",J9,[(v(!0),m(Me,null,Fe(u.items,d=>(v(),m("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:ve(["checklist-item",{"item-completed":d.isCompleted}])},[l("div",Y9,[l("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:h=>i.$emit("toggle-item",d)},null,40,X9)]),l("div",Q9,[l("div",{class:ve(["item-text",{"text-completed":d.isCompleted}])},w(d.text),3),d.isCompleted?(v(),m("div",eF,[l("span",tF,w(d.completedByActorName||"Unknown"),1),l("span",nF,w(s(d.completedAt)),1)])):A("",!0)])],2))),128))])):A("",!0)]))),128))]))],64))])):A("",!0)]))}},sF=Ge(oF,[["__scopeId","data-v-b2878e4f"]]),aF={class:"accordion-section"},iF={class:"accordion-title"},lF=["innerHTML"],rF={class:"accordion-icon"},cF={key:0,class:"accordion-content"},uF={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),m("div",aF,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",iF,[l("span",{class:"section-icon",innerHTML:D(Yn)("notes")},null,8,lF),Qe(" Your "+w(e.notes.length===1?"note":"notes")+w(e.notes.length>1?` (${e.notes.length})`:""),1)]),l("span",rF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",cF,[Ee(Cc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):A("",!0)]))}},dF=Ge(uF,[["__scopeId","data-v-10b7523a"]]),hF={class:"accordion-section"},fF={class:"accordion-title"},pF=["innerHTML"],vF={key:0,class:"location-status active"},mF={key:1,class:"location-status"},gF={class:"accordion-icon"},yF={key:0,class:"accordion-content map-content"},kF={key:0,class:"map-selection-banner"},_F={class:"map-wrapper"},bF={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=ct(),a=uo("marshalBranding",{headerStyle:{},headerTextColor:""}),s=ui({headerStyle:U(()=>Mr(a.headerStyle)),headerTextColor:U(()=>Mr(a.headerTextColor))}),i=M(null);return t({mapRef:i,recenterOnLocation:(r,u,d)=>i.value?.recenterOnLocation?.(r,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.()}),(r,u)=>(v(),m("div",hF,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>r.$emit("toggle"))},[l("span",fF,[l("span",{class:"section-icon",innerHTML:D(Yn)("course")},null,8,pF),Qe(" "+w(D(o).course)+" ",1),e.userLocation?(v(),m("span",vF,"GPS Active")):(v(),m("span",mF,"GPS Inactive"))]),l("span",gF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",yF,[e.selectingLocation?(v(),m("div",kF,[l("span",null,[u[7]||(u[7]=Qe("Click on the map to set the new location for ",-1)),l("strong",null,w(e.selectingLocationName),1)]),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):A("",!0),l("div",_F,[Ee(hi,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":D(o).course,"fullscreen-header-style":s.headerStyle,"fullscreen-header-text-color":s.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:ve({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>r.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>r.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>r.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>r.$emit("visibility-change",d))},Lp({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:He(()=>[l("span",null,[u[8]||(u[8]=Qe("Click on the map to set the new location for ",-1)),l("strong",null,w(e.selectingLocationName),1)]),l("button",{onClick:u[2]||(u[2]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):A("",!0)]))}},wF=Ge(bF,[["__scopeId","data-v-97a9b1f4"]]),CF={class:"area-lead-content"},LF={key:0,class:"loading-state"},SF={key:1,class:"error-state"},IF={key:2,class:"empty-state"},xF={key:3,class:"checkpoint-accordion"},$F=["onClick"],TF={class:"checkpoint-header-content"},MF={class:"checkpoint-title-row"},AF={class:"checkpoint-name"},EF={key:0,class:"area-badge"},PF={key:0,class:"checkpoint-description-preview"},DF={class:"checkpoint-status-row"},OF={class:"status-badge marshals-status"},RF={key:0,class:"status-badge tasks-status"},BF={class:"accordion-icon"},NF={key:0,class:"checkpoint-accordion-content"},FF={class:"checkpoint-mini-map"},UF={class:"checkpoint-marshals-section"},zF={class:"marshals-label"},HF={key:0,class:"empty-state"},VF={key:1,class:"marshals-list"},GF=["onClick"],jF={class:"marshal-header"},ZF={class:"marshal-name-row"},qF={class:"marshal-name"},WF={key:0,class:"task-count"},KF={class:"check-status-row"},JF=["onClick","disabled"],YF={key:0,class:"check-in-time"},XF={key:0},QF={key:1,class:"last-access-time"},e7={key:0,class:"checkpoint-tasks-section"},t7={class:"marshals-label"},n7={class:"tasks-list"},o7=["disabled","onChange"],s7={class:"task-text"},a7=["disabled","onChange"],i7={class:"task-text"},l7={key:0,class:"marshal-details-modal"},r7={class:"details-section"},c7={class:"contact-info"},u7={key:0,class:"contact-row"},d7=["href"],h7={key:1,class:"contact-row"},f7=["href"],p7={key:2,class:"no-contact"},v7={class:"details-section"},m7={key:0,class:"checked-in-section"},g7={class:"checked-in-details"},y7={class:"check-time-detail"},k7={key:0,class:"check-method"},_7=["disabled"],b7={key:1,class:"not-checked-in-section"},w7=["disabled"],C7={key:2,class:"last-access-detail"},L7={class:"details-section"},S7={key:0,class:"no-tasks"},I7={key:1,class:"tasks-list modal-tasks"},x7=["disabled","onChange"],$7={class:"task-text"},T7={class:"details-section contact-actions-section"},M7={class:"contact-buttons"},A7=["href"],E7=["href"],P7=["href"],D7={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ct(),{updatePendingCount:i}=vd(),r=e,u=o,d=M(!1),h=M(null),p=M([]),g=M([]),y=M(null),_=M(!1),b=M(null),C=U(()=>{const z=new Set(r.areaIds);return z.size===0?[...g.value].sort((Y,ue)=>js(Y.name,ue.name)):g.value.filter(Y=>(Y.areaIds||[]).some(ke=>z.has(ke))).sort((Y,ue)=>js(Y.name,ue.name))}),I=(z,Y=60)=>z?z.length<=Y?z:z.substring(0,Y).trim()+"...":"",$=M(!1),x=M(null),S=M(null),B=async()=>{if(!(!r.eventId||r.areaIds.length===0)){if(d.value=!0,h.value=null,On()){try{const z=await La(r.eventId);if(z?.areaLeadDashboard){p.value=z.areaLeadDashboard.areas||[],g.value=z.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(z){console.warn("Failed to load cached dashboard:",z)}h.value="Offline - no cached data available",d.value=!1;return}try{const z=await ba.getAreaLeadDashboard(r.eventId);p.value=z.data.areas||[],g.value=z.data.checkpoints||[];try{const Y=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await La(r.eventId)?await xr(r.eventId,"areaLeadDashboard",Y):await Hl(r.eventId,{areaLeadDashboard:Y})}catch(Y){console.warn("Failed to cache dashboard:",Y)}}catch(z){console.error("Failed to load area lead dashboard:",z);try{const Y=await La(r.eventId);if(Y?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=Y.areaLeadDashboard.areas||[],g.value=Y.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Y){console.warn("Failed to load cached dashboard:",Y)}h.value=z.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},E=z=>{y.value=y.value===z?null:z},q=z=>z.marshals.filter(Y=>Y.isCheckedIn).length,P=z=>{const Y=z.marshals.reduce((ue,ke)=>ue+ke.outstandingTaskCount,0);return z.outstandingTaskCount+Y},F=(z,Y)=>{x.value=z,S.value=Y,$.value=!0},R=()=>{$.value=!1,x.value=null,S.value=null},j=async(z,Y)=>{if(b.value)return;const ue=z.assignmentId||z.id;if(!ue){console.error("No assignment ID found for marshal:",z);return}b.value=z.marshalId;try{if(On())await wo("checkin_toggle",{eventId:r.eventId,assignmentId:ue}),z.isCheckedIn=!0,z.checkInTime=new Date().toISOString(),z.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await Sa.toggleCheckIn(r.eventId,ue),await B(),u("checkin-updated"),x.value?.marshalId===z.marshalId&&S.value){const ke=g.value.find(Re=>Re.checkpointId===S.value.checkpointId);if(ke){const Re=ke.marshals.find(Ye=>Ye.marshalId===z.marshalId);Re&&(x.value=Re)}}}catch(ke){console.error("Failed to check in marshal:",ke),(On()||!ke.response)&&(await wo("checkin_toggle",{eventId:r.eventId,assignmentId:ue}),z.isCheckedIn=!0,z.checkInTime=new Date().toISOString(),z.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{b.value=null}},O=async(z,Y)=>{if(_.value)return;_.value=!0;const ke={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:r.marshalId,contextType:z.contextType,contextId:z.contextId};try{On()?(await wo("checklist_complete",{eventId:r.eventId,itemId:z.itemId,data:ke}),Y.outstandingTasks=Y.outstandingTasks.filter(Re=>Re.itemId!==z.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Rt.complete(r.eventId,z.itemId,ke),await B(),u("checklist-updated"))}catch(Re){console.error("Failed to complete task:",Re),(On()||!Re.response)&&(await wo("checklist_complete",{eventId:r.eventId,itemId:z.itemId,data:ke}),Y.outstandingTasks=Y.outstandingTasks.filter(Ye=>Ye.itemId!==z.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{_.value=!1}},G=async(z,Y)=>{if(_.value)return;_.value=!0;const ke={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:r.marshalId,contextType:z.contextType,contextId:z.contextId,actorMarshalId:r.marshalId};try{On()?(await wo("checklist_uncomplete",{eventId:r.eventId,itemId:z.itemId,data:ke}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(Re=>Re.itemId!==z.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(z),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Rt.uncomplete(r.eventId,z.itemId,ke),await B(),u("checklist-updated"))}catch(Re){console.error("Failed to uncomplete task:",Re),(On()||!Re.response)&&(await wo("checklist_uncomplete",{eventId:r.eventId,itemId:z.itemId,data:ke}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(Ye=>Ye.itemId!==z.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(z),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{_.value=!1}},Q=async z=>{if(_.value||!x.value)return;_.value=!0;const Y={marshalId:x.value.marshalId,contextType:z.contextType,contextId:z.contextId};try{if(On())await wo("checklist_complete",{eventId:r.eventId,itemId:z.itemId,data:Y}),x.value.outstandingTasks=x.value.outstandingTasks.filter(ue=>ue.itemId!==z.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Rt.complete(r.eventId,z.itemId,Y),await B(),x.value&&S.value){const ue=g.value.find(ke=>ke.checkpointId===S.value.checkpointId);if(ue){const ke=ue.marshals.find(Re=>Re.marshalId===x.value.marshalId);ke&&(x.value=ke)}}u("checklist-updated")}}catch(ue){console.error("Failed to complete task:",ue),(On()||!ue.response)&&(await wo("checklist_complete",{eventId:r.eventId,itemId:z.itemId,data:Y}),x.value.outstandingTasks=x.value.outstandingTasks.filter(ke=>ke.itemId!==z.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{_.value=!1}},se=z=>z?new Date(z).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",pe=z=>z?new Date(z).toLocaleString():"",ee=z=>{if(!z)return"";const Y=new Date(z),ke=new Date-Y,Re=Math.floor(ke/6e4),Ye=Math.floor(Re/60),Ne=Math.floor(Ye/24);return Re<1?"just now":Re<60?`${Re}m ago`:Ye<24?`${Ye}h ago`:Ne===1?"yesterday":Ne<7?`${Ne}d ago`:Y.toLocaleDateString()},te=z=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[z]||z;return t({areas:p,checkpoints:g,loading:d,loadDashboard:B}),Ze(()=>r.eventId,()=>{B()},{immediate:!0}),(z,Y)=>(v(),m("div",CF,[d.value?(v(),m("div",LF," Loading dashboard... ")):h.value?(v(),m("div",SF,[l("p",null,w(h.value),1),l("button",{onClick:B,class:"btn btn-secondary"},"Retry")])):C.value.length===0?(v(),m("div",IF,[l("p",null,"No "+w(D(s).checkpoints)+" in your "+w(D(s).areas)+".",1)])):(v(),m("div",xF,[(v(!0),m(Me,null,Fe(C.value,ue=>(v(),m("div",{key:ue.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:ve(["checkpoint-accordion-header",{active:y.value===ue.checkpointId}]),onClick:ke=>E(ue.checkpointId)},[l("div",TF,[l("div",MF,[l("span",AF,w(ue.name),1),ue.areaName?(v(),m("span",EF,w(ue.areaName),1)):A("",!0)]),ue.description?(v(),m("div",PF,w(I(ue.description)),1)):A("",!0),l("div",DF,[l("span",OF,w(q(ue))+" / "+w(ue.marshals.length)+" checked in ",1),P(ue)>0?(v(),m("span",RF,w(P(ue))+" tasks ",1)):A("",!0)])]),l("span",BF,w(y.value===ue.checkpointId?"":"+"),1)],10,$F),y.value===ue.checkpointId?(v(),m("div",NF,[l("div",FF,[Ee(hi,{locations:[{id:ue.checkpointId,name:ue.name,description:ue.description,latitude:ue.latitude,longitude:ue.longitude}],route:e.route,center:{lat:ue.latitude,lng:ue.longitude},zoom:16,"highlight-location-id":ue.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),l("div",UF,[l("div",zF,w(D(a).people)+" ("+w(ue.marshals.length)+")",1),ue.marshals.length===0?(v(),m("div",HF," No "+w(D(s).people)+" assigned to this "+w(D(s).checkpoint)+". ",1)):(v(),m("div",VF,[(v(!0),m(Me,null,Fe(ue.marshals,ke=>(v(),m("div",{key:ke.marshalId,class:ve(["marshal-card",{"is-checked-in":ke.isCheckedIn}]),onClick:Re=>F(ke,ue)},[l("div",jF,[l("div",ZF,[l("span",qF,w(ke.name),1),ke.outstandingTaskCount>0?(v(),m("span",WF,w(ke.outstandingTaskCount)+" tasks ",1)):A("",!0)]),l("div",KF,[l("div",{class:ve(["check-status",{"checked-in":ke.isCheckedIn}])},w(ke.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:it(Re=>j(ke),["stop"]),class:ve(["quick-checkin-btn",{"undo-btn":ke.isCheckedIn}]),disabled:b.value===ke.marshalId},w(b.value===ke.marshalId?"...":ke.isCheckedIn?"Undo":"Check In"),11,JF)])]),ke.isCheckedIn&&ke.checkInTime?(v(),m("div",YF,[Qe(w(se(ke.checkInTime))+" ",1),ke.checkInMethod?(v(),m("span",XF," ("+w(te(ke.checkInMethod))+")",1)):A("",!0)])):A("",!0),ke.lastAccessedAt?(v(),m("div",QF," Last active: "+w(ee(ke.lastAccessedAt)),1)):A("",!0)],10,GF))),128))]))]),ue.outstandingTaskCount>0||ue.completedTasks&&ue.completedTasks.length>0?(v(),m("div",e7,[l("div",t7,w(D(a).checkpoint)+" tasks",1),l("div",n7,[(v(!0),m(Me,null,Fe(ue.outstandingTasks,ke=>(v(),m("div",{key:ke.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:_.value,onChange:Re=>O(ke,ue)},null,40,o7),l("span",s7,w(ke.text),1)]))),128)),(v(!0),m(Me,null,Fe(ue.completedTasks||[],ke=>(v(),m("div",{key:`completed-${ke.itemId}`,class:"task-item task-completed"},[l("input",{type:"checkbox",checked:"",disabled:_.value,onChange:Re=>G(ke,ue)},null,40,a7),l("span",i7,w(ke.text),1)]))),128))])])):A("",!0)])):A("",!0)]))),128))])),Ee(Gt,{show:$.value,title:x.value?.name||"Marshal Details",size:"large",onClose:R},{actions:He(()=>[l("button",{onClick:R,class:"btn btn-secondary"},"Close")]),default:He(()=>[x.value?(v(),m("div",l7,[l("div",r7,[Y[4]||(Y[4]=l("h4",null,"Contact Details",-1)),l("div",c7,[x.value.email?(v(),m("div",u7,[Y[2]||(Y[2]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${x.value.email}`},w(x.value.email),9,d7)])):A("",!0),x.value.phoneNumber?(v(),m("div",h7,[Y[3]||(Y[3]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${x.value.phoneNumber}`},w(x.value.phoneNumber),9,f7)])):A("",!0),!x.value.email&&!x.value.phoneNumber?(v(),m("div",p7," No contact details available. ")):A("",!0)])]),l("div",v7,[Y[8]||(Y[8]=l("h4",null,"Check-in Status",-1)),x.value.isCheckedIn?(v(),m("div",m7,[l("div",g7,[Y[6]||(Y[6]=l("span",{class:"check-icon"},"",-1)),l("div",null,[Y[5]||(Y[5]=l("strong",null,"Checked In",-1)),l("p",y7,w(pe(x.value.checkInTime)),1),x.value.checkInMethod?(v(),m("p",k7," Method: "+w(te(x.value.checkInMethod)),1)):A("",!0)])]),l("button",{onClick:Y[0]||(Y[0]=ue=>j(x.value,S.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===x.value.marshalId},w(b.value===x.value.marshalId?"Undoing...":"Undo Check-in"),9,_7)])):(v(),m("div",b7,[Y[7]||(Y[7]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:Y[1]||(Y[1]=ue=>j(x.value,S.value)),class:"btn btn-primary check-in-btn",disabled:b.value===x.value.marshalId},w(b.value===x.value.marshalId?"Checking in...":"Check In"),9,w7)])),x.value.lastAccessedAt?(v(),m("div",C7," Last active: "+w(ee(x.value.lastAccessedAt)),1)):A("",!0)]),l("div",L7,[l("h4",null,w(D(a).checklists)+" ("+w(x.value.outstandingTasks?.length||0)+" outstanding)",1),!x.value.outstandingTasks||x.value.outstandingTasks.length===0?(v(),m("div",S7," No outstanding tasks. ")):(v(),m("div",I7,[(v(!0),m(Me,null,Fe(x.value.outstandingTasks,ue=>(v(),m("div",{key:ue.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:_.value,onChange:ke=>Q(ue)},null,40,x7),l("span",$7,w(ue.text),1)]))),128))]))]),l("div",T7,[l("div",M7,[x.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${x.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,A7)):A("",!0),x.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${x.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,E7)):A("",!0),x.value.email?(v(),m("a",{key:2,href:`mailto:${x.value.email}`,class:"btn btn-secondary"}," Email ",8,P7)):A("",!0)])])])):A("",!0)]),_:1},8,["show","title"])]))}},O7=Ge(D7,[["__scopeId","data-v-067e0528"]]),R7={key:0,class:"accordion-section"},B7={class:"accordion-title"},N7=["innerHTML"],F7={class:"accordion-icon"},U7={key:0,class:"accordion-content area-lead-accordion-content"},z7={key:0,class:"area-filter-pills"},H7=["onClick"],V7={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=ct(),a=M(null);return t({areaLeadRef:a}),(s,i)=>e.isAreaLead?(v(),m("div",R7,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",B7,[l("span",{class:"section-icon",innerHTML:D(Yn)("area")},null,8,N7),Qe(" Your "+w(e.areas.length===1?D(o).area:D(o).areas)+w(e.areas.length>1?` (${e.areas.length})`:""),1)]),l("span",F7,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",U7,[e.areas.length>1?(v(),m("div",z7,[(v(!0),m(Me,null,Fe(e.areas,r=>(v(),m("button",{key:r.areaId,class:ve(["area-filter-pill",{selected:e.selectedFilters.has(r.areaId)}]),style:et(e.selectedFilters.has(r.areaId)?{backgroundColor:r.color||"#667eea",borderColor:r.color||"#667eea"}:{}),onClick:u=>s.$emit("toggle-filter",r.areaId)},w(r.name),15,H7))),128))])):A("",!0),Ee(O7,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=r=>s.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):A("",!0)])):A("",!0)}},G7=Ge(V7,[["__scopeId","data-v-9278e6a8"]]),j7={key:0,class:"accordion-section"},Z7={class:"accordion-title"},q7=["innerHTML"],W7={class:"accordion-icon"},K7={key:0,class:"accordion-content area-lead-marshals-content"},J7={class:"area-lead-marshals-list"},Y7=["onClick"],X7={class:"marshal-header-info"},Q7={class:"marshal-name-row"},eU={class:"marshal-name"},tU={class:"marshal-meta"},nU={class:"marshal-checkpoint"},oU={key:0,class:"marshal-task-count"},sU={class:"accordion-icon"},aU={key:0,class:"area-lead-marshal-content"},iU={class:"marshal-checkin-section"},lU={key:0,class:"marshal-contact-section"},rU=["href"],cU=["href"],uU={key:1,class:"marshal-tasks-section"},dU={class:"tasks-label"},hU={class:"tasks-list"},fU=["checked","disabled","onChange"],pU={class:"task-text"},vU={key:2,class:"no-tasks-message"},mU={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=ct(),a=s=>!s||s.length===0?"":s.length===1?s[0].name:s.map(i=>i.name).join(", ");return(s,i)=>e.isAreaLead&&e.marshals.length>0?(v(),m("div",j7,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",Z7,[l("span",{class:"section-icon",innerHTML:D(Yn)("marshal")},null,8,q7),Qe(" Your "+w(e.marshals.length===1?D(o).person:D(o).people)+w(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),l("span",W7,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",K7,[l("div",J7,[(v(!0),m(Me,null,Fe(e.marshals,r=>(v(),m("div",{key:r.marshalId,class:"area-lead-marshal-item"},[l("button",{class:ve(["area-lead-marshal-header",{active:e.expandedMarshalId===r.marshalId,"is-checked-in":r.isCheckedIn}]),onClick:u=>s.$emit("toggle-marshal",r.marshalId)},[l("div",X7,[l("div",Q7,[l("span",eU,w(r.name),1),l("span",{class:ve(["check-status-badge",{"checked-in":r.isCheckedIn}])},w(r.isCheckedIn?"":""),3)]),l("div",tU,[l("span",nU,w(a(r.checkpoints)),1),r.totalTaskCount>0?(v(),m("span",oU,w(r.completedTaskCount)+" / "+w(r.totalTaskCount)+" "+w(D(o).checklists)+" complete ",1)):A("",!0)])]),l("span",sU,w(e.expandedMarshalId===r.marshalId?"":"+"),1)],10,Y7),e.expandedMarshalId===r.marshalId?(v(),m("div",aU,[l("div",iU,[Ee(Kr,{"is-checked-in":r.isCheckedIn,"check-in-time":r.checkInTime,"check-in-method":r.checkInMethod,"checked-in-by":r.checkedInBy,"marshal-name":r.marshalName,"is-loading":e.checkingInMarshalId===r.id,onToggle:u=>s.$emit("check-in",r)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),r.email||r.phoneNumber?(v(),m("div",lU,[r.phoneNumber?(v(),m("a",{key:0,href:`tel:${r.phoneNumber}`,class:"contact-link"},w(r.phoneNumber),9,rU)):A("",!0),r.email?(v(),m("a",{key:1,href:`mailto:${r.email}`,class:"contact-link"},w(r.email),9,cU)):A("",!0)])):A("",!0),r.allTasks.length>0?(v(),m("div",uU,[l("div",dU,w(D(t).checklists),1),l("div",hU,[(v(!0),m(Me,null,Fe(r.allTasks,u=>(v(),m("div",{key:`${u.itemId}-${u.contextId}`,class:ve(["task-item",{"task-completed":u.isCompleted}])},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>s.$emit("toggle-task",u,r)},null,40,fU),l("span",pU,w(u.text),1)],2))),128))])])):(v(),m("div",vU," No "+w(D(o).checklists)+" assigned. ",1))])):A("",!0)]))),128))])])):A("",!0)])):A("",!0)}},gU=Ge(mU,[["__scopeId","data-v-49a1421b"]]),yU={class:"checkpoint-note-header"},kU={key:0,class:"pin-icon",title:"Pinned"},_U={class:"checkpoint-note-title"},bU={key:0,class:"checkpoint-note-content"},wU={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=U(()=>(t.priority||"Normal").toLowerCase());return(a,s)=>(v(),m("div",{class:ve(["checkpoint-note-item",o.value])},[l("div",yU,[e.isPinned?(v(),m("span",kU,"")):A("",!0),l("span",{class:ve(["priority-indicator",o.value])},null,2),l("strong",_U,w(e.title),1),l("span",{class:ve(["priority-badge",o.value])},w(e.priority),3)]),e.content?(v(),m("div",bU,w(e.content),1)):A("",!0)],2))}},CU=Ge(wU,[["__scopeId","data-v-5f2df920"]]);function dm({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:o=[],areaLeadAreaIds:a=[],locationId:s,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const r of e){const u=r.scope||r.Scope,d=r.ids||r.Ids||[];switch(u){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(o.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(s))&&o.includes(s)||d.some(p=>o.includes(p)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(o.length>0)return!0}else if(d.some(p=>i.includes(p))&&o.includes(s))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(a.length>0)return!0}else if(d.some(p=>a.includes(p)))return!0;break}}return!1}const LU={class:"checkpoint-accordion-section"},SU={class:"checkpoint-header-content"},IU={class:"checkpoint-title-row"},xU=["innerHTML"],$U={key:0,class:"checkpoint-check-icon"},TU={class:"checkpoint-name"},MU={key:1,class:"area-badge"},AU={key:2,class:"checkpoint-time-badge"},EU={key:3,class:"checkpoint-distance-badge"},PU={key:0,class:"checkpoint-description-preview"},DU={class:"accordion-icon"},OU={key:0,class:"checkpoint-accordion-content"},RU={key:0,class:"checkpoint-mini-map"},BU={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},NU={class:"my-checkin-section"},FU={key:0,class:"check-in-error"},UU={class:"checkpoint-marshals"},zU={class:"marshals-label"},HU={key:0,class:"marshals-list"},VU={key:0,class:"check-badge"},GU={key:1,class:"marshals-list-expanded"},jU=["onClick"],ZU={class:"marshal-name-text"},qU={class:"marshal-status-icons"},WU={key:0,class:"check-badge"},KU={class:"expand-icon"},JU={key:0,class:"marshal-details-panel"},YU={class:"detail-row"},XU={key:0,class:"detail-row"},QU={key:1,class:"detail-row"},ez={key:2,class:"detail-row"},tz=["href"],nz={key:3,class:"detail-row"},oz=["href"],sz={key:4,class:"contact-buttons-mini"},az=["href"],iz=["href"],lz=["href"],rz={key:5,class:"checkpoint-marshal-checkin"},cz={key:1,class:"checkpoint-area-contacts"},uz={class:"marshals-label"},dz={class:"contact-list"},hz={key:2,class:"checkpoint-notes"},fz={class:"checkpoint-notes-list"},pz={key:3,class:"dynamic-location-section"},vz={class:"dynamic-location-header"},mz={class:"dynamic-badge"},gz={key:0,class:"last-update"},yz={key:0,class:"dynamic-location-actions"},kz=["disabled"],_z=["title"],bz={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=ct(),s=uo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ui({headerStyle:U(()=>Mr(s.headerStyle)),headerTextColor:U(()=>Mr(s.headerTextColor))}),r=e,u=M(null),d=U(()=>r.assignment.location?.isDynamic),h=U(()=>{if(!d.value)return!1;const $=r.assignment.location,x=$?.locationUpdateScopeConfigurations||$?.LocationUpdateScopeConfigurations||[];return dm({scopeConfigurations:x,marshalId:r.currentMarshalId,marshalAssignmentLocationIds:r.allAssignmentLocationIds,areaLeadAreaIds:r.areaLeadAreaIds,locationId:r.assignment.locationId,locationAreaIds:r.assignment.areaIds||[]})}),p=U(()=>{if(!r.userLocation?.lat||!r.userLocation?.lng)return null;const $=r.assignment.location;return!$?.latitude||!$?.longitude?null:di(r.userLocation.lat,r.userLocation.lng,$.latitude,$.longitude)}),g=U(()=>{const $=p.value;return $==null?null:$<1e3?`${Math.round($/10)*10} m`:`${(Math.round($/100)/10).toFixed(1)} km`});t({mapRef:u});const y=$=>{const x=$?.iconType||"checkpoint",S=$?.iconColor||"#667eea",B={checkpoint:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return B[x]||B.checkpoint},_=($,x)=>{const S=B=>B?new Date(B).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return $&&x?`${S($)} - ${S(x)}`:$?`from ${S($)}`:x?`until ${S(x)}`:""},b=$=>$?new Date($).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",C=$=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[$]||$,I=$=>$?new Date($).toLocaleString():"";return($,x)=>(v(),m("div",LU,[l("button",{class:ve(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:x[0]||(x[0]=S=>$.$emit("toggle"))},[l("div",SU,[l("div",IU,[l("span",{class:"checkpoint-icon",innerHTML:y(e.assignment.location)},null,8,xU),e.assignment.effectiveIsCheckedIn?(v(),m("span",$U,"")):A("",!0),l("span",TU,w(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),m("span",MU,w(e.assignment.areaName),1)):A("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),m("span",AU,w(_(e.assignment.location.startTime,e.assignment.location.endTime)),1)):A("",!0),g.value?(v(),m("span",EU,w(g.value),1)):A("",!0)]),e.assignment.location?.description?(v(),m("div",PU,w(e.assignment.location.description),1)):A("",!0)]),l("span",DU,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",OU,[e.assignment.location?(v(),m("div",RU,[Ee(hi,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:x[2]||(x[2]=S=>$.$emit("map-click",S)),onLocationClick:x[3]||(x[3]=S=>$.$emit("location-click",S)),onActionClick:x[4]||(x[4]=S=>$.$emit("action-click",S)),onVisibilityChange:x[5]||(x[5]=S=>$.$emit("visibility-change",S))},Lp({_:2},[h.value?{name:"fullscreen-footer",fn:He(()=>[l("button",{class:"btn btn-primary",onClick:x[1]||(x[1]=S=>$.$emit("update-location"))},[(v(),m("svg",BU,[...x[9]||(x[9]=[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),x[10]||(x[10]=Qe(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):A("",!0),l("div",NU,[Ee(Kr,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:x[6]||(x[6]=S=>$.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),m("div",FU,w(e.checkInError),1)):A("",!0)]),l("div",UU,[l("div",zU,w(D(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),m("div",GU,[(v(!0),m(Me,null,Fe(e.assignment.allMarshals,S=>(v(),m("div",{key:S.marshalId,class:ve(["marshal-card-mini",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn,expanded:e.expandedMarshalId===S.marshalId}])},[l("button",{class:"marshal-card-header",onClick:B=>$.$emit("toggle-marshal",S.marshalId)},[l("span",ZU,w(S.marshalName)+w(S.marshalId===e.currentMarshalId?" (you)":""),1),l("span",qU,[S.effectiveIsCheckedIn?(v(),m("span",WU,"")):A("",!0),l("span",KU,w(e.expandedMarshalId===S.marshalId?"":"+"),1)])],8,jU),e.expandedMarshalId===S.marshalId?(v(),m("div",JU,[l("div",YU,[x[11]||(x[11]=l("span",{class:"detail-label"},"Status:",-1)),l("span",{class:ve(S.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},w(S.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),S.effectiveIsCheckedIn&&S.checkInTime?(v(),m("div",XU,[x[12]||(x[12]=l("span",{class:"detail-label"},"Check-in time:",-1)),l("span",null,w(b(S.checkInTime)),1)])):A("",!0),S.checkInMethod?(v(),m("div",QU,[x[13]||(x[13]=l("span",{class:"detail-label"},"Method:",-1)),l("span",null,w(C(S.checkInMethod)),1)])):A("",!0),S.email?(v(),m("div",ez,[x[14]||(x[14]=l("span",{class:"detail-label"},"Email:",-1)),l("a",{href:"mailto:"+S.email},w(S.email),9,tz)])):A("",!0),S.phoneNumber?(v(),m("div",nz,[x[15]||(x[15]=l("span",{class:"detail-label"},"Phone:",-1)),l("a",{href:"tel:"+S.phoneNumber},w(S.phoneNumber),9,oz)])):A("",!0),S.email||S.phoneNumber?(v(),m("div",sz,[S.phoneNumber?(v(),m("a",{key:0,href:"tel:"+S.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,az)):A("",!0),S.phoneNumber?(v(),m("a",{key:1,href:"sms:"+S.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,iz)):A("",!0),S.email?(v(),m("a",{key:2,href:"mailto:"+S.email,class:"btn btn-sm btn-secondary"},"Email",8,lz)):A("",!0)])):A("",!0),S.marshalId!==e.currentMarshalId?(v(),m("div",rz,[Ee(Kr,{"is-checked-in":S.effectiveIsCheckedIn,"check-in-time":S.checkInTime,"check-in-method":S.checkInMethod,"checked-in-by":S.checkedInBy,"marshal-name":S.marshalName,"is-loading":e.checkingInMarshalId===S.id,onToggle:B=>$.$emit("marshal-check-in",S)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):A("",!0)])):A("",!0)],2))),128))])):(v(),m("div",HU,[(v(!0),m(Me,null,Fe(e.assignment.allMarshals,S=>(v(),m("span",{key:S.marshalId,class:ve(["marshal-tag",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn}])},[Qe(w(S.marshalName)+w(S.marshalId===e.currentMarshalId?" (you)":"")+" ",1),S.effectiveIsCheckedIn?(v(),m("span",VU,"")):A("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),m("div",cz,[l("div",uz,w(D(o).area)+" contacts:",1),l("div",dz,[(v(!0),m(Me,null,Fe(e.assignment.areaContacts,S=>(v(),qe(um,{key:S.marshalId,name:S.marshalName,role:S.role,phone:S.phone,email:S.email},null,8,["name","role","phone","email"]))),128))])])):A("",!0),e.notes.length>0?(v(),m("div",hz,[x[16]||(x[16]=l("div",{class:"marshals-label"},"Notes:",-1)),l("div",fz,[(v(!0),m(Me,null,Fe(e.notes,S=>(v(),qe(CU,{key:S.noteId,title:S.title,content:S.content,priority:S.priority,"is-pinned":S.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):A("",!0),d.value?(v(),m("div",pz,[l("div",vz,[l("span",mz,"Dynamic "+w(e.assignment.location.resolvedCheckpointTerm||D(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),m("span",gz," Last updated: "+w(I(e.assignment.location.lastLocationUpdate)),1)):A("",!0)]),h.value?(v(),m("div",yz,[l("button",{onClick:x[7]||(x[7]=S=>$.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...x[17]||(x[17]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Qe(" Update location ",-1)])],8,kz),l("button",{onClick:x[8]||(x[8]=S=>$.$emit("toggle-auto-update")),class:ve(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[x[18]||(x[18]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Qe(" "+w(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,_z)])):A("",!0)])):A("",!0)])):A("",!0)]))}},wz=Ge(bz,[["__scopeId","data-v-bf4c0c36"]]),Cz={class:"accordion-section"},Lz={class:"accordion-title"},Sz=["innerHTML"],Iz={class:"accordion-icon"},xz={key:0,class:"accordion-content assignments-accordion-content"},$z={key:0,class:"empty-state"},Tz={key:1,class:"checkpoint-accordion"},Mz={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=ct(),a=e,s=U(()=>a.assignments.map(u=>u.locationId)),i={},r=(u,d)=>{d?i[u]=d:delete i[u]};return t({checkpointRefs:i}),(u,d)=>(v(),m("div",Cz,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>u.$emit("toggle"))},[l("span",Lz,[l("span",{class:"section-icon",innerHTML:D(Yn)("checkpoint")},null,8,Sz),Qe(" Your "+w(e.assignments.length===1?D(o).checkpoint:D(o).checkpoints)+w(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),l("span",Iz,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",xz,[e.assignments.length===0?(v(),m("div",$z,[l("p",null,"You don't have any "+w(D(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",Tz,[(v(!0),m(Me,null,Fe(e.assignments,h=>(v(),qe(wz,{key:h.id,ref_for:!0,ref:p=>r(h.id,p),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId,h.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":s.value,onToggle:p=>u.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=p=>u.$emit("map-click",p)),onLocationClick:d[2]||(d[2]=p=>u.$emit("location-click",p)),onActionClick:p=>u.$emit("action-click",h,p),onVisibilityChange:p=>u.$emit("visibility-change",h.id,p),onUpdateLocation:p=>u.$emit("update-location",h),onCheckIn:p=>u.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=p=>u.$emit("toggle-marshal",p)),onMarshalCheckIn:p=>u.$emit("marshal-check-in",p,h.locationId),onToggleAutoUpdate:p=>u.$emit("toggle-auto-update",h)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):A("",!0)]))}},Az=Ge(Mz,[["__scopeId","data-v-24c613ab"]]),hm="marshal-branding-cache";function Ez(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${hm}-${e}`);return t?JSON.parse(t):null}catch{return null}}function Pz(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${hm}-${e}`,JSON.stringify(t))}catch{}}function Dz(e,t=null){const o=M(t?Ez(t):null);Ze(()=>e.value,y=>{if(y&&t){const _={brandingPageGradientStart:y.brandingPageGradientStart,brandingPageGradientEnd:y.brandingPageGradientEnd,brandingHeaderGradientStart:y.brandingHeaderGradientStart,brandingHeaderGradientEnd:y.brandingHeaderGradientEnd,brandingAccentColor:y.brandingAccentColor,brandingLogoUrl:y.brandingLogoUrl,brandingLogoPosition:y.brandingLogoPosition};Pz(t,_),o.value=_}},{immediate:!0});const a=(y,_)=>e.value?.[y]||o.value?.[y]||_,s=U(()=>{const y=a("brandingPageGradientStart",cn.pageGradientStart),_=a("brandingPageGradientEnd",cn.pageGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${_} 100%)`}}),i=U(()=>{const y=a("brandingHeaderGradientStart",cn.headerGradientStart),_=a("brandingHeaderGradientEnd",cn.headerGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${_} 100%)`}}),r=U(()=>{const y=a("brandingHeaderGradientStart",cn.headerGradientStart),_=a("brandingHeaderGradientEnd",cn.headerGradientEnd);return sm(y,_)}),u=U(()=>a("brandingAccentColor",cn.accentColor)),d=U(()=>Ru(u.value)),h=U(()=>({background:u.value,color:d.value})),p=U(()=>{const y=a("brandingLogoUrl","");return y?y.startsWith("/api")?ka+y.substring(4):y:""}),g=U(()=>a("brandingLogoPosition","left"));return{pageBackgroundStyle:s,headerStyle:i,headerTextColor:r,accentColor:u,accentTextColor:d,accentButtonStyle:h,brandingLogoUrl:p,brandingLogoPosition:g}}function Oz(){const e=M(null),t=M(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return kn(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:s}}function Rz({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:s,isAreaLead:i,allLocations:r,areas:u,terms:d,termsLower:h,areaLeadRef:p,areaLeadCheckpoints:g,sectionLastLoadedAt:y,updateCachedField:_,updatePendingCount:b}){const C=M([]),I=M(!1),$=M(null),x=M(!1),S=M("person"),B=M(null),E=U(()=>C.value.filter(z=>z.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(z.matchedScope)?z.completedByActorId===t.value:!0)),q=U(()=>E.value.filter(z=>z.isCompleted).length),P=U(()=>{const z=a.value.map(Y=>Y.locationId);return E.value.filter(Y=>Y.completionContextType==="Personal"?Y.contextOwnerMarshalId===t.value:Y.completionContextType==="Checkpoint"?z.includes(Y.completionContextId):Y.completionContextType==="Area"?s.value.includes(Y.completionContextId):!0)}),F=U(()=>{if(!i.value)return[];const z=a.value.map(Y=>Y.locationId);return E.value.filter(Y=>Y.completionContextType==="Personal"?Y.contextOwnerMarshalId!==t.value:Y.completionContextType==="Checkpoint"?!z.includes(Y.completionContextId):Y.completionContextType==="Area"?!s.value.includes(Y.completionContextId):!1)}),R=U(()=>P.value.map(z=>({...z,localIsCompleted:z.isCompleted,isModified:!1}))),j=U(()=>F.value.map(z=>({...z,localIsCompleted:z.isCompleted,isModified:!1}))),O=U(()=>{const z=p.value?.checkpoints||g.value||[];if(z.length===0)return[];const Y=[],ue=new Set;for(const ke of z)for(const Re of ke.marshals||[])ue.has(Re.marshalId)||(ue.add(Re.marshalId),Y.push(Re));return Y}),G=U(()=>{if(i.value)return"none";const z=E.value,Y=new Set;for(const ue of z)ue.completionContextType==="Checkpoint"&&ue.completionContextId&&Y.add(ue.completionContextId);return Y.size>1?"checkpoint":"none"}),Q=U(()=>{const z=E.value,Y={};for(const ue of z){let ke,Re;ue.completionContextType==="Checkpoint"&&ue.completionContextId?(ke=`checkpoint_${ue.completionContextId}`,Re=r.value.find(Ne=>Ne.id===ue.completionContextId)?.name||"Unknown "+d.value.checkpoint):ue.completionContextType==="Area"&&ue.completionContextId?(ke=`area_${ue.completionContextId}`,Re=u.value.find(Ne=>Ne.id===ue.completionContextId)?.name||"Unknown "+d.value.area):(ke="personal",Re="Personal"),Y[ke]||(Y[ke]={key:ke,name:Re,items:[],completedCount:0}),Y[ke].items.push(ue),ue.isCompleted&&Y[ke].completedCount++}return Object.values(Y).sort((ue,ke)=>ue.name.localeCompare(ke.name,void 0,{numeric:!0,sensitivity:"base"}))}),se=z=>{B.value=B.value===z?null:z},pe=z=>{if(!z.completionContextType||!z.completionContextId)return null;if(z.completionContextType==="Checkpoint"){const Y=r.value.find(ke=>ke.id===z.completionContextId);if(!Y)return null;const ue=Y.description?` - ${Y.description}`:"";return`At ${h.value.checkpoint} ${Y.name}${ue}`}if(z.completionContextType==="Area"){const Y=u.value.find(ue=>ue.id===z.completionContextId);return Y?`At ${h.value.area} ${Y.name}`:null}return z.completionContextType==="Personal"?"Personal item":null},ee=async(z=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}z||(I.value=!0),$.value=null;try{const Y=e.value;console.log("Fetching checklist for marshal:",t.value);let ke=(await Rt.getMarshalChecklist(Y,t.value)).data||[];if(i.value&&s.value.length>0){console.log("Fetching area checklists for areas:",s.value);const Re=s.value.map(Ke=>Rt.getAreaChecklist(Y,Ke).catch(We=>(console.warn(`Failed to fetch checklist for area ${Ke}:`,We),{data:[]}))),Ye=await Promise.all(Re),Ne=new Map;for(const Ke of ke){const We=`${Ke.itemId}_${Ke.completionContextType}_${Ke.completionContextId}`;Ne.set(We,Ke)}for(const Ke of Ye)for(const We of Ke.data||[]){const X=`${We.itemId}_${We.completionContextType}_${We.completionContextId}`;Ne.has(X)||Ne.set(X,We)}ke=Array.from(Ne.values()),console.log("Merged checklist items:",ke.length)}C.value=ke,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",C.value.length,"items")}catch(Y){console.error("Failed to load checklist:",Y.response?.status,Y.response?.data),$.value=Y.response?.data?.message||"Failed to load checklist"}finally{z||(I.value=!1)}};return{checklistItems:C,checklistLoading:I,checklistError:$,savingChecklist:x,checklistGroupBy:S,expandedChecklistGroup:B,visibleChecklistItems:E,completedChecklistCount:q,myChecklistItems:P,areaChecklistItems:F,myChecklistItemsWithLocalState:R,areaChecklistItemsWithLocalState:j,areaMarshalsForChecklist:O,effectiveChecklistGroupBy:G,groupedChecklistItems:Q,loadChecklist:ee,handleToggleChecklist:async z=>{if(x.value)return;x.value=!0;const Y=e.value,ue={marshalId:z.contextOwnerMarshalId||t.value,contextType:z.completionContextType,contextId:z.completionContextId,actorMarshalId:t.value};try{z.isCompleted?On()?(await wo("checklist_uncomplete",{eventId:Y,itemId:z.itemId,data:ue}),z.isCompleted=!1,z.completedAt=null,z.completedByActorName=null,b&&await b()):(await Rt.uncomplete(Y,z.itemId,ue),await ee(!0)):On()?(await wo("checklist_complete",{eventId:Y,itemId:z.itemId,data:ue}),z.isCompleted=!0,z.completedAt=new Date().toISOString(),z.completedByActorName=o.value?.name||"You",b&&await b()):(await Rt.complete(Y,z.itemId,ue),await ee(!0)),_&&await _(Y,"checklist",JSON.parse(JSON.stringify(C.value)))}catch(ke){if(console.error("Failed to toggle checklist item:",ke),On()||!ke.response){const Re=z.isCompleted?"checklist_uncomplete":"checklist_complete";await wo(Re,{eventId:Y,itemId:z.itemId,data:ue}),z.isCompleted?(z.isCompleted=!1,z.completedAt=null,z.completedByActorName=null):(z.isCompleted=!0,z.completedAt=new Date().toISOString(),z.completedByActorName=o.value?.name||"You"),b&&await b(),_&&await _(Y,"checklist",JSON.parse(JSON.stringify(C.value)))}}finally{x.value=!1}},toggleChecklistGroup:se,getContextName:pe}}function Bz({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const s=M(!1),i=M(null),r=M(null),u=M(null),d=M(!1),h=M(!1),p=M(!1);let g=null,y=null;const _=se=>se?.isDynamic===!0||se?.IsDynamic===!0,b=(se,pe,ee,te)=>{const z=t.value.find(Y=>Y.id===se);z&&(z.latitude=pe,z.longitude=ee,z.lastLocationUpdate=te)},C=se=>{i.value=se,r.value=null,u.value=null,s.value=!0},I=()=>{s.value=!1,i.value=null,r.value=null,u.value=null,p.value=!1},$=()=>{s.value=!1,p.value=!0},x=()=>{p.value=!1,s.value=!0},S=async(se,pe,ee,te,z=null)=>{d.value=!0;try{const Y=e.value,ue={latitude:pe,longitude:ee,sourceType:te};z&&(ue.sourceCheckpointId=z);const ke=await Jn.updatePosition(Y,se,ue);ke.data.success&&(h.value&&R(),b(se,ke.data.latitude,ke.data.longitude,ke.data.lastLocationUpdate))}catch(Y){console.error("Failed to update location:",Y),Y.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},B=async()=>{if(i.value){d.value=!0,r.value=null;try{let se,pe;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(se=o.value.lat,pe=o.value.lng),!se||!pe){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Y=await new Promise((ue,ke)=>{navigator.geolocation.getCurrentPosition(ue,ke,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});se=Y.coords.latitude,pe=Y.coords.longitude}const ee=e.value,te=i.value.locationId,z=await Jn.updatePosition(ee,te,{latitude:se,longitude:pe,sourceType:"gps"});z.data.success&&(u.value="Location updated successfully!",b(te,z.data.latitude,z.data.longitude,z.data.lastLocationUpdate),setTimeout(()=>I(),1500))}catch(se){console.error("Failed to update location with GPS:",se),se.response?.status===403?r.value="You do not have permission to update this location.":se.code===1?r.value="Location access denied. Please enable location permissions.":se.code===2?r.value="Unable to determine your location. Please try again.":se.code===3||se.message?.includes("Timeout")?r.value="GPS timed out. Please ensure location services are enabled and try again.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},E=async se=>{if(!i.value)return;const pe=t.value.find(ee=>ee.id===se);if(!pe){r.value="Source checkpoint not found.";return}d.value=!0,r.value=null;try{const ee=e.value,te=i.value.locationId,z=await Jn.updatePosition(ee,te,{latitude:pe.latitude,longitude:pe.longitude,sourceType:"checkpoint",sourceCheckpointId:se});z.data.success&&(h.value&&R(),u.value=`Location copied from ${pe.name}!`,b(te,z.data.latitude,z.data.longitude,z.data.lastLocationUpdate),setTimeout(()=>I(),1500))}catch(ee){console.error("Failed to copy location from checkpoint:",ee),ee.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}},q=async(se,pe)=>{if(i.value){d.value=!0,r.value=null;try{const ee=e.value,te=i.value.locationId,z=await Jn.updatePosition(ee,te,{latitude:se,longitude:pe,sourceType:"manual"});z.data.success&&(u.value="Location updated successfully!",b(te,z.data.latitude,z.data.longitude,z.data.lastLocationUpdate),setTimeout(()=>I(),1500))}catch(ee){console.error("Failed to update location manually:",ee),ee.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},P=async se=>{if(!(!se||!("geolocation"in navigator)))try{const pe=await new Promise((z,Y)=>{navigator.geolocation.getCurrentPosition(z,Y,{enableHighAccuracy:!0,timeout:15e3})}),ee=e.value,te=se.locationId;await Jn.updatePosition(ee,te,{latitude:pe.coords.latitude,longitude:pe.coords.longitude,sourceType:"gps"}),b(te,pe.coords.latitude,pe.coords.longitude,new Date().toISOString())}catch(pe){console.warn("Auto-update location failed:",pe)}},F=se=>{h.value=!0,P(se),g=setInterval(()=>{P(se)},6e4)},R=()=>{h.value=!1,g&&(clearInterval(g),g=null)};return{showLocationUpdateModal:s,updatingLocationFor:i,locationUpdateError:r,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:p,isDynamicCheckpoint:_,openLocationUpdateModal:C,closeLocationUpdateModal:I,startMapLocationSelect:$,cancelMapLocationSelect:x,updateDynamicCheckpointLocation:S,updateLocationWithGps:B,updateLocationFromCheckpoint:E,updateLocationManually:q,toggleAutoUpdate:se=>{h.value?R():F(se)},startAutoUpdate:F,stopAutoUpdate:R,startDynamicCheckpointPolling:()=>{y||!t.value.some(pe=>pe.isDynamic||pe.IsDynamic)||(y=setInterval(async()=>{try{const pe=e.value,ee=await Jn.getDynamicCheckpoints(pe);if(ee.data&&Array.isArray(ee.data))for(const te of ee.data){const z=t.value.find(Y=>Y.id===te.checkpointId);z&&(z.latitude=te.latitude,z.longitude=te.longitude,z.lastLocationUpdate=te.lastLocationUpdate)}}catch(pe){console.warn("Failed to poll dynamic checkpoints:",pe)}},6e4))},stopDynamicCheckpointPolling:()=>{y&&(clearInterval(y),y=null)},handleMapClickForLocation:se=>{p.value&&i.value&&(S(i.value.locationId,se.lat,se.lng,"manual"),p.value=!1)}}}function Nz({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:s,areaLeadMarshalDataVersion:i,updatePendingCount:r,updateCachedField:u}){const{termsLower:d}=ct(),h=M(null),p=M(null),g=M(null),y=M(!1),_=M(null),b=M(new Set),C=M(!1),I=M(""),$=j=>{if(!j)return!0;const O=new Date(j);return(new Date-O)/(1e3*60*60)>24},x=j=>j?new Date(j).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=j=>{if(!j)return"";switch(j){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return j}},B=j=>{b.value.add(j),y.value=!1,_.value=null},E=()=>{C.value=!1,I.value=""},q=j=>j<1e3?`${Math.round(j/10)*10} m`:`${(Math.round(j/100)/10).toFixed(1)} km`,P=(j,O,G)=>{if(j==null||O==null)return;const Q=o.value?.find(te=>te.id===G);if(!Q)return;const se=Q.latitude,pe=Q.longitude;if(se==null||pe==null)return;const ee=di(j,O,se,pe);if(ee>50){const te=q(ee);I.value=`Thanks for checking in. Just so you know, it's possible you are more than ${te} from your ${d.value.checkpoint} area.`,C.value=!0}},F=async(j,O=!0,G=null)=>{if(!j?.id){g.value="Cannot check in: Assignment ID is missing";return}h.value=j.id,p.value=j.id,g.value=null;const Q=e.value;if(!Q){g.value="Cannot check in: Event ID is missing",h.value=null,p.value=null;return}const se=j.effectiveIsCheckedIn!==void 0?j.effectiveIsCheckedIn:j.isCheckedIn&&!$(j.checkInTime),pe=j.isCheckedIn&&!se,ee=se?"check-out":pe?"refresh":"check-in",te=!se;let z=null,Y=null,ue="Manual";if(O&&!se&&"geolocation"in navigator)try{const Re=await new Promise((Ye,Ne)=>{navigator.geolocation.getCurrentPosition(Ye,Ne,{enableHighAccuracy:!0,timeout:5e3})});z=Re.coords.latitude,Y=Re.coords.longitude,ue="GPS"}catch(Re){console.log("GPS unavailable, using manual check-in:",Re.message)}const ke={latitude:z,longitude:Y,action:ee};try{if(On()){await wo("checkin_toggle",{eventId:Q,assignmentId:j.id,gpsData:ke});const Re=t.value.findIndex(Ye=>Ye.id===j.id);if(Re!==-1&&(t.value[Re]={...t.value[Re],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?`${ue} (pending)`:null,checkInLatitude:z,checkInLongitude:Y}),G){const Ye=o.value.find(Ne=>Ne.id===G);if(Ye?.assignments){const Ne=Ye.assignments.find(Ke=>Ke.id===j.id||Ke.marshalId===j.marshalId);Ne&&(Ne.isCheckedIn=te,Ne.checkInTime=te?new Date().toISOString():null)}}r&&await r(),u&&await u(Q,"locations",o.value)}else{const Re=await Sa.toggleCheckIn(Q,j.id,ke),Ye=t.value.findIndex(Ne=>Ne.id===j.id);if(Ye!==-1&&(t.value[Ye]=Re.data),G){const Ne=o.value.find(Ke=>Ke.id===G);if(Ne?.assignments){const Ke=Ne.assignments.find(We=>We.id===j.id||We.marshalId===j.marshalId);Ke&&Object.assign(Ke,Re.data)}}}if(G&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++,te&&z!=null&&Y!=null){const Re=G||j.locationId;Re&&P(z,Y,Re)}}catch(Re){if(On()||!Re.response){await wo("checkin_toggle",{eventId:Q,assignmentId:j.id,gpsData:ke});const Ye=t.value.findIndex(Ne=>Ne.id===j.id);Ye!==-1&&(t.value[Ye]={...t.value[Ye],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?"Manual (pending)":null}),r&&await r()}else Re.response?.data?.message?g.value=Re.response.data.message:Re.message?g.value=Re.message:g.value=`Failed to ${ee}. Please try again.`}finally{h.value=null,p.value=null}};return{checkingIn:h,checkingInAssignment:p,checkInError:g,showCheckInReminderModal:y,checkInReminderCheckpoint:_,dismissedCheckInReminders:b,showDistanceWarning:C,distanceWarningMessage:I,isCheckInStale:$,formatCheckInTime:x,formatCheckInMethod:S,handleCheckInToggle:F,handleAreaLeadMarshalCheckIn:async j=>{const G=(a?.value?.checkpoints||s?.value||[]).find(ee=>ee.marshals?.some(te=>te.marshalId===j.marshalId));if(!G){console.error("Could not find checkpoint for marshal:",j);return}const Q=G.marshals.find(ee=>ee.marshalId===j.marshalId);if(!Q)return;const se=Q.assignmentId||Q.id;if(!se){console.error("No assignment ID found for marshal:",Q);return}const pe={id:se,marshalId:j.marshalId,isCheckedIn:j.isCheckedIn,effectiveIsCheckedIn:j.isCheckedIn};await F(pe,!1,G.locationId)},dismissCheckInReminder:B,dismissDistanceWarning:E}}function Fz({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:s,showMessage:i}){const r=M([]),u=M(!1),d=M(null),h=M(!1),p=M(!1),g=M(""),y=M(!1),_=M(!1),b=M(!1),C=U(()=>r.value.filter(F=>F.status==="open"||F.status==="acknowledged"||F.status==="in_progress").length),I=async()=>{const F=e.value;u.value=!0;try{const R=new Map;if(o.value&&a.value.length>0)for(const j of a.value)try{const G=(await vs.getForArea(F,j)).data.incidents||[];for(const Q of G)R.set(Q.incidentId,Q)}catch(O){console.warn(`Failed to load incidents for area ${j}:`,O)}try{const O=(await vs.getAll(F)).data.incidents||[];for(const G of O)G.reportedBy?.marshalId===t.value&&R.set(G.incidentId,G)}catch(j){console.debug("Could not load all incidents:",j)}r.value=Array.from(R.values()).sort((j,O)=>new Date(O.incidentTime||O.createdAt)-new Date(j.incidentTime||j.createdAt)),s?.value&&(s.value.incidents=Date.now()),console.log("My incidents loaded:",r.value.length)}catch(R){console.error("Failed to load incidents:",R)}finally{u.value=!1}},$=async F=>{b.value=!0;try{await vs.create(e.value,F),_.value=!1,I(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(R){console.error("Failed to report incident:",R),i&&i("Error",R.response?.data?.message||"Failed to report incident. Please try again.")}finally{b.value=!1}},x=F=>{d.value=F,h.value=!0},S=()=>{h.value=!1,d.value=null},B=async({incidentId:F,status:R})=>{try{await vs.updateStatus(e.value,F,{status:R});const j=r.value.find(O=>O.incidentId===F);j&&(j.status=R),d.value?.incidentId===F&&(d.value.status=R)}catch(j){console.error("Failed to update incident status:",j),i&&i("Error","Failed to update status. Please try again.")}},E=()=>{g.value="",p.value=!0},q=()=>{p.value=!1,g.value=""};return{myIncidents:r,incidentsLoading:u,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:p,incidentNoteText:g,submittingIncidentNote:y,showReportIncident:_,reportingIncident:b,openIncidentsCount:C,loadMyIncidents:I,handleReportIncident:$,openIncidentDetail:x,closeIncidentDetail:S,handleIncidentStatusChange:B,openAddIncidentNoteModal:E,closeAddIncidentNoteModal:q,submitIncidentNote:async()=>{if(!(!g.value.trim()||!d.value)){y.value=!0;try{await vs.addNote(e.value,d.value.incidentId,g.value.trim()),q(),I();const F=await vs.get(e.value,d.value.incidentId);d.value=F.data}catch(F){console.error("Failed to add note:",F),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const wf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',Cf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function Uz({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=ct(),s=M({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=M(-1),r=M({}),u={},d=U(()=>t.value.filter(I=>I.location?.latitude&&I.location?.longitude&&!(I.location.latitude===0&&I.location.longitude===0))),h=U(()=>{const I=[];return e.value&&!s.value.userLocationInView&&I.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:wf}),d.value.length>0&&!s.value.highlightedLocationInView&&I.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:Cf}),I}),p=I=>{const $=s.value,x=$.userLocationInView!==I.userLocationInView||$.highlightedLocationInView!==I.highlightedLocationInView,S=JSON.stringify($.highlightedLocationsVisibility)!==JSON.stringify(I.highlightedLocationsVisibility||{});(x||S)&&(s.value={...I,highlightedLocationsVisibility:I.highlightedLocationsVisibility||{}})},g=()=>{const I=d.value;if(I.length===0)return null;if(I.length===1)return i.value=0,I[0];const $=s.value.highlightedLocationsVisibility||{},x=[];for(let E=0;E<I.length;E++){const q=I[E].locationId;$[q]===!1&&x.push(E)}if(x.length===0)return i.value=0,I[0];if(x.length===1)return i.value=x[0],I[x[0]];const S=i.value;let B=-1;for(const E of x)if(E>S){B=E;break}return B===-1&&(B=x[0]),i.value=B,I[B]};return{courseMapVisibility:s,courseMapActions:h,handleCourseMapVisibilityChange:p,handleCourseMapAction:({actionId:I})=>{if(I==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(I==="recenter-checkpoint"){const $=g();$?.location&&o.value?.recenterOnLocation($.location.latitude,$.location.longitude)}},checkpointMapVisibility:r,checkpointMapRefs:u,getCheckpointMapActions:I=>{const $=[],x=r.value[I]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!x.userLocationInView&&$.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:wf}),x.highlightedLocationInView||$.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:Cf}),$},handleCheckpointMapVisibilityChange:(I,$)=>{const x=r.value[I];(!x||x.userLocationInView!==$.userLocationInView||x.highlightedLocationInView!==$.highlightedLocationInView)&&(r.value={...r.value,[I]:$})},handleCheckpointMapAction:(I,{actionId:$})=>{const x=u[I.id];$==="recenter-user"&&e.value?x?.recenterOnUserLocation():$==="recenter-checkpoint"&&I.location&&x?.recenterOnLocation(I.location.latitude,I.location.longitude)}}}function zz({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,loadChecklist:s}){const i=M(null),r=M(!1),u=M(0),d=g=>{i.value=i.value===g?null:g},h=U(()=>{u.value;const g=o?.value?.checkpoints||a?.value||[],y=new Map;for(const _ of g)for(const b of _.marshals||[]){y.has(b.marshalId)||y.set(b.marshalId,{...b,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const C=y.get(b.marshalId);if(C.checkpoints.push({checkpointId:_.checkpointId,name:_.name,description:_.description}),b.outstandingTasks)for(const I of b.outstandingTasks)C.allTasks.push({...I,isCompleted:!1,checkpointName:_.name}),C.totalTaskCount++;if(b.completedTasks)for(const I of b.completedTasks)C.allTasks.push({...I,isCompleted:!0,checkpointName:_.name}),C.totalTaskCount++,C.completedTaskCount++}return Array.from(y.values()).sort((_,b)=>(_.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:i,savingAreaLeadMarshalTask:r,areaLeadMarshalDataVersion:u,allAreaLeadMarshals:h,toggleAreaLeadMarshalExpansion:d,toggleAreaLeadMarshalTask:async(g,y)=>{if(r.value)return;r.value=!0;const _={marshalId:y.marshalId,contextType:g.contextType,contextId:g.contextId,actorMarshalId:t.value};try{g.isCompleted?await Rt.uncomplete(e.value,g.itemId,_):await Rt.complete(e.value,g.itemId,_),o?.value?.loadDashboard&&await o.value.loadDashboard(),u.value++,s&&await s(!0)}catch(b){console.error("Failed to toggle area lead marshal task:",b)}finally{r.value=!1}}}}function Hz({router:e,route:t,onAuthSuccess:o}){const a=M(!1),s=M(!1),i=M(null),r=M(null),u=M(null),d=M(null),h=U(()=>r.value?.name||null),p=U(()=>d.value?.eventRoles?d.value.eventRoles.filter(R=>R.role==="EventAreaLead").flatMap(R=>R.areaIds||[]):[]),g=U(()=>p.value.length>0),y=U(()=>d.value?.eventRoles?d.value.eventRoles.some(F=>F.role==="EventAdmin"):!1),_=U(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),b=U(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let C=null;const I=()=>{C||(C=setInterval(async()=>{if(d.value?.marshalId)try{await ms.getMe(t.params.eventId)}catch(F){console.debug("Heartbeat failed:",F)}},300*1e3))},$=()=>{C&&(clearInterval(C),C=null)},x=async(F,R,j=!1)=>{s.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:F,code:R,isReauth:j}),eu();try{Co("marshal",F);const O=await ms.marshalLogin(F,R);if(console.log("Auth response:",O.data),O.data.success){Hh(F,{token:O.data.sessionToken,marshalId:O.data.marshalId,marshalName:O.data.person?.name||null}),$k(F,O.data.marshalId,R),r.value=O.data.person,u.value=O.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,r.value?.name);try{const G=await ms.getMe(F);d.value=G.data,console.log("User claims:",d.value)}catch(G){console.warn("Failed to fetch claims:",G)}e.replace({path:t.path,query:{}}),I(),o&&await o()}else i.value=O.data.message||"Authentication failed"}catch(O){console.error("Authentication failed:",O),i.value=O.response?.data?.message||"Invalid or expired login link"}finally{s.value=!1}};return{isAuthenticated:a,authenticating:s,loginError:i,currentPerson:r,currentMarshalId:u,userClaims:d,currentMarshalName:h,areaLeadAreaIds:p,isAreaLead:g,isEventAdmin:y,canSwitchToAdmin:_,isAdminButNeedsReauth:b,authenticateWithMagicCode:x,checkExistingSession:async F=>{Co("marshal",F);const R=Vr(F),j=R?.marshalId,O=j?gv(F,j):null;if(!R?.token)return O?(console.log("No session but have stored code, attempting re-authentication..."),eu(),await x(F,O,!0),a.value):!1;try{const G=await ms.getMe(F);if(G.data&&G.data.marshalId)return d.value=G.data,r.value={personId:G.data.personId,name:G.data.personName,email:G.data.personEmail},u.value=G.data.marshalId,a.value=!0,fv(F,G.data.marshalId),I(),!0}catch(G){if(console.log("Session validation failed, attempting re-authentication...",G),O)try{if(eu(),await x(F,O,!0),a.value)return console.log("Re-authentication successful"),!0}catch(Q){console.error("Re-authentication failed:",Q)}R?.sessionKey&&Cu(R.sessionKey)}return!1},handleClose:F=>{$(),Co(null),a.value=!1,r.value=null,u.value=null,d.value=null,F&&F(),e.push("/marshal")},handleRemoveSession:async F=>{const[R]=F.split(":");Co("marshal",R);try{await ms.logout()}catch{}Cu(F),Co(null)},updateSessionEventInfo:(F,R,j)=>{const O=Vr(F);O&&O.marshalId&&Hh(F,{marshalId:O.marshalId,marshalName:O.marshalName,token:O.token,eventName:R,eventDate:j})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:I,stopHeartbeat:$}}const Vz={key:0,class:"header-logo-cover"},Gz=["src"],jz={key:2,class:"header-logo header-logo-left"},Zz=["src"],qz={class:"header-center"},Wz={key:0},Kz={key:1,class:"header-event-date"},Jz={key:0,class:"header-actions"},Yz={key:3,class:"header-logo header-logo-right"},Xz=["src"],Qz={class:"container"},eH={key:0,class:"selection-card"},tH={key:1,class:"selection-card"},nH={key:0,class:"loading"},oH={key:2,class:"selection-card error-card"},sH={class:"error"},aH={key:3,class:"dashboard"},iH={key:0,class:"welcome-bar"},lH={class:"welcome-info"},rH={key:0,class:"welcome-email"},cH={key:0,class:"mode-switch"},uH={key:1,class:"mode-switch"},dH={class:"accordion"},hH={class:"add-note-form"},fH={class:"modal-actions"},pH=["disabled"],vH=6e4,mH={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=ct(),{updatePendingCount:a}=vd(),s=mc(),i=Ki(),r=U(()=>s.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:p,currentPerson:g,currentMarshalId:y,currentMarshalName:_,areaLeadAreaIds:b,isAreaLead:C,canSwitchToAdmin:I,isAdminButNeedsReauth:$,authenticateWithMagicCode:x,checkExistingSession:S,handleClose:B,updateSessionEventInfo:E,switchToAdminMode:q,stopHeartbeat:P}=Hz({router:i,route:s,onAuthSuccess:()=>u.onAuthSuccess?.()}),F=M(new Set),R=U(()=>b.value.length?ee.value.filter(Oe=>b.value.includes(Oe.id)).map(Oe=>({areaId:Oe.id,name:Oe.name,color:Oe.color})).sort((Oe,$e)=>(Oe.name||"").localeCompare($e.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ze(R,Oe=>{Oe.length>0&&F.value.size===0&&(F.value=new Set(Oe.map($e=>$e.areaId)))},{immediate:!0});const j=U(()=>b.value.filter(Oe=>F.value.has(Oe))),O=Oe=>{const $e=new Set(F.value);$e.has(Oe)?$e.delete(Oe):$e.add(Oe),F.value=$e},G=U(()=>{const Oe=wn.value.find(nt=>nt.isCheckedIn&&!is(nt.checkInTime)&&nt.location);if(Oe?.location)return{id:Oe.location.id,locationId:Oe.location.id,name:Oe.location.name,description:Oe.location.description};if(oo.value){const nt=wn.value.find(ft=>ft.id===oo.value);if(nt?.location)return{id:nt.location.id,locationId:nt.location.id,name:nt.location.name,description:nt.location.description}}const $e=wn.value[0];return $e?.location?{id:$e.location.id,locationId:$e.location.id,name:$e.location.name,description:$e.location.description}:null}),Q=M(null),se=M([]),pe=M([]),ee=M([]),te=M(!0),{pageBackgroundStyle:z,headerStyle:Y,headerTextColor:ue,accentColor:ke,accentTextColor:Re,accentButtonStyle:Ye,brandingLogoUrl:Ne,brandingLogoPosition:Ke}=Dz(Q,s.params.eventId);Cl("marshalBranding",{headerStyle:Y,headerTextColor:ue,accentButtonStyle:Ye,accentColor:ke,accentTextColor:Re});const We=M("assignments"),X=M({checklist:0,notes:0,incidents:0,eventContacts:0}),_e=M([]),Le=M([]),me=M(null),ce=U(()=>me.value?.areaLeadRef?.value),{checklistItems:N,checklistLoading:K,checklistError:ae,savingChecklist:Te,expandedChecklistGroup:Be,visibleChecklistItems:De,completedChecklistCount:Se,myChecklistItems:J,areaChecklistItems:he,areaChecklistItemsWithLocalState:xe,areaMarshalsForChecklist:Ie,effectiveChecklistGroupBy:be,groupedChecklistItems:de,loadChecklist:fe,handleToggleChecklist:Z,toggleChecklistGroup:W,getContextName:ie}=Rz({eventId:r,currentMarshalId:y,currentPerson:g,assignments:pe,areaLeadAreaIds:b,isAreaLead:C,allLocations:se,areas:ee,terms:t,termsLower:o,areaLeadRef:ce,areaLeadCheckpoints:_e,sectionLastLoadedAt:X,updateCachedField:xr,updatePendingCount:a}),{userLocation:Ue,locationLastUpdated:Xe,startLocationTracking:mt,stopLocationTracking:_t}=Oz(),{showLocationUpdateModal:gt,updatingLocationFor:St,locationUpdateError:bt,locationUpdateSuccess:Ut,updatingLocation:Bt,autoUpdateEnabled:ut,selectingLocationOnMap:ln,openLocationUpdateModal:un,closeLocationUpdateModal:Nt,startMapLocationSelect:wt,cancelMapLocationSelect:Xn,updateDynamicCheckpointLocation:zn,updateLocationWithGps:Qn,updateLocationFromCheckpoint:_n,toggleAutoUpdate:Kt,stopAutoUpdate:ks,startDynamicCheckpointPolling:eo,stopDynamicCheckpointPolling:Io}=Bz({eventId:r,allLocations:se,userLocation:Ue,locationLastUpdated:Xe}),le=()=>{wt(),We.value="map"},{expandedAreaLeadMarshal:re,savingAreaLeadMarshalTask:ye,areaLeadMarshalDataVersion:at,allAreaLeadMarshals:je,toggleAreaLeadMarshalExpansion:xt,toggleAreaLeadMarshalTask:Jt}=zz({eventId:r,currentMarshalId:y,areaLeadRef:ce,areaLeadCheckpoints:_e,loadChecklist:fe}),{checkingIn:en,checkingInAssignment:Bo,checkInError:po,showCheckInReminderModal:No,checkInReminderCheckpoint:Hn,dismissedCheckInReminders:Aa,showDistanceWarning:_s,distanceWarningMessage:Fo,isCheckInStale:is,handleCheckInToggle:Ws,handleAreaLeadMarshalCheckIn:Vn,dismissCheckInReminder:Ks,dismissDistanceWarning:dn}=Nz({eventId:r,assignments:pe,allLocations:se,areaLeadRef:ce,areaLeadCheckpoints:_e,areaLeadMarshalDataVersion:at,updatePendingCount:a,updateCachedField:xr}),xo=M(!1),$o=M(!1),bs=M(""),vo=M(""),mo=M(null),to=M(!1),To=M(""),pn=M(""),go=(Oe,$e)=>{To.value=Oe,pn.value=$e,to.value=!0},{myIncidents:no,incidentsLoading:kt,selectedIncident:Et,showIncidentDetail:Mo,showAddIncidentNoteModal:Uo,incidentNoteText:yo,submittingIncidentNote:Js,showReportIncident:ht,loadMyIncidents:zt,handleReportIncident:Ea,openIncidentDetail:ws,handleIncidentStatusChange:$n,openAddIncidentNoteModal:el,closeAddIncidentNoteModal:ls,submitIncidentNote:Ao}=Fz({eventId:r,currentMarshalId:y,isAreaLead:C,areaLeadAreaIds:b,sectionLastLoadedAt:X,showMessage:go}),qt=M(null),zo=U(()=>qt.value),Ho=M(null),Cs=Oe=>!Oe||Oe.length===0?!1:Oe.some($e=>b.value.includes($e)),Pa=Oe=>{Ho.value=Ho.value===Oe?null:Oe},bn=Oe=>{const $e=We.value===Oe;if(We.value=$e?null:Oe,!$e){const nt=Date.now(),ft=vt=>nt-X.value[vt]>vH;switch(Oe){case"checklist":ft("checklist")&&fe();break;case"notes":ft("notes")&&Vo();break;case"incidents":ft("incidents")&&zt();break;case"eventContacts":ft("eventContacts")&&Oa();break}}},oo=M(null),jt=Oe=>{oo.value=oo.value===Oe?null:Oe};Ze(()=>pe.value,Oe=>{Oe.length===1&&oo.value===null&&(oo.value=Oe[0].id)},{immediate:!0});const wn=U(()=>pe.value.map(Oe=>{const $e=se.value.find(Tt=>Tt.id===Oe.locationId),nt=$e?.areaIds||$e?.AreaIds||[];let ft=null;nt.length>0&&ee.value.length>0&&(ft=ee.value.find(on=>nt.includes(on.id))?.name);const nn=($e?.assignments||[]).map(Tt=>({...Tt,effectiveIsCheckedIn:Tt.isCheckedIn&&!is(Tt.checkInTime)})).sort((Tt,on)=>(Tt.marshalName||"").localeCompare(on.marshalName||"",void 0,{sensitivity:"base"})),Cn=oa.value.filter(Tt=>nt.includes(Tt.areaId)&&(!Tt.marshalId||Tt.marshalId!==y.value)),An=new Set,Ht=Cn.filter(Tt=>{const on=JSON.stringify({name:Tt.name||"",marshalId:Tt.marshalId||"",role:Tt.role||"",phone:Tt.phone||"",email:Tt.email||"",notes:Tt.notes||""});return An.has(on)?!1:(An.add(on),!0)}).sort((Tt,on)=>(Tt.marshalName||Tt.name||"").localeCompare(on.marshalName||on.name||"",void 0,{sensitivity:"base"})),En=Oe.isCheckedIn&&!is(Oe.checkInTime);return{...Oe,location:$e,areaName:ft,areaIds:nt,allMarshals:nn,areaContacts:Ht,locationName:$e?.name||"Unknown Location",effectiveIsCheckedIn:En}})),{courseMapActions:Ys,handleCourseMapVisibilityChange:Xs,handleCourseMapAction:Qs,getCheckpointMapActions:fi,handleCheckpointMapVisibilityChange:Tn,handleCheckpointMapAction:ea}=Uz({userLocation:Ue,assignmentsWithDetails:wn,courseMapRef:zo}),rt=U(()=>pe.value.length>0?pe.value[0]:null),hn=U(()=>pe.value.map(Oe=>Oe.locationId)),$t=U(()=>wn.value.some(Oe=>Oe.location?.isDynamic||Oe.location?.IsDynamic)),so=U(()=>wn.value.find(Oe=>Oe.location?.isDynamic||Oe.location?.IsDynamic)),ko=U(()=>{const Oe=so.value;if(!Oe)return!1;const $e=Oe.location,nt=$e?.locationUpdateScopeConfigurations||$e?.LocationUpdateScopeConfigurations||[];return dm({scopeConfigurations:nt,marshalId:y.value,marshalAssignmentLocationIds:hn.value,areaLeadAreaIds:b.value,locationId:Oe.locationId,locationAreaIds:Oe.areaIds||[]})}),ta=U(()=>{if(!Q.value||!wn.value.length)return[];const Oe=new Date,$e=Q.value.eventDate?new Date(Q.value.eventDate):null;return wn.value.filter(nt=>{if(nt.effectiveIsCheckedIn||Aa.value.has(nt.id))return!1;const ft=nt.location;if(!ft)return!1;const vt=ft.startTime?new Date(ft.startTime):$e;if(!vt)return!1;let nn;if(ft.endTime)nn=new Date(ft.endTime);else if($e)nn=new Date($e.getTime()+7200*1e3);else return!1;return Oe>=vt&&Oe<nn})});Ze(ta,Oe=>{Oe.length>0&&!No.value&&(Hn.value=Oe[0],No.value=!0)},{immediate:!0}),Ze(_s,Oe=>{Oe&&(go("Distance notice",Fo.value),dn())});const na=()=>{const Oe=Hn.value;Oe&&(Ks(Oe.id),We.value="assignments",oo.value=Oe.id)},Mn=U(()=>Q.value?.route?(typeof Q.value.route=="string"?JSON.parse(Q.value.route):Q.value.route)||[]:[]),Ls=U(()=>!rt.value||!se.value.length?null:se.value.find(Oe=>Oe.id===rt.value.locationId)),Gn=M([]),Wt=M(!1),Eo=U(()=>{const Oe=Gn.value.filter(ft=>!ft.marshalId||ft.marshalId!==y.value),$e=new Set;return Oe.filter(ft=>{const vt=JSON.stringify({name:ft.name||"",marshalId:ft.marshalId||"",role:ft.role||"",phone:ft.phone||"",email:ft.email||"",notes:ft.notes||""});return $e.has(vt)?!1:($e.add(vt),!0)}).sort((ft,vt)=>{if(ft.isPinned!==vt.isPinned)return ft.isPinned?-1:1;const nn=ft.displayOrder||0,Cn=vt.displayOrder||0;return nn!==Cn?nn-Cn:(ft.name||"").localeCompare(vt.name||"",void 0,{sensitivity:"base"})})}),Da=U(()=>Eo.value.filter(Oe=>Oe.showInEmergencyInfo)),Ss=U(()=>Le.value.filter(Oe=>Oe.showInEmergencyInfo)),tl=U(()=>Da.value.length>0||Ss.value.length>0),pi=(Oe,$e=[])=>{if(!Le.value||Le.value.length===0)return[];const nt=se.value.find(Ht=>Ht.id===Oe),ft=nt?.areaIds||nt?.AreaIds||[],vt=$e.length>0?$e:ft,nn=[],Cn=new Set;for(const Ht of Le.value){const En=Ht.noteId||Ht.NoteId||Ht.id;if(Cn.has(En))continue;const Tt=Ht.scopeConfigurations||Ht.ScopeConfigurations||[];let on=!1;if(Tt.length>0)for(const ao of Tt){const io=ao.itemType||ao.ItemType,_o=ao.ids||ao.Ids||[];if(io==="Checkpoint"&&(_o.includes(Oe)||_o.includes("ALL_CHECKPOINTS"))){on=!0;break}if(io==="Area"&&(_o.includes("ALL_AREAS")||vt.length>0&&vt.some(za=>_o.includes(za)))){on=!0;break}}else{const ao=Ht.matchedScope||Ht.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(_o=>ao.includes(_o)||ao===_o)&&(on=!0)}on&&(Cn.add(En),nn.push(Ht))}const An={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return nn.sort((Ht,En)=>{const Tt=Ht.isPinned||Ht.IsPinned,on=En.isPinned||En.IsPinned;if(Tt&&!on)return-1;if(!Tt&&on)return 1;const ao=An[Ht.priority||Ht.Priority||"Normal"]??3,io=An[En.priority||En.Priority||"Normal"]??3;if(ao!==io)return ao-io;const _o=Ht.createdAt||Ht.CreatedAt,Ua=En.createdAt||En.CreatedAt;return new Date(Ua)-new Date(_o)})},oa=M([]),nl=(Oe,$e)=>Oe.localeCompare($e,void 0,{numeric:!0,sensitivity:"base"}),vi=U(()=>{if(!St.value)return[];const Oe=St.value.locationId;return se.value.filter($e=>$e.id!==Oe&&$e.latitude!==0&&$e.longitude!==0).sort(($e,nt)=>nl($e.name,nt.name))}),Ct=U(()=>Ls.value?{lat:Ls.value.latitude,lng:Ls.value.longitude}:Ue.value?Ue.value:se.value.length>0?{lat:se.value[0].latitude,lng:se.value[0].longitude}:{lat:51.505,lng:-.09}),mi=async()=>{const Oe=s.params.eventId;if(console.log("Loading event data for:",{eventId:Oe,marshalId:y.value}),On()){console.log("Offline mode detected, attempting to load from cache...");const vt=await La(Oe);if(vt){if(console.log("Loaded cached data from:",vt.cachedAt),Q.value=vt.event,ee.value=vt.areas||[],se.value=vt.locations||[],N.value=vt.checklist||[],Gn.value=vt.contacts||[],Le.value=vt.notes||[],vt.areaLeadDashboard?.checkpoints&&(_e.value=vt.areaLeadDashboard.checkpoints),Q.value&&Au(Q.value),y.value){const nn=[];for(const Cn of se.value){const An=Cn.assignments?.find(Ht=>Ht.marshalId===y.value);An&&nn.push(An)}pe.value=nn}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[$e,nt,ft]=await Promise.allSettled([_a.getById(Oe),ba.getByEvent(Oe),gl.getEventStatus(Oe)]);if($e.status==="fulfilled"?(Q.value=$e.value.data,console.log("Event loaded:",Q.value?.name),Q.value&&(Au(Q.value),E(Oe,Q.value.name,Q.value.eventDate))):console.error("Failed to load event:",$e.reason),nt.status==="fulfilled"?(ee.value=nt.value.data||[],console.log("Areas loaded:",ee.value.length)):console.error("Failed to load areas:",nt.reason),ft.status==="fulfilled"){if(se.value=ft.value.data?.locations||[],console.log("Locations loaded:",se.value.length),y.value){const vt=[];for(const nn of se.value){const Cn=nn.assignments?.find(An=>An.marshalId===y.value);Cn&&vt.push(Cn)}pe.value=vt,console.log("Total assignments found:",pe.value.length)}}else console.error("Failed to load event status:",ft.reason);await Promise.allSettled([fe(),Oa(),Vo(),zt()]);try{const vt=JSON.parse(JSON.stringify({event:Q.value,areas:ee.value,locations:se.value,checklist:N.value,contacts:Gn.value,notes:Le.value,marshalId:y.value}));await Hl(Oe,vt),console.log("Event data cached for offline access")}catch(vt){console.warn("Failed to cache event data:",vt)}eo()};u.onAuthSuccess=mi;const vn=async()=>{const Oe=s.params.eventId;if(On()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const $e=await ba.getAreaLeadDashboard(Oe);if($e.data){_e.value=$e.data.checkpoints||[];const nt=JSON.parse(JSON.stringify({areas:$e.data.areas||[],checkpoints:$e.data.checkpoints||[]}));await La(Oe)?await xr(Oe,"areaLeadDashboard",nt):await Hl(Oe,{areaLeadDashboard:nt}),console.log("Area lead dashboard cached for offline access")}}catch($e){$e.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",$e)}console.log("Background preload complete")},Vo=async()=>{const Oe=s.params.eventId;try{const $e=await fs.getMyNotes(Oe);Le.value=$e.data||[],X.value.notes=Date.now(),console.log("Notes loaded:",Le.value.length)}catch($e){console.error("Failed to load notes:",$e)}},Oa=async()=>{const Oe=s.params.eventId;Wt.value=!0;try{const $e=await pa.getMyContacts(Oe);Gn.value=$e.data||[],X.value.eventContacts=Date.now(),console.log("Contacts loaded:",Gn.value.length)}catch($e){console.warn("Failed to load contacts:",$e),Gn.value=[]}finally{Wt.value=!1}},ol=()=>{$o.value=!1,mo.value&&(mo.value(),mo.value=null)},Ra=()=>{$o.value=!1,mo.value=null},Ba=()=>{to.value=!1},Na=Oe=>{if(ln.value&&St.value){zn(St.value.locationId,Oe.lat,Oe.lng,"manual"),ln.value=!1,St.value=null;return}if(ko.value&&so.value){const $e=so.value;bs.value="Update location",vo.value=`Update ${$e.location?.name||"dynamic checkpoint"} to this location?`,mo.value=async()=>{await zn($e.locationId,Oe.lat,Oe.lng,"manual")},$o.value=!0}},gi=Oe=>{if(!ln.value&&ko.value&&so.value){const $e=so.value;if(Oe.id===$e.locationId)return;bs.value="Copy location",vo.value=`Copy location from "${Oe.name}" to ${$e.location?.name||"your dynamic checkpoint"}?`,mo.value=async()=>{await zn($e.locationId,Oe.latitude,Oe.longitude,"checkpoint",Oe.id)},$o.value=!0}},yi=()=>{B(()=>{pe.value=[],N.value=[],oa.value=[]})},Fa=Oe=>Oe?new Date(Oe).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return Qt(async()=>{const Oe=s.params.eventId,$e=s.query.code;te.value=!0;try{$e?await x(Oe,$e):await S(Oe)&&await mi()}finally{te.value=!1}d.value&&(mt(),"requestIdleCallback"in window?requestIdleCallback(()=>{vn()},{timeout:5e3}):setTimeout(()=>{vn()},2e3))}),Ze(d,Oe=>{Oe?mt():_t()}),Ze(()=>s.query.code,async Oe=>{if(Oe&&d.value){te.value=!0;try{await x(s.params.eventId,Oe)}finally{te.value=!1}}}),Ze(Q,Oe=>{Oe&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),kn(()=>{P(),ks(),Io()}),(Oe,$e)=>(v(),m("div",{class:"marshal-view",style:et(D(z))},[Ee(JB),l("header",{class:ve(["header",`logo-${D(Ke)}`]),style:et(D(Y))},[D(Ne)&&D(Ke)==="cover"?(v(),m("div",Vz,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-cover-img"},null,8,Gz)])):A("",!0),D(d)&&D(Ke)==="right"?(v(),m("button",{key:1,onClick:yi,class:"btn-close-session btn-close-left",style:et({color:D(ue)}),title:"Close session"},"  ",4)):A("",!0),D(Ne)&&D(Ke)==="left"?(v(),m("div",jz,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-img"},null,8,Zz)])):A("",!0),l("div",qz,[l("div",{class:"header-title",style:et({color:D(ue)})},[Q.value?(v(),m("h1",Wz,w(Q.value.name),1)):A("",!0),Q.value?.eventDate?(v(),m("div",Kz,w(Fa(Q.value.eventDate)),1)):A("",!0)],4),D(d)?(v(),m("div",Jz,[l("button",{onClick:$e[0]||($e[0]=nt=>ht.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),tl.value?(v(),m("button",{key:0,onClick:$e[1]||($e[1]=nt=>xo.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):A("",!0)])):A("",!0)]),D(Ne)&&D(Ke)==="right"?(v(),m("div",Yz,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-img"},null,8,Xz)])):A("",!0),D(d)&&D(Ke)!=="right"?(v(),m("button",{key:4,onClick:yi,class:"btn-close-session btn-close-right",style:et({color:D(ue)}),title:"Close session"},"  ",4)):A("",!0)],6),l("div",Qz,[te.value?(v(),m("div",eH,[...$e[22]||($e[22]=[l("div",{class:"loading"},"Loading...",-1)])])):!D(d)&&!D(p)?(v(),m("div",tH,[$e[23]||($e[23]=l("h2",null,"Welcome",-1)),$e[24]||($e[24]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),D(h)?(v(),m("p",nH,"Authenticating...")):A("",!0)])):D(p)?(v(),m("div",oH,[$e[25]||($e[25]=l("h2",null,"Login failed",-1)),l("p",sH,w(D(p)),1),$e[26]||($e[26]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",aH,[D(I)||D($)?(v(),m("div",iH,[l("div",lH,[D(g)?.email?(v(),m("span",rH,w(D(g).email),1)):A("",!0)]),D(I)?(v(),m("div",cH,[l("button",{onClick:$e[2]||($e[2]=(...nt)=>D(q)&&D(q)(...nt)),class:"btn-mode-switch"}," Switch to Admin ")])):D($)?(v(),m("div",uH,[...$e[27]||($e[27]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):A("",!0)])):A("",!0),l("div",dH,[Ee(Az,{ref:"assignmentsSectionRef","is-expanded":We.value==="assignments",assignments:wn.value,"expanded-checkpoint-id":oo.value,"all-locations":se.value,route:Mn.value,"user-location":D(Ue),"has-dynamic-assignment":$t.value,"current-marshal-id":D(y),"current-marshal-name":D(_),"checking-in-id":D(en),"checking-in-assignment-id":D(Bo),"check-in-error":D(po),"checking-in-marshal-id":D(en),"expanded-marshal-id":Ho.value,"updating-location":D(Bt),"auto-update-enabled":D(ut),"get-toolbar-actions":D(fi),"is-area-lead-for-areas":Cs,"get-notes-for-checkpoint":pi,"area-lead-area-ids":D(b),onToggle:$e[3]||($e[3]=nt=>bn("assignments")),onToggleCheckpoint:jt,onMapClick:Na,onLocationClick:gi,onActionClick:D(ea),onVisibilityChange:D(Tn),onUpdateLocation:D(un),onCheckIn:$e[4]||($e[4]=nt=>D(Ws)(nt,!0)),onToggleMarshal:Pa,onMarshalCheckIn:$e[5]||($e[5]=(nt,ft)=>D(Ws)(nt,!1,ft)),onToggleAutoUpdate:D(Kt)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ee(sF,{loading:D(K),error:D(ae),"is-expanded":We.value==="checklist","is-area-lead":D(C),"my-items":D(J),"area-items":D(he),"area-items-with-local-state":D(xe),"visible-items":D(De),"grouped-items":D(de),"completed-count":D(Se),saving:D(Te),"effective-group-by":D(be),"expanded-group":D(Be),locations:se.value,areas:ee.value,marshals:D(Ie),"get-context-name":D(ie),onToggle:$e[6]||($e[6]=nt=>bn("checklist")),onToggleItem:D(Z),onToggleGroup:D(W)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ee(dF,{"event-id":D(s).params.eventId,notes:Le.value,locations:se.value,areas:ee.value,assignments:pe.value,"is-expanded":We.value==="notes",onToggle:$e[7]||($e[7]=nt=>bn("notes")),onNotesChanged:Vo},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ee(QN,{contacts:Eo.value,loading:Wt.value,"is-expanded":We.value==="eventContacts",onToggle:$e[8]||($e[8]=nt=>bn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ee(c9,{incidents:D(no),loading:D(kt),"is-expanded":We.value==="incidents",onToggle:$e[9]||($e[9]=nt=>bn("incidents")),onSelectIncident:D(ws)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ee(G7,{ref_key:"areaLeadSectionRef",ref:me,"is-area-lead":D(C),"is-expanded":We.value==="areaLead",areas:R.value,"selected-filters":F.value,"filtered-area-ids":j.value,"event-id":D(s).params.eventId,"marshal-id":D(y),route:Mn.value,onToggle:$e[10]||($e[10]=nt=>bn("areaLead")),onToggleFilter:O,onChecklistUpdated:D(fe)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ee(gU,{"is-area-lead":D(C),"is-expanded":We.value==="areaLeadMarshals",marshals:D(je),"expanded-marshal-id":D(re),"checking-in-marshal-id":D(en),"saving-task":D(ye),onToggle:$e[11]||($e[11]=nt=>bn("areaLeadMarshals")),onToggleMarshal:D(xt),onCheckIn:D(Vn),onToggleTask:D(Jt)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Ee(wF,{ref_key:"routeSectionRef",ref:qt,"is-expanded":We.value==="map","user-location":D(Ue),"selecting-location":D(ln),"selecting-location-name":D(St)?.location?.name||"",locations:se.value,route:Mn.value,center:Ct.value,"highlight-location-ids":hn.value,clickable:D(ln)||ko.value,"toolbar-actions":D(Ys),onToggle:$e[12]||($e[12]=nt=>bn("map")),onCancelSelect:D(Xn),onMapClick:Na,onLocationClick:gi,onActionClick:D(Qs),onVisibilityChange:D(Xs)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onCancelSelect","onActionClick","onVisibilityChange"]),Ee(b9,{"event-date":Q.value?.eventDate,description:Q.value?.description,"is-expanded":We.value==="eventDetails",onToggle:$e[13]||($e[13]=nt=>bn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ee(RB,{show:xo.value,contacts:Da.value,notes:Ss.value,onClose:$e[14]||($e[14]=nt=>xo.value=!1)},null,8,["show","contacts","notes"]),Ee(cm,{show:D(ht),"event-id":r.value||"",checkpoint:G.value,"initial-location":D(Ue),checkpoints:se.value,route:Mn.value,onClose:$e[15]||($e[15]=nt=>ht.value=!1),onSubmit:D(Ea)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ee(rm,{show:D(Mo),incident:D(Et),route:Mn.value,checkpoints:se.value,"can-manage":D(C),onClose:$e[16]||($e[16]=nt=>Mo.value=!1),onStatusChange:D($n),onOpenAddNote:D(el)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ee(Gt,{show:D(Uo),title:"Add update",size:"small",onClose:D(ls)},{footer:He(()=>[l("div",fH,[l("button",{type:"button",class:"btn btn-secondary",onClick:$e[18]||($e[18]=(...nt)=>D(ls)&&D(ls)(...nt))}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:$e[19]||($e[19]=(...nt)=>D(Ao)&&D(Ao)(...nt)),disabled:!D(yo).trim()||D(Js)},w(D(Js)?"Adding...":"Add update"),9,pH)])]),default:He(()=>[l("div",hH,[ze(l("textarea",{"onUpdate:modelValue":$e[17]||($e[17]=nt=>Yt(yo)?yo.value=nt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[tt,D(yo)]])])]),_:1},8,["show","onClose"]),Ee($a,{show:$o.value,title:bs.value,message:vo.value,onConfirm:ol,onCancel:Ra},null,8,["show","title","message"]),Ee($a,{show:to.value,title:To.value,message:pn.value,"show-cancel":!1,onConfirm:Ba},null,8,["show","title","message"]),Ee(aN,{show:D(No),checkpoint:D(Hn),"accent-button-style":D(Ye),onDismiss:$e[20]||($e[20]=nt=>D(Ks)(D(Hn)?.id)),onGoToCheckpoint:na},null,8,["show","checkpoint","accent-button-style"]),Ee(EN,{show:D(gt),assignment:D(St),"user-location":D(Ue),"auto-update-enabled":D(ut),updating:D(Bt),error:D(bt),success:D(Ut),"available-checkpoints":vi.value,"accent-button-style":D(Ye),onClose:D(Nt),onUpdateGps:D(Qn),onToggleAutoUpdate:$e[21]||($e[21]=nt=>D(Kt)(D(St))),onSelectOnMap:le,onCopyFromCheckpoint:D(_n)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},gH=Ge(mH,[["__scopeId","data-v-40379716"]]),yH={class:"form-group"},kH={class:"form-group"},_H={class:"form-group"},bH={class:"actions-left"},wH={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,s=M({name:"",email:"",phone:""});Ze(()=>o.profile,h=>{h&&(s.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ze(()=>o.show,h=>{h&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},r=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}a("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(h,p)=>(v(),qe(Gt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:He(()=>[l("div",bH,[e.showLogout?(v(),m("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):A("",!0)]),l("button",{type:"button",onClick:r,class:"btn btn-success"}," Save ")]),default:He(()=>[l("form",{onSubmit:it(r,["prevent"])},[l("div",yH,[p[3]||(p[3]=l("label",null,"Name *",-1)),ze(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>s.value.name=g),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[tt,s.value.name]])]),l("div",kH,[p[4]||(p[4]=l("label",null,"Email *",-1)),ze(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>s.value.email=g),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[tt,s.value.email]])]),l("div",_H,[p[5]||(p[5]=l("label",null,"Phone",-1)),ze(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>s.value.phone=g),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[tt,s.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},CH=Ge(wH,[["__scopeId","data-v-178e5f48"]]),LH={class:"tabs"},SH={class:"tab-content"},IH={class:"form-group"},xH={class:"form-group"},$H={class:"form-group"},TH={class:"form-group"},MH=["value"],AH={class:"tab-content"},EH={class:"emergency-contacts-section"},PH={key:0,class:"empty-state"},DH={class:"card-header"},OH=["onClick"],RH={class:"form-group"},BH=["onUpdate:modelValue"],NH={class:"form-group"},FH=["onUpdate:modelValue"],UH={class:"form-group"},zH=["onUpdate:modelValue"],HH={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:s,switchTab:i,resetTab:r}=Wv("basic",["basic","emergency"]),u=M({...o.eventData});Ze(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ze(()=>o.show,y=>{y&&r()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{u.value.emergencyContacts.splice(y,1)},p=()=>{a("submit",{...u.value})},g=()=>{a("close")};return(y,_)=>(v(),qe(Gt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":He(()=>[l("div",LH,[l("button",{type:"button",onClick:_[0]||(_[0]=b=>D(i)("basic")),class:ve(["tab-button",{active:D(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:_[1]||(_[1]=b=>D(i)("emergency")),class:ve(["tab-button",{active:D(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:He(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-success"}," Save ")]),default:He(()=>[l("form",{onSubmit:it(p,["prevent"])},[ze(l("div",SH,[l("div",IH,[_[6]||(_[6]=l("label",null,"Event name *",-1)),ze(l("input",{"onUpdate:modelValue":_[2]||(_[2]=b=>u.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[tt,u.value.name]])]),l("div",xH,[_[7]||(_[7]=l("label",null,"Description",-1)),ze(l("textarea",{"onUpdate:modelValue":_[3]||(_[3]=b=>u.value.description=b),rows:"3",class:"form-input"},null,512),[[tt,u.value.description]])]),l("div",$H,[_[8]||(_[8]=l("label",null,"Event date *",-1)),ze(l("input",{"onUpdate:modelValue":_[4]||(_[4]=b=>u.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[tt,u.value.eventDate]])]),l("div",TH,[_[9]||(_[9]=l("label",null,"Time zone *",-1)),ze(l("select",{"onUpdate:modelValue":_[5]||(_[5]=b=>u.value.timeZoneId=b),required:"",class:"form-input"},[(v(!0),m(Me,null,Fe(D(nm),b=>(v(),m("option",{key:b.value,value:b.value},w(b.label),9,MH))),128))],512),[[Fn,u.value.timeZoneId]])])],512),[[ys,D(s)==="basic"]]),ze(l("div",AH,[l("div",EH,[l("div",{class:"section-header-small"},[_[10]||(_[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",PH,[..._[11]||(_[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):A("",!0),(v(!0),m(Me,null,Fe(u.value.emergencyContacts,(b,C)=>(v(),m("div",{key:C,class:"emergency-contact-card"},[l("div",DH,[l("h4",null,"Contact "+w(C+1),1),l("button",{type:"button",onClick:I=>h(C),class:"btn-remove"},"  ",8,OH)]),l("div",RH,[_[12]||(_[12]=l("label",null,"Name *",-1)),ze(l("input",{"onUpdate:modelValue":I=>b.name=I,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,BH),[[tt,b.name]])]),l("div",NH,[_[13]||(_[13]=l("label",null,"Phone *",-1)),ze(l("input",{"onUpdate:modelValue":I=>b.phone=I,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,FH),[[tt,b.phone]])]),l("div",UH,[_[14]||(_[14]=l("label",null,"Additional details",-1)),ze(l("textarea",{"onUpdate:modelValue":I=>b.details=I,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,zH),[[tt,b.details]])])]))),128))])],512),[[ys,D(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},VH=Ge(HH,[["__scopeId","data-v-d820eb4f"]]),GH=nd("profile",()=>{const e=M(null),t=M(!1),o=M(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await gr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const h=await gr.updateProfile(d);return e.value=h.data,h.data}catch(h){throw o.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,o.value=null;try{return(await gr.getPerson(d,h)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(d,h,p)=>{t.value=!0,o.value=null;try{return(await gr.updatePerson(d,h,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),jH={class:"sessions-view"},ZH={class:"sessions-container"},qH={key:0,class:"loading-state"},WH={key:1,class:"empty-state"},KH={key:2,class:"sessions-list"},JH={class:"section-header"},YH={class:"section-actions"},XH=["onClick"],QH={class:"session-info"},eV={class:"event-name"},tV={key:0,class:"event-date"},nV={key:1,class:"sign-in-section"},oV={key:2,class:"section-header"},sV=["onClick"],aV={class:"session-info"},iV={class:"event-name"},lV={class:"role-name"},rV={key:0,class:"event-date"},cV=["onClick"],uV={class:"modal-card"},dV={class:"modal-actions"},hV={class:"modal-card"},fV={class:"modal-actions"},pV={__name:"SessionsView",setup(e){const t=Ki(),o=Yl(),a=qv(),s=GH(),i=M([]),r=M([]),u=M(!0),d=M(!1),h=M(!1),p=M(!1),g=M(!1),y=M(null),_=M(!1),b=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),C=U(()=>localStorage.getItem("adminEmail")),I=U(()=>!!C.value),$=()=>{i.value=xk()},x=te=>{fv(te.eventId,te.marshalId),t.push(`/event/${te.eventId}`)},S=te=>{y.value=te,p.value=!0},B=async()=>{if(!y.value)return;const{sessionKey:te,eventId:z}=y.value;try{Co("marshal",z),await authApi.logout()}catch{}Cu(te),Co(null),$(),p.value=!1,y.value=null},E=()=>{g.value=!0},q=async()=>{await o.logout(),r.value=[],g.value=!1},P=async()=>{if(h.value=!0,!s.profile)try{await s.fetchProfile()}catch(te){console.error("Failed to load profile:",te)}},F=async te=>{try{await s.updateProfile(te),h.value=!1}catch(z){console.error("Failed to save profile:",z),alert("Failed to save profile. Please try again.")}},R=async()=>{await o.logout(),r.value=[],h.value=!1},j=te=>te?new Date(te).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",O=async()=>{if(I.value)try{Co("admin");const te=await _a.getAll();r.value=te.data||[]}catch(te){console.error("Failed to load admin events:",te),r.value=[]}},G=te=>{t.push(`/admin/event/${te}`)},Q=()=>{t.push("/")},se=()=>{},pe=()=>{_.value=!1,b.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},ee=async te=>{try{const z={...te,adminEmail:o.adminEmail};await a.createEvent(z),pe(),await O()}catch(z){console.error("Failed to create event:",z),alert("Failed to create event. Please try again.")}};return Qt(async()=>{document.title="OnTheDay App - Sessions",vv(),pv(),$(),await O(),u.value=!1}),(te,z)=>(v(),m("div",jH,[l("div",ZH,[Ee(jv,{title:"Your sessions"}),u.value?(v(),m("div",qH,[...z[9]||(z[9]=[l("p",null,"Loading sessions...",-1)])])):i.value.length===0&&r.value.length===0?(v(),m("div",WH,[z[10]||(z[10]=l("p",null,"No active sessions.",-1)),z[11]||(z[11]=l("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),l("button",{class:"btn btn-primary",onClick:z[0]||(z[0]=Y=>d.value=!0)}," Sign in ")])):(v(),m("div",KH,[I.value?(v(),m(Me,{key:0},[l("div",JH,[z[12]||(z[12]=l("span",{class:"section-label"},"Admin events",-1)),l("div",YH,[l("button",{class:"btn btn-small btn-primary",onClick:P}," Profile "),l("button",{class:"btn btn-small btn-primary",onClick:z[1]||(z[1]=Y=>_.value=!0)}," Create event ")])]),(v(!0),m(Me,null,Fe(r.value,Y=>(v(),m("div",{key:"admin-"+Y.id,class:"session-card admin-card",onClick:ue=>G(Y.id)},[z[14]||(z[14]=l("div",{class:"card-icon admin-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),l("div",QH,[l("div",eV,w(Y.name),1),z[13]||(z[13]=l("div",{class:"role-name"},"Admin",-1)),Y.eventDate?(v(),m("div",tV,w(j(Y.eventDate)),1)):A("",!0)]),l("button",{class:"btn-logout",onClick:it(E,["stop"]),title:"Log out as admin"},"  ")],8,XH))),128))],64)):(v(),m("div",nV,[l("button",{class:"btn btn-primary",onClick:z[2]||(z[2]=Y=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),m("div",oV,[...z[15]||(z[15]=[l("span",{class:"section-label"},"Marshal sessions",-1)])])):A("",!0),(v(!0),m(Me,null,Fe(i.value,Y=>(v(),m("div",{key:Y.sessionKey,class:"session-card",onClick:ue=>x(Y)},[z[16]||(z[16]=l("div",{class:"card-icon marshal-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),l("div",aV,[l("div",iV,w(Y.eventName||"Event"),1),l("div",lV,w(Y.marshalName||"Marshal"),1),Y.eventDate?(v(),m("div",rV,w(j(Y.eventDate)),1)):A("",!0)]),l("button",{class:"btn-logout",onClick:it(ue=>S(Y),["stop"]),title:"Log out from this session"},"  ",8,cV)],8,sV))),128))])),l("button",{class:"btn-back-home",onClick:Q,title:"Back to home"},"  ")]),Ee(Zv,{show:d.value,onClose:z[3]||(z[3]=Y=>d.value=!1),onSuccess:se},null,8,["show"]),Ee(CH,{show:h.value,profile:D(s).profile,"show-logout":!0,onClose:z[4]||(z[4]=Y=>h.value=!1),onSubmit:F,onLogout:R},null,8,["show","profile"]),Ee(VH,{show:_.value,"event-data":b.value,"is-editing":!1,onClose:pe,onSubmit:ee},null,8,["show","event-data"]),(v(),qe(Ol,{to:"body"},[Ee(es,{name:"modal"},{default:He(()=>[g.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:z[6]||(z[6]=it(Y=>g.value=!1,["self"]))},[l("div",uV,[z[17]||(z[17]=l("h3",null,"Log out as admin?",-1)),z[18]||(z[18]=l("p",null,"This will log you out from all admin events.",-1)),z[19]||(z[19]=l("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),l("div",dV,[l("button",{class:"btn btn-secondary",onClick:z[5]||(z[5]=Y=>g.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:q},"Log out")])])])):A("",!0)]),_:1})])),(v(),qe(Ol,{to:"body"},[Ee(es,{name:"modal"},{default:He(()=>[p.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:z[8]||(z[8]=it(Y=>p.value=!1,["self"]))},[l("div",hV,[z[22]||(z[22]=l("h3",null,"Log out from session?",-1)),l("p",null,[z[20]||(z[20]=Qe("This will log you out from ",-1)),l("strong",null,w(y.value?.eventName||"this event"),1),z[21]||(z[21]=Qe(".",-1))]),z[23]||(z[23]=l("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),l("div",fV,[l("button",{class:"btn btn-secondary",onClick:z[7]||(z[7]=Y=>p.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:B},"Log out")])])])):A("",!0)]),_:1})]))]))}},vV=Ge(pV,[["__scopeId","data-v-add55e1c"]]);let Lf=!1;function mV(){Lf||(Lf=!0,vv(),pv())}const gV=[{path:"/",name:"Home",component:Rb},{path:"/admin/login",name:"AdminLogin",component:Gb},{path:"/admin/verify",name:"AdminVerify",component:Yb},{path:"/sessions",name:"Sessions",component:vV},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:yB,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:gH},{path:"/:pathMatch(.*)*",redirect:"/"}],fm=dk({history:V1("/VolunteerCheckin/testing/"),routes:gV});fm.beforeEach((e,t,o)=>{mV();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?Co("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&Co(null),e.name==="MarshalView"){const s=e.params.eventId,i=!!e.query.code,r=Vr(s),u=r?.marshalId?gv(s,r.marshalId):null;if(i){o();return}if(r?.token){o();return}if(u){o();return}if(mv()){o({name:"Sessions"});return}}o()});qs().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const md=Jy(Sk);md.use(Qy());md.use(fm);md.mount("#app");
