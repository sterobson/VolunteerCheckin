(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();function Pu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Bt={},Pi=[],Qo=()=>{},mf=()=>!1,Zr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Du=e=>e.startsWith("onUpdate:"),hn=Object.assign,Ru=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},mm=Object.prototype.hasOwnProperty,Dt=(e,t)=>mm.call(e,t),it=Array.isArray,Di=e=>Fl(e)==="[object Map]",Vi=e=>Fl(e)==="[object Set]",xd=e=>Fl(e)==="[object Date]",dt=e=>typeof e=="function",Xt=e=>typeof e=="string",ts=e=>typeof e=="symbol",Ot=e=>e!==null&&typeof e=="object",gf=e=>(Ot(e)||dt(e))&&dt(e.then)&&dt(e.catch),yf=Object.prototype.toString,Fl=e=>yf.call(e),gm=e=>Fl(e).slice(8,-1),kf=e=>Fl(e)==="[object Object]",qr=e=>Xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,vl=Pu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},ym=/-\w/g,Po=Wr(e=>e.replace(ym,t=>t.slice(1).toUpperCase())),km=/\B([A-Z])/g,$a=Wr(e=>e.replace(km,"-$1").toLowerCase()),Kr=Wr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Mc=Wr(e=>e?`on${Kr(e)}`:""),wa=(e,t)=>!Object.is(e,t),vr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},_f=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},Jr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},_m=e=>{const t=Xt(e)?Number(e):NaN;return isNaN(t)?e:t};let Id;const Yr=()=>Id||(Id=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qe(e){if(it(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],s=Xt(a)?Lm(a):Qe(a);if(s)for(const i in s)t[i]=s[i]}return t}else if(Xt(e)||Ot(e))return e}const bm=/;(?![^(]*\))/g,wm=/:([^]+)/,Cm=/\/\*[^]*?\*\//g;function Lm(e){const t={};return e.replace(Cm,"").split(bm).forEach(o=>{if(o){const a=o.split(wm);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function pe(e){let t="";if(Xt(e))t=e;else if(it(e))for(let o=0;o<e.length;o++){const a=pe(e[o]);a&&(t+=a+" ")}else if(Ot(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Sm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xm=Pu(Sm);function bf(e){return!!e||e===""}function Im(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=ai(e[a],t[a]);return o}function ai(e,t){if(e===t)return!0;let o=xd(e),a=xd(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=ts(e),a=ts(t),o||a)return e===t;if(o=it(e),a=it(t),o||a)return o&&a?Im(e,t):!1;if(o=Ot(e),a=Ot(t),o||a){if(!o||!a)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const r in e){const u=e.hasOwnProperty(r),d=t.hasOwnProperty(r);if(u&&!d||!u&&d||!ai(e[r],t[r]))return!1}}return String(e)===String(t)}function Ou(e,t){return e.findIndex(o=>ai(o,t))}const wf=e=>!!(e&&e.__v_isRef===!0),C=e=>Xt(e)?e:e==null?"":it(e)||Ot(e)&&(e.toString===yf||!dt(e.toString))?wf(e)?C(e.value):JSON.stringify(e,Cf,2):String(e),Cf=(e,t)=>wf(t)?Cf(e,t.value):Di(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,s],i)=>(o[Ac(a,i)+" =>"]=s,o),{})}:Vi(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Ac(o))}:ts(t)?Ac(t):Ot(t)&&!it(t)&&!kf(t)?String(t):t,Ac=(e,t="")=>{var o;return ts(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function $m(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let En;class Lf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=En,!t&&En&&(this.index=(En.scopes||(En.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=En;try{return En=this,t()}finally{En=o}}}on(){++this._on===1&&(this.prevScope=En,En=this)}off(){this._on>0&&--this._on===0&&(En=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Sf(e){return new Lf(e)}function xf(){return En}function Tm(e,t=!1){En&&En.cleanups.push(e)}let Vt;const Ec=new WeakSet;class If{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,En&&En.active&&En.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ec.has(this)&&(Ec.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Tf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$d(this),Mf(this);const t=Vt,o=es;Vt=this,es=!0;try{return this.fn()}finally{Af(this),Vt=t,es=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Fu(t);this.deps=this.depsTail=void 0,$d(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ec.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qc(this)&&this.run()}get dirty(){return Qc(this)}}let $f=0,ml,gl;function Tf(e,t=!1){if(e.flags|=8,t){e.next=gl,gl=e;return}e.next=ml,ml=e}function Bu(){$f++}function Nu(){if(--$f>0)return;if(gl){let t=gl;for(gl=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ml;){let t=ml;for(ml=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Af(e){let t,o=e.depsTail,a=o;for(;a;){const s=a.prevDep;a.version===-1?(a===o&&(o=s),Fu(a),Mm(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=s}e.deps=t,e.depsTail=o}function Qc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ef(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ef(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xl)||(e.globalVersion=xl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Qc(e))))return;e.flags|=2;const t=e.dep,o=Vt,a=es;Vt=e,es=!0;try{Mf(e);const s=e.fn(e._value);(t.version===0||wa(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Vt=o,es=a,Af(e),e.flags&=-3}}function Fu(e,t=!1){const{dep:o,prevSub:a,nextSub:s}=e;if(a&&(a.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)Fu(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Mm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let es=!0;const Pf=[];function Us(){Pf.push(es),es=!1}function zs(){const e=Pf.pop();es=e===void 0?!0:e}function $d(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Vt;Vt=void 0;try{t()}finally{Vt=o}}}let xl=0;class Am{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Uu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Vt||!es||Vt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Vt)o=this.activeLink=new Am(Vt,this),Vt.deps?(o.prevDep=Vt.depsTail,Vt.depsTail.nextDep=o,Vt.depsTail=o):Vt.deps=Vt.depsTail=o,Df(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Vt.depsTail,o.nextDep=void 0,Vt.depsTail.nextDep=o,Vt.depsTail=o,Vt.deps===o&&(Vt.deps=a)}return o}trigger(t){this.version++,xl++,this.notify(t)}notify(t){Bu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Nu()}}}function Df(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Df(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Lr=new WeakMap,ti=Symbol(""),eu=Symbol(""),Il=Symbol("");function Dn(e,t,o){if(es&&Vt){let a=Lr.get(e);a||Lr.set(e,a=new Map);let s=a.get(o);s||(a.set(o,s=new Uu),s.map=a,s.key=o),s.track()}}function Ps(e,t,o,a,s,i){const r=Lr.get(e);if(!r){xl++;return}const u=d=>{d&&d.trigger()};if(Bu(),t==="clear")r.forEach(u);else{const d=it(e),f=d&&qr(o);if(d&&o==="length"){const p=Number(a);r.forEach((g,k)=>{(k==="length"||k===Il||!ts(k)&&k>=p)&&u(g)})}else switch((o!==void 0||r.has(void 0))&&u(r.get(o)),f&&u(r.get(Il)),t){case"add":d?f&&u(r.get("length")):(u(r.get(ti)),Di(e)&&u(r.get(eu)));break;case"delete":d||(u(r.get(ti)),Di(e)&&u(r.get(eu)));break;case"set":Di(e)&&u(r.get(ti));break}}Nu()}function Em(e,t){const o=Lr.get(e);return o&&o.get(t)}function xi(e){const t=Tt(e);return t===e?t:(Dn(t,"iterate",Il),wo(e)?t:t.map(ns))}function Xr(e){return Dn(e=Tt(e),"iterate",Il),e}function pa(e,t){return Hs(e)?Fs(e)?Ni(ns(t)):Ni(t):ns(t)}const Pm={__proto__:null,[Symbol.iterator](){return Pc(this,Symbol.iterator,e=>pa(this,e))},concat(...e){return xi(this).concat(...e.map(t=>it(t)?xi(t):t))},entries(){return Pc(this,"entries",e=>(e[1]=pa(this,e[1]),e))},every(e,t){return Is(this,"every",e,t,void 0,arguments)},filter(e,t){return Is(this,"filter",e,t,o=>o.map(a=>pa(this,a)),arguments)},find(e,t){return Is(this,"find",e,t,o=>pa(this,o),arguments)},findIndex(e,t){return Is(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Is(this,"findLast",e,t,o=>pa(this,o),arguments)},findLastIndex(e,t){return Is(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Is(this,"forEach",e,t,void 0,arguments)},includes(...e){return Dc(this,"includes",e)},indexOf(...e){return Dc(this,"indexOf",e)},join(e){return xi(this).join(e)},lastIndexOf(...e){return Dc(this,"lastIndexOf",e)},map(e,t){return Is(this,"map",e,t,void 0,arguments)},pop(){return il(this,"pop")},push(...e){return il(this,"push",e)},reduce(e,...t){return Td(this,"reduce",e,t)},reduceRight(e,...t){return Td(this,"reduceRight",e,t)},shift(){return il(this,"shift")},some(e,t){return Is(this,"some",e,t,void 0,arguments)},splice(...e){return il(this,"splice",e)},toReversed(){return xi(this).toReversed()},toSorted(e){return xi(this).toSorted(e)},toSpliced(...e){return xi(this).toSpliced(...e)},unshift(...e){return il(this,"unshift",e)},values(){return Pc(this,"values",e=>pa(this,e))}};function Pc(e,t,o){const a=Xr(e),s=a[t]();return a!==e&&!wo(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=o(i.value)),i}),s}const Dm=Array.prototype;function Is(e,t,o,a,s,i){const r=Xr(e),u=r!==e&&!wo(e),d=r[t];if(d!==Dm[t]){const g=d.apply(e,i);return u?ns(g):g}let f=o;r!==e&&(u?f=function(g,k){return o.call(this,pa(e,g),k,e)}:o.length>2&&(f=function(g,k){return o.call(this,g,k,e)}));const p=d.call(r,f,a);return u&&s?s(p):p}function Td(e,t,o,a){const s=Xr(e);let i=o;return s!==e&&(wo(e)?o.length>3&&(i=function(r,u,d){return o.call(this,r,u,d,e)}):i=function(r,u,d){return o.call(this,r,pa(e,u),d,e)}),s[t](i,...a)}function Dc(e,t,o){const a=Tt(e);Dn(a,"iterate",Il);const s=a[t](...o);return(s===-1||s===!1)&&Qr(o[0])?(o[0]=Tt(o[0]),a[t](...o)):s}function il(e,t,o=[]){Us(),Bu();const a=Tt(e)[t].apply(e,o);return Nu(),zs(),a}const Rm=Pu("__proto__,__v_isRef,__isVue"),Rf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ts));function Om(e){ts(e)||(e=String(e));const t=Tt(this);return Dn(t,"has",e),t.hasOwnProperty(e)}class Of{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(s?i?Zm:Uf:i?Ff:Nf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const r=it(t);if(!s){let d;if(r&&(d=Pm[o]))return d;if(o==="hasOwnProperty")return Om}const u=Reflect.get(t,o,Yt(t)?t:a);if((ts(o)?Rf.has(o):Rm(o))||(s||Dn(t,"get",o),i))return u;if(Yt(u)){const d=r&&qr(o)?u:u.value;return s&&Ot(d)?nu(d):d}return Ot(u)?s?nu(u):li(u):u}}class Bf extends Of{constructor(t=!1){super(!1,t)}set(t,o,a,s){let i=t[o];const r=it(t)&&qr(o);if(!this._isShallow){const f=Hs(i);if(!wo(a)&&!Hs(a)&&(i=Tt(i),a=Tt(a)),!r&&Yt(i)&&!Yt(a))return f||(i.value=a),!0}const u=r?Number(o)<t.length:Dt(t,o),d=Reflect.set(t,o,a,Yt(t)?t:s);return t===Tt(s)&&(u?wa(a,i)&&Ps(t,"set",o,a):Ps(t,"add",o,a)),d}deleteProperty(t,o){const a=Dt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&a&&Ps(t,"delete",o,void 0),s}has(t,o){const a=Reflect.has(t,o);return(!ts(o)||!Rf.has(o))&&Dn(t,"has",o),a}ownKeys(t){return Dn(t,"iterate",it(t)?"length":ti),Reflect.ownKeys(t)}}class Bm extends Of{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Nm=new Bf,Fm=new Bm,Um=new Bf(!0);const tu=e=>e,ir=e=>Reflect.getPrototypeOf(e);function zm(e,t,o){return function(...a){const s=this.__v_raw,i=Tt(s),r=Di(i),u=e==="entries"||e===Symbol.iterator&&r,d=e==="keys"&&r,f=s[e](...a),p=o?tu:t?Ni:ns;return!t&&Dn(i,"iterate",d?eu:ti),{next(){const{value:g,done:k}=f.next();return k?{value:g,done:k}:{value:u?[p(g[0]),p(g[1])]:p(g),done:k}},[Symbol.iterator](){return this}}}}function lr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Hm(e,t){const o={get(s){const i=this.__v_raw,r=Tt(i),u=Tt(s);e||(wa(s,u)&&Dn(r,"get",s),Dn(r,"get",u));const{has:d}=ir(r),f=t?tu:e?Ni:ns;if(d.call(r,s))return f(i.get(s));if(d.call(r,u))return f(i.get(u));i!==r&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Dn(Tt(s),"iterate",ti),s.size},has(s){const i=this.__v_raw,r=Tt(i),u=Tt(s);return e||(wa(s,u)&&Dn(r,"has",s),Dn(r,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)},forEach(s,i){const r=this,u=r.__v_raw,d=Tt(u),f=t?tu:e?Ni:ns;return!e&&Dn(d,"iterate",ti),u.forEach((p,g)=>s.call(i,f(p),f(g),r))}};return hn(o,e?{add:lr("add"),set:lr("set"),delete:lr("delete"),clear:lr("clear")}:{add(s){!t&&!wo(s)&&!Hs(s)&&(s=Tt(s));const i=Tt(this);return ir(i).has.call(i,s)||(i.add(s),Ps(i,"add",s,s)),this},set(s,i){!t&&!wo(i)&&!Hs(i)&&(i=Tt(i));const r=Tt(this),{has:u,get:d}=ir(r);let f=u.call(r,s);f||(s=Tt(s),f=u.call(r,s));const p=d.call(r,s);return r.set(s,i),f?wa(i,p)&&Ps(r,"set",s,i):Ps(r,"add",s,i),this},delete(s){const i=Tt(this),{has:r,get:u}=ir(i);let d=r.call(i,s);d||(s=Tt(s),d=r.call(i,s)),u&&u.call(i,s);const f=i.delete(s);return d&&Ps(i,"delete",s,void 0),f},clear(){const s=Tt(this),i=s.size!==0,r=s.clear();return i&&Ps(s,"clear",void 0,void 0),r}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=zm(s,e,t)}),o}function zu(e,t){const o=Hm(e,t);return(a,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?a:Reflect.get(Dt(o,s)&&s in a?o:a,s,i)}const Vm={get:zu(!1,!1)},Gm={get:zu(!1,!0)},jm={get:zu(!0,!1)};const Nf=new WeakMap,Ff=new WeakMap,Uf=new WeakMap,Zm=new WeakMap;function qm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wm(e){return e.__v_skip||!Object.isExtensible(e)?0:qm(gm(e))}function li(e){return Hs(e)?e:Hu(e,!1,Nm,Vm,Nf)}function zf(e){return Hu(e,!1,Um,Gm,Ff)}function nu(e){return Hu(e,!0,Fm,jm,Uf)}function Hu(e,t,o,a,s){if(!Ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=Wm(e);if(i===0)return e;const r=s.get(e);if(r)return r;const u=new Proxy(e,i===2?a:o);return s.set(e,u),u}function Fs(e){return Hs(e)?Fs(e.__v_raw):!!(e&&e.__v_isReactive)}function Hs(e){return!!(e&&e.__v_isReadonly)}function wo(e){return!!(e&&e.__v_isShallow)}function Qr(e){return e?!!e.__v_raw:!1}function Tt(e){const t=e&&e.__v_raw;return t?Tt(t):e}function Vu(e){return!Dt(e,"__v_skip")&&Object.isExtensible(e)&&_f(e,"__v_skip",!0),e}const ns=e=>Ot(e)?li(e):e,Ni=e=>Ot(e)?nu(e):e;function Yt(e){return e?e.__v_isRef===!0:!1}function T(e){return Hf(e,!1)}function Km(e){return Hf(e,!0)}function Hf(e,t){return Yt(e)?e:new Jm(e,t)}class Jm{constructor(t,o){this.dep=new Uu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Tt(t),this._value=o?t:ns(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||wo(t)||Hs(t);t=a?t:Tt(t),wa(t,o)&&(this._rawValue=t,this._value=a?t:ns(t),this.dep.trigger())}}function O(e){return Yt(e)?e.value:e}function Sr(e){return dt(e)?e():O(e)}const Ym={get:(e,t,o)=>t==="__v_raw"?e:O(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const s=e[t];return Yt(s)&&!Yt(o)?(s.value=o,!0):Reflect.set(e,t,o,a)}};function Vf(e){return Fs(e)?e:new Proxy(e,Ym)}function Xm(e){const t=it(e)?new Array(e.length):{};for(const o in e)t[o]=eg(e,o);return t}class Qm{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Tt(t);let s=!0,i=t;if(!it(t)||!qr(String(o)))do s=!Qr(i)||wo(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=O(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Yt(this._raw[this._key])){const o=this._object[this._key];if(Yt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Em(this._raw,this._key)}}function eg(e,t,o){return new Qm(e,t,o)}class tg{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Uu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Vt!==this)return Tf(this,!0),!0}get value(){const t=this.dep.track();return Ef(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ng(e,t,o=!1){let a,s;return dt(e)?a=e:(a=e.get,s=e.set),new tg(a,s,o)}const rr={},xr=new WeakMap;let Ka;function og(e,t=!1,o=Ka){if(o){let a=xr.get(o);a||xr.set(o,a=[]),a.push(e)}}function sg(e,t,o=Bt){const{immediate:a,deep:s,once:i,scheduler:r,augmentJob:u,call:d}=o,f=D=>s?D:wo(D)||s===!1||s===0?Ds(D,1):Ds(D);let p,g,k,y,_=!1,w=!1;if(Yt(e)?(g=()=>e.value,_=wo(e)):Fs(e)?(g=()=>f(e),_=!0):it(e)?(w=!0,_=e.some(D=>Fs(D)||wo(D)),g=()=>e.map(D=>{if(Yt(D))return D.value;if(Fs(D))return f(D);if(dt(D))return d?d(D,2):D()})):dt(e)?t?g=d?()=>d(e,2):e:g=()=>{if(k){Us();try{k()}finally{zs()}}const D=Ka;Ka=p;try{return d?d(e,3,[y]):e(y)}finally{Ka=D}}:g=Qo,t&&s){const D=g,R=s===!0?1/0:s;g=()=>Ds(D(),R)}const S=xf(),E=()=>{p.stop(),S&&S.active&&Ru(S.effects,p)};if(i&&t){const D=t;t=(...R)=>{D(...R),E()}}let A=w?new Array(e.length).fill(rr):rr;const x=D=>{if(!(!(p.flags&1)||!p.dirty&&!D))if(t){const R=p.run();if(s||_||(w?R.some((H,$)=>wa(H,A[$])):wa(R,A))){k&&k();const H=Ka;Ka=p;try{const $=[R,A===rr?void 0:w&&A[0]===rr?[]:A,y];A=R,d?d(t,3,$):t(...$)}finally{Ka=H}}}else p.run()};return u&&u(x),p=new If(g),p.scheduler=r?()=>r(x,!1):x,y=D=>og(D,!1,p),k=p.onStop=()=>{const D=xr.get(p);if(D){if(d)d(D,4);else for(const R of D)R();xr.delete(p)}},t?a?x(!0):A=p.run():r?r(x.bind(null,!0),!0):p.run(),E.pause=p.pause.bind(p),E.resume=p.resume.bind(p),E.stop=E,E}function Ds(e,t=1/0,o){if(t<=0||!Ot(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Yt(e))Ds(e.value,t,o);else if(it(e))for(let a=0;a<e.length;a++)Ds(e[a],t,o);else if(Vi(e)||Di(e))e.forEach(a=>{Ds(a,t,o)});else if(kf(e)){for(const a in e)Ds(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Ds(e[a],t,o)}return e}function Ul(e,t,o,a){try{return a?e(...a):e()}catch(s){ec(s,t,o)}}function os(e,t,o,a){if(dt(e)){const s=Ul(e,t,o,a);return s&&gf(s)&&s.catch(i=>{ec(i,t,o)}),s}if(it(e)){const s=[];for(let i=0;i<e.length;i++)s.push(os(e[i],t,o,a));return s}}function ec(e,t,o,a=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||Bt;if(t){let u=t.parent;const d=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,d,f)===!1)return}u=u.parent}if(i){Us(),Ul(i,null,10,[e,d,f]),zs();return}}ag(e,o,s,a,r)}function ag(e,t,o,a=!0,s=!1){if(s)throw e;console.error(e)}const Jn=[];let ds=-1;const Ri=[];let va=null,$i=0;const Gf=Promise.resolve();let Ir=null;function cn(e){const t=Ir||Gf;return e?t.then(this?e.bind(this):e):t}function ig(e){let t=ds+1,o=Jn.length;for(;t<o;){const a=t+o>>>1,s=Jn[a],i=$l(s);i<e||i===e&&s.flags&2?t=a+1:o=a}return t}function Gu(e){if(!(e.flags&1)){const t=$l(e),o=Jn[Jn.length-1];!o||!(e.flags&2)&&t>=$l(o)?Jn.push(e):Jn.splice(ig(t),0,e),e.flags|=1,jf()}}function jf(){Ir||(Ir=Gf.then(Wf))}function Zf(e){it(e)?Ri.push(...e):va&&e.id===-1?va.splice($i+1,0,e):e.flags&1||(Ri.push(e),e.flags|=1),jf()}function Md(e,t,o=ds+1){for(;o<Jn.length;o++){const a=Jn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Jn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function qf(e){if(Ri.length){const t=[...new Set(Ri)].sort((o,a)=>$l(o)-$l(a));if(Ri.length=0,va){va.push(...t);return}for(va=t,$i=0;$i<va.length;$i++){const o=va[$i];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}va=null,$i=0}}const $l=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Wf(e){try{for(ds=0;ds<Jn.length;ds++){const t=Jn[ds];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ul(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ds<Jn.length;ds++){const t=Jn[ds];t&&(t.flags&=-2)}ds=-1,Jn.length=0,qf(),Ir=null,(Jn.length||Ri.length)&&Wf()}}let Sn=null,Kf=null;function $r(e){const t=Sn;return Sn=e,Kf=e&&e.type.__scopeId||null,t}function ze(e,t=Sn,o){if(!t||e._n)return e;const a=(...s)=>{a._d&&Ar(-1);const i=$r(t);let r;try{r=e(...s)}finally{$r(i),a._d&&Ar(1)}return r};return a._n=!0,a._c=!0,a._d=!0,a}function Ue(e,t){if(Sn===null)return e;const o=ic(Sn),a=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,r,u,d=Bt]=t[s];i&&(dt(i)&&(i={mounted:i,updated:i}),i.deep&&Ds(r),a.push({dir:i,instance:o,value:r,oldValue:void 0,arg:u,modifiers:d}))}return e}function Ga(e,t,o,a){const s=e.dirs,i=t&&t.dirs;for(let r=0;r<s.length;r++){const u=s[r];i&&(u.oldValue=i[r].value);let d=u.dir[a];d&&(Us(),os(d,o,8,[e.el,u,e,t]),zs())}}function yl(e,t){if(On){let o=On.provides;const a=On.parent&&On.parent.provides;a===o&&(o=On.provides=Object.create(a)),o[e]=t}}function lo(e,t,o=!1){const a=ac();if(a||ni){let s=ni?ni._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&dt(t)?t.call(a&&a.proxy):t}}function lg(){return!!(ac()||ni)}const rg=Symbol.for("v-scx"),cg=()=>lo(rg);function Ze(e,t,o){return Jf(e,t,o)}function Jf(e,t,o=Bt){const{immediate:a,deep:s,flush:i,once:r}=o,u=hn({},o),d=t&&a||!t&&i!=="post";let f;if(Pl){if(i==="sync"){const y=cg();f=y.__watcherHandles||(y.__watcherHandles=[])}else if(!d){const y=()=>{};return y.stop=Qo,y.resume=Qo,y.pause=Qo,y}}const p=On;u.call=(y,_,w)=>os(y,p,_,w);let g=!1;i==="post"?u.scheduler=y=>{Wn(y,p&&p.suspense)}:i!=="sync"&&(g=!0,u.scheduler=(y,_)=>{_?y():Gu(y)}),u.augmentJob=y=>{t&&(y.flags|=4),g&&(y.flags|=2,p&&(y.id=p.uid,y.i=p))};const k=sg(e,t,u);return Pl&&(f?f.push(k):d&&k()),k}function ug(e,t,o){const a=this.proxy,s=Xt(e)?e.includes(".")?Yf(a,e):()=>a[e]:e.bind(a,a);let i;dt(t)?i=t:(i=t.handler,o=t);const r=zl(this),u=Jf(s,i.bind(a),o);return r(),u}function Yf(e,t){const o=t.split(".");return()=>{let a=e;for(let s=0;s<o.length&&a;s++)a=a[o[s]];return a}}const Xf=Symbol("_vte"),Qf=e=>e.__isTeleport,kl=e=>e&&(e.disabled||e.disabled===""),Ad=e=>e&&(e.defer||e.defer===""),Ed=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Pd=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,ou=(e,t)=>{const o=e&&e.to;return Xt(o)?t?t(o):null:o},ep={name:"Teleport",__isTeleport:!0,process(e,t,o,a,s,i,r,u,d,f){const{mc:p,pc:g,pbc:k,o:{insert:y,querySelector:_,createText:w,createComment:S}}=f,E=kl(t.props);let{shapeFlag:A,children:x,dynamicChildren:D}=t;if(e==null){const R=t.el=w(""),H=t.anchor=w("");y(R,o,a),y(H,o,a);const $=(N,Z)=>{A&16&&p(x,N,Z,s,i,r,u,d)},B=()=>{const N=t.target=ou(t.props,_),Z=tp(N,t,w,y);N&&(r!=="svg"&&Ed(N)?r="svg":r!=="mathml"&&Pd(N)&&(r="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(N),E||($(N,Z),mr(t,!1)))};E&&($(o,H),mr(t,!0)),Ad(t.props)?(t.el.__isMounted=!1,Wn(()=>{B(),delete t.el.__isMounted},i)):B()}else{if(Ad(t.props)&&e.el.__isMounted===!1){Wn(()=>{ep.process(e,t,o,a,s,i,r,u,d,f)},i);return}t.el=e.el,t.targetStart=e.targetStart;const R=t.anchor=e.anchor,H=t.target=e.target,$=t.targetAnchor=e.targetAnchor,B=kl(e.props),N=B?o:H,Z=B?R:$;if(r==="svg"||Ed(H)?r="svg":(r==="mathml"||Pd(H))&&(r="mathml"),D?(k(e.dynamicChildren,D,N,s,i,r,u),Wu(e,t,!0)):d||g(e,t,N,Z,s,i,r,u,!1),E)B?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):cr(t,o,R,f,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const P=t.target=ou(t.props,_);P&&cr(t,P,null,f,0)}else B&&cr(t,H,$,f,1);mr(t,E)}},remove(e,t,o,{um:a,o:{remove:s}},i){const{shapeFlag:r,children:u,anchor:d,targetStart:f,targetAnchor:p,target:g,props:k}=e;if(g&&(s(f),s(p)),i&&s(d),r&16){const y=i||!kl(k);for(let _=0;_<u.length;_++){const w=u[_];a(w,t,o,y,!!w.dynamicChildren)}}},move:cr,hydrate:dg};function cr(e,t,o,{o:{insert:a},m:s},i=2){i===0&&a(e.targetAnchor,t,o);const{el:r,anchor:u,shapeFlag:d,children:f,props:p}=e,g=i===2;if(g&&a(r,t,o),(!g||kl(p))&&d&16)for(let k=0;k<f.length;k++)s(f[k],t,o,2);g&&a(u,t,o)}function dg(e,t,o,a,s,i,{o:{nextSibling:r,parentNode:u,querySelector:d,insert:f,createText:p}},g){function k(w,S,E,A){S.anchor=g(r(w),S,u(w),o,a,s,i),S.targetStart=E,S.targetAnchor=A}const y=t.target=ou(t.props,d),_=kl(t.props);if(y){const w=y._lpa||y.firstChild;if(t.shapeFlag&16)if(_)k(e,t,w,w&&r(w));else{t.anchor=r(e);let S=w;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")t.targetStart=S;else if(S.data==="teleport anchor"){t.targetAnchor=S,y._lpa=t.targetAnchor&&r(t.targetAnchor);break}}S=r(S)}t.targetAnchor||tp(y,t,p,f),g(w&&r(w),t,y,o,a,s,i)}mr(t,_)}else _&&t.shapeFlag&16&&k(e,t,e,r(e));return t.anchor&&r(t.anchor)}const Tl=ep;function mr(e,t){const o=e.ctx;if(o&&o.ut){let a,s;for(t?(a=e.el,s=e.anchor):(a=e.targetStart,s=e.targetAnchor);a&&a!==s;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function tp(e,t,o,a){const s=t.targetStart=o(""),i=t.targetAnchor=o("");return s[Xf]=i,e&&(a(s,e),a(i,e)),i}const As=Symbol("_leaveCb"),ur=Symbol("_enterCb");function hg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nn(()=>{e.isMounted=!0}),dp(()=>{e.isUnmounting=!0}),e}const Ao=[Function,Array],np={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ao,onEnter:Ao,onAfterEnter:Ao,onEnterCancelled:Ao,onBeforeLeave:Ao,onLeave:Ao,onAfterLeave:Ao,onLeaveCancelled:Ao,onBeforeAppear:Ao,onAppear:Ao,onAfterAppear:Ao,onAppearCancelled:Ao},op=e=>{const t=e.subTree;return t.component?op(t.component):t},fg={name:"BaseTransition",props:np,setup(e,{slots:t}){const o=ac(),a=hg();return()=>{const s=t.default&&ip(t.default(),!0);if(!s||!s.length)return;const i=sp(s),r=Tt(e),{mode:u}=r;if(a.isLeaving)return Rc(i);const d=Dd(i);if(!d)return Rc(i);let f=su(d,r,a,o,g=>f=g);d.type!==Rn&&Ml(d,f);let p=o.subTree&&Dd(o.subTree);if(p&&p.type!==Rn&&!Ja(p,d)&&op(o).type!==Rn){let g=su(p,r,a,o);if(Ml(p,g),u==="out-in"&&d.type!==Rn)return a.isLeaving=!0,g.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},Rc(i);u==="in-out"&&d.type!==Rn?g.delayLeave=(k,y,_)=>{const w=ap(a,p);w[String(p.key)]=p,k[As]=()=>{y(),k[As]=void 0,delete f.delayedLeave,p=void 0},f.delayedLeave=()=>{_(),delete f.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return i}}};function sp(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Rn){t=o;break}}return t}const pg=fg;function ap(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function su(e,t,o,a,s){const{appear:i,mode:r,persisted:u=!1,onBeforeEnter:d,onEnter:f,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:k,onLeave:y,onAfterLeave:_,onLeaveCancelled:w,onBeforeAppear:S,onAppear:E,onAfterAppear:A,onAppearCancelled:x}=t,D=String(e.key),R=ap(o,e),H=(N,Z)=>{N&&os(N,a,9,Z)},$=(N,Z)=>{const P=Z[1];H(N,Z),it(N)?N.every(G=>G.length<=1)&&P():N.length<=1&&P()},B={mode:r,persisted:u,beforeEnter(N){let Z=d;if(!o.isMounted)if(i)Z=S||d;else return;N[As]&&N[As](!0);const P=R[D];P&&Ja(e,P)&&P.el[As]&&P.el[As](),H(Z,[N])},enter(N){let Z=f,P=p,G=g;if(!o.isMounted)if(i)Z=E||f,P=A||p,G=x||g;else return;let Y=!1;const te=N[ur]=Q=>{Y||(Y=!0,Q?H(G,[N]):H(P,[N]),B.delayedLeave&&B.delayedLeave(),N[ur]=void 0)};Z?$(Z,[N,te]):te()},leave(N,Z){const P=String(e.key);if(N[ur]&&N[ur](!0),o.isUnmounting)return Z();H(k,[N]);let G=!1;const Y=N[As]=te=>{G||(G=!0,Z(),te?H(w,[N]):H(_,[N]),N[As]=void 0,R[P]===e&&delete R[P])};R[P]=e,y?$(y,[N,Y]):Y()},clone(N){const Z=su(N,t,o,a,s);return s&&s(Z),Z}};return B}function Rc(e){if(tc(e))return e=Sa(e),e.children=null,e}function Dd(e){if(!tc(e))return Qf(e.type)&&e.children?sp(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&dt(o.default))return o.default()}}function Ml(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ml(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ip(e,t=!1,o){let a=[],s=0;for(let i=0;i<e.length;i++){let r=e[i];const u=o==null?r.key:String(o)+String(r.key!=null?r.key:i);r.type===Ie?(r.patchFlag&128&&s++,a=a.concat(ip(r.children,t,u))):(t||r.type!==Rn)&&a.push(u!=null?Sa(r,{key:u}):r)}if(s>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function lp(e,t){return dt(e)?hn({name:e.name},t,{setup:e}):e}function rp(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Tr=new WeakMap;function _l(e,t,o,a,s=!1){if(it(e)){e.forEach((_,w)=>_l(_,t&&(it(t)?t[w]:t),o,a,s));return}if(Oi(a)&&!s){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&_l(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?ic(a.component):a.el,r=s?null:i,{i:u,r:d}=e,f=t&&t.r,p=u.refs===Bt?u.refs={}:u.refs,g=u.setupState,k=Tt(g),y=g===Bt?mf:_=>Dt(k,_);if(f!=null&&f!==d){if(Rd(t),Xt(f))p[f]=null,y(f)&&(g[f]=null);else if(Yt(f)){f.value=null;const _=t;_.k&&(p[_.k]=null)}}if(dt(d))Ul(d,u,12,[r,p]);else{const _=Xt(d),w=Yt(d);if(_||w){const S=()=>{if(e.f){const E=_?y(d)?g[d]:p[d]:d.value;if(s)it(E)&&Ru(E,i);else if(it(E))E.includes(i)||E.push(i);else if(_)p[d]=[i],y(d)&&(g[d]=p[d]);else{const A=[i];d.value=A,e.k&&(p[e.k]=A)}}else _?(p[d]=r,y(d)&&(g[d]=r)):w&&(d.value=r,e.k&&(p[e.k]=r))};if(r){const E=()=>{S(),Tr.delete(e)};E.id=-1,Tr.set(e,E),Wn(E,o)}else Rd(e),S()}}}function Rd(e){const t=Tr.get(e);t&&(t.flags|=8,Tr.delete(e))}Yr().requestIdleCallback;Yr().cancelIdleCallback;const Oi=e=>!!e.type.__asyncLoader,tc=e=>e.type.__isKeepAlive;function vg(e,t){cp(e,"a",t)}function mg(e,t){cp(e,"da",t)}function cp(e,t,o=On){const a=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(nc(t,a,o),o){let s=o.parent;for(;s&&s.parent;)tc(s.parent.vnode)&&gg(a,t,o,s),s=s.parent}}function gg(e,t,o,a){const s=nc(t,e,a,!0);xn(()=>{Ru(a[t],s)},o)}function nc(e,t,o=On,a=!1){if(o){const s=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...r)=>{Us();const u=zl(o),d=os(t,o,e,r);return u(),zs(),d});return a?s.unshift(i):s.push(i),i}}const Gs=e=>(t,o=On)=>{(!Pl||e==="sp")&&nc(e,(...a)=>t(...a),o)},yg=Gs("bm"),nn=Gs("m"),up=Gs("bu"),kg=Gs("u"),dp=Gs("bum"),xn=Gs("um"),_g=Gs("sp"),bg=Gs("rtg"),wg=Gs("rtc");function Cg(e,t=On){nc("ec",e,t)}const hp="components";function ju(e,t){return pp(hp,e,!0,t)||e}const fp=Symbol.for("v-ndc");function Lg(e){return Xt(e)?pp(hp,e,!1)||e:e||fp}function pp(e,t,o=!0,a=!1){const s=Sn||On;if(s){const i=s.type;{const u=ly(i,!1);if(u&&(u===t||u===Po(t)||u===Kr(Po(t))))return i}const r=Od(s[e]||i[e],t)||Od(s.appContext[e],t);return!r&&a?i:r}}function Od(e,t){return e&&(e[t]||e[Po(t)]||e[Kr(Po(t))])}function Ne(e,t,o,a){let s;const i=o,r=it(e);if(r||Xt(e)){const u=r&&Fs(e);let d=!1,f=!1;u&&(d=!wo(e),f=Hs(e),e=Xr(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(d?f?Ni(ns(e[p])):ns(e[p]):e[p],p,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,i)}else if(Ot(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,f=u.length;d<f;d++){const p=u[d];s[d]=t(e[p],p,d,i)}}else s=[];return s}function vp(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(it(a))for(let s=0;s<a.length;s++)e[a[s].name]=a[s].fn;else a&&(e[a.name]=a.key?(...s)=>{const i=a.fn(...s);return i&&(i.key=a.key),i}:a.fn)}return e}function io(e,t,o={},a,s){if(Sn.ce||Sn.parent&&Oi(Sn.parent)&&Sn.parent.ce){const f=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),qe(Ie,null,[Ee("slot",o,a&&a())],f?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const r=i&&mp(i(o)),u=o.key||r&&r.key,d=qe(Ie,{key:(u&&!ts(u)?u:`_${t}`)+(!r&&a?"_fb":"")},r||(a?a():[]),r&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function mp(e){return e.some(t=>El(t)?!(t.type===Rn||t.type===Ie&&!mp(t.children)):!0)?e:null}const au=e=>e?Rp(e)?ic(e):au(e.parent):null,bl=hn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>au(e.parent),$root:e=>au(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>yp(e),$forceUpdate:e=>e.f||(e.f=()=>{Gu(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>ug.bind(e)}),Oc=(e,t)=>e!==Bt&&!e.__isScriptSetup&&Dt(e,t),Sg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:s,props:i,accessCache:r,type:u,appContext:d}=e;if(t[0]!=="$"){const k=r[t];if(k!==void 0)switch(k){case 1:return a[t];case 2:return s[t];case 4:return o[t];case 3:return i[t]}else{if(Oc(a,t))return r[t]=1,a[t];if(s!==Bt&&Dt(s,t))return r[t]=2,s[t];if(Dt(i,t))return r[t]=3,i[t];if(o!==Bt&&Dt(o,t))return r[t]=4,o[t];iu&&(r[t]=0)}}const f=bl[t];let p,g;if(f)return t==="$attrs"&&Dn(e.attrs,"get",""),f(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Bt&&Dt(o,t))return r[t]=4,o[t];if(g=d.config.globalProperties,Dt(g,t))return g[t]},set({_:e},t,o){const{data:a,setupState:s,ctx:i}=e;return Oc(s,t)?(s[t]=o,!0):a!==Bt&&Dt(a,t)?(a[t]=o,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:s,props:i,type:r}},u){let d;return!!(o[u]||e!==Bt&&u[0]!=="$"&&Dt(e,u)||Oc(t,u)||Dt(i,u)||Dt(a,u)||Dt(bl,u)||Dt(s.config.globalProperties,u)||(d=r.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Dt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Bd(e){return it(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let iu=!0;function xg(e){const t=yp(e),o=e.proxy,a=e.ctx;iu=!1,t.beforeCreate&&Nd(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:r,watch:u,provide:d,inject:f,created:p,beforeMount:g,mounted:k,beforeUpdate:y,updated:_,activated:w,deactivated:S,beforeDestroy:E,beforeUnmount:A,destroyed:x,unmounted:D,render:R,renderTracked:H,renderTriggered:$,errorCaptured:B,serverPrefetch:N,expose:Z,inheritAttrs:P,components:G,directives:Y,filters:te}=t;if(f&&Ig(f,a,null),r)for(const ne in r){const F=r[ne];dt(F)&&(a[ne]=F.bind(o))}if(s){const ne=s.call(o,o);Ot(ne)&&(e.data=li(ne))}if(iu=!0,i)for(const ne in i){const F=i[ne],K=dt(F)?F.bind(o,o):dt(F.get)?F.get.bind(o,o):Qo,fe=!dt(F)&&dt(F.set)?F.set.bind(o):Qo,he=V({get:K,set:fe});Object.defineProperty(a,ne,{enumerable:!0,configurable:!0,get:()=>he.value,set:Re=>he.value=Re})}if(u)for(const ne in u)gp(u[ne],a,o,ne);if(d){const ne=dt(d)?d.call(o):d;Reflect.ownKeys(ne).forEach(F=>{yl(F,ne[F])})}p&&Nd(p,e,"c");function X(ne,F){it(F)?F.forEach(K=>ne(K.bind(o))):F&&ne(F.bind(o))}if(X(yg,g),X(nn,k),X(up,y),X(kg,_),X(vg,w),X(mg,S),X(Cg,B),X(wg,H),X(bg,$),X(dp,A),X(xn,D),X(_g,N),it(Z))if(Z.length){const ne=e.exposed||(e.exposed={});Z.forEach(F=>{Object.defineProperty(ne,F,{get:()=>o[F],set:K=>o[F]=K,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===Qo&&(e.render=R),P!=null&&(e.inheritAttrs=P),G&&(e.components=G),Y&&(e.directives=Y),N&&rp(e)}function Ig(e,t,o=Qo){it(e)&&(e=lu(e));for(const a in e){const s=e[a];let i;Ot(s)?"default"in s?i=lo(s.from||a,s.default,!0):i=lo(s.from||a):i=lo(s),Yt(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:r=>i.value=r}):t[a]=i}}function Nd(e,t,o){os(it(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function gp(e,t,o,a){let s=a.includes(".")?Yf(o,a):()=>o[a];if(Xt(e)){const i=t[e];dt(i)&&Ze(s,i)}else if(dt(e))Ze(s,e.bind(o));else if(Ot(e))if(it(e))e.forEach(i=>gp(i,t,o,a));else{const i=dt(e.handler)?e.handler.bind(o):t[e.handler];dt(i)&&Ze(s,i,e)}}function yp(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:r}}=e.appContext,u=i.get(t);let d;return u?d=u:!s.length&&!o&&!a?d=t:(d={},s.length&&s.forEach(f=>Mr(d,f,r,!0)),Mr(d,t,r)),Ot(t)&&i.set(t,d),d}function Mr(e,t,o,a=!1){const{mixins:s,extends:i}=t;i&&Mr(e,i,o,!0),s&&s.forEach(r=>Mr(e,r,o,!0));for(const r in t)if(!(a&&r==="expose")){const u=$g[r]||o&&o[r];e[r]=u?u(e[r],t[r]):t[r]}return e}const $g={data:Fd,props:Ud,emits:Ud,methods:dl,computed:dl,beforeCreate:qn,created:qn,beforeMount:qn,mounted:qn,beforeUpdate:qn,updated:qn,beforeDestroy:qn,beforeUnmount:qn,destroyed:qn,unmounted:qn,activated:qn,deactivated:qn,errorCaptured:qn,serverPrefetch:qn,components:dl,directives:dl,watch:Mg,provide:Fd,inject:Tg};function Fd(e,t){return t?e?function(){return hn(dt(e)?e.call(this,this):e,dt(t)?t.call(this,this):t)}:t:e}function Tg(e,t){return dl(lu(e),lu(t))}function lu(e){if(it(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function qn(e,t){return e?[...new Set([].concat(e,t))]:t}function dl(e,t){return e?hn(Object.create(null),e,t):t}function Ud(e,t){return e?it(e)&&it(t)?[...new Set([...e,...t])]:hn(Object.create(null),Bd(e),Bd(t??{})):t}function Mg(e,t){if(!e)return t;if(!t)return e;const o=hn(Object.create(null),e);for(const a in t)o[a]=qn(e[a],t[a]);return o}function kp(){return{app:null,config:{isNativeTag:mf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ag=0;function Eg(e,t){return function(a,s=null){dt(a)||(a=hn({},a)),s!=null&&!Ot(s)&&(s=null);const i=kp(),r=new WeakSet,u=[];let d=!1;const f=i.app={_uid:Ag++,_component:a,_props:s,_container:null,_context:i,_instance:null,version:cy,get config(){return i.config},set config(p){},use(p,...g){return r.has(p)||(p&&dt(p.install)?(r.add(p),p.install(f,...g)):dt(p)&&(r.add(p),p(f,...g))),f},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),f},component(p,g){return g?(i.components[p]=g,f):i.components[p]},directive(p,g){return g?(i.directives[p]=g,f):i.directives[p]},mount(p,g,k){if(!d){const y=f._ceVNode||Ee(a,s);return y.appContext=i,k===!0?k="svg":k===!1&&(k=void 0),e(y,p,k),d=!0,f._container=p,p.__vue_app__=f,ic(y.component)}},onUnmount(p){u.push(p)},unmount(){d&&(os(u,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(p,g){return i.provides[p]=g,f},runWithContext(p){const g=ni;ni=f;try{return p()}finally{ni=g}}};return f}}let ni=null;const Pg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Po(t)}Modifiers`]||e[`${$a(t)}Modifiers`];function Dg(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Bt;let s=o;const i=t.startsWith("update:"),r=i&&Pg(a,t.slice(7));r&&(r.trim&&(s=o.map(p=>Xt(p)?p.trim():p)),r.number&&(s=o.map(Jr)));let u,d=a[u=Mc(t)]||a[u=Mc(Po(t))];!d&&i&&(d=a[u=Mc($a(t))]),d&&os(d,e,6,s);const f=a[u+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,os(f,e,6,s)}}const Rg=new WeakMap;function _p(e,t,o=!1){const a=o?Rg:t.emitsCache,s=a.get(e);if(s!==void 0)return s;const i=e.emits;let r={},u=!1;if(!dt(e)){const d=f=>{const p=_p(f,t,!0);p&&(u=!0,hn(r,p))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(Ot(e)&&a.set(e,null),null):(it(i)?i.forEach(d=>r[d]=null):hn(r,i),Ot(e)&&a.set(e,r),r)}function oc(e,t){return!e||!Zr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,$a(t))||Dt(e,t))}function zd(e){const{type:t,vnode:o,proxy:a,withProxy:s,propsOptions:[i],slots:r,attrs:u,emit:d,render:f,renderCache:p,props:g,data:k,setupState:y,ctx:_,inheritAttrs:w}=e,S=$r(e);let E,A;try{if(o.shapeFlag&4){const D=s||a,R=D;E=hs(f.call(R,D,p,g,y,k,_)),A=u}else{const D=t;E=hs(D.length>1?D(g,{attrs:u,slots:r,emit:d}):D(g,null)),A=t.props?u:Og(u)}}catch(D){Cl.length=0,ec(D,e,1),E=Ee(Rn)}let x=E;if(A&&w!==!1){const D=Object.keys(A),{shapeFlag:R}=x;D.length&&R&7&&(i&&D.some(Du)&&(A=Bg(A,i)),x=Sa(x,A,!1,!0))}return o.dirs&&(x=Sa(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(o.dirs):o.dirs),o.transition&&Ml(x,o.transition),E=x,$r(S),E}const Og=e=>{let t;for(const o in e)(o==="class"||o==="style"||Zr(o))&&((t||(t={}))[o]=e[o]);return t},Bg=(e,t)=>{const o={};for(const a in e)(!Du(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function Ng(e,t,o){const{props:a,children:s,component:i}=e,{props:r,children:u,patchFlag:d}=t,f=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?Hd(a,r,f):!!r;if(d&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const k=p[g];if(r[k]!==a[k]&&!oc(f,k))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:a===r?!1:a?r?Hd(a,r,f):!0:!!r;return!1}function Hd(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let s=0;s<a.length;s++){const i=a[s];if(t[i]!==e[i]&&!oc(o,i))return!0}return!1}function Fg({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const bp={},wp=()=>Object.create(bp),Cp=e=>Object.getPrototypeOf(e)===bp;function Ug(e,t,o,a=!1){const s={},i=wp();e.propsDefaults=Object.create(null),Lp(e,t,s,i);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);o?e.props=a?s:zf(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function zg(e,t,o,a){const{props:s,attrs:i,vnode:{patchFlag:r}}=e,u=Tt(s),[d]=e.propsOptions;let f=!1;if((a||r>0)&&!(r&16)){if(r&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let k=p[g];if(oc(e.emitsOptions,k))continue;const y=t[k];if(d)if(Dt(i,k))y!==i[k]&&(i[k]=y,f=!0);else{const _=Po(k);s[_]=ru(d,u,_,y,e,!1)}else y!==i[k]&&(i[k]=y,f=!0)}}}else{Lp(e,t,s,i)&&(f=!0);let p;for(const g in u)(!t||!Dt(t,g)&&((p=$a(g))===g||!Dt(t,p)))&&(d?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=ru(d,u,g,void 0,e,!0)):delete s[g]);if(i!==u)for(const g in i)(!t||!Dt(t,g))&&(delete i[g],f=!0)}f&&Ps(e.attrs,"set","")}function Lp(e,t,o,a){const[s,i]=e.propsOptions;let r=!1,u;if(t)for(let d in t){if(vl(d))continue;const f=t[d];let p;s&&Dt(s,p=Po(d))?!i||!i.includes(p)?o[p]=f:(u||(u={}))[p]=f:oc(e.emitsOptions,d)||(!(d in a)||f!==a[d])&&(a[d]=f,r=!0)}if(i){const d=Tt(o),f=u||Bt;for(let p=0;p<i.length;p++){const g=i[p];o[g]=ru(s,d,g,f[g],e,!Dt(f,g))}}return r}function ru(e,t,o,a,s,i){const r=e[o];if(r!=null){const u=Dt(r,"default");if(u&&a===void 0){const d=r.default;if(r.type!==Function&&!r.skipFactory&&dt(d)){const{propsDefaults:f}=s;if(o in f)a=f[o];else{const p=zl(s);a=f[o]=d.call(null,t),p()}}else a=d;s.ce&&s.ce._setProp(o,a)}r[0]&&(i&&!u?a=!1:r[1]&&(a===""||a===$a(o))&&(a=!0))}return a}const Hg=new WeakMap;function Sp(e,t,o=!1){const a=o?Hg:t.propsCache,s=a.get(e);if(s)return s;const i=e.props,r={},u=[];let d=!1;if(!dt(e)){const p=g=>{d=!0;const[k,y]=Sp(g,t,!0);hn(r,k),y&&u.push(...y)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!i&&!d)return Ot(e)&&a.set(e,Pi),Pi;if(it(i))for(let p=0;p<i.length;p++){const g=Po(i[p]);Vd(g)&&(r[g]=Bt)}else if(i)for(const p in i){const g=Po(p);if(Vd(g)){const k=i[p],y=r[g]=it(k)||dt(k)?{type:k}:hn({},k),_=y.type;let w=!1,S=!0;if(it(_))for(let E=0;E<_.length;++E){const A=_[E],x=dt(A)&&A.name;if(x==="Boolean"){w=!0;break}else x==="String"&&(S=!1)}else w=dt(_)&&_.name==="Boolean";y[0]=w,y[1]=S,(w||Dt(y,"default"))&&u.push(g)}}const f=[r,u];return Ot(e)&&a.set(e,f),f}function Vd(e){return e[0]!=="$"&&!vl(e)}const Zu=e=>e==="_"||e==="_ctx"||e==="$stable",qu=e=>it(e)?e.map(hs):[hs(e)],Vg=(e,t,o)=>{if(t._n)return t;const a=ze((...s)=>qu(t(...s)),o);return a._c=!1,a},xp=(e,t,o)=>{const a=e._ctx;for(const s in e){if(Zu(s))continue;const i=e[s];if(dt(i))t[s]=Vg(s,i,a);else if(i!=null){const r=qu(i);t[s]=()=>r}}},Ip=(e,t)=>{const o=qu(t);e.slots.default=()=>o},$p=(e,t,o)=>{for(const a in t)(o||!Zu(a))&&(e[a]=t[a])},Gg=(e,t,o)=>{const a=e.slots=wp();if(e.vnode.shapeFlag&32){const s=t._;s?($p(a,t,o),o&&_f(a,"_",s,!0)):xp(t,a)}else t&&Ip(e,t)},jg=(e,t,o)=>{const{vnode:a,slots:s}=e;let i=!0,r=Bt;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:$p(s,t,o):(i=!t.$stable,xp(t,s)),r=t}else t&&(Ip(e,t),r={default:1});if(i)for(const u in s)!Zu(u)&&r[u]==null&&delete s[u]},Wn=Jg;function Zg(e){return qg(e)}function qg(e,t){const o=Yr();o.__VUE__=!0;const{insert:a,remove:s,patchProp:i,createElement:r,createText:u,createComment:d,setText:f,setElementText:p,parentNode:g,nextSibling:k,setScopeId:y=Qo,insertStaticContent:_}=e,w=(q,J,ve,Se=null,re=null,ue=null,ee=void 0,W=null,ie=!!J.dynamicChildren)=>{if(q===J)return;q&&!Ja(q,J)&&(Se=ye(q),Re(q,re,ue,!0),q=null),J.patchFlag===-2&&(ie=!1,J.dynamicChildren=null);const{type:Le,ref:Ce,shapeFlag:ke}=J;switch(Le){case sc:S(q,J,ve,Se);break;case Rn:E(q,J,ve,Se);break;case wl:q==null&&A(J,ve,Se,ee);break;case Ie:G(q,J,ve,Se,re,ue,ee,W,ie);break;default:ke&1?R(q,J,ve,Se,re,ue,ee,W,ie):ke&6?Y(q,J,ve,Se,re,ue,ee,W,ie):(ke&64||ke&128)&&Le.process(q,J,ve,Se,re,ue,ee,W,ie,xe)}Ce!=null&&re?_l(Ce,q&&q.ref,ue,J||q,!J):Ce==null&&q&&q.ref!=null&&_l(q.ref,null,ue,q,!0)},S=(q,J,ve,Se)=>{if(q==null)a(J.el=u(J.children),ve,Se);else{const re=J.el=q.el;J.children!==q.children&&f(re,J.children)}},E=(q,J,ve,Se)=>{q==null?a(J.el=d(J.children||""),ve,Se):J.el=q.el},A=(q,J,ve,Se)=>{[q.el,q.anchor]=_(q.children,J,ve,Se,q.el,q.anchor)},x=({el:q,anchor:J},ve,Se)=>{let re;for(;q&&q!==J;)re=k(q),a(q,ve,Se),q=re;a(J,ve,Se)},D=({el:q,anchor:J})=>{let ve;for(;q&&q!==J;)ve=k(q),s(q),q=ve;s(J)},R=(q,J,ve,Se,re,ue,ee,W,ie)=>{if(J.type==="svg"?ee="svg":J.type==="math"&&(ee="mathml"),q==null)H(J,ve,Se,re,ue,ee,W,ie);else{const Le=q.el&&q.el._isVueCE?q.el:null;try{Le&&Le._beginPatch(),N(q,J,re,ue,ee,W,ie)}finally{Le&&Le._endPatch()}}},H=(q,J,ve,Se,re,ue,ee,W)=>{let ie,Le;const{props:Ce,shapeFlag:ke,transition:j,dirs:se}=q;if(ie=q.el=r(q.type,ue,Ce&&Ce.is,Ce),ke&8?p(ie,q.children):ke&16&&B(q.children,ie,null,Se,re,Bc(q,ue),ee,W),se&&Ga(q,null,Se,"created"),$(ie,q,q.scopeId,ee,Se),Ce){for(const Me in Ce)Me!=="value"&&!vl(Me)&&i(ie,Me,null,Ce[Me],ue,Se);"value"in Ce&&i(ie,"value",null,Ce.value,ue),(Le=Ce.onVnodeBeforeMount)&&cs(Le,Se,q)}se&&Ga(q,null,Se,"beforeMount");const de=Wg(re,j);de&&j.beforeEnter(ie),a(ie,J,ve),((Le=Ce&&Ce.onVnodeMounted)||de||se)&&Wn(()=>{Le&&cs(Le,Se,q),de&&j.enter(ie),se&&Ga(q,null,Se,"mounted")},re)},$=(q,J,ve,Se,re)=>{if(ve&&y(q,ve),Se)for(let ue=0;ue<Se.length;ue++)y(q,Se[ue]);if(re){let ue=re.subTree;if(J===ue||Ap(ue.type)&&(ue.ssContent===J||ue.ssFallback===J)){const ee=re.vnode;$(q,ee,ee.scopeId,ee.slotScopeIds,re.parent)}}},B=(q,J,ve,Se,re,ue,ee,W,ie=0)=>{for(let Le=ie;Le<q.length;Le++){const Ce=q[Le]=W?ma(q[Le]):hs(q[Le]);w(null,Ce,J,ve,Se,re,ue,ee,W)}},N=(q,J,ve,Se,re,ue,ee)=>{const W=J.el=q.el;let{patchFlag:ie,dynamicChildren:Le,dirs:Ce}=J;ie|=q.patchFlag&16;const ke=q.props||Bt,j=J.props||Bt;let se;if(ve&&ja(ve,!1),(se=j.onVnodeBeforeUpdate)&&cs(se,ve,J,q),Ce&&Ga(J,q,ve,"beforeUpdate"),ve&&ja(ve,!0),(ke.innerHTML&&j.innerHTML==null||ke.textContent&&j.textContent==null)&&p(W,""),Le?Z(q.dynamicChildren,Le,W,ve,Se,Bc(J,re),ue):ee||F(q,J,W,null,ve,Se,Bc(J,re),ue,!1),ie>0){if(ie&16)P(W,ke,j,ve,re);else if(ie&2&&ke.class!==j.class&&i(W,"class",null,j.class,re),ie&4&&i(W,"style",ke.style,j.style,re),ie&8){const de=J.dynamicProps;for(let Me=0;Me<de.length;Me++){const Oe=de[Me],Be=ke[Oe],Ye=j[Oe];(Ye!==Be||Oe==="value")&&i(W,Oe,Be,Ye,re,ve)}}ie&1&&q.children!==J.children&&p(W,J.children)}else!ee&&Le==null&&P(W,ke,j,ve,re);((se=j.onVnodeUpdated)||Ce)&&Wn(()=>{se&&cs(se,ve,J,q),Ce&&Ga(J,q,ve,"updated")},Se)},Z=(q,J,ve,Se,re,ue,ee)=>{for(let W=0;W<J.length;W++){const ie=q[W],Le=J[W],Ce=ie.el&&(ie.type===Ie||!Ja(ie,Le)||ie.shapeFlag&198)?g(ie.el):ve;w(ie,Le,Ce,null,Se,re,ue,ee,!0)}},P=(q,J,ve,Se,re)=>{if(J!==ve){if(J!==Bt)for(const ue in J)!vl(ue)&&!(ue in ve)&&i(q,ue,J[ue],null,re,Se);for(const ue in ve){if(vl(ue))continue;const ee=ve[ue],W=J[ue];ee!==W&&ue!=="value"&&i(q,ue,W,ee,re,Se)}"value"in ve&&i(q,"value",J.value,ve.value,re)}},G=(q,J,ve,Se,re,ue,ee,W,ie)=>{const Le=J.el=q?q.el:u(""),Ce=J.anchor=q?q.anchor:u("");let{patchFlag:ke,dynamicChildren:j,slotScopeIds:se}=J;se&&(W=W?W.concat(se):se),q==null?(a(Le,ve,Se),a(Ce,ve,Se),B(J.children||[],ve,Ce,re,ue,ee,W,ie)):ke>0&&ke&64&&j&&q.dynamicChildren&&q.dynamicChildren.length===j.length?(Z(q.dynamicChildren,j,ve,re,ue,ee,W),(J.key!=null||re&&J===re.subTree)&&Wu(q,J,!0)):F(q,J,ve,Ce,re,ue,ee,W,ie)},Y=(q,J,ve,Se,re,ue,ee,W,ie)=>{J.slotScopeIds=W,q==null?J.shapeFlag&512?re.ctx.activate(J,ve,Se,ee,ie):te(J,ve,Se,re,ue,ee,ie):Q(q,J,ie)},te=(q,J,ve,Se,re,ue,ee)=>{const W=q.component=ny(q,Se,re);if(tc(q)&&(W.ctx.renderer=xe),oy(W,!1,ee),W.asyncDep){if(re&&re.registerDep(W,X,ee),!q.el){const ie=W.subTree=Ee(Rn);E(null,ie,J,ve),q.placeholder=ie.el}}else X(W,q,J,ve,re,ue,ee)},Q=(q,J,ve)=>{const Se=J.component=q.component;if(Ng(q,J,ve))if(Se.asyncDep&&!Se.asyncResolved){ne(Se,J,ve);return}else Se.next=J,Se.update();else J.el=q.el,Se.vnode=J},X=(q,J,ve,Se,re,ue,ee)=>{const W=()=>{if(q.isMounted){let{next:ke,bu:j,u:se,parent:de,vnode:Me}=q;{const _t=Tp(q);if(_t){ke&&(ke.el=Me.el,ne(q,ke,ee)),_t.asyncDep.then(()=>{q.isUnmounted||W()});return}}let Oe=ke,Be;ja(q,!1),ke?(ke.el=Me.el,ne(q,ke,ee)):ke=Me,j&&vr(j),(Be=ke.props&&ke.props.onVnodeBeforeUpdate)&&cs(Be,de,ke,Me),ja(q,!0);const Ye=zd(q),mt=q.subTree;q.subTree=Ye,w(mt,Ye,g(mt.el),ye(mt),q,re,ue),ke.el=Ye.el,Oe===null&&Fg(q,Ye.el),se&&Wn(se,re),(Be=ke.props&&ke.props.onVnodeUpdated)&&Wn(()=>cs(Be,de,ke,Me),re)}else{let ke;const{el:j,props:se}=J,{bm:de,m:Me,parent:Oe,root:Be,type:Ye}=q,mt=Oi(J);ja(q,!1),de&&vr(de),!mt&&(ke=se&&se.onVnodeBeforeMount)&&cs(ke,Oe,J),ja(q,!0);{Be.ce&&Be.ce._def.shadowRoot!==!1&&Be.ce._injectChildStyle(Ye);const _t=q.subTree=zd(q);w(null,_t,ve,Se,q,re,ue),J.el=_t.el}if(Me&&Wn(Me,re),!mt&&(ke=se&&se.onVnodeMounted)){const _t=J;Wn(()=>cs(ke,Oe,_t),re)}(J.shapeFlag&256||Oe&&Oi(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&q.a&&Wn(q.a,re),q.isMounted=!0,J=ve=Se=null}};q.scope.on();const ie=q.effect=new If(W);q.scope.off();const Le=q.update=ie.run.bind(ie),Ce=q.job=ie.runIfDirty.bind(ie);Ce.i=q,Ce.id=q.uid,ie.scheduler=()=>Gu(Ce),ja(q,!0),Le()},ne=(q,J,ve)=>{J.component=q;const Se=q.vnode.props;q.vnode=J,q.next=null,zg(q,J.props,Se,ve),jg(q,J.children,ve),Us(),Md(q),zs()},F=(q,J,ve,Se,re,ue,ee,W,ie=!1)=>{const Le=q&&q.children,Ce=q?q.shapeFlag:0,ke=J.children,{patchFlag:j,shapeFlag:se}=J;if(j>0){if(j&128){fe(Le,ke,ve,Se,re,ue,ee,W,ie);return}else if(j&256){K(Le,ke,ve,Se,re,ue,ee,W,ie);return}}se&8?(Ce&16&&Ke(Le,re,ue),ke!==Le&&p(ve,ke)):Ce&16?se&16?fe(Le,ke,ve,Se,re,ue,ee,W,ie):Ke(Le,re,ue,!0):(Ce&8&&p(ve,""),se&16&&B(ke,ve,Se,re,ue,ee,W,ie))},K=(q,J,ve,Se,re,ue,ee,W,ie)=>{q=q||Pi,J=J||Pi;const Le=q.length,Ce=J.length,ke=Math.min(Le,Ce);let j;for(j=0;j<ke;j++){const se=J[j]=ie?ma(J[j]):hs(J[j]);w(q[j],se,ve,null,re,ue,ee,W,ie)}Le>Ce?Ke(q,re,ue,!0,!1,ke):B(J,ve,Se,re,ue,ee,W,ie,ke)},fe=(q,J,ve,Se,re,ue,ee,W,ie)=>{let Le=0;const Ce=J.length;let ke=q.length-1,j=Ce-1;for(;Le<=ke&&Le<=j;){const se=q[Le],de=J[Le]=ie?ma(J[Le]):hs(J[Le]);if(Ja(se,de))w(se,de,ve,null,re,ue,ee,W,ie);else break;Le++}for(;Le<=ke&&Le<=j;){const se=q[ke],de=J[j]=ie?ma(J[j]):hs(J[j]);if(Ja(se,de))w(se,de,ve,null,re,ue,ee,W,ie);else break;ke--,j--}if(Le>ke){if(Le<=j){const se=j+1,de=se<Ce?J[se].el:Se;for(;Le<=j;)w(null,J[Le]=ie?ma(J[Le]):hs(J[Le]),ve,de,re,ue,ee,W,ie),Le++}}else if(Le>j)for(;Le<=ke;)Re(q[Le],re,ue,!0),Le++;else{const se=Le,de=Le,Me=new Map;for(Le=de;Le<=j;Le++){const wt=J[Le]=ie?ma(J[Le]):hs(J[Le]);wt.key!=null&&Me.set(wt.key,Le)}let Oe,Be=0;const Ye=j-de+1;let mt=!1,_t=0;const bt=new Array(Ye);for(Le=0;Le<Ye;Le++)bt[Le]=0;for(Le=se;Le<=ke;Le++){const wt=q[Le];if(Be>=Ye){Re(wt,re,ue,!0);continue}let Nt;if(wt.key!=null)Nt=Me.get(wt.key);else for(Oe=de;Oe<=j;Oe++)if(bt[Oe-de]===0&&Ja(wt,J[Oe])){Nt=Oe;break}Nt===void 0?Re(wt,re,ue,!0):(bt[Nt-de]=Le+1,Nt>=_t?_t=Nt:mt=!0,w(wt,J[Nt],ve,null,re,ue,ee,W,ie),Be++)}const Mt=mt?Kg(bt):Pi;for(Oe=Mt.length-1,Le=Ye-1;Le>=0;Le--){const wt=de+Le,Nt=J[wt],Ft=J[wt+1],Fn=wt+1<Ce?Ft.el||Mp(Ft):Se;bt[Le]===0?w(null,Nt,ve,Fn,re,ue,ee,W,ie):mt&&(Oe<0||Le!==Mt[Oe]?he(Nt,ve,Fn,2):Oe--)}}},he=(q,J,ve,Se,re=null)=>{const{el:ue,type:ee,transition:W,children:ie,shapeFlag:Le}=q;if(Le&6){he(q.component.subTree,J,ve,Se);return}if(Le&128){q.suspense.move(J,ve,Se);return}if(Le&64){ee.move(q,J,ve,xe);return}if(ee===Ie){a(ue,J,ve);for(let ke=0;ke<ie.length;ke++)he(ie[ke],J,ve,Se);a(q.anchor,J,ve);return}if(ee===wl){x(q,J,ve);return}if(Se!==2&&Le&1&&W)if(Se===0)W.beforeEnter(ue),a(ue,J,ve),Wn(()=>W.enter(ue),re);else{const{leave:ke,delayLeave:j,afterLeave:se}=W,de=()=>{q.ctx.isUnmounted?s(ue):a(ue,J,ve)},Me=()=>{ue._isLeaving&&ue[As](!0),ke(ue,()=>{de(),se&&se()})};j?j(ue,de,Me):Me()}else a(ue,J,ve)},Re=(q,J,ve,Se=!1,re=!1)=>{const{type:ue,props:ee,ref:W,children:ie,dynamicChildren:Le,shapeFlag:Ce,patchFlag:ke,dirs:j,cacheIndex:se}=q;if(ke===-2&&(re=!1),W!=null&&(Us(),_l(W,null,ve,q,!0),zs()),se!=null&&(J.renderCache[se]=void 0),Ce&256){J.ctx.deactivate(q);return}const de=Ce&1&&j,Me=!Oi(q);let Oe;if(Me&&(Oe=ee&&ee.onVnodeBeforeUnmount)&&cs(Oe,J,q),Ce&6)He(q.component,ve,Se);else{if(Ce&128){q.suspense.unmount(ve,Se);return}de&&Ga(q,null,J,"beforeUnmount"),Ce&64?q.type.remove(q,J,ve,xe,Se):Le&&!Le.hasOnce&&(ue!==Ie||ke>0&&ke&64)?Ke(Le,J,ve,!1,!0):(ue===Ie&&ke&384||!re&&Ce&16)&&Ke(ie,J,ve),Se&&et(q)}(Me&&(Oe=ee&&ee.onVnodeUnmounted)||de)&&Wn(()=>{Oe&&cs(Oe,J,q),de&&Ga(q,null,J,"unmounted")},ve)},et=q=>{const{type:J,el:ve,anchor:Se,transition:re}=q;if(J===Ie){Xe(ve,Se);return}if(J===wl){D(q);return}const ue=()=>{s(ve),re&&!re.persisted&&re.afterLeave&&re.afterLeave()};if(q.shapeFlag&1&&re&&!re.persisted){const{leave:ee,delayLeave:W}=re,ie=()=>ee(ve,ue);W?W(q.el,ue,ie):ie()}else ue()},Xe=(q,J)=>{let ve;for(;q!==J;)ve=k(q),s(q),q=ve;s(J)},He=(q,J,ve)=>{const{bum:Se,scope:re,job:ue,subTree:ee,um:W,m:ie,a:Le}=q;Gd(ie),Gd(Le),Se&&vr(Se),re.stop(),ue&&(ue.flags|=8,Re(ee,q,J,ve)),W&&Wn(W,J),Wn(()=>{q.isUnmounted=!0},J)},Ke=(q,J,ve,Se=!1,re=!1,ue=0)=>{for(let ee=ue;ee<q.length;ee++)Re(q[ee],J,ve,Se,re)},ye=q=>{if(q.shapeFlag&6)return ye(q.component.subTree);if(q.shapeFlag&128)return q.suspense.next();const J=k(q.anchor||q.el),ve=J&&J[Xf];return ve?k(ve):J};let Ve=!1;const me=(q,J,ve)=>{let Se;q==null?J._vnode&&(Re(J._vnode,null,null,!0),Se=J._vnode.component):w(J._vnode||null,q,J,null,null,null,ve),J._vnode=q,Ve||(Ve=!0,Md(Se),qf(),Ve=!1)},xe={p:w,um:Re,m:he,r:et,mt:te,mc:B,pc:F,pbc:Z,n:ye,o:e};return{render:me,hydrate:void 0,createApp:Eg(me)}}function Bc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function ja({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Wg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Wu(e,t,o=!1){const a=e.children,s=t.children;if(it(a)&&it(s))for(let i=0;i<a.length;i++){const r=a[i];let u=s[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[i]=ma(s[i]),u.el=r.el),!o&&u.patchFlag!==-2&&Wu(r,u)),u.type===sc&&(u.patchFlag!==-1?u.el=r.el:u.__elIndex=i+(e.type===Ie?1:0)),u.type===Rn&&!u.el&&(u.el=r.el)}}function Kg(e){const t=e.slice(),o=[0];let a,s,i,r,u;const d=e.length;for(a=0;a<d;a++){const f=e[a];if(f!==0){if(s=o[o.length-1],e[s]<f){t[a]=s,o.push(a);continue}for(i=0,r=o.length-1;i<r;)u=i+r>>1,e[o[u]]<f?i=u+1:r=u;f<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,r=o[i-1];i-- >0;)o[i]=r,r=t[r];return o}function Tp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Tp(t)}function Gd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Mp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Mp(t.subTree):null}const Ap=e=>e.__isSuspense;function Jg(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):Zf(e)}const Ie=Symbol.for("v-fgt"),sc=Symbol.for("v-txt"),Rn=Symbol.for("v-cmt"),wl=Symbol.for("v-stc"),Cl=[];let bo=null;function v(e=!1){Cl.push(bo=e?null:[])}function Yg(){Cl.pop(),bo=Cl[Cl.length-1]||null}let Al=1;function Ar(e,t=!1){Al+=e,e<0&&bo&&t&&(bo.hasOnce=!0)}function Ep(e){return e.dynamicChildren=Al>0?bo||Pi:null,Yg(),Al>0&&bo&&bo.push(e),e}function m(e,t,o,a,s,i){return Ep(l(e,t,o,a,s,i,!0))}function qe(e,t,o,a,s){return Ep(Ee(e,t,o,a,s,!0))}function El(e){return e?e.__v_isVNode===!0:!1}function Ja(e,t){return e.type===t.type&&e.key===t.key}const Pp=({key:e})=>e??null,gr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Xt(e)||Yt(e)||dt(e)?{i:Sn,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,a=0,s=null,i=e===Ie?0:1,r=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Pp(t),ref:t&&gr(t),scopeId:Kf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Sn};return u?(Ku(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=Xt(o)?8:16),Al>0&&!r&&bo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&bo.push(d),d}const Ee=Xg;function Xg(e,t=null,o=null,a=0,s=null,i=!1){if((!e||e===fp)&&(e=Rn),El(e)){const u=Sa(e,t,!0);return o&&Ku(u,o),Al>0&&!i&&bo&&(u.shapeFlag&6?bo[bo.indexOf(e)]=u:bo.push(u)),u.patchFlag=-2,u}if(ry(e)&&(e=e.__vccOpts),t){t=Qg(t);let{class:u,style:d}=t;u&&!Xt(u)&&(t.class=pe(u)),Ot(d)&&(Qr(d)&&!it(d)&&(d=hn({},d)),t.style=Qe(d))}const r=Xt(e)?1:Ap(e)?128:Qf(e)?64:Ot(e)?4:dt(e)?2:0;return l(e,t,o,a,s,r,i,!0)}function Qg(e){return e?Qr(e)||Cp(e)?hn({},e):e:null}function Sa(e,t,o=!1,a=!1){const{props:s,ref:i,patchFlag:r,children:u,transition:d}=e,f=t?Dp(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&Pp(f),ref:t&&t.ref?o&&i?it(i)?i.concat(gr(t)):[i,gr(t)]:gr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ie?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Sa(e.ssContent),ssFallback:e.ssFallback&&Sa(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Ml(p,d.clone(p)),p}function Je(e=" ",t=0){return Ee(sc,null,e,t)}function Er(e,t){const o=Ee(wl,null,e);return o.staticCount=t,o}function M(e="",t=!1){return t?(v(),qe(Rn,null,e)):Ee(Rn,null,e)}function hs(e){return e==null||typeof e=="boolean"?Ee(Rn):it(e)?Ee(Ie,null,e.slice()):El(e)?ma(e):Ee(sc,null,String(e))}function ma(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Sa(e)}function Ku(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(it(t))o=16;else if(typeof t=="object")if(a&65){const s=t.default;s&&(s._c&&(s._d=!1),Ku(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Cp(t)?t._ctx=Sn:s===3&&Sn&&(Sn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else dt(t)?(t={default:t,_ctx:Sn},o=32):(t=String(t),a&64?(o=16,t=[Je(t)]):o=8);e.children=t,e.shapeFlag|=o}function Dp(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const s in a)if(s==="class")t.class!==a.class&&(t.class=pe([t.class,a.class]));else if(s==="style")t.style=Qe([t.style,a.style]);else if(Zr(s)){const i=t[s],r=a[s];r&&i!==r&&!(it(i)&&i.includes(r))&&(t[s]=i?[].concat(i,r):r)}else s!==""&&(t[s]=a[s])}return t}function cs(e,t,o,a=null){os(e,t,7,[o,a])}const ey=kp();let ty=0;function ny(e,t,o){const a=e.type,s=(t?t.appContext:e.appContext)||ey,i={uid:ty++,vnode:e,type:a,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Lf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sp(a,s),emitsOptions:_p(a,s),emit:null,emitted:null,propsDefaults:Bt,inheritAttrs:a.inheritAttrs,ctx:Bt,data:Bt,props:Bt,attrs:Bt,slots:Bt,refs:Bt,setupState:Bt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Dg.bind(null,i),e.ce&&e.ce(i),i}let On=null;const ac=()=>On||Sn;let Pr,cu;{const e=Yr(),t=(o,a)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(a),i=>{s.length>1?s.forEach(r=>r(i)):s[0](i)}};Pr=t("__VUE_INSTANCE_SETTERS__",o=>On=o),cu=t("__VUE_SSR_SETTERS__",o=>Pl=o)}const zl=e=>{const t=On;return Pr(e),e.scope.on(),()=>{e.scope.off(),Pr(t)}},jd=()=>{On&&On.scope.off(),Pr(null)};function Rp(e){return e.vnode.shapeFlag&4}let Pl=!1;function oy(e,t=!1,o=!1){t&&cu(t);const{props:a,children:s}=e.vnode,i=Rp(e);Ug(e,a,i,t),Gg(e,s,o||t);const r=i?sy(e,t):void 0;return t&&cu(!1),r}function sy(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Sg);const{setup:a}=o;if(a){Us();const s=e.setupContext=a.length>1?iy(e):null,i=zl(e),r=Ul(a,e,0,[e.props,s]),u=gf(r);if(zs(),i(),(u||e.sp)&&!Oi(e)&&rp(e),u){if(r.then(jd,jd),t)return r.then(d=>{Zd(e,d)}).catch(d=>{ec(d,e,0)});e.asyncDep=r}else Zd(e,r)}else Op(e)}function Zd(e,t,o){dt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=Vf(t)),Op(e)}function Op(e,t,o){const a=e.type;e.render||(e.render=a.render||Qo);{const s=zl(e);Us();try{xg(e)}finally{zs(),s()}}}const ay={get(e,t){return Dn(e,"get",""),e[t]}};function iy(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,ay),slots:e.slots,emit:e.emit,expose:t}}function ic(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Vf(Vu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in bl)return bl[o](e)},has(t,o){return o in t||o in bl}})):e.proxy}function ly(e,t=!0){return dt(e)?e.displayName||e.name:e.name||t&&e.__name}function ry(e){return dt(e)&&"__vccOpts"in e}const V=(e,t)=>ng(e,t,Pl);function Ju(e,t,o){try{Ar(-1);const a=arguments.length;return a===2?Ot(t)&&!it(t)?El(t)?Ee(e,null,[t]):Ee(e,t):Ee(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&El(o)&&(o=[o]),Ee(e,t,o))}finally{Ar(1)}}const cy="3.5.26";let uu;const qd=typeof window<"u"&&window.trustedTypes;if(qd)try{uu=qd.createPolicy("vue",{createHTML:e=>e})}catch{}const Bp=uu?e=>uu.createHTML(e):e=>e,uy="http://www.w3.org/2000/svg",dy="http://www.w3.org/1998/Math/MathML",Ms=typeof document<"u"?document:null,Wd=Ms&&Ms.createElement("template"),hy={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const s=t==="svg"?Ms.createElementNS(uy,e):t==="mathml"?Ms.createElementNS(dy,e):o?Ms.createElement(e,{is:o}):Ms.createElement(e);return e==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:e=>Ms.createTextNode(e),createComment:e=>Ms.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ms.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,s,i){const r=o?o.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===i||!(s=s.nextSibling)););else{Wd.innerHTML=Bp(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=Wd.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[r?r.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ua="transition",ll="animation",Dl=Symbol("_vtc"),Np={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},fy=hn({},np,Np),py=e=>(e.displayName="Transition",e.props=fy,e),gs=py((e,{slots:t})=>Ju(pg,vy(e),t)),Za=(e,t=[])=>{it(e)?e.forEach(o=>o(...t)):e&&e(...t)},Kd=e=>e?it(e)?e.some(t=>t.length>1):e.length>1:!1;function vy(e){const t={};for(const G in e)G in Np||(t[G]=e[G]);if(e.css===!1)return t;const{name:o="v",type:a,duration:s,enterFromClass:i=`${o}-enter-from`,enterActiveClass:r=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:f=r,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:k=`${o}-leave-active`,leaveToClass:y=`${o}-leave-to`}=e,_=my(s),w=_&&_[0],S=_&&_[1],{onBeforeEnter:E,onEnter:A,onEnterCancelled:x,onLeave:D,onLeaveCancelled:R,onBeforeAppear:H=E,onAppear:$=A,onAppearCancelled:B=x}=t,N=(G,Y,te,Q)=>{G._enterCancelled=Q,qa(G,Y?p:u),qa(G,Y?f:r),te&&te()},Z=(G,Y)=>{G._isLeaving=!1,qa(G,g),qa(G,y),qa(G,k),Y&&Y()},P=G=>(Y,te)=>{const Q=G?$:A,X=()=>N(Y,G,te);Za(Q,[Y,X]),Jd(()=>{qa(Y,G?d:i),$s(Y,G?p:u),Kd(Q)||Yd(Y,a,w,X)})};return hn(t,{onBeforeEnter(G){Za(E,[G]),$s(G,i),$s(G,r)},onBeforeAppear(G){Za(H,[G]),$s(G,d),$s(G,f)},onEnter:P(!1),onAppear:P(!0),onLeave(G,Y){G._isLeaving=!0;const te=()=>Z(G,Y);$s(G,g),G._enterCancelled?($s(G,k),eh(G)):(eh(G),$s(G,k)),Jd(()=>{G._isLeaving&&(qa(G,g),$s(G,y),Kd(D)||Yd(G,a,S,te))}),Za(D,[G,te])},onEnterCancelled(G){N(G,!1,void 0,!0),Za(x,[G])},onAppearCancelled(G){N(G,!0,void 0,!0),Za(B,[G])},onLeaveCancelled(G){Z(G),Za(R,[G])}})}function my(e){if(e==null)return null;if(Ot(e))return[Nc(e.enter),Nc(e.leave)];{const t=Nc(e);return[t,t]}}function Nc(e){return _m(e)}function $s(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Dl]||(e[Dl]=new Set)).add(t)}function qa(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Dl];o&&(o.delete(t),o.size||(e[Dl]=void 0))}function Jd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let gy=0;function Yd(e,t,o,a){const s=e._endId=++gy,i=()=>{s===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:r,timeout:u,propCount:d}=yy(e,t);if(!r)return a();const f=r+"end";let p=0;const g=()=>{e.removeEventListener(f,k),i()},k=y=>{y.target===e&&++p>=d&&g()};setTimeout(()=>{p<d&&g()},u+1),e.addEventListener(f,k)}function yy(e,t){const o=window.getComputedStyle(e),a=_=>(o[_]||"").split(", "),s=a(`${ua}Delay`),i=a(`${ua}Duration`),r=Xd(s,i),u=a(`${ll}Delay`),d=a(`${ll}Duration`),f=Xd(u,d);let p=null,g=0,k=0;t===ua?r>0&&(p=ua,g=r,k=i.length):t===ll?f>0&&(p=ll,g=f,k=d.length):(g=Math.max(r,f),p=g>0?r>f?ua:ll:null,k=p?p===ua?i.length:d.length:0);const y=p===ua&&/\b(?:transform|all)(?:,|$)/.test(a(`${ua}Property`).toString());return{type:p,timeout:g,propCount:k,hasTransform:y}}function Xd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>Qd(o)+Qd(e[a])))}function Qd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function eh(e){return(e?e.ownerDocument:document).body.offsetHeight}function ky(e,t,o){const a=e[Dl];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Dr=Symbol("_vod"),Fp=Symbol("_vsh"),ys={name:"show",beforeMount(e,{value:t},{transition:o}){e[Dr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):rl(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),rl(e,!0),a.enter(e)):a.leave(e,()=>{rl(e,!1)}):rl(e,t))},beforeUnmount(e,{value:t}){rl(e,t)}};function rl(e,t){e.style.display=t?e[Dr]:"none",e[Fp]=!t}const Up=Symbol("");function _y(e){const t=ac();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Rr(i,s))},a=()=>{const s=e(t.proxy);t.ce?Rr(t.ce,s):du(t.subTree,s),o(s)};up(()=>{Zf(a)}),nn(()=>{Ze(a,Qo,{flush:"post"});const s=new MutationObserver(a);s.observe(t.subTree.el.parentNode,{childList:!0}),xn(()=>s.disconnect())})}function du(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{du(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Rr(e.el,t);else if(e.type===Ie)e.children.forEach(o=>du(o,t));else if(e.type===wl){let{el:o,anchor:a}=e;for(;o&&(Rr(o,t),o!==a);)o=o.nextSibling}}function Rr(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const s in t){const i=$m(t[s]);o.setProperty(`--${s}`,i),a+=`--${s}: ${i};`}o[Up]=a}}const by=/(?:^|;)\s*display\s*:/;function wy(e,t,o){const a=e.style,s=Xt(o);let i=!1;if(o&&!s){if(t)if(Xt(t))for(const r of t.split(";")){const u=r.slice(0,r.indexOf(":")).trim();o[u]==null&&yr(a,u,"")}else for(const r in t)o[r]==null&&yr(a,r,"");for(const r in o)r==="display"&&(i=!0),yr(a,r,o[r])}else if(s){if(t!==o){const r=a[Up];r&&(o+=";"+r),a.cssText=o,i=by.test(o)}}else t&&e.removeAttribute("style");Dr in e&&(e[Dr]=i?a.display:"",e[Fp]&&(a.display="none"))}const th=/\s*!important$/;function yr(e,t,o){if(it(o))o.forEach(a=>yr(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Cy(e,t);th.test(o)?e.setProperty($a(a),o.replace(th,""),"important"):e[a]=o}}const nh=["Webkit","Moz","ms"],Fc={};function Cy(e,t){const o=Fc[t];if(o)return o;let a=Po(t);if(a!=="filter"&&a in e)return Fc[t]=a;a=Kr(a);for(let s=0;s<nh.length;s++){const i=nh[s]+a;if(i in e)return Fc[t]=i}return t}const oh="http://www.w3.org/1999/xlink";function sh(e,t,o,a,s,i=xm(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(oh,t.slice(6,t.length)):e.setAttributeNS(oh,t,o):o==null||i&&!bf(o)?e.removeAttribute(t):e.setAttribute(t,i?"":ts(o)?String(o):o)}function ah(e,t,o,a,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Bp(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let r=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=bf(o):o==null&&u==="string"?(o="",r=!0):u==="number"&&(o=0,r=!0)}try{e[t]=o}catch{}r&&e.removeAttribute(s||t)}function Rs(e,t,o,a){e.addEventListener(t,o,a)}function Ly(e,t,o,a){e.removeEventListener(t,o,a)}const ih=Symbol("_vei");function Sy(e,t,o,a,s=null){const i=e[ih]||(e[ih]={}),r=i[t];if(a&&r)r.value=a;else{const[u,d]=xy(t);if(a){const f=i[t]=Ty(a,s);Rs(e,u,f,d)}else r&&(Ly(e,u,r,d),i[t]=void 0)}}const lh=/(?:Once|Passive|Capture)$/;function xy(e){let t;if(lh.test(e)){t={};let a;for(;a=e.match(lh);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):$a(e.slice(2)),t]}let Uc=0;const Iy=Promise.resolve(),$y=()=>Uc||(Iy.then(()=>Uc=0),Uc=Date.now());function Ty(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;os(My(a,o.value),t,5,[a])};return o.value=e,o.attached=$y(),o}function My(e,t){if(it(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>s=>!s._stopped&&a&&a(s))}else return t}const rh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ay=(e,t,o,a,s,i)=>{const r=s==="svg";t==="class"?ky(e,a,r):t==="style"?wy(e,o,a):Zr(t)?Du(t)||Sy(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Ey(e,t,a,r))?(ah(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&sh(e,t,a,r,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Xt(a))?ah(e,Po(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),sh(e,t,a,r))};function Ey(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&rh(t)&&dt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return rh(t)&&Xt(o)?!1:t in e}const xa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?o=>vr(t,o):t};function Py(e){e.target.composing=!0}function ch(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Eo=Symbol("_assign");function uh(e,t,o){return t&&(e=e.trim()),o&&(e=Jr(e)),e}const st={created(e,{modifiers:{lazy:t,trim:o,number:a}},s){e[Eo]=xa(s);const i=a||s.props&&s.props.type==="number";Rs(e,t?"change":"input",r=>{r.target.composing||e[Eo](uh(e.value,o,i))}),(o||i)&&Rs(e,"change",()=>{e.value=uh(e.value,o,i)}),t||(Rs(e,"compositionstart",Py),Rs(e,"compositionend",ch),Rs(e,"change",ch))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:s,number:i}},r){if(e[Eo]=xa(r),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Jr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Ia={deep:!0,created(e,t,o){e[Eo]=xa(o),Rs(e,"change",()=>{const a=e._modelValue,s=Fi(e),i=e.checked,r=e[Eo];if(it(a)){const u=Ou(a,s),d=u!==-1;if(i&&!d)r(a.concat(s));else if(!i&&d){const f=[...a];f.splice(u,1),r(f)}}else if(Vi(a)){const u=new Set(a);i?u.add(s):u.delete(s),r(u)}else r(zp(e,i))})},mounted:dh,beforeUpdate(e,t,o){e[Eo]=xa(o),dh(e,t,o)}};function dh(e,{value:t,oldValue:o},a){e._modelValue=t;let s;if(it(t))s=Ou(t,a.props.value)>-1;else if(Vi(t))s=t.has(a.props.value);else{if(t===o)return;s=ai(t,zp(e,!0))}e.checked!==s&&(e.checked=s)}const hh={created(e,{value:t},o){e.checked=ai(t,o.props.value),e[Eo]=xa(o),Rs(e,"change",()=>{e[Eo](Fi(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Eo]=xa(a),t!==o&&(e.checked=ai(t,a.props.value))}},Bn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const s=Vi(t);Rs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,r=>r.selected).map(r=>o?Jr(Fi(r)):Fi(r));e[Eo](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[Eo]=xa(a)},mounted(e,{value:t}){fh(e,t)},beforeUpdate(e,t,o){e[Eo]=xa(o)},updated(e,{value:t}){e._assigning||fh(e,t)}};function fh(e,t){const o=e.multiple,a=it(t);if(!(o&&!a&&!Vi(t))){for(let s=0,i=e.options.length;s<i;s++){const r=e.options[s],u=Fi(r);if(o)if(a){const d=typeof u;d==="string"||d==="number"?r.selected=t.some(f=>String(f)===String(u)):r.selected=Ou(t,u)>-1}else r.selected=t.has(u);else if(ai(Fi(r),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Fi(e){return"_value"in e?e._value:e.value}function zp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Dy=["ctrl","shift","alt","meta"],Ry={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Dy.some(o=>e[`${o}Key`]&&!t.includes(o))},rt=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((s,...i)=>{for(let r=0;r<t.length;r++){const u=Ry[t[r]];if(u&&u(s,t))return}return e(s,...i)}))},Oy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ps=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(s=>{if(!("key"in s))return;const i=$a(s.key);if(t.some(r=>r===i||Oy[r]===i))return e(s)}))},By=hn({patchProp:Ay},hy);let ph;function Ny(){return ph||(ph=Zg(By))}const Fy=((...e)=>{const t=Ny().createApp(...e),{mount:o}=t;return t.mount=a=>{const s=zy(a);if(!s)return;const i=t._component;!dt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const r=o(s,!1,Uy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t});function Uy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zy(e){return Xt(e)?document.querySelector(e):e}let Hp;const lc=e=>Hp=e,Vp=Symbol();function hu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Ll;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Ll||(Ll={}));function Hy(){const e=Sf(!0),t=e.run(()=>T({}));let o=[],a=[];const s=Vu({install(i){lc(s),s._a=i,i.provide(Vp,s),i.config.globalProperties.$pinia=s,a.forEach(r=>o.push(r)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Gp=()=>{};function vh(e,t,o,a=Gp){e.add(t);const s=()=>{e.delete(t)&&a()};return!o&&xf()&&Tm(s),s}function Ii(e,...t){e.forEach(o=>{o(...t)})}const Vy=e=>e(),mh=Symbol(),zc=Symbol();function fu(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],s=e[o];hu(s)&&hu(a)&&e.hasOwnProperty(o)&&!Yt(a)&&!Fs(a)?e[o]=fu(s,a):e[o]=a}return e}const Gy=Symbol();function jy(e){return!hu(e)||!Object.prototype.hasOwnProperty.call(e,Gy)}const{assign:ha}=Object;function Zy(e){return!!(Yt(e)&&e.effect)}function qy(e,t,o,a){const{state:s,actions:i,getters:r}=t,u=o.state.value[e];let d;function f(){u||(o.state.value[e]=s?s():{});const p=Xm(o.state.value[e]);return ha(p,i,Object.keys(r||{}).reduce((g,k)=>(g[k]=Vu(V(()=>{lc(o);const y=o._s.get(e);return r[k].call(y,y)})),g),{}))}return d=jp(e,f,t,o,a,!0),d}function jp(e,t,o={},a,s,i){let r;const u=ha({actions:{}},o),d={deep:!0};let f,p,g=new Set,k=new Set,y;const _=a.state.value[e];!i&&!_&&(a.state.value[e]={}),T({});let w;function S(B){let N;f=p=!1,typeof B=="function"?(B(a.state.value[e]),N={type:Ll.patchFunction,storeId:e,events:y}):(fu(a.state.value[e],B),N={type:Ll.patchObject,payload:B,storeId:e,events:y});const Z=w=Symbol();cn().then(()=>{w===Z&&(f=!0)}),p=!0,Ii(g,N,a.state.value[e])}const E=i?function(){const{state:N}=o,Z=N?N():{};this.$patch(P=>{ha(P,Z)})}:Gp;function A(){r.stop(),g.clear(),k.clear(),a._s.delete(e)}const x=(B,N="")=>{if(mh in B)return B[zc]=N,B;const Z=function(){lc(a);const P=Array.from(arguments),G=new Set,Y=new Set;function te(ne){G.add(ne)}function Q(ne){Y.add(ne)}Ii(k,{args:P,name:Z[zc],store:R,after:te,onError:Q});let X;try{X=B.apply(this&&this.$id===e?this:R,P)}catch(ne){throw Ii(Y,ne),ne}return X instanceof Promise?X.then(ne=>(Ii(G,ne),ne)).catch(ne=>(Ii(Y,ne),Promise.reject(ne))):(Ii(G,X),X)};return Z[mh]=!0,Z[zc]=N,Z},D={_p:a,$id:e,$onAction:vh.bind(null,k),$patch:S,$reset:E,$subscribe(B,N={}){const Z=vh(g,B,N.detached,()=>P()),P=r.run(()=>Ze(()=>a.state.value[e],G=>{(N.flush==="sync"?p:f)&&B({storeId:e,type:Ll.direct,events:y},G)},ha({},d,N)));return Z},$dispose:A},R=li(D);a._s.set(e,R);const $=(a._a&&a._a.runWithContext||Vy)(()=>a._e.run(()=>(r=Sf()).run(()=>t({action:x}))));for(const B in $){const N=$[B];if(Yt(N)&&!Zy(N)||Fs(N))i||(_&&jy(N)&&(Yt(N)?N.value=_[B]:fu(N,_[B])),a.state.value[e][B]=N);else if(typeof N=="function"){const Z=x(N,B);$[B]=Z,u.actions[B]=N}}return ha(R,$),ha(Tt(R),$),Object.defineProperty(R,"$state",{get:()=>a.state.value[e],set:B=>{S(N=>{ha(N,B)})}}),a._p.forEach(B=>{ha(R,r.run(()=>B({store:R,app:a._a,pinia:a,options:u})))}),_&&i&&o.hydrate&&o.hydrate(R.$state,_),f=!0,p=!0,R}function Yu(e,t,o){let a;const s=typeof t=="function";a=s?o:t;function i(r,u){const d=lg();return r=r||(d?lo(Vp,null):null),r&&lc(r),r=Hp,r._s.has(e)||(s?jp(e,t,a,r):qy(e,a,r)),r._s.get(e)}return i.$id=e,i}const Ti=typeof document<"u";function Zp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Wy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Zp(e.default)}const Pt=Object.assign;function Hc(e,t){const o={};for(const a in t){const s=t[a];o[a]=ss(s)?s.map(e):e(s)}return o}const Sl=()=>{},ss=Array.isArray;function gh(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const qp=/#/g,Ky=/&/g,Jy=/\//g,Yy=/=/g,Xy=/\?/g,Wp=/\+/g,Qy=/%5B/g,e1=/%5D/g,Kp=/%5E/g,t1=/%60/g,Jp=/%7B/g,n1=/%7C/g,Yp=/%7D/g,o1=/%20/g;function Xu(e){return e==null?"":encodeURI(""+e).replace(n1,"|").replace(Qy,"[").replace(e1,"]")}function s1(e){return Xu(e).replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function pu(e){return Xu(e).replace(Wp,"%2B").replace(o1,"+").replace(qp,"%23").replace(Ky,"%26").replace(t1,"`").replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function a1(e){return pu(e).replace(Yy,"%3D")}function i1(e){return Xu(e).replace(qp,"%23").replace(Xy,"%3F")}function l1(e){return i1(e).replace(Jy,"%2F")}function Rl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const r1=/\/$/,c1=e=>e.replace(r1,"");function Vc(e,t,o="/"){let a,s={},i="",r="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),s=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),r=t.slice(u,t.length)),a=f1(a??t,o),{fullPath:a+i+r,path:a,query:s,hash:Rl(r)}}function u1(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function yh(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function d1(e,t,o){const a=t.matched.length-1,s=o.matched.length-1;return a>-1&&a===s&&Ui(t.matched[a],o.matched[s])&&Xp(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Ui(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Xp(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!h1(e[o],t[o]))return!1;return!0}function h1(e,t){return ss(e)?kh(e,t):ss(t)?kh(t,e):e?.valueOf()===t?.valueOf()}function kh(e,t){return ss(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function f1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),s=a[a.length-1];(s===".."||s===".")&&a.push("");let i=o.length-1,r,u;for(r=0;r<a.length;r++)if(u=a[r],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(r).join("/")}const da={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let vu=(function(e){return e.pop="pop",e.push="push",e})({}),Gc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function p1(e){if(!e)if(Ti){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),c1(e)}const v1=/^[^#]+#/;function m1(e,t){return e.replace(v1,"#")+t}function g1(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const rc=()=>({left:window.scrollX,top:window.scrollY});function y1(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=g1(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function _h(e,t){return(history.state?history.state.position-t:-1)+e}const mu=new Map;function k1(e,t){mu.set(e,t)}function _1(e){const t=mu.get(e);return mu.delete(e),t}function b1(e){return typeof e=="string"||e&&typeof e=="object"}function Qp(e){return typeof e=="string"||typeof e=="symbol"}let tn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const ev=Symbol("");tn.MATCHER_NOT_FOUND+"",tn.NAVIGATION_GUARD_REDIRECT+"",tn.NAVIGATION_ABORTED+"",tn.NAVIGATION_CANCELLED+"",tn.NAVIGATION_DUPLICATED+"";function zi(e,t){return Pt(new Error,{type:e,[ev]:!0},t)}function Ts(e,t){return e instanceof Error&&ev in e&&(t==null||!!(e.type&t))}const w1=["params","query","hash"];function C1(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of w1)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function L1(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const s=o[a].replace(Wp," "),i=s.indexOf("="),r=Rl(i<0?s:s.slice(0,i)),u=i<0?null:Rl(s.slice(i+1));if(r in t){let d=t[r];ss(d)||(d=t[r]=[d]),d.push(u)}else t[r]=u}return t}function bh(e){let t="";for(let o in e){const a=e[o];if(o=a1(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(ss(a)?a.map(s=>s&&pu(s)):[a&&pu(a)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function S1(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=ss(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return t}const x1=Symbol(""),wh=Symbol(""),cc=Symbol(""),Qu=Symbol(""),gu=Symbol("");function cl(){let e=[];function t(a){return e.push(a),()=>{const s=e.indexOf(a);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function ga(e,t,o,a,s,i=r=>r()){const r=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const f=k=>{k===!1?d(zi(tn.NAVIGATION_ABORTED,{from:o,to:t})):k instanceof Error?d(k):b1(k)?d(zi(tn.NAVIGATION_GUARD_REDIRECT,{from:t,to:k})):(r&&a.enterCallbacks[s]===r&&typeof k=="function"&&r.push(k),u())},p=i(()=>e.call(a&&a.instances[s],t,o,f));let g=Promise.resolve(p);e.length<3&&(g=g.then(f)),g.catch(k=>d(k))})}function jc(e,t,o,a,s=i=>i()){const i=[];for(const r of e)for(const u in r.components){let d=r.components[u];if(!(t!=="beforeRouteEnter"&&!r.instances[u]))if(Zp(d)){const f=(d.__vccOpts||d)[t];f&&i.push(ga(f,o,a,r,u,s))}else{let f=d();i.push(()=>f.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${r.path}"`);const g=Wy(p)?p.default:p;r.mods[u]=p,r.components[u]=g;const k=(g.__vccOpts||g)[t];return k&&ga(k,o,a,r,u,s)()}))}}return i}function I1(e,t){const o=[],a=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let r=0;r<i;r++){const u=t.matched[r];u&&(e.matched.find(f=>Ui(f,u))?a.push(u):o.push(u));const d=e.matched[r];d&&(t.matched.find(f=>Ui(f,d))||s.push(d))}return[o,a,s]}let $1=()=>location.protocol+"//"+location.host;function tv(e,t){const{pathname:o,search:a,hash:s}=t,i=e.indexOf("#");if(i>-1){let r=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(r);return u[0]!=="/"&&(u="/"+u),yh(u,"")}return yh(o,e)+a+s}function T1(e,t,o,a){let s=[],i=[],r=null;const u=({state:k})=>{const y=tv(e,location),_=o.value,w=t.value;let S=0;if(k){if(o.value=y,t.value=k,r&&r===_){r=null;return}S=w?k.position-w.position:0}else a(y);s.forEach(E=>{E(o.value,_,{delta:S,type:vu.pop,direction:S?S>0?Gc.forward:Gc.back:Gc.unknown})})};function d(){r=o.value}function f(k){s.push(k);const y=()=>{const _=s.indexOf(k);_>-1&&s.splice(_,1)};return i.push(y),y}function p(){if(document.visibilityState==="hidden"){const{history:k}=window;if(!k.state)return;k.replaceState(Pt({},k.state,{scroll:rc()}),"")}}function g(){for(const k of i)k();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:d,listen:f,destroy:g}}function Ch(e,t,o,a=!1,s=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:s?rc():null}}function M1(e){const{history:t,location:o}=window,a={value:tv(e,o)},s={value:t.state};s.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,f,p){const g=e.indexOf("#"),k=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:$1()+e+d;try{t[p?"replaceState":"pushState"](f,"",k),s.value=f}catch(y){console.error(y),o[p?"replace":"assign"](k)}}function r(d,f){i(d,Pt({},t.state,Ch(s.value.back,d,s.value.forward,!0),f,{position:s.value.position}),!0),a.value=d}function u(d,f){const p=Pt({},s.value,t.state,{forward:d,scroll:rc()});i(p.current,p,!0),i(d,Pt({},Ch(a.value,d,null),{position:p.position+1},f),!1),a.value=d}return{location:a,state:s,push:u,replace:r}}function A1(e){e=p1(e);const t=M1(e),o=T1(e,t.state,t.location,t.replace);function a(i,r=!0){r||o.pauseListeners(),history.go(i)}const s=Pt({location:"",base:e,go:a,createHref:m1.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function E1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),A1(e)}let Qa=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var rn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(rn||{});const P1={type:Qa.Static,value:""},D1=/[a-zA-Z0-9_]/;function R1(e){if(!e)return[[]];if(e==="/")return[[P1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(y){throw new Error(`ERR (${o})/"${f}": ${y}`)}let o=rn.Static,a=o;const s=[];let i;function r(){i&&s.push(i),i=[]}let u=0,d,f="",p="";function g(){f&&(o===rn.Static?i.push({type:Qa.Static,value:f}):o===rn.Param||o===rn.ParamRegExp||o===rn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Qa.Param,value:f,regexp:p,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),f="")}function k(){f+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==rn.ParamRegExp){a=o,o=rn.EscapeNext;continue}switch(o){case rn.Static:d==="/"?(f&&g(),r()):d===":"?(g(),o=rn.Param):k();break;case rn.EscapeNext:k(),o=a;break;case rn.Param:d==="("?o=rn.ParamRegExp:D1.test(d)?k():(g(),o=rn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case rn.ParamRegExp:d===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+d:o=rn.ParamRegExpEnd:p+=d;break;case rn.ParamRegExpEnd:g(),o=rn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===rn.ParamRegExp&&t(`Unfinished custom RegExp for param "${f}"`),g(),r(),s}const Lh="[^/]+?",O1={sensitive:!1,strict:!1,start:!0,end:!0};var Kn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Kn||{});const B1=/[.+*?^${}()[\]/\\]/g;function N1(e,t){const o=Pt({},O1,t),a=[];let s=o.start?"^":"";const i=[];for(const f of e){const p=f.length?[]:[Kn.Root];o.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const k=f[g];let y=Kn.Segment+(o.sensitive?Kn.BonusCaseSensitive:0);if(k.type===Qa.Static)g||(s+="/"),s+=k.value.replace(B1,"\\$&"),y+=Kn.Static;else if(k.type===Qa.Param){const{value:_,repeatable:w,optional:S,regexp:E}=k;i.push({name:_,repeatable:w,optional:S});const A=E||Lh;if(A!==Lh){y+=Kn.BonusCustomRegExp;try{`${A}`}catch(D){throw new Error(`Invalid custom RegExp for param "${_}" (${A}): `+D.message)}}let x=w?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;g||(x=S&&f.length<2?`(?:/${x})`:"/"+x),S&&(x+="?"),s+=x,y+=Kn.Dynamic,S&&(y+=Kn.BonusOptional),w&&(y+=Kn.BonusRepeatable),A===".*"&&(y+=Kn.BonusWildcard)}p.push(y)}a.push(p)}if(o.strict&&o.end){const f=a.length-1;a[f][a[f].length-1]+=Kn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const r=new RegExp(s,o.sensitive?"":"i");function u(f){const p=f.match(r),g={};if(!p)return null;for(let k=1;k<p.length;k++){const y=p[k]||"",_=i[k-1];g[_.name]=y&&_.repeatable?y.split("/"):y}return g}function d(f){let p="",g=!1;for(const k of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const y of k)if(y.type===Qa.Static)p+=y.value;else if(y.type===Qa.Param){const{value:_,repeatable:w,optional:S}=y,E=_ in f?f[_]:"";if(ss(E)&&!w)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const A=ss(E)?E.join("/"):E;if(!A)if(S)k.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${_}"`);p+=A}}return p||"/"}return{re:r,score:a,keys:i,parse:u,stringify:d}}function F1(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Kn.Static+Kn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Kn.Static+Kn.Segment?1:-1:0}function nv(e,t){let o=0;const a=e.score,s=t.score;for(;o<a.length&&o<s.length;){const i=F1(a[o],s[o]);if(i)return i;o++}if(Math.abs(s.length-a.length)===1){if(Sh(a))return 1;if(Sh(s))return-1}return s.length-a.length}function Sh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const U1={strict:!1,end:!0,sensitive:!1};function z1(e,t,o){const a=N1(R1(e.path),o),s=Pt(a,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function H1(e,t){const o=[],a=new Map;t=gh(U1,t);function s(g){return a.get(g)}function i(g,k,y){const _=!y,w=Ih(g);w.aliasOf=y&&y.record;const S=gh(t,g),E=[w];if("alias"in g){const D=typeof g.alias=="string"?[g.alias]:g.alias;for(const R of D)E.push(Ih(Pt({},w,{components:y?y.record.components:w.components,path:R,aliasOf:y?y.record:w})))}let A,x;for(const D of E){const{path:R}=D;if(k&&R[0]!=="/"){const H=k.record.path,$=H[H.length-1]==="/"?"":"/";D.path=k.record.path+(R&&$+R)}if(A=z1(D,k,S),y?y.alias.push(A):(x=x||A,x!==A&&x.alias.push(A),_&&g.name&&!$h(A)&&r(g.name)),ov(A)&&d(A),w.children){const H=w.children;for(let $=0;$<H.length;$++)i(H[$],A,y&&y.children[$])}y=y||A}return x?()=>{r(x)}:Sl}function r(g){if(Qp(g)){const k=a.get(g);k&&(a.delete(g),o.splice(o.indexOf(k),1),k.children.forEach(r),k.alias.forEach(r))}else{const k=o.indexOf(g);k>-1&&(o.splice(k,1),g.record.name&&a.delete(g.record.name),g.children.forEach(r),g.alias.forEach(r))}}function u(){return o}function d(g){const k=j1(g,o);o.splice(k,0,g),g.record.name&&!$h(g)&&a.set(g.record.name,g)}function f(g,k){let y,_={},w,S;if("name"in g&&g.name){if(y=a.get(g.name),!y)throw zi(tn.MATCHER_NOT_FOUND,{location:g});S=y.record.name,_=Pt(xh(k.params,y.keys.filter(x=>!x.optional).concat(y.parent?y.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),g.params&&xh(g.params,y.keys.map(x=>x.name))),w=y.stringify(_)}else if(g.path!=null)w=g.path,y=o.find(x=>x.re.test(w)),y&&(_=y.parse(w),S=y.record.name);else{if(y=k.name?a.get(k.name):o.find(x=>x.re.test(k.path)),!y)throw zi(tn.MATCHER_NOT_FOUND,{location:g,currentLocation:k});S=y.record.name,_=Pt({},k.params,g.params),w=y.stringify(_)}const E=[];let A=y;for(;A;)E.unshift(A.record),A=A.parent;return{name:S,path:w,params:_,matched:E,meta:G1(E)}}e.forEach(g=>i(g));function p(){o.length=0,a.clear()}return{addRoute:i,resolve:f,removeRoute:r,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function xh(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function Ih(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:V1(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function V1(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function $h(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function G1(e){return e.reduce((t,o)=>Pt(t,o.meta),{})}function j1(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;nv(e,t[i])<0?a=i:o=i+1}const s=Z1(e);return s&&(a=t.lastIndexOf(s,a-1)),a}function Z1(e){let t=e;for(;t=t.parent;)if(ov(t)&&nv(e,t)===0)return t}function ov({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Th(e){const t=lo(cc),o=lo(Qu),a=V(()=>{const d=O(e.to);return t.resolve(d)}),s=V(()=>{const{matched:d}=a.value,{length:f}=d,p=d[f-1],g=o.matched;if(!p||!g.length)return-1;const k=g.findIndex(Ui.bind(null,p));if(k>-1)return k;const y=Mh(d[f-2]);return f>1&&Mh(p)===y&&g[g.length-1].path!==y?g.findIndex(Ui.bind(null,d[f-2])):k}),i=V(()=>s.value>-1&&Y1(o.params,a.value.params)),r=V(()=>s.value>-1&&s.value===o.matched.length-1&&Xp(o.params,a.value.params));function u(d={}){if(J1(d)){const f=t[O(e.replace)?"replace":"push"](O(e.to)).catch(Sl);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:a,href:V(()=>a.value.href),isActive:i,isExactActive:r,navigate:u}}function q1(e){return e.length===1?e[0]:e}const W1=lp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Th,setup(e,{slots:t}){const o=li(Th(e)),{options:a}=lo(cc),s=V(()=>({[Ah(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[Ah(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&q1(t.default(o));return e.custom?i:Ju("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},i)}}}),K1=W1;function J1(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Y1(e,t){for(const o in t){const a=t[o],s=e[o];if(typeof a=="string"){if(a!==s)return!1}else if(!ss(s)||s.length!==a.length||a.some((i,r)=>i.valueOf()!==s[r].valueOf()))return!1}return!0}function Mh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ah=(e,t,o)=>e??t??o,X1=lp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=lo(gu),s=V(()=>e.route||a.value),i=lo(wh,0),r=V(()=>{let f=O(i);const{matched:p}=s.value;let g;for(;(g=p[f])&&!g.components;)f++;return f}),u=V(()=>s.value.matched[r.value]);yl(wh,V(()=>r.value+1)),yl(x1,u),yl(gu,s);const d=T();return Ze(()=>[d.value,u.value,e.name],([f,p,g],[k,y,_])=>{p&&(p.instances[g]=f,y&&y!==p&&f&&f===k&&(p.leaveGuards.size||(p.leaveGuards=y.leaveGuards),p.updateGuards.size||(p.updateGuards=y.updateGuards))),f&&p&&(!y||!Ui(p,y)||!k)&&(p.enterCallbacks[g]||[]).forEach(w=>w(f))},{flush:"post"}),()=>{const f=s.value,p=e.name,g=u.value,k=g&&g.components[p];if(!k)return Eh(o.default,{Component:k,route:f});const y=g.props[p],_=y?y===!0?f.params:typeof y=="function"?y(f):y:null,S=Ju(k,Pt({},_,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(g.instances[p]=null)},ref:d}));return Eh(o.default,{Component:S,route:f})||S}}});function Eh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const Q1=X1;function ek(e){const t=H1(e.routes,e),o=e.parseQuery||L1,a=e.stringifyQuery||bh,s=e.history,i=cl(),r=cl(),u=cl(),d=Km(da);let f=da;Ti&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=Hc.bind(null,ye=>""+ye),g=Hc.bind(null,l1),k=Hc.bind(null,Rl);function y(ye,Ve){let me,xe;return Qp(ye)?(me=t.getRecordMatcher(ye),xe=Ve):xe=ye,t.addRoute(xe,me)}function _(ye){const Ve=t.getRecordMatcher(ye);Ve&&t.removeRoute(Ve)}function w(){return t.getRoutes().map(ye=>ye.record)}function S(ye){return!!t.getRecordMatcher(ye)}function E(ye,Ve){if(Ve=Pt({},Ve||d.value),typeof ye=="string"){const ve=Vc(o,ye,Ve.path),Se=t.resolve({path:ve.path},Ve),re=s.createHref(ve.fullPath);return Pt(ve,Se,{params:k(Se.params),hash:Rl(ve.hash),redirectedFrom:void 0,href:re})}let me;if(ye.path!=null)me=Pt({},ye,{path:Vc(o,ye.path,Ve.path).path});else{const ve=Pt({},ye.params);for(const Se in ve)ve[Se]==null&&delete ve[Se];me=Pt({},ye,{params:g(ve)}),Ve.params=g(Ve.params)}const xe=t.resolve(me,Ve),De=ye.hash||"";xe.params=p(k(xe.params));const q=u1(a,Pt({},ye,{hash:s1(De),path:xe.path})),J=s.createHref(q);return Pt({fullPath:q,hash:De,query:a===bh?S1(ye.query):ye.query||{}},xe,{redirectedFrom:void 0,href:J})}function A(ye){return typeof ye=="string"?Vc(o,ye,d.value.path):Pt({},ye)}function x(ye,Ve){if(f!==ye)return zi(tn.NAVIGATION_CANCELLED,{from:Ve,to:ye})}function D(ye){return $(ye)}function R(ye){return D(Pt(A(ye),{replace:!0}))}function H(ye,Ve){const me=ye.matched[ye.matched.length-1];if(me&&me.redirect){const{redirect:xe}=me;let De=typeof xe=="function"?xe(ye,Ve):xe;return typeof De=="string"&&(De=De.includes("?")||De.includes("#")?De=A(De):{path:De},De.params={}),Pt({query:ye.query,hash:ye.hash,params:De.path!=null?{}:ye.params},De)}}function $(ye,Ve){const me=f=E(ye),xe=d.value,De=ye.state,q=ye.force,J=ye.replace===!0,ve=H(me,xe);if(ve)return $(Pt(A(ve),{state:typeof ve=="object"?Pt({},De,ve.state):De,force:q,replace:J}),Ve||me);const Se=me;Se.redirectedFrom=Ve;let re;return!q&&d1(a,xe,me)&&(re=zi(tn.NAVIGATION_DUPLICATED,{to:Se,from:xe}),he(xe,xe,!0,!1)),(re?Promise.resolve(re):Z(Se,xe)).catch(ue=>Ts(ue)?Ts(ue,tn.NAVIGATION_GUARD_REDIRECT)?ue:fe(ue):F(ue,Se,xe)).then(ue=>{if(ue){if(Ts(ue,tn.NAVIGATION_GUARD_REDIRECT))return $(Pt({replace:J},A(ue.to),{state:typeof ue.to=="object"?Pt({},De,ue.to.state):De,force:q}),Ve||Se)}else ue=G(Se,xe,!0,J,De);return P(Se,xe,ue),ue})}function B(ye,Ve){const me=x(ye,Ve);return me?Promise.reject(me):Promise.resolve()}function N(ye){const Ve=Xe.values().next().value;return Ve&&typeof Ve.runWithContext=="function"?Ve.runWithContext(ye):ye()}function Z(ye,Ve){let me;const[xe,De,q]=I1(ye,Ve);me=jc(xe.reverse(),"beforeRouteLeave",ye,Ve);for(const ve of xe)ve.leaveGuards.forEach(Se=>{me.push(ga(Se,ye,Ve))});const J=B.bind(null,ye,Ve);return me.push(J),Ke(me).then(()=>{me=[];for(const ve of i.list())me.push(ga(ve,ye,Ve));return me.push(J),Ke(me)}).then(()=>{me=jc(De,"beforeRouteUpdate",ye,Ve);for(const ve of De)ve.updateGuards.forEach(Se=>{me.push(ga(Se,ye,Ve))});return me.push(J),Ke(me)}).then(()=>{me=[];for(const ve of q)if(ve.beforeEnter)if(ss(ve.beforeEnter))for(const Se of ve.beforeEnter)me.push(ga(Se,ye,Ve));else me.push(ga(ve.beforeEnter,ye,Ve));return me.push(J),Ke(me)}).then(()=>(ye.matched.forEach(ve=>ve.enterCallbacks={}),me=jc(q,"beforeRouteEnter",ye,Ve,N),me.push(J),Ke(me))).then(()=>{me=[];for(const ve of r.list())me.push(ga(ve,ye,Ve));return me.push(J),Ke(me)}).catch(ve=>Ts(ve,tn.NAVIGATION_CANCELLED)?ve:Promise.reject(ve))}function P(ye,Ve,me){u.list().forEach(xe=>N(()=>xe(ye,Ve,me)))}function G(ye,Ve,me,xe,De){const q=x(ye,Ve);if(q)return q;const J=Ve===da,ve=Ti?history.state:{};me&&(xe||J?s.replace(ye.fullPath,Pt({scroll:J&&ve&&ve.scroll},De)):s.push(ye.fullPath,De)),d.value=ye,he(ye,Ve,me,J),fe()}let Y;function te(){Y||(Y=s.listen((ye,Ve,me)=>{if(!He.listening)return;const xe=E(ye),De=H(xe,He.currentRoute.value);if(De){$(Pt(De,{replace:!0,force:!0}),xe).catch(Sl);return}f=xe;const q=d.value;Ti&&k1(_h(q.fullPath,me.delta),rc()),Z(xe,q).catch(J=>Ts(J,tn.NAVIGATION_ABORTED|tn.NAVIGATION_CANCELLED)?J:Ts(J,tn.NAVIGATION_GUARD_REDIRECT)?($(Pt(A(J.to),{force:!0}),xe).then(ve=>{Ts(ve,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&!me.delta&&me.type===vu.pop&&s.go(-1,!1)}).catch(Sl),Promise.reject()):(me.delta&&s.go(-me.delta,!1),F(J,xe,q))).then(J=>{J=J||G(xe,q,!1),J&&(me.delta&&!Ts(J,tn.NAVIGATION_CANCELLED)?s.go(-me.delta,!1):me.type===vu.pop&&Ts(J,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),P(xe,q,J)}).catch(Sl)}))}let Q=cl(),X=cl(),ne;function F(ye,Ve,me){fe(ye);const xe=X.list();return xe.length?xe.forEach(De=>De(ye,Ve,me)):console.error(ye),Promise.reject(ye)}function K(){return ne&&d.value!==da?Promise.resolve():new Promise((ye,Ve)=>{Q.add([ye,Ve])})}function fe(ye){return ne||(ne=!ye,te(),Q.list().forEach(([Ve,me])=>ye?me(ye):Ve()),Q.reset()),ye}function he(ye,Ve,me,xe){const{scrollBehavior:De}=e;if(!Ti||!De)return Promise.resolve();const q=!me&&_1(_h(ye.fullPath,0))||(xe||!me)&&history.state&&history.state.scroll||null;return cn().then(()=>De(ye,Ve,q)).then(J=>J&&y1(J)).catch(J=>F(J,ye,Ve))}const Re=ye=>s.go(ye);let et;const Xe=new Set,He={currentRoute:d,listening:!0,addRoute:y,removeRoute:_,clearRoutes:t.clearRoutes,hasRoute:S,getRoutes:w,resolve:E,options:e,push:D,replace:R,go:Re,back:()=>Re(-1),forward:()=>Re(1),beforeEach:i.add,beforeResolve:r.add,afterEach:u.add,onError:X.add,isReady:K,install(ye){ye.component("RouterLink",K1),ye.component("RouterView",Q1),ye.config.globalProperties.$router=He,Object.defineProperty(ye.config.globalProperties,"$route",{enumerable:!0,get:()=>O(d)}),Ti&&!et&&d.value===da&&(et=!0,D(s.location).catch(xe=>{}));const Ve={};for(const xe in da)Object.defineProperty(Ve,xe,{get:()=>d.value[xe],enumerable:!0});ye.provide(cc,He),ye.provide(Qu,zf(Ve)),ye.provide(gu,d);const me=ye.unmount;Xe.add(ye),ye.unmount=function(){Xe.delete(ye),Xe.size<1&&(f=da,Y&&Y(),Y=null,d.value=da,et=!1,ne=!1),me()}}};function Ke(ye){return ye.reduce((Ve,me)=>Ve.then(()=>N(me)),Promise.resolve())}return He}function Gi(){return lo(cc)}function uc(e){return lo(Qu)}const tk={__name:"App",setup(e){const t=Gi(),o=T(""),a=["/","/sessions"];return Ze(()=>t.currentRoute.value,(s,i)=>{if(!i?.path){o.value="";return}const r=a.indexOf(s.path),u=a.indexOf(i.path);r!==-1&&u!==-1?o.value=r>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(s,i)=>{const r=ju("router-view");return v(),qe(r,null,{default:ze(({Component:u,route:d})=>[Ee(gs,{name:o.value,mode:"out-in"},{default:ze(()=>[(v(),qe(Lg(u),{key:d.path}))]),_:2},1032,["name"])]),_:1})}}},ji="marshalSessions",nk=30;function Or(e,t){return`${e}:${t}`}function ed(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function Ta(){try{return JSON.parse(localStorage.getItem(ji)||"{}")}catch{return{}}}function Br(e){const t=Ta(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,s])=>({sessionKey:a,...s}));return o.length===0?null:(o.sort((a,s)=>new Date(s.lastAccessed)-new Date(a.lastAccessed)),o[0])}function Ph(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=Ta(),a=Or(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(ji,JSON.stringify(o))}function yu(e){const t=Ta(),{eventId:o,marshalId:a}=ed(e);delete t[e],localStorage.setItem(ji,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function sv(e,t){const o=Ta(),a=Or(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(ji,JSON.stringify(o)))}function av(){const e=Ta(),t=new Date;t.setDate(t.getDate()-nk);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:r}=ed(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${r}`),o=!0}o&&localStorage.setItem(ji,JSON.stringify(e))}function iv(){const e=Ta(),t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);if(s&&s.startsWith("marshal_")&&!s.startsWith("marshalCode_")&&!s.startsWith("marshalSessions")){const i=s.replace("marshal_",""),r=localStorage.getItem(s);if(r){const u=Or(i,r);e[u]||(e[u]={marshalId:r,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(s)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const s=e[a];if(s&&s.marshalId){const i=Or(a,s.marshalId);e[i]||(e[i]={...s,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(ji,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function ok(){const e=Ta();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:s}=ed(t);return{sessionKey:t,eventId:a,marshalId:s,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function lv(){const e=Ta();return Object.values(e).some(t=>t.token)}function rv(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function sk(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function cv(e,t){return function(){return e.apply(t,arguments)}}const{toString:ak}=Object.prototype,{getPrototypeOf:td}=Object,{iterator:dc,toStringTag:uv}=Symbol,hc=(e=>t=>{const o=ak.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),as=e=>(e=e.toLowerCase(),t=>hc(t)===e),fc=e=>t=>typeof t===e,{isArray:Zi}=Array,Hi=fc("undefined");function Hl(e){return e!==null&&!Hi(e)&&e.constructor!==null&&!Hi(e.constructor)&&ro(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const dv=as("ArrayBuffer");function ik(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&dv(e.buffer),t}const lk=fc("string"),ro=fc("function"),hv=fc("number"),Vl=e=>e!==null&&typeof e=="object",rk=e=>e===!0||e===!1,kr=e=>{if(hc(e)!=="object")return!1;const t=td(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(uv in e)&&!(dc in e)},ck=e=>{if(!Vl(e)||Hl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},uk=as("Date"),dk=as("File"),hk=as("Blob"),fk=as("FileList"),pk=e=>Vl(e)&&ro(e.pipe),vk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ro(e.append)&&((t=hc(e))==="formdata"||t==="object"&&ro(e.toString)&&e.toString()==="[object FormData]"))},mk=as("URLSearchParams"),[gk,yk,kk,_k]=["ReadableStream","Request","Response","Headers"].map(as),bk=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),Zi(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(Hl(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let u;for(a=0;a<r;a++)u=i[a],t.call(null,e[u],u,e)}}function fv(e,t){if(Hl(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,s;for(;a-- >0;)if(s=o[a],t===s.toLowerCase())return s;return null}const ei=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pv=e=>!Hi(e)&&e!==ei;function ku(){const{caseless:e,skipUndefined:t}=pv(this)&&this||{},o={},a=(s,i)=>{const r=e&&fv(o,i)||i;kr(o[r])&&kr(s)?o[r]=ku(o[r],s):kr(s)?o[r]=ku({},s):Zi(s)?o[r]=s.slice():(!t||!Hi(s))&&(o[r]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Gl(arguments[s],a);return o}const wk=(e,t,o,{allOwnKeys:a}={})=>(Gl(t,(s,i)=>{o&&ro(s)?e[i]=cv(s,o):e[i]=s},{allOwnKeys:a}),e),Ck=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Lk=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Sk=(e,t,o,a)=>{let s,i,r;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)r=s[i],(!a||a(r,e,t))&&!u[r]&&(t[r]=e[r],u[r]=!0);e=o!==!1&&td(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},xk=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},Ik=e=>{if(!e)return null;if(Zi(e))return e;let t=e.length;if(!hv(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},$k=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&td(Uint8Array)),Tk=(e,t)=>{const a=(e&&e[dc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},Mk=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},Ak=as("HTMLFormElement"),Ek=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,s){return a.toUpperCase()+s}),Dh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Pk=as("RegExp"),vv=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};Gl(o,(s,i)=>{let r;(r=t(s,i,e))!==!1&&(a[i]=r||s)}),Object.defineProperties(e,a)},Dk=e=>{vv(e,(t,o)=>{if(ro(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(ro(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Rk=(e,t)=>{const o={},a=s=>{s.forEach(i=>{o[i]=!0})};return Zi(e)?a(e):a(String(e).split(t)),o},Ok=()=>{},Bk=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Nk(e){return!!(e&&ro(e.append)&&e[uv]==="FormData"&&e[dc])}const Fk=e=>{const t=new Array(10),o=(a,s)=>{if(Vl(a)){if(t.indexOf(a)>=0)return;if(Hl(a))return a;if(!("toJSON"in a)){t[s]=a;const i=Zi(a)?[]:{};return Gl(a,(r,u)=>{const d=o(r,s+1);!Hi(d)&&(i[u]=d)}),t[s]=void 0,i}}return a};return o(e,0)},Uk=as("AsyncFunction"),zk=e=>e&&(Vl(e)||ro(e))&&ro(e.then)&&ro(e.catch),mv=((e,t)=>e?setImmediate:t?((o,a)=>(ei.addEventListener("message",({source:s,data:i})=>{s===ei&&i===o&&a.length&&a.shift()()},!1),s=>{a.push(s),ei.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",ro(ei.postMessage)),Hk=typeof queueMicrotask<"u"?queueMicrotask.bind(ei):typeof process<"u"&&process.nextTick||mv,Vk=e=>e!=null&&ro(e[dc]),Te={isArray:Zi,isArrayBuffer:dv,isBuffer:Hl,isFormData:vk,isArrayBufferView:ik,isString:lk,isNumber:hv,isBoolean:rk,isObject:Vl,isPlainObject:kr,isEmptyObject:ck,isReadableStream:gk,isRequest:yk,isResponse:kk,isHeaders:_k,isUndefined:Hi,isDate:uk,isFile:dk,isBlob:hk,isRegExp:Pk,isFunction:ro,isStream:pk,isURLSearchParams:mk,isTypedArray:$k,isFileList:fk,forEach:Gl,merge:ku,extend:wk,trim:bk,stripBOM:Ck,inherits:Lk,toFlatObject:Sk,kindOf:hc,kindOfTest:as,endsWith:xk,toArray:Ik,forEachEntry:Tk,matchAll:Mk,isHTMLForm:Ak,hasOwnProperty:Dh,hasOwnProp:Dh,reduceDescriptors:vv,freezeMethods:Dk,toObjectSet:Rk,toCamelCase:Ek,noop:Ok,toFiniteNumber:Bk,findKey:fv,global:ei,isContextDefined:pv,isSpecCompliantForm:Nk,toJSONObject:Fk,isAsyncFn:Uk,isThenable:zk,setImmediate:mv,asap:Hk,isIterable:Vk};function pt(e,t,o,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}Te.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});const gv=pt.prototype,yv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{yv[e]={value:e}});Object.defineProperties(pt,yv);Object.defineProperty(gv,"isAxiosError",{value:!0});pt.from=(e,t,o,a,s,i)=>{const r=Object.create(gv);Te.toFlatObject(e,r,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return pt.call(r,u,d,o,a,s),e&&r.cause==null&&Object.defineProperty(r,"cause",{value:e,configurable:!0}),r.name=e&&e.name||"Error",i&&Object.assign(r,i),r};const Gk=null;function _u(e){return Te.isPlainObject(e)||Te.isArray(e)}function kv(e){return Te.endsWith(e,"[]")?e.slice(0,-2):e}function Rh(e,t,o){return e?e.concat(t).map(function(s,i){return s=kv(s),!o&&i?"["+s+"]":s}).join(o?".":""):t}function jk(e){return Te.isArray(e)&&!e.some(_u)}const Zk=Te.toFlatObject(Te,{},null,function(t){return/^is[A-Z]/.test(t)});function pc(e,t,o){if(!Te.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Te.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,S){return!Te.isUndefined(S[w])});const a=o.metaTokens,s=o.visitor||p,i=o.dots,r=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(t);if(!Te.isFunction(s))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(Te.isDate(_))return _.toISOString();if(Te.isBoolean(_))return _.toString();if(!d&&Te.isBlob(_))throw new pt("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(_)||Te.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,w,S){let E=_;if(_&&!S&&typeof _=="object"){if(Te.endsWith(w,"{}"))w=a?w:w.slice(0,-2),_=JSON.stringify(_);else if(Te.isArray(_)&&jk(_)||(Te.isFileList(_)||Te.endsWith(w,"[]"))&&(E=Te.toArray(_)))return w=kv(w),E.forEach(function(x,D){!(Te.isUndefined(x)||x===null)&&t.append(r===!0?Rh([w],D,i):r===null?w:w+"[]",f(x))}),!1}return _u(_)?!0:(t.append(Rh(S,w,i),f(_)),!1)}const g=[],k=Object.assign(Zk,{defaultVisitor:p,convertValue:f,isVisitable:_u});function y(_,w){if(!Te.isUndefined(_)){if(g.indexOf(_)!==-1)throw Error("Circular reference detected in "+w.join("."));g.push(_),Te.forEach(_,function(E,A){(!(Te.isUndefined(E)||E===null)&&s.call(t,E,Te.isString(A)?A.trim():A,w,k))===!0&&y(E,w?w.concat(A):[A])}),g.pop()}}if(!Te.isObject(e))throw new TypeError("data must be an object");return y(e),t}function Oh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function nd(e,t){this._pairs=[],e&&pc(e,this,t)}const _v=nd.prototype;_v.append=function(t,o){this._pairs.push([t,o])};_v.toString=function(t){const o=t?function(a){return t.call(this,a,Oh)}:Oh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function qk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function bv(e,t,o){if(!t)return e;const a=o&&o.encode||qk;Te.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let i;if(s?i=s(t,o):i=Te.isURLSearchParams(t)?t.toString():new nd(t,o).toString(a),i){const r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Bh{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Te.forEach(this.handlers,function(a){a!==null&&t(a)})}}const wv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wk=typeof URLSearchParams<"u"?URLSearchParams:nd,Kk=typeof FormData<"u"?FormData:null,Jk=typeof Blob<"u"?Blob:null,Yk={isBrowser:!0,classes:{URLSearchParams:Wk,FormData:Kk,Blob:Jk},protocols:["http","https","file","blob","url","data"]},od=typeof window<"u"&&typeof document<"u",bu=typeof navigator=="object"&&navigator||void 0,Xk=od&&(!bu||["ReactNative","NativeScript","NS"].indexOf(bu.product)<0),Qk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",e_=od&&window.location.href||"http://localhost",t_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:od,hasStandardBrowserEnv:Xk,hasStandardBrowserWebWorkerEnv:Qk,navigator:bu,origin:e_},Symbol.toStringTag,{value:"Module"})),Nn={...t_,...Yk};function n_(e,t){return pc(e,new Nn.classes.URLSearchParams,{visitor:function(o,a,s,i){return Nn.isNode&&Te.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function o_(e){return Te.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function s_(e){const t={},o=Object.keys(e);let a;const s=o.length;let i;for(a=0;a<s;a++)i=o[a],t[i]=e[i];return t}function Cv(e){function t(o,a,s,i){let r=o[i++];if(r==="__proto__")return!0;const u=Number.isFinite(+r),d=i>=o.length;return r=!r&&Te.isArray(s)?s.length:r,d?(Te.hasOwnProp(s,r)?s[r]=[s[r],a]:s[r]=a,!u):((!s[r]||!Te.isObject(s[r]))&&(s[r]=[]),t(o,a,s[r],i)&&Te.isArray(s[r])&&(s[r]=s_(s[r])),!u)}if(Te.isFormData(e)&&Te.isFunction(e.entries)){const o={};return Te.forEachEntry(e,(a,s)=>{t(o_(a),s,o,0)}),o}return null}function a_(e,t,o){if(Te.isString(e))try{return(t||JSON.parse)(e),Te.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const jl={transitional:wv,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",s=a.indexOf("application/json")>-1,i=Te.isObject(t);if(i&&Te.isHTMLForm(t)&&(t=new FormData(t)),Te.isFormData(t))return s?JSON.stringify(Cv(t)):t;if(Te.isArrayBuffer(t)||Te.isBuffer(t)||Te.isStream(t)||Te.isFile(t)||Te.isBlob(t)||Te.isReadableStream(t))return t;if(Te.isArrayBufferView(t))return t.buffer;if(Te.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return n_(t,this.formSerializer).toString();if((u=Te.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return pc(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||s?(o.setContentType("application/json",!1),a_(t)):t}],transformResponse:[function(t){const o=this.transitional||jl.transitional,a=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Te.isResponse(t)||Te.isReadableStream(t))return t;if(t&&Te.isString(t)&&(a&&!this.responseType||s)){const r=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(r)throw u.name==="SyntaxError"?pt.from(u,pt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nn.classes.FormData,Blob:Nn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],e=>{jl.headers[e]={}});const i_=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),l_=e=>{const t={};let o,a,s;return e&&e.split(`
`).forEach(function(r){s=r.indexOf(":"),o=r.substring(0,s).trim().toLowerCase(),a=r.substring(s+1).trim(),!(!o||t[o]&&i_[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},Nh=Symbol("internals");function ul(e){return e&&String(e).trim().toLowerCase()}function _r(e){return e===!1||e==null?e:Te.isArray(e)?e.map(_r):String(e)}function r_(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const c_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Zc(e,t,o,a,s){if(Te.isFunction(a))return a.call(this,t,o);if(s&&(t=o),!!Te.isString(t)){if(Te.isString(a))return t.indexOf(a)!==-1;if(Te.isRegExp(a))return a.test(t)}}function u_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function d_(e,t){const o=Te.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(s,i,r){return this[a].call(this,t,s,i,r)},configurable:!0})})}let co=class{constructor(t){t&&this.set(t)}set(t,o,a){const s=this;function i(u,d,f){const p=ul(d);if(!p)throw new Error("header name must be a non-empty string");const g=Te.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||d]=_r(u))}const r=(u,d)=>Te.forEach(u,(f,p)=>i(f,p,d));if(Te.isPlainObject(t)||t instanceof this.constructor)r(t,o);else if(Te.isString(t)&&(t=t.trim())&&!c_(t))r(l_(t),o);else if(Te.isObject(t)&&Te.isIterable(t)){let u={},d,f;for(const p of t){if(!Te.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?Te.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}r(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=ul(t),t){const a=Te.findKey(this,t);if(a){const s=this[a];if(!o)return s;if(o===!0)return r_(s);if(Te.isFunction(o))return o.call(this,s,a);if(Te.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=ul(t),t){const a=Te.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||Zc(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let s=!1;function i(r){if(r=ul(r),r){const u=Te.findKey(a,r);u&&(!o||Zc(a,a[u],u,o))&&(delete a[u],s=!0)}}return Te.isArray(t)?t.forEach(i):i(t),s}clear(t){const o=Object.keys(this);let a=o.length,s=!1;for(;a--;){const i=o[a];(!t||Zc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const o=this,a={};return Te.forEach(this,(s,i)=>{const r=Te.findKey(a,i);if(r){o[r]=_r(s),delete o[i];return}const u=t?u_(i):String(i).trim();u!==i&&delete o[i],o[u]=_r(s),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Te.forEach(this,(a,s)=>{a!=null&&a!==!1&&(o[s]=t&&Te.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Nh]=this[Nh]={accessors:{}}).accessors,s=this.prototype;function i(r){const u=ul(r);a[u]||(d_(s,r),a[u]=!0)}return Te.isArray(t)?t.forEach(i):i(t),this}};co.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(co.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});Te.freezeMethods(co);function qc(e,t){const o=this||jl,a=t||o,s=co.from(a.headers);let i=a.data;return Te.forEach(e,function(u){i=u.call(o,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Lv(e){return!!(e&&e.__CANCEL__)}function qi(e,t,o){pt.call(this,e??"canceled",pt.ERR_CANCELED,t,o),this.name="CanceledError"}Te.inherits(qi,pt,{__CANCEL__:!0});function Sv(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new pt("Request failed with status code "+o.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function h_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function f_(e,t){e=e||10;const o=new Array(e),a=new Array(e);let s=0,i=0,r;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=a[i];r||(r=f),o[s]=d,a[s]=f;let g=i,k=0;for(;g!==s;)k+=o[g++],g=g%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),f-r<t)return;const y=p&&f-p;return y?Math.round(k*1e3/y):void 0}}function p_(e,t){let o=0,a=1e3/t,s,i;const r=(f,p=Date.now())=>{o=p,s=null,i&&(clearTimeout(i),i=null),e(...f)};return[(...f)=>{const p=Date.now(),g=p-o;g>=a?r(f,p):(s=f,i||(i=setTimeout(()=>{i=null,r(s)},a-g)))},()=>s&&r(s)]}const Nr=(e,t,o=3)=>{let a=0;const s=f_(50,250);return p_(i=>{const r=i.loaded,u=i.lengthComputable?i.total:void 0,d=r-a,f=s(d),p=r<=u;a=r;const g={loaded:r,total:u,progress:u?r/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-r)/f:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},Fh=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Uh=e=>(...t)=>Te.asap(()=>e(...t)),v_=Nn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Nn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Nn.origin),Nn.navigator&&/(msie|trident)/i.test(Nn.navigator.userAgent)):()=>!0,m_=Nn.hasStandardBrowserEnv?{write(e,t,o,a,s,i,r){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Te.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Te.isString(a)&&u.push(`path=${a}`),Te.isString(s)&&u.push(`domain=${s}`),i===!0&&u.push("secure"),Te.isString(r)&&u.push(`SameSite=${r}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function g_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function y_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xv(e,t,o){let a=!g_(t);return e&&(a||o==!1)?y_(e,t):t}const zh=e=>e instanceof co?{...e}:e;function ii(e,t){t=t||{};const o={};function a(f,p,g,k){return Te.isPlainObject(f)&&Te.isPlainObject(p)?Te.merge.call({caseless:k},f,p):Te.isPlainObject(p)?Te.merge({},p):Te.isArray(p)?p.slice():p}function s(f,p,g,k){if(Te.isUndefined(p)){if(!Te.isUndefined(f))return a(void 0,f,g,k)}else return a(f,p,g,k)}function i(f,p){if(!Te.isUndefined(p))return a(void 0,p)}function r(f,p){if(Te.isUndefined(p)){if(!Te.isUndefined(f))return a(void 0,f)}else return a(void 0,p)}function u(f,p,g){if(g in t)return a(f,p);if(g in e)return a(void 0,f)}const d={url:i,method:i,data:i,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:u,headers:(f,p,g)=>s(zh(f),zh(p),g,!0)};return Te.forEach(Object.keys({...e,...t}),function(p){const g=d[p]||s,k=g(e[p],t[p],p);Te.isUndefined(k)&&g!==u||(o[p]=k)}),o}const Iv=e=>{const t=ii({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:r,auth:u}=t;if(t.headers=r=co.from(r),t.url=bv(xv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&r.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Te.isFormData(o)){if(Nn.hasStandardBrowserEnv||Nn.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if(Te.isFunction(o.getHeaders)){const d=o.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,g])=>{f.includes(p.toLowerCase())&&r.set(p,g)})}}if(Nn.hasStandardBrowserEnv&&(a&&Te.isFunction(a)&&(a=a(t)),a||a!==!1&&v_(t.url))){const d=s&&i&&m_.read(i);d&&r.set(s,d)}return t},k_=typeof XMLHttpRequest<"u",__=k_&&function(e){return new Promise(function(o,a){const s=Iv(e);let i=s.data;const r=co.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=s,p,g,k,y,_;function w(){y&&y(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let S=new XMLHttpRequest;S.open(s.method.toUpperCase(),s.url,!0),S.timeout=s.timeout;function E(){if(!S)return;const x=co.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),R={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:x,config:e,request:S};Sv(function($){o($),w()},function($){a($),w()},R),S=null}"onloadend"in S?S.onloadend=E:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(E)},S.onabort=function(){S&&(a(new pt("Request aborted",pt.ECONNABORTED,e,S)),S=null)},S.onerror=function(D){const R=D&&D.message?D.message:"Network Error",H=new pt(R,pt.ERR_NETWORK,e,S);H.event=D||null,a(H),S=null},S.ontimeout=function(){let D=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||wv;s.timeoutErrorMessage&&(D=s.timeoutErrorMessage),a(new pt(D,R.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,S)),S=null},i===void 0&&r.setContentType(null),"setRequestHeader"in S&&Te.forEach(r.toJSON(),function(D,R){S.setRequestHeader(R,D)}),Te.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),u&&u!=="json"&&(S.responseType=s.responseType),f&&([k,_]=Nr(f,!0),S.addEventListener("progress",k)),d&&S.upload&&([g,y]=Nr(d),S.upload.addEventListener("progress",g),S.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(p=x=>{S&&(a(!x||x.type?new qi(null,e,S):x),S.abort(),S=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const A=h_(s.url);if(A&&Nn.protocols.indexOf(A)===-1){a(new pt("Unsupported protocol "+A+":",pt.ERR_BAD_REQUEST,e));return}S.send(i||null)})},b_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,s;const i=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;a.abort(p instanceof pt?p:new qi(p instanceof Error?p.message:p))}};let r=t&&setTimeout(()=>{r=null,i(new pt(`timeout ${t} of ms exceeded`,pt.ETIMEDOUT))},t);const u=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Te.asap(u),d}},w_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,s;for(;a<o;)s=a+t,yield e.slice(a,s),a=s},C_=async function*(e,t){for await(const o of L_(e))yield*w_(o,t)},L_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Hh=(e,t,o,a)=>{const s=C_(e,t);let i=0,r,u=d=>{r||(r=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await s.next();if(f){u(),d.close();return}let g=p.byteLength;if(o){let k=i+=g;o(k)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Vh=64*1024,{isFunction:dr}=Te,S_=(({Request:e,Response:t})=>({Request:e,Response:t}))(Te.global),{ReadableStream:Gh,TextEncoder:jh}=Te.global,Zh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},x_=e=>{e=Te.merge.call({skipUndefined:!0},S_,e);const{fetch:t,Request:o,Response:a}=e,s=t?dr(t):typeof fetch=="function",i=dr(o),r=dr(a);if(!s)return!1;const u=s&&dr(Gh),d=s&&(typeof jh=="function"?(_=>w=>_.encode(w))(new jh):async _=>new Uint8Array(await new o(_).arrayBuffer())),f=i&&u&&Zh(()=>{let _=!1;const w=new o(Nn.origin,{body:new Gh,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!w}),p=r&&u&&Zh(()=>Te.isReadableStream(new a("").body)),g={stream:p&&(_=>_.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!g[_]&&(g[_]=(w,S)=>{let E=w&&w[_];if(E)return E.call(w);throw new pt(`Response type '${_}' is not supported`,pt.ERR_NOT_SUPPORT,S)})});const k=async _=>{if(_==null)return 0;if(Te.isBlob(_))return _.size;if(Te.isSpecCompliantForm(_))return(await new o(Nn.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(_)||Te.isArrayBuffer(_))return _.byteLength;if(Te.isURLSearchParams(_)&&(_=_+""),Te.isString(_))return(await d(_)).byteLength},y=async(_,w)=>{const S=Te.toFiniteNumber(_.getContentLength());return S??k(w)};return async _=>{let{url:w,method:S,data:E,signal:A,cancelToken:x,timeout:D,onDownloadProgress:R,onUploadProgress:H,responseType:$,headers:B,withCredentials:N="same-origin",fetchOptions:Z}=Iv(_),P=t||fetch;$=$?($+"").toLowerCase():"text";let G=b_([A,x&&x.toAbortSignal()],D),Y=null;const te=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let Q;try{if(H&&f&&S!=="get"&&S!=="head"&&(Q=await y(B,E))!==0){let he=new o(w,{method:"POST",body:E,duplex:"half"}),Re;if(Te.isFormData(E)&&(Re=he.headers.get("content-type"))&&B.setContentType(Re),he.body){const[et,Xe]=Fh(Q,Nr(Uh(H)));E=Hh(he.body,Vh,et,Xe)}}Te.isString(N)||(N=N?"include":"omit");const X=i&&"credentials"in o.prototype,ne={...Z,signal:G,method:S.toUpperCase(),headers:B.normalize().toJSON(),body:E,duplex:"half",credentials:X?N:void 0};Y=i&&new o(w,ne);let F=await(i?P(Y,Z):P(w,ne));const K=p&&($==="stream"||$==="response");if(p&&(R||K&&te)){const he={};["status","statusText","headers"].forEach(He=>{he[He]=F[He]});const Re=Te.toFiniteNumber(F.headers.get("content-length")),[et,Xe]=R&&Fh(Re,Nr(Uh(R),!0))||[];F=new a(Hh(F.body,Vh,et,()=>{Xe&&Xe(),te&&te()}),he)}$=$||"text";let fe=await g[Te.findKey(g,$)||"text"](F,_);return!K&&te&&te(),await new Promise((he,Re)=>{Sv(he,Re,{data:fe,headers:co.from(F.headers),status:F.status,statusText:F.statusText,config:_,request:Y})})}catch(X){throw te&&te(),X&&X.name==="TypeError"&&/Load failed|fetch/i.test(X.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,_,Y),{cause:X.cause||X}):pt.from(X,X&&X.code,_,Y)}}},I_=new Map,$v=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:s}=t,i=[a,s,o];let r=i.length,u=r,d,f,p=I_;for(;u--;)d=i[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:x_(t)),p=f;return f};$v();const sd={http:Gk,xhr:__,fetch:{get:$v}};Te.forEach(sd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const qh=e=>`- ${e}`,$_=e=>Te.isFunction(e)||e===null||e===!1;function T_(e,t){e=Te.isArray(e)?e:[e];const{length:o}=e;let a,s;const i={};for(let r=0;r<o;r++){a=e[r];let u;if(s=a,!$_(a)&&(s=sd[(u=String(a)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${u}'`);if(s&&(Te.isFunction(s)||(s=s.get(t))))break;i[u||"#"+r]=s}if(!s){const r=Object.entries(i).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=o?r.length>1?`since :
`+r.map(qh).join(`
`):" "+qh(r[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Tv={getAdapter:T_,adapters:sd};function Wc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new qi(null,e)}function Wh(e){return Wc(e),e.headers=co.from(e.headers),e.data=qc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Tv.getAdapter(e.adapter||jl.adapter,e)(e).then(function(a){return Wc(e),a.data=qc.call(e,e.transformResponse,a),a.headers=co.from(a.headers),a},function(a){return Lv(a)||(Wc(e),a&&a.response&&(a.response.data=qc.call(e,e.transformResponse,a.response),a.response.headers=co.from(a.response.headers))),Promise.reject(a)})}const Mv="1.13.2",vc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{vc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Kh={};vc.transitional=function(t,o,a){function s(i,r){return"[Axios v"+Mv+"] Transitional option '"+i+"'"+r+(a?". "+a:"")}return(i,r,u)=>{if(t===!1)throw new pt(s(r," has been removed"+(o?" in "+o:"")),pt.ERR_DEPRECATED);return o&&!Kh[r]&&(Kh[r]=!0,console.warn(s(r," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,r,u):!0}};vc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function M_(e,t,o){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],r=t[i];if(r){const u=e[i],d=u===void 0||r(u,i,e);if(d!==!0)throw new pt("option "+i+" must be "+d,pt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new pt("Unknown option "+i,pt.ERR_BAD_OPTION)}}const br={assertOptions:M_,validators:vc},us=br.validators;let oi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Bh,response:new Bh}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ii(this.defaults,o);const{transitional:a,paramsSerializer:s,headers:i}=o;a!==void 0&&br.assertOptions(a,{silentJSONParsing:us.transitional(us.boolean),forcedJSONParsing:us.transitional(us.boolean),clarifyTimeoutError:us.transitional(us.boolean)},!1),s!=null&&(Te.isFunction(s)?o.paramsSerializer={serialize:s}:br.assertOptions(s,{encode:us.function,serialize:us.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),br.assertOptions(o,{baseUrl:us.spelling("baseURL"),withXsrfToken:us.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let r=i&&Te.merge(i.common,i[o.method]);i&&Te.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),o.headers=co.concat(r,i);const u=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(o)===!1||(d=d&&w.synchronous,u.unshift(w.fulfilled,w.rejected))});const f=[];this.interceptors.response.forEach(function(w){f.push(w.fulfilled,w.rejected)});let p,g=0,k;if(!d){const _=[Wh.bind(this),void 0];for(_.unshift(...u),_.push(...f),k=_.length,p=Promise.resolve(o);g<k;)p=p.then(_[g++],_[g++]);return p}k=u.length;let y=o;for(;g<k;){const _=u[g++],w=u[g++];try{y=_(y)}catch(S){w.call(this,S);break}}try{p=Wh.call(this,y)}catch(_){return Promise.reject(_)}for(g=0,k=f.length;g<k;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=ii(this.defaults,t);const o=xv(t.baseURL,t.url,t.allowAbsoluteUrls);return bv(o,t.params,t.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(t){oi.prototype[t]=function(o,a){return this.request(ii(a||{},{method:t,url:o,data:(a||{}).data}))}});Te.forEach(["post","put","patch"],function(t){function o(a){return function(i,r,u){return this.request(ii(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:r}))}}oi.prototype[t]=o(),oi.prototype[t+"Form"]=o(!0)});let A_=class Av{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const r=new Promise(u=>{a.subscribe(u),i=u}).then(s);return r.cancel=function(){a.unsubscribe(i)},r},t(function(i,r,u){a.reason||(a.reason=new qi(i,r,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Av(function(s){t=s}),cancel:t}}};function E_(e){return function(o){return e.apply(null,o)}}function P_(e){return Te.isObject(e)&&e.isAxiosError===!0}const wu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(wu).forEach(([e,t])=>{wu[t]=e});function Ev(e){const t=new oi(e),o=cv(oi.prototype.request,t);return Te.extend(o,oi.prototype,t,{allOwnKeys:!0}),Te.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Ev(ii(e,s))},o}const sn=Ev(jl);sn.Axios=oi;sn.CanceledError=qi;sn.CancelToken=A_;sn.isCancel=Lv;sn.VERSION=Mv;sn.toFormData=pc;sn.AxiosError=pt;sn.Cancel=sn.CanceledError;sn.all=function(t){return Promise.all(t)};sn.spread=E_;sn.isAxiosError=P_;sn.mergeConfig=ii;sn.AxiosHeaders=co;sn.formToJSON=e=>Cv(Te.isHTMLForm(e)?new FormData(e):e);sn.getAdapter=Tv.getAdapter;sn.HttpStatusCode=wu;sn.default=sn;const{Axios:sH,AxiosError:aH,CanceledError:iH,isCancel:lH,CancelToken:rH,VERSION:cH,all:uH,Cancel:dH,isAxiosError:hH,spread:fH,toFormData:pH,AxiosHeaders:vH,HttpStatusCode:mH,formToJSON:gH,getAdapter:yH,mergeConfig:kH}=sn,ya="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",D_="VolunteerCheckinOffline",R_=1;let Xo=null;async function js(){return Xo||new Promise((e,t)=>{const o=indexedDB.open(D_,R_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Xo=o.result,e(Xo)},o.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Ol(e,t){return await js(),new Promise((o,a)=>{const s=Xo.transaction(["eventData","syncMeta"],"readwrite"),i=s.objectStore("eventData"),r=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),r.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function Ca(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function wr(e,t,o){const a=await Ca(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await Ol(e,a))}async function O_(e){return await js(),new Promise((t,o)=>{const s=Xo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},r=s.add(i);r.onsuccess=()=>t(r.result),r.onerror=()=>o(r.error)})}async function Pv(){return await js(),new Promise((e,t)=>{const i=Xo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const r=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(r)},i.onerror=()=>t(i.error)})}async function Fr(){return(await Pv()).length}async function Jh(e,t){return await js(),new Promise((o,a)=>{const s=Xo.transaction(["pendingActions"],"readwrite"),i=s.objectStore("pendingActions"),r=i.get(e);r.onsuccess=()=>{const u=r.result;u&&(Object.assign(u,t),i.put(u))},s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function Yh(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function B_(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const We=sn.create({baseURL:ya,headers:{"Content-Type":"application/json"},timeout:15e3});let Cu=!1,Dv={type:null,eventId:null};function _o(e,t=null){Dv={type:e,eventId:t}}async function N_(){}function Xh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function F_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Rv(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Dv}const U_=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];We.interceptors.request.use(e=>{if(U_.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Rv();let s=null;if(a.type==="marshal"&&a.eventId){const i=Br(a.eventId);i?.token&&(s=i.token)}return s||(s=localStorage.getItem("sessionToken")),s&&(e.headers.Authorization=`Bearer ${s}`),e});let Ur=0;const z_=2;function H_(){if(Ur++,Ur>=z_&&Rv().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function V_(){Ur=0}function Kc(){Ur=0}function G_(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const s=window.location.hash||"";return!!(s.match(/#\/event\/[^/?]+/)||s==="#/marshal"||s.startsWith("#/marshal?"))}We.interceptors.response.use(e=>{Cu=!1,V_();const t=e.config.url,o=Xh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return G_(t)||H_(),Promise.reject(e);if(F_(e)&&(Cu=!0,t.method==="get")){const o=Xh(t.url);if(o){const a=await Ca(o);if(a)return console.log("Returning cached data for:",t.url),Promise.resolve({data:a,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function ko(e,t,o){return await O_({type:e,payload:t,eventId:t.eventId}),await N_(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function Pn(){return Cu||!navigator.onLine}const j_={check:()=>We.head("/health")},Lu=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),vs={requestLogin:e=>We.post("/auth/request-login",{email:e,frontendUrl:Lu()}),verifyToken:e=>We.post("/auth/verify-token",{token:e}),instantLogin:e=>We.post("/auth/instant-login",{email:e}),createAdmin:e=>We.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>We.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>We.get("/auth/me",{params:{eventId:e}}),logout:()=>We.post("/auth/logout")},hr={getProfile:()=>We.get("/auth/profile"),updateProfile:e=>We.put("/auth/profile",e),getPerson:(e,t)=>We.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>We.put(`/people/${e}`,o,{params:{eventId:t}})},ka={create:e=>We.post("/events",e),getAll:()=>We.get("/events"),getById:e=>We.get(`/events/${e}`),update:(e,t)=>We.put(`/events/${e}`,t),delete:e=>We.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),We.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Yn={create:e=>We.post("/locations",e),getById:(e,t)=>We.get(`/locations/${e}/${t}`),getByEvent:e=>We.get(`/events/${e}/locations`),update:(e,t,o)=>We.put(`/locations/${e}/${t}`,o),delete:(e,t)=>We.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),We.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>We.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>We.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>We.get(`/events/${e}/dynamic-checkpoints`)},hl={create:e=>We.post("/assignments",e),getById:(e,t)=>We.get(`/assignments/${e}/${t}`),getByEvent:e=>We.get(`/assignments/event/${e}`),delete:(e,t)=>We.delete(`/assignments/${e}/${t}`),getEventStatus:e=>We.get(`/events/${e}/status`)},La={checkIn:e=>We.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:s}={})=>We.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:s??null}),adminCheckIn:(e,t)=>We.post(`/checkin/admin/${e}/${t}`)},Jc={getAdmins:e=>We.get(`/events/${e}/admins`),addAdmin:(e,t)=>We.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>We.delete(`/events/${e}/admins/${t}`)},ms={create:e=>We.post("/marshals",e),getByEvent:e=>We.get(`/events/${e}/marshals`),getById:(e,t)=>We.get(`/marshals/${e}/${t}`),update:(e,t,o)=>We.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>We.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>We.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Lu()}}),sendMagicLink:(e,t)=>We.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Lu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),We.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},_a={create:e=>We.post("/areas",e),getByEvent:e=>We.get(`/events/${e}/areas`),getById:(e,t)=>We.get(`/areas/${e}/${t}`),update:(e,t,o)=>We.put(`/areas/${e}/${t}`,o),delete:(e,t)=>We.delete(`/areas/${e}/${t}`),recalculate:e=>We.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>We.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>We.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>We.post(`/events/${e}/checklist-items`,t),getByEvent:e=>We.get(`/events/${e}/checklist-items`),getById:(e,t)=>We.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>We.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>We.delete(`/checklist-items/${e}/${t}`),getReport:e=>We.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>We.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>We.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>We.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>We.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>We.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Es={create:(e,t)=>We.post(`/events/${e}/notes`,t),getByEvent:e=>We.get(`/events/${e}/notes`),getById:(e,t)=>We.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>We.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>We.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>We.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>We.get(`/events/${e}/my-notes`)},fa={create:(e,t)=>We.post(`/events/${e}/contacts`,t),getByEvent:e=>We.get(`/events/${e}/contacts`),getById:(e,t)=>We.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>We.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>We.delete(`/events/${e}/contacts/${t}`),getRoles:e=>We.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>We.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>We.get(`/events/${e}/my-contacts`)},fs={create:(e,t)=>We.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>We.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>We.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>We.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>We.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>We.post(`/events/${e}/incidents/${t}/notes`,{note:o})},je=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o},Z_={class:"hero-animation-container"},q_={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=T(!1);return nn(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,s)=>(v(),m("div",Z_,[(v(),m("svg",{viewBox:"0 0 400 350",class:pe(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...s[0]||(s[0]=[Er(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},W_=je(q_,[["__scopeId","data-v-cec8ae43"]]),K_={class:"hero-header"},J_={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=T(!1);return nn(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),m("div",K_,[Ee(W_,{animate:t.value},null,8,["animate"]),e.title?(v(),m("div",{key:0,class:pe(["hero-overlay",{"no-animate":!t.value}])},[l("h1",null,C(e.title),1)],2)):M("",!0)]))}},Ov=je(J_,[["__scopeId","data-v-c824ab01"]]),Zl=Yu("auth",()=>{const e=T(localStorage.getItem("adminEmail")||null),t=T(!!e.value),o=T(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await vs.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await vs.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},instantLogin:async u=>{const d=await vs.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},logout:async()=>{try{await vs.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),_o(null)}}}),Y_={class:"modal-card"},X_={key:0,class:"email-sent"},Q_={key:1},eb={class:"form-group"},tb=["disabled"],nb={key:0,class:"error"},ob={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,s=Zl(),i=T(""),r=T(!1),u=T(null),d=T(!1);async function f(){r.value=!0,u.value=null;try{const k=await s.requestLogin(i.value);k.success?(d.value=!0,a("success",i.value)):u.value=k.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{r.value=!1}}function p(){i.value="",d.value=!1,u.value=null}function g(){a("close")}return Ze(()=>o.show,k=>{k||setTimeout(()=>{p()},200)}),(k,y)=>(v(),qe(Tl,{to:"body"},[Ee(gs,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(g,["self"])},[l("div",Y_,[l("button",{class:"modal-close",onClick:g},""),d.value?(v(),m("div",X_,[y[2]||(y[2]=l("div",{class:"check-icon"},"",-1)),y[3]||(y[3]=l("h3",null,"Check your email!",-1)),l("p",null,[y[1]||(y[1]=Je("We've sent a login link to ",-1)),l("strong",null,C(i.value),1)]),y[4]||(y[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:p,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",Q_,[y[5]||(y[5]=l("h2",null,"Join us or login",-1)),y[6]||(y[6]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:rt(f,["prevent"])},[l("div",eb,[Ue(l("input",{"onUpdate:modelValue":y[0]||(y[0]=_=>i.value=_),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),l("button",{type:"submit",class:"btn btn-primary btn-full",disabled:r.value},C(r.value?"Sending...":"Send login link"),9,tb)],32),u.value?(v(),m("div",nb,C(u.value),1)):M("",!0)]))])],4)):M("",!0)]),_:1})]))}},Bv=je(ob,[["__scopeId","data-v-7c646305"]]),sb={class:"home"},ab={class:"hero-section"},ib={class:"content-section"},lb={class:"container"},rb={class:"carousel"},cb={class:"carousel-indicators"},ub=["onClick"],db={__name:"Home",setup(e){const t=uc(),o=Gi();function a(){const k=!!localStorage.getItem("adminEmail"),y=lv();return k||y}function s(){a()?o.push("/sessions"):p.value=!0}const i=T(0);let r=null;function u(k){i.value=k,f()}function d(){i.value=(i.value+1)%2}function f(){r&&clearInterval(r),r=setInterval(d,1e4)}const p=T(!1);function g(){p.value=!1,t.query.login&&o.replace({query:{}})}return nn(()=>{f(),t.query.login&&(a()?o.replace("/sessions"):p.value=!0)}),xn(()=>{r&&clearInterval(r)}),(k,y)=>(v(),m("div",sb,[l("section",ab,[Ee(Ov,{title:"OnTheDay"}),y[0]||(y[0]=l("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),l("button",{class:"btn btn-primary",onClick:s}," Join us or login ")]),l("section",ib,[l("div",lb,[y[2]||(y[2]=Er('<div class="features-grid" data-v-c615012d><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div></div>',1)),l("div",rb,[l("div",{class:"carousel-track",style:Qe({transform:`translateX(-${i.value*100}%)`})},[...y[1]||(y[1]=[Er('<div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div>',2)])],4),l("div",cb,[(v(),m(Ie,null,Ne(2,(_,w)=>l("button",{key:w,class:pe(["indicator",{active:i.value===w}]),onClick:S=>u(w)},null,10,ub)),64))])])])]),Ee(Bv,{show:p.value,onClose:g},null,8,["show"])]))}},hb=je(db,[["__scopeId","data-v-c615012d"]]),fb={class:"admin-login"},pb={class:"login-card"},vb={key:0,class:"email-sent"},mb={class:"form-group"},gb=["disabled"],yb={key:0,class:"error"},kb={__name:"AdminLogin",setup(e){const t=Zl(),o=T(""),a=T(!1),s=T(null),i=T(!1),r=async()=>{a.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,s.value=null};return(d,f)=>{const p=ju("router-link");return v(),m("div",fb,[l("div",pb,[f[7]||(f[7]=l("h2",null,"Admin login",-1)),i.value?(v(),m("div",vb,[f[2]||(f[2]=l("div",{class:"check-icon"},"",-1)),f[3]||(f[3]=l("h3",null,"Check your email!",-1)),l("p",null,[f[1]||(f[1]=Je("We've sent a login link to ",-1)),l("strong",null,C(o.value),1)]),f[4]||(f[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(Ie,{key:1},[f[5]||(f[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:rt(r,["prevent"])},[l("div",mb,[Ue(l("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:a.value},C(a.value?"Sending...":"Send login link"),9,gb)],32),s.value?(v(),m("div",yb,C(s.value),1)):M("",!0)],64)),Ee(p,{to:"/",class:"back-link"},{default:ze(()=>[...f[6]||(f[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},_b=je(kb,[["__scopeId","data-v-5d0a88c2"]]),bb={class:"admin-verify"},wb={class:"verify-card"},Cb={key:0,class:"status"},Lb={key:1,class:"status error"},Sb={key:2,class:"status success"},xb={__name:"AdminVerify",setup(e){const t=Gi(),o=uc(),a=Zl(),s=T(!0),i=T(null);return nn(async()=>{const r=o.query.token;if(!r){i.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await a.verifyToken(r);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(r,u)=>{const d=ju("router-link");return v(),m("div",bb,[l("div",wb,[s.value?(v(),m("div",Cb,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),m("div",Lb,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,C(i.value),1),Ee(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:ze(()=>[...u[1]||(u[1]=[Je(" Try again ",-1)])]),_:1})])):(v(),m("div",Sb,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to your sessions...",-1)])]))])])}}},Ib=je(xb,[["__scopeId","data-v-b2435a84"]]),Nv=Yu("events",()=>{const e=T([]),t=T(null),o=T([]),a=T([]),s=T(null),i=T(!1),r=T(null),u=async()=>{i.value=!0,r.value=null;try{const H=await ka.getAll();e.value=H.data}catch(H){throw r.value=H.message,H}finally{i.value=!1}},d=async H=>{i.value=!0,r.value=null;try{const $=await ka.getById(H);t.value=$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},f=async H=>{i.value=!0,r.value=null;try{const $=await ka.create(H);return e.value.push($.data),$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},p=async(H,$)=>{i.value=!0,r.value=null;try{const B=await ka.update(H,$),N=e.value.findIndex(Z=>Z.id===H);return N!==-1&&(e.value[N]=B.data),t.value?.id===H&&(t.value=B.data),B.data}catch(B){throw r.value=B.message,B}finally{i.value=!1}},g=async H=>{i.value=!0,r.value=null;try{await ka.delete(H),e.value=e.value.filter($=>$.id!==H)}catch($){throw r.value=$.message,$}finally{i.value=!1}},k=async H=>{i.value=!0,r.value=null;try{const $=await Yn.getByEvent(H);o.value=$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:s,loading:i,error:r,fetchEvents:u,fetchEvent:d,createEvent:f,updateEvent:p,deleteEvent:g,fetchLocations:k,createLocation:async H=>{i.value=!0,r.value=null;try{const $=await Yn.create(H);return o.value.push($.data),$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},updateLocation:async(H,$,B)=>{i.value=!0,r.value=null;try{const N=await Yn.update(H,$,B),Z=o.value.findIndex(P=>P.id===$);return Z!==-1&&(o.value[Z]=N.data),N.data}catch(N){throw r.value=N.message,N}finally{i.value=!1}},deleteLocation:async(H,$)=>{i.value=!0,r.value=null;try{await Yn.delete(H,$),o.value=o.value.filter(B=>B.id!==$)}catch(B){throw r.value=B.message,B}finally{i.value=!1}},bulkUpdateLocationTimes:async(H,$)=>{i.value=!0,r.value=null;try{const B=await Yn.bulkUpdateTimes(H,$);return await k(H),B.data}catch(B){throw r.value=B.message,B}finally{i.value=!1}},fetchAssignments:async H=>{i.value=!0,r.value=null;try{const $=await hl.getByEvent(H);a.value=$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},createAssignment:async H=>{i.value=!0,r.value=null;try{const $=await hl.create(H);return a.value.push($.data),$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},deleteAssignment:async(H,$)=>{i.value=!0,r.value=null;try{await hl.delete(H,$),a.value=a.value.filter(B=>B.id!==$)}catch(B){throw r.value=B.message,B}finally{i.value=!1}},fetchEventStatus:async H=>{i.value=!0,r.value=null;try{const $=await hl.getEventStatus(H);return s.value=$.data,$.data}catch($){throw r.value=$.message,$}finally{i.value=!1}},updateAssignmentCheckIn:H=>{const $=a.value.findIndex(B=>B.id===H.id);$!==-1&&(a.value[$]=H),s.value&&s.value.locations.forEach(B=>{const N=B.assignments.findIndex(Z=>Z.id===H.id);N!==-1&&(B.assignments[N]=H,B.checkedInCount=B.assignments.filter(Z=>Z.isCheckedIn).length)})}}});function Fv(e="details",t=[]){const o=T(e),a=g=>{o.value=g},s=()=>{o.value=e},i=g=>o.value===g,r=V(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const k=r.value;if(k===-1)return;const y=k+1;y<t.length?o.value=t[y]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const k=r.value;if(k===-1)return;const y=k-1;y>=0?o.value=t[y]:g&&(o.value=t[t.length-1])},f=V(()=>{if(t.length===0)return!1;const g=r.value;return g!==-1&&g<t.length-1}),p=V(()=>t.length===0?!1:r.value>0);return{activeTab:o,activeTabIndex:r,hasNextTab:f,hasPreviousTab:p,switchTab:a,resetTab:s,isActiveTab:i,nextTab:u,previousTab:d}}function $b(){const e=T(!1),t=T(""),o=T(""),a=T(null),s=T(!1),i=T("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:i,showConfirm:(p,g,k,y={})=>{t.value=p,o.value=g,a.value=k,s.value=y.isDanger||!1,i.value=y.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Mi=T({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Bs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Os={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ya(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Bs.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Uv(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return t==="Person points"?`${Bs.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function Su(e,t){return e==="Person points"?`${Bs.people[t]?.singular||"Person"} points`:e}function xu(e){e&&(Mi.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Ko=e=>e.toLowerCase(),Jo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ut(){const e=p=>{const g=Mi.value[p],k=Bs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const y=Mi.value.people;return`${Bs.people[y]?.singular||"Person"} point`}return k?.singular||g},t=p=>{const g=Mi.value[p],k=Bs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const y=Mi.value.people;return`${Bs.people[y]?.singular||"Person"} points`}return k?.plural||g},o=V(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=V(()=>({person:Ko(e("people")),checkpoint:Ko(e("checkpoint")),area:Ko(e("area")),checklist:Ko(e("checklist")),course:Ko(e("course")),people:Ko(t("people")),checkpoints:Ko(t("checkpoint")),areas:Ko(t("area")),checklists:Ko(t("checklist")),courses:Ko(t("course"))})),s=V(()=>({person:Jo(e("people")),checkpoint:Jo(e("checkpoint")),area:Jo(e("area")),checklist:Jo(e("checklist")),course:Jo(e("course")),people:Jo(t("people")),checkpoints:Jo(t("checkpoint")),areas:Jo(t("area")),checklists:Jo(t("checklist")),courses:Jo(t("course"))})),i=V(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:s,tabLabels:i,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>Ko(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>Jo(g?t(p):e(p)),terminology:Mi}}function Tb(){const e=T(!1),t=T(null),o=T({}),a=T(null),s=T(null),i=T([]),r=T(null),u=T(null),d=T(!1),f=T(!1),p=T(1),g=V(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),k=Y=>{if(Y){const te=Y.getMapCenter?.(),Q=Y.getMapZoom?.();te&&Q!==null&&(r.value=te,u.value=Q)}},y=(Y={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Y.title||"Select checkpoint location",description:Y.description||"Click on the map to set the location. Click again to reposition."}},_=(Y,te="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${te}: ${Y}`,description:"Click on the map to set the new location"}},w=(Y={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:Y.title||"Draw area boundary",description:Y.description||"Click to add points. Click Done when finished to complete the area."}},S=(Y=1)=>{p.value=Y,i.value=[],e.value=!0,t.value="add-multiple",f.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},E=Y=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=Y:t.value==="add-multiple"&&A(Y)},A=Y=>{i.value.push({id:`temp-${p.value}`,name:`Checkpoint ${p.value}`,description:"",latitude:Y.lat,longitude:Y.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),p.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},x=Y=>{s.value=Y},D=()=>s.value&&s.value.length>=3?s.value.map(Y=>({lat:Y.lat,lng:Y.lng})):null,R=()=>{e.value=!1,t.value=null,o.value={},a.value=null,r.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:s,tempCheckpoints:i,savedMapCenter:r,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:f,multiCheckpointCounter:p,canCompleteFullscreen:g,saveMapState:k,enterPlaceCheckpointMode:y,enterMoveCheckpointMode:_,enterDrawAreaMode:w,enterAddMultipleMode:S,handleFullscreenMapClick:E,handlePolygonDrawing:x,getCompletedPolygon:D,exitFullscreen:R,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],f.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),R()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],f.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(Y,te,Q)=>V(()=>{const X=[...Y.value];return t.value==="place-checkpoint"&&a.value&&X.push({id:"temp-single",name:te.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:te.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&Q.value&&X.push({id:"temp-move",name:Q.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:Q.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&X.push(...i.value),X}),createDisplayAreas:(Y,te)=>V(()=>{const Q=[...Y.value];if(t.value==="draw-area"&&te.value?.polygon?.length>0){const X=Q.findIndex(ne=>ne.id===te.value.id);X>=0?Q[X]={...te.value}:Q.push({...te.value,id:te.value.id||"temp-area"})}return Q}),calculateStartingNumber:Y=>{const te=Y.value.map(Q=>{const X=Q.name.match(/^Checkpoint (\d+)$/);return X?parseInt(X[1]):0}).filter(Q=>Q>0);return te.length>0?Math.max(...te)+1:1}}}function Mb(e){const t=T([]),o=T(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Jc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Jc.addAdmin(e.value,d)},removeAdmin:async d=>{await Jc.removeAdmin(e.value,d)}}}function Ab(e){const t=T(!1),o=T(!1),a=T(!1),s=T(!1),i=T(!1),r=T(!1),u=T(null),d=T(null),f=T(null),p=T(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:s,importing:i,importingMarshals:r,uploadError:u,importError:d,importResult:f,importMarshalsResult:p,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async R=>{if(!R)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await ka.uploadGpx(e.value,R),!0}catch(H){return console.error("Failed to upload route:",H),u.value=H.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,f.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,f.value=null},importLocations:async(R,H)=>{if(!R)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,f.value=null;try{const $=await Yn.importCsv(e.value,R,H);return f.value=$.data,$.data}catch($){return console.error("Failed to import locations:",$),d.value=$.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,p.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,p.value=null},importMarshals:async R=>{if(!R)return d.value="Please select a CSV file",null;r.value=!0,d.value=null,p.value=null;try{const H=await ms.importCsv(e.value,R);return p.value=H.data,H.data}catch(H){return console.error("Failed to import marshals:",H),d.value=H.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{r.value=!1}},formatImportResultMessage:(R,H="location")=>{const $=H==="location"?"location(s)":"marshal(s)";let N=`<p>Created <strong>${R[H==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${$} and <strong>${R.assignmentsCreated}</strong> assignment(s)</p>`;return R.errors&&R.errors.length>0&&(N+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',R.errors.forEach(Z=>{N+=`<li>${Z}</li>`}),N+="</ul>"),N}}}const zv="admin-theme-preference",Wa=T(Eb());function Eb(){return typeof window>"u"?"system":localStorage.getItem(zv)||"system"}function Pb(e){localStorage.setItem(zv,e)}function Hv(){const e=V(()=>Wa.value==="system"?"light dark":Wa.value),t=(s,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Wa.value=s,Pb(s)},o=()=>{const s=["system","light","dark"],r=(s.indexOf(Wa.value)+1)%s.length;t(s[r])},a=V(()=>Wa.value==="dark"?!0:Wa.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Wa,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const Vv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Bl=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${s}T${i}:${r}`},zr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},Db=(e,t,o,a)=>{const i=e*Math.PI/180,r=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,f=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(r)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))},Rb=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ob(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fl={exports:{}};var Bb=fl.exports,Qh;function Nb(){return Qh||(Qh=1,(function(e,t){(function(o,a){a(t)})(Bb,(function(o){var a="1.9.4";function s(n){var c,h,b,I;for(h=1,b=arguments.length;h<b;h++){I=arguments[h];for(c in I)n[c]=I[c]}return n}var i=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function r(n,c){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var b=h.call(arguments,2);return function(){return n.apply(c,b.length?b.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,c,h){var b,I,U,oe;return oe=function(){b=!1,I&&(U.apply(h,I),I=!1)},U=function(){b?I=arguments:(n.apply(h,arguments),setTimeout(oe,c),b=!0)},U}function p(n,c,h){var b=c[1],I=c[0],U=b-I;return n===b&&h?n:((n-I)%U+U)%U+I}function g(){return!1}function k(n,c){if(c===!1)return n;var h=Math.pow(10,c===void 0?6:c);return Math.round(n*h)/h}function y(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function _(n){return y(n).split(/\s+/)}function w(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var h in c)n.options[h]=c[h];return n.options}function S(n,c,h){var b=[];for(var I in n)b.push(encodeURIComponent(h?I.toUpperCase():I)+"="+encodeURIComponent(n[I]));return(!c||c.indexOf("?")===-1?"?":"&")+b.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function A(n,c){return n.replace(E,function(h,b){var I=c[b];if(I===void 0)throw new Error("No value provided for variable "+h);return typeof I=="function"&&(I=I(c)),I})}var x=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function D(n,c){for(var h=0;h<n.length;h++)if(n[h]===c)return h;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var $=0;function B(n){var c=+new Date,h=Math.max(0,16-(c-$));return $=c+h,window.setTimeout(n,h)}var N=window.requestAnimationFrame||H("RequestAnimationFrame")||B,Z=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function P(n,c,h){if(h&&N===B)n.call(c);else return N.call(window,r(n,c))}function G(n){n&&Z.call(window,n)}var Y={__proto__:null,extend:s,create:i,bind:r,get lastId(){return u},stamp:d,throttle:f,wrapNum:p,falseFn:g,formatNum:k,trim:y,splitWords:_,setOptions:w,getParamString:S,template:A,isArray:x,indexOf:D,emptyImageUrl:R,requestFn:N,cancelFn:Z,requestAnimFrame:P,cancelAnimFrame:G};function te(){}te.extend=function(n){var c=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,b=i(h);b.constructor=c,c.prototype=b;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(c[I]=this[I]);return n.statics&&s(c,n.statics),n.includes&&(Q(n.includes),s.apply(null,[b].concat(n.includes))),s(b,n),delete b.statics,delete b.includes,b.options&&(b.options=h.options?i(h.options):{},s(b.options,n.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var U=0,oe=b._initHooks.length;U<oe;U++)b._initHooks[U].call(this)}},c},te.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},te.mergeOptions=function(n){return s(this.prototype.options,n),this},te.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Q(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=x(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var X={on:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c);else{n=_(n);for(var I=0,U=n.length;I<U;I++)this._on(n[I],c,h)}return this},off:function(n,c,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var b in n)this._off(b,n[b],c);else{n=_(n);for(var I=arguments.length===1,U=0,oe=n.length;U<oe;U++)I?this._off(n[U]):this._off(n[U],c,h)}return this},_on:function(n,c,h,b){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,h)===!1){h===this&&(h=void 0);var I={fn:c,ctx:h};b&&(I.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(I)}},_off:function(n,c,h){var b,I,U;if(this._events&&(b=this._events[n],!!b)){if(arguments.length===1){if(this._firingCount)for(I=0,U=b.length;I<U;I++)b[I].fn=g;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var oe=this._listens(n,c,h);if(oe!==!1){var we=b[oe];this._firingCount&&(we.fn=g,this._events[n]=b=b.slice()),b.splice(oe,1)}}},fire:function(n,c,h){if(!this.listens(n,h))return this;var b=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var I=this._events[n];if(I){this._firingCount=this._firingCount+1||1;for(var U=0,oe=I.length;U<oe;U++){var we=I[U],$e=we.fn;we.once&&this.off(n,$e,we.ctx),$e.call(we.ctx||this,b)}this._firingCount--}}return h&&this._propagateEvent(b),this},listens:function(n,c,h,b){typeof n!="string"&&console.warn('"string" type argument expected');var I=c;typeof c!="function"&&(b=!!c,I=void 0,h=void 0);var U=this._events&&this._events[n];if(U&&U.length&&this._listens(n,I,h)!==!1)return!0;if(b){for(var oe in this._eventParents)if(this._eventParents[oe].listens(n,c,h,b))return!0}return!1},_listens:function(n,c,h){if(!this._events)return!1;var b=this._events[n]||[];if(!c)return!!b.length;h===this&&(h=void 0);for(var I=0,U=b.length;I<U;I++)if(b[I].fn===c&&b[I].ctx===h)return I;return!1},once:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c,!0);else{n=_(n);for(var I=0,U=n.length;I<U;I++)this._on(n[I],c,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};X.addEventListener=X.on,X.removeEventListener=X.clearAllEventListeners=X.off,X.addOneTimeEventListener=X.once,X.fireEvent=X.fire,X.hasEventListeners=X.listens;var ne=te.extend(X);function F(n,c,h){this.x=h?Math.round(n):n,this.y=h?Math.round(c):c}var K=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};F.prototype={clone:function(){return new F(this.x,this.y)},add:function(n){return this.clone()._add(fe(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(fe(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new F(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new F(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(n){n=fe(n);var c=n.x-this.x,h=n.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(n){return n=fe(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=fe(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function fe(n,c,h){return n instanceof F?n:x(n)?new F(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new F(n.x,n.y):new F(n,c,h)}function he(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}he.prototype={extend:function(n){var c,h;if(!n)return this;if(n instanceof F||typeof n[0]=="number"||"x"in n)c=h=fe(n);else if(n=Re(n),c=n.min,h=n.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return fe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return fe(this.min.x,this.max.y)},getTopRight:function(){return fe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,h;return typeof n[0]=="number"||n instanceof F?n=fe(n):n=Re(n),n instanceof he?(c=n.min,h=n.max):c=h=n,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Re(n);var c=this.min,h=this.max,b=n.min,I=n.max,U=I.x>=c.x&&b.x<=h.x,oe=I.y>=c.y&&b.y<=h.y;return U&&oe},overlaps:function(n){n=Re(n);var c=this.min,h=this.max,b=n.min,I=n.max,U=I.x>c.x&&b.x<h.x,oe=I.y>c.y&&b.y<h.y;return U&&oe},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,h=this.max,b=Math.abs(c.x-h.x)*n,I=Math.abs(c.y-h.y)*n;return Re(fe(c.x-b,c.y-I),fe(h.x+b,h.y+I))},equals:function(n){return n?(n=Re(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Re(n,c){return!n||n instanceof he?n:new he(n,c)}function et(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}et.prototype={extend:function(n){var c=this._southWest,h=this._northEast,b,I;if(n instanceof He)b=n,I=n;else if(n instanceof et){if(b=n._southWest,I=n._northEast,!b||!I)return this}else return n?this.extend(Ke(n)||Xe(n)):this;return!c&&!h?(this._southWest=new He(b.lat,b.lng),this._northEast=new He(I.lat,I.lng)):(c.lat=Math.min(b.lat,c.lat),c.lng=Math.min(b.lng,c.lng),h.lat=Math.max(I.lat,h.lat),h.lng=Math.max(I.lng,h.lng)),this},pad:function(n){var c=this._southWest,h=this._northEast,b=Math.abs(c.lat-h.lat)*n,I=Math.abs(c.lng-h.lng)*n;return new et(new He(c.lat-b,c.lng-I),new He(h.lat+b,h.lng+I))},getCenter:function(){return new He((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new He(this.getNorth(),this.getWest())},getSouthEast:function(){return new He(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof He||"lat"in n?n=Ke(n):n=Xe(n);var c=this._southWest,h=this._northEast,b,I;return n instanceof et?(b=n.getSouthWest(),I=n.getNorthEast()):b=I=n,b.lat>=c.lat&&I.lat<=h.lat&&b.lng>=c.lng&&I.lng<=h.lng},intersects:function(n){n=Xe(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),U=I.lat>=c.lat&&b.lat<=h.lat,oe=I.lng>=c.lng&&b.lng<=h.lng;return U&&oe},overlaps:function(n){n=Xe(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),U=I.lat>c.lat&&b.lat<h.lat,oe=I.lng>c.lng&&b.lng<h.lng;return U&&oe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=Xe(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Xe(n,c){return n instanceof et?n:new et(n,c)}function He(n,c,h){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,h!==void 0&&(this.alt=+h)}He.prototype={equals:function(n,c){if(!n)return!1;n=Ke(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+k(this.lat,n)+", "+k(this.lng,n)+")"},distanceTo:function(n){return Ve.distance(this,Ke(n))},wrap:function(){return Ve.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,h=c/Math.cos(Math.PI/180*this.lat);return Xe([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new He(this.lat,this.lng,this.alt)}};function Ke(n,c,h){return n instanceof He?n:x(n)&&typeof n[0]!="object"?n.length===3?new He(n[0],n[1],n[2]):n.length===2?new He(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new He(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new He(n,c,h)}var ye={latLngToPoint:function(n,c){var h=this.projection.project(n),b=this.scale(c);return this.transformation._transform(h,b)},pointToLatLng:function(n,c){var h=this.scale(c),b=this.transformation.untransform(n,h);return this.projection.unproject(b)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(n),b=this.transformation.transform(c.min,h),I=this.transformation.transform(c.max,h);return new he(b,I)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,b=n.alt;return new He(h,c,b)},wrapLatLngBounds:function(n){var c=n.getCenter(),h=this.wrapLatLng(c),b=c.lat-h.lat,I=c.lng-h.lng;if(b===0&&I===0)return n;var U=n.getSouthWest(),oe=n.getNorthEast(),we=new He(U.lat-b,U.lng-I),$e=new He(oe.lat-b,oe.lng-I);return new et(we,$e)}},Ve=s({},ye,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var h=Math.PI/180,b=n.lat*h,I=c.lat*h,U=Math.sin((c.lat-n.lat)*h/2),oe=Math.sin((c.lng-n.lng)*h/2),we=U*U+Math.cos(b)*Math.cos(I)*oe*oe,$e=2*Math.atan2(Math.sqrt(we),Math.sqrt(1-we));return this.R*$e}}),me=6378137,xe={R:me,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,h=this.MAX_LATITUDE,b=Math.max(Math.min(h,n.lat),-h),I=Math.sin(b*c);return new F(this.R*n.lng*c,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(n){var c=180/Math.PI;return new He((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=me*Math.PI;return new he([-n,-n],[n,n])})()};function De(n,c,h,b){if(x(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=h,this._d=b}De.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new F((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function q(n,c,h,b){return new De(n,c,h,b)}var J=s({},Ve,{code:"EPSG:3857",projection:xe,transformation:(function(){var n=.5/(Math.PI*xe.R);return q(n,.5,-n,.5)})()}),ve=s({},J,{code:"EPSG:900913"});function Se(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function re(n,c){var h="",b,I,U,oe,we,$e;for(b=0,U=n.length;b<U;b++){for(we=n[b],I=0,oe=we.length;I<oe;I++)$e=we[I],h+=(I?"L":"M")+$e.x+" "+$e.y;h+=c?Ge.svg?"z":"x":""}return h||"M0 0"}var ue=document.documentElement.style,ee="ActiveXObject"in window,W=ee&&!document.addEventListener,ie="msLaunchUri"in navigator&&!("documentMode"in document),Le=ot("webkit"),Ce=ot("android"),ke=ot("android 2")||ot("android 3"),j=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),se=Ce&&ot("Google")&&j<537&&!("AudioNode"in window),de=!!window.opera,Me=!ie&&ot("chrome"),Oe=ot("gecko")&&!Le&&!de&&!ee,Be=!Me&&ot("safari"),Ye=ot("phantom"),mt="OTransition"in ue,_t=navigator.platform.indexOf("Win")===0,bt=ee&&"transition"in ue,Mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ke,wt="MozPerspective"in ue,Nt=!window.L_DISABLE_3D&&(bt||Mt||wt)&&!mt&&!Ye,Ft=typeof orientation<"u"||ot("mobile"),Fn=Ft&&Le,Qn=Ft&&Mt,fn=!window.PointerEvent&&window.MSPointerEvent,jt=!!(window.PointerEvent||fn),yt="ontouchstart"in window||!!window.TouchEvent,eo=!window.L_NO_TOUCH&&(yt||jt),Un=Ft&&de,to=Ft&&Oe,pn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Zt=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return n})(),ks=(function(){return!!document.createElement("canvas").getContext})(),no=!!(document.createElementNS&&Se("svg").createSVGRect),Co=!!no&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),le=!no&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),ce=navigator.platform.indexOf("Mac")===0,ge=navigator.platform.indexOf("Linux")===0;function ot(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Ge={ie:ee,ielt9:W,edge:ie,webkit:Le,android:Ce,android23:ke,androidStock:se,opera:de,chrome:Me,gecko:Oe,safari:Be,phantom:Ye,opera12:mt,win:_t,ie3d:bt,webkit3d:Mt,gecko3d:wt,any3d:Nt,mobile:Ft,mobileWebkit:Fn,mobileWebkit3d:Qn,msPointer:fn,pointer:jt,touch:eo,touchNative:yt,mobileOpera:Un,mobileGecko:to,retina:pn,passiveEvents:Zt,canvas:ks,svg:no,vml:le,inlineSvg:Co,mac:ce,linux:ge},St=Ge.msPointer?"MSPointerDown":"pointerdown",Wt=Ge.msPointer?"MSPointerMove":"pointermove",Qt=Ge.msPointer?"MSPointerUp":"pointerup",Do=Ge.msPointer?"MSPointerCancel":"pointercancel",uo={touchstart:St,touchmove:Wt,touchend:Qt,touchcancel:Do},Ro={touchstart:So,touchmove:on,touchend:on,touchcancel:on},zn={},Ma=!1;function Oo(n,c,h){return c==="touchstart"&&Bo(),Ro[c]?(h=Ro[c].bind(this,h),n.addEventListener(uo[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function Lo(n,c,h){if(!uo[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(uo[c],h,!1)}function Zs(n){zn[n.pointerId]=n}function qs(n){zn[n.pointerId]&&(zn[n.pointerId]=n)}function vn(n){delete zn[n.pointerId]}function Bo(){Ma||(document.addEventListener(St,Zs,!0),document.addEventListener(Wt,qs,!0),document.addEventListener(Qt,vn,!0),document.addEventListener(Do,vn,!0),Ma=!0)}function on(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in zn)c.touches.push(zn[h]);c.changedTouches=[c],n(c)}}function So(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Kt(c),on(n,c)}function ho(n){var c={},h,b;for(b in n)h=n[b],c[b]=h&&h.bind?h.bind(n):h;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var _s=200;function xo(n,c){n.addEventListener("dblclick",c);var h=0,b;function I(U){if(U.detail!==1){b=U.detail;return}if(!(U.pointerType==="mouse"||U.sourceCapabilities&&!U.sourceCapabilities.firesTouchEvents)){var oe=Oa(U);if(!(oe.some(function($e){return $e instanceof HTMLLabelElement&&$e.attributes.for})&&!oe.some(function($e){return $e instanceof HTMLInputElement||$e instanceof HTMLSelectElement}))){var we=Date.now();we-h<=_s?(b++,b===2&&c(ho(U))):b=1,h=we}}}return n.addEventListener("click",I),{dblclick:c,simDblclick:I}}function bs(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var Io=Ws(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),No=Ws(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mn=No==="webkitTransition"||No==="OTransition"?No+"End":"transitionend";function $o(n){return typeof n=="string"?document.getElementById(n):n}function Hn(n,c){var h=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(n,null);h=b?b[c]:null}return h==="auto"?null:h}function vt(n,c,h){var b=document.createElement(n);return b.className=c||"",h&&h.appendChild(b),b}function xt(n){var c=n.parentNode;c&&c.removeChild(n)}function To(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function fo(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function Fo(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Aa(n,c){if(n.classList!==void 0)return n.classList.contains(c);var h=Uo(n);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function ht(n,c){if(n.classList!==void 0)for(var h=_(c),b=0,I=h.length;b<I;b++)n.classList.add(h[b]);else if(!Aa(n,c)){var U=Uo(n);Ea(n,(U?U+" ":"")+c)}}function Ut(n,c){n.classList!==void 0?n.classList.remove(c):Ea(n,y((" "+Uo(n)+" ").replace(" "+c+" "," ")))}function Ea(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function Uo(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function gn(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&ci(n,c)}function ci(n,c){var h=!1,b="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(b)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):n.style.filter+=" progid:"+b+"(opacity="+c+")"}function Ws(n){for(var c=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in c)return n[h];return!1}function po(n,c,h){var b=c||new F(0,0);n.style[Io]=(Ge.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(h?" scale("+h+")":"")}function qt(n,c){n._leaflet_pos=c,Ge.any3d?po(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function zo(n){return n._leaflet_pos||new F(0,0)}var yn,In,Pa;if("onselectstart"in document)yn=function(){lt(window,"selectstart",Kt)},In=function(){It(window,"selectstart",Kt)};else{var kn=Ws(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);yn=function(){if(kn){var n=document.documentElement.style;Pa=n[kn],n[kn]="none"}},In=function(){kn&&(document.documentElement.style[kn]=Pa,Pa=void 0)}}function Da(){lt(window,"dragstart",Kt)}function zt(){It(window,"dragstart",Kt)}var ws,Ks;function Js(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Ys(),ws=n,Ks=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",Ys))}function Ys(){ws&&(ws.style.outlineStyle=Ks,ws=void 0,Ks=void 0,It(window,"keydown",Ys))}function Ra(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function $n(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var Ho={__proto__:null,TRANSFORM:Io,TRANSITION:No,TRANSITION_END:mn,get:$o,getStyle:Hn,create:vt,remove:xt,empty:To,toFront:fo,toBack:Fo,hasClass:Aa,addClass:ht,removeClass:Ut,setClass:Ea,getClass:Uo,setOpacity:gn,testProp:Ws,setTransform:po,setPosition:qt,getPosition:zo,get disableTextSelection(){return yn},get enableTextSelection(){return In},disableImageDrag:Da,enableImageDrag:zt,preventOutline:Js,restoreOutline:Ys,getSizedParentNode:Ra,getScale:$n};function lt(n,c,h,b){if(c&&typeof c=="object")for(var I in c)mo(n,I,c[I],h);else{c=_(c);for(var U=0,oe=c.length;U<oe;U++)mo(n,c[U],h,b)}return this}var _n="_leaflet_events";function It(n,c,h,b){if(arguments.length===1)oo(n),delete n[_n];else if(c&&typeof c=="object")for(var I in c)is(n,I,c[I],h);else if(c=_(c),arguments.length===2)oo(n,function(we){return D(c,we)!==-1});else for(var U=0,oe=c.length;U<oe;U++)is(n,c[U],h,b);return this}function oo(n,c){for(var h in n[_n]){var b=h.split(/\d/)[0];(!c||c(b))&&is(n,b,null,null,h)}}var vo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mo(n,c,h,b){var I=c+d(h)+(b?"_"+d(b):"");if(n[_n]&&n[_n][I])return this;var U=function(we){return h.call(b||n,we||window.event)},oe=U;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?U=Oo(n,c,U):Ge.touch&&c==="dblclick"?U=xo(n,U):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(vo[c]||c,U,Ge.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(U=function(we){we=we||window.event,ea(n,we)&&oe(we)},n.addEventListener(vo[c],U,!1)):n.addEventListener(c,oe,!1):n.attachEvent("on"+c,U),n[_n]=n[_n]||{},n[_n][I]=U}function is(n,c,h,b,I){I=I||c+d(h)+(b?"_"+d(b):"");var U=n[_n]&&n[_n][I];if(!U)return this;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?Lo(n,c,U):Ge.touch&&c==="dblclick"?bs(n,U):"removeEventListener"in n?n.removeEventListener(vo[c]||c,U,!1):n.detachEvent("on"+c,U),n[_n][I]=null}function go(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Xs(n){return mo(n,"wheel",go),this}function Vo(n){return lt(n,"mousedown touchstart dblclick contextmenu",go),n._leaflet_disable_click=!0,this}function Kt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Go(n){return Kt(n),go(n),this}function Oa(n){if(n.composedPath)return n.composedPath();for(var c=[],h=n.target;h;)c.push(h),h=h.parentNode;return c}function Qs(n,c){if(!c)return new F(n.clientX,n.clientY);var h=$n(c),b=h.boundingClientRect;return new F((n.clientX-b.left)/h.x-c.clientLeft,(n.clientY-b.top)/h.y-c.clientTop)}var Ki=Ge.linux&&Ge.chrome?window.devicePixelRatio:Ge.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ui(n){return Ge.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ki:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function ea(n,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var di={__proto__:null,on:lt,off:It,stopPropagation:go,disableScrollPropagation:Xs,disableClickPropagation:Vo,preventDefault:Kt,stop:Go,getPropagationPath:Oa,getMousePosition:Qs,getWheelDelta:ui,isExternalTarget:ea,addListener:lt,removeListener:It},ta=ne.extend({run:function(n,c,h,b){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=zo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var h=this._startPos.add(this._offset.multiplyBy(n));c&&h._round(),qt(this._el,h),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),gt=ne.extend({options:{crs:J,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=w(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(Ke(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=No&&Ge.any3d&&!Ge.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,mn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(Ke(n),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var b=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,h.zoom):this._tryAnimatedPan(n,h.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,h){var b=this.getZoomScale(c),I=this.getSize().divideBy(2),U=n instanceof F?n:this.latLngToContainerPoint(n),oe=U.subtract(I).multiplyBy(1-1/b),we=this.containerPointToLatLng(I.add(oe));return this.setView(we,c,{zoom:h})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():Xe(n);var h=fe(c.paddingTopLeft||c.padding||[0,0]),b=fe(c.paddingBottomRight||c.padding||[0,0]),I=this.getBoundsZoom(n,!1,h.add(b));if(I=typeof c.maxZoom=="number"?Math.min(c.maxZoom,I):I,I===1/0)return{center:n.getCenter(),zoom:I};var U=b.subtract(h).divideBy(2),oe=this.project(n.getSouthWest(),I),we=this.project(n.getNorthEast(),I),$e=this.unproject(oe.add(we).divideBy(2).add(U),I);return{center:$e,zoom:I}},fitBounds:function(n,c){if(n=Xe(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=fe(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ta,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,h){if(h=h||{},h.animate===!1||!Ge.any3d)return this.setView(n,c,h);this._stop();var b=this.project(this.getCenter()),I=this.project(n),U=this.getSize(),oe=this._zoom;n=Ke(n),c=c===void 0?oe:c;var we=Math.max(U.x,U.y),$e=we*this.getZoomScale(oe,c),Fe=I.distanceTo(b)||1,nt=1.42,ct=nt*nt;function kt(an){var ar=an?-1:1,hm=an?$e:we,fm=$e*$e-we*we+ar*ct*ct*Fe*Fe,pm=2*hm*ct*Fe,Tc=fm/pm,Sd=Math.sqrt(Tc*Tc+1)-Tc,vm=Sd<1e-9?-18:Math.log(Sd);return vm}function Zn(an){return(Math.exp(an)-Math.exp(-an))/2}function dn(an){return(Math.exp(an)+Math.exp(-an))/2}function Mo(an){return Zn(an)/dn(an)}var ao=kt(0);function Si(an){return we*(dn(ao)/dn(ao+nt*an))}function rm(an){return we*(dn(ao)*Mo(ao+nt*an)-Zn(ao))/ct}function cm(an){return 1-Math.pow(1-an,1.5)}var um=Date.now(),Cd=(kt(1)-ao)/nt,dm=h.duration?1e3*h.duration:1e3*Cd*.8;function Ld(){var an=(Date.now()-um)/dm,ar=cm(an)*Cd;an<=1?(this._flyToFrame=P(Ld,this),this._move(this.unproject(b.add(I.subtract(b).multiplyBy(rm(ar)/Fe)),oe),this.getScaleZoom(we/Si(ar),oe),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ld.call(this),this},flyToBounds:function(n,c){var h=this._getBoundsCenterZoom(n,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(n){return n=Xe(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var h=this.getCenter(),b=this._limitCenter(h,this._zoom,Xe(n));return h.equals(b)||this.panTo(b,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var h=fe(c.paddingTopLeft||c.padding||[0,0]),b=fe(c.paddingBottomRight||c.padding||[0,0]),I=this.project(this.getCenter()),U=this.project(n),oe=this.getPixelBounds(),we=Re([oe.min.add(h),oe.max.subtract(b)]),$e=we.getSize();if(!we.contains(U)){this._enforcingBounds=!0;var Fe=U.subtract(we.getCenter()),nt=we.extend(U).getSize().subtract($e);I.x+=Fe.x<0?-nt.x:nt.x,I.y+=Fe.y<0?-nt.y:nt.y,this.panTo(this.unproject(I),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),b=c.divideBy(2).round(),I=h.divideBy(2).round(),U=b.subtract(I);return!U.x&&!U.y?this:(n.animate&&n.pan?this.panBy(U):(n.pan&&this._rawPanBy(U),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=r(this._handleGeolocationResponse,this),h=r(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,n):navigator.geolocation.getCurrentPosition(c,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,h=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,h=n.coords.longitude,b=new He(c,h),I=b.toBounds(n.coords.accuracy*2),U=this._locateOptions;if(U.setView){var oe=this.getBoundsZoom(I);this.setView(b,U.maxZoom?Math.min(oe,U.maxZoom):oe)}var we={latlng:b,bounds:I,timestamp:n.timestamp};for(var $e in n.coords)typeof n.coords[$e]=="number"&&(we[$e]=n.coords[$e]);this.fire("locationfound",we)}},addHandler:function(n,c){if(!c)return this;var h=this[n]=new c(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)xt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),b=vt("div",h,c||this._mapPane);return n&&(this._panes[n]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new et(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,h){n=Xe(n),h=fe(h||[0,0]);var b=this.getZoom()||0,I=this.getMinZoom(),U=this.getMaxZoom(),oe=n.getNorthWest(),we=n.getSouthEast(),$e=this.getSize().subtract(h),Fe=Re(this.project(we,b),this.project(oe,b)).getSize(),nt=Ge.any3d?this.options.zoomSnap:1,ct=$e.x/Fe.x,kt=$e.y/Fe.y,Zn=c?Math.max(ct,kt):Math.min(ct,kt);return b=this.getScaleZoom(Zn,b),nt&&(b=Math.round(b/(nt/100))*(nt/100),b=c?Math.ceil(b/nt)*nt:Math.floor(b/nt)*nt),Math.max(I,Math.min(U,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new F(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var h=this._getTopLeftPoint(n,c);return new he(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(n)/h.scale(c)},getScaleZoom:function(n,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var b=h.zoom(n*h.scale(c));return isNaN(b)?1/0:b},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(Ke(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(fe(n),c)},layerPointToLatLng:function(n){var c=fe(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(Ke(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Ke(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Xe(n))},distance:function(n,c){return this.options.crs.distance(Ke(n),Ke(c))},containerPointToLayerPoint:function(n){return fe(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return fe(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(fe(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ke(n)))},mouseEventToContainerPoint:function(n){return Qs(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=$o(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ge.any3d,ht(n,"leaflet-container"+(Ge.touch?" leaflet-touch":"")+(Ge.retina?" leaflet-retina":"")+(Ge.ielt9?" leaflet-oldie":"")+(Ge.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Hn(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qt(this._mapPane,new F(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(n.markerPane,"leaflet-zoom-hide"),ht(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,h){qt(this._mapPane,new F(0,0));var b=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var I=this._zoom!==c;this._moveStart(I,h)._move(n,c)._moveEnd(I),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,h,b){c===void 0&&(c=this._zoom);var I=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),b?h&&h.pinch&&this.fire("zoom",h):((I||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){qt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?It:lt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Ge.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var h=[],b,I=c==="mouseout"||c==="mouseover",U=n.target||n.srcElement,oe=!1;U;){if(b=this._targets[d(U)],b&&(c==="click"||c==="preclick")&&this._draggableMoved(b)){oe=!0;break}if(b&&b.listens(c,!0)&&(I&&!ea(U,n)||(h.push(b),I))||U===this._container)break;U=U.parentNode}return!h.length&&!oe&&!I&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var h=n.type;h==="mousedown"&&Js(c),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,h){if(n.type==="click"){var b=s({},n);b.type="preclick",this._fireDOMEvent(b,b.type,h)}var I=this._findEventTargets(n,c);if(h){for(var U=[],oe=0;oe<h.length;oe++)h[oe].listens(c,!0)&&U.push(h[oe]);I=U.concat(I)}if(I.length){c==="contextmenu"&&Kt(n);var we=I[0],$e={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Fe=we.getLatLng&&(!we._radius||we._radius<=10);$e.containerPoint=Fe?this.latLngToContainerPoint(we.getLatLng()):this.mouseEventToContainerPoint(n),$e.layerPoint=this.containerPointToLayerPoint($e.containerPoint),$e.latlng=Fe?we.getLatLng():this.layerPointToLatLng($e.layerPoint)}for(oe=0;oe<I.length;oe++)if(I[oe].fire(c,$e,!0),$e.originalEvent._stopped||I[oe].options.bubblingMouseEvents===!1&&D(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return zo(this._mapPane)||new F(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var h=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var h=this.getSize()._divideBy(2);return this.project(n,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return this.project(n,c)._subtract(b)},_latLngBoundsToNewLayerBounds:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return Re([this.project(n.getSouthWest(),c)._subtract(b),this.project(n.getNorthWest(),c)._subtract(b),this.project(n.getSouthEast(),c)._subtract(b),this.project(n.getNorthEast(),c)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,h){if(!h)return n;var b=this.project(n,c),I=this.getSize().divideBy(2),U=new he(b.subtract(I),b.add(I)),oe=this._getBoundsOffset(U,h,c);return Math.abs(oe.x)<=1&&Math.abs(oe.y)<=1?n:this.unproject(b.add(oe),c)},_limitOffset:function(n,c){if(!c)return n;var h=this.getPixelBounds(),b=new he(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(b,c))},_getBoundsOffset:function(n,c,h){var b=Re(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),I=b.min.subtract(n.min),U=b.max.subtract(n.max),oe=this._rebound(I.x,-U.x),we=this._rebound(I.y,-U.y);return new F(oe,we)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),h=this.getMaxZoom(),b=Ge.any3d?this.options.zoomSnap:1;return b&&(n=Math.round(n/b)*b),Math.max(c,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ut(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var h=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var n=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var h=Io,b=this._proxy.style[h];po(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),b===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();po(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(c),I=this._getCenterOffset(n)._divideBy(1-1/b);return h.animate!==!0&&!this.getSize().contains(I)?!1:(P(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,h,b){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ut(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ji(n,c){return new gt(n,c)}var bn=te.extend({options:{position:"topright"},initialize:function(n){w(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),h=this.getPosition(),b=n._controlCorners[h];return ht(c,"leaflet-control"),h.indexOf("bottom")!==-1?b.insertBefore(c,b.firstChild):b.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Cs=function(n){return new bn(n)};gt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",h=this._controlContainer=vt("div",c+"control-container",this._container);function b(I,U){var oe=c+I+" "+c+U;n[I+U]=vt("div",oe,h)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)xt(this._controlCorners[n]);xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ba=bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,h,b){return h<b?-1:b<h?1:0}},initialize:function(n,c,h){w(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in n)this._addLayer(n[b],b);for(b in c)this._addLayer(c[b],b,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return bn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Ut(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ut(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=vt("div",n),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Vo(c),Xs(c);var b=this._section=vt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),lt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=vt("a",n+"-toggle",c);I.href="#",I.title="Layers",I.setAttribute("role","button"),lt(I,{keydown:function(U){U.keyCode===13&&this._expandSafely()},click:function(U){Kt(U),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=vt("div",n+"-base",b),this._separator=vt("div",n+"-separator",b),this._overlaysList=vt("div",n+"-overlays",b),c.appendChild(b)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(r(function(b,I){return this.options.sortFunction(b.layer,I.layer,b.name,I.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;To(this._baseLayersList),To(this._overlaysList),this._layerControlInputs=[];var n,c,h,b,I=0;for(h=0;h<this._layers.length;h++)b=this._layers[h],this._addItem(b),c=c||b.overlay,n=n||!b.overlay,I+=b.overlay?0:1;return this.options.hideSingleBase&&(n=n&&I>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),h=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(n,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=h,b.firstChild},_addItem:function(n){var c=document.createElement("label"),h=this._map.hasLayer(n.layer),b;n.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=h):b=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(b),b.layerId=d(n.layer),lt(b,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+n.name;var U=document.createElement("span");c.appendChild(U),U.appendChild(b),U.appendChild(I);var oe=n.overlay?this._overlaysList:this._baseLayersList;return oe.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,h,b=[],I=[];this._handlingClick=!0;for(var U=n.length-1;U>=0;U--)c=n[U],h=this._getLayer(c.layerId).layer,c.checked?b.push(h):c.checked||I.push(h);for(U=0;U<I.length;U++)this._map.hasLayer(I[U])&&this._map.removeLayer(I[U]);for(U=0;U<b.length;U++)this._map.hasLayer(b[U])||this._map.addLayer(b[U]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,h,b=this._map.getZoom(),I=n.length-1;I>=0;I--)c=n[I],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&b<h.options.minZoom||h.options.maxZoom!==void 0&&b>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Kt),this.expand();var c=this;setTimeout(function(){It(n,"click",Kt),c._preventClick=!1})}}),hi=function(n,c,h){return new Ba(n,c,h)},na=bn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",h=vt("div",c+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,h,b,I){var U=vt("a",h,b);return U.innerHTML=n,U.href="#",U.title=c,U.setAttribute("role","button"),U.setAttribute("aria-label",c),Vo(U),lt(U,"click",Go),lt(U,"click",I,this),lt(U,"click",this._refocusOnMap,this),U},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";Ut(this._zoomInButton,c),Ut(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ht(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ht(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});gt.mergeOptions({zoomControl:!0}),gt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new na,this.addControl(this.zoomControl))});var Na=function(n){return new na(n)},Pe=bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",h=vt("div",c),b=this.options;return this._addScales(b,c+"-line",h),n.on(b.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,h){n.metric&&(this._mScale=vt("div",c,h)),n.imperial&&(this._iScale=vt("div",c,h))},_update:function(){var n=this._map,c=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/n)},_updateImperial:function(n){var c=n*3.2808399,h,b,I;c>5280?(h=c/5280,b=this._getRoundNum(h),this._updateScale(this._iScale,b+" mi",b/h)):(I=this._getRoundNum(c),this._updateScale(this._iScale,I+" ft",I/c))},_updateScale:function(n,c,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),h=n/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Ae=function(n){return new Pe(n)},at='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ft=bn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ge.inlineSvg?at+" ":"")+"Leaflet</a>"},initialize:function(n){w(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),Vo(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});gt.mergeOptions({attributionControl:!0}),gt.addInitHook(function(){this.options.attributionControl&&new ft().addTo(this)});var Ct=function(n){return new ft(n)};bn.Layers=Ba,bn.Zoom=na,bn.Scale=Pe,bn.Attribution=ft,Cs.layers=hi,Cs.zoom=Na,Cs.scale=Ae,Cs.attribution=Ct;var Ht=te.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ht.addTo=function(n,c){return n.addHandler(c,this),this};var Vn={Events:X},Gn=Ge.touch?"touchstart mousedown":"mousedown",At=ne.extend({options:{clickTolerance:3},initialize:function(n,c,h,b){w(this,b),this._element=n,this._dragStartTarget=c||n,this._preventOutline=h},enable:function(){this._enabled||(lt(this._dragStartTarget,Gn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(At._dragging===this&&this.finishDrag(!0),It(this._dragStartTarget,Gn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Aa(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){At._dragging===this&&this.finishDrag();return}if(!(At._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(At._dragging=this,this._preventOutline&&Js(this._element),Da(),yn(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,h=Ra(this._element);this._startPoint=new F(c.clientX,c.clientY),this._startPos=zo(this._element),this._parentScale=$n(h);var b=n.type==="mousedown";lt(document,b?"mousemove":"touchmove",this._onMove,this),lt(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,h=new F(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Kt(n),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),qt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Ut(document.body,"leaflet-dragging"),this._lastTarget&&(Ut(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),It(document,"mousemove touchmove",this._onMove,this),It(document,"mouseup touchend touchcancel",this._onUp,this),zt(),In();var c=this._moved&&this._moving;this._moving=!1,At._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Tn(n,c,h){var b,I=[1,4,2,8],U,oe,we,$e,Fe,nt,ct,kt;for(U=0,nt=n.length;U<nt;U++)n[U]._code=ls(n[U],c);for(we=0;we<4;we++){for(ct=I[we],b=[],U=0,nt=n.length,oe=nt-1;U<nt;oe=U++)$e=n[U],Fe=n[oe],$e._code&ct?Fe._code&ct||(kt=pi(Fe,$e,ct,c,h),kt._code=ls(kt,c),b.push(kt)):(Fe._code&ct&&(kt=pi(Fe,$e,ct,c,h),kt._code=ls(kt,c),b.push(kt)),b.push($e));n=b}return n}function $t(n,c){var h,b,I,U,oe,we,$e,Fe,nt;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ct=Ke([0,0]),kt=Xe(n),Zn=kt.getNorthWest().distanceTo(kt.getSouthWest())*kt.getNorthEast().distanceTo(kt.getNorthWest());Zn<1700&&(ct=Jt(n));var dn=n.length,Mo=[];for(h=0;h<dn;h++){var ao=Ke(n[h]);Mo.push(c.project(Ke([ao.lat-ct.lat,ao.lng-ct.lng])))}for(we=$e=Fe=0,h=0,b=dn-1;h<dn;b=h++)I=Mo[h],U=Mo[b],oe=I.y*U.x-U.y*I.x,$e+=(I.x+U.x)*oe,Fe+=(I.y+U.y)*oe,we+=oe*3;we===0?nt=Mo[0]:nt=[$e/we,Fe/we];var Si=c.unproject(fe(nt));return Ke([Si.lat+ct.lat,Si.lng+ct.lng])}function Jt(n){for(var c=0,h=0,b=0,I=0;I<n.length;I++){var U=Ke(n[I]);c+=U.lat,h+=U.lng,b++}return Ke([c/b,h/b])}var Mn={__proto__:null,clipPolygon:Tn,polygonCenter:$t,centroid:Jt};function jo(n,c){if(!c||!n.length)return n.slice();var h=c*c;return n=kc(n,h),n=Yi(n,h),n}function jn(n,c,h){return Math.sqrt(oa(n,c,h,!0))}function fi(n,c,h){return oa(n,c,h)}function Yi(n,c){var h=n.length,b=typeof Uint8Array<"u"?Uint8Array:Array,I=new b(h);I[0]=I[h-1]=1,Fa(n,I,c,0,h-1);var U,oe=[];for(U=0;U<h;U++)I[U]&&oe.push(n[U]);return oe}function Fa(n,c,h,b,I){var U=0,oe,we,$e;for(we=b+1;we<=I-1;we++)$e=oa(n[we],n[b],n[I],!0),$e>U&&(oe=we,U=$e);U>h&&(c[oe]=1,Fa(n,c,h,b,oe),Fa(n,c,h,oe,I))}function kc(n,c){for(var h=[n[0]],b=1,I=0,U=n.length;b<U;b++)_c(n[b],n[I])>c&&(h.push(n[b]),I=b);return I<U-1&&h.push(n[U-1]),h}var Kl;function Xi(n,c,h,b,I){var U=b?Kl:ls(n,h),oe=ls(c,h),we,$e,Fe;for(Kl=oe;;){if(!(U|oe))return[n,c];if(U&oe)return!1;we=U||oe,$e=pi(n,c,we,h,I),Fe=ls($e,h),we===U?(n=$e,U=Fe):(c=$e,oe=Fe)}}function pi(n,c,h,b,I){var U=c.x-n.x,oe=c.y-n.y,we=b.min,$e=b.max,Fe,nt;return h&8?(Fe=n.x+U*($e.y-n.y)/oe,nt=$e.y):h&4?(Fe=n.x+U*(we.y-n.y)/oe,nt=we.y):h&2?(Fe=$e.x,nt=n.y+oe*($e.x-n.x)/U):h&1&&(Fe=we.x,nt=n.y+oe*(we.x-n.x)/U),new F(Fe,nt,I)}function ls(n,c){var h=0;return n.x<c.min.x?h|=1:n.x>c.max.x&&(h|=2),n.y<c.min.y?h|=4:n.y>c.max.y&&(h|=8),h}function _c(n,c){var h=c.x-n.x,b=c.y-n.y;return h*h+b*b}function oa(n,c,h,b){var I=c.x,U=c.y,oe=h.x-I,we=h.y-U,$e=oe*oe+we*we,Fe;return $e>0&&(Fe=((n.x-I)*oe+(n.y-U)*we)/$e,Fe>1?(I=h.x,U=h.y):Fe>0&&(I+=oe*Fe,U+=we*Fe)),oe=n.x-I,we=n.y-U,b?oe*oe+we*we:new F(I,U)}function so(n){return!x(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Jl(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),so(n)}function Yl(n,c){var h,b,I,U,oe,we,$e,Fe;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var nt=Ke([0,0]),ct=Xe(n),kt=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());kt<1700&&(nt=Jt(n));var Zn=n.length,dn=[];for(h=0;h<Zn;h++){var Mo=Ke(n[h]);dn.push(c.project(Ke([Mo.lat-nt.lat,Mo.lng-nt.lng])))}for(h=0,b=0;h<Zn-1;h++)b+=dn[h].distanceTo(dn[h+1])/2;if(b===0)Fe=dn[0];else for(h=0,U=0;h<Zn-1;h++)if(oe=dn[h],we=dn[h+1],I=oe.distanceTo(we),U+=I,U>b){$e=(U-b)/I,Fe=[we.x-$e*(we.x-oe.x),we.y-$e*(we.y-oe.y)];break}var ao=c.unproject(fe(Fe));return Ke([ao.lat+nt.lat,ao.lng+nt.lng])}var bc={__proto__:null,simplify:jo,pointToSegmentDistance:jn,closestPointOnSegment:fi,clipSegment:Xi,_getEdgeIntersection:pi,_getBitCode:ls,_sqClosestPointOnSegment:oa,isFlat:so,_flat:Jl,polylineCenter:Yl},Qi={project:function(n){return new F(n.lng,n.lat)},unproject:function(n){return new He(n.y,n.x)},bounds:new he([-180,-90],[180,90])},el={R:6378137,R_MINOR:6356752314245179e-9,bounds:new he([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,h=this.R,b=n.lat*c,I=this.R_MINOR/h,U=Math.sqrt(1-I*I),oe=U*Math.sin(b),we=Math.tan(Math.PI/4-b/2)/Math.pow((1-oe)/(1+oe),U/2);return b=-h*Math.log(Math.max(we,1e-10)),new F(n.lng*c*h,b)},unproject:function(n){for(var c=180/Math.PI,h=this.R,b=this.R_MINOR/h,I=Math.sqrt(1-b*b),U=Math.exp(-n.y/h),oe=Math.PI/2-2*Math.atan(U),we=0,$e=.1,Fe;we<15&&Math.abs($e)>1e-7;we++)Fe=I*Math.sin(oe),Fe=Math.pow((1-Fe)/(1+Fe),I/2),$e=Math.PI/2-2*Math.atan(U*Fe)-oe,oe+=$e;return new He(oe*c,n.x*c/h)}},wc={__proto__:null,LonLat:Qi,Mercator:el,SphericalMercator:xe},Cc=s({},Ve,{code:"EPSG:3395",projection:el,transformation:(function(){var n=.5/(Math.PI*el.R);return q(n,.5,-n,.5)})()}),Xl=s({},Ve,{code:"EPSG:4326",projection:Qi,transformation:q(1/180,1,-1/180,.5)}),Lc=s({},ye,{projection:Qi,transformation:q(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var h=c.lng-n.lng,b=c.lat-n.lat;return Math.sqrt(h*h+b*b)},infinite:!0});ye.Earth=Ve,ye.EPSG3395=Cc,ye.EPSG3857=J,ye.EPSG900913=ve,ye.EPSG4326=Xl,ye.Simple=Lc;var yo=ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});gt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},_addLayers:function(n){n=n?x(n)?n:[n]:[];for(var c=0,h=n.length;c<h;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,h=this._getZoomSpan();for(var b in this._zoomBoundLayers){var I=this._zoomBoundLayers[b].options;n=I.minZoom===void 0?n:Math.min(n,I.minZoom),c=I.maxZoom===void 0?c:Math.max(c,I.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var sa=yo.extend({initialize:function(n,c){w(this,c),this._layers={};var h,b;if(n)for(h=0,b=n.length;h<b;h++)this.addLayer(n[h])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),h,b;for(h in this._layers)b=this._layers[h],b[n]&&b[n].apply(b,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),vi=function(n,c){return new sa(n,c)},Zo=sa.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),sa.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),sa.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new et;for(var c in this._layers){var h=this._layers[c];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),mi=function(n,c){return new Zo(n,c)},aa=te.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){w(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(b,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(n,c){var h=this.options,b=h[c+"Size"];typeof b=="number"&&(b=[b,b]);var I=fe(b),U=fe(c==="shadow"&&h.shadowAnchor||h.iconAnchor||I&&I.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(h.className||""),U&&(n.style.marginLeft=-U.x+"px",n.style.marginTop=-U.y+"px"),I&&(n.style.width=I.x+"px",n.style.height=I.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return Ge.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ql(n){return new aa(n)}var Ls=aa.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ls.imagePath!="string"&&(Ls.imagePath=this._detectIconPath()),(this.options.imagePath||Ls.imagePath)+aa.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(h,b,I){var U=b.exec(h);return U&&U[I]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=vt("div","leaflet-default-icon-path",document.body),c=Hn(n,"background-image")||Hn(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),gi=Ht.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new At(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ut(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,h=c._map,b=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,U=zo(c._icon),oe=h.getPixelBounds(),we=h.getPixelOrigin(),$e=Re(oe.min._subtract(we).add(I),oe.max._subtract(we).subtract(I));if(!$e.contains(U)){var Fe=fe((Math.max($e.max.x,U.x)-$e.max.x)/(oe.max.x-$e.max.x)-(Math.min($e.min.x,U.x)-$e.min.x)/(oe.min.x-$e.min.x),(Math.max($e.max.y,U.y)-$e.max.y)/(oe.max.y-$e.max.y)-(Math.min($e.min.y,U.y)-$e.min.y)/(oe.min.y-$e.min.y)).multiplyBy(b);h.panBy(Fe,{animate:!1}),this._draggable._newPos._add(Fe),this._draggable._startPos._add(Fe),qt(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=P(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,h=c._shadow,b=zo(c._icon),I=c._map.layerPointToLatLng(b);h&&qt(h,b),c._latlng=I,n.latlng=I,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),yi=yo.extend({options:{icon:new Ls,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){w(this,c),this._latlng=Ke(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=Ke(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),b=!1;h!==this._icon&&(this._icon&&this._removeIcon(),b=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ht(h,c),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(h,"focus",this._panOnFocus,this);var I=n.icon.createShadow(this._shadow),U=!1;I!==this._shadow&&(this._removeShadow(),U=!0),I&&(ht(I,c),I.alt=""),this._shadow=I,n.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&U&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&It(this._icon,"focus",this._panOnFocus,this),xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&qt(this._icon,n),this._shadow&&qt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),gi)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new gi(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&gn(this._icon,n),this._shadow&&gn(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,h=c.iconSize?fe(c.iconSize):fe(0,0),b=c.iconAnchor?fe(c.iconAnchor):fe(0,0);n.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:h.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Sc(n,c){return new yi(n,c)}var rs=yo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return w(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ki=rs.extend({options:{fill:!0,radius:10},initialize:function(n,c){w(this,c),this._latlng=Ke(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=Ke(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return rs.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,h=this._clickTolerance(),b=[n+h,c+h];this._pxBounds=new he(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xc(n,c){return new ki(n,c)}var tl=ki.extend({initialize:function(n,c,h){if(typeof c=="number"&&(c=s({},h,{radius:c})),w(this,c),this._latlng=Ke(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new et(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:rs.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,h=this._map,b=h.options.crs;if(b.distance===Ve.distance){var I=Math.PI/180,U=this._mRadius/Ve.R/I,oe=h.project([c+U,n]),we=h.project([c-U,n]),$e=oe.add(we).divideBy(2),Fe=h.unproject($e).lat,nt=Math.acos((Math.cos(U*I)-Math.sin(c*I)*Math.sin(Fe*I))/(Math.cos(c*I)*Math.cos(Fe*I)))/I;(isNaN(nt)||nt===0)&&(nt=U/Math.cos(Math.PI/180*c)),this._point=$e.subtract(h.getPixelOrigin()),this._radius=isNaN(nt)?0:$e.x-h.project([Fe,n-nt]).x,this._radiusY=$e.y-oe.y}else{var ct=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ct).x}this._updateBounds()}});function Ic(n,c,h){return new tl(n,c,h)}var qo=rs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){w(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,h=null,b=oa,I,U,oe=0,we=this._parts.length;oe<we;oe++)for(var $e=this._parts[oe],Fe=1,nt=$e.length;Fe<nt;Fe++){I=$e[Fe-1],U=$e[Fe];var ct=b(n,I,U,!0);ct<c&&(c=ct,h=b(n,I,U))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Yl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=Ke(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new et,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return so(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],h=so(n),b=0,I=n.length;b<I;b++)h?(c[b]=Ke(n[b]),this._bounds.extend(c[b])):c[b]=this._convertLatLngs(n[b]);return c},_project:function(){var n=new he;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new F(n,n);this._rawPxBounds&&(this._pxBounds=new he([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,h){var b=n[0]instanceof He,I=n.length,U,oe;if(b){for(oe=[],U=0;U<I;U++)oe[U]=this._map.latLngToLayerPoint(n[U]),h.extend(oe[U]);c.push(oe)}else for(U=0;U<I;U++)this._projectLatlngs(n[U],c,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,b,I,U,oe,we,$e;for(h=0,I=0,U=this._rings.length;h<U;h++)for($e=this._rings[h],b=0,oe=$e.length;b<oe-1;b++)we=Xi($e[b],$e[b+1],n,b,!0),we&&(c[I]=c[I]||[],c[I].push(we[0]),(we[1]!==$e[b+1]||b===oe-2)&&(c[I].push(we[1]),I++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,h=0,b=n.length;h<b;h++)n[h]=jo(n[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var h,b,I,U,oe,we,$e=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,U=this._parts.length;h<U;h++)for(we=this._parts[h],b=0,oe=we.length,I=oe-1;b<oe;I=b++)if(!(!c&&b===0)&&jn(n,we[I],we[b])<=$e)return!0;return!1}});function $c(n,c){return new qo(n,c)}qo._flat=Jl;var ia=qo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return $t(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=qo.prototype._convertLatLngs.call(this,n),h=c.length;return h>=2&&c[0]instanceof He&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(n){qo.prototype._setLatLngs.call(this,n),so(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return so(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,h=new F(c,c);if(n=new he(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,I=this._rings.length,U;b<I;b++)U=Tn(this._rings[b],n,!0),U.length&&this._parts.push(U)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,h,b,I,U,oe,we,$e,Fe;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(U=0,$e=this._parts.length;U<$e;U++)for(h=this._parts[U],oe=0,Fe=h.length,we=Fe-1;oe<Fe;we=oe++)b=h[oe],I=h[we],b.y>n.y!=I.y>n.y&&n.x<(I.x-b.x)*(n.y-b.y)/(I.y-b.y)+b.x&&(c=!c);return c||qo.prototype._containsPoint.call(this,n,!0)}});function er(n,c){return new ia(n,c)}var Wo=Zo.extend({initialize:function(n,c){w(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=x(n)?n:n.features,h,b,I;if(c){for(h=0,b=c.length;h<b;h++)I=c[h],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var U=this.options;if(U.filter&&!U.filter(n))return this;var oe=Ua(n,U);return oe?(oe.feature=wi(n),oe.defaultOptions=oe.options,this.resetStyle(oe),U.onEachFeature&&U.onEachFeature(n,oe),this.addLayer(oe)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function Ua(n,c){var h=n.type==="Feature"?n.geometry:n,b=h?h.coordinates:null,I=[],U=c&&c.pointToLayer,oe=c&&c.coordsToLatLng||nl,we,$e,Fe,nt;if(!b&&!h)return null;switch(h.type){case"Point":return we=oe(b),tr(U,n,we,c);case"MultiPoint":for(Fe=0,nt=b.length;Fe<nt;Fe++)we=oe(b[Fe]),I.push(tr(U,n,we,c));return new Zo(I);case"LineString":case"MultiLineString":return $e=_i(b,h.type==="LineString"?0:1,oe),new qo($e,c);case"Polygon":case"MultiPolygon":return $e=_i(b,h.type==="Polygon"?1:2,oe),new ia($e,c);case"GeometryCollection":for(Fe=0,nt=h.geometries.length;Fe<nt;Fe++){var ct=Ua({geometry:h.geometries[Fe],type:"Feature",properties:n.properties},c);ct&&I.push(ct)}return new Zo(I);case"FeatureCollection":for(Fe=0,nt=h.features.length;Fe<nt;Fe++){var kt=Ua(h.features[Fe],c);kt&&I.push(kt)}return new Zo(I);default:throw new Error("Invalid GeoJSON object.")}}function tr(n,c,h,b){return n?n(c,h):new yi(h,b&&b.markersInheritOptions&&b)}function nl(n){return new He(n[1],n[0],n[2])}function _i(n,c,h){for(var b=[],I=0,U=n.length,oe;I<U;I++)oe=c?_i(n[I],c-1,h):(h||nl)(n[I]),b.push(oe);return b}function za(n,c){return n=Ke(n),n.alt!==void 0?[k(n.lng,c),k(n.lat,c),k(n.alt,c)]:[k(n.lng,c),k(n.lat,c)]}function bi(n,c,h,b){for(var I=[],U=0,oe=n.length;U<oe;U++)I.push(c?bi(n[U],so(n[U])?0:c-1,h,b):za(n[U],b));return!c&&h&&I.length>0&&I.push(I[0].slice()),I}function la(n,c){return n.feature?s({},n.feature,{geometry:c}):wi(c)}function wi(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Ci={toGeoJSON:function(n){return la(this,{type:"Point",coordinates:za(this.getLatLng(),n)})}};yi.include(Ci),tl.include(Ci),ki.include(Ci),qo.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=bi(this._latlngs,c?1:0,!1,n);return la(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ia.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=c&&!so(this._latlngs[0]),b=bi(this._latlngs,h?2:c?1:0,!0,n);return c||(b=[b]),la(this,{type:(h?"Multi":"")+"Polygon",coordinates:b})}}),sa.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(n).geometry.coordinates)}),la(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var h=c==="GeometryCollection",b=[];return this.eachLayer(function(I){if(I.toGeoJSON){var U=I.toGeoJSON(n);if(h)b.push(U.geometry);else{var oe=wi(U);oe.type==="FeatureCollection"?b.push.apply(b,oe.features):b.push(oe)}}}),h?la(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function nr(n,c){return new Wo(n,c)}var Ha=nr,Va=yo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,h){this._url=n,this._bounds=Xe(c),w(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&fo(this._image),this},bringToBack:function(){return this._map&&Fo(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Xe(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:vt("img");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=r(this.fire,this,"load"),c.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;po(this._image,h,c)},_reset:function(){var n=this._image,c=new he(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();qt(n,c.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){gn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),or=function(n,c,h){return new Va(n,c,h)},ol=Va.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:vt("video");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=r(this.fire,this,"load"),n){for(var h=c.getElementsByTagName("source"),b=[],I=0;I<h.length;I++)b.push(h[I].src);this._url=h.length>0?b:[c.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var U=0;U<this._url.length;U++){var oe=vt("source");oe.src=this._url[U],c.appendChild(oe)}}});function z(n,c,h){return new ol(n,c,h)}var ae=Va.extend({_initImage:function(){var n=this._image=this._url;ht(n,"leaflet-image-layer"),this._zoomAnimated&&ht(n,"leaflet-zoom-animated"),this.options.className&&ht(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function _e(n,c,h){return new ae(n,c,h)}var be=yo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof He||x(n))?(this._latlng=Ke(n),w(this,c)):(w(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&gn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&gn(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(gn(this._container,0),this._removeTimeout=setTimeout(r(xt,void 0,this._container),200)):xt(this._container),this.options.interactive&&(Ut(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Ke(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fo(this._container),this},bringToBack:function(){return this._map&&Fo(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof Zo){c=null;var h=this._source._layers;for(var b in h)if(h[b]._map){c=h[b];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=fe(this.options.offset),h=this._getAnchor();this._zoomAnimated?qt(this._container,n.add(h)):c=c.add(n).add(h);var b=this._containerBottom=-c.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=b+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});gt.include({_initOverlay:function(n,c,h,b){var I=c;return I instanceof n||(I=new n(b).setContent(c)),h&&I.setLatLng(h),I}}),yo.include({_initOverlay:function(n,c,h,b){var I=h;return I instanceof n?(w(I,b),I._source=this):(I=c&&!b?c:new n(b,this),I.setContent(h)),I}});var tt=be.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,be.prototype.openOn.call(this,n)},onAdd:function(n){be.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof rs||this._source.on("preclick",go))},onRemove:function(n){be.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof rs||this._source.off("preclick",go))},getEvents:function(){var n=be.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=vt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=vt("div",n+"-content-wrapper",c);if(this._contentNode=vt("div",n+"-content",h),Vo(c),Xs(this._contentNode),lt(c,"contextmenu",go),this._tipContainer=vt("div",n+"-tip-container",c),this._tip=vt("div",n+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=vt("a",n+"-close-button",c);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',lt(b,"click",function(I){Kt(I),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var b=n.offsetHeight,I=this.options.maxHeight,U="leaflet-popup-scrolled";I&&b>I?(c.height=I+"px",ht(n,U)):Ut(n,U),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();qt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(Hn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,b=this._containerWidth,I=new F(this._containerLeft,-h-this._containerBottom);I._add(zo(this._container));var U=n.layerPointToContainerPoint(I),oe=fe(this.options.autoPanPadding),we=fe(this.options.autoPanPaddingTopLeft||oe),$e=fe(this.options.autoPanPaddingBottomRight||oe),Fe=n.getSize(),nt=0,ct=0;U.x+b+$e.x>Fe.x&&(nt=U.x+b-Fe.x+$e.x),U.x-nt-we.x<0&&(nt=U.x-we.x),U.y+h+$e.y>Fe.y&&(ct=U.y+h-Fe.y+$e.y),U.y-ct-we.y<0&&(ct=U.y-we.y),(nt||ct)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([nt,ct]))}},_getAnchor:function(){return fe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lt=function(n,c){return new tt(n,c)};gt.mergeOptions({closePopupOnClick:!0}),gt.include({openPopup:function(n,c,h){return this._initOverlay(tt,n,c,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),yo.include({bindPopup:function(n,c){return this._popup=this._initOverlay(tt,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Zo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Go(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof rs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Et=be.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){be.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){be.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=be.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,h,b=this._map,I=this._container,U=b.latLngToContainerPoint(b.getCenter()),oe=b.layerPointToContainerPoint(n),we=this.options.direction,$e=I.offsetWidth,Fe=I.offsetHeight,nt=fe(this.options.offset),ct=this._getAnchor();we==="top"?(c=$e/2,h=Fe):we==="bottom"?(c=$e/2,h=0):we==="center"?(c=$e/2,h=Fe/2):we==="right"?(c=0,h=Fe/2):we==="left"?(c=$e,h=Fe/2):oe.x<U.x?(we="right",c=0,h=Fe/2):(we="left",c=$e+(nt.x+ct.x)*2,h=Fe/2),n=n.subtract(fe(c,h,!0)).add(nt).add(ct),Ut(I,"leaflet-tooltip-right"),Ut(I,"leaflet-tooltip-left"),Ut(I,"leaflet-tooltip-top"),Ut(I,"leaflet-tooltip-bottom"),ht(I,"leaflet-tooltip-"+we),qt(I,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&gn(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return fe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),un=function(n,c){return new Et(n,c)};gt.include({openTooltip:function(n,c,h){return this._initOverlay(Et,n,c,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),yo.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Et,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Zo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(lt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,h,b;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),b=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(c)}});var ra=aa.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(To(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var b=fe(h.bgPos);c.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Li(n){return new ra(n)}aa.Default=Ls;var Ss=yo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ge.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){w(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),xt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Fo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof F?n:new F(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,h=-n(-1/0,1/0),b=0,I=c.length,U;b<I;b++)U=c[b].style.zIndex,c[b]!==this._container&&U&&(h=n(h,+U));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ge.ielt9){gn(this._container,this.options.opacity);var n=+new Date,c=!1,h=!1;for(var b in this._tiles){var I=this._tiles[b];if(!(!I.current||!I.loaded)){var U=Math.min(1,(n-I.loaded)/200);gn(I.el,U),U<1?c=!0:(I.active?h=!0:this._onOpaqueTile(I),I.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=c-Math.abs(n-h),this._onUpdateLevel(h)):(xt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var b=this._levels[n],I=this._map;return b||(b=this._levels[n]={},b.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=c,b.origin=I.project(I.unproject(I.getPixelOrigin()),n).round(),b.zoom=n,this._setZoomTransform(b,I.getCenter(),I.getZoom()),g(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var b=c.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)xt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,h,b){var I=Math.floor(n/2),U=Math.floor(c/2),oe=h-1,we=new F(+I,+U);we.z=+oe;var $e=this._tileCoordsToKey(we),Fe=this._tiles[$e];return Fe&&Fe.active?(Fe.retain=!0,!0):(Fe&&Fe.loaded&&(Fe.retain=!0),oe>b?this._retainParent(I,U,oe,b):!1)},_retainChildren:function(n,c,h,b){for(var I=2*n;I<2*n+2;I++)for(var U=2*c;U<2*c+2;U++){var oe=new F(I,U);oe.z=h+1;var we=this._tileCoordsToKey(oe),$e=this._tiles[we];if($e&&$e.active){$e.retain=!0;continue}else $e&&$e.loaded&&($e.retain=!0);h+1<b&&this._retainChildren(I,U,h+1,b)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,h,b){var I=Math.round(c);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var U=this.options.updateWhenZooming&&I!==this._tileZoom;(!b||U)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,c)},_setZoomTransform:function(n,c,h){var b=this._map.getZoomScale(h,n.zoom),I=n.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(c,h)).round();Ge.any3d?po(n.el,I,b):qt(n.el,I)},_resetGrid:function(){var n=this._map,c=n.options.crs,h=this._tileSize=this.getTileSize(),b=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],b).x/h.x),Math.ceil(n.project([0,c.wrapLng[1]],b).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],b).y/h.x),Math.ceil(n.project([c.wrapLat[1],0],b).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),b=c.getZoomScale(h,this._tileZoom),I=c.project(n,this._tileZoom).floor(),U=c.getSize().divideBy(b*2);return new he(I.subtract(U),I.add(U))},_update:function(n){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(n),I=this._pxBoundsToTileRange(b),U=I.getCenter(),oe=[],we=this.options.keepBuffer,$e=new he(I.getBottomLeft().subtract([we,-we]),I.getTopRight().add([we,-we]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Fe in this._tiles){var nt=this._tiles[Fe].coords;(nt.z!==this._tileZoom||!$e.contains(new F(nt.x,nt.y)))&&(this._tiles[Fe].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ct=I.min.y;ct<=I.max.y;ct++)for(var kt=I.min.x;kt<=I.max.x;kt++){var Zn=new F(kt,ct);if(Zn.z=this._tileZoom,!!this._isValidTile(Zn)){var dn=this._tiles[this._tileCoordsToKey(Zn)];dn?dn.current=!0:oe.push(Zn)}}if(oe.sort(function(ao,Si){return ao.distanceTo(U)-Si.distanceTo(U)}),oe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mo=document.createDocumentFragment();for(kt=0;kt<oe.length;kt++)this._addTile(oe[kt],Mo);this._level.el.appendChild(Mo)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!c.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(n);return Xe(this.options.bounds).overlaps(b)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,h=this.getTileSize(),b=n.scaleBy(h),I=b.add(h),U=c.unproject(b,n.z),oe=c.unproject(I,n.z);return[U,oe]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),h=new et(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),h=new F(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(n){var c=this._tiles[n];c&&(xt(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ht(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=g,n.onmousemove=g,Ge.ielt9&&this.options.opacity<1&&gn(n,this.options.opacity)},_addTile:function(n,c){var h=this._getTilePos(n),b=this._tileCoordsToKey(n),I=this.createTile(this._wrapCoords(n),r(this._tileReady,this,n));this._initTile(I),this.createTile.length<2&&P(r(this._tileReady,this,n,null,I)),qt(I,h),this._tiles[b]={el:I,coords:n,current:!0},c.appendChild(I),this.fire("tileloadstart",{tile:I,coords:n})},_tileReady:function(n,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:n});var b=this._tileCoordsToKey(n);h=this._tiles[b],h&&(h.loaded=+new Date,this._map._fadeAnimated?(gn(h.el,0),G(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(ht(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ge.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new F(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new he(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function ca(n){return new Ss(n)}var wn=Ss.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=w(this,c),c.detectRetina&&Ge.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var h=document.createElement("img");return lt(h,"load",r(this._tileOnLoad,this,c,h)),lt(h,"error",r(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var c={r:Ge.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=h),c["-y"]=h}return A(this._url,s(c,this.options))},_tileOnLoad:function(n,c){Ge.ielt9?setTimeout(r(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,h){var b=this.options.errorTileUrl;b&&c.getAttribute("src")!==b&&(c.src=b),n(h,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,b=this.options.zoomOffset;return h&&(n=c-n),n+b},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=g,c.onerror=g,!c.complete)){c.src=R;var h=this._tiles[n].coords;xt(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",R),Ss.prototype._removeTile.call(this,n)},_tileReady:function(n,c,h){if(!(!this._map||h&&h.getAttribute("src")===R))return Ss.prototype._tileReady.call(this,n,c,h)}});function ud(n,c){return new wn(n,c)}var dd=wn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var h=s({},this.defaultWmsParams);for(var b in c)b in this.options||(h[b]=c[b]);c=w(this,c);var I=c.detectRetina&&Ge.retina?2:1,U=this.getTileSize();h.width=U.x*I,h.height=U.y*I,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,wn.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),h=this._crs,b=Re(h.project(c[0]),h.project(c[1])),I=b.min,U=b.max,oe=(this._wmsVersion>=1.3&&this._crs===Xl?[I.y,I.x,U.y,U.x]:[I.x,I.y,U.x,U.y]).join(","),we=wn.prototype.getTileUrl.call(this,n);return we+S(this.wmsParams,we,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+oe},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function om(n,c){return new dd(n,c)}wn.WMS=dd,ud.wms=om;var xs=yo.extend({options:{padding:.1},initialize:function(n){w(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var h=this._map.getZoomScale(c,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,c),U=b.multiplyBy(-h).add(I).subtract(this._map._getNewPixelOrigin(n,c));Ge.any3d?po(this._container,U,h):qt(this._container,U)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new he(h,h.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),hd=xs.extend({options:{tolerance:0},getEvents:function(){var n=xs.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){xs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,xt(this._container),It(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=this._container,h=n.getSize(),b=Ge.retina?2:1;qt(c,n.min),c.width=b*h.x,c.height=b*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Ge.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){xs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,h=c.next,b=c.prev;h?h.prev=b:this._drawLast=b,b?b.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),h=[],b,I;for(I=0;I<c.length;I++){if(b=Number(c[I]),isNaN(b))return;h.push(b)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new he,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)n=b.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var h,b,I,U,oe=n._parts,we=oe.length,$e=this._ctx;if(we){for($e.beginPath(),h=0;h<we;h++){for(b=0,I=oe[h].length;b<I;b++)U=oe[h][b],$e[b?"lineTo":"moveTo"](U.x,U.y);c&&$e.closePath()}this._fillStroke($e,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,h=this._ctx,b=Math.max(Math.round(n._radius),1),I=(Math.max(Math.round(n._radiusY),1)||b)/b;I!==1&&(h.save(),h.scale(1,I)),h.beginPath(),h.arc(c.x,c.y/I,b,0,Math.PI*2,!1),I!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,c){var h=c.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(b=h);this._fireEvent(b?[b]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(Ut(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(b=h);b!==this._hoveredLayer&&(this._handleMouseOut(n),b&&(ht(this._container,"leaflet-interactive"),this._fireEvent([b],n,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,h){this._map._fireDOMEvent(c,h||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(h)h.prev=b;else return;b?b.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(b)b.next=h;else return;h?h.prev=b:b&&(this._drawLast=b),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function fd(n){return Ge.canvas?new hd(n):null}var sl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),sm={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(xs.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=sl("shape");ht(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=sl("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;xt(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,h=n._fill,b=n.options,I=n._container;I.stroked=!!b.stroke,I.filled=!!b.fill,b.stroke?(c||(c=n._stroke=sl("stroke")),I.appendChild(c),c.weight=b.weight+"px",c.color=b.color,c.opacity=b.opacity,b.dashArray?c.dashStyle=x(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=b.lineCap.replace("butt","flat"),c.joinstyle=b.lineJoin):c&&(I.removeChild(c),n._stroke=null),b.fill?(h||(h=n._fill=sl("fill")),I.appendChild(h),h.color=b.fillColor||b.color,h.opacity=b.fillOpacity):h&&(I.removeChild(h),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),h=Math.round(n._radius),b=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+b+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){fo(n._container)},_bringToBack:function(n){Fo(n._container)}},sr=Ge.vml?sl:Se,al=xs.extend({_initContainer:function(){this._container=sr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=sr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xt(this._container),It(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),qt(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=sr("path");n.options.className&&ht(c,n.options.className),n.options.interactive&&ht(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){xt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,h=n.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,re(n._parts,c))},_updateCircle:function(n){var c=n._point,h=Math.max(Math.round(n._radius),1),b=Math.max(Math.round(n._radiusY),1)||h,I="a"+h+","+b+" 0 1,0 ",U=n._empty()?"M0 0":"M"+(c.x-h)+","+c.y+I+h*2+",0 "+I+-h*2+",0 ";this._setPath(n,U)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){fo(n._path)},_bringToBack:function(n){Fo(n._path)}});Ge.vml&&al.include(sm);function pd(n){return Ge.svg||Ge.vml?new al(n):null}gt.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&fd(n)||pd(n)}});var vd=ia.extend({initialize:function(n,c){ia.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Xe(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function am(n,c){return new vd(n,c)}al.create=sr,al.pointsToPath=re,Wo.geometryToLayer=Ua,Wo.coordsToLatLng=nl,Wo.coordsToLatLngs=_i,Wo.latLngToCoords=za,Wo.latLngsToCoords=bi,Wo.getFeature=la,Wo.asFeature=wi,gt.mergeOptions({boxZoom:!0});var md=Ht.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){It(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),yn(),Da(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new he(this._point,this._startPoint),h=c.getSize();qt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(xt(this._box),Ut(this._container,"leaflet-crosshair")),In(),zt(),It(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var c=new et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});gt.addInitHook("addHandler","boxZoom",md),gt.mergeOptions({doubleClickZoom:!0});var gd=Ht.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,h=c.getZoom(),b=c.options.zoomDelta,I=n.originalEvent.shiftKey?h-b:h+b;c.options.doubleClickZoom==="center"?c.setZoom(I):c.setZoomAround(n.containerPoint,I)}});gt.addInitHook("addHandler","doubleClickZoom",gd),gt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var yd=Ht.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new At(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ut(this._map._container,"leaflet-grab"),Ut(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Xe(this._map.options.maxBounds);this._offsetLimit=Re(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),h=this._initialWorldOffset,b=this._draggable._newPos.x,I=(b-c+h)%n+c-h,U=(b+c+h)%n-c-h,oe=Math.abs(I+h)<Math.abs(U+h)?I:U;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=oe},_onDragEnd:function(n){var c=this._map,h=c.options,b=!h.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),b)c.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),U=(this._lastTime-this._times[0])/1e3,oe=h.easeLinearity,we=I.multiplyBy(oe/U),$e=we.distanceTo([0,0]),Fe=Math.min(h.inertiaMaxSpeed,$e),nt=we.multiplyBy(Fe/$e),ct=Fe/(h.inertiaDeceleration*oe),kt=nt.multiplyBy(-ct/2).round();!kt.x&&!kt.y?c.fire("moveend"):(kt=c._limitOffset(kt,c.options.maxBounds),P(function(){c.panBy(kt,{duration:ct,easeLinearity:oe,noMoveStart:!0,animate:!0})}))}}});gt.addInitHook("addHandler","dragging",yd),gt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kd=Ht.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),It(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,h=n.scrollTop||c.scrollTop,b=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(b,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},h=this.keyCodes,b,I;for(b=0,I=h.left.length;b<I;b++)c[h.left[b]]=[-1*n,0];for(b=0,I=h.right.length;b<I;b++)c[h.right[b]]=[n,0];for(b=0,I=h.down.length;b<I;b++)c[h.down[b]]=[0,n];for(b=0,I=h.up.length;b<I;b++)c[h.up[b]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},h=this.keyCodes,b,I;for(b=0,I=h.zoomIn.length;b<I;b++)c[h.zoomIn[b]]=n;for(b=0,I=h.zoomOut.length;b<I;b++)c[h.zoomOut[b]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){It(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,h=this._map,b;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(b=this._panKeys[c],n.shiftKey&&(b=fe(b).multiplyBy(3)),h.options.maxBounds&&(b=h._limitOffset(fe(b),h.options.maxBounds)),h.options.worldCopyJump){var I=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(b)));h.panTo(I)}else h.panBy(b)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Go(n)}}});gt.addInitHook("addHandler","keyboard",kd),gt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _d=Ht.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){It(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=ui(n),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var b=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),b),Go(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,U=h?Math.ceil(I/h)*h:I,oe=n._limitZoom(c+(this._delta>0?U:-U))-c;this._delta=0,this._startTime=null,oe&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+oe):n.setZoomAround(this._lastMousePos,c+oe))}});gt.addInitHook("addHandler","scrollWheelZoom",_d);var im=600;gt.mergeOptions({tapHold:Ge.touchNative&&Ge.safari&&Ge.mobile,tapTolerance:15});var bd=Ht.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){It(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new F(c.clientX,c.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Kt),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),im),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){It(document,"touchend",Kt),It(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),It(document,"touchend touchcancel contextmenu",this._cancel,this),It(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new F(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});gt.addInitHook("addHandler","tapHold",bd),gt.mergeOptions({touchZoom:Ge.touch,bounceAtZoomLimits:!0});var wd=Ht.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ut(this._map._container,"leaflet-touch-zoom"),It(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(b)._divideBy(2))),this._startDist=h.distanceTo(b),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Kt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]),I=h.distanceTo(b)/this._startDist;if(this._zoom=c.getScaleZoom(I,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&I<1||this._zoom>c.getMaxZoom()&&I>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var U=h._add(b)._divideBy(2)._subtract(this._centerPoint);if(I===1&&U.x===0&&U.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(U),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var oe=r(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(oe,this,!0),Kt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),It(document,"touchmove",this._onTouchMove,this),It(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});gt.addInitHook("addHandler","touchZoom",wd),gt.BoxZoom=md,gt.DoubleClickZoom=gd,gt.Drag=yd,gt.Keyboard=kd,gt.ScrollWheelZoom=_d,gt.TapHold=bd,gt.TouchZoom=wd,o.Bounds=he,o.Browser=Ge,o.CRS=ye,o.Canvas=hd,o.Circle=tl,o.CircleMarker=ki,o.Class=te,o.Control=bn,o.DivIcon=ra,o.DivOverlay=be,o.DomEvent=di,o.DomUtil=Ho,o.Draggable=At,o.Evented=ne,o.FeatureGroup=Zo,o.GeoJSON=Wo,o.GridLayer=Ss,o.Handler=Ht,o.Icon=aa,o.ImageOverlay=Va,o.LatLng=He,o.LatLngBounds=et,o.Layer=yo,o.LayerGroup=sa,o.LineUtil=bc,o.Map=gt,o.Marker=yi,o.Mixin=Vn,o.Path=rs,o.Point=F,o.PolyUtil=Mn,o.Polygon=ia,o.Polyline=qo,o.Popup=tt,o.PosAnimation=ta,o.Projection=wc,o.Rectangle=vd,o.Renderer=xs,o.SVG=al,o.SVGOverlay=ae,o.TileLayer=wn,o.Tooltip=Et,o.Transformation=De,o.Util=Y,o.VideoOverlay=ol,o.bind=r,o.bounds=Re,o.canvas=fd,o.circle=Ic,o.circleMarker=xc,o.control=Cs,o.divIcon=Li,o.extend=s,o.featureGroup=mi,o.geoJSON=nr,o.geoJson=Ha,o.gridLayer=ca,o.icon=Ql,o.imageOverlay=or,o.latLng=Ke,o.latLngBounds=Xe,o.layerGroup=vi,o.map=Ji,o.marker=Sc,o.point=fe,o.polygon=er,o.polyline=$c,o.popup=Lt,o.rectangle=am,o.setOptions=w,o.stamp=d,o.svg=pd,o.svgOverlay=_e,o.tileLayer=ud,o.tooltip=un,o.transformation=q,o.version=a,o.videoOverlay=z;var lm=window.L;o.noConflict=function(){return window.L=lm,this},window.L=o}))})(fl,fl.exports)),fl.exports}var Fb=Nb();const en=Ob(Fb);(function(e,t,o){function a(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,r=i.getLatLngs(),u=r.splice(-1,1)[0];this._poly.setLatLngs(r),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),r=this._map.layerPointToLatLng(i);this._currentLatLng=r,this._updateTooltip(r),this._updateGuide(i),this._mouseMarker.setLatLng(r),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,r=i.clientX,u=i.clientY;this._startPoint.call(this,r,u)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,r=i.clientX,u=i.clientY;this._endPoint.call(this,r,u,s),this._clickHandled=null},_endPoint:function(s,i,r){if(this._mouseDownOrigin){var u=L.point(s,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(r.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(r.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(r.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,r,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,r=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,r),this._endPoint.call(this,i,r,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var r;if(this.type===L.Draw.Polyline.TYPE)r=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;r=this._markers[0]}var u=this._map.latLngToContainerPoint(r.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(f)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var r,u,d,f=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,k=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));k<f;k+=this.options.guidelineDistance)r=k/f,u={x:Math.floor(s.x*(1-r)+r*i.x),y:Math.floor(s.y*(1-r)+r*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,r=this._guidesContainer.childNodes.length;i<r;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,r=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=r?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var r,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(r=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[r].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[r].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,r=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?r&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(r)*(this.options.factor||1):this._measurementRunningTotal||0:r&&i?this._measurementRunningTotal+this._map.distance(i,r)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var r;!this.options.allowIntersection&&this.options.showArea&&(r=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(r)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,r,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,f=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),r=f?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:r}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,r=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(r),this._isDrawing){this._drawShape(r),i=this._shape.getRadius().toFixed(1);var f="";u&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var r=parseInt(s.style.marginTop,10)-i,u=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=r+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,r){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,r&&r.drawError&&(r.drawError=L.Util.extend({},this.options.drawError,r.drawError)),this._latlngs=i,L.setOptions(this,r)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,r,u,d=this._defaultShape();for(s=0,r=d.length;s<r;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var f,p;for(s=0,i=r-1;s<r;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[i],p=this._markers[s],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return r._origLatLng=s,r._index=i,r.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(r),r},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,r=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),r.options.poly){var d=r._map._editTooltip;if(!r.options.poly.allowIntersection&&r.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var f=r.options.color;r.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){r.setStyle({color:f}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,r=s.target;this._defaultShape().length<i||(this._removeMarker(r),this._updatePrevNext(r._prev,r._next),r._middleLeft&&this._markerGroup.removeLayer(r._middleLeft),r._middleRight&&this._markerGroup.removeLayer(r._middleRight),r._prev&&r._next?this._createMiddleMarker(r._prev,r._next):r._prev?r._next||(r._prev._middleRight=null):r._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i),u=s.target;L.extend(u._origLatLng,r),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(r){r._index>s&&(r._index+=i)})},_createMiddleMarker:function(s,i){var r,u,d,f=this._getMiddleLatLng(s,i),p=this._createMarker(f);p.setOpacity(.6),s._middleRight=i._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=i._index;p._index=g,p.off("click",r,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),i._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,i),this._poly.fire("editstart")},d=function(){p.off("dragstart",u,this),p.off("dragend",d,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,i)},r=function(){u.call(this),d.call(this),this._fireEdit()},p.on("click",r,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var r=this._poly._map,u=r.project(s.getLatLng()),d=r.project(i.getLatLng());return r.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(r),this._markerGroup.addLayer(r),r},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,r=i.getLatLng();i===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),r=s.target,u=r._cornerIndex;r.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,r=s.length;i<r;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),r=s.target,u=r._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var i,r,u=s.target;u===this._moveMarker&&(i=this._shape.getBounds(),r=i.getCenter(),u.setLatLng(r)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,r=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),f=[],p=0,g=r.length;p<g;p++)i=[r[p].lat-d.lat,r[p].lng-d.lng],f.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),r=this._map.project(s);return this._map.unproject([r.x+i,r.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var r={};if(s.touches!==void 0){if(!s.touches.length)return;r=s.touches[0]}else if(s.pointerType!=="touch"||(r=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(r),d=this._map.mouseEventToLayerPoint(r),f=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:f,layerPoint:d,containerPoint:u,pageX:r.pageX,pageY:r.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,r=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return r&&r>100&&r<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var r=0;r<i.length;r++)L.DomEvent.on(s,i[r],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],r=0,u=s.length;r<u;r++)Array.isArray(s[r])?i.push(L.LatLngUtil.cloneLatLngs(s[r])):i.push(this.cloneLatLng(s[r]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var r,u,d=i.length,f=0,p=Math.PI/180;if(d>2){for(var g=0;g<d;g++)r=i[g],u=i[(g+1)%d],f+=(u.lng-r.lng)*p*(2+Math.sin(r.lat*p)+Math.sin(u.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(i,r){var u=parseFloat(i).toFixed(r),d=L.drawLocal.format&&L.drawLocal.format.numeric,f=d&&d.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var k=u.split(".");u=p?k[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):k[0],g=g||".",k.length>1&&(u=u+g+k[1])}return u},readableArea:function(i,r,p){var d,f,p=L.Util.extend({},s,p);return r?(f=["ha","m"],type=typeof r,type==="string"?f=[r]:type!=="boolean"&&(f=r),d=i>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,p.km)+" km":i>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,p.ha)+" ha":L.GeometryUtil.formattedNumber(i,p.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,p.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(i,p.yd)+" yd"),d},readableDistance:function(i,r,u,d,g){var p,g=L.Util.extend({},s,g);switch(r?typeof r=="string"?r:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":p=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(i,g.m)+" m";break;case"feet":i*=3.28083,p=L.GeometryUtil.formattedNumber(i,g.ft)+" ft";break;case"nauticalMile":i*=.53996,p=L.GeometryUtil.formattedNumber(i/1e3,g.nm)+" nm";break;default:i*=1.09361,p=i>1760?L.GeometryUtil.formattedNumber(i/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(i,g.yd)+" yd"}return p},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,r,u){return this._checkCounterclockwise(s,r,u)!==this._checkCounterclockwise(i,r,u)&&this._checkCounterclockwise(s,i,r)!==this._checkCounterclockwise(s,i,u)},_checkCounterclockwise:function(s,i,r){return(r.y-s.y)*(i.x-s.x)>(i.y-s.y)*(r.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,r,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(i=u[s-1],r=u[s],this._lineSegmentsIntersectsRange(i,r,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var r=this._getProjectedPoints(),u=r?r.length:0,d=r?r[u-1]:null,f=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,f,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),r=i?i.length:0;return r+=s||0,!i||r<=3},_lineSegmentsIntersectsRange:function(s,i,r,u){var d,f,p=this._getProjectedPoints();u=u||0;for(var g=r;g>u;g--)if(d=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(s,i,d,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),r=0;r<i.length;r++)s.push(this._map.latLngToLayerPoint(i[r]));return s}}),L.Polygon.include({intersects:function(){var s,i,r,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,i=d[0],r=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(r,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,r=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),r.appendChild(i));return r},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var r in this._toolbars)this._toolbars[r]!==i&&this._toolbars[r].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,r=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",f=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<f.length;i++)f[i].enabled&&this._initModeHandler(f[i].handler,this._toolbarContainer,u++,d,f[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),r.appendChild(this._toolbarContainer),r.appendChild(this._actionsContainer),r},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,r=this._actionButtons.length;i<r;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,r,u,d){var f=s.type;this._modes[f]={},this._modes[f].handler=s,this._modes[f].button=this._createButton({type:f,title:d,className:u+"-"+f,container:i,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=r,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),r=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(r),s.title&&(i.title=s.title,r.innerHTML=s.title),s.text&&(i.innerHTML=s.text,r.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,s.callback,s.context),i},_disposeButton:function(s,i){var r=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,r,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,r,u,d,f=this._actionsContainer,p=this.getActions(s),g=p.length;for(r=0,u=this._actionButtons.length;r<u;r++)this._disposeButton(this._actionButtons[r].button,this._actionButtons[r].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var k=0;k<g;k++)"enabled"in p[k]&&!p[k].enabled||(i=L.DomUtil.create("li","",f),d=this._createButton({title:p[k].title,text:p[k].text,container:i,callback:p[k].callback,context:p[k].context}),this._actionButtons.push({button:d,callback:p[k].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,r=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=r+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),r=this._container;return this._container&&(this._visible&&(r.style.visibility="inherit"),L.DomUtil.setPosition(r,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,r=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,r,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(r=L.Util.extend({},this.options.poly),u.options.poly=r),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],r=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(r);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Gv=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",ef=e=>e.length*6+12,Yc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),Ub=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(r=>{if(a.contains(r.getLatLng())){const u=e.latLngToContainerPoint(r.getLatLng()),d=r.locationData;d&&o.push({marker:r,pixelPos:u,location:d})}});const s=o.map(({marker:r,pixelPos:u,location:d})=>{const g=ef(d.name),k=d.description?ef(`${d.name}: ${Gv(d.description,50)}`):g;return{marker:r,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-k/2,right:u.x+k/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return s.forEach(({marker:r,location:u,markerBox:d,baseLabelBox:f,descLabelBox:p},g)=>{if(!u.description)return;let k=!1;for(let y=0;y<s.length;y++){if(g===y)continue;const _=s[y];if(Yc(p,_.markerBox)||Yc(p,_.baseLabelBox)){k=!0;break}if(_.descLabelBox&&i.has(_.location.id)&&Yc(p,_.descLabelBox)){k=!0;break}}k||i.add(u.id)}),i},fr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],zb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Hr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function si(e){return Hr.find(t=>t.value===e)||Hr[0]}function Hb(e){return si(e).defaultColor||"#667eea"}function Vb(e,t){return t||Hb(e)}const Iu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,s=t-4,i=4,r=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${r},${s} ${i},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-s} ${o+s},${a} ${o},${a+s} ${o-s},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-3,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${o+s*Math.cos(d)},${a+s*Math.sin(d)}`);const f=d+Math.PI/5;r.push(`${o+i*Math.cos(f)},${a+i*Math.sin(f)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${r.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<6;r++){const u=Math.PI/6+r*Math.PI/3;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<5;r++){const u=Math.PI/2*-1+r*2*Math.PI/5;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},tf={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Ai={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<6;i++){const r=Math.PI/6+i*Math.PI/3;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<5;i++){const r=Math.PI/2*-1+i*2*Math.PI/5;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=13,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const f=d+Math.PI/5;r.push(`${16+i*Math.cos(f)},${16+i*Math.sin(f)}`)}return`<polygon points="${r.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},nf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Cn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:s,size:i="100",outputSize:r=null}){if(!e||e==="default"){if(!(o||a||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=si(e),d=parseInt(i,10)/100,f=r||Math.round(32*d);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",k=a||"#fff";if(Ai[e])p=Ai[e]({backgroundColor:g,borderColor:k});else return Iu[e]?.(g,f)||null}else{const g=o||"#667eea",k=a||"#fff",y=s||"#fff",_=t||"circle";_!=="none"&&Ai[_]&&(p+=Ai[_]({backgroundColor:g,borderColor:k})),nf[e]&&(p+=nf[e](y,g))}return`<svg width="${f}" height="${f}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const Gb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function jb(e,t){return e===0?"missing":e>=t?"full":"partial"}function $u(e,t){const o=jb(e,t);return Gb[o]}function Zb(e,t,o=32){if(e==="default")return null;if(tf[e])return tf[e](o);if(Iu[e]){const a=t||"#667eea";return Iu[e](a,o)}return null}const qb=["circle","square","hexagon","pentagon"];function Wb(e){return qb.includes(e)}function Kb(e,t,o,a,s=32,i=!0){const r=Zb(e,t,s),u=$u(o,a);if(!r)return null;const d=i&&Wb(e),f=Vb(e,t),p=Yb(f),g=jv(f)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",k=s>=36?"12px":"10px",y=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${k};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${r}
      ${y}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function Jb(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function jv(e){return!e||e.length<6?!1:Jb(e)>.4}function Yb(e){return jv(e)?"#1F2937":"#FFFFFF"}const Xb={class:"map-container-wrapper"},Qb="#667eea",e0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=T(null);let r=null;const u=T([]),d=T([]),f=T([]);let p=null,g=null;const k=T([]);let y=null,_=null,w=!1;const S=T(!1),E=()=>{if(r){const Ce=r.getCenter();return{lat:Ce.lat,lng:Ce.lng}}return null},A=()=>r?r.getZoom():null,x=()=>{if(u.value.length>0){f.value.push([...u.value]);const Ce=d.value.pop()||[];u.value=Ce,Se(),s("polygon-drawing",u.value)}},D=()=>{if(f.value.length>0){d.value.push([...u.value]);const Ce=f.value.pop();u.value=Ce,Se(),s("polygon-drawing",u.value)}},R=()=>u.value.length>0,H=()=>f.value.length>0,$=()=>u.value.length,B=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),N())},N=()=>{u.value=[],d.value=[],f.value=[],Se()},Z=()=>{!r||!a.userLocation||(r.setView([a.userLocation.lat,a.userLocation.lng],r.getZoom(),{animate:!0,duration:.5}),S.value=!0)},P=(Ce,ke,j=null)=>{if(!r||Ce==null||ke==null)return;r.setView([Ce,ke],j??r.getZoom(),{animate:!0,duration:.5});const se=a.center&&Math.abs(a.center.lat-Ce)<1e-4&&Math.abs(a.center.lng-ke)<1e-4;S.value=!se},G=T(!0),Y=T(!0),te=(Ce,ke)=>{if(!r||Ce==null||ke==null)return!0;const j=r.getBounds(),se=en.latLng(Ce,ke);return j.contains(se)};t({getMapCenter:E,getMapZoom:A,undoPolygonPoint:x,redoPolygonPoint:D,canUndo:R,canRedo:H,getPolygonPointCount:$,completePolygon:B,clearPolygonDrawing:N,recenterOnUserLocation:Z,recenterOnLocation:P,isLocationInView:te,userLocationInView:Y,highlightedLocationInView:G});const Q=T([]);let X=null;const ne=T(!0),F=T(!1),K=T(new Set),fe=T([]);let he=null,Re=null;const et=V(()=>a.hideRecenterButton||!a.highlightLocationId||!S.value?!1:!G.value),Xe=T({}),He=()=>{const Ce={};if(a.highlightLocationId){const ke=a.locations.find(j=>j.id===a.highlightLocationId);if(ke?.latitude&&ke?.longitude){const j=te(ke.latitude,ke.longitude);G.value=j,Ce[a.highlightLocationId]=j,Xe.value=Ce;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let ke=!0;for(const j of a.highlightLocationIds){const se=a.locations.find(de=>de.id===j);if(se?.latitude&&se?.longitude){const de=te(se.latitude,se.longitude);Ce[j]=de,de||(ke=!1)}else Ce[j]=!0}G.value=ke,Xe.value=Ce;return}if(!r){G.value=!0,Xe.value={};return}G.value=!0,Xe.value={}},Ke=()=>{if(!r||!a.userLocation){Y.value=!0;return}Y.value=te(a.userLocation.lat,a.userLocation.lng)},ye=()=>{He(),Ke(),s("visibility-change",{userLocationInView:Y.value,highlightedLocationInView:G.value,highlightedLocationsVisibility:Xe.value})},Ve=()=>{if(!r||!a.highlightLocationId)return;const Ce=a.locations.find(ke=>ke.id===a.highlightLocationId);!Ce||!Ce.latitude||!Ce.longitude||(r.setView([Ce.latitude,Ce.longitude],r.getZoom(),{animate:!0,duration:.5}),S.value=!1,G.value=!0)},me=(Ce,ke,j,se,de=!1)=>{const Me=j?"36px":se?"20px":"30px",Oe=j?"#667eea":"white",Be=de?"":$u(Ce,ke);return`
    <div style="position: relative; width: ${Me}; height: ${Me};">
      <div style="
        background-color: ${Qb};
        width: ${Me};
        height: ${Me};
        border-radius: 50%;
        border: 3px solid ${Oe};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${de?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Be}
      </div>`}
    </div>
  `},xe=()=>{if(!r)return;const Ce=Ub(r,Q.value),ke=Array.from(K.value).sort().join(","),j=Array.from(Ce).sort().join(",");ke!==j&&(K.value=Ce,Le())},De=()=>{if(Re&&(Re.remove(),Re=null),!r||!a.userLocation)return;const Ce=en.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Re=en.marker([a.userLocation.lat,a.userLocation.lng],{icon:Ce}).addTo(r).bindPopup("Your location")},q=()=>{if(!i.value)return;let Ce=51.505,ke=-.09,j=13;const se=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,de=(Oe,Be)=>Oe!=null&&Be!=null&&!(Oe===0&&Be===0),Me=[];se.length>0&&Me.push(...se.filter(Oe=>de(Oe.latitude,Oe.longitude)).map(Oe=>({lat:Oe.latitude,lng:Oe.longitude}))),a.route&&a.route.length>0&&Me.push(...a.route.filter(Oe=>de(Oe.lat,Oe.lng)).map(Oe=>({lat:Oe.lat,lng:Oe.lng}))),a.center?(Ce=a.center.lat,ke=a.center.lng,j=a.zoom??13):Me.length>0&&(Ce=Me.reduce((Oe,Be)=>Oe+Be.lat,0)/Me.length,ke=Me.reduce((Oe,Be)=>Oe+Be.lng,0)/Me.length,j=10),r=en.map(i.value).setView([Ce,ke],j),en.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(r),a.clickable&&r.on("click",Oe=>{a.drawingMode||s("map-click",{lat:Oe.latlng.lat,lng:Oe.latlng.lng})}),r.on("zoomstart",()=>{ie=!0}),r.on("zoomend moveend",()=>{ie=!1,W?Le():xe(),ye()}),r.on("dragstart",()=>{S.value=!0}),Le(),J(),ve(),De(),ee(),ue(),r.whenReady(()=>{ye()})},J=()=>{if(X&&(X.remove(),X=null),!r||a.route.length===0)return;const Ce=a.route.map(ke=>[ke.lat,ke.lng]);X=en.polyline(Ce,{color:"blue",weight:4,opacity:.7}).addTo(r)},ve=()=>{fe.value.forEach(Ce=>Ce.remove()),fe.value=[],!(!r||a.areas.length===0)&&a.areas.forEach(Ce=>{const ke=typeof Ce.polygon=="string"?JSON.parse(Ce.polygon):Ce.polygon;if(!ke||ke.length===0)return;const j=ke.map(Oe=>[Oe.lat,Oe.lng]),se=Ce.id===a.selectedAreaId,de=Ce.color||"#667eea",Me=en.polygon(j,{color:de,fillColor:de,fillOpacity:se?.4:.2,weight:se?3:2,opacity:.8}).addTo(r);Me.setStyle({pane:"overlayPane"}),a.drawingMode||(Me.on("click",()=>s("area-click",Ce)),Me.on("mouseover",()=>{Me.setStyle({fillOpacity:.4})}),Me.on("mouseout",()=>{Me.setStyle({fillOpacity:se?.4:.2})})),fe.value.push(Me)})},Se=()=>{if(r&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=en.layerGroup().addTo(r),u.value.forEach((Ce,ke)=>{const j=ke===0,se=ke===u.value.length-1,de=en.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${j?"16px":"12px"};
        height: ${j?"16px":"12px"};
        background-color: ${j?"#667eea":se?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[j?16:12,j?16:12],iconAnchor:[j?8:6,j?8:6]});en.marker([Ce.lat,Ce.lng],{icon:de,interactive:!1}).addTo(g)}),u.value.length>=2))){const Ce=u.value.map(ke=>[ke.lat,ke.lng]);u.value.length>=3&&Ce.push(Ce[0]),p=en.polyline(Ce,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(r)}},re=()=>{if(!r||(y&&(y.remove(),y=null),_&&(_.remove(),_=null),k.value.length===0))return;const Ce=k.value.map(j=>[j.lat,j.lng]);y=en.polygon(Ce,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(r),y.bringToFront(),_=en.layerGroup({pane:"markerPane"}).addTo(r);const ke=j=>{k.value.length<=3||(k.value.splice(j,1),w=!0,s("polygon-update",[...k.value]),re())};k.value.forEach((j,se)=>{const de=k.value.length>3,Me=en.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),Oe=en.marker([j.lat,j.lng],{icon:Me,draggable:!0}).addTo(_);if(Oe.on("drag",Be=>{const Ye=Be.target.getLatLng();k.value[se]={lat:Ye.lat,lng:Ye.lng};const mt=k.value.map(_t=>[_t.lat,_t.lng]);y.setLatLngs(mt)}),Oe.on("dragend",()=>{w=!0,s("polygon-update",[...k.value])}),Oe.on("contextmenu",Be=>{en.DomEvent.preventDefault(Be),de&&ke(se)}),de){const Be=document.createElement("div"),Ye=document.createElement("button");Ye.textContent="Delete point",Ye.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const mt=_t=>{_t.preventDefault(),_t.stopPropagation(),Oe.closePopup(),ke(se)};Ye.addEventListener("click",mt),Ye.addEventListener("touchend",mt),Be.appendChild(Ye),Oe.bindPopup(Be,{closeButton:!1,className:"vertex-popup"})}})},ue=(Ce=!0)=>{if(r){if(!a.editingPolygon||a.editingPolygon.length===0){y&&(y.remove(),y=null),_&&(_.remove(),_=null),k.value=[];return}if(k.value=a.editingPolygon.map(ke=>({lat:ke.lat,lng:ke.lng})),re(),Ce&&k.value.length>=3){const ke=en.latLngBounds(k.value.map(j=>[j.lat,j.lng]));r.fitBounds(ke,{padding:[50,50]})}}},ee=()=>{if(!r)return;if(he||(he=new en.FeatureGroup,r.addLayer(he)),r._customDrawingHandlers&&(r.off("click",r._customDrawingHandlers.handleClick),r.getContainer().removeEventListener("touchstart",r._customDrawingHandlers.handleTouchStart),r.getContainer().removeEventListener("touchend",r._customDrawingHandlers.handleTouchEnd),r.getContainer().removeEventListener("touchmove",r._customDrawingHandlers.handleTouchMove),delete r._customDrawingHandlers),!a.drawingMode){N(),he&&he.clearLayers();return}let Ce=0,ke=null,j=!1,se=!1;const de=300,Me=15,Oe=bt=>{d.value.push([...u.value]),f.value=[],u.value.push({lat:bt.lat,lng:bt.lng}),Se(),s("polygon-drawing",u.value)},Be=bt=>{bt.originalEvent&&bt.originalEvent.sourceCapabilities?.firesTouchEvents||Oe(bt.latlng)},Ye=bt=>{if(bt.touches.length>1){se=!0;return}se=!1,Ce=Date.now(),ke={x:bt.touches[0].clientX,y:bt.touches[0].clientY},j=!1},mt=bt=>{if(!ke||se)return;const Mt=bt.touches[0].clientX-ke.x,wt=bt.touches[0].clientY-ke.y;Math.sqrt(Mt*Mt+wt*wt)>Me&&(j=!0)},_t=bt=>{if(se){se=!1,ke=null;return}if(Date.now()-Ce<de&&!j&&ke){const wt=bt.changedTouches[0],Nt=en.point(wt.clientX-r.getContainer().getBoundingClientRect().left,wt.clientY-r.getContainer().getBoundingClientRect().top),Ft=r.containerPointToLatLng(Nt);bt.preventDefault(),bt.stopPropagation(),Oe(Ft)}ke=null,j=!1};r.on("click",Be),r.getContainer().addEventListener("touchstart",Ye,{passive:!0}),r.getContainer().addEventListener("touchmove",mt,{passive:!0}),r.getContainer().addEventListener("touchend",_t,{passive:!1}),r._customDrawingHandlers={handleClick:Be,handleTouchStart:Ye,handleTouchMove:mt,handleTouchEnd:_t},Se()};let W=!1,ie=!1;const Le=()=>{if(r&&(r._animatingZoom||ie)){W=!0;return}if(W=!1,Q.value.forEach(j=>{j._map&&(j.off(),j.remove())}),Q.value=[],!r)return;const Ce=i.value?.clientWidth||400,ke=Math.floor(Ce*.75);if(a.locations.forEach(j=>{const se=j.latitude??j.Latitude,de=j.longitude??j.Longitude;if(se==null||de==null||se===0&&de===0)return;const Me=j.checkedInCount||0,Oe=j.requiredMarshals||1,Be=a.highlightLocationId===j.id||a.highlightLocationIds.includes(j.id),Ye=a.simplifyNonHighlighted&&!Be,mt=j.resolvedStyleType||j.ResolvedStyleType,_t=j.resolvedStyleBackgroundColor||j.ResolvedStyleBackgroundColor||j.resolvedStyleColor||j.ResolvedStyleColor,bt=j.resolvedStyleBorderColor||j.ResolvedStyleBorderColor,Mt=j.resolvedStyleIconColor||j.ResolvedStyleIconColor,wt=j.resolvedStyleBackgroundShape||j.ResolvedStyleBackgroundShape,Nt=mt&&mt!=="default"||_t||bt||Mt||wt&&wt!=="circle"&&wt!=="default",Ft=j.resolvedStyleMapRotation??j.ResolvedStyleMapRotation??j.styleMapRotation??j.StyleMapRotation??0,Fn=parseInt(Ft,10)||0,Qn=j.areaColor||"#999",fn=j.areaId&&!a.marshalMode,yt=K.value.has(j.id)&&j.description?`${j.name}: ${Gv(j.description,50)}`:j.name,eo=Be?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Un=Be?"#667eea":Ye?"#e0e0e0":"white",to=Be?"white":Ye?"#888":"#333";let pn;if(Ye){const ot="20px";pn=`
        <div style="
          background-color: #999;
          width: ${ot};
          height: ${ot};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Zt=!a.marshalMode,ks=$u(Me,Oe),no=Zt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Me}/${Oe}</div>`:"";if(!Ye&&Nt){const ot=Be?40:32,Ge=j.resolvedStyleSize||j.ResolvedStyleSize||"100",St=Cn({type:j.resolvedStyleType||j.ResolvedStyleType,backgroundShape:j.resolvedStyleBackgroundShape||j.ResolvedStyleBackgroundShape||"circle",backgroundColor:j.resolvedStyleBackgroundColor||j.ResolvedStyleBackgroundColor||j.resolvedStyleColor||j.ResolvedStyleColor||"",borderColor:j.resolvedStyleBorderColor||j.ResolvedStyleBorderColor||"",iconColor:j.resolvedStyleIconColor||j.ResolvedStyleIconColor||"",size:Ge});St?pn=St:pn=Kb(j.resolvedStyleType,j.resolvedStyleColor,Me,Oe,ot,Zt)||me(Me,Oe,Be,a.marshalMode,!0)}else Ye||(pn=me(Me,Oe,Be,a.marshalMode,!0));const Co=Fn!==0?`transform: rotate(${Fn}deg);`:"",le=en.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${eo}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${fn?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${Qn};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Co}">
                ${pn}
              </div>
              ${Ye?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${ks}
              </div>`}
              ${Ye?"":no}
            </div>
          </div>
          <div style="
            background-color: ${Un};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${Be?"12px":"11px"};
            font-weight: bold;
            color: ${to};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${ke}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${yt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),ce=a.marshalMode?`<b>${j.name}</b>${j.description?`<br>${j.description}`:""}`:`<b>${j.name}</b><br>${j.description||""}<br>Checked in: ${Me}/${Oe}`,ge=en.marker([j.latitude,j.longitude],{icon:le}).addTo(r).bindPopup(ce);ge.on("click",()=>{s("location-click",j)}),ge.locationData=j,Q.value.push(ge)}),r&&ne.value&&!a.center&&!F.value){const j=[],se=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,de=(Me,Oe)=>Me!=null&&Oe!=null&&!(Me===0&&Oe===0);if(se.length>0&&j.push(...se.filter(Me=>de(Me.latitude,Me.longitude)).map(Me=>[Me.latitude,Me.longitude])),a.route.length>0&&j.push(...a.route.filter(Me=>de(Me.lat,Me.lng)).map(Me=>[Me.lat,Me.lng])),j.length>0){const Me=en.latLngBounds(j);r.fitBounds(Me,{padding:[50,50]}),ne.value=!1,F.value=!0}}else a.center&&(ne.value=!1);setTimeout(()=>{r&&!r._animatingZoom&&xe()},100)};return nn(()=>{F.value=!1,ne.value=!0,q();let Ce,ke=0,j=0;const se=new ResizeObserver(de=>{if(r&&de.length>0){const{width:Me,height:Oe}=de[0].contentRect;(Math.abs(Me-ke)>10||Math.abs(Oe-j)>10)&&(ke=Me,j=Oe,clearTimeout(Ce),Ce=setTimeout(()=>{r.invalidateSize()},150))}});i.value&&se.observe(i.value),xn(()=>{clearTimeout(Ce),se.disconnect()})}),Ze(()=>a.locations,Ce=>{if(Le(),r&&!F.value&&Ce.length>0&&!a.center){const ke=Ce.map(Me=>Me.latitude),j=Ce.map(Me=>Me.longitude),se=ke.reduce((Me,Oe)=>Me+Oe,0)/ke.length,de=j.reduce((Me,Oe)=>Me+Oe,0)/j.length;r.setView([se,de],10),F.value=!0,ne.value=!1}r&&setTimeout(()=>ye(),50)},{deep:!0}),Ze(()=>a.route,Ce=>{if(J(),Le(),r&&!F.value&&Ce&&Ce.length>0&&!a.center){const ke=Ce.map(Me=>Me.lat),j=Ce.map(Me=>Me.lng),se=ke.reduce((Me,Oe)=>Me+Oe,0)/ke.length,de=j.reduce((Me,Oe)=>Me+Oe,0)/j.length;r.setView([se,de],10),F.value=!0,ne.value=!1}},{deep:!0}),Ze(()=>a.center,(Ce,ke)=>{r&&!S.value&&(!ke||Math.abs(Ce.lat-ke.lat)>1e-6||Math.abs(Ce.lng-ke.lng)>1e-6)&&r.setView([Ce.lat,Ce.lng],a.zoom)}),Ze(()=>a.areas,()=>{ve()},{deep:!0}),Ze(()=>a.selectedAreaId,()=>{ve()}),Ze(()=>a.drawingMode,()=>{ee()}),Ze(()=>a.editingPolygon,()=>{if(w){w=!1;return}ue()},{deep:!0}),Ze(()=>a.userLocation,()=>{De()},{deep:!0}),Ze(()=>a.highlightLocationId,()=>{Le()}),Ze(()=>a.highlightLocationIds,()=>{Le(),r&&setTimeout(()=>ye(),50)},{deep:!0}),Ze(()=>a.marshalMode,()=>{Le()}),Ze(()=>a.simplifyNonHighlighted,()=>{Le()}),Ze(()=>a.clickable,Ce=>{r&&(r.off("click"),Ce&&r.on("click",ke=>{a.drawingMode||s("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}))}),(Ce,ke)=>(v(),m("div",Xb,[l("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),et.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:Ve,title:"Recenter on checkpoint"},[...ke[0]||(ke[0]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),l("span",null,"Recenter",-1)])])):M("",!0)]))}},Tu=je(e0,[["__scopeId","data-v-91272c81"]]);function Vs(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const t0={class:"areas-selection"},n0={key:0,class:"areas-selection-header"},o0={class:"areas-list"},s0=["checked","onChange"],a0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>[...o.areas].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Vs(d.name,f.name))),i=V(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),r=d=>{const f=[...o.selectedAreaIds],p=f.indexOf(d);p>=0?f.splice(p,1):f.push(d),a("update:selectedAreaIds",f)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,f)=>(v(),m("div",t0,[e.areas.length>1?(v(),m("div",n0,[l("button",{onClick:u,class:"toggle-all-btn"},C(i.value?"Deselect all":"Select all"),1)])):M("",!0),l("div",o0,[(v(!0),m(Ie,null,Ne(s.value,p=>(v(),m("label",{class:"area-checkbox",key:p.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>r(p.id)},null,40,s0),l("span",{class:"area-color-dot",style:Qe({backgroundColor:p.color||"#667eea"})},null,4),Je(" "+C(p.name),1)]))),128))])]))}},i0=je(a0,[["__scopeId","data-v-ba19009b"]]),l0={key:1,class:"toolbar-btn-wrapper filters-wrapper"},r0={key:1,class:"dropdown-content filters-dropdown"},c0={class:"filters-header"},u0={class:"filter-section"},d0={class:"filter-checkbox"},h0=["checked"],f0={class:"filter-section"},p0={class:"filter-checkbox"},v0=["checked"],m0={class:"filter-checkbox"},g0=["checked"],y0={class:"filter-checkbox"},k0=["checked"],_0={key:0,class:"filter-section"},b0=["onClick","title"],w0={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},C0={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},L0=["innerHTML"],S0={key:0,class:"dropdown-content action-dropdown"},x0=["onClick"],I0={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=ut(),s=e,i=o,r=T(!1),u=T(null),d=V(()=>u.value!==null),f=()=>{r.value=!r.value,r.value&&(u.value=null)},p=(_,w)=>{i("filter-change",{...s.filters,[_]:w})},g=_=>{_.items&&_.items.length>0?u.value===_.id?u.value=null:(u.value=_.id,r.value=!1):i("action-click",{actionId:_.id})},k=(_,w)=>{u.value=null,i("action-click",{actionId:_,itemId:w})};return t({closeDropdowns:()=>{r.value=!1,u.value=null}}),(_,w)=>(v(),m("div",{class:pe(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:w[0]||(w[0]=S=>_.$emit("fullscreen-click")),title:"Fullscreen"},[...w[8]||(w[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):M("",!0),e.showFilters&&!d.value?(v(),m("div",l0,[r.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:w[1]||(w[1]=S=>r.value=!1)})):M("",!0),l("button",{class:pe(["toolbar-btn",{active:r.value}]),onClick:f,title:"Show/hide options"},[...w[9]||(w[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),r.value?(v(),m("div",r0,[l("div",c0,[w[11]||(w[11]=l("span",{class:"filters-title"},"Map filters",-1)),l("button",{class:"close-filters-btn",onClick:w[2]||(w[2]=S=>r.value=!1),title:"Close"},[...w[10]||(w[10]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),l("div",u0,[w[12]||(w[12]=l("h4",null,"Display",-1)),l("label",d0,[l("input",{type:"checkbox",checked:e.filters.showRoute,onChange:w[3]||(w[3]=S=>p("showRoute",S.target.checked))},null,40,h0),l("span",null,C(O(a).course)+" line",1)])]),l("div",f0,[l("h4",null,C(O(a).checkpoints),1),l("label",p0,[l("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:w[4]||(w[4]=S=>p("showUncheckedIn",S.target.checked))},null,40,v0),w[13]||(w[13]=l("span",{class:"status-indicator unchecked"},null,-1)),w[14]||(w[14]=l("span",null,"Unchecked-in",-1))]),l("label",m0,[l("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:w[5]||(w[5]=S=>p("showPartiallyCheckedIn",S.target.checked))},null,40,g0),w[15]||(w[15]=l("span",{class:"status-indicator partial"},null,-1)),w[16]||(w[16]=l("span",null,"Partially checked-in",-1))]),l("label",y0,[l("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:w[6]||(w[6]=S=>p("showFullyCheckedIn",S.target.checked))},null,40,k0),w[17]||(w[17]=l("span",{class:"status-indicator full"},null,-1)),w[18]||(w[18]=l("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",_0,[l("h4",null,C(O(a).areas),1),Ee(i0,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":w[7]||(w[7]=S=>p("selectedAreaIds",S))},null,8,["areas","selected-area-ids"])])):M("",!0)])):M("",!0)])):M("",!0),(v(!0),m(Ie,null,Ne(e.actions,S=>(v(),m("div",{key:S.id,class:pe(["toolbar-btn-wrapper",{hidden:r.value}])},[l("button",{class:pe(["toolbar-btn",{active:u.value===S.id}]),onClick:E=>g(S),title:S.label||S.id},[S.icon==="plus"?(v(),m("svg",w0,[...w[19]||(w[19]=[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):S.icon==="edit"?(v(),m("svg",C0,[...w[20]||(w[20]=[l("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),l("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):S.icon==="custom"?(v(),m("span",{key:2,innerHTML:S.customIcon},null,8,L0)):M("",!0)],10,b0),S.items&&u.value===S.id?(v(),m("div",S0,[(v(!0),m(Ie,null,Ne(S.items,E=>(v(),m("button",{key:E.id,onClick:A=>k(S.id,E.id),class:"dropdown-item"},C(E.label),9,x0))),128))])):M("",!0)],2))),128))],2))}},$0=je(I0,[["__scopeId","data-v-d04b549d"]]),T0={key:0,class:"drawing-controls"},M0={class:"point-count"},A0={class:"undo-redo-buttons"},E0=["disabled"],P0=["disabled"],D0={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.show&&o.pointCount>0),i=r=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?r.metaKey:r.ctrlKey;d&&r.key==="z"&&!r.shiftKey?(r.preventDefault(),o.canUndo&&a("undo")):d&&(r.key==="y"||r.key==="z"&&r.shiftKey)&&(r.preventDefault(),o.canRedo&&a("redo"))};return nn(()=>{document.addEventListener("keydown",i)}),xn(()=>{document.removeEventListener("keydown",i)}),(r,u)=>s.value?(v(),m("div",T0,[l("div",M0,C(e.pointCount)+" point"+C(e.pointCount!==1?"s":""),1),l("div",A0,[l("button",{onClick:u[0]||(u[0]=d=>r.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,E0),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,P0)])])):M("",!0)}},of=je(D0,[["__scopeId","data-v-6cd009cb"]]),R0={class:"context-info"},O0={class:"action-buttons"},B0=["disabled"],N0={key:0,class:"fullscreen-map-banner"},F0={class:"fullscreen-map-container"},U0={key:1,class:"fullscreen-map-footer"},z0={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=V(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,i=()=>{s("done")},r=()=>{s("cancel")},u=()=>{s("close")},d=f=>{f.key==="Escape"&&o.show&&(o.mode==="view"?u():r())};return Ze(()=>o.show,f=>{f?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),nn(()=>{document.addEventListener("keydown",d)}),xn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(f,p)=>(v(),qe(Tl,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:p[0]||(p[0]=rt(()=>{},["prevent","self"]))},[l("div",{class:"fullscreen-map-header",style:Qe(e.headerStyle)},[l("div",R0,[l("h3",{style:Qe({color:e.headerTextColor})},C(e.title),5),e.description?(v(),m("p",{key:0,style:Qe({color:e.headerTextColor,opacity:.85})},C(e.description),5)):M("",!0)]),l("div",O0,[io(f.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:rt(u,["stop"]),class:"btn btn-close-x",style:Qe(a.value),title:"Close"},[...p[1]||(p[1]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(Ie,{key:1},[l("button",{type:"button",onClick:r,class:"btn btn-cancel"}," Cancel "),l("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,B0)],64))])],4),f.$slots.banner?(v(),m("div",N0,[io(f.$slots,"banner",{},void 0)])):M("",!0),l("div",F0,[io(f.$slots,"default",{},void 0)]),f.$slots.footer?(v(),m("div",U0,[io(f.$slots,"footer",{},void 0)])):M("",!0)],32)):M("",!0)]))}},H0=je(z0,[["__scopeId","data-v-b5d05af4"]]),V0={class:"map-wrapper"},G0={class:"fullscreen-map-wrapper"},j0={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=T(null),r=T(null),u=T(null),d=T(!1),f=T(0),p=T(!1),g=T(!1),k=T({...a.filters});Ze(()=>a.filters,Q=>{k.value={...Q}},{deep:!0}),Ze(()=>a.areas,Q=>{a.showFilters&&Q.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=Q.map(X=>X.id))},{immediate:!0});const y=V(()=>a.showFilters?a.locations.filter(Q=>{const X=Q.checkedInCount||0,ne=Q.requiredMarshals||1,F=X===0,K=X>0&&X<ne,fe=X>=ne;if(F&&!k.value.showUncheckedIn||K&&!k.value.showPartiallyCheckedIn||fe&&!k.value.showFullyCheckedIn)return!1;const he=Q.areaIds||Q.AreaIds||[];return!(a.areas.length>0&&he.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!he.some(et=>k.value.selectedAreaIds.includes(et))))}):a.locations),_=V(()=>a.showFilters?k.value.showRoute?a.route:[]:a.route),w=V(()=>a.showFilters?k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?a.areas.filter(Q=>k.value.selectedAreaIds.includes(Q.id)):a.areas.length>0?[]:a.areas:a.areas),S=V(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),E=()=>d.value?r.value:i.value,A=()=>{d.value=!0,s("fullscreen-change",!0)},x=()=>{d.value=!1,s("fullscreen-change",!1)},D=()=>{if(a.mode==="draw-polygon"){const Q=E();Q&&Q.clearPolygonDrawing(),f.value=0,p.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},R=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const Q=E();Q&&Q.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},H=Q=>{k.value=Q,s("filter-change",Q)},$=Q=>{a.mode==="select-point"&&s("point-selected",Q),s("map-click",Q)},B=Q=>{f.value=Q?.length||0,P(),s("polygon-drawing",Q)},N=Q=>{s("polygon-complete",Q),f.value=0,p.value=!1,g.value=!1},Z=Q=>{s("polygon-update",Q)},P=()=>{const Q=E();Q&&(p.value=Q.canUndo?Q.canUndo():!1,g.value=Q.canRedo?Q.canRedo():!1)},G=()=>{const Q=E();Q&&Q.undoPolygonPoint&&(Q.undoPolygonPoint(),P())},Y=()=>{const Q=E();Q&&Q.redoPolygonPoint&&(Q.redoPolygonPoint(),P())};return t({getMapCenter:()=>E()?.getMapCenter?.(),getMapZoom:()=>E()?.getMapZoom?.(),undoPolygonPoint:G,redoPolygonPoint:Y,canUndo:()=>p.value,canRedo:()=>g.value,getPolygonPointCount:()=>f.value,completePolygon:()=>E()?.completePolygon?.(),clearPolygonDrawing:()=>{E()?.clearPolygonDrawing?.(),f.value=0,p.value=!1,g.value=!1},recenterOnUserLocation:()=>E()?.recenterOnUserLocation?.(),recenterOnLocation:(Q,X,ne)=>E()?.recenterOnLocation?.(Q,X,ne),isLocationInView:(Q,X)=>E()?.isLocationInView?.(Q,X)??!0,getUserLocationInView:()=>E()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>E()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:x,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(Q,X)=>(v(),m("div",{class:"common-map",style:Qe({height:e.height})},[l("div",V0,[Ee(Tu,{ref_key:"mapViewRef",ref:i,locations:y.value,route:_.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:X[0]||(X[0]=ne=>Q.$emit("location-click",ne)),onMapClick:$,onAreaClick:X[1]||(X[1]=ne=>Q.$emit("area-click",ne)),onPolygonComplete:N,onPolygonDrawing:B,onPolygonUpdate:Z,onVisibilityChange:X[2]||(X[2]=ne=>Q.$emit("visibility-change",ne))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee($0,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:A,onFilterChange:H,onActionClick:X[3]||(X[3]=ne=>Q.$emit("action-click",ne))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ee(of,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:G,onRedo:Y},null,8,["show","point-count","can-undo","can-redo"])]),Ee(H0,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":S.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:D,onClose:x},{actions:ze(()=>[io(Q.$slots,"fullscreen-actions",{},void 0,!0)]),banner:ze(()=>[io(Q.$slots,"fullscreen-banner",{},void 0,!0)]),footer:ze(()=>[io(Q.$slots,"fullscreen-footer",{},void 0,!0)]),default:ze(()=>[l("div",G0,[Ee(Tu,{ref_key:"fullscreenMapViewRef",ref:r,locations:y.value,route:_.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:X[4]||(X[4]=ne=>Q.$emit("location-click",ne)),onMapClick:$,onAreaClick:X[5]||(X[5]=ne=>Q.$emit("area-click",ne)),onPolygonComplete:N,onPolygonDrawing:B,onPolygonUpdate:Z,onVisibilityChange:X[6]||(X[6]=ne=>Q.$emit("visibility-change",ne))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(of,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:G,onRedo:Y},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},ri=je(j0,[["__scopeId","data-v-d6bcac0e"]]),Z0={class:"course-areas-tab"},q0={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=e,r=o,u=T(null),d=T(null),f=T(0),p=T({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=V(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),k=({actionId:A,itemId:x})=>{A==="add"&&(x==="checkpoint"?(r("add-checkpoint-from-map"),w()):x==="many-checkpoints"?(r("add-many-checkpoints-from-map"),w()):x==="area"?(r("add-area-from-map"),w()):x==="import"?r("import-checkpoints"):x==="upload"&&r("upload-route"))},y=A=>{p.value=A},_=A=>{f.value=A?.length||0},w=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:w,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ze(()=>i.areas,A=>{if(A.length>0){const x=new Set(p.value.selectedAreaIds);A.forEach(D=>{x.has(D.id)||p.value.selectedAreaIds.push(D.id)}),p.value.selectedAreaIds=p.value.selectedAreaIds.filter(D=>A.some(R=>R.id===D))}},{immediate:!0}),Ze(()=>i.drawingMode,A=>{A||(f.value=0)}),(A,x)=>(v(),m("div",Z0,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ee(ri,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:p.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${O(s).area} boundary`:O(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:x[0]||(x[0]=D=>A.$emit("map-click",D)),onLocationClick:x[1]||(x[1]=D=>A.$emit("location-click",D)),onAreaClick:x[2]||(x[2]=D=>A.$emit("area-click",D)),onPolygonComplete:x[3]||(x[3]=D=>A.$emit("polygon-complete",D)),onPolygonDrawing:_,onFilterChange:y,onActionClick:k},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},W0=je(q0,[["__scopeId","data-v-c0e54ae9"]]),K0=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),s=parseFloat(o),i=parseFloat(a),r=!isNaN(s)&&String(s)===o,u=!isNaN(i)&&String(i)===a;return r&&u?s-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},J0={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:pe(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[io(t.$slots,"default",{},void 0)],2))}},Ln=je(J0,[["__scopeId","data-v-a94deea5"]]),Y0={class:"check-in-toggle-container"},X0=["disabled"],Q0={key:0,class:"toggle-spinner"},ew={key:1,class:"toggle-icon"},tw={class:"toggle-label"},nw={key:0,class:"check-in-details"},ow={key:0,class:"check-in-method"},sw={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=e,o=V(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),a=V(()=>{const{checkedInBy:i,checkInMethod:r,marshalName:u}=t;return i&&i!==u?i:r||""}),s=i=>i?new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(i,r)=>(v(),m("div",Y0,[l("button",{class:pe(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[e.isLoading?(v(),m("span",Q0)):e.isCheckedIn?(v(),m("span",ew,"")):M("",!0),l("span",tw,C(o.value),1)],10,X0),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),m("span",nw,[Je(C(s(e.checkInTime))+" ",1),a.value?(v(),m("span",ow,"("+C(a.value)+")",1)):M("",!0)])):M("",!0)]))}},Vr=je(sw,[["__scopeId","data-v-95f8f1cc"]]),aw={class:"marshals-tab"},iw={class:"tab-header"},lw={class:"button-group"},rw={key:0,class:"status-pills"},cw={class:"filters-section"},uw={class:"search-group"},dw={class:"marshals-grid"},hw={class:"marshals-table"},fw={key:0,class:"sort-indicator"},pw={key:0,class:"sort-indicator"},vw={key:0,class:"sort-indicator"},mw={key:0,class:"sort-indicator"},gw=["onClick"],yw=["rowspan"],kw={class:"checkpoint-cell"},_w={class:"checkpoint-name"},bw={key:0,class:"checkpoint-description"},ww=["rowspan"],Cw={key:0,class:"last-active-text"},Lw={key:1,class:"last-active-never"},Sw=["onClick"],xw={class:"no-checkpoint-text"},Iw={class:"hide-on-mobile last-active-cell"},$w={key:0,class:"last-active-text"},Tw={key:1,class:"last-active-never"},Mw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=ut(),s=e,i=T(null);t({setCheckingIn:Z=>{i.value=Z}});const u=T("name"),d=T("asc"),f=T(""),p=T("all"),g=Z=>{p.value=Z},k=Z=>{u.value===Z?d.value=d.value==="asc"?"desc":"asc":(u.value=Z,d.value="asc")},y=Z=>s.assignments.filter(P=>P.marshalId===Z),_=V(()=>new Set(s.assignments.filter(Z=>Z.isCheckedIn).map(Z=>Z.marshalId))),w=V(()=>new Set(s.assignments.map(Z=>Z.marshalId))),S=V(()=>_.value.size),E=V(()=>s.marshals.filter(Z=>!w.value.has(Z.id)).length),A=V(()=>s.marshals.filter(Z=>w.value.has(Z.id)&&!_.value.has(Z.id)).length),x=Z=>s.locations.find(P=>P.id===Z),D=Z=>{const P=x(Z);return P?P.name:"Unknown"},R=Z=>{const P=x(Z);return P?P.description:""},H=Z=>{const P=s.marshals.find(G=>G.id===Z);return P?P.name:""},$=Z=>{if(!Z)return"";const P=new Date(Z),Y=new Date-P,te=Math.floor(Y/6e4),Q=Math.floor(te/60),X=Math.floor(Q/24);return te<1?"just now":te<60?`${te}m ago`:Q<24?`${Q}h ago`:X===1?"yesterday":X<7?`${X}d ago`:P.toLocaleDateString()},B=V(()=>{let Z=s.marshals;if(p.value==="unassigned"?Z=Z.filter(P=>!w.value.has(P.id)):p.value==="checked-in"?Z=Z.filter(P=>_.value.has(P.id)):p.value==="not-checked-in"&&(Z=Z.filter(P=>w.value.has(P.id)&&!_.value.has(P.id))),f.value.trim()){const P=f.value.toLowerCase().trim().split(/\s+/);Z=Z.filter(G=>{const te=y(G.id).map(X=>{const ne=x(X.locationId);return ne?`${ne.name||""} ${ne.description||""}`:""}).join(" "),Q=`${G.name} ${te}`.toLowerCase();return P.every(X=>Q.includes(X))})}return Z}),N=V(()=>{const Z=[...B.value];return Z.sort((P,G)=>{let Y=0;if(u.value==="name")Y=P.name.localeCompare(G.name);else if(u.value==="checkpoint"){const te=y(P.id),Q=y(G.id),X=te.length>0?D(te[0].locationId):"",ne=Q.length>0?D(Q[0].locationId):"";Y=K0(X,ne)}else if(u.value==="status"){const te=y(P.id),Q=y(G.id),X=te.length>0&&te[0].isCheckedIn?1:0;Y=(Q.length>0&&Q[0].isCheckedIn?1:0)-X}else if(u.value==="lastActive"){const te=P.lastAccessedDate?new Date(P.lastAccessedDate).getTime():0;Y=(G.lastAccessedDate?new Date(G.lastAccessedDate).getTime():0)-te}return d.value==="asc"?Y:-Y}),Z});return(Z,P)=>(v(),m("div",aw,[l("div",iw,[l("div",lw,[l("button",{onClick:P[0]||(P[0]=G=>Z.$emit("add-marshal")),class:"btn btn-primary"}," Add "+C(O(a).person.toLowerCase()),1),l("button",{onClick:P[1]||(P[1]=G=>Z.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",rw,[Ee(Ln,{variant:"neutral",active:p.value==="all",onClick:P[2]||(P[2]=G=>g("all"))},{default:ze(()=>[Je(C(e.marshals.length)+" total ",1)]),_:1},8,["active"]),E.value>0?(v(),qe(Ln,{key:0,variant:"warning",active:p.value==="unassigned",onClick:P[3]||(P[3]=G=>g("unassigned"))},{default:ze(()=>[Je(C(E.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0),S.value>0?(v(),qe(Ln,{key:1,variant:"success",active:p.value==="checked-in",onClick:P[4]||(P[4]=G=>g("checked-in"))},{default:ze(()=>[Je(C(S.value)+" checked in ",1)]),_:1},8,["active"])):M("",!0),A.value>0?(v(),qe(Ln,{key:2,variant:"danger",active:p.value==="not-checked-in",onClick:P[5]||(P[5]=G=>g("not-checked-in"))},{default:ze(()=>[Je(C(A.value)+" not checked in ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),l("div",cw,[l("div",uw,[Ue(l("input",{"onUpdate:modelValue":P[6]||(P[6]=G=>f.value=G),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,f.value]])])]),l("div",dw,[l("table",hw,[l("thead",null,[l("tr",null,[l("th",{onClick:P[7]||(P[7]=G=>k("name")),class:"sortable"},[P[12]||(P[12]=Je(" Name ",-1)),u.value==="name"?(v(),m("span",fw,C(d.value==="asc"?"":""),1)):M("",!0)]),l("th",{onClick:P[8]||(P[8]=G=>k("checkpoint")),class:"sortable"},[Je(C(O(a).checkpoint)+" ",1),u.value==="checkpoint"?(v(),m("span",pw,C(d.value==="asc"?"":""),1)):M("",!0)]),l("th",{onClick:P[9]||(P[9]=G=>k("status")),class:"sortable"},[P[13]||(P[13]=Je(" Status ",-1)),u.value==="status"?(v(),m("span",vw,C(d.value==="asc"?"":""),1)):M("",!0)]),l("th",{onClick:P[10]||(P[10]=G=>k("lastActive")),class:"sortable hide-on-mobile"},[P[14]||(P[14]=Je(" Last active ",-1)),u.value==="lastActive"?(v(),m("span",mw,C(d.value==="asc"?"":""),1)):M("",!0)])])]),l("tbody",null,[(v(!0),m(Ie,null,Ne(N.value,G=>(v(),m(Ie,{key:G.id},[y(G.id).length>0?(v(!0),m(Ie,{key:0},Ne(y(G.id),(Y,te)=>(v(),m("tr",{key:`${G.id}-${Y.id}`,class:"marshal-row",onClick:Q=>Z.$emit("select-marshal",G)},[te===0?(v(),m("td",{key:0,rowspan:y(G.id).length},C(G.name),9,yw)):M("",!0),l("td",kw,[l("div",_w,C(D(Y.locationId)),1),R(Y.locationId)?(v(),m("div",bw,C(R(Y.locationId)),1)):M("",!0)]),l("td",{onClick:P[11]||(P[11]=rt(()=>{},["stop"])),class:"check-in-cell"},[Ee(Vr,{"is-checked-in":Y.isCheckedIn,"check-in-time":Y.checkInTime,"check-in-method":Y.checkInMethod,"checked-in-by":Y.checkedInBy,"marshal-name":H(Y.marshalId),"is-loading":i.value===Y.id,onToggle:Q=>Z.$emit("toggle-check-in",Y)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),te===0?(v(),m("td",{key:1,rowspan:y(G.id).length,class:"hide-on-mobile last-active-cell"},[G.lastAccessedDate?(v(),m("span",Cw,C($(G.lastAccessedDate)),1)):(v(),m("span",Lw,"Never"))],8,ww)):M("",!0)],8,gw))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:Y=>Z.$emit("select-marshal",G)},[l("td",null,C(G.name),1),l("td",xw,"No "+C(O(a).checkpoint.toLowerCase())+" assigned",1),P[15]||(P[15]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),l("td",Iw,[G.lastAccessedDate?(v(),m("span",$w,C($(G.lastAccessedDate)),1)):(v(),m("span",Tw,"Never"))])],8,Sw))],64))),128))])])])]))}},Aw=je(Mw,[["__scopeId","data-v-c3a36b99"]]),Ew={class:"checklists-tab"},Pw={class:"checklists-tab-header"},Dw={class:"button-group"},Rw={class:"filters-section"},Ow={class:"search-group"},Bw=["placeholder"],Nw={class:"checklist-items-list"},Fw={key:0,class:"empty-state"},Uw={class:"checklist-item-content"},zw=["onClick"],Hw={class:"checklist-item-scopes"},Vw=["onClick"],Gw={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=T(""),r=V(()=>{if(!i.value.trim())return s.checklistItems;const p=i.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const k=(g.text||"").toLowerCase();return p.every(y=>k.includes(y))})}),u=V(()=>[...r.value].sort((p,g)=>p.displayOrder!==g.displayOrder?p.displayOrder-g.displayOrder:Vs(p.text,g.text))),d=p=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,OnePerArea:`One per ${a.value.area}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryAreaLead:`Every ${a.value.area} lead`,OneLeadPerArea:`One lead per ${a.value.area}`,AreaLead:`${o.value.area} lead`})[p]||p,f=p=>{if(!p)return"";const g=d(p.scope);if(p.itemType===null)return g;const k=p.ids||[];if(k.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(k.includes("ALL_AREAS"))return`${g} (All ${a.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${g} (All ${a.value.checkpoints})`;const y=k.length;return y===0?g:`${g} (${y})`};return(p,g)=>(v(),m("div",Ew,[l("div",Pw,[l("div",Dw,[l("button",{onClick:g[0]||(g[0]=k=>p.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+C(O(a).checklist),1)])]),l("div",Rw,[l("div",Ow,[Ue(l("input",{"onUpdate:modelValue":g[1]||(g[1]=k=>i.value=k),type:"text",class:"search-input",placeholder:`Search ${O(a).checklists}...`},null,8,Bw),[[st,i.value]])])]),l("div",Nw,[r.value.length===0?(v(),m("div",Fw,[l("p",null,C(i.value?`No ${O(a).checklists} match your search.`:`No ${O(a).checklists} yet. Create one to get started!`),1)])):M("",!0),(v(!0),m(Ie,null,Ne(u.value,k=>(v(),m("div",{key:k.itemId,class:"checklist-item-card"},[l("div",Uw,[l("div",{class:"checklist-item-title",onClick:y=>p.$emit("select-checklist-item",k,"details")},[l("strong",null,C(k.text),1)],8,zw),l("div",Hw,[(v(!0),m(Ie,null,Ne(k.scopeConfigurations,(y,_)=>(v(),m("span",{key:_,class:"scope-badge",onClick:w=>p.$emit("select-checklist-item",k,"visibility")},C(f(y)),9,Vw))),128))])])]))),128))])]))}},jw=je(Gw,[["__scopeId","data-v-123b7338"]]),Zw={class:"notes-tab"},qw={class:"tab-header"},Ww={class:"button-group"},Kw={class:"filters-section"},Jw={class:"search-group"},Yw={class:"notes-list"},Xw={key:0,class:"empty-state"},Qw=["onClick"],eC={class:"note-header"},tC={class:"note-title-row"},nC={key:0,class:"pin-icon",title:"Pinned"},oC={key:1,class:"emergency-indicator",title:"Shown in emergency info"},sC={class:"note-meta"},aC={key:0,class:"category-badge"},iC={class:"created-info"},lC={key:0,class:"note-preview"},rC={class:"note-scopes"},cC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=T(""),i=V(()=>{if(!s.value.trim())return a.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return a.notes.filter(k=>{const y=`${k.title||""} ${k.content||""} ${k.priority||""}`.toLowerCase();return g.every(_=>y.includes(_))})}),r=V(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((k,y)=>{if(k.isPinned!==y.isPinned)return k.isPinned?-1:1;const _=g[k.priority]??2,w=g[y.priority]??2;return _!==w?_-w:k.displayOrder!==y.displayOrder?k.displayOrder-y.displayOrder:Vs(k.title,y.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const k=u(g.scope);if(g.itemType===null)return k;const y=g.ids||[];if(y.includes("ALL_MARSHALS"))return`${k} (Everyone)`;if(y.includes("ALL_AREAS"))return`${k} (All ${o.value.areas})`;if(y.includes("ALL_CHECKPOINTS"))return`${k} (All ${o.value.checkpoints})`;const _=y.length;return _===0?k:`${k} (${_})`},f=g=>{if(!g)return"";const k=150;return g.length<=k?g:g.substring(0,k)+"..."},p=g=>{if(!g)return"";const k=new Date(g),_=new Date-k,w=Math.floor(_/6e4),S=Math.floor(_/36e5),E=Math.floor(_/864e5);return w<1?"Just now":w<60?`${w}m ago`:S<24?`${S}h ago`:E<7?`${E}d ago`:k.toLocaleDateString()};return(g,k)=>(v(),m("div",Zw,[l("div",qw,[l("div",Ww,[l("button",{onClick:k[0]||(k[0]=y=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",Kw,[l("div",Jw,[Ue(l("input",{"onUpdate:modelValue":k[1]||(k[1]=y=>s.value=y),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,s.value]])])]),l("div",Yw,[i.value.length===0?(v(),m("div",Xw,[l("p",null,C(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):M("",!0),(v(!0),m(Ie,null,Ne(r.value,y=>(v(),m("div",{key:y.noteId,class:pe(["note-card",{pinned:y.isPinned}]),onClick:_=>g.$emit("select-note",y)},[l("div",eC,[l("div",tC,[y.isPinned?(v(),m("span",nC,"")):M("",!0),l("span",{class:pe(["priority-indicator",y.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,C(y.title),1),y.showInEmergencyInfo?(v(),m("span",oC,"")):M("",!0)]),l("div",sC,[y.category?(v(),m("span",aC,C(y.category),1)):M("",!0),l("span",iC,C(p(y.createdAt)),1)])]),y.content?(v(),m("div",lC,C(f(y.content)),1)):M("",!0),l("div",rC,[(v(!0),m(Ie,null,Ne(y.scopeConfigurations,(_,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(d(_)),1))),128))])],10,Qw))),128))])]))}},uC=je(cC,[["__scopeId","data-v-071c9763"]]),dC={key:0,class:"empty-state"},hC={key:0,class:"empty-hint"},fC={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",dC,[l("p",null,C(e.emptyMessage),1),e.emptyHint?(v(),m("p",hC,C(e.emptyHint),1)):M("",!0)])):(v(),m("div",{key:1,class:pe(["cards-grid",e.gridClass])},[io(t.$slots,"default",{},void 0)],2))}},ql=je(fC,[["__scopeId","data-v-a842b7b1"]]),pC={class:"contact-card-header"},vC={class:"contact-name-row"},mC={key:0,class:"primary-badge",title:"Primary contact"},gC={class:"contact-name"},yC={key:0,class:"contact-role"},kC={key:0,class:"emergency-indicator",title:"Shown in emergency info"},_C={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},bC=["title"],wC={key:0,class:"contact-card-details"},CC={key:0,class:"contact-phone"},LC={key:1,class:"contact-email"},SC={key:1,class:"contact-card-notes"},xC={key:2,class:"contact-card-scopes"},IC={key:3,class:"contact-card-badge"},$C={key:4,class:"contact-card-badge"},TC={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,r=V(()=>{const k=s.contact.scopeConfigurations;return!k||k.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&i("click",s.contact)},d=k=>k?k==="AreaLead"?`${o.value.area} Lead`:k.replace(/([A-Z])/g," $1").replace(/^./,y=>y.toUpperCase()).trim():"",f=k=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,EveryAreaLead:`Every ${a.value.area} lead`})[k]||k,p=k=>{if(!k)return"";const y=f(k.scope);if(k.itemType===null)return y;const _=k.ids||[];if(_.includes("ALL_MARSHALS"))return`${y} (Everyone)`;if(_.includes("ALL_AREAS"))return`${y} (All ${a.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${y} (All ${a.value.checkpoints})`;const w=_.length;return w===0?y:`${y} (${w})`},g=k=>{if(!k)return"";const y=100;return k.length<=y?k:k.substring(0,y)+"..."};return(k,y)=>(v(),m("div",{class:pe(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[l("div",pC,[l("div",{class:pe(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[l("div",vC,[e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",mC,"")):M("",!0),l("span",gC,C(e.contact.name),1)]),e.contact.role?(v(),m("span",yC,C(d(e.contact.role)),1)):M("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(v(),m("span",kC,"")):M("",!0),r.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",_C,"!")):M("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:y[0]||(y[0]=rt(_=>k.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,bC)):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:y[1]||(y[1]=rt(_=>k.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):M("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",wC,[e.contact.phone?(v(),m("span",CC,C(e.contact.phone),1)):M("",!0),e.contact.email?(v(),m("span",LC,C(e.contact.email),1)):M("",!0)])):M("",!0),e.contact.notes&&e.showNotes?(v(),m("div",SC,C(g(e.contact.notes)),1)):M("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),m("div",xC,[(v(!0),m(Ie,null,Ne(e.contact.scopeConfigurations,(_,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(p(_)),1))),128))])):M("",!0),e.isPending?(v(),m("div",IC,[...y[2]||(y[2]=[l("span",{class:"pending-indicator"},"Will be added on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",$C,[...y[3]||(y[3]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],2))}},MC=je(TC,[["__scopeId","data-v-125408bd"]]),Zv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,a=s=>!s.isPending;return(s,i)=>(v(),qe(ql,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Ie,null,Ne(e.contacts,r=>(v(),qe(MC,{key:r.contactId,contact:r,"is-pending":r.isPending,"is-marked-for-removal":r.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(r),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(r),onClick:u=>s.$emit("select",r),onRemove:i[0]||(i[0]=u=>s.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},AC={class:"contacts-tab"},EC={class:"tab-header"},PC={class:"button-group"},DC={key:0,class:"status-pills"},RC={class:"filters-section"},OC={class:"search-group"},BC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=T(""),s=T("all"),i=V(()=>o.contacts.filter(y=>!y.scopeConfigurations||y.scopeConfigurations.length===0).length),r=V(()=>o.contacts.filter(y=>y.scopeConfigurations&&y.scopeConfigurations.length>0).length),u=y=>{s.value=y},d=y=>y?y.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=y=>y?y.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",p=V(()=>{let y=o.contacts;if(s.value==="no-scope"?y=y.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0):s.value==="with-scope"&&(y=y.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0)),a.value.trim()){const w=d(a.value).split(" ").filter(S=>S.length>0);y=y.filter(S=>{const E=f(S.role),A=d(`${S.name||""} ${E} ${S.email||""} ${S.phone||""}`);return w.every(x=>A.includes(x))})}return y}),g=V(()=>[...p.value].sort((y,_)=>(y.name||"").localeCompare(_.name||"",void 0,{sensitivity:"base"}))),k=V(()=>{const y=a.value.trim();return s.value==="no-scope"?y?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?y?"No assigned contacts match your search.":"No contacts are assigned yet.":y?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(y,_)=>(v(),m("div",AC,[l("div",EC,[l("div",PC,[l("button",{onClick:_[0]||(_[0]=w=>y.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",DC,[Ee(Ln,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=w=>u("all"))},{default:ze(()=>[Je(C(e.contacts.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(Ln,{key:0,variant:"success",active:s.value==="with-scope",onClick:_[2]||(_[2]=w=>u("with-scope"))},{default:ze(()=>[Je(C(r.value)+" assigned ",1)]),_:1},8,["active"])):M("",!0),i.value>0?(v(),qe(Ln,{key:1,variant:"danger",active:s.value==="no-scope",onClick:_[3]||(_[3]=w=>u("no-scope"))},{default:ze(()=>[Je(C(i.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),l("div",RC,[l("div",OC,[Ue(l("input",{"onUpdate:modelValue":_[4]||(_[4]=w=>a.value=w),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,a.value]])])]),Ee(Zv,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":k.value,onSelect:_[5]||(_[5]=w=>y.$emit("select-contact",w))},null,8,["contacts","empty-message"])]))}},NC=je(BC,[["__scopeId","data-v-ca4b1b77"]]),qv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],FC={class:"event-details-tab"},UC={class:"event-info-card"},zC={class:"form-group"},HC={class:"form-group"},VC={class:"form-row"},GC={class:"form-group"},jC={class:"form-group"},ZC=["value"],qC={class:"form-actions"},WC=["disabled"],KC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,s=T({...o.eventData});Ze(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},r=()=>{a("submit",{...s.value})};return(u,d)=>(v(),m("div",FC,[l("div",UC,[l("form",{onSubmit:rt(r,["prevent"]),class:"event-details-form"},[l("div",zC,[d[4]||(d[4]=l("label",null,"Event name",-1)),Ue(l("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.name]])]),l("div",HC,[d[5]||(d[5]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=f=>s.value.description=f),rows:"3",class:"form-input",onInput:i},null,544),[[st,s.value.description]])]),l("div",VC,[l("div",GC,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),Ue(l("input",{"onUpdate:modelValue":d[2]||(d[2]=f=>s.value.eventDate=f),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.eventDate]])]),l("div",jC,[d[7]||(d[7]=l("label",null,"Time zone",-1)),Ue(l("select",{"onUpdate:modelValue":d[3]||(d[3]=f=>s.value.timeZoneId=f),required:"",class:"form-input",onChange:i},[(v(!0),m(Ie,null,Ne(O(qv),f=>(v(),m("option",{key:f.value,value:f.value},C(f.label),9,ZC))),128))],544),[[Bn,s.value.timeZoneId]])])]),l("div",qC,[l("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,WC)])],32)])]))}},JC=je(KC,[["__scopeId","data-v-2754c3cc"]]),YC={class:"admins-list"},XC={class:"admin-info"},QC={class:"admin-role"},e2=["onClick"],t2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[l("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",YC,[(v(!0),m(Ie,null,Ne(e.admins,a=>(v(),m("div",{key:a.userEmail,class:"admin-item"},[l("div",XC,[l("strong",null,C(a.userEmail),1),l("span",QC,C(a.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,e2)):M("",!0)]))),128))])]))}},n2=je(t2,[["__scopeId","data-v-e526860b"]]),An=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Cr="#667eea";function o2(e){const t=e.map(a=>a.color);return An.find(a=>!t.includes(a.hex))?.hex||Cr}const s2={class:"modal-content"},a2={class:"modal-body"},i2={class:"preview-section"},l2={class:"map-preview"},r2=["innerHTML"],c2={class:"options-grid"},u2={class:"option-button-content"},d2={class:"option-button-value icon-value"},h2=["innerHTML"],f2={class:"option-button-content"},p2={class:"option-button-value color-value"},v2=["disabled"],m2={class:"option-button-content"},g2={class:"option-button-value color-value"},y2={class:"option-button-content"},k2={class:"option-button-value icon-value"},_2=["innerHTML"],b2=["disabled"],w2={class:"option-button-content"},C2={class:"option-button-value color-value"},L2={class:"option-button-content"},S2={class:"option-button-value"},x2={class:"option-button-content"},I2={class:"option-button-value"},$2={key:0,class:"centered-popup"},T2={class:"popup-grid"},M2=["onClick"],A2=["innerHTML"],E2={key:0},P2={key:1,class:"centered-popup"},D2={class:"popup-grid"},R2=["title","onClick"],O2=["innerHTML"],B2={key:0},N2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},F2={key:1,class:"custom-check-mark"},U2={key:0,class:"custom-hex-input"},z2={class:"hex-input-row"},H2=["disabled"],V2={key:0,class:"hex-error"},G2={key:2,class:"centered-popup"},j2={class:"popup-grid"},Z2=["title","onClick"],q2=["innerHTML"],W2={key:0},K2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},J2={key:1,class:"custom-check-mark"},Y2={key:0,class:"custom-hex-input"},X2={class:"hex-input-row"},Q2=["disabled"],eL={key:0,class:"hex-error"},tL={key:3,class:"centered-popup icon-popup"},nL={class:"popup-grid"},oL=["onClick"],sL=["innerHTML"],aL={key:0},iL={key:4,class:"centered-popup"},lL={class:"popup-grid"},rL=["title","onClick"],cL=["innerHTML"],uL={key:0},dL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},hL={key:1,class:"custom-check-mark"},fL={key:0,class:"custom-hex-input"},pL={class:"hex-input-row"},vL=["disabled"],mL={key:0,class:"hex-error"},gL={key:5,class:"centered-popup"},yL={class:"size-grid"},kL=["onClick"],_L=["innerHTML"],bL={key:6,class:"centered-popup"},wL={class:"rotation-content"},CL={class:"rotation-preview-container"},LL=["innerHTML"],SL={class:"rotation-control"},xL={class:"rotation-slider-container"},IL=["value"],$L={class:"rotation-value"},TL={class:"rotation-presets"},ML="#667eea",AL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,s=T(o.backgroundShape||"circle"),i=T(o.iconType||"none"),r=T(o.backgroundColor||""),u=T(o.borderColor||""),d=T(o.iconColor||""),f=T(o.size||"100"),p=T(o.mapRotation??""),g=T(null),k=T(!1),y=T(!1),_=T(!1),w=T(""),S=T(""),E=T(""),A=T(null),x=T(null),D=T(null),R=le=>le==="default"?o.inheritedBackgroundShape||"circle":le==="none"?"none":le||"circle",H=le=>le==="default"||!le?F():le==="none"?"transparent":le,$=le=>le==="default"?o.inheritedBorderColor||"#ffffff":le==="none"||!le?"transparent":le,B=le=>{if(le==="default"){const ce=o.inheritedType;return ce&&ce!=="default"&&si(ce).category==="content"?ce:"none"}return le==="none"||!le?"none":le},N=le=>le==="default"||!le?o.inheritedIconColor||"#ffffff":le==="none"?"transparent":le,Z=le=>le==="default"?o.inheritedSize||"100":le||"100",P=le=>{if(le==="default"||le===""){const ce=o.inheritedMapRotation;return ce!==""&&ce!==void 0&&ce!==null&&parseInt(ce,10)||0}return parseInt(le,10)||0},G=V(()=>{const le=o.inheritedBackgroundShape||"circle",ce=fr.find(ge=>ge.value===le)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ce})`,showLabel:!0},...fr.filter(ge=>ge.value!=="none").map(ge=>({...ge,showLabel:!1}))]}),Y=V(()=>{const le=Hr.filter(ot=>ot.category==="content"),ce=[{value:"none",label:"None",category:"content",showLabel:!0}],ge=o.inheritedType;if(ge&&ge!=="default"){const ot=si(ge);ot.category==="content"&&ce.push({value:"default",label:`Default (${ot.label||ge})`,category:"content",showLabel:!0})}return ce.push(...le.map(ot=>({...ot,showLabel:!1}))),ce}),te=V(()=>{const le={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${le[o.inheritedSize]||"Normal"})`},...zb.map(ge=>({value:ge.value,label:le[ge.value]||ge.label}))]}),Q=V(()=>R(s.value)!=="none"),X=V(()=>B(i.value)!=="none"),ne=V(()=>{const le=o.inheritedBackgroundColor;return le&&le!=="default"&&le.startsWith("#")?le:ML}),F=()=>ne.value,K=V(()=>r.value&&r.value!=="default"?r.value:F()),fe=V(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),he=V(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Re=V(()=>{const le=ne.value,ce=An.find(ge=>ge.hex.toLowerCase()===le.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ce})`,showLabel:!0},...An.map(ge=>({hex:ge.hex,name:ge.name,showLabel:!1}))]}),et=V(()=>{const le=o.inheritedBorderColor||"#ffffff",ce=le==="#ffffff"?"White":An.find(ge=>ge.hex===le)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ce})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(ge=>ge.hex!=="#ffffff").map(ge=>({hex:ge.hex,name:ge.name,showLabel:!1}))]}),Xe=V(()=>{const le=o.inheritedIconColor||"#ffffff",ce=le==="#ffffff"?"White":An.find(ge=>ge.hex===le)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ce})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(ge=>ge.hex!=="#ffffff").map(ge=>({hex:ge.hex,name:ge.name,showLabel:!1}))]}),He=le=>le==="default"?!r.value||r.value==="default":r.value===le,Ke=le=>le==="#ffffff"?!d.value||d.value==="#ffffff":d.value===le,ye=V(()=>{const le=r.value;return!le||le==="default"||le==="none"?!1:!An.some(ce=>ce.hex.toLowerCase()===le.toLowerCase())}),Ve=V(()=>{const le=u.value;return!le||le==="default"||le==="none"||le==="#ffffff"||le==="#000000"?!1:!An.some(ce=>ce.hex.toLowerCase()===le.toLowerCase())}),me=V(()=>{const le=d.value;return!le||le==="default"||le==="none"||le==="#ffffff"||le==="#000000"?!1:!An.some(ce=>ce.hex.toLowerCase()===le.toLowerCase())}),xe=V(()=>{if(!w.value)return!1;const le=w.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),De=V(()=>{if(!S.value)return!1;const le=S.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),q=V(()=>{if(!E.value)return!1;const le=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(le)||/^[0-9A-Fa-f]{3}$/.test(le)}),J=le=>{if(le==="none")return"None";if(le==="default"){const ge=o.inheritedBackgroundShape;return ge?`Default (${fr.find(Ge=>Ge.value===ge)?.label||"Circle"})`:"Default (Circle)"}const ce=fr.find(ge=>ge.value===le);return ce?ce.label:"Circle"},ve=le=>{if(le==="none")return"None";if(le==="default"){const ge=o.inheritedType;if(ge&&ge!=="default"){const ot=si(ge);if(ot.category==="content")return`Default (${ot.label||ge})`}return"Default"}const ce=Hr.find(ge=>ge.value===le);return ce?ce.label:"None"},Se=le=>{if(le==="none")return"None";if(!le||le==="default"){const ge=ne.value;return`Default (${An.find(Ge=>Ge.hex.toLowerCase()===ge.toLowerCase())?.name||"Custom"})`}const ce=[...An].find(ge=>ge.hex.toLowerCase()===le.toLowerCase());return ce?ce.name:le},re=le=>{if(le==="none")return"None";if(le==="default"){const ge=o.inheritedBorderColor;return ge&&ge!=="none"?`Default (${ge==="#ffffff"?"White":An.find(Ge=>Ge.hex===ge)?.name||"Custom"})`:"Default (White)"}if(!le||le==="#ffffff")return"White";const ce=[...et.value].find(ge=>ge.hex===le);return ce?ce.name:le},ue=le=>{if(le==="none")return"None";if(le==="default"){const ge=o.inheritedIconColor;return ge?`Default (${ge==="#ffffff"?"White":An.find(Ge=>Ge.hex===ge)?.name||"Custom"})`:"Default (White)"}if(!le||le==="#ffffff")return"White";const ce=[...Xe.value].find(ge=>ge.hex===le);return ce?ce.name:le},ee=le=>{const ce={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(le==="default"){const ge=o.inheritedSize;return`Default (${ce[ge]||"Normal"})`}return ce[le]||"Normal"},W=le=>{if(le==="default"||le===""||le===void 0||le===null){const ce=o.inheritedMapRotation;return ce!==""&&ce!==void 0&&ce!==null?`Default (${ce})`:"Default (0)"}return`${le}`},ie=le=>{if(le==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ce=R(le),ge=H(r.value),ot=$(u.value);return Ai[ce]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Ai[ce]({backgroundColor:ge,borderColor:ot==="transparent"?"none":ot})}</svg>`:""},Le=le=>{const ce=B(le);return ce==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Cn({type:ce,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Ce=le=>{const ce=R(le);if(ce==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const ge=H(r.value),ot=$(u.value),Ge=B(i.value),St=N(d.value);return Cn({type:Ge!=="none"?Ge:ce,backgroundShape:ce,backgroundColor:ge,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},ke=le=>{const ce=H(le),ge=R(s.value),ot=$(u.value),Ge=B(i.value),St=N(d.value);return ge==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ce==="transparent"?"#e2e8f0":ce}"/>
    </svg>`:Cn({type:Ge!=="none"?Ge:ge,backgroundShape:ge,backgroundColor:ce==="transparent"?"#e2e8f0":ce,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},j=le=>{const ce=$(le),ge=R(s.value),ot=H(r.value),Ge=B(i.value),St=N(d.value);return ge==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ce}" stroke-width="2"/>
    </svg>`:Cn({type:Ge!=="none"?Ge:ge,backgroundShape:ge,backgroundColor:ot,borderColor:ce==="transparent"?"none":ce,iconColor:St,size:"100",outputSize:28})},se=le=>{const ce=B(le),ge=R(s.value),ot=H(r.value),Ge=$(u.value),St=N(d.value);if(ce==="none"&&ge==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const Wt=ge!=="none"?ge:"circle";return Cn({type:ce!=="none"?ce:Wt,backgroundShape:Wt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:St,size:"100",outputSize:42})},de=le=>{const ce=N(le),ge=R(s.value),ot=H(r.value),Ge=$(u.value),St=B(i.value);return St==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ce==="transparent"?"#e2e8f0":ce}"/>
    </svg>`:Cn({type:St,backgroundShape:ge!=="none"?ge:"circle",backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:ce==="transparent"?"#e2e8f0":ce,size:"100",outputSize:28})},Me=le=>{const ce=Z(le),ge=R(s.value),ot=H(r.value),Ge=$(u.value),St=B(i.value),Wt=N(d.value);if(ge==="none"&&St==="none")return"";const Qt=ge!=="none"?ge:"circle";return Cn({type:St!=="none"?St:Qt,backgroundShape:Qt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:Wt,size:ce})},Oe=V(()=>{const le=R(s.value),ce=H(r.value),ge=$(u.value),ot=B(i.value),Ge=N(d.value),St=Z(f.value);return le==="none"&&ot==="none"?"":Cn(le==="none"&&ot!=="none"?{type:ot,backgroundShape:"none",backgroundColor:ce,borderColor:"none",iconColor:Ge,size:St}:{type:ot!=="none"?ot:le,backgroundShape:le,backgroundColor:ce,borderColor:ge==="transparent"?"none":ge,iconColor:Ge,size:St})}),Be=le=>{g.value=g.value===le?null:le},Ye=()=>{g.value=null,k.value=!1,y.value=!1,_.value=!1},mt=le=>{s.value=le,Ye()},_t=le=>{r.value=le,Ye()},bt=le=>{u.value=le,Ye()},Mt=le=>{i.value=le,Ye()},wt=le=>{d.value=le,Ye()},Nt=le=>{f.value=le,Ye()},Ft=le=>{p.value=le,Ye()},Fn=()=>{k.value=!k.value,k.value&&(ye.value?w.value=r.value.replace(/^#/,""):w.value="",cn(()=>A.value?.focus()))},Qn=()=>{y.value=!y.value,y.value&&(Ve.value?S.value=u.value.replace(/^#/,""):S.value="",cn(()=>x.value?.focus()))},fn=()=>{_.value=!_.value,_.value&&(me.value?E.value=d.value.replace(/^#/,""):E.value="",cn(()=>D.value?.focus()))},jt=()=>{w.value=w.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},yt=()=>{S.value=S.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},eo=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Un=le=>le.length===3?le[0]+le[0]+le[1]+le[1]+le[2]+le[2]:le,to=()=>{if(!xe.value)return;const le=Un(w.value);r.value="#"+le,k.value=!1,Ye()},pn=()=>{if(!De.value)return;const le=Un(S.value);u.value="#"+le,y.value=!1,Ye()},Zt=()=>{if(!q.value)return;const le=Un(E.value);d.value="#"+le,_.value=!1,Ye()},ks=le=>{p.value=le};Ze(()=>o.isOpen,le=>{if(le){const ce=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",ge=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",ot=o.backgroundColor&&o.backgroundColor!=="",Ge=o.borderColor&&o.borderColor!=="",St=o.iconColor&&o.iconColor!=="",Wt=o.size&&o.size!==""&&o.size!=="100",Qt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ce||ge||ot||Ge||St||Wt||Qt?(s.value=o.backgroundShape||"default",i.value=o.iconType||"default",r.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",f.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",i.value="default",r.value="default",u.value="default",d.value="default",f.value="default",p.value="default"),g.value=null}});const no=()=>{Ye(),a("update:isOpen",!1),a("cancel")},Co=()=>{Ye();const le=ot=>ot==="default"?"":ot;let ce="";i.value==="none"?ce="none":i.value&&i.value!=="default"&&(ce=i.value);let ge="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(ge=parseInt(p.value,10)||0),a("apply",{iconType:ce,backgroundShape:le(s.value),backgroundColor:le(r.value),borderColor:le(u.value),iconColor:le(d.value),size:le(f.value),mapRotation:ge}),a("update:isOpen",!1)};return(le,ce)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(no,["self"])},[l("div",s2,[l("div",{class:"modal-header"},[ce[18]||(ce[18]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:no},"")]),l("div",a2,[l("div",i2,[l("div",l2,[ce[19]||(ce[19]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:Qe({transform:`rotate(${P(p.value)}deg)`}),innerHTML:Oe.value},null,12,r2)])]),l("div",c2,[l("button",{type:"button",class:pe(["option-button",{active:g.value==="shape"}]),onClick:ce[0]||(ce[0]=ge=>Be("shape"))},[l("div",u2,[ce[20]||(ce[20]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",d2,[l("div",{class:"icon-preview-small",innerHTML:ie(s.value)},null,8,h2),l("span",null,C(J(s.value)),1)])]),ce[21]||(ce[21]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="bgColor"}]),onClick:ce[1]||(ce[1]=ge=>Be("bgColor"))},[l("div",f2,[ce[22]||(ce[22]=l("span",{class:"option-button-label"},"Background",-1)),l("div",p2,[l("span",{class:"color-swatch",style:Qe({backgroundColor:K.value})},null,4),l("span",null,C(Se(r.value)),1)])]),ce[23]||(ce[23]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="borderColor",disabled:!Q.value}]),disabled:!Q.value,onClick:ce[2]||(ce[2]=ge=>Be("borderColor"))},[l("div",m2,[ce[24]||(ce[24]=l("span",{class:"option-button-label"},"Border",-1)),l("div",g2,[l("span",{class:pe(["color-swatch",{"no-border":u.value==="none"}]),style:Qe(u.value!=="none"?{backgroundColor:fe.value}:{})},null,6),l("span",null,C(re(u.value)),1)])]),ce[25]||(ce[25]=l("span",{class:"option-button-arrow"},"",-1))],10,v2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="icon"}]),onClick:ce[3]||(ce[3]=ge=>Be("icon"))},[l("div",y2,[ce[26]||(ce[26]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",k2,[l("div",{class:"icon-preview-small",innerHTML:Le(i.value)},null,8,_2),l("span",null,C(ve(i.value)),1)])]),ce[27]||(ce[27]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="iconColor",disabled:!X.value}]),disabled:!X.value,onClick:ce[4]||(ce[4]=ge=>Be("iconColor"))},[l("div",w2,[ce[28]||(ce[28]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",C2,[l("span",{class:"color-swatch",style:Qe({backgroundColor:he.value})},null,4),l("span",null,C(ue(d.value)),1)])]),ce[29]||(ce[29]=l("span",{class:"option-button-arrow"},"",-1))],10,b2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="size"}]),onClick:ce[5]||(ce[5]=ge=>Be("size"))},[l("div",L2,[ce[30]||(ce[30]=l("span",{class:"option-button-label"},"Size",-1)),l("span",S2,C(ee(f.value)),1)]),ce[31]||(ce[31]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:ce[6]||(ce[6]=ge=>Be("mapRotation"))},[l("div",x2,[ce[32]||(ce[32]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",I2,C(W(p.value)),1)]),ce[33]||(ce[33]=l("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",$2,[l("div",{class:"popup-header"},[ce[34]||(ce[34]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",T2,[(v(!0),m(Ie,null,Ne(G.value,ge=>(v(),m("button",{key:ge.value,type:"button",class:pe(["popup-grid-item",{selected:s.value===ge.value}]),onClick:ot=>mt(ge.value)},[l("div",{class:"popup-item-preview",innerHTML:Ce(ge.value)},null,8,A2),ge.showLabel?(v(),m("span",E2,C(ge.label),1)):M("",!0)],10,M2))),128))])])):M("",!0),g.value==="bgColor"?(v(),m("div",P2,[l("div",{class:"popup-header"},[ce[35]||(ce[35]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",D2,[(v(!0),m(Ie,null,Ne(Re.value,ge=>(v(),m("button",{key:ge.hex,type:"button",class:pe(["popup-grid-item",{selected:He(ge.hex)}]),title:ge.name,onClick:ot=>_t(ge.hex)},[l("div",{class:"popup-item-preview",innerHTML:ke(ge.hex)},null,8,O2),ge.showLabel?(v(),m("span",B2,C(ge.name),1)):M("",!0)],10,R2))),128)),l("button",{type:"button",class:pe(["popup-grid-item custom-color-option",{selected:ye.value}]),style:Qe(ye.value?{"--custom-color":r.value}:{}),title:"Custom colour",onClick:Fn},[l("div",{class:"popup-item-preview custom-color-preview",style:Qe(ye.value?{backgroundColor:r.value}:{})},[ye.value?M("",!0):(v(),m("svg",N2,[...ce[36]||(ce[36]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),ye.value?(v(),m("span",F2,"")):M("",!0)],4),ce[37]||(ce[37]=l("span",null,"Custom",-1))],6)]),k.value?(v(),m("div",U2,[ce[39]||(ce[39]=l("label",null,"Enter hex code",-1)),l("div",z2,[ce[38]||(ce[38]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"bgHexInput",ref:A,"onUpdate:modelValue":ce[7]||(ce[7]=ge=>w.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:w.value&&!xe.value}]),onInput:jt,onKeydown:ps(to,["enter"])},null,34),[[st,w.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:xe.value?"#"+w.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!xe.value,onClick:to}," Apply ",8,H2)]),w.value&&!xe.value?(v(),m("span",V2," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="borderColor"?(v(),m("div",G2,[l("div",{class:"popup-header"},[ce[40]||(ce[40]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",j2,[(v(!0),m(Ie,null,Ne(et.value,ge=>(v(),m("button",{key:ge.hex,type:"button",class:pe(["popup-grid-item",{selected:u.value===ge.hex}]),title:ge.name,onClick:ot=>bt(ge.hex)},[l("div",{class:"popup-item-preview",innerHTML:j(ge.hex)},null,8,q2),ge.showLabel?(v(),m("span",W2,C(ge.name),1)):M("",!0)],10,Z2))),128)),l("button",{type:"button",class:pe(["popup-grid-item custom-color-option",{selected:Ve.value}]),style:Qe(Ve.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:Qn},[l("div",{class:"popup-item-preview custom-color-preview",style:Qe(Ve.value?{backgroundColor:u.value}:{})},[Ve.value?M("",!0):(v(),m("svg",K2,[...ce[41]||(ce[41]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Ve.value?(v(),m("span",J2,"")):M("",!0)],4),ce[42]||(ce[42]=l("span",null,"Custom",-1))],6)]),y.value?(v(),m("div",Y2,[ce[44]||(ce[44]=l("label",null,"Enter hex code",-1)),l("div",X2,[ce[43]||(ce[43]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"borderHexInput",ref:x,"onUpdate:modelValue":ce[8]||(ce[8]=ge=>S.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!De.value}]),onInput:yt,onKeydown:ps(pn,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:De.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!De.value,onClick:pn}," Apply ",8,Q2)]),S.value&&!De.value?(v(),m("span",eL," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="icon"?(v(),m("div",tL,[l("div",{class:"popup-header"},[ce[45]||(ce[45]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",nL,[(v(!0),m(Ie,null,Ne(Y.value,ge=>(v(),m("button",{key:ge.value,type:"button",class:pe(["popup-grid-item",{selected:i.value===ge.value}]),onClick:ot=>Mt(ge.value)},[l("div",{class:"popup-item-preview",innerHTML:se(ge.value)},null,8,sL),ge.showLabel?(v(),m("span",aL,C(ge.label),1)):M("",!0)],10,oL))),128))])])):M("",!0),g.value==="iconColor"?(v(),m("div",iL,[l("div",{class:"popup-header"},[ce[46]||(ce[46]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",lL,[(v(!0),m(Ie,null,Ne(Xe.value,ge=>(v(),m("button",{key:ge.hex,type:"button",class:pe(["popup-grid-item",{selected:Ke(ge.hex)}]),title:ge.name,onClick:ot=>wt(ge.hex)},[l("div",{class:"popup-item-preview",innerHTML:de(ge.hex)},null,8,cL),ge.showLabel?(v(),m("span",uL,C(ge.name),1)):M("",!0)],10,rL))),128)),l("button",{type:"button",class:pe(["popup-grid-item custom-color-option",{selected:me.value}]),style:Qe(me.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:fn},[l("div",{class:"popup-item-preview custom-color-preview",style:Qe(me.value?{backgroundColor:d.value}:{})},[me.value?M("",!0):(v(),m("svg",dL,[...ce[47]||(ce[47]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),me.value?(v(),m("span",hL,"")):M("",!0)],4),ce[48]||(ce[48]=l("span",null,"Custom",-1))],6)]),_.value?(v(),m("div",fL,[ce[50]||(ce[50]=l("label",null,"Enter hex code",-1)),l("div",pL,[ce[49]||(ce[49]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"iconHexInput",ref:D,"onUpdate:modelValue":ce[9]||(ce[9]=ge=>E.value=ge),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:E.value&&!q.value}]),onInput:eo,onKeydown:ps(Zt,["enter"])},null,34),[[st,E.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:q.value?"#"+E.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!q.value,onClick:Zt}," Apply ",8,vL)]),E.value&&!q.value?(v(),m("span",mL," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="size"?(v(),m("div",gL,[l("div",{class:"popup-header"},[ce[51]||(ce[51]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",yL,[(v(!0),m(Ie,null,Ne(te.value,ge=>(v(),m("button",{key:ge.value,type:"button",class:pe(["size-grid-item",{selected:f.value===ge.value}]),onClick:ot=>Nt(ge.value)},[l("div",{class:"size-preview",innerHTML:Me(ge.value)},null,8,_L),l("span",null,C(ge.label),1)],10,kL))),128))])])):M("",!0),g.value==="mapRotation"?(v(),m("div",bL,[l("div",{class:"popup-header"},[ce[52]||(ce[52]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:Ye},"")]),l("div",wL,[l("div",CL,[l("div",{class:"rotation-preview-icon",style:Qe({transform:`rotate(${P(p.value)}deg)`}),innerHTML:Oe.value},null,12,LL)]),ce[53]||(ce[53]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",SL,[l("button",{type:"button",class:pe(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:ce[10]||(ce[10]=ge=>Ft("default"))}," Default ",2),l("div",xL,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:ce[11]||(ce[11]=ge=>ks(parseInt(ge.target.value,10)))},null,40,IL),l("div",$L,C(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),l("div",TL,[l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===-90}]),onClick:ce[12]||(ce[12]=ge=>Ft(-90))},"-90",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===-45}]),onClick:ce[13]||(ce[13]=ge=>Ft(-45))},"-45",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===0}]),onClick:ce[14]||(ce[14]=ge=>Ft(0))},"0",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===45}]),onClick:ce[15]||(ce[15]=ge=>Ft(45))},"+45",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===90}]),onClick:ce[16]||(ce[16]=ge=>Ft(90))},"+90",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===180}]),onClick:ce[17]||(ce[17]=ge=>Ft(180))},"180",2)])])])):M("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:no},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:Co},"Apply")])])])):M("",!0)}},EL=je(AL,[["__scopeId","data-v-bbab1a46"]]),PL={class:"checkpoint-style-picker"},DL={class:"form-group"},RL={class:"style-options"},OL=["innerHTML"],BL={class:"option-label"},NL=["innerHTML"],FL="#667eea",UL={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,s=T(o.styleType),i=T(o.styleColor||""),r=T(o.styleBackgroundShape||"default"),u=T(o.styleBackgroundColor||""),d=T(o.styleBorderColor||""),f=T(o.styleIconColor||""),p=T(o.styleSize||"default"),g=T(o.styleMapRotation||""),k=P=>!P||P==="default"?!1:si(P).category==="content",y=T(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&k(o.styleType)?o.styleType:"default"),_=T(!1),w=V(()=>!!(s.value&&s.value!=="default"||r.value&&r.value!=="default"&&r.value!=="circle"||u.value||d.value||f.value||p.value&&p.value!=="default"&&p.value!=="100")),S=P=>P&&P!==""&&P!=="default",E=P=>P&&P.startsWith("#"),A=V(()=>{const G=S(o.inheritedStyleType),Y=S(o.inheritedBackgroundShape),te=E(o.inheritedBackgroundColor)||E(o.inheritedStyleColor),Q=E(o.inheritedBorderColor),X=E(o.inheritedIconColor),ne=S(o.inheritedSize);if(G||Y||te||Q||X||ne){const K=G?o.inheritedStyleType:Y?o.inheritedBackgroundShape:"circle",fe=(E(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(E(o.inheritedStyleColor)?o.inheritedStyleColor:null)||FL;return Cn({type:K,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:fe,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),x=V(()=>{const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),D=V(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const G=parseInt(g.value,10)||0;if(G!==0)return{transform:`rotate(${G}deg)`}}const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),R=V(()=>{if(w.value){const P=y.value&&y.value!=="none"&&y.value!=="default";let G=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&si(o.inheritedStyleType).category==="content"&&(G=o.inheritedStyleType);const Y=y.value==="default"&&G,te=P||Y,Q=P?y.value:Y?G:null,X=r.value&&r.value!=="default"?r.value:o.inheritedBackgroundShape||"circle",ne=te?Q:X,F=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",K=d.value||o.inheritedBorderColor||"#ffffff",fe=f.value||o.inheritedIconColor||"#ffffff";return Cn({type:ne,backgroundShape:X,backgroundColor:F,borderColor:K,iconColor:fe,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),H=()=>{s.value="default",y.value="default",a("update:styleType","default"),r.value="default",u.value="",i.value="",d.value="",f.value="",p.value="default",g.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),Z()},$=()=>{_.value=!0},B=P=>{P.iconType==="none"?y.value="none":P.iconType?y.value=P.iconType:y.value="default",r.value=P.backgroundShape||"default",u.value=P.backgroundColor||"",d.value=P.borderColor||"",f.value=P.iconColor||"",p.value=P.size||"default",g.value=P.mapRotation??"";const G=P.iconType==="none"||P.iconType&&P.iconType!==""||P.backgroundShape||P.backgroundColor||P.borderColor||P.iconColor||P.size||P.mapRotation!==""&&P.mapRotation!==0;P.iconType&&P.iconType!=="none"?s.value=P.iconType:G?s.value="custom":s.value="default",a("update:styleType",s.value),a("update:styleBackgroundShape",P.backgroundShape),a("update:styleBackgroundColor",P.backgroundColor),a("update:styleBorderColor",P.borderColor),a("update:styleIconColor",P.iconColor),a("update:styleSize",P.size),a("update:styleMapRotation",P.mapRotation??""),Z()},N=()=>{},Z=()=>{a("change",{styleType:s.value,styleColor:u.value||i.value,styleBackgroundShape:r.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:f.value,styleSize:p.value,styleMapRotation:g.value})};return Ze(()=>o.styleType,P=>{s.value=P,P&&P!=="default"&&P!=="custom"&&k(P)?y.value=P:y.value="default"}),Ze(()=>o.styleColor,P=>{i.value=P||""}),Ze(()=>o.styleBackgroundShape,P=>{r.value=P||"default"}),Ze(()=>o.styleBackgroundColor,P=>{u.value=P||""}),Ze(()=>o.styleBorderColor,P=>{d.value=P||""}),Ze(()=>o.styleIconColor,P=>{f.value=P||""}),Ze(()=>o.styleSize,P=>{p.value=P||"default"}),Ze(()=>o.styleMapRotation,P=>{g.value=P??""}),(P,G)=>(v(),m("div",PL,[l("div",DL,[l("label",null,C(e.iconLabel),1),l("div",RL,[l("button",{type:"button",class:pe(["style-option-button",{selected:!w.value}]),onClick:H},[l("div",{class:"option-preview",style:Qe(x.value),innerHTML:A.value},null,12,OL),l("span",BL,C(e.defaultLabel),1)],2),l("button",{type:"button",class:pe(["style-option-button",{selected:w.value}]),onClick:$},[l("div",{class:"option-preview",style:Qe(D.value),innerHTML:R.value},null,12,NL),G[1]||(G[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Ee(EL,{isOpen:_.value,"onUpdate:isOpen":G[0]||(G[0]=Y=>_.value=Y),"icon-type":y.value,"background-shape":r.value,"background-color":u.value,"border-color":d.value,"icon-color":f.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:B,onCancel:N},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},ad=je(UL,[["__scopeId","data-v-c066da64"]]),zL={class:"logo-uploader"},HL={key:0,class:"logo-preview"},VL=["src"],GL=["disabled"],jL={key:0,class:"upload-progress"},ZL={key:1,class:"upload-prompt"},qL={key:2,class:"error-message"},sf=5*1024*1024,WL={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=X=>X?X.startsWith("/api")?ya+X.substring(4):X:"",s=e;function i(){const X={},ne=localStorage.getItem("adminEmail");ne&&(X["X-Admin-Email"]=ne);const F=localStorage.getItem("sessionToken");return F&&(X.Authorization=`Bearer ${F}`),X}const r=o;function u(){r("staged-change",{hasPendingChanges:y.value!==null||w.value,isPendingDelete:w.value,displayUrl:_.value||(w.value?"":s.modelValue)||""})}const d=T(null),f=T(!1),p=T(!1),g=T(""),k=T(Date.now()),y=T(null),_=T(""),w=T(!1),S=V(()=>{if(s.staged){if(_.value)return!0;if(w.value)return!1}return!!s.modelValue}),E=V(()=>{if(s.staged&&w.value)return"";if(s.staged&&_.value)return _.value;if(!s.modelValue)return"";const X=a(s.modelValue),ne=X.includes("?")?"&":"?";return`${X}${ne}_t=${k.value}`});function A(){_.value&&(URL.revokeObjectURL(_.value),_.value="")}xn(()=>{A()});const x=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function D(){f.value||d.value?.click()}function R(X){const ne=X.target.files?.[0];ne&&$(ne),d.value&&(d.value.value="")}function H(X){p.value=!1;const ne=X.dataTransfer?.files?.[0];ne&&$(ne)}async function $(X){if(g.value="",!x.includes(X.type)){g.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(X.size>sf){g.value=`File too large. Maximum size is ${sf/(1024*1024)}MB.`;return}if(s.staged){A(),y.value=X,_.value=URL.createObjectURL(X),w.value=!1,u();return}f.value=!0;try{const ne=await fetch(`${ya}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":X.type,...i()},body:X});if(!ne.ok){const K=await ne.text().catch(()=>"");let fe=`Upload failed (${ne.status})`;try{fe=JSON.parse(K).message||fe}catch{K&&(fe=K)}throw new Error(fe)}const F=await ne.json();k.value=Date.now(),r("update:modelValue",F.logoUrl)}catch(ne){console.error("Logo upload error:",ne),ne.name==="TypeError"&&ne.message==="Failed to fetch"?g.value="Network error. Check your connection or try a smaller file.":ne.message?.includes("401")||ne.message?.includes("403")?g.value="Not authorized. Please refresh the page and try again.":g.value=ne.message||"Failed to upload logo. Please try again."}finally{f.value=!1}}async function B(){if(g.value="",s.staged){y.value?(A(),y.value=null):s.modelValue&&(w.value=!0),u();return}f.value=!0;try{const X=await fetch(`${ya}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!X.ok){const ne=await X.json().catch(()=>({}));throw new Error(ne.message||"Delete failed")}r("update:modelValue","")}catch(X){console.error("Logo delete error:",X),g.value=X.message||"Failed to remove logo. Please try again."}finally{f.value=!1}}async function N(){if(!y.value)return{success:!0,logoUrl:w.value?"":s.modelValue};f.value=!0,g.value="";try{const X=await fetch(`${ya}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":y.value.type,...i()},body:y.value});if(!X.ok){const F=await X.text().catch(()=>"");let K=`Upload failed (${X.status})`;try{K=JSON.parse(F).message||K}catch{F&&(K=F)}throw new Error(K)}const ne=await X.json();return k.value=Date.now(),A(),y.value=null,w.value=!1,{success:!0,logoUrl:ne.logoUrl}}catch(X){return console.error("Logo upload error:",X),g.value=X.message||"Failed to upload logo. Please try again.",{success:!1,error:X.message}}finally{f.value=!1}}async function Z(){if(!w.value)return{success:!0};f.value=!0,g.value="";try{const X=await fetch(`${ya}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!X.ok){const ne=await X.json().catch(()=>({}));throw new Error(ne.message||"Delete failed")}return w.value=!1,{success:!0}}catch(X){return console.error("Logo delete error:",X),g.value=X.message||"Failed to remove logo. Please try again.",{success:!1,error:X.message}}finally{f.value=!1}}function P(){return y.value!==null||w.value}function G(){return y.value}function Y(){return w.value}function te(){return _.value?_.value:w.value?"":a(s.modelValue)||""}function Q(){A(),y.value=null,w.value=!1}return t({uploadStagedFile:N,deleteStagedLogo:Z,hasPendingChanges:P,getStagedFile:G,isPendingDelete:Y,getDisplayUrl:te,resetStagedState:Q}),(X,ne)=>(v(),m("div",zL,[ne[4]||(ne[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),S.value?(v(),m("div",HL,[l("img",{src:E.value,alt:"Event logo",class:"logo-image"},null,8,VL),l("button",{type:"button",class:"remove-btn",onClick:B,disabled:f.value}," Remove ",8,GL)])):(v(),m("div",{key:1,class:pe(["upload-area",{"drag-over":p.value,uploading:f.value}]),onDragover:ne[0]||(ne[0]=rt(F=>p.value=!0,["prevent"])),onDragleave:ne[1]||(ne[1]=rt(F=>p.value=!1,["prevent"])),onDrop:rt(H,["prevent"]),onClick:D},[l("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:R},null,544),f.value?(v(),m("div",jL,[...ne[2]||(ne[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),m("div",ZL,[...ne[3]||(ne[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),g.value?(v(),m("div",qL,C(g.value),1)):M("",!0)]))}},KL=je(WL,[["__scopeId","data-v-bfb1b332"]]),Wv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function JL(){return{...Wv[0]}}function YL(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function Mu(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function Au(e){return!e||e===""?"#ffffff":Mu(e)>.179?"#333333":"#ffffff"}function Kv(e,t){const o=e||ln.headerGradientStart,a=t||ln.headerGradientEnd,s=Mu(o),i=Mu(a);return(s+i)/2>.35?"#333333":"#ffffff"}const ln={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},XL={class:"marshal-mockup-container"},QL={class:"presets-section"},eS={class:"presets-row"},tS=["title","onClick"],nS={class:"preset-name"},oS={class:"mockup-frame"},sS={key:0,class:"logo-cover-bg"},aS=["src"],iS=["src"],lS={class:"header-center"},rS={class:"event-name"},cS={class:"mockup-buttons"},uS=["src"],dS={class:"mockup-body"},hS={class:"mockup-card"},fS={class:"card-content"},pS={class:"editor-header"},vS={class:"editor-content"},mS={class:"color-grid-inline"},gS={class:"color-field"},yS={class:"color-swatches"},kS=["title","onClick"],_S={key:0,class:"check"},bS={class:"custom-color-wrapper"},wS={class:"hex-popup-header"},CS={class:"hex-input-row"},LS=["disabled"],SS={key:0,class:"hex-error"},xS={class:"gradient-toggle"},IS={key:0,class:"color-field"},$S={class:"color-swatches"},TS=["title","onClick"],MS={key:0,class:"check"},AS={class:"custom-color-wrapper"},ES={class:"hex-popup-header"},PS={class:"hex-input-row"},DS=["disabled"],RS={key:0,class:"hex-error"},OS={key:1,class:"logo-position-section"},BS={class:"position-buttons"},NS={class:"color-swatches"},FS=["title","onClick"],US={key:0,class:"check"},zS={class:"custom-color-wrapper"},HS={class:"hex-popup-header"},VS={class:"hex-input-row"},GS=["disabled"],jS={key:0,class:"hex-error"},ZS={class:"color-grid-inline"},qS={class:"color-field"},WS={class:"color-swatches"},KS=["title","onClick"],JS={key:0,class:"check"},YS={class:"custom-color-wrapper"},XS={class:"hex-popup-header"},QS={class:"hex-input-row"},ex=["disabled"],tx={key:0,class:"hex-error"},nx={class:"gradient-toggle"},ox={key:0,class:"color-field"},sx={class:"color-swatches"},ax=["title","onClick"],ix={key:0,class:"check"},lx={class:"custom-color-wrapper"},rx={class:"hex-popup-header"},cx={class:"hex-input-row"},ux=["disabled"],dx={key:0,class:"hex-error"},hx={class:"editor-footer"},fx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=ee=>ee?ee.startsWith("/api")?ya+ee.substring(4):ee:"",s=An,i=e,r=o,u=T(null),d=Wv,f=T(!1),p=T(!1),g=T(null),k=T(!1),y=T(""),_=ee=>{typeof ee=="object"&&ee!==null?(k.value=ee.isPendingDelete,y.value=ee.displayUrl||"",r("logo-staged-change",ee.hasPendingChanges)):(g.value&&(k.value=g.value.isPendingDelete(),y.value=g.value.getDisplayUrl()||""),r("logo-staged-change",!!ee))},w=T(null),S=T(""),E=T(null),A=T(null),x=T({left:"50%",right:"auto",transform:"translateX(-50%)"}),D=ee=>ee?!s.some(W=>W.hex.toLowerCase()===ee.toLowerCase()):!1,R=ee=>!ee||!D(ee)?"#666666":Au(ee),H=ee=>!ee||!D(ee)?"#e0e0e0":ee,$=V(()=>{if(!S.value)return!1;const ee=S.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ee)||/^[0-9A-Fa-f]{3}$/.test(ee)}),B=(ee,W)=>{if(w.value===ee)w.value=null;else{w.value=ee;let ie="";switch(ee){case"headerStart":ie=i.branding.headerGradientStart;break;case"headerEnd":ie=i.branding.headerGradientEnd;break;case"pageStart":ie=i.branding.pageGradientStart;break;case"pageEnd":ie=i.branding.pageGradientEnd;break;case"accent":ie=i.branding.accentColor;break}if(ie&&D(ie)?S.value=ie.replace(/^#/,""):S.value="",W&&A.value){const Le=W.currentTarget,Ce=A.value,ke=Le.getBoundingClientRect(),j=Ce.getBoundingClientRect(),se=220,de=12,Me=ke.left+ke.width/2-j.left,Oe=j.width,Be=Me-se/2;Me+se/2>Oe-de?x.value={left:"auto",right:"0",transform:"none"}:Be<de?x.value={left:"0",right:"auto",transform:"none"}:x.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>E.value?.focus())}},N=()=>{S.value=S.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Z=()=>{if(!$.value||!w.value)return;let ee=S.value;ee.length===3&&(ee=ee[0]+ee[0]+ee[1]+ee[1]+ee[2]+ee[2]);const W="#"+ee;switch(w.value){case"headerStart":Ve("start",W);break;case"headerEnd":ye("headerGradientEnd",W);break;case"pageStart":me("start",W);break;case"pageEnd":ye("pageGradientEnd",W);break;case"accent":ye("accentColor",W);break}w.value=null};Ze(u,ee=>{if(w.value=null,S.value="",ee==="header"){const W=i.branding.headerGradientStart||ln.headerGradientStart,ie=i.branding.headerGradientEnd||ln.headerGradientEnd;f.value=W!==ie}else if(ee==="page"){const W=i.branding.pageGradientStart||ln.pageGradientStart,ie=i.branding.pageGradientEnd||ln.pageGradientEnd;p.value=W!==ie}});const P={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},G=V(()=>i.branding.headerGradientStart||ln.headerGradientStart),Y=V(()=>i.branding.headerGradientEnd||ln.headerGradientEnd),te=V(()=>i.branding.accentColor||ln.accentColor),Q=V(()=>i.branding.pageGradientStart||ln.pageGradientStart),X=V(()=>i.branding.pageGradientEnd||ln.pageGradientEnd),ne=V(()=>i.branding.logoPosition||"left"),F=T(Date.now());Ze(()=>i.branding.logoUrl,()=>{F.value=Date.now(),k.value=!1,y.value=""});const K=V(()=>k.value?!1:!!(y.value||i.branding.logoUrl)),fe=V(()=>{if(k.value)return"";if(y.value){if(y.value.startsWith("blob:"))return y.value;const ie=a(y.value),Le=ie.includes("?")?"&":"?";return`${ie}${Le}_t=${F.value}`}if(!i.branding.logoUrl)return"";const ee=a(i.branding.logoUrl),W=ee.includes("?")?"&":"?";return`${ee}${W}_t=${F.value}`}),he=V(()=>({background:`linear-gradient(135deg, ${G.value} 0%, ${Y.value} 100%)`})),Re=V(()=>Kv(G.value,Y.value)),et=V(()=>({background:te.value,color:Au(te.value)})),Xe=V(()=>({background:`linear-gradient(135deg, ${Q.value} 0%, ${X.value} 100%)`}));function He(ee){u.value=u.value===ee?null:ee}function Ke(ee){!K.value&&ee&&ye("logoPosition",ee),He("logo")}function ye(ee,W){r("update:branding",{...i.branding,[ee]:W})}function Ve(ee,W){f.value?ye("headerGradientStart",W):r("update:branding",{...i.branding,headerGradientStart:W,headerGradientEnd:W})}function me(ee,W){p.value?ye("pageGradientStart",W):r("update:branding",{...i.branding,pageGradientStart:W,pageGradientEnd:W})}function xe(){if(!f.value){const ee=i.branding.headerGradientStart||ln.headerGradientStart;ye("headerGradientEnd",ee)}}function De(){if(!p.value){const ee=i.branding.pageGradientStart||ln.pageGradientStart;ye("pageGradientEnd",ee)}}function q(ee){r("update:branding",YL(i.branding,ee)),u.value=null}async function J(){return g.value?await g.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ve(){return g.value?await g.value.deleteStagedLogo():{success:!0}}function Se(){return g.value?.hasPendingChanges()||!1}function re(){return g.value?.isPendingDelete()||!1}function ue(){g.value&&g.value.resetStagedState(),k.value=!1,y.value=""}return t({uploadStagedLogo:J,deleteStagedLogo:ve,hasLogoChanges:Se,isLogoPendingDelete:re,resetLogo:ue}),(ee,W)=>(v(),m("div",XL,[l("div",QL,[W[32]||(W[32]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",eS,[(v(!0),m(Ie,null,Ne(O(d),ie=>(v(),m("button",{key:ie.name,type:"button",class:"preset-btn",title:ie.name,onClick:Le=>q(ie)},[l("span",{class:"preset-preview",style:Qe({background:`linear-gradient(135deg, ${ie.pageGradientStart} 0%, ${ie.pageGradientEnd} 100%)`})},null,4),l("span",nS,C(ie.name),1)],8,tS))),128))])]),l("div",oS,[l("div",{class:pe(["mockup-page",{"region-active":u.value==="page"}]),style:Qe(Xe.value),onClick:W[7]||(W[7]=ie=>He("page"))},[l("div",{class:pe(["mockup-header",[{"region-active":u.value==="header"},K.value?`logo-${ne.value}`:"logo-none"]]),style:Qe(he.value),onClick:W[5]||(W[5]=rt(ie=>He("header"),["stop"]))},[K.value&&ne.value==="cover"?(v(),m("div",sS,[l("img",{src:fe.value,alt:"Logo",class:"logo-cover-img"},null,8,aS)])):M("",!0),K.value&&ne.value==="cover"?(v(),m("button",{key:1,type:"button",class:pe(["logo-cover-edit-btn",{"region-active":u.value==="logo"}]),onClick:W[0]||(W[0]=rt(ie=>He("logo"),["stop"])),title:"Edit logo"},[...W[33]||(W[33]=[l("span",null,"",-1)])],2)):M("",!0),K.value&&ne.value==="left"?(v(),m("div",{key:2,class:pe(["mockup-logo logo-left",{"region-active":u.value==="logo"}]),onClick:W[1]||(W[1]=rt(ie=>He("logo"),["stop"]))},[l("img",{src:fe.value,alt:"Logo",class:"logo-img"},null,8,iS)],2)):M("",!0),K.value?M("",!0):(v(),m("div",{key:3,class:pe(["logo-add-area logo-add-left",{"region-active":u.value==="logo"}]),onClick:W[2]||(W[2]=rt(ie=>Ke("left"),["stop"]))},[...W[34]||(W[34]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),l("div",lS,[l("div",{class:"mockup-title",style:Qe({color:Re.value})},[l("span",rS,C(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:Qe({color:Re.value})},C(e.eventDate||"Event Date"),5),l("div",cS,[W[35]||(W[35]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:Qe({color:Re.value})},"Logout",4)])]),K.value&&ne.value==="right"?(v(),m("div",{key:4,class:pe(["mockup-logo logo-right",{"region-active":u.value==="logo"}]),onClick:W[3]||(W[3]=rt(ie=>He("logo"),["stop"]))},[l("img",{src:fe.value,alt:"Logo",class:"logo-img"},null,8,uS)],2)):M("",!0),K.value?M("",!0):(v(),m("div",{key:5,class:pe(["logo-add-area logo-add-right",{"region-active":u.value==="logo"}]),onClick:W[4]||(W[4]=rt(ie=>Ke("right"),["stop"]))},[...W[36]||(W[36]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),l("div",dS,[l("div",hS,[W[37]||(W[37]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",fS,[l("div",{class:pe(["mockup-checkin-btn",{"region-active":u.value==="accent"}]),style:Qe(et.value),onClick:W[6]||(W[6]=rt(ie=>He("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),Ue(l("div",{class:"editor-overlay",onClick:W[31]||(W[31]=rt(ie=>u.value=null,["self"]))},[l("div",{ref_key:"editorModalRef",ref:A,class:"editor-modal"},[l("div",pS,[l("span",null,C(P[u.value]),1),l("button",{type:"button",class:"editor-close",onClick:W[8]||(W[8]=ie=>u.value=null)},"")]),l("div",vS,[u.value==="header"?(v(),m(Ie,{key:0},[W[46]||(W[46]=l("p",{class:"editor-description"},"Choose the colour for the header.",-1)),l("div",mS,[l("div",gS,[l("label",null,C(f.value?"Start colour":"Colour"),1),l("div",yS,[(v(!0),m(Ie,null,Ne(O(s),ie=>(v(),m("button",{key:"hs-"+ie.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.headerGradientStart===ie.hex}]),style:Qe({backgroundColor:ie.hex}),title:ie.name,onClick:Le=>Ve("start",ie.hex)},[e.branding.headerGradientStart===ie.hex?(v(),m("span",_S,"")):M("",!0)],14,kS))),128)),l("div",bS,[l("button",{type:"button",class:pe(["color-swatch-btn custom-color-btn",{selected:D(e.branding.headerGradientStart)}]),style:Qe({backgroundColor:H(e.branding.headerGradientStart)}),title:"Custom colour",onClick:W[9]||(W[9]=ie=>B("headerStart",ie))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:R(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...W[38]||(W[38]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),w.value==="headerStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(x.value)},[l("div",wS,[W[39]||(W[39]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:W[10]||(W[10]=ie=>w.value=null)},"")]),l("div",CS,[W[40]||(W[40]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":W[11]||(W[11]=ie=>S.value=ie),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!$.value}]),onInput:N,onKeydown:ps(Z,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:$.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!$.value,onClick:Z}," Apply ",8,LS)]),S.value&&!$.value?(v(),m("span",SS,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),l("label",xS,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":W[12]||(W[12]=ie=>f.value=ie),onChange:xe},null,544),[[Ia,f.value]]),W[41]||(W[41]=l("span",null,"Use gradient",-1))])]),f.value?(v(),m("div",IS,[W[45]||(W[45]=l("label",null,"End colour",-1)),l("div",$S,[(v(!0),m(Ie,null,Ne(O(s),ie=>(v(),m("button",{key:"he-"+ie.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ie.hex}]),style:Qe({backgroundColor:ie.hex}),title:ie.name,onClick:Le=>ye("headerGradientEnd",ie.hex)},[e.branding.headerGradientEnd===ie.hex?(v(),m("span",MS,"")):M("",!0)],14,TS))),128)),l("div",AS,[l("button",{type:"button",class:pe(["color-swatch-btn custom-color-btn",{selected:D(e.branding.headerGradientEnd)}]),style:Qe({backgroundColor:H(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:W[13]||(W[13]=ie=>B("headerEnd",ie))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:R(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...W[42]||(W[42]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),w.value==="headerEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(x.value)},[l("div",ES,[W[43]||(W[43]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:W[14]||(W[14]=ie=>w.value=null)},"")]),l("div",PS,[W[44]||(W[44]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":W[15]||(W[15]=ie=>S.value=ie),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!$.value}]),onInput:N,onKeydown:ps(Z,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:$.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!$.value,onClick:Z}," Apply ",8,DS)]),S.value&&!$.value?(v(),m("span",RS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0),u.value==="logo"?(v(),m("div",OS,[W[47]||(W[47]=l("label",{class:"editor-label"},"Position",-1)),l("div",BS,[l("button",{type:"button",class:pe(["position-btn",{selected:ne.value==="left"}]),onClick:W[16]||(W[16]=ie=>ye("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:pe(["position-btn",{selected:ne.value==="cover"}]),onClick:W[17]||(W[17]=ie=>ye("logoPosition","cover"))}," Cover ",2),l("button",{type:"button",class:pe(["position-btn",{selected:ne.value==="right"}]),onClick:W[18]||(W[18]=ie=>ye("logoPosition","right"))}," Right ",2)])])):M("",!0),Ue(Ee(KL,{ref_key:"logoUploaderRef",ref:g,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":W[19]||(W[19]=ie=>ye("logoUrl",ie)),onStagedChange:_},null,8,["model-value","event-id","admin-email"]),[[ys,u.value==="logo"]]),u.value==="accent"?(v(),m(Ie,{key:2},[W[51]||(W[51]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",NS,[(v(!0),m(Ie,null,Ne(O(s),ie=>(v(),m("button",{key:"ac-"+ie.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.accentColor===ie.hex}]),style:Qe({backgroundColor:ie.hex}),title:ie.name,onClick:Le=>ye("accentColor",ie.hex)},[e.branding.accentColor===ie.hex?(v(),m("span",US,"")):M("",!0)],14,FS))),128)),l("div",zS,[l("button",{type:"button",class:pe(["color-swatch-btn custom-color-btn",{selected:D(e.branding.accentColor)}]),style:Qe({backgroundColor:H(e.branding.accentColor)}),title:"Custom colour",onClick:W[20]||(W[20]=ie=>B("accent",ie))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:R(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...W[48]||(W[48]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),w.value==="accent"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(x.value)},[l("div",HS,[W[49]||(W[49]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:W[21]||(W[21]=ie=>w.value=null)},"")]),l("div",VS,[W[50]||(W[50]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":W[22]||(W[22]=ie=>S.value=ie),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!$.value}]),onInput:N,onKeydown:ps(Z,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:$.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!$.value,onClick:Z}," Apply ",8,GS)]),S.value&&!$.value?(v(),m("span",jS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])],64)):M("",!0),u.value==="page"?(v(),m(Ie,{key:3},[W[60]||(W[60]=l("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),l("div",ZS,[l("div",qS,[l("label",null,C(p.value?"Start colour":"Colour"),1),l("div",WS,[(v(!0),m(Ie,null,Ne(O(s),ie=>(v(),m("button",{key:"ps-"+ie.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.pageGradientStart===ie.hex}]),style:Qe({backgroundColor:ie.hex}),title:ie.name,onClick:Le=>me("start",ie.hex)},[e.branding.pageGradientStart===ie.hex?(v(),m("span",JS,"")):M("",!0)],14,KS))),128)),l("div",YS,[l("button",{type:"button",class:pe(["color-swatch-btn custom-color-btn",{selected:D(e.branding.pageGradientStart)}]),style:Qe({backgroundColor:H(e.branding.pageGradientStart)}),title:"Custom colour",onClick:W[23]||(W[23]=ie=>B("pageStart",ie))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:R(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...W[52]||(W[52]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),w.value==="pageStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(x.value)},[l("div",XS,[W[53]||(W[53]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:W[24]||(W[24]=ie=>w.value=null)},"")]),l("div",QS,[W[54]||(W[54]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":W[25]||(W[25]=ie=>S.value=ie),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!$.value}]),onInput:N,onKeydown:ps(Z,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:$.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!$.value,onClick:Z}," Apply ",8,ex)]),S.value&&!$.value?(v(),m("span",tx,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),l("label",nx,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":W[26]||(W[26]=ie=>p.value=ie),onChange:De},null,544),[[Ia,p.value]]),W[55]||(W[55]=l("span",null,"Use gradient",-1))])]),p.value?(v(),m("div",ox,[W[59]||(W[59]=l("label",null,"End colour",-1)),l("div",sx,[(v(!0),m(Ie,null,Ne(O(s),ie=>(v(),m("button",{key:"pe-"+ie.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ie.hex}]),style:Qe({backgroundColor:ie.hex}),title:ie.name,onClick:Le=>ye("pageGradientEnd",ie.hex)},[e.branding.pageGradientEnd===ie.hex?(v(),m("span",ix,"")):M("",!0)],14,ax))),128)),l("div",lx,[l("button",{type:"button",class:pe(["color-swatch-btn custom-color-btn",{selected:D(e.branding.pageGradientEnd)}]),style:Qe({backgroundColor:H(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:W[27]||(W[27]=ie=>B("pageEnd",ie))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:R(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...W[56]||(W[56]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),w.value==="pageEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(x.value)},[l("div",rx,[W[57]||(W[57]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:W[28]||(W[28]=ie=>w.value=null)},"")]),l("div",cx,[W[58]||(W[58]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:E,"onUpdate:modelValue":W[29]||(W[29]=ie=>S.value=ie),type:"text",maxlength:"6",placeholder:"000000",class:pe(["hex-input",{invalid:S.value&&!$.value}]),onInput:N,onKeydown:ps(Z,["enter"])},null,34),[[st,S.value]]),l("div",{class:"hex-preview",style:Qe({backgroundColor:$.value?"#"+S.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!$.value,onClick:Z}," Apply ",8,ux)]),S.value&&!$.value?(v(),m("span",dx,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0)]),l("div",hx,[l("button",{type:"button",class:"btn-done",onClick:W[30]||(W[30]=ie=>u.value=null)},"Done")])],512)],512),[[ys,u.value]]),W[61]||(W[61]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},px=je(fx,[["__scopeId","data-v-01af4f2d"]]),vx={class:"settings-tab"},mx={class:"accordion"},gx={class:"accordion-section"},yx={class:"accordion-title"},kx={class:"accordion-icon"},_x={key:0,class:"accordion-content"},bx={class:"accordion-section"},wx={class:"accordion-icon"},Cx={key:0,class:"accordion-content"},Lx={class:"terminology-grid"},Sx={class:"term-group"},xx=["value"],Ix={class:"term-group"},$x=["value"],Tx={class:"term-group"},Mx=["value"],Ax={class:"term-group"},Ex=["value"],Px={class:"term-group"},Dx=["value"],Rx={class:"form-actions"},Ox=["disabled"],Bx={class:"accordion-section"},Nx={class:"accordion-title"},Fx={class:"accordion-icon"},Ux={key:0,class:"accordion-content"},zx={class:"section-description"},Hx={class:"form-actions"},Vx=["disabled"],Gx={class:"accordion-section"},jx={class:"accordion-title"},Zx={class:"accordion-icon"},qx={key:0,class:"accordion-content"},Wx={class:"section-description"},Kx={class:"form-actions"},Jx=["disabled"],Yx=["disabled"],af="admin_settings_accordion",Xx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=Zl(),i=V(()=>s.adminEmail||""),r=e,u=t,d=T({...r.eventData}),f=T(null),p=T(!1),g=()=>r.eventId?`${af}_${r.eventId}`:af,k=T(null);nn(()=>{const $=localStorage.getItem(g());$&&(k.value=$)});const y=V(()=>{const $=d.value.peopleTerm||"Marshals";return Os.checkpoint.map(B=>({value:B,label:Su(B,$)}))}),_=$=>{const B=k.value===$?null:$;k.value=B,B?localStorage.setItem(g(),B):localStorage.removeItem(g())};Ze(()=>r.eventData,$=>{d.value={...$},A.value=!1},{deep:!0});const w=()=>{u("update:formDirty",!0)},S=($,B)=>{d.value[$]=B,w()},E=V(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),A=T(!1),x=$=>{A.value=$},D=$=>{d.value.brandingHeaderGradientStart=$.headerGradientStart,d.value.brandingHeaderGradientEnd=$.headerGradientEnd,d.value.brandingLogoUrl=$.logoUrl,d.value.brandingLogoPosition=$.logoPosition,d.value.brandingAccentColor=$.accentColor,d.value.brandingPageGradientStart=$.pageGradientStart,d.value.brandingPageGradientEnd=$.pageGradientEnd,w()},R=()=>{JL(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",A.value=!1,f.value?.resetLogo(),w()},H=async()=>{if(!p.value){p.value=!0;try{if(A.value&&f.value){if(f.value.isLogoPendingDelete()){const B=await f.value.deleteStagedLogo();if(!B.success){console.error("Failed to delete logo:",B.error);return}d.value.brandingLogoUrl=""}else{const B=await f.value.uploadStagedLogo();if(!B.success){console.error("Failed to upload logo:",B.error);return}B.logoUrl&&!B.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=B.logoUrl)}A.value=!1}u("submit",{...d.value})}finally{p.value=!1}}};return($,B)=>(v(),m("div",vx,[l("div",mx,[l("div",gx,[l("button",{class:pe(["accordion-header",{active:k.value==="admins"}]),onClick:B[0]||(B[0]=N=>_("admins"))},[l("span",yx,"Administrators ("+C(e.admins.length)+")",1),l("span",kx,C(k.value==="admins"?"-":"+"),1)],2),k.value==="admins"?(v(),m("div",_x,[Ee(n2,{admins:e.admins,onAddAdmin:B[1]||(B[1]=N=>$.$emit("add-admin")),onRemoveAdmin:B[2]||(B[2]=N=>$.$emit("remove-admin",N))},null,8,["admins"])])):M("",!0)]),l("div",bx,[l("button",{class:pe(["accordion-header",{active:k.value==="terminology"}]),onClick:B[3]||(B[3]=N=>_("terminology"))},[B[19]||(B[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",wx,C(k.value==="terminology"?"-":"+"),1)],2),k.value==="terminology"?(v(),m("div",Cx,[B[20]||(B[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",Lx,[l("div",Sx,[l("label",null,C(O(o).people)+" are called",1),Ue(l("select",{"onUpdate:modelValue":B[4]||(B[4]=N=>d.value.peopleTerm=N),class:"form-input",onChange:w},[(v(!0),m(Ie,null,Ne(O(Os).people,N=>(v(),m("option",{key:N,value:N},C(N),9,xx))),128))],544),[[Bn,d.value.peopleTerm]])]),l("div",Ix,[l("label",null,C(O(o).checkpoints)+" are called",1),Ue(l("select",{"onUpdate:modelValue":B[5]||(B[5]=N=>d.value.checkpointTerm=N),class:"form-input",onChange:w},[(v(!0),m(Ie,null,Ne(y.value,N=>(v(),m("option",{key:N.value,value:N.value},C(N.label),9,$x))),128))],544),[[Bn,d.value.checkpointTerm]])]),l("div",Tx,[l("label",null,C(O(o).areas)+" are called",1),Ue(l("select",{"onUpdate:modelValue":B[6]||(B[6]=N=>d.value.areaTerm=N),class:"form-input",onChange:w},[(v(!0),m(Ie,null,Ne(O(Os).area,N=>(v(),m("option",{key:N,value:N},C(N),9,Mx))),128))],544),[[Bn,d.value.areaTerm]])]),l("div",Ax,[l("label",null,C(O(o).checklists)+" are called",1),Ue(l("select",{"onUpdate:modelValue":B[7]||(B[7]=N=>d.value.checklistTerm=N),class:"form-input",onChange:w},[(v(!0),m(Ie,null,Ne(O(Os).checklist,N=>(v(),m("option",{key:N,value:N},C(N),9,Ex))),128))],544),[[Bn,d.value.checklistTerm]])]),l("div",Px,[l("label",null,C(O(o).course)+" is called",1),Ue(l("select",{"onUpdate:modelValue":B[8]||(B[8]=N=>d.value.courseTerm=N),class:"form-input",onChange:w},[(v(!0),m(Ie,null,Ne(O(Os).course,N=>(v(),m("option",{key:N,value:N},C(N),9,Dx))),128))],544),[[Bn,d.value.courseTerm]])])]),l("div",Rx,[l("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Ox)])])):M("",!0)]),l("div",Bx,[l("button",{class:pe(["accordion-header",{active:k.value==="appearance"}]),onClick:B[9]||(B[9]=N=>_("appearance"))},[l("span",Nx,C(O(o).checkpoint)+" appearance",1),l("span",Fx,C(k.value==="appearance"?"-":"+"),1)],2),k.value==="appearance"?(v(),m("div",Ux,[l("p",zx," Set the default marker style for all "+C(O(a).checkpoints)+" in this event. Individual "+C(O(a).areas)+" and "+C(O(a).checkpoints)+" can override this setting. ",1),Ee(ad,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":B[10]||(B[10]=N=>S("defaultCheckpointStyleType",N)),"onUpdate:styleColor":B[11]||(B[11]=N=>S("defaultCheckpointStyleColor",N)),"onUpdate:styleBackgroundShape":B[12]||(B[12]=N=>S("defaultCheckpointStyleBackgroundShape",N)),"onUpdate:styleBackgroundColor":B[13]||(B[13]=N=>S("defaultCheckpointStyleBackgroundColor",N)),"onUpdate:styleBorderColor":B[14]||(B[14]=N=>S("defaultCheckpointStyleBorderColor",N)),"onUpdate:styleIconColor":B[15]||(B[15]=N=>S("defaultCheckpointStyleIconColor",N)),"onUpdate:styleSize":B[16]||(B[16]=N=>S("defaultCheckpointStyleSize",N)),"onUpdate:styleMapRotation":B[17]||(B[17]=N=>S("defaultCheckpointStyleMapRotation",N))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",Hx,[l("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Vx)])])):M("",!0)]),l("div",Gx,[l("button",{class:pe(["accordion-header",{active:k.value==="branding"}]),onClick:B[18]||(B[18]=N=>_("branding"))},[l("span",jx,C(O(o).person)+" branding",1),l("span",Zx,C(k.value==="branding"?"-":"+"),1)],2),k.value==="branding"?(v(),m("div",qx,[l("p",Wx," Customise the appearance of the "+C(O(a).person)+" view to match your organisation's branding. ",1),Ee(px,{ref_key:"brandingMockupRef",ref:f,branding:E.value,"event-name":d.value.name,"event-date":O(Vv)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":D,onLogoStagedChange:x},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",Kx,[l("button",{onClick:R,class:"btn btn-secondary",disabled:p.value}," Reset to default ",8,Jx),l("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty&&!A.value||p.value},C(p.value?"Saving...":"Save"),9,Yx)])])):M("",!0)])])]))}},Qx=je(Xx,[["__scopeId","data-v-bb7e241a"]]),eI={class:"incident-header"},tI={class:"incident-title-row"},nI={class:"incident-title"},oI={class:"incident-badges"},sI={key:0,class:"incident-description"},aI={class:"incident-context"},iI={key:0,class:"context-item"},lI={key:1,class:"context-item"},rI={key:2,class:"context-item"},cI={class:"incident-footer"},uI={class:"reporter-info"},dI={class:"time-info"},hI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=V(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",r=u=>{if(!u)return"";const d=new Date(u),p=new Date-d,g=Math.floor(p/6e4),k=Math.floor(p/36e5),y=Math.floor(p/864e5);return g<1?"just now":g<60?`${g}m ago`:k<24?`${k}h ago`:y<7?`${y}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:pe(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=f=>u.$emit("select",e.incident))},[l("div",eI,[l("div",tI,[l("span",{class:pe(["severity-indicator",e.incident.severity])},null,2),l("strong",nI,C(o.value),1)]),l("div",oI,[l("span",{class:pe(["severity-badge",e.incident.severity])},C(a(e.incident.severity)),3),l("span",{class:pe(["status-badge",e.incident.status])},C(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",sI,C(i(e.incident.description)),1)):M("",!0),l("div",aI,[e.incident.context?.checkpoint?(v(),m("div",iI,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,C(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",lI,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):M("",!0),e.incident.area?(v(),m("div",rI,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,C(e.incident.area.areaName),1)])):M("",!0)]),l("div",cI,[l("span",uI," Reported by "+C(e.incident.reportedBy?.name||"Unknown"),1),l("span",dI,C(r(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},Wl=je(hI,[["__scopeId","data-v-690fd385"]]),fI={class:"incidents-tab"},pI={class:"tab-header"},vI={class:"button-group"},mI={key:0,class:"status-pills"},gI={class:"filters-section"},yI={class:"search-group"},kI={class:"incidents-list"},_I={key:0,class:"loading-state"},bI={key:1,class:"empty-state"},wI={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=T(""),s=T("all"),i=k=>{s.value=k},r=V(()=>o.incidents.filter(k=>k.status==="open").length),u=V(()=>o.incidents.filter(k=>k.status==="in_progress"||k.status==="acknowledged").length),d=V(()=>o.incidents.filter(k=>k.status==="resolved").length),f=V(()=>o.incidents.filter(k=>k.status==="closed").length),p=V(()=>{let k=o.incidents;if(s.value==="open"?k=k.filter(y=>y.status==="open"):s.value==="in-progress"?k=k.filter(y=>y.status==="in_progress"||y.status==="acknowledged"):s.value==="resolved"?k=k.filter(y=>y.status==="resolved"):s.value==="closed"&&(k=k.filter(y=>y.status==="closed")),a.value.trim()){const y=a.value.toLowerCase().trim().split(/\s+/);k=k.filter(_=>{const w=`${_.context?.checkpoint?.name||""} ${_.context?.checkpoint?.description||""}`,S=_.area?.areaName||"",E=[_.reportedBy?.name||"",...(_.context?.peopleAtCheckpoint||[]).map(D=>D.name||"")].join(" "),A=(_.updates||[]).map(D=>D.note||"").join(" "),x=`${_.title||""} ${_.description||""} ${w} ${S} ${E} ${A}`.toLowerCase();return y.every(D=>x.includes(D))})}return k}),g=V(()=>[...p.value].sort((k,y)=>new Date(y.incidentTime||y.createdAt)-new Date(k.incidentTime||k.createdAt)));return(k,y)=>(v(),m("div",fI,[l("div",pI,[l("div",vI,[l("button",{onClick:y[0]||(y[0]=_=>k.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",mI,[Ee(Ln,{variant:"neutral",active:s.value==="all",onClick:y[1]||(y[1]=_=>i("all"))},{default:ze(()=>[Je(C(e.incidents.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(Ln,{key:0,variant:"info",active:s.value==="open",onClick:y[2]||(y[2]=_=>i("open"))},{default:ze(()=>[Je(C(r.value)+" open ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),qe(Ln,{key:1,variant:"purple",active:s.value==="in-progress",onClick:y[3]||(y[3]=_=>i("in-progress"))},{default:ze(()=>[Je(C(u.value)+" in progress ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),qe(Ln,{key:2,variant:"success",active:s.value==="resolved",onClick:y[4]||(y[4]=_=>i("resolved"))},{default:ze(()=>[Je(C(d.value)+" resolved ",1)]),_:1},8,["active"])):M("",!0),f.value>0?(v(),qe(Ln,{key:3,variant:"neutral",active:s.value==="closed",onClick:y[5]||(y[5]=_=>i("closed"))},{default:ze(()=>[Je(C(f.value)+" closed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),l("div",gI,[l("div",yI,[Ue(l("input",{"onUpdate:modelValue":y[6]||(y[6]=_=>a.value=_),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,a.value]])])]),l("div",kI,[e.loading?(v(),m("div",_I," Loading incidents... ")):p.value.length===0?(v(),m("div",bI,[l("p",null,C(a.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):M("",!0),(v(!0),m(Ie,null,Ne(g.value,_=>(v(),qe(Wl,{key:_.incidentId,incident:_,onSelect:w=>k.$emit("select-incident",_)},null,8,["incident","onSelect"]))),128))])]))}},CI=je(wI,[["__scopeId","data-v-56bde653"]]),LI={class:"checkpoint-card-header"},SI={class:"checkpoint-name-row"},xI=["innerHTML"],II={class:"checkpoint-name"},$I={key:0,class:"checkpoint-description"},TI={key:0,class:"checkpoint-card-areas"},MI={class:"checkpoint-card-stats"},AI={key:1,class:"checkpoint-card-marshals"},EI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=S=>{const E=o.areas.find(A=>A.id===S);return E?E.name:null},r=S=>{const E=o.areas.find(A=>A.id===S);return E?E.color:"#999"},u=V(()=>{const S=o.checkpoint,E=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor;return E||(s.value.length>0?r(s.value[0]):"#667eea")}),d=V(()=>{const S=o.checkpoint;return S.requiredMarshals===0?null:S.checkedInCount>=S.requiredMarshals?"full":S.checkedInCount>0?"partial":"none"}),f=V(()=>[...o.checkpoint.assignments||[]].sort((E,A)=>(E.marshalName||"").localeCompare(A.marshalName||"",void 0,{sensitivity:"base"}))),p=V(()=>(o.checkpoint.assignments||[]).length),g=V(()=>(o.checkpoint.assignments||[]).filter(S=>S.isCheckedIn).length),k=V(()=>d.value?`staffing-${d.value}`:""),y=V(()=>{const S=p.value,E=g.value;return S===0?"":E===0?"checkin-none":E>=S?"checkin-full":"checkin-partial"}),_=V(()=>{const S=o.checkpoint,E=S.resolvedStyleType||S.ResolvedStyleType,A=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor,x=S.resolvedStyleBorderColor||S.ResolvedStyleBorderColor,D=S.resolvedStyleIconColor||S.ResolvedStyleIconColor,R=S.resolvedStyleBackgroundShape||S.ResolvedStyleBackgroundShape;return E&&E!=="default"||A||x||D||R&&R!=="circle"?Cn({type:E||"circle",backgroundShape:R||"circle",backgroundColor:A||"#667eea",borderColor:x||"#ffffff",iconColor:D||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),w=()=>{o.clickable&&a("click",o.checkpoint)};return(S,E)=>(v(),m("div",{class:pe(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:Qe({borderLeftColor:u.value}),onClick:w},[l("div",LI,[l("div",{class:pe(["checkpoint-card-title",{clickable:e.clickable}])},[l("span",SI,[l("span",{class:"checkpoint-icon",innerHTML:_.value},null,8,xI),l("span",II,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",$I,"  "+C(e.checkpoint.description),1)):M("",!0)])],2)]),s.value.length>0?(v(),m("div",TI,[(v(!0),m(Ie,null,Ne(s.value,A=>(v(),m("span",{key:A,class:"area-badge",style:Qe({backgroundColor:r(A)})},C(i(A)),5))),128))])):M("",!0),l("div",MI,[l("span",{class:pe(["stat-badge staffing-badge",k.value])},C(e.checkpoint.checkedInCount)+"/"+C(e.checkpoint.requiredMarshals)+" staffed ",3),p.value>0?(v(),m("span",{key:0,class:pe(["stat-badge",y.value])},C(g.value)+"/"+C(p.value)+" checked in ",3)):M("",!0)]),f.value.length>0?(v(),m("div",AI,[(v(!0),m(Ie,null,Ne(f.value,A=>(v(),m("span",{key:A.id,class:pe(["marshal-badge",{"checked-in":A.isCheckedIn}])},C(A.marshalName),3))),128))])):M("",!0)],6))}},PI=je(EI,[["__scopeId","data-v-da001590"]]),Jv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(ql,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Ie,null,Ne(e.checkpoints,a=>(v(),qe(PI,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},DI={class:"checkpoints-tab"},RI={class:"tab-header"},OI={class:"button-group"},BI={key:0,class:"status-pills"},NI={class:"filters-section"},FI={class:"search-group"},UI=["placeholder"],zI={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ut(),o=e,a=T(""),s=T("all"),i=y=>{s.value=y},r=V(()=>o.locations.filter(y=>y.checkedInCount>=y.requiredMarshals&&y.requiredMarshals>0).length),u=V(()=>o.locations.filter(y=>y.checkedInCount>0&&y.checkedInCount<y.requiredMarshals).length),d=V(()=>o.locations.filter(y=>y.checkedInCount===0&&y.requiredMarshals>0).length),f=y=>{const _=o.areas.find(w=>w.id===y);return _?_.name:null},p=V(()=>{let y=o.locations;if(s.value==="full"?y=y.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0):s.value==="partial"?y=y.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals):s.value==="missing"&&(y=y.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0)),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(w=>{const E=(w.areaIds||w.AreaIds||[]).map(D=>f(D)||"").join(" "),A=(w.assignments||[]).map(D=>D.marshalName||"").join(" "),x=`${w.name||""} ${w.description||""} ${E} ${A}`.toLowerCase();return _.every(D=>x.includes(D))})}return y}),g=V(()=>[...p.value].sort((y,_)=>Vs(y.name,_.name))),k=V(()=>{const y=a.value.trim();return s.value==="full"?y?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?y?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?y?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:y?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(y,_)=>(v(),m("div",DI,[l("div",RI,[l("div",OI,[l("button",{onClick:_[0]||(_[0]=w=>y.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+C(O(t).checkpoint),1),l("button",{onClick:_[1]||(_[1]=w=>y.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",BI,[Ee(Ln,{variant:"neutral",active:s.value==="all",onClick:_[2]||(_[2]=w=>i("all"))},{default:ze(()=>[Je(C(e.locations.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe(Ln,{key:0,variant:"success",active:s.value==="full",onClick:_[3]||(_[3]=w=>i("full"))},{default:ze(()=>[Je(C(r.value)+" fully staffed ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),qe(Ln,{key:1,variant:"warning",active:s.value==="partial",onClick:_[4]||(_[4]=w=>i("partial"))},{default:ze(()=>[Je(C(u.value)+" partial ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),qe(Ln,{key:2,variant:"danger",active:s.value==="missing",onClick:_[5]||(_[5]=w=>i("missing"))},{default:ze(()=>[Je(C(d.value)+" unstaffed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),l("div",NI,[l("div",FI,[Ue(l("input",{"onUpdate:modelValue":_[6]||(_[6]=w=>a.value=w),type:"text",class:"search-input",placeholder:`Search by name, description, ${O(t).area}, or ${O(t).person}...`},null,8,UI),[[st,a.value]])])]),Ee(Jv,{checkpoints:g.value,areas:e.areas,"empty-message":k.value,onSelect:_[7]||(_[7]=w=>y.$emit("select-location",w))},null,8,["checkpoints","areas","empty-message"])]))}},HI=je(zI,[["__scopeId","data-v-35be2364"]]),VI={class:"area-card-header"},GI={class:"area-name-row"},jI={class:"area-name"},ZI={key:0,class:"default-badge"},qI={key:0,class:"area-description"},WI={class:"area-card-stats"},KI={class:"stat-badge"},JI={class:"stat-badge"},YI={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(o.area.id)||p.areaId===o.area.id).length),i=V(()=>o.contacts.filter(p=>p.scopeConfigurations?p.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),r=V(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=V(()=>{const p=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Ya("checkpoint",p,r.value):Uv("checkpoint",p,r.value)}),d=V(()=>`${s.value} ${u.value.toLowerCase()}`),f=()=>{o.clickable&&a("click",o.area)};return(p,g)=>(v(),m("div",{class:pe(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:Qe({borderLeftColor:e.area.color||"#667eea"}),onClick:f},[l("div",VI,[l("div",{class:pe(["area-card-title",{clickable:e.clickable}])},[l("div",GI,[l("span",jI,C(e.area.name),1),e.area.isDefault?(v(),m("span",ZI,"Default")):M("",!0)]),e.area.description?(v(),m("span",qI,C(e.area.description),1)):M("",!0)],2)]),l("div",WI,[l("span",KI,C(d.value),1),l("span",JI,C(i.value)+" contact"+C(i.value===1?"":"s"),1)])],6))}},XI=je(YI,[["__scopeId","data-v-8ac20bf2"]]),QI={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(ql,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Ie,null,Ne(e.areas,a=>(v(),qe(XI,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},e$={class:"areas-tab"},t$={class:"tab-header"},n$={class:"button-group"},o$={key:0,class:"status-pills"},s$={class:"filters-section"},a$={class:"search-group"},i$=["placeholder"],l$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ut(),o=e,a=T(""),s=d=>o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(d)||f.areaId===d),i=V(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(f=>{const g=s(f.id).map(y=>`${y.name||""} ${y.description||""}`).join(" "),k=`${f.name||""} ${f.description||""} ${g}`.toLowerCase();return d.every(y=>k.includes(y))})}),r=V(()=>[...i.value].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Vs(d.name,f.name))),u=V(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,f)=>(v(),m("div",e$,[l("div",t$,[l("div",n$,[l("button",{onClick:f[0]||(f[0]=p=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+C(O(t).area),1)]),e.areas.length>0?(v(),m("div",o$,[Ee(Ln,{variant:"neutral",active:!1},{default:ze(()=>[Je(C(e.areas.length)+" "+C(e.areas.length===1?O(t).area:O(t).areas),1)]),_:1})])):M("",!0)]),l("div",s$,[l("div",a$,[Ue(l("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>a.value=p),type:"text",class:"search-input",placeholder:`Search by ${O(t).area} name or ${O(t).checkpoint} name...`},null,8,i$),[[st,a.value]])])]),Ee(QI,{areas:r.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:f[2]||(f[2]=p=>d.$emit("select-area",p))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},r$=je(l$,[["__scopeId","data-v-203f9606"]]),c$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Xn=e=>c$[e]||"",u$={class:"responsive-tabs"},d$=["onClick"],h$=["innerHTML"],f$=["innerHTML"],p$={class:"hamburger-label"},v$=["onClick"],m$=["innerHTML"],g$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=T(null),i=T(null),r=T(null),u=T(!1),d=T({}),f=T(!1),p=V(()=>o.tabs.find(E=>E.value===o.modelValue)),g=V(()=>p.value?p.value.label:"Menu"),k=()=>{if(u.value=!u.value,u.value&&i.value){const E=i.value.getBoundingClientRect();d.value={top:`${E.bottom+4}px`}}},y=E=>{a("update:modelValue",E),u.value=!1},_=E=>{if(!s.value)return;const A=s.value.contains(E.target);u.value&&!A&&(u.value=!1)},w=()=>{if(!r.value)return;const E=r.value,A=f.value;A&&(E.style.visibility="visible",E.style.position="static");const x=E.scrollWidth>E.clientWidth;A&&(E.style.visibility="",E.style.position=""),f.value=x};let S=null;return nn(()=>{document.addEventListener("click",_),cn(()=>{w()}),cn(()=>{const E=r.value?.parentElement;E&&(S=new ResizeObserver(()=>{w()}),S.observe(E))})}),xn(()=>{document.removeEventListener("click",_),S&&S.disconnect()}),Ze(()=>o.tabs,()=>{cn(()=>{w()})},{deep:!0}),(E,A)=>(v(),m("div",u$,[l("div",{ref_key:"visibleTabsRef",ref:r,class:pe(["visible-tabs",{"is-hidden":f.value}])},[(v(!0),m(Ie,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:pe(["tab-button",{active:e.modelValue===x.value}]),onClick:D=>E.$emit("update:modelValue",x.value),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(x.icon)},null,8,h$)):M("",!0),Je(" "+C(x.label),1)],10,d$))),128))],2),l("div",{class:pe(["hamburger-only",{"is-visible":f.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:i,class:pe(["hamburger-button",{active:u.value}]),onClick:rt(k,["stop"]),type:"button"},[A[1]||(A[1]=l("span",{class:"hamburger-icon"},"",-1)),p.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(p.value.icon)},null,8,f$)):M("",!0),l("span",p$,C(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:Qe(d.value),onClick:A[0]||(A[0]=rt(()=>{},["stop"]))},[(v(!0),m(Ie,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:pe(["dropdown-item",{active:e.modelValue===x.value}]),onClick:rt(D=>y(x.value),["stop"]),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(x.icon)},null,8,m$)):M("",!0),Je(" "+C(x.label),1)],10,v$))),128))],4)):M("",!0)],512)],2)]))}},y$=je(g$,[["__scopeId","data-v-2467c6fc"]]),k$={class:"confirm-modal"},_$={class:"confirm-actions"},b$={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},s=()=>{o("cancel")};return(i,r)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(s,["self"])},[l("div",k$,[l("h3",null,C(e.title),1),l("p",null,C(e.message),1),l("div",_$,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},C(e.cancelText),1)):M("",!0),l("button",{onClick:a,class:pe(["btn",e.isDanger?"btn-danger":"btn-primary"])},C(e.confirmText),3)])])])):M("",!0)}},Nl=je(b$,[["__scopeId","data-v-bead7a29"]]),w$={class:"base-modal-header"},C$={class:"base-modal-header-content"},L$={key:0,class:"base-modal-title"},S$={key:0,class:"base-modal-tab-header"},x$={key:1,class:"base-modal-footer"},I$={key:0,class:"base-modal-actions"},$$={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const x=document.documentElement,D=getComputedStyle(x).getPropertyValue("--modal-resize-duration").trim();return D.endsWith("s")?parseFloat(D)*1e3:300},a=e,s=t,i=T(!1),r=T(!1),u=T(null),d=T(null);let f=null,p=!1,g=0;const k=()=>{if(!d.value||!u.value||p)return;const x=d.value.scrollHeight,D=g;if(D===x||g===0){g=x;return}p=!0,d.value.style.height=`${D}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${x}px`;const R=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),p=!1,g=x},R)},y=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),f=new MutationObserver(()=>{cn(()=>{k()})}),f.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},_=()=>{f&&(f.disconnect(),f=null)};nn(()=>{cn(()=>{a.show&&y()})}),xn(()=>{_()}),Ze(()=>a.show,x=>{x?cn(()=>{g=0,y()}):_()});const w=()=>{a.closeOnOverlay&&S()},S=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:s("close")},E=()=>{i.value=!1,s("close")},A=()=>{i.value=!1};return(x,D)=>(v(),qe(gs,{name:"modal",appear:""},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(w,["self"])},[l("div",{class:pe(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",w$,[l("div",C$,[io(x.$slots,"header",{},()=>[e.title?(v(),m("h2",L$,C(e.title),1)):M("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:S,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):M("",!0)]),x.$slots["tab-header"]?(v(),m("div",S$,[io(x.$slots,"tab-header",{},void 0,!0)])):M("",!0),l("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[l("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[io(x.$slots,"default",{},void 0,!0)],512)],512),x.$slots.footer||x.$slots.actions?(v(),m("div",x$,[io(x.$slots,"footer",{},()=>[x.$slots.actions?(v(),m("div",I$,[io(x.$slots,"actions",{},void 0,!0)])):M("",!0)],!0)])):M("",!0)],2),e.confirmOnClose&&!r.value?(v(),qe(Nl,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:E,onCancel:A},null,8,["show"])):M("",!0)],4)):M("",!0)]),_:3}))}},Gt=je($$,[["__scopeId","data-v-141bdab1"]]),T$={class:"instruction"},M$={class:"share-link-container"},A$=["value"],E$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=t,i=T(!1),r=T(null),u=()=>{r.value&&(r.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{s("close")};return(f,p)=>(v(),qe(Gt,{show:e.show,title:`${O(o).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:ze(()=>[l("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:ze(()=>[l("p",T$,"Share this link with "+C(O(a).peoplePlural)+" so they can check in:",1),l("div",M$,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:r},null,8,A$),l("button",{onClick:u,class:"btn btn-primary"},C(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},P$=je(E$,[["__scopeId","data-v-b037c39b"]]),D$={class:"success-content"},R$={class:"success-message"},O$={class:"link-section"},B$={class:"help-text"},N$={key:0,class:"loading-text"},F$={key:1,class:"magic-link-container"},U$=["value"],z$={class:"magic-link-actions"},H$=["disabled"],V$={key:0,class:"success-text"},G$={key:1,class:"error-text"},j$={key:2,class:"error-text"},Z$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=T(""),r=T(!1),u=T(!1),d=T(""),f=T(!1),p=T(!1),g=T(!1),k=T(""),y=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const E=await ms.getMagicLink(a.eventId,a.marshalId);i.value=E.data.magicLink,r.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),d.value="Failed to load login link"}finally{u.value=!1}}},_=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const E=document.createElement("textarea");E.value=i.value,E.style.position="fixed",E.style.left="-9999px",document.body.appendChild(E),E.select(),document.execCommand("copy"),document.body.removeChild(E)}f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch(E){console.error("Failed to copy:",E)}},w=async()=>{if(!(!a.eventId||!a.marshalId)){p.value=!0,g.value=!1,k.value="";try{await ms.sendMagicLink(a.eventId,a.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),k.value=E.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},S=()=>{s("close")};return Ze(()=>a.show,E=>{E&&a.marshalId?y():(i.value="",r.value=!1,d.value="",f.value=!1,g.value=!1,k.value="")},{immediate:!0}),(E,A)=>(v(),qe(Gt,{show:e.show,title:`${O(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:S},{actions:ze(()=>[l("button",{onClick:S,class:"btn btn-primary"},"Done")]),default:ze(()=>[l("div",D$,[A[2]||(A[2]=l("div",{class:"success-icon"},"",-1)),l("p",R$,[l("strong",null,C(e.marshalName),1),A[1]||(A[1]=Je(" has been added successfully. ",-1))])]),l("div",O$,[A[3]||(A[3]=l("label",null,"Login link",-1)),l("p",B$," Share this unique link with "+C(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",N$,"Loading link...")):i.value?(v(),m("div",F$,[l("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:A[0]||(A[0]=x=>x.target.select())},null,40,U$),l("div",z$,[l("button",{type:"button",class:"btn btn-secondary",onClick:_},C(f.value?"Copied!":"Copy link"),1),r.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:w},C(p.value?"Sending...":"Send via email"),9,H$)):M("",!0)]),g.value?(v(),m("p",V$,"Email sent successfully!")):M("",!0),k.value?(v(),m("p",G$,C(k.value),1)):M("",!0)])):d.value?(v(),m("div",j$,C(d.value),1)):M("",!0)])]),_:1},8,["show","title"]))}},q$=je(Z$,[["__scopeId","data-v-e99677e9"]]),W$={class:"form-group"},K$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=T("");Ze(()=>o.show,d=>{d||(s.value="")});const i=()=>{a("update:isDirty",!0)},r=()=>{a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),qe(Gt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary"}," Add administrator ")]),default:ze(()=>[f[2]||(f[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:rt(r,["prevent"])},[l("div",W$,[f[1]||(f[1]=l("label",null,"Email address",-1)),Ue(l("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},J$=je(K$,[["__scopeId","data-v-a82da194"]]),Y$={class:"form-group"},X$={key:0,class:"error"},Q$=["disabled"],eT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=T(null);Ze(()=>o.show,d=>{d||(s.value=null)});const i=d=>{s.value=d.target.files[0],a("update:isDirty",!0)},r=()=>{s.value&&a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),qe(Gt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary",disabled:e.uploading},C(e.uploading?"Uploading...":"Upload route"),9,Q$)]),default:ze(()=>[f[1]||(f[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:rt(r,["prevent"])},[l("div",Y$,[f[0]||(f[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",X$,C(e.error),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},tT=je(eT,[["__scopeId","data-v-317975db"]]),nT={class:"instruction"},oT={class:"form-group"},sT={class:"form-group"},aT={class:"checkbox-label"},iT={key:0,class:"error"},lT={key:1,class:"import-result"},rT={key:0,class:"import-errors"},cT=["disabled"],uT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,r=T(null),u=T(!1);Ze(()=>s.show,k=>{k||(r.value=null,u.value=!1)});const d=k=>{r.value=k.target.files[0],i("update:isDirty",!0)},f=()=>{i("update:isDirty",!0)},p=()=>{r.value&&i("submit",{file:r.value,deleteExisting:u.value})},g=()=>{i("close")};return(k,y)=>(v(),qe(Gt,{show:e.show,title:`Import ${O(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:ze(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${O(a).checkpoints}`),9,cT)]),default:ze(()=>[l("p",nT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+C(O(o).people)+" (optional)",1),y[3]||(y[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:rt(p,["prevent"])},[l("div",oT,[y[1]||(y[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",sT,[l("label",aT,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":y[0]||(y[0]=_=>u.value=_),onChange:f},null,544),[[Ia,u.value]]),Je(" Delete existing "+C(O(a).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",iT,C(e.error),1)):M("",!0),e.result?(v(),m("div",lT,[l("p",null,"Created "+C(e.result.locationsCreated)+" "+C(O(a).checkpoints)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",rT,[y[2]||(y[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Ie,null,Ne(e.result.errors,(_,w)=>(v(),m("li",{key:w},C(_),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},dT=je(uT,[["__scopeId","data-v-75c79d31"]]),hT={class:"instruction"},fT={class:"form-group"},pT={key:0,class:"error"},vT={key:1,class:"import-result"},mT={key:0,class:"import-errors"},gT=["disabled"],yT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,r=T(null);Ze(()=>s.show,p=>{p||(r.value=null)});const u=p=>{r.value=p.target.files[0],i("update:isDirty",!0)},d=()=>{r.value&&i("submit",r.value)},f=()=>{i("close")};return(p,g)=>(v(),qe(Gt,{show:e.show,title:`Import ${O(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{actions:ze(()=>[l("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${O(a).people}`),9,gT)]),default:ze(()=>[l("p",hT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+C(O(o).checkpoint)+" (optional)",1),g[2]||(g[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:rt(d,["prevent"])},[l("div",fT,[g[0]||(g[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",pT,C(e.error),1)):M("",!0),e.result?(v(),m("div",vT,[l("p",null,"Imported "+C(e.result.marshalsCreated)+" "+C(O(a).people)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",mT,[g[1]||(g[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Ie,null,Ne(e.result.errors,(k,y)=>(v(),m("li",{key:y},C(k),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},kT=je(yT,[["__scopeId","data-v-be89bf1f"]]),_T=["onClick"],bT=["innerHTML"],wT={class:"hamburger-nav"},CT=["disabled"],LT=["innerHTML"],ST={class:"current-tab-label"},xT=["disabled"],IT={key:0,class:"hamburger-menu"},$T=["onClick"],TT=["innerHTML"],MT=400,AT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=T(null),i=T(null),r=T(null),u=T(!1),d=T(!1),f=V(()=>{const R=o.tabs.find(H=>H.value===o.modelValue);return R?R.label:""}),p=V(()=>o.tabs.find(H=>H.value===o.modelValue)?.icon||null),g=V(()=>o.tabs.findIndex(R=>R.value===o.modelValue)),k=V(()=>g.value>0),y=V(()=>g.value<o.tabs.length-1),_=()=>{k.value&&a("update:modelValue",o.tabs[g.value-1].value)},w=()=>{y.value&&a("update:modelValue",o.tabs[g.value+1].value)},S=()=>{if(!s.value)return;const R=s.value.clientWidth;if(R<MT){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>R&&(u.value=!0);return}const H=o.tabs.some(N=>N.icon)?110:90,$=o.tabs.length*H,B=(o.tabs.length-1)*8;$+B<=R&&(u.value=!1,cn(()=>{i.value&&i.value.scrollWidth>R&&(u.value=!0)}))},E=()=>{d.value=!d.value},A=R=>{a("update:modelValue",R),d.value=!1},x=R=>{r.value&&!r.value.contains(R.target)&&(d.value=!1)};let D=null;return nn(()=>{cn(()=>{S(),s.value&&typeof ResizeObserver<"u"&&(D=new ResizeObserver(()=>{S()}),D.observe(s.value)),document.addEventListener("click",x)})}),xn(()=>{D&&D.disconnect(),document.removeEventListener("click",x)}),Ze(()=>o.tabs,()=>{cn(()=>{S()})},{deep:!0}),(R,H)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:r},[l("div",wT,[l("button",{class:pe(["nav-arrow",{invisible:!k.value}]),onClick:_,type:"button","aria-label":"Previous tab",disabled:!k.value},"  ",10,CT),l("button",{class:"hamburger-button",onClick:E,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:O(Xn)(p.value)},null,8,LT)):M("",!0),l("span",ST,C(f.value),1),H[0]||(H[0]=l("span",{class:"hamburger-chevron"},"",-1))]),l("button",{class:pe(["nav-arrow",{invisible:!y.value}]),onClick:w,type:"button","aria-label":"Next tab",disabled:!y.value},"  ",10,xT)]),d.value?(v(),m("div",IT,[(v(!0),m(Ie,null,Ne(e.tabs,$=>(v(),m("button",{key:$.value,class:pe(["menu-item",{active:e.modelValue===$.value}]),onClick:B=>A($.value),type:"button"},[$.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)($.icon)},null,8,TT)):M("",!0),Je(" "+C($.label),1)],10,$T))),128))])):M("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),m(Ie,null,Ne(e.tabs,$=>(v(),m("button",{key:$.value,class:pe(["tab-button",{active:e.modelValue===$.value}]),onClick:B=>R.$emit("update:modelValue",$.value),type:"button"},[$.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)($.icon)},null,8,bT)):M("",!0),Je(" "+C($.label),1)],10,_T))),128))],512))],512))}},Wi=je(AT,[["__scopeId","data-v-736c5d0a"]]),ET={class:"tab-content"},PT={class:"form-group"},DT=["value"],RT={class:"form-group"},OT=["value"],BT={class:"form-group"},NT={class:"area-display"},FT={key:0,class:"no-area"},UT={class:"form-help"},zT={class:"form-group checkbox-group"},HT={class:"checkbox-label"},VT=["checked"],GT={class:"form-help"},jT={key:0,class:"custom-times-section"},ZT={class:"form-group"},qT=["value"],WT={class:"form-help"},KT={class:"form-group"},JT=["value"],YT={class:"form-help"},XT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(f=>f.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},r=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const f=Bl(o.eventDate);d.startTime=f,d.endTime=f}a("update:form",d),a("input")};return(u,d)=>(v(),m("div",ET,[l("form",{onSubmit:d[5]||(d[5]=rt(f=>u.$emit("save"),["prevent"]))},[l("div",PT,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=f=>i("name",f.target.value)),type:"text",required:"",class:"form-input"},null,40,DT)]),l("div",RT,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=f=>i("description",f.target.value)),type:"text",class:"form-input"},null,40,OT)]),l("div",BT,[l("label",null,C(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",NT,[s.value.length===0?(v(),m("span",FT," Not in any "+C(e.areaTermSingular.toLowerCase())+" polygon ",1)):M("",!0),(v(!0),m(Ie,null,Ne(s.value,f=>(v(),m("span",{key:f.id,class:"area-badge",style:Qe({backgroundColor:f.color||"var(--brand-primary)"})},C(f.name),5))),128))]),l("small",UT,C(e.areaTermPlural)+" are automatically assigned based on "+C(e.checkpointTermSingular.toLowerCase())+" location within "+C(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",zT,[l("label",HT,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=f=>r(f.target.checked)),type:"checkbox"},null,40,VT),l("span",null,"Use custom date/time for this "+C(e.checkpointTermSingular.toLowerCase()),1)]),l("small",GT," By default, "+C(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",jT,[l("div",ZT,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=f=>i("startTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,qT),l("small",WT," When "+C(e.peopleTermPlural.toLowerCase())+" should arrive at this "+C(e.checkpointTermSingular.toLowerCase()),1)]),l("div",KT,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=f=>i("endTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,JT),l("small",YT," When "+C(e.peopleTermPlural.toLowerCase())+" can leave this "+C(e.checkpointTermSingular.toLowerCase()),1)])])):M("",!0)],32)]))}},QT=je(XT,[["__scopeId","data-v-aa628901"]]),eM={class:"scope-configuration-editor"},tM={class:"editor-header"},nM={class:"scope-types-list"},oM=["onClick"],sM={class:"scope-type-label"},aM={class:"scope-type-pill"},iM={class:"expand-label"},lM={class:"expand-icon"},rM={class:"modal-content"},cM={class:"modal-header"},uM={class:"modal-body"},dM={class:"scope-help"},hM={key:0,class:"form-group"},fM={class:"checkbox-label special-option"},pM=["checked"],vM={key:0,class:"specific-selection"},mM=["placeholder"],gM={class:"checkbox-group scrollable"},yM=["checked","onChange"],kM={key:1,class:"form-group"},_M={class:"checkbox-label special-option"},bM=["checked"],wM={key:0,class:"specific-selection"},CM={class:"checkbox-group scrollable"},LM=["checked","onChange"],SM={key:2,class:"form-group"},xM={class:"checkbox-label special-option"},IM=["checked"],$M={key:0,class:"specific-selection"},TM=["placeholder"],MM={class:"checkbox-group scrollable"},AM={key:0,class:"checkbox-label this-checkpoint-option"},EM=["checked"],PM={class:"checkpoint-info"},DM={class:"checkpoint-name"},RM=["checked","onChange"],OM={class:"checkpoint-info"},BM={class:"checkpoint-name"},NM={key:0,class:"checkpoint-description"},FM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),r=T({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=T(null),d=T(""),f=T(""),p=T(!a.isEditing);let g=!0,k=!1;const y=V(()=>i.value.filter(me=>!a.excludeScopes.includes(me.scope))),_=V(()=>p.value?y.value:y.value.filter(me=>Z(me.scope))),w=V(()=>y.value.filter(xe=>Z(xe.scope)).length<y.value.length),S=V(()=>{const me=y.value.filter(xe=>Z(xe.scope)).length;return y.value.length-me}),E=V(()=>!a.currentCheckpointId&&a.intent==="location-update");Ze(()=>a.modelValue,me=>{if(me){if(k){k=!1;return}g=!0,Object.keys(r.value).forEach(xe=>{r.value[xe]={enabled:!1,ids:[]}}),me.forEach(xe=>{xe.scope==="Everyone"?r.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:xe.scope==="AreaLead"?r.value.EveryAreaLead={enabled:!0,ids:[...xe.ids]}:r.value[xe.scope]&&(r.value[xe.scope]={enabled:!0,ids:[...xe.ids]})}),g=!1}},{immediate:!0});const A=()=>{const me=[];return Object.keys(r.value).forEach(xe=>{const De=r.value[xe];if(De.enabled){const q={scope:xe,itemType:x(xe),ids:[...De.ids]};me.push(q)}}),me};Ze(r,()=>{if(g)return;if(Object.keys(r.value).some(De=>De!=="SpecificPeople"&&r.value[De].enabled)&&r.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const De=r.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");r.value.SpecificPeople.ids.splice(De,1),r.value.SpecificPeople.ids.length===0&&(r.value.SpecificPeople.enabled=!1)}k=!0;const xe=A();s("update:modelValue",xe),s("user-changed")},{deep:!0});const x=me=>D(me)?"Area":R(me)?"Checkpoint":H(me)?"Marshal":null,D=me=>me==="EveryoneInAreas"||me==="OnePerArea"||me==="EveryAreaLead"||me==="OneLeadPerArea",R=me=>me==="EveryoneAtCheckpoints"||me==="OnePerCheckpoint",H=me=>me==="SpecificPeople",$=me=>{const xe=i.value.find(De=>De.scope===me);return xe?xe.label:me},B=V(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${o.value.checklist}?`),N=me=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[me]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[me]||"",Z=me=>r.value[me]?.enabled||!1,P=me=>{const xe=r.value[me];if(!xe||!xe.enabled)return"No";const De=xe.ids||[];if(D(me)){if(De.includes("ALL_AREAS"))return`All ${o.value.areas}`;const q=De.length;return q>0?`${q} ${q!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(R(me)){if(De.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(De.length===1&&De[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const q=De.length;return q>0?`${q} ${q!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(H(me)){if(De.includes("ALL_MARSHALS"))return"Everyone";const q=De.length;return q>0?`${q} ${q!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},G=me=>{u.value=me,d.value="",f.value=""},Y=()=>{u.value=null},te=()=>{u.value&&(r.value[u.value]={enabled:!1,ids:[]}),Y()},Q=()=>u.value&&r.value[u.value]?.ids.includes("ALL_MARSHALS"),X=()=>{if(!u.value)return;const me=r.value[u.value];Q()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_MARSHALS"],me.enabled=!0)},ne=me=>u.value&&r.value[u.value]?.ids.includes(me),F=me=>{if(!u.value)return;const xe=r.value[u.value],De=xe.ids.indexOf(me);De>=0?(xe.ids.splice(De,1),xe.ids.length===0&&(xe.enabled=!1)):(xe.ids.push(me),xe.enabled=!0)},K=V(()=>{if(!f.value)return a.marshals;const me=f.value.toLowerCase();return a.marshals.filter(xe=>xe.name.toLowerCase().includes(me)||xe.email&&xe.email.toLowerCase().includes(me))}),fe=()=>u.value&&r.value[u.value]?.ids.includes("ALL_AREAS"),he=()=>{if(!u.value)return;const me=r.value[u.value];fe()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_AREAS"],me.enabled=!0)},Re=me=>u.value&&r.value[u.value]?.ids.includes(me),et=me=>{if(!u.value)return;const xe=r.value[u.value],De=xe.ids.indexOf(me);De>=0?(xe.ids.splice(De,1),xe.ids.length===0&&(xe.enabled=!1)):(xe.ids.push(me),xe.enabled=!0)},Xe=()=>u.value&&r.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),He=()=>{if(!u.value)return;const me=r.value[u.value];Xe()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_CHECKPOINTS"],me.enabled=!0)},Ke=me=>u.value&&r.value[u.value]?.ids.includes(me),ye=me=>{if(!u.value)return;const xe=r.value[u.value],De=xe.ids.indexOf(me);De>=0?(xe.ids.splice(De,1),xe.ids.length===0&&(xe.enabled=!1)):(xe.ids.push(me),xe.enabled=!0)},Ve=V(()=>{let me=a.locations;if(d.value){const xe=d.value.toLowerCase();me=me.filter(De=>De.name.toLowerCase().includes(xe)||De.description&&De.description.toLowerCase().includes(xe))}return[...me].sort((xe,De)=>Vs(xe.name,De.name))});return(me,xe)=>(v(),m("div",eM,[l("div",tM,[l("h4",null,C(B.value),1)]),l("div",nM,[(v(!0),m(Ie,null,Ne(_.value,De=>(v(),m("div",{key:De.scope,class:pe(["scope-type-row",{active:Z(De.scope)}]),onClick:q=>G(De.scope)},[l("div",sM,C(De.label),1),l("div",aM,C(P(De.scope)),1)],10,oM))),128)),w.value?(v(),m("div",{key:0,class:"expand-row",onClick:xe[0]||(xe[0]=De=>p.value=!p.value)},[l("div",iM,C(p.value?"Show less":`Show ${S.value} more option${S.value!==1?"s":""}...`),1),l("div",lM,C(p.value?"":""),1)])):M("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:rt(Y,["self"])},[l("div",rM,[l("div",cM,[l("h5",null,C($(u.value)),1),l("button",{onClick:Y,class:"btn-close",type:"button"},"")]),l("div",uM,[l("p",dM,C(N(u.value)),1),H(u.value)?(v(),m("div",hM,[l("label",fM,[l("input",{type:"checkbox",checked:Q(),onChange:X},null,40,pM),l("span",null,[xe[4]||(xe[4]=l("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+C(O(o).people)+")",1)])]),Q()?M("",!0):(v(),m("div",vM,[Ue(l("input",{"onUpdate:modelValue":xe[1]||(xe[1]=De=>f.value=De),type:"text",placeholder:`Search ${O(o).people}...`,class:"search-input"},null,8,mM),[[st,f.value]]),l("div",gM,[(v(!0),m(Ie,null,Ne(K.value,De=>(v(),m("label",{key:De.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:ne(De.id),onChange:q=>F(De.id)},null,40,yM),l("span",null,C(De.name),1)]))),128))])]))])):M("",!0),D(u.value)?(v(),m("div",kM,[l("label",_M,[l("input",{type:"checkbox",checked:fe(),onChange:he},null,40,bM),l("span",null,[l("strong",null,"All "+C(O(o).areas),1),Je(" (includes future "+C(O(o).areas)+")",1)])]),fe()?M("",!0):(v(),m("div",wM,[l("div",CM,[(v(!0),m(Ie,null,Ne(e.areas,De=>(v(),m("label",{key:De.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Re(De.id),onChange:q=>et(De.id)},null,40,LM),l("span",{class:"area-color-dot",style:Qe({backgroundColor:De.color||"#667eea"})},null,4),l("span",null,C(De.name),1)]))),128))])]))])):M("",!0),R(u.value)?(v(),m("div",SM,[l("label",xM,[l("input",{type:"checkbox",checked:Xe(),onChange:He},null,40,IM),l("span",null,[l("strong",null,"All "+C(O(o).checkpoints),1),Je(" (includes future "+C(O(o).checkpoints)+")",1)])]),Xe()?M("",!0):(v(),m("div",$M,[Ue(l("input",{"onUpdate:modelValue":xe[2]||(xe[2]=De=>d.value=De),type:"text",placeholder:`Search ${O(o).checkpoints}...`,class:"search-input"},null,8,TM),[[st,d.value]]),l("div",MM,[E.value?(v(),m("label",AM,[l("input",{type:"checkbox",checked:Ke("THIS_CHECKPOINT"),onChange:xe[3]||(xe[3]=De=>ye("THIS_CHECKPOINT"))},null,40,EM),l("div",PM,[l("span",DM,[l("strong",null,"This "+C(O(o).checkpoint),1)])])])):M("",!0),(v(!0),m(Ie,null,Ne(Ve.value,De=>(v(),m("label",{key:De.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Ke(De.id),onChange:q=>ye(De.id)},null,40,RM),l("div",OM,[l("span",BM,C(De.name),1),De.description?(v(),m("span",NM," - "+C(De.description),1)):M("",!0)])]))),128))])]))])):M("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:te,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:Y,class:"btn btn-primary",type:"button"},"Done")])])])):M("",!0)]))}},mc=je(FM,[["__scopeId","data-v-3107d36b"]]),UM={class:"tab-content"},zM={class:"form-group"},HM=["value"],VM={key:0,class:"form-error"},GM={class:"form-row"},jM={class:"form-group"},ZM=["disabled"],qM={class:"form-group"},WM=["disabled"],KM={class:"form-group"},JM={class:"accordion-item"},YM={class:"accordion-preview"},XM={class:"accordion-arrow"},QM={key:0,class:"accordion-content"},eA={class:"section-description"},tA={class:"dynamic-checkbox"},nA=["checked"],oA={key:0,class:"dynamic-settings"},sA={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,s=T(!1),i=T(""),r=T(""),u=y=>y==null||y===""||isNaN(y)?"":Number(y).toFixed(6);Ze(()=>o.form.longitude,y=>{i.value=u(y)},{immediate:!0}),Ze(()=>o.form.latitude,y=>{r.value=u(y)},{immediate:!0});const d=y=>{const _=y==="longitude"?i:r,w=parseFloat(_.value);isNaN(w)?_.value.trim()===""&&(a("update:form",{...o.form,[y]:0}),a("input"),_.value=u(0)):(a("update:form",{...o.form,[y]:w}),a("input"),_.value=u(w))},f=(y,_)=>{a("update:form",{...o.form,[y]:_}),a("input")},p=y=>{if(y){const _=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],w=o.form.locationUpdateScopeConfigurations||[],S=w.length>0?w:_;a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:S})}else a("update:form",{...o.form,isDynamic:!1});a("input")},g=y=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:y}),a("input")},k=y=>{if(!y)return!0;const _=y.includes(".")?y.split("."):y.split("/");if(_.length!==3)return!1;const w=/^[a-z]{1,20}$/;return _.every(S=>w.test(S))};return(y,_)=>(v(),m("div",UM,[l("form",{onSubmit:_[6]||(_[6]=rt(w=>y.$emit("save"),["prevent"]))},[l("div",zM,[_[10]||(_[10]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:_[0]||(_[0]=w=>f("what3Words",w.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,HM),e.form.what3Words&&!k(e.form.what3Words)?(v(),m("small",VM," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),e.form.isDynamic?M("",!0):(v(),m(Ie,{key:0},[l("div",GM,[l("div",jM,[_[11]||(_[11]=l("label",null,"Longitude",-1)),Ue(l("input",{"onUpdate:modelValue":_[1]||(_[1]=w=>i.value=w),onBlur:_[2]||(_[2]=w=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,ZM),[[st,i.value]])]),l("div",qM,[_[12]||(_[12]=l("label",null,"Latitude",-1)),Ue(l("input",{"onUpdate:modelValue":_[3]||(_[3]=w=>r.value=w),onBlur:_[4]||(_[4]=w=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,WM),[[st,r.value]])])]),l("div",KM,[l("button",{type:"button",onClick:_[5]||(_[5]=w=>y.$emit("move-location")),class:pe(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[_[13]||(_[13]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+C(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",JM,[l("button",{type:"button",class:pe(["accordion-header",{expanded:s.value}]),onClick:_[7]||(_[7]=w=>s.value=!s.value)},[_[14]||(_[14]=Er('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),l("span",YM,C(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",XM,C(s.value?"":""),1)],2),s.value?(v(),m("div",QM,[l("p",eA," Enable this for lead cars, sweep vehicles, or other moving "+C(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+C(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",tA,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:_[8]||(_[8]=w=>p(w.target.checked))},null,40,nA),l("span",null,"This "+C(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",oA,[Ee(mc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:_[9]||(_[9]=w=>y.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):M("",!0)])):M("",!0)])]))}},aA=je(sA,[["__scopeId","data-v-c3ce308d"]]);function Yv(e){const t=T(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const k=!o(p);k===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,k),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const iA={class:"card-main"},lA={class:"card-title"},rA={class:"marshal-name"},cA={key:0,class:"card-check-in"},uA={class:"toggle-icon"},dA={class:"toggle-label"},hA={key:0,class:"check-in-time"},fA={key:0,class:"check-in-method"},pA={key:1,class:"unsaved-indicator"},vA={key:1,class:"card-status-readonly"},mA={class:"status-icon"},gA={key:0,class:"check-in-time"},yA={key:0,class:"check-in-method"},kA={key:2,class:"card-badge"},_A={key:3,class:"card-badge"},bA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const o=e,a=t,s=g=>g?new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",i=V(()=>{const{checkedInBy:g,checkInMethod:k,marshalName:y}=o.assignment;return g&&g!==y?g:k||""}),r=V(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),u=V(()=>{const{checkInLatitude:g,checkInLongitude:k}=o.assignment,y=o.location;return!g||!k||!y?.latitude||!y?.longitude?null:Db(g,k,y.latitude,y.longitude)}),d=V(()=>u.value===null?null:Rb(u.value)),f=V(()=>u.value===null?"":u.value<=50?"distance-close":u.value<=100?"distance-medium":"distance-far"),p=()=>{r.value&&a("click",o.assignment)};return(g,k)=>(v(),m("div",{class:pe(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":r.value}]),onClick:p},[l("div",iA,[l("div",lA,[l("span",rA,C(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",cA,[l("button",{class:pe(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=rt(y=>g.$emit("toggle-check-in",e.assignment),["stop"]))},[l("span",uA,C(e.effectiveCheckInStatus?"":""),1),l("span",dA,C(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",hA,[Je(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",fA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:pe(["check-in-distance",f.value])},C(d.value),3)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",pA," Unsaved ")):M("",!0)])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",vA,[l("span",{class:pe(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[l("span",mA,C(e.effectiveCheckInStatus?"":""),1),Je(" "+C(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",gA,[Je(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",yA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:pe(["check-in-distance",f.value])},C(d.value),3)):M("",!0)])):M("",!0)])):M("",!0),e.assignment.isPending?(v(),m("div",kA,[...k[3]||(k[3]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",_A,[...k[4]||(k[4]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=rt(y=>g.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=rt(y=>g.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)],2))}},wA=je(bA,[["__scopeId","data-v-6e808532"]]),CA={class:"tab-content"},LA={key:0,class:"read-only-notice"},SA={key:1,class:"form-group"},xA=["value"],IA={class:"section-title"},$A={key:2,class:"assign-section"},TA={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal"],setup(e,{expose:t,emit:o}){const a=e,s=V(()=>a.peopleTerm.toLowerCase()),i=V(()=>a.personTerm.toLowerCase()),r=V(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:f,handleToggleCheckIn:p}=Yv(()=>u("input")),g=T(new Set),k=V(()=>a.assignments?.length||0),y=V(()=>a.assignments?[...a.assignments].sort((D,R)=>(D.marshalName||"").localeCompare(R.marshalName||"",void 0,{sensitivity:"base"})):[]),_=D=>g.value.has(D),w=D=>{D.isPending||u("select-marshal",D)},S=D=>{p(D)},E=D=>{D.isPending?u("remove-assignment",D):(g.value.add(D.id),u("input"))},A=D=>{g.value.delete(D.id),u("input")},x=(D,R)=>{u("update:form",{...a.form,[D]:Number(R)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([D,R])=>({assignmentId:D,shouldBeCheckedIn:R})),getMarkedForRemoval:()=>Array.from(g.value)}),(D,R)=>(v(),m("div",CA,[e.readOnly?(v(),m("div",LA," Viewing from "+C(i.value)+" - "+C(s.value)+" cannot be modified here. ",1)):M("",!0),e.readOnly?M("",!0):(v(),m("div",SA,[l("label",null,"Required "+C(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:R[0]||(R[0]=H=>x("requiredMarshals",H.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,xA)])),l("h3",IA,"Assigned "+C(s.value)+" ("+C(k.value)+")",1),Ee(ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${r.value}.`},{default:ze(()=>[(v(!0),m(Ie,null,Ne(y.value,H=>(v(),qe(wA,{key:H.id,assignment:H,"effective-check-in-status":O(f)(H),"has-unsaved-changes":O(d).has(H.id),"is-marked-for-removal":_(H.id),"read-only":e.readOnly,location:e.form,onClick:w,onToggleCheckIn:S,onRemove:E,onUndoRemove:A},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?M("",!0):(v(),m("div",$A,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:R[1]||(R[1]=H=>D.$emit("open-assign-modal"))}," + Assign "+C(i.value)+"... ",1)]))]))}},MA=je(TA,[["__scopeId","data-v-a4e77b95"]]),AA={class:"grouped-tasks-list"},EA={key:0,class:"empty-state"},PA={key:1,class:"task-groups"},DA=["onClick"],RA={class:"task-header-content"},OA={class:"task-checkbox-area"},BA={class:"task-info"},NA={class:"task-name"},FA={class:"task-summary"},UA={key:0,class:"modified-badge"},zA={class:"task-scope"},HA=["title"],VA={class:"expand-arrow"},GA={key:0,class:"task-group-details"},jA={class:"detail-checkbox"},ZA=["checked","disabled","onChange"],qA={class:"detail-content"},WA={class:"detail-context"},KA={key:0,class:"detail-completion"},JA={key:0,class:"pending-text"},YA={class:"completion-text"},XA={class:"completion-time"},QA={key:1,class:"detail-uncomplete"},eE={key:2,class:"detail-disabled"},tE={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=T(new Set),r=V(()=>{const _=new Map;for(const w of s.items){_.has(w.itemId)||_.set(w.itemId,{itemId:w.itemId,text:w.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const S=_.get(w.itemId);S.items.push(w),S.totalCount++,w.localIsCompleted&&S.completedCount++,w.isModified&&(S.hasModified=!0)}for(const w of _.values())w.allCompleted=w.completedCount===w.totalCount,w.items.sort((S,E)=>{const A=k(S),x=k(E);return A.localeCompare(x,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(_.values()).sort((w,S)=>w.text.localeCompare(S.text,void 0,{sensitivity:"base"}))}),u=_=>{i.value.has(_)?i.value.delete(_):i.value.add(_),i.value=new Set(i.value)},d=_=>_.hasModified?"status-modified":_.allCompleted?"status-completed":_.completedCount>0?"status-partial":"status-pending",f=_=>_.allCompleted?"":_.completedCount>0?"":"",p=_=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[_.matchedScope]||_.matchedScope,g=_=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[_.matchedScope]||"",k=_=>{if(!_.completionContextType||!_.completionContextId)return"Everyone";if(_.completionContextType==="Checkpoint"){const w=s.locations.find(S=>S.id===_.completionContextId);return w?w.description?`${w.name} - ${w.description}`:w.name:`${o.value.checkpoint} (unknown)`}if(_.completionContextType==="Area"){const w=s.areas.find(S=>S.id===_.completionContextId);return w?w.name:`${o.value.area} (unknown)`}if(_.completionContextType==="Personal"){if(_.contextOwnerName)return _.contextOwnerName;if(_.completionContextId&&s.marshals.length>0){const w=s.marshals.find(S=>S.id===_.completionContextId||S.marshalId===_.completionContextId);if(w)return w.name||w.marshalName}return"Assigned individually"}return _.completionContextType},y=_=>_?new Date(_).toLocaleString():"";return(_,w)=>(v(),m("div",AA,[r.value.length===0?(v(),m("div",EA,[...w[0]||(w[0]=[l("p",null,"No tasks available.",-1)])])):(v(),m("div",PA,[(v(!0),m(Ie,null,Ne(r.value,S=>(v(),m("div",{key:S.itemId,class:pe(["task-group",{"all-completed":S.allCompleted,"has-modified":S.hasModified}])},[l("button",{type:"button",class:"task-group-header",onClick:E=>u(S.itemId)},[l("div",RA,[l("div",OA,[l("span",{class:pe(["task-status-icon",d(S)])},C(f(S)),3)]),l("div",BA,[l("div",NA,C(S.text),1),l("div",FA,[l("span",{class:pe(["completion-count",{"all-done":S.allCompleted}])},C(S.completedCount)+"/"+C(S.totalCount)+" completed ",3),S.hasModified?(v(),m("span",UA," Modified ")):M("",!0)])]),l("div",zA,[l("span",{class:"scope-pill",title:g(S.items[0])},C(p(S.items[0])),9,HA)])]),l("span",VA,C(i.value.has(S.itemId)?"":""),1)],8,DA),i.value.has(S.itemId)?(v(),m("div",GA,[(v(!0),m(Ie,null,Ne(S.items,E=>(v(),m("div",{key:`${E.itemId}-${E.completionContextId}`,class:pe(["task-detail-item",{"item-completed":E.localIsCompleted,"item-modified":E.isModified}])},[l("div",jA,[l("input",{type:"checkbox",checked:E.localIsCompleted,disabled:!E.canBeCompletedByMe&&!E.localIsCompleted,onChange:A=>_.$emit("toggle-complete",E)},null,40,ZA)]),l("div",qA,[l("div",WA,C(k(E)),1),E.localIsCompleted?(v(),m("div",KA,[E.isModified&&!E.isCompleted?(v(),m("span",JA," Will be marked as completed ")):(v(),m(Ie,{key:1},[l("span",YA,C(E.completedByActorName||"Unknown"),1),l("span",XA,C(y(E.completedAt)),1)],64))])):E.isModified&&E.isCompleted?(v(),m("div",QA,[...w[1]||(w[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):E.canBeCompletedByMe?M("",!0):(v(),m("div",eE," Already completed by someone else "))])],2))),128))])):M("",!0)],2))),128))]))]))}},id=je(tE,[["__scopeId","data-v-409a65e7"]]),nE={class:"checkpoint-checklist-view"},oE={key:0,class:"loading-state"},sE={key:1,class:"error-state"},aE={key:2,class:"empty-state"},iE={class:"help-text"},lE={key:3,class:"empty-state"},rE={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,r=T([]),u=T(!1),d=T(null),f=T(new Map),p=V(()=>s.assignments.length===0),g=V(()=>r.value.map(S=>{const E=f.value.get(`${S.itemId}|||${S.completionContextId}`),A=E!==void 0?E.complete:S.isCompleted,x=E!==void 0&&E.complete!==S.isCompleted;return{...S,localIsCompleted:A,isModified:x}})),k=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const S=s.locationId?await Rt.getCheckpointChecklist(s.eventId,s.locationId):await Rt.getAreaChecklist(s.eventId,s.areaId);if(r.value=S.data||[],s.modelValue&&s.modelValue.length>0){const E=new Map;s.modelValue.forEach(A=>{E.set(`${A.itemId}|||${A.contextId}`,{complete:A.complete,contextType:A.contextType,contextId:A.contextId})}),f.value=E}}catch(S){console.error("Failed to load checklist:",S),d.value=S.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=S=>{const E=S.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!E)return;const A=`${S.itemId}|||${S.completionContextId}`,x=f.value.get(A),D=x!==void 0?x.complete:S.isCompleted;f.value.set(A,{complete:!D,contextType:S.completionContextType,contextId:S.completionContextId,marshalId:E}),_()},_=()=>{const S=[];for(const[E,A]of f.value.entries()){const[x,D]=E.split("|||"),R=r.value.find(H=>H.itemId===x&&H.completionContextId===D);R&&A.complete!==R.isCompleted&&S.push({itemId:x,complete:A.complete,contextType:A.contextType,contextId:A.contextId,marshalId:A.marshalId})}i("update:modelValue",S),i("change",S)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(E=>{S.set(`${E.itemId}|||${E.contextId}`,{complete:E.complete,contextType:E.contextType,contextId:E.contextId,marshalId:E.marshalId})}),f.value=S}},loadChecklist:k}),Ze(()=>[s.eventId,s.locationId,s.areaId],()=>{k()},{immediate:!0}),(S,E)=>(v(),m("div",nE,[u.value?(v(),m("div",oE," Loading checklist... ")):d.value?(v(),m("div",sE,[l("p",null,C(d.value),1),l("button",{onClick:k,class:"btn btn-secondary btn-small"}," Retry ")])):p.value?(v(),m("div",aE,[l("p",null,"No "+C(O(a).peoplePlural)+" assigned to this "+C(O(a).checkpoint)+" yet.",1),l("p",iE,"Assign "+C(O(a).peoplePlural)+" to enable "+C(O(a).checklist)+" completion.",1)])):r.value.length===0?(v(),m("div",lE,[l("p",null,"No checklist items for this "+C(O(a).checkpoint)+".",1)])):(v(),qe(id,{key:4,items:g.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},Xv=je(rE,[["__scopeId","data-v-52b7a966"]]),cE={class:"notes-view"},uE={key:0,class:"loading-state"},dE={key:1,class:"error-state"},hE={key:2,class:"empty-state"},fE={key:3,class:"notes-list"},pE={class:"note-header"},vE={class:"note-title-row"},mE={key:0,class:"pin-icon",title:"Pinned"},gE={class:"note-title"},yE={class:"note-meta"},kE={key:0,class:"category-badge"},_E={key:0,class:"note-content"},bE={class:"note-footer"},wE={class:"created-info"},CE={key:0,class:"scope-info"},LE={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=T([]),s=T(!1),i=T(null),r=V(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=V(()=>o.areaId?o.locations.filter(E=>E.areaIds&&E.areaIds.includes(o.areaId)):[]),d=V(()=>u.value.map(E=>E.id)),f=V(()=>{if(!o.areaId)return[];const E=new Set;return o.assignments.filter(A=>d.value.includes(A.locationId)).forEach(A=>E.add(A.marshalId)),Array.from(E)}),p=E=>o.assignments.filter(A=>A.marshalId===E).map(A=>A.locationId),g=E=>{const A=p(E),x=new Set;for(const D of A){const R=o.locations.find(H=>H.id===D);R?.areaIds&&R.areaIds.forEach(H=>x.add(H))}return Array.from(x)},k=(E,A)=>{if(!E.scopeConfigurations)return null;for(const x of E.scopeConfigurations){if(x.itemType==="Area"){if(A.type==="area"&&(x.ids.includes(A.areaId)||x.ids.includes("ALL_AREAS")))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"};if(A.type==="checkpoint"){const R=o.locations.find(H=>H.id===A.locationId)?.areaIds||[];if(x.ids.includes("ALL_AREAS")||R.some(H=>x.ids.includes(H)))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(x.itemType==="Checkpoint"){if(A.type==="checkpoint"&&(x.ids.includes(A.locationId)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(A.type==="area"&&A.checkpointIds.some(R=>x.ids.includes(R)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(x.itemType==="Marshal"){if(A.type==="marshal"&&(x.ids.includes(A.marshalId)||x.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(A.type==="checkpoint"){const D=o.assignments.filter(H=>H.locationId===A.locationId).map(H=>H.marshalId);if(x.ids.includes("ALL_MARSHALS")||D.some(H=>x.ids.includes(H)))return{matched:!0,scope:"Marshal at checkpoint"}}if(A.type==="area"&&(x.ids.includes("ALL_MARSHALS")||A.marshalIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:"Marshal in area"}}if(A.type==="marshal"&&A.checkpointIds&&A.areaIds){if(x.itemType==="Checkpoint"&&(x.ids.includes("ALL_CHECKPOINTS")||A.checkpointIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:"Assigned checkpoint"};if(x.itemType==="Area"&&(x.ids.includes("ALL_AREAS")||A.areaIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},y=V(()=>{const E=o.allNotes||a.value;if(!E||E.length===0)return[];if(o.areaId&&o.allNotes){const A={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:f.value},x=[],D=new Set;for(const R of E){if(D.has(R.noteId))continue;const H=k(R,A);H&&(D.add(R.noteId),x.push({...R,matchedScope:H.scope}))}return x}if(o.locationId&&o.allNotes){const A={type:"checkpoint",locationId:o.locationId},x=[],D=new Set;for(const R of E){if(D.has(R.noteId))continue;const H=k(R,A);H&&(D.add(R.noteId),x.push({...R,matchedScope:H.scope}))}return x}if(o.marshalId&&o.allNotes){const A=p(o.marshalId),x=g(o.marshalId),D={type:"marshal",marshalId:o.marshalId,checkpointIds:A,areaIds:x},R=[],H=new Set;for(const $ of E){if(H.has($.noteId))continue;const B=k($,D);B&&(H.add($.noteId),R.push({...$,matchedScope:B.scope}))}return R}return E}),_=V(()=>{const E={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...y.value].sort((A,x)=>{if(A.isPinned!==x.isPinned)return A.isPinned?-1:1;const D=E[A.priority]??2,R=E[x.priority]??2;return D!==R?D-R:A.displayOrder!==x.displayOrder?A.displayOrder-x.displayOrder:new Date(x.createdAt)-new Date(A.createdAt)})}),w=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,i.value=null;try{let E;o.marshalId?E=await Es.getMarshalNotes(o.eventId,o.marshalId):E=await Es.getByEvent(o.eventId),a.value=E.data||[]}catch(E){console.error("Failed to load notes:",E),i.value=E.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ze(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&w()},{immediate:!0});const S=E=>{if(!E)return"";const A=new Date(E),D=new Date-A,R=Math.floor(D/6e4),H=Math.floor(D/36e5),$=Math.floor(D/864e5);return R<1?"just now":R<60?`${R}m ago`:H<24?`${H}h ago`:$<7?`${$}d ago`:A.toLocaleDateString()};return t({loadNotes:w}),(E,A)=>(v(),m("div",cE,[s.value?(v(),m("div",uE," Loading notes... ")):i.value?(v(),m("div",dE,[l("p",null,C(i.value),1),l("button",{onClick:w,class:"btn btn-secondary btn-small"}," Retry ")])):y.value.length===0?(v(),m("div",hE,[l("p",null,C(r.value),1)])):(v(),m("div",fE,[(v(!0),m(Ie,null,Ne(_.value,x=>(v(),m("div",{key:x.noteId,class:pe(["note-item",{pinned:x.isPinned}])},[l("div",pE,[l("div",vE,[x.isPinned?(v(),m("span",mE,"")):M("",!0),l("span",{class:pe(["priority-indicator",(x.priority||"Normal").toLowerCase()])},null,2),l("strong",gE,C(x.title),1)]),l("div",yE,[x.category?(v(),m("span",kE,C(x.category),1)):M("",!0),l("span",{class:pe(["priority-badge",(x.priority||"Normal").toLowerCase()])},C(x.priority||"Normal"),3)])]),x.content?(v(),m("div",_E,C(x.content),1)):M("",!0),l("div",bE,[l("span",wE," Created by "+C(x.createdByName||"Unknown")+"  "+C(S(x.createdAt)),1),x.matchedScope&&e.showScope?(v(),m("span",CE,C(x.matchedScope),1)):M("",!0)])],2))),128))]))]))}},gc=je(LE,[["__scopeId","data-v-9fdf0b0b"]]),SE={class:"checklist-preview"},xE={class:"preview-actions"},IE={class:"preview-header"},$E={key:0,class:"add-item-form"},TE=["placeholder"],ME=["disabled"],AE={key:1,class:"pending-items"},EE={class:"item-content"},PE={class:"item-header"},DE={class:"item-text"},RE={class:"item-scope"},OE=["onClick"],BE={key:2,class:"empty-state"},NE={key:0,class:"help-text"},FE={key:3,class:"checklist-items"},UE={class:"item-content"},zE={class:"item-header"},HE={class:"item-text"},VE={class:"item-scope"},GE=["title"],jE={key:0,class:"item-context"},ZE={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=V(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():a.value.checkpoint),r=t,u=T(!1),d=T(""),f=T([...s.modelValue]);Ze(()=>s.modelValue,x=>{f.value=[...x]},{deep:!0});const p=()=>{d.value.trim()&&(f.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,k())},g=x=>{f.value.splice(x,1),k()},k=()=>{r("update:modelValue",[...f.value]),r("change")},y=x=>{const D=x.scope,R=x.itemType,H=x.ids||[];return(D==="EveryoneAtCheckpoints"||D==="OnePerCheckpoint")&&R==="Checkpoint"?H.includes("ALL_CHECKPOINTS"):D==="OnePerCheckpoint"&&R==="Area"?H.includes("ALL_AREAS")?!0:H.some($=>s.pendingAreaIds.includes($)):(D==="EveryoneInAreas"||D==="OnePerArea"||D==="EveryAreaLead"||D==="OneLeadPerArea")&&R==="Area"?H.includes("ALL_AREAS")?!0:H.some($=>s.pendingAreaIds.includes($)):!1},_=V(()=>s.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>y(D)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(H=>y(H));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${a.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(H=>y(H));return D&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find($=>y($));if(!D)return null;const R=D.itemType,H=D.ids||[];if(H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(R==="Area"){const $=s.areas.filter(B=>H.includes(B.id)&&s.pendingAreaIds.includes(B.id)).map(B=>B.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(x,D)=>(v(),m("div",SE,[l("div",xE,[l("p",IE,C(e.isEditing?`Add new ${O(a).checklist} for this ${i.value}:`:`${O(o).checklists} that will apply at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>u.value=!u.value)},C(u.value?"Cancel":`Add ${O(a).checklist}`),1)]),u.value?(v(),m("div",$E,[Ue(l("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>d.value=R),type:"text",placeholder:`Enter ${O(a).checklist} text...`,class:"add-item-input",onKeyup:ps(p,["enter"])},null,40,TE),[[st,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:p}," Add ",8,ME)])):M("",!0),f.value.length>0?(v(),m("div",AE,[(v(!0),m(Ie,null,Ne(f.value,(R,H)=>(v(),m("div",{key:`pending-${H}`,class:"checklist-item pending"},[D[3]||(D[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",EE,[l("div",PE,[l("div",DE,C(R.text),1),l("div",RE,[D[2]||(D[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:$=>g(H),title:"Remove"},"  ",8,OE)])])])]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&f.value.length===0?(v(),m("div",BE,[l("p",null,"No "+C(O(a).checklists)+" will apply based on the current "+C(O(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",NE," Assign "+C(O(a).areas)+" to see relevant "+C(O(a).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",FE,[(v(!0),m(Ie,null,Ne(_.value,R=>(v(),m("div",{key:R.id,class:"checklist-item"},[D[4]||(D[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",UE,[l("div",zE,[l("div",HE,C(R.text),1),l("div",VE,[l("span",{class:"scope-pill",title:E(R)},C(S(R)),9,GE)])]),A(R)?(v(),m("div",jE,C(A(R)),1)):M("",!0)])]))),128))])):M("",!0)]))}},qE=je(ZE,[["__scopeId","data-v-7d943b21"]]),WE={class:"notes-preview"},KE={class:"preview-actions"},JE={class:"preview-header"},YE={key:0,class:"add-item-form"},XE={class:"add-form-fields"},QE=["disabled"],e4={key:1,class:"pending-items"},t4={class:"note-header"},n4={class:"note-title"},o4={class:"note-actions"},s4=["onClick"],a4={key:0,class:"note-content"},i4={key:2,class:"empty-state"},l4={key:0,class:"help-text"},r4={key:3,class:"notes-list"},c4={class:"note-header"},u4={class:"note-title"},d4=["title"],h4={key:0,class:"note-content"},f4={key:1,class:"note-context"},p4={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),r=T(!1),u=T(""),d=T(""),f=T([...a.modelValue]);Ze(()=>a.modelValue,x=>{f.value=[...x]},{deep:!0});const p=()=>{!u.value.trim()&&!d.value.trim()||(f.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",r.value=!1,k())},g=x=>{f.value.splice(x,1),k()},k=()=>{s("update:modelValue",[...f.value]),s("change")},y=x=>{const D=x.scope,R=x.itemType,H=x.ids||[];return D==="EveryoneAtCheckpoints"&&R==="Checkpoint"?H.includes("ALL_CHECKPOINTS"):D==="EveryoneInAreas"&&R==="Area"?H.includes("ALL_AREAS")?!0:H.some($=>a.pendingAreaIds.includes($)):!1},_=V(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>y(D)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(H=>y(H));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(H=>y(H));return D&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find($=>y($));if(!D)return null;const R=D.itemType,H=D.ids||[];if(H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(R==="Area"){const $=a.areas.filter(B=>H.includes(B.id)&&a.pendingAreaIds.includes(B.id)).map(B=>B.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(x,D)=>(v(),m("div",WE,[l("div",KE,[l("p",JE,C(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>r.value=!r.value)},C(r.value?"Cancel":"Add note"),1)]),r.value?(v(),m("div",YE,[l("div",XE,[Ue(l("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>u.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,u.value]]),Ue(l("textarea",{"onUpdate:modelValue":D[2]||(D[2]=R=>d.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:p}," Add ",8,QE)])):M("",!0),f.value.length>0?(v(),m("div",e4,[(v(!0),m(Ie,null,Ne(f.value,(R,H)=>(v(),m("div",{key:`pending-${H}`,class:"note-item pending"},[l("div",t4,[l("span",n4,C(R.title||"Untitled"),1),l("div",o4,[D[3]||(D[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:$=>g(H),title:"Remove"},"  ",8,s4)])]),R.content?(v(),m("div",a4,C(R.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&f.value.length===0?(v(),m("div",i4,[l("p",null,"No notes will apply based on the current "+C(O(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",l4," Assign "+C(O(o).areas)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",r4,[(v(!0),m(Ie,null,Ne(_.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[l("div",c4,[l("span",u4,C(R.title||"Untitled"),1),l("span",{class:"scope-pill",title:E(R)},C(S(R)),9,d4)]),R.content?(v(),m("div",h4,C(R.content),1)):M("",!0),A(R)?(v(),m("div",f4,C(A(R)),1)):M("",!0)]))),128))])):M("",!0)]))}},v4=je(p4,[["__scopeId","data-v-71646c3f"]]),m4={class:"base-modal-title modal-title-with-icon"},g4=["innerHTML"],y4={key:7,class:"tab-content appearance-tab"},k4={class:"accordion-item"},_4=["innerHTML"],b4={class:"accordion-title"},w4={class:"accordion-arrow"},C4={key:0,class:"accordion-content"},L4={class:"section-description"},S4={class:"accordion-item"},x4={class:"accordion-preview"},I4={class:"accordion-arrow"},$4={key:0,class:"accordion-content"},T4={class:"section-description"},M4={class:"terminology-row"},A4={class:"terminology-field"},E4=["value"],P4={value:""},D4=["value"],R4={class:"terminology-field"},O4=["value"],B4={value:""},N4=["value"],F4={key:8,class:"tab-content incidents-tab"},U4={class:"incidents-list"},z4={class:"custom-footer"},H4={class:"footer-left"},lf="edit_location_accordion",V4={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=T("details"),r=T(!1),u=T(null),d=T(null),f=T([]),p=T([]),g=T([]),k=T({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),y=()=>a.eventId?`${lf}_${a.eventId}`:lf,_=T({iconStyle:!1,terminology:!1});nn(()=>{const re=localStorage.getItem(y());if(re)try{const ue=JSON.parse(re);_.value={..._.value,...ue}}catch{}});const w=re=>{_.value[re]=!_.value[re],localStorage.setItem(y(),JSON.stringify(_.value))},S=V(()=>{const re=k.value.areaIds||[];if(re.length>0){const ue=a.areas.filter(ee=>re.includes(ee.id)&&ee.peopleTerm).sort((ee,W)=>(ee.checkpointCount||0)-(W.checkpointCount||0));if(ue.length>0)return ue[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),E=V(()=>k.value.peopleTerm?k.value.peopleTerm:S.value),A=V(()=>{const re=k.value.areaIds||[];if(re.length>0){const ue=a.areas.filter(ee=>re.includes(ee.id)&&ee.checkpointTerm).sort((ee,W)=>(ee.checkpointCount||0)-(W.checkpointCount||0));if(ue.length>0)return ue[0].checkpointTerm}return o.value.checkpoint});V(()=>A.value.toLowerCase());const x=V(()=>{const re=k.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(re)return Ya("checkpoint",re,E.value);const ue=k.value.areaIds||[];let ee=null;if(ue.length>0){const W=a.areas.filter(ie=>ue.includes(ie.id)&&ie.checkpointTerm).sort((ie,Le)=>(ie.checkpointCount||0)-(Le.checkpointCount||0));W.length>0&&(ee=W[0].checkpointTerm)}return ee?Ya("checkpoint",ee,E.value):o.value.checkpoint}),D=V(()=>x.value.toLowerCase()),R=V(()=>{const re=E.value;return Ya("people",re)});V(()=>R.value.toLowerCase());const H=V(()=>o.value.area);V(()=>H.value.toLowerCase());const $=V(()=>o.value.area),B=V(()=>$.value.toLowerCase()),N=V(()=>o.value.areas),Z=V(()=>!!(a.location&&a.location.id)),P=V(()=>Z.value?`Edit ${D.value}: ${a.location?.name||""}`:`Add ${D.value}`),G=V(()=>{const re=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:E.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&re.push({value:"incidents",label:"Incidents",icon:"incidents"}),re}),Y=V(()=>G.value.findIndex(re=>re.value===i.value)),te=V(()=>Y.value===G.value.length-1),Q=V(()=>{const re=k.value.areaIds||[],ue=a.areas.filter(Be=>re.includes(Be.id)).sort((Be,Ye)=>(Be.checkpointCount||0)-(Ye.checkpointCount||0)),ee=(Be,Ye)=>{for(const mt of ue){const _t=Be(mt);if(_t&&_t!=="default")return{value:_t,source:"area"}}return Ye&&Ye!=="default"?{value:Ye,source:"event"}:{value:"",source:"none"}},W=ee(Be=>Be.checkpointStyleType||Be.CheckpointStyleType,a.eventDefaultStyleType),ie=ee(Be=>Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleColor),Le=ee(Be=>Be.checkpointStyleBackgroundShape||Be.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),Ce=ee(Be=>Be.checkpointStyleBackgroundColor||Be.CheckpointStyleBackgroundColor||Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),ke=ee(Be=>Be.checkpointStyleBorderColor||Be.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),j=ee(Be=>Be.checkpointStyleIconColor||Be.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),se=ee(Be=>Be.checkpointStyleSize||Be.CheckpointStyleSize,a.eventDefaultStyleSize),de=ee(Be=>Be.checkpointStyleMapRotation??Be.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Oe=[W,Le,Ce,ke,j,se,de].some(Be=>Be.source==="area");return{type:W.value||"default",color:ie.value,backgroundShape:Le.value,backgroundColor:Ce.value,borderColor:ke.value,iconColor:j.value,size:se.value,mapRotation:de.value,source:Oe?"area":W.value?"event":"none"}}),X=V(()=>Q.value.source==="area"?`${$.value} default`:"Event default"),ne=V(()=>{const re=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:Q.value.type,ue=k.value.styleBackgroundShape||Q.value.backgroundShape||"circle",ee=k.value.styleBackgroundColor||Q.value.backgroundColor||"#667eea",W=k.value.styleBorderColor||Q.value.borderColor||"#ffffff",ie=k.value.styleIconColor||Q.value.iconColor||"#ffffff";return Cn({type:re||"circle",backgroundShape:ue,backgroundColor:ee,borderColor:W,iconColor:ie,size:"100"})}),F=V(()=>{let re,ue,ee,W,ie;return Z.value&&a.location?(re=a.location.resolvedStyleType||a.location.ResolvedStyleType,ue=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",ee=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",W=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",ie=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(re=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:Q.value.type,ue=k.value.styleBackgroundShape||Q.value.backgroundShape||"circle",ee=k.value.styleBackgroundColor||Q.value.backgroundColor||"#667eea",W=k.value.styleBorderColor||Q.value.borderColor||"#ffffff",ie=k.value.styleIconColor||Q.value.iconColor||"#ffffff"),Cn({type:re||"circle",backgroundShape:ue,backgroundColor:ee,borderColor:W,iconColor:ie,size:"100",outputSize:28})}),K=V(()=>{const re=!!k.value.checkpointTerm,ue=!!k.value.peopleTerm;return re&&ue?`${Ya("checkpoint",k.value.checkpointTerm,k.value.peopleTerm)}, ${k.value.peopleTerm}`:re?Ya("checkpoint",k.value.checkpointTerm,E.value):ue?k.value.peopleTerm:"Using defaults"}),fe=V(()=>te.value?null:G.value[Y.value+1]),he=V(()=>fe.value?`${fe.value.label}...`:""),Re=T(!1),et=T(null);Ze(()=>a.location,re=>{if(re){const ue=re.id||"new";if(et.value!==ue){et.value=ue,Re.value=!0;let ee="",W="";re.startTime&&(ee=Bl(re.startTime)),re.endTime&&(W=Bl(re.endTime)),k.value={id:re.id||null,name:re.name||"",description:re.description||"",what3Words:re.what3Words||"",latitude:re.latitude||0,longitude:re.longitude||0,requiredMarshals:re.requiredMarshals||1,useCustomTimes:!!(re.startTime||re.endTime),startTime:ee,endTime:W,areaIds:re.areaIds||re.AreaIds||[],styleType:re.styleType||re.StyleType||"default",styleColor:re.styleColor||re.StyleColor||"",styleBackgroundShape:re.styleBackgroundShape||re.StyleBackgroundShape||"",styleBackgroundColor:re.styleBackgroundColor||re.StyleBackgroundColor||"",styleBorderColor:re.styleBorderColor||re.StyleBorderColor||"",styleIconColor:re.styleIconColor||re.StyleIconColor||"",styleSize:re.styleSize||re.StyleSize||"",styleMapRotation:re.styleMapRotation??re.StyleMapRotation??"",peopleTerm:re.peopleTerm||"",checkpointTerm:re.checkpointTerm||"",isDynamic:re.isDynamic||!1,locationUpdateScopeConfigurations:re.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ze(()=>a.show,re=>{re?(i.value="details",r.value=!1,f.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(et.value=null,Re.value=!1)});const Xe=re=>{k.value=re},He=()=>{s("update:isDirty",!0)},Ke=()=>{r.value=!r.value,s("move-location",{isMoving:r.value,formData:{...k.value}})},ye=re=>{f.value=re,He()},Ve=()=>{fe.value&&(i.value=fe.value.value)},me=()=>{const re={...k.value,startTime:k.value.useCustomTimes&&k.value.startTime?new Date(k.value.startTime).toISOString():null,endTime:k.value.useCustomTimes&&k.value.endTime?new Date(k.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:f.value||[],pendingAssignments:a.assignments.filter(ue=>ue.isPending).map(ue=>({marshalId:ue.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",re)},xe=()=>{a.location&&a.location.id&&s("delete",a.location.id)},De=re=>{s("remove-assignment",re)},q=()=>{s("open-assign-modal")},J=re=>{s("select-marshal",re)},ve=()=>{s("close")},Se=(re,ue)=>{k.value[re]=ue,He()};return(re,ue)=>(v(),qe(Gt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ve},{header:ze(()=>[l("h2",m4,[F.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:F.value},null,8,g4)):M("",!0),Je(" "+C(P.value),1)])]),"tab-header":ze(()=>[Ee(Wi,{modelValue:i.value,"onUpdate:modelValue":ue[0]||(ue[0]=ee=>i.value=ee),tabs:G.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[l("div",z4,[l("div",H4,[Z.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:xe,class:"btn btn-danger"}," Delete ")):M("",!0),!Z.value&&!te.value?(v(),m("button",{key:1,type:"button",onClick:Ve,class:"btn btn-secondary mobile-only"},C(he.value),1)):M("",!0)]),l("button",{type:"button",onClick:me,class:"btn btn-success"}," Save ")])]),default:ze(()=>[i.value==="details"?(v(),qe(QT,{key:0,form:k.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":$.value,"area-term-plural":N.value,"checkpoint-term-singular":x.value,"people-term-plural":E.value,"onUpdate:form":Xe,onInput:He,onSave:me},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):M("",!0),i.value==="location"?(v(),qe(aA,{key:1,form:k.value,"is-moving":r.value,"checkpoint-term-singular":x.value,"people-term-plural":E.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":Z.value,"onUpdate:form":Xe,onInput:He,onSave:me,onMoveLocation:Ke},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):M("",!0),i.value==="marshals"?(v(),qe(MA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:k.value,assignments:e.assignments,"people-term":E.value,"person-term":R.value,"checkpoint-term":x.value,"read-only":e.lockedFromMarshal,"onUpdate:form":Xe,onInput:He,onRemoveAssignment:De,onOpenAssignModal:q,onSelectMarshal:J},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):M("",!0),i.value==="checklists"&&Z.value?(v(),qe(Xv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:f.value,"onUpdate:modelValue":ue[1]||(ue[1]=ee=>f.value=ee),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:ye},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):M("",!0),i.value==="checklists"?(v(),qe(qE,{key:4,modelValue:p.value,"onUpdate:modelValue":ue[2]||(ue[2]=ee=>p.value=ee),"all-checklist-items":e.allChecklistItems,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":x.value,onChange:He},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="notes"&&Z.value?(v(),qe(gc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):M("",!0),i.value==="notes"?(v(),qe(v4,{key:6,modelValue:g.value,"onUpdate:modelValue":ue[3]||(ue[3]=ee=>g.value=ee),"all-notes":e.notes,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":x.value,onChange:He},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="appearance"?(v(),m("div",y4,[l("div",k4,[l("button",{type:"button",class:pe(["accordion-header",{expanded:_.value.iconStyle}]),onClick:ue[4]||(ue[4]=ee=>w("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:ne.value},null,8,_4),l("span",b4,C(x.value)+" marker style",1),l("span",w4,C(_.value.iconStyle?"":""),1)],2),_.value.iconStyle?(v(),m("div",C4,[l("p",L4," Choose a custom icon for this "+C(D.value)+", or leave as Default to inherit from "+C(B.value)+" or event settings. ",1),Ee(ad,{"style-type":k.value.styleType||"default","style-color":k.value.styleColor||"","style-background-shape":k.value.styleBackgroundShape||"","style-background-color":k.value.styleBackgroundColor||"","style-border-color":k.value.styleBorderColor||"","style-icon-color":k.value.styleIconColor||"","style-size":k.value.styleSize||"","style-map-rotation":k.value.styleMapRotation??"","inherited-style-type":Q.value.type,"inherited-style-color":Q.value.color,"inherited-background-shape":Q.value.backgroundShape||"","inherited-background-color":Q.value.backgroundColor||Q.value.color||"","inherited-border-color":Q.value.borderColor||"","inherited-icon-color":Q.value.iconColor||"","inherited-size":Q.value.size||"","inherited-map-rotation":Q.value.mapRotation??"","default-label":X.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ue[5]||(ue[5]=ee=>Se("styleType",ee)),"onUpdate:styleColor":ue[6]||(ue[6]=ee=>Se("styleColor",ee)),"onUpdate:styleBackgroundShape":ue[7]||(ue[7]=ee=>Se("styleBackgroundShape",ee)),"onUpdate:styleBackgroundColor":ue[8]||(ue[8]=ee=>Se("styleBackgroundColor",ee)),"onUpdate:styleBorderColor":ue[9]||(ue[9]=ee=>Se("styleBorderColor",ee)),"onUpdate:styleIconColor":ue[10]||(ue[10]=ee=>Se("styleIconColor",ee)),"onUpdate:styleSize":ue[11]||(ue[11]=ee=>Se("styleSize",ee)),"onUpdate:styleMapRotation":ue[12]||(ue[12]=ee=>Se("styleMapRotation",ee))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):M("",!0)]),l("div",S4,[l("button",{type:"button",class:pe(["accordion-header",{expanded:_.value.terminology}]),onClick:ue[13]||(ue[13]=ee=>w("terminology"))},[ue[17]||(ue[17]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ue[18]||(ue[18]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",x4,C(K.value),1),l("span",I4,C(_.value.terminology?"":""),1)],2),_.value.terminology?(v(),m("div",$4,[l("p",T4," Customise what this "+C(D.value)+" and its "+C(E.value.toLowerCase())+" are called. ",1),l("div",M4,[l("div",A4,[l("label",null,"What is this "+C(D.value)+" called?",1),l("select",{value:k.value.checkpointTerm,class:"form-input",onChange:ue[14]||(ue[14]=ee=>{Xe({...k.value,checkpointTerm:ee.target.value}),He()})},[l("option",P4,"Use "+C(B.value)+" default ("+C(x.value)+")",1),ue[19]||(ue[19]=l("option",{value:"Vehicle"},"Vehicle",-1)),ue[20]||(ue[20]=l("option",{value:"Car"},"Car",-1)),ue[21]||(ue[21]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),m(Ie,null,Ne(O(Os).checkpoint,ee=>(v(),m("option",{key:ee,value:ee},C(ee),9,D4))),128))],40,E4)]),l("div",R4,[l("label",null,"What are "+C(E.value.toLowerCase())+" called here?",1),l("select",{value:k.value.peopleTerm,class:"form-input",onChange:ue[15]||(ue[15]=ee=>{Xe({...k.value,peopleTerm:ee.target.value}),He()})},[l("option",B4,"Use "+C(B.value)+" default ("+C(S.value)+")",1),(v(!0),m(Ie,null,Ne(O(Os).people,ee=>(v(),m("option",{key:ee,value:ee},C(ee),9,N4))),128))],40,O4)])])])):M("",!0)])])):M("",!0),i.value==="incidents"?(v(),m("div",F4,[l("div",U4,[(v(!0),m(Ie,null,Ne(e.incidents,ee=>(v(),qe(Wl,{key:ee.incidentId,incident:ee,onSelect:ue[16]||(ue[16]=W=>re.$emit("select-incident",W))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},G4=je(V4,[["__scopeId","data-v-61f1a81f"]]),j4={class:"tab-content"},Z4={key:0,class:"error-banner"},q4=["value"],W4={key:0,class:"field-error"},K4={class:"contact-row"},J4=["value"],Y4={key:0,class:"field-error"},X4=["value"],Q4={key:0,class:"field-error"},e3=["value"],t3={key:0,class:"field-error"},n3={key:1,class:"magic-link-section"},o3={key:0,class:"loading-text"},s3={key:1,class:"magic-link-container"},a3={class:"magic-link-row"},i3=["value"],l3={key:0,class:"error-text"},r3={key:1,class:"magic-link-actions"},c3=["disabled"],u3={key:2,class:"success-text"},d3={key:3,class:"error-text"},h3={key:2,class:"error-text"},f3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=T(null),r=T(null),u=T(null),d=T(null),f=T(""),p=T(!1),g=T(!1),k=T(""),y=T(!1),_=T(!1),w=T(!1),S=T(""),E=($,B)=>{s("update:form",{...a.form,[$]:B}),s("input")},A=async()=>{if(!(!a.eventId||!a.marshalId)){g.value=!0,k.value="";try{const $=await ms.getMagicLink(a.eventId,a.marshalId);f.value=$.data.magicLink,p.value=$.data.hasEmail}catch($){console.error("Failed to fetch magic link:",$),k.value="Failed to load login link"}finally{g.value=!1}}},x=T(""),D=async()=>{x.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(f.value),y.value=!0,setTimeout(()=>{y.value=!1},2e3);return}}catch($){console.warn("Clipboard API failed, trying fallback:",$)}try{const $=document.createElement("textarea");$.value=f.value,$.style.position="fixed",$.style.left="-9999px",$.style.top="0",document.body.appendChild($),$.focus(),$.select();const B=document.execCommand("copy");document.body.removeChild($),B?(y.value=!0,setTimeout(()=>{y.value=!1},2e3)):(x.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3))}catch($){console.error("Fallback copy failed:",$),x.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3)}},R=async()=>{if(!(!a.eventId||!a.marshalId)){_.value=!0,w.value=!1,S.value="";try{await ms.sendMagicLink(a.eventId,a.marshalId),w.value=!0,setTimeout(()=>{w.value=!1},3e3)}catch($){console.error("Failed to send email:",$),S.value=$.response?.data?.message||"Failed to send email"}finally{_.value=!1}}};return Ze(()=>a.marshalId,$=>{$?A():(f.value="",p.value=!1)},{immediate:!0}),t({focusField:$=>{cn(()=>{const N={name:i,email:r,phoneNumber:u,notes:d}[$];N?.value&&(N.value.focus(),N.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),($,B)=>(v(),m("div",j4,[e.validationErrors.general?(v(),m("div",Z4,C(e.validationErrors.general),1)):M("",!0),l("div",{class:pe(["form-group",{"has-error":e.validationErrors.name}])},[B[5]||(B[5]=l("label",null,"Name *",-1)),l("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:B[0]||(B[0]=N=>E("name",N.target.value)),type:"text",required:"",class:pe(["form-input",{"input-error":e.validationErrors.name}])},null,42,q4),e.validationErrors.name?(v(),m("span",W4,C(e.validationErrors.name),1)):M("",!0)],2),l("div",K4,[l("div",{class:pe(["form-group contact-email",{"has-error":e.validationErrors.email}])},[B[6]||(B[6]=l("label",null,"Email",-1)),l("input",{ref_key:"emailInputRef",ref:r,value:e.form.email,onInput:B[1]||(B[1]=N=>E("email",N.target.value)),type:"email",class:pe(["form-input",{"input-error":e.validationErrors.email}])},null,42,J4),e.validationErrors.email?(v(),m("span",Y4,C(e.validationErrors.email),1)):M("",!0)],2),l("div",{class:pe(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[B[7]||(B[7]=l("label",null,"Phone number",-1)),l("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:B[2]||(B[2]=N=>E("phoneNumber",N.target.value)),type:"tel",class:pe(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,X4),e.validationErrors.phoneNumber?(v(),m("span",Q4,C(e.validationErrors.phoneNumber),1)):M("",!0)],2)]),l("div",{class:pe(["form-group",{"has-error":e.validationErrors.notes}])},[B[8]||(B[8]=l("label",null,"Notes",-1)),l("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:B[3]||(B[3]=N=>E("notes",N.target.value)),class:pe(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,e3),e.validationErrors.notes?(v(),m("span",t3,C(e.validationErrors.notes),1)):M("",!0)],2),e.marshalId?(v(),m("div",n3,[B[9]||(B[9]=l("label",null,"Login link",-1)),B[10]||(B[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",o3,"Loading link...")):f.value?(v(),m("div",s3,[l("div",a3,[l("input",{type:"text",value:f.value,readonly:"",class:"form-input magic-link-input",onFocus:B[4]||(B[4]=N=>N.target.select())},null,40,i3),l("button",{type:"button",class:"btn btn-secondary",onClick:D},C(y.value?"Copied!":"Copy link"),1)]),x.value?(v(),m("p",l3,C(x.value),1)):M("",!0),p.value?(v(),m("div",r3,[l("button",{type:"button",class:"btn btn-primary",disabled:_.value,onClick:R},C(_.value?"Sending...":"Send via email"),9,c3)])):M("",!0),w.value?(v(),m("p",u3,"Email sent successfully!")):M("",!0),S.value?(v(),m("p",d3,C(S.value),1)):M("",!0)])):k.value?(v(),m("div",h3,C(k.value),1)):M("",!0)])):M("",!0)]))}},p3=je(f3,[["__scopeId","data-v-16ffb81b"]]),v3={class:"card-header"},m3={class:"checkpoint-name-row"},g3=["innerHTML"],y3={class:"checkpoint-name"},k3={key:0,class:"checkpoint-description"},_3={key:0,class:"card-areas"},b3={key:1,class:"card-check-in"},w3={key:0,class:"check-in-time"},C3={key:0,class:"check-in-method"},L3={key:1,class:"unsaved-indicator"},S3={key:2,class:"card-locked"},x3={class:"locked-badge"},I3={key:3,class:"card-badge"},$3={key:4,class:"card-badge"},T3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),r=V(()=>i.value.map(y=>{const _=a.areas.find(w=>w.id===y);return _?_.name:null}).filter(Boolean)),u=V(()=>i.value.map(y=>{const _=a.areas.find(w=>w.id===y);return _?_.color:"#999"})),d=V(()=>{if(!a.location)return"#667eea";const y=a.location,_=y.resolvedStyleBackgroundColor||y.ResolvedStyleBackgroundColor||y.resolvedStyleColor||y.ResolvedStyleColor;if(_)return _;if(i.value.length>0){const w=a.areas.find(S=>S.id===i.value[0]);if(w)return w.color}return"#667eea"}),f=V(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const y=a.location,_=y.resolvedStyleType||y.ResolvedStyleType,w=y.resolvedStyleBackgroundColor||y.ResolvedStyleBackgroundColor||y.resolvedStyleColor||y.ResolvedStyleColor,S=y.resolvedStyleBorderColor||y.ResolvedStyleBorderColor,E=y.resolvedStyleIconColor||y.ResolvedStyleIconColor,A=y.resolvedStyleBackgroundShape||y.ResolvedStyleBackgroundShape;return _&&_!=="default"||w||S||E||A&&A!=="circle"?Cn({type:_||"circle",backgroundShape:A||"circle",backgroundColor:w||"#667eea",borderColor:S||"#ffffff",iconColor:E||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),p=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=V(()=>{const{checkedInBy:y,checkInMethod:_,marshalName:w}=a.assignment;return y&&y!==w?y:_||""}),k=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&s("click",a.assignment)};return(y,_)=>(v(),m("div",{class:pe(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:Qe({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[l("div",v3,[l("div",{class:"card-title",onClick:k},[l("span",m3,[l("span",{class:"checkpoint-icon",innerHTML:f.value},null,8,g3),l("span",y3,C(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",k3,"  "+C(e.assignment.locationDescription),1)):M("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:_[0]||(_[0]=rt(w=>y.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=rt(w=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)]),r.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",_3,[(v(!0),m(Ie,null,Ne(r.value,(w,S)=>(v(),m("span",{key:S,class:"area-badge",style:Qe({backgroundColor:u.value[S]})},C(w),5))),128))])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",b3,[l("button",{class:pe(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:_[2]||(_[2]=w=>y.$emit("toggle-check-in",e.assignment))},[..._[3]||(_[3]=[l("span",{class:"toggle-icon"},"",-1),l("span",{class:"toggle-label-wrapper"},[l("span",{class:"toggle-label toggle-label-check-in"},"Check in"),l("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",w3,[Je(C(p(e.assignment.checkInTime))+" ",1),g.value?(v(),m("span",C3,"("+C(g.value)+")",1)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",L3," Unsaved ")):M("",!0)])):M("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",S3,[l("span",x3,"Viewing from this "+C(O(o).checkpoint),1)])):M("",!0),e.assignment.isPending?(v(),m("div",I3,[..._[4]||(_[4]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",$3,[..._[5]||(_[5]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],6))}},M3=je(T3,[["__scopeId","data-v-df38bf23"]]),A3={class:"tab-content"},E3={key:0,class:"read-only-notice"},P3={class:"section-title"},D3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},R3={value:""},O3=["value"],B3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,{pendingCheckInChanges:r,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=Yv(()=>i("input")),f=T(""),p=T(new Set),g=V(()=>s.assignments?.length||0),k=R=>s.allLocations&&s.allLocations.find(H=>H.id===R)||null,y=V(()=>[...s.assignments].sort((R,H)=>(R.locationName||"").localeCompare(H.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),_=R=>p.value.has(R),w=R=>{R.isPending||i("select-checkpoint",R)},S=R=>{d(R)},E=R=>{R.isPending?i("remove-assignment",R):(p.value.add(R.id),i("input"))},A=R=>{p.value.delete(R.id),i("input")},x=V(()=>{const R=[...s.availableLocations];return R.sort((H,$)=>H.name.localeCompare($.name,void 0,{numeric:!0,sensitivity:"base"})),R}),D=()=>{f.value&&(i("assign-to-location",f.value),f.value="")};return t({pendingCheckInChanges:r,clearPendingChanges:()=>{r.value.clear(),p.value.clear(),f.value=""},getPendingChanges:()=>Array.from(r.value.entries()).map(([R,H])=>({assignmentId:R,shouldBeCheckedIn:H})),getMarkedForRemoval:()=>Array.from(p.value)}),(R,H)=>(v(),m("div",A3,[e.lockedCheckpointId?(v(),m("div",E3," Viewing from "+C(O(a).checkpoint)+" - "+C(O(a).checkpoints)+" cannot be modified here. ",1)):M("",!0),l("h3",P3,"Assigned "+C(O(a).checkpoints)+" ("+C(g.value)+")",1),Ee(ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${O(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${O(a).person} to ${O(a).checkpoints}.`},{default:ze(()=>[(v(!0),m(Ie,null,Ne(y.value,$=>(v(),qe(M3,{key:$.id,assignment:$,location:k($.locationId),areas:e.areas,"effective-check-in-status":O(u)($),"has-unsaved-changes":O(r).has($.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":_($.id),onClick:w,onToggleCheckIn:S,onRemove:E,onUndoRemove:A},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&x.value.length>0?(v(),m("div",D3,[l("label",null,"Assign to "+C(O(a).checkpoint),1),Ue(l("select",{"onUpdate:modelValue":H[0]||(H[0]=$=>f.value=$),class:"form-input",onChange:D},[l("option",R3,"Select a "+C(O(a).checkpoint)+"...",1),(v(!0),m(Ie,null,Ne(x.value,$=>(v(),m("option",{key:$.id,value:$.id},[Je(C($.name),1),$.description?(v(),m(Ie,{key:0},[Je(" - "+C($.description),1)],64)):M("",!0)],8,O3))),128))],544),[[Bn,f.value]])])):M("",!0)]))}},N3=je(B3,[["__scopeId","data-v-f60fc06e"]]),F3={class:"marshal-checklist-view"},U3={key:0,class:"loading-state"},z3={key:1,class:"error-state"},H3={key:2,class:"empty-state"},V3={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,r=T([]),u=T(!1),d=T(null),f=T(new Map),p=V(()=>r.value.map(w=>{const S=f.value.get(w.itemId),E=S!==void 0?S.complete:w.isCompleted,A=S!==void 0&&S.complete!==w.isCompleted;return{...w,localIsCompleted:E,isModified:A}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const w=await Rt.getMarshalChecklist(s.eventId,s.marshalId);if(r.value=w.data||[],s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(E=>{S.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),f.value=S}}catch(w){console.error("Failed to load checklist:",w),d.value=w.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},k=w=>{const S=f.value.get(w.itemId),E=S!==void 0?S.complete:w.isCompleted;f.value.set(w.itemId,{complete:!E,contextType:w.completionContextType,contextId:w.completionContextId}),y()},y=()=>{const w=[];for(const[S,E]of f.value.entries()){const A=r.value.find(x=>x.itemId===S);A&&E.complete!==A.isCompleted&&w.push({itemId:S,complete:E.complete,contextType:E.contextType,contextId:E.contextId})}i("update:modelValue",w),i("change",w)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const w=new Map;s.modelValue.forEach(S=>{w.set(S.itemId,{complete:S.complete,contextType:S.contextType,contextId:S.contextId})}),f.value=w}},loadChecklist:g}),Ze(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(w,S)=>(v(),m("div",F3,[u.value?(v(),m("div",U3," Loading checklist... ")):d.value?(v(),m("div",z3,[l("p",null,C(d.value),1),l("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):r.value.length===0?(v(),m("div",H3,[l("p",null,"No checklist items for this "+C(O(a).person)+".",1)])):(v(),qe(id,{key:3,items:p.value,locations:e.locations,areas:e.areas,onToggleComplete:k},null,8,["items","locations","areas"]))]))}},G3=je(V3,[["__scopeId","data-v-7460304c"]]),j3={class:"checklist-preview"},Z3={class:"preview-actions"},q3={class:"preview-header"},W3={key:0,class:"add-item-form"},K3=["placeholder"],J3=["disabled"],Y3={key:1,class:"pending-items"},X3={class:"item-content"},Q3={class:"item-header"},eP={class:"item-text"},tP={class:"item-scope"},nP=["onClick"],oP={key:2,class:"empty-state"},sP={key:0,class:"help-text"},aP={key:3,class:"checklist-items"},iP={class:"item-content"},lP={class:"item-header"},rP={class:"item-text"},cP={class:"item-scope"},uP=["title"],dP={key:0,class:"item-context"},hP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=T(!1),r=T(""),u=T([...a.modelValue]);Ze(()=>a.modelValue,A=>{u.value=[...A]},{deep:!0});const d=()=>{r.value.trim()&&(u.value.push({text:r.value.trim(),isNew:!0}),r.value="",i.value=!1,p())},f=A=>{u.value.splice(A,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=V(()=>{const A=new Set;for(const x of a.pendingLocationIds){const D=a.allLocations.find(R=>R.id===x);D&&(D.areaIds||D.AreaIds||[]).forEach(H=>A.add(H))}return[...A]}),k=A=>{const x=A.scope,D=A.itemType,R=A.ids||[];return x==="SpecificPeople"&&D==="Marshal"?R.includes("ALL_MARSHALS"):(x==="EveryoneAtCheckpoints"||x==="OnePerCheckpoint")&&D==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(H=>a.pendingLocationIds.includes(H)):x==="OnePerCheckpoint"&&D==="Area"?R.includes("ALL_AREAS")?!0:R.some(H=>g.value.includes(H)):(x==="EveryoneInAreas"||x==="OnePerArea"||x==="EveryAreaLead"||x==="OneLeadPerArea")&&D==="Area"?R.includes("ALL_AREAS")?!0:R.some(H=>g.value.includes(H)):!1},y=V(()=>a.allChecklistItems.filter(A=>A.scopeConfigurations&&A.scopeConfigurations.length>0?A.scopeConfigurations.some(x=>k(x)):!1)),_=A=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[A]||A,w=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"Unknown";const x=A.scopeConfigurations.find(R=>k(R));if(!x)return _(A.scopeConfigurations[0].scope);const D=x.ids||[];return D.includes("ALL_MARSHALS")?"Everyone":D.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:D.includes("ALL_AREAS")?`All ${o.value.areas}`:_(x.scope)},S=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"";const x=A.scopeConfigurations.find(R=>k(R));return x&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[x.scope]||""},E=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return null;const x=A.scopeConfigurations.find(H=>k(H));if(!x)return null;const D=x.itemType,R=x.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if(D==="Checkpoint"){const H=a.allLocations.filter($=>R.includes($.id)&&a.pendingLocationIds.includes($.id)).map($=>$.name);if(H.length>0)return`At: ${H.join(", ")}`}if(D==="Area"){const H=a.areas.filter($=>R.includes($.id)&&g.value.includes($.id)).map($=>$.name);if(H.length>0)return`In: ${H.join(", ")}`}return null};return(A,x)=>(v(),m("div",j3,[l("div",Z3,[l("p",q3,C(e.isEditing?`Add new ${O(o).checklist} for this ${O(o).person}:`:`${O(o).checklists} that will apply to this ${O(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=D=>i.value=!i.value)},C(i.value?"Cancel":`Add ${O(o).checklist}`),1)]),i.value?(v(),m("div",W3,[Ue(l("input",{"onUpdate:modelValue":x[1]||(x[1]=D=>r.value=D),type:"text",placeholder:`Enter ${O(o).checklist} text...`,class:"add-item-input",onKeyup:ps(d,["enter"])},null,40,K3),[[st,r.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim(),onClick:d}," Add ",8,J3)])):M("",!0),u.value.length>0?(v(),m("div",Y3,[(v(!0),m(Ie,null,Ne(u.value,(D,R)=>(v(),m("div",{key:`pending-${R}`,class:"checklist-item pending"},[x[3]||(x[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",X3,[l("div",Q3,[l("div",eP,C(D.text),1),l("div",tP,[x[2]||(x[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:H=>f(R),title:"Remove"},"  ",8,nP)])])])]))),128))])):M("",!0),!e.isEditing&&y.value.length===0&&u.value.length===0?(v(),m("div",oP,[l("p",null,"No "+C(O(o).checklists)+" will apply based on the current "+C(O(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",sP," Assign "+C(O(o).checkpoints)+" to see relevant "+C(O(o).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&y.value.length>0?(v(),m("div",aP,[(v(!0),m(Ie,null,Ne(y.value,D=>(v(),m("div",{key:D.id,class:"checklist-item"},[x[4]||(x[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",iP,[l("div",lP,[l("div",rP,C(D.text),1),l("div",cP,[l("span",{class:"scope-pill",title:S(D)},C(w(D)),9,uP)])]),E(D)?(v(),m("div",dP,C(E(D)),1)):M("",!0)])]))),128))])):M("",!0)]))}},fP=je(hP,[["__scopeId","data-v-6deaacc2"]]),pP={class:"notes-preview"},vP={class:"preview-actions"},mP={class:"preview-header"},gP={key:0,class:"add-item-form"},yP={class:"add-form-fields"},kP=["disabled"],_P={key:1,class:"pending-items"},bP={class:"note-header"},wP={class:"note-title"},CP={class:"note-actions"},LP=["onClick"],SP={key:0,class:"note-content"},xP={key:2,class:"empty-state"},IP={key:0,class:"help-text"},$P={key:3,class:"notes-list"},TP={class:"note-header"},MP={class:"note-title"},AP=["title"],EP={key:0,class:"note-content"},PP={key:1,class:"note-context"},DP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=T(!1),r=T(""),u=T(""),d=T([...a.modelValue]);Ze(()=>a.modelValue,x=>{d.value=[...x]},{deep:!0});const f=()=>{!r.value.trim()&&!u.value.trim()||(d.value.push({title:r.value.trim(),content:u.value.trim(),isNew:!0}),r.value="",u.value="",i.value=!1,g())},p=x=>{d.value.splice(x,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},k=V(()=>{const x=new Set;for(const D of a.pendingLocationIds){const R=a.allLocations.find(H=>H.id===D);R&&(R.areaIds||R.AreaIds||[]).forEach($=>x.add($))}return[...x]}),y=x=>{const D=x.scope,R=x.itemType,H=x.ids||[];return D==="SpecificPeople"&&R==="Marshal"?H.includes("ALL_MARSHALS"):D==="EveryoneAtCheckpoints"&&R==="Checkpoint"?H.includes("ALL_CHECKPOINTS")?!0:H.some($=>a.pendingLocationIds.includes($)):D==="EveryoneInAreas"&&R==="Area"?H.includes("ALL_AREAS")?!0:H.some($=>k.value.includes($)):!1},_=V(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>y(D)):!1)),w=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(H=>y(H));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_MARSHALS")?"Everyone":R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(H=>y(H));return D&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find($=>y($));if(!D)return null;const R=D.itemType,H=D.ids||[];if(H.includes("ALL_MARSHALS")||H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(R==="Checkpoint"){const $=a.allLocations.filter(B=>H.includes(B.id)&&a.pendingLocationIds.includes(B.id)).map(B=>B.name);if($.length>0)return`At: ${$.join(", ")}`}if(R==="Area"){const $=a.areas.filter(B=>H.includes(B.id)&&k.value.includes(B.id)).map(B=>B.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(x,D)=>(v(),m("div",pP,[l("div",vP,[l("p",mP,C(e.isEditing?`Add new note for this ${O(o).person}:`:`Notes that will be visible to this ${O(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>i.value=!i.value)},C(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",gP,[l("div",yP,[Ue(l("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>r.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,r.value]]),Ue(l("textarea",{"onUpdate:modelValue":D[2]||(D[2]=R=>u.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim()&&!u.value.trim(),onClick:f}," Add ",8,kP)])):M("",!0),d.value.length>0?(v(),m("div",_P,[(v(!0),m(Ie,null,Ne(d.value,(R,H)=>(v(),m("div",{key:`pending-${H}`,class:"note-item pending"},[l("div",bP,[l("span",wP,C(R.title||"Untitled"),1),l("div",CP,[D[3]||(D[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:$=>p(H),title:"Remove"},"  ",8,LP)])]),R.content?(v(),m("div",SP,C(R.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&d.value.length===0?(v(),m("div",xP,[l("p",null,"No notes will be visible based on the current "+C(O(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",IP," Assign "+C(O(o).checkpoints)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",$P,[(v(!0),m(Ie,null,Ne(_.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[l("div",TP,[l("span",MP,C(R.title||"Untitled"),1),l("span",{class:"scope-pill",title:E(R)},C(S(R)),9,AP)]),R.content?(v(),m("div",EP,C(R.content),1)):M("",!0),A(R)?(v(),m("div",PP,C(A(R)),1)):M("",!0)]))),128))])):M("",!0)]))}},RP=je(DP,[["__scopeId","data-v-e8e0946a"]]),OP={key:6,class:"tab-content incidents-tab"},BP={class:"incidents-list"},NP={class:"custom-footer"},FP={class:"footer-left"},UP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=e,r=o,u=T("details"),d=T(null),f=T(null),p=T(null),g=T([]),k=T([]),y=T([]),_=T([]),w=T({name:"",email:"",phoneNumber:"",notes:""}),S=V(()=>{const he=i.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,Re=w.value.name?.trim();return Re?`${he} - ${Re}`:he}),E=V(()=>{const he=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&he.push({value:"incidents",label:"Incidents",icon:"incidents"}),he}),A=V(()=>E.value.findIndex(he=>he.value===u.value)),x=V(()=>A.value===E.value.length-1),D=V(()=>x.value?null:E.value[A.value+1]),R=V(()=>D.value?`${D.value.label}...`:""),H=V(()=>k.value.map(he=>he.locationId)),$=V(()=>i.isEditing?i.assignments:k.value.map(he=>({id:`pending-${he.locationId}`,locationId:he.locationId,locationName:i.allLocations.find(Re=>Re.id===he.locationId)?.name||"Unknown",isPending:!0}))),B=V(()=>{if(i.isEditing)return i.availableLocations;const he=k.value.map(Re=>Re.locationId);return i.allLocations.filter(Re=>!he.includes(Re.id))});Ze(()=>i.marshal,he=>{he?w.value={name:he.name||"",email:he.email||"",phoneNumber:he.phoneNumber||"",notes:he.notes||""}:w.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ze(()=>i.show,he=>{he&&(u.value="details",g.value=[],k.value=[],y.value=[],_.value=[],i.isEditing||(w.value={name:"",email:"",phoneNumber:"",notes:""}),f.value?.clearPendingChanges&&f.value.clearPendingChanges(),p.value?.resetLocalState&&p.value.resetLocalState())});const N=he=>{w.value=he},Z=()=>{r("update:isDirty",!0)},P=()=>{r("update:isDirty",!0)},G=()=>{D.value&&(u.value=D.value.value)},Y=()=>{const he={...w.value,checkInChanges:f.value?.getPendingChanges?.()||[],assignmentsToRemove:f.value?.getMarkedForRemoval?.()||[],checklistChanges:g.value||[],pendingAssignments:i.isEditing?[]:k.value,pendingNewChecklistItems:y.value,pendingNewNotes:_.value};r("save",he)},te=()=>{r("delete")},Q=he=>{!i.isEditing&&he.isPending?k.value=k.value.filter(Re=>Re.locationId!==he.locationId):r("remove-assignment",he)},X=he=>{i.isEditing?r("assign-to-location",he):(k.value.push({locationId:he}),r("update:isDirty",!0))},ne=he=>{r("select-checkpoint",he)},F=()=>{r("close")};return t({switchToTab:he=>{u.value=he},focusField:he=>{d.value?.focusField&&d.value.focusField(he)}}),(he,Re)=>(v(),qe(Gt,{show:e.show,title:S.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:F},{"tab-header":ze(()=>[Ee(Wi,{modelValue:u.value,"onUpdate:modelValue":Re[0]||(Re[0]=et=>u.value=et),tabs:E.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[l("div",NP,[l("div",FP,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:te,class:"btn btn-danger"}," Delete ")):M("",!0),!e.isEditing&&!x.value?(v(),m("button",{key:1,type:"button",onClick:G,class:"btn btn-secondary mobile-only"},C(R.value),1)):M("",!0)]),l("button",{type:"button",onClick:Y,class:"btn btn-success"}," Save ")])]),default:ze(()=>[u.value==="details"?(v(),qe(p3,{key:0,ref_key:"detailsTabRef",ref:d,form:w.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":N,onInput:Z},null,8,["form","event-id","marshal-id","validation-errors"])):M("",!0),u.value==="checkpoints"?(v(),qe(N3,{key:1,ref_key:"checkpointsTabRef",ref:f,assignments:$.value,"available-locations":B.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:Z,onRemoveAssignment:Q,onAssignToLocation:X,onSelectCheckpoint:ne},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):M("",!0),u.value==="checklists"&&e.isEditing?(v(),qe(G3,{key:2,ref_key:"checklistTabRef",ref:p,modelValue:g.value,"onUpdate:modelValue":Re[1]||(Re[1]=et=>g.value=et),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:P},null,8,["modelValue","event-id","marshal-id","locations","areas"])):M("",!0),u.value==="checklists"?(v(),qe(fP,{key:3,modelValue:y.value,"onUpdate:modelValue":Re[2]||(Re[2]=et=>y.value=et),"all-checklist-items":e.allChecklistItems,"pending-location-ids":H.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:Z},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="notes"&&e.isEditing?(v(),qe(gc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):M("",!0),u.value==="notes"?(v(),qe(RP,{key:5,modelValue:_.value,"onUpdate:modelValue":Re[3]||(Re[3]=et=>_.value=et),"all-notes":e.eventNotes,"pending-location-ids":H.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:Z},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="incidents"?(v(),m("div",OP,[l("div",BP,[(v(!0),m(Ie,null,Ne(e.incidents,et=>(v(),qe(Wl,{key:et.incidentId,incident:et,onSelect:Re[4]||(Re[4]=Xe=>he.$emit("select-incident",Xe))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty","z-index"]))}},zP=je(UP,[["__scopeId","data-v-dd9a44f3"]]),HP={class:"locations-list"},VP={class:"conflict-actions"},GP={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=t,i=u=>{s("choice",u)},r=()=>{s("close")};return(u,d)=>(v(),qe(Gt,{show:e.show,title:`${O(o).person} already assigned`,size:"medium","z-index":1100,onClose:r},{actions:ze(()=>[l("div",VP,[l("button",{onClick:d[0]||(d[0]=f=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+C(O(a).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=f=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=f=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=f=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:ze(()=>[l("p",null,[l("strong",null,C(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),l("ul",HP,[(v(!0),m(Ie,null,Ne(e.conflictData.locations,f=>(v(),m("li",{key:f},C(f),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},jP=je(GP,[["__scopeId","data-v-997e8aaa"]]),ZP={key:0,class:"assign-marshal-section"},qP={value:""},WP=["value"],KP=["disabled"],JP={key:1,class:"assign-marshal-section create-mode"},YP={class:"form-group"},XP={class:"form-group"},QP={class:"form-group"},e6={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=T(!1),r=T(""),u=T({name:"",email:"",phoneNumber:""});Ze(()=>a.show,y=>{y||(i.value=!1,r.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},f=()=>{r.value&&s("assign-existing",r.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},k=()=>{s("close")};return(y,_)=>(v(),qe(Gt,{show:e.show,title:i.value?`Create new ${O(o).person}`:`Assign ${O(o).person} to ${e.locationName}`,size:"medium",onClose:k},{actions:ze(()=>[i.value?(v(),m(Ie,{key:0},[l("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):M("",!0)]),default:ze(()=>[i.value?(v(),m("div",JP,[l("h3",null,"Create new "+C(O(o).person),1),l("div",YP,[_[5]||(_[5]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":_[1]||(_[1]=w=>u.value.name=w),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),l("div",XP,[_[6]||(_[6]=l("label",null,"Email",-1)),Ue(l("input",{"onUpdate:modelValue":_[2]||(_[2]=w=>u.value.email=w),type:"email",class:"form-input"},null,512),[[st,u.value.email]])]),l("div",QP,[_[7]||(_[7]=l("label",null,"Phone",-1)),Ue(l("input",{"onUpdate:modelValue":_[3]||(_[3]=w=>u.value.phoneNumber=w),type:"tel",class:"form-input"},null,512),[[st,u.value.phoneNumber]])])])):(v(),m("div",ZP,[l("h3",null,"Select existing "+C(O(o).person),1),Ue(l("select",{"onUpdate:modelValue":_[0]||(_[0]=w=>r.value=w),class:"form-input"},[l("option",qP,"Choose a "+C(O(o).person)+"...",1),(v(!0),m(Ie,null,Ne(e.marshals,w=>(v(),m("option",{key:w.id,value:w.id},[Je(C(w.name)+" ",1),w.assignedLocationIds&&w.assignedLocationIds.length>0?(v(),m(Ie,{key:0},[Je(" (assigned to "+C(w.assignedLocationIds.length)+" "+C(w.assignedLocationIds.length>1?O(o).checkpoints:O(o).checkpoint)+") ",1)],64)):M("",!0)],8,WP))),128))],512),[[Bn,r.value]]),l("button",{onClick:f,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!r.value}," Assign selected "+C(O(o).person),9,KP),_[4]||(_[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+C(O(o).person),1)]))]),_:1},8,["show","title"]))}},t6=je(e6,[["__scopeId","data-v-fa70b913"]]),n6={class:"shift-times-content"},o6={class:"info-text"},s6={class:"time-delta-info"},a6={class:"delta-detail"},i6={class:"delta-detail"},l6={class:"delta-summary"},r6={class:"affected-checkpoints"},c6={class:"option-selection"},u6={class:"radio-option"},d6={class:"radio-option"},h6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,r=T("shift"),u=V(()=>{const k=new Date(s.oldEventDate);return new Date(s.newEventDate)-k}),d=k=>new Date(k).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=k=>{const y=Math.abs(k),_=k>=0?"+":"-",w=Math.floor(y/(1e3*60*60*24)),S=Math.floor(y%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(y%(1e3*60*60)/(1e3*60)),A=[];return w>0&&A.push(`${w}d`),S>0&&A.push(`${S}h`),E>0&&A.push(`${E}m`),`${_}${A.join(" ")}`},p=()=>{i("confirm",{shouldShift:r.value==="shift",timeDelta:u.value})},g=()=>{i("cancel")};return(k,y)=>(v(),qe(Gt,{show:e.show,title:`Shift ${O(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:ze(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary"},C(r.value==="shift"?"Shift Times":"Keep Times"),1)]),default:ze(()=>[l("div",n6,[l("p",o6," You've changed the event date/time. Some "+C(O(a).checkpoints)+" have custom times set. ",1),l("div",s6,[y[2]||(y[2]=l("strong",null,"Event time change:",-1)),l("div",a6," Old: "+C(d(e.oldEventDate)),1),l("div",i6," New: "+C(d(e.newEventDate)),1),l("div",l6," Delta: "+C(f(u.value)),1)]),l("p",r6,[l("strong",null,C(e.affectedCheckpointsCount)+" "+C(e.affectedCheckpointsCount===1?O(a).checkpoint:O(a).checkpoints),1),y[3]||(y[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),l("div",c6,[l("label",u6,[Ue(l("input",{"onUpdate:modelValue":y[0]||(y[0]=_=>r.value=_),type:"radio",value:"shift",name:"shift-option"},null,512),[[hh,r.value]]),l("div",null,[l("strong",null,"Shift all "+C(O(a).checkpoint)+" times",1),y[4]||(y[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",d6,[Ue(l("input",{"onUpdate:modelValue":y[1]||(y[1]=_=>r.value=_),type:"radio",value:"keep",name:"shift-option"},null,512),[[hh,r.value]]),l("div",null,[l("strong",null,"Keep "+C(O(a).checkpoint)+" times unchanged",1),l("small",null,C(O(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},f6=je(h6,[["__scopeId","data-v-a6454aff"]]),p6={class:"search-section"},v6={class:"form-group"},m6={class:"suggestions-list"},g6={class:"suggestion-content"},y6={key:0,class:"suggestion-detail"},k6=["onClick"],_6={class:"suggestion-content"},b6={class:"suggestion-name"},w6={key:0,class:"suggestion-detail"},C6=["onClick"],L6={class:"suggestion-content"},S6={class:"suggestion-name"},x6={key:0,class:"suggestion-detail"},I6={key:1,class:"no-results"},$6={key:2,class:"no-results"},T6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=T(""),r=T(null),u=V(()=>a.contacts.filter($=>a.excludeContactIds.includes($.contactId)&&$.marshalId).map($=>$.marshalId)),d=V(()=>a.contacts.filter($=>$.marshalId).map($=>$.marshalId)),f=V(()=>a.contacts.filter($=>!a.excludeContactIds.includes($.contactId))),p=V(()=>a.marshals.filter($=>!u.value.includes($.id)&&!d.value.includes($.id))),g=$=>$?$.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",k=V(()=>{const $=g(i.value);return $?$.split(" ").filter(B=>B.length>0):[]}),y=($,B)=>{if(B.length===0)return{score:1,isPartial:!1};const N=g($);let Z=0;for(const P of B)N.includes(P)&&Z++;return{score:Z,isPartial:Z>0&&Z<B.length,isFullMatch:Z===B.length}},_=V(()=>{const $=k.value,B=[];return f.value.forEach(N=>{const Z=`${N.name||""} ${N.role||""}`,P=y(Z,$);($.length===0||P.score>0)&&B.push({key:`contact-${N.contactId}`,type:"contact",name:N.name,detail:N.role?H(N.role):null,data:N,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),p.value.forEach(N=>{const Z=`${N.name||""} ${N.email||""}`,P=y(Z,$);($.length===0||P.score>0)&&B.push({key:`marshal-${N.id}`,type:"marshal",name:N.name,detail:N.email||N.phoneNumber||null,data:N,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),B.sort((N,Z)=>Z.matchScore!==N.matchScore?Z.matchScore-N.matchScore:N.name.localeCompare(Z.name,void 0,{sensitivity:"base"})),B}),w=V(()=>k.value.length===0?_.value:_.value.filter($=>$.isFullMatch)),S=V(()=>k.value.length===0?[]:_.value.filter($=>$.isPartial)),E=V(()=>S.value.length>0);Ze(()=>a.show,async $=>{$&&(i.value="",await cn(),r.value?.focus())});const A=$=>{const B=a.contacts.find(N=>N.marshalId===$.id);if(B){if(a.excludeContactIds.includes(B.contactId))return;s("select-contact",B)}else s("create-from-marshal",$)},x=$=>{s("select-contact",$)},D=()=>{s("create-new",i.value.trim())},R=()=>{s("close")},H=$=>$?$.replace(/([A-Z])/g," $1").replace(/^./,B=>B.toUpperCase()).trim():"";return($,B)=>(v(),qe(Gt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:R},{actions:ze(()=>[l("button",{onClick:R,class:"btn btn-secondary"}," Cancel ")]),default:ze(()=>[l("div",p6,[l("div",v6,[B[1]||(B[1]=l("label",null,"Search or create",-1)),Ue(l("input",{ref_key:"searchInputRef",ref:r,"onUpdate:modelValue":B[0]||(B[0]=N=>i.value=N),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),l("div",m6,[l("div",{class:"suggestion-item create-new",onClick:D},[B[3]||(B[3]=l("span",{class:"suggestion-icon create-icon"},"+",-1)),l("div",g6,[B[2]||(B[2]=l("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),m("span",y6,'"'+C(i.value.trim())+'"',1)):M("",!0)])]),(v(!0),m(Ie,null,Ne(w.value,N=>(v(),m("div",{key:N.key,class:"suggestion-item",onClick:Z=>N.type==="marshal"?A(N.data):x(N.data)},[l("span",{class:pe(["suggestion-icon",N.type==="marshal"?"marshal-icon":"contact-icon"])},C(N.type==="marshal"?"M":"C"),3),l("div",_6,[l("span",b6,C(N.name),1),N.detail?(v(),m("span",w6,C(N.detail),1)):M("",!0)]),l("span",{class:pe(["suggestion-badge",{"contact-badge":N.type==="contact"}])},C(N.type==="marshal"?O(o).person:"Contact"),3)],8,k6))),128)),E.value?(v(),m(Ie,{key:0},[B[4]||(B[4]=l("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(Ie,null,Ne(S.value,N=>(v(),m("div",{key:N.key,class:"suggestion-item",onClick:Z=>N.type==="marshal"?A(N.data):x(N.data)},[l("span",{class:pe(["suggestion-icon",N.type==="marshal"?"marshal-icon":"contact-icon"])},C(N.type==="marshal"?"M":"C"),3),l("div",L6,[l("span",S6,C(N.name),1),N.detail?(v(),m("span",x6,C(N.detail),1)):M("",!0)]),l("span",{class:pe(["suggestion-badge",{"contact-badge":N.type==="contact"}])},C(N.type==="marshal"?O(o).person:"Contact"),3)],8,C6))),128))],64)):M("",!0),i.value.trim()&&w.value.length===0&&S.value.length===0?(v(),m("div",I6," No matching "+C(O(o).people.toLowerCase())+" or contacts found. ",1)):M("",!0),!i.value.trim()&&w.value.length===0?(v(),m("div",$6," No "+C(O(o).people.toLowerCase())+" or contacts available to add. ",1)):M("",!0)])])]),_:1},8,["show","title"]))}},M6=je(T6,[["__scopeId","data-v-e25ca97b"]]),A6={key:0,class:"tab-content"},E6={class:"form-group"},P6=["disabled"],D6={class:"form-group"},R6={key:1,class:"tab-content"},O6={class:"boundary-section"},B6={key:0,class:"boundary-preview"},N6={class:"boundary-actions"},F6={key:2,class:"tab-content"},U6={class:"contacts-header"},z6={class:"section-title"},H6={key:3,class:"tab-content"},V6={class:"section-title"},G6={key:4,class:"placeholder-message"},j6={key:6,class:"placeholder-message"},Z6={key:8,class:"placeholder-message"},q6={key:9,class:"tab-content appearance-tab"},W6={class:"accordion-item"},K6=["innerHTML"],J6={class:"accordion-title"},Y6={class:"accordion-arrow"},X6={key:0,class:"accordion-content"},Q6={class:"section-description"},e5={class:"color-picker"},t5=["title","onClick"],n5={class:"accordion-item"},o5=["innerHTML"],s5={class:"accordion-title"},a5={class:"accordion-arrow"},i5={key:0,class:"accordion-content"},l5={class:"section-description"},r5={class:"accordion-item"},c5={class:"accordion-title"},u5={class:"accordion-preview"},d5={class:"accordion-arrow"},h5={key:0,class:"accordion-content"},f5={class:"section-description"},p5={class:"form-group"},v5={value:""},m5=["value"],g5={class:"accordion-item"},y5={class:"accordion-title"},k5={class:"accordion-preview"},_5={class:"accordion-arrow"},b5={key:0,class:"accordion-content"},w5={class:"section-description"},C5={class:"form-group"},L5={value:""},S5=["value"],x5={key:10,class:"tab-content incidents-tab"},I5={class:"incidents-list"},$5={class:"custom-footer"},T5={class:"footer-left"},rf="edit_area_accordion",M5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=()=>x.value.peopleTerm?x.value.peopleTerm:d.eventPeopleTerm||"Marshals",r=(j=!0)=>{const se=x.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",de=i();return j?Uv("checkpoint",se,de):Ya("checkpoint",se,de)},u=(j=!0)=>r(j).toLowerCase(),d=e,f=o,p=T("details"),g=T(null),k=T([]),y=T({}),_=T({}),w=T(!1),S=T(!1),E=T([]),A=T([]),x=T({name:"",description:"",color:Cr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),D=()=>({name:"",description:"",color:o2(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>d.eventId?`${rf}_${d.eventId}`:rf,H=T({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});nn(()=>{const j=localStorage.getItem(R());if(j)try{const se=JSON.parse(j);H.value={...H.value,...se}}catch{}});const $=j=>{H.value[j]=!H.value[j],localStorage.setItem(R(),JSON.stringify(H.value))},B=V(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${x.value.color||Cr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),N=V(()=>{const j=x.value.checkpointStyleType!=="default"||x.value.checkpointStyleBackgroundShape||x.value.checkpointStyleBackgroundColor||x.value.checkpointStyleBorderColor||x.value.checkpointStyleIconColor||x.value.checkpointStyleSize,se=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!j&&!se)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const de=x.value.checkpointStyleType&&x.value.checkpointStyleType!=="default"?x.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",Me=x.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Oe=x.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Be=x.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Ye=x.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",mt=x.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Cn({type:de!=="default"?de:Me,backgroundShape:Me,backgroundColor:Oe,borderColor:Be,iconColor:Ye,size:mt,outputSize:24})}),Z=V(()=>d.area&&d.area.id),P=V(()=>!x.value.polygon||x.value.polygon.length===0?[]:x.value.polygon.map((j,se)=>({id:`polygon-point-${se}`,latitude:j.lat,longitude:j.lng}))),G=V(()=>d.area?.id?d.areas.filter(j=>j.id!==d.area.id).map(j=>({...j,color:"#999999"})):d.areas.map(j=>({...j,color:"#999999"})));V(()=>K.value.map(j=>j.id));const Y=V(()=>{const j=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:r(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&j.push({value:"incidents",label:"Incidents",icon:"incidents"}),j}),te=V(()=>Y.value.findIndex(j=>j.value===p.value)),Q=V(()=>te.value===Y.value.length-1),X=V(()=>Q.value?null:Y.value[te.value+1]),ne=V(()=>X.value?`${X.value.label}...`:""),F=V(()=>{if(!d.area||!d.area.id)return[];const j=d.checkpoints.filter(se=>se.areaIds&&se.areaIds.includes(d.area.id)).map(se=>se.id);return d.assignments.filter(se=>j.includes(se.locationId))}),K=V(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(j=>j.areaIds&&j.areaIds.includes(d.area.id))),fe=V(()=>{const j=[...K.value];return j.sort((se,de)=>{const Me=se.name.match(/^(\d+)/),Oe=de.name.match(/^(\d+)/);if(Me&&Oe){const Be=parseInt(Me[1]),Ye=parseInt(Oe[1]);if(Be!==Ye)return Be-Ye}return se.name.localeCompare(de.name,void 0,{numeric:!0,sensitivity:"base"})}),j}),he=V(()=>!d.area||!d.area.id?[]:d.contacts.filter(j=>j.scopeConfigurations?j.scopeConfigurations.some(se=>se.scope==="EveryoneInAreas"&&se.itemType==="Area"?se.ids?.includes("ALL_AREAS")?!0:se.ids?.includes(d.area.id):!1):!1)),Re=V(()=>{const j=new Set(he.value.map(Me=>Me.contactId)),se=he.value.map(Me=>({...Me,isPending:!1,isExisting:!0,isMarkedForRemoval:A.value.includes(Me.contactId)})),de=E.value.filter(Me=>!j.has(Me.contactId)).map(Me=>({...Me,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...se,...de].sort((Me,Oe)=>Me.name.localeCompare(Oe.name,void 0,{sensitivity:"base"}))}),et=V(()=>{const j=he.value.map(de=>de.contactId),se=E.value.map(de=>de.contactId);return[...j,...se]}),Xe=async j=>{if(!(y.value[j]||_.value[j])){_.value[j]=!0;try{const de=(await Rt.getCheckpointChecklist(d.eventId,j)).data||[];y.value[j]={total:de.length,completed:de.filter(Me=>Me.isCompleted).length}}catch(se){console.error("Failed to load checklist status for checkpoint:",j,se),y.value[j]={total:0,completed:0}}finally{_.value[j]=!1}}};Ze(()=>d.area,j=>{if(j){const se=j.polygon?typeof j.polygon=="string"?JSON.parse(j.polygon):j.polygon:[];x.value={name:j.name||"",description:j.description||"",color:j.color||Cr,displayOrder:j.displayOrder||0,isDefault:j.isDefault||!1,polygon:se,checkpointStyleType:j.checkpointStyleType||"default",checkpointStyleColor:j.checkpointStyleColor||"",checkpointStyleBackgroundShape:j.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:j.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:j.checkpointStyleBorderColor||"",checkpointStyleIconColor:j.checkpointStyleIconColor||"",checkpointStyleSize:j.checkpointStyleSize||"",checkpointStyleMapRotation:j.checkpointStyleMapRotation??"",peopleTerm:j.peopleTerm||"",checkpointTerm:j.checkpointTerm||""}}else x.value=D()},{immediate:!0,deep:!0}),Ze(()=>d.show,j=>{j&&(p.value=d.initialTab||"details",k.value=[],y.value={},_.value={},E.value=[],A.value=[],S.value=!1,Z.value||(x.value=D()),g.value?.resetLocalState&&g.value.resetLocalState())}),Ze(p,j=>{j==="checkpoints"&&d.area&&d.area.id&&K.value.forEach(se=>{setTimeout(()=>Xe(se.id),0)})});const He=()=>{f("update:isDirty",!0)},Ke=j=>{x.value.color=j,He()},ye=(j,se)=>{x.value[j]=se,He()},Ve=()=>{f("draw-boundary",x.value)},me=j=>{x.value.polygon=j,He()},xe=()=>{x.value.polygon=[],w.value=!1,He()},De=j=>{S.value=!1,f("create-contact-from-marshal",{marshal:j,area:d.area})},q=j=>{S.value=!1,f("create-new-contact",{name:j,area:d.area})},J=j=>{E.value.find(se=>se.contactId===j.contactId)||(E.value.push(j),He()),S.value=!1},ve=j=>{E.value=E.value.filter(se=>se.contactId!==j),He()},Se=j=>{A.value.includes(j)||(A.value.push(j),He())},re=j=>j.isPending?"Remove pending contact":`Remove from ${s.value.area}`,ue=j=>{Re.value.find(de=>de.contactId===j)?.isPending?ve(j):Se(j)},ee=j=>{A.value=A.value.filter(se=>se!==j),He()},W=j=>{k.value=j,He()},ie=()=>{X.value&&(p.value=X.value.value)},Le=()=>{const j=d.area?{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,displayOrder:x.value.displayOrder,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,checklistChanges:k.value||[],pendingContacts:E.value||[],contactsToRemove:A.value||[]}:{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,pendingContacts:E.value||[]};f("save",j)},Ce=()=>{f("delete",d.area.id)},ke=()=>{f("close")};return t({addPendingContact:j=>{j&&!E.value.find(se=>se.contactId===j.contactId)&&(E.value.push(j),He())},removeContactById:j=>{const se=E.value.some(de=>de.contactId===j);E.value=E.value.filter(de=>de.contactId!==j),A.value=A.value.filter(de=>de!==j),se&&He()}}),(j,se)=>(v(),qe(Gt,{show:e.show,title:e.area&&e.area.id?`Edit ${O(s).area}: ${e.area.name}`:`Create new ${O(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ke},{"tab-header":ze(()=>[Ee(Wi,{modelValue:p.value,"onUpdate:modelValue":se[0]||(se[0]=de=>p.value=de),tabs:Y.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[l("div",$5,[l("div",T5,[Z.value&&!x.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:Ce,class:"btn btn-danger"}," Delete ")):M("",!0),!Z.value&&!Q.value?(v(),m("button",{key:1,type:"button",onClick:ie,class:"btn btn-secondary mobile-only"},C(ne.value),1)):M("",!0)]),l("button",{type:"button",onClick:Le,class:"btn btn-success"}," Save ")])]),default:ze(()=>[p.value==="details"?(v(),m("div",A6,[l("form",{onSubmit:rt(Le,["prevent"])},[l("div",E6,[se[25]||(se[25]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":se[1]||(se[1]=de=>x.value.name=de),type:"text",required:"",class:"form-input",disabled:x.value.isDefault,onInput:He},null,40,P6),[[st,x.value.name]])]),l("div",D6,[se[26]||(se[26]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":se[2]||(se[2]=de=>x.value.description=de),class:"form-input",rows:"3",onInput:He},null,544),[[st,x.value.description]])])],32)])):M("",!0),p.value==="boundary"?(v(),m("div",R6,[l("div",O6,[x.value.polygon&&x.value.polygon.length>0?(v(),m("div",B6,[Ee(ri,{mode:"edit-polygon","editing-polygon":x.value.polygon,route:e.route,locations:e.checkpoints,areas:G.value,"all-locations-for-bounds":P.value,height:"300px",onPolygonUpdate:me},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),se[27]||(se[27]=l("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):M("",!0),l("div",N6,[!x.value.polygon||x.value.polygon.length===0?(v(),m("button",{key:0,onClick:Ve,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(Ie,{key:1},[l("button",{onClick:Ve,class:"btn btn-secondary"}," Redraw "),l("button",{onClick:se[3]||(se[3]=de=>w.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):M("",!0),Ee(Nl,{show:w.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:xe,onCancel:se[4]||(se[4]=de=>w.value=!1)},null,8,["show"]),p.value==="contacts"?(v(),m("div",F6,[l("div",U6,[l("h3",z6,C(O(a).area)+" contacts ("+C(Re.value.length)+")",1),l("button",{onClick:se[5]||(se[5]=de=>S.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ee(Zv,{contacts:Re.value,"show-remove-button":!0,"remove-title":re,"empty-message":`No contacts assigned to this ${O(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${O(s).people} in this ${O(s).area}.`,onSelect:se[6]||(se[6]=de=>j.$emit("edit-contact",de)),onRemove:ue,onUndoRemove:ee},null,8,["contacts","empty-message","empty-hint"])])):M("",!0),Ee(M6,{show:S.value,"area-name":x.value.name||"this "+O(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":et.value,onClose:se[7]||(se[7]=de=>S.value=!1),onSelectContact:J,onCreateFromMarshal:De,onCreateNew:q},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),p.value==="checkpoints"&&Z.value?(v(),m("div",H6,[l("h3",V6,C(r())+" in "+C(e.area?.name)+" ("+C(K.value.length)+")",1),Ee(Jv,{checkpoints:fe.value,areas:e.areas,"empty-message":`No ${u()} in this ${O(s).area} yet.`,onSelect:se[8]||(se[8]=de=>j.$emit("select-checkpoint",de))},null,8,["checkpoints","areas","empty-message"])])):M("",!0),p.value==="checkpoints"&&!Z.value?(v(),m("div",G6,[l("p",null,C(r())+" will be automatically assigned based on boundaries after the "+C(O(s).area)+" is created.",1)])):M("",!0),p.value==="checklists"&&Z.value?(v(),qe(Xv,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:k.value,"onUpdate:modelValue":se[9]||(se[9]=de=>k.value=de),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:F.value,onChange:W},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):M("",!0),p.value==="checklists"&&!Z.value?(v(),m("div",j6,[l("p",null,C(O(a).checklists)+" can be assigned after the "+C(O(s).area)+" is created.",1)])):M("",!0),p.value==="notes"&&Z.value?(v(),qe(gc,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):M("",!0),p.value==="notes"&&!Z.value?(v(),m("div",Z6,[l("p",null,"Notes can be viewed after the "+C(O(s).area)+" is created.",1)])):M("",!0),p.value==="appearance"?(v(),m("div",q6,[l("div",W6,[l("button",{type:"button",class:pe(["accordion-header",{expanded:H.value.polygonColor}]),onClick:se[10]||(se[10]=de=>$("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:B.value},null,8,K6),l("span",J6,C(O(a).area)+" polygon colour",1),l("span",Y6,C(H.value.polygonColor?"":""),1)],2),H.value.polygonColor?(v(),m("div",X6,[l("p",Q6," Choose a colour for this "+C(O(s).area)+"'s boundary on the map. ",1),l("div",e5,[(v(!0),m(Ie,null,Ne(O(An),de=>(v(),m("div",{key:de.hex,class:pe(["color-swatch",{selected:x.value.color===de.hex}]),style:Qe({backgroundColor:de.hex}),title:de.name,onClick:Me=>Ke(de.hex)},null,14,t5))),128))])])):M("",!0)]),l("div",n5,[l("button",{type:"button",class:pe(["accordion-header",{expanded:H.value.iconStyle}]),onClick:se[11]||(se[11]=de=>$("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:N.value},null,8,o5),l("span",s5,C(r(!1))+" marker style",1),l("span",a5,C(H.value.iconStyle?"":""),1)],2),H.value.iconStyle?(v(),m("div",i5,[l("p",l5," Set a default marker style for all "+C(u())+" in this "+C(O(s).area)+". Individual "+C(u())+" can override this setting. ",1),Ee(ad,{"style-type":x.value.checkpointStyleType||"default","style-color":x.value.checkpointStyleColor||"","style-background-shape":x.value.checkpointStyleBackgroundShape||"","style-background-color":x.value.checkpointStyleBackgroundColor||"","style-border-color":x.value.checkpointStyleBorderColor||"","style-icon-color":x.value.checkpointStyleIconColor||"","style-size":x.value.checkpointStyleSize||"","style-map-rotation":x.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":se[12]||(se[12]=de=>ye("checkpointStyleType",de)),"onUpdate:styleColor":se[13]||(se[13]=de=>ye("checkpointStyleColor",de)),"onUpdate:styleBackgroundShape":se[14]||(se[14]=de=>ye("checkpointStyleBackgroundShape",de)),"onUpdate:styleBackgroundColor":se[15]||(se[15]=de=>ye("checkpointStyleBackgroundColor",de)),"onUpdate:styleBorderColor":se[16]||(se[16]=de=>ye("checkpointStyleBorderColor",de)),"onUpdate:styleIconColor":se[17]||(se[17]=de=>ye("checkpointStyleIconColor",de)),"onUpdate:styleSize":se[18]||(se[18]=de=>ye("checkpointStyleSize",de)),"onUpdate:styleMapRotation":se[19]||(se[19]=de=>ye("checkpointStyleMapRotation",de))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):M("",!0)]),l("div",r5,[l("button",{type:"button",class:pe(["accordion-header",{expanded:H.value.peopleTerm}]),onClick:se[20]||(se[20]=de=>$("peopleTerm"))},[se[28]||(se[28]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",c5,C(i())+" terminology",1),l("span",u5,C(x.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",d5,C(H.value.peopleTerm?"":""),1)],2),H.value.peopleTerm?(v(),m("div",h5,[l("p",f5," Choose what "+C(i().toLowerCase())+" are called in this "+C(O(s).area)+". This will be inherited by "+C(u())+" unless they override it. ",1),l("div",p5,[se[29]||(se[29]=l("label",null,"What are people called?",-1)),Ue(l("select",{"onUpdate:modelValue":se[21]||(se[21]=de=>x.value.peopleTerm=de),class:"form-input",onChange:He},[l("option",v5,"Use event default ("+C(e.eventPeopleTerm)+")",1),(v(!0),m(Ie,null,Ne(O(Os).people,de=>(v(),m("option",{key:de,value:de},C(de),9,m5))),128))],544),[[Bn,x.value.peopleTerm]])])])):M("",!0)]),l("div",g5,[l("button",{type:"button",class:pe(["accordion-header",{expanded:H.value.checkpointTerm}]),onClick:se[22]||(se[22]=de=>$("checkpointTerm"))},[se[30]||(se[30]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",y5,C(r(!1))+" terminology",1),l("span",k5,C(x.value.checkpointTerm?O(Su)(x.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),l("span",_5,C(H.value.checkpointTerm?"":""),1)],2),H.value.checkpointTerm?(v(),m("div",b5,[l("p",w5," Choose what "+C(u())+" are called in this "+C(O(s).area)+". ",1),l("div",C5,[l("label",null,"What are "+C(u())+" called?",1),Ue(l("select",{"onUpdate:modelValue":se[23]||(se[23]=de=>x.value.checkpointTerm=de),class:"form-input",onChange:He},[l("option",L5,"Use event default ("+C(e.eventCheckpointTerm)+")",1),(v(!0),m(Ie,null,Ne(O(Os).checkpoint,de=>(v(),m("option",{key:de,value:de},C(O(Su)(de,i())),9,S5))),128))],544),[[Bn,x.value.checkpointTerm]])])])):M("",!0)])])):M("",!0),p.value==="incidents"?(v(),m("div",x5,[l("div",I5,[(v(!0),m(Ie,null,Ne(e.incidents,de=>(v(),qe(Wl,{key:de.incidentId,incident:de,onSelect:se[24]||(se[24]=Me=>j.$emit("select-incident",Me))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty"]))}},A5=je(M5,[["__scopeId","data-v-94cf46bf"]]),E5=["innerHTML"],P5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(s,i)=>(v(),qe(Gt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:ze(()=>[l("button",{onClick:a,class:"btn btn-primary"},C(e.okText),1)]),default:ze(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,E5)]),_:1},8,["show","title"]))}},yc=je(P5,[["__scopeId","data-v-a6e7148c"]]),D5={class:"tab-content"},R5={class:"form-group"},O5={for:"text"},B5=["placeholder"],N5={key:0,class:"checkbox-label-inline create-separate-items"},F5={class:"tab-content"},U5={class:"custom-footer"},z5={class:"footer-left"},H5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:o,termsSentence:a}=ut(),s=e,i=t,r=T(!1),u=T(""),d=T("details"),f=T({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),p=V(()=>!!s.checklistItem),g=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=V(()=>g.findIndex($=>$.value===d.value)),y=V(()=>k.value===g.length-1),_=V(()=>y.value?"":g[k.value+1]?.label||"");Ze(()=>s.show,$=>{$&&(d.value=s.initialTab,s.checklistItem?f.value={text:s.checklistItem.text||"",scopeConfigurations:s.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(s.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:s.checklistItem.displayOrder||0,isRequired:s.checklistItem.isRequired!==!1,visibleFrom:s.checklistItem.visibleFrom?w(s.checklistItem.visibleFrom):null,visibleUntil:s.checklistItem.visibleUntil?w(s.checklistItem.visibleUntil):null,mustCompleteBy:s.checklistItem.mustCompleteBy?w(s.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:f.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const w=$=>{if(!$)return null;const B=new Date($),N=B.getTimezoneOffset();return new Date(B.getTime()-N*60*1e3).toISOString().slice(0,16)},S=$=>$?new Date($).toISOString():null,E=()=>{i("update:isDirty",!0)},A=()=>{i("close")},x=()=>{y.value||(d.value=g[k.value+1].value)},D=$=>{u.value=$,r.value=!0},R=()=>{if(!f.value.text||!f.value.text.trim()){D(`Please enter ${o.value.checklist} text`);return}if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){D("Please select at least one scope");return}if(!f.value.scopeConfigurations.some(N=>!(N.itemType!==null&&(!N.ids||N.ids.length===0)))){D("Please configure at least one scope with valid selections");return}const B={text:f.value.text,scopeConfigurations:f.value.scopeConfigurations,displayOrder:f.value.displayOrder||0,isRequired:f.value.isRequired,visibleFrom:S(f.value.visibleFrom),visibleUntil:S(f.value.visibleUntil),mustCompleteBy:S(f.value.mustCompleteBy)};p.value||(B.createSeparateItems=f.value.createSeparateItems),i("save",B)},H=()=>{i("delete",s.checklistItem.itemId)};return($,B)=>(v(),m(Ie,null,[Ee(Gt,{show:e.show,title:p.value?`Edit ${O(o).checklist}`:`Create ${O(o).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:A},{"tab-header":ze(()=>[Ee(Wi,{modelValue:d.value,"onUpdate:modelValue":B[0]||(B[0]=N=>d.value=N),tabs:g},null,8,["modelValue"])]),footer:ze(()=>[l("div",U5,[l("div",z5,[p.value?(v(),m("button",{key:0,type:"button",onClick:H,class:"btn btn-danger"}," Delete ")):M("",!0),!p.value&&!y.value?(v(),m("button",{key:1,type:"button",onClick:x,class:"btn btn-secondary mobile-only"},C(_.value)+"... ",1)):M("",!0)]),l("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:ze(()=>[l("form",{onSubmit:rt(R,["prevent"]),class:"checklist-form"},[Ue(l("div",D5,[l("div",R5,[l("label",O5,C(O(a).checklist)+" text: *",1),Ue(l("textarea",{id:"text","onUpdate:modelValue":B[1]||(B[1]=N=>f.value.text=N),onInput:E,required:"",rows:"3",placeholder:f.value.createSeparateItems?`Enter ${O(o).checklists}, one per line...`:`Enter the ${O(o).checklist} text...`},null,40,B5),[[st,f.value.text]]),p.value?M("",!0):(v(),m("label",N5,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":B[2]||(B[2]=N=>f.value.createSeparateItems=N),onChange:E},null,544),[[Ia,f.value.createSeparateItems]]),B[5]||(B[5]=l("span",null,"Each line creates a new item",-1))]))])],512),[[ys,d.value==="details"]]),Ue(l("div",F5,[Ee(mc,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":B[3]||(B[3]=N=>f.value.scopeConfigurations=N),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,onUserChanged:E},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(yc,{show:r.value,title:"Validation error",message:u.value,onClose:B[4]||(B[4]=N=>r.value=!1)},null,8,["show","message"])],64))}},V5=je(H5,[["__scopeId","data-v-eddaaf3c"]]),G5={class:"tab-content"},j5={class:"form-group"},Z5={class:"form-group"},q5={class:"form-row"},W5={class:"form-group"},K5={class:"checkbox-label-inline show-emergency-checkbox"},J5={class:"form-group"},Y5={class:"form-row"},X5={class:"form-group"},Q5={class:"form-group checkbox-group-inline"},e8={class:"checkbox-label-inline"},t8={class:"tab-content"},n8={class:"custom-footer"},o8={class:"footer-left"},s8={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=T(!1),i=T(""),r=T("details"),u=T({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=D=>D==="Urgent"||D==="Emergency",f=V(()=>!!o.note),p=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],g=V(()=>p.findIndex(D=>D.value===r.value)),k=V(()=>g.value===p.length-1),y=V(()=>k.value?"":p[g.value+1]?.label||"");Ze(()=>o.show,D=>{D&&(r.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1,showInEmergencyInfo:o.note.showInEmergencyInfo??d(o.note.priority)}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),Ze(()=>u.value.priority,(D,R)=>{!f.value&&D!==R&&(d(D)?u.value.showInEmergencyInfo=!0:d(R)&&(u.value.showInEmergencyInfo=!1))});const _=()=>{a("update:isDirty",!0)},w=()=>{a("close")},S=()=>{k.value||(r.value=p[g.value+1].value)},E=D=>{i.value=D,s.value=!0},A=()=>{if(!u.value.title||!u.value.title.trim()){E("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){E("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(H=>!(H.itemType!==null&&(!H.ids||H.ids.length===0)))){E("Please configure at least one scope with valid selections");return}const R={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1,showInEmergencyInfo:u.value.showInEmergencyInfo};a("save",R)},x=()=>{a("delete",o.note.noteId)};return(D,R)=>(v(),m(Ie,null,[Ee(Gt,{show:e.show,title:f.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:w},{"tab-header":ze(()=>[Ee(Wi,{modelValue:r.value,"onUpdate:modelValue":R[0]||(R[0]=H=>r.value=H),tabs:p},null,8,["modelValue"])]),footer:ze(()=>[l("div",n8,[l("div",o8,[f.value?(v(),m("button",{key:0,type:"button",onClick:x,class:"btn btn-danger"}," Delete ")):M("",!0),!f.value&&!k.value?(v(),m("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},C(y.value)+"... ",1)):M("",!0)]),l("button",{type:"button",onClick:A,class:"btn btn-success"}," Save ")])]),default:ze(()=>[l("form",{onSubmit:rt(A,["prevent"]),class:"note-form"},[Ue(l("div",G5,[l("div",j5,[R[10]||(R[10]=l("label",{for:"title"},"Title: *",-1)),Ue(l("input",{id:"title","onUpdate:modelValue":R[1]||(R[1]=H=>u.value.title=H),type:"text",onInput:_,required:"",placeholder:"Enter note title..."},null,544),[[st,u.value.title]])]),l("div",Z5,[R[11]||(R[11]=l("label",{for:"content"},"Content:",-1)),Ue(l("textarea",{id:"content","onUpdate:modelValue":R[2]||(R[2]=H=>u.value.content=H),onInput:_,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,u.value.content]])]),l("div",q5,[l("div",W5,[R[14]||(R[14]=l("label",{for:"priority"},"Priority:",-1)),Ue(l("select",{id:"priority","onUpdate:modelValue":R[3]||(R[3]=H=>u.value.priority=H),onChange:_},[...R[12]||(R[12]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[Bn,u.value.priority]]),l("label",K5,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":R[4]||(R[4]=H=>u.value.showInEmergencyInfo=H),onChange:_},null,544),[[Ia,u.value.showInEmergencyInfo]]),R[13]||(R[13]=l("span",null,"Show in emergency info",-1))])]),l("div",J5,[R[15]||(R[15]=l("label",{for:"category"},"Category:",-1)),Ue(l("input",{id:"category","onUpdate:modelValue":R[5]||(R[5]=H=>u.value.category=H),type:"text",onInput:_,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,u.value.category]])])]),l("div",Y5,[l("div",X5,[R[16]||(R[16]=l("label",{for:"displayOrder"},"Display order:",-1)),Ue(l("input",{id:"displayOrder","onUpdate:modelValue":R[6]||(R[6]=H=>u.value.displayOrder=H),type:"number",onInput:_,min:"0"},null,544),[[st,u.value.displayOrder,void 0,{number:!0}]]),R[17]||(R[17]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",Q5,[l("label",e8,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":R[7]||(R[7]=H=>u.value.isPinned=H),onChange:_},null,544),[[Ia,u.value.isPinned]]),R[18]||(R[18]=l("span",null,"Pin to top",-1))]),R[19]||(R[19]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ys,r.value==="details"]]),Ue(l("div",t8,[Ee(mc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":R[8]||(R[8]=H=>u.value.scopeConfigurations=H),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:_},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,r.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(yc,{show:s.value,title:"Validation error",message:i.value,onClose:R[9]||(R[9]=H=>s.value=!1)},null,8,["show","message"])],64))}},a8=je(s8,[["__scopeId","data-v-e8488047"]]),i8={class:"incident-detail-header"},l8={class:"header-title-row"},r8={class:"modal-title"},c8={class:"header-badges"},u8=["disabled"],d8={key:0,class:"status-dropdown-menu"},h8=["onClick","disabled"],f8={key:0,class:"incident-detail-content"},p8={class:"accordion-section"},v8={class:"accordion-arrow"},m8={key:0,class:"accordion-content"},g8={class:"description-text"},y8={class:"accordion-section"},k8={class:"accordion-arrow"},_8={key:0,class:"accordion-content"},b8={class:"info-grid"},w8={class:"info-item"},C8={class:"info-value"},L8={class:"info-item"},S8={class:"info-value"},x8={key:0,class:"info-item"},I8={class:"info-label"},$8={class:"info-value"},T8={key:1,class:"info-item"},M8={class:"info-label"},A8={class:"info-value"},E8={key:2,class:"info-item"},P8={class:"info-value"},D8={key:0,class:"incident-map-container"},R8={class:"accordion-section"},O8={class:"accordion-preview"},B8={class:"accordion-arrow"},N8={key:0,class:"accordion-content"},F8={class:"reporter-info"},U8={class:"reporter-name"},z8={key:0,class:"accordion-section"},H8={class:"accordion-title"},V8={class:"accordion-preview"},G8={class:"accordion-arrow"},j8={key:0,class:"accordion-content"},Z8={class:"marshals-list"},q8={class:"marshal-name"},W8={key:0,class:"checkin-badge success"},K8={key:1,class:"checkin-badge not-checked-in"},J8={class:"accordion-section"},Y8={key:0,class:"accordion-preview"},X8={class:"accordion-arrow"},Q8={key:0,class:"accordion-content"},eD={key:0,class:"notes-timeline"},tD={class:"note-header"},nD={class:"note-author"},oD={class:"note-time"},sD={key:0,class:"note-status-change"},aD={key:1,class:"note-text"},iD={key:1,class:"no-notes"},lD={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:o,termsSentence:a}=ut(),s=e,i=t,r=T(!1),u=T(!1),d=T(null),f=T({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ze(()=>s.show,Z=>{Z&&(f.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},u.value=!1)});const p=Z=>{d.value&&!d.value.contains(Z.target)&&(u.value=!1)};Ze(u,Z=>{Z?document.addEventListener("click",p):document.removeEventListener("click",p)});const g=()=>{u.value=!u.value},k=Z=>{s.incident?.status!==Z&&(u.value=!1,N(Z))},y=Z=>{const P=f.value[Z];Object.keys(f.value).forEach(G=>{f.value[G]=!1}),P||(f.value[Z]=!0)},_=V(()=>s.incident?.latitude!=null&&s.incident?.longitude!=null),w=V(()=>_.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),S=V(()=>_.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),E=V(()=>{if(!s.incident)return"Incident Details";if(s.incident.title)return s.incident.title;const Z=s.incident.description||"";return Z.length<=50?Z:Z.substring(0,47)+"..."}),A=V(()=>[...s.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((P,G)=>(P.name||"").localeCompare(G.name||"",void 0,{sensitivity:"base"}))),x=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],D=Z=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[Z]||Z,R=Z=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[Z]||Z,H=Z=>{if(!Z)return"";let P=Z.name||"";if(Z.description){const G=Z.description,Y=40,te=G.length>Y?G.substring(0,Y-3)+"...":G;P+=` - ${te}`}return P},$=Z=>Z?new Date(Z).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",B=Z=>{if(!Z)return"";const P=new Date(Z),Y=new Date-P,te=Math.floor(Y/6e4),Q=Math.floor(Y/36e5),X=Math.floor(Y/864e5);return te<1?"just now":te<60?`${te}m ago`:Q<24?`${Q}h ago`:X<7?`${X}d ago`:P.toLocaleDateString()},N=async Z=>{if(s.incident?.status!==Z){r.value=!0;try{i("status-change",{incidentId:s.incident.incidentId,status:Z})}finally{r.value=!1}}};return(Z,P)=>(v(),qe(Gt,{show:e.show,title:E.value,size:"large",onClose:P[7]||(P[7]=G=>Z.$emit("close"))},{header:ze(()=>[l("div",i8,[l("div",l8,[l("span",{class:pe(["severity-indicator",e.incident?.severity])},null,2),l("h2",r8,C(E.value),1)]),l("div",c8,[l("span",{class:pe(["severity-badge",e.incident?.severity])},C(D(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[l("button",{type:"button",class:pe(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:g,disabled:r.value},[Je(C(R(e.incident?.status))+" ",1),P[8]||(P[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,u8),u.value?(v(),m("div",d8,[(v(),m(Ie,null,Ne(x,G=>l("button",{key:G.value,type:"button",class:pe(["status-dropdown-item",{active:e.incident?.status===G.value}]),onClick:Y=>k(G.value),disabled:e.incident?.status===G.value},[l("span",{class:pe(["status-dot",G.value])},null,2),Je(" "+C(G.label),1)],10,h8)),64))])):M("",!0)],512)):(v(),m("span",{key:1,class:pe(["status-badge",e.incident?.status])},C(R(e.incident?.status)),3))])])]),footer:ze(()=>[l("button",{class:"btn btn-secondary",onClick:P[6]||(P[6]=G=>Z.$emit("close"))},"Close")]),default:ze(()=>[e.incident?(v(),m("div",f8,[l("div",p8,[l("button",{type:"button",class:pe(["accordion-header",{expanded:f.value.description}]),onClick:P[0]||(P[0]=G=>y("description"))},[P[9]||(P[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",v8,C(f.value.description?"":""),1)],2),f.value.description?(v(),m("div",m8,[l("p",g8,C(e.incident.description),1)])):M("",!0)]),l("div",y8,[l("button",{type:"button",class:pe(["accordion-header",{expanded:f.value.timeLocation}]),onClick:P[1]||(P[1]=G=>y("timeLocation"))},[P[10]||(P[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",k8,C(f.value.timeLocation?"":""),1)],2),f.value.timeLocation?(v(),m("div",_8,[l("div",b8,[l("div",w8,[P[11]||(P[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",C8,C($(e.incident.incidentTime)),1)]),l("div",L8,[P[12]||(P[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",S8,C($(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",x8,[l("span",I8,C(O(a).checkpoint),1),l("span",$8,C(H(e.incident.context.checkpoint)),1)])):M("",!0),e.incident.area?(v(),m("div",T8,[l("span",M8,C(O(a).area),1),l("span",A8,C(e.incident.area.areaName),1)])):M("",!0),_.value?(v(),m("div",E8,[P[13]||(P[13]=l("span",{class:"info-label"},"GPS location",-1)),l("span",P8,C(e.incident.latitude.toFixed(6))+", "+C(e.incident.longitude.toFixed(6)),1)])):M("",!0)]),_.value?(v(),m("div",D8,[Ee(ri,{locations:e.checkpoints,route:e.route,center:w.value,zoom:15,"user-location":S.value,height:"200px"},null,8,["locations","route","center","user-location"])])):M("",!0)])):M("",!0)]),l("div",R8,[l("button",{type:"button",class:pe(["accordion-header",{expanded:f.value.reporter}]),onClick:P[2]||(P[2]=G=>y("reporter"))},[P[14]||(P[14]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",O8,C(e.incident.reportedBy?.name||"Unknown"),1),l("span",B8,C(f.value.reporter?"":""),1)],2),f.value.reporter?(v(),m("div",N8,[l("div",F8,[l("span",U8,C(e.incident.reportedBy?.name||"Unknown"),1)])])):M("",!0)]),A.value.length?(v(),m("div",z8,[l("button",{type:"button",class:pe(["accordion-header",{expanded:f.value.marshals}]),onClick:P[3]||(P[3]=G=>y("marshals"))},[l("span",H8,C(O(o).peoplePlural)+" at "+C(O(o).checkpoint.toLowerCase()),1),l("span",V8,C(A.value.length),1),l("span",G8,C(f.value.marshals?"":""),1)],2),f.value.marshals?(v(),m("div",j8,[l("div",Z8,[(v(!0),m(Ie,null,Ne(A.value,G=>(v(),m("div",{key:G.marshalId,class:pe(["marshal-item",{"checked-in":G.wasCheckedIn}])},[l("span",q8,C(G.name),1),G.wasCheckedIn?(v(),m("span",W8," Checked in "+C(B(G.checkInTime)),1)):(v(),m("span",K8," Not checked in "))],2))),128))])])):M("",!0)])):M("",!0),l("div",J8,[l("button",{type:"button",class:pe(["accordion-header",{expanded:f.value.notes}]),onClick:P[4]||(P[4]=G=>y("notes"))},[P[15]||(P[15]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",Y8,C(e.incident.updates.length),1)):M("",!0),l("span",X8,C(f.value.notes?"":""),1)],2),f.value.notes?(v(),m("div",Q8,[e.incident.updates?.length?(v(),m("div",eD,[(v(!0),m(Ie,null,Ne(e.incident.updates,(G,Y)=>(v(),m("div",{key:Y,class:"note-item"},[l("div",tD,[l("span",nD,C(G.authorName||"System"),1),l("span",oD,C(B(G.timestamp)),1)]),G.statusChange?(v(),m("div",sD,[P[16]||(P[16]=Je(" Status changed to ",-1)),l("span",{class:pe(["status-badge",G.statusChange])},C(R(G.statusChange)),3)])):G.note?(v(),m("p",aD,C(G.note),1)):M("",!0)]))),128))])):(v(),m("div",iD," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:P[5]||(P[5]=G=>Z.$emit("open-add-note"))}," Add update ")])):M("",!0)])])):M("",!0)]),_:1},8,["show","title"]))}},Qv=je(lD,[["__scopeId","data-v-df0707d4"]]),rD={class:"form-group"},cD={class:"form-group"},uD={class:"form-row"},dD={class:"form-group form-group-half"},hD=["value"],fD={class:"form-group form-group-half"},pD={key:0,class:"form-group"},vD={for:"checkpoint",class:"form-label"},mD=["value"],gD={key:1,class:"form-group"},yD={class:"form-label"},kD={class:"checkpoint-toggle"},_D={class:"checkbox-label"},bD={class:"checkpoint-name"},wD={key:0,class:"checkpoint-description"},CD={class:"form-group"},LD={class:"location-options"},SD={class:"location-buttons"},xD={key:0,class:"location-status"},ID={key:0,class:"location-getting"},$D={key:1,class:"location-display"},TD={key:0,class:"location-accuracy"},MD={key:2,class:"location-error"},AD={key:1,class:"map-picker-container"},ED={key:0,class:"map-picker-hint"},PD={key:2,class:"location-display"},DD={key:2,class:"error-message"},RD={class:"modal-actions"},OD=["disabled"],BD={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:o}=ut(),a=e,s=t,i=T({title:"",description:"",severity:"medium",incidentTime:""}),r=T(""),u=T(!0),d=T("none"),f=T(!1),p=T(null),g=T(null),k=T(null),y=T(!1),_=T(!1),w=T(null),S=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],E=()=>{const G=new Date,Y=G.getFullYear(),te=String(G.getMonth()+1).padStart(2,"0"),Q=String(G.getDate()).padStart(2,"0"),X=String(G.getHours()).padStart(2,"0"),ne=String(G.getMinutes()).padStart(2,"0");return`${Y}-${te}-${Q}T${X}:${ne}`},A=G=>G?new Date(G).toISOString():null,x=V(()=>a.checkpoints||[]),D=V(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(r.value){const G=x.value.find(Y=>Y.id===r.value);if(G?.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(x.value.length>0){const G=x.value[0];if(G.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.route?.length>0){const G=a.route[0];if(G?.lat!=null)return{lat:G.lat,lng:G.lng}}return{lat:-33.9,lng:151.2}}),R=V(()=>i.value.description.trim()!==""),H=V(()=>i.value.description.trim()!=="");Ze(()=>a.show,G=>{G&&(i.value={title:"",description:"",severity:"medium",incidentTime:E()},r.value="",u.value=!0,_.value=!1,w.value=null,k.value=null,p.value=null,g.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy,d.value="gps",f.value=!1):(d.value="none",f.value=!1),a.checkpoint&&(r.value=a.checkpoint.locationId||a.checkpoint.id||""))});const $=G=>{k.value=null,G==="map"?d.value==="map"?f.value=!f.value:(d.value="map",f.value=!0,g.value=null):G==="gps"?(d.value="gps",f.value=!1,N()):(d.value="none",f.value=!1,p.value=null,g.value=null)},B=G=>{p.value={latitude:G.lat,longitude:G.lng},g.value=null,f.value=!1},N=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){k.value="GPS is not available on this device.";return}y.value=!0,navigator.geolocation.getCurrentPosition(G=>{p.value={latitude:G.coords.latitude,longitude:G.coords.longitude},g.value=G.coords.accuracy,y.value=!1},G=>{k.value="Unable to get your location.",y.value=!1},{enableHighAccuracy:!0,timeout:1e4})},Z=async()=>{if(!(!H.value||_.value)){_.value=!0,w.value=null;try{const G=(d.value==="gps"||d.value==="map")&&p.value;let Y=null,te=!1;x.value.length>0?r.value?Y=r.value:te=!0:a.checkpoint&&(u.value?Y=a.checkpoint.locationId||a.checkpoint.id||null:te=!0);const Q={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:A(i.value.incidentTime),latitude:G?p.value.latitude:null,longitude:G?p.value.longitude:null,checkpointId:Y,skipCheckpointAutoAssign:te};s("submit",Q)}catch(G){w.value=G.message||"Failed to report incident. Please try again.",_.value=!1}}},P=()=>{s("close")};return(G,Y)=>(v(),qe(Gt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":R.value,onClose:P},{footer:ze(()=>[l("div",RD,[l("button",{type:"button",class:"btn btn-secondary",onClick:P}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Z,disabled:!H.value||_.value},C(_.value?"Reporting...":"Report Incident"),9,OD)])]),default:ze(()=>[l("form",{onSubmit:rt(Z,["prevent"]),class:"incident-form"},[l("div",rD,[Y[10]||(Y[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),Ue(l("input",{id:"title","onUpdate:modelValue":Y[0]||(Y[0]=te=>i.value.title=te),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),l("div",cD,[Y[11]||(Y[11]=l("label",{for:"description",class:"form-label"},[Je("Description "),l("span",{class:"required"},"*")],-1)),Ue(l("textarea",{id:"description","onUpdate:modelValue":Y[1]||(Y[1]=te=>i.value.description=te),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),l("div",uD,[l("div",dD,[Y[12]||(Y[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),Ue(l("select",{id:"severity","onUpdate:modelValue":Y[2]||(Y[2]=te=>i.value.severity=te),class:"form-input form-select"},[(v(),m(Ie,null,Ne(S,te=>l("option",{key:te.value,value:te.value},C(te.label),9,hD)),64))],512),[[Bn,i.value.severity]])]),l("div",fD,[Y[13]||(Y[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ue(l("input",{id:"incidentTime","onUpdate:modelValue":Y[3]||(Y[3]=te=>i.value.incidentTime=te),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),x.value.length>0?(v(),m("div",pD,[l("label",vD,C(O(o).checkpoint),1),Ue(l("select",{id:"checkpoint","onUpdate:modelValue":Y[4]||(Y[4]=te=>r.value=te),class:"form-input form-select"},[Y[14]||(Y[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(Ie,null,Ne(x.value,te=>(v(),m("option",{key:te.id,value:te.id},C(te.name)+C(te.description?` - ${te.description}`:""),9,mD))),128))],512),[[Bn,r.value]])])):e.checkpoint?(v(),m("div",gD,[l("label",yD,C(O(o).checkpoint),1),l("div",kD,[l("label",_D,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":Y[5]||(Y[5]=te=>u.value=te)},null,512),[[Ia,u.value]]),l("span",bD,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",wD," - "+C(e.checkpoint.description),1)):M("",!0)])])])):M("",!0),l("div",CD,[Y[15]||(Y[15]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",LD,[l("div",SD,[l("button",{type:"button",class:pe(["location-btn",{active:d.value==="gps"}]),onClick:Y[6]||(Y[6]=te=>$("gps"))}," GPS ",2),l("button",{type:"button",class:pe(["location-btn",{active:d.value==="map"}]),onClick:Y[7]||(Y[7]=te=>$("map"))}," Pick on map ",2),l("button",{type:"button",class:pe(["location-btn",{active:d.value==="none"}]),onClick:Y[8]||(Y[8]=te=>$("none"))}," None ",2)]),d.value==="gps"?(v(),m("div",xD,[y.value?(v(),m("div",ID," Getting location... ")):p.value&&p.value.latitude!=null?(v(),m("div",$D,[l("span",null,C(p.value.latitude.toFixed(5))+", "+C(p.value.longitude.toFixed(5)),1),g.value?(v(),m("span",TD,"("+C(Math.round(g.value))+"m)",1)):M("",!0)])):k.value?(v(),m("div",MD,C(k.value),1)):M("",!0)])):M("",!0),d.value==="map"?(v(),m("div",AD,[f.value?(v(),m("div",ED,"Tap to select location")):M("",!0),f.value?(v(),qe(ri,{key:1,locations:x.value,route:e.route,center:D.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":r.value,height:"150px",onPointSelected:B},null,8,["locations","route","center","user-location","highlight-location-id"])):M("",!0),p.value&&p.value.latitude!=null?(v(),m("div",PD,[l("span",null,C(p.value.latitude.toFixed(5))+", "+C(p.value.longitude.toFixed(5)),1),f.value?M("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:Y[9]||(Y[9]=te=>f.value=!0)},"Edit"))])):M("",!0)])):M("",!0)])]),w.value?(v(),m("div",DD,C(w.value),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},em=je(BD,[["__scopeId","data-v-20b520b6"]]),ND={class:"tab-content"},FD={key:0,class:"form-group"},UD={for:"marshalId"},zD=["value"],HD={class:"help-text"},VD={key:1,class:"form-group"},GD={class:"linked-marshal-info"},jD={class:"linked-marshal-name"},ZD={class:"linked-marshal-hint"},qD={key:2,class:"form-group"},WD={class:"form-group"},KD={class:"role-input-group"},JD={key:0,label:"Built-in Roles"},YD=["value"],XD={key:1,label:"Custom Roles"},QD=["value"],eR={class:"checkbox-label-inline show-emergency-checkbox"},tR={class:"form-row"},nR={class:"form-group"},oR={class:"form-group"},sR={class:"form-group"},aR={class:"tab-content"},iR={class:"custom-footer"},lR={class:"footer-left"},rR=["disabled"],cR={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=T(!1),r=T(""),u=T("details"),d=T(!1),f=T({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=Z=>Z==="EmergencyContact",g=V(()=>!!a.contact),k=V(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),y=V(()=>!!f.value.marshalId),_=V(()=>!g.value&&!!a.prefilledMarshalId),w=V(()=>g.value&&!!a.contact?.marshalId),S=V(()=>a.contact?.marshalId?a.marshals.find(P=>P.id===a.contact.marshalId)?.name||"Unknown":""),E=V(()=>[...a.marshals].sort((Z,P)=>Vs(Z.name,P.name)));Ze(()=>a.show,Z=>{if(Z){if(u.value=a.initialTab,a.contact){const P=[...a.availableRoles.builtInRoles||[],...a.availableRoles.customRoles||[]];d.value=a.contact.role&&!P.includes(a.contact.role),f.value={role:a.contact.role||"",name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??p(a.contact.role),scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let P;a.createFromAreaContext?P=[]:a.preselectedArea?P=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:P=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let G={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const Y=a.marshals.find(te=>te.id===a.prefilledMarshalId);Y&&(G={name:Y.name||"",phone:Y.phoneNumber||"",email:Y.email||""})}f.value={role:"",name:G.name,phone:G.phone,email:G.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:!1,scopeConfigurations:P}}s("update:isDirty",!1)}}),Ze(()=>f.value.role,(Z,P)=>{!g.value&&Z!==P&&(p(Z)?f.value.showInEmergencyInfo=!0:p(P)&&(f.value.showInEmergencyInfo=!1))});const A=Z=>Z?Z==="AreaLead"?`${o.value.area} Lead`:Z.replace(/([A-Z])/g," $1").replace(/^./,P=>P.toUpperCase()).trim():"",x=()=>{s("update:isDirty",!0)},D=()=>{if(f.value.marshalId){const Z=a.marshals.find(P=>P.id===f.value.marshalId);Z&&(f.value.name=Z.name,!f.value.phone&&Z.phoneNumber&&(f.value.phone=Z.phoneNumber),!f.value.email&&Z.email&&(f.value.email=Z.email))}x()},R=()=>{s("close")},H=()=>{if(!f.value.role||!f.value.role.trim()){$("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){$("Please enter a contact name");return}u.value="visibility"},$=Z=>{r.value=Z,i.value=!0},B=()=>{if(!f.value.role||!f.value.role.trim()){$("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){$("Please enter a contact name");return}if(!a.createFromAreaContext){if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){$("Please select at least one visibility scope");return}if(!f.value.scopeConfigurations.some(G=>!(G.itemType!==null&&(!G.ids||G.ids.length===0)))){$("Please configure at least one scope with valid selections");return}}const Z={role:f.value.role.trim(),name:f.value.name.trim(),phone:f.value.phone?.trim()||null,email:f.value.email?.trim()||null,notes:f.value.notes?.trim()||null,marshalId:f.value.marshalId||null,showInEmergencyInfo:f.value.showInEmergencyInfo,scopeConfigurations:f.value.scopeConfigurations};s("save",Z)},N=()=>{s("delete",a.contact.contactId)};return(Z,P)=>(v(),m(Ie,null,[Ee(Gt,{show:e.show,title:g.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:R},{"tab-header":ze(()=>[Ee(Wi,{modelValue:u.value,"onUpdate:modelValue":P[0]||(P[0]=G=>u.value=G),tabs:k.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[l("div",iR,[l("div",lR,[g.value?(v(),m("button",{key:0,type:"button",onClick:N,class:"btn btn-danger"}," Delete ")):M("",!0),!g.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:H,class:"btn btn-secondary mobile-only"}," Visibility... ")):M("",!0)]),l("button",{type:"button",onClick:B,class:"btn btn-success",disabled:g.value&&!e.isDirty}," Save ",8,rR)])]),default:ze(()=>[l("form",{onSubmit:rt(B,["prevent"]),class:"contact-form"},[Ue(l("div",ND,[!_.value&&!w.value?(v(),m("div",FD,[l("label",UD,"Link to "+C(O(o).person.toLowerCase())+":",1),Ue(l("select",{id:"marshalId","onUpdate:modelValue":P[1]||(P[1]=G=>f.value.marshalId=G),onChange:D},[P[12]||(P[12]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),m(Ie,null,Ne(E.value,G=>(v(),m("option",{key:G.id,value:G.id},C(G.name),9,zD))),128))],544),[[Bn,f.value.marshalId]]),l("span",HD,"Optionally link to an existing "+C(O(o).person.toLowerCase())+" in the system",1)])):M("",!0),w.value?(v(),m("div",VD,[l("label",null,"Linked "+C(O(o).person.toLowerCase())+":",1),l("div",GD,[l("span",jD,C(S.value),1),l("span",ZD,"Contact details are synced with this "+C(O(o).person.toLowerCase()),1)])])):M("",!0),y.value?M("",!0):(v(),m("div",qD,[P[13]||(P[13]=l("label",{for:"name"},"Name: *",-1)),Ue(l("input",{id:"name","onUpdate:modelValue":P[2]||(P[2]=G=>f.value.name=G),type:"text",onInput:x,placeholder:"Contact name..."},null,544),[[st,f.value.name]])])),l("div",WD,[P[16]||(P[16]=l("label",{for:"role"},"Role: *",-1)),l("div",KD,[d.value?Ue((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":P[4]||(P[4]=G=>f.value.role=G),type:"text",onInput:x,placeholder:"Enter custom role name..."},null,544)),[[st,f.value.role]]):Ue((v(),m("select",{key:0,id:"role","onUpdate:modelValue":P[3]||(P[3]=G=>f.value.role=G),onChange:x},[P[14]||(P[14]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",JD,[(v(!0),m(Ie,null,Ne(e.availableRoles.builtInRoles,G=>(v(),m("option",{key:G,value:G},C(A(G)),9,YD))),128))])):M("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",XD,[(v(!0),m(Ie,null,Ne(e.availableRoles.customRoles,G=>(v(),m("option",{key:G,value:G},C(A(G)),9,QD))),128))])):M("",!0)],544)),[[Bn,f.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:P[5]||(P[5]=G=>d.value=!d.value)},C(d.value?"Use existing":"Custom"),1)]),l("label",eR,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":P[6]||(P[6]=G=>f.value.showInEmergencyInfo=G),onChange:x},null,544),[[Ia,f.value.showInEmergencyInfo]]),P[15]||(P[15]=l("span",null,"Show in emergency info",-1))])]),l("div",tR,[l("div",nR,[P[17]||(P[17]=l("label",{for:"phone"},"Phone:",-1)),Ue(l("input",{id:"phone","onUpdate:modelValue":P[7]||(P[7]=G=>f.value.phone=G),type:"tel",onInput:x,placeholder:"Phone number..."},null,544),[[st,f.value.phone]])]),l("div",oR,[P[18]||(P[18]=l("label",{for:"email"},"Email:",-1)),Ue(l("input",{id:"email","onUpdate:modelValue":P[8]||(P[8]=G=>f.value.email=G),type:"email",onInput:x,placeholder:"Email address..."},null,544),[[st,f.value.email]])])]),l("div",sR,[P[19]||(P[19]=l("label",{for:"notes"},"Notes / Instructions:",-1)),Ue(l("textarea",{id:"notes","onUpdate:modelValue":P[9]||(P[9]=G=>f.value.notes=G),onInput:x,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,f.value.notes]])])],512),[[ys,u.value==="details"]]),Ue(l("div",aR,[Ee(mc,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":P[10]||(P[10]=G=>f.value.scopeConfigurations=G),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":g.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:x},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(yc,{show:i.value,title:"Validation error",message:r.value,onClose:P[11]||(P[11]=G=>i.value=!1)},null,8,["show","message"])],64))}},uR=je(cR,[["__scopeId","data-v-1facd274"]]),dR={key:0,class:"fullscreen-map-overlay"},hR={class:"fullscreen-map-header"},fR={class:"context-info"},pR={key:0},vR={class:"action-buttons"},mR=["disabled"],gR={class:"fullscreen-map-container"},yR={key:0,class:"drawing-controls"},kR={class:"point-count"},_R={class:"undo-redo-buttons"},bR=["disabled"],wR=["disabled"],CR=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,s=T(null),i=T(0),r=T(!1),u=T(!1),d=()=>{a("done")},f=()=>{a("cancel")},p=w=>{i.value=w?.length||0,g(),a("polygon-drawing",w)},g=()=>{s.value&&(r.value=s.value.canUndo(),u.value=s.value.canRedo())},k=()=>{s.value&&(s.value.undoPolygonPoint(),g())},y=()=>{s.value&&(s.value.redoPolygonPoint(),g())};Ze(()=>o.show,w=>{w||(i.value=0,r.value=!1,u.value=!1)});const _=w=>{w.key==="Escape"&&o.show&&f(),o.show&&o.drawingMode&&((w.ctrlKey||w.metaKey)&&w.key==="z"&&!w.shiftKey?(w.preventDefault(),k()):(w.ctrlKey||w.metaKey)&&(w.key==="y"||w.key==="z"&&w.shiftKey)&&(w.preventDefault(),y()))};return nn(()=>{document.addEventListener("keydown",_)}),xn(()=>{document.removeEventListener("keydown",_)}),(w,S)=>(v(),qe(Tl,{to:"body"},[e.show?(v(),m("div",dR,[l("div",hR,[l("div",fR,[l("h3",null,C(e.contextTitle),1),e.contextDescription?(v(),m("p",pR,C(e.contextDescription),1)):M("",!0)]),l("div",vR,[e.mode==="view"?(v(),m("button",{key:0,onClick:f,class:"btn btn-done"}," Close ")):(v(),m(Ie,{key:1},[l("button",{onClick:f,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,mR)],64))])]),l("div",gR,[Ee(Tu,Dp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},w.$attrs,{onMapClick:S[0]||(S[0]=E=>w.$emit("map-click",E)),onPolygonComplete:S[1]||(S[1]=E=>w.$emit("polygon-complete",E)),onPolygonDrawing:p,onLocationClick:S[2]||(S[2]=E=>w.$emit("location-click",E)),onAreaClick:S[3]||(S[3]=E=>w.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),m("div",yR,[l("div",kR,C(i.value)+" point"+C(i.value!==1?"s":""),1),l("div",_R,[l("button",{onClick:k,class:"btn-drawing undo-btn",disabled:!r.value,title:"Undo last point"},"  Undo ",8,bR),l("button",{onClick:y,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,wR)])])):M("",!0)])])):M("",!0)]))}}),LR=je(CR,[["__scopeId","data-v-9ce62b55"]]),SR={class:"form-group"},xR={class:"form-group"},IR={class:"form-group"},$R={key:0,class:"form-error"},TR={class:"form-row"},MR={class:"form-group",style:{flex:"1"}},AR={class:"form-group",style:{flex:"1"}},ER={class:"form-group",style:{flex:"0 0 auto"}},PR={class:"form-group"},DR={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=T({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ze(()=>a.location,f=>{f&&(i.value={...f})},{immediate:!0,deep:!0});const r=()=>{s("update:isDirty",!0),s("update:location",{...i.value})},u=()=>{if(!zr(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}s("save",i.value)},d=()=>{s("close")};return(f,p)=>(v(),qe(Gt,{show:e.show,title:`Add ${O(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:ze(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+C(O(o).checkpoint),1)]),default:ze(()=>[l("form",{onSubmit:rt(u,["prevent"])},[l("div",SR,[p[7]||(p[7]=l("label",null,"Name",-1)),Ue(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>i.value.name=g),type:"text",required:"",class:"form-input",onInput:r},null,544),[[st,i.value.name]])]),l("div",xR,[p[8]||(p[8]=l("label",null,"Description",-1)),Ue(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>i.value.description=g),type:"text",class:"form-input",onInput:r},null,544),[[st,i.value.description]])]),l("div",IR,[p[9]||(p[9]=l("label",null,"What3Words (optional)",-1)),Ue(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>i.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:r},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!O(zr)(i.value.what3Words)?(v(),m("small",$R," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),l("div",TR,[l("div",MR,[p[10]||(p[10]=l("label",null,"Longitude",-1)),Ue(l("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>i.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),l("div",AR,[p[11]||(p[11]=l("label",null,"Latitude",-1)),Ue(l("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>i.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),l("div",ER,[p[12]||(p[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>f.$emit("set-on-map"))},"  ")])]),l("div",PR,[l("label",null,"Required "+C(O(o).people),1),Ue(l("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>i.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:r},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},RR=je(DR,[["__scopeId","data-v-fb51fed0"]]),OR=["aria-expanded","title"],BR=["innerHTML"],NR={key:0,class:"dropdown-menu"},FR=["onClick"],UR=["innerHTML"],zR={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=Hv(),s=T(!1),i=T(null),r={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:r.system},{value:"light",label:"Light",icon:r.light},{value:"dark",label:"Dark",icon:r.dark}],d=V(()=>o.value?r.dark:r.light),f=()=>{s.value=!s.value},p=k=>{a(k),s.value=!1},g=k=>{i.value&&!i.value.contains(k.target)&&(s.value=!1)};return nn(()=>{document.addEventListener("click",g)}),xn(()=>{document.removeEventListener("click",g)}),(k,y)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[l("button",{class:"theme-toggle-btn",onClick:f,type:"button","aria-expanded":s.value,title:O(o)?"Dark mode":"Light mode"},[l("span",{class:"theme-icon",innerHTML:d.value},null,8,BR)],8,OR),s.value?(v(),m("div",NR,[(v(),m(Ie,null,Ne(u,_=>l("button",{key:_.value,class:pe(["dropdown-item",{active:O(t)===_.value}]),onClick:w=>p(_.value)},[l("span",{class:"option-icon",innerHTML:_.icon},null,8,UR),l("span",null,C(_.label),1)],10,FR)),64))])):M("",!0)],512))}},HR=je(zR,[["__scopeId","data-v-969124a4"]]),VR={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},GR=["id"],jR=["filter"],ZR={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){_y(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=V(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),m("svg",VR,[l("defs",null,[l("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[l("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,GR)]),l("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,jR),a[2]||(a[2]=l("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),l("g",{class:pe({"marshal-figure":e.animate})},[...a[1]||(a[1]=[l("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),l("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},qR=je(ZR,[["__scopeId","data-v-3e647831"]]),WR={class:"header"},KR={class:"header-left"},JR={key:0},YR={class:"event-date"},XR={class:"header-actions"},QR={class:"container"},eO={class:"tabs-nav"},tO={class:"tab-content-wrapper"},nO={class:"add-note-form"},oO={class:"modal-footer-actions"},sO=["disabled"],aO=6e4,iO={__name:"AdminEventManage",setup(e){const t=uc(),o=Gi(),a=Nv(),s=V(()=>t.params.eventId),{activeTab:i,switchTab:r}=Fv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:f,confirmModalIsDanger:p,confirmModalConfirmText:g,showConfirm:k,handleConfirmModalConfirm:y,handleConfirmModalCancel:_}=$b(),{tabLabels:w,terms:S,termsLower:E}=ut(),A=Tb(),x=Ab(s),D=Mb(s),{colorScheme:R}=Hv(),H=V(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:w.value.course,icon:"course"},{value:"areas",label:w.value.areas,icon:"area"},{value:"checkpoints",label:w.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:w.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:w.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),$=T(null),B=T([]),N=T([]),Z=T({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),P=T(null),G=T(!1),Y=T(!1),te=T(null),Q=T(null),X=T(!1),ne=T(!1),F=T(null),K=T(""),fe=D.eventAdmins,he=D.showAddAdmin,Re=x.showUploadRoute,et=x.uploading,Xe=x.uploadError,He=x.showImportLocations,Ke=x.showImportMarshals,ye=x.importing,Ve=x.importingMarshals,me=x.importError,xe=x.importResult,De=x.importMarshalsResult,q=T(!1),J=T(!1),ve=T({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Se=T(!1),re=T(!1),ue=T({marshalName:"",locations:[],marshal:null}),ee=T(null),W=T([]),ie=T(!1),Le=T(null),Ce=T(null),ke=T(null),j=T({}),se=T({id:"",name:"",email:"",phoneNumber:"",notes:""}),de=T(!1),Me=T([]),Oe=T([]),Be=T([]),Ye=T([]),mt=T(!1),_t=T(""),bt=T(""),Mt=T({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),wt=T(!1),Nt=T(!1),Ft=T(""),Fn=T(""),Qn=T(0),fn=T({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),jt=T([]),yt=T(null),eo=T(!1),Un=T("details"),to=T(null),pn=T(null),Zt=T(null),ks=A.isAddingMultipleCheckpoints,no=A.multiCheckpointCounter,Co=A.isFullscreenMapActive,le=A.fullscreenMode,ce=A.fullscreenContext,ge=A.tempLocationCoords,ot=A.tempCheckpoints,Ge=A.savedMapCenter,St=A.savedMapZoom,Wt=A.isDrawingAreaBoundary,Qt=T(null),Do=T([]),uo=T(null),Ro=T(!1),zn=T("details"),Ma=T(null),Oo=T([]),Lo=T(null),Zs=T(!1),qs=T("details"),vn=T([]),Bo=T(!1),on=T(null),So=T(!1),ho=T(!1),_s=T(!1),xo=T(""),bs=T(!1),Io=T([]),No=T({builtInRoles:[],customRoles:[]}),mn=T(null),$o=T(!1),Hn=T("details"),vt=T(null),xt=T(""),To=T(null),fo=T(null),Fo=V(()=>fo.value?.marshalId!=null),Aa=()=>{o.push(`/event/${t.params.eventId}`)},ht=V(()=>`${window.location.origin}/#/event/${t.params.eventId}`),Ut=V(()=>{const z=[];return N.value.forEach(ae=>{ae.assignments&&z.push(...ae.assignments)}),z}),Ea=V(()=>{if(!Le.value)return N.value;const z=Le.value.assignedLocationIds||[],ae=Be.value.map(be=>be.locationId),_e=Ye.value;return N.value.filter(be=>!z.includes(be.id)&&!ae.includes(be.id)||_e.includes(be.id))}),Uo=V(()=>{let z=W.value;if(P.value){const ae=P.value.assignments.map(be=>be.marshalName),_e=Me.value.map(be=>be.marshalName);z=W.value.filter(be=>!ae.includes(be.name)&&!_e.includes(be.name))}return z.slice().sort((ae,_e)=>ae.name.localeCompare(_e.name))}),gn=V(()=>le.value==="draw-area"&&yt.value?.polygon?.length>0||A.canCompleteFullscreen.value),ci=V(()=>le.value==="move-checkpoint"&&P.value?.id?P.value.id:null),Ws=V(()=>{const z=[...N.value];return le.value==="place-checkpoint"&&ge.value&&z.push({id:"temp-single",name:fn.value.name||"New Checkpoint",latitude:ge.value.lat,longitude:ge.value.lng,requiredMarshals:fn.value.requiredMarshals||1,assignments:[],isTemporary:!0}),le.value==="move-checkpoint"&&ge.value&&P.value&&z.push({id:"temp-move",name:P.value.name+" (new position)",latitude:ge.value.lat,longitude:ge.value.lng,requiredMarshals:P.value.requiredMarshals,assignments:[],isTemporary:!0}),le.value==="add-multiple"&&z.push(...ot.value),z}),po=V(()=>{let z=[...jt.value];return le.value==="draw-area"&&yt.value?.id&&(z=z.filter(ae=>ae.id!==yt.value.id)),le.value==="draw-area"&&yt.value?.polygon?.length>0&&z.push({...yt.value,id:yt.value.id||"temp-area"}),z}),qt=V(()=>{if(!Le.value||!vn.value.length)return[];const z=Le.value.id,ae=Le.value.assignedLocationIds||[];return vn.value.filter(_e=>{if(_e.reportedBy?.marshalId===z)return!0;const be=_e.context?.checkpoint?.checkpointId;return!!(be&&ae.includes(be))}).sort((_e,be)=>new Date(be.incidentTime||be.createdAt)-new Date(_e.incidentTime||_e.createdAt))}),zo=V(()=>{if(!P.value||!vn.value.length)return[];const z=P.value.id;return vn.value.filter(ae=>ae.context?.checkpoint?.checkpointId===z).sort((ae,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(ae.incidentTime||ae.createdAt))}),yn=V(()=>{if(!yt.value||!vn.value.length)return[];const z=yt.value.id,ae=N.value.filter(_e=>_e.areaIds&&_e.areaIds.includes(z)).map(_e=>_e.id);return vn.value.filter(_e=>{const be=_e.context?.checkpoint?.checkpointId;return be&&ae.includes(be)}).sort((_e,be)=>new Date(be.incidentTime||be.createdAt)-new Date(_e.incidentTime||_e.createdAt))}),In=z=>{on.value=z,So.value=!0},Pa=z=>{on.value=z,So.value=!0},kn=z=>{on.value=z,So.value=!0},Da=()=>{o.push("/sessions")},zt=(z=!0)=>{de.value=z},ws=()=>{wt.value=!0},Ks=async z=>{try{z&&(Mt.value={...z});const ae=Bl($.value.eventDate),_e=Mt.value.eventDate;if(ae!==_e){const be=B.value.filter(tt=>tt.startTime||tt.endTime);if(be.length>0){Ft.value=ae,Fn.value=_e,Qn.value=be.length,Nt.value=!0;return}}await Js(!1,null)}catch(ae){console.error("Failed to update event:",ae),alert("Failed to update event. Please try again.")}},Js=async(z,ae)=>{try{if(await a.updateEvent(t.params.eventId,{...Mt.value,defaultCheckpointStyleMapRotation:Mt.value.defaultCheckpointStyleMapRotation!=null?String(Mt.value.defaultCheckpointStyleMapRotation):null}),z&&ae!==null){const _e=Math.floor(Math.abs(ae)/1e3),be=ae<0,tt=Math.floor(_e/3600),Lt=Math.floor(_e%3600/60),Et=_e%60,un=`${be?"-":""}${tt.toString().padStart(2,"0")}:${Lt.toString().padStart(2,"0")}:${Et.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,un)}await $n(),wt.value=!1}catch(_e){console.error("Failed to update event:",_e),alert("Failed to update event. Please try again.")}},Ys=async({shouldShift:z,timeDelta:ae})=>{Nt.value=!1,await Js(z,ae)},Ra=()=>{Nt.value=!1,$n()},$n=async()=>{try{await a.fetchEvent(t.params.eventId),$.value=a.currentEvent,$.value&&(Mt.value={name:$.value.name||"",description:$.value.description||"",eventDate:Bl($.value.eventDate),timeZoneId:$.value.timeZoneId||"UTC",peopleTerm:$.value.peopleTerm||"Marshals",checkpointTerm:$.value.checkpointTerm||"Checkpoints",areaTerm:$.value.areaTerm||"Areas",checklistTerm:$.value.checklistTerm||"Checklists",courseTerm:$.value.courseTerm||"Course",defaultCheckpointStyleType:$.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:$.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:$.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:$.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:$.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:$.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:$.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:$.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:$.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:$.value.brandingHeaderGradientEnd||"",brandingLogoUrl:$.value.brandingLogoUrl||"",brandingLogoPosition:$.value.brandingLogoPosition||"",brandingAccentColor:$.value.brandingAccentColor||"",brandingPageGradientStart:$.value.brandingPageGradientStart||"",brandingPageGradientEnd:$.value.brandingPageGradientEnd||""},wt.value=!1,xu($.value));const z=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Fa(),Ho(),lt(),_n(),It(),oo(),vo()]);B.value=a.locations,N.value=a.eventStatus.locations,z.forEach((ae,_e)=>{ae.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][_e]}:`,ae.reason)})}catch(z){console.error("Failed to load event data:",z)}},Ho=async()=>{try{const z=await ms.getByEvent(t.params.eventId);W.value=z.data,Z.value.marshals=Date.now()}catch(z){console.error("Failed to load marshals:",z)}},lt=async()=>{try{const z=await _a.getByEvent(t.params.eventId);jt.value=z.data,Z.value.areas=Date.now()}catch(z){console.error("Failed to load areas:",z)}},_n=async()=>{try{const[z,ae]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);Do.value=z.data,Ma.value=ae.data,Z.value.checklists=Date.now()}catch(z){console.error("Failed to load checklists:",z)}},It=async()=>{try{const z=await Es.getByEvent(t.params.eventId);Oo.value=z.data,Z.value.notes=Date.now()}catch(z){console.error("Failed to load notes:",z)}},oo=async()=>{Bo.value=!0;try{const z=await fs.getAll(t.params.eventId);vn.value=z.data.incidents||[],Z.value.incidents=Date.now()}catch(z){console.error("Failed to load incidents:",z)}finally{Bo.value=!1}},vo=async()=>{try{const[z,ae]=await Promise.all([fa.getByEvent(t.params.eventId),fa.getRoles(t.params.eventId)]);Io.value=z.data,No.value=ae.data,Z.value.contacts=Date.now()}catch(z){console.error("Failed to load contacts:",z)}},mo=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),B.value=a.locations,Z.value.checkpoints=Date.now(),N.value=a.eventStatus.locations},is=async()=>{await Promise.all([Ho(),a.fetchEventStatus(t.params.eventId)]),N.value=a.eventStatus.locations},go=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),lt()]),B.value=a.locations,N.value=a.eventStatus.locations},Xs=async()=>{await a.fetchEventStatus(t.params.eventId),N.value=a.eventStatus.locations},Vo=()=>{yt.value=null,Un.value="details",de.value=!1,eo.value=!0},Kt=z=>{yt.value=z,pn.value=z.id,Un.value="details",de.value=!1,eo.value=!0},Go=async z=>{try{let ae;if(yt.value&&yt.value.id){if(ae=yt.value.id,await _a.update(t.params.eventId,ae,z),z.checklistChanges&&z.checklistChanges.length>0)for(const _e of z.checklistChanges)try{_e.complete?await Rt.complete(t.params.eventId,_e.itemId,{marshalId:_e.marshalId,contextType:_e.contextType,contextId:_e.contextId}):await Rt.uncomplete(t.params.eventId,_e.itemId,{marshalId:_e.marshalId,contextType:_e.contextType,contextId:_e.contextId})}catch(be){console.error("Failed to update checklist item:",_e,be)}}else ae=(await _a.create({eventId:t.params.eventId,...z})).data.id;if(z.pendingContacts&&z.pendingContacts.length>0&&ae)for(const _e of z.pendingContacts)try{const be=_e.scopeConfigurations?JSON.parse(JSON.stringify(_e.scopeConfigurations)):[],tt=be.find(Lt=>Lt.scope==="EveryoneInAreas"&&Lt.itemType==="Area");tt?(tt.ids||(tt.ids=[]),tt.ids.includes(ae)||tt.ids.push(ae)):be.push({scope:"EveryoneInAreas",itemType:"Area",ids:[ae]}),await fa.update(t.params.eventId,_e.contactId,{..._e,scopeConfigurations:be})}catch(be){console.error("Failed to add area to contact:",_e,be)}if(z.contactsToRemove&&z.contactsToRemove.length>0&&ae)for(const _e of z.contactsToRemove)try{const be=Io.value.find(Et=>Et.contactId===_e);if(!be)continue;const tt=be.scopeConfigurations?JSON.parse(JSON.stringify(be.scopeConfigurations)):[],Lt=tt.find(Et=>Et.scope==="EveryoneInAreas"&&Et.itemType==="Area");if(Lt&&Lt.ids){Lt.ids=Lt.ids.filter(un=>un!==ae);const Et=Lt.ids.length>0?tt:tt.filter(un=>!(un.scope==="EveryoneInAreas"&&un.itemType==="Area"));await fa.update(t.params.eventId,_e,{...be,scopeConfigurations:Et})}}catch(be){console.error("Failed to remove area from contact:",_e,be)}(z.pendingContacts&&z.pendingContacts.length>0||z.contactsToRemove&&z.contactsToRemove.length>0)&&await vo(),await lt(),await $n(),Qs()}catch(ae){console.error("Failed to save area:",ae),alert(ae.response?.data?.message||"Failed to save area. Please try again.")}},Oa=async z=>{k(`Delete ${E.value.area}`,`Are you sure you want to delete this ${E.value.area}? ${S.value.checkpoints} will be automatically reassigned.`,async()=>{try{await _a.delete(t.params.eventId,z),await _a.recalculate(t.params.eventId),await lt(),await $n(),Qs()}catch(ae){console.error(`Failed to delete ${E.value.area}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${E.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Qs=()=>{eo.value=!1,yt.value=null,pn.value=null,de.value=!1,Wt.value=!1,Zt.value=null},Ki=({marshal:z,area:ae})=>{mn.value=null,Hn.value="details",de.value=!1,vt.value=ae,xt.value="",To.value=z.id,$o.value=!0},ui=({name:z,area:ae})=>{mn.value=null,Hn.value="details",de.value=!1,vt.value=ae,xt.value=z,To.value=null,$o.value=!0},ea=z=>{mn.value=z,Hn.value="details",de.value=!1,$o.value=!0},di=()=>{uo.value=null,zn.value="details",de.value=!1,Ro.value=!0},ta=(z,ae="details")=>{uo.value=z,zn.value=ae,de.value=!1,Ro.value=!0},gt=async z=>{try{if(uo.value&&uo.value.itemId)await Rt.update(t.params.eventId,uo.value.itemId,z);else{const ae=await Rt.create(t.params.eventId,z);ae.data.count&&ae.data.count>1&&(_t.value="Checklist Items Created",bt.value=`Successfully created ${ae.data.count} checklist items.`,mt.value=!0)}await _n(),bn()}catch(ae){console.error("Failed to save checklist item:",ae);const _e=ae.response?.data?.message||"Failed to save checklist item. Please try again.";alert(_e)}},Ji=async z=>{k(`Delete ${E.value.checklist}`,`Are you sure you want to delete this ${E.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,z),await _n(),bn()}catch(ae){console.error(`Failed to delete ${E.value.checklist}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${E.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},bn=()=>{Ro.value=!1,uo.value=null,de.value=!1},Cs=()=>{Lo.value=null,qs.value="details",de.value=!1,Zs.value=!0},Ba=z=>{Lo.value=z,qs.value="details",de.value=!1,Zs.value=!0},hi=async z=>{try{Lo.value&&Lo.value.noteId?await Es.update(t.params.eventId,Lo.value.noteId,z):await Es.create(t.params.eventId,z),await It(),Na()}catch(ae){console.error("Failed to save note:",ae);const _e=ae.response?.data?.message||"Failed to save note. Please try again.";alert(_e)}},na=async z=>{k("Delete note","Are you sure you want to delete this note?",async()=>{try{await Es.delete(t.params.eventId,z),await It(),Na()}catch(ae){console.error("Failed to delete note:",ae),alert(ae.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Na=()=>{Zs.value=!1,Lo.value=null,de.value=!1},Pe=()=>{ho.value=!0},Ae=async z=>{try{await fs.create(t.params.eventId,z),ho.value=!1,await oo()}catch(ae){console.error("Failed to report incident:",ae),alert(ae.response?.data?.message||"Failed to report incident. Please try again.")}},at=z=>{on.value=z,So.value=!0},ft=()=>{So.value=!1,on.value=null},Ct=async({incidentId:z,status:ae})=>{try{if(await fs.updateStatus(t.params.eventId,z,{status:ae}),await oo(),on.value?.incidentId===z){const _e=vn.value.find(be=>be.incidentId===z);_e&&(on.value=_e)}}catch(_e){console.error("Failed to update incident status:",_e),alert(_e.response?.data?.message||"Failed to update status. Please try again.")}},Ht=()=>{xo.value="",_s.value=!0},Vn=()=>{_s.value=!1,xo.value=""},Gn=async()=>{if(!(!xo.value.trim()||!on.value)){bs.value=!0;try{await fs.addNote(t.params.eventId,on.value.incidentId,xo.value.trim()),Vn(),await oo();const z=vn.value.find(ae=>ae.incidentId===on.value.incidentId);z&&(on.value=z)}catch(z){console.error("Failed to add note to incident:",z),alert(z.response?.data?.message||"Failed to add note. Please try again.")}finally{bs.value=!1}}},At=()=>{mn.value=null,Hn.value="details",vt.value=null,de.value=!1,$o.value=!0},Tn=z=>{mn.value=z,Hn.value="details",de.value=!1,$o.value=!0},$t=async z=>{try{let ae=null;const _e=!mn.value||!mn.value.contactId,be=!!vt.value;if(mn.value&&mn.value.contactId)await fa.update(t.params.eventId,mn.value.contactId,z);else{const tt=await fa.create(t.params.eventId,z);ae=tt.data?.contactId||tt.data?.id}if(await vo(),_e&&be&&ae&&to.value){const tt=Io.value.find(Lt=>Lt.contactId===ae);tt&&to.value.addPendingContact(tt)}Mn()}catch(ae){console.error("Failed to save contact:",ae);const _e=ae.response?.data?.message||"Failed to save contact. Please try again.";alert(_e)}},Jt=async z=>{k("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await fa.delete(t.params.eventId,z),await vo(),to.value&&to.value.removeContactById(z),Mn()}catch(ae){console.error("Failed to delete contact:",ae),alert(ae.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Mn=()=>{$o.value=!1,mn.value=null,vt.value=null,xt.value="",To.value=null,de.value=!1},jo=z=>{Zt.value={...z,id:yt.value?.id};const ae={...z,id:yt.value?.id,polygon:[]};yt.value=ae;let _e=!1;if(z.polygon&&z.polygon.length>0){const be=z.polygon.map(wn=>wn.lat||wn[0]),tt=z.polygon.map(wn=>wn.lng||wn[1]),Lt=Math.min(...be),Et=Math.max(...be),un=Math.min(...tt),ra=Math.max(...tt);Ge.value={lat:(Lt+Et)/2,lng:(un+ra)/2};const Li=Et-Lt,Ss=ra-un,ca=Math.max(Li,Ss);St.value=ca<.005?17:ca<.01?16:ca<.02?15:ca<.05?14:13,_e=!0}if(!_e&&z.checkpointIds&&z.checkpointIds.length>0){const be=N.value.filter(tt=>z.checkpointIds.includes(tt.id));if(be.length>0){const tt=be.map(Et=>Et.latitude).filter(Boolean),Lt=be.map(Et=>Et.longitude).filter(Boolean);if(tt.length>0&&Lt.length>0){const Et=Math.min(...tt),un=Math.max(...tt),ra=Math.min(...Lt),Li=Math.max(...Lt);Ge.value={lat:(Et+un)/2,lng:(ra+Li)/2};const Ss=un-Et,ca=Li-ra,wn=Math.max(Ss,ca);St.value=wn<.005?16:wn<.01?15:wn<.02?14:wn<.05?13:12,_e=!0}}}if(!_e&&te.value){const be=te.value.getMapCenter(),tt=te.value.getMapZoom();be&&tt!==null&&(Ge.value=be,St.value=tt)}Co.value=!0,le.value="draw-area",Wt.value=!0,ce.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},jn=z=>{Zt.value?yt.value={...yt.value||{},...Zt.value,polygon:z}:yt.value={...yt.value,polygon:z}},fi=z=>{A.handlePolygonDrawing(z)},Yi=()=>{Wt.value=!1,Zt.value&&(yt.value=Zt.value,eo.value=!0,Zt.value=null)},Fa=()=>D.loadEventAdmins(),kc=async z=>{try{await D.addAdmin(z),await Fa(),Xi()}catch(ae){console.error("Failed to add admin:",ae),alert(ae.response?.data?.message||"Failed to add administrator. Please try again.")}},Kl=async z=>{k("Remove administrator",`Remove ${z} as an administrator?`,async()=>{try{await D.removeAdmin(z),await Fa()}catch(ae){console.error("Failed to remove admin:",ae),alert(ae.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},Xi=()=>{D.closeAddAdminModal(),de.value=!1},pi=async z=>{await x.uploadRoute(z)&&(await mo(),ls())},ls=()=>{x.closeUploadRouteModal()},_c=async({file:z,deleteExisting:ae})=>{const _e=await x.importLocations(z,ae);if(_e){await go(),oa();const be=x.formatImportResultMessage(_e,"location");_t.value="Import Complete",bt.value=be,mt.value=!0}},oa=()=>{x.closeImportLocationsModal()},so=async z=>{if(Y.value)fn.value.latitude=z.lat,fn.value.longitude=z.lng;else if(J.value)ve.value.latitude=z.lat,ve.value.longitude=z.lng,P.value&&(P.value={...P.value,latitude:z.lat,longitude:z.lng}),J.value=!1,q.value=!0,zt();else if(ks.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${no.value}`,description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""}),no.value++,await $n()}catch(ae){console.error("Failed to create checkpoint:",ae),alert("Failed to create checkpoint. Please try again.")}},Jl=z=>{A.handleFullscreenMapClick(z)},Yl=z=>{fn.value={...z}},bc=()=>{Y.value=!1,A.enterPlaceCheckpointMode()},Qi=()=>{A.saveMapState(te.value),fn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},A.enterPlaceCheckpointMode()},el=()=>{A.saveMapState(te.value),Co.value=!0,le.value="view",ce.value={title:"Course map",description:""}},wc=()=>{A.saveMapState(te.value),yt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:jt.value.length},A.enterDrawAreaMode()},Cc=()=>{P.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ve.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Me.value=[],Oe.value=[],de.value=!1,q.value=!0},Xl=()=>{const z=A.calculateStartingNumber(N);A.saveMapState(te.value),A.enterAddMultipleMode(z)},Lc=()=>{if(le.value==="place-checkpoint"){const z=A.getPlacedCoords()||{lat:0,lng:0};P.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ve.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""},Me.value=[],Oe.value=[],de.value=!1,vi(),q.value=!0}else if(le.value==="move-checkpoint"){const z=A.getPlacedCoords();z&&(ve.value.latitude=z.lat,ve.value.longitude=z.lng,P.value&&(P.value={...P.value,...Qt.value||{},latitude:z.lat,longitude:z.lng}),zt()),Qt.value=null,vi(),q.value=!0}else if(le.value==="draw-area"){const z=A.getCompletedPolygon();z&&(Zt.value?yt.value={...yt.value||{},...Zt.value,polygon:z}:yt.value={...yt.value||{},polygon:z}),Zt.value=null,vi()}else le.value==="add-multiple"&&yo()},yo=async()=>{const z=A.getTempCheckpoints();try{for(const ae of z)await a.createLocation({eventId:t.params.eventId,name:ae.name,description:ae.description,latitude:ae.latitude,longitude:ae.longitude,requiredMarshals:ae.requiredMarshals,what3Words:ae.what3Words});A.clearTempCheckpoints(),vi(),await $n()}catch(ae){console.error("Failed to create checkpoints:",ae),alert("Failed to create checkpoints. Please try again.")}},sa=()=>{le.value==="draw-area"?Zt.value&&(yt.value=Zt.value,Zt.value=null):le.value==="move-checkpoint"&&(Qt.value&&P.value&&Object.assign(P.value,Qt.value),q.value=!0,J.value=!1),A.cancelFullscreen()},vi=()=>{A.exitFullscreen()},Zo=z=>{mi(z)},mi=z=>{P.value=z,ve.value={id:z.id,name:z.name,description:z.description||"",latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||""},Me.value=[],Oe.value=[],de.value=!1,q.value=!0,setTimeout(()=>{te.value?.scrollMapIntoView()},100)},aa=async z=>{if(!zr(z.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...z}),await $n(),Ql()}catch(ae){console.error("Failed to save location:",ae),alert("Failed to save location. Please try again.")}},Ql=()=>{Y.value=!1,fn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},de.value=!1,de.value=!1},Ls=()=>{q.value=!1,P.value=null,G.value=!1,J.value=!1,Se.value=!1,Qt.value=null,ve.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Me.value=[],Oe.value=[],de.value=!1},gi=()=>{Se.value=!1},yi=()=>{Se.value=!0},Sc=z=>{z?.formData&&(Qt.value=z.formData),q.value=!1,ge.value=null;const ae=Qt.value?.latitude??P.value?.latitude,_e=Qt.value?.longitude??P.value?.longitude;if(ae&&_e)Ge.value={lat:ae,lng:_e},St.value=16;else if(te.value){const tt=te.value.getMapCenter(),Lt=te.value.getMapZoom();tt&&Lt!==null&&(Ge.value=tt,St.value=Lt)}const be=Qt.value?.name||P.value?.name;Co.value=!0,le.value="move-checkpoint",ce.value={title:`Move ${E.value.checkpoint}: ${be}`,description:"Click on the map to set the new location"}},rs=async z=>{if(!zr(z.what3Words)){alert("Invalid What3Words format.");return}try{const ae=!P.value.id;if(ae){const _e=await a.createLocation({eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const be of z.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:_e.id,marshalId:be.marshalId})}else{const _e=P.value.id;if(await Yn.update(t.params.eventId,_e,{eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[]}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const be of z.pendingNewChecklistItems)be.text?.trim()&&await Rt.create(t.params.eventId,{text:be.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[_e]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const be of z.pendingNewNotes)!be.title?.trim()&&!be.content?.trim()||await Es.create(t.params.eventId,{title:be.title||"Untitled",content:be.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[_e]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const be of Oe.value)await a.deleteAssignment(t.params.eventId,be);if(z.assignmentsToRemove&&z.assignmentsToRemove.length>0)for(const be of z.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,be);for(const be of Me.value)await a.createAssignment({eventId:t.params.eventId,locationId:P.value.id,marshalId:be.marshalId});if(z.checkInChanges&&z.checkInChanges.length>0)for(const be of z.checkInChanges){const tt=P.value.assignments.find(Lt=>Lt.id===be.assignmentId);tt&&tt.isCheckedIn!==be.shouldBeCheckedIn&&await La.adminCheckIn(t.params.eventId,be.assignmentId)}}if(!ae&&z.checklistChanges&&z.checklistChanges.length>0)for(const _e of z.checklistChanges)try{_e.complete?await Rt.complete(t.params.eventId,_e.itemId,{marshalId:_e.marshalId,contextType:_e.contextType,contextId:_e.contextId}):await Rt.uncomplete(t.params.eventId,_e.itemId,{marshalId:_e.marshalId,contextType:_e.contextType,contextId:_e.contextId})}catch(be){console.error("Failed to update checklist item:",_e,be)}await $n(),Ls()}catch(ae){console.error("Failed to update location:",ae),alert("Failed to update location. Please try again.")}},ki=async z=>{k(`Delete ${E.value.checkpoint}`,`Are you sure you want to delete this ${E.value.checkpoint}?`,async()=>{try{await Yn.delete(t.params.eventId,z),await go(),Ls()}catch(ae){console.error(`Failed to delete ${E.value.checkpoint}:`,ae),alert(`Failed to delete ${E.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},xc=async z=>{try{if(Q.value&&Q.value.setCheckingIn(z.id),await La.adminCheckIn(t.params.eventId,z.id),await Xs(),P.value){const ae=N.value.find(_e=>_e.id===P.value.id);ae&&(P.value=ae)}}catch(ae){console.error("Failed to toggle check-in:",ae),alert("Failed to toggle check-in. Please try again.")}finally{Q.value&&Q.value.setCheckingIn(null)}},tl=z=>{const ae=z?.id??z;if(ae?.toString().startsWith("temp-")){const _e=P.value.assignments.find(be=>be.id===ae);_e&&(Me.value=Me.value.filter(be=>be.marshalId!==_e.marshalId)),P.value.assignments=P.value.assignments.filter(be=>be.id!==ae),zt()}else Oe.value.includes(ae)||(Oe.value.push(ae),P.value.assignments=P.value.assignments.filter(_e=>_e.id!==ae),zt())},Ic=async z=>{const ae=W.value.find(be=>be.id===z);if(!ae)return;const _e=N.value.filter(be=>be.assignments?.some(tt=>tt.marshalId===z&&be.id!==P.value.id));if(_e.length>0){ue.value={marshalName:ae.name,locations:_e.map(tt=>tt.name),marshal:ae};const be=await new Promise(tt=>{ee.value=tt,re.value=!0});if(be==="cancel"||be==="choose-other")return;if(be==="move")for(const tt of _e){const Lt=tt.assignments.find(Et=>Et.marshalId===z);if(Lt){Oe.value.push(Lt.id);const Et=N.value.findIndex(un=>un.id===tt.id);Et!==-1&&(N.value[Et].assignments=N.value[Et].assignments.filter(un=>un.id!==Lt.id))}}}Me.value.push({marshalId:ae.id,marshalName:ae.name}),P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ae.id,marshalName:ae.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0}),zt(),gi()},qo=async z=>{try{const _e=(await ms.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber})).data;await Ho(),Me.value.push({marshalId:_e.id,marshalName:_e.name}),P.value&&(P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:_e.id,marshalName:_e.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0})),zt(),gi()}catch(ae){console.error("Failed to create marshal:",ae),alert("Failed to create marshal. Please try again.")}},$c=()=>{Le.value=null,j.value={},se.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Ye.value=[],de.value=!1,ie.value=!0},ia=z=>{Le.value=z,j.value={},se.value={id:z.id,name:z.name,email:z.email||"",phoneNumber:z.phoneNumber||"",notes:z.notes||""},Be.value=[],Ye.value=[],de.value=!1,ie.value=!0},er=V(()=>{if(!Le.value)return[];const z=[];return N.value.forEach(ae=>{ae.assignments.filter(be=>be.marshalName===Le.value.name&&!Ye.value.includes(be.id)).forEach(be=>{z.push({...be,locationName:ae.name,locationDescription:ae.description||""})})}),Be.value.forEach((ae,_e)=>{const be=N.value.find(tt=>tt.id===ae.locationId);be&&z.push({id:`pending-${_e}`,locationId:ae.locationId,locationName:be.name,locationDescription:be.description||"",marshalId:Le.value.id,marshalName:Le.value.name,isCheckedIn:!1,isPending:!0})}),z}),Wo=async z=>{try{let ae=Le.value?.id,_e=!1;if(Le.value){if(await ms.update(t.params.eventId,Le.value.id,{name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const be of z.pendingNewChecklistItems)be.text?.trim()&&await Rt.create(t.params.eventId,{text:be.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const be of z.pendingNewNotes)!be.title?.trim()&&!be.content?.trim()||await Es.create(t.params.eventId,{title:be.title||"Untitled",content:be.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ae=(await ms.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes,pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]})).data.id,_e=!0;for(const be of Ye.value)await a.deleteAssignment(t.params.eventId,be);if(z.assignmentsToRemove&&z.assignmentsToRemove.length>0)for(const be of z.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,be);for(const be of Be.value)await a.createAssignment({eventId:t.params.eventId,locationId:be.locationId,marshalId:ae});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const be of z.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:be.locationId,marshalId:ae});if(z.checkInChanges&&z.checkInChanges.length>0){const be=er.value;for(const tt of z.checkInChanges){const Lt=be.find(Et=>Et.id===tt.assignmentId);Lt&&Lt.isCheckedIn!==tt.shouldBeCheckedIn&&await La.adminCheckIn(t.params.eventId,tt.assignmentId)}}if(z.checklistChanges&&z.checklistChanges.length>0)for(const be of z.checklistChanges)try{const tt={marshalId:ae};be.contextType&&be.contextId&&(tt.contextType=be.contextType,tt.contextId=be.contextId),be.complete?await Rt.complete(t.params.eventId,be.itemId,tt):await Rt.uncomplete(t.params.eventId,be.itemId,tt)}catch(tt){console.error("Failed to process checklist change:",tt);const Lt=tt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Lt}`)}if(await $n(),P.value){const be=N.value.find(tt=>tt.id===P.value.id);be&&(P.value=be)}za(),_e&&(F.value=ae,K.value=z.name,ne.value=!0)}catch(ae){console.error("Failed to save marshal:",ae);const _e=ae.response?.data?.message||"Failed to save marshal. Please try again.";if(ae.response?.status===400){const be=_e.toLowerCase();be.includes("name")?(j.value={name:_e},ke.value&&(ke.value.switchToTab("details"),ke.value.focusField("name"))):be.includes("email")?(j.value={email:_e},ke.value&&(ke.value.switchToTab("details"),ke.value.focusField("email"))):(j.value={general:_e},ke.value&&ke.value.switchToTab("details"))}else j.value={general:_e},ke.value&&ke.value.switchToTab("details")}},Ua=async z=>{const ae=z||Le.value?.id;if(!ae){console.error("No marshal ID to delete");return}const _e=E.value.person;k(`Delete ${_e}`,`Are you sure you want to delete this ${_e}?`,async()=>{try{await ms.delete(t.params.eventId,ae),await is(),za()}catch(be){console.error(`Failed to delete ${_e}:`,be),alert(`Failed to delete ${_e}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},tr=z=>{Ua(z.id)},nl=z=>{const ae=z?.id??z;if(ae?.toString().startsWith("pending-")){const _e=z?.locationId;_e&&(Be.value=Be.value.filter(be=>be.locationId!==_e)),zt()}else Ye.value.includes(ae)||(Ye.value.push(ae),zt())},_i=z=>{Be.value.push({locationId:z}),zt()},za=()=>{ie.value=!1,Le.value=null,Ce.value=null,j.value={},se.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Ye.value=[],de.value=!1},bi=async z=>{const ae=W.value.find(_e=>_e.id===z.marshalId);if(!ae){console.error("Marshal not found:",z.marshalId);return}Ce.value=P.value?.id||null,de.value=!1,Le.value=ae,ie.value=!0},la=z=>{const ae=N.value.find(_e=>_e.id===z.locationId);if(!ae){console.error("Location not found:",z.locationId);return}G.value=!0,de.value=!1,P.value=ae,q.value=!0},wi=async({file:z})=>{const ae=await x.importMarshals(z);if(ae){await is(),Ci();const _e=x.formatImportResultMessage(ae,"marshal");_t.value="Import Complete",bt.value=_e,mt.value=!0}},Ci=()=>{x.closeImportMarshalsModal()},nr=z=>{ee.value&&(ee.value(z),ee.value=null),re.value=!1};let Ha=null;const Va=async()=>{try{const z=t.params.eventId,ae=await Yn.getDynamicCheckpoints(z);if(ae.data&&Array.isArray(ae.data))for(const _e of ae.data){const be=N.value.find(tt=>tt.id===_e.checkpointId);be&&(be.latitude=_e.latitude,be.longitude=_e.longitude,be.lastLocationUpdate=_e.lastLocationUpdate)}}catch(z){console.warn("Failed to poll dynamic checkpoints:",z)}},or=()=>{Ha||!N.value.some(ae=>ae.isDynamic||ae.IsDynamic)||(Va(),Ha=setInterval(Va,6e4))},ol=()=>{Ha&&(clearInterval(Ha),Ha=null)};return Ze(i,z=>{z==="course"?or():ol();const ae=Date.now(),_e=be=>ae-Z.value[be]>aO;switch(z){case"marshals":_e("marshals")&&Ho();break;case"areas":_e("areas")&&lt();break;case"checkpoints":_e("checkpoints")&&mo();break;case"checklists":_e("checklists")&&_n();break;case"notes":_e("notes")&&It();break;case"incidents":_e("incidents")&&oo();break;case"contacts":_e("contacts")&&vo();break}}),nn(async()=>{await $n();try{const z=await vs.getMe(t.params.eventId);fo.value=z.data}catch(z){console.warn("Failed to fetch user claims:",z)}i.value==="course"&&or()}),Ze($,z=>{z&&(document.title="OnTheDay App - Admin")},{immediate:!0}),xn(()=>{ol()}),(z,ae)=>(v(),m("div",{class:"admin-event-manage",style:Qe({colorScheme:O(R)})},[l("header",WR,[l("div",KR,[l("button",{onClick:Da,class:"btn-back",title:"Back to sessions"},[Ee(qR,{size:48,animate:""})]),$.value?(v(),m("div",JR,[l("h1",null,C($.value.name),1),l("p",YR,C(O(Vv)($.value.eventDate)),1)])):M("",!0)]),l("div",XR,[Fo.value?(v(),m("button",{key:0,onClick:Aa,class:"btn btn-marshal-mode"}," Switch to Marshal ")):M("",!0)]),Ee(HR,{class:"theme-toggle-fixed"})]),l("div",QR,[l("div",eO,[Ee(y$,{tabs:H.value,"model-value":O(i),"onUpdate:modelValue":O(r)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",tO,[O(i)==="course"?(v(),qe(W0,{key:0,ref_key:"courseAreasTab",ref:te,checkpoints:N.value,areas:jt.value,route:$.value?.route||[],"selected-area-id":pn.value,"drawing-mode":O(Wt),onMapClick:so,onLocationClick:Zo,onAreaClick:Kt,onImportCheckpoints:ae[0]||(ae[0]=_e=>He.value=!0),onUploadRoute:ae[1]||(ae[1]=_e=>Re.value=!0),onSelectLocation:mi,onAddArea:Vo,onSelectArea:Kt,onPolygonComplete:jn,onCancelDrawing:Yi,onAddCheckpointFromMap:Qi,onAddManyCheckpointsFromMap:Xl,onAddAreaFromMap:wc,onFullscreen:el},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):M("",!0),O(i)==="checkpoints"?(v(),qe(HI,{key:1,locations:N.value,areas:jt.value,onAddCheckpointManually:Cc,onImportCheckpoints:ae[2]||(ae[2]=_e=>He.value=!0),onSelectLocation:mi},null,8,["locations","areas"])):M("",!0),O(i)==="areas"?(v(),qe(r$,{key:2,areas:jt.value,checkpoints:N.value,contacts:Io.value,"event-people-term":$.value?.peopleTerm||"Marshals","event-checkpoint-term":$.value?.checkpointTerm||"Checkpoints",onAddArea:Vo,onSelectArea:Kt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):M("",!0),O(i)==="marshals"?(v(),qe(Aw,{key:3,ref_key:"marshalsTabRef",ref:Q,marshals:W.value,assignments:Ut.value,locations:N.value,onAddMarshal:$c,onImportMarshals:ae[3]||(ae[3]=_e=>Ke.value=!0),onSelectMarshal:ia,onDeleteMarshal:tr,onToggleCheckIn:xc},null,8,["marshals","assignments","locations"])):M("",!0),O(i)==="checklists"?(v(),qe(jw,{key:4,"checklist-items":Do.value,areas:jt.value,locations:N.value,marshals:W.value,"completion-report":Ma.value,onAddChecklistItem:di,onSelectChecklistItem:ta},null,8,["checklist-items","areas","locations","marshals","completion-report"])):M("",!0),O(i)==="notes"?(v(),qe(uC,{key:5,notes:Oo.value,areas:jt.value,locations:N.value,marshals:W.value,onAddNote:Cs,onSelectNote:Ba},null,8,["notes","areas","locations","marshals"])):M("",!0),O(i)==="incidents"?(v(),qe(CI,{key:6,incidents:vn.value,areas:jt.value,loading:Bo.value,onSelectIncident:at,onReportIncident:Pe},null,8,["incidents","areas","loading"])):M("",!0),O(i)==="contacts"?(v(),qe(NC,{key:7,contacts:Io.value,areas:jt.value,locations:N.value,marshals:W.value,"available-roles":No.value,onAddContact:At,onSelectContact:Tn},null,8,["contacts","areas","locations","marshals","available-roles"])):M("",!0),O(i)==="details"?(v(),qe(JC,{key:8,"event-data":Mt.value,"form-dirty":wt.value,onSubmit:Ks,"onUpdate:formDirty":ws},null,8,["event-data","form-dirty"])):M("",!0),O(i)==="settings"?(v(),qe(Qx,{key:9,"event-data":Mt.value,"event-id":O(t).params.eventId,admins:O(fe),"form-dirty":wt.value,onSubmit:Ks,onAddAdmin:ae[4]||(ae[4]=_e=>he.value=!0),onRemoveAdmin:Kl,"onUpdate:formDirty":ws},null,8,["event-data","event-id","admins","form-dirty"])):M("",!0)])]),Ee(RR,{show:Y.value,location:fn.value,"is-dirty":de.value,onClose:Ql,onSave:aa,onSetOnMap:bc,"onUpdate:isDirty":zt,"onUpdate:location":Yl},null,8,["show","location","is-dirty"]),Ee(G4,{show:q.value,location:P.value,assignments:P.value?.assignments||[],"event-date":$.value?.eventDate||"",areas:jt.value,"event-id":O(t).params.eventId,"all-locations":N.value,notes:Oo.value,"available-marshals":Uo.value,"all-checklist-items":Do.value,incidents:zo.value,"is-dirty":de.value,"event-default-style-type":$.value?.defaultCheckpointStyleType||$.value?.DefaultCheckpointStyleType||"default","event-default-style-color":$.value?.defaultCheckpointStyleColor||$.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":$.value?.defaultCheckpointStyleBackgroundShape||$.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":$.value?.defaultCheckpointStyleBackgroundColor||$.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":$.value?.defaultCheckpointStyleBorderColor||$.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":$.value?.defaultCheckpointStyleIconColor||$.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":$.value?.defaultCheckpointStyleSize||$.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":$.value?.defaultCheckpointStyleMapRotation??$.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":$.value?.peopleTerm||"Marshals","z-index":eo.value?1200:G.value?1100:1e3,"locked-from-marshal":G.value,onClose:Ls,onSave:rs,onDelete:ki,onMoveLocation:Sc,onRemoveAssignment:tl,onOpenAssignModal:yi,"onUpdate:isDirty":zt,onSelectIncident:Pa,onSelectMarshal:bi},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ee(P$,{show:X.value,link:ht.value,"is-dirty":!1,onClose:ae[5]||(ae[5]=_e=>X.value=!1)},null,8,["show","link"]),Ee(q$,{show:ne.value,"event-id":O(t).params.eventId,"marshal-id":F.value,"marshal-name":K.value,onClose:ae[6]||(ae[6]=_e=>ne.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ee(J$,{show:O(he),"is-dirty":de.value,onClose:Xi,onSubmit:kc,"onUpdate:isDirty":zt},null,8,["show","is-dirty"]),Ee(tT,{show:O(Re),uploading:O(et),error:O(Xe),"is-dirty":de.value,onClose:ls,onSubmit:pi,"onUpdate:isDirty":zt},null,8,["show","uploading","error","is-dirty"]),Ee(dT,{show:O(He),importing:O(ye),error:O(me),result:O(xe),"is-dirty":de.value,onClose:oa,onSubmit:_c,"onUpdate:isDirty":zt},null,8,["show","importing","error","result","is-dirty"]),Ee(zP,{ref_key:"editMarshalModalRef",ref:ke,show:ie.value,marshal:Le.value,"event-id":O(t).params.eventId,assignments:er.value,"available-locations":Ea.value,"all-locations":N.value,areas:jt.value,"is-editing":!!Le.value,"event-notes":Oo.value,"all-checklist-items":Do.value,incidents:qt.value,"is-dirty":de.value,"validation-errors":j.value,"locked-checkpoint-id":Ce.value,"z-index":Ce.value?1100:1e3,onClose:za,onSave:Wo,onDelete:Ua,onRemoveAssignment:nl,onAssignToLocation:_i,"onUpdate:isDirty":zt,onSelectIncident:In,onSelectCheckpoint:la},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ee(kT,{show:O(Ke),importing:O(Ve),error:O(me),result:O(De),"is-dirty":de.value,onClose:Ci,onSubmit:wi,"onUpdate:isDirty":zt},null,8,["show","importing","error","result","is-dirty"]),Ee(jP,{show:re.value,"conflict-data":ue.value,onClose:ae[7]||(ae[7]=_e=>re.value=!1),onChoice:nr},null,8,["show","conflict-data"]),Ee(t6,{show:Se.value,"location-name":P.value?.name||"",marshals:Uo.value,onClose:gi,onAssignExisting:Ic,onCreateAndAssign:qo},null,8,["show","location-name","marshals"]),Ee(f6,{show:Nt.value,"old-event-date":Ft.value,"new-event-date":Fn.value,"affected-checkpoints-count":Qn.value,onConfirm:Ys,onCancel:Ra},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ee(A5,{ref_key:"editAreaModalRef",ref:to,show:eo.value,area:yt.value,"initial-tab":Un.value,checkpoints:N.value,marshals:W.value,areas:jt.value,route:$.value?.route||[],"is-dirty":de.value,"event-id":O(t).params.eventId,"all-locations":N.value,assignments:Ut.value,notes:Oo.value,contacts:Io.value,incidents:yn.value,"event-default-style-type":$.value?.defaultCheckpointStyleType||$.value?.DefaultCheckpointStyleType||"default","event-default-style-color":$.value?.defaultCheckpointStyleColor||$.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":$.value?.defaultCheckpointStyleBackgroundShape||$.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":$.value?.defaultCheckpointStyleBackgroundColor||$.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":$.value?.defaultCheckpointStyleBorderColor||$.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":$.value?.defaultCheckpointStyleIconColor||$.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":$.value?.defaultCheckpointStyleSize||$.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":$.value?.defaultCheckpointStyleMapRotation??$.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":$.value?.peopleTerm||"Marshals","event-checkpoint-term":$.value?.checkpointTerm||"Checkpoints",onClose:Qs,onSave:Go,onDelete:Oa,onDrawBoundary:jo,"onUpdate:isDirty":zt,onSelectCheckpoint:mi,onCreateContactFromMarshal:Ki,onCreateNewContact:ui,onEditContact:ea,onSelectIncident:kn},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ee(V5,{show:Ro.value,"checklist-item":uo.value,"initial-tab":zn.value,areas:jt.value,locations:N.value,marshals:W.value,"is-dirty":de.value,onClose:bn,onSave:gt,onDelete:Ji,"onUpdate:isDirty":zt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ee(a8,{show:Zs.value,note:Lo.value,"initial-tab":qs.value,areas:jt.value,locations:N.value,marshals:W.value,"is-dirty":de.value,onClose:Na,onSave:hi,onDelete:na,"onUpdate:isDirty":zt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ee(Qv,{show:So.value,incident:on.value,route:$.value?.route||[],checkpoints:N.value,"can-manage":!0,onClose:ft,onStatusChange:Ct,onOpenAddNote:Ht},null,8,["show","incident","route","checkpoints"]),Ee(Gt,{show:_s.value,title:"Add update",size:"small",onClose:Vn},{footer:ze(()=>[l("div",oO,[l("button",{type:"button",class:"btn btn-secondary",onClick:Vn}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Gn,disabled:!xo.value.trim()||bs.value},C(bs.value?"Adding...":"Add update"),9,sO)])]),default:ze(()=>[l("div",nO,[Ue(l("textarea",{"onUpdate:modelValue":ae[8]||(ae[8]=_e=>xo.value=_e),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,xo.value]])])]),_:1},8,["show"]),Ee(em,{show:ho.value,"event-id":O(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:N.value,route:$.value?.route||[],onClose:ae[9]||(ae[9]=_e=>ho.value=!1),onSubmit:Ae},null,8,["show","event-id","checkpoints","route"]),Ee(uR,{show:$o.value,contact:mn.value,"initial-tab":Hn.value,areas:jt.value,locations:N.value,marshals:W.value,"available-roles":No.value,"is-dirty":de.value,"prefilled-name":xt.value,"prefilled-marshal-id":To.value,"create-from-area-context":!!vt.value,onClose:Mn,onSave:$t,onDelete:Jt,"onUpdate:isDirty":zt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ee(LR,{show:O(Co),mode:O(le),"context-title":O(ce).title,"context-description":O(ce).description,"can-complete":gn.value,clickable:O(le)!=="draw-area","drawing-mode":O(le)==="draw-area"&&O(Wt),locations:Ws.value,areas:po.value,route:$.value?.route||[],"selected-area-id":pn.value,center:O(Ge),zoom:O(St),"highlight-location-id":ci.value,onMapClick:Jl,onPolygonComplete:jn,onPolygonDrawing:fi,onDone:Lc,onCancel:sa},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ee(yc,{show:mt.value,title:_t.value,message:bt.value,onClose:ae[10]||(ae[10]=_e=>mt.value=!1)},null,8,["show","title","message"]),Ee(Nl,{show:O(u),title:O(d),message:O(f),"is-danger":O(p),"confirm-text":O(g),onConfirm:O(y),onCancel:O(_)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},lO=je(iO,[["__scopeId","data-v-d8917ba7"]]),rO={key:0,class:"emergency-notes-section"},cO={class:"emergency-notes-list"},uO={class:"note-header"},dO={key:0,class:"note-content"},hO={key:1,class:"emergency-contacts-section"},fO={class:"emergency-contacts-list"},pO={class:"contact-header"},vO={key:0,class:"role-badge"},mO={class:"contact-details"},gO={key:0,class:"info-section"},yO=["href"],kO={key:1,class:"info-section"},_O=["href"],bO={key:2,class:"info-section"},wO=["href"],CO={key:2,class:"no-contacts"},LO={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.notes?[...o.notes].filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,f)=>{const p=d.priority||d.Priority,g=f.priority||f.Priority;return p==="Emergency"&&g!=="Emergency"?-1:g==="Emergency"&&p!=="Emergency"?1:0}):[]),i=V(()=>o.contacts?o.contacts.filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo):[]),r=()=>{a("close")},u=d=>d?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[d]||d.replace(/([A-Z])/g," $1").trim():"";return(d,f)=>(v(),qe(Gt,{show:e.show,title:"Emergency information",size:"medium",onClose:r},{actions:ze(()=>[l("button",{onClick:r,class:"btn btn-secondary"},"Close")]),default:ze(()=>[s.value.length>0?(v(),m("div",rO,[f[0]||(f[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",cO,[(v(!0),m(Ie,null,Ne(s.value,p=>(v(),m("div",{key:p.noteId||p.NoteId,class:pe(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[l("div",uO,[l("h3",null,C(p.title||p.Title),1),l("span",{class:pe(["priority-badge",(p.priority||p.Priority).toLowerCase()])},C(p.priority||p.Priority),3)]),p.content||p.Content?(v(),m("div",dO,C(p.content||p.Content),1)):M("",!0)],2))),128))])])):M("",!0),i.value&&i.value.length>0?(v(),m("div",hO,[f[4]||(f[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",fO,[(v(!0),m(Ie,null,Ne(i.value,p=>(v(),m("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[l("div",pO,[l("h3",null,C(p.name),1),p.role?(v(),m("span",vO,C(u(p.role)),1)):M("",!0)]),l("div",mO,[p.phone?(v(),m("div",gO,[f[1]||(f[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${p.phone}`,class:"phone-link"},C(p.phone),9,yO)])):M("",!0),p.email?(v(),m("div",kO,[f[2]||(f[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${p.email}`,class:"email-link"},C(p.email),9,_O)])):M("",!0),p.notes||p.details?(v(),m("div",bO,[f[3]||(f[3]=l("label",null,"Details",-1)),l("p",null,C(p.notes||p.details),1)])):M("",!0)]),p.phone?(v(),m("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+C(p.name),9,wO)):M("",!0)]))),128))])])):M("",!0),i.value.length===0&&s.value.length===0?(v(),m("div",CO,[...f[5]||(f[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):M("",!0)]),_:1},8,["show"]))}},SO=je(LO,[["__scopeId","data-v-6f08d5d1"]]),pl=T(navigator.onLine),Ns=T(!0),ba=T(0),pr=T(null),Xa=T("idle"),Bi=T(null),Eu=T(!1);let cf=null,Xc=!1,Yo=null,uf=0;function xO(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Gr(){Yo&&(clearTimeout(Yo),Yo=null);const e=xO(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Yo=setTimeout(async()=>{if(Yo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await Fr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await jr();const o=await Fr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Gr())},e)}async function Ei(){if(!navigator.onLine)return Ns.value=!1,!1;try{return await j_.check(),Ns.value=!0,!0}catch(e){return e.response?.status===404?(Ns.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Ns.value=!1,!1)}}async function ld(){const e=Date.now();if(e-uf<2e3)return;uf=e;const t=navigator.onLine;if(pl.value=t,!t){Ns.value=!1;return}Eu.value=!0;try{await Ei()&&ba.value>0&&Gr()}finally{Eu.value=!1}}function df(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),ld())}function hf(){console.log("Window focused, checking connectivity..."),ld()}async function IO(e){try{switch(e.type){case"checkin":await La.checkIn(e.payload);break;case"checkin_toggle":await La.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await La.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function jr(){if(!Xc&&navigator.onLine){Xc=!0,Xa.value="syncing",Bi.value=null;try{const e=await Pv();if(e.length===0){Xa.value="success",ba.value=0;return}let t=0,o=0;for(const a of e){const s=await IO(a);if(s===!0)await Yh(a.id),t++;else if(s==="permanent_failure")await Yh(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await Jh(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await Jh(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ba.value=await Fr(),o>0?(Xa.value="error",Bi.value=`${o} action(s) failed to sync`):Xa.value="success"}catch(e){console.error("Sync error:",e),Xa.value="error",Bi.value="Failed to sync pending actions"}finally{Xc=!1}}}function $O(){cf||(cf=setInterval(async()=>{navigator.onLine&&(await Ei(),Ns.value&&ba.value>0&&await jr())},3e4))}function rd(){const e=V(()=>pl.value&&Ns.value);async function t(){ba.value=await Fr()}async function o(){pl.value=!0,await Ei()&&ba.value>0&&Gr()}function a(){pl.value=!1,Ns.value=!1,Yo&&(clearTimeout(Yo),Yo=null)}nn(async()=>{await js(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",df),window.addEventListener("focus",hf),navigator.onLine&&await Ei()&&ba.value>0&&Gr(),$O()}),xn(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",df),window.removeEventListener("focus",hf),Yo&&(clearTimeout(Yo),Yo=null)});async function s(d,f){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await f();return await Ol(d,p),pr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function i(d){const f=await Ca(d);return f&&(pr.value=f.cachedAt),f}async function r(d){pr.value=await B_(d)}async function u(){return navigator.onLine?await Ei()?(await jr(),Xa.value==="success"):(Bi.value="Server is not responding",!1):(Bi.value="Cannot sync while offline",!1)}return{isOnline:pl,isServerHealthy:Ns,isFullyOnline:e,isCheckingStatus:Eu,pendingActionsCount:ba,lastSyncTime:pr,syncStatus:Xa,syncError:Bi,checkServerHealth:Ei,quickConnectivityCheck:ld,syncPendingActions:jr,updatePendingCount:t,refreshCache:s,getCachedData:i,loadLastSyncTime:r,forcSync:u}}const TO={class:"offline-indicator-container"},MO={class:"offline-icon"},AO={key:0,viewBox:"0 0 24 24",fill:"currentColor"},EO={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},PO={class:"offline-text"},DO={key:0,class:"last-sync"},RO={class:"pending-text"},OO={key:0,class:"pending-subtext"},BO={key:1,class:"syncing-text"},NO={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:s,lastSyncTime:i,syncStatus:r,syncError:u,forcSync:d}=rd(),f=T(!1),p=T(""),g=T(""),k=V(()=>{if(!i.value)return"";const _=new Date(i.value),S=new Date-_,E=Math.floor(S/6e4),A=Math.floor(E/60);return E<1?"just now":E<60?`${E}m ago`:A<24?`${A}h ago`:_.toLocaleDateString()}),y=async()=>{await d()};return Ze(r,_=>{_==="success"&&s.value===0?(p.value="All actions synced successfully!",g.value="success",f.value=!0,setTimeout(()=>{f.value=!1},3e3)):_==="error"&&(p.value=u.value||"Sync failed",g.value="error",f.value=!0,setTimeout(()=>{f.value=!1},5e3))}),(_,w)=>(v(),m("div",TO,[Ee(gs,{name:"slide"},{default:ze(()=>[O(o)?M("",!0):(v(),m("div",{key:0,class:pe(["offline-banner",{checking:O(a)}])},[l("span",MO,[O(a)?(v(),m("svg",EO,[...w[1]||(w[1]=[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",AO,[...w[0]||(w[0]=[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),l("span",PO,C(O(a)?"Checking connection...":O(t)?"Server unavailable":"You're offline"),1),O(i)&&!O(a)?(v(),m("span",DO," Last synced: "+C(k.value),1)):M("",!0)],2))]),_:1}),Ee(gs,{name:"fade"},{default:ze(()=>[O(s)>0?(v(),m("div",{key:0,class:pe(["pending-banner",{"offline-pending":!O(o)}])},[w[2]||(w[2]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",RO,[Je(C(O(s))+" pending action"+C(O(s)!==1?"s":"")+" ",1),O(o)?M("",!0):(v(),m("span",OO,"(will sync when online)"))]),O(o)&&O(r)!=="syncing"?(v(),m("button",{key:0,onClick:y,class:"sync-button"}," Sync Now ")):O(r)==="syncing"?(v(),m("span",BO,"Syncing...")):M("",!0)],2)):M("",!0)]),_:1}),Ee(gs,{name:"fade"},{default:ze(()=>[f.value?(v(),m("div",{key:0,class:pe(["sync-toast",g.value])},C(p.value),3)):M("",!0)]),_:1})]))}},FO=je(NO,[["__scopeId","data-v-9c1e58f4"]]),UO={class:"modal-content check-in-reminder-modal"},zO={class:"modal-header warning"},HO={class:"modal-body"},VO={class:"reminder-message"},GO={key:0},jO={class:"reminder-hint"},ZO={class:"modal-footer"},qO={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ut();return(o,a)=>(v(),qe(gs,{name:"modal"},{default:ze(()=>[e.show&&e.checkpoint?(v(),m("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=rt(s=>o.$emit("dismiss"),["self"]))},[l("div",UO,[l("div",zO,[a[4]||(a[4]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:a[0]||(a[0]=s=>o.$emit("dismiss"))},"")]),l("div",HO,[a[6]||(a[6]=l("div",{class:"reminder-icon"},"",-1)),l("p",VO,[Je(" You have not checked in yet to "+C(O(t).checkpoint)+" ",1),l("strong",null,C(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),m("span",GO," - "+C(e.checkpoint.location.description),1)):M("",!0),a[5]||(a[5]=Je(". ",-1))]),l("p",jO," Please check in when you arrive at your "+C(O(t).checkpoint)+". ",1)]),l("div",ZO,[l("button",{onClick:a[1]||(a[1]=s=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:a[2]||(a[2]=s=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:Qe(e.accentButtonStyle)}," Go to "+C(O(t).checkpoint),5)])])])):M("",!0)]),_:1}))}},WO=je(qO,[["__scopeId","data-v-4761fdb9"]]),KO={class:"modal-content location-update-modal"},JO={class:"modal-header"},YO={class:"modal-body"},XO={key:0,class:"success-message"},QO={key:1},eB={class:"modal-description"},tB={key:0,class:"last-update-info"},nB={key:1,class:"gps-status active"},oB={class:"update-option"},sB=["disabled"],aB={class:"update-option auto-update-option"},iB={class:"checkbox-label"},lB=["checked"],rB={class:"option-hint"},cB={class:"update-option"},uB=["disabled"],dB={class:"update-option"},hB={class:"option-label"},fB={key:0,class:"checkpoint-list"},pB=["onClick","disabled"],vB={key:1,class:"no-checkpoints"},mB={key:2,class:"error"},gB={class:"modal-footer"},yB={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ut(),o=a=>a?new Date(a).toLocaleString():"";return(a,s)=>(v(),qe(gs,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:s[5]||(s[5]=rt(i=>a.$emit("close"),["self"]))},[l("div",KO,[l("div",JO,[l("h3",null,"Update "+C(O(t).checkpoint)+" location",1),l("button",{class:"modal-close",onClick:s[0]||(s[0]=i=>a.$emit("close"))},"")]),l("div",YO,[e.success?(v(),m("div",XO,C(e.success),1)):(v(),m("div",QO,[l("p",eB,[s[6]||(s[6]=Je(" Update the position of ",-1)),l("strong",null,C(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),m("div",tB," Last updated: "+C(o(e.assignment.location.lastLocationUpdate)),1)):M("",!0),e.userLocation?(v(),m("div",nB,[...s[7]||(s[7]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):M("",!0),l("div",oB,[l("button",{onClick:s[1]||(s[1]=i=>a.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:Qe(e.accentButtonStyle)},[s[8]||(s[8]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+C(e.updating?"Updating...":"Use current GPS location"),1)],12,sB)]),l("div",aB,[l("label",iB,[l("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:s[2]||(s[2]=i=>a.$emit("toggle-auto-update"))},null,40,lB),s[9]||(s[9]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",rB,"Automatically updates the "+C(O(t).checkpoint)+" location using your GPS every minute.",1)]),l("div",cB,[l("button",{onClick:s[3]||(s[3]=i=>a.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...s[10]||(s[10]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,uB)]),l("div",dB,[l("label",hB,"Or copy location from another "+C(O(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),m("div",fB,[(v(!0),m(Ie,null,Ne(e.availableCheckpoints,i=>(v(),m("button",{key:i.id,onClick:r=>a.$emit("copy-from-checkpoint",i.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},C(i.name),9,pB))),128))])):(v(),m("p",vB," No other "+C(O(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),m("div",mB,C(e.error),1)):M("",!0)]))]),l("div",gB,[l("button",{onClick:s[4]||(s[4]=i=>a.$emit("close")),class:"btn btn-secondary"}," Cancel ")])])])):M("",!0)]),_:1}))}},kB=je(yB,[["__scopeId","data-v-93b6a4a2"]]),_B={class:"contact-info"},bB={class:"contact-name-row"},wB={key:0,class:"primary-badge"},CB={class:"contact-name"},LB={key:0,class:"contact-notes-text"},SB={key:1,class:"contact-detail"},xB={key:2,class:"contact-detail"},IB={class:"contact-actions"},$B=["href"],TB=["href"],MB=["href"],AB={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],a=V(()=>t.role?o.some(i=>t.role.toLowerCase().includes(i.toLowerCase())):!1),s=V(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,i=>i.toUpperCase()).trim():"");return(i,r)=>(v(),m("div",{class:pe(["contact-item",{"primary-contact":e.isPrimary}])},[l("div",_B,[l("div",bB,[e.isPrimary?(v(),m("span",wB,"")):M("",!0),l("span",CB,C(e.name),1),e.role?(v(),m("span",{key:1,class:pe(["contact-role-badge",{"emergency-role":a.value}])},C(s.value),3)):M("",!0)]),e.notes?(v(),m("div",LB,C(e.notes),1)):M("",!0),e.phone?(v(),m("div",SB,C(e.phone),1)):M("",!0),e.email?(v(),m("div",xB,C(e.email),1)):M("",!0)]),l("div",IB,[e.phone?(v(),m("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...r[0]||(r[0]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,$B)):M("",!0),e.phone?(v(),m("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...r[1]||(r[1]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,TB)):M("",!0),e.email?(v(),m("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...r[2]||(r[2]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,MB)):M("",!0)])],2))}},tm=je(AB,[["__scopeId","data-v-6cf4fca2"]]),EB={key:0,class:"accordion-section"},PB={class:"accordion-title"},DB=["innerHTML"],RB={class:"accordion-icon"},OB={key:0,class:"accordion-content"},BB={key:0,class:"loading"},NB={key:1,class:"contact-list"},FB={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),m("div",EB,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",PB,[l("span",{class:"section-icon",innerHTML:O(Xn)("contacts")},null,8,DB),Je(" Your "+C(e.contacts.length===1?"contact":"contacts")+C(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),l("span",RB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",OB,[e.loading?(v(),m("div",BB,"Loading contacts...")):(v(),m("div",NB,[(v(!0),m(Ie,null,Ne(e.contacts,a=>(v(),qe(tm,{key:a.contactId,name:a.name,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):M("",!0)])):M("",!0)}},UB=je(FB,[["__scopeId","data-v-246302be"]]),zB={key:0,class:"accordion-section"},HB={class:"accordion-title"},VB=["innerHTML"],GB={class:"accordion-icon"},jB={key:0,class:"accordion-content"},ZB={key:0,class:"loading-state"},qB={key:1,class:"empty-state"},WB={key:2,class:"incidents-list"},KB={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),m("div",zB,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",HB,[l("span",{class:"section-icon",innerHTML:O(Xn)("incidents")},null,8,VB),Je(" Your "+C(e.incidents.length===1?"incident":"incidents")+C(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),l("span",GB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",jB,[e.loading?(v(),m("div",ZB," Loading incidents... ")):e.incidents.length===0?(v(),m("div",qB,[...o[1]||(o[1]=[l("p",null,"No incidents to show.",-1)])])):(v(),m("div",WB,[(v(!0),m(Ie,null,Ne(e.incidents,a=>(v(),qe(Wl,{key:a.incidentId,incident:a,onSelect:s=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):M("",!0)])):M("",!0)}},JB=je(KB,[["__scopeId","data-v-e84cbdf1"]]),YB={key:0,class:"accordion-section"},XB={class:"accordion-title"},QB=["innerHTML"],eN={class:"accordion-icon"},tN={key:0,class:"accordion-content"},nN={class:"event-details"},oN={key:0,class:"event-detail-row"},sN={class:"detail-value"},aN={key:1,class:"event-description"},iN={class:"detail-value"},lN={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),m("div",YB,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=s=>o.$emit("toggle"))},[l("span",XB,[l("span",{class:"section-icon",innerHTML:O(Xn)("event")},null,8,QB),a[1]||(a[1]=Je(" Event details ",-1))]),l("span",eN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",tN,[l("div",nN,[e.eventDate?(v(),m("div",oN,[a[2]||(a[2]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",sN,C(t(e.eventDate)),1)])):M("",!0),e.description?(v(),m("div",aN,[a[3]||(a[3]=l("span",{class:"detail-label"},"Description",-1)),l("p",iN,C(e.description),1)])):M("",!0)])])):M("",!0)])):M("",!0)}},rN=je(lN,[["__scopeId","data-v-7c880ad1"]]),cN={class:"accordion-section"},uN={class:"accordion-title"},dN=["innerHTML"],hN={class:"accordion-icon"},fN={key:0,class:"accordion-content"},pN={key:0,class:"loading"},vN={key:1,class:"error"},mN={key:2,class:"empty-state"},gN={class:"checklist-section"},yN={key:0,class:"empty-state small"},kN={key:1,class:"my-jobs-list"},_N=["checked","disabled","onChange"],bN={key:0,class:"checklist-section"},wN={class:"checklist-section-title"},CN={key:0,class:"checklist-items"},LN={class:"item-checkbox"},SN=["checked","disabled","onChange"],xN={class:"item-content"},IN={key:0,class:"item-context"},$N={key:1,class:"completion-info"},TN={class:"completion-text"},MN={class:"completion-time"},AN={key:1,class:"checklist-groups"},EN=["onClick"],PN={class:"group-title"},DN={class:"group-status"},RN={class:"group-count"},ON={class:"group-expand-icon"},BN={key:0,class:"checklist-group-items"},NN={class:"item-checkbox"},FN=["checked","disabled","onChange"],UN={class:"item-content"},zN={key:0,class:"completion-info"},HN={class:"completion-text"},VN={class:"completion-time"},GN={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ut(),o=e,a=V(()=>o.visibleItems.length),s=i=>i?new Date(i).toLocaleString():"";return(i,r)=>(v(),m("div",cN,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[l("span",uN,[l("span",{class:"section-icon",innerHTML:O(Xn)("checklist")},null,8,dN),Je(" Your "+C(O(t).checklists)+" ("+C(e.completedCount)+" of "+C(a.value)+" complete) ",1)]),l("span",hN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",fN,[e.loading?(v(),m("div",pN,"Loading checklist...")):e.error?(v(),m("div",vN,C(e.error),1)):a.value===0?(v(),m("div",mN,[l("p",null,"No "+C(O(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),m(Ie,{key:3},[l("div",gN,[r[3]||(r[3]=l("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),m("div",yN,[...r[2]||(r[2]=[l("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",kN,[(v(!0),m(Ie,null,Ne(e.myItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,_N),l("span",{class:pe(["my-job-text",{completed:u.isCompleted}])},C(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),m("div",bN,[l("h4",wN,"Your "+C(O(t).area)+"'s jobs",1),Ee(id,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:r[1]||(r[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):M("",!0)],64)):(v(),m(Ie,{key:4},[e.effectiveGroupBy==="none"?(v(),m("div",CN,[(v(!0),m(Ie,null,Ne(e.visibleItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:pe(["checklist-item",{"item-completed":u.isCompleted}])},[l("div",LN,[l("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,SN)]),l("div",xN,[l("div",{class:pe(["item-text",{"text-completed":u.isCompleted}])},C(u.text),3),e.getContextName(u)?(v(),m("div",IN,C(e.getContextName(u)),1)):M("",!0),u.isCompleted?(v(),m("div",$N,[l("span",TN," Completed by "+C(u.completedByActorName||"Unknown"),1),l("span",MN,C(s(u.completedAt)),1)])):M("",!0)])],2))),128))])):(v(),m("div",AN,[(v(!0),m(Ie,null,Ne(e.groupedItems,u=>(v(),m("div",{key:u.key,class:"checklist-group"},[l("button",{class:pe(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[l("span",PN,C(u.name),1),l("span",DN,[l("span",RN,C(u.completedCount)+"/"+C(u.items.length),1),l("span",ON,C(e.expandedGroup===u.key?"":"+"),1)])],10,EN),e.expandedGroup===u.key?(v(),m("div",BN,[(v(!0),m(Ie,null,Ne(u.items,d=>(v(),m("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:pe(["checklist-item",{"item-completed":d.isCompleted}])},[l("div",NN,[l("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:f=>i.$emit("toggle-item",d)},null,40,FN)]),l("div",UN,[l("div",{class:pe(["item-text",{"text-completed":d.isCompleted}])},C(d.text),3),d.isCompleted?(v(),m("div",zN,[l("span",HN,C(d.completedByActorName||"Unknown"),1),l("span",VN,C(s(d.completedAt)),1)])):M("",!0)])],2))),128))])):M("",!0)]))),128))]))],64))])):M("",!0)]))}},jN=je(GN,[["__scopeId","data-v-b2878e4f"]]),ZN={class:"accordion-section"},qN={class:"accordion-title"},WN=["innerHTML"],KN={class:"accordion-icon"},JN={key:0,class:"accordion-content"},YN={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),m("div",ZN,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",qN,[l("span",{class:"section-icon",innerHTML:O(Xn)("notes")},null,8,WN),Je(" Your "+C(e.notes.length===1?"note":"notes")+C(e.notes.length>1?` (${e.notes.length})`:""),1)]),l("span",KN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",JN,[Ee(gc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):M("",!0)]))}},XN=je(YN,[["__scopeId","data-v-10b7523a"]]),QN={class:"accordion-section"},e9={class:"accordion-title"},t9=["innerHTML"],n9={key:0,class:"location-status active"},o9={key:1,class:"location-status"},s9={class:"accordion-icon"},a9={key:0,class:"accordion-content map-content"},i9={key:0,class:"map-selection-banner"},l9={class:"map-wrapper"},r9={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=ut(),a=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),s=li({headerStyle:V(()=>Sr(a.headerStyle)),headerTextColor:V(()=>Sr(a.headerTextColor))}),i=T(null);return t({mapRef:i,recenterOnLocation:(r,u,d)=>i.value?.recenterOnLocation?.(r,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.()}),(r,u)=>(v(),m("div",QN,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>r.$emit("toggle"))},[l("span",e9,[l("span",{class:"section-icon",innerHTML:O(Xn)("course")},null,8,t9),Je(" "+C(O(o).course)+" ",1),e.userLocation?(v(),m("span",n9,"GPS Active")):(v(),m("span",o9,"GPS Inactive"))]),l("span",s9,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",a9,[e.selectingLocation?(v(),m("div",i9,[l("span",null,[u[7]||(u[7]=Je("Click on the map to set the new location for ",-1)),l("strong",null,C(e.selectingLocationName),1)]),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):M("",!0),l("div",l9,[Ee(ri,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":O(o).course,"fullscreen-header-style":s.headerStyle,"fullscreen-header-text-color":s.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:pe({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>r.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>r.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>r.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>r.$emit("visibility-change",d))},vp({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:ze(()=>[l("span",null,[u[8]||(u[8]=Je("Click on the map to set the new location for ",-1)),l("strong",null,C(e.selectingLocationName),1)]),l("button",{onClick:u[2]||(u[2]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):M("",!0)]))}},c9=je(r9,[["__scopeId","data-v-97a9b1f4"]]),u9={class:"area-lead-content"},d9={key:0,class:"loading-state"},h9={key:1,class:"error-state"},f9={key:2,class:"empty-state"},p9={key:3,class:"checkpoint-accordion"},v9=["onClick"],m9={class:"checkpoint-header-content"},g9={class:"checkpoint-title-row"},y9={class:"checkpoint-name"},k9={key:0,class:"area-badge"},_9={key:0,class:"checkpoint-description-preview"},b9={class:"checkpoint-status-row"},w9={class:"status-badge marshals-status"},C9={key:0,class:"status-badge tasks-status"},L9={class:"accordion-icon"},S9={key:0,class:"checkpoint-accordion-content"},x9={class:"checkpoint-mini-map"},I9={class:"checkpoint-marshals-section"},$9={class:"marshals-label"},T9={key:0,class:"empty-state"},M9={key:1,class:"marshals-list"},A9=["onClick"],E9={class:"marshal-header"},P9={class:"marshal-name-row"},D9={class:"marshal-name"},R9={key:0,class:"task-count"},O9={class:"check-status-row"},B9=["onClick","disabled"],N9={key:0,class:"check-in-time"},F9={key:0},U9={key:1,class:"last-access-time"},z9={key:0,class:"checkpoint-tasks-section"},H9={class:"marshals-label"},V9={class:"tasks-list"},G9=["disabled","onChange"],j9={class:"task-text"},Z9=["disabled","onChange"],q9={class:"task-text"},W9={key:0,class:"marshal-details-modal"},K9={class:"details-section"},J9={class:"contact-info"},Y9={key:0,class:"contact-row"},X9=["href"],Q9={key:1,class:"contact-row"},eF=["href"],tF={key:2,class:"no-contact"},nF={class:"details-section"},oF={key:0,class:"checked-in-section"},sF={class:"checked-in-details"},aF={class:"check-time-detail"},iF={key:0,class:"check-method"},lF=["disabled"],rF={key:1,class:"not-checked-in-section"},cF=["disabled"],uF={key:2,class:"last-access-detail"},dF={class:"details-section"},hF={key:0,class:"no-tasks"},fF={key:1,class:"tasks-list modal-tasks"},pF=["disabled","onChange"],vF={class:"task-text"},mF={class:"details-section contact-actions-section"},gF={class:"contact-buttons"},yF=["href"],kF=["href"],_F=["href"],bF={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),{updatePendingCount:i}=rd(),r=e,u=o,d=T(!1),f=T(null),p=T([]),g=T([]),k=T(null),y=T(!1),_=T(null),w=V(()=>{const F=new Set(r.areaIds);return F.size===0?[...g.value].sort((K,fe)=>Vs(K.name,fe.name)):g.value.filter(K=>(K.areaIds||[]).some(he=>F.has(he))).sort((K,fe)=>Vs(K.name,fe.name))}),S=(F,K=60)=>F?F.length<=K?F:F.substring(0,K).trim()+"...":"",E=T(!1),A=T(null),x=T(null),D=async()=>{if(!(!r.eventId||r.areaIds.length===0)){if(d.value=!0,f.value=null,Pn()){try{const F=await Ca(r.eventId);if(F?.areaLeadDashboard){p.value=F.areaLeadDashboard.areas||[],g.value=F.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(F){console.warn("Failed to load cached dashboard:",F)}f.value="Offline - no cached data available",d.value=!1;return}try{const F=await _a.getAreaLeadDashboard(r.eventId);p.value=F.data.areas||[],g.value=F.data.checkpoints||[];try{const K=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await Ca(r.eventId)?await wr(r.eventId,"areaLeadDashboard",K):await Ol(r.eventId,{areaLeadDashboard:K})}catch(K){console.warn("Failed to cache dashboard:",K)}}catch(F){console.error("Failed to load area lead dashboard:",F);try{const K=await Ca(r.eventId);if(K?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=K.areaLeadDashboard.areas||[],g.value=K.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(K){console.warn("Failed to load cached dashboard:",K)}f.value=F.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},R=F=>{k.value=k.value===F?null:F},H=F=>F.marshals.filter(K=>K.isCheckedIn).length,$=F=>{const K=F.marshals.reduce((fe,he)=>fe+he.outstandingTaskCount,0);return F.outstandingTaskCount+K},B=(F,K)=>{A.value=F,x.value=K,E.value=!0},N=()=>{E.value=!1,A.value=null,x.value=null},Z=async(F,K)=>{if(_.value)return;const fe=F.assignmentId||F.id;if(!fe){console.error("No assignment ID found for marshal:",F);return}_.value=F.marshalId;try{if(Pn())await ko("checkin_toggle",{eventId:r.eventId,assignmentId:fe}),F.isCheckedIn=!0,F.checkInTime=new Date().toISOString(),F.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await La.toggleCheckIn(r.eventId,fe),await D(),u("checkin-updated"),A.value?.marshalId===F.marshalId&&x.value){const he=g.value.find(Re=>Re.checkpointId===x.value.checkpointId);if(he){const Re=he.marshals.find(et=>et.marshalId===F.marshalId);Re&&(A.value=Re)}}}catch(he){console.error("Failed to check in marshal:",he),(Pn()||!he.response)&&(await ko("checkin_toggle",{eventId:r.eventId,assignmentId:fe}),F.isCheckedIn=!0,F.checkInTime=new Date().toISOString(),F.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{_.value=null}},P=async(F,K)=>{if(y.value)return;y.value=!0;const he={marshalId:K.marshals.length>0?K.marshals[0].marshalId:r.marshalId,contextType:F.contextType,contextId:F.contextId};try{Pn()?(await ko("checklist_complete",{eventId:r.eventId,itemId:F.itemId,data:he}),K.outstandingTasks=K.outstandingTasks.filter(Re=>Re.itemId!==F.itemId),K.outstandingTaskCount=Math.max(0,K.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Rt.complete(r.eventId,F.itemId,he),await D(),u("checklist-updated"))}catch(Re){console.error("Failed to complete task:",Re),(Pn()||!Re.response)&&(await ko("checklist_complete",{eventId:r.eventId,itemId:F.itemId,data:he}),K.outstandingTasks=K.outstandingTasks.filter(et=>et.itemId!==F.itemId),K.outstandingTaskCount=Math.max(0,K.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{y.value=!1}},G=async(F,K)=>{if(y.value)return;y.value=!0;const he={marshalId:K.marshals.length>0?K.marshals[0].marshalId:r.marshalId,contextType:F.contextType,contextId:F.contextId,actorMarshalId:r.marshalId};try{Pn()?(await ko("checklist_uncomplete",{eventId:r.eventId,itemId:F.itemId,data:he}),K.completedTasks&&(K.completedTasks=K.completedTasks.filter(Re=>Re.itemId!==F.itemId)),K.outstandingTasks||(K.outstandingTasks=[]),K.outstandingTasks.push(F),K.outstandingTaskCount=(K.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Rt.uncomplete(r.eventId,F.itemId,he),await D(),u("checklist-updated"))}catch(Re){console.error("Failed to uncomplete task:",Re),(Pn()||!Re.response)&&(await ko("checklist_uncomplete",{eventId:r.eventId,itemId:F.itemId,data:he}),K.completedTasks&&(K.completedTasks=K.completedTasks.filter(et=>et.itemId!==F.itemId)),K.outstandingTasks||(K.outstandingTasks=[]),K.outstandingTasks.push(F),K.outstandingTaskCount=(K.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{y.value=!1}},Y=async F=>{if(y.value||!A.value)return;y.value=!0;const K={marshalId:A.value.marshalId,contextType:F.contextType,contextId:F.contextId};try{if(Pn())await ko("checklist_complete",{eventId:r.eventId,itemId:F.itemId,data:K}),A.value.outstandingTasks=A.value.outstandingTasks.filter(fe=>fe.itemId!==F.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Rt.complete(r.eventId,F.itemId,K),await D(),A.value&&x.value){const fe=g.value.find(he=>he.checkpointId===x.value.checkpointId);if(fe){const he=fe.marshals.find(Re=>Re.marshalId===A.value.marshalId);he&&(A.value=he)}}u("checklist-updated")}}catch(fe){console.error("Failed to complete task:",fe),(Pn()||!fe.response)&&(await ko("checklist_complete",{eventId:r.eventId,itemId:F.itemId,data:K}),A.value.outstandingTasks=A.value.outstandingTasks.filter(he=>he.itemId!==F.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{y.value=!1}},te=F=>F?new Date(F).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Q=F=>F?new Date(F).toLocaleString():"",X=F=>{if(!F)return"";const K=new Date(F),he=new Date-K,Re=Math.floor(he/6e4),et=Math.floor(Re/60),Xe=Math.floor(et/24);return Re<1?"just now":Re<60?`${Re}m ago`:et<24?`${et}h ago`:Xe===1?"yesterday":Xe<7?`${Xe}d ago`:K.toLocaleDateString()},ne=F=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[F]||F;return t({areas:p,checkpoints:g,loading:d,loadDashboard:D}),Ze(()=>r.eventId,()=>{D()},{immediate:!0}),(F,K)=>(v(),m("div",u9,[d.value?(v(),m("div",d9," Loading dashboard... ")):f.value?(v(),m("div",h9,[l("p",null,C(f.value),1),l("button",{onClick:D,class:"btn btn-secondary"},"Retry")])):w.value.length===0?(v(),m("div",f9,[l("p",null,"No "+C(O(s).checkpoints)+" in your "+C(O(s).areas)+".",1)])):(v(),m("div",p9,[(v(!0),m(Ie,null,Ne(w.value,fe=>(v(),m("div",{key:fe.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:pe(["checkpoint-accordion-header",{active:k.value===fe.checkpointId}]),onClick:he=>R(fe.checkpointId)},[l("div",m9,[l("div",g9,[l("span",y9,C(fe.name),1),fe.areaName?(v(),m("span",k9,C(fe.areaName),1)):M("",!0)]),fe.description?(v(),m("div",_9,C(S(fe.description)),1)):M("",!0),l("div",b9,[l("span",w9,C(H(fe))+" / "+C(fe.marshals.length)+" checked in ",1),$(fe)>0?(v(),m("span",C9,C($(fe))+" tasks ",1)):M("",!0)])]),l("span",L9,C(k.value===fe.checkpointId?"":"+"),1)],10,v9),k.value===fe.checkpointId?(v(),m("div",S9,[l("div",x9,[Ee(ri,{locations:[{id:fe.checkpointId,name:fe.name,description:fe.description,latitude:fe.latitude,longitude:fe.longitude}],route:e.route,center:{lat:fe.latitude,lng:fe.longitude},zoom:16,"highlight-location-id":fe.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),l("div",I9,[l("div",$9,C(O(a).people)+" ("+C(fe.marshals.length)+")",1),fe.marshals.length===0?(v(),m("div",T9," No "+C(O(s).people)+" assigned to this "+C(O(s).checkpoint)+". ",1)):(v(),m("div",M9,[(v(!0),m(Ie,null,Ne(fe.marshals,he=>(v(),m("div",{key:he.marshalId,class:pe(["marshal-card",{"is-checked-in":he.isCheckedIn}]),onClick:Re=>B(he,fe)},[l("div",E9,[l("div",P9,[l("span",D9,C(he.name),1),he.outstandingTaskCount>0?(v(),m("span",R9,C(he.outstandingTaskCount)+" tasks ",1)):M("",!0)]),l("div",O9,[l("div",{class:pe(["check-status",{"checked-in":he.isCheckedIn}])},C(he.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:rt(Re=>Z(he),["stop"]),class:pe(["quick-checkin-btn",{"undo-btn":he.isCheckedIn}]),disabled:_.value===he.marshalId},C(_.value===he.marshalId?"...":he.isCheckedIn?"Undo":"Check In"),11,B9)])]),he.isCheckedIn&&he.checkInTime?(v(),m("div",N9,[Je(C(te(he.checkInTime))+" ",1),he.checkInMethod?(v(),m("span",F9," ("+C(ne(he.checkInMethod))+")",1)):M("",!0)])):M("",!0),he.lastAccessedAt?(v(),m("div",U9," Last active: "+C(X(he.lastAccessedAt)),1)):M("",!0)],10,A9))),128))]))]),fe.outstandingTaskCount>0||fe.completedTasks&&fe.completedTasks.length>0?(v(),m("div",z9,[l("div",H9,C(O(a).checkpoint)+" tasks",1),l("div",V9,[(v(!0),m(Ie,null,Ne(fe.outstandingTasks,he=>(v(),m("div",{key:he.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:y.value,onChange:Re=>P(he,fe)},null,40,G9),l("span",j9,C(he.text),1)]))),128)),(v(!0),m(Ie,null,Ne(fe.completedTasks||[],he=>(v(),m("div",{key:`completed-${he.itemId}`,class:"task-item task-completed"},[l("input",{type:"checkbox",checked:"",disabled:y.value,onChange:Re=>G(he,fe)},null,40,Z9),l("span",q9,C(he.text),1)]))),128))])])):M("",!0)])):M("",!0)]))),128))])),Ee(Gt,{show:E.value,title:A.value?.name||"Marshal Details",size:"large",onClose:N},{actions:ze(()=>[l("button",{onClick:N,class:"btn btn-secondary"},"Close")]),default:ze(()=>[A.value?(v(),m("div",W9,[l("div",K9,[K[4]||(K[4]=l("h4",null,"Contact Details",-1)),l("div",J9,[A.value.email?(v(),m("div",Y9,[K[2]||(K[2]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${A.value.email}`},C(A.value.email),9,X9)])):M("",!0),A.value.phoneNumber?(v(),m("div",Q9,[K[3]||(K[3]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${A.value.phoneNumber}`},C(A.value.phoneNumber),9,eF)])):M("",!0),!A.value.email&&!A.value.phoneNumber?(v(),m("div",tF," No contact details available. ")):M("",!0)])]),l("div",nF,[K[8]||(K[8]=l("h4",null,"Check-in Status",-1)),A.value.isCheckedIn?(v(),m("div",oF,[l("div",sF,[K[6]||(K[6]=l("span",{class:"check-icon"},"",-1)),l("div",null,[K[5]||(K[5]=l("strong",null,"Checked In",-1)),l("p",aF,C(Q(A.value.checkInTime)),1),A.value.checkInMethod?(v(),m("p",iF," Method: "+C(ne(A.value.checkInMethod)),1)):M("",!0)])]),l("button",{onClick:K[0]||(K[0]=fe=>Z(A.value,x.value)),class:"btn btn-secondary undo-checkin-btn",disabled:_.value===A.value.marshalId},C(_.value===A.value.marshalId?"Undoing...":"Undo Check-in"),9,lF)])):(v(),m("div",rF,[K[7]||(K[7]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:K[1]||(K[1]=fe=>Z(A.value,x.value)),class:"btn btn-primary check-in-btn",disabled:_.value===A.value.marshalId},C(_.value===A.value.marshalId?"Checking in...":"Check In"),9,cF)])),A.value.lastAccessedAt?(v(),m("div",uF," Last active: "+C(X(A.value.lastAccessedAt)),1)):M("",!0)]),l("div",dF,[l("h4",null,C(O(a).checklists)+" ("+C(A.value.outstandingTasks?.length||0)+" outstanding)",1),!A.value.outstandingTasks||A.value.outstandingTasks.length===0?(v(),m("div",hF," No outstanding tasks. ")):(v(),m("div",fF,[(v(!0),m(Ie,null,Ne(A.value.outstandingTasks,fe=>(v(),m("div",{key:fe.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:y.value,onChange:he=>Y(fe)},null,40,pF),l("span",vF,C(fe.text),1)]))),128))]))]),l("div",mF,[l("div",gF,[A.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${A.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,yF)):M("",!0),A.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${A.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,kF)):M("",!0),A.value.email?(v(),m("a",{key:2,href:`mailto:${A.value.email}`,class:"btn btn-secondary"}," Email ",8,_F)):M("",!0)])])])):M("",!0)]),_:1},8,["show","title"])]))}},wF=je(bF,[["__scopeId","data-v-067e0528"]]),CF={key:0,class:"accordion-section"},LF={class:"accordion-title"},SF=["innerHTML"],xF={class:"accordion-icon"},IF={key:0,class:"accordion-content area-lead-accordion-content"},$F={key:0,class:"area-filter-pills"},TF=["onClick"],MF={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=ut(),a=T(null);return t({areaLeadRef:a}),(s,i)=>e.isAreaLead?(v(),m("div",CF,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",LF,[l("span",{class:"section-icon",innerHTML:O(Xn)("area")},null,8,SF),Je(" Your "+C(e.areas.length===1?O(o).area:O(o).areas)+C(e.areas.length>1?` (${e.areas.length})`:""),1)]),l("span",xF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",IF,[e.areas.length>1?(v(),m("div",$F,[(v(!0),m(Ie,null,Ne(e.areas,r=>(v(),m("button",{key:r.areaId,class:pe(["area-filter-pill",{selected:e.selectedFilters.has(r.areaId)}]),style:Qe(e.selectedFilters.has(r.areaId)?{backgroundColor:r.color||"#667eea",borderColor:r.color||"#667eea"}:{}),onClick:u=>s.$emit("toggle-filter",r.areaId)},C(r.name),15,TF))),128))])):M("",!0),Ee(wF,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=r=>s.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):M("",!0)])):M("",!0)}},AF=je(MF,[["__scopeId","data-v-9278e6a8"]]),EF={key:0,class:"accordion-section"},PF={class:"accordion-title"},DF=["innerHTML"],RF={class:"accordion-icon"},OF={key:0,class:"accordion-content area-lead-marshals-content"},BF={class:"area-lead-marshals-list"},NF=["onClick"],FF={class:"marshal-header-info"},UF={class:"marshal-name-row"},zF={class:"marshal-name"},HF={class:"marshal-meta"},VF={class:"marshal-checkpoint"},GF={key:0,class:"marshal-task-count"},jF={class:"accordion-icon"},ZF={key:0,class:"area-lead-marshal-content"},qF={class:"marshal-checkin-section"},WF={key:0,class:"marshal-contact-section"},KF=["href"],JF=["href"],YF={key:1,class:"marshal-tasks-section"},XF={class:"tasks-label"},QF={class:"tasks-list"},e7=["checked","disabled","onChange"],t7={class:"task-text"},n7={key:2,class:"no-tasks-message"},o7={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=ut(),a=s=>!s||s.length===0?"":s.length===1?s[0].name:s.map(i=>i.name).join(", ");return(s,i)=>e.isAreaLead&&e.marshals.length>0?(v(),m("div",EF,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",PF,[l("span",{class:"section-icon",innerHTML:O(Xn)("marshal")},null,8,DF),Je(" Your "+C(e.marshals.length===1?O(o).person:O(o).people)+C(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),l("span",RF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",OF,[l("div",BF,[(v(!0),m(Ie,null,Ne(e.marshals,r=>(v(),m("div",{key:r.marshalId,class:"area-lead-marshal-item"},[l("button",{class:pe(["area-lead-marshal-header",{active:e.expandedMarshalId===r.marshalId,"is-checked-in":r.isCheckedIn}]),onClick:u=>s.$emit("toggle-marshal",r.marshalId)},[l("div",FF,[l("div",UF,[l("span",zF,C(r.name),1),l("span",{class:pe(["check-status-badge",{"checked-in":r.isCheckedIn}])},C(r.isCheckedIn?"":""),3)]),l("div",HF,[l("span",VF,C(a(r.checkpoints)),1),r.totalTaskCount>0?(v(),m("span",GF,C(r.completedTaskCount)+" / "+C(r.totalTaskCount)+" "+C(O(o).checklists)+" complete ",1)):M("",!0)])]),l("span",jF,C(e.expandedMarshalId===r.marshalId?"":"+"),1)],10,NF),e.expandedMarshalId===r.marshalId?(v(),m("div",ZF,[l("div",qF,[Ee(Vr,{"is-checked-in":r.isCheckedIn,"check-in-time":r.checkInTime,"check-in-method":r.checkInMethod,"checked-in-by":r.checkedInBy,"marshal-name":r.marshalName,"is-loading":e.checkingInMarshalId===r.id,onToggle:u=>s.$emit("check-in",r)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),r.email||r.phoneNumber?(v(),m("div",WF,[r.phoneNumber?(v(),m("a",{key:0,href:`tel:${r.phoneNumber}`,class:"contact-link"},C(r.phoneNumber),9,KF)):M("",!0),r.email?(v(),m("a",{key:1,href:`mailto:${r.email}`,class:"contact-link"},C(r.email),9,JF)):M("",!0)])):M("",!0),r.allTasks.length>0?(v(),m("div",YF,[l("div",XF,C(O(t).checklists),1),l("div",QF,[(v(!0),m(Ie,null,Ne(r.allTasks,u=>(v(),m("div",{key:`${u.itemId}-${u.contextId}`,class:pe(["task-item",{"task-completed":u.isCompleted}])},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>s.$emit("toggle-task",u,r)},null,40,e7),l("span",t7,C(u.text),1)],2))),128))])])):(v(),m("div",n7," No "+C(O(o).checklists)+" assigned. ",1))])):M("",!0)]))),128))])])):M("",!0)])):M("",!0)}},s7=je(o7,[["__scopeId","data-v-49a1421b"]]),a7={class:"checkpoint-note-header"},i7={key:0,class:"pin-icon",title:"Pinned"},l7={class:"checkpoint-note-title"},r7={key:0,class:"checkpoint-note-content"},c7={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=V(()=>(t.priority||"Normal").toLowerCase());return(a,s)=>(v(),m("div",{class:pe(["checkpoint-note-item",o.value])},[l("div",a7,[e.isPinned?(v(),m("span",i7,"")):M("",!0),l("span",{class:pe(["priority-indicator",o.value])},null,2),l("strong",l7,C(e.title),1),l("span",{class:pe(["priority-badge",o.value])},C(e.priority),3)]),e.content?(v(),m("div",r7,C(e.content),1)):M("",!0)],2))}},u7=je(c7,[["__scopeId","data-v-5f2df920"]]),d7={class:"checkpoint-accordion-section"},h7={class:"checkpoint-header-content"},f7={class:"checkpoint-title-row"},p7=["innerHTML"],v7={key:0,class:"checkpoint-check-icon"},m7={class:"checkpoint-name"},g7={key:1,class:"area-badge"},y7={key:2,class:"checkpoint-time-badge"},k7={key:0,class:"checkpoint-description-preview"},_7={class:"accordion-icon"},b7={key:0,class:"checkpoint-accordion-content"},w7={key:0,class:"checkpoint-mini-map"},C7={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},L7={class:"my-checkin-section"},S7={key:0,class:"check-in-error"},x7={class:"checkpoint-marshals"},I7={class:"marshals-label"},$7={key:0,class:"marshals-list"},T7={key:0,class:"check-badge"},M7={key:1,class:"marshals-list-expanded"},A7=["onClick"],E7={class:"marshal-name-text"},P7={class:"marshal-status-icons"},D7={key:0,class:"check-badge"},R7={class:"expand-icon"},O7={key:0,class:"marshal-details-panel"},B7={class:"detail-row"},N7={key:0,class:"detail-row"},F7={key:1,class:"detail-row"},U7={key:2,class:"detail-row"},z7=["href"],H7={key:3,class:"detail-row"},V7=["href"],G7={key:4,class:"contact-buttons-mini"},j7=["href"],Z7=["href"],q7=["href"],W7={key:5,class:"checkpoint-marshal-checkin"},K7={key:1,class:"checkpoint-area-contacts"},J7={class:"marshals-label"},Y7={class:"contact-list"},X7={key:2,class:"checkpoint-notes"},Q7={class:"checkpoint-notes-list"},eU={key:3,class:"dynamic-location-section"},tU={class:"dynamic-location-header"},nU={class:"dynamic-badge"},oU={key:0,class:"last-update"},sU={class:"dynamic-location-actions"},aU=["disabled"],iU=["title"],lU={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=ut(),s=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=li({headerStyle:V(()=>Sr(s.headerStyle)),headerTextColor:V(()=>Sr(s.headerTextColor))}),r=e,u=T(null),d=V(()=>r.assignment.location?.isDynamic);t({mapRef:u});const f=_=>{const w=_?.iconType||"checkpoint",S=_?.iconColor||"#667eea",E={checkpoint:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return E[w]||E.checkpoint},p=(_,w)=>{const S=E=>E?new Date(E).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return _&&w?`${S(_)} - ${S(w)}`:_?`from ${S(_)}`:w?`until ${S(w)}`:""},g=_=>_?new Date(_).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",k=_=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[_]||_,y=_=>_?new Date(_).toLocaleString():"";return(_,w)=>(v(),m("div",d7,[l("button",{class:pe(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:w[0]||(w[0]=S=>_.$emit("toggle"))},[l("div",h7,[l("div",f7,[l("span",{class:"checkpoint-icon",innerHTML:f(e.assignment.location)},null,8,p7),e.assignment.effectiveIsCheckedIn?(v(),m("span",v7,"")):M("",!0),l("span",m7,C(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),m("span",g7,C(e.assignment.areaName),1)):M("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),m("span",y7,C(p(e.assignment.location.startTime,e.assignment.location.endTime)),1)):M("",!0)]),e.assignment.location?.description?(v(),m("div",k7,C(e.assignment.location.description),1)):M("",!0)]),l("span",_7,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",b7,[e.assignment.location?(v(),m("div",w7,[Ee(ri,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:w[2]||(w[2]=S=>_.$emit("map-click",S)),onLocationClick:w[3]||(w[3]=S=>_.$emit("location-click",S)),onActionClick:w[4]||(w[4]=S=>_.$emit("action-click",S)),onVisibilityChange:w[5]||(w[5]=S=>_.$emit("visibility-change",S))},vp({_:2},[e.assignment.location?.isDynamic?{name:"fullscreen-footer",fn:ze(()=>[l("button",{class:"btn btn-primary",onClick:w[1]||(w[1]=S=>_.$emit("update-location"))},[(v(),m("svg",C7,[...w[9]||(w[9]=[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),w[10]||(w[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):M("",!0),l("div",L7,[Ee(Vr,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:w[6]||(w[6]=S=>_.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),m("div",S7,C(e.checkInError),1)):M("",!0)]),l("div",x7,[l("div",I7,C(O(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),m("div",M7,[(v(!0),m(Ie,null,Ne(e.assignment.allMarshals,S=>(v(),m("div",{key:S.marshalId,class:pe(["marshal-card-mini",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn,expanded:e.expandedMarshalId===S.marshalId}])},[l("button",{class:"marshal-card-header",onClick:E=>_.$emit("toggle-marshal",S.marshalId)},[l("span",E7,C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":""),1),l("span",P7,[S.effectiveIsCheckedIn?(v(),m("span",D7,"")):M("",!0),l("span",R7,C(e.expandedMarshalId===S.marshalId?"":"+"),1)])],8,A7),e.expandedMarshalId===S.marshalId?(v(),m("div",O7,[l("div",B7,[w[11]||(w[11]=l("span",{class:"detail-label"},"Status:",-1)),l("span",{class:pe(S.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},C(S.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),S.effectiveIsCheckedIn&&S.checkInTime?(v(),m("div",N7,[w[12]||(w[12]=l("span",{class:"detail-label"},"Check-in time:",-1)),l("span",null,C(g(S.checkInTime)),1)])):M("",!0),S.checkInMethod?(v(),m("div",F7,[w[13]||(w[13]=l("span",{class:"detail-label"},"Method:",-1)),l("span",null,C(k(S.checkInMethod)),1)])):M("",!0),S.email?(v(),m("div",U7,[w[14]||(w[14]=l("span",{class:"detail-label"},"Email:",-1)),l("a",{href:"mailto:"+S.email},C(S.email),9,z7)])):M("",!0),S.phoneNumber?(v(),m("div",H7,[w[15]||(w[15]=l("span",{class:"detail-label"},"Phone:",-1)),l("a",{href:"tel:"+S.phoneNumber},C(S.phoneNumber),9,V7)])):M("",!0),S.email||S.phoneNumber?(v(),m("div",G7,[S.phoneNumber?(v(),m("a",{key:0,href:"tel:"+S.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,j7)):M("",!0),S.phoneNumber?(v(),m("a",{key:1,href:"sms:"+S.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,Z7)):M("",!0),S.email?(v(),m("a",{key:2,href:"mailto:"+S.email,class:"btn btn-sm btn-secondary"},"Email",8,q7)):M("",!0)])):M("",!0),S.marshalId!==e.currentMarshalId?(v(),m("div",W7,[Ee(Vr,{"is-checked-in":S.effectiveIsCheckedIn,"check-in-time":S.checkInTime,"check-in-method":S.checkInMethod,"checked-in-by":S.checkedInBy,"marshal-name":S.marshalName,"is-loading":e.checkingInMarshalId===S.id,onToggle:E=>_.$emit("marshal-check-in",S)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):M("",!0)])):M("",!0)],2))),128))])):(v(),m("div",$7,[(v(!0),m(Ie,null,Ne(e.assignment.allMarshals,S=>(v(),m("span",{key:S.marshalId,class:pe(["marshal-tag",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn}])},[Je(C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":"")+" ",1),S.effectiveIsCheckedIn?(v(),m("span",T7,"")):M("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),m("div",K7,[l("div",J7,C(O(o).area)+" contacts:",1),l("div",Y7,[(v(!0),m(Ie,null,Ne(e.assignment.areaContacts,S=>(v(),qe(tm,{key:S.marshalId,name:S.marshalName,role:S.role,phone:S.phone,email:S.email},null,8,["name","role","phone","email"]))),128))])])):M("",!0),e.notes.length>0?(v(),m("div",X7,[w[16]||(w[16]=l("div",{class:"marshals-label"},"Notes:",-1)),l("div",Q7,[(v(!0),m(Ie,null,Ne(e.notes,S=>(v(),qe(u7,{key:S.noteId,title:S.title,content:S.content,priority:S.priority,"is-pinned":S.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):M("",!0),d.value?(v(),m("div",eU,[l("div",tU,[l("span",nU,"Dynamic "+C(e.assignment.location.resolvedCheckpointTerm||O(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),m("span",oU," Last updated: "+C(y(e.assignment.location.lastLocationUpdate)),1)):M("",!0)]),l("div",sU,[l("button",{onClick:w[7]||(w[7]=S=>_.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...w[17]||(w[17]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,aU),l("button",{onClick:w[8]||(w[8]=S=>_.$emit("toggle-auto-update")),class:pe(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[w[18]||(w[18]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+C(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,iU)])])):M("",!0)])):M("",!0)]))}},rU=je(lU,[["__scopeId","data-v-01c1d6e0"]]),cU={class:"accordion-section"},uU={class:"accordion-title"},dU=["innerHTML"],hU={class:"accordion-icon"},fU={key:0,class:"accordion-content assignments-accordion-content"},pU={key:0,class:"empty-state"},vU={key:1,class:"checkpoint-accordion"},mU={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=ut(),a={},s=(i,r)=>{r?a[i]=r:delete a[i]};return t({checkpointRefs:a}),(i,r)=>(v(),m("div",cU,[l("button",{class:pe(["accordion-header",{active:e.isExpanded}]),onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[l("span",uU,[l("span",{class:"section-icon",innerHTML:O(Xn)("checkpoint")},null,8,dU),Je(" Your "+C(e.assignments.length===1?O(o).checkpoint:O(o).checkpoints)+C(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),l("span",hU,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",fU,[e.assignments.length===0?(v(),m("div",pU,[l("p",null,"You don't have any "+C(O(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",vU,[(v(!0),m(Ie,null,Ne(e.assignments,u=>(v(),qe(rU,{key:u.id,ref_for:!0,ref:d=>s(u.id,d),assignment:u,"is-expanded":e.expandedCheckpointId===u.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(u.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===u.id,"check-in-error":e.checkingInAssignmentId===u.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(u.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(u.locationId,u.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,onToggle:d=>i.$emit("toggle-checkpoint",u.id),onMapClick:r[1]||(r[1]=d=>i.$emit("map-click",d)),onLocationClick:r[2]||(r[2]=d=>i.$emit("location-click",d)),onActionClick:d=>i.$emit("action-click",u,d),onVisibilityChange:d=>i.$emit("visibility-change",u.id,d),onUpdateLocation:d=>i.$emit("update-location",u),onCheckIn:d=>i.$emit("check-in",u),onToggleMarshal:r[3]||(r[3]=d=>i.$emit("toggle-marshal",d)),onMarshalCheckIn:d=>i.$emit("marshal-check-in",d,u.locationId),onToggleAutoUpdate:d=>i.$emit("toggle-auto-update",u)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):M("",!0)]))}},gU=je(mU,[["__scopeId","data-v-d18e3955"]]);function yU(e){const t=V(()=>{const f=e.value?.brandingPageGradientStart||ln.pageGradientStart,p=e.value?.brandingPageGradientEnd||ln.pageGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),o=V(()=>{const f=e.value?.brandingHeaderGradientStart||ln.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||ln.headerGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),a=V(()=>{const f=e.value?.brandingHeaderGradientStart||ln.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||ln.headerGradientEnd;return Kv(f,p)}),s=V(()=>e.value?.brandingAccentColor||ln.accentColor),i=V(()=>Au(s.value)),r=V(()=>({background:s.value,color:i.value})),u=V(()=>{const f=e.value?.brandingLogoUrl||"";return f?f.startsWith("/api")?ya+f.substring(4):f:""}),d=V(()=>e.value?.brandingLogoPosition||"left");return{pageBackgroundStyle:t,headerStyle:o,headerTextColor:a,accentColor:s,accentTextColor:i,accentButtonStyle:r,brandingLogoUrl:u,brandingLogoPosition:d}}function kU(){const e=T(null),t=T(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return xn(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:s}}function _U({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:s,isAreaLead:i,allLocations:r,areas:u,terms:d,termsLower:f,areaLeadRef:p,areaLeadCheckpoints:g,sectionLastLoadedAt:k,updateCachedField:y,updatePendingCount:_}){const w=T([]),S=T(!1),E=T(null),A=T(!1),x=T("person"),D=T(null),R=V(()=>w.value.filter(F=>F.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(F.matchedScope)?F.completedByActorId===t.value:!0)),H=V(()=>R.value.filter(F=>F.isCompleted).length),$=V(()=>{const F=a.value.map(K=>K.locationId);return R.value.filter(K=>K.completionContextType==="Personal"?K.contextOwnerMarshalId===t.value:K.completionContextType==="Checkpoint"?F.includes(K.completionContextId):K.completionContextType==="Area"?s.value.includes(K.completionContextId):!0)}),B=V(()=>{if(!i.value)return[];const F=a.value.map(K=>K.locationId);return R.value.filter(K=>K.completionContextType==="Personal"?K.contextOwnerMarshalId!==t.value:K.completionContextType==="Checkpoint"?!F.includes(K.completionContextId):K.completionContextType==="Area"?!s.value.includes(K.completionContextId):!1)}),N=V(()=>$.value.map(F=>({...F,localIsCompleted:F.isCompleted,isModified:!1}))),Z=V(()=>B.value.map(F=>({...F,localIsCompleted:F.isCompleted,isModified:!1}))),P=V(()=>{const F=p.value?.checkpoints||g.value||[];if(F.length===0)return[];const K=[],fe=new Set;for(const he of F)for(const Re of he.marshals||[])fe.has(Re.marshalId)||(fe.add(Re.marshalId),K.push(Re));return K}),G=V(()=>{if(i.value)return"none";const F=R.value,K=new Set;for(const fe of F)fe.completionContextType==="Checkpoint"&&fe.completionContextId&&K.add(fe.completionContextId);return K.size>1?"checkpoint":"none"}),Y=V(()=>{const F=R.value,K={};for(const fe of F){let he,Re;fe.completionContextType==="Checkpoint"&&fe.completionContextId?(he=`checkpoint_${fe.completionContextId}`,Re=r.value.find(Xe=>Xe.id===fe.completionContextId)?.name||"Unknown "+d.value.checkpoint):fe.completionContextType==="Area"&&fe.completionContextId?(he=`area_${fe.completionContextId}`,Re=u.value.find(Xe=>Xe.id===fe.completionContextId)?.name||"Unknown "+d.value.area):(he="personal",Re="Personal"),K[he]||(K[he]={key:he,name:Re,items:[],completedCount:0}),K[he].items.push(fe),fe.isCompleted&&K[he].completedCount++}return Object.values(K).sort((fe,he)=>fe.name.localeCompare(he.name,void 0,{numeric:!0,sensitivity:"base"}))}),te=F=>{D.value=D.value===F?null:F},Q=F=>{if(!F.completionContextType||!F.completionContextId)return null;if(F.completionContextType==="Checkpoint"){const K=r.value.find(he=>he.id===F.completionContextId);if(!K)return null;const fe=K.description?` - ${K.description}`:"";return`At ${f.value.checkpoint} ${K.name}${fe}`}if(F.completionContextType==="Area"){const K=u.value.find(fe=>fe.id===F.completionContextId);return K?`At ${f.value.area} ${K.name}`:null}return F.completionContextType==="Personal"?"Personal item":null},X=async(F=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}F||(S.value=!0),E.value=null;try{const K=e.value;console.log("Fetching checklist for marshal:",t.value);let he=(await Rt.getMarshalChecklist(K,t.value)).data||[];if(i.value&&s.value.length>0){console.log("Fetching area checklists for areas:",s.value);const Re=s.value.map(He=>Rt.getAreaChecklist(K,He).catch(Ke=>(console.warn(`Failed to fetch checklist for area ${He}:`,Ke),{data:[]}))),et=await Promise.all(Re),Xe=new Map;for(const He of he){const Ke=`${He.itemId}_${He.completionContextType}_${He.completionContextId}`;Xe.set(Ke,He)}for(const He of et)for(const Ke of He.data||[]){const ye=`${Ke.itemId}_${Ke.completionContextType}_${Ke.completionContextId}`;Xe.has(ye)||Xe.set(ye,Ke)}he=Array.from(Xe.values()),console.log("Merged checklist items:",he.length)}w.value=he,k?.value&&(k.value.checklist=Date.now()),console.log("Checklist loaded:",w.value.length,"items")}catch(K){console.error("Failed to load checklist:",K.response?.status,K.response?.data),E.value=K.response?.data?.message||"Failed to load checklist"}finally{F||(S.value=!1)}};return{checklistItems:w,checklistLoading:S,checklistError:E,savingChecklist:A,checklistGroupBy:x,expandedChecklistGroup:D,visibleChecklistItems:R,completedChecklistCount:H,myChecklistItems:$,areaChecklistItems:B,myChecklistItemsWithLocalState:N,areaChecklistItemsWithLocalState:Z,areaMarshalsForChecklist:P,effectiveChecklistGroupBy:G,groupedChecklistItems:Y,loadChecklist:X,handleToggleChecklist:async F=>{if(A.value)return;A.value=!0;const K=e.value,fe={marshalId:F.contextOwnerMarshalId||t.value,contextType:F.completionContextType,contextId:F.completionContextId,actorMarshalId:t.value};try{F.isCompleted?Pn()?(await ko("checklist_uncomplete",{eventId:K,itemId:F.itemId,data:fe}),F.isCompleted=!1,F.completedAt=null,F.completedByActorName=null,_&&await _()):(await Rt.uncomplete(K,F.itemId,fe),await X(!0)):Pn()?(await ko("checklist_complete",{eventId:K,itemId:F.itemId,data:fe}),F.isCompleted=!0,F.completedAt=new Date().toISOString(),F.completedByActorName=o.value?.name||"You",_&&await _()):(await Rt.complete(K,F.itemId,fe),await X(!0)),y&&await y(K,"checklist",JSON.parse(JSON.stringify(w.value)))}catch(he){if(console.error("Failed to toggle checklist item:",he),Pn()||!he.response){const Re=F.isCompleted?"checklist_uncomplete":"checklist_complete";await ko(Re,{eventId:K,itemId:F.itemId,data:fe}),F.isCompleted?(F.isCompleted=!1,F.completedAt=null,F.completedByActorName=null):(F.isCompleted=!0,F.completedAt=new Date().toISOString(),F.completedByActorName=o.value?.name||"You"),_&&await _(),y&&await y(K,"checklist",JSON.parse(JSON.stringify(w.value)))}}finally{A.value=!1}},toggleChecklistGroup:te,getContextName:Q}}function bU({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const s=T(!1),i=T(null),r=T(null),u=T(null),d=T(!1),f=T(!1),p=T(!1);let g=null,k=null;const y=te=>te?.isDynamic===!0||te?.IsDynamic===!0,_=(te,Q,X,ne)=>{const F=t.value.find(K=>K.id===te);F&&(F.latitude=Q,F.longitude=X,F.lastLocationUpdate=ne)},w=te=>{i.value=te,r.value=null,u.value=null,s.value=!0},S=()=>{s.value=!1,i.value=null,r.value=null,u.value=null,p.value=!1},E=()=>{s.value=!1,p.value=!0},A=()=>{p.value=!1,s.value=!0},x=async(te,Q,X,ne,F=null)=>{d.value=!0;try{const K=e.value,fe={latitude:Q,longitude:X,sourceType:ne};F&&(fe.sourceCheckpointId=F);const he=await Yn.updatePosition(K,te,fe);he.data.success&&(f.value&&N(),_(te,he.data.latitude,he.data.longitude,he.data.lastLocationUpdate))}catch(K){console.error("Failed to update location:",K),K.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},D=async()=>{if(i.value){d.value=!0,r.value=null;try{let te,Q;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(te=o.value.lat,Q=o.value.lng),!te||!Q){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const K=await new Promise((fe,he)=>{navigator.geolocation.getCurrentPosition(fe,he,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});te=K.coords.latitude,Q=K.coords.longitude}const X=e.value,ne=i.value.locationId,F=await Yn.updatePosition(X,ne,{latitude:te,longitude:Q,sourceType:"gps"});F.data.success&&(u.value="Location updated successfully!",_(ne,F.data.latitude,F.data.longitude,F.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(te){console.error("Failed to update location with GPS:",te),te.response?.status===403?r.value="You do not have permission to update this location.":te.code===1?r.value="Location access denied. Please enable location permissions.":te.code===2?r.value="Unable to determine your location. Please try again.":te.code===3||te.message?.includes("Timeout")?r.value="GPS timed out. Please ensure location services are enabled and try again.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async te=>{if(!i.value)return;const Q=t.value.find(X=>X.id===te);if(!Q){r.value="Source checkpoint not found.";return}d.value=!0,r.value=null;try{const X=e.value,ne=i.value.locationId,F=await Yn.updatePosition(X,ne,{latitude:Q.latitude,longitude:Q.longitude,sourceType:"checkpoint",sourceCheckpointId:te});F.data.success&&(f.value&&N(),u.value=`Location copied from ${Q.name}!`,_(ne,F.data.latitude,F.data.longitude,F.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(X){console.error("Failed to copy location from checkpoint:",X),X.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}},H=async(te,Q)=>{if(i.value){d.value=!0,r.value=null;try{const X=e.value,ne=i.value.locationId,F=await Yn.updatePosition(X,ne,{latitude:te,longitude:Q,sourceType:"manual"});F.data.success&&(u.value="Location updated successfully!",_(ne,F.data.latitude,F.data.longitude,F.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(X){console.error("Failed to update location manually:",X),X.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},$=async te=>{if(!(!te||!("geolocation"in navigator)))try{const Q=await new Promise((F,K)=>{navigator.geolocation.getCurrentPosition(F,K,{enableHighAccuracy:!0,timeout:15e3})}),X=e.value,ne=te.locationId;await Yn.updatePosition(X,ne,{latitude:Q.coords.latitude,longitude:Q.coords.longitude,sourceType:"gps"}),_(ne,Q.coords.latitude,Q.coords.longitude,new Date().toISOString())}catch(Q){console.warn("Auto-update location failed:",Q)}},B=te=>{f.value=!0,$(te),g=setInterval(()=>{$(te)},6e4)},N=()=>{f.value=!1,g&&(clearInterval(g),g=null)};return{showLocationUpdateModal:s,updatingLocationFor:i,locationUpdateError:r,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:f,selectingLocationOnMap:p,isDynamicCheckpoint:y,openLocationUpdateModal:w,closeLocationUpdateModal:S,startMapLocationSelect:E,cancelMapLocationSelect:A,updateDynamicCheckpointLocation:x,updateLocationWithGps:D,updateLocationFromCheckpoint:R,updateLocationManually:H,toggleAutoUpdate:te=>{f.value?N():B(te)},startAutoUpdate:B,stopAutoUpdate:N,startDynamicCheckpointPolling:()=>{k||!t.value.some(Q=>Q.isDynamic||Q.IsDynamic)||(k=setInterval(async()=>{try{const Q=e.value,X=await Yn.getDynamicCheckpoints(Q);if(X.data&&Array.isArray(X.data))for(const ne of X.data){const F=t.value.find(K=>K.id===ne.checkpointId);F&&(F.latitude=ne.latitude,F.longitude=ne.longitude,F.lastLocationUpdate=ne.lastLocationUpdate)}}catch(Q){console.warn("Failed to poll dynamic checkpoints:",Q)}},6e4))},stopDynamicCheckpointPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:te=>{p.value&&i.value&&(x(i.value.locationId,te.lat,te.lng,"manual"),p.value=!1)}}}function wU({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:s,areaLeadMarshalDataVersion:i,updatePendingCount:r,updateCachedField:u}){const d=T(null),f=T(null),p=T(null),g=T(!1),k=T(null),y=T(new Set),_=D=>{if(!D)return!0;const R=new Date(D);return(new Date-R)/(1e3*60*60)>24},w=D=>D?new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=D=>{if(!D)return"";switch(D){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return D}},E=D=>{y.value.add(D),g.value=!1,k.value=null},A=async(D,R=!0,H=null)=>{d.value=D.id,f.value=D.id,p.value=null;const $=e.value,B=D.effectiveIsCheckedIn!==void 0?D.effectiveIsCheckedIn:D.isCheckedIn&&!_(D.checkInTime),N=B?"check-out":"check-in",Z=!B;let P=null,G=null,Y="Manual";if(R&&!B&&"geolocation"in navigator)try{const Q=await new Promise((X,ne)=>{navigator.geolocation.getCurrentPosition(X,ne,{enableHighAccuracy:!0,timeout:5e3})});P=Q.coords.latitude,G=Q.coords.longitude,Y="GPS"}catch(Q){console.log("GPS unavailable, using manual check-in:",Q.message)}const te={latitude:P,longitude:G,action:N};try{if(Pn()){await ko("checkin_toggle",{eventId:$,assignmentId:D.id,gpsData:te});const Q=t.value.findIndex(X=>X.id===D.id);if(Q!==-1&&(t.value[Q]={...t.value[Q],isCheckedIn:Z,checkInTime:Z?new Date().toISOString():null,checkInMethod:Z?`${Y} (pending)`:null,checkInLatitude:P,checkInLongitude:G}),H){const X=o.value.find(ne=>ne.id===H);if(X?.assignments){const ne=X.assignments.find(F=>F.id===D.id||F.marshalId===D.marshalId);ne&&(ne.isCheckedIn=Z,ne.checkInTime=Z?new Date().toISOString():null)}}r&&await r(),u&&await u($,"locations",o.value)}else{const Q=await La.toggleCheckIn($,D.id,te),X=t.value.findIndex(ne=>ne.id===D.id);if(X!==-1&&(t.value[X]=Q.data),H){const ne=o.value.find(F=>F.id===H);if(ne?.assignments){const F=ne.assignments.find(K=>K.id===D.id||K.marshalId===D.marshalId);F&&Object.assign(F,Q.data)}}}H&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++}catch(Q){if(Pn()||!Q.response){await ko("checkin_toggle",{eventId:$,assignmentId:D.id,gpsData:te});const X=t.value.findIndex(ne=>ne.id===D.id);X!==-1&&(t.value[X]={...t.value[X],isCheckedIn:Z,checkInTime:Z?new Date().toISOString():null,checkInMethod:Z?"Manual (pending)":null}),r&&await r()}else Q.response?.data?.message?p.value=Q.response.data.message:Q.message?p.value=Q.message:p.value=`Failed to ${N}. Please try again.`}finally{d.value=null,f.value=null}};return{checkingIn:d,checkingInAssignment:f,checkInError:p,showCheckInReminderModal:g,checkInReminderCheckpoint:k,dismissedCheckInReminders:y,isCheckInStale:_,formatCheckInTime:w,formatCheckInMethod:S,handleCheckInToggle:A,handleAreaLeadMarshalCheckIn:async D=>{const H=(a?.value?.checkpoints||s?.value||[]).find(Z=>Z.marshals?.some(P=>P.marshalId===D.marshalId));if(!H){console.error("Could not find checkpoint for marshal:",D);return}const $=H.marshals.find(Z=>Z.marshalId===D.marshalId);if(!$)return;const B=$.assignmentId||$.id;if(!B){console.error("No assignment ID found for marshal:",$);return}const N={id:B,marshalId:D.marshalId,isCheckedIn:D.isCheckedIn,effectiveIsCheckedIn:D.isCheckedIn};await A(N,!1,H.locationId)},dismissCheckInReminder:E}}function CU({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:s,showMessage:i}){const r=T([]),u=T(!1),d=T(null),f=T(!1),p=T(!1),g=T(""),k=T(!1),y=T(!1),_=T(!1),w=V(()=>r.value.filter(B=>B.status==="open"||B.status==="acknowledged"||B.status==="in_progress").length),S=async()=>{const B=e.value;u.value=!0;try{const N=new Map;if(o.value&&a.value.length>0)for(const Z of a.value)try{const G=(await fs.getForArea(B,Z)).data.incidents||[];for(const Y of G)N.set(Y.incidentId,Y)}catch(P){console.warn(`Failed to load incidents for area ${Z}:`,P)}try{const P=(await fs.getAll(B)).data.incidents||[];for(const G of P)G.reportedBy?.marshalId===t.value&&N.set(G.incidentId,G)}catch(Z){console.debug("Could not load all incidents:",Z)}r.value=Array.from(N.values()).sort((Z,P)=>new Date(P.incidentTime||P.createdAt)-new Date(Z.incidentTime||Z.createdAt)),s?.value&&(s.value.incidents=Date.now()),console.log("My incidents loaded:",r.value.length)}catch(N){console.error("Failed to load incidents:",N)}finally{u.value=!1}},E=async B=>{_.value=!0;try{await fs.create(e.value,B),y.value=!1,S(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(N){console.error("Failed to report incident:",N),i&&i("Error",N.response?.data?.message||"Failed to report incident. Please try again.")}finally{_.value=!1}},A=B=>{d.value=B,f.value=!0},x=()=>{f.value=!1,d.value=null},D=async({incidentId:B,status:N})=>{try{await fs.updateStatus(e.value,B,{status:N});const Z=r.value.find(P=>P.incidentId===B);Z&&(Z.status=N),d.value?.incidentId===B&&(d.value.status=N)}catch(Z){console.error("Failed to update incident status:",Z),i&&i("Error","Failed to update status. Please try again.")}},R=()=>{g.value="",p.value=!0},H=()=>{p.value=!1,g.value=""};return{myIncidents:r,incidentsLoading:u,selectedIncident:d,showIncidentDetail:f,showAddIncidentNoteModal:p,incidentNoteText:g,submittingIncidentNote:k,showReportIncident:y,reportingIncident:_,openIncidentsCount:w,loadMyIncidents:S,handleReportIncident:E,openIncidentDetail:A,closeIncidentDetail:x,handleIncidentStatusChange:D,openAddIncidentNoteModal:R,closeAddIncidentNoteModal:H,submitIncidentNote:async()=>{if(!(!g.value.trim()||!d.value)){k.value=!0;try{await fs.addNote(e.value,d.value.incidentId,g.value.trim()),H(),S();const B=await fs.get(e.value,d.value.incidentId);d.value=B.data}catch(B){console.error("Failed to add note:",B),i&&i("Error","Failed to add note. Please try again.")}finally{k.value=!1}}}}}const ff='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',pf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function LU({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=ut(),s=T({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=T(-1),r=T({}),u={},d=V(()=>t.value.filter(S=>S.location?.latitude&&S.location?.longitude&&!(S.location.latitude===0&&S.location.longitude===0))),f=V(()=>{const S=[];return e.value&&!s.value.userLocationInView&&S.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),d.value.length>0&&!s.value.highlightedLocationInView&&S.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:pf}),S}),p=S=>{const E=s.value,A=E.userLocationInView!==S.userLocationInView||E.highlightedLocationInView!==S.highlightedLocationInView,x=JSON.stringify(E.highlightedLocationsVisibility)!==JSON.stringify(S.highlightedLocationsVisibility||{});(A||x)&&(s.value={...S,highlightedLocationsVisibility:S.highlightedLocationsVisibility||{}})},g=()=>{const S=d.value;if(S.length===0)return null;if(S.length===1)return i.value=0,S[0];const E=s.value.highlightedLocationsVisibility||{},A=[];for(let R=0;R<S.length;R++){const H=S[R].locationId;E[H]===!1&&A.push(R)}if(A.length===0)return i.value=0,S[0];if(A.length===1)return i.value=A[0],S[A[0]];const x=i.value;let D=-1;for(const R of A)if(R>x){D=R;break}return D===-1&&(D=A[0]),i.value=D,S[D]};return{courseMapVisibility:s,courseMapActions:f,handleCourseMapVisibilityChange:p,handleCourseMapAction:({actionId:S})=>{if(S==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(S==="recenter-checkpoint"){const E=g();E?.location&&o.value?.recenterOnLocation(E.location.latitude,E.location.longitude)}},checkpointMapVisibility:r,checkpointMapRefs:u,getCheckpointMapActions:S=>{const E=[],A=r.value[S]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!A.userLocationInView&&E.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),A.highlightedLocationInView||E.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:pf}),E},handleCheckpointMapVisibilityChange:(S,E)=>{const A=r.value[S];(!A||A.userLocationInView!==E.userLocationInView||A.highlightedLocationInView!==E.highlightedLocationInView)&&(r.value={...r.value,[S]:E})},handleCheckpointMapAction:(S,{actionId:E})=>{const A=u[S.id];E==="recenter-user"&&e.value?A?.recenterOnUserLocation():E==="recenter-checkpoint"&&S.location&&A?.recenterOnLocation(S.location.latitude,S.location.longitude)}}}function SU({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,loadChecklist:s}){const i=T(null),r=T(!1),u=T(0),d=g=>{i.value=i.value===g?null:g},f=V(()=>{u.value;const g=o?.value?.checkpoints||a?.value||[],k=new Map;for(const y of g)for(const _ of y.marshals||[]){k.has(_.marshalId)||k.set(_.marshalId,{..._,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const w=k.get(_.marshalId);if(w.checkpoints.push({checkpointId:y.checkpointId,name:y.name,description:y.description}),_.outstandingTasks)for(const S of _.outstandingTasks)w.allTasks.push({...S,isCompleted:!1,checkpointName:y.name}),w.totalTaskCount++;if(_.completedTasks)for(const S of _.completedTasks)w.allTasks.push({...S,isCompleted:!0,checkpointName:y.name}),w.totalTaskCount++,w.completedTaskCount++}return Array.from(k.values()).sort((y,_)=>(y.name||"").localeCompare(_.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:i,savingAreaLeadMarshalTask:r,areaLeadMarshalDataVersion:u,allAreaLeadMarshals:f,toggleAreaLeadMarshalExpansion:d,toggleAreaLeadMarshalTask:async(g,k)=>{if(r.value)return;r.value=!0;const y={marshalId:k.marshalId,contextType:g.contextType,contextId:g.contextId,actorMarshalId:t.value};try{g.isCompleted?await Rt.uncomplete(e.value,g.itemId,y):await Rt.complete(e.value,g.itemId,y),o?.value?.loadDashboard&&await o.value.loadDashboard(),u.value++,s&&await s(!0)}catch(_){console.error("Failed to toggle area lead marshal task:",_)}finally{r.value=!1}}}}function xU({router:e,route:t,onAuthSuccess:o}){const a=T(!1),s=T(!1),i=T(null),r=T(null),u=T(null),d=T(null),f=V(()=>r.value?.name||null),p=V(()=>d.value?.eventRoles?d.value.eventRoles.filter(N=>N.role==="EventAreaLead").flatMap(N=>N.areaIds||[]):[]),g=V(()=>p.value.length>0),k=V(()=>d.value?.eventRoles?d.value.eventRoles.some(B=>B.role==="EventAdmin"):!1),y=V(()=>d.value?.authMethod==="SecureEmailLink"&&k.value),_=V(()=>d.value?.authMethod==="MarshalMagicCode"&&k.value);let w=null;const S=()=>{w||(w=setInterval(async()=>{if(d.value?.marshalId)try{await vs.getMe(t.params.eventId)}catch(B){console.debug("Heartbeat failed:",B)}},300*1e3))},E=()=>{w&&(clearInterval(w),w=null)},A=async(B,N,Z=!1)=>{s.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:B,code:N,isReauth:Z}),Kc();try{_o("marshal",B);const P=await vs.marshalLogin(B,N);if(console.log("Auth response:",P.data),P.data.success){Ph(B,{token:P.data.sessionToken,marshalId:P.data.marshalId,marshalName:P.data.person?.name||null}),sk(B,P.data.marshalId,N),r.value=P.data.person,u.value=P.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,r.value?.name);try{const G=await vs.getMe(B);d.value=G.data,console.log("User claims:",d.value)}catch(G){console.warn("Failed to fetch claims:",G)}e.replace({path:t.path,query:{}}),S(),o&&await o()}else i.value=P.data.message||"Authentication failed"}catch(P){console.error("Authentication failed:",P),i.value=P.response?.data?.message||"Invalid or expired login link"}finally{s.value=!1}};return{isAuthenticated:a,authenticating:s,loginError:i,currentPerson:r,currentMarshalId:u,userClaims:d,currentMarshalName:f,areaLeadAreaIds:p,isAreaLead:g,isEventAdmin:k,canSwitchToAdmin:y,isAdminButNeedsReauth:_,authenticateWithMagicCode:A,checkExistingSession:async B=>{_o("marshal",B);const N=Br(B),Z=N?.marshalId,P=Z?rv(B,Z):null;if(!N?.token)return P?(console.log("No session but have stored code, attempting re-authentication..."),Kc(),await A(B,P,!0),a.value):!1;try{const G=await vs.getMe(B);if(G.data&&G.data.marshalId)return d.value=G.data,r.value={personId:G.data.personId,name:G.data.personName,email:G.data.personEmail},u.value=G.data.marshalId,a.value=!0,sv(B,G.data.marshalId),S(),!0}catch(G){if(console.log("Session validation failed, attempting re-authentication...",G),P)try{if(Kc(),await A(B,P,!0),a.value)return console.log("Re-authentication successful"),!0}catch(Y){console.error("Re-authentication failed:",Y)}N?.sessionKey&&yu(N.sessionKey)}return!1},handleClose:B=>{E(),_o(null),a.value=!1,r.value=null,u.value=null,d.value=null,B&&B(),e.push("/marshal")},handleRemoveSession:async B=>{const[N]=B.split(":");_o("marshal",N);try{await vs.logout()}catch{}yu(B),_o(null)},updateSessionEventInfo:(B,N,Z)=>{const P=Br(B);P&&P.marshalId&&Ph(B,{marshalId:P.marshalId,marshalName:P.marshalName,token:P.token,eventName:N,eventDate:Z})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:S,stopHeartbeat:E}}const IU={key:0,class:"header-logo-cover"},$U=["src"],TU={key:2,class:"header-logo header-logo-left"},MU=["src"],AU={class:"header-center"},EU={key:0},PU={key:1,class:"header-event-date"},DU={key:0,class:"header-actions"},RU={key:3,class:"header-logo header-logo-right"},OU=["src"],BU={class:"container"},NU={key:0,class:"selection-card"},FU={key:1,class:"selection-card"},UU={key:0,class:"loading"},zU={key:2,class:"selection-card error-card"},HU={class:"error"},VU={key:3,class:"dashboard"},GU={key:0,class:"welcome-bar"},jU={class:"welcome-info"},ZU={key:0,class:"welcome-email"},qU={key:0,class:"mode-switch"},WU={key:1,class:"mode-switch"},KU={class:"accordion"},JU={class:"add-note-form"},YU={class:"modal-actions"},XU=["disabled"],QU=6e4,ez={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=ut(),{updatePendingCount:a}=rd(),s=uc(),i=Gi(),r=V(()=>s.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:f,loginError:p,currentPerson:g,currentMarshalId:k,currentMarshalName:y,areaLeadAreaIds:_,isAreaLead:w,canSwitchToAdmin:S,isAdminButNeedsReauth:E,authenticateWithMagicCode:A,checkExistingSession:x,handleClose:D,updateSessionEventInfo:R,switchToAdminMode:H,stopHeartbeat:$}=xU({router:i,route:s,onAuthSuccess:()=>u.onAuthSuccess?.()}),B=T(new Set),N=V(()=>_.value.length?X.value.filter(Pe=>_.value.includes(Pe.id)).map(Pe=>({areaId:Pe.id,name:Pe.name,color:Pe.color})).sort((Pe,Ae)=>(Pe.name||"").localeCompare(Ae.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ze(N,Pe=>{Pe.length>0&&B.value.size===0&&(B.value=new Set(Pe.map(Ae=>Ae.areaId)))},{immediate:!0});const Z=V(()=>_.value.filter(Pe=>B.value.has(Pe))),P=Pe=>{const Ae=new Set(B.value);Ae.has(Pe)?Ae.delete(Pe):Ae.add(Pe),B.value=Ae},G=V(()=>{const Pe=kn.value.find(at=>at.isCheckedIn&&!Oo(at.checkInTime)&&at.location);if(Pe?.location)return{id:Pe.location.id,locationId:Pe.location.id,name:Pe.location.name,description:Pe.location.description};if(In.value){const at=kn.value.find(ft=>ft.id===In.value);if(at?.location)return{id:at.location.id,locationId:at.location.id,name:at.location.name,description:at.location.description}}const Ae=kn.value[0];return Ae?.location?{id:Ae.location.id,locationId:Ae.location.id,name:Ae.location.name,description:Ae.location.description}:null}),Y=T(null),te=T([]),Q=T([]),X=T([]),ne=T(!0),{pageBackgroundStyle:F,headerStyle:K,headerTextColor:fe,accentColor:he,accentTextColor:Re,accentButtonStyle:et,brandingLogoUrl:Xe,brandingLogoPosition:He}=yU(Y);yl("marshalBranding",{headerStyle:K,headerTextColor:fe,accentButtonStyle:et,accentColor:he,accentTextColor:Re});const Ke=T("assignments"),ye=T({checklist:0,notes:0,incidents:0,eventContacts:0}),Ve=T([]),me=T([]),xe=T(null),De=V(()=>xe.value?.areaLeadRef?.value),{checklistItems:q,checklistLoading:J,checklistError:ve,savingChecklist:Se,expandedChecklistGroup:re,visibleChecklistItems:ue,completedChecklistCount:ee,myChecklistItems:W,areaChecklistItems:ie,areaChecklistItemsWithLocalState:Le,areaMarshalsForChecklist:Ce,effectiveChecklistGroupBy:ke,groupedChecklistItems:j,loadChecklist:se,handleToggleChecklist:de,toggleChecklistGroup:Me,getContextName:Oe}=_U({eventId:r,currentMarshalId:k,currentPerson:g,assignments:Q,areaLeadAreaIds:_,isAreaLead:w,allLocations:te,areas:X,terms:t,termsLower:o,areaLeadRef:De,areaLeadCheckpoints:Ve,sectionLastLoadedAt:ye,updateCachedField:wr,updatePendingCount:a}),{userLocation:Be,locationLastUpdated:Ye,startLocationTracking:mt,stopLocationTracking:_t}=kU(),{showLocationUpdateModal:bt,updatingLocationFor:Mt,locationUpdateError:wt,locationUpdateSuccess:Nt,updatingLocation:Ft,autoUpdateEnabled:Fn,selectingLocationOnMap:Qn,openLocationUpdateModal:fn,closeLocationUpdateModal:jt,startMapLocationSelect:yt,cancelMapLocationSelect:eo,updateDynamicCheckpointLocation:Un,updateLocationWithGps:to,updateLocationFromCheckpoint:pn,toggleAutoUpdate:Zt,stopAutoUpdate:ks,startDynamicCheckpointPolling:no,stopDynamicCheckpointPolling:Co}=bU({eventId:r,allLocations:te,userLocation:Be,locationLastUpdated:Ye}),le=()=>{yt(),Ke.value="map"},{expandedAreaLeadMarshal:ce,savingAreaLeadMarshalTask:ge,areaLeadMarshalDataVersion:ot,allAreaLeadMarshals:Ge,toggleAreaLeadMarshalExpansion:St,toggleAreaLeadMarshalTask:Wt}=SU({eventId:r,currentMarshalId:k,areaLeadRef:De,areaLeadCheckpoints:Ve,loadChecklist:se}),{checkingIn:Qt,checkingInAssignment:Do,checkInError:uo,showCheckInReminderModal:Ro,checkInReminderCheckpoint:zn,dismissedCheckInReminders:Ma,isCheckInStale:Oo,handleCheckInToggle:Lo,handleAreaLeadMarshalCheckIn:Zs,dismissCheckInReminder:qs}=wU({eventId:r,assignments:Q,allLocations:te,areaLeadRef:De,areaLeadCheckpoints:Ve,areaLeadMarshalDataVersion:ot,updatePendingCount:a,updateCachedField:wr}),vn=T(!1),Bo=T(!1),on=T(""),So=T(""),ho=T(null),_s=T(!1),xo=T(""),bs=T(""),Io=(Pe,Ae)=>{xo.value=Pe,bs.value=Ae,_s.value=!0},{myIncidents:No,incidentsLoading:mn,selectedIncident:$o,showIncidentDetail:Hn,showAddIncidentNoteModal:vt,incidentNoteText:xt,submittingIncidentNote:To,showReportIncident:fo,loadMyIncidents:Fo,handleReportIncident:Aa,openIncidentDetail:ht,handleIncidentStatusChange:Ut,openAddIncidentNoteModal:Ea,closeAddIncidentNoteModal:Uo,submitIncidentNote:gn}=CU({eventId:r,currentMarshalId:k,isAreaLead:w,areaLeadAreaIds:_,sectionLastLoadedAt:ye,showMessage:Io}),ci=T(null),Ws=V(()=>ci.value),po=T(null),qt=Pe=>!Pe||Pe.length===0?!1:Pe.some(Ae=>_.value.includes(Ae)),zo=Pe=>{po.value=po.value===Pe?null:Pe},yn=Pe=>{const Ae=Ke.value===Pe;if(Ke.value=Ae?null:Pe,!Ae){const at=Date.now(),ft=Ct=>at-ye.value[Ct]>QU;switch(Pe){case"checklist":ft("checklist")&&se();break;case"notes":ft("notes")&&ta();break;case"incidents":ft("incidents")&&Fo();break;case"eventContacts":ft("eventContacts")&&gt();break}}},In=T(null),Pa=Pe=>{In.value=In.value===Pe?null:Pe};Ze(()=>Q.value,Pe=>{Pe.length===1&&In.value===null&&(In.value=Pe[0].id)},{immediate:!0});const kn=V(()=>Q.value.map(Pe=>{const Ae=te.value.find($t=>$t.id===Pe.locationId),at=Ae?.areaIds||Ae?.AreaIds||[];let ft=null;at.length>0&&X.value.length>0&&(ft=X.value.find(Jt=>at.includes(Jt.id))?.name);const Ht=(Ae?.assignments||[]).map($t=>({...$t,effectiveIsCheckedIn:$t.isCheckedIn&&!Oo($t.checkInTime)})).sort(($t,Jt)=>($t.marshalName||"").localeCompare(Jt.marshalName||"",void 0,{sensitivity:"base"})),Vn=Oa.value.filter($t=>at.includes($t.areaId)&&(!$t.marshalId||$t.marshalId!==k.value)),Gn=new Set,At=Vn.filter($t=>{const Jt=JSON.stringify({name:$t.name||"",marshalId:$t.marshalId||"",role:$t.role||"",phone:$t.phone||"",email:$t.email||"",notes:$t.notes||""});return Gn.has(Jt)?!1:(Gn.add(Jt),!0)}).sort(($t,Jt)=>($t.marshalName||$t.name||"").localeCompare(Jt.marshalName||Jt.name||"",void 0,{sensitivity:"base"})),Tn=Pe.isCheckedIn&&!Oo(Pe.checkInTime);return{...Pe,location:Ae,areaName:ft,areaIds:at,allMarshals:Ht,areaContacts:At,locationName:Ae?.name||"Unknown Location",effectiveIsCheckedIn:Tn}})),{courseMapActions:Da,handleCourseMapVisibilityChange:zt,handleCourseMapAction:ws,getCheckpointMapActions:Ks,handleCheckpointMapVisibilityChange:Js,handleCheckpointMapAction:Ys}=LU({userLocation:Be,assignmentsWithDetails:kn,courseMapRef:Ws}),Ra=V(()=>Q.value.length>0?Q.value[0]:null),$n=V(()=>Q.value.map(Pe=>Pe.locationId)),Ho=V(()=>kn.value.some(Pe=>Pe.location?.isDynamic||Pe.location?.IsDynamic)),lt=V(()=>kn.value.find(Pe=>Pe.location?.isDynamic||Pe.location?.IsDynamic)),_n=V(()=>{if(!Y.value||!kn.value.length)return[];const Pe=new Date,Ae=Y.value.eventDate?new Date(Y.value.eventDate):null;return kn.value.filter(at=>{if(at.effectiveIsCheckedIn||Ma.value.has(at.id))return!1;const ft=at.location;if(!ft)return!1;const Ct=ft.startTime?new Date(ft.startTime):Ae;if(!Ct)return!1;let Ht;if(ft.endTime)Ht=new Date(ft.endTime);else if(Ae)Ht=new Date(Ae.getTime()+7200*1e3);else return!1;return Pe>=Ct&&Pe<Ht})});Ze(_n,Pe=>{Pe.length>0&&!Ro.value&&(zn.value=Pe[0],Ro.value=!0)},{immediate:!0});const It=()=>{const Pe=zn.value;Pe&&(qs(Pe.id),Ke.value="assignments",In.value=Pe.id)},oo=V(()=>Y.value?.route?(typeof Y.value.route=="string"?JSON.parse(Y.value.route):Y.value.route)||[]:[]),vo=V(()=>!Ra.value||!te.value.length?null:te.value.find(Pe=>Pe.id===Ra.value.locationId)),mo=T([]),is=T(!1),go=V(()=>{const Pe=mo.value.filter(ft=>!ft.marshalId||ft.marshalId!==k.value),Ae=new Set;return Pe.filter(ft=>{const Ct=JSON.stringify({name:ft.name||"",marshalId:ft.marshalId||"",role:ft.role||"",phone:ft.phone||"",email:ft.email||"",notes:ft.notes||""});return Ae.has(Ct)?!1:(Ae.add(Ct),!0)}).sort((ft,Ct)=>(ft.name||"").localeCompare(Ct.name||"",void 0,{sensitivity:"base"}))}),Xs=V(()=>go.value.filter(Pe=>Pe.showInEmergencyInfo)),Vo=V(()=>me.value.filter(Pe=>Pe.showInEmergencyInfo)),Kt=V(()=>Xs.value.length>0||Vo.value.length>0),Go=(Pe,Ae=[])=>{if(!me.value||me.value.length===0)return[];const at=te.value.find(At=>At.id===Pe),ft=at?.areaIds||at?.AreaIds||[],Ct=Ae.length>0?Ae:ft,Ht=[],Vn=new Set;for(const At of me.value){const Tn=At.noteId||At.NoteId||At.id;if(Vn.has(Tn))continue;const $t=At.scopeConfigurations||At.ScopeConfigurations||[];let Jt=!1;if($t.length>0)for(const Mn of $t){const jo=Mn.itemType||Mn.ItemType,jn=Mn.ids||Mn.Ids||[];if(jo==="Checkpoint"&&(jn.includes(Pe)||jn.includes("ALL_CHECKPOINTS"))){Jt=!0;break}if(jo==="Area"&&(jn.includes("ALL_AREAS")||Ct.length>0&&Ct.some(Yi=>jn.includes(Yi)))){Jt=!0;break}}else{const Mn=At.matchedScope||At.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(jn=>Mn.includes(jn)||Mn===jn)&&(Jt=!0)}Jt&&(Vn.add(Tn),Ht.push(At))}const Gn={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Ht.sort((At,Tn)=>{const $t=At.isPinned||At.IsPinned,Jt=Tn.isPinned||Tn.IsPinned;if($t&&!Jt)return-1;if(!$t&&Jt)return 1;const Mn=Gn[At.priority||At.Priority||"Normal"]??3,jo=Gn[Tn.priority||Tn.Priority||"Normal"]??3;if(Mn!==jo)return Mn-jo;const jn=At.createdAt||At.CreatedAt,fi=Tn.createdAt||Tn.CreatedAt;return new Date(fi)-new Date(jn)})},Oa=T([]),Qs=(Pe,Ae)=>Pe.localeCompare(Ae,void 0,{numeric:!0,sensitivity:"base"}),Ki=V(()=>{if(!Mt.value)return[];const Pe=Mt.value.locationId;return te.value.filter(Ae=>Ae.id!==Pe&&Ae.latitude!==0&&Ae.longitude!==0).sort((Ae,at)=>Qs(Ae.name,at.name))}),ui=V(()=>vo.value?{lat:vo.value.latitude,lng:vo.value.longitude}:Be.value?Be.value:te.value.length>0?{lat:te.value[0].latitude,lng:te.value[0].longitude}:{lat:51.505,lng:-.09}),ea=async()=>{const Pe=s.params.eventId;if(console.log("Loading event data for:",{eventId:Pe,marshalId:k.value}),Pn()){console.log("Offline mode detected, attempting to load from cache...");const Ct=await Ca(Pe);if(Ct){if(console.log("Loaded cached data from:",Ct.cachedAt),Y.value=Ct.event,X.value=Ct.areas||[],te.value=Ct.locations||[],q.value=Ct.checklist||[],mo.value=Ct.contacts||[],me.value=Ct.notes||[],Ct.areaLeadDashboard?.checkpoints&&(Ve.value=Ct.areaLeadDashboard.checkpoints),Y.value&&xu(Y.value),k.value){const Ht=[];for(const Vn of te.value){const Gn=Vn.assignments?.find(At=>At.marshalId===k.value);Gn&&Ht.push(Gn)}Q.value=Ht}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[Ae,at,ft]=await Promise.allSettled([ka.getById(Pe),_a.getByEvent(Pe),hl.getEventStatus(Pe)]);if(Ae.status==="fulfilled"?(Y.value=Ae.value.data,console.log("Event loaded:",Y.value?.name),Y.value&&(xu(Y.value),R(Pe,Y.value.name,Y.value.eventDate))):console.error("Failed to load event:",Ae.reason),at.status==="fulfilled"?(X.value=at.value.data||[],console.log("Areas loaded:",X.value.length)):console.error("Failed to load areas:",at.reason),ft.status==="fulfilled"){if(te.value=ft.value.data?.locations||[],console.log("Locations loaded:",te.value.length),k.value){const Ct=[];for(const Ht of te.value){const Vn=Ht.assignments?.find(Gn=>Gn.marshalId===k.value);Vn&&Ct.push(Vn)}Q.value=Ct,console.log("Total assignments found:",Q.value.length)}}else console.error("Failed to load event status:",ft.reason);await Promise.allSettled([se(),gt(),ta(),Fo()]);try{const Ct=JSON.parse(JSON.stringify({event:Y.value,areas:X.value,locations:te.value,checklist:q.value,contacts:mo.value,notes:me.value,marshalId:k.value}));await Ol(Pe,Ct),console.log("Event data cached for offline access")}catch(Ct){console.warn("Failed to cache event data:",Ct)}no()};u.onAuthSuccess=ea;const di=async()=>{const Pe=s.params.eventId;if(Pn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Ae=await _a.getAreaLeadDashboard(Pe);if(Ae.data){Ve.value=Ae.data.checkpoints||[];const at=JSON.parse(JSON.stringify({areas:Ae.data.areas||[],checkpoints:Ae.data.checkpoints||[]}));await Ca(Pe)?await wr(Pe,"areaLeadDashboard",at):await Ol(Pe,{areaLeadDashboard:at}),console.log("Area lead dashboard cached for offline access")}}catch(Ae){Ae.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Ae)}console.log("Background preload complete")},ta=async()=>{const Pe=s.params.eventId;try{const Ae=await Es.getMyNotes(Pe);me.value=Ae.data||[],ye.value.notes=Date.now(),console.log("Notes loaded:",me.value.length)}catch(Ae){console.error("Failed to load notes:",Ae)}},gt=async()=>{const Pe=s.params.eventId;is.value=!0;try{const Ae=await fa.getMyContacts(Pe);mo.value=Ae.data||[],ye.value.eventContacts=Date.now(),console.log("Contacts loaded:",mo.value.length)}catch(Ae){console.warn("Failed to load contacts:",Ae),mo.value=[]}finally{is.value=!1}},Ji=()=>{Bo.value=!1,ho.value&&(ho.value(),ho.value=null)},bn=()=>{Bo.value=!1,ho.value=null},Cs=()=>{_s.value=!1},Ba=Pe=>{if(Qn.value&&Mt.value){Un(Mt.value.locationId,Pe.lat,Pe.lng,"manual"),Qn.value=!1,Mt.value=null;return}if(Ho.value&&lt.value){const Ae=lt.value;on.value="Update location",So.value=`Update ${Ae.location?.name||"dynamic checkpoint"} to this location?`,ho.value=async()=>{await Un(Ae.locationId,Pe.lat,Pe.lng,"manual")},Bo.value=!0}},hi=Pe=>{if(!Qn.value&&Ho.value&&lt.value){const Ae=lt.value;if(Pe.id===Ae.locationId)return;on.value="Copy location",So.value=`Copy location from "${Pe.name}" to ${Ae.location?.name||"your dynamic checkpoint"}?`,ho.value=async()=>{await Un(Ae.locationId,Pe.latitude,Pe.longitude,"checkpoint",Pe.id)},Bo.value=!0}},na=()=>{D(()=>{Q.value=[],q.value=[],Oa.value=[]})},Na=Pe=>Pe?new Date(Pe).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return nn(async()=>{const Pe=s.params.eventId,Ae=s.query.code;ne.value=!0;try{Ae?await A(Pe,Ae):await x(Pe)&&await ea()}finally{ne.value=!1}d.value&&(mt(),"requestIdleCallback"in window?requestIdleCallback(()=>{di()},{timeout:5e3}):setTimeout(()=>{di()},2e3))}),Ze(d,Pe=>{Pe?mt():_t()}),Ze(()=>s.query.code,async Pe=>{if(Pe&&d.value){ne.value=!0;try{await A(s.params.eventId,Pe)}finally{ne.value=!1}}}),Ze(Y,Pe=>{Pe&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),xn(()=>{$(),ks(),Co()}),(Pe,Ae)=>(v(),m("div",{class:"marshal-view",style:Qe(O(F))},[Ee(FO),l("header",{class:pe(["header",`logo-${O(He)}`]),style:Qe(O(K))},[O(Xe)&&O(He)==="cover"?(v(),m("div",IU,[l("img",{src:O(Xe),alt:"Event logo",class:"header-logo-cover-img"},null,8,$U)])):M("",!0),O(d)&&O(He)==="right"?(v(),m("button",{key:1,onClick:na,class:"btn-close-session btn-close-left",style:Qe({color:O(fe)}),title:"Close session"},"  ",4)):M("",!0),O(Xe)&&O(He)==="left"?(v(),m("div",TU,[l("img",{src:O(Xe),alt:"Event logo",class:"header-logo-img"},null,8,MU)])):M("",!0),l("div",AU,[l("div",{class:"header-title",style:Qe({color:O(fe)})},[Y.value?(v(),m("h1",EU,C(Y.value.name),1)):M("",!0),Y.value?.eventDate?(v(),m("div",PU,C(Na(Y.value.eventDate)),1)):M("",!0)],4),O(d)?(v(),m("div",DU,[l("button",{onClick:Ae[0]||(Ae[0]=at=>fo.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),Kt.value?(v(),m("button",{key:0,onClick:Ae[1]||(Ae[1]=at=>vn.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):M("",!0)])):M("",!0)]),O(Xe)&&O(He)==="right"?(v(),m("div",RU,[l("img",{src:O(Xe),alt:"Event logo",class:"header-logo-img"},null,8,OU)])):M("",!0),O(d)&&O(He)!=="right"?(v(),m("button",{key:4,onClick:na,class:"btn-close-session btn-close-right",style:Qe({color:O(fe)}),title:"Close session"},"  ",4)):M("",!0)],6),l("div",BU,[ne.value?(v(),m("div",NU,[...Ae[22]||(Ae[22]=[l("div",{class:"loading"},"Loading...",-1)])])):!O(d)&&!O(p)?(v(),m("div",FU,[Ae[23]||(Ae[23]=l("h2",null,"Welcome",-1)),Ae[24]||(Ae[24]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),O(f)?(v(),m("p",UU,"Authenticating...")):M("",!0)])):O(p)?(v(),m("div",zU,[Ae[25]||(Ae[25]=l("h2",null,"Login failed",-1)),l("p",HU,C(O(p)),1),Ae[26]||(Ae[26]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",VU,[O(S)||O(E)?(v(),m("div",GU,[l("div",jU,[O(g)?.email?(v(),m("span",ZU,C(O(g).email),1)):M("",!0)]),O(S)?(v(),m("div",qU,[l("button",{onClick:Ae[2]||(Ae[2]=(...at)=>O(H)&&O(H)(...at)),class:"btn-mode-switch"}," Switch to Admin ")])):O(E)?(v(),m("div",WU,[...Ae[27]||(Ae[27]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):M("",!0)])):M("",!0),l("div",KU,[Ee(gU,{ref:"assignmentsSectionRef","is-expanded":Ke.value==="assignments",assignments:kn.value,"expanded-checkpoint-id":In.value,"all-locations":te.value,route:oo.value,"user-location":O(Be),"has-dynamic-assignment":Ho.value,"current-marshal-id":O(k),"current-marshal-name":O(y),"checking-in-id":O(Qt),"checking-in-assignment-id":O(Do),"check-in-error":O(uo),"checking-in-marshal-id":O(Qt),"expanded-marshal-id":po.value,"updating-location":O(Ft),"auto-update-enabled":O(Fn),"get-toolbar-actions":O(Ks),"is-area-lead-for-areas":qt,"get-notes-for-checkpoint":Go,onToggle:Ae[3]||(Ae[3]=at=>yn("assignments")),onToggleCheckpoint:Pa,onMapClick:Ba,onLocationClick:hi,onActionClick:O(Ys),onVisibilityChange:O(Js),onUpdateLocation:O(fn),onCheckIn:Ae[4]||(Ae[4]=at=>O(Lo)(at,!0)),onToggleMarshal:zo,onMarshalCheckIn:Ae[5]||(Ae[5]=(at,ft)=>O(Lo)(at,!1,ft)),onToggleAutoUpdate:O(Zt)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ee(jN,{loading:O(J),error:O(ve),"is-expanded":Ke.value==="checklist","is-area-lead":O(w),"my-items":O(W),"area-items":O(ie),"area-items-with-local-state":O(Le),"visible-items":O(ue),"grouped-items":O(j),"completed-count":O(ee),saving:O(Se),"effective-group-by":O(ke),"expanded-group":O(re),locations:te.value,areas:X.value,marshals:O(Ce),"get-context-name":O(Oe),onToggle:Ae[6]||(Ae[6]=at=>yn("checklist")),onToggleItem:O(de),onToggleGroup:O(Me)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ee(XN,{"event-id":O(s).params.eventId,notes:me.value,locations:te.value,areas:X.value,assignments:Q.value,"is-expanded":Ke.value==="notes",onToggle:Ae[7]||(Ae[7]=at=>yn("notes")),onNotesChanged:ta},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ee(UB,{contacts:go.value,loading:is.value,"is-expanded":Ke.value==="eventContacts",onToggle:Ae[8]||(Ae[8]=at=>yn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ee(JB,{incidents:O(No),loading:O(mn),"is-expanded":Ke.value==="incidents",onToggle:Ae[9]||(Ae[9]=at=>yn("incidents")),onSelectIncident:O(ht)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ee(AF,{ref_key:"areaLeadSectionRef",ref:xe,"is-area-lead":O(w),"is-expanded":Ke.value==="areaLead",areas:N.value,"selected-filters":B.value,"filtered-area-ids":Z.value,"event-id":O(s).params.eventId,"marshal-id":O(k),route:oo.value,onToggle:Ae[10]||(Ae[10]=at=>yn("areaLead")),onToggleFilter:P,onChecklistUpdated:O(se)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ee(s7,{"is-area-lead":O(w),"is-expanded":Ke.value==="areaLeadMarshals",marshals:O(Ge),"expanded-marshal-id":O(ce),"checking-in-marshal-id":O(Qt),"saving-task":O(ge),onToggle:Ae[11]||(Ae[11]=at=>yn("areaLeadMarshals")),onToggleMarshal:O(St),onCheckIn:O(Zs),onToggleTask:O(Wt)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Ee(c9,{ref_key:"routeSectionRef",ref:ci,"is-expanded":Ke.value==="map","user-location":O(Be),"selecting-location":O(Qn),"selecting-location-name":O(Mt)?.location?.name||"",locations:te.value,route:oo.value,center:ui.value,"highlight-location-ids":$n.value,clickable:O(Qn)||Ho.value,"toolbar-actions":O(Da),onToggle:Ae[12]||(Ae[12]=at=>yn("map")),onCancelSelect:O(eo),onMapClick:Ba,onLocationClick:hi,onActionClick:O(ws),onVisibilityChange:O(zt)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onCancelSelect","onActionClick","onVisibilityChange"]),Ee(rN,{"event-date":Y.value?.eventDate,description:Y.value?.description,"is-expanded":Ke.value==="eventDetails",onToggle:Ae[13]||(Ae[13]=at=>yn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ee(SO,{show:vn.value,contacts:Xs.value,notes:Vo.value,onClose:Ae[14]||(Ae[14]=at=>vn.value=!1)},null,8,["show","contacts","notes"]),Ee(em,{show:O(fo),"event-id":r.value||"",checkpoint:G.value,"initial-location":O(Be),checkpoints:te.value,route:oo.value,onClose:Ae[15]||(Ae[15]=at=>fo.value=!1),onSubmit:O(Aa)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ee(Qv,{show:O(Hn),incident:O($o),route:oo.value,checkpoints:te.value,"can-manage":O(w),onClose:Ae[16]||(Ae[16]=at=>Hn.value=!1),onStatusChange:O(Ut),onOpenAddNote:O(Ea)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ee(Gt,{show:O(vt),title:"Add update",size:"small",onClose:O(Uo)},{footer:ze(()=>[l("div",YU,[l("button",{type:"button",class:"btn btn-secondary",onClick:Ae[18]||(Ae[18]=(...at)=>O(Uo)&&O(Uo)(...at))}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Ae[19]||(Ae[19]=(...at)=>O(gn)&&O(gn)(...at)),disabled:!O(xt).trim()||O(To)},C(O(To)?"Adding...":"Add update"),9,XU)])]),default:ze(()=>[l("div",JU,[Ue(l("textarea",{"onUpdate:modelValue":Ae[17]||(Ae[17]=at=>Yt(xt)?xt.value=at:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,O(xt)]])])]),_:1},8,["show","onClose"]),Ee(Nl,{show:Bo.value,title:on.value,message:So.value,onConfirm:Ji,onCancel:bn},null,8,["show","title","message"]),Ee(Nl,{show:_s.value,title:xo.value,message:bs.value,"show-cancel":!1,onConfirm:Cs},null,8,["show","title","message"]),Ee(WO,{show:O(Ro),checkpoint:O(zn),"accent-button-style":O(et),onDismiss:Ae[20]||(Ae[20]=at=>O(qs)(O(zn)?.id)),onGoToCheckpoint:It},null,8,["show","checkpoint","accent-button-style"]),Ee(kB,{show:O(bt),assignment:O(Mt),"user-location":O(Be),"auto-update-enabled":O(Fn),updating:O(Ft),error:O(wt),success:O(Nt),"available-checkpoints":Ki.value,"accent-button-style":O(et),onClose:O(jt),onUpdateGps:O(to),onToggleAutoUpdate:Ae[21]||(Ae[21]=at=>O(Zt)(O(Mt))),onSelectOnMap:le,onCopyFromCheckpoint:O(pn)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},tz=je(ez,[["__scopeId","data-v-b0daea3c"]]),nz={class:"form-group"},oz={class:"form-group"},sz={class:"form-group"},az={class:"actions-left"},iz={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,s=T({name:"",email:"",phone:""});Ze(()=>o.profile,f=>{f&&(s.value={name:f.name||"",email:f.email||"",phone:f.phone||""})},{immediate:!0,deep:!0}),Ze(()=>o.show,f=>{f&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},r=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}a("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(f,p)=>(v(),qe(Gt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[l("div",az,[e.showLogout?(v(),m("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):M("",!0)]),l("button",{type:"button",onClick:r,class:"btn btn-success"}," Save ")]),default:ze(()=>[l("form",{onSubmit:rt(r,["prevent"])},[l("div",nz,[p[3]||(p[3]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>s.value.name=g),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,s.value.name]])]),l("div",oz,[p[4]||(p[4]=l("label",null,"Email *",-1)),Ue(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>s.value.email=g),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,s.value.email]])]),l("div",sz,[p[5]||(p[5]=l("label",null,"Phone",-1)),Ue(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>s.value.phone=g),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,s.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},lz=je(iz,[["__scopeId","data-v-178e5f48"]]),rz={class:"tabs"},cz={class:"tab-content"},uz={class:"form-group"},dz={class:"form-group"},hz={class:"form-group"},fz={class:"form-group"},pz=["value"],vz={class:"tab-content"},mz={class:"emergency-contacts-section"},gz={key:0,class:"empty-state"},yz={class:"card-header"},kz=["onClick"],_z={class:"form-group"},bz=["onUpdate:modelValue"],wz={class:"form-group"},Cz=["onUpdate:modelValue"],Lz={class:"form-group"},Sz=["onUpdate:modelValue"],xz={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:s,switchTab:i,resetTab:r}=Fv("basic",["basic","emergency"]),u=T({...o.eventData});Ze(()=>o.eventData,k=>{u.value={...k},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ze(()=>o.show,k=>{k&&r()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},f=k=>{u.value.emergencyContacts.splice(k,1)},p=()=>{a("submit",{...u.value})},g=()=>{a("close")};return(k,y)=>(v(),qe(Gt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":ze(()=>[l("div",rz,[l("button",{type:"button",onClick:y[0]||(y[0]=_=>O(i)("basic")),class:pe(["tab-button",{active:O(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:y[1]||(y[1]=_=>O(i)("emergency")),class:pe(["tab-button",{active:O(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:ze(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-success"}," Save ")]),default:ze(()=>[l("form",{onSubmit:rt(p,["prevent"])},[Ue(l("div",cz,[l("div",uz,[y[6]||(y[6]=l("label",null,"Event name *",-1)),Ue(l("input",{"onUpdate:modelValue":y[2]||(y[2]=_=>u.value.name=_),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),l("div",dz,[y[7]||(y[7]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":y[3]||(y[3]=_=>u.value.description=_),rows:"3",class:"form-input"},null,512),[[st,u.value.description]])]),l("div",hz,[y[8]||(y[8]=l("label",null,"Event date *",-1)),Ue(l("input",{"onUpdate:modelValue":y[4]||(y[4]=_=>u.value.eventDate=_),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,u.value.eventDate]])]),l("div",fz,[y[9]||(y[9]=l("label",null,"Time zone *",-1)),Ue(l("select",{"onUpdate:modelValue":y[5]||(y[5]=_=>u.value.timeZoneId=_),required:"",class:"form-input"},[(v(!0),m(Ie,null,Ne(O(qv),_=>(v(),m("option",{key:_.value,value:_.value},C(_.label),9,pz))),128))],512),[[Bn,u.value.timeZoneId]])])],512),[[ys,O(s)==="basic"]]),Ue(l("div",vz,[l("div",mz,[l("div",{class:"section-header-small"},[y[10]||(y[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",gz,[...y[11]||(y[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):M("",!0),(v(!0),m(Ie,null,Ne(u.value.emergencyContacts,(_,w)=>(v(),m("div",{key:w,class:"emergency-contact-card"},[l("div",yz,[l("h4",null,"Contact "+C(w+1),1),l("button",{type:"button",onClick:S=>f(w),class:"btn-remove"},"  ",8,kz)]),l("div",_z,[y[12]||(y[12]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":S=>_.name=S,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,bz),[[st,_.name]])]),l("div",wz,[y[13]||(y[13]=l("label",null,"Phone *",-1)),Ue(l("input",{"onUpdate:modelValue":S=>_.phone=S,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Cz),[[st,_.phone]])]),l("div",Lz,[y[14]||(y[14]=l("label",null,"Additional details",-1)),Ue(l("textarea",{"onUpdate:modelValue":S=>_.details=S,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Sz),[[st,_.details]])])]))),128))])],512),[[ys,O(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Iz=je(xz,[["__scopeId","data-v-d820eb4f"]]),$z=Yu("profile",()=>{const e=T(null),t=T(!1),o=T(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await hr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const f=await hr.updateProfile(d);return e.value=f.data,f.data}catch(f){throw o.value=f.response?.data?.message||"Failed to update profile",f}finally{t.value=!1}},fetchPerson:async(d,f)=>{t.value=!0,o.value=null;try{return(await hr.getPerson(d,f)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(d,f,p)=>{t.value=!0,o.value=null;try{return(await hr.updatePerson(d,f,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),Tz={class:"sessions-view"},Mz={class:"sessions-container"},Az={key:0,class:"loading-state"},Ez={key:1,class:"empty-state"},Pz={key:2,class:"sessions-list"},Dz={class:"section-header"},Rz={class:"section-actions"},Oz=["onClick"],Bz={class:"session-info"},Nz={class:"event-name"},Fz={key:0,class:"event-date"},Uz={key:1,class:"sign-in-section"},zz={key:2,class:"section-header"},Hz=["onClick"],Vz={class:"session-info"},Gz={class:"event-name"},jz={class:"role-name"},Zz={key:0,class:"event-date"},qz=["onClick"],Wz={class:"modal-card"},Kz={class:"modal-actions"},Jz={class:"modal-card"},Yz={class:"modal-actions"},Xz={__name:"SessionsView",setup(e){const t=Gi(),o=Zl(),a=Nv(),s=$z(),i=T([]),r=T([]),u=T(!0),d=T(!1),f=T(!1),p=T(!1),g=T(!1),k=T(null),y=T(!1),_=T({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),w=V(()=>localStorage.getItem("adminEmail")),S=V(()=>!!w.value),E=()=>{i.value=ok()},A=ne=>{sv(ne.eventId,ne.marshalId),t.push(`/event/${ne.eventId}`)},x=ne=>{k.value=ne,p.value=!0},D=async()=>{if(!k.value)return;const{sessionKey:ne,eventId:F}=k.value;try{_o("marshal",F),await authApi.logout()}catch{}yu(ne),_o(null),E(),p.value=!1,k.value=null},R=()=>{g.value=!0},H=async()=>{await o.logout(),r.value=[],g.value=!1},$=async()=>{if(f.value=!0,!s.profile)try{await s.fetchProfile()}catch(ne){console.error("Failed to load profile:",ne)}},B=async ne=>{try{await s.updateProfile(ne),f.value=!1}catch(F){console.error("Failed to save profile:",F),alert("Failed to save profile. Please try again.")}},N=async()=>{await o.logout(),r.value=[],f.value=!1},Z=ne=>ne?new Date(ne).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",P=async()=>{if(S.value)try{_o("admin");const ne=await ka.getAll();r.value=ne.data||[]}catch(ne){console.error("Failed to load admin events:",ne),r.value=[]}},G=ne=>{t.push(`/admin/event/${ne}`)},Y=()=>{t.push("/")},te=()=>{},Q=()=>{y.value=!1,_.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},X=async ne=>{try{const F={...ne,adminEmail:o.adminEmail};await a.createEvent(F),Q(),await P()}catch(F){console.error("Failed to create event:",F),alert("Failed to create event. Please try again.")}};return nn(async()=>{document.title="OnTheDay App - Sessions",iv(),av(),E(),await P(),u.value=!1}),(ne,F)=>(v(),m("div",Tz,[l("div",Mz,[Ee(Ov,{title:"Your sessions"}),u.value?(v(),m("div",Az,[...F[9]||(F[9]=[l("p",null,"Loading sessions...",-1)])])):i.value.length===0&&r.value.length===0?(v(),m("div",Ez,[F[10]||(F[10]=l("p",null,"No active sessions.",-1)),F[11]||(F[11]=l("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),l("button",{class:"btn btn-primary",onClick:F[0]||(F[0]=K=>d.value=!0)}," Sign in ")])):(v(),m("div",Pz,[S.value?(v(),m(Ie,{key:0},[l("div",Dz,[F[12]||(F[12]=l("span",{class:"section-label"},"Admin events",-1)),l("div",Rz,[l("button",{class:"btn btn-small btn-primary",onClick:$}," Profile "),l("button",{class:"btn btn-small btn-primary",onClick:F[1]||(F[1]=K=>y.value=!0)}," Create event ")])]),(v(!0),m(Ie,null,Ne(r.value,K=>(v(),m("div",{key:"admin-"+K.id,class:"session-card admin-card",onClick:fe=>G(K.id)},[F[14]||(F[14]=l("div",{class:"card-icon admin-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),l("div",Bz,[l("div",Nz,C(K.name),1),F[13]||(F[13]=l("div",{class:"role-name"},"Admin",-1)),K.eventDate?(v(),m("div",Fz,C(Z(K.eventDate)),1)):M("",!0)]),l("button",{class:"btn-logout",onClick:rt(R,["stop"]),title:"Log out as admin"},"  ")],8,Oz))),128))],64)):(v(),m("div",Uz,[l("button",{class:"btn btn-primary",onClick:F[2]||(F[2]=K=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),m("div",zz,[...F[15]||(F[15]=[l("span",{class:"section-label"},"Marshal sessions",-1)])])):M("",!0),(v(!0),m(Ie,null,Ne(i.value,K=>(v(),m("div",{key:K.sessionKey,class:"session-card",onClick:fe=>A(K)},[F[16]||(F[16]=l("div",{class:"card-icon marshal-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),l("div",Vz,[l("div",Gz,C(K.eventName||"Event"),1),l("div",jz,C(K.marshalName||"Marshal"),1),K.eventDate?(v(),m("div",Zz,C(Z(K.eventDate)),1)):M("",!0)]),l("button",{class:"btn-logout",onClick:rt(fe=>x(K),["stop"]),title:"Log out from this session"},"  ",8,qz)],8,Hz))),128))])),l("button",{class:"btn-back-home",onClick:Y,title:"Back to home"},"  ")]),Ee(Bv,{show:d.value,onClose:F[3]||(F[3]=K=>d.value=!1),onSuccess:te},null,8,["show"]),Ee(lz,{show:f.value,profile:O(s).profile,"show-logout":!0,onClose:F[4]||(F[4]=K=>f.value=!1),onSubmit:B,onLogout:N},null,8,["show","profile"]),Ee(Iz,{show:y.value,"event-data":_.value,"is-editing":!1,onClose:Q,onSubmit:X},null,8,["show","event-data"]),(v(),qe(Tl,{to:"body"},[Ee(gs,{name:"modal"},{default:ze(()=>[g.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:F[6]||(F[6]=rt(K=>g.value=!1,["self"]))},[l("div",Wz,[F[17]||(F[17]=l("h3",null,"Log out as admin?",-1)),F[18]||(F[18]=l("p",null,"This will log you out from all admin events.",-1)),F[19]||(F[19]=l("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),l("div",Kz,[l("button",{class:"btn btn-secondary",onClick:F[5]||(F[5]=K=>g.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:H},"Log out")])])])):M("",!0)]),_:1})])),(v(),qe(Tl,{to:"body"},[Ee(gs,{name:"modal"},{default:ze(()=>[p.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:F[8]||(F[8]=rt(K=>p.value=!1,["self"]))},[l("div",Jz,[F[22]||(F[22]=l("h3",null,"Log out from session?",-1)),l("p",null,[F[20]||(F[20]=Je("This will log you out from ",-1)),l("strong",null,C(k.value?.eventName||"this event"),1),F[21]||(F[21]=Je(".",-1))]),F[23]||(F[23]=l("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),l("div",Yz,[l("button",{class:"btn btn-secondary",onClick:F[7]||(F[7]=K=>p.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:D},"Log out")])])])):M("",!0)]),_:1})]))]))}},Qz=je(Xz,[["__scopeId","data-v-add55e1c"]]);let vf=!1;function eH(){vf||(vf=!0,iv(),av())}const tH=[{path:"/",name:"Home",component:hb},{path:"/admin/login",name:"AdminLogin",component:_b},{path:"/admin/verify",name:"AdminVerify",component:Ib},{path:"/sessions",name:"Sessions",component:Qz},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:lO,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:tz},{path:"/:pathMatch(.*)*",redirect:"/"}],nm=ek({history:E1("/VolunteerCheckin/testing/"),routes:tH});nm.beforeEach((e,t,o)=>{eH();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?_o("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&_o(null),e.name==="MarshalView"){const s=e.params.eventId,i=!!e.query.code,r=Br(s),u=r?.marshalId?rv(s,r.marshalId):null;if(i){o();return}if(r?.token){o();return}if(u){o();return}if(lv()){o({name:"Sessions"});return}}o()});js().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const cd=Fy(tk);cd.use(Hy());cd.use(nm);cd.mount("#app");
