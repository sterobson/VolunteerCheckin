(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function au(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Mt={},ta=[],To=()=>{},Nh=()=>!1,ml=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),ru=e=>e.startsWith("onUpdate:"),tn=Object.assign,lu=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},Ev=Object.prototype.hasOwnProperty,Lt=(e,t)=>Ev.call(e,t),tt=Array.isArray,na=e=>lr(e)==="[object Map]",da=e=>lr(e)==="[object Set]",nd=e=>lr(e)==="[object Date]",ut=e=>typeof e=="function",Ht=e=>typeof e=="string",Ao=e=>typeof e=="symbol",It=e=>e!==null&&typeof e=="object",Fh=e=>(It(e)||ut(e))&&ut(e.then)&&ut(e.catch),Uh=Object.prototype.toString,lr=e=>Uh.call(e),Pv=e=>lr(e).slice(8,-1),zh=e=>lr(e)==="[object Object]",gl=e=>Ht(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ua=au(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),yl=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Dv=/-\w/g,po=yl(e=>e.replace(Dv,t=>t.slice(1).toUpperCase())),Ov=/\B([A-Z])/g,ni=yl(e=>e.replace(Ov,"-$1").toLowerCase()),_l=yl(e=>e.charAt(0).toUpperCase()+e.slice(1)),ac=yl(e=>e?`on${_l(e)}`:""),Js=(e,t)=>!Object.is(e,t),Gr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},Hh=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},kl=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Rv=e=>{const t=Ht(e)?Number(e):NaN;return isNaN(t)?e:t};let od;const bl=()=>od||(od=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function it(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=Ht(i)?Uv(i):it(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(Ht(e)||It(e))return e}const Bv=/;(?![^(]*\))/g,Nv=/:([^]+)/,Fv=/\/\*[^]*?\*\//g;function Uv(e){const t={};return e.replace(Fv,"").split(Bv).forEach(o=>{if(o){const i=o.split(Nv);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function fe(e){let t="";if(Ht(e))t=e;else if(tt(e))for(let o=0;o<e.length;o++){const i=fe(e[o]);i&&(t+=i+" ")}else if(It(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const zv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hv=au(zv);function Vh(e){return!!e||e===""}function Vv(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=Ri(e[i],t[i]);return o}function Ri(e,t){if(e===t)return!0;let o=nd(e),i=nd(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=Ao(e),i=Ao(t),o||i)return e===t;if(o=tt(e),i=tt(t),o||i)return o&&i?Vv(e,t):!1;if(o=It(e),i=It(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const c in e){const u=e.hasOwnProperty(c),d=t.hasOwnProperty(c);if(u&&!d||!u&&d||!Ri(e[c],t[c]))return!1}}return String(e)===String(t)}function cu(e,t){return e.findIndex(o=>Ri(o,t))}const Gh=e=>!!(e&&e.__v_isRef===!0),k=e=>Ht(e)?e:e==null?"":tt(e)||It(e)&&(e.toString===Uh||!ut(e.toString))?Gh(e)?k(e.value):JSON.stringify(e,Zh,2):String(e),Zh=(e,t)=>Gh(t)?Zh(e,t.value):na(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[rc(i,a)+" =>"]=s,o),{})}:da(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>rc(o))}:Ao(t)?rc(t):It(t)&&!tt(t)&&!zh(t)?String(t):t,rc=(e,t="")=>{var o;return Ao(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function Gv(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let ln;class jh{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ln,!t&&ln&&(this.index=(ln.scopes||(ln.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=ln;try{return ln=this,t()}finally{ln=o}}}on(){++this._on===1&&(this.prevScope=ln,ln=this)}off(){this._on>0&&--this._on===0&&(ln=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function qh(e){return new jh(e)}function Wh(){return ln}function Zv(e,t=!1){ln&&ln.cleanups.push(e)}let At;const lc=new WeakSet;class Kh{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ln&&ln.active&&ln.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,lc.has(this)&&(lc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Jh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,sd(this),Xh(this);const t=At,o=Mo;At=this,Mo=!0;try{return this.fn()}finally{Qh(this),At=t,Mo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)hu(t);this.deps=this.depsTail=void 0,sd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?lc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ic(this)&&this.run()}get dirty(){return Ic(this)}}let Yh=0,za,Ha;function Jh(e,t=!1){if(e.flags|=8,t){e.next=Ha,Ha=e;return}e.next=za,za=e}function uu(){Yh++}function du(){if(--Yh>0)return;if(Ha){let t=Ha;for(Ha=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;za;){let t=za;for(za=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function Xh(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Qh(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),hu(i),jv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function Ic(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ef(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function ef(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Ya)||(e.globalVersion=Ya,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Ic(e))))return;e.flags|=2;const t=e.dep,o=At,i=Mo;At=e,Mo=!0;try{Xh(e);const s=e.fn(e._value);(t.version===0||Js(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{At=o,Mo=i,Qh(e),e.flags&=-3}}function hu(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)hu(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function jv(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Mo=!0;const tf=[];function Is(){tf.push(Mo),Mo=!1}function Ts(){const e=tf.pop();Mo=e===void 0?!0:e}function sd(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=At;At=void 0;try{t()}finally{At=o}}}let Ya=0;class qv{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class fu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!At||!Mo||At===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==At)o=this.activeLink=new qv(At,this),At.deps?(o.prevDep=At.depsTail,At.depsTail.nextDep=o,At.depsTail=o):At.deps=At.depsTail=o,nf(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=At.depsTail,o.nextDep=void 0,At.depsTail.nextDep=o,At.depsTail=o,At.deps===o&&(At.deps=i)}return o}trigger(t){this.version++,Ya++,this.notify(t)}notify(t){uu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{du()}}}function nf(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)nf(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const el=new WeakMap,Ei=Symbol(""),Tc=Symbol(""),Ja=Symbol("");function dn(e,t,o){if(Mo&&At){let i=el.get(e);i||el.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new fu),s.map=i,s.key=o),s.track()}}function _s(e,t,o,i,s,a){const c=el.get(e);if(!c){Ya++;return}const u=d=>{d&&d.trigger()};if(uu(),t==="clear")c.forEach(u);else{const d=tt(e),p=d&&gl(o);if(d&&o==="length"){const f=Number(i);c.forEach((g,_)=>{(_==="length"||_===Ja||!Ao(_)&&_>=f)&&u(g)})}else switch((o!==void 0||c.has(void 0))&&u(c.get(o)),p&&u(c.get(Ja)),t){case"add":d?p&&u(c.get("length")):(u(c.get(Ei)),na(e)&&u(c.get(Tc)));break;case"delete":d||(u(c.get(Ei)),na(e)&&u(c.get(Tc)));break;case"set":na(e)&&u(c.get(Ei));break}}du()}function Wv(e,t){const o=el.get(e);return o&&o.get(t)}function qi(e){const t=bt(e);return t===e?t:(dn(t,"iterate",Ja),oo(e)?t:t.map(Eo))}function wl(e){return dn(e=bt(e),"iterate",Ja),e}function Zs(e,t){return Ms(e)?$s(e)?aa(Eo(t)):aa(t):Eo(t)}const Kv={__proto__:null,[Symbol.iterator](){return cc(this,Symbol.iterator,e=>Zs(this,e))},concat(...e){return qi(this).concat(...e.map(t=>tt(t)?qi(t):t))},entries(){return cc(this,"entries",e=>(e[1]=Zs(this,e[1]),e))},every(e,t){return fs(this,"every",e,t,void 0,arguments)},filter(e,t){return fs(this,"filter",e,t,o=>o.map(i=>Zs(this,i)),arguments)},find(e,t){return fs(this,"find",e,t,o=>Zs(this,o),arguments)},findIndex(e,t){return fs(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return fs(this,"findLast",e,t,o=>Zs(this,o),arguments)},findLastIndex(e,t){return fs(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return fs(this,"forEach",e,t,void 0,arguments)},includes(...e){return uc(this,"includes",e)},indexOf(...e){return uc(this,"indexOf",e)},join(e){return qi(this).join(e)},lastIndexOf(...e){return uc(this,"lastIndexOf",e)},map(e,t){return fs(this,"map",e,t,void 0,arguments)},pop(){return Ma(this,"pop")},push(...e){return Ma(this,"push",e)},reduce(e,...t){return id(this,"reduce",e,t)},reduceRight(e,...t){return id(this,"reduceRight",e,t)},shift(){return Ma(this,"shift")},some(e,t){return fs(this,"some",e,t,void 0,arguments)},splice(...e){return Ma(this,"splice",e)},toReversed(){return qi(this).toReversed()},toSorted(e){return qi(this).toSorted(e)},toSpliced(...e){return qi(this).toSpliced(...e)},unshift(...e){return Ma(this,"unshift",e)},values(){return cc(this,"values",e=>Zs(this,e))}};function cc(e,t,o){const i=wl(e),s=i[t]();return i!==e&&!oo(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const Yv=Array.prototype;function fs(e,t,o,i,s,a){const c=wl(e),u=c!==e&&!oo(e),d=c[t];if(d!==Yv[t]){const g=d.apply(e,a);return u?Eo(g):g}let p=o;c!==e&&(u?p=function(g,_){return o.call(this,Zs(e,g),_,e)}:o.length>2&&(p=function(g,_){return o.call(this,g,_,e)}));const f=d.call(c,p,i);return u&&s?s(f):f}function id(e,t,o,i){const s=wl(e);let a=o;return s!==e&&(oo(e)?o.length>3&&(a=function(c,u,d){return o.call(this,c,u,d,e)}):a=function(c,u,d){return o.call(this,c,Zs(e,u),d,e)}),s[t](a,...i)}function uc(e,t,o){const i=bt(e);dn(i,"iterate",Ja);const s=i[t](...o);return(s===-1||s===!1)&&Cl(o[0])?(o[0]=bt(o[0]),i[t](...o)):s}function Ma(e,t,o=[]){Is(),uu();const i=bt(e)[t].apply(e,o);return du(),Ts(),i}const Jv=au("__proto__,__v_isRef,__isVue"),of=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ao));function Xv(e){Ao(e)||(e=String(e));const t=bt(this);return dn(t,"has",e),t.hasOwnProperty(e)}class sf{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?lm:cf:a?lf:rf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const c=tt(t);if(!s){let d;if(c&&(d=Kv[o]))return d;if(o==="hasOwnProperty")return Xv}const u=Reflect.get(t,o,zt(t)?t:i);if((Ao(o)?of.has(o):Jv(o))||(s||dn(t,"get",o),a))return u;if(zt(u)){const d=c&&gl(o)?u:u.value;return s&&It(d)?Ac(d):d}return It(u)?s?Ac(u):cr(u):u}}class af extends sf{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const c=tt(t)&&gl(o);if(!this._isShallow){const p=Ms(a);if(!oo(i)&&!Ms(i)&&(a=bt(a),i=bt(i)),!c&&zt(a)&&!zt(i))return p||(a.value=i),!0}const u=c?Number(o)<t.length:Lt(t,o),d=Reflect.set(t,o,i,zt(t)?t:s);return t===bt(s)&&(u?Js(i,a)&&_s(t,"set",o,i):_s(t,"add",o,i)),d}deleteProperty(t,o){const i=Lt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&_s(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!Ao(o)||!of.has(o))&&dn(t,"has",o),i}ownKeys(t){return dn(t,"iterate",tt(t)?"length":Ei),Reflect.ownKeys(t)}}class Qv extends sf{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const em=new af,tm=new Qv,nm=new af(!0);const Mc=e=>e,Dr=e=>Reflect.getPrototypeOf(e);function om(e,t,o){return function(...i){const s=this.__v_raw,a=bt(s),c=na(a),u=e==="entries"||e===Symbol.iterator&&c,d=e==="keys"&&c,p=s[e](...i),f=o?Mc:t?aa:Eo;return!t&&dn(a,"iterate",d?Tc:Ei),{next(){const{value:g,done:_}=p.next();return _?{value:g,done:_}:{value:u?[f(g[0]),f(g[1])]:f(g),done:_}},[Symbol.iterator](){return this}}}}function Or(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function sm(e,t){const o={get(s){const a=this.__v_raw,c=bt(a),u=bt(s);e||(Js(s,u)&&dn(c,"get",s),dn(c,"get",u));const{has:d}=Dr(c),p=t?Mc:e?aa:Eo;if(d.call(c,s))return p(a.get(s));if(d.call(c,u))return p(a.get(u));a!==c&&a.get(s)},get size(){const s=this.__v_raw;return!e&&dn(bt(s),"iterate",Ei),s.size},has(s){const a=this.__v_raw,c=bt(a),u=bt(s);return e||(Js(s,u)&&dn(c,"has",s),dn(c,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const c=this,u=c.__v_raw,d=bt(u),p=t?Mc:e?aa:Eo;return!e&&dn(d,"iterate",Ei),u.forEach((f,g)=>s.call(a,p(f),p(g),c))}};return tn(o,e?{add:Or("add"),set:Or("set"),delete:Or("delete"),clear:Or("clear")}:{add(s){!t&&!oo(s)&&!Ms(s)&&(s=bt(s));const a=bt(this);return Dr(a).has.call(a,s)||(a.add(s),_s(a,"add",s,s)),this},set(s,a){!t&&!oo(a)&&!Ms(a)&&(a=bt(a));const c=bt(this),{has:u,get:d}=Dr(c);let p=u.call(c,s);p||(s=bt(s),p=u.call(c,s));const f=d.call(c,s);return c.set(s,a),p?Js(a,f)&&_s(c,"set",s,a):_s(c,"add",s,a),this},delete(s){const a=bt(this),{has:c,get:u}=Dr(a);let d=c.call(a,s);d||(s=bt(s),d=c.call(a,s)),u&&u.call(a,s);const p=a.delete(s);return d&&_s(a,"delete",s,void 0),p},clear(){const s=bt(this),a=s.size!==0,c=s.clear();return a&&_s(s,"clear",void 0,void 0),c}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=om(s,e,t)}),o}function pu(e,t){const o=sm(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(Lt(o,s)&&s in i?o:i,s,a)}const im={get:pu(!1,!1)},am={get:pu(!1,!0)},rm={get:pu(!0,!1)};const rf=new WeakMap,lf=new WeakMap,cf=new WeakMap,lm=new WeakMap;function cm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function um(e){return e.__v_skip||!Object.isExtensible(e)?0:cm(Pv(e))}function cr(e){return Ms(e)?e:vu(e,!1,em,im,rf)}function uf(e){return vu(e,!1,nm,am,lf)}function Ac(e){return vu(e,!0,tm,rm,cf)}function vu(e,t,o,i,s){if(!It(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=um(e);if(a===0)return e;const c=s.get(e);if(c)return c;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function $s(e){return Ms(e)?$s(e.__v_raw):!!(e&&e.__v_isReactive)}function Ms(e){return!!(e&&e.__v_isReadonly)}function oo(e){return!!(e&&e.__v_isShallow)}function Cl(e){return e?!!e.__v_raw:!1}function bt(e){const t=e&&e.__v_raw;return t?bt(t):e}function mu(e){return!Lt(e,"__v_skip")&&Object.isExtensible(e)&&Hh(e,"__v_skip",!0),e}const Eo=e=>It(e)?cr(e):e,aa=e=>It(e)?Ac(e):e;function zt(e){return e?e.__v_isRef===!0:!1}function E(e){return df(e,!1)}function dm(e){return df(e,!0)}function df(e,t){return zt(e)?e:new hm(e,t)}class hm{constructor(t,o){this.dep=new fu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:bt(t),this._value=o?t:Eo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||oo(t)||Ms(t);t=i?t:bt(t),Js(t,o)&&(this._rawValue=t,this._value=i?t:Eo(t),this.dep.trigger())}}function G(e){return zt(e)?e.value:e}const fm={get:(e,t,o)=>t==="__v_raw"?e:G(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return zt(s)&&!zt(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function hf(e){return $s(e)?e:new Proxy(e,fm)}function pm(e){const t=tt(e)?new Array(e.length):{};for(const o in e)t[o]=mm(e,o);return t}class vm{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=bt(t);let s=!0,a=t;if(!tt(t)||!gl(String(o)))do s=!Cl(a)||oo(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=G(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&zt(this._raw[this._key])){const o=this._object[this._key];if(zt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Wv(this._raw,this._key)}}function mm(e,t,o){return new vm(e,t,o)}class gm{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new fu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ya-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&At!==this)return Jh(this,!0),!0}get value(){const t=this.dep.track();return ef(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ym(e,t,o=!1){let i,s;return ut(e)?i=e:(i=e.get,s=e.set),new gm(i,s,o)}const Rr={},tl=new WeakMap;let Li;function _m(e,t=!1,o=Li){if(o){let i=tl.get(o);i||tl.set(o,i=[]),i.push(e)}}function km(e,t,o=Mt){const{immediate:i,deep:s,once:a,scheduler:c,augmentJob:u,call:d}=o,p=A=>s?A:oo(A)||s===!1||s===0?ks(A,1):ks(A);let f,g,_,b,x=!1,$=!1;if(zt(e)?(g=()=>e.value,x=oo(e)):$s(e)?(g=()=>p(e),x=!0):tt(e)?($=!0,x=e.some(A=>$s(A)||oo(A)),g=()=>e.map(A=>{if(zt(A))return A.value;if($s(A))return p(A);if(ut(A))return d?d(A,2):A()})):ut(e)?t?g=d?()=>d(e,2):e:g=()=>{if(_){Is();try{_()}finally{Ts()}}const A=Li;Li=f;try{return d?d(e,3,[b]):e(b)}finally{Li=A}}:g=To,t&&s){const A=g,I=s===!0?1/0:s;g=()=>ks(A(),I)}const B=Wh(),P=()=>{f.stop(),B&&B.active&&lu(B.effects,f)};if(a&&t){const A=t;t=(...I)=>{A(...I),P()}}let M=$?new Array(e.length).fill(Rr):Rr;const S=A=>{if(!(!(f.flags&1)||!f.dirty&&!A))if(t){const I=f.run();if(s||x||($?I.some((T,C)=>Js(T,M[C])):Js(I,M))){_&&_();const T=Li;Li=f;try{const C=[I,M===Rr?void 0:$&&M[0]===Rr?[]:M,b];M=I,d?d(t,3,C):t(...C)}finally{Li=T}}}else f.run()};return u&&u(S),f=new Kh(g),f.scheduler=c?()=>c(S,!1):S,b=A=>_m(A,!1,f),_=f.onStop=()=>{const A=tl.get(f);if(A){if(d)d(A,4);else for(const I of A)I();tl.delete(f)}},t?i?S(!0):M=f.run():c?c(S.bind(null,!0),!0):f.run(),P.pause=f.pause.bind(f),P.resume=f.resume.bind(f),P.stop=P,P}function ks(e,t=1/0,o){if(t<=0||!It(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,zt(e))ks(e.value,t,o);else if(tt(e))for(let i=0;i<e.length;i++)ks(e[i],t,o);else if(da(e)||na(e))e.forEach(i=>{ks(i,t,o)});else if(zh(e)){for(const i in e)ks(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&ks(e[i],t,o)}return e}function ur(e,t,o,i){try{return i?e(...i):e()}catch(s){Ll(s,t,o)}}function Po(e,t,o,i){if(ut(e)){const s=ur(e,t,o,i);return s&&Fh(s)&&s.catch(a=>{Ll(a,t,o)}),s}if(tt(e)){const s=[];for(let a=0;a<e.length;a++)s.push(Po(e[a],t,o,i));return s}}function Ll(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:c}=t&&t.appContext.config||Mt;if(t){let u=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let g=0;g<f.length;g++)if(f[g](e,d,p)===!1)return}u=u.parent}if(a){Is(),ur(a,null,10,[e,d,p]),Ts();return}}bm(e,o,s,i,c)}function bm(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const $n=[];let Qo=-1;const oa=[];let js=null,Ki=0;const ff=Promise.resolve();let nl=null;function os(e){const t=nl||ff;return e?t.then(this?e.bind(this):e):t}function wm(e){let t=Qo+1,o=$n.length;for(;t<o;){const i=t+o>>>1,s=$n[i],a=Xa(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function gu(e){if(!(e.flags&1)){const t=Xa(e),o=$n[$n.length-1];!o||!(e.flags&2)&&t>=Xa(o)?$n.push(e):$n.splice(wm(t),0,e),e.flags|=1,pf()}}function pf(){nl||(nl=ff.then(gf))}function vf(e){tt(e)?oa.push(...e):js&&e.id===-1?js.splice(Ki+1,0,e):e.flags&1||(oa.push(e),e.flags|=1),pf()}function ad(e,t,o=Qo+1){for(;o<$n.length;o++){const i=$n[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;$n.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function mf(e){if(oa.length){const t=[...new Set(oa)].sort((o,i)=>Xa(o)-Xa(i));if(oa.length=0,js){js.push(...t);return}for(js=t,Ki=0;Ki<js.length;Ki++){const o=js[Ki];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}js=null,Ki=0}}const Xa=e=>e.id==null?e.flags&2?-1:1/0:e.id;function gf(e){try{for(Qo=0;Qo<$n.length;Qo++){const t=$n[Qo];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ur(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Qo<$n.length;Qo++){const t=$n[Qo];t&&(t.flags&=-2)}Qo=-1,$n.length=0,mf(),nl=null,($n.length||oa.length)&&gf()}}let on=null,yf=null;function ol(e){const t=on;return on=e,yf=e&&e.type.__scopeId||null,t}function qe(e,t=on,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&al(-1);const a=ol(t);let c;try{c=e(...s)}finally{ol(a),i._d&&al(1)}return c};return i._n=!0,i._c=!0,i._d=!0,i}function Ne(e,t){if(on===null)return e;const o=Ml(on),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,c,u,d=Mt]=t[s];a&&(ut(a)&&(a={mounted:a,updated:a}),a.deep&&ks(c),i.push({dir:a,instance:o,value:c,oldValue:void 0,arg:u,modifiers:d}))}return e}function _i(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let c=0;c<s.length;c++){const u=s[c];a&&(u.oldValue=a[c].value);let d=u.dir[i];d&&(Is(),Po(d,o,8,[e.el,u,e,t]),Ts())}}function Zr(e,t){if(fn){let o=fn.provides;const i=fn.parent&&fn.parent.provides;i===o&&(o=fn.provides=Object.create(i)),o[e]=t}}function ho(e,t,o=!1){const i=Tl();if(i||Pi){let s=Pi?Pi._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ut(t)?t.call(i&&i.proxy):t}}function Cm(){return!!(Tl()||Pi)}const Lm=Symbol.for("v-scx"),Sm=()=>ho(Lm);function je(e,t,o){return _f(e,t,o)}function _f(e,t,o=Mt){const{immediate:i,deep:s,flush:a,once:c}=o,u=tn({},o),d=t&&i||!t&&a!=="post";let p;if(nr){if(a==="sync"){const b=Sm();p=b.__watcherHandles||(b.__watcherHandles=[])}else if(!d){const b=()=>{};return b.stop=To,b.resume=To,b.pause=To,b}}const f=fn;u.call=(b,x,$)=>Po(b,f,x,$);let g=!1;a==="post"?u.scheduler=b=>{Sn(b,f&&f.suspense)}:a!=="sync"&&(g=!0,u.scheduler=(b,x)=>{x?b():gu(b)}),u.augmentJob=b=>{t&&(b.flags|=4),g&&(b.flags|=2,f&&(b.id=f.uid,b.i=f))};const _=km(e,t,u);return nr&&(p?p.push(_):d&&_()),_}function xm(e,t,o){const i=this.proxy,s=Ht(e)?e.includes(".")?kf(i,e):()=>i[e]:e.bind(i,i);let a;ut(t)?a=t:(a=t.handler,o=t);const c=dr(this),u=_f(s,a.bind(i),o);return c(),u}function kf(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const bf=Symbol("_vte"),wf=e=>e.__isTeleport,Va=e=>e&&(e.disabled||e.disabled===""),rd=e=>e&&(e.defer||e.defer===""),ld=e=>typeof SVGElement<"u"&&e instanceof SVGElement,cd=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Ec=(e,t)=>{const o=e&&e.to;return Ht(o)?t?t(o):null:o},Cf={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,c,u,d,p){const{mc:f,pc:g,pbc:_,o:{insert:b,querySelector:x,createText:$,createComment:B}}=p,P=Va(t.props);let{shapeFlag:M,children:S,dynamicChildren:A}=t;if(e==null){const I=t.el=$(""),T=t.anchor=$("");b(I,o,i),b(T,o,i);const C=(z,ae)=>{M&16&&f(S,z,ae,s,a,c,u,d)},V=()=>{const z=t.target=Ec(t.props,x),ae=Sf(z,t,$,b);z&&(c!=="svg"&&ld(z)?c="svg":c!=="mathml"&&cd(z)&&(c="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(z),P||(C(z,ae),jr(t,!1)))};P&&(C(o,T),jr(t,!0)),rd(t.props)?(t.el.__isMounted=!1,Sn(()=>{V(),delete t.el.__isMounted},a)):V()}else{if(rd(t.props)&&e.el.__isMounted===!1){Sn(()=>{Cf.process(e,t,o,i,s,a,c,u,d,p)},a);return}t.el=e.el,t.targetStart=e.targetStart;const I=t.anchor=e.anchor,T=t.target=e.target,C=t.targetAnchor=e.targetAnchor,V=Va(e.props),z=V?o:T,ae=V?I:C;if(c==="svg"||ld(T)?c="svg":(c==="mathml"||cd(T))&&(c="mathml"),A?(_(e.dynamicChildren,A,z,s,a,c,u),bu(e,t,!0)):d||g(e,t,z,ae,s,a,c,u,!1),P)V?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Br(t,o,I,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const j=t.target=Ec(t.props,x);j&&Br(t,j,null,p,0)}else V&&Br(t,T,C,p,1);jr(t,P)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:c,children:u,anchor:d,targetStart:p,targetAnchor:f,target:g,props:_}=e;if(g&&(s(p),s(f)),a&&s(d),c&16){const b=a||!Va(_);for(let x=0;x<u.length;x++){const $=u[x];i($,t,o,b,!!$.dynamicChildren)}}},move:Br,hydrate:$m};function Br(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:c,anchor:u,shapeFlag:d,children:p,props:f}=e,g=a===2;if(g&&i(c,t,o),(!g||Va(f))&&d&16)for(let _=0;_<p.length;_++)s(p[_],t,o,2);g&&i(u,t,o)}function $m(e,t,o,i,s,a,{o:{nextSibling:c,parentNode:u,querySelector:d,insert:p,createText:f}},g){function _($,B,P,M){B.anchor=g(c($),B,u($),o,i,s,a),B.targetStart=P,B.targetAnchor=M}const b=t.target=Ec(t.props,d),x=Va(t.props);if(b){const $=b._lpa||b.firstChild;if(t.shapeFlag&16)if(x)_(e,t,$,$&&c($));else{t.anchor=c(e);let B=$;for(;B;){if(B&&B.nodeType===8){if(B.data==="teleport start anchor")t.targetStart=B;else if(B.data==="teleport anchor"){t.targetAnchor=B,b._lpa=t.targetAnchor&&c(t.targetAnchor);break}}B=c(B)}t.targetAnchor||Sf(b,t,f,p),g($&&c($),t,b,o,i,s,a)}jr(t,x)}else x&&t.shapeFlag&16&&_(e,t,e,c(e));return t.anchor&&c(t.anchor)}const Lf=Cf;function jr(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function Sf(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[bf]=a,e&&(i(s,e),i(a,e)),a}const gs=Symbol("_leaveCb"),Nr=Symbol("_enterCb");function Im(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Yt(()=>{e.isMounted=!0}),Of(()=>{e.isUnmounting=!0}),e}const uo=[Function,Array],xf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:uo,onEnter:uo,onAfterEnter:uo,onEnterCancelled:uo,onBeforeLeave:uo,onLeave:uo,onAfterLeave:uo,onLeaveCancelled:uo,onBeforeAppear:uo,onAppear:uo,onAfterAppear:uo,onAppearCancelled:uo},$f=e=>{const t=e.subTree;return t.component?$f(t.component):t},Tm={name:"BaseTransition",props:xf,setup(e,{slots:t}){const o=Tl(),i=Im();return()=>{const s=t.default&&Mf(t.default(),!0);if(!s||!s.length)return;const a=If(s),c=bt(e),{mode:u}=c;if(i.isLeaving)return dc(a);const d=ud(a);if(!d)return dc(a);let p=Pc(d,c,i,o,g=>p=g);d.type!==hn&&Qa(d,p);let f=o.subTree&&ud(o.subTree);if(f&&f.type!==hn&&!Si(f,d)&&$f(o).type!==hn){let g=Pc(f,c,i,o);if(Qa(f,g),u==="out-in"&&d.type!==hn)return i.isLeaving=!0,g.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,f=void 0},dc(a);u==="in-out"&&d.type!==hn?g.delayLeave=(_,b,x)=>{const $=Tf(i,f);$[String(f.key)]=f,_[gs]=()=>{b(),_[gs]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{x(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return a}}};function If(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==hn){t=o;break}}return t}const Mm=Tm;function Tf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function Pc(e,t,o,i,s){const{appear:a,mode:c,persisted:u=!1,onBeforeEnter:d,onEnter:p,onAfterEnter:f,onEnterCancelled:g,onBeforeLeave:_,onLeave:b,onAfterLeave:x,onLeaveCancelled:$,onBeforeAppear:B,onAppear:P,onAfterAppear:M,onAppearCancelled:S}=t,A=String(e.key),I=Tf(o,e),T=(z,ae)=>{z&&Po(z,i,9,ae)},C=(z,ae)=>{const j=ae[1];T(z,ae),tt(z)?z.every(X=>X.length<=1)&&j():z.length<=1&&j()},V={mode:c,persisted:u,beforeEnter(z){let ae=d;if(!o.isMounted)if(a)ae=B||d;else return;z[gs]&&z[gs](!0);const j=I[A];j&&Si(e,j)&&j.el[gs]&&j.el[gs](),T(ae,[z])},enter(z){let ae=p,j=f,X=g;if(!o.isMounted)if(a)ae=P||p,j=M||f,X=S||g;else return;let ce=!1;const Te=z[Nr]=Ae=>{ce||(ce=!0,Ae?T(X,[z]):T(j,[z]),V.delayedLeave&&V.delayedLeave(),z[Nr]=void 0)};ae?C(ae,[z,Te]):Te()},leave(z,ae){const j=String(e.key);if(z[Nr]&&z[Nr](!0),o.isUnmounting)return ae();T(_,[z]);let X=!1;const ce=z[gs]=Te=>{X||(X=!0,ae(),Te?T($,[z]):T(x,[z]),z[gs]=void 0,I[j]===e&&delete I[j])};I[j]=e,b?C(b,[z,ce]):ce()},clone(z){const ae=Pc(z,t,o,i,s);return s&&s(ae),ae}};return V}function dc(e){if(Sl(e))return e=Qs(e),e.children=null,e}function ud(e){if(!Sl(e))return wf(e.type)&&e.children?If(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ut(o.default))return o.default()}}function Qa(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Qa(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Mf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let c=e[a];const u=o==null?c.key:String(o)+String(c.key!=null?c.key:a);c.type===be?(c.patchFlag&128&&s++,i=i.concat(Mf(c.children,t,u))):(t||c.type!==hn)&&i.push(u!=null?Qs(c,{key:u}):c)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function Af(e,t){return ut(e)?tn({name:e.name},t,{setup:e}):e}function Ef(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const sl=new WeakMap;function Ga(e,t,o,i,s=!1){if(tt(e)){e.forEach((x,$)=>Ga(x,t&&(tt(t)?t[$]:t),o,i,s));return}if(sa(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Ga(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?Ml(i.component):i.el,c=s?null:a,{i:u,r:d}=e,p=t&&t.r,f=u.refs===Mt?u.refs={}:u.refs,g=u.setupState,_=bt(g),b=g===Mt?Nh:x=>Lt(_,x);if(p!=null&&p!==d){if(dd(t),Ht(p))f[p]=null,b(p)&&(g[p]=null);else if(zt(p)){p.value=null;const x=t;x.k&&(f[x.k]=null)}}if(ut(d))ur(d,u,12,[c,f]);else{const x=Ht(d),$=zt(d);if(x||$){const B=()=>{if(e.f){const P=x?b(d)?g[d]:f[d]:d.value;if(s)tt(P)&&lu(P,a);else if(tt(P))P.includes(a)||P.push(a);else if(x)f[d]=[a],b(d)&&(g[d]=f[d]);else{const M=[a];d.value=M,e.k&&(f[e.k]=M)}}else x?(f[d]=c,b(d)&&(g[d]=c)):$&&(d.value=c,e.k&&(f[e.k]=c))};if(c){const P=()=>{B(),sl.delete(e)};P.id=-1,sl.set(e,P),Sn(P,o)}else dd(e),B()}}}function dd(e){const t=sl.get(e);t&&(t.flags|=8,sl.delete(e))}bl().requestIdleCallback;bl().cancelIdleCallback;const sa=e=>!!e.type.__asyncLoader,Sl=e=>e.type.__isKeepAlive;function Am(e,t){Pf(e,"a",t)}function Em(e,t){Pf(e,"da",t)}function Pf(e,t,o=fn){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(xl(t,i,o),o){let s=o.parent;for(;s&&s.parent;)Sl(s.parent.vnode)&&Pm(i,t,o,s),s=s.parent}}function Pm(e,t,o,i){const s=xl(t,e,i,!0);vo(()=>{lu(i[t],s)},o)}function xl(e,t,o=fn,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...c)=>{Is();const u=dr(o),d=Po(t,o,e,c);return u(),Ts(),d});return i?s.unshift(a):s.push(a),a}}const As=e=>(t,o=fn)=>{(!nr||e==="sp")&&xl(e,(...i)=>t(...i),o)},Dm=As("bm"),Yt=As("m"),Df=As("bu"),Om=As("u"),Of=As("bum"),vo=As("um"),Rm=As("sp"),Bm=As("rtg"),Nm=As("rtc");function Fm(e,t=fn){xl("ec",e,t)}const Um="components";function yu(e,t){return Hm(Um,e,!0,t)||e}const zm=Symbol.for("v-ndc");function Hm(e,t,o=!0,i=!1){const s=on||fn;if(s){const a=s.type;{const u=Sg(a,!1);if(u&&(u===t||u===po(t)||u===_l(po(t))))return a}const c=hd(s[e]||a[e],t)||hd(s.appContext[e],t);return!c&&i?a:c}}function hd(e,t){return e&&(e[t]||e[po(t)]||e[_l(po(t))])}function Oe(e,t,o,i){let s;const a=o,c=tt(e);if(c||Ht(e)){const u=c&&$s(e);let d=!1,p=!1;u&&(d=!oo(e),p=Ms(e),e=wl(e)),s=new Array(e.length);for(let f=0,g=e.length;f<g;f++)s[f]=t(d?p?aa(Eo(e[f])):Eo(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(It(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,p=u.length;d<p;d++){const f=u[d];s[d]=t(e[f],f,d,a)}}else s=[];return s}function Yi(e,t,o={},i,s){if(on.ce||on.parent&&sa(on.parent)&&on.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),Xe(be,null,[Re("slot",o,i&&i())],p?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),v();const c=a&&Rf(a(o)),u=o.key||c&&c.key,d=Xe(be,{key:(u&&!Ao(u)?u:`_${t}`)+(!c&&i?"_fb":"")},c||(i?i():[]),c&&e._===1?64:-2);return a&&a._c&&(a._d=!0),d}function Rf(e){return e.some(t=>tr(t)?!(t.type===hn||t.type===be&&!Rf(t.children)):!0)?e:null}const Dc=e=>e?tp(e)?Ml(e):Dc(e.parent):null,Za=tn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Dc(e.parent),$root:e=>Dc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Nf(e),$forceUpdate:e=>e.f||(e.f=()=>{gu(e.update)}),$nextTick:e=>e.n||(e.n=os.bind(e.proxy)),$watch:e=>xm.bind(e)}),hc=(e,t)=>e!==Mt&&!e.__isScriptSetup&&Lt(e,t),Vm={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:c,type:u,appContext:d}=e;if(t[0]!=="$"){const _=c[t];if(_!==void 0)switch(_){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(hc(i,t))return c[t]=1,i[t];if(s!==Mt&&Lt(s,t))return c[t]=2,s[t];if(Lt(a,t))return c[t]=3,a[t];if(o!==Mt&&Lt(o,t))return c[t]=4,o[t];Oc&&(c[t]=0)}}const p=Za[t];let f,g;if(p)return t==="$attrs"&&dn(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==Mt&&Lt(o,t))return c[t]=4,o[t];if(g=d.config.globalProperties,Lt(g,t))return g[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return hc(s,t)?(s[t]=o,!0):i!==Mt&&Lt(i,t)?(i[t]=o,!0):Lt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:c}},u){let d;return!!(o[u]||e!==Mt&&u[0]!=="$"&&Lt(e,u)||hc(t,u)||Lt(a,u)||Lt(i,u)||Lt(Za,u)||Lt(s.config.globalProperties,u)||(d=c.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Lt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function fd(e){return tt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Oc=!0;function Gm(e){const t=Nf(e),o=e.proxy,i=e.ctx;Oc=!1,t.beforeCreate&&pd(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:c,watch:u,provide:d,inject:p,created:f,beforeMount:g,mounted:_,beforeUpdate:b,updated:x,activated:$,deactivated:B,beforeDestroy:P,beforeUnmount:M,destroyed:S,unmounted:A,render:I,renderTracked:T,renderTriggered:C,errorCaptured:V,serverPrefetch:z,expose:ae,inheritAttrs:j,components:X,directives:ce,filters:Te}=t;if(p&&Zm(p,i,null),c)for(const pe in c){const me=c[pe];ut(me)&&(i[pe]=me.bind(o))}if(s){const pe=s.call(o,o);It(pe)&&(e.data=cr(pe))}if(Oc=!0,a)for(const pe in a){const me=a[pe],nt=ut(me)?me.bind(o,o):ut(me.get)?me.get.bind(o,o):To,Le=!ut(me)&&ut(me.set)?me.set.bind(o):To,Be=K({get:nt,set:Le});Object.defineProperty(i,pe,{enumerable:!0,configurable:!0,get:()=>Be.value,set:Ge=>Be.value=Ge})}if(u)for(const pe in u)Bf(u[pe],i,o,pe);if(d){const pe=ut(d)?d.call(o):d;Reflect.ownKeys(pe).forEach(me=>{Zr(me,pe[me])})}f&&pd(f,e,"c");function Ce(pe,me){tt(me)?me.forEach(nt=>pe(nt.bind(o))):me&&pe(me.bind(o))}if(Ce(Dm,g),Ce(Yt,_),Ce(Df,b),Ce(Om,x),Ce(Am,$),Ce(Em,B),Ce(Fm,V),Ce(Nm,T),Ce(Bm,C),Ce(Of,M),Ce(vo,A),Ce(Rm,z),tt(ae))if(ae.length){const pe=e.exposed||(e.exposed={});ae.forEach(me=>{Object.defineProperty(pe,me,{get:()=>o[me],set:nt=>o[me]=nt,enumerable:!0})})}else e.exposed||(e.exposed={});I&&e.render===To&&(e.render=I),j!=null&&(e.inheritAttrs=j),X&&(e.components=X),ce&&(e.directives=ce),z&&Ef(e)}function Zm(e,t,o=To){tt(e)&&(e=Rc(e));for(const i in e){const s=e[i];let a;It(s)?"default"in s?a=ho(s.from||i,s.default,!0):a=ho(s.from||i):a=ho(s),zt(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:c=>a.value=c}):t[i]=a}}function pd(e,t,o){Po(tt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function Bf(e,t,o,i){let s=i.includes(".")?kf(o,i):()=>o[i];if(Ht(e)){const a=t[e];ut(a)&&je(s,a)}else if(ut(e))je(s,e.bind(o));else if(It(e))if(tt(e))e.forEach(a=>Bf(a,t,o,i));else{const a=ut(e.handler)?e.handler.bind(o):t[e.handler];ut(a)&&je(s,a,e)}}function Nf(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:c}}=e.appContext,u=a.get(t);let d;return u?d=u:!s.length&&!o&&!i?d=t:(d={},s.length&&s.forEach(p=>il(d,p,c,!0)),il(d,t,c)),It(t)&&a.set(t,d),d}function il(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&il(e,a,o,!0),s&&s.forEach(c=>il(e,c,o,!0));for(const c in t)if(!(i&&c==="expose")){const u=jm[c]||o&&o[c];e[c]=u?u(e[c],t[c]):t[c]}return e}const jm={data:vd,props:md,emits:md,methods:Oa,computed:Oa,beforeCreate:Ln,created:Ln,beforeMount:Ln,mounted:Ln,beforeUpdate:Ln,updated:Ln,beforeDestroy:Ln,beforeUnmount:Ln,destroyed:Ln,unmounted:Ln,activated:Ln,deactivated:Ln,errorCaptured:Ln,serverPrefetch:Ln,components:Oa,directives:Oa,watch:Wm,provide:vd,inject:qm};function vd(e,t){return t?e?function(){return tn(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function qm(e,t){return Oa(Rc(e),Rc(t))}function Rc(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Ln(e,t){return e?[...new Set([].concat(e,t))]:t}function Oa(e,t){return e?tn(Object.create(null),e,t):t}function md(e,t){return e?tt(e)&&tt(t)?[...new Set([...e,...t])]:tn(Object.create(null),fd(e),fd(t??{})):t}function Wm(e,t){if(!e)return t;if(!t)return e;const o=tn(Object.create(null),e);for(const i in t)o[i]=Ln(e[i],t[i]);return o}function Ff(){return{app:null,config:{isNativeTag:Nh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Km=0;function Ym(e,t){return function(i,s=null){ut(i)||(i=tn({},i)),s!=null&&!It(s)&&(s=null);const a=Ff(),c=new WeakSet,u=[];let d=!1;const p=a.app={_uid:Km++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:$g,get config(){return a.config},set config(f){},use(f,...g){return c.has(f)||(f&&ut(f.install)?(c.add(f),f.install(p,...g)):ut(f)&&(c.add(f),f(p,...g))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,g){return g?(a.components[f]=g,p):a.components[f]},directive(f,g){return g?(a.directives[f]=g,p):a.directives[f]},mount(f,g,_){if(!d){const b=p._ceVNode||Re(i,s);return b.appContext=a,_===!0?_="svg":_===!1&&(_=void 0),e(b,f,_),d=!0,p._container=f,f.__vue_app__=p,Ml(b.component)}},onUnmount(f){u.push(f)},unmount(){d&&(Po(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,g){return a.provides[f]=g,p},runWithContext(f){const g=Pi;Pi=p;try{return f()}finally{Pi=g}}};return p}}let Pi=null;const Jm=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${po(t)}Modifiers`]||e[`${ni(t)}Modifiers`];function Xm(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Mt;let s=o;const a=t.startsWith("update:"),c=a&&Jm(i,t.slice(7));c&&(c.trim&&(s=o.map(f=>Ht(f)?f.trim():f)),c.number&&(s=o.map(kl)));let u,d=i[u=ac(t)]||i[u=ac(po(t))];!d&&a&&(d=i[u=ac(ni(t))]),d&&Po(d,e,6,s);const p=i[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Po(p,e,6,s)}}const Qm=new WeakMap;function Uf(e,t,o=!1){const i=o?Qm:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let c={},u=!1;if(!ut(e)){const d=p=>{const f=Uf(p,t,!0);f&&(u=!0,tn(c,f))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!a&&!u?(It(e)&&i.set(e,null),null):(tt(a)?a.forEach(d=>c[d]=null):tn(c,a),It(e)&&i.set(e,c),c)}function $l(e,t){return!e||!ml(t)?!1:(t=t.slice(2).replace(/Once$/,""),Lt(e,t[0].toLowerCase()+t.slice(1))||Lt(e,ni(t))||Lt(e,t))}function gd(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:c,attrs:u,emit:d,render:p,renderCache:f,props:g,data:_,setupState:b,ctx:x,inheritAttrs:$}=e,B=ol(e);let P,M;try{if(o.shapeFlag&4){const A=s||i,I=A;P=es(p.call(I,A,f,g,b,_,x)),M=u}else{const A=t;P=es(A.length>1?A(g,{attrs:u,slots:c,emit:d}):A(g,null)),M=t.props?u:eg(u)}}catch(A){qa.length=0,Ll(A,e,1),P=Re(hn)}let S=P;if(M&&$!==!1){const A=Object.keys(M),{shapeFlag:I}=S;A.length&&I&7&&(a&&A.some(ru)&&(M=tg(M,a)),S=Qs(S,M,!1,!0))}return o.dirs&&(S=Qs(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(o.dirs):o.dirs),o.transition&&Qa(S,o.transition),P=S,ol(B),P}const eg=e=>{let t;for(const o in e)(o==="class"||o==="style"||ml(o))&&((t||(t={}))[o]=e[o]);return t},tg=(e,t)=>{const o={};for(const i in e)(!ru(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function ng(e,t,o){const{props:i,children:s,component:a}=e,{props:c,children:u,patchFlag:d}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return i?yd(i,c,p):!!c;if(d&8){const f=t.dynamicProps;for(let g=0;g<f.length;g++){const _=f[g];if(c[_]!==i[_]&&!$l(p,_))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===c?!1:i?c?yd(i,c,p):!0:!!c;return!1}function yd(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!$l(o,a))return!0}return!1}function og({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const zf={},Hf=()=>Object.create(zf),Vf=e=>Object.getPrototypeOf(e)===zf;function sg(e,t,o,i=!1){const s={},a=Hf();e.propsDefaults=Object.create(null),Gf(e,t,s,a);for(const c in e.propsOptions[0])c in s||(s[c]=void 0);o?e.props=i?s:uf(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function ig(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:c}}=e,u=bt(s),[d]=e.propsOptions;let p=!1;if((i||c>0)&&!(c&16)){if(c&8){const f=e.vnode.dynamicProps;for(let g=0;g<f.length;g++){let _=f[g];if($l(e.emitsOptions,_))continue;const b=t[_];if(d)if(Lt(a,_))b!==a[_]&&(a[_]=b,p=!0);else{const x=po(_);s[x]=Bc(d,u,x,b,e,!1)}else b!==a[_]&&(a[_]=b,p=!0)}}}else{Gf(e,t,s,a)&&(p=!0);let f;for(const g in u)(!t||!Lt(t,g)&&((f=ni(g))===g||!Lt(t,f)))&&(d?o&&(o[g]!==void 0||o[f]!==void 0)&&(s[g]=Bc(d,u,g,void 0,e,!0)):delete s[g]);if(a!==u)for(const g in a)(!t||!Lt(t,g))&&(delete a[g],p=!0)}p&&_s(e.attrs,"set","")}function Gf(e,t,o,i){const[s,a]=e.propsOptions;let c=!1,u;if(t)for(let d in t){if(Ua(d))continue;const p=t[d];let f;s&&Lt(s,f=po(d))?!a||!a.includes(f)?o[f]=p:(u||(u={}))[f]=p:$l(e.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,c=!0)}if(a){const d=bt(o),p=u||Mt;for(let f=0;f<a.length;f++){const g=a[f];o[g]=Bc(s,d,g,p[g],e,!Lt(p,g))}}return c}function Bc(e,t,o,i,s,a){const c=e[o];if(c!=null){const u=Lt(c,"default");if(u&&i===void 0){const d=c.default;if(c.type!==Function&&!c.skipFactory&&ut(d)){const{propsDefaults:p}=s;if(o in p)i=p[o];else{const f=dr(s);i=p[o]=d.call(null,t),f()}}else i=d;s.ce&&s.ce._setProp(o,i)}c[0]&&(a&&!u?i=!1:c[1]&&(i===""||i===ni(o))&&(i=!0))}return i}const ag=new WeakMap;function Zf(e,t,o=!1){const i=o?ag:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,c={},u=[];let d=!1;if(!ut(e)){const f=g=>{d=!0;const[_,b]=Zf(g,t,!0);tn(c,_),b&&u.push(...b)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!d)return It(e)&&i.set(e,ta),ta;if(tt(a))for(let f=0;f<a.length;f++){const g=po(a[f]);_d(g)&&(c[g]=Mt)}else if(a)for(const f in a){const g=po(f);if(_d(g)){const _=a[f],b=c[g]=tt(_)||ut(_)?{type:_}:tn({},_),x=b.type;let $=!1,B=!0;if(tt(x))for(let P=0;P<x.length;++P){const M=x[P],S=ut(M)&&M.name;if(S==="Boolean"){$=!0;break}else S==="String"&&(B=!1)}else $=ut(x)&&x.name==="Boolean";b[0]=$,b[1]=B,($||Lt(b,"default"))&&u.push(g)}}const p=[c,u];return It(e)&&i.set(e,p),p}function _d(e){return e[0]!=="$"&&!Ua(e)}const _u=e=>e==="_"||e==="_ctx"||e==="$stable",ku=e=>tt(e)?e.map(es):[es(e)],rg=(e,t,o)=>{if(t._n)return t;const i=qe((...s)=>ku(t(...s)),o);return i._c=!1,i},jf=(e,t,o)=>{const i=e._ctx;for(const s in e){if(_u(s))continue;const a=e[s];if(ut(a))t[s]=rg(s,a,i);else if(a!=null){const c=ku(a);t[s]=()=>c}}},qf=(e,t)=>{const o=ku(t);e.slots.default=()=>o},Wf=(e,t,o)=>{for(const i in t)(o||!_u(i))&&(e[i]=t[i])},lg=(e,t,o)=>{const i=e.slots=Hf();if(e.vnode.shapeFlag&32){const s=t._;s?(Wf(i,t,o),o&&Hh(i,"_",s,!0)):jf(t,i)}else t&&qf(e,t)},cg=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,c=Mt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:Wf(s,t,o):(a=!t.$stable,jf(t,s)),c=t}else t&&(qf(e,t),c={default:1});if(a)for(const u in s)!_u(u)&&c[u]==null&&delete s[u]},Sn=pg;function ug(e){return dg(e)}function dg(e,t){const o=bl();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:c,createText:u,createComment:d,setText:p,setElementText:f,parentNode:g,nextSibling:_,setScopeId:b=To,insertStaticContent:x}=e,$=(R,W,oe,Y=null,F=null,N=null,te=void 0,ve=null,xe=!!W.dynamicChildren)=>{if(R===W)return;R&&!Si(R,W)&&(Y=de(R),Ge(R,F,N,!0),R=null),W.patchFlag===-2&&(xe=!1,W.dynamicChildren=null);const{type:we,ref:Ve,shapeFlag:$e}=W;switch(we){case Il:B(R,W,oe,Y);break;case hn:P(R,W,oe,Y);break;case ja:R==null&&M(W,oe,Y,te);break;case be:X(R,W,oe,Y,F,N,te,ve,xe);break;default:$e&1?I(R,W,oe,Y,F,N,te,ve,xe):$e&6?ce(R,W,oe,Y,F,N,te,ve,xe):($e&64||$e&128)&&we.process(R,W,oe,Y,F,N,te,ve,xe,Q)}Ve!=null&&F?Ga(Ve,R&&R.ref,N,W||R,!W):Ve==null&&R&&R.ref!=null&&Ga(R.ref,null,N,R,!0)},B=(R,W,oe,Y)=>{if(R==null)i(W.el=u(W.children),oe,Y);else{const F=W.el=R.el;W.children!==R.children&&p(F,W.children)}},P=(R,W,oe,Y)=>{R==null?i(W.el=d(W.children||""),oe,Y):W.el=R.el},M=(R,W,oe,Y)=>{[R.el,R.anchor]=x(R.children,W,oe,Y,R.el,R.anchor)},S=({el:R,anchor:W},oe,Y)=>{let F;for(;R&&R!==W;)F=_(R),i(R,oe,Y),R=F;i(W,oe,Y)},A=({el:R,anchor:W})=>{let oe;for(;R&&R!==W;)oe=_(R),s(R),R=oe;s(W)},I=(R,W,oe,Y,F,N,te,ve,xe)=>{if(W.type==="svg"?te="svg":W.type==="math"&&(te="mathml"),R==null)T(W,oe,Y,F,N,te,ve,xe);else{const we=R.el&&R.el._isVueCE?R.el:null;try{we&&we._beginPatch(),z(R,W,F,N,te,ve,xe)}finally{we&&we._endPatch()}}},T=(R,W,oe,Y,F,N,te,ve)=>{let xe,we;const{props:Ve,shapeFlag:$e,transition:Ze,dirs:We}=R;if(xe=R.el=c(R.type,N,Ve&&Ve.is,Ve),$e&8?f(xe,R.children):$e&16&&V(R.children,xe,null,Y,F,fc(R,N),te,ve),We&&_i(R,null,Y,"created"),C(xe,R,R.scopeId,te,Y),Ve){for(const se in Ve)se!=="value"&&!Ua(se)&&a(xe,se,null,Ve[se],N,Y);"value"in Ve&&a(xe,"value",null,Ve.value,N),(we=Ve.onVnodeBeforeMount)&&Jo(we,Y,R)}We&&_i(R,null,Y,"beforeMount");const re=hg(F,Ze);re&&Ze.beforeEnter(xe),i(xe,W,oe),((we=Ve&&Ve.onVnodeMounted)||re||We)&&Sn(()=>{we&&Jo(we,Y,R),re&&Ze.enter(xe),We&&_i(R,null,Y,"mounted")},F)},C=(R,W,oe,Y,F)=>{if(oe&&b(R,oe),Y)for(let N=0;N<Y.length;N++)b(R,Y[N]);if(F){let N=F.subTree;if(W===N||Jf(N.type)&&(N.ssContent===W||N.ssFallback===W)){const te=F.vnode;C(R,te,te.scopeId,te.slotScopeIds,F.parent)}}},V=(R,W,oe,Y,F,N,te,ve,xe=0)=>{for(let we=xe;we<R.length;we++){const Ve=R[we]=ve?qs(R[we]):es(R[we]);$(null,Ve,W,oe,Y,F,N,te,ve)}},z=(R,W,oe,Y,F,N,te)=>{const ve=W.el=R.el;let{patchFlag:xe,dynamicChildren:we,dirs:Ve}=W;xe|=R.patchFlag&16;const $e=R.props||Mt,Ze=W.props||Mt;let We;if(oe&&ki(oe,!1),(We=Ze.onVnodeBeforeUpdate)&&Jo(We,oe,W,R),Ve&&_i(W,R,oe,"beforeUpdate"),oe&&ki(oe,!0),($e.innerHTML&&Ze.innerHTML==null||$e.textContent&&Ze.textContent==null)&&f(ve,""),we?ae(R.dynamicChildren,we,ve,oe,Y,fc(W,F),N):te||me(R,W,ve,null,oe,Y,fc(W,F),N,!1),xe>0){if(xe&16)j(ve,$e,Ze,oe,F);else if(xe&2&&$e.class!==Ze.class&&a(ve,"class",null,Ze.class,F),xe&4&&a(ve,"style",$e.style,Ze.style,F),xe&8){const re=W.dynamicProps;for(let se=0;se<re.length;se++){const J=re[se],Ue=$e[J],Qe=Ze[J];(Qe!==Ue||J==="value")&&a(ve,J,Ue,Qe,F,oe)}}xe&1&&R.children!==W.children&&f(ve,W.children)}else!te&&we==null&&j(ve,$e,Ze,oe,F);((We=Ze.onVnodeUpdated)||Ve)&&Sn(()=>{We&&Jo(We,oe,W,R),Ve&&_i(W,R,oe,"updated")},Y)},ae=(R,W,oe,Y,F,N,te)=>{for(let ve=0;ve<W.length;ve++){const xe=R[ve],we=W[ve],Ve=xe.el&&(xe.type===be||!Si(xe,we)||xe.shapeFlag&198)?g(xe.el):oe;$(xe,we,Ve,null,Y,F,N,te,!0)}},j=(R,W,oe,Y,F)=>{if(W!==oe){if(W!==Mt)for(const N in W)!Ua(N)&&!(N in oe)&&a(R,N,W[N],null,F,Y);for(const N in oe){if(Ua(N))continue;const te=oe[N],ve=W[N];te!==ve&&N!=="value"&&a(R,N,ve,te,F,Y)}"value"in oe&&a(R,"value",W.value,oe.value,F)}},X=(R,W,oe,Y,F,N,te,ve,xe)=>{const we=W.el=R?R.el:u(""),Ve=W.anchor=R?R.anchor:u("");let{patchFlag:$e,dynamicChildren:Ze,slotScopeIds:We}=W;We&&(ve=ve?ve.concat(We):We),R==null?(i(we,oe,Y),i(Ve,oe,Y),V(W.children||[],oe,Ve,F,N,te,ve,xe)):$e>0&&$e&64&&Ze&&R.dynamicChildren&&R.dynamicChildren.length===Ze.length?(ae(R.dynamicChildren,Ze,oe,F,N,te,ve),(W.key!=null||F&&W===F.subTree)&&bu(R,W,!0)):me(R,W,oe,Ve,F,N,te,ve,xe)},ce=(R,W,oe,Y,F,N,te,ve,xe)=>{W.slotScopeIds=ve,R==null?W.shapeFlag&512?F.ctx.activate(W,oe,Y,te,xe):Te(W,oe,Y,F,N,te,xe):Ae(R,W,xe)},Te=(R,W,oe,Y,F,N,te)=>{const ve=R.component=kg(R,Y,F);if(Sl(R)&&(ve.ctx.renderer=Q),bg(ve,!1,te),ve.asyncDep){if(F&&F.registerDep(ve,Ce,te),!R.el){const xe=ve.subTree=Re(hn);P(null,xe,W,oe),R.placeholder=xe.el}}else Ce(ve,R,W,oe,F,N,te)},Ae=(R,W,oe)=>{const Y=W.component=R.component;if(ng(R,W,oe))if(Y.asyncDep&&!Y.asyncResolved){pe(Y,W,oe);return}else Y.next=W,Y.update();else W.el=R.el,Y.vnode=W},Ce=(R,W,oe,Y,F,N,te)=>{const ve=()=>{if(R.isMounted){let{next:$e,bu:Ze,u:We,parent:re,vnode:se}=R;{const vt=Kf(R);if(vt){$e&&($e.el=se.el,pe(R,$e,te)),vt.asyncDep.then(()=>{R.isUnmounted||ve()});return}}let J=$e,Ue;ki(R,!1),$e?($e.el=se.el,pe(R,$e,te)):$e=se,Ze&&Gr(Ze),(Ue=$e.props&&$e.props.onVnodeBeforeUpdate)&&Jo(Ue,re,$e,se),ki(R,!0);const Qe=gd(R),ot=R.subTree;R.subTree=Qe,$(ot,Qe,g(ot.el),de(ot),R,F,N),$e.el=Qe.el,J===null&&og(R,Qe.el),We&&Sn(We,F),(Ue=$e.props&&$e.props.onVnodeUpdated)&&Sn(()=>Jo(Ue,re,$e,se),F)}else{let $e;const{el:Ze,props:We}=W,{bm:re,m:se,parent:J,root:Ue,type:Qe}=R,ot=sa(W);ki(R,!1),re&&Gr(re),!ot&&($e=We&&We.onVnodeBeforeMount)&&Jo($e,J,W),ki(R,!0);{Ue.ce&&Ue.ce._def.shadowRoot!==!1&&Ue.ce._injectChildStyle(Qe);const vt=R.subTree=gd(R);$(null,vt,oe,Y,R,F,N),W.el=vt.el}if(se&&Sn(se,F),!ot&&($e=We&&We.onVnodeMounted)){const vt=W;Sn(()=>Jo($e,J,vt),F)}(W.shapeFlag&256||J&&sa(J.vnode)&&J.vnode.shapeFlag&256)&&R.a&&Sn(R.a,F),R.isMounted=!0,W=oe=Y=null}};R.scope.on();const xe=R.effect=new Kh(ve);R.scope.off();const we=R.update=xe.run.bind(xe),Ve=R.job=xe.runIfDirty.bind(xe);Ve.i=R,Ve.id=R.uid,xe.scheduler=()=>gu(Ve),ki(R,!0),we()},pe=(R,W,oe)=>{W.component=R;const Y=R.vnode.props;R.vnode=W,R.next=null,ig(R,W.props,Y,oe),cg(R,W.children,oe),Is(),ad(R),Ts()},me=(R,W,oe,Y,F,N,te,ve,xe=!1)=>{const we=R&&R.children,Ve=R?R.shapeFlag:0,$e=W.children,{patchFlag:Ze,shapeFlag:We}=W;if(Ze>0){if(Ze&128){Le(we,$e,oe,Y,F,N,te,ve,xe);return}else if(Ze&256){nt(we,$e,oe,Y,F,N,te,ve,xe);return}}We&8?(Ve&16&&Me(we,F,N),$e!==we&&f(oe,$e)):Ve&16?We&16?Le(we,$e,oe,Y,F,N,te,ve,xe):Me(we,F,N,!0):(Ve&8&&f(oe,""),We&16&&V($e,oe,Y,F,N,te,ve,xe))},nt=(R,W,oe,Y,F,N,te,ve,xe)=>{R=R||ta,W=W||ta;const we=R.length,Ve=W.length,$e=Math.min(we,Ve);let Ze;for(Ze=0;Ze<$e;Ze++){const We=W[Ze]=xe?qs(W[Ze]):es(W[Ze]);$(R[Ze],We,oe,null,F,N,te,ve,xe)}we>Ve?Me(R,F,N,!0,!1,$e):V(W,oe,Y,F,N,te,ve,xe,$e)},Le=(R,W,oe,Y,F,N,te,ve,xe)=>{let we=0;const Ve=W.length;let $e=R.length-1,Ze=Ve-1;for(;we<=$e&&we<=Ze;){const We=R[we],re=W[we]=xe?qs(W[we]):es(W[we]);if(Si(We,re))$(We,re,oe,null,F,N,te,ve,xe);else break;we++}for(;we<=$e&&we<=Ze;){const We=R[$e],re=W[Ze]=xe?qs(W[Ze]):es(W[Ze]);if(Si(We,re))$(We,re,oe,null,F,N,te,ve,xe);else break;$e--,Ze--}if(we>$e){if(we<=Ze){const We=Ze+1,re=We<Ve?W[We].el:Y;for(;we<=Ze;)$(null,W[we]=xe?qs(W[we]):es(W[we]),oe,re,F,N,te,ve,xe),we++}}else if(we>Ze)for(;we<=$e;)Ge(R[we],F,N,!0),we++;else{const We=we,re=we,se=new Map;for(we=re;we<=Ze;we++){const gt=W[we]=xe?qs(W[we]):es(W[we]);gt.key!=null&&se.set(gt.key,we)}let J,Ue=0;const Qe=Ze-re+1;let ot=!1,vt=0;const Tt=new Array(Qe);for(we=0;we<Qe;we++)Tt[we]=0;for(we=We;we<=$e;we++){const gt=R[we];if(Ue>=Qe){Ge(gt,F,N,!0);continue}let qt;if(gt.key!=null)qt=se.get(gt.key);else for(J=re;J<=Ze;J++)if(Tt[J-re]===0&&Si(gt,W[J])){qt=J;break}qt===void 0?Ge(gt,F,N,!0):(Tt[qt-re]=we+1,qt>=vt?vt=qt:ot=!0,$(gt,W[qt],oe,null,F,N,te,ve,xe),Ue++)}const Jt=ot?fg(Tt):ta;for(J=Jt.length-1,we=Qe-1;we>=0;we--){const gt=re+we,qt=W[gt],Dt=W[gt+1],_t=gt+1<Ve?Dt.el||Yf(Dt):Y;Tt[we]===0?$(null,qt,oe,_t,F,N,te,ve,xe):ot&&(J<0||we!==Jt[J]?Be(qt,oe,_t,2):J--)}}},Be=(R,W,oe,Y,F=null)=>{const{el:N,type:te,transition:ve,children:xe,shapeFlag:we}=R;if(we&6){Be(R.component.subTree,W,oe,Y);return}if(we&128){R.suspense.move(W,oe,Y);return}if(we&64){te.move(R,W,oe,Q);return}if(te===be){i(N,W,oe);for(let $e=0;$e<xe.length;$e++)Be(xe[$e],W,oe,Y);i(R.anchor,W,oe);return}if(te===ja){S(R,W,oe);return}if(Y!==2&&we&1&&ve)if(Y===0)ve.beforeEnter(N),i(N,W,oe),Sn(()=>ve.enter(N),F);else{const{leave:$e,delayLeave:Ze,afterLeave:We}=ve,re=()=>{R.ctx.isUnmounted?s(N):i(N,W,oe)},se=()=>{N._isLeaving&&N[gs](!0),$e(N,()=>{re(),We&&We()})};Ze?Ze(N,re,se):se()}else i(N,W,oe)},Ge=(R,W,oe,Y=!1,F=!1)=>{const{type:N,props:te,ref:ve,children:xe,dynamicChildren:we,shapeFlag:Ve,patchFlag:$e,dirs:Ze,cacheIndex:We}=R;if($e===-2&&(F=!1),ve!=null&&(Is(),Ga(ve,null,oe,R,!0),Ts()),We!=null&&(W.renderCache[We]=void 0),Ve&256){W.ctx.deactivate(R);return}const re=Ve&1&&Ze,se=!sa(R);let J;if(se&&(J=te&&te.onVnodeBeforeUnmount)&&Jo(J,W,R),Ve&6)Ee(R.component,oe,Y);else{if(Ve&128){R.suspense.unmount(oe,Y);return}re&&_i(R,null,W,"beforeUnmount"),Ve&64?R.type.remove(R,W,oe,Q,Y):we&&!we.hasOnce&&(N!==be||$e>0&&$e&64)?Me(we,W,oe,!1,!0):(N===be&&$e&384||!F&&Ve&16)&&Me(xe,W,oe),Y&&ue(R)}(se&&(J=te&&te.onVnodeUnmounted)||re)&&Sn(()=>{J&&Jo(J,W,R),re&&_i(R,null,W,"unmounted")},oe)},ue=R=>{const{type:W,el:oe,anchor:Y,transition:F}=R;if(W===be){Pe(oe,Y);return}if(W===ja){A(R);return}const N=()=>{s(oe),F&&!F.persisted&&F.afterLeave&&F.afterLeave()};if(R.shapeFlag&1&&F&&!F.persisted){const{leave:te,delayLeave:ve}=F,xe=()=>te(oe,N);ve?ve(R.el,N,xe):xe()}else N()},Pe=(R,W)=>{let oe;for(;R!==W;)oe=_(R),s(R),R=oe;s(W)},Ee=(R,W,oe)=>{const{bum:Y,scope:F,job:N,subTree:te,um:ve,m:xe,a:we}=R;kd(xe),kd(we),Y&&Gr(Y),F.stop(),N&&(N.flags|=8,Ge(te,R,W,oe)),ve&&Sn(ve,W),Sn(()=>{R.isUnmounted=!0},W)},Me=(R,W,oe,Y=!1,F=!1,N=0)=>{for(let te=N;te<R.length;te++)Ge(R[te],W,oe,Y,F)},de=R=>{if(R.shapeFlag&6)return de(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const W=_(R.anchor||R.el),oe=W&&W[bf];return oe?_(oe):W};let ke=!1;const H=(R,W,oe)=>{let Y;R==null?W._vnode&&(Ge(W._vnode,null,null,!0),Y=W._vnode.component):$(W._vnode||null,R,W,null,null,null,oe),W._vnode=R,ke||(ke=!0,ad(Y),mf(),ke=!1)},Q={p:$,um:Ge,m:Be,r:ue,mt:Te,mc:V,pc:me,pbc:ae,n:de,o:e};return{render:H,hydrate:void 0,createApp:Ym(H)}}function fc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function ki({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function hg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bu(e,t,o=!1){const i=e.children,s=t.children;if(tt(i)&&tt(s))for(let a=0;a<i.length;a++){const c=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=qs(s[a]),u.el=c.el),!o&&u.patchFlag!==-2&&bu(c,u)),u.type===Il&&(u.patchFlag!==-1?u.el=c.el:u.__elIndex=a+(e.type===be?1:0)),u.type===hn&&!u.el&&(u.el=c.el)}}function fg(e){const t=e.slice(),o=[0];let i,s,a,c,u;const d=e.length;for(i=0;i<d;i++){const p=e[i];if(p!==0){if(s=o[o.length-1],e[s]<p){t[i]=s,o.push(i);continue}for(a=0,c=o.length-1;a<c;)u=a+c>>1,e[o[u]]<p?a=u+1:c=u;p<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,c=o[a-1];a-- >0;)o[a]=c,c=t[c];return o}function Kf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Kf(t)}function kd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Yf(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Yf(t.subTree):null}const Jf=e=>e.__isSuspense;function pg(e,t){t&&t.pendingBranch?tt(e)?t.effects.push(...e):t.effects.push(e):vf(e)}const be=Symbol.for("v-fgt"),Il=Symbol.for("v-txt"),hn=Symbol.for("v-cmt"),ja=Symbol.for("v-stc"),qa=[];let no=null;function v(e=!1){qa.push(no=e?null:[])}function vg(){qa.pop(),no=qa[qa.length-1]||null}let er=1;function al(e,t=!1){er+=e,e<0&&no&&t&&(no.hasOnce=!0)}function Xf(e){return e.dynamicChildren=er>0?no||ta:null,vg(),er>0&&no&&no.push(e),e}function y(e,t,o,i,s,a){return Xf(l(e,t,o,i,s,a,!0))}function Xe(e,t,o,i,s){return Xf(Re(e,t,o,i,s,!0))}function tr(e){return e?e.__v_isVNode===!0:!1}function Si(e,t){return e.type===t.type&&e.key===t.key}const Qf=({key:e})=>e??null,qr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Ht(e)||zt(e)||ut(e)?{i:on,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,i=0,s=null,a=e===be?0:1,c=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Qf(t),ref:t&&qr(t),scopeId:yf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:on};return u?(wu(d,o),a&128&&e.normalize(d)):o&&(d.shapeFlag|=Ht(o)?8:16),er>0&&!c&&no&&(d.patchFlag>0||a&6)&&d.patchFlag!==32&&no.push(d),d}const Re=mg;function mg(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===zm)&&(e=hn),tr(e)){const u=Qs(e,t,!0);return o&&wu(u,o),er>0&&!a&&no&&(u.shapeFlag&6?no[no.indexOf(e)]=u:no.push(u)),u.patchFlag=-2,u}if(xg(e)&&(e=e.__vccOpts),t){t=gg(t);let{class:u,style:d}=t;u&&!Ht(u)&&(t.class=fe(u)),It(d)&&(Cl(d)&&!tt(d)&&(d=tn({},d)),t.style=it(d))}const c=Ht(e)?1:Jf(e)?128:wf(e)?64:It(e)?4:ut(e)?2:0;return l(e,t,o,i,s,c,a,!0)}function gg(e){return e?Cl(e)||Vf(e)?tn({},e):e:null}function Qs(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:c,children:u,transition:d}=e,p=t?ep(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&Qf(p),ref:t&&t.ref?o&&a?tt(a)?a.concat(qr(t)):[a,qr(t)]:qr(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==be?c===-1?16:c|16:c,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Qs(e.ssContent),ssFallback:e.ssFallback&&Qs(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&Qa(f,d.clone(f)),f}function He(e=" ",t=0){return Re(Il,null,e,t)}function rl(e,t){const o=Re(ja,null,e);return o.staticCount=t,o}function D(e="",t=!1){return t?(v(),Xe(hn,null,e)):Re(hn,null,e)}function es(e){return e==null||typeof e=="boolean"?Re(hn):tt(e)?Re(be,null,e.slice()):tr(e)?qs(e):Re(Il,null,String(e))}function qs(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Qs(e)}function wu(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(tt(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),wu(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Vf(t)?t._ctx=on:s===3&&on&&(on.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:on},o=32):(t=String(t),i&64?(o=16,t=[He(t)]):o=8);e.children=t,e.shapeFlag|=o}function ep(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=fe([t.class,i.class]));else if(s==="style")t.style=it([t.style,i.style]);else if(ml(s)){const a=t[s],c=i[s];c&&a!==c&&!(tt(a)&&a.includes(c))&&(t[s]=a?[].concat(a,c):c)}else s!==""&&(t[s]=i[s])}return t}function Jo(e,t,o,i=null){Po(e,t,7,[o,i])}const yg=Ff();let _g=0;function kg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||yg,a={uid:_g++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new jh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zf(i,s),emitsOptions:Uf(i,s),emit:null,emitted:null,propsDefaults:Mt,inheritAttrs:i.inheritAttrs,ctx:Mt,data:Mt,props:Mt,attrs:Mt,slots:Mt,refs:Mt,setupState:Mt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Xm.bind(null,a),e.ce&&e.ce(a),a}let fn=null;const Tl=()=>fn||on;let ll,Nc;{const e=bl(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(c=>c(a)):s[0](a)}};ll=t("__VUE_INSTANCE_SETTERS__",o=>fn=o),Nc=t("__VUE_SSR_SETTERS__",o=>nr=o)}const dr=e=>{const t=fn;return ll(e),e.scope.on(),()=>{e.scope.off(),ll(t)}},bd=()=>{fn&&fn.scope.off(),ll(null)};function tp(e){return e.vnode.shapeFlag&4}let nr=!1;function bg(e,t=!1,o=!1){t&&Nc(t);const{props:i,children:s}=e.vnode,a=tp(e);sg(e,i,a,t),lg(e,s,o||t);const c=a?wg(e,t):void 0;return t&&Nc(!1),c}function wg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Vm);const{setup:i}=o;if(i){Is();const s=e.setupContext=i.length>1?Lg(e):null,a=dr(e),c=ur(i,e,0,[e.props,s]),u=Fh(c);if(Ts(),a(),(u||e.sp)&&!sa(e)&&Ef(e),u){if(c.then(bd,bd),t)return c.then(d=>{wd(e,d)}).catch(d=>{Ll(d,e,0)});e.asyncDep=c}else wd(e,c)}else np(e)}function wd(e,t,o){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:It(t)&&(e.setupState=hf(t)),np(e)}function np(e,t,o){const i=e.type;e.render||(e.render=i.render||To);{const s=dr(e);Is();try{Gm(e)}finally{Ts(),s()}}}const Cg={get(e,t){return dn(e,"get",""),e[t]}};function Lg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,Cg),slots:e.slots,emit:e.emit,expose:t}}function Ml(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(hf(mu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Za)return Za[o](e)},has(t,o){return o in t||o in Za}})):e.proxy}function Sg(e,t=!0){return ut(e)?e.displayName||e.name:e.name||t&&e.__name}function xg(e){return ut(e)&&"__vccOpts"in e}const K=(e,t)=>ym(e,t,nr);function Cu(e,t,o){try{al(-1);const i=arguments.length;return i===2?It(t)&&!tt(t)?tr(t)?Re(e,null,[t]):Re(e,t):Re(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&tr(o)&&(o=[o]),Re(e,t,o))}finally{al(1)}}const $g="3.5.26";let Fc;const Cd=typeof window<"u"&&window.trustedTypes;if(Cd)try{Fc=Cd.createPolicy("vue",{createHTML:e=>e})}catch{}const op=Fc?e=>Fc.createHTML(e):e=>e,Ig="http://www.w3.org/2000/svg",Tg="http://www.w3.org/1998/Math/MathML",ms=typeof document<"u"?document:null,Ld=ms&&ms.createElement("template"),Mg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?ms.createElementNS(Ig,e):t==="mathml"?ms.createElementNS(Tg,e):o?ms.createElement(e,{is:o}):ms.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>ms.createTextNode(e),createComment:e=>ms.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ms.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const c=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{Ld.innerHTML=op(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=Ld.content;if(i==="svg"||i==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[c?c.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},Hs="transition",Aa="animation",or=Symbol("_vtc"),sp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Ag=tn({},xf,sp),Eg=e=>(e.displayName="Transition",e.props=Ag,e),Wr=Eg((e,{slots:t})=>Cu(Mm,Pg(e),t)),bi=(e,t=[])=>{tt(e)?e.forEach(o=>o(...t)):e&&e(...t)},Sd=e=>e?tt(e)?e.some(t=>t.length>1):e.length>1:!1;function Pg(e){const t={};for(const X in e)X in sp||(t[X]=e[X]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:c=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=a,appearActiveClass:p=c,appearToClass:f=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:_=`${o}-leave-active`,leaveToClass:b=`${o}-leave-to`}=e,x=Dg(s),$=x&&x[0],B=x&&x[1],{onBeforeEnter:P,onEnter:M,onEnterCancelled:S,onLeave:A,onLeaveCancelled:I,onBeforeAppear:T=P,onAppear:C=M,onAppearCancelled:V=S}=t,z=(X,ce,Te,Ae)=>{X._enterCancelled=Ae,wi(X,ce?f:u),wi(X,ce?p:c),Te&&Te()},ae=(X,ce)=>{X._isLeaving=!1,wi(X,g),wi(X,b),wi(X,_),ce&&ce()},j=X=>(ce,Te)=>{const Ae=X?C:M,Ce=()=>z(ce,X,Te);bi(Ae,[ce,Ce]),xd(()=>{wi(ce,X?d:a),ps(ce,X?f:u),Sd(Ae)||$d(ce,i,$,Ce)})};return tn(t,{onBeforeEnter(X){bi(P,[X]),ps(X,a),ps(X,c)},onBeforeAppear(X){bi(T,[X]),ps(X,d),ps(X,p)},onEnter:j(!1),onAppear:j(!0),onLeave(X,ce){X._isLeaving=!0;const Te=()=>ae(X,ce);ps(X,g),X._enterCancelled?(ps(X,_),Md(X)):(Md(X),ps(X,_)),xd(()=>{X._isLeaving&&(wi(X,g),ps(X,b),Sd(A)||$d(X,i,B,Te))}),bi(A,[X,Te])},onEnterCancelled(X){z(X,!1,void 0,!0),bi(S,[X])},onAppearCancelled(X){z(X,!0,void 0,!0),bi(V,[X])},onLeaveCancelled(X){ae(X),bi(I,[X])}})}function Dg(e){if(e==null)return null;if(It(e))return[pc(e.enter),pc(e.leave)];{const t=pc(e);return[t,t]}}function pc(e){return Rv(e)}function ps(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[or]||(e[or]=new Set)).add(t)}function wi(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[or];o&&(o.delete(t),o.size||(e[or]=void 0))}function xd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Og=0;function $d(e,t,o,i){const s=e._endId=++Og,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:c,timeout:u,propCount:d}=Rg(e,t);if(!c)return i();const p=c+"end";let f=0;const g=()=>{e.removeEventListener(p,_),a()},_=b=>{b.target===e&&++f>=d&&g()};setTimeout(()=>{f<d&&g()},u+1),e.addEventListener(p,_)}function Rg(e,t){const o=window.getComputedStyle(e),i=x=>(o[x]||"").split(", "),s=i(`${Hs}Delay`),a=i(`${Hs}Duration`),c=Id(s,a),u=i(`${Aa}Delay`),d=i(`${Aa}Duration`),p=Id(u,d);let f=null,g=0,_=0;t===Hs?c>0&&(f=Hs,g=c,_=a.length):t===Aa?p>0&&(f=Aa,g=p,_=d.length):(g=Math.max(c,p),f=g>0?c>p?Hs:Aa:null,_=f?f===Hs?a.length:d.length:0);const b=f===Hs&&/\b(?:transform|all)(?:,|$)/.test(i(`${Hs}Property`).toString());return{type:f,timeout:g,propCount:_,hasTransform:b}}function Id(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>Td(o)+Td(e[i])))}function Td(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Md(e){return(e?e.ownerDocument:document).body.offsetHeight}function Bg(e,t,o){const i=e[or];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const cl=Symbol("_vod"),ip=Symbol("_vsh"),ei={name:"show",beforeMount(e,{value:t},{transition:o}){e[cl]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):Ea(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),Ea(e,!0),i.enter(e)):i.leave(e,()=>{Ea(e,!1)}):Ea(e,t))},beforeUnmount(e,{value:t}){Ea(e,t)}};function Ea(e,t){e.style.display=t?e[cl]:"none",e[ip]=!t}const ap=Symbol("");function Ng(e){const t=Tl();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(a=>ul(a,s))},i=()=>{const s=e(t.proxy);t.ce?ul(t.ce,s):Uc(t.subTree,s),o(s)};Df(()=>{vf(i)}),Yt(()=>{je(i,To,{flush:"post"});const s=new MutationObserver(i);s.observe(t.subTree.el.parentNode,{childList:!0}),vo(()=>s.disconnect())})}function Uc(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{Uc(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)ul(e.el,t);else if(e.type===be)e.children.forEach(o=>Uc(o,t));else if(e.type===ja){let{el:o,anchor:i}=e;for(;o&&(ul(o,t),o!==i);)o=o.nextSibling}}function ul(e,t){if(e.nodeType===1){const o=e.style;let i="";for(const s in t){const a=Gv(t[s]);o.setProperty(`--${s}`,a),i+=`--${s}: ${a};`}o[ap]=i}}const Fg=/(?:^|;)\s*display\s*:/;function Ug(e,t,o){const i=e.style,s=Ht(o);let a=!1;if(o&&!s){if(t)if(Ht(t))for(const c of t.split(";")){const u=c.slice(0,c.indexOf(":")).trim();o[u]==null&&Kr(i,u,"")}else for(const c in t)o[c]==null&&Kr(i,c,"");for(const c in o)c==="display"&&(a=!0),Kr(i,c,o[c])}else if(s){if(t!==o){const c=i[ap];c&&(o+=";"+c),i.cssText=o,a=Fg.test(o)}}else t&&e.removeAttribute("style");cl in e&&(e[cl]=a?i.display:"",e[ip]&&(i.display="none"))}const Ad=/\s*!important$/;function Kr(e,t,o){if(tt(o))o.forEach(i=>Kr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=zg(e,t);Ad.test(o)?e.setProperty(ni(i),o.replace(Ad,""),"important"):e[i]=o}}const Ed=["Webkit","Moz","ms"],vc={};function zg(e,t){const o=vc[t];if(o)return o;let i=po(t);if(i!=="filter"&&i in e)return vc[t]=i;i=_l(i);for(let s=0;s<Ed.length;s++){const a=Ed[s]+i;if(a in e)return vc[t]=a}return t}const Pd="http://www.w3.org/1999/xlink";function Dd(e,t,o,i,s,a=Hv(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(Pd,t.slice(6,t.length)):e.setAttributeNS(Pd,t,o):o==null||a&&!Vh(o)?e.removeAttribute(t):e.setAttribute(t,a?"":Ao(o)?String(o):o)}function Od(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?op(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let c=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Vh(o):o==null&&u==="string"?(o="",c=!0):u==="number"&&(o=0,c=!0)}try{e[t]=o}catch{}c&&e.removeAttribute(s||t)}function bs(e,t,o,i){e.addEventListener(t,o,i)}function Hg(e,t,o,i){e.removeEventListener(t,o,i)}const Rd=Symbol("_vei");function Vg(e,t,o,i,s=null){const a=e[Rd]||(e[Rd]={}),c=a[t];if(i&&c)c.value=i;else{const[u,d]=Gg(t);if(i){const p=a[t]=qg(i,s);bs(e,u,p,d)}else c&&(Hg(e,u,c,d),a[t]=void 0)}}const Bd=/(?:Once|Passive|Capture)$/;function Gg(e){let t;if(Bd.test(e)){t={};let i;for(;i=e.match(Bd);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ni(e.slice(2)),t]}let mc=0;const Zg=Promise.resolve(),jg=()=>mc||(Zg.then(()=>mc=0),mc=Date.now());function qg(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;Po(Wg(i,o.value),t,5,[i])};return o.value=e,o.attached=jg(),o}function Wg(e,t){if(tt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Nd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Kg=(e,t,o,i,s,a)=>{const c=s==="svg";t==="class"?Bg(e,i,c):t==="style"?Ug(e,o,i):ml(t)?ru(t)||Vg(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Yg(e,t,i,c))?(Od(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Dd(e,t,i,c,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ht(i))?Od(e,po(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Dd(e,t,i,c))};function Yg(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Nd(t)&&ut(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Nd(t)&&Ht(o)?!1:t in e}const ti=e=>{const t=e.props["onUpdate:modelValue"]||!1;return tt(t)?o=>Gr(t,o):t};function Jg(e){e.target.composing=!0}function Fd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const fo=Symbol("_assign");function Ud(e,t,o){return t&&(e=e.trim()),o&&(e=kl(e)),e}const et={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[fo]=ti(s);const a=i||s.props&&s.props.type==="number";bs(e,t?"change":"input",c=>{c.target.composing||e[fo](Ud(e.value,o,a))}),(o||a)&&bs(e,"change",()=>{e.value=Ud(e.value,o,a)}),t||(bs(e,"compositionstart",Jg),bs(e,"compositionend",Fd),bs(e,"change",Fd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},c){if(e[fo]=ti(c),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?kl(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===d)||(e.value=d))}},ws={deep:!0,created(e,t,o){e[fo]=ti(o),bs(e,"change",()=>{const i=e._modelValue,s=ra(e),a=e.checked,c=e[fo];if(tt(i)){const u=cu(i,s),d=u!==-1;if(a&&!d)c(i.concat(s));else if(!a&&d){const p=[...i];p.splice(u,1),c(p)}}else if(da(i)){const u=new Set(i);a?u.add(s):u.delete(s),c(u)}else c(rp(e,a))})},mounted:zd,beforeUpdate(e,t,o){e[fo]=ti(o),zd(e,t,o)}};function zd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(tt(t))s=cu(t,i.props.value)>-1;else if(da(t))s=t.has(i.props.value);else{if(t===o)return;s=Ri(t,rp(e,!0))}e.checked!==s&&(e.checked=s)}const Hd={created(e,{value:t},o){e.checked=Ri(t,o.props.value),e[fo]=ti(o),bs(e,"change",()=>{e[fo](ra(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[fo]=ti(i),t!==o&&(e.checked=Ri(t,i.props.value))}},pn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=da(t);bs(e,"change",()=>{const a=Array.prototype.filter.call(e.options,c=>c.selected).map(c=>o?kl(ra(c)):ra(c));e[fo](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,os(()=>{e._assigning=!1})}),e[fo]=ti(i)},mounted(e,{value:t}){Vd(e,t)},beforeUpdate(e,t,o){e[fo]=ti(o)},updated(e,{value:t}){e._assigning||Vd(e,t)}};function Vd(e,t){const o=e.multiple,i=tt(t);if(!(o&&!i&&!da(t))){for(let s=0,a=e.options.length;s<a;s++){const c=e.options[s],u=ra(c);if(o)if(i){const d=typeof u;d==="string"||d==="number"?c.selected=t.some(p=>String(p)===String(u)):c.selected=cu(t,u)>-1}else c.selected=t.has(u);else if(Ri(ra(c),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function ra(e){return"_value"in e?e._value:e.value}function rp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Xg=["ctrl","shift","alt","meta"],Qg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Xg.some(o=>e[`${o}Key`]&&!t.includes(o))},ft=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let c=0;c<t.length;c++){const u=Qg[t[c]];if(u&&u(s,t))return}return e(s,...a)}))},ey={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},lp=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=ni(s.key);if(t.some(c=>c===a||ey[c]===a))return e(s)}))},ty=tn({patchProp:Kg},Mg);let Gd;function ny(){return Gd||(Gd=ug(ty))}const oy=((...e)=>{const t=ny().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=iy(i);if(!s)return;const a=t._component;!ut(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const c=o(s,!1,sy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),c},t});function sy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function iy(e){return Ht(e)?document.querySelector(e):e}let cp;const Al=e=>cp=e,up=Symbol();function zc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Wa;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Wa||(Wa={}));function ay(){const e=qh(!0),t=e.run(()=>E({}));let o=[],i=[];const s=mu({install(a){Al(s),s._a=a,a.provide(up,s),a.config.globalProperties.$pinia=s,i.forEach(c=>o.push(c)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const dp=()=>{};function Zd(e,t,o,i=dp){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&Wh()&&Zv(s),s}function Wi(e,...t){e.forEach(o=>{o(...t)})}const ry=e=>e(),jd=Symbol(),gc=Symbol();function Hc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];zc(s)&&zc(i)&&e.hasOwnProperty(o)&&!zt(i)&&!$s(i)?e[o]=Hc(s,i):e[o]=i}return e}const ly=Symbol();function cy(e){return!zc(e)||!Object.prototype.hasOwnProperty.call(e,ly)}const{assign:Gs}=Object;function uy(e){return!!(zt(e)&&e.effect)}function dy(e,t,o,i){const{state:s,actions:a,getters:c}=t,u=o.state.value[e];let d;function p(){u||(o.state.value[e]=s?s():{});const f=pm(o.state.value[e]);return Gs(f,a,Object.keys(c||{}).reduce((g,_)=>(g[_]=mu(K(()=>{Al(o);const b=o._s.get(e);return c[_].call(b,b)})),g),{}))}return d=hp(e,p,t,o,i,!0),d}function hp(e,t,o={},i,s,a){let c;const u=Gs({actions:{}},o),d={deep:!0};let p,f,g=new Set,_=new Set,b;const x=i.state.value[e];!a&&!x&&(i.state.value[e]={}),E({});let $;function B(V){let z;p=f=!1,typeof V=="function"?(V(i.state.value[e]),z={type:Wa.patchFunction,storeId:e,events:b}):(Hc(i.state.value[e],V),z={type:Wa.patchObject,payload:V,storeId:e,events:b});const ae=$=Symbol();os().then(()=>{$===ae&&(p=!0)}),f=!0,Wi(g,z,i.state.value[e])}const P=a?function(){const{state:z}=o,ae=z?z():{};this.$patch(j=>{Gs(j,ae)})}:dp;function M(){c.stop(),g.clear(),_.clear(),i._s.delete(e)}const S=(V,z="")=>{if(jd in V)return V[gc]=z,V;const ae=function(){Al(i);const j=Array.from(arguments),X=new Set,ce=new Set;function Te(pe){X.add(pe)}function Ae(pe){ce.add(pe)}Wi(_,{args:j,name:ae[gc],store:I,after:Te,onError:Ae});let Ce;try{Ce=V.apply(this&&this.$id===e?this:I,j)}catch(pe){throw Wi(ce,pe),pe}return Ce instanceof Promise?Ce.then(pe=>(Wi(X,pe),pe)).catch(pe=>(Wi(ce,pe),Promise.reject(pe))):(Wi(X,Ce),Ce)};return ae[jd]=!0,ae[gc]=z,ae},A={_p:i,$id:e,$onAction:Zd.bind(null,_),$patch:B,$reset:P,$subscribe(V,z={}){const ae=Zd(g,V,z.detached,()=>j()),j=c.run(()=>je(()=>i.state.value[e],X=>{(z.flush==="sync"?f:p)&&V({storeId:e,type:Wa.direct,events:b},X)},Gs({},d,z)));return ae},$dispose:M},I=cr(A);i._s.set(e,I);const C=(i._a&&i._a.runWithContext||ry)(()=>i._e.run(()=>(c=qh()).run(()=>t({action:S}))));for(const V in C){const z=C[V];if(zt(z)&&!uy(z)||$s(z))a||(x&&cy(z)&&(zt(z)?z.value=x[V]:Hc(z,x[V])),i.state.value[e][V]=z);else if(typeof z=="function"){const ae=S(z,V);C[V]=ae,u.actions[V]=z}}return Gs(I,C),Gs(bt(I),C),Object.defineProperty(I,"$state",{get:()=>i.state.value[e],set:V=>{B(z=>{Gs(z,V)})}}),i._p.forEach(V=>{Gs(I,c.run(()=>V({store:I,app:i._a,pinia:i,options:u})))}),x&&a&&o.hydrate&&o.hydrate(I.$state,x),p=!0,f=!0,I}function Lu(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(c,u){const d=Cm();return c=c||(d?ho(up,null):null),c&&Al(c),c=cp,c._s.has(e)||(s?hp(e,t,i,c):dy(e,i,c)),c._s.get(e)}return a.$id=e,a}const Ke=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},hy={};function fy(e,t){const o=yu("router-view");return v(),Xe(o)}const py=Ke(hy,[["render",fy]]);const Ji=typeof document<"u";function fp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function vy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&fp(e.default)}const Ct=Object.assign;function yc(e,t){const o={};for(const i in t){const s=t[i];o[i]=Do(s)?s.map(e):e(s)}return o}const Ka=()=>{},Do=Array.isArray;function qd(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const pp=/#/g,my=/&/g,gy=/\//g,yy=/=/g,_y=/\?/g,vp=/\+/g,ky=/%5B/g,by=/%5D/g,mp=/%5E/g,wy=/%60/g,gp=/%7B/g,Cy=/%7C/g,yp=/%7D/g,Ly=/%20/g;function Su(e){return e==null?"":encodeURI(""+e).replace(Cy,"|").replace(ky,"[").replace(by,"]")}function Sy(e){return Su(e).replace(gp,"{").replace(yp,"}").replace(mp,"^")}function Vc(e){return Su(e).replace(vp,"%2B").replace(Ly,"+").replace(pp,"%23").replace(my,"%26").replace(wy,"`").replace(gp,"{").replace(yp,"}").replace(mp,"^")}function xy(e){return Vc(e).replace(yy,"%3D")}function $y(e){return Su(e).replace(pp,"%23").replace(_y,"%3F")}function Iy(e){return $y(e).replace(gy,"%2F")}function sr(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ty=/\/$/,My=e=>e.replace(Ty,"");function _c(e,t,o="/"){let i,s={},a="",c="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(i=t.slice(0,d),a=t.slice(d,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),c=t.slice(u,t.length)),i=Dy(i??t,o),{fullPath:i+a+c,path:i,query:s,hash:sr(c)}}function Ay(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function Wd(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ey(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&la(t.matched[i],o.matched[s])&&_p(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function la(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function _p(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Py(e[o],t[o]))return!1;return!0}function Py(e,t){return Do(e)?Kd(e,t):Do(t)?Kd(t,e):e?.valueOf()===t?.valueOf()}function Kd(e,t){return Do(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function Dy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,c,u;for(c=0;c<i.length;c++)if(u=i[c],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(c).join("/")}const Vs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Gc=(function(e){return e.pop="pop",e.push="push",e})({}),kc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Oy(e){if(!e)if(Ji){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),My(e)}const Ry=/^[^#]+#/;function By(e,t){return e.replace(Ry,"#")+t}function Ny(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const El=()=>({left:window.scrollX,top:window.scrollY});function Fy(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=Ny(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Yd(e,t){return(history.state?history.state.position-t:-1)+e}const Zc=new Map;function Uy(e,t){Zc.set(e,t)}function zy(e){const t=Zc.get(e);return Zc.delete(e),t}function Hy(e){return typeof e=="string"||e&&typeof e=="object"}function kp(e){return typeof e=="string"||typeof e=="symbol"}let Ut=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const bp=Symbol("");Ut.MATCHER_NOT_FOUND+"",Ut.NAVIGATION_GUARD_REDIRECT+"",Ut.NAVIGATION_ABORTED+"",Ut.NAVIGATION_CANCELLED+"",Ut.NAVIGATION_DUPLICATED+"";function ca(e,t){return Ct(new Error,{type:e,[bp]:!0},t)}function vs(e,t){return e instanceof Error&&bp in e&&(t==null||!!(e.type&t))}const Vy=["params","query","hash"];function Gy(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of Vy)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function Zy(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(vp," "),a=s.indexOf("="),c=sr(a<0?s:s.slice(0,a)),u=a<0?null:sr(s.slice(a+1));if(c in t){let d=t[c];Do(d)||(d=t[c]=[d]),d.push(u)}else t[c]=u}return t}function Jd(e){let t="";for(let o in e){const i=e[o];if(o=xy(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(Do(i)?i.map(s=>s&&Vc(s)):[i&&Vc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function jy(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=Do(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const qy=Symbol(""),Xd=Symbol(""),Pl=Symbol(""),xu=Symbol(""),jc=Symbol("");function Pa(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Ws(e,t,o,i,s,a=c=>c()){const c=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const p=_=>{_===!1?d(ca(Ut.NAVIGATION_ABORTED,{from:o,to:t})):_ instanceof Error?d(_):Hy(_)?d(ca(Ut.NAVIGATION_GUARD_REDIRECT,{from:t,to:_})):(c&&i.enterCallbacks[s]===c&&typeof _=="function"&&c.push(_),u())},f=a(()=>e.call(i&&i.instances[s],t,o,p));let g=Promise.resolve(f);e.length<3&&(g=g.then(p)),g.catch(_=>d(_))})}function bc(e,t,o,i,s=a=>a()){const a=[];for(const c of e)for(const u in c.components){let d=c.components[u];if(!(t!=="beforeRouteEnter"&&!c.instances[u]))if(fp(d)){const p=(d.__vccOpts||d)[t];p&&a.push(Ws(p,o,i,c,u,s))}else{let p=d();a.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${c.path}"`);const g=vy(f)?f.default:f;c.mods[u]=f,c.components[u]=g;const _=(g.__vccOpts||g)[t];return _&&Ws(_,o,i,c,u,s)()}))}}return a}function Wy(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let c=0;c<a;c++){const u=t.matched[c];u&&(e.matched.find(p=>la(p,u))?i.push(u):o.push(u));const d=e.matched[c];d&&(t.matched.find(p=>la(p,d))||s.push(d))}return[o,i,s]}let Ky=()=>location.protocol+"//"+location.host;function wp(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let c=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(c);return u[0]!=="/"&&(u="/"+u),Wd(u,"")}return Wd(o,e)+i+s}function Yy(e,t,o,i){let s=[],a=[],c=null;const u=({state:_})=>{const b=wp(e,location),x=o.value,$=t.value;let B=0;if(_){if(o.value=b,t.value=_,c&&c===x){c=null;return}B=$?_.position-$.position:0}else i(b);s.forEach(P=>{P(o.value,x,{delta:B,type:Gc.pop,direction:B?B>0?kc.forward:kc.back:kc.unknown})})};function d(){c=o.value}function p(_){s.push(_);const b=()=>{const x=s.indexOf(_);x>-1&&s.splice(x,1)};return a.push(b),b}function f(){if(document.visibilityState==="hidden"){const{history:_}=window;if(!_.state)return;_.replaceState(Ct({},_.state,{scroll:El()}),"")}}function g(){for(const _ of a)_();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:p,destroy:g}}function Qd(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?El():null}}function Jy(e){const{history:t,location:o}=window,i={value:wp(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(d,p,f){const g=e.indexOf("#"),_=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:Ky()+e+d;try{t[f?"replaceState":"pushState"](p,"",_),s.value=p}catch(b){console.error(b),o[f?"replace":"assign"](_)}}function c(d,p){a(d,Ct({},t.state,Qd(s.value.back,d,s.value.forward,!0),p,{position:s.value.position}),!0),i.value=d}function u(d,p){const f=Ct({},s.value,t.state,{forward:d,scroll:El()});a(f.current,f,!0),a(d,Ct({},Qd(i.value,d,null),{position:f.position+1},p),!1),i.value=d}return{location:i,state:s,push:u,replace:c}}function Xy(e){e=Oy(e);const t=Jy(e),o=Yy(e,t.state,t.location,t.replace);function i(a,c=!0){c||o.pauseListeners(),history.go(a)}const s=Ct({location:"",base:e,go:i,createHref:By.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Qy(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Xy(e)}let Ti=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Kt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Kt||{});const e_={type:Ti.Static,value:""},t_=/[a-zA-Z0-9_]/;function n_(e){if(!e)return[[]];if(e==="/")return[[e_]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${o})/"${p}": ${b}`)}let o=Kt.Static,i=o;const s=[];let a;function c(){a&&s.push(a),a=[]}let u=0,d,p="",f="";function g(){p&&(o===Kt.Static?a.push({type:Ti.Static,value:p}):o===Kt.Param||o===Kt.ParamRegExp||o===Kt.ParamRegExpEnd?(a.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Ti.Param,value:p,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function _(){p+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==Kt.ParamRegExp){i=o,o=Kt.EscapeNext;continue}switch(o){case Kt.Static:d==="/"?(p&&g(),c()):d===":"?(g(),o=Kt.Param):_();break;case Kt.EscapeNext:_(),o=i;break;case Kt.Param:d==="("?o=Kt.ParamRegExp:t_.test(d)?_():(g(),o=Kt.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case Kt.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:o=Kt.ParamRegExpEnd:f+=d;break;case Kt.ParamRegExpEnd:g(),o=Kt.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===Kt.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),g(),c(),s}const eh="[^/]+?",o_={sensitive:!1,strict:!1,start:!0,end:!0};var xn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(xn||{});const s_=/[.+*?^${}()[\]/\\]/g;function i_(e,t){const o=Ct({},o_,t),i=[];let s=o.start?"^":"";const a=[];for(const p of e){const f=p.length?[]:[xn.Root];o.strict&&!p.length&&(s+="/");for(let g=0;g<p.length;g++){const _=p[g];let b=xn.Segment+(o.sensitive?xn.BonusCaseSensitive:0);if(_.type===Ti.Static)g||(s+="/"),s+=_.value.replace(s_,"\\$&"),b+=xn.Static;else if(_.type===Ti.Param){const{value:x,repeatable:$,optional:B,regexp:P}=_;a.push({name:x,repeatable:$,optional:B});const M=P||eh;if(M!==eh){b+=xn.BonusCustomRegExp;try{`${M}`}catch(A){throw new Error(`Invalid custom RegExp for param "${x}" (${M}): `+A.message)}}let S=$?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;g||(S=B&&p.length<2?`(?:/${S})`:"/"+S),B&&(S+="?"),s+=S,b+=xn.Dynamic,B&&(b+=xn.BonusOptional),$&&(b+=xn.BonusRepeatable),M===".*"&&(b+=xn.BonusWildcard)}f.push(b)}i.push(f)}if(o.strict&&o.end){const p=i.length-1;i[p][i[p].length-1]+=xn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const c=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(c),g={};if(!f)return null;for(let _=1;_<f.length;_++){const b=f[_]||"",x=a[_-1];g[x.name]=b&&x.repeatable?b.split("/"):b}return g}function d(p){let f="",g=!1;for(const _ of e){(!g||!f.endsWith("/"))&&(f+="/"),g=!1;for(const b of _)if(b.type===Ti.Static)f+=b.value;else if(b.type===Ti.Param){const{value:x,repeatable:$,optional:B}=b,P=x in p?p[x]:"";if(Do(P)&&!$)throw new Error(`Provided param "${x}" is an array but it is not repeatable (* or + modifiers)`);const M=Do(P)?P.join("/"):P;if(!M)if(B)_.length<2&&(f.endsWith("/")?f=f.slice(0,-1):g=!0);else throw new Error(`Missing required param "${x}"`);f+=M}}return f||"/"}return{re:c,score:i,keys:a,parse:u,stringify:d}}function a_(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===xn.Static+xn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===xn.Static+xn.Segment?1:-1:0}function Cp(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=a_(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(th(i))return 1;if(th(s))return-1}return s.length-i.length}function th(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const r_={strict:!1,end:!0,sensitive:!1};function l_(e,t,o){const i=i_(n_(e.path),o),s=Ct(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function c_(e,t){const o=[],i=new Map;t=qd(r_,t);function s(g){return i.get(g)}function a(g,_,b){const x=!b,$=oh(g);$.aliasOf=b&&b.record;const B=qd(t,g),P=[$];if("alias"in g){const A=typeof g.alias=="string"?[g.alias]:g.alias;for(const I of A)P.push(oh(Ct({},$,{components:b?b.record.components:$.components,path:I,aliasOf:b?b.record:$})))}let M,S;for(const A of P){const{path:I}=A;if(_&&I[0]!=="/"){const T=_.record.path,C=T[T.length-1]==="/"?"":"/";A.path=_.record.path+(I&&C+I)}if(M=l_(A,_,B),b?b.alias.push(M):(S=S||M,S!==M&&S.alias.push(M),x&&g.name&&!sh(M)&&c(g.name)),Lp(M)&&d(M),$.children){const T=$.children;for(let C=0;C<T.length;C++)a(T[C],M,b&&b.children[C])}b=b||M}return S?()=>{c(S)}:Ka}function c(g){if(kp(g)){const _=i.get(g);_&&(i.delete(g),o.splice(o.indexOf(_),1),_.children.forEach(c),_.alias.forEach(c))}else{const _=o.indexOf(g);_>-1&&(o.splice(_,1),g.record.name&&i.delete(g.record.name),g.children.forEach(c),g.alias.forEach(c))}}function u(){return o}function d(g){const _=h_(g,o);o.splice(_,0,g),g.record.name&&!sh(g)&&i.set(g.record.name,g)}function p(g,_){let b,x={},$,B;if("name"in g&&g.name){if(b=i.get(g.name),!b)throw ca(Ut.MATCHER_NOT_FOUND,{location:g});B=b.record.name,x=Ct(nh(_.params,b.keys.filter(S=>!S.optional).concat(b.parent?b.parent.keys.filter(S=>S.optional):[]).map(S=>S.name)),g.params&&nh(g.params,b.keys.map(S=>S.name))),$=b.stringify(x)}else if(g.path!=null)$=g.path,b=o.find(S=>S.re.test($)),b&&(x=b.parse($),B=b.record.name);else{if(b=_.name?i.get(_.name):o.find(S=>S.re.test(_.path)),!b)throw ca(Ut.MATCHER_NOT_FOUND,{location:g,currentLocation:_});B=b.record.name,x=Ct({},_.params,g.params),$=b.stringify(x)}const P=[];let M=b;for(;M;)P.unshift(M.record),M=M.parent;return{name:B,path:$,params:x,matched:P,meta:d_(P)}}e.forEach(g=>a(g));function f(){o.length=0,i.clear()}return{addRoute:a,resolve:p,removeRoute:c,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function nh(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function oh(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:u_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function u_(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function sh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function d_(e){return e.reduce((t,o)=>Ct(t,o.meta),{})}function h_(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;Cp(e,t[a])<0?i=a:o=a+1}const s=f_(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function f_(e){let t=e;for(;t=t.parent;)if(Lp(t)&&Cp(e,t)===0)return t}function Lp({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function ih(e){const t=ho(Pl),o=ho(xu),i=K(()=>{const d=G(e.to);return t.resolve(d)}),s=K(()=>{const{matched:d}=i.value,{length:p}=d,f=d[p-1],g=o.matched;if(!f||!g.length)return-1;const _=g.findIndex(la.bind(null,f));if(_>-1)return _;const b=ah(d[p-2]);return p>1&&ah(f)===b&&g[g.length-1].path!==b?g.findIndex(la.bind(null,d[p-2])):_}),a=K(()=>s.value>-1&&y_(o.params,i.value.params)),c=K(()=>s.value>-1&&s.value===o.matched.length-1&&_p(o.params,i.value.params));function u(d={}){if(g_(d)){const p=t[G(e.replace)?"replace":"push"](G(e.to)).catch(Ka);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:K(()=>i.value.href),isActive:a,isExactActive:c,navigate:u}}function p_(e){return e.length===1?e[0]:e}const v_=Af({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ih,setup(e,{slots:t}){const o=cr(ih(e)),{options:i}=ho(Pl),s=K(()=>({[rh(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[rh(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&p_(t.default(o));return e.custom?a:Cu("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),m_=v_;function g_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function y_(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!Do(s)||s.length!==i.length||i.some((a,c)=>a.valueOf()!==s[c].valueOf()))return!1}return!0}function ah(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const rh=(e,t,o)=>e??t??o,__=Af({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=ho(jc),s=K(()=>e.route||i.value),a=ho(Xd,0),c=K(()=>{let p=G(a);const{matched:f}=s.value;let g;for(;(g=f[p])&&!g.components;)p++;return p}),u=K(()=>s.value.matched[c.value]);Zr(Xd,K(()=>c.value+1)),Zr(qy,u),Zr(jc,s);const d=E();return je(()=>[d.value,u.value,e.name],([p,f,g],[_,b,x])=>{f&&(f.instances[g]=p,b&&b!==f&&p&&p===_&&(f.leaveGuards.size||(f.leaveGuards=b.leaveGuards),f.updateGuards.size||(f.updateGuards=b.updateGuards))),p&&f&&(!b||!la(f,b)||!_)&&(f.enterCallbacks[g]||[]).forEach($=>$(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,g=u.value,_=g&&g.components[f];if(!_)return lh(o.default,{Component:_,route:p});const b=g.props[f],x=b?b===!0?p.params:typeof b=="function"?b(p):b:null,B=Cu(_,Ct({},x,t,{onVnodeUnmounted:P=>{P.component.isUnmounted&&(g.instances[f]=null)},ref:d}));return lh(o.default,{Component:B,route:p})||B}}});function lh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const k_=__;function b_(e){const t=c_(e.routes,e),o=e.parseQuery||Zy,i=e.stringifyQuery||Jd,s=e.history,a=Pa(),c=Pa(),u=Pa(),d=dm(Vs);let p=Vs;Ji&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=yc.bind(null,de=>""+de),g=yc.bind(null,Iy),_=yc.bind(null,sr);function b(de,ke){let H,Q;return kp(de)?(H=t.getRecordMatcher(de),Q=ke):Q=de,t.addRoute(Q,H)}function x(de){const ke=t.getRecordMatcher(de);ke&&t.removeRoute(ke)}function $(){return t.getRoutes().map(de=>de.record)}function B(de){return!!t.getRecordMatcher(de)}function P(de,ke){if(ke=Ct({},ke||d.value),typeof de=="string"){const oe=_c(o,de,ke.path),Y=t.resolve({path:oe.path},ke),F=s.createHref(oe.fullPath);return Ct(oe,Y,{params:_(Y.params),hash:sr(oe.hash),redirectedFrom:void 0,href:F})}let H;if(de.path!=null)H=Ct({},de,{path:_c(o,de.path,ke.path).path});else{const oe=Ct({},de.params);for(const Y in oe)oe[Y]==null&&delete oe[Y];H=Ct({},de,{params:g(oe)}),ke.params=g(ke.params)}const Q=t.resolve(H,ke),ie=de.hash||"";Q.params=f(_(Q.params));const R=Ay(i,Ct({},de,{hash:Sy(ie),path:Q.path})),W=s.createHref(R);return Ct({fullPath:R,hash:ie,query:i===Jd?jy(de.query):de.query||{}},Q,{redirectedFrom:void 0,href:W})}function M(de){return typeof de=="string"?_c(o,de,d.value.path):Ct({},de)}function S(de,ke){if(p!==de)return ca(Ut.NAVIGATION_CANCELLED,{from:ke,to:de})}function A(de){return C(de)}function I(de){return A(Ct(M(de),{replace:!0}))}function T(de,ke){const H=de.matched[de.matched.length-1];if(H&&H.redirect){const{redirect:Q}=H;let ie=typeof Q=="function"?Q(de,ke):Q;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=M(ie):{path:ie},ie.params={}),Ct({query:de.query,hash:de.hash,params:ie.path!=null?{}:de.params},ie)}}function C(de,ke){const H=p=P(de),Q=d.value,ie=de.state,R=de.force,W=de.replace===!0,oe=T(H,Q);if(oe)return C(Ct(M(oe),{state:typeof oe=="object"?Ct({},ie,oe.state):ie,force:R,replace:W}),ke||H);const Y=H;Y.redirectedFrom=ke;let F;return!R&&Ey(i,Q,H)&&(F=ca(Ut.NAVIGATION_DUPLICATED,{to:Y,from:Q}),Be(Q,Q,!0,!1)),(F?Promise.resolve(F):ae(Y,Q)).catch(N=>vs(N)?vs(N,Ut.NAVIGATION_GUARD_REDIRECT)?N:Le(N):me(N,Y,Q)).then(N=>{if(N){if(vs(N,Ut.NAVIGATION_GUARD_REDIRECT))return C(Ct({replace:W},M(N.to),{state:typeof N.to=="object"?Ct({},ie,N.to.state):ie,force:R}),ke||Y)}else N=X(Y,Q,!0,W,ie);return j(Y,Q,N),N})}function V(de,ke){const H=S(de,ke);return H?Promise.reject(H):Promise.resolve()}function z(de){const ke=Pe.values().next().value;return ke&&typeof ke.runWithContext=="function"?ke.runWithContext(de):de()}function ae(de,ke){let H;const[Q,ie,R]=Wy(de,ke);H=bc(Q.reverse(),"beforeRouteLeave",de,ke);for(const oe of Q)oe.leaveGuards.forEach(Y=>{H.push(Ws(Y,de,ke))});const W=V.bind(null,de,ke);return H.push(W),Me(H).then(()=>{H=[];for(const oe of a.list())H.push(Ws(oe,de,ke));return H.push(W),Me(H)}).then(()=>{H=bc(ie,"beforeRouteUpdate",de,ke);for(const oe of ie)oe.updateGuards.forEach(Y=>{H.push(Ws(Y,de,ke))});return H.push(W),Me(H)}).then(()=>{H=[];for(const oe of R)if(oe.beforeEnter)if(Do(oe.beforeEnter))for(const Y of oe.beforeEnter)H.push(Ws(Y,de,ke));else H.push(Ws(oe.beforeEnter,de,ke));return H.push(W),Me(H)}).then(()=>(de.matched.forEach(oe=>oe.enterCallbacks={}),H=bc(R,"beforeRouteEnter",de,ke,z),H.push(W),Me(H))).then(()=>{H=[];for(const oe of c.list())H.push(Ws(oe,de,ke));return H.push(W),Me(H)}).catch(oe=>vs(oe,Ut.NAVIGATION_CANCELLED)?oe:Promise.reject(oe))}function j(de,ke,H){u.list().forEach(Q=>z(()=>Q(de,ke,H)))}function X(de,ke,H,Q,ie){const R=S(de,ke);if(R)return R;const W=ke===Vs,oe=Ji?history.state:{};H&&(Q||W?s.replace(de.fullPath,Ct({scroll:W&&oe&&oe.scroll},ie)):s.push(de.fullPath,ie)),d.value=de,Be(de,ke,H,W),Le()}let ce;function Te(){ce||(ce=s.listen((de,ke,H)=>{if(!Ee.listening)return;const Q=P(de),ie=T(Q,Ee.currentRoute.value);if(ie){C(Ct(ie,{replace:!0,force:!0}),Q).catch(Ka);return}p=Q;const R=d.value;Ji&&Uy(Yd(R.fullPath,H.delta),El()),ae(Q,R).catch(W=>vs(W,Ut.NAVIGATION_ABORTED|Ut.NAVIGATION_CANCELLED)?W:vs(W,Ut.NAVIGATION_GUARD_REDIRECT)?(C(Ct(M(W.to),{force:!0}),Q).then(oe=>{vs(oe,Ut.NAVIGATION_ABORTED|Ut.NAVIGATION_DUPLICATED)&&!H.delta&&H.type===Gc.pop&&s.go(-1,!1)}).catch(Ka),Promise.reject()):(H.delta&&s.go(-H.delta,!1),me(W,Q,R))).then(W=>{W=W||X(Q,R,!1),W&&(H.delta&&!vs(W,Ut.NAVIGATION_CANCELLED)?s.go(-H.delta,!1):H.type===Gc.pop&&vs(W,Ut.NAVIGATION_ABORTED|Ut.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),j(Q,R,W)}).catch(Ka)}))}let Ae=Pa(),Ce=Pa(),pe;function me(de,ke,H){Le(de);const Q=Ce.list();return Q.length?Q.forEach(ie=>ie(de,ke,H)):console.error(de),Promise.reject(de)}function nt(){return pe&&d.value!==Vs?Promise.resolve():new Promise((de,ke)=>{Ae.add([de,ke])})}function Le(de){return pe||(pe=!de,Te(),Ae.list().forEach(([ke,H])=>de?H(de):ke()),Ae.reset()),de}function Be(de,ke,H,Q){const{scrollBehavior:ie}=e;if(!Ji||!ie)return Promise.resolve();const R=!H&&zy(Yd(de.fullPath,0))||(Q||!H)&&history.state&&history.state.scroll||null;return os().then(()=>ie(de,ke,R)).then(W=>W&&Fy(W)).catch(W=>me(W,de,ke))}const Ge=de=>s.go(de);let ue;const Pe=new Set,Ee={currentRoute:d,listening:!0,addRoute:b,removeRoute:x,clearRoutes:t.clearRoutes,hasRoute:B,getRoutes:$,resolve:P,options:e,push:A,replace:I,go:Ge,back:()=>Ge(-1),forward:()=>Ge(1),beforeEach:a.add,beforeResolve:c.add,afterEach:u.add,onError:Ce.add,isReady:nt,install(de){de.component("RouterLink",m_),de.component("RouterView",k_),de.config.globalProperties.$router=Ee,Object.defineProperty(de.config.globalProperties,"$route",{enumerable:!0,get:()=>G(d)}),Ji&&!ue&&d.value===Vs&&(ue=!0,A(s.location).catch(Q=>{}));const ke={};for(const Q in Vs)Object.defineProperty(ke,Q,{get:()=>d.value[Q],enumerable:!0});de.provide(Pl,Ee),de.provide(xu,uf(ke)),de.provide(jc,d);const H=de.unmount;Pe.add(de),de.unmount=function(){Pe.delete(de),Pe.size<1&&(p=Vs,ce&&ce(),ce=null,d.value=Vs,ue=!1,pe=!1),H()}}};function Me(de){return de.reduce((ke,H)=>ke.then(()=>z(H)),Promise.resolve())}return Ee}function ha(){return ho(Pl)}function Dl(e){return ho(xu)}const w_={class:"hero-animation-container"},C_={__name:"HeroMapAnimation",setup(e){const t=E(!1);return Yt(()=>{requestAnimationFrame(()=>{t.value=!0})}),(o,i)=>(v(),y("div",w_,[(v(),y("svg",{viewBox:"0 0 400 350",class:fe(["hero-map-svg",{animate:t.value}])},[...i[0]||(i[0]=[rl(`<defs data-v-1b7f6f65><clipPath id="mapClip" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" data-v-1b7f6f65></polygon></clipPath></defs><g class="map-group" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-1b7f6f65></polygon><g clip-path="url(#mapClip)" class="contours" data-v-1b7f6f65><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-1b7f6f65><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-1b7f6f65></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-1b7f6f65></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-1b7f6f65></path><g class="trail-segments" data-v-1b7f6f65><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-1b7f6f65><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-1b7f6f65><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-1b7f6f65><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-1b7f6f65><circle cx="0" cy="-28" r="12" fill="#444" data-v-1b7f6f65></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-1b7f6f65><circle cx="0" cy="-18" r="8" fill="#444" data-v-1b7f6f65></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-1b7f6f65><circle cx="0" cy="-12" r="6" fill="#444" data-v-1b7f6f65></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-1b7f6f65></path></g><g clip-path="url(#mapClip)" class="trees" data-v-1b7f6f65><g transform="translate(45, 280)" data-v-1b7f6f65><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(75, 255)" data-v-1b7f6f65><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(350, 230)" data-v-1b7f6f65><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(60, 140)" data-v-1b7f6f65><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 70)" data-v-1b7f6f65><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 140)" data-v-1b7f6f65><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-1b7f6f65></rect></g></g></g>`,2)])],2))]))}},L_=Ke(C_,[["__scopeId","data-v-1b7f6f65"]]);function Sp(e,t){return function(){return e.apply(t,arguments)}}const{toString:S_}=Object.prototype,{getPrototypeOf:$u}=Object,{iterator:Ol,toStringTag:xp}=Symbol,Rl=(e=>t=>{const o=S_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Oo=e=>(e=e.toLowerCase(),t=>Rl(t)===e),Bl=e=>t=>typeof t===e,{isArray:fa}=Array,ua=Bl("undefined");function hr(e){return e!==null&&!ua(e)&&e.constructor!==null&&!ua(e.constructor)&&Un(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const $p=Oo("ArrayBuffer");function x_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&$p(e.buffer),t}const $_=Bl("string"),Un=Bl("function"),Ip=Bl("number"),fr=e=>e!==null&&typeof e=="object",I_=e=>e===!0||e===!1,Yr=e=>{if(Rl(e)!=="object")return!1;const t=$u(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(xp in e)&&!(Ol in e)},T_=e=>{if(!fr(e)||hr(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},M_=Oo("Date"),A_=Oo("File"),E_=Oo("Blob"),P_=Oo("FileList"),D_=e=>fr(e)&&Un(e.pipe),O_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Un(e.append)&&((t=Rl(e))==="formdata"||t==="object"&&Un(e.toString)&&e.toString()==="[object FormData]"))},R_=Oo("URLSearchParams"),[B_,N_,F_,U_]=["ReadableStream","Request","Response","Headers"].map(Oo),z_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pr(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),fa(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(hr(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),c=a.length;let u;for(i=0;i<c;i++)u=a[i],t.call(null,e[u],u,e)}}function Tp(e,t){if(hr(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Mi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Mp=e=>!ua(e)&&e!==Mi;function qc(){const{caseless:e,skipUndefined:t}=Mp(this)&&this||{},o={},i=(s,a)=>{const c=e&&Tp(o,a)||a;Yr(o[c])&&Yr(s)?o[c]=qc(o[c],s):Yr(s)?o[c]=qc({},s):fa(s)?o[c]=s.slice():(!t||!ua(s))&&(o[c]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&pr(arguments[s],i);return o}const H_=(e,t,o,{allOwnKeys:i}={})=>(pr(t,(s,a)=>{o&&Un(s)?e[a]=Sp(s,o):e[a]=s},{allOwnKeys:i}),e),V_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),G_=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Z_=(e,t,o,i)=>{let s,a,c;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)c=s[a],(!i||i(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=o!==!1&&$u(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},j_=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},q_=e=>{if(!e)return null;if(fa(e))return e;let t=e.length;if(!Ip(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},W_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&$u(Uint8Array)),K_=(e,t)=>{const i=(e&&e[Ol]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},Y_=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},J_=Oo("HTMLFormElement"),X_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),ch=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Q_=Oo("RegExp"),Ap=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};pr(o,(s,a)=>{let c;(c=t(s,a,e))!==!1&&(i[a]=c||s)}),Object.defineProperties(e,i)},e1=e=>{Ap(e,(t,o)=>{if(Un(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(Un(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},t1=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return fa(e)?i(e):i(String(e).split(t)),o},n1=()=>{},o1=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function s1(e){return!!(e&&Un(e.append)&&e[xp]==="FormData"&&e[Ol])}const i1=e=>{const t=new Array(10),o=(i,s)=>{if(fr(i)){if(t.indexOf(i)>=0)return;if(hr(i))return i;if(!("toJSON"in i)){t[s]=i;const a=fa(i)?[]:{};return pr(i,(c,u)=>{const d=o(c,s+1);!ua(d)&&(a[u]=d)}),t[s]=void 0,a}}return i};return o(e,0)},a1=Oo("AsyncFunction"),r1=e=>e&&(fr(e)||Un(e))&&Un(e.then)&&Un(e.catch),Ep=((e,t)=>e?setImmediate:t?((o,i)=>(Mi.addEventListener("message",({source:s,data:a})=>{s===Mi&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Mi.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",Un(Mi.postMessage)),l1=typeof queueMicrotask<"u"?queueMicrotask.bind(Mi):typeof process<"u"&&process.nextTick||Ep,c1=e=>e!=null&&Un(e[Ol]),_e={isArray:fa,isArrayBuffer:$p,isBuffer:hr,isFormData:O_,isArrayBufferView:x_,isString:$_,isNumber:Ip,isBoolean:I_,isObject:fr,isPlainObject:Yr,isEmptyObject:T_,isReadableStream:B_,isRequest:N_,isResponse:F_,isHeaders:U_,isUndefined:ua,isDate:M_,isFile:A_,isBlob:E_,isRegExp:Q_,isFunction:Un,isStream:D_,isURLSearchParams:R_,isTypedArray:W_,isFileList:P_,forEach:pr,merge:qc,extend:H_,trim:z_,stripBOM:V_,inherits:G_,toFlatObject:Z_,kindOf:Rl,kindOfTest:Oo,endsWith:j_,toArray:q_,forEachEntry:K_,matchAll:Y_,isHTMLForm:J_,hasOwnProperty:ch,hasOwnProp:ch,reduceDescriptors:Ap,freezeMethods:e1,toObjectSet:t1,toCamelCase:X_,noop:n1,toFiniteNumber:o1,findKey:Tp,global:Mi,isContextDefined:Mp,isSpecCompliantForm:s1,toJSONObject:i1,isAsyncFn:a1,isThenable:r1,setImmediate:Ep,asap:l1,isIterable:c1};function ht(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}_e.inherits(ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_e.toJSONObject(this.config),code:this.code,status:this.status}}});const Pp=ht.prototype,Dp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Dp[e]={value:e}});Object.defineProperties(ht,Dp);Object.defineProperty(Pp,"isAxiosError",{value:!0});ht.from=(e,t,o,i,s,a)=>{const c=Object.create(Pp);_e.toFlatObject(e,c,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return ht.call(c,u,d,o,i,s),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",a&&Object.assign(c,a),c};const u1=null;function Wc(e){return _e.isPlainObject(e)||_e.isArray(e)}function Op(e){return _e.endsWith(e,"[]")?e.slice(0,-2):e}function uh(e,t,o){return e?e.concat(t).map(function(s,a){return s=Op(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function d1(e){return _e.isArray(e)&&!e.some(Wc)}const h1=_e.toFlatObject(_e,{},null,function(t){return/^is[A-Z]/.test(t)});function Nl(e,t,o){if(!_e.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=_e.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function($,B){return!_e.isUndefined(B[$])});const i=o.metaTokens,s=o.visitor||f,a=o.dots,c=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&_e.isSpecCompliantForm(t);if(!_e.isFunction(s))throw new TypeError("visitor must be a function");function p(x){if(x===null)return"";if(_e.isDate(x))return x.toISOString();if(_e.isBoolean(x))return x.toString();if(!d&&_e.isBlob(x))throw new ht("Blob is not supported. Use a Buffer instead.");return _e.isArrayBuffer(x)||_e.isTypedArray(x)?d&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function f(x,$,B){let P=x;if(x&&!B&&typeof x=="object"){if(_e.endsWith($,"{}"))$=i?$:$.slice(0,-2),x=JSON.stringify(x);else if(_e.isArray(x)&&d1(x)||(_e.isFileList(x)||_e.endsWith($,"[]"))&&(P=_e.toArray(x)))return $=Op($),P.forEach(function(S,A){!(_e.isUndefined(S)||S===null)&&t.append(c===!0?uh([$],A,a):c===null?$:$+"[]",p(S))}),!1}return Wc(x)?!0:(t.append(uh(B,$,a),p(x)),!1)}const g=[],_=Object.assign(h1,{defaultVisitor:f,convertValue:p,isVisitable:Wc});function b(x,$){if(!_e.isUndefined(x)){if(g.indexOf(x)!==-1)throw Error("Circular reference detected in "+$.join("."));g.push(x),_e.forEach(x,function(P,M){(!(_e.isUndefined(P)||P===null)&&s.call(t,P,_e.isString(M)?M.trim():M,$,_))===!0&&b(P,$?$.concat(M):[M])}),g.pop()}}if(!_e.isObject(e))throw new TypeError("data must be an object");return b(e),t}function dh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Iu(e,t){this._pairs=[],e&&Nl(e,this,t)}const Rp=Iu.prototype;Rp.append=function(t,o){this._pairs.push([t,o])};Rp.toString=function(t){const o=t?function(i){return t.call(this,i,dh)}:dh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function f1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Bp(e,t,o){if(!t)return e;const i=o&&o.encode||f1;_e.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=_e.isURLSearchParams(t)?t.toString():new Iu(t,o).toString(i),a){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class hh{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){_e.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Np={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},p1=typeof URLSearchParams<"u"?URLSearchParams:Iu,v1=typeof FormData<"u"?FormData:null,m1=typeof Blob<"u"?Blob:null,g1={isBrowser:!0,classes:{URLSearchParams:p1,FormData:v1,Blob:m1},protocols:["http","https","file","blob","url","data"]},Tu=typeof window<"u"&&typeof document<"u",Kc=typeof navigator=="object"&&navigator||void 0,y1=Tu&&(!Kc||["ReactNative","NativeScript","NS"].indexOf(Kc.product)<0),_1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",k1=Tu&&window.location.href||"http://localhost",b1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Tu,hasStandardBrowserEnv:y1,hasStandardBrowserWebWorkerEnv:_1,navigator:Kc,origin:k1},Symbol.toStringTag,{value:"Module"})),vn={...b1,...g1};function w1(e,t){return Nl(e,new vn.classes.URLSearchParams,{visitor:function(o,i,s,a){return vn.isNode&&_e.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function C1(e){return _e.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function L1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function Fp(e){function t(o,i,s,a){let c=o[a++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=a>=o.length;return c=!c&&_e.isArray(s)?s.length:c,d?(_e.hasOwnProp(s,c)?s[c]=[s[c],i]:s[c]=i,!u):((!s[c]||!_e.isObject(s[c]))&&(s[c]=[]),t(o,i,s[c],a)&&_e.isArray(s[c])&&(s[c]=L1(s[c])),!u)}if(_e.isFormData(e)&&_e.isFunction(e.entries)){const o={};return _e.forEachEntry(e,(i,s)=>{t(C1(i),s,o,0)}),o}return null}function S1(e,t,o){if(_e.isString(e))try{return(t||JSON.parse)(e),_e.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const vr={transitional:Np,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=_e.isObject(t);if(a&&_e.isHTMLForm(t)&&(t=new FormData(t)),_e.isFormData(t))return s?JSON.stringify(Fp(t)):t;if(_e.isArrayBuffer(t)||_e.isBuffer(t)||_e.isStream(t)||_e.isFile(t)||_e.isBlob(t)||_e.isReadableStream(t))return t;if(_e.isArrayBufferView(t))return t.buffer;if(_e.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return w1(t,this.formSerializer).toString();if((u=_e.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Nl(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),S1(t)):t}],transformResponse:[function(t){const o=this.transitional||vr.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(_e.isResponse(t)||_e.isReadableStream(t))return t;if(t&&_e.isString(t)&&(i&&!this.responseType||s)){const c=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?ht.from(u,ht.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vn.classes.FormData,Blob:vn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_e.forEach(["delete","get","head","post","put","patch"],e=>{vr.headers[e]={}});const x1=_e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(c){s=c.indexOf(":"),o=c.substring(0,s).trim().toLowerCase(),i=c.substring(s+1).trim(),!(!o||t[o]&&x1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},fh=Symbol("internals");function Da(e){return e&&String(e).trim().toLowerCase()}function Jr(e){return e===!1||e==null?e:_e.isArray(e)?e.map(Jr):String(e)}function I1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const T1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function wc(e,t,o,i,s){if(_e.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!_e.isString(t)){if(_e.isString(i))return t.indexOf(i)!==-1;if(_e.isRegExp(i))return i.test(t)}}function M1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function A1(e,t){const o=_e.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,c){return this[i].call(this,t,s,a,c)},configurable:!0})})}let zn=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,d,p){const f=Da(d);if(!f)throw new Error("header name must be a non-empty string");const g=_e.findKey(s,f);(!g||s[g]===void 0||p===!0||p===void 0&&s[g]!==!1)&&(s[g||d]=Jr(u))}const c=(u,d)=>_e.forEach(u,(p,f)=>a(p,f,d));if(_e.isPlainObject(t)||t instanceof this.constructor)c(t,o);else if(_e.isString(t)&&(t=t.trim())&&!T1(t))c($1(t),o);else if(_e.isObject(t)&&_e.isIterable(t)){let u={},d,p;for(const f of t){if(!_e.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(d=u[p])?_e.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}c(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=Da(t),t){const i=_e.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return I1(s);if(_e.isFunction(o))return o.call(this,s,i);if(_e.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=Da(t),t){const i=_e.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||wc(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(c){if(c=Da(c),c){const u=_e.findKey(i,c);u&&(!o||wc(i,i[u],u,o))&&(delete i[u],s=!0)}}return _e.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||wc(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return _e.forEach(this,(s,a)=>{const c=_e.findKey(i,a);if(c){o[c]=Jr(s),delete o[a];return}const u=t?M1(a):String(a).trim();u!==a&&delete o[a],o[u]=Jr(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return _e.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&_e.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[fh]=this[fh]={accessors:{}}).accessors,s=this.prototype;function a(c){const u=Da(c);i[u]||(A1(s,c),i[u]=!0)}return _e.isArray(t)?t.forEach(a):a(t),this}};zn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_e.reduceDescriptors(zn.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});_e.freezeMethods(zn);function Cc(e,t){const o=this||vr,i=t||o,s=zn.from(i.headers);let a=i.data;return _e.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function Up(e){return!!(e&&e.__CANCEL__)}function pa(e,t,o){ht.call(this,e??"canceled",ht.ERR_CANCELED,t,o),this.name="CanceledError"}_e.inherits(pa,ht,{__CANCEL__:!0});function zp(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new ht("Request failed with status code "+o.status,[ht.ERR_BAD_REQUEST,ht.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function E1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function P1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,c;return t=t!==void 0?t:1e3,function(d){const p=Date.now(),f=i[a];c||(c=p),o[s]=d,i[s]=p;let g=a,_=0;for(;g!==s;)_+=o[g++],g=g%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),p-c<t)return;const b=f&&p-f;return b?Math.round(_*1e3/b):void 0}}function D1(e,t){let o=0,i=1e3/t,s,a;const c=(p,f=Date.now())=>{o=f,s=null,a&&(clearTimeout(a),a=null),e(...p)};return[(...p)=>{const f=Date.now(),g=f-o;g>=i?c(p,f):(s=p,a||(a=setTimeout(()=>{a=null,c(s)},i-g)))},()=>s&&c(s)]}const dl=(e,t,o=3)=>{let i=0;const s=P1(50,250);return D1(a=>{const c=a.loaded,u=a.lengthComputable?a.total:void 0,d=c-i,p=s(d),f=c<=u;i=c;const g={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:p||void 0,estimated:p&&u&&f?(u-c)/p:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},ph=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},vh=e=>(...t)=>_e.asap(()=>e(...t)),O1=vn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,vn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(vn.origin),vn.navigator&&/(msie|trident)/i.test(vn.navigator.userAgent)):()=>!0,R1=vn.hasStandardBrowserEnv?{write(e,t,o,i,s,a,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];_e.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),_e.isString(i)&&u.push(`path=${i}`),_e.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),_e.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function B1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function N1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Hp(e,t,o){let i=!B1(t);return e&&(i||o==!1)?N1(e,t):t}const mh=e=>e instanceof zn?{...e}:e;function Bi(e,t){t=t||{};const o={};function i(p,f,g,_){return _e.isPlainObject(p)&&_e.isPlainObject(f)?_e.merge.call({caseless:_},p,f):_e.isPlainObject(f)?_e.merge({},f):_e.isArray(f)?f.slice():f}function s(p,f,g,_){if(_e.isUndefined(f)){if(!_e.isUndefined(p))return i(void 0,p,g,_)}else return i(p,f,g,_)}function a(p,f){if(!_e.isUndefined(f))return i(void 0,f)}function c(p,f){if(_e.isUndefined(f)){if(!_e.isUndefined(p))return i(void 0,p)}else return i(void 0,f)}function u(p,f,g){if(g in t)return i(p,f);if(g in e)return i(void 0,p)}const d={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(p,f,g)=>s(mh(p),mh(f),g,!0)};return _e.forEach(Object.keys({...e,...t}),function(f){const g=d[f]||s,_=g(e[f],t[f],f);_e.isUndefined(_)&&g!==u||(o[f]=_)}),o}const Vp=e=>{const t=Bi({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:c,auth:u}=t;if(t.headers=c=zn.from(c),t.url=Bp(Hp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),_e.isFormData(o)){if(vn.hasStandardBrowserEnv||vn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(_e.isFunction(o.getHeaders)){const d=o.getHeaders(),p=["content-type","content-length"];Object.entries(d).forEach(([f,g])=>{p.includes(f.toLowerCase())&&c.set(f,g)})}}if(vn.hasStandardBrowserEnv&&(i&&_e.isFunction(i)&&(i=i(t)),i||i!==!1&&O1(t.url))){const d=s&&a&&R1.read(a);d&&c.set(s,d)}return t},F1=typeof XMLHttpRequest<"u",U1=F1&&function(e){return new Promise(function(o,i){const s=Vp(e);let a=s.data;const c=zn.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:p}=s,f,g,_,b,x;function $(){b&&b(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let B=new XMLHttpRequest;B.open(s.method.toUpperCase(),s.url,!0),B.timeout=s.timeout;function P(){if(!B)return;const S=zn.from("getAllResponseHeaders"in B&&B.getAllResponseHeaders()),I={data:!u||u==="text"||u==="json"?B.responseText:B.response,status:B.status,statusText:B.statusText,headers:S,config:e,request:B};zp(function(C){o(C),$()},function(C){i(C),$()},I),B=null}"onloadend"in B?B.onloadend=P:B.onreadystatechange=function(){!B||B.readyState!==4||B.status===0&&!(B.responseURL&&B.responseURL.indexOf("file:")===0)||setTimeout(P)},B.onabort=function(){B&&(i(new ht("Request aborted",ht.ECONNABORTED,e,B)),B=null)},B.onerror=function(A){const I=A&&A.message?A.message:"Network Error",T=new ht(I,ht.ERR_NETWORK,e,B);T.event=A||null,i(T),B=null},B.ontimeout=function(){let A=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const I=s.transitional||Np;s.timeoutErrorMessage&&(A=s.timeoutErrorMessage),i(new ht(A,I.clarifyTimeoutError?ht.ETIMEDOUT:ht.ECONNABORTED,e,B)),B=null},a===void 0&&c.setContentType(null),"setRequestHeader"in B&&_e.forEach(c.toJSON(),function(A,I){B.setRequestHeader(I,A)}),_e.isUndefined(s.withCredentials)||(B.withCredentials=!!s.withCredentials),u&&u!=="json"&&(B.responseType=s.responseType),p&&([_,x]=dl(p,!0),B.addEventListener("progress",_)),d&&B.upload&&([g,b]=dl(d),B.upload.addEventListener("progress",g),B.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(f=S=>{B&&(i(!S||S.type?new pa(null,e,B):S),B.abort(),B=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const M=E1(s.url);if(M&&vn.protocols.indexOf(M)===-1){i(new ht("Unsupported protocol "+M+":",ht.ERR_BAD_REQUEST,e));return}B.send(a||null)})},z1=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;i.abort(f instanceof ht?f:new pa(f instanceof Error?f.message:f))}};let c=t&&setTimeout(()=>{c=null,a(new ht(`timeout ${t} of ms exceeded`,ht.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),e=null)};e.forEach(p=>p.addEventListener("abort",a));const{signal:d}=i;return d.unsubscribe=()=>_e.asap(u),d}},H1=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},V1=async function*(e,t){for await(const o of G1(e))yield*H1(o,t)},G1=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},gh=(e,t,o,i)=>{const s=V1(e,t);let a=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:p,value:f}=await s.next();if(p){u(),d.close();return}let g=f.byteLength;if(o){let _=a+=g;o(_)}d.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},yh=64*1024,{isFunction:Fr}=_e,Z1=(({Request:e,Response:t})=>({Request:e,Response:t}))(_e.global),{ReadableStream:_h,TextEncoder:kh}=_e.global,bh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},j1=e=>{e=_e.merge.call({skipUndefined:!0},Z1,e);const{fetch:t,Request:o,Response:i}=e,s=t?Fr(t):typeof fetch=="function",a=Fr(o),c=Fr(i);if(!s)return!1;const u=s&&Fr(_h),d=s&&(typeof kh=="function"?(x=>$=>x.encode($))(new kh):async x=>new Uint8Array(await new o(x).arrayBuffer())),p=a&&u&&bh(()=>{let x=!1;const $=new o(vn.origin,{body:new _h,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!$}),f=c&&u&&bh(()=>_e.isReadableStream(new i("").body)),g={stream:f&&(x=>x.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!g[x]&&(g[x]=($,B)=>{let P=$&&$[x];if(P)return P.call($);throw new ht(`Response type '${x}' is not supported`,ht.ERR_NOT_SUPPORT,B)})});const _=async x=>{if(x==null)return 0;if(_e.isBlob(x))return x.size;if(_e.isSpecCompliantForm(x))return(await new o(vn.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(_e.isArrayBufferView(x)||_e.isArrayBuffer(x))return x.byteLength;if(_e.isURLSearchParams(x)&&(x=x+""),_e.isString(x))return(await d(x)).byteLength},b=async(x,$)=>{const B=_e.toFiniteNumber(x.getContentLength());return B??_($)};return async x=>{let{url:$,method:B,data:P,signal:M,cancelToken:S,timeout:A,onDownloadProgress:I,onUploadProgress:T,responseType:C,headers:V,withCredentials:z="same-origin",fetchOptions:ae}=Vp(x),j=t||fetch;C=C?(C+"").toLowerCase():"text";let X=z1([M,S&&S.toAbortSignal()],A),ce=null;const Te=X&&X.unsubscribe&&(()=>{X.unsubscribe()});let Ae;try{if(T&&p&&B!=="get"&&B!=="head"&&(Ae=await b(V,P))!==0){let Be=new o($,{method:"POST",body:P,duplex:"half"}),Ge;if(_e.isFormData(P)&&(Ge=Be.headers.get("content-type"))&&V.setContentType(Ge),Be.body){const[ue,Pe]=ph(Ae,dl(vh(T)));P=gh(Be.body,yh,ue,Pe)}}_e.isString(z)||(z=z?"include":"omit");const Ce=a&&"credentials"in o.prototype,pe={...ae,signal:X,method:B.toUpperCase(),headers:V.normalize().toJSON(),body:P,duplex:"half",credentials:Ce?z:void 0};ce=a&&new o($,pe);let me=await(a?j(ce,ae):j($,pe));const nt=f&&(C==="stream"||C==="response");if(f&&(I||nt&&Te)){const Be={};["status","statusText","headers"].forEach(Ee=>{Be[Ee]=me[Ee]});const Ge=_e.toFiniteNumber(me.headers.get("content-length")),[ue,Pe]=I&&ph(Ge,dl(vh(I),!0))||[];me=new i(gh(me.body,yh,ue,()=>{Pe&&Pe(),Te&&Te()}),Be)}C=C||"text";let Le=await g[_e.findKey(g,C)||"text"](me,x);return!nt&&Te&&Te(),await new Promise((Be,Ge)=>{zp(Be,Ge,{data:Le,headers:zn.from(me.headers),status:me.status,statusText:me.statusText,config:x,request:ce})})}catch(Ce){throw Te&&Te(),Ce&&Ce.name==="TypeError"&&/Load failed|fetch/i.test(Ce.message)?Object.assign(new ht("Network Error",ht.ERR_NETWORK,x,ce),{cause:Ce.cause||Ce}):ht.from(Ce,Ce&&Ce.code,x,ce)}}},q1=new Map,Gp=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let c=a.length,u=c,d,p,f=q1;for(;u--;)d=a[u],p=f.get(d),p===void 0&&f.set(d,p=u?new Map:j1(t)),f=p;return p};Gp();const Mu={http:u1,xhr:U1,fetch:{get:Gp}};_e.forEach(Mu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const wh=e=>`- ${e}`,W1=e=>_e.isFunction(e)||e===null||e===!1;function K1(e,t){e=_e.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let c=0;c<o;c++){i=e[c];let u;if(s=i,!W1(i)&&(s=Mu[(u=String(i)).toLowerCase()],s===void 0))throw new ht(`Unknown adapter '${u}'`);if(s&&(_e.isFunction(s)||(s=s.get(t))))break;a[u||"#"+c]=s}if(!s){const c=Object.entries(a).map(([d,p])=>`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?c.length>1?`since :
`+c.map(wh).join(`
`):" "+wh(c[0]):"as no adapter specified";throw new ht("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Zp={getAdapter:K1,adapters:Mu};function Lc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new pa(null,e)}function Ch(e){return Lc(e),e.headers=zn.from(e.headers),e.data=Cc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Zp.getAdapter(e.adapter||vr.adapter,e)(e).then(function(i){return Lc(e),i.data=Cc.call(e,e.transformResponse,i),i.headers=zn.from(i.headers),i},function(i){return Up(i)||(Lc(e),i&&i.response&&(i.response.data=Cc.call(e,e.transformResponse,i.response),i.response.headers=zn.from(i.response.headers))),Promise.reject(i)})}const jp="1.13.2",Fl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Fl[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const Lh={};Fl.transitional=function(t,o,i){function s(a,c){return"[Axios v"+jp+"] Transitional option '"+a+"'"+c+(i?". "+i:"")}return(a,c,u)=>{if(t===!1)throw new ht(s(c," has been removed"+(o?" in "+o:"")),ht.ERR_DEPRECATED);return o&&!Lh[c]&&(Lh[c]=!0,console.warn(s(c," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,c,u):!0}};Fl.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function Y1(e,t,o){if(typeof e!="object")throw new ht("options must be an object",ht.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],c=t[a];if(c){const u=e[a],d=u===void 0||c(u,a,e);if(d!==!0)throw new ht("option "+a+" must be "+d,ht.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new ht("Unknown option "+a,ht.ERR_BAD_OPTION)}}const Xr={assertOptions:Y1,validators:Fl},Xo=Xr.validators;let Di=class{constructor(t){this.defaults=t||{},this.interceptors={request:new hh,response:new hh}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=Bi(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&Xr.assertOptions(i,{silentJSONParsing:Xo.transitional(Xo.boolean),forcedJSONParsing:Xo.transitional(Xo.boolean),clarifyTimeoutError:Xo.transitional(Xo.boolean)},!1),s!=null&&(_e.isFunction(s)?o.paramsSerializer={serialize:s}:Xr.assertOptions(s,{encode:Xo.function,serialize:Xo.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Xr.assertOptions(o,{baseUrl:Xo.spelling("baseURL"),withXsrfToken:Xo.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let c=a&&_e.merge(a.common,a[o.method]);a&&_e.forEach(["delete","get","head","post","put","patch","common"],x=>{delete a[x]}),o.headers=zn.concat(c,a);const u=[];let d=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(o)===!1||(d=d&&$.synchronous,u.unshift($.fulfilled,$.rejected))});const p=[];this.interceptors.response.forEach(function($){p.push($.fulfilled,$.rejected)});let f,g=0,_;if(!d){const x=[Ch.bind(this),void 0];for(x.unshift(...u),x.push(...p),_=x.length,f=Promise.resolve(o);g<_;)f=f.then(x[g++],x[g++]);return f}_=u.length;let b=o;for(;g<_;){const x=u[g++],$=u[g++];try{b=x(b)}catch(B){$.call(this,B);break}}try{f=Ch.call(this,b)}catch(x){return Promise.reject(x)}for(g=0,_=p.length;g<_;)f=f.then(p[g++],p[g++]);return f}getUri(t){t=Bi(this.defaults,t);const o=Hp(t.baseURL,t.url,t.allowAbsoluteUrls);return Bp(o,t.params,t.paramsSerializer)}};_e.forEach(["delete","get","head","options"],function(t){Di.prototype[t]=function(o,i){return this.request(Bi(i||{},{method:t,url:o,data:(i||{}).data}))}});_e.forEach(["post","put","patch"],function(t){function o(i){return function(a,c,u){return this.request(Bi(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}Di.prototype[t]=o(),Di.prototype[t+"Form"]=o(!0)});let J1=class qp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const c=new Promise(u=>{i.subscribe(u),a=u}).then(s);return c.cancel=function(){i.unsubscribe(a)},c},t(function(a,c,u){i.reason||(i.reason=new pa(a,c,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new qp(function(s){t=s}),cancel:t}}};function X1(e){return function(o){return e.apply(null,o)}}function Q1(e){return _e.isObject(e)&&e.isAxiosError===!0}const Yc={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Yc).forEach(([e,t])=>{Yc[t]=e});function Wp(e){const t=new Di(e),o=Sp(Di.prototype.request,t);return _e.extend(o,Di.prototype,t,{allOwnKeys:!0}),_e.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Wp(Bi(e,s))},o}const Gt=Wp(vr);Gt.Axios=Di;Gt.CanceledError=pa;Gt.CancelToken=J1;Gt.isCancel=Up;Gt.VERSION=jp;Gt.toFormData=Nl;Gt.AxiosError=ht;Gt.Cancel=Gt.CanceledError;Gt.all=function(t){return Promise.all(t)};Gt.spread=X1;Gt.isAxiosError=Q1;Gt.mergeConfig=Bi;Gt.AxiosHeaders=zn;Gt.formToJSON=e=>Fp(_e.isHTMLForm(e)?new FormData(e):e);Gt.getAdapter=Zp.getAdapter;Gt.HttpStatusCode=Yc;Gt.default=Gt;const{Axios:fF,AxiosError:pF,CanceledError:vF,isCancel:mF,CancelToken:gF,VERSION:yF,all:_F,Cancel:kF,isAxiosError:bF,spread:wF,toFormData:CF,AxiosHeaders:LF,HttpStatusCode:SF,formToJSON:xF,getAdapter:$F,mergeConfig:IF}=Gt,ek="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",tk="VolunteerCheckinOffline",nk=1;let Io=null;async function Es(){return Io||new Promise((e,t)=>{const o=indexedDB.open(tk,nk);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Io=o.result,e(Io)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function ir(e,t){return await Es(),new Promise((o,i)=>{const s=Io.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),c=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),c.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function Xs(e){return await Es(),new Promise((t,o)=>{const a=Io.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function Ra(e,t,o){const i=await Xs(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await ir(e,i))}async function ok(e){return await Es(),new Promise((t,o)=>{const s=Io.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},c=s.add(a);c.onsuccess=()=>t(c.result),c.onerror=()=>o(c.error)})}async function Kp(){return await Es(),new Promise((e,t)=>{const a=Io.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const c=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(c)},a.onerror=()=>t(a.error)})}async function hl(){return(await Kp()).length}async function Sh(e,t){return await Es(),new Promise((o,i)=>{const s=Io.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),c=a.get(e);c.onsuccess=()=>{const u=c.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function xh(e){return await Es(),new Promise((t,o)=>{const a=Io.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function sk(e){return await Es(),new Promise((t,o)=>{const a=Io.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const Fe=Gt.create({baseURL:ek,headers:{"Content-Type":"application/json"},timeout:15e3});let Jc=!1;async function ik(){}function $h(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function ak(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}Fe.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let Xc=0;const rk=2;function lk(){if(Xc++,Xc>=rk){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function ck(){Xc=0}Fe.interceptors.response.use(e=>{Jc=!1,ck();const t=e.config.url,o=$h(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return lk(),Promise.reject(e);if(ak(e)&&(Jc=!0,t.method==="get")){const o=$h(t.url);if(o){const i=await Xs(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Qn(e,t,o){return await ok({type:e,payload:t,eventId:t.eventId}),await ik(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function un(){return Jc||!navigator.onLine}const uk={check:()=>Fe.head("/health")},Qc=()=>{const e=window.location.href.split("#")[0];return e.endsWith("/")?e.slice(0,-1):e},ts={requestLogin:e=>Fe.post("/auth/request-login",{email:e,frontendUrl:Qc()}),verifyToken:e=>Fe.post("/auth/verify-token",{token:e}),instantLogin:e=>Fe.post("/auth/instant-login",{email:e}),createAdmin:e=>Fe.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Fe.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Fe.get("/auth/me",{params:{eventId:e}}),logout:()=>Fe.post("/auth/logout")},Ur={getProfile:()=>Fe.get("/auth/profile"),updateProfile:e=>Fe.put("/auth/profile",e),getPerson:(e,t)=>Fe.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Fe.put(`/people/${e}`,o,{params:{eventId:t}})},xi={create:e=>Fe.post("/events",e),getAll:()=>Fe.get("/events"),getById:e=>Fe.get(`/events/${e}`),update:(e,t)=>Fe.put(`/events/${e}`,t),delete:e=>Fe.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Fe.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Fn={create:e=>Fe.post("/locations",e),getById:(e,t)=>Fe.get(`/locations/${e}/${t}`),getByEvent:e=>Fe.get(`/events/${e}/locations`),update:(e,t,o)=>Fe.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Fe.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),Fe.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Fe.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Fe.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Fe.get(`/events/${e}/dynamic-checkpoints`)},Ba={create:e=>Fe.post("/assignments",e),getById:(e,t)=>Fe.get(`/assignments/${e}/${t}`),getByEvent:e=>Fe.get(`/assignments/event/${e}`),delete:(e,t)=>Fe.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Fe.get(`/events/${e}/status`)},Ls={checkIn:e=>Fe.post("/checkin",e),adminCheckIn:(e,t)=>Fe.post(`/checkin/admin/${e}/${t}`)},Sc={getAdmins:e=>Fe.get(`/events/${e}/admins`),addAdmin:(e,t)=>Fe.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Fe.delete(`/events/${e}/admins/${t}`)},ns={create:e=>Fe.post("/marshals",e),getByEvent:e=>Fe.get(`/events/${e}/marshals`),getById:(e,t)=>Fe.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Fe.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Fe.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Fe.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Qc()}}),sendMagicLink:(e,t)=>Fe.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Qc()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Fe.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Ks={create:e=>Fe.post("/areas",e),getByEvent:e=>Fe.get(`/events/${e}/areas`),getById:(e,t)=>Fe.get(`/areas/${e}/${t}`),update:(e,t,o)=>Fe.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Fe.delete(`/areas/${e}/${t}`),recalculate:e=>Fe.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Fe.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Fe.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>Fe.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Fe.get(`/events/${e}/checklist-items`),getById:(e,t)=>Fe.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Fe.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Fe.delete(`/checklist-items/${e}/${t}`),getReport:e=>Fe.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Fe.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Fe.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Fe.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Fe.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Fe.post(`/checklist-items/${e}/${t}/uncomplete`,o)},ys={create:(e,t)=>Fe.post(`/events/${e}/notes`,t),getByEvent:e=>Fe.get(`/events/${e}/notes`),getById:(e,t)=>Fe.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Fe.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Fe.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Fe.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Fe.get(`/events/${e}/my-notes`)},Xi={create:(e,t)=>Fe.post(`/events/${e}/contacts`,t),getByEvent:e=>Fe.get(`/events/${e}/contacts`),getById:(e,t)=>Fe.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Fe.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Fe.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Fe.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Fe.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Fe.get(`/events/${e}/my-contacts`)},eo={create:(e,t)=>Fe.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Fe.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Fe.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Fe.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Fe.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Fe.post(`/events/${e}/incidents/${t}/notes`,{note:o})},va=Lu("auth",()=>{const e=E(localStorage.getItem("adminEmail")||null),t=E(!!e.value),o=E(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ts.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ts.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},instantLogin:async u=>{const d=await ts.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},logout:async()=>{try{await ts.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),dk={class:"home"},hk={class:"hero-section"},fk={class:"hero-content"},pk={class:"content-section"},vk={class:"container"},mk={class:"carousel"},gk={class:"carousel-indicators"},yk=["onClick"],_k={class:"modal-card"},kk={key:0,class:"email-sent"},bk={key:1},wk={class:"form-group"},Ck=["disabled"],Lk={key:0,class:"error"},Sk={__name:"Home",setup(e){const t=Dl(),o=ha(),i=va(),s=E(0);let a=null;function c(P){s.value=P,d()}function u(){s.value=(s.value+1)%2}function d(){a&&clearInterval(a),a=setInterval(u,1e4)}const p=E(!1),f=E(""),g=E(!1),_=E(null),b=E(!1);async function x(){g.value=!0,_.value=null;try{const P=await i.requestLogin(f.value);P.success?b.value=!0:_.value=P.message||"Failed to send login link. Please try again."}catch{_.value="Failed to send login link. Please try again."}finally{g.value=!1}}function $(){f.value="",b.value=!1,_.value=null}function B(){p.value=!1,t.query.login&&o.replace({query:{}})}return Yt(()=>{d(),t.query.login&&(p.value=!0)}),vo(()=>{a&&clearInterval(a)}),(P,M)=>(v(),y("div",dk,[l("section",hk,[l("div",fk,[Re(L_),M[2]||(M[2]=l("div",{class:"hero-overlay"},[l("h1",null,"OnTheDay")],-1))]),M[3]||(M[3]=l("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),l("button",{class:"btn btn-primary",onClick:M[0]||(M[0]=S=>p.value=!0)}," Join us or login ")]),l("section",pk,[l("div",vk,[M[5]||(M[5]=rl('<div class="features-grid" data-v-f75bc50b><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div></div>',1)),l("div",mk,[l("div",{class:"carousel-track",style:it({transform:`translateX(-${s.value*100}%)`})},[...M[4]||(M[4]=[rl('<div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div>',2)])],4),l("div",gk,[(v(),y(be,null,Oe(2,(S,A)=>l("button",{key:A,class:fe(["indicator",{active:s.value===A}]),onClick:I=>c(A)},null,10,yk)),64))])])])]),(v(),Xe(Lf,{to:"body"},[Re(Wr,{name:"modal"},{default:qe(()=>[p.value?(v(),y("div",{key:0,class:"modal-overlay",onClick:ft(B,["self"])},[l("div",_k,[l("button",{class:"modal-close",onClick:B},""),b.value?(v(),y("div",kk,[M[7]||(M[7]=l("div",{class:"check-icon"},"",-1)),M[8]||(M[8]=l("h3",null,"Check your email!",-1)),l("p",null,[M[6]||(M[6]=He("We've sent a login link to ",-1)),l("strong",null,k(f.value),1)]),M[9]||(M[9]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:$,class:"btn btn-secondary"}," Use a different email ")])):(v(),y("div",bk,[M[10]||(M[10]=l("h2",null,"Join us or login",-1)),M[11]||(M[11]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:ft(x,["prevent"])},[l("div",wk,[Ne(l("input",{"onUpdate:modelValue":M[1]||(M[1]=S=>f.value=S),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[et,f.value]])]),l("button",{type:"submit",class:"btn btn-primary btn-full",disabled:g.value},k(g.value?"Sending...":"Send login link"),9,Ck)],32),_.value?(v(),y("div",Lk,k(_.value),1)):D("",!0)]))])])):D("",!0)]),_:1})]))]))}},xk=Ke(Sk,[["__scopeId","data-v-f75bc50b"]]),$k={class:"admin-login"},Ik={class:"login-card"},Tk={key:0,class:"email-sent"},Mk={class:"form-group"},Ak=["disabled"],Ek={key:0,class:"error"},Pk={__name:"AdminLogin",setup(e){const t=va(),o=E(""),i=E(!1),s=E(null),a=E(!1),c=async()=>{i.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?a.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(d,p)=>{const f=yu("router-link");return v(),y("div",$k,[l("div",Ik,[p[7]||(p[7]=l("h2",null,"Admin login",-1)),a.value?(v(),y("div",Tk,[p[2]||(p[2]=l("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=l("h3",null,"Check your email!",-1)),l("p",null,[p[1]||(p[1]=He("We've sent a login link to ",-1)),l("strong",null,k(o.value),1)]),p[4]||(p[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),y(be,{key:1},[p[5]||(p[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:ft(c,["prevent"])},[l("div",Mk,[Ne(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[et,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:i.value},k(i.value?"Sending...":"Send login link"),9,Ak)],32),s.value?(v(),y("div",Ek,k(s.value),1)):D("",!0)],64)),Re(f,{to:"/",class:"back-link"},{default:qe(()=>[...p[6]||(p[6]=[He(" Back to Home",-1)])]),_:1})])])}}},Dk=Ke(Pk,[["__scopeId","data-v-5d0a88c2"]]),Ok={class:"admin-verify"},Rk={class:"verify-card"},Bk={key:0,class:"status"},Nk={key:1,class:"status error"},Fk={key:2,class:"status success"},Uk={__name:"AdminVerify",setup(e){const t=ha(),o=Dl(),i=va(),s=E(!0),a=E(null);return Yt(async()=>{const c=o.query.token;if(!c){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(c);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(c,u)=>{const d=yu("router-link");return v(),y("div",Ok,[l("div",Rk,[s.value?(v(),y("div",Bk,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(v(),y("div",Nk,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,k(a.value),1),Re(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:qe(()=>[...u[1]||(u[1]=[He(" Try again ",-1)])]),_:1})])):(v(),y("div",Fk,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to dashboard...",-1)])]))])])}}},zk=Ke(Uk,[["__scopeId","data-v-76177495"]]),Yp=Lu("events",()=>{const e=E([]),t=E(null),o=E([]),i=E([]),s=E(null),a=E(!1),c=E(null),u=async()=>{a.value=!0,c.value=null;try{const T=await xi.getAll();e.value=T.data}catch(T){throw c.value=T.message,T}finally{a.value=!1}},d=async T=>{a.value=!0,c.value=null;try{const C=await xi.getById(T);t.value=C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},p=async T=>{a.value=!0,c.value=null;try{const C=await xi.create(T);return e.value.push(C.data),C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},f=async(T,C)=>{a.value=!0,c.value=null;try{const V=await xi.update(T,C),z=e.value.findIndex(ae=>ae.id===T);return z!==-1&&(e.value[z]=V.data),t.value?.id===T&&(t.value=V.data),V.data}catch(V){throw c.value=V.message,V}finally{a.value=!1}},g=async T=>{a.value=!0,c.value=null;try{await xi.delete(T),e.value=e.value.filter(C=>C.id!==T)}catch(C){throw c.value=C.message,C}finally{a.value=!1}},_=async T=>{a.value=!0,c.value=null;try{const C=await Fn.getByEvent(T);o.value=C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:c,fetchEvents:u,fetchEvent:d,createEvent:p,updateEvent:f,deleteEvent:g,fetchLocations:_,createLocation:async T=>{a.value=!0,c.value=null;try{const C=await Fn.create(T);return o.value.push(C.data),C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},updateLocation:async(T,C,V)=>{a.value=!0,c.value=null;try{const z=await Fn.update(T,C,V),ae=o.value.findIndex(j=>j.id===C);return ae!==-1&&(o.value[ae]=z.data),z.data}catch(z){throw c.value=z.message,z}finally{a.value=!1}},deleteLocation:async(T,C)=>{a.value=!0,c.value=null;try{await Fn.delete(T,C),o.value=o.value.filter(V=>V.id!==C)}catch(V){throw c.value=V.message,V}finally{a.value=!1}},bulkUpdateLocationTimes:async(T,C)=>{a.value=!0,c.value=null;try{const V=await Fn.bulkUpdateTimes(T,C);return await _(T),V.data}catch(V){throw c.value=V.message,V}finally{a.value=!1}},fetchAssignments:async T=>{a.value=!0,c.value=null;try{const C=await Ba.getByEvent(T);i.value=C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},createAssignment:async T=>{a.value=!0,c.value=null;try{const C=await Ba.create(T);return i.value.push(C.data),C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},deleteAssignment:async(T,C)=>{a.value=!0,c.value=null;try{await Ba.delete(T,C),i.value=i.value.filter(V=>V.id!==C)}catch(V){throw c.value=V.message,V}finally{a.value=!1}},fetchEventStatus:async T=>{a.value=!0,c.value=null;try{const C=await Ba.getEventStatus(T);return s.value=C.data,C.data}catch(C){throw c.value=C.message,C}finally{a.value=!1}},updateAssignmentCheckIn:T=>{const C=i.value.findIndex(V=>V.id===T.id);C!==-1&&(i.value[C]=T),s.value&&s.value.locations.forEach(V=>{const z=V.assignments.findIndex(ae=>ae.id===T.id);z!==-1&&(V.assignments[z]=T,V.checkedInCount=V.assignments.filter(ae=>ae.isCheckedIn).length)})}}}),Hk={class:"confirm-modal"},Vk={class:"confirm-actions"},Gk={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,c)=>e.show?(v(),y("div",{key:0,class:"modal-overlay",onClick:ft(s,["self"])},[l("div",Hk,[l("h3",null,k(e.title),1),l("p",null,k(e.message),1),l("div",Vk,[e.showCancel?(v(),y("button",{key:0,onClick:s,class:"btn btn-secondary"},k(e.cancelText),1)):D("",!0),l("button",{onClick:i,class:fe(["btn",e.isDanger?"btn-danger":"btn-primary"])},k(e.confirmText),3)])])])):D("",!0)}},ar=Ke(Gk,[["__scopeId","data-v-bead7a29"]]),Zk={class:"base-modal-header"},jk={class:"base-modal-header-content"},qk={key:0,class:"base-modal-title"},Wk={key:0,class:"base-modal-tab-header"},Kk={class:"base-modal-body"},Yk={key:1,class:"base-modal-footer"},Jk={key:0,class:"base-modal-actions"},Xk={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=E(!1),a=E(!1),c=()=>{o.closeOnOverlay&&u()},u=()=>{o.confirmOnClose&&o.isDirty?s.value=!0:i("close")},d=()=>{s.value=!1,i("close")},p=()=>{s.value=!1};return(f,g)=>e.show?(v(),y("div",{key:0,class:"base-modal-overlay",style:it({zIndex:e.zIndex}),onClick:ft(c,["self"])},[l("div",{class:fe(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",Zk,[l("div",jk,[Yi(f.$slots,"header",{},()=>[e.title?(v(),y("h2",qk,k(e.title),1)):D("",!0)])]),e.showCloseButton?(v(),y("button",{key:0,onClick:u,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):D("",!0)]),f.$slots["tab-header"]?(v(),y("div",Wk,[Yi(f.$slots,"tab-header",{},void 0)])):D("",!0),l("div",Kk,[Yi(f.$slots,"default",{},void 0)]),f.$slots.footer||f.$slots.actions?(v(),y("div",Yk,[Yi(f.$slots,"footer",{},()=>[f.$slots.actions?(v(),y("div",Jk,[Yi(f.$slots,"actions",{},void 0,!0)])):D("",!0)])])):D("",!0)],2),e.confirmOnClose&&!a.value?(v(),Xe(ar,{key:0,show:s.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:d,onCancel:p},null,8,["show"])):D("",!0)],4)):D("",!0)}},Pt=Ke(Xk,[["__scopeId","data-v-f8079872"]]);function Jp(e="details",t=[]){const o=E(e),i=g=>{o.value=g},s=()=>{o.value=e},a=g=>o.value===g,c=K(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const _=c.value;if(_===-1)return;const b=_+1;b<t.length?o.value=t[b]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const _=c.value;if(_===-1)return;const b=_-1;b>=0?o.value=t[b]:g&&(o.value=t[t.length-1])},p=K(()=>{if(t.length===0)return!1;const g=c.value;return g!==-1&&g<t.length-1}),f=K(()=>t.length===0?!1:c.value>0);return{activeTab:o,activeTabIndex:c,hasNextTab:p,hasPreviousTab:f,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:d}}const Xp=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],Qk={class:"tabs"},eb={class:"tab-content"},tb={class:"form-group"},nb={class:"form-group"},ob={class:"form-group"},sb={class:"form-group"},ib=["value"],ab={class:"tab-content"},rb={class:"emergency-contacts-section"},lb={key:0,class:"empty-state"},cb={class:"card-header"},ub=["onClick"],db={class:"form-group"},hb=["onUpdate:modelValue"],fb={class:"form-group"},pb=["onUpdate:modelValue"],vb={class:"form-group"},mb=["onUpdate:modelValue"],gb={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:c}=Jp("basic",["basic","emergency"]),u=E({...o.eventData});je(()=>o.eventData,_=>{u.value={..._},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),je(()=>o.show,_=>{_&&c()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=_=>{u.value.emergencyContacts.splice(_,1)},f=()=>{i("submit",{...u.value})},g=()=>{i("close")};return(_,b)=>(v(),Xe(Pt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":qe(()=>[l("div",Qk,[l("button",{type:"button",onClick:b[0]||(b[0]=x=>G(a)("basic")),class:fe(["tab-button",{active:G(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:b[1]||(b[1]=x=>G(a)("emergency")),class:fe(["tab-button",{active:G(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:qe(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary"},k(e.isEditing?"Update":"Create"),1)]),default:qe(()=>[l("form",{onSubmit:ft(f,["prevent"])},[Ne(l("div",eb,[l("div",tb,[b[6]||(b[6]=l("label",null,"Event name *",-1)),Ne(l("input",{"onUpdate:modelValue":b[2]||(b[2]=x=>u.value.name=x),type:"text",required:"",class:"form-input"},null,512),[[et,u.value.name]])]),l("div",nb,[b[7]||(b[7]=l("label",null,"Description",-1)),Ne(l("textarea",{"onUpdate:modelValue":b[3]||(b[3]=x=>u.value.description=x),rows:"3",class:"form-input"},null,512),[[et,u.value.description]])]),l("div",ob,[b[8]||(b[8]=l("label",null,"Event date *",-1)),Ne(l("input",{"onUpdate:modelValue":b[4]||(b[4]=x=>u.value.eventDate=x),type:"datetime-local",required:"",class:"form-input"},null,512),[[et,u.value.eventDate]])]),l("div",sb,[b[9]||(b[9]=l("label",null,"Time zone *",-1)),Ne(l("select",{"onUpdate:modelValue":b[5]||(b[5]=x=>u.value.timeZoneId=x),required:"",class:"form-input"},[(v(!0),y(be,null,Oe(G(Xp),x=>(v(),y("option",{key:x.value,value:x.value},k(x.label),9,ib))),128))],512),[[pn,u.value.timeZoneId]])])],512),[[ei,G(s)==="basic"]]),Ne(l("div",ab,[l("div",rb,[l("div",{class:"section-header-small"},[b[10]||(b[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),y("div",lb,[...b[11]||(b[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):D("",!0),(v(!0),y(be,null,Oe(u.value.emergencyContacts,(x,$)=>(v(),y("div",{key:$,class:"emergency-contact-card"},[l("div",cb,[l("h4",null,"Contact "+k($+1),1),l("button",{type:"button",onClick:B=>p($),class:"btn-remove"},"  ",8,ub)]),l("div",db,[b[12]||(b[12]=l("label",null,"Name *",-1)),Ne(l("input",{"onUpdate:modelValue":B=>x.name=B,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,hb),[[et,x.name]])]),l("div",fb,[b[13]||(b[13]=l("label",null,"Phone *",-1)),Ne(l("input",{"onUpdate:modelValue":B=>x.phone=B,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,pb),[[et,x.phone]])]),l("div",vb,[b[14]||(b[14]=l("label",null,"Additional details",-1)),Ne(l("textarea",{"onUpdate:modelValue":B=>x.details=B,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,mb),[[et,x.details]])])]))),128))])],512),[[ei,G(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},yb=Ke(gb,[["__scopeId","data-v-6339e6bb"]]),Qp="admin-theme-preference",Ci=E(_b());function _b(){return typeof window>"u"?"system":localStorage.getItem(Qp)||"system"}function kb(e){localStorage.setItem(Qp,e)}function Au(){const e=K(()=>Ci.value==="system"?"light dark":Ci.value),t=s=>{Ci.value=s,kb(s)},o=()=>{const s=["system","light","dark"],c=(s.indexOf(Ci.value)+1)%s.length;t(s[c])},i=K(()=>Ci.value==="dark"?!0:Ci.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Ci,colorScheme:e,isDark:i,setTheme:t,cycleTheme:o}}const bb=["aria-expanded","title"],wb=["innerHTML"],Cb={key:0,class:"dropdown-menu"},Lb=["onClick"],Sb=["innerHTML"],xb={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:i}=Au(),s=E(!1),a=E(null),c={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:c.system},{value:"light",label:"Light",icon:c.light},{value:"dark",label:"Dark",icon:c.dark}],d=K(()=>o.value?c.dark:c.light),p=()=>{s.value=!s.value},f=_=>{i(_),s.value=!1},g=_=>{a.value&&!a.value.contains(_.target)&&(s.value=!1)};return Yt(()=>{document.addEventListener("click",g)}),vo(()=>{document.removeEventListener("click",g)}),(_,b)=>(v(),y("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:a},[l("button",{class:"theme-toggle-btn",onClick:p,type:"button","aria-expanded":s.value,title:G(o)?"Dark mode":"Light mode"},[l("span",{class:"theme-icon",innerHTML:d.value},null,8,wb)],8,bb),s.value?(v(),y("div",Cb,[(v(),y(be,null,Oe(u,x=>l("button",{key:x.value,class:fe(["dropdown-item",{active:G(t)===x.value}]),onClick:$=>f(x.value)},[l("span",{class:"option-icon",innerHTML:x.icon},null,8,Sb),l("span",null,k(x.label),1)],10,Lb)),64))])):D("",!0)],512))}},ev=Ke(xb,[["__scopeId","data-v-969124a4"]]),$b={class:"header"},Ib={class:"header-actions"},Tb={class:"user-email"},Mb={class:"container"},Ab={class:"section"},Eb={class:"section-header"},Pb={key:0,class:"loading"},Db={key:1,class:"empty"},Ob={key:2,class:"events-grid"},Rb=["onClick"],Bb={class:"event-date"},Nb={class:"event-desc"},Fb={class:"event-actions"},Ub=["onClick"],zb=["onClick"],Hb={__name:"AdminDashboard",setup(e){const t=ha(),{colorScheme:o}=Au(),i=va(),s=Yp(),a=E(!0),c=E(!1),u=E(null),d=E({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),p=E([]),f=E(!1),g=E(""),_=E(""),b=E(null),x=E(!1),$=E("OK"),B=async()=>{a.value=!0;try{await s.fetchEvents(),p.value=s.events}catch(X){console.error("Failed to load events:",X)}finally{a.value=!1}},P=async X=>{try{const ce={...X,adminEmail:i.adminEmail};u.value?await s.updateEvent(u.value.id,ce):await s.createEvent(ce),p.value=s.events,T()}catch(ce){console.error("Failed to save event:",ce),alert("Failed to save event. Please try again.")}},M=X=>{u.value=X,d.value={name:X.name,description:X.description,eventDate:j(X.eventDate),timeZoneId:X.timeZoneId||"UTC",emergencyContacts:X.emergencyContacts?JSON.parse(JSON.stringify(X.emergencyContacts)):[]}},S=async X=>{g.value="Delete event",_.value=`Are you sure you want to delete "${X.name}"?`,x.value=!0,$.value="Delete",b.value=async()=>{try{await s.deleteEvent(X.id),p.value=s.events}catch(ce){console.error("Failed to delete event:",ce),alert("Failed to delete event. Please try again.")}},f.value=!0},A=()=>{f.value=!1,b.value&&(b.value(),b.value=null)},I=()=>{f.value=!1,b.value=null},T=()=>{c.value=!1,u.value=null,d.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},C=X=>{if(!X){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:X}})},V=()=>{t.push({name:"AdminProfile"})},z=()=>{i.logout(),t.push({name:"Home"})},ae=X=>new Date(X).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=X=>{const ce=new Date(X),Te=ce.getFullYear(),Ae=String(ce.getMonth()+1).padStart(2,"0"),Ce=String(ce.getDate()).padStart(2,"0"),pe=String(ce.getHours()).padStart(2,"0"),me=String(ce.getMinutes()).padStart(2,"0");return`${Te}-${Ae}-${Ce}T${pe}:${me}`};return Yt(()=>{B()}),(X,ce)=>(v(),y("div",{class:"admin-dashboard",style:it({colorScheme:G(o)})},[l("header",$b,[ce[1]||(ce[1]=l("h1",null,"Admin dashboard",-1)),l("div",Ib,[l("span",Tb,k(G(i).adminEmail),1),l("button",{onClick:V,class:"btn btn-secondary"},"Profile"),l("button",{onClick:z,class:"btn btn-secondary"},"Logout"),Re(ev)])]),l("div",Mb,[l("div",Ab,[l("div",Eb,[ce[2]||(ce[2]=l("h2",null,"Your events",-1)),l("button",{onClick:ce[0]||(ce[0]=Te=>c.value=!0),class:"btn btn-primary"}," Create new event ")]),a.value?(v(),y("div",Pb,"Loading events...")):p.value.length===0?(v(),y("div",Db,[...ce[3]||(ce[3]=[l("p",null,"No events yet. Create your first event to get started!",-1)])])):(v(),y("div",Ob,[(v(!0),y(be,null,Oe(p.value,Te=>(v(),y("div",{key:Te.id,class:"event-card",onClick:Ae=>C(Te.id)},[l("h3",null,k(Te.name),1),l("p",Bb,k(ae(Te.eventDate)),1),l("p",Nb,k(Te.description),1),l("div",Fb,[l("button",{onClick:ft(Ae=>M(Te),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,Ub),l("button",{onClick:ft(Ae=>S(Te),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,zb)])],8,Rb))),128))]))])]),Re(yb,{show:c.value||!!u.value,"event-data":d.value,"is-editing":!!u.value,onClose:T,onSubmit:P},null,8,["show","event-data","is-editing"]),Re(ar,{show:f.value,title:g.value,message:_.value,"is-danger":x.value,"confirm-text":$.value,onConfirm:A,onCancel:I},null,8,["show","title","message","is-danger","confirm-text"])],4))}},Vb=Ke(Hb,[["__scopeId","data-v-16db0525"]]),Gb=Lu("profile",()=>{const e=E(null),t=E(!1),o=E(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await Ur.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const p=await Ur.updateProfile(d);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(d,p)=>{t.value=!0,o.value=null;try{return(await Ur.getPerson(d,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,p,f)=>{t.value=!0,o.value=null;try{return(await Ur.updatePerson(d,p,f)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),Zb={class:"form-group"},jb={class:"form-group"},qb={class:"form-group"},Wb={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=E({name:"",email:"",phone:""});je(()=>o.profile,d=>{d&&(s.value={name:d.name||"",email:d.email||"",phone:d.phone||""})},{immediate:!0,deep:!0}),je(()=>o.show,d=>{d&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},c=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(d,p)=>(v(),Xe(Pt,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Save changes ")]),default:qe(()=>[l("form",{onSubmit:ft(c,["prevent"])},[l("div",Zb,[p[3]||(p[3]=l("label",null,"Name *",-1)),Ne(l("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[et,s.value.name]])]),l("div",jb,[p[4]||(p[4]=l("label",null,"Email *",-1)),Ne(l("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.email=f),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[et,s.value.email]])]),l("div",qb,[p[5]||(p[5]=l("label",null,"Phone",-1)),Ne(l("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.phone=f),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[et,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},Kb=Ke(Wb,[["__scopeId","data-v-5b468307"]]),Yb={class:"admin-profile"},Jb={class:"header"},Xb={class:"header-actions"},Qb={class:"user-email"},e0={class:"container"},t0={class:"section"},n0={class:"section-header"},o0={key:0,class:"loading"},s0={key:1,class:"error"},i0={key:2,class:"profile-details"},a0={class:"profile-field"},r0={class:"field-value"},l0={class:"profile-field"},c0={class:"field-value"},u0={class:"profile-field"},d0={class:"field-value"},h0={class:"profile-field"},f0={class:"field-value"},p0={__name:"AdminProfile",setup(e){const t=ha(),o=va(),i=Gb(),s=E(!1),a=async()=>{try{await i.fetchProfile()}catch(p){console.error("Failed to load profile:",p)}},c=async p=>{try{await i.updateProfile(p),s.value=!1}catch(f){console.error("Failed to save profile:",f),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},d=()=>{t.push({name:"AdminDashboard"})};return Yt(()=>{a()}),(p,f)=>(v(),y("div",Yb,[l("header",Jb,[f[2]||(f[2]=l("h1",null,"My profile",-1)),l("div",Xb,[l("span",Qb,k(G(o).adminEmail),1),l("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),l("div",e0,[l("div",t0,[l("div",n0,[f[3]||(f[3]=l("h2",null,"Profile information",-1)),l("button",{onClick:f[0]||(f[0]=g=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),G(i).loading?(v(),y("div",o0,"Loading profile...")):G(i).error?(v(),y("div",s0,[l("p",null,k(G(i).error),1),l("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):G(i).profile?(v(),y("div",i0,[l("div",a0,[f[4]||(f[4]=l("label",null,"Name",-1)),l("div",r0,k(G(i).profile.name||""),1)]),l("div",l0,[f[5]||(f[5]=l("label",null,"Email",-1)),l("div",c0,k(G(i).profile.email||""),1)]),l("div",u0,[f[6]||(f[6]=l("label",null,"Phone",-1)),l("div",d0,k(G(i).profile.phone||""),1)]),l("div",h0,[f[7]||(f[7]=l("label",null,"System admin",-1)),l("div",f0,[l("span",{class:fe(["badge",G(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},k(G(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):D("",!0)]),l("div",{class:"section"},[l("button",{onClick:d,class:"btn btn-secondary"}," Back to Dashboard ")])]),Re(Kb,{show:s.value,profile:G(i).profile,onClose:f[1]||(f[1]=g=>s.value=!1),onSubmit:c},null,8,["show","profile"])]))}},v0=Ke(p0,[["__scopeId","data-v-fdbd980a"]]);function m0(){const e=E(!1),t=E(""),o=E(""),i=E(null),s=E(!1),a=E("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:a,showConfirm:(f,g,_,b={})=>{t.value=f,o.value=g,i.value=_,s.value=b.isDanger||!1,a.value=b.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const Qi=E({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Ss={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Cs={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function $i(e,t,o="Marshals"){if(!t)return"";const i=Ss[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Ss.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function tv(e,t,o="Marshals"){if(!t)return"";const i=Ss[e]?.[t];return t==="Person points"?`${Ss.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function eu(e,t){return e==="Person points"?`${Ss.people[t]?.singular||"Person"} points`:e}function tu(e){e&&(Qi.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const So=e=>e.toLowerCase(),xo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function St(){const e=f=>{const g=Qi.value[f],_=Ss[f]?.[g];if(f==="checkpoint"&&g==="Person points"){const b=Qi.value.people;return`${Ss.people[b]?.singular||"Person"} point`}return _?.singular||g},t=f=>{const g=Qi.value[f],_=Ss[f]?.[g];if(f==="checkpoint"&&g==="Person points"){const b=Qi.value.people;return`${Ss.people[b]?.singular||"Person"} points`}return _?.plural||g},o=K(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=K(()=>({person:So(e("people")),checkpoint:So(e("checkpoint")),area:So(e("area")),checklist:So(e("checklist")),course:So(e("course")),people:So(t("people")),checkpoints:So(t("checkpoint")),areas:So(t("area")),checklists:So(t("checklist")),courses:So(t("course"))})),s=K(()=>({person:xo(e("people")),checkpoint:xo(e("checkpoint")),area:xo(e("area")),checklist:xo(e("checklist")),course:xo(e("course")),people:xo(t("people")),checkpoints:xo(t("checkpoint")),areas:xo(t("area")),checklists:xo(t("checklist")),courses:xo(t("course"))})),a=K(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(f,g)=>g===1?`1 ${e(f)}`:`${g} ${t(f)}`,lower:(f,g=!0)=>So(g?t(f):e(f)),title:(f,g=!0)=>g?t(f):e(f),sentence:(f,g=!0)=>xo(g?t(f):e(f)),terminology:Qi}}function g0(){const e=E(!1),t=E(null),o=E({}),i=E(null),s=E(null),a=E([]),c=E(null),u=E(null),d=E(!1),p=E(!1),f=E(1),g=K(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),_=ce=>{if(ce){const Te=ce.getMapCenter?.(),Ae=ce.getMapZoom?.();Te&&Ae!==null&&(c.value=Te,u.value=Ae)}},b=(ce={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:ce.title||"Select checkpoint location",description:ce.description||"Click on the map to set the location. Click again to reposition."}},x=(ce,Te="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Te}: ${ce}`,description:"Click on the map to set the new location"}},$=(ce={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:ce.title||"Draw area boundary",description:ce.description||"Click to add points. Click Done when finished to complete the area."}},B=(ce=1)=>{f.value=ce,a.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},P=ce=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=ce:t.value==="add-multiple"&&M(ce)},M=ce=>{a.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:ce.lat,longitude:ce.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},S=ce=>{s.value=ce},A=()=>s.value&&s.value.length>=3?s.value.map(ce=>({lat:ce.lat,lng:ce.lng})):null,I=()=>{e.value=!1,t.value=null,o.value={},i.value=null,c.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:c,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:g,saveMapState:_,enterPlaceCheckpointMode:b,enterMoveCheckpointMode:x,enterDrawAreaMode:$,enterAddMultipleMode:B,handleFullscreenMapClick:P,handlePolygonDrawing:S,getCompletedPolygon:A,exitFullscreen:I,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],p.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),I()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],p.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(ce,Te,Ae)=>K(()=>{const Ce=[...ce.value];return t.value==="place-checkpoint"&&i.value&&Ce.push({id:"temp-single",name:Te.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Te.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&Ae.value&&Ce.push({id:"temp-move",name:Ae.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Ae.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Ce.push(...a.value),Ce}),createDisplayAreas:(ce,Te)=>K(()=>{const Ae=[...ce.value];if(t.value==="draw-area"&&Te.value?.polygon?.length>0){const Ce=Ae.findIndex(pe=>pe.id===Te.value.id);Ce>=0?Ae[Ce]={...Te.value}:Ae.push({...Te.value,id:Te.value.id||"temp-area"})}return Ae}),calculateStartingNumber:ce=>{const Te=ce.value.map(Ae=>{const Ce=Ae.name.match(/^Checkpoint (\d+)$/);return Ce?parseInt(Ce[1]):0}).filter(Ae=>Ae>0);return Te.length>0?Math.max(...Te)+1:1}}}function y0(e){const t=E([]),o=E(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Sc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Sc.addAdmin(e.value,d)},removeAdmin:async d=>{await Sc.removeAdmin(e.value,d)}}}function _0(e){const t=E(!1),o=E(!1),i=E(!1),s=E(!1),a=E(!1),c=E(!1),u=E(null),d=E(null),p=E(null),f=E(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:c,uploadError:u,importError:d,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async I=>{if(!I)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await xi.uploadGpx(e.value,I),!0}catch(T){return console.error("Failed to upload route:",T),u.value=T.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,p.value=null},importLocations:async(I,T)=>{if(!I)return d.value="Please select a CSV file",null;a.value=!0,d.value=null,p.value=null;try{const C=await Fn.importCsv(e.value,I,T);return p.value=C.data,C.data}catch(C){return console.error("Failed to import locations:",C),d.value=C.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,d.value=null,f.value=null},importMarshals:async I=>{if(!I)return d.value="Please select a CSV file",null;c.value=!0,d.value=null,f.value=null;try{const T=await ns.importCsv(e.value,I);return f.value=T.data,T.data}catch(T){return console.error("Failed to import marshals:",T),d.value=T.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{c.value=!1}},formatImportResultMessage:(I,T="location")=>{const C=T==="location"?"location(s)":"marshal(s)";let z=`<p>Created <strong>${I[T==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${C} and <strong>${I.assignmentsCreated}</strong> assignment(s)</p>`;return I.errors&&I.errors.length>0&&(z+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',I.errors.forEach(ae=>{z+=`<li>${ae}</li>`}),z+="</ul>"),z}}}const nv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",rr=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),c=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${c}`},fl=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function k0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Na={exports:{}};var b0=Na.exports,Ih;function w0(){return Ih||(Ih=1,(function(e,t){(function(o,i){i(t)})(b0,(function(o){var i="1.9.4";function s(n){var r,h,m,w;for(h=1,m=arguments.length;h<m;h++){w=arguments[h];for(r in w)n[r]=w[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function c(n,r){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var m=h.call(arguments,2);return function(){return n.apply(r,m.length?m.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,r,h){var m,w,O,ne;return ne=function(){m=!1,w&&(O.apply(h,w),w=!1)},O=function(){m?w=arguments:(n.apply(h,arguments),setTimeout(ne,r),m=!0)},O}function f(n,r,h){var m=r[1],w=r[0],O=m-w;return n===m&&h?n:((n-w)%O+O)%O+w}function g(){return!1}function _(n,r){if(r===!1)return n;var h=Math.pow(10,r===void 0?6:r);return Math.round(n*h)/h}function b(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function x(n){return b(n).split(/\s+/)}function $(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var h in r)n.options[h]=r[h];return n.options}function B(n,r,h){var m=[];for(var w in n)m.push(encodeURIComponent(h?w.toUpperCase():w)+"="+encodeURIComponent(n[w]));return(!r||r.indexOf("?")===-1?"?":"&")+m.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function M(n,r){return n.replace(P,function(h,m){var w=r[m];if(w===void 0)throw new Error("No value provided for variable "+h);return typeof w=="function"&&(w=w(r)),w})}var S=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,r){for(var h=0;h<n.length;h++)if(n[h]===r)return h;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var C=0;function V(n){var r=+new Date,h=Math.max(0,16-(r-C));return C=r+h,window.setTimeout(n,h)}var z=window.requestAnimationFrame||T("RequestAnimationFrame")||V,ae=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function j(n,r,h){if(h&&z===V)n.call(r);else return z.call(window,c(n,r))}function X(n){n&&ae.call(window,n)}var ce={__proto__:null,extend:s,create:a,bind:c,get lastId(){return u},stamp:d,throttle:p,wrapNum:f,falseFn:g,formatNum:_,trim:b,splitWords:x,setOptions:$,getParamString:B,template:M,isArray:S,indexOf:A,emptyImageUrl:I,requestFn:z,cancelFn:ae,requestAnimFrame:j,cancelAnimFrame:X};function Te(){}Te.extend=function(n){var r=function(){$(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=r.__super__=this.prototype,m=a(h);m.constructor=r,r.prototype=m;for(var w in this)Object.prototype.hasOwnProperty.call(this,w)&&w!=="prototype"&&w!=="__super__"&&(r[w]=this[w]);return n.statics&&s(r,n.statics),n.includes&&(Ae(n.includes),s.apply(null,[m].concat(n.includes))),s(m,n),delete m.statics,delete m.includes,m.options&&(m.options=h.options?a(h.options):{},s(m.options,n.options)),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,ne=m._initHooks.length;O<ne;O++)m._initHooks[O].call(this)}},r},Te.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},Te.mergeOptions=function(n){return s(this.prototype.options,n),this},Te.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Ae(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=S(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ce={on:function(n,r,h){if(typeof n=="object")for(var m in n)this._on(m,n[m],r);else{n=x(n);for(var w=0,O=n.length;w<O;w++)this._on(n[w],r,h)}return this},off:function(n,r,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var m in n)this._off(m,n[m],r);else{n=x(n);for(var w=arguments.length===1,O=0,ne=n.length;O<ne;O++)w?this._off(n[O]):this._off(n[O],r,h)}return this},_on:function(n,r,h,m){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,h)===!1){h===this&&(h=void 0);var w={fn:r,ctx:h};m&&(w.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(w)}},_off:function(n,r,h){var m,w,O;if(this._events&&(m=this._events[n],!!m)){if(arguments.length===1){if(this._firingCount)for(w=0,O=m.length;w<O;w++)m[w].fn=g;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var ne=this._listens(n,r,h);if(ne!==!1){var he=m[ne];this._firingCount&&(he.fn=g,this._events[n]=m=m.slice()),m.splice(ne,1)}}},fire:function(n,r,h){if(!this.listens(n,h))return this;var m=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var w=this._events[n];if(w){this._firingCount=this._firingCount+1||1;for(var O=0,ne=w.length;O<ne;O++){var he=w[O],ye=he.fn;he.once&&this.off(n,ye,he.ctx),ye.call(he.ctx||this,m)}this._firingCount--}}return h&&this._propagateEvent(m),this},listens:function(n,r,h,m){typeof n!="string"&&console.warn('"string" type argument expected');var w=r;typeof r!="function"&&(m=!!r,w=void 0,h=void 0);var O=this._events&&this._events[n];if(O&&O.length&&this._listens(n,w,h)!==!1)return!0;if(m){for(var ne in this._eventParents)if(this._eventParents[ne].listens(n,r,h,m))return!0}return!1},_listens:function(n,r,h){if(!this._events)return!1;var m=this._events[n]||[];if(!r)return!!m.length;h===this&&(h=void 0);for(var w=0,O=m.length;w<O;w++)if(m[w].fn===r&&m[w].ctx===h)return w;return!1},once:function(n,r,h){if(typeof n=="object")for(var m in n)this._on(m,n[m],r,!0);else{n=x(n);for(var w=0,O=n.length;w<O;w++)this._on(n[w],r,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};Ce.addEventListener=Ce.on,Ce.removeEventListener=Ce.clearAllEventListeners=Ce.off,Ce.addOneTimeEventListener=Ce.once,Ce.fireEvent=Ce.fire,Ce.hasEventListeners=Ce.listens;var pe=Te.extend(Ce);function me(n,r,h){this.x=h?Math.round(n):n,this.y=h?Math.round(r):r}var nt=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};me.prototype={clone:function(){return new me(this.x,this.y)},add:function(n){return this.clone()._add(Le(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(Le(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new me(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new me(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=nt(this.x),this.y=nt(this.y),this},distanceTo:function(n){n=Le(n);var r=n.x-this.x,h=n.y-this.y;return Math.sqrt(r*r+h*h)},equals:function(n){return n=Le(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=Le(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function Le(n,r,h){return n instanceof me?n:S(n)?new me(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new me(n.x,n.y):new me(n,r,h)}function Be(n,r){if(n)for(var h=r?[n,r]:n,m=0,w=h.length;m<w;m++)this.extend(h[m])}Be.prototype={extend:function(n){var r,h;if(!n)return this;if(n instanceof me||typeof n[0]=="number"||"x"in n)r=h=Le(n);else if(n=Ge(n),r=n.min,h=n.max,!r||!h)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=h.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return Le((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return Le(this.min.x,this.max.y)},getTopRight:function(){return Le(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,h;return typeof n[0]=="number"||n instanceof me?n=Le(n):n=Ge(n),n instanceof Be?(r=n.min,h=n.max):r=h=n,r.x>=this.min.x&&h.x<=this.max.x&&r.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Ge(n);var r=this.min,h=this.max,m=n.min,w=n.max,O=w.x>=r.x&&m.x<=h.x,ne=w.y>=r.y&&m.y<=h.y;return O&&ne},overlaps:function(n){n=Ge(n);var r=this.min,h=this.max,m=n.min,w=n.max,O=w.x>r.x&&m.x<h.x,ne=w.y>r.y&&m.y<h.y;return O&&ne},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,h=this.max,m=Math.abs(r.x-h.x)*n,w=Math.abs(r.y-h.y)*n;return Ge(Le(r.x-m,r.y-w),Le(h.x+m,h.y+w))},equals:function(n){return n?(n=Ge(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Ge(n,r){return!n||n instanceof Be?n:new Be(n,r)}function ue(n,r){if(n)for(var h=r?[n,r]:n,m=0,w=h.length;m<w;m++)this.extend(h[m])}ue.prototype={extend:function(n){var r=this._southWest,h=this._northEast,m,w;if(n instanceof Ee)m=n,w=n;else if(n instanceof ue){if(m=n._southWest,w=n._northEast,!m||!w)return this}else return n?this.extend(Me(n)||Pe(n)):this;return!r&&!h?(this._southWest=new Ee(m.lat,m.lng),this._northEast=new Ee(w.lat,w.lng)):(r.lat=Math.min(m.lat,r.lat),r.lng=Math.min(m.lng,r.lng),h.lat=Math.max(w.lat,h.lat),h.lng=Math.max(w.lng,h.lng)),this},pad:function(n){var r=this._southWest,h=this._northEast,m=Math.abs(r.lat-h.lat)*n,w=Math.abs(r.lng-h.lng)*n;return new ue(new Ee(r.lat-m,r.lng-w),new Ee(h.lat+m,h.lng+w))},getCenter:function(){return new Ee((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ee(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ee(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Ee||"lat"in n?n=Me(n):n=Pe(n);var r=this._southWest,h=this._northEast,m,w;return n instanceof ue?(m=n.getSouthWest(),w=n.getNorthEast()):m=w=n,m.lat>=r.lat&&w.lat<=h.lat&&m.lng>=r.lng&&w.lng<=h.lng},intersects:function(n){n=Pe(n);var r=this._southWest,h=this._northEast,m=n.getSouthWest(),w=n.getNorthEast(),O=w.lat>=r.lat&&m.lat<=h.lat,ne=w.lng>=r.lng&&m.lng<=h.lng;return O&&ne},overlaps:function(n){n=Pe(n);var r=this._southWest,h=this._northEast,m=n.getSouthWest(),w=n.getNorthEast(),O=w.lat>r.lat&&m.lat<h.lat,ne=w.lng>r.lng&&m.lng<h.lng;return O&&ne},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=Pe(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Pe(n,r){return n instanceof ue?n:new ue(n,r)}function Ee(n,r,h){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,h!==void 0&&(this.alt=+h)}Ee.prototype={equals:function(n,r){if(!n)return!1;n=Me(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+_(this.lat,n)+", "+_(this.lng,n)+")"},distanceTo:function(n){return ke.distance(this,Me(n))},wrap:function(){return ke.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,h=r/Math.cos(Math.PI/180*this.lat);return Pe([this.lat-r,this.lng-h],[this.lat+r,this.lng+h])},clone:function(){return new Ee(this.lat,this.lng,this.alt)}};function Me(n,r,h){return n instanceof Ee?n:S(n)&&typeof n[0]!="object"?n.length===3?new Ee(n[0],n[1],n[2]):n.length===2?new Ee(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Ee(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new Ee(n,r,h)}var de={latLngToPoint:function(n,r){var h=this.projection.project(n),m=this.scale(r);return this.transformation._transform(h,m)},pointToLatLng:function(n,r){var h=this.scale(r),m=this.transformation.untransform(n,h);return this.projection.unproject(m)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,h=this.scale(n),m=this.transformation.transform(r.min,h),w=this.transformation.transform(r.max,h);return new Be(m,w)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,m=n.alt;return new Ee(h,r,m)},wrapLatLngBounds:function(n){var r=n.getCenter(),h=this.wrapLatLng(r),m=r.lat-h.lat,w=r.lng-h.lng;if(m===0&&w===0)return n;var O=n.getSouthWest(),ne=n.getNorthEast(),he=new Ee(O.lat-m,O.lng-w),ye=new Ee(ne.lat-m,ne.lng-w);return new ue(he,ye)}},ke=s({},de,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var h=Math.PI/180,m=n.lat*h,w=r.lat*h,O=Math.sin((r.lat-n.lat)*h/2),ne=Math.sin((r.lng-n.lng)*h/2),he=O*O+Math.cos(m)*Math.cos(w)*ne*ne,ye=2*Math.atan2(Math.sqrt(he),Math.sqrt(1-he));return this.R*ye}}),H=6378137,Q={R:H,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,h=this.MAX_LATITUDE,m=Math.max(Math.min(h,n.lat),-h),w=Math.sin(m*r);return new me(this.R*n.lng*r,this.R*Math.log((1+w)/(1-w))/2)},unproject:function(n){var r=180/Math.PI;return new Ee((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=H*Math.PI;return new Be([-n,-n],[n,n])})()};function ie(n,r,h,m){if(S(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=h,this._d=m}ie.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new me((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function R(n,r,h,m){return new ie(n,r,h,m)}var W=s({},ke,{code:"EPSG:3857",projection:Q,transformation:(function(){var n=.5/(Math.PI*Q.R);return R(n,.5,-n,.5)})()}),oe=s({},W,{code:"EPSG:900913"});function Y(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function F(n,r){var h="",m,w,O,ne,he,ye;for(m=0,O=n.length;m<O;m++){for(he=n[m],w=0,ne=he.length;w<ne;w++)ye=he[w],h+=(w?"L":"M")+ye.x+" "+ye.y;h+=r?Je.svg?"z":"x":""}return h||"M0 0"}var N=document.documentElement.style,te="ActiveXObject"in window,ve=te&&!document.addEventListener,xe="msLaunchUri"in navigator&&!("documentMode"in document),we=Zt("webkit"),Ve=Zt("android"),$e=Zt("android 2")||Zt("android 3"),Ze=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),We=Ve&&Zt("Google")&&Ze<537&&!("AudioNode"in window),re=!!window.opera,se=!xe&&Zt("chrome"),J=Zt("gecko")&&!we&&!re&&!te,Ue=!se&&Zt("safari"),Qe=Zt("phantom"),ot="OTransition"in N,vt=navigator.platform.indexOf("Win")===0,Tt=te&&"transition"in N,Jt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!$e,gt="MozPerspective"in N,qt=!window.L_DISABLE_3D&&(Tt||Jt||gt)&&!ot&&!Qe,Dt=typeof orientation<"u"||Zt("mobile"),_t=Dt&&we,wt=Dt&&Jt,xt=!window.PointerEvent&&window.MSPointerEvent,mo=!!(window.PointerEvent||xt),so="ontouchstart"in window||!!window.TouchEvent,Ot=!window.L_NO_TOUCH&&(so||mo),In=Dt&&re,Ni=Dt&&J,sn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Bt=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,r),window.removeEventListener("testPassiveEventSupport",g,r)}catch{}return n})(),Ro=(function(){return!!document.createElement("canvas").getContext})(),Wt=!!(document.createElementNS&&Y("svg").createSVGRect),go=!!Wt&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),oi=!Wt&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),Bo=navigator.platform.indexOf("Mac")===0,No=navigator.platform.indexOf("Linux")===0;function Zt(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Je={ie:te,ielt9:ve,edge:xe,webkit:we,android:Ve,android23:$e,androidStock:We,opera:re,chrome:se,gecko:J,safari:Ue,phantom:Qe,opera12:ot,win:vt,ie3d:Tt,webkit3d:Jt,gecko3d:gt,any3d:qt,mobile:Dt,mobileWebkit:_t,mobileWebkit3d:wt,msPointer:xt,pointer:mo,touch:Ot,touchNative:so,mobileOpera:In,mobileGecko:Ni,retina:sn,passiveEvents:Bt,canvas:Ro,svg:Wt,vml:oi,inlineSvg:go,mac:Bo,linux:No},Tn=Je.msPointer?"MSPointerDown":"pointerdown",io=Je.msPointer?"MSPointerMove":"pointermove",Ps=Je.msPointer?"MSPointerUp":"pointerup",Hn=Je.msPointer?"MSPointerCancel":"pointercancel",Mn={touchstart:Tn,touchmove:io,touchend:Ps,touchcancel:Hn},An={touchstart:is,touchmove:mn,touchend:mn,touchcancel:mn},Vn={},Ds=!1;function Xt(n,r,h){return r==="touchstart"&&ii(),An[r]?(h=An[r].bind(this,h),n.addEventListener(Mn[r],h,!1),h):(console.warn("wrong event specified:",r),g)}function si(n,r,h){if(!Mn[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(Mn[r],h,!1)}function nn(n){Vn[n.pointerId]=n}function yo(n){Vn[n.pointerId]&&(Vn[n.pointerId]=n)}function Fo(n){delete Vn[n.pointerId]}function ii(){Ds||(document.addEventListener(Tn,nn,!0),document.addEventListener(io,yo,!0),document.addEventListener(Ps,Fo,!0),document.addEventListener(Hn,Fo,!0),Ds=!0)}function mn(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var h in Vn)r.touches.push(Vn[h]);r.changedTouches=[r],n(r)}}function is(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Ft(r),mn(n,r)}function Uo(n){var r={},h,m;for(m in n)h=n[m],r[m]=h&&h.bind?h.bind(n):h;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var zo=200;function En(n,r){n.addEventListener("dblclick",r);var h=0,m;function w(O){if(O.detail!==1){m=O.detail;return}if(!(O.pointerType==="mouse"||O.sourceCapabilities&&!O.sourceCapabilities.firesTouchEvents)){var ne=q(O);if(!(ne.some(function(ye){return ye instanceof HTMLLabelElement&&ye.attributes.for})&&!ne.some(function(ye){return ye instanceof HTMLInputElement||ye instanceof HTMLSelectElement}))){var he=Date.now();he-h<=zo?(m++,m===2&&r(Uo(O))):m=1,h=he}}}return n.addEventListener("click",w),{dblclick:r,simDblclick:w}}function Pn(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var _o=ao(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Gn=ao(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Os=Gn==="webkitTransition"||Gn==="OTransition"?Gn+"End":"transitionend";function ai(n){return typeof n=="string"?document.getElementById(n):n}function as(n,r){var h=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!h||h==="auto")&&document.defaultView){var m=document.defaultView.getComputedStyle(n,null);h=m?m[r]:null}return h==="auto"?null:h}function mt(n,r,h){var m=document.createElement(n);return m.className=r||"",h&&h.appendChild(m),m}function $t(n){var r=n.parentNode;r&&r.removeChild(n)}function Rs(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Dn(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function Ho(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function ri(n,r){if(n.classList!==void 0)return n.classList.contains(r);var h=Vo(n);return h.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(h)}function ct(n,r){if(n.classList!==void 0)for(var h=x(r),m=0,w=h.length;m<w;m++)n.classList.add(h[m]);else if(!ri(n,r)){var O=Vo(n);li(n,(O?O+" ":"")+r)}}function Et(n,r){n.classList!==void 0?n.classList.remove(r):li(n,b((" "+Vo(n)+" ").replace(" "+r+" "," ")))}function li(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function Vo(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function an(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&ci(n,r)}function ci(n,r){var h=!1,m="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(m)}catch{if(r===1)return}r=Math.round(r*100),h?(h.Enabled=r!==100,h.Opacity=r):n.style.filter+=" progid:"+m+"(opacity="+r+")"}function ao(n){for(var r=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in r)return n[h];return!1}function Nt(n,r,h){var m=r||new me(0,0);n.style[_o]=(Je.ie3d?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(h?" scale("+h+")":"")}function dt(n,r){n._leaflet_pos=r,Je.any3d?Nt(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function gn(n){return n._leaflet_pos||new me(0,0)}var Zn,ro,Bs;if("onselectstart"in document)Zn=function(){lt(window,"selectstart",Ft)},ro=function(){kt(window,"selectstart",Ft)};else{var rs=ao(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Zn=function(){if(rs){var n=document.documentElement.style;Bs=n[rs],n[rs]="none"}},ro=function(){rs&&(document.documentElement.style[rs]=Bs,Bs=void 0)}}function rn(){lt(window,"dragstart",Ft)}function jn(){kt(window,"dragstart",Ft)}var qn,Go;function Wn(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Kn(),qn=n,Go=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",Kn))}function Kn(){qn&&(qn.style.outlineStyle=Go,qn=void 0,Go=void 0,kt(window,"keydown",Kn))}function ls(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Ns(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var Fi={__proto__:null,TRANSFORM:_o,TRANSITION:Gn,TRANSITION_END:Os,get:ai,getStyle:as,create:mt,remove:$t,empty:Rs,toFront:Dn,toBack:Ho,hasClass:ri,addClass:ct,removeClass:Et,setClass:li,getClass:Vo,setOpacity:an,testProp:ao,setTransform:Nt,setPosition:dt,getPosition:gn,get disableTextSelection(){return Zn},get enableTextSelection(){return ro},disableImageDrag:rn,enableImageDrag:jn,preventOutline:Wn,restoreOutline:Kn,getSizedParentNode:ls,getScale:Ns};function lt(n,r,h,m){if(r&&typeof r=="object")for(var w in r)di(n,w,r[w],h);else{r=x(r);for(var O=0,ne=r.length;O<ne;O++)di(n,r[O],h,m)}return this}var yn="_leaflet_events";function kt(n,r,h,m){if(arguments.length===1)Zo(n),delete n[yn];else if(r&&typeof r=="object")for(var w in r)cs(n,w,r[w],h);else if(r=x(r),arguments.length===2)Zo(n,function(he){return A(r,he)!==-1});else for(var O=0,ne=r.length;O<ne;O++)cs(n,r[O],h,m);return this}function Zo(n,r){for(var h in n[yn]){var m=h.split(/\d/)[0];(!r||r(m))&&cs(n,m,null,null,h)}}var ui={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function di(n,r,h,m){var w=r+d(h)+(m?"_"+d(m):"");if(n[yn]&&n[yn][w])return this;var O=function(he){return h.call(m||n,he||window.event)},ne=O;!Je.touchNative&&Je.pointer&&r.indexOf("touch")===0?O=Xt(n,r,O):Je.touch&&r==="dblclick"?O=En(n,O):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(ui[r]||r,O,Je.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(O=function(he){he=he||window.event,ze(n,he)&&ne(he)},n.addEventListener(ui[r],O,!1)):n.addEventListener(r,ne,!1):n.attachEvent("on"+r,O),n[yn]=n[yn]||{},n[yn][w]=O}function cs(n,r,h,m,w){w=w||r+d(h)+(m?"_"+d(m):"");var O=n[yn]&&n[yn][w];if(!O)return this;!Je.touchNative&&Je.pointer&&r.indexOf("touch")===0?si(n,r,O):Je.touch&&r==="dblclick"?Pn(n,O):"removeEventListener"in n?n.removeEventListener(ui[r]||r,O,!1):n.detachEvent("on"+r,O),n[yn][w]=null}function ko(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function hi(n){return di(n,"wheel",ko),this}function Yn(n){return lt(n,"mousedown touchstart dblclick contextmenu",ko),n._leaflet_disable_click=!0,this}function Ft(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function bo(n){return Ft(n),ko(n),this}function q(n){if(n.composedPath)return n.composedPath();for(var r=[],h=n.target;h;)r.push(h),h=h.parentNode;return r}function Z(n,r){if(!r)return new me(n.clientX,n.clientY);var h=Ns(r),m=h.boundingClientRect;return new me((n.clientX-m.left)/h.x-r.clientLeft,(n.clientY-m.top)/h.y-r.clientTop)}var ee=Je.linux&&Je.chrome?window.devicePixelRatio:Je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Se(n){return Je.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/ee:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function ze(n,r){var h=r.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var at={__proto__:null,on:lt,off:kt,stopPropagation:ko,disableScrollPropagation:hi,disableClickPropagation:Yn,preventDefault:Ft,stop:bo,getPropagationPath:q,getMousePosition:Z,getWheelDelta:Se,isExternalTarget:ze,addListener:lt,removeListener:kt},Vt=pe.extend({run:function(n,r,h,m){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=gn(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=j(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,h=this._duration*1e3;r<h?this._runFrame(this._easeOut(r/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var h=this._startPos.add(this._offset.multiplyBy(n));r&&h._round(),dt(this._el,h),this.fire("step")},_complete:function(){X(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),st=pe.extend({options:{crs:W,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=$(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(Me(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Gn&&Je.any3d&&!Je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,Os,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,h){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter(Me(n),r,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var m=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,h.zoom):this._tryAnimatedPan(n,h.pan);if(m)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,h){var m=this.getZoomScale(r),w=this.getSize().divideBy(2),O=n instanceof me?n:this.latLngToContainerPoint(n),ne=O.subtract(w).multiplyBy(1-1/m),he=this.containerPointToLatLng(w.add(ne));return this.setView(he,r,{zoom:h})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():Pe(n);var h=Le(r.paddingTopLeft||r.padding||[0,0]),m=Le(r.paddingBottomRight||r.padding||[0,0]),w=this.getBoundsZoom(n,!1,h.add(m));if(w=typeof r.maxZoom=="number"?Math.min(r.maxZoom,w):w,w===1/0)return{center:n.getCenter(),zoom:w};var O=m.subtract(h).divideBy(2),ne=this.project(n.getSouthWest(),w),he=this.project(n.getNorthEast(),w),ye=this.unproject(ne.add(he).divideBy(2).add(O),w);return{center:ye,zoom:w}},fitBounds:function(n,r){if(n=Pe(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,r);return this.setView(h.center,h.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=Le(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Vt,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){ct(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,h){if(h=h||{},h.animate===!1||!Je.any3d)return this.setView(n,r,h);this._stop();var m=this.project(this.getCenter()),w=this.project(n),O=this.getSize(),ne=this._zoom;n=Me(n),r=r===void 0?ne:r;var he=Math.max(O.x,O.y),ye=he*this.getZoomScale(ne,r),De=w.distanceTo(m)||1,Ye=1.42,rt=Ye*Ye;function pt(jt){var Pr=jt?-1:1,Iv=jt?ye:he,Tv=ye*ye-he*he+Pr*rt*rt*De*De,Mv=2*Iv*rt*De,ic=Tv/Mv,td=Math.sqrt(ic*ic+1)-ic,Av=td<1e-9?-18:Math.log(td);return Av}function wn(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function Qt(jt){return(Math.exp(jt)+Math.exp(-jt))/2}function co(jt){return wn(jt)/Qt(jt)}var Bn=pt(0);function ji(jt){return he*(Qt(Bn)/Qt(Bn+Ye*jt))}function Lv(jt){return he*(Qt(Bn)*co(Bn+Ye*jt)-wn(Bn))/rt}function Sv(jt){return 1-Math.pow(1-jt,1.5)}var xv=Date.now(),Qu=(pt(1)-Bn)/Ye,$v=h.duration?1e3*h.duration:1e3*Qu*.8;function ed(){var jt=(Date.now()-xv)/$v,Pr=Sv(jt)*Qu;jt<=1?(this._flyToFrame=j(ed,this),this._move(this.unproject(m.add(w.subtract(m).multiplyBy(Lv(Pr)/De)),ne),this.getScaleZoom(he/ji(Pr),ne),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),ed.call(this),this},flyToBounds:function(n,r){var h=this._getBoundsCenterZoom(n,r);return this.flyTo(h.center,h.zoom,r)},setMaxBounds:function(n){return n=Pe(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var h=this.getCenter(),m=this._limitCenter(h,this._zoom,Pe(n));return h.equals(m)||this.panTo(m,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var h=Le(r.paddingTopLeft||r.padding||[0,0]),m=Le(r.paddingBottomRight||r.padding||[0,0]),w=this.project(this.getCenter()),O=this.project(n),ne=this.getPixelBounds(),he=Ge([ne.min.add(h),ne.max.subtract(m)]),ye=he.getSize();if(!he.contains(O)){this._enforcingBounds=!0;var De=O.subtract(he.getCenter()),Ye=he.extend(O).getSize().subtract(ye);w.x+=De.x<0?-Ye.x:Ye.x,w.y+=De.y<0?-Ye.y:Ye.y,this.panTo(this.unproject(w),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),m=r.divideBy(2).round(),w=h.divideBy(2).round(),O=m.subtract(w);return!O.x&&!O.y?this:(n.animate&&n.pan?this.panBy(O):(n.pan&&this._rawPanBy(O),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=c(this._handleGeolocationResponse,this),h=c(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,h,n):navigator.geolocation.getCurrentPosition(r,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,h=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,h=n.coords.longitude,m=new Ee(r,h),w=m.toBounds(n.coords.accuracy*2),O=this._locateOptions;if(O.setView){var ne=this.getBoundsZoom(w);this.setView(m,O.maxZoom?Math.min(ne,O.maxZoom):ne)}var he={latlng:m,bounds:w,timestamp:n.timestamp};for(var ye in n.coords)typeof n.coords[ye]=="number"&&(he[ye]=n.coords[ye]);this.fire("locationfound",he)}},addHandler:function(n,r){if(!r)return this;var h=this[n]=new r(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),$t(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(X(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)$t(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),m=mt("div",h,r||this._mapPane);return n&&(this._panes[n]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new ue(r,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,h){n=Pe(n),h=Le(h||[0,0]);var m=this.getZoom()||0,w=this.getMinZoom(),O=this.getMaxZoom(),ne=n.getNorthWest(),he=n.getSouthEast(),ye=this.getSize().subtract(h),De=Ge(this.project(he,m),this.project(ne,m)).getSize(),Ye=Je.any3d?this.options.zoomSnap:1,rt=ye.x/De.x,pt=ye.y/De.y,wn=r?Math.max(rt,pt):Math.min(rt,pt);return m=this.getScaleZoom(wn,m),Ye&&(m=Math.round(m/(Ye/100))*(Ye/100),m=r?Math.ceil(m/Ye)*Ye:Math.floor(m/Ye)*Ye),Math.max(w,Math.min(O,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new me(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var h=this._getTopLeftPoint(n,r);return new Be(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var h=this.options.crs;return r=r===void 0?this._zoom:r,h.scale(n)/h.scale(r)},getScaleZoom:function(n,r){var h=this.options.crs;r=r===void 0?this._zoom:r;var m=h.zoom(n*h.scale(r));return isNaN(m)?1/0:m},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(Me(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(Le(n),r)},layerPointToLatLng:function(n){var r=Le(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project(Me(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Me(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Pe(n))},distance:function(n,r){return this.options.crs.distance(Me(n),Me(r))},containerPointToLayerPoint:function(n){return Le(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return Le(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(Le(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Me(n)))},mouseEventToContainerPoint:function(n){return Z(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=ai(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(r,"scroll",this._onScroll,this),this._containerId=d(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Je.any3d,ct(n,"leaflet-container"+(Je.touch?" leaflet-touch":"")+(Je.retina?" leaflet-retina":"")+(Je.ielt9?" leaflet-oldie":"")+(Je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=as(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dt(this._mapPane,new me(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ct(n.markerPane,"leaflet-zoom-hide"),ct(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,h){dt(this._mapPane,new me(0,0));var m=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var w=this._zoom!==r;this._moveStart(w,h)._move(n,r)._moveEnd(w),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,h,m){r===void 0&&(r=this._zoom);var w=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),m?h&&h.pinch&&this.fire("zoom",h):((w||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return X(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){dt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var r=n?kt:lt;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),Je.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){X(this._resizeRequest),this._resizeRequest=j(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var h=[],m,w=r==="mouseout"||r==="mouseover",O=n.target||n.srcElement,ne=!1;O;){if(m=this._targets[d(O)],m&&(r==="click"||r==="preclick")&&this._draggableMoved(m)){ne=!0;break}if(m&&m.listens(r,!0)&&(w&&!ze(O,n)||(h.push(m),w))||O===this._container)break;O=O.parentNode}return!h.length&&!ne&&!w&&this.listens(r,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var h=n.type;h==="mousedown"&&Wn(r),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,h){if(n.type==="click"){var m=s({},n);m.type="preclick",this._fireDOMEvent(m,m.type,h)}var w=this._findEventTargets(n,r);if(h){for(var O=[],ne=0;ne<h.length;ne++)h[ne].listens(r,!0)&&O.push(h[ne]);w=O.concat(w)}if(w.length){r==="contextmenu"&&Ft(n);var he=w[0],ye={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var De=he.getLatLng&&(!he._radius||he._radius<=10);ye.containerPoint=De?this.latLngToContainerPoint(he.getLatLng()):this.mouseEventToContainerPoint(n),ye.layerPoint=this.containerPointToLayerPoint(ye.containerPoint),ye.latlng=De?he.getLatLng():this.layerPointToLatLng(ye.layerPoint)}for(ne=0;ne<w.length;ne++)if(w[ne].fire(r,ye,!0),ye.originalEvent._stopped||w[ne].options.bubblingMouseEvents===!1&&A(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return gn(this._mapPane)||new me(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var h=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var h=this.getSize()._divideBy(2);return this.project(n,r)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,h){var m=this._getNewPixelOrigin(h,r);return this.project(n,r)._subtract(m)},_latLngBoundsToNewLayerBounds:function(n,r,h){var m=this._getNewPixelOrigin(h,r);return Ge([this.project(n.getSouthWest(),r)._subtract(m),this.project(n.getNorthWest(),r)._subtract(m),this.project(n.getSouthEast(),r)._subtract(m),this.project(n.getNorthEast(),r)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,h){if(!h)return n;var m=this.project(n,r),w=this.getSize().divideBy(2),O=new Be(m.subtract(w),m.add(w)),ne=this._getBoundsOffset(O,h,r);return Math.abs(ne.x)<=1&&Math.abs(ne.y)<=1?n:this.unproject(m.add(ne),r)},_limitOffset:function(n,r){if(!r)return n;var h=this.getPixelBounds(),m=new Be(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(m,r))},_getBoundsOffset:function(n,r,h){var m=Ge(this.project(r.getNorthEast(),h),this.project(r.getSouthWest(),h)),w=m.min.subtract(n.min),O=m.max.subtract(n.max),ne=this._rebound(w.x,-O.x),he=this._rebound(w.y,-O.y);return new me(ne,he)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),h=this.getMaxZoom(),m=Je.any3d?this.options.zoomSnap:1;return m&&(n=Math.round(n/m)*m),Math.max(r,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Et(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var h=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,r),!0)},_createAnimProxy:function(){var n=this._proxy=mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var h=_o,m=this._proxy.style[h];Nt(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),m===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){$t(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();Nt(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(r),w=this._getCenterOffset(n)._divideBy(1-1/m);return h.animate!==!0&&!this.getSize().contains(w)?!1:(j(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,h,m){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:m}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Et(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function On(n,r){return new st(n,r)}var _n=Te.extend({options:{position:"topright"},initialize:function(n){$(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),h=this.getPosition(),m=n._controlCorners[h];return ct(r,"leaflet-control"),h.indexOf("bottom")!==-1?m.insertBefore(r,m.firstChild):m.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?($t(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),fi=function(n){return new _n(n)};st.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",h=this._controlContainer=mt("div",r+"control-container",this._container);function m(w,O){var ne=r+w+" "+r+O;n[w+O]=mt("div",ne,h)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)$t(this._controlCorners[n]);$t(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var mr=_n.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,h,m){return h<m?-1:m<h?1:0}},initialize:function(n,r,h){$(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var m in n)this._addLayer(n[m],m);for(m in r)this._addLayer(r[m],m,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return _n.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(d(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Et(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Et(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=mt("div",n),h=this.options.collapsed;r.setAttribute("aria-haspopup",!0),Yn(r),hi(r);var m=this._section=mt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),lt(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var w=this._layersLink=mt("a",n+"-toggle",r);w.href="#",w.title="Layers",w.setAttribute("role","button"),lt(w,{keydown:function(O){O.keyCode===13&&this._expandSafely()},click:function(O){Ft(O),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=mt("div",n+"-base",m),this._separator=mt("div",n+"-separator",m),this._overlaysList=mt("div",n+"-overlays",m),r.appendChild(m)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&d(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:h}),this.options.sortLayers&&this._layers.sort(c(function(m,w){return this.options.sortFunction(m.layer,w.layer,m.name,w.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Rs(this._baseLayersList),Rs(this._overlaysList),this._layerControlInputs=[];var n,r,h,m,w=0;for(h=0;h<this._layers.length;h++)m=this._layers[h],this._addItem(m),r=r||m.overlay,n=n||!m.overlay,w+=m.overlay?0:1;return this.options.hideSingleBase&&(n=n&&w>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(d(n.target)),h=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,r)},_createRadioElement:function(n,r){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=h,m.firstChild},_addItem:function(n){var r=document.createElement("label"),h=this._map.hasLayer(n.layer),m;n.overlay?(m=document.createElement("input"),m.type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=h):m=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(m),m.layerId=d(n.layer),lt(m,"click",this._onInputClick,this);var w=document.createElement("span");w.innerHTML=" "+n.name;var O=document.createElement("span");r.appendChild(O),O.appendChild(m),O.appendChild(w);var ne=n.overlay?this._overlaysList:this._baseLayersList;return ne.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,h,m=[],w=[];this._handlingClick=!0;for(var O=n.length-1;O>=0;O--)r=n[O],h=this._getLayer(r.layerId).layer,r.checked?m.push(h):r.checked||w.push(h);for(O=0;O<w.length;O++)this._map.hasLayer(w[O])&&this._map.removeLayer(w[O]);for(O=0;O<m.length;O++)this._map.hasLayer(m[O])||this._map.addLayer(m[O]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,h,m=this._map.getZoom(),w=n.length-1;w>=0;w--)r=n[w],h=this._getLayer(r.layerId).layer,r.disabled=h.options.minZoom!==void 0&&m<h.options.minZoom||h.options.maxZoom!==void 0&&m>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Ft),this.expand();var r=this;setTimeout(function(){kt(n,"click",Ft),r._preventClick=!1})}}),Vl=function(n,r,h){return new mr(n,r,h)},pi=_n.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",h=mt("div",r+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,r+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,r+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,h,m,w){var O=mt("a",h,m);return O.innerHTML=n,O.href="#",O.title=r,O.setAttribute("role","button"),O.setAttribute("aria-label",r),Yn(O),lt(O,"click",bo),lt(O,"click",w,this),lt(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";Et(this._zoomInButton,r),Et(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ct(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ct(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});st.mergeOptions({zoomControl:!0}),st.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new pi,this.addControl(this.zoomControl))});var Gl=function(n){return new pi(n)},gr=_n.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",h=mt("div",r),m=this.options;return this._addScales(m,r+"-line",h),n.on(m.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,h){n.metric&&(this._mScale=mt("div",r,h)),n.imperial&&(this._iScale=mt("div",r,h))},_update:function(){var n=this._map,r=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),h=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,h,r/n)},_updateImperial:function(n){var r=n*3.2808399,h,m,w;r>5280?(h=r/5280,m=this._getRoundNum(h),this._updateScale(this._iScale,m+" mi",m/h)):(w=this._getRoundNum(r),this._updateScale(this._iScale,w+" ft",w/r))},_updateScale:function(n,r,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),h=n/r;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,r*h}}),Zl=function(n){return new gr(n)},jl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ga=_n.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Je.inlineSvg?jl+" ":"")+"Leaflet</a>"},initialize:function(n){$(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=mt("div","leaflet-control-attribution"),Yn(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});st.mergeOptions({attributionControl:!0}),st.addInitHook(function(){this.options.attributionControl&&new ga().addTo(this)});var ya=function(n){return new ga(n)};_n.Layers=mr,_n.Zoom=pi,_n.Scale=gr,_n.Attribution=ga,fi.layers=Vl,fi.zoom=Gl,fi.scale=Zl,fi.attribution=ya;var lo=Te.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});lo.addTo=function(n,r){return n.addHandler(r,this),this};var yr={Events:Ce},_r=Je.touch?"touchstart mousedown":"mousedown",jo=pe.extend({options:{clickTolerance:3},initialize:function(n,r,h,m){$(this,m),this._element=n,this._dragStartTarget=r||n,this._preventOutline=h},enable:function(){this._enabled||(lt(this._dragStartTarget,_r,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(jo._dragging===this&&this.finishDrag(!0),kt(this._dragStartTarget,_r,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!ri(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){jo._dragging===this&&this.finishDrag();return}if(!(jo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(jo._dragging=this,this._preventOutline&&Wn(this._element),rn(),Zn(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,h=ls(this._element);this._startPoint=new me(r.clientX,r.clientY),this._startPos=gn(this._element),this._parentScale=Ns(h);var m=n.type==="mousedown";lt(document,m?"mousemove":"touchmove",this._onMove,this),lt(document,m?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,h=new me(r.clientX,r.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Ft(n),this._moved||(this.fire("dragstart"),this._moved=!0,ct(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),dt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Et(document.body,"leaflet-dragging"),this._lastTarget&&(Et(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),kt(document,"mousemove touchmove",this._onMove,this),kt(document,"mouseup touchend touchcancel",this._onUp,this),jn(),ro();var r=this._moved&&this._moving;this._moving=!1,jo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Ui(n,r,h){var m,w=[1,4,2,8],O,ne,he,ye,De,Ye,rt,pt;for(O=0,Ye=n.length;O<Ye;O++)n[O]._code=us(n[O],r);for(he=0;he<4;he++){for(rt=w[he],m=[],O=0,Ye=n.length,ne=Ye-1;O<Ye;ne=O++)ye=n[O],De=n[ne],ye._code&rt?De._code&rt||(pt=zi(De,ye,rt,r,h),pt._code=us(pt,r),m.push(pt)):(De._code&rt&&(pt=zi(De,ye,rt,r,h),pt._code=us(pt,r),m.push(pt)),m.push(ye));n=m}return n}function kr(n,r){var h,m,w,O,ne,he,ye,De,Ye;if(!n||n.length===0)throw new Error("latlngs not passed");Rn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var rt=Me([0,0]),pt=Pe(n),wn=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());wn<1700&&(rt=_a(n));var Qt=n.length,co=[];for(h=0;h<Qt;h++){var Bn=Me(n[h]);co.push(r.project(Me([Bn.lat-rt.lat,Bn.lng-rt.lng])))}for(he=ye=De=0,h=0,m=Qt-1;h<Qt;m=h++)w=co[h],O=co[m],ne=w.y*O.x-O.y*w.x,ye+=(w.x+O.x)*ne,De+=(w.y+O.y)*ne,he+=ne*3;he===0?Ye=co[0]:Ye=[ye/he,De/he];var ji=r.unproject(Le(Ye));return Me([ji.lat+rt.lat,ji.lng+rt.lng])}function _a(n){for(var r=0,h=0,m=0,w=0;w<n.length;w++){var O=Me(n[w]);r+=O.lat,h+=O.lng,m++}return Me([r/m,h/m])}var br={__proto__:null,clipPolygon:Ui,polygonCenter:kr,centroid:_a};function wr(n,r){if(!r||!n.length)return n.slice();var h=r*r;return n=Wl(n,h),n=Cr(n,h),n}function ka(n,r,h){return Math.sqrt(vi(n,r,h,!0))}function ql(n,r,h){return vi(n,r,h)}function Cr(n,r){var h=n.length,m=typeof Uint8Array<"u"?Uint8Array:Array,w=new m(h);w[0]=w[h-1]=1,ba(n,w,r,0,h-1);var O,ne=[];for(O=0;O<h;O++)w[O]&&ne.push(n[O]);return ne}function ba(n,r,h,m,w){var O=0,ne,he,ye;for(he=m+1;he<=w-1;he++)ye=vi(n[he],n[m],n[w],!0),ye>O&&(ne=he,O=ye);O>h&&(r[ne]=1,ba(n,r,h,m,ne),ba(n,r,h,ne,w))}function Wl(n,r){for(var h=[n[0]],m=1,w=0,O=n.length;m<O;m++)Kl(n[m],n[w])>r&&(h.push(n[m]),w=m);return w<O-1&&h.push(n[O-1]),h}var Lr;function Sr(n,r,h,m,w){var O=m?Lr:us(n,h),ne=us(r,h),he,ye,De;for(Lr=ne;;){if(!(O|ne))return[n,r];if(O&ne)return!1;he=O||ne,ye=zi(n,r,he,h,w),De=us(ye,h),he===O?(n=ye,O=De):(r=ye,ne=De)}}function zi(n,r,h,m,w){var O=r.x-n.x,ne=r.y-n.y,he=m.min,ye=m.max,De,Ye;return h&8?(De=n.x+O*(ye.y-n.y)/ne,Ye=ye.y):h&4?(De=n.x+O*(he.y-n.y)/ne,Ye=he.y):h&2?(De=ye.x,Ye=n.y+ne*(ye.x-n.x)/O):h&1&&(De=he.x,Ye=n.y+ne*(he.x-n.x)/O),new me(De,Ye,w)}function us(n,r){var h=0;return n.x<r.min.x?h|=1:n.x>r.max.x&&(h|=2),n.y<r.min.y?h|=4:n.y>r.max.y&&(h|=8),h}function Kl(n,r){var h=r.x-n.x,m=r.y-n.y;return h*h+m*m}function vi(n,r,h,m){var w=r.x,O=r.y,ne=h.x-w,he=h.y-O,ye=ne*ne+he*he,De;return ye>0&&(De=((n.x-w)*ne+(n.y-O)*he)/ye,De>1?(w=h.x,O=h.y):De>0&&(w+=ne*De,O+=he*De)),ne=n.x-w,he=n.y-O,m?ne*ne+he*he:new me(w,O)}function Rn(n){return!S(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function xr(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Rn(n)}function $r(n,r){var h,m,w,O,ne,he,ye,De;if(!n||n.length===0)throw new Error("latlngs not passed");Rn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ye=Me([0,0]),rt=Pe(n),pt=rt.getNorthWest().distanceTo(rt.getSouthWest())*rt.getNorthEast().distanceTo(rt.getNorthWest());pt<1700&&(Ye=_a(n));var wn=n.length,Qt=[];for(h=0;h<wn;h++){var co=Me(n[h]);Qt.push(r.project(Me([co.lat-Ye.lat,co.lng-Ye.lng])))}for(h=0,m=0;h<wn-1;h++)m+=Qt[h].distanceTo(Qt[h+1])/2;if(m===0)De=Qt[0];else for(h=0,O=0;h<wn-1;h++)if(ne=Qt[h],he=Qt[h+1],w=ne.distanceTo(he),O+=w,O>m){ye=(O-m)/w,De=[he.x-ye*(he.x-ne.x),he.y-ye*(he.y-ne.y)];break}var Bn=r.unproject(Le(De));return Me([Bn.lat+Ye.lat,Bn.lng+Ye.lng])}var Yl={__proto__:null,simplify:wr,pointToSegmentDistance:ka,closestPointOnSegment:ql,clipSegment:Sr,_getEdgeIntersection:zi,_getBitCode:us,_sqClosestPointOnSegment:vi,isFlat:Rn,_flat:xr,polylineCenter:$r},Fs={project:function(n){return new me(n.lng,n.lat)},unproject:function(n){return new Ee(n.y,n.x)},bounds:new Be([-180,-90],[180,90])},wa={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,h=this.R,m=n.lat*r,w=this.R_MINOR/h,O=Math.sqrt(1-w*w),ne=O*Math.sin(m),he=Math.tan(Math.PI/4-m/2)/Math.pow((1-ne)/(1+ne),O/2);return m=-h*Math.log(Math.max(he,1e-10)),new me(n.lng*r*h,m)},unproject:function(n){for(var r=180/Math.PI,h=this.R,m=this.R_MINOR/h,w=Math.sqrt(1-m*m),O=Math.exp(-n.y/h),ne=Math.PI/2-2*Math.atan(O),he=0,ye=.1,De;he<15&&Math.abs(ye)>1e-7;he++)De=w*Math.sin(ne),De=Math.pow((1-De)/(1+De),w/2),ye=Math.PI/2-2*Math.atan(O*De)-ne,ne+=ye;return new Ee(ne*r,n.x*r/h)}},Hi={__proto__:null,LonLat:Fs,Mercator:wa,SphericalMercator:Q},Jl=s({},ke,{code:"EPSG:3395",projection:wa,transformation:(function(){var n=.5/(Math.PI*wa.R);return R(n,.5,-n,.5)})()}),Ca=s({},ke,{code:"EPSG:4326",projection:Fs,transformation:R(1/180,1,-1/180,.5)}),La=s({},de,{projection:Fs,transformation:R(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var h=r.lng-n.lng,m=r.lat-n.lat;return Math.sqrt(h*h+m*m)},infinite:!0});de.Earth=ke,de.EPSG3395=Jl,de.EPSG3857=W,de.EPSG900913=oe,de.EPSG4326=Ca,de.Simple=La;var kn=pe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var h=this.getEvents();r.on(h,this),this.once("remove",function(){r.off(h,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});st.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=d(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=d(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},_addLayers:function(n){n=n?S(n)?n:[n]:[];for(var r=0,h=n.length;r<h;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=d(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,h=this._getZoomSpan();for(var m in this._zoomBoundLayers){var w=this._zoomBoundLayers[m].options;n=w.minZoom===void 0?n:Math.min(n,w.minZoom),r=w.maxZoom===void 0?r:Math.max(r,w.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Us=kn.extend({initialize:function(n,r){$(this,r),this._layers={};var h,m;if(n)for(h=0,m=n.length;h<m;h++)this.addLayer(n[h])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),h,m;for(h in this._layers)m=this._layers[h],m[n]&&m[n].apply(m,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),Xl=function(n,r){return new Us(n,r)},wo=Us.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Us.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Us.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new ue;for(var r in this._layers){var h=this._layers[r];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),Ql=function(n,r){return new wo(n,r)},zs=Te.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){$(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(h,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(m,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),m},_setIconStyles:function(n,r){var h=this.options,m=h[r+"Size"];typeof m=="number"&&(m=[m,m]);var w=Le(m),O=Le(r==="shadow"&&h.shadowAnchor||h.iconAnchor||w&&w.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(h.className||""),O&&(n.style.marginLeft=-O.x+"px",n.style.marginTop=-O.y+"px"),w&&(n.style.width=w.x+"px",n.style.height=w.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return Je.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function ec(n){return new zs(n)}var mi=zs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof mi.imagePath!="string"&&(mi.imagePath=this._detectIconPath()),(this.options.imagePath||mi.imagePath)+zs.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(h,m,w){var O=m.exec(h);return O&&O[w]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=mt("div","leaflet-default-icon-path",document.body),r=as(n,"background-image")||as(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Ir=lo.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new jo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ct(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Et(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,h=r._map,m=this._marker.options.autoPanSpeed,w=this._marker.options.autoPanPadding,O=gn(r._icon),ne=h.getPixelBounds(),he=h.getPixelOrigin(),ye=Ge(ne.min._subtract(he).add(w),ne.max._subtract(he).subtract(w));if(!ye.contains(O)){var De=Le((Math.max(ye.max.x,O.x)-ye.max.x)/(ne.max.x-ye.max.x)-(Math.min(ye.min.x,O.x)-ye.min.x)/(ne.min.x-ye.min.x),(Math.max(ye.max.y,O.y)-ye.max.y)/(ne.max.y-ye.max.y)-(Math.min(ye.min.y,O.y)-ye.min.y)/(ne.min.y-ye.min.y)).multiplyBy(m);h.panBy(De,{animate:!1}),this._draggable._newPos._add(De),this._draggable._startPos._add(De),dt(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=j(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(X(this._panRequest),this._panRequest=j(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,h=r._shadow,m=gn(r._icon),w=r._map.layerPointToLatLng(m);h&&dt(h,m),r._latlng=w,n.latlng=w,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){X(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Vi=kn.extend({options:{icon:new mi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){$(this,r),this._latlng=Me(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=Me(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),m=!1;h!==this._icon&&(this._icon&&this._removeIcon(),m=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ct(h,r),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(h,"focus",this._panOnFocus,this);var w=n.icon.createShadow(this._shadow),O=!1;w!==this._shadow&&(this._removeShadow(),O=!0),w&&(ct(w,r),w.alt=""),this._shadow=w,n.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),w&&O&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&kt(this._icon,"focus",this._panOnFocus,this),$t(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&$t(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&dt(this._icon,n),this._shadow&&dt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ir)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ir(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&an(this._icon,n),this._shadow&&an(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,h=r.iconSize?Le(r.iconSize):Le(0,0),m=r.iconAnchor?Le(r.iconAnchor):Le(0,0);n.panInside(this._latlng,{paddingTopLeft:m,paddingBottomRight:h.subtract(m)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Tr(n,r){return new Vi(n,r)}var qo=kn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return $(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),gi=qo.extend({options:{fill:!0,radius:10},initialize:function(n,r){$(this,r),this._latlng=Me(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=Me(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return qo.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,h=this._clickTolerance(),m=[n+h,r+h];this._pxBounds=new Be(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function tc(n,r){return new gi(n,r)}var Sa=gi.extend({initialize:function(n,r,h){if(typeof r=="number"&&(r=s({},h,{radius:r})),$(this,r),this._latlng=Me(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new ue(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:qo.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,h=this._map,m=h.options.crs;if(m.distance===ke.distance){var w=Math.PI/180,O=this._mRadius/ke.R/w,ne=h.project([r+O,n]),he=h.project([r-O,n]),ye=ne.add(he).divideBy(2),De=h.unproject(ye).lat,Ye=Math.acos((Math.cos(O*w)-Math.sin(r*w)*Math.sin(De*w))/(Math.cos(r*w)*Math.cos(De*w)))/w;(isNaN(Ye)||Ye===0)&&(Ye=O/Math.cos(Math.PI/180*r)),this._point=ye.subtract(h.getPixelOrigin()),this._radius=isNaN(Ye)?0:ye.x-h.project([De,n-Ye]).x,this._radiusY=ye.y-ne.y}else{var rt=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(rt).x}this._updateBounds()}});function nc(n,r,h){return new Sa(n,r,h)}var Jn=qo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){$(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,h=null,m=vi,w,O,ne=0,he=this._parts.length;ne<he;ne++)for(var ye=this._parts[ne],De=1,Ye=ye.length;De<Ye;De++){w=ye[De-1],O=ye[De];var rt=m(n,w,O,!0);rt<r&&(r=rt,h=m(n,w,O))}return h&&(h.distance=Math.sqrt(r)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return $r(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=Me(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new ue,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Rn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],h=Rn(n),m=0,w=n.length;m<w;m++)h?(r[m]=Me(n[m]),this._bounds.extend(r[m])):r[m]=this._convertLatLngs(n[m]);return r},_project:function(){var n=new Be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new me(n,n);this._rawPxBounds&&(this._pxBounds=new Be([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,h){var m=n[0]instanceof Ee,w=n.length,O,ne;if(m){for(ne=[],O=0;O<w;O++)ne[O]=this._map.latLngToLayerPoint(n[O]),h.extend(ne[O]);r.push(ne)}else for(O=0;O<w;O++)this._projectLatlngs(n[O],r,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,h,m,w,O,ne,he,ye;for(h=0,w=0,O=this._rings.length;h<O;h++)for(ye=this._rings[h],m=0,ne=ye.length;m<ne-1;m++)he=Sr(ye[m],ye[m+1],n,m,!0),he&&(r[w]=r[w]||[],r[w].push(he[0]),(he[1]!==ye[m+1]||m===ne-2)&&(r[w].push(he[1]),w++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,h=0,m=n.length;h<m;h++)n[h]=wr(n[h],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var h,m,w,O,ne,he,ye=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,O=this._parts.length;h<O;h++)for(he=this._parts[h],m=0,ne=he.length,w=ne-1;m<ne;w=m++)if(!(!r&&m===0)&&ka(n,he[w],he[m])<=ye)return!0;return!1}});function oc(n,r){return new Jn(n,r)}Jn._flat=xr;var ds=Jn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return kr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=Jn.prototype._convertLatLngs.call(this,n),h=r.length;return h>=2&&r[0]instanceof Ee&&r[0].equals(r[h-1])&&r.pop(),r},_setLatLngs:function(n){Jn.prototype._setLatLngs.call(this,n),Rn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Rn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,h=new me(r,r);if(n=new Be(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var m=0,w=this._rings.length,O;m<w;m++)O=Ui(this._rings[m],n,!0),O.length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,h,m,w,O,ne,he,ye,De;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(O=0,ye=this._parts.length;O<ye;O++)for(h=this._parts[O],ne=0,De=h.length,he=De-1;ne<De;he=ne++)m=h[ne],w=h[he],m.y>n.y!=w.y>n.y&&n.x<(w.x-m.x)*(n.y-m.y)/(w.y-m.y)+m.x&&(r=!r);return r||Jn.prototype._containsPoint.call(this,n,!0)}});function sc(n,r){return new ds(n,r)}var Co=wo.extend({initialize:function(n,r){$(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=S(n)?n:n.features,h,m,w;if(r){for(h=0,m=r.length;h<m;h++)w=r[h],(w.geometries||w.geometry||w.features||w.coordinates)&&this.addData(w);return this}var O=this.options;if(O.filter&&!O.filter(n))return this;var ne=Wo(n,O);return ne?(ne.feature=Ie(n),ne.defaultOptions=ne.options,this.resetStyle(ne),O.onEachFeature&&O.onEachFeature(n,ne),this.addLayer(ne)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function Wo(n,r){var h=n.type==="Feature"?n.geometry:n,m=h?h.coordinates:null,w=[],O=r&&r.pointToLayer,ne=r&&r.coordsToLatLng||Gi,he,ye,De,Ye;if(!m&&!h)return null;switch(h.type){case"Point":return he=ne(m),xa(O,n,he,r);case"MultiPoint":for(De=0,Ye=m.length;De<Ye;De++)he=ne(m[De]),w.push(xa(O,n,he,r));return new wo(w);case"LineString":case"MultiLineString":return ye=yi(m,h.type==="LineString"?0:1,ne),new Jn(ye,r);case"Polygon":case"MultiPolygon":return ye=yi(m,h.type==="Polygon"?1:2,ne),new ds(ye,r);case"GeometryCollection":for(De=0,Ye=h.geometries.length;De<Ye;De++){var rt=Wo({geometry:h.geometries[De],type:"Feature",properties:n.properties},r);rt&&w.push(rt)}return new wo(w);case"FeatureCollection":for(De=0,Ye=h.features.length;De<Ye;De++){var pt=Wo(h.features[De],r);pt&&w.push(pt)}return new wo(w);default:throw new Error("Invalid GeoJSON object.")}}function xa(n,r,h,m){return n?n(r,h):new Vi(h,m&&m.markersInheritOptions&&m)}function Gi(n){return new Ee(n[1],n[0],n[2])}function yi(n,r,h){for(var m=[],w=0,O=n.length,ne;w<O;w++)ne=r?yi(n[w],r-1,h):(h||Gi)(n[w]),m.push(ne);return m}function U(n,r){return n=Me(n),n.alt!==void 0?[_(n.lng,r),_(n.lat,r),_(n.alt,r)]:[_(n.lng,r),_(n.lat,r)]}function le(n,r,h,m){for(var w=[],O=0,ne=n.length;O<ne;O++)w.push(r?le(n[O],Rn(n[O])?0:r-1,h,m):U(n[O],m));return!r&&h&&w.length>0&&w.push(w[0].slice()),w}function ge(n,r){return n.feature?s({},n.feature,{geometry:r}):Ie(r)}function Ie(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var yt={toGeoJSON:function(n){return ge(this,{type:"Point",coordinates:U(this.getLatLng(),n)})}};Vi.include(yt),Sa.include(yt),gi.include(yt),Jn.include({toGeoJSON:function(n){var r=!Rn(this._latlngs),h=le(this._latlngs,r?1:0,!1,n);return ge(this,{type:(r?"Multi":"")+"LineString",coordinates:h})}}),ds.include({toGeoJSON:function(n){var r=!Rn(this._latlngs),h=r&&!Rn(this._latlngs[0]),m=le(this._latlngs,h?2:r?1:0,!0,n);return r||(m=[m]),ge(this,{type:(h?"Multi":"")+"Polygon",coordinates:m})}}),Us.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(h){r.push(h.toGeoJSON(n).geometry.coordinates)}),ge(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var h=r==="GeometryCollection",m=[];return this.eachLayer(function(w){if(w.toGeoJSON){var O=w.toGeoJSON(n);if(h)m.push(O.geometry);else{var ne=Ie(O);ne.type==="FeatureCollection"?m.push.apply(m,ne.features):m.push(ne)}}}),h?ge(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});function bn(n,r){return new Co(n,r)}var Lo=bn,Ko=kn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,h){this._url=n,this._bounds=Pe(r),$(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){$t(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Dn(this._image),this},bringToBack:function(){return this._map&&Ho(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Pe(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:mt("img");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onload=c(this.fire,this,"load"),r.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Nt(this._image,h,r)},_reset:function(){var n=this._image,r=new Be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=r.getSize();dt(n,r.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){an(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),hv=function(n,r,h){return new Ko(n,r,h)},Bu=Ko.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:mt("video");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onloadeddata=c(this.fire,this,"load"),n){for(var h=r.getElementsByTagName("source"),m=[],w=0;w<h.length;w++)m.push(h[w].src);this._url=h.length>0?m:[r.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var O=0;O<this._url.length;O++){var ne=mt("source");ne.src=this._url[O],r.appendChild(ne)}}});function fv(n,r,h){return new Bu(n,r,h)}var Nu=Ko.extend({_initImage:function(){var n=this._image=this._url;ct(n,"leaflet-image-layer"),this._zoomAnimated&&ct(n,"leaflet-zoom-animated"),this.options.className&&ct(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function pv(n,r,h){return new Nu(n,r,h)}var Yo=kn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof Ee||S(n))?(this._latlng=Me(n),$(this,r)):($(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&an(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&an(this._container,1),this.bringToFront(),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(an(this._container,0),this._removeTimeout=setTimeout(c($t,void 0,this._container),200)):$t(this._container),this.options.interactive&&(Et(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Me(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Dn(this._container),this},bringToBack:function(){return this._map&&Ho(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof wo){r=null;var h=this._source._layers;for(var m in h)if(h[m]._map){r=h[m];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=Le(this.options.offset),h=this._getAnchor();this._zoomAnimated?dt(this._container,n.add(h)):r=r.add(n).add(h);var m=this._containerBottom=-r.y,w=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=m+"px",this._container.style.left=w+"px"}},_getAnchor:function(){return[0,0]}});st.include({_initOverlay:function(n,r,h,m){var w=r;return w instanceof n||(w=new n(m).setContent(r)),h&&w.setLatLng(h),w}}),kn.include({_initOverlay:function(n,r,h,m){var w=h;return w instanceof n?($(w,m),w._source=this):(w=r&&!m?r:new n(m,this),w.setContent(h)),w}});var Mr=Yo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Yo.prototype.openOn.call(this,n)},onAdd:function(n){Yo.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof qo||this._source.on("preclick",ko))},onRemove:function(n){Yo.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof qo||this._source.off("preclick",ko))},getEvents:function(){var n=Yo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=mt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=mt("div",n+"-content-wrapper",r);if(this._contentNode=mt("div",n+"-content",h),Yn(r),hi(this._contentNode),lt(r,"contextmenu",ko),this._tipContainer=mt("div",n+"-tip-container",r),this._tip=mt("div",n+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=mt("a",n+"-close-button",r);m.setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',lt(m,"click",function(w){Ft(w),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),r.width=h+1+"px",r.whiteSpace="",r.height="";var m=n.offsetHeight,w=this.options.maxHeight,O="leaflet-popup-scrolled";w&&m>w?(r.height=w+"px",ct(n,O)):Et(n,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();dt(this._container,r.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(as(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+r,m=this._containerWidth,w=new me(this._containerLeft,-h-this._containerBottom);w._add(gn(this._container));var O=n.layerPointToContainerPoint(w),ne=Le(this.options.autoPanPadding),he=Le(this.options.autoPanPaddingTopLeft||ne),ye=Le(this.options.autoPanPaddingBottomRight||ne),De=n.getSize(),Ye=0,rt=0;O.x+m+ye.x>De.x&&(Ye=O.x+m-De.x+ye.x),O.x-Ye-he.x<0&&(Ye=O.x-he.x),O.y+h+ye.y>De.y&&(rt=O.y+h-De.y+ye.y),O.y-rt-he.y<0&&(rt=O.y-he.y),(Ye||rt)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Ye,rt]))}},_getAnchor:function(){return Le(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),vv=function(n,r){return new Mr(n,r)};st.mergeOptions({closePopupOnClick:!0}),st.include({openPopup:function(n,r,h){return this._initOverlay(Mr,n,r,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),kn.include({bindPopup:function(n,r){return this._popup=this._initOverlay(Mr,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof wo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){bo(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof qo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Ar=Yo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Yo.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Yo.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Yo.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mt("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,h,m=this._map,w=this._container,O=m.latLngToContainerPoint(m.getCenter()),ne=m.layerPointToContainerPoint(n),he=this.options.direction,ye=w.offsetWidth,De=w.offsetHeight,Ye=Le(this.options.offset),rt=this._getAnchor();he==="top"?(r=ye/2,h=De):he==="bottom"?(r=ye/2,h=0):he==="center"?(r=ye/2,h=De/2):he==="right"?(r=0,h=De/2):he==="left"?(r=ye,h=De/2):ne.x<O.x?(he="right",r=0,h=De/2):(he="left",r=ye+(Ye.x+rt.x)*2,h=De/2),n=n.subtract(Le(r,h,!0)).add(Ye).add(rt),Et(w,"leaflet-tooltip-right"),Et(w,"leaflet-tooltip-left"),Et(w,"leaflet-tooltip-top"),Et(w,"leaflet-tooltip-bottom"),ct(w,"leaflet-tooltip-"+he),dt(w,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&an(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return Le(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),mv=function(n,r){return new Ar(n,r)};st.include({openTooltip:function(n,r,h){return this._initOverlay(Ar,n,r,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),kn.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ar,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[r](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof wo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(lt(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,h,m;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),m=this._map.containerPointToLayerPoint(h),r=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(r)}});var Fu=zs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Rs(r),r.appendChild(h.html)):r.innerHTML=h.html!==!1?h.html:"",h.bgPos){var m=Le(h.bgPos);r.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function gv(n){return new Fu(n)}zs.Default=mi;var $a=kn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){$(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),$t(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Dn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ho(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof me?n:new me(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,h=-n(-1/0,1/0),m=0,w=r.length,O;m<w;m++)O=r[m].style.zIndex,r[m]!==this._container&&O&&(h=n(h,+O));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Je.ielt9){an(this._container,this.options.opacity);var n=+new Date,r=!1,h=!1;for(var m in this._tiles){var w=this._tiles[m];if(!(!w.current||!w.loaded)){var O=Math.min(1,(n-w.loaded)/200);an(w.el,O),O<1?r=!0:(w.active?h=!0:this._onOpaqueTile(w),w.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),r&&(X(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=r-Math.abs(n-h),this._onUpdateLevel(h)):($t(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var m=this._levels[n],w=this._map;return m||(m=this._levels[n]={},m.el=mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=r,m.origin=w.project(w.unproject(w.getPixelOrigin()),n).round(),m.zoom=n,this._setZoomTransform(m,w.getCenter(),w.getZoom()),g(m.el.offsetWidth),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,r,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var m=r.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)$t(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,h,m){var w=Math.floor(n/2),O=Math.floor(r/2),ne=h-1,he=new me(+w,+O);he.z=+ne;var ye=this._tileCoordsToKey(he),De=this._tiles[ye];return De&&De.active?(De.retain=!0,!0):(De&&De.loaded&&(De.retain=!0),ne>m?this._retainParent(w,O,ne,m):!1)},_retainChildren:function(n,r,h,m){for(var w=2*n;w<2*n+2;w++)for(var O=2*r;O<2*r+2;O++){var ne=new me(w,O);ne.z=h+1;var he=this._tileCoordsToKey(ne),ye=this._tiles[he];if(ye&&ye.active){ye.retain=!0;continue}else ye&&ye.loaded&&(ye.retain=!0);h+1<m&&this._retainChildren(w,O,h+1,m)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,h,m){var w=Math.round(r);this.options.maxZoom!==void 0&&w>this.options.maxZoom||this.options.minZoom!==void 0&&w<this.options.minZoom?w=void 0:w=this._clampZoom(w);var O=this.options.updateWhenZooming&&w!==this._tileZoom;(!m||O)&&(this._tileZoom=w,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),w!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,r)},_setZoomTransform:function(n,r,h){var m=this._map.getZoomScale(h,n.zoom),w=n.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(r,h)).round();Je.any3d?Nt(n.el,w,m):dt(n.el,w)},_resetGrid:function(){var n=this._map,r=n.options.crs,h=this._tileSize=this.getTileSize(),m=this._tileZoom,w=this._map.getPixelWorldBounds(this._tileZoom);w&&(this._globalTileRange=this._pxBoundsToTileRange(w)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],m).x/h.x),Math.ceil(n.project([0,r.wrapLng[1]],m).x/h.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],m).y/h.x),Math.ceil(n.project([r.wrapLat[1],0],m).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,h=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),m=r.getZoomScale(h,this._tileZoom),w=r.project(n,this._tileZoom).floor(),O=r.getSize().divideBy(m*2);return new Be(w.subtract(O),w.add(O))},_update:function(n){var r=this._map;if(r){var h=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var m=this._getTiledPixelBounds(n),w=this._pxBoundsToTileRange(m),O=w.getCenter(),ne=[],he=this.options.keepBuffer,ye=new Be(w.getBottomLeft().subtract([he,-he]),w.getTopRight().add([he,-he]));if(!(isFinite(w.min.x)&&isFinite(w.min.y)&&isFinite(w.max.x)&&isFinite(w.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var De in this._tiles){var Ye=this._tiles[De].coords;(Ye.z!==this._tileZoom||!ye.contains(new me(Ye.x,Ye.y)))&&(this._tiles[De].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var rt=w.min.y;rt<=w.max.y;rt++)for(var pt=w.min.x;pt<=w.max.x;pt++){var wn=new me(pt,rt);if(wn.z=this._tileZoom,!!this._isValidTile(wn)){var Qt=this._tiles[this._tileCoordsToKey(wn)];Qt?Qt.current=!0:ne.push(wn)}}if(ne.sort(function(Bn,ji){return Bn.distanceTo(O)-ji.distanceTo(O)}),ne.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var co=document.createDocumentFragment();for(pt=0;pt<ne.length;pt++)this._addTile(ne[pt],co);this._level.el.appendChild(co)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var h=this._globalTileRange;if(!r.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!r.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(n);return Pe(this.options.bounds).overlaps(m)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,h=this.getTileSize(),m=n.scaleBy(h),w=m.add(h),O=r.unproject(m,n.z),ne=r.unproject(w,n.z);return[O,ne]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),h=new ue(r[0],r[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),h=new me(+r[0],+r[1]);return h.z=+r[2],h},_removeTile:function(n){var r=this._tiles[n];r&&($t(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ct(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=g,n.onmousemove=g,Je.ielt9&&this.options.opacity<1&&an(n,this.options.opacity)},_addTile:function(n,r){var h=this._getTilePos(n),m=this._tileCoordsToKey(n),w=this.createTile(this._wrapCoords(n),c(this._tileReady,this,n));this._initTile(w),this.createTile.length<2&&j(c(this._tileReady,this,n,null,w)),dt(w,h),this._tiles[m]={el:w,coords:n,current:!0},r.appendChild(w),this.fire("tileloadstart",{tile:w,coords:n})},_tileReady:function(n,r,h){r&&this.fire("tileerror",{error:r,tile:h,coords:n});var m=this._tileCoordsToKey(n);h=this._tiles[m],h&&(h.loaded=+new Date,this._map._fadeAnimated?(an(h.el,0),X(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),r||(ct(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Je.ielt9||!this._map._fadeAnimated?j(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new me(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new Be(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function yv(n){return new $a(n)}var Zi=$a.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=$(this,r),r.detectRetina&&Je.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var h=document.createElement("img");return lt(h,"load",c(this._tileOnLoad,this,r,h)),lt(h,"error",c(this._tileOnError,this,r,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var r={r:Je.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=h),r["-y"]=h}return M(this._url,s(r,this.options))},_tileOnLoad:function(n,r){Je.ielt9?setTimeout(c(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,h){var m=this.options.errorTileUrl;m&&r.getAttribute("src")!==m&&(r.src=m),n(h,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,h=this.options.zoomReverse,m=this.options.zoomOffset;return h&&(n=r-n),n+m},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=g,r.onerror=g,!r.complete)){r.src=I;var h=this._tiles[n].coords;$t(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:h})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",I),$a.prototype._removeTile.call(this,n)},_tileReady:function(n,r,h){if(!(!this._map||h&&h.getAttribute("src")===I))return $a.prototype._tileReady.call(this,n,r,h)}});function Uu(n,r){return new Zi(n,r)}var zu=Zi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var h=s({},this.defaultWmsParams);for(var m in r)m in this.options||(h[m]=r[m]);r=$(this,r);var w=r.detectRetina&&Je.retina?2:1,O=this.getTileSize();h.width=O.x*w,h.height=O.y*w,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,Zi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),h=this._crs,m=Ge(h.project(r[0]),h.project(r[1])),w=m.min,O=m.max,ne=(this._wmsVersion>=1.3&&this._crs===Ca?[w.y,w.x,O.y,O.x]:[w.x,w.y,O.x,O.y]).join(","),he=Zi.prototype.getTileUrl.call(this,n);return he+B(this.wmsParams,he,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ne},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function _v(n,r){return new zu(n,r)}Zi.WMS=zu,Uu.wms=_v;var hs=kn.extend({options:{padding:.1},initialize:function(n){$(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var h=this._map.getZoomScale(r,this._zoom),m=this._map.getSize().multiplyBy(.5+this.options.padding),w=this._map.project(this._center,r),O=m.multiplyBy(-h).add(w).subtract(this._map._getNewPixelOrigin(n,r));Je.any3d?Nt(this._container,O,h):dt(this._container,O)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),h=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new Be(h,h.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hu=hs.extend({options:{tolerance:0},getEvents:function(){var n=hs.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){hs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){X(this._redrawRequest),delete this._ctx,$t(this._container),kt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hs.prototype._update.call(this);var n=this._bounds,r=this._container,h=n.getSize(),m=Je.retina?2:1;dt(r,n.min),r.width=m*h.x,r.height=m*h.y,r.style.width=h.x+"px",r.style.height=h.y+"px",Je.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){hs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,h=r.next,m=r.prev;h?h.prev=m:this._drawLast=m,m?m.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),h=[],m,w;for(w=0;w<r.length;w++){if(m=Number(r[w]),isNaN(m))return;h.push(m)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||j(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Be,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var h=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)n=m.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var h,m,w,O,ne=n._parts,he=ne.length,ye=this._ctx;if(he){for(ye.beginPath(),h=0;h<he;h++){for(m=0,w=ne[h].length;m<w;m++)O=ne[h][m],ye[m?"lineTo":"moveTo"](O.x,O.y);r&&ye.closePath()}this._fillStroke(ye,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,h=this._ctx,m=Math.max(Math.round(n._radius),1),w=(Math.max(Math.round(n._radiusY),1)||m)/m;w!==1&&(h.save(),h.scale(1,w)),h.beginPath(),h.arc(r.x,r.y/w,m,0,Math.PI*2,!1),w!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,r){var h=r.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),h,m,w=this._drawFirst;w;w=w.next)h=w.layer,h.options.interactive&&h._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(m=h);this._fireEvent(m?[m]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(Et(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var h,m,w=this._drawFirst;w;w=w.next)h=w.layer,h.options.interactive&&h._containsPoint(r)&&(m=h);m!==this._hoveredLayer&&(this._handleMouseOut(n),m&&(ct(this._container,"leaflet-interactive"),this._fireEvent([m],n,"mouseover"),this._hoveredLayer=m)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,h){this._map._fireDOMEvent(r,h||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var h=r.next,m=r.prev;if(h)h.prev=m;else return;m?m.next=h:h&&(this._drawFirst=h),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var h=r.next,m=r.prev;if(m)m.next=h;else return;h?h.prev=m:m&&(this._drawLast=m),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function Vu(n){return Je.canvas?new Hu(n):null}var Ia=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),kv={_initContainer:function(){this._container=mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(hs.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=Ia("shape");ct(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=Ia("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;$t(r),n.removeInteractiveTarget(r),delete this._layers[d(n)]},_updateStyle:function(n){var r=n._stroke,h=n._fill,m=n.options,w=n._container;w.stroked=!!m.stroke,w.filled=!!m.fill,m.stroke?(r||(r=n._stroke=Ia("stroke")),w.appendChild(r),r.weight=m.weight+"px",r.color=m.color,r.opacity=m.opacity,m.dashArray?r.dashStyle=S(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=m.lineCap.replace("butt","flat"),r.joinstyle=m.lineJoin):r&&(w.removeChild(r),n._stroke=null),m.fill?(h||(h=n._fill=Ia("fill")),w.appendChild(h),h.color=m.fillColor||m.color,h.opacity=m.fillOpacity):h&&(w.removeChild(h),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),h=Math.round(n._radius),m=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+h+","+m+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){Dn(n._container)},_bringToBack:function(n){Ho(n._container)}},Er=Je.vml?Ia:Y,Ta=hs.extend({_initContainer:function(){this._container=Er("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Er("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){$t(this._container),kt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hs.prototype._update.call(this);var n=this._bounds,r=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,h.setAttribute("width",r.x),h.setAttribute("height",r.y)),dt(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=Er("path");n.options.className&&ct(r,n.options.className),n.options.interactive&&ct(r,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){$t(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,h=n.options;r&&(h.stroke?(r.setAttribute("stroke",h.color),r.setAttribute("stroke-opacity",h.opacity),r.setAttribute("stroke-width",h.weight),r.setAttribute("stroke-linecap",h.lineCap),r.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?r.setAttribute("stroke-dasharray",h.dashArray):r.removeAttribute("stroke-dasharray"),h.dashOffset?r.setAttribute("stroke-dashoffset",h.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),h.fill?(r.setAttribute("fill",h.fillColor||h.color),r.setAttribute("fill-opacity",h.fillOpacity),r.setAttribute("fill-rule",h.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,F(n._parts,r))},_updateCircle:function(n){var r=n._point,h=Math.max(Math.round(n._radius),1),m=Math.max(Math.round(n._radiusY),1)||h,w="a"+h+","+m+" 0 1,0 ",O=n._empty()?"M0 0":"M"+(r.x-h)+","+r.y+w+h*2+",0 "+w+-h*2+",0 ";this._setPath(n,O)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){Dn(n._path)},_bringToBack:function(n){Ho(n._path)}});Je.vml&&Ta.include(kv);function Gu(n){return Je.svg||Je.vml?new Ta(n):null}st.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&Vu(n)||Gu(n)}});var Zu=ds.extend({initialize:function(n,r){ds.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Pe(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function bv(n,r){return new Zu(n,r)}Ta.create=Er,Ta.pointsToPath=F,Co.geometryToLayer=Wo,Co.coordsToLatLng=Gi,Co.coordsToLatLngs=yi,Co.latLngToCoords=U,Co.latLngsToCoords=le,Co.getFeature=ge,Co.asFeature=Ie,st.mergeOptions({boxZoom:!0});var ju=lo.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){kt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){$t(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Zn(),rn(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=mt("div","leaflet-zoom-box",this._container),ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new Be(this._point,this._startPoint),h=r.getSize();dt(this._box,r.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&($t(this._box),Et(this._container,"leaflet-crosshair")),ro(),jn(),kt(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var r=new ue(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});st.addInitHook("addHandler","boxZoom",ju),st.mergeOptions({doubleClickZoom:!0});var qu=lo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,h=r.getZoom(),m=r.options.zoomDelta,w=n.originalEvent.shiftKey?h-m:h+m;r.options.doubleClickZoom==="center"?r.setZoom(w):r.setZoomAround(n.containerPoint,w)}});st.addInitHook("addHandler","doubleClickZoom",qu),st.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wu=lo.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new jo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Et(this._map._container,"leaflet-grab"),Et(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=Pe(this._map.options.maxBounds);this._offsetLimit=Ge(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),h=this._initialWorldOffset,m=this._draggable._newPos.x,w=(m-r+h)%n+r-h,O=(m+r+h)%n-r-h,ne=Math.abs(w+h)<Math.abs(O+h)?w:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ne},_onDragEnd:function(n){var r=this._map,h=r.options,m=!h.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),m)r.fire("moveend");else{this._prunePositions(+new Date);var w=this._lastPos.subtract(this._positions[0]),O=(this._lastTime-this._times[0])/1e3,ne=h.easeLinearity,he=w.multiplyBy(ne/O),ye=he.distanceTo([0,0]),De=Math.min(h.inertiaMaxSpeed,ye),Ye=he.multiplyBy(De/ye),rt=De/(h.inertiaDeceleration*ne),pt=Ye.multiplyBy(-rt/2).round();!pt.x&&!pt.y?r.fire("moveend"):(pt=r._limitOffset(pt,r.options.maxBounds),j(function(){r.panBy(pt,{duration:rt,easeLinearity:ne,noMoveStart:!0,animate:!0})}))}}});st.addInitHook("addHandler","dragging",Wu),st.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ku=lo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),kt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,h=n.scrollTop||r.scrollTop,m=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(m,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},h=this.keyCodes,m,w;for(m=0,w=h.left.length;m<w;m++)r[h.left[m]]=[-1*n,0];for(m=0,w=h.right.length;m<w;m++)r[h.right[m]]=[n,0];for(m=0,w=h.down.length;m<w;m++)r[h.down[m]]=[0,n];for(m=0,w=h.up.length;m<w;m++)r[h.up[m]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},h=this.keyCodes,m,w;for(m=0,w=h.zoomIn.length;m<w;m++)r[h.zoomIn[m]]=n;for(m=0,w=h.zoomOut.length;m<w;m++)r[h.zoomOut[m]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){kt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,h=this._map,m;if(r in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(m=this._panKeys[r],n.shiftKey&&(m=Le(m).multiplyBy(3)),h.options.maxBounds&&(m=h._limitOffset(Le(m),h.options.maxBounds)),h.options.worldCopyJump){var w=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(m)));h.panTo(w)}else h.panBy(m)}else if(r in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;bo(n)}}});st.addInitHook("addHandler","keyboard",Ku),st.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Yu=lo.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){kt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=Se(n),h=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var m=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),m),bo(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var m=this._delta/(this._map.options.wheelPxPerZoomLevel*4),w=4*Math.log(2/(1+Math.exp(-Math.abs(m))))/Math.LN2,O=h?Math.ceil(w/h)*h:w,ne=n._limitZoom(r+(this._delta>0?O:-O))-r;this._delta=0,this._startTime=null,ne&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+ne):n.setZoomAround(this._lastMousePos,r+ne))}});st.addInitHook("addHandler","scrollWheelZoom",Yu);var wv=600;st.mergeOptions({tapHold:Je.touchNative&&Je.safari&&Je.mobile,tapTolerance:15});var Ju=lo.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){kt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new me(r.clientX,r.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Ft),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),wv),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){kt(document,"touchend",Ft),kt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),kt(document,"touchend touchcancel contextmenu",this._cancel,this),kt(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new me(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});h._simulated=!0,r.target.dispatchEvent(h)}});st.addInitHook("addHandler","tapHold",Ju),st.mergeOptions({touchZoom:Je.touch,bounceAtZoomLimits:!0});var Xu=lo.extend({addHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Et(this._map._container,"leaflet-touch-zoom"),kt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var h=r.mouseEventToContainerPoint(n.touches[0]),m=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(h.add(m)._divideBy(2))),this._startDist=h.distanceTo(m),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Ft(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,h=r.mouseEventToContainerPoint(n.touches[0]),m=r.mouseEventToContainerPoint(n.touches[1]),w=h.distanceTo(m)/this._startDist;if(this._zoom=r.getScaleZoom(w,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&w<1||this._zoom>r.getMaxZoom()&&w>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,w===1)return}else{var O=h._add(m)._divideBy(2)._subtract(this._centerPoint);if(w===1&&O.x===0&&O.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),X(this._animRequest);var ne=c(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=j(ne,this,!0),Ft(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,X(this._animRequest),kt(document,"touchmove",this._onTouchMove,this),kt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});st.addInitHook("addHandler","touchZoom",Xu),st.BoxZoom=ju,st.DoubleClickZoom=qu,st.Drag=Wu,st.Keyboard=Ku,st.ScrollWheelZoom=Yu,st.TapHold=Ju,st.TouchZoom=Xu,o.Bounds=Be,o.Browser=Je,o.CRS=de,o.Canvas=Hu,o.Circle=Sa,o.CircleMarker=gi,o.Class=Te,o.Control=_n,o.DivIcon=Fu,o.DivOverlay=Yo,o.DomEvent=at,o.DomUtil=Fi,o.Draggable=jo,o.Evented=pe,o.FeatureGroup=wo,o.GeoJSON=Co,o.GridLayer=$a,o.Handler=lo,o.Icon=zs,o.ImageOverlay=Ko,o.LatLng=Ee,o.LatLngBounds=ue,o.Layer=kn,o.LayerGroup=Us,o.LineUtil=Yl,o.Map=st,o.Marker=Vi,o.Mixin=yr,o.Path=qo,o.Point=me,o.PolyUtil=br,o.Polygon=ds,o.Polyline=Jn,o.Popup=Mr,o.PosAnimation=Vt,o.Projection=Hi,o.Rectangle=Zu,o.Renderer=hs,o.SVG=Ta,o.SVGOverlay=Nu,o.TileLayer=Zi,o.Tooltip=Ar,o.Transformation=ie,o.Util=ce,o.VideoOverlay=Bu,o.bind=c,o.bounds=Ge,o.canvas=Vu,o.circle=nc,o.circleMarker=tc,o.control=fi,o.divIcon=gv,o.extend=s,o.featureGroup=Ql,o.geoJSON=bn,o.geoJson=Lo,o.gridLayer=yv,o.icon=ec,o.imageOverlay=hv,o.latLng=Me,o.latLngBounds=Pe,o.layerGroup=Xl,o.map=On,o.marker=Tr,o.point=Le,o.polygon=sc,o.polyline=oc,o.popup=vv,o.rectangle=bv,o.setOptions=$,o.stamp=d,o.svg=Gu,o.svgOverlay=pv,o.tileLayer=Uu,o.tooltip=mv,o.transformation=R,o.version=i,o.videoOverlay=fv;var Cv=window.L;o.noConflict=function(){return window.L=Cv,this},window.L=o}))})(Na,Na.exports)),Na.exports}var C0=w0();const Cn=k0(C0);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,c=a.getLatLngs(),u=c.splice(-1,1)[0];this._poly.setLatLngs(c),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),c=this._map.layerPointToLatLng(a);this._currentLatLng=c,this._updateTooltip(c),this._updateGuide(a),this._mouseMarker.setLatLng(c),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,c=a.clientX,u=a.clientY;this._startPoint.call(this,c,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,c=a.clientX,u=a.clientY;this._endPoint.call(this,c,u,s),this._clickHandled=null},_endPoint:function(s,a,c){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(c.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(c.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(c.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,c,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,c=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,c),this._endPoint.call(this,a,c,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var c;if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;c=this._markers[0]}var u=this._map.latLngToContainerPoint(c.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(d.getLatLng());a=u.distanceTo(p)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var c,u,d,p=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),f=this.options.guidelineDistance,g=this.options.maxGuideLineLength,_=p>g?p-g:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));_<p;_+=this.options.guidelineDistance)c=_/p,u={x:Math.floor(s.x*(1-c)+c*a.x),y:Math.floor(s.y*(1-c)+c*a.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,c=this._guidesContainer.childNodes.length;a<c;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,c=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=c?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var c,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(c=d-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[c].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[c].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?c&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(c)*(this.options.factor||1):this._measurementRunningTotal||0:c&&a?this._measurementRunningTotal+this._map.distance(a,c)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(c)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,c,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,p=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),c=p?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:c}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,c=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(c),this._isDrawing){this._drawShape(c),a=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var c=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=c+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError)),this._latlngs=a,L.setOptions(this,c)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,c,u,d=this._defaultShape();for(s=0,c=d.length;s<c;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,a=c-1;s<c;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[a],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return c._origLatLng=s,c._index=a,c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(c),c},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,c=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),c.options.poly){var d=c._map._editTooltip;if(!c.options.poly.allowIntersection&&c.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var p=c.options.color;c.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){c.setStyle({color:p}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,c=s.target;this._defaultShape().length<a||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,c),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(c){c._index>s&&(c._index+=a)})},_createMiddleMarker:function(s,a){var c,u,d,p=this._getMiddleLatLng(s,a),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=a._middleLeft=f,u=function(){f.off("touchmove",u,this);var g=a._index;f._index=g,f.off("click",c,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(g,0,p),this._markers.splice(g,0,f),f.setOpacity(1),this._updateIndexes(g,1),a._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,a),this._poly.fire("editstart")},d=function(){f.off("dragstart",u,this),f.off("dragend",d,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,a)},c=function(){u.call(this),d.call(this),this._fireEdit()},f.on("click",c,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var c=this._poly._map,u=c.project(s.getLatLng()),d=c.project(a.getLatLng());return c.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(c),this._markerGroup.addLayer(c),c},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,c=a.getLatLng();a===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),c=s.target,u=c._cornerIndex;c.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,c=s.length;a<c;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),c=s.target,u=c._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,c,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),c=a.getCenter(),u.setLatLng(c)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),p=[],f=0,g=c.length;f<g;f++)a=[c[f].lat-d.lat,c[f].lng-d.lng],p.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),c=this._map.project(s);return this._map.unproject([c.x+a,c.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var c={};if(s.touches!==void 0){if(!s.touches.length)return;c=s.touches[0]}else if(s.pointerType!=="touch"||(c=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(c),d=this._map.mouseEventToLayerPoint(c),p=this._map.layerPointToLatLng(d);this._map.fire(a,{latlng:p,layerPoint:d,containerPoint:u,pageX:c.pageX,pageY:c.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,c=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return c&&c>100&&c<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var c=0;c<a.length;c++)L.DomEvent.on(s,a[c],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],c=0,u=s.length;c<u;c++)Array.isArray(s[c])?a.push(L.LatLngUtil.cloneLatLngs(s[c])):a.push(this.cloneLatLng(s[c]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var c,u,d=a.length,p=0,f=Math.PI/180;if(d>2){for(var g=0;g<d;g++)c=a[g],u=a[(g+1)%d],p+=(u.lng-c.lng)*f*(2+Math.sin(c.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(a,c){var u=parseFloat(a).toFixed(c),d=L.drawLocal.format&&L.drawLocal.format.numeric,p=d&&d.delimiters,f=p&&p.thousands,g=p&&p.decimal;if(f||g){var _=u.split(".");u=f?_[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):_[0],g=g||".",_.length>1&&(u=u+g+_[1])}return u},readableArea:function(a,c,f){var d,p,f=L.Util.extend({},s,f);return c?(p=["ha","m"],type=typeof c,type==="string"?p=[c]:type!=="boolean"&&(p=c),d=a>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,f.km)+" km":a>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,f.ha)+" ha":L.GeometryUtil.formattedNumber(a,f.m)+" m"):(a/=.836127,d=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,f.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(a,f.yd)+" yd"),d},readableDistance:function(a,c,u,d,g){var f,g=L.Util.extend({},s,g);switch(c?typeof c=="string"?c:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":f=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(a,g.m)+" m";break;case"feet":a*=3.28083,f=L.GeometryUtil.formattedNumber(a,g.ft)+" ft";break;case"nauticalMile":a*=.53996,f=L.GeometryUtil.formattedNumber(a/1e3,g.nm)+" nm";break;default:a*=1.09361,f=a>1760?L.GeometryUtil.formattedNumber(a/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(a,g.yd)+" yd"}return f},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,c,u){return this._checkCounterclockwise(s,c,u)!==this._checkCounterclockwise(a,c,u)&&this._checkCounterclockwise(s,a,c)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,c){return(c.y-s.y)*(a.x-s.x)>(a.y-s.y)*(c.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,c,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(a=u[s-1],c=u[s],this._lineSegmentsIntersectsRange(a,c,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var c=this._getProjectedPoints(),u=c?c.length:0,d=c?c[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,p,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),c=a?a.length:0;return c+=s||0,!a||c<=3},_lineSegmentsIntersectsRange:function(s,a,c,u){var d,p,f=this._getProjectedPoints();u=u||0;for(var g=c;g>u;g--)if(d=f[g-1],p=f[g],L.LineUtil.segmentsIntersect(s,a,d,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),c=0;c<a.length;c++)s.push(this._map.latLngToLayerPoint(a[c]));return s}}),L.Polygon.include({intersects:function(){var s,a,c,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,a=d[0],c=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(c,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,c=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),c.appendChild(a));return c},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var c in this._toolbars)this._toolbars[c]!==a&&this._toolbars[c].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,c=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<p.length;a++)p[a].enabled&&this._initModeHandler(p[a].handler,this._toolbarContainer,u++,d,p[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,c=this._actionButtons.length;a<c;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,c,u,d){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:d,className:u+"-"+p,container:a,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=c,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),c=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(c),s.title&&(a.title=s.title,c.innerHTML=s.title),s.text&&(a.innerHTML=s.text,c.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var c=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,c,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,c,u,d,p=this._actionsContainer,f=this.getActions(s),g=f.length;for(c=0,u=this._actionButtons.length;c<u;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var _=0;_<g;_++)"enabled"in f[_]&&!f[_].enabled||(a=L.DomUtil.create("li","",p),d=this._createButton({title:f[_].title,text:f[_].text,container:a,callback:f[_].callback,context:f[_].context}),this._actionButtons.push({button:d,callback:f[_].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=c+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),c=this._container;return this._container&&(this._visible&&(c.style.visibility="inherit"),L.DomUtil.setPosition(c,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,c=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,c,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(c=L.Util.extend({},this.options.poly),u.options.poly=c),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],c=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(c);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const ov=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Th=e=>e.length*6+12,xc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),L0=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(c=>{if(i.contains(c.getLatLng())){const u=e.latLngToContainerPoint(c.getLatLng()),d=c.locationData;d&&o.push({marker:c,pixelPos:u,location:d})}});const s=o.map(({marker:c,pixelPos:u,location:d})=>{const g=Th(d.name),_=d.description?Th(`${d.name}: ${ov(d.description,50)}`):g;return{marker:c,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-_/2,right:u.x+_/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:c,location:u,markerBox:d,baseLabelBox:p,descLabelBox:f},g)=>{if(!u.description)return;let _=!1;for(let b=0;b<s.length;b++){if(g===b)continue;const x=s[b];if(xc(f,x.markerBox)||xc(f,x.baseLabelBox)){_=!0;break}if(x.descLabelBox&&a.has(x.location.id)&&xc(f,x.descLabelBox)){_=!0;break}}_||a.add(u.id)}),a},zr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],S0=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],pl=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function Oi(e){return pl.find(t=>t.value===e)||pl[0]}function x0(e){return Oi(e).defaultColor||"#667eea"}function $0(e,t){return t||x0(e)}const nu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,c=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${c},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${o+s*Math.cos(d)},${i+s*Math.sin(d)}`);const p=d+Math.PI/5;c.push(`${o+a*Math.cos(p)},${i+a*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${c.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<6;c++){const u=Math.PI/6+c*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<5;c++){const u=Math.PI/2*-1+c*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Mh={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},ea={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const c=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const c=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const p=d+Math.PI/5;c.push(`${16+a*Math.cos(p)},${16+a*Math.sin(p)}`)}return`<polygon points="${c.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Ah={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function en({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:c=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=Oi(e),d=parseInt(a,10)/100,p=c||Math.round(32*d);let f="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",_=i||"#fff";if(ea[e])f=ea[e]({backgroundColor:g,borderColor:_});else return nu[e]?.(g,p)||null}else{const g=o||"#667eea",_=i||"#fff",b=s||"#fff",x=t||"circle";x!=="none"&&ea[x]&&(f+=ea[x]({backgroundColor:g,borderColor:_})),Ah[e]&&(f+=Ah[e](b,g))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const I0={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function T0(e,t){return e===0?"missing":e>=t?"full":"partial"}function ou(e,t){const o=T0(e,t);return I0[o]}function M0(e,t,o=32){if(e==="default")return null;if(Mh[e])return Mh[e](o);if(nu[e]){const i=t||"#667eea";return nu[e](i,o)}return null}const A0=["circle","square","hexagon","pentagon"];function E0(e){return A0.includes(e)}function P0(e,t,o,i,s=32,a=!0){const c=M0(e,t,s),u=ou(o,i);if(!c)return null;const d=a&&E0(e),p=$0(e,t),f=O0(p),g=sv(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",_=s>=36?"12px":"10px",b=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${_};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${c}
      ${b}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function D0(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function sv(e){return!e||e.length<6?!1:D0(e)>.4}function O0(e){return sv(e)?"#1F2937":"#FFFFFF"}const R0="#667eea",B0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=E(null);let c=null;const u=E([]),d=E([]),p=E([]);let f=null,g=null;const _=()=>{if(c){const ue=c.getCenter();return{lat:ue.lat,lng:ue.lng}}return null},b=()=>c?c.getZoom():null,x=()=>{if(u.value.length>0){p.value.push([...u.value]);const ue=d.value.pop()||[];u.value=ue,nt(),s("polygon-drawing",u.value)}},$=()=>{if(p.value.length>0){d.value.push([...u.value]);const ue=p.value.pop();u.value=ue,nt(),s("polygon-drawing",u.value)}},B=()=>u.value.length>0,P=()=>p.value.length>0,M=()=>u.value.length,S=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),A())},A=()=>{u.value=[],d.value=[],p.value=[],nt()};t({getMapCenter:_,getMapZoom:b,undoPolygonPoint:x,redoPolygonPoint:$,canUndo:B,canRedo:P,getPolygonPointCount:M,completePolygon:S,clearPolygonDrawing:A});const I=E([]);let T=null;const C=E(!0),V=E(!1),z=E(new Set),ae=E([]);let j=null,X=null;const ce=(ue,Pe,Ee,Me,de=!1)=>{const ke=Ee?"36px":Me?"20px":"30px",H=Ee?"#667eea":"white",Q=de?"":ou(ue,Pe);return`
    <div style="position: relative; width: ${ke}; height: ${ke};">
      <div style="
        background-color: ${R0};
        width: ${ke};
        height: ${ke};
        border-radius: 50%;
        border: 3px solid ${H};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${de?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Q}
      </div>`}
    </div>
  `},Te=()=>{if(!c)return;const ue=L0(c,I.value),Pe=Array.from(z.value).sort().join(","),Ee=Array.from(ue).sort().join(",");Pe!==Ee&&(z.value=ue,Ge())},Ae=()=>{if(X&&(X.remove(),X=null),!c||!i.userLocation)return;const ue=Cn.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});X=Cn.marker([i.userLocation.lat,i.userLocation.lng],{icon:ue}).addTo(c).bindPopup("Your location")},Ce=()=>{if(!a.value)return;let ue=51.505,Pe=-.09,Ee=13;const Me=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,de=(H,Q)=>H!=null&&Q!=null&&!(H===0&&Q===0),ke=[];Me.length>0&&ke.push(...Me.filter(H=>de(H.latitude,H.longitude)).map(H=>({lat:H.latitude,lng:H.longitude}))),i.route&&i.route.length>0&&ke.push(...i.route.filter(H=>de(H.lat,H.lng)).map(H=>({lat:H.lat,lng:H.lng}))),i.center?(ue=i.center.lat,Pe=i.center.lng,Ee=i.zoom??13):ke.length>0&&(ue=ke.reduce((H,Q)=>H+Q.lat,0)/ke.length,Pe=ke.reduce((H,Q)=>H+Q.lng,0)/ke.length,Ee=10),c=Cn.map(a.value).setView([ue,Pe],Ee),Cn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(c),i.clickable&&c.on("click",H=>{i.drawingMode||s("map-click",{lat:H.latlng.lat,lng:H.latlng.lng})}),c.on("zoomend moveend",()=>{Be?Ge():Te()}),Ge(),pe(),me(),Ae(),Le()},pe=()=>{if(T&&(T.remove(),T=null),!c||i.route.length===0)return;const ue=i.route.map(Pe=>[Pe.lat,Pe.lng]);T=Cn.polyline(ue,{color:"blue",weight:4,opacity:.7}).addTo(c)},me=()=>{ae.value.forEach(ue=>ue.remove()),ae.value=[],!(!c||i.areas.length===0)&&i.areas.forEach(ue=>{const Pe=typeof ue.polygon=="string"?JSON.parse(ue.polygon):ue.polygon;if(!Pe||Pe.length===0)return;const Ee=Pe.map(H=>[H.lat,H.lng]),Me=ue.id===i.selectedAreaId,de=ue.color||"#667eea",ke=Cn.polygon(Ee,{color:de,fillColor:de,fillOpacity:Me?.4:.2,weight:Me?3:2,opacity:.8}).addTo(c);ke.setStyle({pane:"overlayPane"}),i.drawingMode||(ke.on("click",()=>s("area-click",ue)),ke.on("mouseover",()=>{ke.setStyle({fillOpacity:.4})}),ke.on("mouseout",()=>{ke.setStyle({fillOpacity:Me?.4:.2})})),ae.value.push(ke)})},nt=()=>{if(c&&(f&&(f.remove(),f=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=Cn.layerGroup().addTo(c),u.value.forEach((ue,Pe)=>{const Ee=Pe===0,Me=Pe===u.value.length-1,de=Cn.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${Ee?"16px":"12px"};
        height: ${Ee?"16px":"12px"};
        background-color: ${Ee?"#667eea":Me?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[Ee?16:12,Ee?16:12],iconAnchor:[Ee?8:6,Ee?8:6]});Cn.marker([ue.lat,ue.lng],{icon:de,interactive:!1}).addTo(g)}),u.value.length>=2))){const ue=u.value.map(Pe=>[Pe.lat,Pe.lng]);u.value.length>=3&&ue.push(ue[0]),f=Cn.polyline(ue,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(c)}},Le=()=>{if(!c)return;if(j||(j=new Cn.FeatureGroup,c.addLayer(j)),c._customDrawingHandlers&&(c.off("click",c._customDrawingHandlers.handleClick),c.getContainer().removeEventListener("touchstart",c._customDrawingHandlers.handleTouchStart),c.getContainer().removeEventListener("touchend",c._customDrawingHandlers.handleTouchEnd),c.getContainer().removeEventListener("touchmove",c._customDrawingHandlers.handleTouchMove),delete c._customDrawingHandlers),!i.drawingMode){A(),j&&j.clearLayers();return}let ue=0,Pe=null,Ee=!1,Me=!1;const de=300,ke=15,H=oe=>{d.value.push([...u.value]),p.value=[],u.value.push({lat:oe.lat,lng:oe.lng}),nt(),s("polygon-drawing",u.value)},Q=oe=>{oe.originalEvent&&oe.originalEvent.sourceCapabilities?.firesTouchEvents||H(oe.latlng)},ie=oe=>{if(oe.touches.length>1){Me=!0;return}Me=!1,ue=Date.now(),Pe={x:oe.touches[0].clientX,y:oe.touches[0].clientY},Ee=!1},R=oe=>{if(!Pe||Me)return;const Y=oe.touches[0].clientX-Pe.x,F=oe.touches[0].clientY-Pe.y;Math.sqrt(Y*Y+F*F)>ke&&(Ee=!0)},W=oe=>{if(Me){Me=!1,Pe=null;return}if(Date.now()-ue<de&&!Ee&&Pe){const F=oe.changedTouches[0],N=Cn.point(F.clientX-c.getContainer().getBoundingClientRect().left,F.clientY-c.getContainer().getBoundingClientRect().top),te=c.containerPointToLatLng(N);oe.preventDefault(),oe.stopPropagation(),H(te)}Pe=null,Ee=!1};c.on("click",Q),c.getContainer().addEventListener("touchstart",ie,{passive:!0}),c.getContainer().addEventListener("touchmove",R,{passive:!0}),c.getContainer().addEventListener("touchend",W,{passive:!1}),c._customDrawingHandlers={handleClick:Q,handleTouchStart:ie,handleTouchMove:R,handleTouchEnd:W},nt()};let Be=!1;const Ge=()=>{if(c&&c._animatingZoom){Be=!0;return}if(Be=!1,I.value.forEach(ue=>{ue._map&&(ue.off(),ue.remove())}),I.value=[],!!c){if(i.locations.forEach(ue=>{const Pe=ue.latitude??ue.Latitude,Ee=ue.longitude??ue.Longitude;if(Pe==null||Ee==null||Pe===0&&Ee===0)return;const Me=ue.checkedInCount||0,de=ue.requiredMarshals||1,ke=i.highlightLocationId===ue.id||i.highlightLocationIds.includes(ue.id),H=i.simplifyNonHighlighted&&!ke,Q=ue.resolvedStyleType||ue.ResolvedStyleType,ie=ue.resolvedStyleBackgroundColor||ue.ResolvedStyleBackgroundColor||ue.resolvedStyleColor||ue.ResolvedStyleColor,R=ue.resolvedStyleBorderColor||ue.ResolvedStyleBorderColor,W=ue.resolvedStyleIconColor||ue.ResolvedStyleIconColor,oe=ue.resolvedStyleBackgroundShape||ue.ResolvedStyleBackgroundShape,Y=Q&&Q!=="default"||ie||R||W||oe&&oe!=="circle"&&oe!=="default",F=ue.resolvedStyleMapRotation??ue.ResolvedStyleMapRotation??ue.styleMapRotation??ue.StyleMapRotation??0,N=parseInt(F,10)||0,te=ue.areaColor||"#999",ve=ue.areaId&&!i.marshalMode,we=z.value.has(ue.id)&&ue.description?`${ue.name}: ${ov(ue.description,50)}`:ue.name,Ve=ke?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",$e=ke?"#667eea":H?"#e0e0e0":"white",Ze=ke?"white":H?"#888":"#333";let We;if(H){const Tt="20px";We=`
        <div style="
          background-color: #999;
          width: ${Tt};
          height: ${Tt};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const re=!i.marshalMode,se=ou(Me,de),J=re?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Me}/${de}</div>`:"";if(Y){const Tt=ke?40:32,Jt=ue.resolvedStyleSize||ue.ResolvedStyleSize||"100",gt=en({type:ue.resolvedStyleType||ue.ResolvedStyleType,backgroundShape:ue.resolvedStyleBackgroundShape||ue.ResolvedStyleBackgroundShape||"circle",backgroundColor:ue.resolvedStyleBackgroundColor||ue.ResolvedStyleBackgroundColor||ue.resolvedStyleColor||ue.ResolvedStyleColor||"",borderColor:ue.resolvedStyleBorderColor||ue.ResolvedStyleBorderColor||"",iconColor:ue.resolvedStyleIconColor||ue.ResolvedStyleIconColor||"",size:Jt});gt?We=gt:We=P0(ue.resolvedStyleType,ue.resolvedStyleColor,Me,de,Tt,re)||ce(Me,de,ke,i.marshalMode,!0)}else We=ce(Me,de,ke,i.marshalMode,!0);const Ue=N!==0?`transform: rotate(${N}deg);`:"",Qe=Cn.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ve}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${ve?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${te};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Ue}">
                ${We}
              </div>
              ${H?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${se}
              </div>`}
              ${H?"":J}
            </div>
          </div>
          <div style="
            background-color: ${$e};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ke?"12px":"11px"};
            font-weight: bold;
            color: ${Ze};
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${we}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),ot=i.marshalMode?`<b>${ue.name}</b>${ue.description?`<br>${ue.description}`:""}`:`<b>${ue.name}</b><br>${ue.description||""}<br>Checked in: ${Me}/${de}`,vt=Cn.marker([ue.latitude,ue.longitude],{icon:Qe}).addTo(c).bindPopup(ot);vt.on("click",()=>{s("location-click",ue)}),vt.locationData=ue,I.value.push(vt)}),c&&C.value&&!i.center&&!V.value){const ue=[],Pe=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,Ee=(Me,de)=>Me!=null&&de!=null&&!(Me===0&&de===0);if(Pe.length>0&&ue.push(...Pe.filter(Me=>Ee(Me.latitude,Me.longitude)).map(Me=>[Me.latitude,Me.longitude])),i.route.length>0&&ue.push(...i.route.filter(Me=>Ee(Me.lat,Me.lng)).map(Me=>[Me.lat,Me.lng])),ue.length>0){const Me=Cn.latLngBounds(ue);c.fitBounds(Me,{padding:[50,50]}),C.value=!1,V.value=!0}}else i.center&&(C.value=!1);setTimeout(()=>{c&&!c._animatingZoom&&Te()},100)}};return Yt(()=>{V.value=!1,C.value=!0,Ce();let ue,Pe=0,Ee=0;const Me=new ResizeObserver(de=>{if(c&&de.length>0){const{width:ke,height:H}=de[0].contentRect;(Math.abs(ke-Pe)>10||Math.abs(H-Ee)>10)&&(Pe=ke,Ee=H,clearTimeout(ue),ue=setTimeout(()=>{c.invalidateSize()},150))}});a.value&&Me.observe(a.value),vo(()=>{clearTimeout(ue),Me.disconnect()})}),je(()=>i.locations,ue=>{if(Ge(),c&&!V.value&&ue.length>0&&!i.center){const Pe=ue.map(ke=>ke.latitude),Ee=ue.map(ke=>ke.longitude),Me=Pe.reduce((ke,H)=>ke+H,0)/Pe.length,de=Ee.reduce((ke,H)=>ke+H,0)/Ee.length;c.setView([Me,de],10),V.value=!0,C.value=!1}},{deep:!0}),je(()=>i.route,ue=>{if(pe(),Ge(),c&&!V.value&&ue&&ue.length>0&&!i.center){const Pe=ue.map(ke=>ke.lat),Ee=ue.map(ke=>ke.lng),Me=Pe.reduce((ke,H)=>ke+H,0)/Pe.length,de=Ee.reduce((ke,H)=>ke+H,0)/Ee.length;c.setView([Me,de],10),V.value=!0,C.value=!1}},{deep:!0}),je(()=>i.center,ue=>{c&&c.setView([ue.lat,ue.lng],i.zoom)}),je(()=>i.areas,()=>{me()},{deep:!0}),je(()=>i.selectedAreaId,()=>{me()}),je(()=>i.drawingMode,()=>{Le()}),je(()=>i.userLocation,()=>{Ae()},{deep:!0}),je(()=>i.highlightLocationId,()=>{Ge()}),je(()=>i.highlightLocationIds,()=>{Ge()},{deep:!0}),je(()=>i.marshalMode,()=>{Ge()}),je(()=>i.simplifyNonHighlighted,()=>{Ge()}),je(()=>i.clickable,ue=>{c&&(c.off("click"),ue&&c.on("click",Pe=>{i.drawingMode||s("map-click",{lat:Pe.latlng.lat,lng:Pe.latlng.lng})}))}),(ue,Pe)=>(v(),y("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512))}},xs=Ke(B0,[["__scopeId","data-v-295c929a"]]);function ss(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const N0={class:"areas-selection"},F0={key:0,class:"areas-selection-header"},U0={class:"areas-list"},z0=["checked","onChange"],H0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=K(()=>[...o.areas].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:ss(d.name,p.name))),a=K(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),c=d=>{const p=[...o.selectedAreaIds],f=p.indexOf(d);f>=0?p.splice(f,1):p.push(d),i("update:selectedAreaIds",p)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,p)=>(v(),y("div",N0,[e.areas.length>1?(v(),y("div",F0,[l("button",{onClick:u,class:"toggle-all-btn"},k(a.value?"Deselect all":"Select all"),1)])):D("",!0),l("div",U0,[(v(!0),y(be,null,Oe(s.value,f=>(v(),y("label",{class:"area-checkbox",key:f.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:g=>c(f.id)},null,40,z0),l("span",{class:"area-color-dot",style:it({backgroundColor:f.color||"#667eea"})},null,4),He(" "+k(f.name),1)]))),128))])]))}},V0=Ke(H0,[["__scopeId","data-v-ba19009b"]]),G0={class:"course-areas-tab"},Z0={class:"map-wrapper"},j0={class:"map-buttons-column"},q0={key:0,class:"map-btn-wrapper"},W0={key:0,class:"dropdown-content filters-dropdown"},K0={class:"filter-section"},Y0={class:"filter-checkbox"},J0={class:"filter-checkbox"},X0={class:"filter-checkbox"},Q0={class:"filter-checkbox"},ew={class:"filter-checkbox"},tw={key:0,class:"filter-section"},nw={key:1,class:"map-btn-wrapper"},ow={key:0,class:"dropdown-content add-dropdown"},sw={key:0,class:"drawing-controls"},iw={class:"point-count"},aw={class:"undo-redo-buttons"},rw=["disabled"],lw=["disabled"],cw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map","fullscreen"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,c=o,u=E(null),d=E(null),p=E(!0),f=E(!1),g=E(null),_=E(0),b=E(!1),x=E(!1),$=E({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreas:[]}),B=()=>{p.value=!p.value,p.value||(f.value=!1)},P=()=>{f.value=!f.value,f.value&&(p.value=!0)},M=Ce=>{f.value=!1,Ce==="checkpoint"?(c("add-checkpoint-from-map"),z()):Ce==="many-checkpoints"?(c("add-many-checkpoints-from-map"),z()):Ce==="area"&&(c("add-area-from-map"),z())},S=()=>{f.value=!1,c("import-checkpoints")},A=()=>{f.value=!1,c("upload-route")},I=Ce=>{_.value=Ce?.length||0,T()},T=()=>{d.value&&(b.value=d.value.canUndo(),x.value=d.value.canRedo())},C=()=>{d.value&&(d.value.undoPolygonPoint(),T())},V=()=>{d.value&&(d.value.redoPolygonPoint(),T())},z=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};t({scrollMapIntoView:z,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),je(()=>a.areas,Ce=>{if(Ce.length>0){const pe=new Set($.value.selectedAreas);Ce.forEach(me=>{pe.has(me.id)||$.value.selectedAreas.push(me.id)}),$.value.selectedAreas=$.value.selectedAreas.filter(me=>Ce.some(nt=>nt.id===me))}},{immediate:!0}),je(()=>a.drawingMode,Ce=>{Ce||(_.value=0,b.value=!1,x.value=!1)}),K(()=>[...a.areas].sort((Ce,pe)=>Ce.displayOrder!==pe.displayOrder?Ce.displayOrder-pe.displayOrder:ss(Ce.name,pe.name)));const X=K(()=>$.value.showRoute?a.route:[]),ce=Ce=>{const pe=Ce.checkedInCount||0,me=Ce.requiredMarshals||1;return pe===0?"unchecked":pe>=me?"full":"partial"},Te=K(()=>!$.value.showUncheckedIn&&!$.value.showPartiallyCheckedIn&&!$.value.showFullyCheckedIn?[]:a.checkpoints.filter(Ce=>{const pe=ce(Ce);if(pe==="unchecked"&&!$.value.showUncheckedIn||pe==="partial"&&!$.value.showPartiallyCheckedIn||pe==="full"&&!$.value.showFullyCheckedIn)return!1;const me=Ce.areaIds||Ce.AreaIds;return me&&Array.isArray(me)?me.some(nt=>$.value.selectedAreas.includes(nt)):Ce.areaId?$.value.selectedAreas.includes(Ce.areaId):!1})),Ae=K(()=>$.value.showAreas?a.areas.filter(Ce=>$.value.selectedAreas.includes(Ce.id)):[]);return(Ce,pe)=>(v(),y("div",G0,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[l("div",Z0,[Re(xs,{ref_key:"mapView",ref:d,locations:Te.value,route:X.value,areas:Ae.value,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,"drawing-mode":e.drawingMode,onMapClick:pe[0]||(pe[0]=me=>Ce.$emit("map-click",me)),onLocationClick:pe[1]||(pe[1]=me=>Ce.$emit("location-click",me)),onAreaClick:pe[2]||(pe[2]=me=>Ce.$emit("area-click",me)),onPolygonComplete:pe[3]||(pe[3]=me=>Ce.$emit("polygon-complete",me)),onPolygonDrawing:I},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","drawing-mode"]),l("div",j0,[l("button",{class:"map-btn",onClick:pe[4]||(pe[4]=me=>Ce.$emit("fullscreen")),title:"Fullscreen"},[...pe[14]||(pe[14]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])]),f.value?D("",!0):(v(),y("div",q0,[l("button",{class:fe(["map-btn",{active:!p.value}]),onClick:B,title:"Show/hide options"},[...pe[15]||(pe[15]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),p.value?D("",!0):(v(),y("div",W0,[l("div",K0,[pe[16]||(pe[16]=l("h4",null,"Show on map:",-1)),l("label",Y0,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":pe[5]||(pe[5]=me=>$.value.showRoute=me)},null,512),[[ws,$.value.showRoute]]),He(" "+k(G(i).course),1)]),l("label",J0,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":pe[6]||(pe[6]=me=>$.value.showUncheckedIn=me)},null,512),[[ws,$.value.showUncheckedIn]]),He(" Unchecked-in "+k(G(s).checkpoints),1)]),l("label",X0,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":pe[7]||(pe[7]=me=>$.value.showPartiallyCheckedIn=me)},null,512),[[ws,$.value.showPartiallyCheckedIn]]),He(" Partially checked-in "+k(G(s).checkpoints),1)]),l("label",Q0,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":pe[8]||(pe[8]=me=>$.value.showFullyCheckedIn=me)},null,512),[[ws,$.value.showFullyCheckedIn]]),He(" Fully checked-in "+k(G(s).checkpoints),1)]),l("label",ew,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":pe[9]||(pe[9]=me=>$.value.showAreas=me)},null,512),[[ws,$.value.showAreas]]),He(" "+k(G(i).areas),1)])]),e.areas.length>0&&$.value.showAreas?(v(),y("div",tw,[l("h4",null,"Filter "+k(G(s).areas)+":",1),Re(V0,{areas:e.areas,"selected-area-ids":$.value.selectedAreas,"onUpdate:selectedAreaIds":pe[10]||(pe[10]=me=>$.value.selectedAreas=me)},null,8,["areas","selected-area-ids"])])):D("",!0)]))])),p.value?(v(),y("div",nw,[l("button",{class:fe(["map-btn",{active:f.value}]),onClick:P,ref_key:"addButtonRef",ref:g,title:"Add"},[...pe[17]||(pe[17]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])],2),f.value?(v(),y("div",ow,[l("button",{onClick:pe[11]||(pe[11]=me=>M("checkpoint")),class:"dropdown-item"},k(G(i).checkpoint),1),l("button",{onClick:pe[12]||(pe[12]=me=>M("many-checkpoints")),class:"dropdown-item"}," Many "+k(G(s).checkpoints),1),l("button",{onClick:pe[13]||(pe[13]=me=>M("area")),class:"dropdown-item"},k(G(i).area),1),l("button",{onClick:S,class:"dropdown-item"}," Import "+k(G(s).checkpoints)+"... ",1),l("button",{onClick:A,class:"dropdown-item"}," Upload "+k(G(s).course)+"... ",1)])):D("",!0)])):D("",!0)]),e.drawingMode&&_.value>0?(v(),y("div",sw,[l("div",iw,k(_.value)+" point"+k(_.value!==1?"s":""),1),l("div",aw,[l("button",{onClick:C,class:"btn-drawing undo-btn",disabled:!b.value,title:"Undo last point"},"  Undo ",8,rw),l("button",{onClick:V,class:"btn-drawing redo-btn",disabled:!x.value,title:"Redo point"}," Redo  ",8,lw)])])):D("",!0)])],512)]))}},uw=Ke(cw,[["__scopeId","data-v-4e81d9ee"]]),dw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),c=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return c&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},hw=e=>e&&e.isCheckedIn?"":"",fw={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),y("button",{class:fe(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=i=>t.$emit("click"))},[Yi(t.$slots,"default",{},void 0)],2))}},to=Ke(fw,[["__scopeId","data-v-f866b89f"]]),pw={class:"marshals-tab"},vw={class:"tab-header"},mw={class:"button-group"},gw={key:0,class:"status-pills"},yw={class:"filters-section"},_w={class:"search-group"},kw={class:"marshals-grid"},bw={class:"marshals-table"},ww={key:0,class:"sort-indicator"},Cw={key:0,class:"sort-indicator"},Lw={key:0,class:"sort-indicator"},Sw={key:0,class:"sort-indicator"},xw=["onClick"],$w=["rowspan"],Iw={class:"checkpoint-cell"},Tw={class:"checkpoint-name"},Mw={key:0,class:"checkpoint-description"},Aw=["value","onChange"],Ew=["rowspan"],Pw={key:0,class:"last-active-text"},Dw={key:1,class:"last-active-never"},Ow=["onClick"],Rw={class:"no-checkpoint-text"},Bw={class:"hide-on-mobile last-active-cell"},Nw={key:0,class:"last-active-text"},Fw={key:1,class:"last-active-never"},Uw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=E("name"),a=E("asc"),c=E(""),u=E("all"),d=V=>{u.value=V},p=V=>{s.value===V?a.value=a.value==="asc"?"desc":"asc":(s.value=V,a.value="asc")},f=V=>i.assignments.filter(z=>z.marshalId===V),g=K(()=>new Set(i.assignments.filter(V=>V.isCheckedIn).map(V=>V.marshalId))),_=K(()=>new Set(i.assignments.map(V=>V.marshalId))),b=K(()=>g.value.size),x=K(()=>i.marshals.filter(V=>!_.value.has(V.id)).length),$=K(()=>i.marshals.filter(V=>_.value.has(V.id)&&!g.value.has(V.id)).length),B=V=>i.locations.find(z=>z.id===V),P=V=>{const z=B(V);return z?z.name:"Unknown"},M=V=>{const z=B(V);return z?z.description:""},S=V=>{if(!V)return"";const z=new Date(V),j=new Date-z,X=Math.floor(j/6e4),ce=Math.floor(X/60),Te=Math.floor(ce/24);return X<1?"just now":X<60?`${X}m ago`:ce<24?`${ce}h ago`:Te===1?"yesterday":Te<7?`${Te}d ago`:z.toLocaleDateString()},A=K(()=>{let V=i.marshals;if(u.value==="unassigned"?V=V.filter(z=>!_.value.has(z.id)):u.value==="checked-in"?V=V.filter(z=>g.value.has(z.id)):u.value==="not-checked-in"&&(V=V.filter(z=>_.value.has(z.id)&&!g.value.has(z.id))),c.value.trim()){const z=c.value.toLowerCase().trim().split(/\s+/);V=V.filter(ae=>{const X=f(ae.id).map(Te=>{const Ae=B(Te.locationId);return Ae?`${Ae.name||""} ${Ae.description||""}`:""}).join(" "),ce=`${ae.name} ${X}`.toLowerCase();return z.every(Te=>ce.includes(Te))})}return V}),I=K(()=>{const V=[...A.value];return V.sort((z,ae)=>{let j=0;if(s.value==="name")j=z.name.localeCompare(ae.name);else if(s.value==="checkpoint"){const X=f(z.id),ce=f(ae.id),Te=X.length>0?P(X[0].locationId):"",Ae=ce.length>0?P(ce[0].locationId):"";j=dw(Te,Ae)}else if(s.value==="status"){const X=f(z.id),ce=f(ae.id),Te=X.length>0&&X[0].isCheckedIn?1:0;j=(ce.length>0&&ce[0].isCheckedIn?1:0)-Te}else if(s.value==="lastActive"){const X=z.lastAccessedDate?new Date(z.lastAccessedDate).getTime():0;j=(ae.lastAccessedDate?new Date(ae.lastAccessedDate).getTime():0)-X}return a.value==="asc"?j:-j}),V}),T=V=>V.isAdminCheckedIn?"admin-checked-in":V.isWrongLocation?"wrong-location":V.isCheckedIn?"checked-in":"not-checked-in",C=V=>V.isCheckedIn?"status-checked-in":"status-not-checked-in";return(V,z)=>(v(),y("div",pw,[l("div",vw,[l("div",mw,[l("button",{onClick:z[0]||(z[0]=ae=>V.$emit("add-marshal")),class:"btn btn-primary"}," Add "+k(G(o).person.toLowerCase()),1),l("button",{onClick:z[1]||(z[1]=ae=>V.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),y("div",gw,[Re(to,{variant:"neutral",active:u.value==="all",onClick:z[2]||(z[2]=ae=>d("all"))},{default:qe(()=>[He(k(e.marshals.length)+" total ",1)]),_:1},8,["active"]),x.value>0?(v(),Xe(to,{key:0,variant:"warning",active:u.value==="unassigned",onClick:z[3]||(z[3]=ae=>d("unassigned"))},{default:qe(()=>[He(k(x.value)+" unassigned ",1)]),_:1},8,["active"])):D("",!0),b.value>0?(v(),Xe(to,{key:1,variant:"success",active:u.value==="checked-in",onClick:z[4]||(z[4]=ae=>d("checked-in"))},{default:qe(()=>[He(k(b.value)+" checked in ",1)]),_:1},8,["active"])):D("",!0),$.value>0?(v(),Xe(to,{key:2,variant:"danger",active:u.value==="not-checked-in",onClick:z[5]||(z[5]=ae=>d("not-checked-in"))},{default:qe(()=>[He(k($.value)+" not checked in ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),l("div",yw,[l("div",_w,[Ne(l("input",{"onUpdate:modelValue":z[6]||(z[6]=ae=>c.value=ae),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[et,c.value]])])]),l("div",kw,[l("table",bw,[l("thead",null,[l("tr",null,[l("th",{onClick:z[7]||(z[7]=ae=>p("name")),class:"sortable"},[z[12]||(z[12]=He(" Name ",-1)),s.value==="name"?(v(),y("span",ww,k(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:z[8]||(z[8]=ae=>p("checkpoint")),class:"sortable"},[He(k(G(o).checkpoint)+" ",1),s.value==="checkpoint"?(v(),y("span",Cw,k(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:z[9]||(z[9]=ae=>p("status")),class:"sortable"},[z[13]||(z[13]=He(" Status ",-1)),s.value==="status"?(v(),y("span",Lw,k(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:z[10]||(z[10]=ae=>p("lastActive")),class:"sortable hide-on-mobile"},[z[14]||(z[14]=He(" Last active ",-1)),s.value==="lastActive"?(v(),y("span",Sw,k(a.value==="asc"?"":""),1)):D("",!0)])])]),l("tbody",null,[(v(!0),y(be,null,Oe(I.value,ae=>(v(),y(be,{key:ae.id},[f(ae.id).length>0?(v(!0),y(be,{key:0},Oe(f(ae.id),(j,X)=>(v(),y("tr",{key:`${ae.id}-${j.id}`,class:"marshal-row",onClick:ce=>V.$emit("select-marshal",ae)},[X===0?(v(),y("td",{key:0,rowspan:f(ae.id).length},k(ae.name),9,$w)):D("",!0),l("td",Iw,[l("div",Tw,k(P(j.locationId)),1),M(j.locationId)?(v(),y("div",Mw,k(M(j.locationId)),1)):D("",!0)]),l("td",{onClick:z[11]||(z[11]=ft(()=>{},["stop"]))},[l("select",{value:T(j),onChange:ce=>V.$emit("change-assignment-status",{assignment:j,status:ce.target.value}),class:fe(["status-select hide-on-mobile",C(j)])},[...z[15]||(z[15]=[l("option",{value:"not-checked-in"},"Not checked-in",-1),l("option",{value:"checked-in"},"Checked-in",-1),l("option",{value:"admin-checked-in"},"Admin checked-in",-1),l("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,Aw),l("span",{class:fe(["status-icon show-on-mobile",C(j)])},k(G(hw)(j)),3)]),X===0?(v(),y("td",{key:1,rowspan:f(ae.id).length,class:"hide-on-mobile last-active-cell"},[ae.lastAccessedDate?(v(),y("span",Pw,k(S(ae.lastAccessedDate)),1)):(v(),y("span",Dw,"Never"))],8,Ew)):D("",!0)],8,xw))),128)):(v(),y("tr",{key:1,class:"marshal-row",onClick:j=>V.$emit("select-marshal",ae)},[l("td",null,k(ae.name),1),l("td",Rw,"No "+k(G(o).checkpoint.toLowerCase())+" assigned",1),z[16]||(z[16]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),l("td",Bw,[ae.lastAccessedDate?(v(),y("span",Nw,k(S(ae.lastAccessedDate)),1)):(v(),y("span",Fw,"Never"))])],8,Ow))],64))),128))])])])]))}},zw=Ke(Uw,[["__scopeId","data-v-618e1dbe"]]),Hw={class:"checklists-tab"},Vw={class:"checklists-tab-header"},Gw={class:"button-group"},Zw={class:"filters-section"},jw={class:"search-group"},qw=["placeholder"],Ww={class:"checklist-items-list"},Kw={key:0,class:"empty-state"},Yw={class:"checklist-item-content"},Jw=["onClick"],Xw={class:"checklist-item-scopes"},Qw=["onClick"],eC={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=E(""),c=K(()=>{if(!a.value.trim())return s.checklistItems;const f=a.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const _=(g.text||"").toLowerCase();return f.every(b=>_.includes(b))})}),u=K(()=>[...c.value].sort((f,g)=>f.displayOrder!==g.displayOrder?f.displayOrder-g.displayOrder:ss(f.text,g.text))),d=f=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[f]||f,p=f=>{if(!f)return"";const g=d(f.scope);if(f.itemType===null)return g;const _=f.ids||[];if(_.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(_.includes("ALL_AREAS"))return`${g} (All ${i.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${g} (All ${i.value.checkpoints})`;const b=_.length;return b===0?g:`${g} (${b})`};return(f,g)=>(v(),y("div",Hw,[l("div",Vw,[l("div",Gw,[l("button",{onClick:g[0]||(g[0]=_=>f.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+k(G(i).checklist),1)])]),l("div",Zw,[l("div",jw,[Ne(l("input",{"onUpdate:modelValue":g[1]||(g[1]=_=>a.value=_),type:"text",class:"search-input",placeholder:`Search ${G(i).checklists}...`},null,8,qw),[[et,a.value]])])]),l("div",Ww,[c.value.length===0?(v(),y("div",Kw,[l("p",null,k(a.value?`No ${G(i).checklists} match your search.`:`No ${G(i).checklists} yet. Create one to get started!`),1)])):D("",!0),(v(!0),y(be,null,Oe(u.value,_=>(v(),y("div",{key:_.itemId,class:"checklist-item-card"},[l("div",Yw,[l("div",{class:"checklist-item-title",onClick:b=>f.$emit("select-checklist-item",_,"details")},[l("strong",null,k(_.text),1)],8,Jw),l("div",Xw,[(v(!0),y(be,null,Oe(_.scopeConfigurations,(b,x)=>(v(),y("span",{key:x,class:"scope-badge",onClick:$=>f.$emit("select-checklist-item",_,"visibility")},k(p(b)),9,Qw))),128))])])]))),128))])]))}},tC=Ke(eC,[["__scopeId","data-v-123b7338"]]),nC={class:"notes-tab"},oC={class:"notes-tab-header"},sC={class:"button-group"},iC={class:"filters-section"},aC={class:"search-group"},rC={class:"notes-list"},lC={key:0,class:"empty-state"},cC=["onClick"],uC={class:"note-header"},dC={class:"note-title-row"},hC={key:0,class:"pin-icon",title:"Pinned"},fC={class:"note-meta"},pC={key:0,class:"category-badge"},vC={class:"created-info"},mC={key:0,class:"note-preview"},gC={class:"note-scopes"},yC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=E(""),a=K(()=>{if(!s.value.trim())return i.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return i.notes.filter(_=>{const b=`${_.title||""} ${_.content||""} ${_.priority||""}`.toLowerCase();return g.every(x=>b.includes(x))})}),c=K(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...a.value].sort((_,b)=>{if(_.isPinned!==b.isPinned)return _.isPinned?-1:1;const x=g[_.priority]??2,$=g[b.priority]??2;return x!==$?x-$:_.displayOrder!==b.displayOrder?_.displayOrder-b.displayOrder:ss(_.title,b.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const _=u(g.scope);if(g.itemType===null)return _;const b=g.ids||[];if(b.includes("ALL_MARSHALS"))return`${_} (Everyone)`;if(b.includes("ALL_AREAS"))return`${_} (All ${o.value.areas})`;if(b.includes("ALL_CHECKPOINTS"))return`${_} (All ${o.value.checkpoints})`;const x=b.length;return x===0?_:`${_} (${x})`},p=g=>{if(!g)return"";const _=150;return g.length<=_?g:g.substring(0,_)+"..."},f=g=>{if(!g)return"";const _=new Date(g),x=new Date-_,$=Math.floor(x/6e4),B=Math.floor(x/36e5),P=Math.floor(x/864e5);return $<1?"Just now":$<60?`${$}m ago`:B<24?`${B}h ago`:P<7?`${P}d ago`:_.toLocaleDateString()};return(g,_)=>(v(),y("div",nC,[l("div",oC,[l("div",sC,[l("button",{onClick:_[0]||(_[0]=b=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",iC,[l("div",aC,[Ne(l("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>s.value=b),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[et,s.value]])])]),l("div",rC,[a.value.length===0?(v(),y("div",lC,[l("p",null,k(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):D("",!0),(v(!0),y(be,null,Oe(c.value,b=>(v(),y("div",{key:b.noteId,class:fe(["note-card",{pinned:b.isPinned}]),onClick:x=>g.$emit("select-note",b)},[l("div",uC,[l("div",dC,[b.isPinned?(v(),y("span",hC,"")):D("",!0),l("span",{class:fe(["priority-indicator",b.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,k(b.title),1)]),l("div",fC,[b.category?(v(),y("span",pC,k(b.category),1)):D("",!0),l("span",vC,k(f(b.createdAt)),1)])]),b.content?(v(),y("div",mC,k(p(b.content)),1)):D("",!0),l("div",gC,[(v(!0),y(be,null,Oe(b.scopeConfigurations,(x,$)=>(v(),y("span",{key:$,class:"scope-badge"},k(d(x)),1))),128))])],10,cC))),128))])]))}},_C=Ke(yC,[["__scopeId","data-v-73f1bcdd"]]),kC={class:"contacts-tab"},bC={class:"contacts-tab-header"},wC={class:"button-group"},CC={class:"filters-section"},LC={class:"search-group"},SC={class:"contacts-list"},xC={key:0,class:"empty-state"},$C=["onClick"],IC={class:"contact-header"},TC={class:"contact-title-row"},MC={key:0,class:"primary-badge",title:"Primary contact"},AC={class:"role-badge"},EC={class:"contact-details"},PC={key:0,class:"contact-phone"},DC={key:1,class:"contact-email"},OC={key:0,class:"contact-notes"},RC={class:"contact-scopes"},BC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=E(""),a=K(()=>{if(!s.value.trim())return i.contacts;const g=s.value.toLowerCase().trim().split(/\s+/);return i.contacts.filter(_=>{const b=u(_.role),x=`${_.name||""} ${b}`.toLowerCase();return g.every($=>x.includes($))})}),c=K(()=>[...a.value].sort((g,_)=>{if(g.isPrimary!==_.isPrimary)return g.isPrimary?-1:1;const b=g.role.localeCompare(_.role);return b!==0?b:g.displayOrder!==_.displayOrder?g.displayOrder-_.displayOrder:ss(g.name,_.name)})),u=g=>g?g==="AreaLead"?`${o.value.area.charAt(0).toUpperCase()+o.value.area.slice(1)} Lead`:g.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",d=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`})[g]||g,p=g=>{if(!g)return"";const _=d(g.scope);if(g.itemType===null)return _;const b=g.ids||[];if(b.includes("ALL_MARSHALS"))return`${_} (Everyone)`;if(b.includes("ALL_AREAS"))return`${_} (All ${o.value.areas})`;if(b.includes("ALL_CHECKPOINTS"))return`${_} (All ${o.value.checkpoints})`;const x=b.length;return x===0?_:`${_} (${x})`},f=g=>{if(!g)return"";const _=100;return g.length<=_?g:g.substring(0,_)+"..."};return(g,_)=>(v(),y("div",kC,[l("div",bC,[l("div",wC,[l("button",{onClick:_[0]||(_[0]=b=>g.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")])]),l("div",CC,[l("div",LC,[Ne(l("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>s.value=b),type:"text",class:"search-input",placeholder:"Search by name or role..."},null,512),[[et,s.value]])])]),l("div",SC,[a.value.length===0?(v(),y("div",xC,[l("p",null,k(s.value?"No contacts match your search.":"No contacts yet. Create one to get started!"),1)])):D("",!0),(v(!0),y(be,null,Oe(c.value,b=>(v(),y("div",{key:b.contactId,class:fe(["contact-card",{primary:b.isPrimary}]),onClick:x=>g.$emit("select-contact",b)},[l("div",IC,[l("div",TC,[b.isPrimary?(v(),y("span",MC,"")):D("",!0),l("strong",null,k(b.name),1),l("span",AC,k(u(b.role)),1)]),l("div",EC,[b.phone?(v(),y("span",PC,k(b.phone),1)):D("",!0),b.email?(v(),y("span",DC,k(b.email),1)):D("",!0)])]),b.notes?(v(),y("div",OC,k(f(b.notes)),1)):D("",!0),l("div",RC,[(v(!0),y(be,null,Oe(b.scopeConfigurations,(x,$)=>(v(),y("span",{key:$,class:"scope-badge"},k(p(x)),1))),128))])],10,$C))),128))])]))}},NC=Ke(BC,[["__scopeId","data-v-2081b7fe"]]),FC={class:"event-details-tab"},UC={class:"event-info-card"},zC={class:"form-group"},HC={class:"form-group"},VC={class:"form-row"},GC={class:"form-group"},ZC={class:"form-group"},jC=["value"],qC={class:"form-actions"},WC=["disabled"],KC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=E({...o.eventData});je(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},c=()=>{i("submit",{...s.value})};return(u,d)=>(v(),y("div",FC,[l("div",UC,[l("form",{onSubmit:ft(c,["prevent"]),class:"event-details-form"},[l("div",zC,[d[4]||(d[4]=l("label",null,"Event name",-1)),Ne(l("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:a},null,544),[[et,s.value.name]])]),l("div",HC,[d[5]||(d[5]=l("label",null,"Description",-1)),Ne(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:a},null,544),[[et,s.value.description]])]),l("div",VC,[l("div",GC,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),Ne(l("input",{"onUpdate:modelValue":d[2]||(d[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[et,s.value.eventDate]])]),l("div",ZC,[d[7]||(d[7]=l("label",null,"Time zone",-1)),Ne(l("select",{"onUpdate:modelValue":d[3]||(d[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:a},[(v(!0),y(be,null,Oe(G(Xp),p=>(v(),y("option",{key:p.value,value:p.value},k(p.label),9,jC))),128))],544),[[pn,s.value.timeZoneId]])])]),l("div",qC,[l("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,WC)])],32)])]))}},YC=Ke(KC,[["__scopeId","data-v-6af50b43"]]),JC={class:"admins-list"},XC={class:"admin-info"},QC={class:"admin-role"},e2=["onClick"],t2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),y("div",null,[l("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",JC,[(v(!0),y(be,null,Oe(e.admins,i=>(v(),y("div",{key:i.userEmail,class:"admin-item"},[l("div",XC,[l("strong",null,k(i.userEmail),1),l("span",QC,k(i.role),1)]),e.admins.length>1?(v(),y("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,e2)):D("",!0)]))),128))])]))}},n2=Ke(t2,[["__scopeId","data-v-e526860b"]]),Xn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Qr="#667eea";function Eh(e){const t=e.map(i=>i.color);return Xn.find(i=>!t.includes(i.hex))?.hex||Qr}const o2={class:"modal-content"},s2={class:"modal-body"},i2={class:"preview-section"},a2={class:"map-preview"},r2=["innerHTML"],l2={class:"options-grid"},c2={class:"option-button-content"},u2={class:"option-button-value icon-value"},d2=["innerHTML"],h2={class:"option-button-content"},f2={class:"option-button-value color-value"},p2=["disabled"],v2={class:"option-button-content"},m2={class:"option-button-value color-value"},g2={class:"option-button-content"},y2={class:"option-button-value icon-value"},_2=["innerHTML"],k2=["disabled"],b2={class:"option-button-content"},w2={class:"option-button-value color-value"},C2={class:"option-button-content"},L2={class:"option-button-value"},S2={class:"option-button-content"},x2={class:"option-button-value"},$2={key:0,class:"centered-popup"},I2={class:"popup-grid"},T2=["onClick"],M2=["innerHTML"],A2={key:0},E2={key:1,class:"centered-popup"},P2={class:"popup-grid"},D2=["title","onClick"],O2=["innerHTML"],R2={key:0},B2={key:2,class:"centered-popup"},N2={class:"popup-grid"},F2=["title","onClick"],U2=["innerHTML"],z2={key:0},H2={key:3,class:"centered-popup icon-popup"},V2={class:"popup-grid"},G2=["onClick"],Z2=["innerHTML"],j2={key:0},q2={key:4,class:"centered-popup"},W2={class:"popup-grid"},K2=["title","onClick"],Y2=["innerHTML"],J2={key:0},X2={key:5,class:"centered-popup"},Q2={class:"size-grid"},eL=["onClick"],tL=["innerHTML"],nL={key:6,class:"centered-popup"},oL={class:"rotation-content"},sL={class:"rotation-preview-container"},iL=["innerHTML"],aL={class:"rotation-control"},rL={class:"rotation-slider-container"},lL=["value"],cL={class:"rotation-value"},uL={class:"rotation-presets"},dL="#667eea",hL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=E(o.backgroundShape||"circle"),a=E(o.iconType||"none"),c=E(o.backgroundColor||""),u=E(o.borderColor||""),d=E(o.iconColor||""),p=E(o.size||"100"),f=E(o.mapRotation??""),g=E(null),_=re=>re==="default"?o.inheritedBackgroundShape||"circle":re==="none"?"none":re||"circle",b=re=>re==="default"||!re?z():re==="none"?"transparent":re,x=re=>re==="default"?o.inheritedBorderColor||"#ffffff":re==="none"||!re?"transparent":re,$=re=>{if(re==="default"){const se=o.inheritedType;return se&&se!=="default"&&Oi(se).category==="content"?se:"none"}return re==="none"||!re?"none":re},B=re=>re==="default"||!re?o.inheritedIconColor||"#ffffff":re==="none"?"transparent":re,P=re=>re==="default"?o.inheritedSize||"100":re||"100",M=re=>{if(re==="default"||re===""){const se=o.inheritedMapRotation;return se!==""&&se!==void 0&&se!==null&&parseInt(se,10)||0}return parseInt(re,10)||0},S=K(()=>{const re=o.inheritedBackgroundShape||"circle",se=zr.find(J=>J.value===re)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${se})`,showLabel:!0},...zr.filter(J=>J.value!=="none").map(J=>({...J,showLabel:!1}))]}),A=K(()=>{const re=pl.filter(Ue=>Ue.category==="content"),se=[{value:"none",label:"None",category:"content",showLabel:!0}],J=o.inheritedType;if(J&&J!=="default"){const Ue=Oi(J);Ue.category==="content"&&se.push({value:"default",label:`Default (${Ue.label||J})`,category:"content",showLabel:!0})}return se.push(...re.map(Ue=>({...Ue,showLabel:!1}))),se}),I=K(()=>{const re={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${re[o.inheritedSize]||"Normal"})`},...S0.map(J=>({value:J.value,label:re[J.value]||J.label}))]}),T=K(()=>_(s.value)!=="none"),C=K(()=>$(a.value)!=="none"),V=K(()=>{const re=o.inheritedBackgroundColor;return re&&re!=="default"&&re.startsWith("#")?re:dL}),z=()=>V.value,ae=K(()=>c.value&&c.value!=="default"?c.value:z()),j=K(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),X=K(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),ce=K(()=>{const re=V.value,se=Xn.find(J=>J.hex.toLowerCase()===re.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${se})`,showLabel:!0},...Xn.map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Te=K(()=>{const re=o.inheritedBorderColor||"#ffffff",se=re==="#ffffff"?"White":Xn.find(J=>J.hex===re)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${se})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Xn.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Ae=K(()=>{const re=o.inheritedIconColor||"#ffffff",se=re==="#ffffff"?"White":Xn.find(J=>J.hex===re)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${se})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Xn.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Ce=re=>re==="default"?!c.value||c.value==="default":c.value===re,pe=re=>re==="#ffffff"?!d.value||d.value==="#ffffff":d.value===re,me=re=>{if(re==="none")return"None";if(re==="default"){const J=o.inheritedBackgroundShape;return J?`Default (${zr.find(Qe=>Qe.value===J)?.label||"Circle"})`:"Default (Circle)"}const se=zr.find(J=>J.value===re);return se?se.label:"Circle"},nt=re=>{if(re==="none")return"None";if(re==="default"){const J=o.inheritedType;if(J&&J!=="default"){const Ue=Oi(J);if(Ue.category==="content")return`Default (${Ue.label||J})`}return"Default"}const se=pl.find(J=>J.value===re);return se?se.label:"None"},Le=re=>{if(re==="none")return"None";if(!re||re==="default"){const J=V.value;return`Default (${Xn.find(Qe=>Qe.hex.toLowerCase()===J.toLowerCase())?.name||"Custom"})`}const se=[...Xn].find(J=>J.hex.toLowerCase()===re.toLowerCase());return se?se.name:re},Be=re=>{if(re==="none")return"None";if(re==="default"){const J=o.inheritedBorderColor;return J&&J!=="none"?`Default (${J==="#ffffff"?"White":Xn.find(Qe=>Qe.hex===J)?.name||"Custom"})`:"Default (White)"}if(!re||re==="#ffffff")return"White";const se=[...Te.value].find(J=>J.hex===re);return se?se.name:re},Ge=re=>{if(re==="none")return"None";if(re==="default"){const J=o.inheritedIconColor;return J?`Default (${J==="#ffffff"?"White":Xn.find(Qe=>Qe.hex===J)?.name||"Custom"})`:"Default (White)"}if(!re||re==="#ffffff")return"White";const se=[...Ae.value].find(J=>J.hex===re);return se?se.name:re},ue=re=>{const se={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(re==="default"){const J=o.inheritedSize;return`Default (${se[J]||"Normal"})`}return se[re]||"Normal"},Pe=re=>{if(re==="default"||re===""||re===void 0||re===null){const se=o.inheritedMapRotation;return se!==""&&se!==void 0&&se!==null?`Default (${se})`:"Default (0)"}return`${re}`},Ee=re=>{if(re==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const se=_(re),J=b(c.value),Ue=x(u.value);return ea[se]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${ea[se]({backgroundColor:J,borderColor:Ue==="transparent"?"none":Ue})}</svg>`:""},Me=re=>{const se=$(re);return se==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:en({type:se,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},de=re=>{const se=_(re);if(se==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const J=b(c.value),Ue=x(u.value),Qe=$(a.value),ot=B(d.value);return en({type:Qe!=="none"?Qe:se,backgroundShape:se,backgroundColor:J,borderColor:Ue==="transparent"?"none":Ue,iconColor:ot,size:"100",outputSize:28})},ke=re=>{const se=b(re),J=_(s.value),Ue=x(u.value),Qe=$(a.value),ot=B(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${se==="transparent"?"#e2e8f0":se}"/>
    </svg>`:en({type:Qe!=="none"?Qe:J,backgroundShape:J,backgroundColor:se==="transparent"?"#e2e8f0":se,borderColor:Ue==="transparent"?"none":Ue,iconColor:ot,size:"100",outputSize:28})},H=re=>{const se=x(re),J=_(s.value),Ue=b(c.value),Qe=$(a.value),ot=B(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${se}" stroke-width="2"/>
    </svg>`:en({type:Qe!=="none"?Qe:J,backgroundShape:J,backgroundColor:Ue,borderColor:se==="transparent"?"none":se,iconColor:ot,size:"100",outputSize:28})},Q=re=>{const se=$(re),J=_(s.value),Ue=b(c.value),Qe=x(u.value),ot=B(d.value);if(se==="none"&&J==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const vt=J!=="none"?J:"circle";return en({type:se!=="none"?se:vt,backgroundShape:vt,backgroundColor:Ue,borderColor:Qe==="transparent"?"none":Qe,iconColor:ot,size:"100",outputSize:42})},ie=re=>{const se=B(re),J=_(s.value),Ue=b(c.value),Qe=x(u.value),ot=$(a.value);return ot==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${se==="transparent"?"#e2e8f0":se}"/>
    </svg>`:en({type:ot,backgroundShape:J!=="none"?J:"circle",backgroundColor:Ue,borderColor:Qe==="transparent"?"none":Qe,iconColor:se==="transparent"?"#e2e8f0":se,size:"100",outputSize:28})},R=re=>{const se=P(re),J=_(s.value),Ue=b(c.value),Qe=x(u.value),ot=$(a.value),vt=B(d.value);if(J==="none"&&ot==="none")return"";const Tt=J!=="none"?J:"circle";return en({type:ot!=="none"?ot:Tt,backgroundShape:Tt,backgroundColor:Ue,borderColor:Qe==="transparent"?"none":Qe,iconColor:vt,size:se})},W=K(()=>{const re=_(s.value),se=b(c.value),J=x(u.value),Ue=$(a.value),Qe=B(d.value),ot=P(p.value);return re==="none"&&Ue==="none"?"":en(re==="none"&&Ue!=="none"?{type:Ue,backgroundShape:"none",backgroundColor:se,borderColor:"none",iconColor:Qe,size:ot}:{type:Ue!=="none"?Ue:re,backgroundShape:re,backgroundColor:se,borderColor:J==="transparent"?"none":J,iconColor:Qe,size:ot})}),oe=re=>{g.value=g.value===re?null:re},Y=()=>{g.value=null},F=re=>{s.value=re,Y()},N=re=>{c.value=re,Y()},te=re=>{u.value=re,Y()},ve=re=>{a.value=re,Y()},xe=re=>{d.value=re,Y()},we=re=>{p.value=re,Y()},Ve=re=>{f.value=re,Y()},$e=re=>{f.value=re};je(()=>o.isOpen,re=>{if(re){const se=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",J=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",Ue=o.backgroundColor&&o.backgroundColor!=="",Qe=o.borderColor&&o.borderColor!=="",ot=o.iconColor&&o.iconColor!=="",vt=o.size&&o.size!==""&&o.size!=="100",Tt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;se||J||Ue||Qe||ot||vt||Tt?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",c.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",c.value="default",u.value="default",d.value="default",p.value="default",f.value="default"),g.value=null}});const Ze=()=>{Y(),i("update:isOpen",!1),i("cancel")},We=()=>{Y();const re=Ue=>Ue==="default"?"":Ue;let se="";a.value==="none"?se="none":a.value&&a.value!=="default"&&(se=a.value);let J="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(J=parseInt(f.value,10)||0),i("apply",{iconType:se,backgroundShape:re(s.value),backgroundColor:re(c.value),borderColor:re(u.value),iconColor:re(d.value),size:re(p.value),mapRotation:J}),i("update:isOpen",!1)};return(re,se)=>e.isOpen?(v(),y("div",{key:0,class:"modal-overlay",onClick:ft(Ze,["self"])},[l("div",o2,[l("div",{class:"modal-header"},[se[15]||(se[15]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:Ze},"")]),l("div",s2,[l("div",i2,[l("div",a2,[se[16]||(se[16]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:it({transform:`rotate(${M(f.value)}deg)`}),innerHTML:W.value},null,12,r2)])]),l("div",l2,[l("button",{type:"button",class:fe(["option-button",{active:g.value==="shape"}]),onClick:se[0]||(se[0]=J=>oe("shape"))},[l("div",c2,[se[17]||(se[17]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",u2,[l("div",{class:"icon-preview-small",innerHTML:Ee(s.value)},null,8,d2),l("span",null,k(me(s.value)),1)])]),se[18]||(se[18]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:fe(["option-button",{active:g.value==="bgColor"}]),onClick:se[1]||(se[1]=J=>oe("bgColor"))},[l("div",h2,[se[19]||(se[19]=l("span",{class:"option-button-label"},"Background",-1)),l("div",f2,[l("span",{class:"color-swatch",style:it({backgroundColor:ae.value})},null,4),l("span",null,k(Le(c.value)),1)])]),se[20]||(se[20]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:fe(["option-button",{active:g.value==="borderColor",disabled:!T.value}]),disabled:!T.value,onClick:se[2]||(se[2]=J=>oe("borderColor"))},[l("div",v2,[se[21]||(se[21]=l("span",{class:"option-button-label"},"Border",-1)),l("div",m2,[l("span",{class:fe(["color-swatch",{"no-border":u.value==="none"}]),style:it(u.value!=="none"?{backgroundColor:j.value}:{})},null,6),l("span",null,k(Be(u.value)),1)])]),se[22]||(se[22]=l("span",{class:"option-button-arrow"},"",-1))],10,p2),l("button",{type:"button",class:fe(["option-button",{active:g.value==="icon"}]),onClick:se[3]||(se[3]=J=>oe("icon"))},[l("div",g2,[se[23]||(se[23]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",y2,[l("div",{class:"icon-preview-small",innerHTML:Me(a.value)},null,8,_2),l("span",null,k(nt(a.value)),1)])]),se[24]||(se[24]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:fe(["option-button",{active:g.value==="iconColor",disabled:!C.value}]),disabled:!C.value,onClick:se[4]||(se[4]=J=>oe("iconColor"))},[l("div",b2,[se[25]||(se[25]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",w2,[l("span",{class:"color-swatch",style:it({backgroundColor:X.value})},null,4),l("span",null,k(Ge(d.value)),1)])]),se[26]||(se[26]=l("span",{class:"option-button-arrow"},"",-1))],10,k2),l("button",{type:"button",class:fe(["option-button",{active:g.value==="size"}]),onClick:se[5]||(se[5]=J=>oe("size"))},[l("div",C2,[se[27]||(se[27]=l("span",{class:"option-button-label"},"Size",-1)),l("span",L2,k(ue(p.value)),1)]),se[28]||(se[28]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:fe(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:se[6]||(se[6]=J=>oe("mapRotation"))},[l("div",S2,[se[29]||(se[29]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",x2,k(Pe(f.value)),1)]),se[30]||(se[30]=l("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),y("div",$2,[l("div",{class:"popup-header"},[se[31]||(se[31]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",I2,[(v(!0),y(be,null,Oe(S.value,J=>(v(),y("button",{key:J.value,type:"button",class:fe(["popup-grid-item",{selected:s.value===J.value}]),onClick:Ue=>F(J.value)},[l("div",{class:"popup-item-preview",innerHTML:de(J.value)},null,8,M2),J.showLabel?(v(),y("span",A2,k(J.label),1)):D("",!0)],10,T2))),128))])])):D("",!0),g.value==="bgColor"?(v(),y("div",E2,[l("div",{class:"popup-header"},[se[32]||(se[32]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",P2,[(v(!0),y(be,null,Oe(ce.value,J=>(v(),y("button",{key:J.hex,type:"button",class:fe(["popup-grid-item",{selected:Ce(J.hex)}]),title:J.name,onClick:Ue=>N(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:ke(J.hex)},null,8,O2),J.showLabel?(v(),y("span",R2,k(J.name),1)):D("",!0)],10,D2))),128))])])):D("",!0),g.value==="borderColor"?(v(),y("div",B2,[l("div",{class:"popup-header"},[se[33]||(se[33]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",N2,[(v(!0),y(be,null,Oe(Te.value,J=>(v(),y("button",{key:J.hex,type:"button",class:fe(["popup-grid-item",{selected:u.value===J.hex}]),title:J.name,onClick:Ue=>te(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:H(J.hex)},null,8,U2),J.showLabel?(v(),y("span",z2,k(J.name),1)):D("",!0)],10,F2))),128))])])):D("",!0),g.value==="icon"?(v(),y("div",H2,[l("div",{class:"popup-header"},[se[34]||(se[34]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",V2,[(v(!0),y(be,null,Oe(A.value,J=>(v(),y("button",{key:J.value,type:"button",class:fe(["popup-grid-item",{selected:a.value===J.value}]),onClick:Ue=>ve(J.value)},[l("div",{class:"popup-item-preview",innerHTML:Q(J.value)},null,8,Z2),J.showLabel?(v(),y("span",j2,k(J.label),1)):D("",!0)],10,G2))),128))])])):D("",!0),g.value==="iconColor"?(v(),y("div",q2,[l("div",{class:"popup-header"},[se[35]||(se[35]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",W2,[(v(!0),y(be,null,Oe(Ae.value,J=>(v(),y("button",{key:J.hex,type:"button",class:fe(["popup-grid-item",{selected:pe(J.hex)}]),title:J.name,onClick:Ue=>xe(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:ie(J.hex)},null,8,Y2),J.showLabel?(v(),y("span",J2,k(J.name),1)):D("",!0)],10,K2))),128))])])):D("",!0),g.value==="size"?(v(),y("div",X2,[l("div",{class:"popup-header"},[se[36]||(se[36]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",Q2,[(v(!0),y(be,null,Oe(I.value,J=>(v(),y("button",{key:J.value,type:"button",class:fe(["size-grid-item",{selected:p.value===J.value}]),onClick:Ue=>we(J.value)},[l("div",{class:"size-preview",innerHTML:R(J.value)},null,8,tL),l("span",null,k(J.label),1)],10,eL))),128))])])):D("",!0),g.value==="mapRotation"?(v(),y("div",nL,[l("div",{class:"popup-header"},[se[37]||(se[37]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:Y},"")]),l("div",oL,[l("div",sL,[l("div",{class:"rotation-preview-icon",style:it({transform:`rotate(${M(f.value)}deg)`}),innerHTML:W.value},null,12,iL)]),se[38]||(se[38]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",aL,[l("button",{type:"button",class:fe(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:se[7]||(se[7]=J=>Ve("default"))}," Default ",2),l("div",rL,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:se[8]||(se[8]=J=>$e(parseInt(J.target.value,10)))},null,40,lL),l("div",cL,k(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),l("div",uL,[l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===-90}]),onClick:se[9]||(se[9]=J=>Ve(-90))},"-90",2),l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===-45}]),onClick:se[10]||(se[10]=J=>Ve(-45))},"-45",2),l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===0}]),onClick:se[11]||(se[11]=J=>Ve(0))},"0",2),l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===45}]),onClick:se[12]||(se[12]=J=>Ve(45))},"+45",2),l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===90}]),onClick:se[13]||(se[13]=J=>Ve(90))},"+90",2),l("button",{type:"button",class:fe(["rotation-preset-btn",{selected:f.value===180}]),onClick:se[14]||(se[14]=J=>Ve(180))},"180",2)])])])):D("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:Ze},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:We},"Apply")])])])):D("",!0)}},fL=Ke(hL,[["__scopeId","data-v-d83aaf03"]]),pL={class:"checkpoint-style-picker"},vL={class:"form-group"},mL={class:"style-options"},gL=["innerHTML"],yL={class:"option-label"},_L=["innerHTML"],kL="#667eea",bL={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=E(o.styleType),a=E(o.styleColor||""),c=E(o.styleBackgroundShape||"default"),u=E(o.styleBackgroundColor||""),d=E(o.styleBorderColor||""),p=E(o.styleIconColor||""),f=E(o.styleSize||"default"),g=E(o.styleMapRotation||""),_=j=>!j||j==="default"?!1:Oi(j).category==="content",b=E(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&_(o.styleType)?o.styleType:"default"),x=E(!1),$=K(()=>!!(s.value&&s.value!=="default"||c.value&&c.value!=="default"&&c.value!=="circle"||u.value||d.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),B=j=>j&&j!==""&&j!=="default",P=j=>j&&j.startsWith("#"),M=K(()=>{const X=B(o.inheritedStyleType),ce=B(o.inheritedBackgroundShape),Te=P(o.inheritedBackgroundColor)||P(o.inheritedStyleColor),Ae=P(o.inheritedBorderColor),Ce=P(o.inheritedIconColor),pe=B(o.inheritedSize);if(X||ce||Te||Ae||Ce||pe){const nt=X?o.inheritedStyleType:ce?o.inheritedBackgroundShape:"circle",Le=(P(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(P(o.inheritedStyleColor)?o.inheritedStyleColor:null)||kL;return en({type:nt,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:Le,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),S=K(()=>{const j=o.inheritedMapRotation;return j!==""&&j!==void 0&&j!==null&&j!==0?{transform:`rotate(${j}deg)`}:{}}),A=K(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const X=parseInt(g.value,10)||0;if(X!==0)return{transform:`rotate(${X}deg)`}}const j=o.inheritedMapRotation;return j!==""&&j!==void 0&&j!==null&&j!==0?{transform:`rotate(${j}deg)`}:{}}),I=K(()=>{if($.value){const j=b.value&&b.value!=="none"&&b.value!=="default";let X=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&Oi(o.inheritedStyleType).category==="content"&&(X=o.inheritedStyleType);const ce=b.value==="default"&&X,Te=j||ce,Ae=j?b.value:ce?X:null,Ce=c.value&&c.value!=="default"?c.value:o.inheritedBackgroundShape||"circle",pe=Te?Ae:Ce,me=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",nt=d.value||o.inheritedBorderColor||"#ffffff",Le=p.value||o.inheritedIconColor||"#ffffff";return en({type:pe,backgroundShape:Ce,backgroundColor:me,borderColor:nt,iconColor:Le,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),T=()=>{s.value="default",b.value="default",i("update:styleType","default"),c.value="default",u.value="",a.value="",d.value="",p.value="",f.value="default",g.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),ae()},C=()=>{x.value=!0},V=j=>{j.iconType==="none"?b.value="none":j.iconType?b.value=j.iconType:b.value="default",c.value=j.backgroundShape||"default",u.value=j.backgroundColor||"",d.value=j.borderColor||"",p.value=j.iconColor||"",f.value=j.size||"default",g.value=j.mapRotation??"";const X=j.iconType==="none"||j.iconType&&j.iconType!==""||j.backgroundShape||j.backgroundColor||j.borderColor||j.iconColor||j.size||j.mapRotation!==""&&j.mapRotation!==0;j.iconType&&j.iconType!=="none"?s.value=j.iconType:X?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",j.backgroundShape),i("update:styleBackgroundColor",j.backgroundColor),i("update:styleBorderColor",j.borderColor),i("update:styleIconColor",j.iconColor),i("update:styleSize",j.size),i("update:styleMapRotation",j.mapRotation??""),ae()},z=()=>{},ae=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:c.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:g.value})};return je(()=>o.styleType,j=>{s.value=j,j&&j!=="default"&&j!=="custom"&&_(j)?b.value=j:b.value="default"}),je(()=>o.styleColor,j=>{a.value=j||""}),je(()=>o.styleBackgroundShape,j=>{c.value=j||"default"}),je(()=>o.styleBackgroundColor,j=>{u.value=j||""}),je(()=>o.styleBorderColor,j=>{d.value=j||""}),je(()=>o.styleIconColor,j=>{p.value=j||""}),je(()=>o.styleSize,j=>{f.value=j||"default"}),je(()=>o.styleMapRotation,j=>{g.value=j??""}),(j,X)=>(v(),y("div",pL,[l("div",vL,[l("label",null,k(e.iconLabel),1),l("div",mL,[l("button",{type:"button",class:fe(["style-option-button",{selected:!$.value}]),onClick:T},[l("div",{class:"option-preview",style:it(S.value),innerHTML:M.value},null,12,gL),l("span",yL,k(e.defaultLabel),1)],2),l("button",{type:"button",class:fe(["style-option-button",{selected:$.value}]),onClick:C},[l("div",{class:"option-preview",style:it(A.value),innerHTML:I.value},null,12,_L),X[1]||(X[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Re(fL,{isOpen:x.value,"onUpdate:isOpen":X[0]||(X[0]=ce=>x.value=ce),"icon-type":b.value,"background-shape":c.value,"background-color":u.value,"border-color":d.value,"icon-color":p.value,size:f.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:V,onCancel:z},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Eu=Ke(bL,[["__scopeId","data-v-c066da64"]]),wL={class:"logo-uploader"},CL={key:0,class:"logo-preview"},LL=["src"],SL=["disabled"],xL={key:0,class:"upload-progress"},$L={key:1,class:"upload-prompt"},IL={key:2,class:"error-message"},Ph=500*1024,TL={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=E(null),a=E(!1),c=E(!1),u=E(""),d=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function p(){a.value||s.value?.click()}function f(x){const $=x.target.files?.[0];$&&_($),s.value&&(s.value.value="")}function g(x){c.value=!1;const $=x.dataTransfer?.files?.[0];$&&_($)}async function _(x){if(u.value="",!d.includes(x.type)){u.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(x.size>Ph){u.value=`File too large. Maximum size is ${Ph/1024}KB.`;return}a.value=!0;try{const $=await fetch(`/api/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":x.type,"X-Admin-Email":o.adminEmail},body:x});if(!$.ok){const P=await $.json().catch(()=>({}));throw new Error(P.message||"Upload failed")}const B=await $.json();i("update:modelValue",B.logoUrl)}catch($){console.error("Logo upload error:",$),u.value=$.message||"Failed to upload logo. Please try again."}finally{a.value=!1}}async function b(){u.value="",a.value=!0;try{const x=await fetch(`/api/events/${o.eventId}/logo`,{method:"DELETE",headers:{"X-Admin-Email":o.adminEmail}});if(!x.ok){const $=await x.json().catch(()=>({}));throw new Error($.message||"Delete failed")}i("update:modelValue","")}catch(x){console.error("Logo delete error:",x),u.value=x.message||"Failed to remove logo. Please try again."}finally{a.value=!1}}return(x,$)=>(v(),y("div",wL,[$[4]||($[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(v(),y("div",CL,[l("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,LL),l("button",{type:"button",class:"remove-btn",onClick:b,disabled:a.value}," Remove ",8,SL)])):(v(),y("div",{key:1,class:fe(["upload-area",{"drag-over":c.value,uploading:a.value}]),onDragover:$[0]||($[0]=ft(B=>c.value=!0,["prevent"])),onDragleave:$[1]||($[1]=ft(B=>c.value=!1,["prevent"])),onDrop:ft(g,["prevent"]),onClick:p},[l("input",{ref_key:"fileInput",ref:s,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:f},null,544),a.value?(v(),y("div",xL,[...$[2]||($[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),y("div",$L,[...$[3]||($[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 500KB)",-1)])]))],34)),u.value?(v(),y("div",IL,k(u.value),1)):D("",!0)]))}},ML=Ke(TL,[["__scopeId","data-v-18fc4701"]]),iv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function AL(){return{...iv[0]}}function EL(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function su(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function av(e){return!e||e===""?"#ffffff":su(e)>.179?"#333333":"#ffffff"}function rv(e,t){const o=e||Nn.headerGradientStart,i=t||Nn.headerGradientEnd,s=su(o),a=su(i);return(s+a)/2>.35?"#333333":"#ffffff"}const Nn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},PL={class:"marshal-mockup-container"},DL={class:"presets-section"},OL={class:"presets-row"},RL=["title","onClick"],BL={class:"preset-name"},NL={class:"mockup-frame"},FL={key:0,class:"logo-cover-bg"},UL=["src"],zL=["src"],HL={key:1,class:"logo-placeholder"},VL={class:"event-name"},GL={class:"mockup-buttons"},ZL=["src"],jL={key:1,class:"logo-placeholder"},qL={class:"mockup-body"},WL={class:"mockup-card"},KL={class:"card-content"},YL={class:"editor-modal"},JL={class:"editor-header"},XL={class:"editor-content"},QL={class:"color-grid-inline"},eS={class:"color-field"},tS={class:"color-swatches"},nS=["title","onClick"],oS={key:0,class:"check"},sS={class:"color-field"},iS={class:"color-swatches"},aS=["title","onClick"],rS={key:0,class:"check"},lS={class:"logo-position-section"},cS={class:"position-buttons"},uS={class:"color-swatches"},dS=["title","onClick"],hS={key:0,class:"check"},fS={class:"color-grid-inline"},pS={class:"color-field"},vS={class:"color-swatches"},mS=["title","onClick"],gS={key:0,class:"check"},yS={class:"color-field"},_S={class:"color-swatches"},kS=["title","onClick"],bS={key:0,class:"check"},wS={class:"editor-footer"},CS={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=Xn,i=e,s=t,a=E(null),c=iv,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},d=K(()=>i.branding.headerGradientStart||Nn.headerGradientStart),p=K(()=>i.branding.headerGradientEnd||Nn.headerGradientEnd),f=K(()=>i.branding.accentColor||Nn.accentColor),g=K(()=>i.branding.pageGradientStart||Nn.pageGradientStart),_=K(()=>i.branding.pageGradientEnd||Nn.pageGradientEnd),b=K(()=>i.branding.logoPosition||"left"),x=K(()=>({background:`linear-gradient(135deg, ${d.value} 0%, ${p.value} 100%)`})),$=K(()=>rv(d.value,p.value)),B=K(()=>({background:f.value,color:av(f.value)})),P=K(()=>({background:`linear-gradient(135deg, ${g.value} 0%, ${_.value} 100%)`}));function M(I){a.value=a.value===I?null:I}function S(I,T){s("update:branding",{...i.branding,[I]:T})}function A(I){s("update:branding",EL(i.branding,I)),a.value=null}return(I,T)=>(v(),y("div",PL,[l("div",DL,[T[13]||(T[13]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",OL,[(v(!0),y(be,null,Oe(G(c),C=>(v(),y("button",{key:C.name,type:"button",class:"preset-btn",title:C.name,onClick:V=>A(C)},[l("span",{class:"preset-preview",style:it({background:`linear-gradient(135deg, ${C.pageGradientStart} 0%, ${C.pageGradientEnd} 100%)`})},null,4),l("span",BL,k(C.name),1)],8,RL))),128))])]),l("div",NL,[l("div",{class:fe(["mockup-page",{"region-active":a.value==="page"}]),style:it(P.value),onClick:T[5]||(T[5]=C=>M("page"))},[l("div",{class:fe(["mockup-header",[{"region-active":a.value==="header"},`logo-${b.value}`]]),style:it(x.value),onClick:T[3]||(T[3]=ft(C=>M("header"),["stop"]))},[e.branding.logoUrl&&b.value==="cover"?(v(),y("div",FL,[l("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,UL)])):D("",!0),b.value==="left"?(v(),y("div",{key:1,class:fe(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:T[0]||(T[0]=ft(C=>M("logo"),["stop"]))},[e.branding.logoUrl?(v(),y("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,zL)):(v(),y("span",HL,"+ Logo"))],2)):D("",!0),l("div",{class:fe(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&b.value!=="left"&&b.value!=="right"}]),onClick:T[1]||(T[1]=ft(C=>M("logo"),["stop"]))},[l("div",{class:"mockup-title",style:it({color:$.value})},[l("span",VL,k(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:it({color:$.value})},k(e.eventDate||"Event Date"),5),l("div",GL,[T[14]||(T[14]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:it({color:$.value})},"Logout",4)])],2),b.value==="right"?(v(),y("div",{key:2,class:fe(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:T[2]||(T[2]=ft(C=>M("logo"),["stop"]))},[e.branding.logoUrl?(v(),y("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,ZL)):(v(),y("span",jL,"+ Logo"))],2)):D("",!0)],6),l("div",qL,[l("div",WL,[T[15]||(T[15]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",KL,[l("div",{class:fe(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:it(B.value),onClick:T[4]||(T[4]=ft(C=>M("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(v(),y("div",{key:0,class:"editor-overlay",onClick:T[12]||(T[12]=ft(C=>a.value=null,["self"]))},[l("div",YL,[l("div",JL,[l("span",null,k(u[a.value]),1),l("button",{type:"button",class:"editor-close",onClick:T[6]||(T[6]=C=>a.value=null)},"")]),l("div",XL,[a.value==="header"?(v(),y(be,{key:0},[T[18]||(T[18]=l("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),l("div",QL,[l("div",eS,[T[16]||(T[16]=l("label",null,"Start colour",-1)),l("div",tS,[(v(!0),y(be,null,Oe(G(o),C=>(v(),y("button",{key:"hs-"+C.hex,type:"button",class:fe(["color-swatch-btn",{selected:e.branding.headerGradientStart===C.hex}]),style:it({backgroundColor:C.hex}),title:C.name,onClick:V=>S("headerGradientStart",C.hex)},[e.branding.headerGradientStart===C.hex?(v(),y("span",oS,"")):D("",!0)],14,nS))),128))])]),l("div",sS,[T[17]||(T[17]=l("label",null,"End colour",-1)),l("div",iS,[(v(!0),y(be,null,Oe(G(o),C=>(v(),y("button",{key:"he-"+C.hex,type:"button",class:fe(["color-swatch-btn",{selected:e.branding.headerGradientEnd===C.hex}]),style:it({backgroundColor:C.hex}),title:C.name,onClick:V=>S("headerGradientEnd",C.hex)},[e.branding.headerGradientEnd===C.hex?(v(),y("span",rS,"")):D("",!0)],14,aS))),128))])])])],64)):D("",!0),a.value==="logo"?(v(),y(be,{key:1},[l("div",lS,[T[19]||(T[19]=l("label",{class:"editor-label"},"Position",-1)),l("div",cS,[l("button",{type:"button",class:fe(["position-btn",{selected:b.value==="left"}]),onClick:T[7]||(T[7]=C=>S("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:fe(["position-btn",{selected:b.value==="right"}]),onClick:T[8]||(T[8]=C=>S("logoPosition","right"))}," Right ",2),l("button",{type:"button",class:fe(["position-btn",{selected:b.value==="cover"}]),onClick:T[9]||(T[9]=C=>S("logoPosition","cover"))}," Cover ",2)])]),Re(ML,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":T[10]||(T[10]=C=>S("logoUrl",C))},null,8,["model-value","event-id","admin-email"])],64)):D("",!0),a.value==="accent"?(v(),y(be,{key:2},[T[20]||(T[20]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",uS,[(v(!0),y(be,null,Oe(G(o),C=>(v(),y("button",{key:"ac-"+C.hex,type:"button",class:fe(["color-swatch-btn",{selected:e.branding.accentColor===C.hex}]),style:it({backgroundColor:C.hex}),title:C.name,onClick:V=>S("accentColor",C.hex)},[e.branding.accentColor===C.hex?(v(),y("span",hS,"")):D("",!0)],14,dS))),128))])],64)):D("",!0),a.value==="page"?(v(),y(be,{key:3},[T[23]||(T[23]=l("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),l("div",fS,[l("div",pS,[T[21]||(T[21]=l("label",null,"Start colour",-1)),l("div",vS,[(v(!0),y(be,null,Oe(G(o),C=>(v(),y("button",{key:"ps-"+C.hex,type:"button",class:fe(["color-swatch-btn",{selected:e.branding.pageGradientStart===C.hex}]),style:it({backgroundColor:C.hex}),title:C.name,onClick:V=>S("pageGradientStart",C.hex)},[e.branding.pageGradientStart===C.hex?(v(),y("span",gS,"")):D("",!0)],14,mS))),128))])]),l("div",yS,[T[22]||(T[22]=l("label",null,"End colour",-1)),l("div",_S,[(v(!0),y(be,null,Oe(G(o),C=>(v(),y("button",{key:"pe-"+C.hex,type:"button",class:fe(["color-swatch-btn",{selected:e.branding.pageGradientEnd===C.hex}]),style:it({backgroundColor:C.hex}),title:C.name,onClick:V=>S("pageGradientEnd",C.hex)},[e.branding.pageGradientEnd===C.hex?(v(),y("span",bS,"")):D("",!0)],14,kS))),128))])])])],64)):D("",!0)]),l("div",wS,[l("button",{type:"button",class:"btn-done",onClick:T[11]||(T[11]=C=>a.value=null)},"Done")])])])):D("",!0),T[24]||(T[24]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},LS=Ke(CS,[["__scopeId","data-v-925e9964"]]),SS={class:"settings-tab"},xS={class:"accordion"},$S={class:"accordion-section"},IS={class:"accordion-title"},TS={class:"accordion-icon"},MS={key:0,class:"accordion-content"},AS={class:"accordion-section"},ES={class:"accordion-icon"},PS={key:0,class:"accordion-content"},DS={class:"terminology-grid"},OS={class:"term-group"},RS=["value"],BS={class:"term-group"},NS=["value"],FS={class:"term-group"},US=["value"],zS={class:"term-group"},HS=["value"],VS={class:"term-group"},GS=["value"],ZS={class:"form-actions"},jS=["disabled"],qS={class:"accordion-section"},WS={class:"accordion-title"},KS={class:"accordion-icon"},YS={key:0,class:"accordion-content"},JS={class:"section-description"},XS={class:"form-actions"},QS=["disabled"],ex={class:"accordion-section"},tx={class:"accordion-title"},nx={class:"accordion-icon"},ox={key:0,class:"accordion-content"},sx={class:"section-description"},ix={class:"form-actions"},ax=["disabled"],Dh="admin_settings_accordion",rx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=va(),a=K(()=>s.adminEmail||""),c=e,u=t,d=E({...c.eventData}),p=()=>c.eventId?`${Dh}_${c.eventId}`:Dh,f=E(null);Yt(()=>{const S=localStorage.getItem(p());S&&(f.value=S)});const g=K(()=>{const S=d.value.peopleTerm||"Marshals";return Cs.checkpoint.map(A=>({value:A,label:eu(A,S)}))}),_=S=>{const A=f.value===S?null:S;f.value=A,A?localStorage.setItem(p(),A):localStorage.removeItem(p())};je(()=>c.eventData,S=>{d.value={...S}},{deep:!0});const b=()=>{u("update:formDirty",!0)},x=(S,A)=>{d.value[S]=A,b()},$=K(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),B=S=>{d.value.brandingHeaderGradientStart=S.headerGradientStart,d.value.brandingHeaderGradientEnd=S.headerGradientEnd,d.value.brandingLogoUrl=S.logoUrl,d.value.brandingLogoPosition=S.logoPosition,d.value.brandingAccentColor=S.accentColor,d.value.brandingPageGradientStart=S.pageGradientStart,d.value.brandingPageGradientEnd=S.pageGradientEnd,b()},P=()=>{AL(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",b()},M=()=>{u("submit",{...d.value})};return(S,A)=>(v(),y("div",SS,[l("div",xS,[l("div",$S,[l("button",{class:fe(["accordion-header",{active:f.value==="admins"}]),onClick:A[0]||(A[0]=I=>_("admins"))},[l("span",IS,"Administrators ("+k(e.admins.length)+")",1),l("span",TS,k(f.value==="admins"?"-":"+"),1)],2),f.value==="admins"?(v(),y("div",MS,[Re(n2,{admins:e.admins,onAddAdmin:A[1]||(A[1]=I=>S.$emit("add-admin")),onRemoveAdmin:A[2]||(A[2]=I=>S.$emit("remove-admin",I))},null,8,["admins"])])):D("",!0)]),l("div",AS,[l("button",{class:fe(["accordion-header",{active:f.value==="terminology"}]),onClick:A[3]||(A[3]=I=>_("terminology"))},[A[19]||(A[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",ES,k(f.value==="terminology"?"-":"+"),1)],2),f.value==="terminology"?(v(),y("div",PS,[A[20]||(A[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",DS,[l("div",OS,[l("label",null,k(G(o).people)+" are called",1),Ne(l("select",{"onUpdate:modelValue":A[4]||(A[4]=I=>d.value.peopleTerm=I),class:"form-input",onChange:b},[(v(!0),y(be,null,Oe(G(Cs).people,I=>(v(),y("option",{key:I,value:I},k(I),9,RS))),128))],544),[[pn,d.value.peopleTerm]])]),l("div",BS,[l("label",null,k(G(o).checkpoints)+" are called",1),Ne(l("select",{"onUpdate:modelValue":A[5]||(A[5]=I=>d.value.checkpointTerm=I),class:"form-input",onChange:b},[(v(!0),y(be,null,Oe(g.value,I=>(v(),y("option",{key:I.value,value:I.value},k(I.label),9,NS))),128))],544),[[pn,d.value.checkpointTerm]])]),l("div",FS,[l("label",null,k(G(o).areas)+" are called",1),Ne(l("select",{"onUpdate:modelValue":A[6]||(A[6]=I=>d.value.areaTerm=I),class:"form-input",onChange:b},[(v(!0),y(be,null,Oe(G(Cs).area,I=>(v(),y("option",{key:I,value:I},k(I),9,US))),128))],544),[[pn,d.value.areaTerm]])]),l("div",zS,[l("label",null,k(G(o).checklists)+" are called",1),Ne(l("select",{"onUpdate:modelValue":A[7]||(A[7]=I=>d.value.checklistTerm=I),class:"form-input",onChange:b},[(v(!0),y(be,null,Oe(G(Cs).checklist,I=>(v(),y("option",{key:I,value:I},k(I),9,HS))),128))],544),[[pn,d.value.checklistTerm]])]),l("div",VS,[l("label",null,k(G(o).course)+" is called",1),Ne(l("select",{"onUpdate:modelValue":A[8]||(A[8]=I=>d.value.courseTerm=I),class:"form-input",onChange:b},[(v(!0),y(be,null,Oe(G(Cs).course,I=>(v(),y("option",{key:I,value:I},k(I),9,GS))),128))],544),[[pn,d.value.courseTerm]])])]),l("div",ZS,[l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,jS)])])):D("",!0)]),l("div",qS,[l("button",{class:fe(["accordion-header",{active:f.value==="appearance"}]),onClick:A[9]||(A[9]=I=>_("appearance"))},[l("span",WS,k(G(o).checkpoint)+" appearance",1),l("span",KS,k(f.value==="appearance"?"-":"+"),1)],2),f.value==="appearance"?(v(),y("div",YS,[l("p",JS," Set the default marker style for all "+k(G(i).checkpoints)+" in this event. Individual "+k(G(i).areas)+" and "+k(G(i).checkpoints)+" can override this setting. ",1),Re(Eu,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":A[10]||(A[10]=I=>x("defaultCheckpointStyleType",I)),"onUpdate:styleColor":A[11]||(A[11]=I=>x("defaultCheckpointStyleColor",I)),"onUpdate:styleBackgroundShape":A[12]||(A[12]=I=>x("defaultCheckpointStyleBackgroundShape",I)),"onUpdate:styleBackgroundColor":A[13]||(A[13]=I=>x("defaultCheckpointStyleBackgroundColor",I)),"onUpdate:styleBorderColor":A[14]||(A[14]=I=>x("defaultCheckpointStyleBorderColor",I)),"onUpdate:styleIconColor":A[15]||(A[15]=I=>x("defaultCheckpointStyleIconColor",I)),"onUpdate:styleSize":A[16]||(A[16]=I=>x("defaultCheckpointStyleSize",I)),"onUpdate:styleMapRotation":A[17]||(A[17]=I=>x("defaultCheckpointStyleMapRotation",I))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",XS,[l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,QS)])])):D("",!0)]),l("div",ex,[l("button",{class:fe(["accordion-header",{active:f.value==="branding"}]),onClick:A[18]||(A[18]=I=>_("branding"))},[l("span",tx,k(G(o).person)+" branding",1),l("span",nx,k(f.value==="branding"?"-":"+"),1)],2),f.value==="branding"?(v(),y("div",ox,[l("p",sx," Customise the appearance of the "+k(G(i).person)+" view to match your organisation's branding. ",1),Re(LS,{branding:$.value,"event-name":d.value.name,"event-date":G(nv)(d.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":B},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",ix,[l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,ax),l("button",{onClick:P,class:"btn btn-secondary"}," Reset to Default ")])])):D("",!0)])])]))}},lx=Ke(rx,[["__scopeId","data-v-d6c3dcdb"]]),cx={class:"incident-header"},ux={class:"incident-title-row"},dx={class:"incident-title"},hx={class:"incident-badges"},fx={key:0,class:"incident-description"},px={class:"incident-context"},vx={key:0,class:"context-item"},mx={key:1,class:"context-item"},gx={key:2,class:"context-item"},yx={class:"incident-footer"},_x={class:"reporter-info"},kx={class:"time-info"},bx={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=K(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),i=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,a=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",c=u=>{if(!u)return"";const d=new Date(u),f=new Date-d,g=Math.floor(f/6e4),_=Math.floor(f/36e5),b=Math.floor(f/864e5);return g<1?"just now":g<60?`${g}m ago`:_<24?`${_}h ago`:b<7?`${b}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),y("div",{class:fe(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=p=>u.$emit("select",e.incident))},[l("div",cx,[l("div",ux,[l("span",{class:fe(["severity-indicator",e.incident.severity])},null,2),l("strong",dx,k(o.value),1)]),l("div",hx,[l("span",{class:fe(["severity-badge",e.incident.severity])},k(i(e.incident.severity)),3),l("span",{class:fe(["status-badge",e.incident.status])},k(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),y("div",fx,k(a(e.incident.description)),1)):D("",!0),l("div",px,[e.incident.context?.checkpoint?(v(),y("div",vx,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,k(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),y("div",mx,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):D("",!0),e.incident.area?(v(),y("div",gx,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,k(e.incident.area.areaName),1)])):D("",!0)]),l("div",yx,[l("span",_x," Reported by "+k(e.incident.reportedBy?.name||"Unknown"),1),l("span",kx,k(c(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},ma=Ke(bx,[["__scopeId","data-v-690fd385"]]),wx={class:"incidents-tab"},Cx={class:"tab-header"},Lx={class:"button-group"},Sx={key:0,class:"status-pills"},xx={class:"filters-section"},$x={class:"search-group"},Ix={class:"incidents-list"},Tx={key:0,class:"loading-state"},Mx={key:1,class:"empty-state"},Ax={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,i=E(""),s=E("all"),a=_=>{s.value=_},c=K(()=>o.incidents.filter(_=>_.status==="open").length),u=K(()=>o.incidents.filter(_=>_.status==="in_progress"||_.status==="acknowledged").length),d=K(()=>o.incidents.filter(_=>_.status==="resolved").length),p=K(()=>o.incidents.filter(_=>_.status==="closed").length),f=K(()=>{let _=o.incidents;if(s.value==="open"?_=_.filter(b=>b.status==="open"):s.value==="in-progress"?_=_.filter(b=>b.status==="in_progress"||b.status==="acknowledged"):s.value==="resolved"?_=_.filter(b=>b.status==="resolved"):s.value==="closed"&&(_=_.filter(b=>b.status==="closed")),i.value.trim()){const b=i.value.toLowerCase().trim().split(/\s+/);_=_.filter(x=>{const $=`${x.context?.checkpoint?.name||""} ${x.context?.checkpoint?.description||""}`,B=x.area?.areaName||"",P=[x.reportedBy?.name||"",...(x.context?.peopleAtCheckpoint||[]).map(A=>A.name||"")].join(" "),M=(x.updates||[]).map(A=>A.note||"").join(" "),S=`${x.title||""} ${x.description||""} ${$} ${B} ${P} ${M}`.toLowerCase();return b.every(A=>S.includes(A))})}return _}),g=K(()=>[...f.value].sort((_,b)=>new Date(b.incidentTime||b.createdAt)-new Date(_.incidentTime||_.createdAt)));return(_,b)=>(v(),y("div",wx,[l("div",Cx,[l("div",Lx,[l("button",{onClick:b[0]||(b[0]=x=>_.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),y("div",Sx,[Re(to,{variant:"neutral",active:s.value==="all",onClick:b[1]||(b[1]=x=>a("all"))},{default:qe(()=>[He(k(e.incidents.length)+" total ",1)]),_:1},8,["active"]),c.value>0?(v(),Xe(to,{key:0,variant:"info",active:s.value==="open",onClick:b[2]||(b[2]=x=>a("open"))},{default:qe(()=>[He(k(c.value)+" open ",1)]),_:1},8,["active"])):D("",!0),u.value>0?(v(),Xe(to,{key:1,variant:"purple",active:s.value==="in-progress",onClick:b[3]||(b[3]=x=>a("in-progress"))},{default:qe(()=>[He(k(u.value)+" in progress ",1)]),_:1},8,["active"])):D("",!0),d.value>0?(v(),Xe(to,{key:2,variant:"success",active:s.value==="resolved",onClick:b[4]||(b[4]=x=>a("resolved"))},{default:qe(()=>[He(k(d.value)+" resolved ",1)]),_:1},8,["active"])):D("",!0),p.value>0?(v(),Xe(to,{key:3,variant:"neutral",active:s.value==="closed",onClick:b[5]||(b[5]=x=>a("closed"))},{default:qe(()=>[He(k(p.value)+" closed ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),l("div",xx,[l("div",$x,[Ne(l("input",{"onUpdate:modelValue":b[6]||(b[6]=x=>i.value=x),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[et,i.value]])])]),l("div",Ix,[e.loading?(v(),y("div",Tx," Loading incidents... ")):f.value.length===0?(v(),y("div",Mx,[l("p",null,k(i.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):D("",!0),(v(!0),y(be,null,Oe(g.value,x=>(v(),Xe(ma,{key:x.incidentId,incident:x,onSelect:$=>_.$emit("select-incident",x)},null,8,["incident","onSelect"]))),128))])]))}},Ex=Ke(Ax,[["__scopeId","data-v-379161cd"]]),Px={class:"checkpoints-tab"},Dx={class:"tab-header"},Ox={class:"button-group"},Rx={key:0,class:"status-pills"},Bx={class:"filters-section"},Nx={class:"search-group"},Fx=["placeholder"],Ux={class:"locations-list"},zx=["onClick"],Hx={class:"location-info"},Vx={class:"location-header"},Gx=["innerHTML"],Zx={key:0,class:"location-description"},jx={class:"location-stats"},qx={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=St(),o=e,i=E(""),s=E("all"),a=B=>{s.value=B},c=K(()=>o.locations.filter(B=>B.checkedInCount>=B.requiredMarshals&&B.requiredMarshals>0).length),u=K(()=>o.locations.filter(B=>B.checkedInCount>0&&B.checkedInCount<B.requiredMarshals).length),d=K(()=>o.locations.filter(B=>B.checkedInCount===0&&B.requiredMarshals>0).length),p=K(()=>{let B=o.locations;if(s.value==="full"?B=B.filter(P=>P.checkedInCount>=P.requiredMarshals&&P.requiredMarshals>0):s.value==="partial"?B=B.filter(P=>P.checkedInCount>0&&P.checkedInCount<P.requiredMarshals):s.value==="missing"&&(B=B.filter(P=>P.checkedInCount===0&&P.requiredMarshals>0)),i.value.trim()){const P=i.value.toLowerCase().trim().split(/\s+/);B=B.filter(M=>{const A=(M.areaIds||M.AreaIds||[]).map(C=>g(C)||"").join(" "),I=(M.assignments||[]).map(C=>C.marshalName||"").join(" "),T=`${M.name||""} ${M.description||""} ${A} ${I}`.toLowerCase();return P.every(C=>T.includes(C))})}return B}),f=K(()=>[...p.value].sort((B,P)=>ss(B.name,P.name))),g=B=>{const P=o.areas.find(M=>M.id===B);return P?P.name:null},_=B=>{const P=o.areas.find(M=>M.id===B);return P?P.color:"#999"},b=B=>{const P=B.resolvedStyleBackgroundColor||B.ResolvedStyleBackgroundColor||B.resolvedStyleColor||B.ResolvedStyleColor;if(P)return P;const M=B.areaIds||B.AreaIds||[];return M.length>0?_(M[0]):"#667eea"},x=B=>B.requiredMarshals===0?"":B.checkedInCount>=B.requiredMarshals?"staffed-full":B.checkedInCount>0?"staffed-partial":"staffed-none",$=B=>{const P=B.resolvedStyleType||B.ResolvedStyleType,M=B.resolvedStyleBackgroundColor||B.ResolvedStyleBackgroundColor||B.resolvedStyleColor||B.ResolvedStyleColor,S=B.resolvedStyleBorderColor||B.ResolvedStyleBorderColor,A=B.resolvedStyleIconColor||B.ResolvedStyleIconColor,I=B.resolvedStyleBackgroundShape||B.ResolvedStyleBackgroundShape;return P&&P!=="default"||M||S||A||I&&I!=="circle"?en({type:P||"circle",backgroundShape:I||"circle",backgroundColor:M||"#667eea",borderColor:S||"#ffffff",iconColor:A||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`};return(B,P)=>(v(),y("div",Px,[l("div",Dx,[l("div",Ox,[l("button",{onClick:P[0]||(P[0]=M=>B.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+k(G(t).checkpoint),1),l("button",{onClick:P[1]||(P[1]=M=>B.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),y("div",Rx,[Re(to,{variant:"neutral",active:s.value==="all",onClick:P[2]||(P[2]=M=>a("all"))},{default:qe(()=>[He(k(e.locations.length)+" total ",1)]),_:1},8,["active"]),c.value>0?(v(),Xe(to,{key:0,variant:"success",active:s.value==="full",onClick:P[3]||(P[3]=M=>a("full"))},{default:qe(()=>[He(k(c.value)+" fully staffed ",1)]),_:1},8,["active"])):D("",!0),u.value>0?(v(),Xe(to,{key:1,variant:"warning",active:s.value==="partial",onClick:P[4]||(P[4]=M=>a("partial"))},{default:qe(()=>[He(k(u.value)+" partial ",1)]),_:1},8,["active"])):D("",!0),d.value>0?(v(),Xe(to,{key:2,variant:"danger",active:s.value==="missing",onClick:P[5]||(P[5]=M=>a("missing"))},{default:qe(()=>[He(k(d.value)+" unstaffed ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),l("div",Bx,[l("div",Nx,[Ne(l("input",{"onUpdate:modelValue":P[6]||(P[6]=M=>i.value=M),type:"text",class:"search-input",placeholder:`Search by name, description, ${G(t).area}, or ${G(t).person}...`},null,8,Fx),[[et,i.value]])])]),l("div",Ux,[(v(!0),y(be,null,Oe(f.value,M=>(v(),y("div",{key:M.id,class:"location-item",style:it({borderLeftColor:b(M)}),onClick:S=>B.$emit("select-location",M)},[l("div",Hx,[l("div",Vx,[l("span",{class:"checkpoint-icon",innerHTML:$(M)},null,8,Gx),l("strong",null,k(M.name),1),(v(!0),y(be,null,Oe(M.areaIds||M.AreaIds||[],S=>(v(),y("span",{key:S,class:"area-badge",style:it({backgroundColor:_(S)})},k(g(S)),5))),128))]),M.description?(v(),y("p",Zx,k(M.description),1)):D("",!0),l("div",jx,[l("span",{class:fe(["stat-badge",x(M)])},k(M.checkedInCount)+"/"+k(M.requiredMarshals)+" staffed ",3),(v(!0),y(be,null,Oe(M.assignments,S=>(v(),y("span",{key:S.id,class:fe(["stat-badge",{"checked-in":S.isCheckedIn}])},k(S.marshalName),3))),128))])])],12,zx))),128))])]))}},Wx=Ke(qx,[["__scopeId","data-v-474b4e1d"]]),Kx={class:"areas-tab"},Yx={class:"tab-header"},Jx={class:"button-group"},Xx={key:0,class:"status-pills"},Qx={class:"status-pill"},e$={class:"filters-section"},t$={class:"search-group"},n$=["placeholder"],o$={class:"areas-list"},s$=["onClick"],i$={class:"area-info"},a$={class:"area-header"},r$={key:0,class:"default-badge"},l$={key:0,class:"area-description"},c$={class:"area-stats"},u$={class:"stat-badge"},d$={class:"stat-badge"},h$={key:0,class:"empty-state"},f$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{terms:t}=St(),o=e,i=E(""),s=_=>o.checkpoints.filter(b=>(b.areaIds||b.AreaIds||[]).includes(_)||b.areaId===_),a=K(()=>{if(!i.value.trim())return o.areas;const _=i.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(b=>{const $=s(b.id).map(P=>`${P.name||""} ${P.description||""}`).join(" "),B=`${b.name||""} ${b.description||""} ${$}`.toLowerCase();return _.every(P=>B.includes(P))})}),c=K(()=>[...a.value].sort((_,b)=>_.displayOrder!==b.displayOrder?_.displayOrder-b.displayOrder:ss(_.name,b.name))),u=_=>_.checkpointCount!==void 0?_.checkpointCount:o.checkpoints.filter(b=>b.areaId===_.id).length,d=_=>o.contacts.filter(b=>b.scopeConfigurations?b.scopeConfigurations.some(x=>x.scope==="EveryoneInAreas"&&x.itemType==="Area"?x.ids?.includes("ALL_AREAS")?!0:x.ids?.includes(_.id):!1):!1).length,p=_=>_.peopleTerm||o.eventPeopleTerm||"Marshals",f=(_,b)=>{const x=_.checkpointTerm||o.eventCheckpointTerm||"Checkpoints",$=p(_);return b===1?$i("checkpoint",x,$):tv("checkpoint",x,$)},g=_=>{const b=u(_),x=f(_,b).toLowerCase();return`${b} ${x}`};return(_,b)=>(v(),y("div",Kx,[l("div",Yx,[l("div",Jx,[l("button",{onClick:b[0]||(b[0]=x=>_.$emit("add-area")),class:"btn btn-primary"}," Add "+k(G(t).area.toLowerCase()),1)]),e.areas.length>0?(v(),y("div",Xx,[l("span",Qx,k(e.areas.length)+" "+k(e.areas.length===1?G(t).area.toLowerCase():G(t).areas.toLowerCase()),1)])):D("",!0)]),l("div",e$,[l("div",t$,[Ne(l("input",{"onUpdate:modelValue":b[1]||(b[1]=x=>i.value=x),type:"text",class:"search-input",placeholder:`Search by ${G(t).area.toLowerCase()} name or ${G(t).checkpoint.toLowerCase()} name...`},null,8,n$),[[et,i.value]])])]),l("div",o$,[(v(!0),y(be,null,Oe(c.value,x=>(v(),y("div",{key:x.id,class:"area-item",style:it({borderLeftColor:x.color||"#667eea"}),onClick:$=>_.$emit("select-area",x)},[l("div",i$,[l("div",a$,[l("strong",null,k(x.name),1),x.isDefault?(v(),y("span",r$,"Default")):D("",!0)]),x.description?(v(),y("p",l$,k(x.description),1)):D("",!0),l("div",c$,[l("span",u$,k(g(x)),1),l("span",d$,k(d(x))+" contact"+k(d(x)===1?"":"s"),1)])])],12,s$))),128)),a.value.length===0?(v(),y("div",h$,[l("p",null,k(i.value?`No ${G(t).areas.toLowerCase()} match your search.`:`No ${G(t).areas.toLowerCase()} yet. Click "Add ${G(t).area.toLowerCase()}" to create one.`),1)])):D("",!0)])]))}},p$=Ke(f$,[["__scopeId","data-v-1c918297"]]),v$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},cn=e=>v$[e]||"",m$={class:"responsive-tabs"},g$=["onClick"],y$=["innerHTML"],_$=["innerHTML"],k$={class:"hamburger-label"},b$=["onClick"],w$=["innerHTML"],C$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=E(null),a=E(null),c=E(null),u=E(!1),d=E({}),p=E(!1),f=K(()=>o.tabs.find(P=>P.value===o.modelValue)),g=K(()=>f.value?f.value.label:"Menu"),_=()=>{if(u.value=!u.value,u.value&&a.value){const P=a.value.getBoundingClientRect();d.value={top:`${P.bottom+4}px`}}},b=P=>{i("update:modelValue",P),u.value=!1},x=P=>{if(!s.value)return;const M=s.value.contains(P.target);u.value&&!M&&(u.value=!1)},$=()=>{if(!c.value)return;const P=c.value,M=p.value;M&&(P.style.visibility="visible",P.style.position="static");const S=P.scrollWidth>P.clientWidth;M&&(P.style.visibility="",P.style.position=""),p.value=S};let B=null;return Yt(()=>{document.addEventListener("click",x),os(()=>{$()}),os(()=>{const P=c.value?.parentElement;P&&(B=new ResizeObserver(()=>{$()}),B.observe(P))})}),vo(()=>{document.removeEventListener("click",x),B&&B.disconnect()}),je(()=>o.tabs,()=>{os(()=>{$()})},{deep:!0}),(P,M)=>(v(),y("div",m$,[l("div",{ref_key:"visibleTabsRef",ref:c,class:fe(["visible-tabs",{"is-hidden":p.value}])},[(v(!0),y(be,null,Oe(e.tabs,S=>(v(),y("button",{key:S.value,class:fe(["tab-button",{active:e.modelValue===S.value}]),onClick:A=>P.$emit("update:modelValue",S.value),type:"button"},[S.icon?(v(),y("span",{key:0,class:"tab-icon",innerHTML:G(cn)(S.icon)},null,8,y$)):D("",!0),He(" "+k(S.label),1)],10,g$))),128))],2),l("div",{class:fe(["hamburger-only",{"is-visible":p.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:a,class:fe(["hamburger-button",{active:u.value}]),onClick:ft(_,["stop"]),type:"button"},[M[1]||(M[1]=l("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(v(),y("span",{key:0,class:"tab-icon",innerHTML:G(cn)(f.value.icon)},null,8,_$)):D("",!0),l("span",k$,k(g.value),1)],2),u.value?(v(),y("div",{key:0,class:"hamburger-dropdown",style:it(d.value),onClick:M[0]||(M[0]=ft(()=>{},["stop"]))},[(v(!0),y(be,null,Oe(e.tabs,S=>(v(),y("button",{key:S.value,class:fe(["dropdown-item",{active:e.modelValue===S.value}]),onClick:ft(A=>b(S.value),["stop"]),type:"button"},[S.icon?(v(),y("span",{key:0,class:"tab-icon",innerHTML:G(cn)(S.icon)},null,8,w$)):D("",!0),He(" "+k(S.label),1)],10,b$))),128))],4)):D("",!0)],512)],2)]))}},L$=Ke(C$,[["__scopeId","data-v-2467c6fc"]]),S$={class:"share-link-container"},x$=["value"],$$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=E(!1),s=E(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},c=()=>{o("close")};return(u,d)=>(v(),Xe(Pt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:qe(()=>[l("button",{onClick:c,class:"btn btn-secondary"},"Close")]),default:qe(()=>[d[0]||(d[0]=l("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),l("div",S$,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,x$),l("button",{onClick:a,class:"btn btn-primary"},k(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},I$=Ke($$,[["__scopeId","data-v-98fe71d6"]]),T$={class:"success-content"},M$={class:"success-message"},A$={class:"link-section"},E$={class:"help-text"},P$={key:0,class:"loading-text"},D$={key:1,class:"magic-link-container"},O$=["value"],R$={class:"magic-link-actions"},B$=["disabled"],N$={key:0,class:"success-text"},F$={key:1,class:"error-text"},U$={key:2,class:"error-text"},z$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=E(""),c=E(!1),u=E(!1),d=E(""),p=E(!1),f=E(!1),g=E(!1),_=E(""),b=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,d.value="";try{const P=await ns.getMagicLink(i.eventId,i.marshalId);a.value=P.data.magicLink,c.value=P.data.hasEmail}catch(P){console.error("Failed to fetch magic link:",P),d.value="Failed to load login link"}finally{u.value=!1}}},x=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a.value);else{const P=document.createElement("textarea");P.value=a.value,P.style.position="fixed",P.style.left="-9999px",document.body.appendChild(P),P.select(),document.execCommand("copy"),document.body.removeChild(P)}p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(P){console.error("Failed to copy:",P)}},$=async()=>{if(!(!i.eventId||!i.marshalId)){f.value=!0,g.value=!1,_.value="";try{await ns.sendMagicLink(i.eventId,i.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(P){console.error("Failed to send email:",P),_.value=P.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},B=()=>{s("close")};return je(()=>i.show,P=>{P&&i.marshalId?b():(a.value="",c.value=!1,d.value="",p.value=!1,g.value=!1,_.value="")},{immediate:!0}),(P,M)=>(v(),Xe(Pt,{show:e.show,title:`${G(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:B},{actions:qe(()=>[l("button",{onClick:B,class:"btn btn-primary"},"Done")]),default:qe(()=>[l("div",T$,[M[2]||(M[2]=l("div",{class:"success-icon"},"",-1)),l("p",M$,[l("strong",null,k(e.marshalName),1),M[1]||(M[1]=He(" has been added successfully. ",-1))])]),l("div",A$,[M[3]||(M[3]=l("label",null,"Login link",-1)),l("p",E$," Share this unique link with "+k(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),y("div",P$,"Loading link...")):a.value?(v(),y("div",D$,[l("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:M[0]||(M[0]=S=>S.target.select())},null,40,O$),l("div",R$,[l("button",{type:"button",class:"btn btn-secondary",onClick:x},k(p.value?"Copied!":"Copy link"),1),c.value?(v(),y("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:$},k(f.value?"Sending...":"Send via email"),9,B$)):D("",!0)]),g.value?(v(),y("p",N$,"Email sent successfully!")):D("",!0),_.value?(v(),y("p",F$,k(_.value),1)):D("",!0)])):d.value?(v(),y("div",U$,k(d.value),1)):D("",!0)])]),_:1},8,["show","title"]))}},H$=Ke(z$,[["__scopeId","data-v-e99677e9"]]),V$={class:"form-group"},G$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=E("");je(()=>o.show,d=>{d||(s.value="")});const a=()=>{i("update:isDirty",!0)},c=()=>{i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),Xe(Pt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add administrator ")]),default:qe(()=>[p[2]||(p[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:ft(c,["prevent"])},[l("div",V$,[p[1]||(p[1]=l("label",null,"Email address",-1)),Ne(l("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[et,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},Z$=Ke(G$,[["__scopeId","data-v-a82da194"]]),j$={class:"form-group"},q$={key:0,class:"error"},W$=["disabled"],K$={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=E(null);je(()=>o.show,d=>{d||(s.value=null)});const a=d=>{s.value=d.target.files[0],i("update:isDirty",!0)},c=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),Xe(Pt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary",disabled:e.uploading},k(e.uploading?"Uploading...":"Upload route"),9,W$)]),default:qe(()=>[p[1]||(p[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:ft(c,["prevent"])},[l("div",j$,[p[0]||(p[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(v(),y("div",q$,k(e.error),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},Y$=Ke(K$,[["__scopeId","data-v-317975db"]]),J$={class:"instruction"},X$={class:"form-group"},Q$={class:"form-group"},eI={class:"checkbox-label"},tI={key:0,class:"error"},nI={key:1,class:"import-result"},oI={key:0,class:"import-errors"},sI=["disabled"],iI={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,c=E(null),u=E(!1);je(()=>s.show,_=>{_||(c.value=null,u.value=!1)});const d=_=>{c.value=_.target.files[0],a("update:isDirty",!0)},p=()=>{a("update:isDirty",!0)},f=()=>{c.value&&a("submit",{file:c.value,deleteExisting:u.value})},g=()=>{a("close")};return(_,b)=>(v(),Xe(Pt,{show:e.show,title:`Import ${G(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:qe(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},k(e.importing?"Importing...":`Import ${G(i).checkpoints}`),9,sI)]),default:qe(()=>[l("p",J$,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+k(G(o).people)+" (optional)",1),b[3]||(b[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:ft(f,["prevent"])},[l("div",X$,[b[1]||(b[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",Q$,[l("label",eI,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":b[0]||(b[0]=x=>u.value=x),onChange:p},null,544),[[ws,u.value]]),He(" Delete existing "+k(G(i).checkpoints)+" before import ",1)])]),e.error?(v(),y("div",tI,k(e.error),1)):D("",!0),e.result?(v(),y("div",nI,[l("p",null,"Created "+k(e.result.locationsCreated)+" "+k(G(i).checkpoints)+" and "+k(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),y("div",oI,[b[2]||(b[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),y(be,null,Oe(e.result.errors,(x,$)=>(v(),y("li",{key:$},k(x),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},aI=Ke(iI,[["__scopeId","data-v-75c79d31"]]),rI={class:"instruction"},lI={class:"form-group"},cI={key:0,class:"error"},uI={key:1,class:"import-result"},dI={key:0,class:"import-errors"},hI=["disabled"],fI={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,c=E(null);je(()=>s.show,f=>{f||(c.value=null)});const u=f=>{c.value=f.target.files[0],a("update:isDirty",!0)},d=()=>{c.value&&a("submit",c.value)},p=()=>{a("close")};return(f,g)=>(v(),Xe(Pt,{show:e.show,title:`Import ${G(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:qe(()=>[l("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},k(e.importing?"Importing...":`Import ${G(i).people}`),9,hI)]),default:qe(()=>[l("p",rI,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+k(G(o).checkpoint)+" (optional)",1),g[2]||(g[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:ft(d,["prevent"])},[l("div",lI,[g[0]||(g[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),y("div",cI,k(e.error),1)):D("",!0),e.result?(v(),y("div",uI,[l("p",null,"Imported "+k(e.result.marshalsCreated)+" "+k(G(i).people)+" and "+k(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),y("div",dI,[g[1]||(g[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),y(be,null,Oe(e.result.errors,(_,b)=>(v(),y("li",{key:b},k(_),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},pI=Ke(fI,[["__scopeId","data-v-be89bf1f"]]),vI={key:0,class:"tabs"},mI=["onClick"],gI=["innerHTML"],yI={class:"hamburger-nav"},_I=["disabled"],kI=["innerHTML"],bI={class:"current-tab-label"},wI=["disabled"],CI={key:0,class:"hamburger-menu"},LI=["onClick"],SI=["innerHTML"],xI=400,$I={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=E(null),a=E(null),c=E(!1),u=E(!1),d=K(()=>{const A=o.tabs.find(I=>I.value===o.modelValue);return A?A.label:""}),p=K(()=>o.tabs.find(I=>I.value===o.modelValue)?.icon||null),f=K(()=>o.tabs.findIndex(A=>A.value===o.modelValue)),g=K(()=>f.value>0),_=K(()=>f.value<o.tabs.length-1),b=()=>{g.value&&i("update:modelValue",o.tabs[f.value-1].value)},x=()=>{_.value&&i("update:modelValue",o.tabs[f.value+1].value)},$=()=>{if(!s.value)return;const A=s.value.clientWidth,I=o.tabs.length*100;c.value=I>A||A<xI},B=()=>{u.value=!u.value},P=A=>{i("update:modelValue",A),u.value=!1},M=A=>{a.value&&!a.value.contains(A.target)&&(u.value=!1)};let S=null;return Yt(()=>{os(()=>{$(),s.value&&typeof ResizeObserver<"u"&&(S=new ResizeObserver(()=>{$()}),S.observe(s.value)),document.addEventListener("click",M)})}),vo(()=>{S&&S.disconnect(),document.removeEventListener("click",M)}),je(()=>o.tabs,()=>{os(()=>{$()})},{deep:!0}),(A,I)=>(v(),y("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[c.value?(v(),y("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:a},[l("div",yI,[l("button",{class:fe(["nav-arrow",{invisible:!g.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!g.value},"  ",10,_I),l("button",{class:"hamburger-button",onClick:B,type:"button","aria-label":"Tab menu"},[p.value?(v(),y("span",{key:0,class:"current-tab-icon",innerHTML:G(cn)(p.value)},null,8,kI)):D("",!0),l("span",bI,k(d.value),1),I[0]||(I[0]=l("span",{class:"hamburger-chevron"},"",-1))]),l("button",{class:fe(["nav-arrow",{invisible:!_.value}]),onClick:x,type:"button","aria-label":"Next tab",disabled:!_.value},"  ",10,wI)]),u.value?(v(),y("div",CI,[(v(!0),y(be,null,Oe(e.tabs,T=>(v(),y("button",{key:T.value,class:fe(["menu-item",{active:e.modelValue===T.value}]),onClick:C=>P(T.value),type:"button"},[T.icon?(v(),y("span",{key:0,class:"tab-icon",innerHTML:G(cn)(T.icon)},null,8,SI)):D("",!0),He(" "+k(T.label),1)],10,LI))),128))])):D("",!0)],512)):(v(),y("div",vI,[(v(!0),y(be,null,Oe(e.tabs,T=>(v(),y("button",{key:T.value,class:fe(["tab-button",{active:e.modelValue===T.value}]),onClick:C=>A.$emit("update:modelValue",T.value),type:"button"},[T.icon?(v(),y("span",{key:0,class:"tab-icon",innerHTML:G(cn)(T.icon)},null,8,gI)):D("",!0),He(" "+k(T.label),1)],10,mI))),128))]))],512))}},Pu=Ke($I,[["__scopeId","data-v-6cd15cf1"]]),II={class:"tab-content"},TI={class:"form-group"},MI=["value"],AI={class:"form-group"},EI=["value"],PI={class:"form-group"},DI={class:"area-display"},OI={key:0,class:"no-area"},RI={class:"form-help"},BI={class:"form-group checkbox-group"},NI={class:"checkbox-label"},FI=["checked"],UI={class:"form-help"},zI={key:0,class:"custom-times-section"},HI={class:"form-group"},VI=["value"],GI={class:"form-help"},ZI={class:"form-group"},jI=["value"],qI={class:"form-help"},WI={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=K(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(p=>p.id===d)).filter(d=>d!==void 0)),a=(u,d)=>{i("update:form",{...o.form,[u]:d}),i("input")},c=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const p=rr(o.eventDate);d.startTime=p,d.endTime=p}i("update:form",d),i("input")};return(u,d)=>(v(),y("div",II,[l("form",{onSubmit:d[5]||(d[5]=ft(p=>u.$emit("save"),["prevent"]))},[l("div",TI,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=p=>a("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,MI)]),l("div",AI,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=p=>a("description",p.target.value)),type:"text",class:"form-input"},null,40,EI)]),l("div",PI,[l("label",null,k(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",DI,[s.value.length===0?(v(),y("span",OI," Not in any "+k(e.areaTermSingular.toLowerCase())+" polygon ",1)):D("",!0),(v(!0),y(be,null,Oe(s.value,p=>(v(),y("span",{key:p.id,class:"area-badge",style:it({backgroundColor:p.color||"var(--brand-primary)"})},k(p.name),5))),128))]),l("small",RI,k(e.areaTermPlural)+" are automatically assigned based on "+k(e.checkpointTermSingular.toLowerCase())+" location within "+k(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",BI,[l("label",NI,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=p=>c(p.target.checked)),type:"checkbox"},null,40,FI),l("span",null,"Use custom date/time for this "+k(e.checkpointTermSingular.toLowerCase()),1)]),l("small",UI," By default, "+k(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),y("div",zI,[l("div",HI,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=p=>a("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,VI),l("small",GI," When "+k(e.peopleTermPlural.toLowerCase())+" should arrive at this "+k(e.checkpointTermSingular.toLowerCase()),1)]),l("div",ZI,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=p=>a("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,jI),l("small",qI," When "+k(e.peopleTermPlural.toLowerCase())+" can leave this "+k(e.checkpointTermSingular.toLowerCase()),1)])])):D("",!0)],32)]))}},KI=Ke(WI,[["__scopeId","data-v-aa628901"]]),YI={class:"scope-configuration-editor"},JI={class:"editor-header"},XI={class:"scope-types-list"},QI=["onClick"],eT={class:"scope-type-label"},tT={class:"scope-type-pill"},nT={class:"expand-label"},oT={class:"expand-icon"},sT={class:"modal-content"},iT={class:"modal-header"},aT={class:"modal-body"},rT={class:"scope-help"},lT={key:0,class:"form-group"},cT={class:"checkbox-label special-option"},uT=["checked"],dT={key:0,class:"specific-selection"},hT=["placeholder"],fT={class:"checkbox-group scrollable"},pT=["checked","onChange"],vT={key:1,class:"form-group"},mT={class:"checkbox-label special-option"},gT=["checked"],yT={key:0,class:"specific-selection"},_T={class:"checkbox-group scrollable"},kT=["checked","onChange"],bT={key:2,class:"form-group"},wT={class:"checkbox-label special-option"},CT=["checked"],LT={key:0,class:"specific-selection"},ST=["placeholder"],xT={class:"checkbox-group scrollable"},$T={key:0,class:"checkbox-label this-checkpoint-option"},IT=["checked"],TT={class:"checkpoint-info"},MT={class:"checkpoint-name"},AT=["checked","onChange"],ET={class:"checkpoint-info"},PT={class:"checkpoint-name"},DT={key:0,class:"checkpoint-description"},OT={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=K(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),c=E({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=E(null),d=E(""),p=E(""),f=E(!i.isEditing);let g=!0,_=!1;const b=K(()=>a.value.filter(H=>!i.excludeScopes.includes(H.scope))),x=K(()=>f.value?b.value:b.value.filter(H=>ae(H.scope))),$=K(()=>b.value.filter(Q=>ae(Q.scope)).length<b.value.length),B=K(()=>{const H=b.value.filter(Q=>ae(Q.scope)).length;return b.value.length-H}),P=K(()=>!i.currentCheckpointId&&i.intent==="location-update");je(()=>i.modelValue,H=>{if(H){if(_){_=!1;return}g=!0,Object.keys(c.value).forEach(Q=>{c.value[Q]={enabled:!1,ids:[]}}),H.forEach(Q=>{Q.scope==="Everyone"?c.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Q.scope==="AreaLead"?c.value.EveryAreaLead={enabled:!0,ids:[...Q.ids]}:c.value[Q.scope]&&(c.value[Q.scope]={enabled:!0,ids:[...Q.ids]})}),g=!1}},{immediate:!0});const M=()=>{const H=[];return Object.keys(c.value).forEach(Q=>{const ie=c.value[Q];if(ie.enabled){const R={scope:Q,itemType:S(Q),ids:[...ie.ids]};H.push(R)}}),H};je(c,()=>{if(g)return;if(Object.keys(c.value).some(ie=>ie!=="SpecificPeople"&&c.value[ie].enabled)&&c.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const ie=c.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");c.value.SpecificPeople.ids.splice(ie,1),c.value.SpecificPeople.ids.length===0&&(c.value.SpecificPeople.enabled=!1)}_=!0;const Q=M();s("update:modelValue",Q),s("user-changed")},{deep:!0});const S=H=>A(H)?"Area":I(H)?"Checkpoint":T(H)?"Marshal":null,A=H=>H==="EveryoneInAreas"||H==="OnePerArea"||H==="EveryAreaLead"||H==="OneLeadPerArea",I=H=>H==="EveryoneAtCheckpoints"||H==="OnePerCheckpoint",T=H=>H==="SpecificPeople",C=H=>{const Q=a.value.find(ie=>ie.scope===H);return Q?Q.label:H},V=K(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),z=H=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[H]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[H]||"",ae=H=>c.value[H]?.enabled||!1,j=H=>{const Q=c.value[H];if(!Q||!Q.enabled)return"No";const ie=Q.ids||[];if(A(H)){if(ie.includes("ALL_AREAS"))return`All ${o.value.areas}`;const R=ie.length;return R>0?`${R} ${R!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(I(H)){if(ie.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(ie.length===1&&ie[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const R=ie.length;return R>0?`${R} ${R!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(T(H)){if(ie.includes("ALL_MARSHALS"))return"Everyone";const R=ie.length;return R>0?`${R} ${R!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},X=H=>{u.value=H,d.value="",p.value=""},ce=()=>{u.value=null},Te=()=>{u.value&&(c.value[u.value]={enabled:!1,ids:[]}),ce()},Ae=()=>u.value&&c.value[u.value]?.ids.includes("ALL_MARSHALS"),Ce=()=>{if(!u.value)return;const H=c.value[u.value];Ae()?(H.ids=[],H.enabled=!1):(H.ids=["ALL_MARSHALS"],H.enabled=!0)},pe=H=>u.value&&c.value[u.value]?.ids.includes(H),me=H=>{if(!u.value)return;const Q=c.value[u.value],ie=Q.ids.indexOf(H);ie>=0?(Q.ids.splice(ie,1),Q.ids.length===0&&(Q.enabled=!1)):(Q.ids.push(H),Q.enabled=!0)},nt=K(()=>{if(!p.value)return i.marshals;const H=p.value.toLowerCase();return i.marshals.filter(Q=>Q.name.toLowerCase().includes(H)||Q.email&&Q.email.toLowerCase().includes(H))}),Le=()=>u.value&&c.value[u.value]?.ids.includes("ALL_AREAS"),Be=()=>{if(!u.value)return;const H=c.value[u.value];Le()?(H.ids=[],H.enabled=!1):(H.ids=["ALL_AREAS"],H.enabled=!0)},Ge=H=>u.value&&c.value[u.value]?.ids.includes(H),ue=H=>{if(!u.value)return;const Q=c.value[u.value],ie=Q.ids.indexOf(H);ie>=0?(Q.ids.splice(ie,1),Q.ids.length===0&&(Q.enabled=!1)):(Q.ids.push(H),Q.enabled=!0)},Pe=()=>u.value&&c.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Ee=()=>{if(!u.value)return;const H=c.value[u.value];Pe()?(H.ids=[],H.enabled=!1):(H.ids=["ALL_CHECKPOINTS"],H.enabled=!0)},Me=H=>u.value&&c.value[u.value]?.ids.includes(H),de=H=>{if(!u.value)return;const Q=c.value[u.value],ie=Q.ids.indexOf(H);ie>=0?(Q.ids.splice(ie,1),Q.ids.length===0&&(Q.enabled=!1)):(Q.ids.push(H),Q.enabled=!0)},ke=K(()=>{let H=i.locations;if(d.value){const Q=d.value.toLowerCase();H=H.filter(ie=>ie.name.toLowerCase().includes(Q)||ie.description&&ie.description.toLowerCase().includes(Q))}return[...H].sort((Q,ie)=>ss(Q.name,ie.name))});return(H,Q)=>(v(),y("div",YI,[l("div",JI,[l("h4",null,k(V.value),1)]),l("div",XI,[(v(!0),y(be,null,Oe(x.value,ie=>(v(),y("div",{key:ie.scope,class:fe(["scope-type-row",{active:ae(ie.scope)}]),onClick:R=>X(ie.scope)},[l("div",eT,k(ie.label),1),l("div",tT,k(j(ie.scope)),1)],10,QI))),128)),$.value?(v(),y("div",{key:0,class:"expand-row",onClick:Q[0]||(Q[0]=ie=>f.value=!f.value)},[l("div",nT,k(f.value?"Show less":`Show ${B.value} more option${B.value!==1?"s":""}...`),1),l("div",oT,k(f.value?"":""),1)])):D("",!0)]),u.value?(v(),y("div",{key:0,class:"scope-config-modal",onClick:ft(ce,["self"])},[l("div",sT,[l("div",iT,[l("h5",null,k(C(u.value)),1),l("button",{onClick:ce,class:"btn-close",type:"button"},"")]),l("div",aT,[l("p",rT,k(z(u.value)),1),T(u.value)?(v(),y("div",lT,[l("label",cT,[l("input",{type:"checkbox",checked:Ae(),onChange:Ce},null,40,uT),l("span",null,[Q[4]||(Q[4]=l("strong",null,"Everyone at the event",-1)),He(" (all current and future "+k(G(o).people)+")",1)])]),Ae()?D("",!0):(v(),y("div",dT,[Ne(l("input",{"onUpdate:modelValue":Q[1]||(Q[1]=ie=>p.value=ie),type:"text",placeholder:`Search ${G(o).people}...`,class:"search-input"},null,8,hT),[[et,p.value]]),l("div",fT,[(v(!0),y(be,null,Oe(nt.value,ie=>(v(),y("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:pe(ie.id),onChange:R=>me(ie.id)},null,40,pT),l("span",null,k(ie.name),1)]))),128))])]))])):D("",!0),A(u.value)?(v(),y("div",vT,[l("label",mT,[l("input",{type:"checkbox",checked:Le(),onChange:Be},null,40,gT),l("span",null,[l("strong",null,"All "+k(G(o).areas),1),He(" (includes future "+k(G(o).areas)+")",1)])]),Le()?D("",!0):(v(),y("div",yT,[l("div",_T,[(v(!0),y(be,null,Oe(e.areas,ie=>(v(),y("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Ge(ie.id),onChange:R=>ue(ie.id)},null,40,kT),l("span",{class:"area-color-dot",style:it({backgroundColor:ie.color||"#667eea"})},null,4),l("span",null,k(ie.name),1)]))),128))])]))])):D("",!0),I(u.value)?(v(),y("div",bT,[l("label",wT,[l("input",{type:"checkbox",checked:Pe(),onChange:Ee},null,40,CT),l("span",null,[l("strong",null,"All "+k(G(o).checkpoints),1),He(" (includes future "+k(G(o).checkpoints)+")",1)])]),Pe()?D("",!0):(v(),y("div",LT,[Ne(l("input",{"onUpdate:modelValue":Q[2]||(Q[2]=ie=>d.value=ie),type:"text",placeholder:`Search ${G(o).checkpoints}...`,class:"search-input"},null,8,ST),[[et,d.value]]),l("div",xT,[P.value?(v(),y("label",$T,[l("input",{type:"checkbox",checked:Me("THIS_CHECKPOINT"),onChange:Q[3]||(Q[3]=ie=>de("THIS_CHECKPOINT"))},null,40,IT),l("div",TT,[l("span",MT,[l("strong",null,"This "+k(G(o).checkpoint),1)])])])):D("",!0),(v(!0),y(be,null,Oe(ke.value,ie=>(v(),y("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Me(ie.id),onChange:R=>de(ie.id)},null,40,AT),l("div",ET,[l("span",PT,k(ie.name),1),ie.description?(v(),y("span",DT," - "+k(ie.description),1)):D("",!0)])]))),128))])]))])):D("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:Te,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:ce,class:"btn btn-primary",type:"button"},"Done")])])])):D("",!0)]))}},Ul=Ke(OT,[["__scopeId","data-v-ad360dec"]]),RT={class:"tab-content"},BT={class:"form-group"},NT=["value"],FT={key:0,class:"form-error"},UT={class:"form-row"},zT={class:"form-group"},HT=["value","disabled"],VT={class:"form-group"},GT=["value","disabled"],ZT={class:"form-group"},jT={class:"accordion-item"},qT={class:"accordion-preview"},WT={class:"accordion-arrow"},KT={key:0,class:"accordion-content"},YT={class:"section-description"},JT={class:"dynamic-checkbox"},XT=["checked"],QT={key:0,class:"dynamic-settings"},eM={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=E(!1),a=g=>g==null||g===""?"":Number(g).toFixed(6),c=(g,_)=>{i("update:form",{...o.form,[g]:_}),i("input")},u=(g,_)=>{i("update:form",{...o.form,[g]:Number(_)}),i("input")},d=g=>{if(g){const _=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],b=o.form.locationUpdateScopeConfigurations||[],x=b.length>0?b:_;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else i("update:form",{...o.form,isDynamic:!1});i("input")},p=g=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:g}),i("input")},f=g=>{if(!g)return!0;const _=g.includes(".")?g.split("."):g.split("/");if(_.length!==3)return!1;const b=/^[a-z]{1,20}$/;return _.every(x=>b.test(x))};return(g,_)=>(v(),y("div",RT,[l("form",{onSubmit:_[4]||(_[4]=ft(b=>g.$emit("save"),["prevent"]))},[l("div",BT,[_[8]||(_[8]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:_[0]||(_[0]=b=>c("what3Words",b.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,NT),e.form.what3Words&&!f(e.form.what3Words)?(v(),y("small",FT," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),e.form.isDynamic?D("",!0):(v(),y(be,{key:0},[l("div",UT,[l("div",zT,[_[9]||(_[9]=l("label",null,"Longitude",-1)),l("input",{value:a(e.form.longitude),onInput:_[1]||(_[1]=b=>u("longitude",b.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,HT)]),l("div",VT,[_[10]||(_[10]=l("label",null,"Latitude",-1)),l("input",{value:a(e.form.latitude),onInput:_[2]||(_[2]=b=>u("latitude",b.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,GT)])]),l("div",ZT,[l("button",{type:"button",onClick:_[3]||(_[3]=b=>g.$emit("move-location")),class:fe(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[_[11]||(_[11]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),He(" "+k(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",jT,[l("button",{type:"button",class:fe(["accordion-header",{expanded:s.value}]),onClick:_[5]||(_[5]=b=>s.value=!s.value)},[_[12]||(_[12]=rl('<div class="accordion-icon" data-v-9396727c><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-9396727c><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-9396727c></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-9396727c></path><circle cx="12" cy="11" r="2" fill="white" data-v-9396727c></circle></svg></div><span class="accordion-title" data-v-9396727c>Dynamic location</span>',2)),l("span",qT,k(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",WT,k(s.value?"":""),1)],2),s.value?(v(),y("div",KT,[l("p",YT," Enable this for lead cars, sweep vehicles, or other moving "+k(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+k(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",JT,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:_[6]||(_[6]=b=>d(b.target.checked))},null,40,XT),l("span",null,"This "+k(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),y("div",QT,[Re(Ul,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":p,onUserChanged:_[7]||(_[7]=b=>g.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):D("",!0)])):D("",!0)])]))}},tM=Ke(eM,[["__scopeId","data-v-9396727c"]]);function lv(e){const t=E(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const _=!o(f);_===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,_),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,g])=>({assignmentId:f,shouldBeCheckedIn:g}))}}const nM={class:"tab-content"},oM={class:"form-group"},sM=["value"],iM={class:"section-title"},aM={class:"assignments-list"},rM={class:"assignment-info"},lM={class:"assignment-header"},cM=["title"],uM={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},dM={key:2,class:"pending-badge"},hM={key:3,class:"pending-badge"},fM={key:0,class:"check-in-info"},pM={class:"check-in-method"},vM={class:"assignment-actions"},mM=["onClick"],gM=["onClick"],yM={class:"assign-section"},_M={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"}},emits:["update:form","input","remove-assignment","open-assign-modal"],setup(e,{expose:t,emit:o}){const i=e,s=K(()=>i.peopleTerm.toLowerCase()),a=K(()=>i.personTerm.toLowerCase()),c=o,{pendingCheckInChanges:u,getEffectiveCheckInStatus:d,handleToggleCheckIn:p,getStatusIcon:f,getStatusColor:g,getStatusText:_,formatTime:b}=lv(()=>c("input")),x=K(()=>i.assignments?.length||0),$=K(()=>i.assignments?[...i.assignments].sort((P,M)=>{const S=P.marshalName?.toLowerCase()||"",A=M.marshalName?.toLowerCase()||"";return S.localeCompare(A)}):[]),B=(P,M)=>{c("update:form",{...i.form,[P]:Number(M)}),c("input")};return t({pendingCheckInChanges:u,clearPendingChanges:()=>{u.value.clear()},getPendingChanges:()=>Array.from(u.value.entries()).map(([P,M])=>({assignmentId:P,shouldBeCheckedIn:M}))}),(P,M)=>(v(),y("div",nM,[l("div",oM,[l("label",null,"Required "+k(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:M[0]||(M[0]=S=>B("requiredMarshals",S.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,sM)]),l("h3",iM,"Assigned "+k(s.value)+" ("+k(x.value)+")",1),l("div",aM,[(v(!0),y(be,null,Oe($.value,S=>(v(),y("div",{key:S.id,class:fe(["assignment-item",{"checked-in":!S.isPending&&G(d)(S),"is-pending":S.isPending}])},[l("div",rM,[l("div",lM,[S.isPending?(v(),y("span",uM,"  ")):(v(),y("span",{key:0,class:"status-indicator",style:it({color:G(g)(S)}),title:G(_)(S)},k(G(f)(S)),13,cM)),l("strong",null,k(S.marshalName),1),S.isPending?(v(),y("span",dM," (will be assigned on save) ")):G(u).has(S.id)?(v(),y("span",hM," (unsaved) ")):D("",!0)]),!S.isPending&&G(d)(S)?(v(),y("span",fM,[S.isCheckedIn&&!G(u).has(S.id)?(v(),y(be,{key:0},[He(k(G(b)(S.checkInTime))+" ",1),l("span",pM,"("+k(S.checkInMethod)+")",1)],64)):(v(),y(be,{key:1},[He(" Will be checked in on save ")],64))])):D("",!0)]),l("div",vM,[S.isPending?D("",!0):(v(),y("button",{key:0,onClick:A=>G(p)(S),class:fe(["btn btn-small",G(d)(S)?"btn-danger":"btn-secondary"])},k(G(d)(S)?"Undo":"Check in"),11,mM)),l("button",{onClick:A=>P.$emit("remove-assignment",S),class:"btn btn-small btn-danger"}," Remove ",8,gM)])],2))),128)),l("div",yM,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:M[1]||(M[1]=S=>P.$emit("open-assign-modal"))}," + Assign "+k(a.value)+"... ",1)])])]))}},kM=Ke(_M,[["__scopeId","data-v-fba07968"]]),bM={class:"checkpoint-checklist-view"},wM={key:0,class:"loading-state"},CM={key:1,class:"error-state"},LM={key:2,class:"empty-state"},SM={key:3,class:"empty-state"},xM={key:4,class:"checklist-items"},$M={class:"item-checkbox"},IM=["checked","disabled","onChange"],TM={class:"item-content"},MM={class:"item-header"},AM={class:"item-text-wrapper"},EM={class:"item-text"},PM={key:0,class:"item-context"},DM={class:"item-scope"},OM=["title"],RM={key:0,class:"completion-info"},BM={key:0,class:"pending-text"},NM={class:"completion-text"},FM={class:"completion-time"},UM={key:1,class:"uncomplete-info"},zM={key:2,class:"disabled-reason"},HM={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,c=o,u=E([]),d=E(!1),p=E(null),f=E(new Map),g=K(()=>a.assignments.length===0),_=K(()=>u.value.map(I=>{const T=f.value.get(`${I.itemId}|||${I.completionContextId}`),C=T!==void 0?T.complete:I.isCompleted,V=T!==void 0&&T.complete!==I.isCompleted;return{...I,localIsCompleted:C,isModified:V}})),b=async()=>{if(!(!a.eventId||!a.locationId&&!a.areaId)){d.value=!0,p.value=null;try{const I=a.locationId?await Rt.getCheckpointChecklist(a.eventId,a.locationId):await Rt.getAreaChecklist(a.eventId,a.areaId);if(u.value=I.data||[],a.modelValue&&a.modelValue.length>0){const T=new Map;a.modelValue.forEach(C=>{T.set(`${C.itemId}|||${C.contextId}`,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),f.value=T}}catch(I){console.error("Failed to load checklist:",I),p.value=I.response?.data?.message||"Failed to load checklist"}finally{d.value=!1}}},x=I=>{const T=I.contextOwnerMarshalId||(a.assignments.length>0?a.assignments[0].marshalId:null);if(!T)return;const C=`${I.itemId}|||${I.completionContextId}`,V=f.value.get(C),z=V!==void 0?V.complete:I.isCompleted;f.value.set(C,{complete:!z,contextType:I.completionContextType,contextId:I.completionContextId,marshalId:T}),$()},$=()=>{const I=[];for(const[T,C]of f.value.entries()){const[V,z]=T.split("|||"),ae=u.value.find(j=>j.itemId===V&&j.completionContextId===z);ae&&C.complete!==ae.isCompleted&&I.push({itemId:V,complete:C.complete,contextType:C.contextType,contextId:C.contextId,marshalId:C.marshalId})}c("update:modelValue",I),c("change",I)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const I=new Map;a.modelValue.forEach(T=>{I.set(`${T.itemId}|||${T.contextId}`,{complete:T.complete,contextType:T.contextType,contextId:T.contextId,marshalId:T.marshalId})}),f.value=I}},loadChecklist:b});const P=I=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[I.matchedScope]||I.matchedScope,M=I=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to certain people",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[I.matchedScope]||"",S=I=>{if(!I.completionContextType||!I.completionContextId)return null;if(I.completionContextType==="Checkpoint"){const T=a.locations.find(V=>V.id===I.completionContextId);if(!T)return null;const C=T.description?`${T.name} - ${T.description}`:T.name;return`at ${s.value.checkpoint} ${C}`}if(I.completionContextType==="Area"){const T=a.areas.find(C=>C.id===I.completionContextId);return T?`in ${s.value.area} ${T.name}`:null}return I.completionContextType==="Personal"?I.contextOwnerName?`for ${I.contextOwnerName}`:"assigned individually":null},A=I=>I?new Date(I).toLocaleString():"";return je(()=>[a.eventId,a.locationId,a.areaId],()=>{b()},{immediate:!0}),(I,T)=>(v(),y("div",bM,[d.value?(v(),y("div",wM," Loading checklist... ")):p.value?(v(),y("div",CM,[l("p",null,k(p.value),1),l("button",{onClick:b,class:"btn btn-secondary btn-small"}," Retry ")])):g.value?(v(),y("div",LM,[...T[0]||(T[0]=[l("p",null,"No marshals assigned to this checkpoint yet.",-1),l("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):u.value.length===0?(v(),y("div",SM,[...T[1]||(T[1]=[l("p",null,"No checklist items for this checkpoint.",-1)])])):(v(),y("div",xM,[(v(!0),y(be,null,Oe(_.value,C=>(v(),y("div",{key:`${C.itemId}-${C.completionContextId}`,class:fe(["checklist-item",{"item-completed":C.localIsCompleted,"item-modified":C.isModified}])},[l("div",$M,[l("input",{type:"checkbox",checked:C.localIsCompleted,disabled:!C.canBeCompletedByMe&&!C.localIsCompleted,onChange:V=>x(C)},null,40,IM)]),l("div",TM,[l("div",MM,[l("div",AM,[l("div",EM,k(C.text),1),S(C)?(v(),y("div",PM,k(S(C)),1)):D("",!0)]),l("div",DM,[l("span",{class:"scope-pill",title:M(C)},k(P(C)),9,OM)])]),C.localIsCompleted?(v(),y("div",RM,[C.isModified&&!C.isCompleted?(v(),y("span",BM," Will be marked as completed (pending save) ")):(v(),y(be,{key:1},[l("span",NM," Completed by "+k(C.completedByActorName||"Unknown"),1),l("span",FM,k(A(C.completedAt)),1)],64))])):D("",!0),C.isModified&&C.isCompleted&&!C.localIsCompleted?(v(),y("div",UM,[...T[2]||(T[2]=[l("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):D("",!0),!C.canBeCompletedByMe&&!C.localIsCompleted?(v(),y("div",zM," Already completed by someone else ")):D("",!0)])],2))),128))]))]))}},cv=Ke(HM,[["__scopeId","data-v-647b649b"]]),VM={class:"notes-view"},GM={key:0,class:"loading-state"},ZM={key:1,class:"error-state"},jM={key:2,class:"empty-state"},qM={key:3,class:"notes-list"},WM={class:"note-header"},KM={class:"note-title-row"},YM={key:0,class:"pin-icon",title:"Pinned"},JM={class:"note-title"},XM={class:"note-meta"},QM={key:0,class:"category-badge"},eA={key:0,class:"note-content"},tA={class:"note-footer"},nA={class:"created-info"},oA={key:0,class:"scope-info"},sA={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=E([]),s=E(!1),a=E(null),c=K(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=K(()=>o.areaId?o.locations.filter(P=>P.areaIds&&P.areaIds.includes(o.areaId)):[]),d=K(()=>u.value.map(P=>P.id)),p=K(()=>{if(!o.areaId)return[];const P=new Set;return o.assignments.filter(M=>d.value.includes(M.locationId)).forEach(M=>P.add(M.marshalId)),Array.from(P)}),f=P=>o.assignments.filter(M=>M.marshalId===P).map(M=>M.locationId),g=P=>{const M=f(P),S=new Set;for(const A of M){const I=o.locations.find(T=>T.id===A);I?.areaIds&&I.areaIds.forEach(T=>S.add(T))}return Array.from(S)},_=(P,M)=>{if(!P.scopeConfigurations)return null;for(const S of P.scopeConfigurations){if(S.itemType==="Area"){if(M.type==="area"&&(S.ids.includes(M.areaId)||S.ids.includes("ALL_AREAS")))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"};if(M.type==="checkpoint"){const I=o.locations.find(T=>T.id===M.locationId)?.areaIds||[];if(S.ids.includes("ALL_AREAS")||I.some(T=>S.ids.includes(T)))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(S.itemType==="Checkpoint"){if(M.type==="checkpoint"&&(S.ids.includes(M.locationId)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(M.type==="area"&&M.checkpointIds.some(I=>S.ids.includes(I)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(S.itemType==="Marshal"){if(M.type==="marshal"&&(S.ids.includes(M.marshalId)||S.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(M.type==="checkpoint"){const A=o.assignments.filter(T=>T.locationId===M.locationId).map(T=>T.marshalId);if(S.ids.includes("ALL_MARSHALS")||A.some(T=>S.ids.includes(T)))return{matched:!0,scope:"Marshal at checkpoint"}}if(M.type==="area"&&(S.ids.includes("ALL_MARSHALS")||M.marshalIds.some(I=>S.ids.includes(I))))return{matched:!0,scope:"Marshal in area"}}if(M.type==="marshal"&&M.checkpointIds&&M.areaIds){if(S.itemType==="Checkpoint"&&(S.ids.includes("ALL_CHECKPOINTS")||M.checkpointIds.some(I=>S.ids.includes(I))))return{matched:!0,scope:"Assigned checkpoint"};if(S.itemType==="Area"&&(S.ids.includes("ALL_AREAS")||M.areaIds.some(I=>S.ids.includes(I))))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},b=K(()=>{const P=o.allNotes||i.value;if(!P||P.length===0)return[];if(o.areaId&&o.allNotes){const M={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:p.value},S=[],A=new Set;for(const I of P){if(A.has(I.noteId))continue;const T=_(I,M);T&&(A.add(I.noteId),S.push({...I,matchedScope:T.scope}))}return S}if(o.locationId&&o.allNotes){const M={type:"checkpoint",locationId:o.locationId},S=[],A=new Set;for(const I of P){if(A.has(I.noteId))continue;const T=_(I,M);T&&(A.add(I.noteId),S.push({...I,matchedScope:T.scope}))}return S}if(o.marshalId&&o.allNotes){const M=f(o.marshalId),S=g(o.marshalId),A={type:"marshal",marshalId:o.marshalId,checkpointIds:M,areaIds:S},I=[],T=new Set;for(const C of P){if(T.has(C.noteId))continue;const V=_(C,A);V&&(T.add(C.noteId),I.push({...C,matchedScope:V.scope}))}return I}return P}),x=K(()=>{const P={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...b.value].sort((M,S)=>{if(M.isPinned!==S.isPinned)return M.isPinned?-1:1;const A=P[M.priority]??2,I=P[S.priority]??2;return A!==I?A-I:M.displayOrder!==S.displayOrder?M.displayOrder-S.displayOrder:new Date(S.createdAt)-new Date(M.createdAt)})}),$=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let P;o.marshalId?P=await ys.getMarshalNotes(o.eventId,o.marshalId):P=await ys.getByEvent(o.eventId),i.value=P.data||[]}catch(P){console.error("Failed to load notes:",P),a.value=P.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};je(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&$()},{immediate:!0});const B=P=>{if(!P)return"";const M=new Date(P),A=new Date-M,I=Math.floor(A/6e4),T=Math.floor(A/36e5),C=Math.floor(A/864e5);return I<1?"just now":I<60?`${I}m ago`:T<24?`${T}h ago`:C<7?`${C}d ago`:M.toLocaleDateString()};return t({loadNotes:$}),(P,M)=>(v(),y("div",VM,[s.value?(v(),y("div",GM," Loading notes... ")):a.value?(v(),y("div",ZM,[l("p",null,k(a.value),1),l("button",{onClick:$,class:"btn btn-secondary btn-small"}," Retry ")])):b.value.length===0?(v(),y("div",jM,[l("p",null,k(c.value),1)])):(v(),y("div",qM,[(v(!0),y(be,null,Oe(x.value,S=>(v(),y("div",{key:S.noteId,class:fe(["note-item",{pinned:S.isPinned}])},[l("div",WM,[l("div",KM,[S.isPinned?(v(),y("span",YM,"")):D("",!0),l("span",{class:fe(["priority-indicator",(S.priority||"Normal").toLowerCase()])},null,2),l("strong",JM,k(S.title),1)]),l("div",XM,[S.category?(v(),y("span",QM,k(S.category),1)):D("",!0),l("span",{class:fe(["priority-badge",(S.priority||"Normal").toLowerCase()])},k(S.priority||"Normal"),3)])]),S.content?(v(),y("div",eA,k(S.content),1)):D("",!0),l("div",tA,[l("span",nA," Created by "+k(S.createdByName||"Unknown")+"  "+k(B(S.createdAt)),1),S.matchedScope&&e.showScope?(v(),y("span",oA,k(S.matchedScope),1)):D("",!0)])],2))),128))]))]))}},zl=Ke(sA,[["__scopeId","data-v-9fdf0b0b"]]),iA={class:"checklist-preview"},aA={class:"preview-actions"},rA={class:"preview-header"},lA={key:0,class:"add-item-form"},cA=["placeholder"],uA=["disabled"],dA={key:1,class:"pending-items"},hA={class:"item-content"},fA={class:"item-header"},pA={class:"item-text"},vA={class:"item-scope"},mA=["onClick"],gA={key:2,class:"empty-state"},yA={key:0,class:"help-text"},_A={key:3,class:"checklist-items"},kA={class:"item-content"},bA={class:"item-header"},wA={class:"item-text"},CA={class:"item-scope"},LA=["title"],SA={key:0,class:"item-context"},xA={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=K(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),c=t,u=E(!1),d=E(""),p=E([...s.modelValue]);je(()=>s.modelValue,S=>{p.value=[...S]},{deep:!0});const f=()=>{d.value.trim()&&(p.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,_())},g=S=>{p.value.splice(S,1),_()},_=()=>{c("update:modelValue",[...p.value]),c("change")},b=S=>{const A=S.scope,I=S.itemType,T=S.ids||[];return(A==="EveryoneAtCheckpoints"||A==="OnePerCheckpoint")&&I==="Checkpoint"?T.includes("ALL_CHECKPOINTS"):A==="OnePerCheckpoint"&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(C=>s.pendingAreaIds.includes(C)):(A==="EveryoneInAreas"||A==="OnePerArea"||A==="EveryAreaLead"||A==="OneLeadPerArea")&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(C=>s.pendingAreaIds.includes(C)):!1},x=K(()=>s.allChecklistItems.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(A=>b(A)):!1)),$=S=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[S]||S,B=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const A=S.scopeConfigurations.find(T=>b(T));if(!A)return $(S.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${i.value.areas}`:$(A.scope)},P=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const A=S.scopeConfigurations.find(T=>b(T));return A&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[A.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const A=S.scopeConfigurations.find(C=>b(C));if(!A)return null;const I=A.itemType,T=A.ids||[];if(T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(I==="Area"){const C=s.areas.filter(V=>T.includes(V.id)&&s.pendingAreaIds.includes(V.id)).map(V=>V.name);if(C.length>0)return`In: ${C.join(", ")}`}return null};return(S,A)=>(v(),y("div",iA,[l("div",aA,[l("p",rA,k(e.isEditing?`Add new ${G(i).checklist} for this ${a.value}:`:`${G(o).checklists} that will apply at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>u.value=!u.value)},k(u.value?"Cancel":`Add ${G(i).checklist}`),1)]),u.value?(v(),y("div",lA,[Ne(l("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>d.value=I),type:"text",placeholder:`Enter ${G(i).checklist} text...`,class:"add-item-input",onKeyup:lp(f,["enter"])},null,40,cA),[[et,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,uA)])):D("",!0),p.value.length>0?(v(),y("div",dA,[(v(!0),y(be,null,Oe(p.value,(I,T)=>(v(),y("div",{key:`pending-${T}`,class:"checklist-item pending"},[A[3]||(A[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",hA,[l("div",fA,[l("div",pA,k(I.text),1),l("div",vA,[A[2]||(A[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:C=>g(T),title:"Remove"},"  ",8,mA)])])])]))),128))])):D("",!0),!e.isEditing&&x.value.length===0&&p.value.length===0?(v(),y("div",gA,[l("p",null,"No "+k(G(i).checklists)+" will apply based on the current "+k(G(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),y("p",yA," Assign "+k(G(i).areas)+" to see relevant "+k(G(i).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&x.value.length>0?(v(),y("div",_A,[(v(!0),y(be,null,Oe(x.value,I=>(v(),y("div",{key:I.id,class:"checklist-item"},[A[4]||(A[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",kA,[l("div",bA,[l("div",wA,k(I.text),1),l("div",CA,[l("span",{class:"scope-pill",title:P(I)},k(B(I)),9,LA)])]),M(I)?(v(),y("div",SA,k(M(I)),1)):D("",!0)])]))),128))])):D("",!0)]))}},$A=Ke(xA,[["__scopeId","data-v-7d943b21"]]),IA={class:"notes-preview"},TA={class:"preview-actions"},MA={class:"preview-header"},AA={key:0,class:"add-item-form"},EA={class:"add-form-fields"},PA=["disabled"],DA={key:1,class:"pending-items"},OA={class:"note-header"},RA={class:"note-title"},BA={class:"note-actions"},NA=["onClick"],FA={key:0,class:"note-content"},UA={key:2,class:"empty-state"},zA={key:0,class:"help-text"},HA={key:3,class:"notes-list"},VA={class:"note-header"},GA={class:"note-title"},ZA=["title"],jA={key:0,class:"note-content"},qA={key:1,class:"note-context"},WA={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=K(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),c=E(!1),u=E(""),d=E(""),p=E([...i.modelValue]);je(()=>i.modelValue,S=>{p.value=[...S]},{deep:!0});const f=()=>{!u.value.trim()&&!d.value.trim()||(p.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",c.value=!1,_())},g=S=>{p.value.splice(S,1),_()},_=()=>{s("update:modelValue",[...p.value]),s("change")},b=S=>{const A=S.scope,I=S.itemType,T=S.ids||[];return A==="EveryoneAtCheckpoints"&&I==="Checkpoint"?T.includes("ALL_CHECKPOINTS"):A==="EveryoneInAreas"&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(C=>i.pendingAreaIds.includes(C)):!1},x=K(()=>i.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(A=>b(A)):!1)),$=S=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,B=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const A=S.scopeConfigurations.find(T=>b(T));if(!A)return $(S.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${o.value.areas}`:$(A.scope)},P=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const A=S.scopeConfigurations.find(T=>b(T));return A&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const A=S.scopeConfigurations.find(C=>b(C));if(!A)return null;const I=A.itemType,T=A.ids||[];if(T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(I==="Area"){const C=i.areas.filter(V=>T.includes(V.id)&&i.pendingAreaIds.includes(V.id)).map(V=>V.name);if(C.length>0)return`In: ${C.join(", ")}`}return null};return(S,A)=>(v(),y("div",IA,[l("div",TA,[l("p",MA,k(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>c.value=!c.value)},k(c.value?"Cancel":"Add note"),1)]),c.value?(v(),y("div",AA,[l("div",EA,[Ne(l("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>u.value=I),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[et,u.value]]),Ne(l("textarea",{"onUpdate:modelValue":A[2]||(A[2]=I=>d.value=I),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[et,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,PA)])):D("",!0),p.value.length>0?(v(),y("div",DA,[(v(!0),y(be,null,Oe(p.value,(I,T)=>(v(),y("div",{key:`pending-${T}`,class:"note-item pending"},[l("div",OA,[l("span",RA,k(I.title||"Untitled"),1),l("div",BA,[A[3]||(A[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:C=>g(T),title:"Remove"},"  ",8,NA)])]),I.content?(v(),y("div",FA,k(I.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&x.value.length===0&&p.value.length===0?(v(),y("div",UA,[l("p",null,"No notes will apply based on the current "+k(G(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),y("p",zA," Assign "+k(G(o).areas)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&x.value.length>0?(v(),y("div",HA,[(v(!0),y(be,null,Oe(x.value,I=>(v(),y("div",{key:I.id,class:"note-item"},[l("div",VA,[l("span",GA,k(I.title||"Untitled"),1),l("span",{class:"scope-pill",title:P(I)},k(B(I)),9,ZA)]),I.content?(v(),y("div",jA,k(I.content),1)):D("",!0),M(I)?(v(),y("div",qA,k(M(I)),1)):D("",!0)]))),128))])):D("",!0)]))}},KA=Ke(WA,[["__scopeId","data-v-71646c3f"]]),YA={class:"base-modal-title modal-title-with-icon"},JA=["innerHTML"],XA={key:7,class:"tab-content appearance-tab"},QA={class:"accordion-item"},eE=["innerHTML"],tE={class:"accordion-title"},nE={class:"accordion-arrow"},oE={key:0,class:"accordion-content"},sE={class:"section-description"},iE={class:"accordion-item"},aE={class:"accordion-preview"},rE={class:"accordion-arrow"},lE={key:0,class:"accordion-content"},cE={class:"section-description"},uE={class:"terminology-row"},dE={class:"terminology-field"},hE=["value"],fE={value:""},pE=["value"],vE={class:"terminology-field"},mE=["value"],gE={value:""},yE=["value"],_E={key:8,class:"tab-content incidents-tab"},kE={class:"incidents-list"},bE={class:"custom-footer"},wE={class:"footer-left"},Oh="edit_location_accordion",CE={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=E("details"),c=E(!1),u=E(null),d=E(null),p=E([]),f=E([]),g=E([]),_=E({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),b=()=>i.eventId?`${Oh}_${i.eventId}`:Oh,x=E({iconStyle:!1,terminology:!1});Yt(()=>{const Y=localStorage.getItem(b());if(Y)try{const F=JSON.parse(Y);x.value={...x.value,...F}}catch{}});const $=Y=>{x.value[Y]=!x.value[Y],localStorage.setItem(b(),JSON.stringify(x.value))},B=K(()=>{const Y=_.value.areaIds||[];if(Y.length>0){const F=i.areas.filter(N=>Y.includes(N.id)&&N.peopleTerm).sort((N,te)=>(N.checkpointCount||0)-(te.checkpointCount||0));if(F.length>0)return F[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),P=K(()=>_.value.peopleTerm?_.value.peopleTerm:B.value),M=K(()=>{const Y=_.value.areaIds||[];if(Y.length>0){const F=i.areas.filter(N=>Y.includes(N.id)&&N.checkpointTerm).sort((N,te)=>(N.checkpointCount||0)-(te.checkpointCount||0));if(F.length>0)return F[0].checkpointTerm}return o.value.checkpoint});K(()=>M.value.toLowerCase());const S=K(()=>{const Y=_.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(Y)return $i("checkpoint",Y,P.value);const F=_.value.areaIds||[];let N=null;if(F.length>0){const te=i.areas.filter(ve=>F.includes(ve.id)&&ve.checkpointTerm).sort((ve,xe)=>(ve.checkpointCount||0)-(xe.checkpointCount||0));te.length>0&&(N=te[0].checkpointTerm)}return N?$i("checkpoint",N,P.value):o.value.checkpoint}),A=K(()=>S.value.toLowerCase()),I=K(()=>{const Y=P.value;return $i("people",Y)});K(()=>I.value.toLowerCase());const T=K(()=>o.value.area);K(()=>T.value.toLowerCase());const C=K(()=>o.value.area),V=K(()=>C.value.toLowerCase()),z=K(()=>o.value.areas),ae=K(()=>!!(i.location&&i.location.id)),j=K(()=>ae.value?`Edit ${A.value}: ${i.location?.name||""}`:`Add ${A.value}`),X=K(()=>{const Y=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:P.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return i.incidents&&i.incidents.length>0&&Y.push({value:"incidents",label:"Incidents",icon:"incidents"}),Y}),ce=K(()=>X.value.findIndex(Y=>Y.value===a.value)),Te=K(()=>ce.value===X.value.length-1),Ae=K(()=>{const Y=_.value.areaIds||[],F=i.areas.filter(J=>Y.includes(J.id)).sort((J,Ue)=>(J.checkpointCount||0)-(Ue.checkpointCount||0)),N=(J,Ue)=>{for(const Qe of F){const ot=J(Qe);if(ot&&ot!=="default")return{value:ot,source:"area"}}return Ue&&Ue!=="default"?{value:Ue,source:"event"}:{value:"",source:"none"}},te=N(J=>J.checkpointStyleType||J.CheckpointStyleType,i.eventDefaultStyleType),ve=N(J=>J.checkpointStyleColor||J.CheckpointStyleColor,i.eventDefaultStyleColor),xe=N(J=>J.checkpointStyleBackgroundShape||J.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),we=N(J=>J.checkpointStyleBackgroundColor||J.CheckpointStyleBackgroundColor||J.checkpointStyleColor||J.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),Ve=N(J=>J.checkpointStyleBorderColor||J.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),$e=N(J=>J.checkpointStyleIconColor||J.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),Ze=N(J=>J.checkpointStyleSize||J.CheckpointStyleSize,i.eventDefaultStyleSize),We=N(J=>J.checkpointStyleMapRotation??J.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),se=[te,xe,we,Ve,$e,Ze,We].some(J=>J.source==="area");return{type:te.value||"default",color:ve.value,backgroundShape:xe.value,backgroundColor:we.value,borderColor:Ve.value,iconColor:$e.value,size:Ze.value,mapRotation:We.value,source:se?"area":te.value?"event":"none"}}),Ce=K(()=>Ae.value.source==="area"?`${C.value} default`:"Event default"),pe=K(()=>{const Y=_.value.styleType&&_.value.styleType!=="default"&&_.value.styleType!=="custom"?_.value.styleType:Ae.value.type,F=_.value.styleBackgroundShape||Ae.value.backgroundShape||"circle",N=_.value.styleBackgroundColor||Ae.value.backgroundColor||"#667eea",te=_.value.styleBorderColor||Ae.value.borderColor||"#ffffff",ve=_.value.styleIconColor||Ae.value.iconColor||"#ffffff";return en({type:Y||"circle",backgroundShape:F,backgroundColor:N,borderColor:te,iconColor:ve,size:"100"})}),me=K(()=>{let Y,F,N,te,ve;return ae.value&&i.location?(Y=i.location.resolvedStyleType||i.location.ResolvedStyleType,F=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",N=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",te=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",ve=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(Y=_.value.styleType&&_.value.styleType!=="default"&&_.value.styleType!=="custom"?_.value.styleType:Ae.value.type,F=_.value.styleBackgroundShape||Ae.value.backgroundShape||"circle",N=_.value.styleBackgroundColor||Ae.value.backgroundColor||"#667eea",te=_.value.styleBorderColor||Ae.value.borderColor||"#ffffff",ve=_.value.styleIconColor||Ae.value.iconColor||"#ffffff"),en({type:Y||"circle",backgroundShape:F,backgroundColor:N,borderColor:te,iconColor:ve,size:"100",outputSize:28})}),nt=K(()=>{const Y=!!_.value.checkpointTerm,F=!!_.value.peopleTerm;return Y&&F?`${$i("checkpoint",_.value.checkpointTerm,_.value.peopleTerm)}, ${_.value.peopleTerm}`:Y?$i("checkpoint",_.value.checkpointTerm,P.value):F?_.value.peopleTerm:"Using defaults"}),Le=K(()=>Te.value?null:X.value[ce.value+1]),Be=K(()=>Le.value?`${Le.value.label}...`:""),Ge=E(!1),ue=E(null);je(()=>i.location,Y=>{if(Y){const F=Y.id||"new";if(ue.value!==F){ue.value=F,Ge.value=!0;let N="",te="";Y.startTime&&(N=rr(Y.startTime)),Y.endTime&&(te=rr(Y.endTime)),_.value={id:Y.id||null,name:Y.name||"",description:Y.description||"",what3Words:Y.what3Words||"",latitude:Y.latitude||0,longitude:Y.longitude||0,requiredMarshals:Y.requiredMarshals||1,useCustomTimes:!!(Y.startTime||Y.endTime),startTime:N,endTime:te,areaIds:Y.areaIds||Y.AreaIds||[],styleType:Y.styleType||Y.StyleType||"default",styleColor:Y.styleColor||Y.StyleColor||"",styleBackgroundShape:Y.styleBackgroundShape||Y.StyleBackgroundShape||"",styleBackgroundColor:Y.styleBackgroundColor||Y.StyleBackgroundColor||"",styleBorderColor:Y.styleBorderColor||Y.StyleBorderColor||"",styleIconColor:Y.styleIconColor||Y.StyleIconColor||"",styleSize:Y.styleSize||Y.StyleSize||"",styleMapRotation:Y.styleMapRotation??Y.StyleMapRotation??"",peopleTerm:Y.peopleTerm||"",checkpointTerm:Y.checkpointTerm||"",isDynamic:Y.isDynamic||!1,locationUpdateScopeConfigurations:Y.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),je(()=>i.show,Y=>{Y?(a.value="details",c.value=!1,p.value=[],f.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(ue.value=null,Ge.value=!1)});const Pe=Y=>{_.value=Y},Ee=()=>{s("update:isDirty",!0)},Me=()=>{c.value=!c.value,s("move-location",{isMoving:c.value,formData:{..._.value}})},de=Y=>{p.value=Y,Ee()},ke=()=>{Le.value&&(a.value=Le.value.value)},H=()=>{const Y={..._.value,startTime:_.value.useCustomTimes&&_.value.startTime?new Date(_.value.startTime).toISOString():null,endTime:_.value.useCustomTimes&&_.value.endTime?new Date(_.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:i.assignments.filter(F=>F.isPending).map(F=>({marshalId:F.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:g.value};s("save",Y)},Q=()=>{i.location&&i.location.id&&s("delete",i.location.id)},ie=Y=>{s("remove-assignment",Y)},R=()=>{s("open-assign-modal")},W=()=>{s("close")},oe=(Y,F)=>{_.value[Y]=F,Ee()};return(Y,F)=>(v(),Xe(Pt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:W},{header:qe(()=>[l("h2",YA,[me.value?(v(),y("span",{key:0,class:"modal-title-icon",innerHTML:me.value},null,8,JA)):D("",!0),He(" "+k(j.value),1)])]),"tab-header":qe(()=>[Re(Pu,{modelValue:a.value,"onUpdate:modelValue":F[0]||(F[0]=N=>a.value=N),tabs:X.value},null,8,["modelValue","tabs"])]),footer:qe(()=>[l("div",bE,[l("div",wE,[ae.value?(v(),y("button",{key:0,type:"button",onClick:Q,class:"btn btn-danger"}," Delete "+k(A.value),1)):D("",!0),!ae.value&&!Te.value?(v(),y("button",{key:1,type:"button",onClick:ke,class:"btn btn-secondary mobile-only"},k(Be.value),1)):D("",!0)]),l("button",{type:"button",onClick:H,class:"btn btn-primary"},k(ae.value?"Save changes":`Create ${A.value}`),1)])]),default:qe(()=>[a.value==="details"?(v(),Xe(KI,{key:0,form:_.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":C.value,"area-term-plural":z.value,"checkpoint-term-singular":S.value,"people-term-plural":P.value,"onUpdate:form":Pe,onInput:Ee,onSave:H},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):D("",!0),a.value==="location"?(v(),Xe(tM,{key:1,form:_.value,"is-moving":c.value,"checkpoint-term-singular":S.value,"people-term-plural":P.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":ae.value,"onUpdate:form":Pe,onInput:Ee,onSave:H,onMoveLocation:Me},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):D("",!0),a.value==="marshals"?(v(),Xe(kM,{key:2,ref_key:"assignmentsTabRef",ref:u,form:_.value,assignments:e.assignments,"people-term":P.value,"person-term":I.value,"onUpdate:form":Pe,onInput:Ee,onRemoveAssignment:ie,onOpenAssignModal:R},null,8,["form","assignments","people-term","person-term"])):D("",!0),a.value==="checklists"&&ae.value?(v(),Xe(cv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:p.value,"onUpdate:modelValue":F[1]||(F[1]=N=>p.value=N),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:de},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):D("",!0),a.value==="checklists"?(v(),Xe($A,{key:4,modelValue:f.value,"onUpdate:modelValue":F[2]||(F[2]=N=>f.value=N),"all-checklist-items":e.allChecklistItems,"pending-area-ids":_.value.areaIds,areas:e.areas,"is-editing":ae.value,"checkpoint-term-singular":S.value,onChange:Ee},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),a.value==="notes"&&ae.value?(v(),Xe(zl,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):D("",!0),a.value==="notes"?(v(),Xe(KA,{key:6,modelValue:g.value,"onUpdate:modelValue":F[3]||(F[3]=N=>g.value=N),"all-notes":e.notes,"pending-area-ids":_.value.areaIds,areas:e.areas,"is-editing":ae.value,"checkpoint-term-singular":S.value,onChange:Ee},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),a.value==="appearance"?(v(),y("div",XA,[l("div",QA,[l("button",{type:"button",class:fe(["accordion-header",{expanded:x.value.iconStyle}]),onClick:F[4]||(F[4]=N=>$("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:pe.value},null,8,eE),l("span",tE,k(S.value)+" marker style",1),l("span",nE,k(x.value.iconStyle?"":""),1)],2),x.value.iconStyle?(v(),y("div",oE,[l("p",sE," Choose a custom icon for this "+k(A.value)+", or leave as Default to inherit from "+k(V.value)+" or event settings. ",1),Re(Eu,{"style-type":_.value.styleType||"default","style-color":_.value.styleColor||"","style-background-shape":_.value.styleBackgroundShape||"","style-background-color":_.value.styleBackgroundColor||"","style-border-color":_.value.styleBorderColor||"","style-icon-color":_.value.styleIconColor||"","style-size":_.value.styleSize||"","style-map-rotation":_.value.styleMapRotation??"","inherited-style-type":Ae.value.type,"inherited-style-color":Ae.value.color,"inherited-background-shape":Ae.value.backgroundShape||"","inherited-background-color":Ae.value.backgroundColor||Ae.value.color||"","inherited-border-color":Ae.value.borderColor||"","inherited-icon-color":Ae.value.iconColor||"","inherited-size":Ae.value.size||"","inherited-map-rotation":Ae.value.mapRotation??"","default-label":Ce.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":F[5]||(F[5]=N=>oe("styleType",N)),"onUpdate:styleColor":F[6]||(F[6]=N=>oe("styleColor",N)),"onUpdate:styleBackgroundShape":F[7]||(F[7]=N=>oe("styleBackgroundShape",N)),"onUpdate:styleBackgroundColor":F[8]||(F[8]=N=>oe("styleBackgroundColor",N)),"onUpdate:styleBorderColor":F[9]||(F[9]=N=>oe("styleBorderColor",N)),"onUpdate:styleIconColor":F[10]||(F[10]=N=>oe("styleIconColor",N)),"onUpdate:styleSize":F[11]||(F[11]=N=>oe("styleSize",N)),"onUpdate:styleMapRotation":F[12]||(F[12]=N=>oe("styleMapRotation",N))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):D("",!0)]),l("div",iE,[l("button",{type:"button",class:fe(["accordion-header",{expanded:x.value.terminology}]),onClick:F[13]||(F[13]=N=>$("terminology"))},[F[17]||(F[17]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),F[18]||(F[18]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",aE,k(nt.value),1),l("span",rE,k(x.value.terminology?"":""),1)],2),x.value.terminology?(v(),y("div",lE,[l("p",cE," Customise what this "+k(A.value)+" and its "+k(P.value.toLowerCase())+" are called. ",1),l("div",uE,[l("div",dE,[l("label",null,"What is this "+k(A.value)+" called?",1),l("select",{value:_.value.checkpointTerm,class:"form-input",onChange:F[14]||(F[14]=N=>{Pe({..._.value,checkpointTerm:N.target.value}),Ee()})},[l("option",fE,"Use "+k(V.value)+" default ("+k(S.value)+")",1),F[19]||(F[19]=l("option",{value:"Vehicle"},"Vehicle",-1)),F[20]||(F[20]=l("option",{value:"Car"},"Car",-1)),F[21]||(F[21]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),y(be,null,Oe(G(Cs).checkpoint,N=>(v(),y("option",{key:N,value:N},k(N),9,pE))),128))],40,hE)]),l("div",vE,[l("label",null,"What are "+k(P.value.toLowerCase())+" called here?",1),l("select",{value:_.value.peopleTerm,class:"form-input",onChange:F[15]||(F[15]=N=>{Pe({..._.value,peopleTerm:N.target.value}),Ee()})},[l("option",gE,"Use "+k(V.value)+" default ("+k(B.value)+")",1),(v(!0),y(be,null,Oe(G(Cs).people,N=>(v(),y("option",{key:N,value:N},k(N),9,yE))),128))],40,mE)])])])):D("",!0)])])):D("",!0),a.value==="incidents"?(v(),y("div",_E,[l("div",kE,[(v(!0),y(be,null,Oe(e.incidents,N=>(v(),Xe(ma,{key:N.incidentId,incident:N,onSelect:F[16]||(F[16]=te=>Y.$emit("select-incident",te))},null,8,["incident"]))),128))])])):D("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},LE=Ke(CE,[["__scopeId","data-v-f6f5b19e"]]),SE={class:"tab-content"},xE={key:0,class:"error-banner"},$E=["value"],IE={key:0,class:"field-error"},TE=["value"],ME={key:0,class:"field-error"},AE=["value"],EE={key:0,class:"field-error"},PE=["value"],DE={key:0,class:"field-error"},OE={key:1,class:"magic-link-section"},RE={key:0,class:"loading-text"},BE={key:1,class:"magic-link-container"},NE={class:"magic-link-row"},FE=["value"],UE={key:0,class:"error-text"},zE={key:1,class:"magic-link-actions"},HE=["disabled"],VE={key:2,class:"success-text"},GE={key:3,class:"error-text"},ZE={key:2,class:"error-text"},jE={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=E(null),c=E(null),u=E(null),d=E(null),p=E(""),f=E(!1),g=E(!1),_=E(""),b=E(!1),x=E(!1),$=E(!1),B=E(""),P=(C,V)=>{s("update:form",{...i.form,[C]:V}),s("input")},M=async()=>{if(!(!i.eventId||!i.marshalId)){g.value=!0,_.value="";try{const C=await ns.getMagicLink(i.eventId,i.marshalId);p.value=C.data.magicLink,f.value=C.data.hasEmail}catch(C){console.error("Failed to fetch magic link:",C),_.value="Failed to load login link"}finally{g.value=!1}}},S=E(""),A=async()=>{S.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(p.value),b.value=!0,setTimeout(()=>{b.value=!1},2e3);return}}catch(C){console.warn("Clipboard API failed, trying fallback:",C)}try{const C=document.createElement("textarea");C.value=p.value,C.style.position="fixed",C.style.left="-9999px",C.style.top="0",document.body.appendChild(C),C.focus(),C.select();const V=document.execCommand("copy");document.body.removeChild(C),V?(b.value=!0,setTimeout(()=>{b.value=!1},2e3)):(S.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3))}catch(C){console.error("Fallback copy failed:",C),S.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3)}},I=async()=>{if(!(!i.eventId||!i.marshalId)){x.value=!0,$.value=!1,B.value="";try{await ns.sendMagicLink(i.eventId,i.marshalId),$.value=!0,setTimeout(()=>{$.value=!1},3e3)}catch(C){console.error("Failed to send email:",C),B.value=C.response?.data?.message||"Failed to send email"}finally{x.value=!1}}};return je(()=>i.marshalId,C=>{C?M():(p.value="",f.value=!1)},{immediate:!0}),t({focusField:C=>{os(()=>{const z={name:a,email:c,phoneNumber:u,notes:d}[C];z?.value&&(z.value.focus(),z.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(C,V)=>(v(),y("div",SE,[e.validationErrors.general?(v(),y("div",xE,k(e.validationErrors.general),1)):D("",!0),l("div",{class:fe(["form-group",{"has-error":e.validationErrors.name}])},[V[5]||(V[5]=l("label",null,"Name *",-1)),l("input",{ref_key:"nameInputRef",ref:a,value:e.form.name,onInput:V[0]||(V[0]=z=>P("name",z.target.value)),type:"text",required:"",class:fe(["form-input",{"input-error":e.validationErrors.name}])},null,42,$E),e.validationErrors.name?(v(),y("span",IE,k(e.validationErrors.name),1)):D("",!0)],2),l("div",{class:fe(["form-group",{"has-error":e.validationErrors.email}])},[V[6]||(V[6]=l("label",null,"Email",-1)),l("input",{ref_key:"emailInputRef",ref:c,value:e.form.email,onInput:V[1]||(V[1]=z=>P("email",z.target.value)),type:"email",class:fe(["form-input",{"input-error":e.validationErrors.email}])},null,42,TE),e.validationErrors.email?(v(),y("span",ME,k(e.validationErrors.email),1)):D("",!0)],2),l("div",{class:fe(["form-group",{"has-error":e.validationErrors.phoneNumber}])},[V[7]||(V[7]=l("label",null,"Phone number",-1)),l("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:V[2]||(V[2]=z=>P("phoneNumber",z.target.value)),type:"tel",class:fe(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,AE),e.validationErrors.phoneNumber?(v(),y("span",EE,k(e.validationErrors.phoneNumber),1)):D("",!0)],2),l("div",{class:fe(["form-group",{"has-error":e.validationErrors.notes}])},[V[8]||(V[8]=l("label",null,"Notes",-1)),l("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:V[3]||(V[3]=z=>P("notes",z.target.value)),class:fe(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,PE),e.validationErrors.notes?(v(),y("span",DE,k(e.validationErrors.notes),1)):D("",!0)],2),e.marshalId?(v(),y("div",OE,[V[9]||(V[9]=l("label",null,"Login link",-1)),V[10]||(V[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),y("div",RE,"Loading link...")):p.value?(v(),y("div",BE,[l("div",NE,[l("input",{type:"text",value:p.value,readonly:"",class:"form-input magic-link-input",onFocus:V[4]||(V[4]=z=>z.target.select())},null,40,FE),l("button",{type:"button",class:"btn btn-secondary",onClick:A},k(b.value?"Copied!":"Copy link"),1)]),S.value?(v(),y("p",UE,k(S.value),1)):D("",!0),f.value?(v(),y("div",zE,[l("button",{type:"button",class:"btn btn-primary",disabled:x.value,onClick:I},k(x.value?"Sending...":"Send via email"),9,HE)])):D("",!0),$.value?(v(),y("p",VE,"Email sent successfully!")):D("",!0),B.value?(v(),y("p",GE,k(B.value),1)):D("",!0)])):_.value?(v(),y("div",ZE,k(_.value),1)):D("",!0)])):D("",!0)]))}},qE=Ke(jE,[["__scopeId","data-v-3ad9fb4d"]]),WE={class:"tab-content"},KE={class:"section-title"},YE={class:"assignments-list"},JE={class:"assignment-info"},XE={class:"assignment-header"},QE=["title"],eP={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},tP={key:2,class:"pending-badge"},nP={key:3,class:"pending-badge"},oP={key:0,class:"check-in-info"},sP={class:"check-in-method"},iP={class:"assignment-actions"},aP=["onClick"],rP=["onClick"],lP={key:0,class:"form-group",style:{"margin-top":"1.5rem"}},cP={value:""},uP=["value"],dP={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1}},emits:["input","remove-assignment","assign-to-location"],setup(e,{expose:t,emit:o}){const{termsLower:i}=St(),s=e,a=o,{pendingCheckInChanges:c,getEffectiveCheckInStatus:u,handleToggleCheckIn:d,getStatusIcon:p,getStatusColor:f,getStatusText:g,formatTime:_}=lv(()=>a("input")),b=E(""),x=K(()=>s.assignments?.length||0),$=K(()=>{const P=[...s.availableLocations];return P.sort((M,S)=>M.name.localeCompare(S.name,void 0,{numeric:!0,sensitivity:"base"})),P}),B=()=>{b.value&&(a("assign-to-location",b.value),b.value="")};return t({pendingCheckInChanges:c,clearPendingChanges:()=>{c.value.clear(),b.value=""},getPendingChanges:()=>Array.from(c.value.entries()).map(([P,M])=>({assignmentId:P,shouldBeCheckedIn:M}))}),(P,M)=>(v(),y("div",WE,[l("h3",KE,"Assigned "+k(G(i).checkpoints)+" ("+k(x.value)+")",1),l("div",YE,[(v(!0),y(be,null,Oe(e.assignments,S=>(v(),y("div",{key:S.id,class:fe(["assignment-item",{"checked-in":!S.isPending&&G(u)(S),"is-pending":S.isPending}])},[l("div",JE,[l("div",XE,[S.isPending?(v(),y("span",eP,"  ")):(v(),y("span",{key:0,class:"status-indicator",style:it({color:G(f)(S)}),title:G(g)(S)},k(G(p)(S)),13,QE)),l("strong",null,k(S.locationName),1),S.isPending?(v(),y("span",tP," (will be assigned on save) ")):G(c).has(S.id)?(v(),y("span",nP," (unsaved) ")):D("",!0)]),!S.isPending&&G(u)(S)?(v(),y("span",oP,[S.isCheckedIn&&!G(c).has(S.id)?(v(),y(be,{key:0},[He(k(G(_)(S.checkInTime))+" ",1),l("span",sP,"("+k(S.checkInMethod)+")",1)],64)):(v(),y(be,{key:1},[He(" Will be checked in on save ")],64))])):D("",!0)]),l("div",iP,[S.isPending?D("",!0):(v(),y("button",{key:0,onClick:A=>G(d)(S),class:fe(["btn btn-small",G(u)(S)?"btn-danger":"btn-secondary"])},k(G(u)(S)?"Undo":"Check in"),11,aP)),l("button",{onClick:A=>P.$emit("remove-assignment",S),class:"btn btn-small btn-danger"}," Remove ",8,rP)])],2))),128)),$.value.length>0?(v(),y("div",lP,[l("label",null,"Assign to "+k(G(i).checkpoint),1),Ne(l("select",{"onUpdate:modelValue":M[0]||(M[0]=S=>b.value=S),class:"form-input",onChange:B},[l("option",cP,"Select a "+k(G(i).checkpoint)+"...",1),(v(!0),y(be,null,Oe($.value,S=>(v(),y("option",{key:S.id,value:S.id},[He(k(S.name),1),S.description?(v(),y(be,{key:0},[He(" - "+k(S.description),1)],64)):D("",!0)],8,uP))),128))],544),[[pn,b.value]])])):D("",!0)])]))}},hP=Ke(dP,[["__scopeId","data-v-b89e2c9f"]]),fP={class:"marshal-checklist-view"},pP={key:0,class:"loading-state"},vP={key:1,class:"error-state"},mP={key:2,class:"empty-state"},gP={key:3,class:"checklist-items"},yP={class:"item-checkbox"},_P=["checked","disabled","onChange"],kP={class:"item-content"},bP={class:"item-header"},wP={class:"item-text-wrapper"},CP={class:"item-text"},LP={key:0,class:"item-context"},SP={class:"item-scope"},xP=["title"],$P={key:0,class:"completion-info"},IP={key:0,class:"pending-text"},TP={class:"completion-text"},MP={class:"completion-time"},AP={key:1,class:"uncomplete-info"},EP={key:2,class:"disabled-reason"},PP={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,c=o,u=E([]),d=E(!1),p=E(null),f=E(new Map),g=K(()=>u.value.map(I=>{const T=f.value.get(I.itemId),C=T!==void 0?T.complete:I.isCompleted,V=T!==void 0&&T.complete!==I.isCompleted;return{...I,localIsCompleted:C,isModified:V}})),_=async()=>{if(!(!a.eventId||!a.marshalId)){d.value=!0,p.value=null;try{const I=await Rt.getMarshalChecklist(a.eventId,a.marshalId);if(u.value=I.data||[],a.modelValue&&a.modelValue.length>0){const T=new Map;a.modelValue.forEach(C=>{T.set(C.itemId,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),f.value=T}}catch(I){console.error("Failed to load checklist:",I),p.value=I.response?.data?.message||"Failed to load checklist"}finally{d.value=!1}}},b=I=>{const T=f.value.get(I.itemId),C=T!==void 0?T.complete:I.isCompleted;f.value.set(I.itemId,{complete:!C,contextType:I.completionContextType,contextId:I.completionContextId}),x()},x=()=>{const I=[];for(const[T,C]of f.value.entries()){const V=u.value.find(z=>z.itemId===T);V&&C.complete!==V.isCompleted&&I.push({itemId:T,complete:C.complete,contextType:C.contextType,contextId:C.contextId})}c("update:modelValue",I),c("change",I)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const I=new Map;a.modelValue.forEach(T=>{I.set(T.itemId,{complete:T.complete,contextType:T.contextType,contextId:T.contextId})}),f.value=I}},loadChecklist:_});const B=I=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[I.matchedScope]||I.matchedScope,P=I=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to this person",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[I.matchedScope]||"",M=I=>I.completionContextType==="Checkpoint"||I.completionContextType==="Area"?"Already completed by someone else":"Cannot be completed",S=I=>{if(!I.completionContextType||!I.completionContextId)return null;if(I.completionContextType==="Checkpoint"){const T=a.locations.find(V=>V.id===I.completionContextId);if(!T)return null;const C=T.description?`${T.name} - ${T.description}`:T.name;return`at ${s.value.checkpoint} ${C}`}if(I.completionContextType==="Area"){const T=a.areas.find(C=>C.id===I.completionContextId);return T?`in ${s.value.area} ${T.name}`:null}return I.completionContextType==="Personal"?I.contextOwnerName?`for ${I.contextOwnerName}`:"assigned individually":null},A=I=>I?new Date(I).toLocaleString():"";return je(()=>[a.eventId,a.marshalId],()=>{_()},{immediate:!0}),(I,T)=>(v(),y("div",fP,[d.value?(v(),y("div",pP," Loading checklist... ")):p.value?(v(),y("div",vP,[l("p",null,k(p.value),1),l("button",{onClick:_,class:"btn btn-secondary btn-small"}," Retry ")])):u.value.length===0?(v(),y("div",mP,[...T[0]||(T[0]=[l("p",null,"No checklist items for this person.",-1)])])):(v(),y("div",gP,[(v(!0),y(be,null,Oe(g.value,C=>(v(),y("div",{key:`${C.itemId}_${C.completionContextType}_${C.completionContextId}`,class:fe(["checklist-item",{"item-completed":C.localIsCompleted,"item-modified":C.isModified}])},[l("div",yP,[l("input",{type:"checkbox",checked:C.localIsCompleted,disabled:!C.canBeCompletedByMe,onChange:V=>b(C)},null,40,_P)]),l("div",kP,[l("div",bP,[l("div",wP,[l("div",CP,k(C.text),1),S(C)?(v(),y("div",LP,k(S(C)),1)):D("",!0)]),l("div",SP,[l("span",{class:"scope-pill",title:P(C)},k(B(C)),9,xP)])]),C.localIsCompleted?(v(),y("div",$P,[C.isModified&&!C.isCompleted?(v(),y("span",IP," Will be marked as completed (pending save) ")):(v(),y(be,{key:1},[l("span",TP," Completed by "+k(C.completedByActorName||"Unknown"),1),l("span",MP,k(A(C.completedAt)),1)],64))])):D("",!0),C.isModified&&C.isCompleted&&!C.localIsCompleted?(v(),y("div",AP,[...T[1]||(T[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):D("",!0),!C.canBeCompletedByMe&&!C.localIsCompleted?(v(),y("div",EP,k(M(C)),1)):D("",!0)])],2))),128))]))]))}},DP=Ke(PP,[["__scopeId","data-v-25f2e028"]]),OP={class:"checklist-preview"},RP={class:"preview-actions"},BP={class:"preview-header"},NP={key:0,class:"add-item-form"},FP=["placeholder"],UP=["disabled"],zP={key:1,class:"pending-items"},HP={class:"item-content"},VP={class:"item-header"},GP={class:"item-text"},ZP={class:"item-scope"},jP=["onClick"],qP={key:2,class:"empty-state"},WP={key:0,class:"help-text"},KP={key:3,class:"checklist-items"},YP={class:"item-content"},JP={class:"item-header"},XP={class:"item-text"},QP={class:"item-scope"},e3=["title"],t3={key:0,class:"item-context"},n3={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=E(!1),c=E(""),u=E([...i.modelValue]);je(()=>i.modelValue,M=>{u.value=[...M]},{deep:!0});const d=()=>{c.value.trim()&&(u.value.push({text:c.value.trim(),isNew:!0}),c.value="",a.value=!1,f())},p=M=>{u.value.splice(M,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},g=K(()=>{const M=new Set;for(const S of i.pendingLocationIds){const A=i.allLocations.find(I=>I.id===S);A&&(A.areaIds||A.AreaIds||[]).forEach(T=>M.add(T))}return[...M]}),_=M=>{const S=M.scope,A=M.itemType,I=M.ids||[];return S==="SpecificPeople"&&A==="Marshal"?I.includes("ALL_MARSHALS"):(S==="EveryoneAtCheckpoints"||S==="OnePerCheckpoint")&&A==="Checkpoint"?I.includes("ALL_CHECKPOINTS")?!0:I.some(T=>i.pendingLocationIds.includes(T)):S==="OnePerCheckpoint"&&A==="Area"?I.includes("ALL_AREAS")?!0:I.some(T=>g.value.includes(T)):(S==="EveryoneInAreas"||S==="OnePerArea"||S==="EveryAreaLead"||S==="OneLeadPerArea")&&A==="Area"?I.includes("ALL_AREAS")?!0:I.some(T=>g.value.includes(T)):!1},b=K(()=>i.allChecklistItems.filter(M=>M.scopeConfigurations&&M.scopeConfigurations.length>0?M.scopeConfigurations.some(S=>_(S)):!1)),x=M=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[M]||M,$=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"Unknown";const S=M.scopeConfigurations.find(I=>_(I));if(!S)return x(M.scopeConfigurations[0].scope);const A=S.ids||[];return A.includes("ALL_MARSHALS")?"Everyone":A.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${o.value.areas}`:x(S.scope)},B=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"";const S=M.scopeConfigurations.find(I=>_(I));return S&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[S.scope]||""},P=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return null;const S=M.scopeConfigurations.find(T=>_(T));if(!S)return null;const A=S.itemType,I=S.ids||[];if(I.includes("ALL_MARSHALS")||I.includes("ALL_CHECKPOINTS")||I.includes("ALL_AREAS"))return null;if(A==="Checkpoint"){const T=i.allLocations.filter(C=>I.includes(C.id)&&i.pendingLocationIds.includes(C.id)).map(C=>C.name);if(T.length>0)return`At: ${T.join(", ")}`}if(A==="Area"){const T=i.areas.filter(C=>I.includes(C.id)&&g.value.includes(C.id)).map(C=>C.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(M,S)=>(v(),y("div",OP,[l("div",RP,[l("p",BP,k(e.isEditing?`Add new ${G(o).checklist} for this ${G(o).person}:`:`${G(o).checklists} that will apply to this ${G(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=A=>a.value=!a.value)},k(a.value?"Cancel":`Add ${G(o).checklist}`),1)]),a.value?(v(),y("div",NP,[Ne(l("input",{"onUpdate:modelValue":S[1]||(S[1]=A=>c.value=A),type:"text",placeholder:`Enter ${G(o).checklist} text...`,class:"add-item-input",onKeyup:lp(d,["enter"])},null,40,FP),[[et,c.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim(),onClick:d}," Add ",8,UP)])):D("",!0),u.value.length>0?(v(),y("div",zP,[(v(!0),y(be,null,Oe(u.value,(A,I)=>(v(),y("div",{key:`pending-${I}`,class:"checklist-item pending"},[S[3]||(S[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",HP,[l("div",VP,[l("div",GP,k(A.text),1),l("div",ZP,[S[2]||(S[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:T=>p(I),title:"Remove"},"  ",8,jP)])])])]))),128))])):D("",!0),!e.isEditing&&b.value.length===0&&u.value.length===0?(v(),y("div",qP,[l("p",null,"No "+k(G(o).checklists)+" will apply based on the current "+k(G(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),y("p",WP," Assign "+k(G(o).checkpoints)+" to see relevant "+k(G(o).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&b.value.length>0?(v(),y("div",KP,[(v(!0),y(be,null,Oe(b.value,A=>(v(),y("div",{key:A.id,class:"checklist-item"},[S[4]||(S[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",YP,[l("div",JP,[l("div",XP,k(A.text),1),l("div",QP,[l("span",{class:"scope-pill",title:B(A)},k($(A)),9,e3)])]),P(A)?(v(),y("div",t3,k(P(A)),1)):D("",!0)])]))),128))])):D("",!0)]))}},o3=Ke(n3,[["__scopeId","data-v-6deaacc2"]]),s3={class:"notes-preview"},i3={class:"preview-actions"},a3={class:"preview-header"},r3={key:0,class:"add-item-form"},l3={class:"add-form-fields"},c3=["disabled"],u3={key:1,class:"pending-items"},d3={class:"note-header"},h3={class:"note-title"},f3={class:"note-actions"},p3=["onClick"],v3={key:0,class:"note-content"},m3={key:2,class:"empty-state"},g3={key:0,class:"help-text"},y3={key:3,class:"notes-list"},_3={class:"note-header"},k3={class:"note-title"},b3=["title"],w3={key:0,class:"note-content"},C3={key:1,class:"note-context"},L3={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=E(!1),c=E(""),u=E(""),d=E([...i.modelValue]);je(()=>i.modelValue,S=>{d.value=[...S]},{deep:!0});const p=()=>{!c.value.trim()&&!u.value.trim()||(d.value.push({title:c.value.trim(),content:u.value.trim(),isNew:!0}),c.value="",u.value="",a.value=!1,g())},f=S=>{d.value.splice(S,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},_=K(()=>{const S=new Set;for(const A of i.pendingLocationIds){const I=i.allLocations.find(T=>T.id===A);I&&(I.areaIds||I.AreaIds||[]).forEach(C=>S.add(C))}return[...S]}),b=S=>{const A=S.scope,I=S.itemType,T=S.ids||[];return A==="SpecificPeople"&&I==="Marshal"?T.includes("ALL_MARSHALS"):A==="EveryoneAtCheckpoints"&&I==="Checkpoint"?T.includes("ALL_CHECKPOINTS")?!0:T.some(C=>i.pendingLocationIds.includes(C)):A==="EveryoneInAreas"&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(C=>_.value.includes(C)):!1},x=K(()=>i.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(A=>b(A)):!1)),$=S=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,B=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const A=S.scopeConfigurations.find(T=>b(T));if(!A)return $(S.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_MARSHALS")?"Everyone":I.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${o.value.areas}`:$(A.scope)},P=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const A=S.scopeConfigurations.find(T=>b(T));return A&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const A=S.scopeConfigurations.find(C=>b(C));if(!A)return null;const I=A.itemType,T=A.ids||[];if(T.includes("ALL_MARSHALS")||T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(I==="Checkpoint"){const C=i.allLocations.filter(V=>T.includes(V.id)&&i.pendingLocationIds.includes(V.id)).map(V=>V.name);if(C.length>0)return`At: ${C.join(", ")}`}if(I==="Area"){const C=i.areas.filter(V=>T.includes(V.id)&&_.value.includes(V.id)).map(V=>V.name);if(C.length>0)return`In: ${C.join(", ")}`}return null};return(S,A)=>(v(),y("div",s3,[l("div",i3,[l("p",a3,k(e.isEditing?`Add new note for this ${G(o).person}:`:`Notes that will be visible to this ${G(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>a.value=!a.value)},k(a.value?"Cancel":"Add note"),1)]),a.value?(v(),y("div",r3,[l("div",l3,[Ne(l("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>c.value=I),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[et,c.value]]),Ne(l("textarea",{"onUpdate:modelValue":A[2]||(A[2]=I=>u.value=I),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[et,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,c3)])):D("",!0),d.value.length>0?(v(),y("div",u3,[(v(!0),y(be,null,Oe(d.value,(I,T)=>(v(),y("div",{key:`pending-${T}`,class:"note-item pending"},[l("div",d3,[l("span",h3,k(I.title||"Untitled"),1),l("div",f3,[A[3]||(A[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:C=>f(T),title:"Remove"},"  ",8,p3)])]),I.content?(v(),y("div",v3,k(I.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&x.value.length===0&&d.value.length===0?(v(),y("div",m3,[l("p",null,"No notes will be visible based on the current "+k(G(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),y("p",g3," Assign "+k(G(o).checkpoints)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&x.value.length>0?(v(),y("div",y3,[(v(!0),y(be,null,Oe(x.value,I=>(v(),y("div",{key:I.id,class:"note-item"},[l("div",_3,[l("span",k3,k(I.title||"Untitled"),1),l("span",{class:"scope-pill",title:P(I)},k(B(I)),9,b3)]),I.content?(v(),y("div",w3,k(I.content),1)):D("",!0),M(I)?(v(),y("div",C3,k(M(I)),1)):D("",!0)]))),128))])):D("",!0)]))}},S3=Ke(L3,[["__scopeId","data-v-e8e0946a"]]),x3={key:6,class:"tab-content incidents-tab"},$3={class:"incidents-list"},I3={class:"custom-footer"},T3={class:"footer-left"},M3={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,c=o,u=E("details"),d=E(null),p=E(null),f=E(null),g=E([]),_=E([]),b=E([]),x=E([]),$=E({name:"",email:"",phoneNumber:"",notes:""}),B=K(()=>{const Le=a.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,Be=$.value.name?.trim();return Be?`${Le} - ${Be}`:Le}),P=K(()=>{const Le=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:i.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:i.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return a.incidents&&a.incidents.length>0&&Le.push({value:"incidents",label:"Incidents",icon:"incidents"}),Le}),M=K(()=>P.value.findIndex(Le=>Le.value===u.value)),S=K(()=>M.value===P.value.length-1),A=K(()=>S.value?null:P.value[M.value+1]),I=K(()=>A.value?`${A.value.label}...`:""),T=K(()=>_.value.map(Le=>Le.locationId)),C=K(()=>a.isEditing?a.assignments:_.value.map(Le=>({id:`pending-${Le.locationId}`,locationId:Le.locationId,locationName:a.allLocations.find(Be=>Be.id===Le.locationId)?.name||"Unknown",isPending:!0}))),V=K(()=>{if(a.isEditing)return a.availableLocations;const Le=_.value.map(Be=>Be.locationId);return a.allLocations.filter(Be=>!Le.includes(Be.id))});je(()=>a.marshal,Le=>{Le?$.value={name:Le.name||"",email:Le.email||"",phoneNumber:Le.phoneNumber||"",notes:Le.notes||""}:$.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),je(()=>a.show,Le=>{Le&&(u.value="details",g.value=[],_.value=[],b.value=[],x.value=[],a.isEditing||($.value={name:"",email:"",phoneNumber:"",notes:""}),p.value?.clearPendingChanges&&p.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const z=Le=>{$.value=Le},ae=()=>{c("update:isDirty",!0)},j=()=>{c("update:isDirty",!0)},X=()=>{A.value&&(u.value=A.value.value)},ce=()=>{const Le={...$.value,checkInChanges:p.value?.getPendingChanges?.()||[],checklistChanges:g.value||[],pendingAssignments:a.isEditing?[]:_.value,pendingNewChecklistItems:b.value,pendingNewNotes:x.value};c("save",Le)},Te=()=>{c("delete")},Ae=Le=>{!a.isEditing&&Le.isPending?_.value=_.value.filter(Be=>Be.locationId!==Le.locationId):c("remove-assignment",Le)},Ce=Le=>{a.isEditing?c("assign-to-location",Le):(_.value.push({locationId:Le}),c("update:isDirty",!0))},pe=()=>{c("close")};return t({switchToTab:Le=>{u.value=Le},focusField:Le=>{d.value?.focusField&&d.value.focusField(Le)}}),(Le,Be)=>(v(),Xe(Pt,{show:e.show,title:B.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:pe},{"tab-header":qe(()=>[Re(Pu,{modelValue:u.value,"onUpdate:modelValue":Be[0]||(Be[0]=Ge=>u.value=Ge),tabs:P.value},null,8,["modelValue","tabs"])]),footer:qe(()=>[l("div",I3,[l("div",T3,[e.isEditing?(v(),y("button",{key:0,type:"button",onClick:Te,class:"btn btn-danger"}," Delete "+k(G(s).person),1)):D("",!0),!e.isEditing&&!S.value?(v(),y("button",{key:1,type:"button",onClick:X,class:"btn btn-secondary mobile-only"},k(I.value),1)):D("",!0)]),l("button",{type:"button",onClick:ce,class:"btn btn-primary"},k(e.isEditing?"Save changes":`Create ${G(s).person}`),1)])]),default:qe(()=>[u.value==="details"?(v(),Xe(qE,{key:0,ref_key:"detailsTabRef",ref:d,form:$.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":z,onInput:ae},null,8,["form","event-id","marshal-id","validation-errors"])):D("",!0),u.value==="checkpoints"?(v(),Xe(hP,{key:1,ref_key:"checkpointsTabRef",ref:p,assignments:C.value,"available-locations":V.value,"is-new-marshal":!e.isEditing,onInput:ae,onRemoveAssignment:Ae,onAssignToLocation:Ce},null,8,["assignments","available-locations","is-new-marshal"])):D("",!0),u.value==="checklists"&&e.isEditing?(v(),Xe(DP,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:g.value,"onUpdate:modelValue":Be[1]||(Be[1]=Ge=>g.value=Ge),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:j},null,8,["modelValue","event-id","marshal-id","locations","areas"])):D("",!0),u.value==="checklists"?(v(),Xe(o3,{key:3,modelValue:b.value,"onUpdate:modelValue":Be[2]||(Be[2]=Ge=>b.value=Ge),"all-checklist-items":e.allChecklistItems,"pending-location-ids":T.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ae},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),u.value==="notes"&&e.isEditing?(v(),Xe(zl,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):D("",!0),u.value==="notes"?(v(),Xe(S3,{key:5,modelValue:x.value,"onUpdate:modelValue":Be[3]||(Be[3]=Ge=>x.value=Ge),"all-notes":e.eventNotes,"pending-location-ids":T.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ae},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),u.value==="incidents"?(v(),y("div",x3,[l("div",$3,[(v(!0),y(be,null,Oe(e.incidents,Ge=>(v(),Xe(ma,{key:Ge.incidentId,incident:Ge,onSelect:Be[4]||(Be[4]=ue=>Le.$emit("select-incident",ue))},null,8,["incident"]))),128))])])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},A3=Ke(M3,[["__scopeId","data-v-83d0b35b"]]),E3={class:"locations-list"},P3={class:"conflict-actions"},D3={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=t,a=u=>{s("choice",u)},c=()=>{s("close")};return(u,d)=>(v(),Xe(Pt,{show:e.show,title:`${G(o).person} already assigned`,size:"medium","z-index":1100,onClose:c},{actions:qe(()=>[l("div",P3,[l("button",{onClick:d[0]||(d[0]=p=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+k(G(i).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=p=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=p=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=p=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:qe(()=>[l("p",null,[l("strong",null,k(e.conflictData.marshalName),1),d[4]||(d[4]=He(" is currently assigned to: ",-1))]),l("ul",E3,[(v(!0),y(be,null,Oe(e.conflictData.locations,p=>(v(),y("li",{key:p},k(p),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},O3=Ke(D3,[["__scopeId","data-v-997e8aaa"]]),R3={key:0,class:"assign-marshal-section"},B3={value:""},N3=["value"],F3=["disabled"],U3={key:1,class:"assign-marshal-section create-mode"},z3={class:"form-group"},H3={class:"form-group"},V3={class:"form-group"},G3={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=E(!1),c=E(""),u=E({name:"",email:"",phoneNumber:""});je(()=>i.show,b=>{b||(a.value=!1,c.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{a.value=!0},p=()=>{c.value&&s("assign-existing",c.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},_=()=>{s("close")};return(b,x)=>(v(),Xe(Pt,{show:e.show,title:a.value?`Create new ${G(o).person}`:`Assign ${G(o).person} to ${e.locationName}`,size:"medium",onClose:_},{actions:qe(()=>[a.value?(v(),y(be,{key:0},[l("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):D("",!0)]),default:qe(()=>[a.value?(v(),y("div",U3,[l("h3",null,"Create new "+k(G(o).person),1),l("div",z3,[x[5]||(x[5]=l("label",null,"Name *",-1)),Ne(l("input",{"onUpdate:modelValue":x[1]||(x[1]=$=>u.value.name=$),type:"text",required:"",class:"form-input"},null,512),[[et,u.value.name]])]),l("div",H3,[x[6]||(x[6]=l("label",null,"Email",-1)),Ne(l("input",{"onUpdate:modelValue":x[2]||(x[2]=$=>u.value.email=$),type:"email",class:"form-input"},null,512),[[et,u.value.email]])]),l("div",V3,[x[7]||(x[7]=l("label",null,"Phone",-1)),Ne(l("input",{"onUpdate:modelValue":x[3]||(x[3]=$=>u.value.phoneNumber=$),type:"tel",class:"form-input"},null,512),[[et,u.value.phoneNumber]])])])):(v(),y("div",R3,[l("h3",null,"Select existing "+k(G(o).person),1),Ne(l("select",{"onUpdate:modelValue":x[0]||(x[0]=$=>c.value=$),class:"form-input"},[l("option",B3,"Choose a "+k(G(o).person)+"...",1),(v(!0),y(be,null,Oe(e.marshals,$=>(v(),y("option",{key:$.id,value:$.id},[He(k($.name)+" ",1),$.assignedLocationIds&&$.assignedLocationIds.length>0?(v(),y(be,{key:0},[He(" (assigned to "+k($.assignedLocationIds.length)+" "+k($.assignedLocationIds.length>1?G(o).checkpoints:G(o).checkpoint)+") ",1)],64)):D("",!0)],8,N3))),128))],512),[[pn,c.value]]),l("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!c.value}," Assign selected "+k(G(o).person),9,F3),x[4]||(x[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+k(G(o).person),1)]))]),_:1},8,["show","title"]))}},Z3=Ke(G3,[["__scopeId","data-v-fa70b913"]]),j3={class:"shift-times-content"},q3={class:"info-text"},W3={class:"time-delta-info"},K3={class:"delta-detail"},Y3={class:"delta-detail"},J3={class:"delta-summary"},X3={class:"affected-checkpoints"},Q3={class:"option-selection"},e4={class:"radio-option"},t4={class:"radio-option"},n4={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,c=E("shift"),u=K(()=>{const _=new Date(s.oldEventDate);return new Date(s.newEventDate)-_}),d=_=>new Date(_).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=_=>{const b=Math.abs(_),x=_>=0?"+":"-",$=Math.floor(b/(1e3*60*60*24)),B=Math.floor(b%(1e3*60*60*24)/(1e3*60*60)),P=Math.floor(b%(1e3*60*60)/(1e3*60)),M=[];return $>0&&M.push(`${$}d`),B>0&&M.push(`${B}h`),P>0&&M.push(`${P}m`),`${x}${M.join(" ")}`},f=()=>{a("confirm",{shouldShift:c.value==="shift",timeDelta:u.value})},g=()=>{a("cancel")};return(_,b)=>(v(),Xe(Pt,{show:e.show,title:`Shift ${G(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:qe(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary"},k(c.value==="shift"?"Shift Times":"Keep Times"),1)]),default:qe(()=>[l("div",j3,[l("p",q3," You've changed the event date/time. Some "+k(G(i).checkpoints)+" have custom times set. ",1),l("div",W3,[b[2]||(b[2]=l("strong",null,"Event time change:",-1)),l("div",K3," Old: "+k(d(e.oldEventDate)),1),l("div",Y3," New: "+k(d(e.newEventDate)),1),l("div",J3," Delta: "+k(p(u.value)),1)]),l("p",X3,[l("strong",null,k(e.affectedCheckpointsCount)+" "+k(e.affectedCheckpointsCount===1?G(i).checkpoint:G(i).checkpoints),1),b[3]||(b[3]=He(" with custom times will be shifted by the same amount. ",-1))]),l("div",Q3,[l("label",e4,[Ne(l("input",{"onUpdate:modelValue":b[0]||(b[0]=x=>c.value=x),type:"radio",value:"shift",name:"shift-option"},null,512),[[Hd,c.value]]),l("div",null,[l("strong",null,"Shift all "+k(G(i).checkpoint)+" times",1),b[4]||(b[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",t4,[Ne(l("input",{"onUpdate:modelValue":b[1]||(b[1]=x=>c.value=x),type:"radio",value:"keep",name:"shift-option"},null,512),[[Hd,c.value]]),l("div",null,[l("strong",null,"Keep "+k(G(i).checkpoint)+" times unchanged",1),l("small",null,k(G(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},o4=Ke(n4,[["__scopeId","data-v-a6454aff"]]),s4={key:0,class:"tab-content"},i4={class:"form-group"},a4=["disabled"],r4={class:"form-group"},l4={key:1,class:"tab-content"},c4={class:"boundary-section"},u4={class:"boundary-actions"},d4={key:2,class:"tab-content"},h4={class:"section-title"},f4={class:"contacts-actions"},p4={key:0,class:"area-contacts-list"},v4=["onClick"],m4={class:"contact-info"},g4={key:0,class:"contact-role-badge"},y4={key:1,class:"contact-details"},_4={key:0},k4={key:1},b4={key:3,class:"tab-content"},w4={class:"section-title"},C4={key:0,class:"empty-state"},L4={key:1,class:"checkpoints-list"},S4=["onClick"],x4={class:"checkpoint-header"},$4=["innerHTML"],I4={class:"checkpoint-name-section"},T4={key:0,class:"checkpoint-description"},M4={class:"checkpoint-stats"},A4={class:"checkpoint-details"},E4={class:"detail-row with-pills"},P4={class:"detail-label"},D4={class:"detail-value"},O4={key:0,class:"warning-text"},R4={key:0,class:"marshal-pills"},B4={class:"detail-row"},N4={class:"detail-value"},F4={key:0,class:"detail-row"},U4={key:1,class:"detail-row"},z4={key:4,class:"placeholder-message"},H4={key:6,class:"placeholder-message"},V4={key:8,class:"placeholder-message"},G4={key:9,class:"tab-content appearance-tab"},Z4={class:"accordion-item"},j4=["innerHTML"],q4={class:"accordion-title"},W4={class:"accordion-arrow"},K4={key:0,class:"accordion-content"},Y4={class:"section-description"},J4={class:"color-picker"},X4=["title","onClick"],Q4={class:"accordion-item"},e6=["innerHTML"],t6={class:"accordion-title"},n6={class:"accordion-arrow"},o6={key:0,class:"accordion-content"},s6={class:"section-description"},i6={class:"accordion-item"},a6={class:"accordion-title"},r6={class:"accordion-preview"},l6={class:"accordion-arrow"},c6={key:0,class:"accordion-content"},u6={class:"section-description"},d6={class:"form-group"},h6={value:""},f6=["value"],p6={class:"accordion-item"},v6={class:"accordion-title"},m6={class:"accordion-preview"},g6={class:"accordion-arrow"},y6={key:0,class:"accordion-content"},_6={class:"section-description"},k6={class:"form-group"},b6={value:""},w6=["value"],C6={key:10,class:"tab-content incidents-tab"},L6={class:"incidents-list"},S6={class:"custom-footer"},x6={class:"footer-left"},Rh="edit_area_accordion",$6={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","add-area-contact","edit-contact","select-incident"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=()=>$.value.peopleTerm?$.value.peopleTerm:d.eventPeopleTerm||"Marshals",a=(F=!0)=>{const N=$.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",te=s();return F?tv("checkpoint",N,te):$i("checkpoint",N,te)},c=(F=!0)=>a(F).toLowerCase(),u=F=>F.resolvedPeopleTerm?F.resolvedPeopleTerm:F.peopleTerm?F.peopleTerm:$.value.peopleTerm?$.value.peopleTerm:d.eventPeopleTerm||"Marshals",d=e,p=t,f=E("details"),g=E(null),_=E([]),b=E({}),x=E({}),$=E({name:"",description:"",color:Qr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),B=()=>d.eventId?`${Rh}_${d.eventId}`:Rh,P=E({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});Yt(()=>{const F=localStorage.getItem(B());if(F)try{const N=JSON.parse(F);P.value={...P.value,...N}}catch{}});const M=F=>{P.value[F]=!P.value[F],localStorage.setItem(B(),JSON.stringify(P.value))},S=K(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${$.value.color||Qr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),A=K(()=>{const F=$.value.checkpointStyleType!=="default"||$.value.checkpointStyleBackgroundShape||$.value.checkpointStyleBackgroundColor||$.value.checkpointStyleBorderColor||$.value.checkpointStyleIconColor||$.value.checkpointStyleSize,N=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!F&&!N)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const te=$.value.checkpointStyleType&&$.value.checkpointStyleType!=="default"?$.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",ve=$.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",xe=$.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",we=$.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Ve=$.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",$e=$.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return en({type:te!=="default"?te:ve,backgroundShape:ve,backgroundColor:xe,borderColor:we,iconColor:Ve,size:$e,outputSize:24})}),I=K(()=>d.area&&d.area.id),T=K(()=>{const F=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:a(),icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&F.push({value:"incidents",label:"Incidents",icon:"incidents"}),F}),C=K(()=>T.value.findIndex(F=>F.value===f.value)),V=K(()=>C.value===T.value.length-1),z=K(()=>V.value?null:T.value[C.value+1]),ae=K(()=>z.value?`${z.value.label}...`:""),j=K(()=>{if(!d.area||!d.area.id)return[];const F=d.checkpoints.filter(N=>N.areaIds&&N.areaIds.includes(d.area.id)).map(N=>N.id);return d.assignments.filter(N=>F.includes(N.locationId))}),X=K(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(F=>F.areaIds&&F.areaIds.includes(d.area.id))),ce=K(()=>{const F=[...X.value];return F.sort((N,te)=>{const ve=N.name.match(/^(\d+)/),xe=te.name.match(/^(\d+)/);if(ve&&xe){const we=parseInt(ve[1]),Ve=parseInt(xe[1]);if(we!==Ve)return we-Ve}return N.name.localeCompare(te.name,void 0,{numeric:!0,sensitivity:"base"})}),F}),Te=K(()=>!d.area||!d.area.id?[]:d.contacts.filter(F=>F.scopeConfigurations?F.scopeConfigurations.some(N=>N.scope==="EveryoneInAreas"&&N.itemType==="Area"?N.ids?.includes("ALL_AREAS")?!0:N.ids?.includes(d.area.id):!1):!1)),Ae=F=>d.assignments.filter(N=>N.locationId===F),Ce=F=>[...Ae(F)].sort((te,ve)=>(te.marshalName||"").localeCompare(ve.marshalName||"",void 0,{sensitivity:"base"})),pe=F=>Ae(F.id).filter(te=>te.isCheckedIn).length,me=F=>{const N=Ae(F.id);if(N.length===0)return"status-none";const te=N.filter(ve=>ve.isCheckedIn).length;return te===0?"status-none":te===N.length?"status-complete":"status-partial"},nt=F=>{const N=Ae(F.id),te=u(F).toLowerCase();if(N.length===0)return`No ${te}`;const ve=N.filter(xe=>xe.isCheckedIn).length;return ve===0?"Not checked in":ve===N.length?"Fully checked in":`Partially checked in (${ve}/${N.length})`},Le=F=>{const N=b.value[F];return!N||N.total===0?"":N.completed===N.total?"status-complete":N.completed===0?"status-none":"status-partial"},Be=F=>{const N=b.value[F];return N?N.total===0?"No tasks":N.completed===N.total?"All tasks completed":`${N.completed}/${N.total} completed`:""},Ge=async F=>{if(!(b.value[F]||x.value[F])){x.value[F]=!0;try{const te=(await Rt.getCheckpointChecklist(d.eventId,F)).data||[];b.value[F]={total:te.length,completed:te.filter(ve=>ve.isCompleted).length}}catch(N){console.error("Failed to load checklist status for checkpoint:",F,N),b.value[F]={total:0,completed:0}}finally{x.value[F]=!1}}};je(()=>d.area,F=>{if(F){const N=F.polygon?typeof F.polygon=="string"?JSON.parse(F.polygon):F.polygon:[];$.value={name:F.name||"",description:F.description||"",color:F.color||Qr,displayOrder:F.displayOrder||0,isDefault:F.isDefault||!1,polygon:N,checkpointStyleType:F.checkpointStyleType||"default",checkpointStyleColor:F.checkpointStyleColor||"",checkpointStyleBackgroundShape:F.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:F.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:F.checkpointStyleBorderColor||"",checkpointStyleIconColor:F.checkpointStyleIconColor||"",checkpointStyleSize:F.checkpointStyleSize||"",checkpointStyleMapRotation:F.checkpointStyleMapRotation??"",peopleTerm:F.peopleTerm||"",checkpointTerm:F.checkpointTerm||""}}else $.value={name:"",description:"",color:Eh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),je(()=>d.show,F=>{F&&(f.value=d.initialTab||"details",_.value=[],b.value={},x.value={},I.value||($.value={name:"",description:"",color:Eh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),g.value?.resetLocalState&&g.value.resetLocalState())}),je(f,F=>{F==="checkpoints"&&d.area&&d.area.id&&X.value.forEach(N=>{setTimeout(()=>Ge(N.id),0)})});const ue=()=>{p("update:isDirty",!0)},Pe=F=>{$.value.color=F,ue()},Ee=(F,N)=>{$.value[F]=N,ue()},Me=()=>{p("draw-boundary",$.value)},de=()=>{$.value.polygon=[],ue()},ke=()=>{p("add-area-contact",d.area)},H=F=>F?F.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"",Q=F=>{_.value=F,ue()},ie=()=>{z.value&&(f.value=z.value.value)},R=()=>{const F=d.area?{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,displayOrder:$.value.displayOrder,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm,checklistChanges:_.value||[]}:{name:$.value.name,description:$.value.description,color:$.value.color,polygon:$.value.polygon.length>0?$.value.polygon:null,checkpointStyleType:$.value.checkpointStyleType,checkpointStyleColor:$.value.checkpointStyleColor,checkpointStyleBackgroundShape:$.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:$.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:$.value.checkpointStyleBorderColor,checkpointStyleIconColor:$.value.checkpointStyleIconColor,checkpointStyleSize:$.value.checkpointStyleSize,checkpointStyleMapRotation:$.value.checkpointStyleMapRotation!=null&&$.value.checkpointStyleMapRotation!==""?String($.value.checkpointStyleMapRotation):null,peopleTerm:$.value.peopleTerm,checkpointTerm:$.value.checkpointTerm};p("save",F)},W=()=>{p("delete",d.area.id)},oe=()=>{p("close")},Y=F=>{const N=F.resolvedStyleType||F.ResolvedStyleType,te=F.resolvedStyleBackgroundColor||F.ResolvedStyleBackgroundColor||F.resolvedStyleColor||F.ResolvedStyleColor,ve=F.resolvedStyleBorderColor||F.ResolvedStyleBorderColor,xe=F.resolvedStyleIconColor||F.ResolvedStyleIconColor,we=F.resolvedStyleBackgroundShape||F.ResolvedStyleBackgroundShape;return N&&N!=="default"||te||ve||xe||we&&we!=="circle"?en({type:N||"circle",backgroundShape:we||"circle",backgroundColor:te||"#667eea",borderColor:ve||"#ffffff",iconColor:xe||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};return(F,N)=>(v(),Xe(Pt,{show:e.show,title:e.area&&e.area.id?`Edit ${G(i).area}: ${e.area.name}`:`Create new ${G(i).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:oe},{"tab-header":qe(()=>[Re(Pu,{modelValue:f.value,"onUpdate:modelValue":N[0]||(N[0]=te=>f.value=te),tabs:T.value},null,8,["modelValue","tabs"])]),footer:qe(()=>[l("div",S6,[l("div",x6,[I.value&&!$.value.isDefault?(v(),y("button",{key:0,type:"button",onClick:W,class:"btn btn-danger"}," Delete "+k(G(i).area),1)):D("",!0),!I.value&&!V.value?(v(),y("button",{key:1,type:"button",onClick:ie,class:"btn btn-secondary mobile-only"},k(ae.value),1)):D("",!0)]),l("button",{type:"button",onClick:R,class:"btn btn-primary"},k(I.value?"Save changes":`Create ${G(i).area}`),1)])]),default:qe(()=>[f.value==="details"?(v(),y("div",s4,[l("form",{onSubmit:ft(R,["prevent"])},[l("div",i4,[N[19]||(N[19]=l("label",null,"Name *",-1)),Ne(l("input",{"onUpdate:modelValue":N[1]||(N[1]=te=>$.value.name=te),type:"text",required:"",class:"form-input",disabled:$.value.isDefault,onInput:ue},null,40,a4),[[et,$.value.name]])]),l("div",r4,[N[20]||(N[20]=l("label",null,"Description",-1)),Ne(l("textarea",{"onUpdate:modelValue":N[2]||(N[2]=te=>$.value.description=te),class:"form-input",rows:"3",onInput:ue},null,544),[[et,$.value.description]])])],32)])):D("",!0),f.value==="boundary"?(v(),y("div",l4,[l("div",c4,[N[21]||(N[21]=l("div",{class:"instructions-card"},[l("p",null,[l("strong",null,"Draw a polygon on the map to define this area's boundary")]),l("p",null,' Click "Draw on Map" to activate drawing mode. Click on the map to add vertices, and double-click to complete the polygon. ')],-1)),l("div",u4,[l("button",{onClick:Me,class:"btn btn-primary btn-full"}," Draw on Map "),$.value.polygon&&$.value.polygon.length>0?(v(),y("button",{key:0,onClick:de,class:"btn btn-danger btn-full"}," Clear Boundary ")):D("",!0)])])])):D("",!0),f.value==="contacts"?(v(),y("div",d4,[l("h3",h4,k(G(o).area)+" contacts",1),l("div",f4,[l("button",{onClick:ke,class:"btn btn-primary btn-full"}," Add contact for this "+k(G(i).area),1)]),Te.value.length>0?(v(),y("div",p4,[l("h4",null,"Contacts visible in this "+k(G(i).area)+" ("+k(Te.value.length)+")",1),(v(!0),y(be,null,Oe(Te.value,te=>(v(),y("div",{key:te.contactId,class:"contact-item",onClick:ve=>F.$emit("edit-contact",te)},[l("div",m4,[l("strong",null,k(te.name),1),te.role?(v(),y("span",g4,k(H(te.role)),1)):D("",!0),te.phone||te.email?(v(),y("div",y4,[te.phone?(v(),y("span",_4,k(te.phone),1)):D("",!0),te.email?(v(),y("span",k4,k(te.email),1)):D("",!0)])):D("",!0)])],8,v4))),128))])):D("",!0)])):D("",!0),f.value==="checkpoints"&&I.value?(v(),y("div",b4,[l("h3",w4,k(a())+" in "+k(e.area?.name)+" ("+k(X.value.length)+")",1),X.value.length===0?(v(),y("div",C4,[l("p",null,"No "+k(c())+" in this "+k(G(i).area)+" yet.",1)])):(v(),y("div",L4,[(v(!0),y(be,null,Oe(ce.value,te=>(v(),y("div",{key:te.id,class:"checkpoint-card",onClick:ve=>F.$emit("select-checkpoint",te)},[l("div",x4,[l("span",{class:"checkpoint-icon",innerHTML:Y(te)},null,8,$4),l("div",I4,[l("h4",null,[He(k(te.name),1),te.description?(v(),y("span",T4," - "+k(te.description),1)):D("",!0)])]),l("div",M4,[l("div",{class:fe(["stat-badge",me(te)])},k(nt(te)),3)])]),l("div",A4,[l("div",E4,[l("span",P4,k(u(te))+":",1),l("span",D4,[He(k(Ae(te.id).length)+" / "+k(te.requiredMarshals)+" ",1),Ae(te.id).length<te.requiredMarshals?(v(),y("span",O4," ("+k(te.requiredMarshals-Ae(te.id).length)+" needed) ",1)):D("",!0)]),Ae(te.id).length>0?(v(),y("div",R4,[(v(!0),y(be,null,Oe(Ce(te.id),ve=>(v(),y("span",{key:ve.id,class:fe(["marshal-pill",{"checked-in":ve.isCheckedIn}])},k(ve.marshalName),3))),128))])):D("",!0)]),l("div",B4,[N[22]||(N[22]=l("span",{class:"detail-label"},"Checked in:",-1)),l("span",N4,k(pe(te))+" / "+k(Ae(te.id).length),1)]),b.value[te.id]?(v(),y("div",F4,[N[23]||(N[23]=l("span",{class:"detail-label"},"Tasks:",-1)),l("span",{class:fe(["detail-value",Le(te.id)])},k(Be(te.id)),3)])):x.value[te.id]?(v(),y("div",U4,[...N[24]||(N[24]=[l("span",{class:"detail-label"},"Tasks:",-1),l("span",{class:"detail-value loading-text"},"Loading...",-1)])])):D("",!0)])],8,S4))),128))]))])):D("",!0),f.value==="checkpoints"&&!I.value?(v(),y("div",z4,[l("p",null,k(a())+" will be automatically assigned based on boundaries after the "+k(G(i).area)+" is created.",1)])):D("",!0),f.value==="checklists"&&I.value?(v(),Xe(cv,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:_.value,"onUpdate:modelValue":N[3]||(N[3]=te=>_.value=te),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:j.value,onChange:Q},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):D("",!0),f.value==="checklists"&&!I.value?(v(),y("div",H4,[l("p",null,k(G(o).checklists)+" can be assigned after the "+k(G(i).area)+" is created.",1)])):D("",!0),f.value==="notes"&&I.value?(v(),Xe(zl,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):D("",!0),f.value==="notes"&&!I.value?(v(),y("div",V4,[l("p",null,"Notes can be viewed after the "+k(G(i).area)+" is created.",1)])):D("",!0),f.value==="appearance"?(v(),y("div",G4,[l("div",Z4,[l("button",{type:"button",class:fe(["accordion-header",{expanded:P.value.polygonColor}]),onClick:N[4]||(N[4]=te=>M("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:S.value},null,8,j4),l("span",q4,k(G(o).area)+" polygon colour",1),l("span",W4,k(P.value.polygonColor?"":""),1)],2),P.value.polygonColor?(v(),y("div",K4,[l("p",Y4," Choose a colour for this "+k(G(i).area)+"'s boundary on the map. ",1),l("div",J4,[(v(!0),y(be,null,Oe(G(Xn),te=>(v(),y("div",{key:te.hex,class:fe(["color-swatch",{selected:$.value.color===te.hex}]),style:it({backgroundColor:te.hex}),title:te.name,onClick:ve=>Pe(te.hex)},null,14,X4))),128))])])):D("",!0)]),l("div",Q4,[l("button",{type:"button",class:fe(["accordion-header",{expanded:P.value.iconStyle}]),onClick:N[5]||(N[5]=te=>M("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:A.value},null,8,e6),l("span",t6,k(a(!1))+" marker style",1),l("span",n6,k(P.value.iconStyle?"":""),1)],2),P.value.iconStyle?(v(),y("div",o6,[l("p",s6," Set a default marker style for all "+k(c())+" in this "+k(G(i).area)+". Individual "+k(c())+" can override this setting. ",1),Re(Eu,{"style-type":$.value.checkpointStyleType||"default","style-color":$.value.checkpointStyleColor||"","style-background-shape":$.value.checkpointStyleBackgroundShape||"","style-background-color":$.value.checkpointStyleBackgroundColor||"","style-border-color":$.value.checkpointStyleBorderColor||"","style-icon-color":$.value.checkpointStyleIconColor||"","style-size":$.value.checkpointStyleSize||"","style-map-rotation":$.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":N[6]||(N[6]=te=>Ee("checkpointStyleType",te)),"onUpdate:styleColor":N[7]||(N[7]=te=>Ee("checkpointStyleColor",te)),"onUpdate:styleBackgroundShape":N[8]||(N[8]=te=>Ee("checkpointStyleBackgroundShape",te)),"onUpdate:styleBackgroundColor":N[9]||(N[9]=te=>Ee("checkpointStyleBackgroundColor",te)),"onUpdate:styleBorderColor":N[10]||(N[10]=te=>Ee("checkpointStyleBorderColor",te)),"onUpdate:styleIconColor":N[11]||(N[11]=te=>Ee("checkpointStyleIconColor",te)),"onUpdate:styleSize":N[12]||(N[12]=te=>Ee("checkpointStyleSize",te)),"onUpdate:styleMapRotation":N[13]||(N[13]=te=>Ee("checkpointStyleMapRotation",te))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):D("",!0)]),l("div",i6,[l("button",{type:"button",class:fe(["accordion-header",{expanded:P.value.peopleTerm}]),onClick:N[14]||(N[14]=te=>M("peopleTerm"))},[N[25]||(N[25]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",a6,k(s())+" terminology",1),l("span",r6,k($.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",l6,k(P.value.peopleTerm?"":""),1)],2),P.value.peopleTerm?(v(),y("div",c6,[l("p",u6," Choose what "+k(s().toLowerCase())+" are called in this "+k(G(i).area)+". This will be inherited by "+k(c())+" unless they override it. ",1),l("div",d6,[N[26]||(N[26]=l("label",null,"What are people called?",-1)),Ne(l("select",{"onUpdate:modelValue":N[15]||(N[15]=te=>$.value.peopleTerm=te),class:"form-input",onChange:ue},[l("option",h6,"Use event default ("+k(e.eventPeopleTerm)+")",1),(v(!0),y(be,null,Oe(G(Cs).people,te=>(v(),y("option",{key:te,value:te},k(te),9,f6))),128))],544),[[pn,$.value.peopleTerm]])])])):D("",!0)]),l("div",p6,[l("button",{type:"button",class:fe(["accordion-header",{expanded:P.value.checkpointTerm}]),onClick:N[16]||(N[16]=te=>M("checkpointTerm"))},[N[27]||(N[27]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",v6,k(a(!1))+" terminology",1),l("span",m6,k($.value.checkpointTerm?G(eu)($.value.checkpointTerm,s()):`${e.eventCheckpointTerm} (event default)`),1),l("span",g6,k(P.value.checkpointTerm?"":""),1)],2),P.value.checkpointTerm?(v(),y("div",y6,[l("p",_6," Choose what "+k(c())+" are called in this "+k(G(i).area)+". ",1),l("div",k6,[l("label",null,"What are "+k(c())+" called?",1),Ne(l("select",{"onUpdate:modelValue":N[17]||(N[17]=te=>$.value.checkpointTerm=te),class:"form-input",onChange:ue},[l("option",b6,"Use event default ("+k(e.eventCheckpointTerm)+")",1),(v(!0),y(be,null,Oe(G(Cs).checkpoint,te=>(v(),y("option",{key:te,value:te},k(G(eu)(te,s())),9,w6))),128))],544),[[pn,$.value.checkpointTerm]])])])):D("",!0)])])):D("",!0),f.value==="incidents"?(v(),y("div",C6,[l("div",L6,[(v(!0),y(be,null,Oe(e.incidents,te=>(v(),Xe(ma,{key:te.incidentId,incident:te,onSelect:N[18]||(N[18]=ve=>F.$emit("select-incident",ve))},null,8,["incident"]))),128))])])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},I6=Ke($6,[["__scopeId","data-v-d7cf066b"]]),T6=["innerHTML"],M6={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(v(),Xe(Pt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:qe(()=>[l("button",{onClick:i,class:"btn btn-primary"},k(e.okText),1)]),default:qe(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,T6)]),_:1},8,["show","title"]))}},Hl=Ke(M6,[["__scopeId","data-v-a6e7148c"]]),A6={class:"tab-headers"},E6={class:"tab-content"},P6={class:"form-group"},D6=["placeholder"],O6={key:0,class:"checkbox-label-inline create-separate-items"},R6={class:"tab-content"},B6={class:"custom-footer"},N6={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=E(!1),a=E(""),c=E("details"),u=E({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),d=K(()=>!!o.checklistItem);je(()=>o.show,P=>{P&&(c.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?p(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?p(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?p(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const p=P=>{if(!P)return null;const M=new Date(P),S=M.getTimezoneOffset();return new Date(M.getTime()-S*60*1e3).toISOString().slice(0,16)},f=P=>P?new Date(P).toISOString():null,g=()=>{i("update:isDirty",!0)},_=()=>{i("close")},b=()=>{c.value="visibility"},x=P=>{a.value=P,s.value=!0},$=()=>{if(!u.value.text||!u.value.text.trim()){x("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){x("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(S=>!(S.itemType!==null&&(!S.ids||S.ids.length===0)))){x("Please configure at least one scope with valid selections");return}const M={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:f(u.value.visibleFrom),visibleUntil:f(u.value.visibleUntil),mustCompleteBy:f(u.value.mustCompleteBy)};d.value||(M.createSeparateItems=u.value.createSeparateItems),i("save",M)},B=()=>{i("delete",o.checklistItem.itemId)};return(P,M)=>(v(),y(be,null,[Re(Pt,{show:e.show,title:d.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:_},{footer:qe(()=>[l("div",B6,[d.value?(v(),y("button",{key:0,type:"button",onClick:B,class:"btn btn-danger"}," Delete ")):D("",!0),!d.value&&c.value==="details"?(v(),y("button",{key:1,type:"button",onClick:b,class:"btn btn-primary"}," Next ")):D("",!0),d.value||c.value==="visibility"?(v(),y("button",{key:2,type:"button",onClick:$,class:"btn btn-primary"},k(d.value?"Save changes":"Create"),1)):D("",!0)])]),default:qe(()=>[l("div",A6,[l("button",{type:"button",class:fe(["tab-header",{active:c.value==="details"}]),onClick:M[0]||(M[0]=S=>c.value="details")}," Details ",2),l("button",{type:"button",class:fe(["tab-header",{active:c.value==="visibility"}]),onClick:M[1]||(M[1]=S=>c.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:ft($,["prevent"]),class:"checklist-form"},[Ne(l("div",E6,[l("div",P6,[M[7]||(M[7]=l("label",{for:"text"},"Checklist text: *",-1)),Ne(l("textarea",{id:"text","onUpdate:modelValue":M[2]||(M[2]=S=>u.value.text=S),onInput:g,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,D6),[[et,u.value.text]]),d.value?D("",!0):(v(),y("label",O6,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":M[3]||(M[3]=S=>u.value.createSeparateItems=S),onChange:g},null,544),[[ws,u.value.createSeparateItems]]),M[6]||(M[6]=l("span",null,"Each line creates a new item",-1))]))])],512),[[ei,c.value==="details"]]),Ne(l("div",R6,[Re(Ul,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":M[4]||(M[4]=S=>u.value.scopeConfigurations=S),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,onUserChanged:g},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ei,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Re(Hl,{show:s.value,title:"Validation error",message:a.value,onClose:M[5]||(M[5]=S=>s.value=!1)},null,8,["show","message"])],64))}},F6=Ke(N6,[["__scopeId","data-v-1eae56af"]]),U6={class:"tab-headers"},z6={class:"tab-content"},H6={class:"form-group"},V6={class:"form-group"},G6={class:"form-row"},Z6={class:"form-group"},j6={class:"form-group"},q6={class:"form-row"},W6={class:"form-group"},K6={class:"form-group checkbox-group-inline"},Y6={class:"checkbox-label-inline"},J6={class:"tab-content"},X6={class:"custom-footer"},Q6={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=E(!1),a=E(""),c=E("details"),u=E({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),d=K(()=>!!o.note);je(()=>o.show,$=>{$&&(c.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const p=()=>{i("update:isDirty",!0)},f=()=>{i("close")},g=()=>{c.value="visibility"},_=$=>{a.value=$,s.value=!0},b=()=>{if(!u.value.title||!u.value.title.trim()){_("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){_("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(P=>!(P.itemType!==null&&(!P.ids||P.ids.length===0)))){_("Please configure at least one scope with valid selections");return}const B={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",B)},x=()=>{i("delete",o.note.noteId)};return($,B)=>(v(),y(be,null,[Re(Pt,{show:e.show,title:d.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{footer:qe(()=>[l("div",X6,[d.value?(v(),y("button",{key:0,type:"button",onClick:x,class:"btn btn-danger"}," Delete ")):D("",!0),!d.value&&c.value==="details"?(v(),y("button",{key:1,type:"button",onClick:g,class:"btn btn-primary"}," Next ")):D("",!0),d.value||c.value==="visibility"?(v(),y("button",{key:2,type:"button",onClick:b,class:"btn btn-primary"},k(d.value?"Save changes":"Create"),1)):D("",!0)])]),default:qe(()=>[l("div",U6,[l("button",{type:"button",class:fe(["tab-header",{active:c.value==="details"}]),onClick:B[0]||(B[0]=P=>c.value="details")}," Details ",2),l("button",{type:"button",class:fe(["tab-header",{active:c.value==="visibility"}]),onClick:B[1]||(B[1]=P=>c.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:ft(b,["prevent"]),class:"note-form"},[Ne(l("div",z6,[l("div",H6,[B[10]||(B[10]=l("label",{for:"title"},"Title: *",-1)),Ne(l("input",{id:"title","onUpdate:modelValue":B[2]||(B[2]=P=>u.value.title=P),type:"text",onInput:p,required:"",placeholder:"Enter note title..."},null,544),[[et,u.value.title]])]),l("div",V6,[B[11]||(B[11]=l("label",{for:"content"},"Content:",-1)),Ne(l("textarea",{id:"content","onUpdate:modelValue":B[3]||(B[3]=P=>u.value.content=P),onInput:p,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[et,u.value.content]])]),l("div",G6,[l("div",Z6,[B[13]||(B[13]=l("label",{for:"priority"},"Priority:",-1)),Ne(l("select",{id:"priority","onUpdate:modelValue":B[4]||(B[4]=P=>u.value.priority=P),onChange:p},[...B[12]||(B[12]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[pn,u.value.priority]])]),l("div",j6,[B[14]||(B[14]=l("label",{for:"category"},"Category:",-1)),Ne(l("input",{id:"category","onUpdate:modelValue":B[5]||(B[5]=P=>u.value.category=P),type:"text",onInput:p,placeholder:"e.g., Safety, Logistics..."},null,544),[[et,u.value.category]])])]),l("div",q6,[l("div",W6,[B[15]||(B[15]=l("label",{for:"displayOrder"},"Display order:",-1)),Ne(l("input",{id:"displayOrder","onUpdate:modelValue":B[6]||(B[6]=P=>u.value.displayOrder=P),type:"number",onInput:p,min:"0"},null,544),[[et,u.value.displayOrder,void 0,{number:!0}]]),B[16]||(B[16]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",K6,[l("label",Y6,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":B[7]||(B[7]=P=>u.value.isPinned=P),onChange:p},null,544),[[ws,u.value.isPinned]]),B[17]||(B[17]=l("span",null,"Pin to top",-1))]),B[18]||(B[18]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ei,c.value==="details"]]),Ne(l("div",J6,[Re(Ul,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":B[8]||(B[8]=P=>u.value.scopeConfigurations=P),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:p},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ei,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Re(Hl,{show:s.value,title:"Validation error",message:a.value,onClose:B[9]||(B[9]=P=>s.value=!1)},null,8,["show","message"])],64))}},e5=Ke(Q6,[["__scopeId","data-v-8357df84"]]),t5={class:"incident-detail-header"},n5={class:"header-title-row"},o5={class:"modal-title"},s5={class:"header-badges"},i5=["disabled"],a5={key:0,class:"status-dropdown-menu"},r5=["onClick","disabled"],l5={key:0,class:"incident-detail-content"},c5={class:"accordion-section"},u5={class:"accordion-arrow"},d5={key:0,class:"accordion-content"},h5={class:"description-text"},f5={class:"accordion-section"},p5={class:"accordion-arrow"},v5={key:0,class:"accordion-content"},m5={class:"info-grid"},g5={class:"info-item"},y5={class:"info-value"},_5={class:"info-item"},k5={class:"info-value"},b5={key:0,class:"info-item"},w5={class:"info-value"},C5={key:1,class:"info-item"},L5={class:"info-value"},S5={key:2,class:"info-item"},x5={class:"info-value"},$5={key:0,class:"incident-map-container"},I5={class:"accordion-section"},T5={class:"accordion-preview"},M5={class:"accordion-arrow"},A5={key:0,class:"accordion-content"},E5={class:"reporter-info"},P5={class:"reporter-name"},D5={key:0,class:"accordion-section"},O5={class:"accordion-preview"},R5={class:"accordion-arrow"},B5={key:0,class:"accordion-content"},N5={class:"marshals-list"},F5={class:"marshal-name"},U5={key:0,class:"checkin-badge success"},z5={key:1,class:"checkin-badge not-checked-in"},H5={class:"accordion-section"},V5={key:0,class:"accordion-preview"},G5={class:"accordion-arrow"},Z5={key:0,class:"accordion-content"},j5={key:0,class:"notes-timeline"},q5={class:"note-header"},W5={class:"note-author"},K5={class:"note-time"},Y5={key:0,class:"note-status-change"},J5={key:1,class:"note-text"},X5={key:1,class:"no-notes"},Q5={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const o=e,i=t,s=E(!1),a=E(!1),c=E(null),u=E({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});je(()=>o.show,V=>{V&&(u.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},a.value=!1)});const d=V=>{c.value&&!c.value.contains(V.target)&&(a.value=!1)};je(a,V=>{V?document.addEventListener("click",d):document.removeEventListener("click",d)});const p=()=>{a.value=!a.value},f=V=>{o.incident?.status!==V&&(a.value=!1,C(V))},g=V=>{const z=u.value[V];Object.keys(u.value).forEach(ae=>{u.value[ae]=!1}),z||(u.value[V]=!0)},_=K(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),b=K(()=>_.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),x=K(()=>_.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),$=K(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const V=o.incident.description||"";return V.length<=50?V:V.substring(0,47)+"..."}),B=K(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((z,ae)=>(z.name||"").localeCompare(ae.name||"",void 0,{sensitivity:"base"}))),P=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],M=V=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[V]||V,S=V=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[V]||V,A=V=>{if(!V)return"";let z=V.name||"";if(V.description){const ae=V.description,j=40,X=ae.length>j?ae.substring(0,j-3)+"...":ae;z+=` - ${X}`}return z},I=V=>V?new Date(V).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",T=V=>{if(!V)return"";const z=new Date(V),j=new Date-z,X=Math.floor(j/6e4),ce=Math.floor(j/36e5),Te=Math.floor(j/864e5);return X<1?"just now":X<60?`${X}m ago`:ce<24?`${ce}h ago`:Te<7?`${Te}d ago`:z.toLocaleDateString()},C=async V=>{if(o.incident?.status!==V){s.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:V})}finally{s.value=!1}}};return(V,z)=>(v(),Xe(Pt,{show:e.show,title:$.value,size:"large",onClose:z[7]||(z[7]=ae=>V.$emit("close"))},{header:qe(()=>[l("div",t5,[l("div",n5,[l("span",{class:fe(["severity-indicator",e.incident?.severity])},null,2),l("h2",o5,k($.value),1)]),l("div",s5,[l("span",{class:fe(["severity-badge",e.incident?.severity])},k(M(e.incident?.severity)),3),e.canManage?(v(),y("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:c},[l("button",{type:"button",class:fe(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:p,disabled:s.value},[He(k(S(e.incident?.status))+" ",1),z[8]||(z[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,i5),a.value?(v(),y("div",a5,[(v(),y(be,null,Oe(P,ae=>l("button",{key:ae.value,type:"button",class:fe(["status-dropdown-item",{active:e.incident?.status===ae.value}]),onClick:j=>f(ae.value),disabled:e.incident?.status===ae.value},[l("span",{class:fe(["status-dot",ae.value])},null,2),He(" "+k(ae.label),1)],10,r5)),64))])):D("",!0)],512)):(v(),y("span",{key:1,class:fe(["status-badge",e.incident?.status])},k(S(e.incident?.status)),3))])])]),footer:qe(()=>[l("button",{class:"btn btn-secondary",onClick:z[6]||(z[6]=ae=>V.$emit("close"))},"Close")]),default:qe(()=>[e.incident?(v(),y("div",l5,[l("div",c5,[l("button",{type:"button",class:fe(["accordion-header",{expanded:u.value.description}]),onClick:z[0]||(z[0]=ae=>g("description"))},[z[9]||(z[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",u5,k(u.value.description?"":""),1)],2),u.value.description?(v(),y("div",d5,[l("p",h5,k(e.incident.description),1)])):D("",!0)]),l("div",f5,[l("button",{type:"button",class:fe(["accordion-header",{expanded:u.value.timeLocation}]),onClick:z[1]||(z[1]=ae=>g("timeLocation"))},[z[10]||(z[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",p5,k(u.value.timeLocation?"":""),1)],2),u.value.timeLocation?(v(),y("div",v5,[l("div",m5,[l("div",g5,[z[11]||(z[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",y5,k(I(e.incident.incidentTime)),1)]),l("div",_5,[z[12]||(z[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",k5,k(I(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),y("div",b5,[z[13]||(z[13]=l("span",{class:"info-label"},"Checkpoint",-1)),l("span",w5,k(A(e.incident.context.checkpoint)),1)])):D("",!0),e.incident.area?(v(),y("div",C5,[z[14]||(z[14]=l("span",{class:"info-label"},"Area",-1)),l("span",L5,k(e.incident.area.areaName),1)])):D("",!0),_.value?(v(),y("div",S5,[z[15]||(z[15]=l("span",{class:"info-label"},"GPS location",-1)),l("span",x5,k(e.incident.latitude.toFixed(6))+", "+k(e.incident.longitude.toFixed(6)),1)])):D("",!0)]),_.value?(v(),y("div",$5,[Re(xs,{locations:e.checkpoints,route:e.route,center:b.value,zoom:15,"user-location":x.value,class:"incident-location-map"},null,8,["locations","route","center","user-location"])])):D("",!0)])):D("",!0)]),l("div",I5,[l("button",{type:"button",class:fe(["accordion-header",{expanded:u.value.reporter}]),onClick:z[2]||(z[2]=ae=>g("reporter"))},[z[16]||(z[16]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",T5,k(e.incident.reportedBy?.name||"Unknown"),1),l("span",M5,k(u.value.reporter?"":""),1)],2),u.value.reporter?(v(),y("div",A5,[l("div",E5,[l("span",P5,k(e.incident.reportedBy?.name||"Unknown"),1)])])):D("",!0)]),B.value.length?(v(),y("div",D5,[l("button",{type:"button",class:fe(["accordion-header",{expanded:u.value.marshals}]),onClick:z[3]||(z[3]=ae=>g("marshals"))},[z[17]||(z[17]=l("span",{class:"accordion-title"},"Marshals at checkpoint",-1)),l("span",O5,k(B.value.length),1),l("span",R5,k(u.value.marshals?"":""),1)],2),u.value.marshals?(v(),y("div",B5,[l("div",N5,[(v(!0),y(be,null,Oe(B.value,ae=>(v(),y("div",{key:ae.marshalId,class:fe(["marshal-item",{"checked-in":ae.wasCheckedIn}])},[l("span",F5,k(ae.name),1),ae.wasCheckedIn?(v(),y("span",U5," Checked in "+k(T(ae.checkInTime)),1)):(v(),y("span",z5," Not checked in "))],2))),128))])])):D("",!0)])):D("",!0),l("div",H5,[l("button",{type:"button",class:fe(["accordion-header",{expanded:u.value.notes}]),onClick:z[4]||(z[4]=ae=>g("notes"))},[z[18]||(z[18]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),y("span",V5,k(e.incident.updates.length),1)):D("",!0),l("span",G5,k(u.value.notes?"":""),1)],2),u.value.notes?(v(),y("div",Z5,[e.incident.updates?.length?(v(),y("div",j5,[(v(!0),y(be,null,Oe(e.incident.updates,(ae,j)=>(v(),y("div",{key:j,class:"note-item"},[l("div",q5,[l("span",W5,k(ae.authorName||"System"),1),l("span",K5,k(T(ae.timestamp)),1)]),ae.statusChange?(v(),y("div",Y5,[z[19]||(z[19]=He(" Status changed to ",-1)),l("span",{class:fe(["status-badge",ae.statusChange])},k(S(ae.statusChange)),3)])):ae.note?(v(),y("p",J5,k(ae.note),1)):D("",!0)]))),128))])):(v(),y("div",X5," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:z[5]||(z[5]=ae=>V.$emit("open-add-note"))}," Add update ")])):D("",!0)])])):D("",!0)]),_:1},8,["show","title"]))}},Du=Ke(Q5,[["__scopeId","data-v-dbaeb21d"]]),eD={class:"form-group"},tD={class:"form-group"},nD={class:"form-row"},oD={class:"form-group form-group-half"},sD=["value"],iD={class:"form-group form-group-half"},aD={key:0,class:"form-group"},rD=["value"],lD={key:1,class:"form-group"},cD={class:"checkpoint-toggle"},uD={class:"checkbox-label"},dD={class:"checkpoint-name"},hD={key:0,class:"checkpoint-description"},fD={class:"form-group"},pD={class:"location-options"},vD={class:"location-buttons"},mD={key:0,class:"location-status"},gD={key:0,class:"location-getting"},yD={key:1,class:"location-display"},_D={key:0,class:"location-accuracy"},kD={key:2,class:"location-error"},bD={key:1,class:"map-picker-container"},wD={key:0,class:"map-picker-hint"},CD={key:2,class:"location-display"},LD={key:2,class:"error-message"},SD={class:"modal-actions"},xD=["disabled"],$D={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,s=E({title:"",description:"",severity:"medium",incidentTime:""}),a=E(""),c=E(!0),u=E("none"),d=E(!1),p=E(null),f=E(null),g=E(null),_=E(!1),b=E(!1),x=E(null),$=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],B=()=>{const j=new Date,X=j.getFullYear(),ce=String(j.getMonth()+1).padStart(2,"0"),Te=String(j.getDate()).padStart(2,"0"),Ae=String(j.getHours()).padStart(2,"0"),Ce=String(j.getMinutes()).padStart(2,"0");return`${X}-${ce}-${Te}T${Ae}:${Ce}`},P=j=>j?new Date(j).toISOString():null,M=K(()=>o.checkpoints||[]),S=K(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(a.value){const j=M.value.find(X=>X.id===a.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(o.initialLocation?.latitude!=null)return{lat:o.initialLocation.latitude,lng:o.initialLocation.longitude};if(o.checkpoint?.latitude!=null)return{lat:o.checkpoint.latitude,lng:o.checkpoint.longitude};if(M.value.length>0){const j=M.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(o.route?.length>0){const j=o.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),A=K(()=>s.value.description.trim()!==""),I=K(()=>s.value.description.trim()!=="");je(()=>o.show,j=>{j&&(s.value={title:"",description:"",severity:"medium",incidentTime:B()},a.value="",c.value=!0,b.value=!1,x.value=null,g.value=null,p.value=null,f.value=null,o.initialLocation&&o.initialLocation.latitude!=null?(p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy,u.value="gps",d.value=!1):(u.value="none",d.value=!1),o.checkpoint&&(a.value=o.checkpoint.locationId||o.checkpoint.id||""))});const T=j=>{g.value=null,j==="map"?u.value==="map"?d.value=!d.value:(u.value="map",d.value=!0,f.value=null):j==="gps"?(u.value="gps",d.value=!1,V()):(u.value="none",d.value=!1,p.value=null,f.value=null)},C=j=>{p.value={latitude:j.lat,longitude:j.lng},f.value=null,d.value=!1},V=()=>{if(o.initialLocation&&o.initialLocation.latitude!=null){p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy;return}if(!navigator.geolocation){g.value="GPS is not available on this device.";return}_.value=!0,navigator.geolocation.getCurrentPosition(j=>{p.value={latitude:j.coords.latitude,longitude:j.coords.longitude},f.value=j.coords.accuracy,_.value=!1},j=>{g.value="Unable to get your location.",_.value=!1},{enableHighAccuracy:!0,timeout:1e4})},z=async()=>{if(!(!I.value||b.value)){b.value=!0,x.value=null;try{const j=(u.value==="gps"||u.value==="map")&&p.value;let X=null,ce=!1;M.value.length>0?a.value?X=a.value:ce=!0:o.checkpoint&&(c.value?X=o.checkpoint.locationId||o.checkpoint.id||null:ce=!0);const Te={title:s.value.title.trim()||null,description:s.value.description.trim(),severity:s.value.severity,incidentTime:P(s.value.incidentTime),latitude:j?p.value.latitude:null,longitude:j?p.value.longitude:null,checkpointId:X,skipCheckpointAutoAssign:ce};i("submit",Te)}catch(j){x.value=j.message||"Failed to report incident. Please try again.",b.value=!1}}},ae=()=>{i("close")};return(j,X)=>(v(),Xe(Pt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":A.value,onClose:ae},{footer:qe(()=>[l("div",SD,[l("button",{type:"button",class:"btn btn-secondary",onClick:ae}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:z,disabled:!I.value||b.value},k(b.value?"Reporting...":"Report Incident"),9,xD)])]),default:qe(()=>[l("form",{onSubmit:ft(z,["prevent"]),class:"incident-form"},[l("div",eD,[X[10]||(X[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),Ne(l("input",{id:"title","onUpdate:modelValue":X[0]||(X[0]=ce=>s.value.title=ce),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[et,s.value.title]])]),l("div",tD,[X[11]||(X[11]=l("label",{for:"description",class:"form-label"},[He("Description "),l("span",{class:"required"},"*")],-1)),Ne(l("textarea",{id:"description","onUpdate:modelValue":X[1]||(X[1]=ce=>s.value.description=ce),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[et,s.value.description]])]),l("div",nD,[l("div",oD,[X[12]||(X[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),Ne(l("select",{id:"severity","onUpdate:modelValue":X[2]||(X[2]=ce=>s.value.severity=ce),class:"form-input form-select"},[(v(),y(be,null,Oe($,ce=>l("option",{key:ce.value,value:ce.value},k(ce.label),9,sD)),64))],512),[[pn,s.value.severity]])]),l("div",iD,[X[13]||(X[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ne(l("input",{id:"incidentTime","onUpdate:modelValue":X[3]||(X[3]=ce=>s.value.incidentTime=ce),type:"datetime-local",class:"form-input"},null,512),[[et,s.value.incidentTime]])])]),M.value.length>0?(v(),y("div",aD,[X[15]||(X[15]=l("label",{for:"checkpoint",class:"form-label"},"Checkpoint",-1)),Ne(l("select",{id:"checkpoint","onUpdate:modelValue":X[4]||(X[4]=ce=>a.value=ce),class:"form-input form-select"},[X[14]||(X[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),y(be,null,Oe(M.value,ce=>(v(),y("option",{key:ce.id,value:ce.id},k(ce.name)+k(ce.description?` - ${ce.description}`:""),9,rD))),128))],512),[[pn,a.value]])])):e.checkpoint?(v(),y("div",lD,[X[16]||(X[16]=l("label",{class:"form-label"},"Checkpoint",-1)),l("div",cD,[l("label",uD,[Ne(l("input",{type:"checkbox","onUpdate:modelValue":X[5]||(X[5]=ce=>c.value=ce)},null,512),[[ws,c.value]]),l("span",dD,k(e.checkpoint.name),1),e.checkpoint.description?(v(),y("span",hD," - "+k(e.checkpoint.description),1)):D("",!0)])])])):D("",!0),l("div",fD,[X[17]||(X[17]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",pD,[l("div",vD,[l("button",{type:"button",class:fe(["location-btn",{active:u.value==="gps"}]),onClick:X[6]||(X[6]=ce=>T("gps"))}," GPS ",2),l("button",{type:"button",class:fe(["location-btn",{active:u.value==="map"}]),onClick:X[7]||(X[7]=ce=>T("map"))}," Pick on map ",2),l("button",{type:"button",class:fe(["location-btn",{active:u.value==="none"}]),onClick:X[8]||(X[8]=ce=>T("none"))}," None ",2)]),u.value==="gps"?(v(),y("div",mD,[_.value?(v(),y("div",gD," Getting location... ")):p.value&&p.value.latitude!=null?(v(),y("div",yD,[l("span",null,k(p.value.latitude.toFixed(5))+", "+k(p.value.longitude.toFixed(5)),1),f.value?(v(),y("span",_D,"("+k(Math.round(f.value))+"m)",1)):D("",!0)])):g.value?(v(),y("div",kD,k(g.value),1)):D("",!0)])):D("",!0),u.value==="map"?(v(),y("div",bD,[d.value?(v(),y("div",wD,"Tap to select location")):D("",!0),d.value?(v(),Xe(xs,{key:1,locations:M.value,route:e.route,center:S.value,zoom:14,clickable:!0,"user-location":e.initialLocation,"highlight-location-id":a.value,onMapClick:C,class:"location-picker-map"},null,8,["locations","route","center","user-location","highlight-location-id"])):D("",!0),p.value&&p.value.latitude!=null?(v(),y("div",CD,[l("span",null,k(p.value.latitude.toFixed(5))+", "+k(p.value.longitude.toFixed(5)),1),d.value?D("",!0):(v(),y("button",{key:0,type:"button",class:"location-edit-btn",onClick:X[9]||(X[9]=ce=>d.value=!0)},"Edit"))])):D("",!0)])):D("",!0)])]),x.value?(v(),y("div",LD,k(x.value),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},uv=Ke($D,[["__scopeId","data-v-90d4434a"]]),ID={class:"tab-headers"},TD={class:"tab-content"},MD={class:"form-group"},AD={for:"marshalId"},ED=["value"],PD={class:"help-text"},DD={class:"form-group"},OD=["disabled"],RD={class:"form-group"},BD={class:"role-input-group"},ND={key:0,label:"Built-in Roles"},FD=["value"],UD={key:1,label:"Custom Roles"},zD=["value"],HD={class:"form-row"},VD={class:"form-group"},GD={class:"form-group"},ZD={class:"form-group"},jD={class:"tab-content"},qD={class:"custom-footer"},WD={class:"footer-left"},KD={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=E(!1),c=E(""),u=E("details"),d=E(!1),p=E({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=K(()=>!!i.contact),g=K(()=>!!p.value.marshalId),_=K(()=>[...i.marshals].sort((I,T)=>ss(I.name,T.name)));je(()=>i.show,I=>{if(I){if(u.value=i.initialTab,i.contact){const T=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];d.value=i.contact.role&&!T.includes(i.contact.role),p.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;const T=i.preselectedArea?[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];p.value={role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:T}}s("update:isDirty",!1)}});const b=I=>I?I==="AreaLead"?`${o.value.area} Lead`:I.replace(/([A-Z])/g," $1").replace(/^./,T=>T.toUpperCase()).trim():"",x=()=>{s("update:isDirty",!0)},$=()=>{if(p.value.marshalId){const I=i.marshals.find(T=>T.id===p.value.marshalId);I&&(p.value.name=I.name,!p.value.phone&&I.phoneNumber&&(p.value.phone=I.phoneNumber),!p.value.email&&I.email&&(p.value.email=I.email))}x()},B=()=>{s("close")},P=()=>{if(!p.value.role||!p.value.role.trim()){M("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){M("Please enter a contact name");return}u.value="visibility"},M=I=>{c.value=I,a.value=!0},S=()=>{if(!p.value.role||!p.value.role.trim()){M("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){M("Please enter a contact name");return}if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){M("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some(C=>!(C.itemType!==null&&(!C.ids||C.ids.length===0)))){M("Please configure at least one scope with valid selections");return}const T={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,scopeConfigurations:p.value.scopeConfigurations};s("save",T)},A=()=>{s("delete",i.contact.contactId)};return(I,T)=>(v(),y(be,null,[Re(Pt,{show:e.show,title:f.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:B},{footer:qe(()=>[l("div",qD,[l("div",WD,[f.value?(v(),y("button",{key:0,type:"button",onClick:A,class:"btn btn-danger"}," Delete ")):D("",!0),!f.value&&u.value==="details"?(v(),y("button",{key:1,type:"button",onClick:P,class:"btn btn-secondary mobile-only"}," Visibility... ")):D("",!0)]),l("button",{type:"button",onClick:S,class:"btn btn-primary"},k(f.value?"Save changes":"Create contact"),1)])]),default:qe(()=>[l("div",ID,[l("button",{type:"button",class:fe(["tab-header",{active:u.value==="details"}]),onClick:T[0]||(T[0]=C=>u.value="details")}," Details ",2),l("button",{type:"button",class:fe(["tab-header",{active:u.value==="visibility"}]),onClick:T[1]||(T[1]=C=>u.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:ft(S,["prevent"]),class:"contact-form"},[Ne(l("div",TD,[l("div",MD,[l("label",AD,"Link to "+k(G(o).person.toLowerCase())+":",1),Ne(l("select",{id:"marshalId","onUpdate:modelValue":T[2]||(T[2]=C=>p.value.marshalId=C),onChange:$},[T[12]||(T[12]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),y(be,null,Oe(_.value,C=>(v(),y("option",{key:C.id,value:C.id},k(C.name),9,ED))),128))],544),[[pn,p.value.marshalId]]),l("span",PD,"Optionally link to an existing "+k(G(o).person.toLowerCase())+" in the system",1)]),l("div",DD,[T[13]||(T[13]=l("label",{for:"name"},"Name: *",-1)),Ne(l("input",{id:"name","onUpdate:modelValue":T[3]||(T[3]=C=>p.value.name=C),type:"text",onInput:x,disabled:g.value,class:fe({"input-disabled":g.value}),placeholder:"Contact name..."},null,42,OD),[[et,p.value.name]])]),l("div",RD,[T[15]||(T[15]=l("label",{for:"role"},"Role: *",-1)),l("div",BD,[d.value?Ne((v(),y("input",{key:1,id:"customRole","onUpdate:modelValue":T[5]||(T[5]=C=>p.value.role=C),type:"text",onInput:x,placeholder:"Enter custom role name..."},null,544)),[[et,p.value.role]]):Ne((v(),y("select",{key:0,id:"role","onUpdate:modelValue":T[4]||(T[4]=C=>p.value.role=C),onChange:x},[T[14]||(T[14]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),y("optgroup",ND,[(v(!0),y(be,null,Oe(e.availableRoles.builtInRoles,C=>(v(),y("option",{key:C,value:C},k(b(C)),9,FD))),128))])):D("",!0),e.availableRoles.customRoles?.length>0?(v(),y("optgroup",UD,[(v(!0),y(be,null,Oe(e.availableRoles.customRoles,C=>(v(),y("option",{key:C,value:C},k(b(C)),9,zD))),128))])):D("",!0)],544)),[[pn,p.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:T[6]||(T[6]=C=>d.value=!d.value)},k(d.value?"Use existing":"Custom"),1)])]),l("div",HD,[l("div",VD,[T[16]||(T[16]=l("label",{for:"phone"},"Phone:",-1)),Ne(l("input",{id:"phone","onUpdate:modelValue":T[7]||(T[7]=C=>p.value.phone=C),type:"tel",onInput:x,placeholder:"Phone number..."},null,544),[[et,p.value.phone]])]),l("div",GD,[T[17]||(T[17]=l("label",{for:"email"},"Email:",-1)),Ne(l("input",{id:"email","onUpdate:modelValue":T[8]||(T[8]=C=>p.value.email=C),type:"email",onInput:x,placeholder:"Email address..."},null,544),[[et,p.value.email]])])]),l("div",ZD,[T[18]||(T[18]=l("label",{for:"notes"},"Notes / Instructions:",-1)),Ne(l("textarea",{id:"notes","onUpdate:modelValue":T[9]||(T[9]=C=>p.value.notes=C),onInput:x,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[et,p.value.notes]])])],512),[[ei,u.value==="details"]]),Ne(l("div",jD,[Re(Ul,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":T[10]||(T[10]=C=>p.value.scopeConfigurations=C),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:x},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ei,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Re(Hl,{show:a.value,title:"Validation error",message:c.value,onClose:T[11]||(T[11]=C=>a.value=!1)},null,8,["show","message"])],64))}},YD=Ke(KD,[["__scopeId","data-v-d6efd77c"]]),JD={key:0,class:"fullscreen-map-overlay"},XD={class:"fullscreen-map-header"},QD={class:"context-info"},eO={key:0},tO={class:"action-buttons"},nO=["disabled"],oO={class:"fullscreen-map-container"},sO={key:0,class:"drawing-controls"},iO={class:"point-count"},aO={class:"undo-redo-buttons"},rO=["disabled"],lO=["disabled"],cO=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=E(null),a=E(0),c=E(!1),u=E(!1),d=()=>{i("done")},p=()=>{i("cancel")},f=$=>{a.value=$?.length||0,g(),i("polygon-drawing",$)},g=()=>{s.value&&(c.value=s.value.canUndo(),u.value=s.value.canRedo())},_=()=>{s.value&&(s.value.undoPolygonPoint(),g())},b=()=>{s.value&&(s.value.redoPolygonPoint(),g())};je(()=>o.show,$=>{$||(a.value=0,c.value=!1,u.value=!1)});const x=$=>{$.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&(($.ctrlKey||$.metaKey)&&$.key==="z"&&!$.shiftKey?($.preventDefault(),_()):($.ctrlKey||$.metaKey)&&($.key==="y"||$.key==="z"&&$.shiftKey)&&($.preventDefault(),b()))};return Yt(()=>{document.addEventListener("keydown",x)}),vo(()=>{document.removeEventListener("keydown",x)}),($,B)=>(v(),Xe(Lf,{to:"body"},[e.show?(v(),y("div",JD,[l("div",XD,[l("div",QD,[l("h3",null,k(e.contextTitle),1),e.contextDescription?(v(),y("p",eO,k(e.contextDescription),1)):D("",!0)]),l("div",tO,[e.mode==="view"?(v(),y("button",{key:0,onClick:p,class:"btn btn-done"}," Close ")):(v(),y(be,{key:1},[l("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,nO)],64))])]),l("div",oO,[Re(xs,ep({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},$.$attrs,{onMapClick:B[0]||(B[0]=P=>$.$emit("map-click",P)),onPolygonComplete:B[1]||(B[1]=P=>$.$emit("polygon-complete",P)),onPolygonDrawing:f,onLocationClick:B[2]||(B[2]=P=>$.$emit("location-click",P)),onAreaClick:B[3]||(B[3]=P=>$.$emit("area-click",P))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(v(),y("div",sO,[l("div",iO,k(a.value)+" point"+k(a.value!==1?"s":""),1),l("div",aO,[l("button",{onClick:_,class:"btn-drawing undo-btn",disabled:!c.value,title:"Undo last point"},"  Undo ",8,rO),l("button",{onClick:b,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,lO)])])):D("",!0)])])):D("",!0)]))}}),uO=Ke(cO,[["__scopeId","data-v-9ce62b55"]]),dO={class:"form-group"},hO={class:"form-group"},fO={class:"form-group"},pO={key:0,class:"form-error"},vO={class:"form-row"},mO={class:"form-group",style:{flex:"1"}},gO={class:"form-group",style:{flex:"1"}},yO={class:"form-group",style:{flex:"0 0 auto"}},_O={class:"form-group"},kO={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=E({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});je(()=>i.location,p=>{p&&(a.value={...p})},{immediate:!0,deep:!0});const c=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!fl(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},d=()=>{s("close")};return(p,f)=>(v(),Xe(Pt,{show:e.show,title:`Add ${G(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:qe(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+k(G(o).checkpoint),1)]),default:qe(()=>[l("form",{onSubmit:ft(u,["prevent"])},[l("div",dO,[f[7]||(f[7]=l("label",null,"Name",-1)),Ne(l("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>a.value.name=g),type:"text",required:"",class:"form-input",onInput:c},null,544),[[et,a.value.name]])]),l("div",hO,[f[8]||(f[8]=l("label",null,"Description",-1)),Ne(l("input",{"onUpdate:modelValue":f[1]||(f[1]=g=>a.value.description=g),type:"text",class:"form-input",onInput:c},null,544),[[et,a.value.description]])]),l("div",fO,[f[9]||(f[9]=l("label",null,"What3Words (optional)",-1)),Ne(l("input",{"onUpdate:modelValue":f[2]||(f[2]=g=>a.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:c},null,544),[[et,a.value.what3Words]]),a.value.what3Words&&!G(fl)(a.value.what3Words)?(v(),y("small",pO," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),l("div",vO,[l("div",mO,[f[10]||(f[10]=l("label",null,"Longitude",-1)),Ne(l("input",{"onUpdate:modelValue":f[3]||(f[3]=g=>a.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[et,a.value.longitude,void 0,{number:!0}]])]),l("div",gO,[f[11]||(f[11]=l("label",null,"Latitude",-1)),Ne(l("input",{"onUpdate:modelValue":f[4]||(f[4]=g=>a.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[et,a.value.latitude,void 0,{number:!0}]])]),l("div",yO,[f[12]||(f[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=g=>p.$emit("set-on-map"))},"  ")])]),l("div",_O,[l("label",null,"Required "+k(G(o).people),1),Ne(l("input",{"onUpdate:modelValue":f[6]||(f[6]=g=>a.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:c},null,544),[[et,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},bO=Ke(kO,[["__scopeId","data-v-fb51fed0"]]),wO={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},CO=["id"],LO=["filter"],SO={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){Ng(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=K(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,i)=>(v(),y("svg",wO,[l("defs",null,[l("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...i[0]||(i[0]=[l("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,CO)]),l("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,LO),i[2]||(i[2]=l("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),l("g",{class:fe({"marshal-figure":e.animate})},[...i[1]||(i[1]=[l("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),l("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},xO=Ke(SO,[["__scopeId","data-v-3e647831"]]),$O={class:"header"},IO={class:"header-left"},TO={key:0},MO={class:"event-date"},AO={class:"header-actions"},EO={class:"container"},PO={class:"tabs-nav"},DO={class:"tab-content-wrapper"},OO={class:"add-note-form"},RO={class:"modal-footer-actions"},BO=["disabled"],NO=6e4,FO={__name:"AdminEventManage",setup(e){const t=Dl(),o=ha(),i=Yp(),s=K(()=>t.params.eventId),{activeTab:a,switchTab:c}=Jp("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:p,confirmModalIsDanger:f,confirmModalConfirmText:g,showConfirm:_,handleConfirmModalConfirm:b,handleConfirmModalCancel:x}=m0(),{tabLabels:$,terms:B,termsLower:P}=St(),M=g0(),S=_0(s),A=y0(s),{colorScheme:I}=Au(),T=K(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:$.value.course,icon:"course"},{value:"areas",label:$.value.areas,icon:"area"},{value:"checkpoints",label:$.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:$.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:$.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),C=E(null),V=E([]),z=E([]),ae=E({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),j=E(null),X=E(!1),ce=E(null),Te=E(!1),Ae=E(!1),Ce=E(null),pe=E(""),me=A.eventAdmins,nt=A.showAddAdmin,Le=S.showUploadRoute,Be=S.uploading,Ge=S.uploadError,ue=S.showImportLocations,Pe=S.showImportMarshals,Ee=S.importing,Me=S.importingMarshals,de=S.importError,ke=S.importResult,H=S.importMarshalsResult,Q=E(!1),ie=E(!1),R=E({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),W=E(!1),oe=E(!1),Y=E({marshalName:"",locations:[],marshal:null}),F=E(null),N=E([]),te=E(!1),ve=E(null),xe=E(null),we=E({}),Ve=E({id:"",name:"",email:"",phoneNumber:"",notes:""}),$e=E(!1),Ze=E([]),We=E([]),re=E([]),se=E([]),J=E(!1),Ue=E(""),Qe=E(""),ot=E({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),vt=E(!1),Tt=E(!1),Jt=E(""),gt=E(""),qt=E(0),Dt=E({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),_t=E([]),wt=E(null),xt=E(!1),mo=E("details"),so=E(null),Ot=E(null),In=M.isAddingMultipleCheckpoints,Ni=M.multiCheckpointCounter,sn=M.isFullscreenMapActive,Bt=M.fullscreenMode,Ro=M.fullscreenContext,Wt=M.tempLocationCoords,go=M.tempCheckpoints,oi=M.savedMapCenter,Bo=M.savedMapZoom,No=M.isDrawingAreaBoundary,Zt=E(null),Je=E([]),Tn=E(null),io=E(!1),Ps=E("details"),Hn=E(null),Mn=E([]),An=E(null),Vn=E(!1),Ds=E("details"),Xt=E([]),si=E(!1),nn=E(null),yo=E(!1),Fo=E(!1),ii=E(!1),mn=E(""),is=E(!1),Uo=E([]),zo=E({builtInRoles:[],customRoles:[]}),En=E(null),Pn=E(!1),_o=E("details"),Gn=E(null),Os=E(null),ai=K(()=>Os.value?.marshalId!=null),as=()=>{o.push(`/event/${t.params.eventId}`)},mt=K(()=>`${window.location.origin}/#/event/${t.params.eventId}`),$t=K(()=>{const U=[];return z.value.forEach(le=>{le.assignments&&U.push(...le.assignments)}),U}),Rs=K(()=>{if(!ve.value)return z.value;const U=ve.value.assignedLocationIds||[],le=re.value.map(Ie=>Ie.locationId),ge=se.value;return z.value.filter(Ie=>!U.includes(Ie.id)&&!le.includes(Ie.id)||ge.includes(Ie.id))}),Dn=K(()=>{let U=N.value;if(j.value){const le=j.value.assignments.map(Ie=>Ie.marshalName),ge=Ze.value.map(Ie=>Ie.marshalName);U=N.value.filter(Ie=>!le.includes(Ie.name)&&!ge.includes(Ie.name))}return U.slice().sort((le,ge)=>le.name.localeCompare(ge.name))}),Ho=K(()=>Bt.value==="draw-area"&&wt.value?.polygon?.length>0||M.canCompleteFullscreen.value),ri=K(()=>{const U=[...z.value];return Bt.value==="place-checkpoint"&&Wt.value&&U.push({id:"temp-single",name:Dt.value.name||"New Checkpoint",latitude:Wt.value.lat,longitude:Wt.value.lng,requiredMarshals:Dt.value.requiredMarshals||1,assignments:[],isTemporary:!0}),Bt.value==="move-checkpoint"&&Wt.value&&j.value&&U.push({id:"temp-move",name:j.value.name+" (new position)",latitude:Wt.value.lat,longitude:Wt.value.lng,requiredMarshals:j.value.requiredMarshals,assignments:[],isTemporary:!0}),Bt.value==="add-multiple"&&U.push(...go.value),U}),ct=K(()=>{const U=[..._t.value];if(Bt.value==="draw-area"&&wt.value?.polygon?.length>0){const le=U.findIndex(ge=>ge.id===wt.value.id);le>=0?U[le]={...wt.value}:U.push({...wt.value,id:wt.value.id||"temp-area"})}return U}),Et=K(()=>{if(!ve.value||!Xt.value.length)return[];const U=ve.value.id,le=ve.value.assignedLocationIds||[];return Xt.value.filter(ge=>{if(ge.reportedBy?.marshalId===U)return!0;const Ie=ge.context?.checkpoint?.checkpointId;return!!(Ie&&le.includes(Ie))}).sort((ge,Ie)=>new Date(Ie.incidentTime||Ie.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),li=K(()=>{if(!j.value||!Xt.value.length)return[];const U=j.value.id;return Xt.value.filter(le=>le.context?.checkpoint?.checkpointId===U).sort((le,ge)=>new Date(ge.incidentTime||ge.createdAt)-new Date(le.incidentTime||le.createdAt))}),Vo=K(()=>{if(!wt.value||!Xt.value.length)return[];const U=wt.value.id,le=z.value.filter(ge=>ge.areaIds&&ge.areaIds.includes(U)).map(ge=>ge.id);return Xt.value.filter(ge=>{const Ie=ge.context?.checkpoint?.checkpointId;return Ie&&le.includes(Ie)}).sort((ge,Ie)=>new Date(Ie.incidentTime||Ie.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),an=U=>{nn.value=U,yo.value=!0},ci=U=>{nn.value=U,yo.value=!0},ao=U=>{nn.value=U,yo.value=!0},Nt=()=>{o.push("/admin/dashboard")},dt=(U=!0)=>{$e.value=U},gn=()=>{vt.value=!0},Zn=async U=>{try{U&&(ot.value={...U});const le=rr(C.value.eventDate),ge=ot.value.eventDate;if(le!==ge){const Ie=V.value.filter(yt=>yt.startTime||yt.endTime);if(Ie.length>0){Jt.value=le,gt.value=ge,qt.value=Ie.length,Tt.value=!0;return}}await ro(!1,null)}catch(le){console.error("Failed to update event:",le),alert("Failed to update event. Please try again.")}},ro=async(U,le)=>{try{if(await i.updateEvent(t.params.eventId,{...ot.value,defaultCheckpointStyleMapRotation:ot.value.defaultCheckpointStyleMapRotation!=null?String(ot.value.defaultCheckpointStyleMapRotation):null}),U&&le!==null){const ge=Math.floor(Math.abs(le)/1e3),Ie=le<0,yt=Math.floor(ge/3600),bn=Math.floor(ge%3600/60),Lo=ge%60,Ko=`${Ie?"-":""}${yt.toString().padStart(2,"0")}:${bn.toString().padStart(2,"0")}:${Lo.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,Ko)}await rn(),vt.value=!1}catch(ge){console.error("Failed to update event:",ge),alert("Failed to update event. Please try again.")}},Bs=async({shouldShift:U,timeDelta:le})=>{Tt.value=!1,await ro(U,le)},rs=()=>{Tt.value=!1,rn()},rn=async()=>{try{await i.fetchEvent(t.params.eventId),C.value=i.currentEvent,C.value&&(ot.value={name:C.value.name||"",description:C.value.description||"",eventDate:rr(C.value.eventDate),timeZoneId:C.value.timeZoneId||"UTC",peopleTerm:C.value.peopleTerm||"Marshals",checkpointTerm:C.value.checkpointTerm||"Checkpoints",areaTerm:C.value.areaTerm||"Areas",checklistTerm:C.value.checklistTerm||"Checklists",courseTerm:C.value.courseTerm||"Course",defaultCheckpointStyleType:C.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:C.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:C.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:C.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:C.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:C.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:C.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:C.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:C.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:C.value.brandingHeaderGradientEnd||"",brandingLogoUrl:C.value.brandingLogoUrl||"",brandingLogoPosition:C.value.brandingLogoPosition||"",brandingAccentColor:C.value.brandingAccentColor||"",brandingPageGradientStart:C.value.brandingPageGradientStart||"",brandingPageGradientEnd:C.value.brandingPageGradientEnd||""},vt.value=!1,tu(C.value));const U=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),Ui(),jn(),qn(),Go(),Wn(),Kn(),ls()]);V.value=i.locations,z.value=i.eventStatus.locations,U.forEach((le,ge)=>{le.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][ge]}:`,le.reason)})}catch(U){console.error("Failed to load event data:",U)}},jn=async()=>{try{const U=await ns.getByEvent(t.params.eventId);N.value=U.data,ae.value.marshals=Date.now()}catch(U){console.error("Failed to load marshals:",U)}},qn=async()=>{try{const U=await Ks.getByEvent(t.params.eventId);_t.value=U.data,ae.value.areas=Date.now()}catch(U){console.error("Failed to load areas:",U)}},Go=async()=>{try{const[U,le]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);Je.value=U.data,Hn.value=le.data,ae.value.checklists=Date.now()}catch(U){console.error("Failed to load checklists:",U)}},Wn=async()=>{try{const U=await ys.getByEvent(t.params.eventId);Mn.value=U.data,ae.value.notes=Date.now()}catch(U){console.error("Failed to load notes:",U)}},Kn=async()=>{si.value=!0;try{const U=await eo.getAll(t.params.eventId);Xt.value=U.data.incidents||[],ae.value.incidents=Date.now()}catch(U){console.error("Failed to load incidents:",U)}finally{si.value=!1}},ls=async()=>{try{const[U,le]=await Promise.all([Xi.getByEvent(t.params.eventId),Xi.getRoles(t.params.eventId)]);Uo.value=U.data,zo.value=le.data,ae.value.contacts=Date.now()}catch(U){console.error("Failed to load contacts:",U)}},Ns=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),V.value=i.locations,ae.value.checkpoints=Date.now(),z.value=i.eventStatus.locations},Fi=async()=>{await Promise.all([jn(),i.fetchEventStatus(t.params.eventId)]),z.value=i.eventStatus.locations},lt=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),qn()]),V.value=i.locations,z.value=i.eventStatus.locations},yn=async()=>{await i.fetchEventStatus(t.params.eventId),z.value=i.eventStatus.locations},kt=()=>{wt.value=null,mo.value="details",$e.value=!1,xt.value=!0},Zo=U=>{wt.value=U,so.value=U.id,mo.value="details",$e.value=!1,xt.value=!0},ui=async U=>{try{if(wt.value&&wt.value.id){if(await Ks.update(t.params.eventId,wt.value.id,U),U.checklistChanges&&U.checklistChanges.length>0)for(const le of U.checklistChanges)try{le.complete?await Rt.complete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId}):await Rt.uncomplete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId})}catch(ge){console.error("Failed to update checklist item:",le,ge)}}else await Ks.create({eventId:t.params.eventId,...U});await qn(),await rn(),cs()}catch(le){console.error("Failed to save area:",le),alert(le.response?.data?.message||"Failed to save area. Please try again.")}},di=async U=>{_(`Delete ${P.value.area}`,`Are you sure you want to delete this ${P.value.area}? ${B.value.checkpoints} will be automatically reassigned.`,async()=>{try{await Ks.delete(t.params.eventId,U),await Ks.recalculate(t.params.eventId),await qn(),await rn(),cs()}catch(le){console.error(`Failed to delete ${P.value.area}:`,le),alert(le.response?.data?.message||`Failed to delete ${P.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},cs=()=>{xt.value=!1,wt.value=null,so.value=null,$e.value=!1,No.value=!1,Ot.value=null},ko=U=>{En.value=null,_o.value="details",$e.value=!1,Gn.value=U,Pn.value=!0},hi=U=>{En.value=U,_o.value="details",$e.value=!1,Pn.value=!0},Yn=()=>{Tn.value=null,Ps.value="details",$e.value=!1,io.value=!0},Ft=(U,le="details")=>{Tn.value=U,Ps.value=le,$e.value=!1,io.value=!0},bo=async U=>{try{if(Tn.value&&Tn.value.itemId)await Rt.update(t.params.eventId,Tn.value.itemId,U);else{const le=await Rt.create(t.params.eventId,U);le.data.count&&le.data.count>1&&(Ue.value="Checklist Items Created",Qe.value=`Successfully created ${le.data.count} checklist items.`,J.value=!0)}await Go(),Z()}catch(le){console.error("Failed to save checklist item:",le);const ge=le.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ge)}},q=async U=>{_(`Delete ${P.value.checklist}`,`Are you sure you want to delete this ${P.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,U),await Go(),Z()}catch(le){console.error(`Failed to delete ${P.value.checklist}:`,le),alert(le.response?.data?.message||`Failed to delete ${P.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Z=()=>{io.value=!1,Tn.value=null,$e.value=!1},ee=()=>{An.value=null,Ds.value="details",$e.value=!1,Vn.value=!0},Se=U=>{An.value=U,Ds.value="details",$e.value=!1,Vn.value=!0},ze=async U=>{try{An.value&&An.value.noteId?await ys.update(t.params.eventId,An.value.noteId,U):await ys.create(t.params.eventId,U),await Wn(),Vt()}catch(le){console.error("Failed to save note:",le);const ge=le.response?.data?.message||"Failed to save note. Please try again.";alert(ge)}},at=async U=>{_("Delete note","Are you sure you want to delete this note?",async()=>{try{await ys.delete(t.params.eventId,U),await Wn(),Vt()}catch(le){console.error("Failed to delete note:",le),alert(le.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Vt=()=>{Vn.value=!1,An.value=null,$e.value=!1},st=()=>{Fo.value=!0},On=async U=>{try{await eo.create(t.params.eventId,U),Fo.value=!1,await Kn()}catch(le){console.error("Failed to report incident:",le),alert(le.response?.data?.message||"Failed to report incident. Please try again.")}},_n=U=>{nn.value=U,yo.value=!0},fi=()=>{yo.value=!1,nn.value=null},mr=async({incidentId:U,status:le})=>{try{if(await eo.updateStatus(t.params.eventId,U,{status:le}),await Kn(),nn.value?.incidentId===U){const ge=Xt.value.find(Ie=>Ie.incidentId===U);ge&&(nn.value=ge)}}catch(ge){console.error("Failed to update incident status:",ge),alert(ge.response?.data?.message||"Failed to update status. Please try again.")}},Vl=()=>{mn.value="",ii.value=!0},pi=()=>{ii.value=!1,mn.value=""},Gl=async()=>{if(!(!mn.value.trim()||!nn.value)){is.value=!0;try{await eo.addNote(t.params.eventId,nn.value.incidentId,mn.value.trim()),pi(),await Kn();const U=Xt.value.find(le=>le.incidentId===nn.value.incidentId);U&&(nn.value=U)}catch(U){console.error("Failed to add note to incident:",U),alert(U.response?.data?.message||"Failed to add note. Please try again.")}finally{is.value=!1}}},gr=()=>{En.value=null,_o.value="details",Gn.value=null,$e.value=!1,Pn.value=!0},Zl=U=>{En.value=U,_o.value="details",$e.value=!1,Pn.value=!0},jl=async U=>{try{En.value&&En.value.contactId?await Xi.update(t.params.eventId,En.value.contactId,U):await Xi.create(t.params.eventId,U),await ls(),ya()}catch(le){console.error("Failed to save contact:",le);const ge=le.response?.data?.message||"Failed to save contact. Please try again.";alert(ge)}},ga=async U=>{_("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await Xi.delete(t.params.eventId,U),await ls(),ya()}catch(le){console.error("Failed to delete contact:",le),alert(le.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},ya=()=>{Pn.value=!1,En.value=null,Gn.value=null,$e.value=!1},lo=U=>{if(Ot.value=U,xt.value=!1,ce.value){const le=ce.value.getMapCenter(),ge=ce.value.getMapZoom();le&&ge!==null&&(oi.value=le,Bo.value=ge)}sn.value=!0,Bt.value="draw-area",No.value=!0,Ro.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},yr=U=>{Ot.value?wt.value={...wt.value||{},...Ot.value,polygon:U}:wt.value={...wt.value,polygon:U}},_r=U=>{M.handlePolygonDrawing(U)},jo=()=>{No.value=!1,Ot.value&&(wt.value=Ot.value,xt.value=!0,Ot.value=null)},Ui=()=>A.loadEventAdmins(),kr=async U=>{try{await A.addAdmin(U),await Ui(),br()}catch(le){console.error("Failed to add admin:",le),alert(le.response?.data?.message||"Failed to add administrator. Please try again.")}},_a=async U=>{_("Remove administrator",`Remove ${U} as an administrator?`,async()=>{try{await A.removeAdmin(U),await Ui()}catch(le){console.error("Failed to remove admin:",le),alert(le.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},br=()=>{A.closeAddAdminModal(),$e.value=!1},wr=async U=>{await S.uploadRoute(U)&&(await Ns(),ka())},ka=()=>{S.closeUploadRouteModal()},ql=async({file:U,deleteExisting:le})=>{const ge=await S.importLocations(U,le);if(ge){await lt(),Cr();const Ie=S.formatImportResultMessage(ge,"location");Ue.value="Import Complete",Qe.value=Ie,J.value=!0}},Cr=()=>{S.closeImportLocationsModal()},ba=async U=>{if(X.value)Dt.value.latitude=U.lat,Dt.value.longitude=U.lng;else if(ie.value)R.value.latitude=U.lat,R.value.longitude=U.lng,j.value&&(j.value={...j.value,latitude:U.lat,longitude:U.lng}),ie.value=!1,Q.value=!0,dt();else if(In.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${Ni.value}`,description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""}),Ni.value++,await rn()}catch(le){console.error("Failed to create checkpoint:",le),alert("Failed to create checkpoint. Please try again.")}},Wl=U=>{M.handleFullscreenMapClick(U)},Lr=U=>{Dt.value={...U}},Sr=()=>{X.value=!1,M.enterPlaceCheckpointMode()},zi=()=>{M.saveMapState(ce.value),Dt.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},M.enterPlaceCheckpointMode()},us=()=>{M.saveMapState(ce.value),sn.value=!0,Bt.value="view",Ro.value={title:"Course map",description:""}},Kl=()=>{M.saveMapState(ce.value),wt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:_t.value.length},M.enterDrawAreaMode()},vi=()=>{j.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},R.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Ze.value=[],We.value=[],$e.value=!1,Q.value=!0},Rn=()=>{const U=M.calculateStartingNumber(z);M.saveMapState(ce.value),M.enterAddMultipleMode(U)},xr=()=>{if(Bt.value==="place-checkpoint"){const U=M.getPlacedCoords()||{lat:0,lng:0};j.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},R.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""},Ze.value=[],We.value=[],$e.value=!1,Fs(),Q.value=!0}else if(Bt.value==="move-checkpoint"){const U=M.getPlacedCoords();U&&(R.value.latitude=U.lat,R.value.longitude=U.lng,j.value&&(j.value={...j.value,...Zt.value||{},latitude:U.lat,longitude:U.lng}),dt()),Zt.value=null,Fs(),Q.value=!0}else if(Bt.value==="draw-area"){const U=M.getCompletedPolygon();U&&(Ot.value?wt.value={...wt.value||{},...Ot.value,polygon:U}:wt.value={...wt.value||{},polygon:U}),Fs(),mo.value="boundary",xt.value=!0,Ot.value=null}else Bt.value==="add-multiple"&&$r()},$r=async()=>{const U=M.getTempCheckpoints();try{for(const le of U)await i.createLocation({eventId:t.params.eventId,name:le.name,description:le.description,latitude:le.latitude,longitude:le.longitude,requiredMarshals:le.requiredMarshals,what3Words:le.what3Words});M.clearTempCheckpoints(),Fs(),await rn()}catch(le){console.error("Failed to create checkpoints:",le),alert("Failed to create checkpoints. Please try again.")}},Yl=()=>{Bt.value==="draw-area"?Ot.value&&(wt.value=Ot.value,xt.value=!0,Ot.value=null):Bt.value==="move-checkpoint"&&(Zt.value&&j.value&&Object.assign(j.value,Zt.value),Q.value=!0,ie.value=!1),M.cancelFullscreen()},Fs=()=>{M.exitFullscreen()},wa=U=>{Hi(U)},Hi=U=>{j.value=U,R.value={id:U.id,name:U.name,description:U.description||"",latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||""},Ze.value=[],We.value=[],$e.value=!1,Q.value=!0,setTimeout(()=>{ce.value?.scrollMapIntoView()},100)},Jl=async U=>{if(!fl(U.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...U}),await rn(),Ca()}catch(le){console.error("Failed to save location:",le),alert("Failed to save location. Please try again.")}},Ca=()=>{X.value=!1,Dt.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},$e.value=!1,$e.value=!1},La=()=>{Q.value=!1,j.value=null,ie.value=!1,W.value=!1,Zt.value=null,R.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Ze.value=[],We.value=[],$e.value=!1},kn=()=>{W.value=!1},Us=()=>{W.value=!0},Xl=U=>{if(U?.formData&&(Zt.value=U.formData),Q.value=!1,Wt.value=null,ce.value){const ge=ce.value.getMapCenter(),Ie=ce.value.getMapZoom();ge&&Ie!==null&&(oi.value=ge,Bo.value=Ie)}const le=Zt.value?.name||j.value?.name;sn.value=!0,Bt.value="move-checkpoint",Ro.value={title:`Move ${P.value.checkpoint}: ${le}`,description:"Click on the map to set the new location"}},wo=async U=>{if(!fl(U.what3Words)){alert("Invalid What3Words format.");return}try{const le=!j.value.id;if(le){const ge=await i.createLocation({eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const Ie of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:ge.id,marshalId:Ie.marshalId})}else{const ge=j.value.id;if(await Fn.update(t.params.eventId,ge,{eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[]}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const Ie of U.pendingNewChecklistItems)Ie.text?.trim()&&await Rt.create(t.params.eventId,{text:Ie.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const Ie of U.pendingNewNotes)!Ie.title?.trim()&&!Ie.content?.trim()||await ys.create(t.params.eventId,{title:Ie.title||"Untitled",content:Ie.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const Ie of We.value)await i.deleteAssignment(t.params.eventId,Ie);for(const Ie of Ze.value)await i.createAssignment({eventId:t.params.eventId,locationId:j.value.id,marshalId:Ie.marshalId});if(U.checkInChanges&&U.checkInChanges.length>0)for(const Ie of U.checkInChanges){const yt=j.value.assignments.find(bn=>bn.id===Ie.assignmentId);yt&&yt.isCheckedIn!==Ie.shouldBeCheckedIn&&await Ls.adminCheckIn(t.params.eventId,Ie.assignmentId)}}if(!le&&U.checklistChanges&&U.checklistChanges.length>0)for(const ge of U.checklistChanges)try{ge.complete?await Rt.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Rt.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(Ie){console.error("Failed to update checklist item:",ge,Ie)}await rn(),La()}catch(le){console.error("Failed to update location:",le),alert("Failed to update location. Please try again.")}},Ql=async U=>{_(`Delete ${P.value.checkpoint}`,`Are you sure you want to delete this ${P.value.checkpoint}?`,async()=>{try{await Fn.delete(t.params.eventId,U),await lt(),La()}catch(le){console.error(`Failed to delete ${P.value.checkpoint}:`,le),alert(`Failed to delete ${P.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},zs=U=>{const le=U?.id??U;if(le?.toString().startsWith("temp-")){const ge=j.value.assignments.find(Ie=>Ie.id===le);ge&&(Ze.value=Ze.value.filter(Ie=>Ie.marshalId!==ge.marshalId)),j.value.assignments=j.value.assignments.filter(Ie=>Ie.id!==le),dt()}else We.value.includes(le)||(We.value.push(le),j.value.assignments=j.value.assignments.filter(ge=>ge.id!==le),dt())},ec=async U=>{const le=N.value.find(Ie=>Ie.id===U);if(!le)return;const ge=z.value.filter(Ie=>Ie.assignments?.some(yt=>yt.marshalId===U&&Ie.id!==j.value.id));if(ge.length>0){Y.value={marshalName:le.name,locations:ge.map(yt=>yt.name),marshal:le};const Ie=await new Promise(yt=>{F.value=yt,oe.value=!0});if(Ie==="cancel"||Ie==="choose-other")return;if(Ie==="move")for(const yt of ge){const bn=yt.assignments.find(Lo=>Lo.marshalId===U);if(bn){We.value.push(bn.id);const Lo=z.value.findIndex(Ko=>Ko.id===yt.id);Lo!==-1&&(z.value[Lo].assignments=z.value[Lo].assignments.filter(Ko=>Ko.id!==bn.id))}}}Ze.value.push({marshalId:le.id,marshalName:le.name}),j.value.assignments||(j.value.assignments=[]),j.value.assignments.push({id:`temp-${Date.now()}`,marshalId:le.id,marshalName:le.name,locationId:j.value.id,isCheckedIn:!1,isPending:!0}),dt(),kn()},mi=async U=>{try{const ge=(await ns.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber})).data;await jn(),Ze.value.push({marshalId:ge.id,marshalName:ge.name}),j.value&&(j.value.assignments||(j.value.assignments=[]),j.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ge.id,marshalName:ge.name,locationId:j.value.id,isCheckedIn:!1,isPending:!0})),dt(),kn()}catch(le){console.error("Failed to create marshal:",le),alert("Failed to create marshal. Please try again.")}},Ir=()=>{ve.value=null,we.value={},Ve.value={id:"",name:"",email:"",phoneNumber:"",notes:""},re.value=[],se.value=[],$e.value=!1,te.value=!0},Vi=U=>{ve.value=U,we.value={},Ve.value={id:U.id,name:U.name,email:U.email||"",phoneNumber:U.phoneNumber||"",notes:U.notes||""},re.value=[],se.value=[],$e.value=!1,te.value=!0},Tr=()=>{if(!ve.value)return[];const U=[];return z.value.forEach(le=>{le.assignments.filter(Ie=>Ie.marshalName===ve.value.name).forEach(Ie=>{U.push({...Ie,locationName:le.name})})}),U},qo=async U=>{try{let le=ve.value?.id,ge=!1;if(ve.value){if(await ns.update(t.params.eventId,ve.value.id,{name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const Ie of U.pendingNewChecklistItems)Ie.text?.trim()&&await Rt.create(t.params.eventId,{text:Ie.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const Ie of U.pendingNewNotes)!Ie.title?.trim()&&!Ie.content?.trim()||await ys.create(t.params.eventId,{title:Ie.title||"Untitled",content:Ie.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}else le=(await ns.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes,pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]})).data.id,ge=!0;for(const Ie of se.value)await i.deleteAssignment(t.params.eventId,Ie);for(const Ie of re.value)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.locationId,marshalId:le});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const Ie of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.locationId,marshalId:le});if(U.checkInChanges&&U.checkInChanges.length>0){const Ie=Tr();for(const yt of U.checkInChanges){const bn=Ie.find(Lo=>Lo.id===yt.assignmentId);bn&&bn.isCheckedIn!==yt.shouldBeCheckedIn&&await Ls.adminCheckIn(t.params.eventId,yt.assignmentId)}}if(U.checklistChanges&&U.checklistChanges.length>0)for(const Ie of U.checklistChanges)try{const yt={marshalId:le};Ie.contextType&&Ie.contextId&&(yt.contextType=Ie.contextType,yt.contextId=Ie.contextId),Ie.complete?await Rt.complete(t.params.eventId,Ie.itemId,yt):await Rt.uncomplete(t.params.eventId,Ie.itemId,yt)}catch(yt){console.error("Failed to process checklist change:",yt);const bn=yt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${bn}`)}await rn(),Jn(),ge&&(Ce.value=le,pe.value=U.name,Ae.value=!0)}catch(le){console.error("Failed to save marshal:",le);const ge=le.response?.data?.message||"Failed to save marshal. Please try again.";if(le.response?.status===400){const Ie=ge.toLowerCase();Ie.includes("name")?(we.value={name:ge},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("name"))):Ie.includes("email")?(we.value={email:ge},xe.value&&(xe.value.switchToTab("details"),xe.value.focusField("email"))):(we.value={general:ge},xe.value&&xe.value.switchToTab("details"))}else we.value={general:ge},xe.value&&xe.value.switchToTab("details")}},gi=async U=>{const le=U||ve.value?.id;if(!le){console.error("No marshal ID to delete");return}const ge=P.value.person;_(`Delete ${ge}`,`Are you sure you want to delete this ${ge}?`,async()=>{try{await ns.delete(t.params.eventId,le),await Fi(),Jn()}catch(Ie){console.error(`Failed to delete ${ge}:`,Ie),alert(`Failed to delete ${ge}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},tc=U=>{gi(U.id)},Sa=U=>{se.value.includes(U)||(se.value.push(U),dt())},nc=U=>{re.value.push({locationId:U}),dt()},Jn=()=>{te.value=!1,ve.value=null,we.value={},Ve.value={id:"",name:"",email:"",phoneNumber:"",notes:""},re.value=[],se.value=[],$e.value=!1},oc=async({file:U})=>{const le=await S.importMarshals(U);if(le){await Fi(),ds();const ge=S.formatImportResultMessage(le,"marshal");Ue.value="Import Complete",Qe.value=ge,J.value=!0}},ds=()=>{S.closeImportMarshalsModal()},sc=U=>{F.value&&(F.value(U),F.value=null),oe.value=!1},Co=async({assignment:U,status:le})=>{try{if(le==="not-checked-in"?U.isCheckedIn&&await Ls.adminCheckIn(t.params.eventId,U.id):U.isCheckedIn||await Ls.adminCheckIn(t.params.eventId,U.id),await yn(),j.value){const ge=z.value.find(Ie=>Ie.id===j.value.id);ge&&(j.value=ge)}}catch(ge){console.error("Failed to change assignment status:",ge),alert("Failed to change status. Please try again.")}};let Wo=null;const xa=async()=>{try{const U=t.params.eventId,le=await Fn.getDynamicCheckpoints(U);if(le.data&&Array.isArray(le.data))for(const ge of le.data){const Ie=z.value.find(yt=>yt.id===ge.checkpointId);Ie&&(Ie.latitude=ge.latitude,Ie.longitude=ge.longitude,Ie.lastLocationUpdate=ge.lastLocationUpdate)}}catch(U){console.warn("Failed to poll dynamic checkpoints:",U)}},Gi=()=>{Wo||!z.value.some(le=>le.isDynamic||le.IsDynamic)||(xa(),Wo=setInterval(xa,6e4))},yi=()=>{Wo&&(clearInterval(Wo),Wo=null)};return je(a,U=>{U==="course"?Gi():yi();const le=Date.now(),ge=Ie=>le-ae.value[Ie]>NO;switch(U){case"marshals":ge("marshals")&&jn();break;case"areas":ge("areas")&&qn();break;case"checkpoints":ge("checkpoints")&&Ns();break;case"checklists":ge("checklists")&&Go();break;case"notes":ge("notes")&&Wn();break;case"incidents":ge("incidents")&&Kn();break;case"contacts":ge("contacts")&&ls();break}}),Yt(async()=>{await rn();try{const U=await ts.getMe(t.params.eventId);Os.value=U.data}catch(U){console.warn("Failed to fetch user claims:",U)}a.value==="course"&&Gi()}),je(C,U=>{U&&(document.title="OnTheDay App - Admin")},{immediate:!0}),vo(()=>{yi()}),(U,le)=>(v(),y("div",{class:"admin-event-manage",style:it({colorScheme:G(I)})},[l("header",$O,[l("div",IO,[l("button",{onClick:Nt,class:"btn-back",title:"Back to Dashboard"},[Re(xO,{size:48,animate:""})]),C.value?(v(),y("div",TO,[l("h1",null,k(C.value.name),1),l("p",MO,k(G(nv)(C.value.eventDate)),1)])):D("",!0)]),l("div",AO,[ai.value?(v(),y("button",{key:0,onClick:as,class:"btn btn-marshal-mode"}," Switch to Marshal ")):D("",!0)]),Re(ev,{class:"theme-toggle-fixed"})]),l("div",EO,[l("div",PO,[Re(L$,{tabs:T.value,"model-value":G(a),"onUpdate:modelValue":G(c)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",DO,[G(a)==="course"?(v(),Xe(uw,{key:0,ref_key:"courseAreasTab",ref:ce,checkpoints:z.value,areas:_t.value,route:C.value?.route||[],"selected-area-id":so.value,"drawing-mode":G(No),onMapClick:ba,onLocationClick:wa,onAreaClick:Zo,onImportCheckpoints:le[0]||(le[0]=ge=>ue.value=!0),onUploadRoute:le[1]||(le[1]=ge=>Le.value=!0),onSelectLocation:Hi,onAddArea:kt,onSelectArea:Zo,onPolygonComplete:yr,onCancelDrawing:jo,onAddCheckpointFromMap:zi,onAddManyCheckpointsFromMap:Rn,onAddAreaFromMap:Kl,onFullscreen:us},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):D("",!0),G(a)==="checkpoints"?(v(),Xe(Wx,{key:1,locations:z.value,areas:_t.value,onAddCheckpointManually:vi,onImportCheckpoints:le[2]||(le[2]=ge=>ue.value=!0),onSelectLocation:Hi},null,8,["locations","areas"])):D("",!0),G(a)==="areas"?(v(),Xe(p$,{key:2,areas:_t.value,checkpoints:z.value,contacts:Uo.value,"event-people-term":C.value?.peopleTerm||"Marshals","event-checkpoint-term":C.value?.checkpointTerm||"Checkpoints",onAddArea:kt,onSelectArea:Zo},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):D("",!0),G(a)==="marshals"?(v(),Xe(zw,{key:3,marshals:N.value,assignments:$t.value,locations:z.value,onAddMarshal:Ir,onImportMarshals:le[3]||(le[3]=ge=>Pe.value=!0),onSelectMarshal:Vi,onDeleteMarshal:tc,onChangeAssignmentStatus:Co},null,8,["marshals","assignments","locations"])):D("",!0),G(a)==="checklists"?(v(),Xe(tC,{key:4,"checklist-items":Je.value,areas:_t.value,locations:z.value,marshals:N.value,"completion-report":Hn.value,onAddChecklistItem:Yn,onSelectChecklistItem:Ft},null,8,["checklist-items","areas","locations","marshals","completion-report"])):D("",!0),G(a)==="notes"?(v(),Xe(_C,{key:5,notes:Mn.value,areas:_t.value,locations:z.value,marshals:N.value,onAddNote:ee,onSelectNote:Se},null,8,["notes","areas","locations","marshals"])):D("",!0),G(a)==="incidents"?(v(),Xe(Ex,{key:6,incidents:Xt.value,areas:_t.value,loading:si.value,onSelectIncident:_n,onReportIncident:st},null,8,["incidents","areas","loading"])):D("",!0),G(a)==="contacts"?(v(),Xe(NC,{key:7,contacts:Uo.value,areas:_t.value,locations:z.value,marshals:N.value,"available-roles":zo.value,onAddContact:gr,onSelectContact:Zl},null,8,["contacts","areas","locations","marshals","available-roles"])):D("",!0),G(a)==="details"?(v(),Xe(YC,{key:8,"event-data":ot.value,"form-dirty":vt.value,onSubmit:Zn,"onUpdate:formDirty":gn},null,8,["event-data","form-dirty"])):D("",!0),G(a)==="settings"?(v(),Xe(lx,{key:9,"event-data":ot.value,"event-id":G(t).params.eventId,admins:G(me),"form-dirty":vt.value,onSubmit:Zn,onAddAdmin:le[4]||(le[4]=ge=>nt.value=!0),onRemoveAdmin:_a,"onUpdate:formDirty":gn},null,8,["event-data","event-id","admins","form-dirty"])):D("",!0)])]),Re(bO,{show:X.value,location:Dt.value,"is-dirty":$e.value,onClose:Ca,onSave:Jl,onSetOnMap:Sr,"onUpdate:isDirty":dt,"onUpdate:location":Lr},null,8,["show","location","is-dirty"]),Re(LE,{show:Q.value,location:j.value,assignments:j.value?.assignments||[],"event-date":C.value?.eventDate||"",areas:_t.value,"event-id":G(t).params.eventId,"all-locations":z.value,notes:Mn.value,"available-marshals":Dn.value,"all-checklist-items":Je.value,incidents:li.value,"is-dirty":$e.value,"event-default-style-type":C.value?.defaultCheckpointStyleType||C.value?.DefaultCheckpointStyleType||"default","event-default-style-color":C.value?.defaultCheckpointStyleColor||C.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":C.value?.defaultCheckpointStyleBackgroundShape||C.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":C.value?.defaultCheckpointStyleBackgroundColor||C.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":C.value?.defaultCheckpointStyleBorderColor||C.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":C.value?.defaultCheckpointStyleIconColor||C.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":C.value?.defaultCheckpointStyleSize||C.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":C.value?.defaultCheckpointStyleMapRotation??C.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":C.value?.peopleTerm||"Marshals","z-index":xt.value?1100:1e3,onClose:La,onSave:wo,onDelete:Ql,onMoveLocation:Xl,onRemoveAssignment:zs,onOpenAssignModal:Us,"onUpdate:isDirty":dt,onSelectIncident:ci},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index"]),Re(I$,{show:Te.value,link:mt.value,"is-dirty":!1,onClose:le[5]||(le[5]=ge=>Te.value=!1)},null,8,["show","link"]),Re(H$,{show:Ae.value,"event-id":G(t).params.eventId,"marshal-id":Ce.value,"marshal-name":pe.value,onClose:le[6]||(le[6]=ge=>Ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Re(Z$,{show:G(nt),"is-dirty":$e.value,onClose:br,onSubmit:kr,"onUpdate:isDirty":dt},null,8,["show","is-dirty"]),Re(Y$,{show:G(Le),uploading:G(Be),error:G(Ge),"is-dirty":$e.value,onClose:ka,onSubmit:wr,"onUpdate:isDirty":dt},null,8,["show","uploading","error","is-dirty"]),Re(aI,{show:G(ue),importing:G(Ee),error:G(de),result:G(ke),"is-dirty":$e.value,onClose:Cr,onSubmit:ql,"onUpdate:isDirty":dt},null,8,["show","importing","error","result","is-dirty"]),Re(A3,{ref_key:"editMarshalModalRef",ref:xe,show:te.value,marshal:ve.value,"event-id":G(t).params.eventId,assignments:Tr(),"available-locations":Rs.value,"all-locations":z.value,areas:_t.value,"is-editing":!!ve.value,"event-notes":Mn.value,"all-checklist-items":Je.value,incidents:Et.value,"is-dirty":$e.value,"validation-errors":we.value,onClose:Jn,onSave:qo,onDelete:gi,onRemoveAssignment:Sa,onAssignToLocation:nc,"onUpdate:isDirty":dt,onSelectIncident:an},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors"]),Re(pI,{show:G(Pe),importing:G(Me),error:G(de),result:G(H),"is-dirty":$e.value,onClose:ds,onSubmit:oc,"onUpdate:isDirty":dt},null,8,["show","importing","error","result","is-dirty"]),Re(O3,{show:oe.value,"conflict-data":Y.value,onClose:le[7]||(le[7]=ge=>oe.value=!1),onChoice:sc},null,8,["show","conflict-data"]),Re(Z3,{show:W.value,"location-name":j.value?.name||"",marshals:Dn.value,onClose:kn,onAssignExisting:ec,onCreateAndAssign:mi},null,8,["show","location-name","marshals"]),Re(o4,{show:Tt.value,"old-event-date":Jt.value,"new-event-date":gt.value,"affected-checkpoints-count":qt.value,onConfirm:Bs,onCancel:rs},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Re(I6,{show:xt.value,area:wt.value,"initial-tab":mo.value,checkpoints:z.value,marshals:N.value,areas:_t.value,"is-dirty":$e.value,"event-id":G(t).params.eventId,"all-locations":z.value,assignments:$t.value,notes:Mn.value,contacts:Uo.value,incidents:Vo.value,"event-default-style-type":C.value?.defaultCheckpointStyleType||C.value?.DefaultCheckpointStyleType||"default","event-default-style-color":C.value?.defaultCheckpointStyleColor||C.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":C.value?.defaultCheckpointStyleBackgroundShape||C.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":C.value?.defaultCheckpointStyleBackgroundColor||C.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":C.value?.defaultCheckpointStyleBorderColor||C.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":C.value?.defaultCheckpointStyleIconColor||C.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":C.value?.defaultCheckpointStyleSize||C.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":C.value?.defaultCheckpointStyleMapRotation??C.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":C.value?.peopleTerm||"Marshals","event-checkpoint-term":C.value?.checkpointTerm||"Checkpoints",onClose:cs,onSave:ui,onDelete:di,onDrawBoundary:lo,"onUpdate:isDirty":dt,onSelectCheckpoint:Hi,onAddAreaContact:ko,onEditContact:hi,onSelectIncident:ao},null,8,["show","area","initial-tab","checkpoints","marshals","areas","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Re(F6,{show:io.value,"checklist-item":Tn.value,"initial-tab":Ps.value,areas:_t.value,locations:z.value,marshals:N.value,"is-dirty":$e.value,onClose:Z,onSave:bo,onDelete:q,"onUpdate:isDirty":dt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Re(e5,{show:Vn.value,note:An.value,"initial-tab":Ds.value,areas:_t.value,locations:z.value,marshals:N.value,"is-dirty":$e.value,onClose:Vt,onSave:ze,onDelete:at,"onUpdate:isDirty":dt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Re(Du,{show:yo.value,incident:nn.value,route:C.value?.route||[],checkpoints:z.value,"can-manage":!0,onClose:fi,onStatusChange:mr,onOpenAddNote:Vl},null,8,["show","incident","route","checkpoints"]),Re(Pt,{show:ii.value,title:"Add update",size:"small",onClose:pi},{footer:qe(()=>[l("div",RO,[l("button",{type:"button",class:"btn btn-secondary",onClick:pi}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Gl,disabled:!mn.value.trim()||is.value},k(is.value?"Adding...":"Add update"),9,BO)])]),default:qe(()=>[l("div",OO,[Ne(l("textarea",{"onUpdate:modelValue":le[8]||(le[8]=ge=>mn.value=ge),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[et,mn.value]])])]),_:1},8,["show"]),Re(uv,{show:Fo.value,"event-id":G(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:z.value,route:C.value?.route||[],onClose:le[9]||(le[9]=ge=>Fo.value=!1),onSubmit:On},null,8,["show","event-id","checkpoints","route"]),Re(YD,{show:Pn.value,contact:En.value,"initial-tab":_o.value,areas:_t.value,locations:z.value,marshals:N.value,"available-roles":zo.value,"is-dirty":$e.value,"preselected-area":Gn.value,onClose:ya,onSave:jl,onDelete:ga,"onUpdate:isDirty":dt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","preselected-area"]),Re(uO,{show:G(sn),mode:G(Bt),"context-title":G(Ro).title,"context-description":G(Ro).description,"can-complete":Ho.value,clickable:G(Bt)!=="draw-area","drawing-mode":G(Bt)==="draw-area"&&G(No),locations:ri.value,areas:ct.value,route:C.value?.route||[],"selected-area-id":so.value,center:G(oi),zoom:G(Bo),onMapClick:Wl,onPolygonComplete:yr,onPolygonDrawing:_r,onDone:xr,onCancel:Yl},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),Re(Hl,{show:J.value,title:Ue.value,message:Qe.value,onClose:le[10]||(le[10]=ge=>J.value=!1)},null,8,["show","title","message"]),Re(ar,{show:G(u),title:G(d),message:G(p),"is-danger":G(f),"confirm-text":G(g),onConfirm:G(b),onCancel:G(x)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},UO=Ke(FO,[["__scopeId","data-v-e6d2066d"]]),zO={key:0,class:"emergency-notes-section"},HO={class:"emergency-notes-list"},VO={class:"note-header"},GO={key:0,class:"note-content"},ZO={key:1,class:"emergency-contacts-section"},jO={class:"emergency-contacts-list"},qO={class:"contact-header"},WO={key:0,class:"role-badge"},KO={class:"contact-details"},YO={key:0,class:"info-section"},JO=["href"],XO={key:1,class:"info-section"},QO=["href"],e8={key:2,class:"info-section"},t8=["href"],n8={key:2,class:"no-contacts"},o8={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=K(()=>o.notes?[...o.notes].sort((u,d)=>{const p=u.priority||u.Priority,f=d.priority||d.Priority;return p==="Emergency"&&f!=="Emergency"?-1:f==="Emergency"&&p!=="Emergency"?1:0}):[]),a=()=>{i("close")},c=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,d)=>(v(),Xe(Pt,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:qe(()=>[l("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:qe(()=>[e.notes&&e.notes.length>0?(v(),y("div",zO,[d[0]||(d[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",HO,[(v(!0),y(be,null,Oe(s.value,p=>(v(),y("div",{key:p.noteId||p.NoteId,class:fe(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[l("div",VO,[l("h3",null,k(p.title||p.Title),1),l("span",{class:fe(["priority-badge",(p.priority||p.Priority).toLowerCase()])},k(p.priority||p.Priority),3)]),p.content||p.Content?(v(),y("div",GO,k(p.content||p.Content),1)):D("",!0)],2))),128))])])):D("",!0),e.contacts&&e.contacts.length>0?(v(),y("div",ZO,[d[4]||(d[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",jO,[(v(!0),y(be,null,Oe(e.contacts,p=>(v(),y("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[l("div",qO,[l("h3",null,k(p.name),1),p.role?(v(),y("span",WO,k(c(p.role)),1)):D("",!0)]),l("div",KO,[p.phone?(v(),y("div",YO,[d[1]||(d[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${p.phone}`,class:"phone-link"},k(p.phone),9,JO)])):D("",!0),p.email?(v(),y("div",XO,[d[2]||(d[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${p.email}`,class:"email-link"},k(p.email),9,QO)])):D("",!0),p.notes||p.details?(v(),y("div",e8,[d[3]||(d[3]=l("label",null,"Details",-1)),l("p",null,k(p.notes||p.details),1)])):D("",!0)]),p.phone?(v(),y("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+k(p.name),9,t8)):D("",!0)]))),128))])])):D("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(v(),y("div",n8,[...d[5]||(d[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):D("",!0)]),_:1},8,["show"]))}},s8=Ke(o8,[["__scopeId","data-v-77c03c7e"]]),Hr=E(navigator.onLine),Ys=E(!0),Ai=E(0),Vr=E(null),Ii=E("idle"),ia=E(null);let Bh=null,$c=!1,$o=null;function i8(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function iu(){$o&&(clearTimeout($o),$o=null);const e=i8(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),$o=setTimeout(async()=>{if($o=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await hl()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await vl();const o=await hl();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),iu())},e)}async function Fa(){if(!navigator.onLine)return Ys.value=!1,!1;try{return await uk.check(),Ys.value=!0,!0}catch(e){return e.response?.status===404?(Ys.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Ys.value=!1,!1)}}async function a8(e){try{switch(e.type){case"checkin":await Ls.checkIn(e.payload);break;case"checkin_admin":await Ls.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function vl(){if(!$c&&navigator.onLine){$c=!0,Ii.value="syncing",ia.value=null;try{const e=await Kp();if(e.length===0){Ii.value="success",Ai.value=0;return}let t=0,o=0;for(const i of e){const s=await a8(i);if(s===!0)await xh(i.id),t++;else if(s==="permanent_failure")await xh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await Sh(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await Sh(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}Ai.value=await hl(),o>0?(Ii.value="error",ia.value=`${o} action(s) failed to sync`):Ii.value="success"}catch(e){console.error("Sync error:",e),Ii.value="error",ia.value="Failed to sync pending actions"}finally{$c=!1}}}function r8(){Bh||(Bh=setInterval(async()=>{navigator.onLine&&(await Fa(),Ys.value&&Ai.value>0&&await vl())},3e4))}function Ou(){const e=K(()=>Hr.value&&Ys.value);async function t(){Ai.value=await hl()}async function o(){Hr.value=!0,await Fa()&&Ai.value>0&&iu()}function i(){Hr.value=!1,Ys.value=!1,$o&&(clearTimeout($o),$o=null)}Yt(async()=>{await Es(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),navigator.onLine&&await Fa()&&Ai.value>0&&iu(),r8()}),vo(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),$o&&(clearTimeout($o),$o=null)});async function s(d,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await ir(d,f),Vr.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function a(d){const p=await Xs(d);return p&&(Vr.value=p.cachedAt),p}async function c(d){Vr.value=await sk(d)}async function u(){return navigator.onLine?await Fa()?(await vl(),Ii.value==="success"):(ia.value="Server is not responding",!1):(ia.value="Cannot sync while offline",!1)}return{isOnline:Hr,isServerHealthy:Ys,isFullyOnline:e,pendingActionsCount:Ai,lastSyncTime:Vr,syncStatus:Ii,syncError:ia,checkServerHealth:Fa,syncPendingActions:vl,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:c,forcSync:u}}const l8={class:"area-lead-content"},c8={key:0,class:"loading-state"},u8={key:1,class:"error-state"},d8={key:2,class:"empty-state"},h8={key:3,class:"checkpoint-accordion"},f8=["onClick"],p8={class:"checkpoint-header-content"},v8={class:"checkpoint-title-row"},m8={class:"checkpoint-name"},g8={key:0,class:"area-badge"},y8={key:0,class:"checkpoint-description-preview"},_8={class:"checkpoint-status-row"},k8={class:"status-badge marshals-status"},b8={key:0,class:"status-badge tasks-status"},w8={class:"accordion-icon"},C8={key:0,class:"checkpoint-accordion-content"},L8={class:"checkpoint-mini-map"},S8={class:"checkpoint-marshals-section"},x8={class:"marshals-label"},$8={key:0,class:"empty-state"},I8={key:1,class:"marshals-list"},T8=["onClick"],M8={class:"marshal-header"},A8={class:"marshal-name-row"},E8={class:"marshal-name"},P8={key:0,class:"task-count"},D8={class:"check-status-row"},O8=["onClick","disabled"],R8={key:0,class:"check-in-time"},B8={key:0},N8={key:1,class:"last-access-time"},F8={key:0,class:"checkpoint-tasks-section"},U8={class:"marshals-label"},z8={class:"tasks-list"},H8=["disabled","onChange"],V8={class:"task-text"},G8={class:"incidents-accordion-section"},Z8={class:"incidents-header-content"},j8={key:0,class:"incidents-badge"},q8={class:"accordion-icon"},W8={key:0,class:"incidents-accordion-content"},K8={key:0,class:"loading-state"},Y8={key:1,class:"empty-state"},J8={key:2,class:"incidents-list"},X8={key:0,class:"marshal-details-modal"},Q8={class:"details-section"},eR={class:"contact-info"},tR={key:0,class:"contact-row"},nR=["href"],oR={key:1,class:"contact-row"},sR=["href"],iR={key:2,class:"no-contact"},aR={class:"details-section"},rR={key:0,class:"checked-in-section"},lR={class:"checked-in-details"},cR={class:"check-time-detail"},uR={key:0,class:"check-method"},dR=["disabled"],hR={key:1,class:"not-checked-in-section"},fR=["disabled"],pR={key:2,class:"last-access-detail"},vR={class:"details-section"},mR={key:0,class:"no-tasks"},gR={key:1,class:"tasks-list modal-tasks"},yR=["disabled","onChange"],_R={class:"task-text"},kR={class:"details-section contact-actions-section"},bR={class:"contact-buttons"},wR=["href"],CR=["href"],LR=["href"],SR={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),{updatePendingCount:a}=Ou(),c=e,u=o,d=E(!1),p=E(null),f=E([]),g=E([]),_=E(null),b=E(!1),x=E(null),$=K(()=>[...g.value].sort((H,Q)=>ss(H.name,Q.name))),B=(H,Q=60)=>H?H.length<=Q?H:H.substring(0,Q).trim()+"...":"";t({areas:f,checkpoints:g,loading:d});const P=E(!1),M=E(null),S=E(null),A=E([]),I=E(!1),T=E(!1),C=E(null),V=E(!1),z=async()=>{if(!(!c.eventId||c.areaIds.length===0)){if(d.value=!0,p.value=null,un()){try{const H=await Xs(c.eventId);if(H?.areaLeadDashboard){f.value=H.areaLeadDashboard.areas||[],g.value=H.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(H){console.warn("Failed to load cached dashboard:",H)}p.value="Offline - no cached data available",d.value=!1;return}try{const H=await Ks.getAreaLeadDashboard(c.eventId);f.value=H.data.areas||[],g.value=H.data.checkpoints||[];try{const Q=JSON.parse(JSON.stringify({areas:f.value,checkpoints:g.value}));await Xs(c.eventId)?await Ra(c.eventId,"areaLeadDashboard",Q):await ir(c.eventId,{areaLeadDashboard:Q})}catch(Q){console.warn("Failed to cache dashboard:",Q)}}catch(H){console.error("Failed to load area lead dashboard:",H);try{const Q=await Xs(c.eventId);if(Q?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Q.areaLeadDashboard.areas||[],g.value=Q.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Q){console.warn("Failed to load cached dashboard:",Q)}p.value=H.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},ae=async()=>{if(!(!c.eventId||c.areaIds.length===0)){I.value=!0;try{const H=[];for(const ie of c.areaIds)try{const W=(await eo.getForArea(c.eventId,ie)).data.incidents||[];H.push(...W)}catch(R){console.warn(`Failed to load incidents for area ${ie}:`,R)}const Q=H.reduce((ie,R)=>(ie.find(W=>W.incidentId===R.incidentId)||ie.push(R),ie),[]);A.value=Q.sort((ie,R)=>new Date(R.incidentTime||R.createdAt)-new Date(ie.incidentTime||ie.createdAt))}catch(H){console.error("Failed to load incidents:",H)}finally{I.value=!1}}},j=K(()=>A.value.filter(H=>H.status==="open"||H.status==="acknowledged"||H.status==="in_progress").length),X=()=>{T.value=!T.value,T.value&&A.value.length===0&&ae()},ce=H=>{C.value=H,V.value=!0},Te=()=>{V.value=!1,C.value=null},Ae=async({incidentId:H,status:Q})=>{try{if(await eo.updateStatus(c.eventId,H,{status:Q}),await ae(),C.value?.incidentId===H){const ie=A.value.find(R=>R.incidentId===H);ie&&(C.value=ie)}}catch(ie){console.error("Failed to update incident status:",ie),alert(ie.response?.data?.message||"Failed to update status")}},Ce=async({incidentId:H,note:Q})=>{try{if(await eo.addNote(c.eventId,H,Q),await ae(),C.value?.incidentId===H){const ie=A.value.find(R=>R.incidentId===H);ie&&(C.value=ie)}}catch(ie){console.error("Failed to add note to incident:",ie),alert(ie.response?.data?.message||"Failed to add note")}},pe=H=>{_.value=_.value===H?null:H},me=H=>H.marshals.filter(Q=>Q.isCheckedIn).length,nt=H=>{const Q=H.marshals.reduce((ie,R)=>ie+R.outstandingTaskCount,0);return H.outstandingTaskCount+Q},Le=(H,Q)=>{M.value=H,S.value=Q,P.value=!0},Be=()=>{P.value=!1,M.value=null,S.value=null},Ge=async(H,Q)=>{if(x.value)return;const ie=H.assignmentId||H.id;if(!ie){console.error("No assignment ID found for marshal:",H);return}x.value=H.marshalId;try{if(un())await Qn("checkin_admin",{eventId:c.eventId,assignmentId:ie}),H.isCheckedIn=!0,H.checkInTime=new Date().toISOString(),H.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await Ls.adminCheckIn(c.eventId,ie),await z(),u("checkin-updated"),M.value?.marshalId===H.marshalId&&S.value){const R=g.value.find(W=>W.checkpointId===S.value.checkpointId);if(R){const W=R.marshals.find(oe=>oe.marshalId===H.marshalId);W&&(M.value=W)}}}catch(R){console.error("Failed to check in marshal:",R),(un()||!R.response)&&(await Qn("checkin_admin",{eventId:c.eventId,assignmentId:ie}),H.isCheckedIn=!0,H.checkInTime=new Date().toISOString(),H.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{x.value=null}},ue=async(H,Q)=>{if(b.value)return;b.value=!0;const R={marshalId:Q.marshals.length>0?Q.marshals[0].marshalId:c.marshalId,contextType:H.contextType,contextId:H.contextId};try{un()?(await Qn("checklist_complete",{eventId:c.eventId,itemId:H.itemId,data:R}),Q.outstandingTasks=Q.outstandingTasks.filter(W=>W.itemId!==H.itemId),Q.outstandingTaskCount=Math.max(0,Q.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Rt.complete(c.eventId,H.itemId,R),await z(),u("checklist-updated"))}catch(W){console.error("Failed to complete task:",W),(un()||!W.response)&&(await Qn("checklist_complete",{eventId:c.eventId,itemId:H.itemId,data:R}),Q.outstandingTasks=Q.outstandingTasks.filter(oe=>oe.itemId!==H.itemId),Q.outstandingTaskCount=Math.max(0,Q.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{b.value=!1}},Pe=async H=>{if(b.value||!M.value)return;b.value=!0;const Q={marshalId:M.value.marshalId,contextType:H.contextType,contextId:H.contextId};try{if(un())await Qn("checklist_complete",{eventId:c.eventId,itemId:H.itemId,data:Q}),M.value.outstandingTasks=M.value.outstandingTasks.filter(ie=>ie.itemId!==H.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Rt.complete(c.eventId,H.itemId,Q),await z(),M.value&&S.value){const ie=g.value.find(R=>R.checkpointId===S.value.checkpointId);if(ie){const R=ie.marshals.find(W=>W.marshalId===M.value.marshalId);R&&(M.value=R)}}u("checklist-updated")}}catch(ie){console.error("Failed to complete task:",ie),(un()||!ie.response)&&(await Qn("checklist_complete",{eventId:c.eventId,itemId:H.itemId,data:Q}),M.value.outstandingTasks=M.value.outstandingTasks.filter(R=>R.itemId!==H.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{b.value=!1}},Ee=H=>H?new Date(H).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Me=H=>H?new Date(H).toLocaleString():"",de=H=>{if(!H)return"";const Q=new Date(H),R=new Date-Q,W=Math.floor(R/6e4),oe=Math.floor(W/60),Y=Math.floor(oe/24);return W<1?"just now":W<60?`${W}m ago`:oe<24?`${oe}h ago`:Y===1?"yesterday":Y<7?`${Y}d ago`:Q.toLocaleDateString()},ke=H=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[H]||H;return je(()=>[c.eventId,c.areaIds],()=>{z()},{immediate:!0}),(H,Q)=>(v(),y("div",l8,[d.value?(v(),y("div",c8," Loading dashboard... ")):p.value?(v(),y("div",u8,[l("p",null,k(p.value),1),l("button",{onClick:z,class:"btn btn-secondary"},"Retry")])):$.value.length===0?(v(),y("div",d8,[l("p",null,"No "+k(G(s).checkpoints)+" in your "+k(G(s).areas)+".",1)])):(v(),y("div",h8,[(v(!0),y(be,null,Oe($.value,ie=>(v(),y("div",{key:ie.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:fe(["checkpoint-accordion-header",{active:_.value===ie.checkpointId}]),onClick:R=>pe(ie.checkpointId)},[l("div",p8,[l("div",v8,[l("span",m8,k(ie.name),1),ie.areaName?(v(),y("span",g8,k(ie.areaName),1)):D("",!0)]),ie.description?(v(),y("div",y8,k(B(ie.description)),1)):D("",!0),l("div",_8,[l("span",k8,k(me(ie))+" / "+k(ie.marshals.length)+" checked in ",1),nt(ie)>0?(v(),y("span",b8,k(nt(ie))+" tasks ",1)):D("",!0)])]),l("span",w8,k(_.value===ie.checkpointId?"":"+"),1)],10,f8),_.value===ie.checkpointId?(v(),y("div",C8,[l("div",L8,[Re(xs,{locations:[{id:ie.checkpointId,name:ie.name,description:ie.description,latitude:ie.latitude,longitude:ie.longitude}],route:e.route,center:{lat:ie.latitude,lng:ie.longitude},zoom:16,"highlight-location-id":ie.checkpointId,"marshal-mode":!0},null,8,["locations","route","center","highlight-location-id"])]),l("div",S8,[l("div",x8,k(G(i).people)+" ("+k(ie.marshals.length)+")",1),ie.marshals.length===0?(v(),y("div",$8," No "+k(G(s).people)+" assigned to this "+k(G(s).checkpoint)+". ",1)):(v(),y("div",I8,[(v(!0),y(be,null,Oe(ie.marshals,R=>(v(),y("div",{key:R.marshalId,class:fe(["marshal-card",{"is-checked-in":R.isCheckedIn}]),onClick:W=>Le(R,ie)},[l("div",M8,[l("div",A8,[l("span",E8,k(R.name),1),R.outstandingTaskCount>0?(v(),y("span",P8,k(R.outstandingTaskCount)+" tasks ",1)):D("",!0)]),l("div",D8,[l("div",{class:fe(["check-status",{"checked-in":R.isCheckedIn}])},k(R.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:ft(W=>Ge(R),["stop"]),class:fe(["quick-checkin-btn",{"undo-btn":R.isCheckedIn}]),disabled:x.value===R.marshalId},k(x.value===R.marshalId?"...":R.isCheckedIn?"Undo":"Check In"),11,O8)])]),R.isCheckedIn&&R.checkInTime?(v(),y("div",R8,[He(k(Ee(R.checkInTime))+" ",1),R.checkInMethod?(v(),y("span",B8," ("+k(ke(R.checkInMethod))+")",1)):D("",!0)])):D("",!0),R.lastAccessedAt?(v(),y("div",N8," Last active: "+k(de(R.lastAccessedAt)),1)):D("",!0)],10,T8))),128))]))]),ie.outstandingTaskCount>0?(v(),y("div",F8,[l("div",U8,"Outstanding "+k(G(s).checkpoint)+" tasks ("+k(ie.outstandingTaskCount)+")",1),l("div",z8,[(v(!0),y(be,null,Oe(ie.outstandingTasks,R=>(v(),y("div",{key:R.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:b.value,onChange:W=>ue(R,ie)},null,40,H8),l("span",V8,k(R.text),1)]))),128))])])):D("",!0)])):D("",!0)]))),128))])),l("div",G8,[l("button",{class:fe(["incidents-accordion-header",{active:T.value}]),onClick:X},[l("div",Z8,[Q[2]||(Q[2]=l("span",{class:"incidents-title"},"Incidents",-1)),j.value>0?(v(),y("span",j8,k(j.value)+" open ",1)):D("",!0)]),l("span",q8,k(T.value?"":"+"),1)],2),T.value?(v(),y("div",W8,[I.value?(v(),y("div",K8," Loading incidents... ")):A.value.length===0?(v(),y("div",Y8,[...Q[3]||(Q[3]=[l("p",null,"No incidents reported in your areas.",-1)])])):(v(),y("div",J8,[(v(!0),y(be,null,Oe(A.value,ie=>(v(),Xe(ma,{key:ie.incidentId,incident:ie,onSelect:ce},null,8,["incident"]))),128))]))])):D("",!0)]),Re(Du,{show:V.value,incident:C.value,"can-manage":!0,onClose:Te,onStatusChange:Ae,onAddNote:Ce},null,8,["show","incident"]),Re(Pt,{show:P.value,title:M.value?.name||"Marshal Details",size:"large",onClose:Be},{actions:qe(()=>[l("button",{onClick:Be,class:"btn btn-secondary"},"Close")]),default:qe(()=>[M.value?(v(),y("div",X8,[l("div",Q8,[Q[6]||(Q[6]=l("h4",null,"Contact Details",-1)),l("div",eR,[M.value.email?(v(),y("div",tR,[Q[4]||(Q[4]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${M.value.email}`},k(M.value.email),9,nR)])):D("",!0),M.value.phoneNumber?(v(),y("div",oR,[Q[5]||(Q[5]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${M.value.phoneNumber}`},k(M.value.phoneNumber),9,sR)])):D("",!0),!M.value.email&&!M.value.phoneNumber?(v(),y("div",iR," No contact details available. ")):D("",!0)])]),l("div",aR,[Q[10]||(Q[10]=l("h4",null,"Check-in Status",-1)),M.value.isCheckedIn?(v(),y("div",rR,[l("div",lR,[Q[8]||(Q[8]=l("span",{class:"check-icon"},"",-1)),l("div",null,[Q[7]||(Q[7]=l("strong",null,"Checked In",-1)),l("p",cR,k(Me(M.value.checkInTime)),1),M.value.checkInMethod?(v(),y("p",uR," Method: "+k(ke(M.value.checkInMethod)),1)):D("",!0)])]),l("button",{onClick:Q[0]||(Q[0]=ie=>Ge(M.value,S.value)),class:"btn btn-secondary undo-checkin-btn",disabled:x.value===M.value.marshalId},k(x.value===M.value.marshalId?"Undoing...":"Undo Check-in"),9,dR)])):(v(),y("div",hR,[Q[9]||(Q[9]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:Q[1]||(Q[1]=ie=>Ge(M.value,S.value)),class:"btn btn-primary check-in-btn",disabled:x.value===M.value.marshalId},k(x.value===M.value.marshalId?"Checking in...":"Check In"),9,fR)])),M.value.lastAccessedAt?(v(),y("div",pR," Last active: "+k(de(M.value.lastAccessedAt)),1)):D("",!0)]),l("div",vR,[l("h4",null,k(G(i).checklists)+" ("+k(M.value.outstandingTasks?.length||0)+" outstanding)",1),!M.value.outstandingTasks||M.value.outstandingTasks.length===0?(v(),y("div",mR," No outstanding tasks. ")):(v(),y("div",gR,[(v(!0),y(be,null,Oe(M.value.outstandingTasks,ie=>(v(),y("div",{key:ie.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:b.value,onChange:R=>Pe(ie)},null,40,yR),l("span",_R,k(ie.text),1)]))),128))]))]),l("div",kR,[l("div",bR,[M.value.phoneNumber?(v(),y("a",{key:0,href:`tel:${M.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,wR)):D("",!0),M.value.phoneNumber?(v(),y("a",{key:1,href:`sms:${M.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,CR)):D("",!0),M.value.email?(v(),y("a",{key:2,href:`mailto:${M.value.email}`,class:"btn btn-secondary"}," Email ",8,LR)):D("",!0)])])])):D("",!0)]),_:1},8,["show","title"])]))}},xR=Ke(SR,[["__scopeId","data-v-284f4df3"]]),$R={class:"offline-indicator-container"},IR={key:0,class:"offline-banner"},TR={class:"offline-text"},MR={key:0,class:"last-sync"},AR={class:"pending-text"},ER={key:0,class:"pending-subtext"},PR={key:1,class:"syncing-text"},DR={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,pendingActionsCount:i,lastSyncTime:s,syncStatus:a,syncError:c,forcSync:u}=Ou(),d=E(!1),p=E(""),f=E(""),g=K(()=>{if(!s.value)return"";const b=new Date(s.value),$=new Date-b,B=Math.floor($/6e4),P=Math.floor(B/60);return B<1?"just now":B<60?`${B}m ago`:P<24?`${P}h ago`:b.toLocaleDateString()}),_=async()=>{await u()};return je(a,b=>{b==="success"&&i.value===0?(p.value="All actions synced successfully!",f.value="success",d.value=!0,setTimeout(()=>{d.value=!1},3e3)):b==="error"&&(p.value=c.value||"Sync failed",f.value="error",d.value=!0,setTimeout(()=>{d.value=!1},5e3))}),(b,x)=>(v(),y("div",$R,[Re(Wr,{name:"slide"},{default:qe(()=>[G(o)?D("",!0):(v(),y("div",IR,[x[0]||(x[0]=l("span",{class:"offline-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"})])],-1)),l("span",TR,k(G(t)?"Server unavailable":"You're offline"),1),G(s)?(v(),y("span",MR," Last synced: "+k(g.value),1)):D("",!0)]))]),_:1}),Re(Wr,{name:"fade"},{default:qe(()=>[G(i)>0?(v(),y("div",{key:0,class:fe(["pending-banner",{"offline-pending":!G(o)}])},[x[1]||(x[1]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",AR,[He(k(G(i))+" pending action"+k(G(i)!==1?"s":"")+" ",1),G(o)?D("",!0):(v(),y("span",ER,"(will sync when online)"))]),G(o)&&G(a)!=="syncing"?(v(),y("button",{key:0,onClick:_,class:"sync-button"}," Sync Now ")):G(a)==="syncing"?(v(),y("span",PR,"Syncing...")):D("",!0)],2)):D("",!0)]),_:1}),Re(Wr,{name:"fade"},{default:qe(()=>[d.value?(v(),y("div",{key:0,class:fe(["sync-toast",f.value])},k(p.value),3)):D("",!0)]),_:1})]))}},OR=Ke(DR,[["__scopeId","data-v-45629f1c"]]),RR={key:0,class:"header-logo-cover"},BR=["src"],NR=["title"],FR=["innerHTML"],UR={key:2,class:"header-logo header-logo-left"},zR=["src"],HR={class:"header-center"},VR={key:0},GR={key:1,class:"header-event-date"},ZR={key:0,class:"header-actions"},jR={key:3,class:"header-logo header-logo-right"},qR=["src"],WR=["title"],KR=["innerHTML"],YR={class:"container"},JR={key:0,class:"selection-card"},XR={key:1,class:"selection-card"},QR={key:0,class:"loading"},eB={key:2,class:"selection-card error-card"},tB={class:"error"},nB={key:3,class:"dashboard"},oB={key:0,class:"welcome-bar"},sB={class:"welcome-info"},iB={key:0,class:"welcome-email"},aB={key:0,class:"mode-switch"},rB={key:1,class:"mode-switch"},lB={class:"accordion"},cB={class:"accordion-section"},uB={class:"accordion-title"},dB=["innerHTML"],hB={key:0,class:"location-status active"},fB={key:1,class:"location-status"},pB={class:"accordion-icon"},vB={key:0,class:"accordion-content map-content"},mB={key:0,class:"map-selection-banner"},gB={class:"map-wrapper"},yB={class:"accordion-section"},_B={class:"accordion-title"},kB=["innerHTML"],bB={class:"accordion-icon"},wB={key:0,class:"accordion-content assignments-accordion-content"},CB={key:0,class:"empty-state"},LB={key:1,class:"checkpoint-accordion"},SB=["onClick"],xB={class:"checkpoint-header-content"},$B={class:"checkpoint-title-row"},IB=["innerHTML"],TB={key:0,class:"checkpoint-check-icon"},MB={class:"checkpoint-name"},AB={key:1,class:"area-badge"},EB={key:2,class:"checkpoint-time-badge"},PB={key:0,class:"checkpoint-description-preview"},DB={class:"accordion-icon"},OB={key:0,class:"checkpoint-accordion-content"},RB={key:0,class:"checkpoint-mini-map"},BB=["onClick"],NB={class:"checkpoint-marshals"},FB={class:"marshals-label"},UB={class:"marshals-list"},zB={key:0,class:"check-badge"},HB={key:1,class:"checkpoint-area-contacts"},VB={class:"marshals-label"},GB={class:"contact-list"},ZB={class:"contact-info"},jB={class:"contact-name"},qB={key:0,class:"contact-role"},WB={key:1,class:"contact-detail"},KB={key:2,class:"contact-detail"},YB={class:"contact-actions"},JB=["href"],XB=["href"],QB=["href"],eN={key:2,class:"checked-in-status"},tN={class:"check-time"},nN={key:3,class:"check-in-actions"},oN=["onClick","disabled"],sN=["onClick","disabled"],iN={key:4,class:"error"},aN={key:5,class:"dynamic-location-section"},rN={class:"dynamic-location-header"},lN={class:"dynamic-badge"},cN={key:0,class:"last-update"},uN={class:"dynamic-location-actions"},dN=["onClick","disabled"],hN=["onClick","title"],fN={class:"accordion-section"},pN={class:"accordion-title"},vN=["innerHTML"],mN={class:"accordion-icon"},gN={key:0,class:"accordion-content"},yN={key:0,class:"loading"},_N={key:1,class:"error"},kN={key:2,class:"empty-state"},bN={key:3,class:"checklist-items"},wN={class:"item-checkbox"},CN=["checked","disabled","onChange"],LN={class:"item-content"},SN={key:0,class:"item-context"},xN={key:1,class:"completion-info"},$N={class:"completion-text"},IN={class:"completion-time"},TN={key:0,class:"accordion-section"},MN={class:"accordion-title"},AN=["innerHTML"],EN={class:"accordion-icon"},PN={key:0,class:"accordion-content"},DN={key:0,class:"loading"},ON={key:1,class:"contact-list"},RN={class:"contact-info"},BN={class:"contact-name-row"},NN={key:0,class:"primary-badge"},FN={class:"contact-name"},UN={key:1,class:"contact-role-badge"},zN={key:0,class:"contact-notes-text"},HN={key:1,class:"contact-detail"},VN={key:2,class:"contact-detail"},GN={class:"contact-actions"},ZN=["href"],jN=["href"],qN=["href"],WN={class:"accordion-section"},KN={class:"accordion-title"},YN=["innerHTML"],JN={class:"accordion-icon"},XN={key:0,class:"accordion-content"},QN={key:1,class:"accordion-section"},e7={class:"accordion-title"},t7=["innerHTML"],n7={key:0,class:"incidents-badge-count"},o7={class:"accordion-icon"},s7={key:0,class:"accordion-content"},i7={key:0,class:"loading-state"},a7={key:1,class:"empty-state"},r7={key:2,class:"incidents-list"},l7={key:2,class:"accordion-section"},c7={class:"accordion-title"},u7=["innerHTML"],d7={key:0,class:"area-lead-badges"},h7={class:"accordion-icon"},f7={key:0,class:"accordion-content area-lead-accordion-content"},p7={key:3,class:"accordion-section"},v7={class:"accordion-title"},m7=["innerHTML"],g7={class:"accordion-icon"},y7={key:0,class:"accordion-content"},_7={class:"event-details"},k7={key:0,class:"event-detail-row"},b7={class:"detail-value"},w7={key:1,class:"event-description"},C7={class:"detail-value"},L7={class:"add-note-form"},S7={class:"modal-actions"},x7=["disabled"],$7={class:"modal-content check-in-reminder-modal"},I7={class:"modal-header warning"},T7={class:"modal-body"},M7={class:"reminder-message"},A7={key:0},E7={class:"reminder-hint"},P7={class:"modal-footer"},D7={class:"modal-content location-update-modal"},O7={class:"modal-header"},R7={class:"modal-body"},B7={key:0,class:"success-message"},N7={key:1},F7={class:"modal-description"},U7={key:0,class:"last-update-info"},z7={key:1,class:"gps-status active"},H7={class:"update-option"},V7=["disabled"],G7={class:"update-option auto-update-option"},Z7={class:"checkbox-label"},j7=["checked"],q7={class:"option-hint"},W7={class:"update-option"},K7=["disabled"],Y7={class:"update-option"},J7={class:"option-label"},X7={key:0,class:"checkpoint-list"},Q7=["onClick","disabled"],eF={key:1,class:"no-checkpoints"},tF={key:2,class:"error"},nF={key:2,class:"fullscreen-map-overlay"},oF={key:0,class:"fullscreen-map-banner"},sF={key:1,class:"fullscreen-map-container"},iF={key:2,class:"fullscreen-map-container"},aF={key:3,class:"fullscreen-map-actions"},rF=6e4,lF={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=St(),{updatePendingCount:i}=Ou(),s=Dl(),a=ha(),c=K(()=>s.params.eventId),u=E(!1),d=E(!1),p=E(null),f=E(null),g=E(null),_=E(null),b=K(()=>_.value?.eventRoles?_.value.eventRoles.filter(Z=>Z.role==="EventAreaLead").flatMap(Z=>Z.areaIds||[]):[]),x=K(()=>b.value.length>0);K(()=>{const q=new Map;for(const Z of sn.value)Z.location&&q.set(Z.location.id,{id:Z.location.id,name:Z.location.name,description:Z.location.description,order:Z.location.order??999});if(x.value)for(const Z of I.value){if(q.has(Z.id))continue;(Z.areaIds||Z.AreaIds||[]).some(Se=>b.value.includes(Se))&&q.set(Z.id,{id:Z.id,name:Z.name,description:Z.description,order:Z.order??999})}return Array.from(q.values()).sort((Z,ee)=>Z.order!==ee.order?Z.order-ee.order:(Z.name||"").localeCompare(ee.name||"",void 0,{numeric:!0,sensitivity:"base"}))});const $=K(()=>{const q=sn.value.find(ee=>ee.isCheckedIn&&!wt(ee.checkInTime)&&ee.location);if(q?.location)return{id:q.location.id,locationId:q.location.id,name:q.location.name,description:q.location.description};if(In.value){const ee=sn.value.find(Se=>Se.id===In.value);if(ee?.location)return{id:ee.location.id,locationId:ee.location.id,name:ee.location.name,description:ee.location.description}}const Z=sn.value[0];return Z?.location?{id:Z.location.id,locationId:Z.location.id,name:Z.location.name,description:Z.location.description}:null}),B=K(()=>_.value?.eventRoles?_.value.eventRoles.some(q=>q.role==="EventAdmin"):!1),P=K(()=>_.value?.authMethod==="SecureEmailLink"&&B.value),M=K(()=>_.value?.authMethod==="MarshalMagicCode"&&B.value),S=()=>{a.push(`/admin/events/${s.params.eventId}`)},A=E(null),I=E([]),T=E([]),C=E([]),V=E(!0),z=K(()=>{const q=A.value?.brandingPageGradientStart||Nn.pageGradientStart,Z=A.value?.brandingPageGradientEnd||Nn.pageGradientEnd;return{background:`linear-gradient(135deg, ${q} 0%, ${Z} 100%)`}}),ae=K(()=>{const q=A.value?.brandingHeaderGradientStart||Nn.headerGradientStart,Z=A.value?.brandingHeaderGradientEnd||Nn.headerGradientEnd;return{background:`linear-gradient(135deg, ${q} 0%, ${Z} 100%)`}}),j=K(()=>{const q=A.value?.brandingHeaderGradientStart||Nn.headerGradientStart,Z=A.value?.brandingHeaderGradientEnd||Nn.headerGradientEnd;return rv(q,Z)}),X=K(()=>A.value?.brandingAccentColor||Nn.accentColor),ce=K(()=>av(X.value)),Te=K(()=>({background:X.value,color:ce.value})),Ae=K(()=>A.value?.brandingLogoUrl||""),Ce=K(()=>A.value?.brandingLogoPosition||"left"),pe=E("assignments"),me=E({checklist:0,notes:0,incidents:0,eventContacts:0}),nt=E(null),Le=E(null),Be=E(null),Ge=E([]),ue=E(!1),Pe=E(null),Ee=E(!1),Me=E([]),de=E([]),ke=E(!1),H=E(null),Q=E(!1),ie=E(!1),R=E(""),W=E(!1),oe=K(()=>de.value.filter(q=>q.status==="open"||q.status==="acknowledged"||q.status==="in_progress").length),Y=E(!1),F=E(null),N=E(null),te=E(null),ve=E(!1),xe=E(!1);let we=null,Ve=null;const $e=E(null),Ze=E(!1),We=E(!1),re=E(!1),se=E(!1),J=E(""),Ue=E(""),Qe=E(null),ot=E(!1),vt=E(""),Tt=E(""),Jt=E(!1),gt=E(null),qt=E(new Set),Dt=E(null),_t=E(null),wt=q=>{if(!q)return!0;const Z=new Date(q);return(new Date-Z)/(1e3*60*60)>24},xt=E(null),mo=E(null);let so=null;const Ot=q=>{const Z=pe.value===q;if(pe.value=Z?null:q,!Z){const ee=Date.now(),Se=ze=>ee-me.value[ze]>rF;switch(q){case"checklist":Se("checklist")&&Pn();break;case"notes":Se("notes")&&Uo();break;case"incidents":Se("incidents")&&zo();break;case"eventContacts":Se("eventContacts")&&En();break}}},In=E(null),Ni=q=>{In.value=In.value===q?null:q};je(()=>T.value,q=>{q.length===1&&In.value===null&&(In.value=q[0].id)},{immediate:!0});const sn=K(()=>T.value.map(q=>{const Z=I.value.find(On=>On.id===q.locationId),ee=Z?.areaIds||Z?.AreaIds||[];let Se=null;ee.length>0&&C.value.length>0&&(Se=C.value.find(_n=>ee.includes(_n.id))?.name);const at=(Z?.assignments||[]).map(On=>({...On,effectiveIsCheckedIn:On.isCheckedIn&&!wt(On.checkInTime)})),Vt=Xt.value.filter(On=>ee.includes(On.areaId)),st=q.isCheckedIn&&!wt(q.checkInTime);return{...q,location:Z,areaName:Se,areaIds:ee,allMarshals:at,areaContacts:Vt,locationName:Z?.name||"Unknown Location",effectiveIsCheckedIn:st}})),Bt=K(()=>T.value.length>0?T.value[0]:null),Ro=K(()=>T.value.map(q=>q.locationId)),Wt=K(()=>sn.value.some(q=>q.location?.isDynamic||q.location?.IsDynamic)),go=K(()=>sn.value.find(q=>q.location?.isDynamic||q.location?.IsDynamic)),oi=K(()=>{if(!A.value||!sn.value.length)return[];const q=new Date,Z=A.value.eventDate?new Date(A.value.eventDate):null;return sn.value.filter(ee=>{if(ee.effectiveIsCheckedIn||qt.value.has(ee.id))return!1;const Se=ee.location;if(!Se)return!1;const ze=Se.startTime?new Date(Se.startTime):Z;if(!ze)return!1;let at;if(Se.endTime)at=new Date(Se.endTime);else if(Z)at=new Date(Z.getTime()+7200*1e3);else return!1;return q>=ze&&q<at})});je(oi,q=>{q.length>0&&!Jt.value&&(gt.value=q[0],Jt.value=!0)},{immediate:!0});const Bo=q=>{qt.value.add(q),Jt.value=!1,gt.value=null},No=(q,Z=null)=>{Dt.value=q,_t.value=Z,document.body.style.overflow="hidden"},Zt=()=>{Dt.value=null,_t.value=null,document.body.style.overflow=""},Je=K(()=>A.value?.route?(typeof A.value.route=="string"?JSON.parse(A.value.route):A.value.route)||[]:[]),Tn=K(()=>!Bt.value||!I.value.length?null:I.value.find(q=>q.id===Bt.value.locationId)),io=K(()=>Ge.value.filter(q=>q.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(q.matchedScope)?q.completedByActorId===g.value:!0)),Ps=K(()=>io.value.filter(q=>q.isCompleted).length),Hn=E([]),Mn=E(!1),An=K(()=>Hn.value),Vn=K(()=>{const q=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return Hn.value.filter(Z=>q.includes(Z.role))}),Ds=K(()=>Me.value.filter(q=>{const Z=q.priority||q.Priority;return Z==="Emergency"||Z==="Urgent"})),Xt=E([]);K(()=>{if(Xt.value.length===0)return[];const q={};for(const Z of Xt.value){const ee=Z.areaId||"unknown";q[ee]||(q[ee]={areaId:Z.areaId,areaName:Z.areaName||"Unknown Area",contacts:[]}),q[ee].contacts.push(Z)}return Object.values(q)}),K(()=>Xt.value.length);const si=(q,Z)=>q.localeCompare(Z,void 0,{numeric:!0,sensitivity:"base"}),nn=K(()=>{if(!F.value)return[];const q=F.value.locationId;return I.value.filter(Z=>Z.id!==q&&Z.latitude!==0&&Z.longitude!==0).sort((Z,ee)=>si(Z.name,ee.name))}),yo=K(()=>Tn.value?{lat:Tn.value.latitude,lng:Tn.value.longitude}:xt.value?xt.value:I.value.length>0?{lat:I.value[0].latitude,lng:I.value[0].longitude}:{lat:51.505,lng:-.09}),Fo=async(q,Z)=>{d.value=!0,p.value=null,console.log("Authenticating with magic code:",{eventId:q,code:Z});try{const ee=await ts.marshalLogin(q,Z);if(console.log("Auth response:",ee.data),ee.data.success){localStorage.setItem("sessionToken",ee.data.sessionToken),localStorage.setItem(`marshal_${q}`,ee.data.marshalId),f.value=ee.data.person,g.value=ee.data.marshalId,u.value=!0,console.log("Authenticated as marshal:",g.value,f.value?.name);try{const Se=await ts.getMe(q);_.value=Se.data,console.log("User claims:",_.value)}catch(Se){console.warn("Failed to fetch claims:",Se)}a.replace({path:s.path,query:{}}),Ft(),await mn()}else p.value=ee.data.message||"Authentication failed"}catch(ee){console.error("Authentication failed:",ee),p.value=ee.response?.data?.message||"Invalid or expired login link"}finally{d.value=!1}},ii=async q=>{const Z=localStorage.getItem("sessionToken"),ee=localStorage.getItem(`marshal_${q}`);if(!Z||!ee)return!1;try{const Se=await ts.getMe(q);if(Se.data&&Se.data.marshalId)return _.value=Se.data,f.value={personId:Se.data.personId,name:Se.data.personName,email:Se.data.personEmail},g.value=Se.data.marshalId,u.value=!0,Ft(),!0}catch{localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${q}`)}return!1},mn=async()=>{const q=s.params.eventId;if(console.log("Loading event data for:",{eventId:q,marshalId:g.value}),un()){console.log("Offline mode detected, attempting to load from cache...");const ze=await Xs(q);if(ze){if(console.log("Loaded cached data from:",ze.cachedAt),A.value=ze.event,C.value=ze.areas||[],I.value=ze.locations||[],Ge.value=ze.checklist||[],Hn.value=ze.contacts||[],Me.value=ze.notes||[],A.value&&tu(A.value),g.value){const at=[];for(const Vt of I.value){const st=Vt.assignments?.find(On=>On.marshalId===g.value);st&&at.push(st)}T.value=at}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[Z,ee,Se]=await Promise.allSettled([xi.getById(q),Ks.getByEvent(q),Ba.getEventStatus(q)]);if(Z.status==="fulfilled"?(A.value=Z.value.data,console.log("Event loaded:",A.value?.name),A.value&&tu(A.value)):console.error("Failed to load event:",Z.reason),ee.status==="fulfilled"?(C.value=ee.value.data||[],console.log("Areas loaded:",C.value.length)):console.error("Failed to load areas:",ee.reason),Se.status==="fulfilled"){if(I.value=Se.value.data?.locations||[],console.log("Locations loaded:",I.value.length),g.value){const ze=[];for(const at of I.value){const Vt=at.assignments?.find(st=>st.marshalId===g.value);Vt&&ze.push(Vt)}T.value=ze,console.log("Total assignments found:",T.value.length)}}else console.error("Failed to load event status:",Se.reason);await Promise.allSettled([Pn(),En(),Uo(),zo()]);try{const ze=JSON.parse(JSON.stringify({event:A.value,areas:C.value,locations:I.value,checklist:Ge.value,contacts:Hn.value,notes:Me.value,marshalId:g.value}));await ir(q,ze),console.log("Event data cached for offline access")}catch(ze){console.warn("Failed to cache event data:",ze)}ls()},is=async()=>{const q=s.params.eventId;if(un()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Z=await Ks.getAreaLeadDashboard(q);if(Z.data){const ee=JSON.parse(JSON.stringify({areas:Z.data.areas||[],checkpoints:Z.data.checkpoints||[]}));await Xs(q)?await Ra(q,"areaLeadDashboard",ee):await ir(q,{areaLeadDashboard:ee}),console.log("Area lead dashboard cached for offline access")}}catch(Z){Z.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Z)}console.log("Background preload complete")},Uo=async()=>{const q=s.params.eventId;try{const Z=await ys.getMyNotes(q);Me.value=Z.data||[],me.value.notes=Date.now(),console.log("Notes loaded:",Me.value.length)}catch(Z){console.error("Failed to load notes:",Z)}},zo=async()=>{const q=s.params.eventId;ke.value=!0;try{const Z=new Map;if(x.value&&b.value.length>0)for(const ee of b.value)try{const ze=(await eo.getForArea(q,ee)).data.incidents||[];for(const at of ze)Z.set(at.incidentId,at)}catch(Se){console.warn(`Failed to load incidents for area ${ee}:`,Se)}try{const Se=(await eo.getAll(q)).data.incidents||[];for(const ze of Se)ze.reportedBy?.marshalId===g.value&&Z.set(ze.incidentId,ze)}catch(ee){console.debug("Could not load all incidents:",ee)}de.value=Array.from(Z.values()).sort((ee,Se)=>new Date(Se.incidentTime||Se.createdAt)-new Date(ee.incidentTime||ee.createdAt)),me.value.incidents=Date.now(),console.log("My incidents loaded:",de.value.length)}catch(Z){console.error("Failed to load incidents:",Z)}finally{ke.value=!1}},En=async()=>{const q=s.params.eventId;Mn.value=!0;try{const Z=await Xi.getMyContacts(q);Hn.value=Z.data||[],me.value.eventContacts=Date.now(),console.log("Contacts loaded:",Hn.value.length)}catch(Z){console.warn("Failed to load contacts:",Z),Hn.value=[]}finally{Mn.value=!1}},Pn=async()=>{if(!g.value){console.warn("No marshal ID, skipping checklist load");return}ue.value=!0,Pe.value=null;try{console.log("Fetching checklist for marshal:",g.value);const q=await Rt.getMarshalChecklist(s.params.eventId,g.value);Ge.value=q.data||[],me.value.checklist=Date.now(),console.log("Checklist loaded:",Ge.value.length,"items")}catch(q){console.error("Failed to load checklist:",q.response?.status,q.response?.data),Pe.value=q.response?.data?.message||"Failed to load checklist"}finally{ue.value=!1}},_o=async q=>{if(Ee.value)return;Ee.value=!0;const Z=s.params.eventId,ee={marshalId:g.value,contextType:q.completionContextType,contextId:q.completionContextId};try{q.isCompleted?un()?(await Qn("checklist_uncomplete",{eventId:Z,itemId:q.itemId,data:ee}),q.isCompleted=!1,q.completedAt=null,q.completedByActorName=null,await i()):(await Rt.uncomplete(Z,q.itemId,ee),await Pn()):un()?(await Qn("checklist_complete",{eventId:Z,itemId:q.itemId,data:ee}),q.isCompleted=!0,q.completedAt=new Date().toISOString(),q.completedByActorName=f.value?.name||"You",await i()):(await Rt.complete(Z,q.itemId,ee),await Pn()),await Ra(Z,"checklist",Ge.value)}catch(Se){if(console.error("Failed to toggle checklist item:",Se),un()||!Se.response){const ze=q.isCompleted?"checklist_uncomplete":"checklist_complete";await Qn(ze,{eventId:Z,itemId:q.itemId,data:ee}),q.isCompleted=!q.isCompleted,await i()}else Pe.value=Se.response?.data?.message||"Failed to update checklist",setTimeout(()=>{Pe.value=null},3e3)}finally{Ee.value=!1}},Gn=q=>{if(!q.completionContextType||!q.completionContextId)return null;if(q.completionContextType==="Checkpoint"){const Z=I.value.find(Se=>Se.id===q.completionContextId);if(!Z)return null;const ee=Z.description?` - ${Z.description}`:"";return`At ${o.value.checkpoint} ${Z.name}${ee}`}if(q.completionContextType==="Area"){const Z=C.value.find(ee=>ee.id===q.completionContextId);return Z?`At ${o.value.area} ${Z.name}`:null}return q.completionContextType==="Personal"?"Personal item":null},Os=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),so=navigator.geolocation.watchPosition(q=>{xt.value={lat:q.coords.latitude,lng:q.coords.longitude},mo.value=Date.now()},q=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[q.code]||q.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},ai=()=>{so!==null&&(navigator.geolocation.clearWatch(so),so=null)},as=async q=>{nt.value=q.id,Le.value=q.id,Be.value=null;const Z=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ee=await new Promise((ze,at)=>{navigator.geolocation.getCurrentPosition(ze,at,{enableHighAccuracy:!0,timeout:1e4})}),Se={eventId:Z,assignmentId:q.id,latitude:ee.coords.latitude,longitude:ee.coords.longitude,manualCheckIn:!1};if(un()){await Qn("checkin",Se);const ze=T.value.findIndex(at=>at.id===q.id);ze!==-1&&(T.value[ze]={...T.value[ze],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:ee.coords.latitude,checkInLongitude:ee.coords.longitude}),await i(),await Ra(Z,"locations",I.value)}else{const ze=await Ls.checkIn(Se),at=T.value.findIndex(Vt=>Vt.id===q.id);at!==-1&&(T.value[at]=ze.data)}}catch(ee){if(un()||!ee.response){const Se={eventId:Z,assignmentId:q.id,latitude:xt.value?.lat||null,longitude:xt.value?.lng||null,manualCheckIn:!0};await Qn("checkin",Se);const ze=T.value.findIndex(at=>at.id===q.id);ze!==-1&&(T.value[ze]={...T.value[ze],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else ee.response?.data?.message?Be.value=ee.response.data.message:ee.message?Be.value=ee.message:Be.value="Failed to check in. Please try manual check-in."}finally{nt.value=null,Le.value=null}},mt=q=>{J.value="Manual Check-In",Ue.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",Qe.value=async()=>{nt.value=q.id,Le.value=q.id,Be.value=null;const Z=s.params.eventId,ee={eventId:Z,assignmentId:q.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(un()){await Qn("checkin",ee);const Se=T.value.findIndex(ze=>ze.id===q.id);Se!==-1&&(T.value[Se]={...T.value[Se],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await Ra(Z,"locations",I.value)}else{const Se=await Ls.checkIn(ee),ze=T.value.findIndex(at=>at.id===q.id);ze!==-1&&(T.value[ze]=Se.data)}}catch(Se){if(un()||!Se.response){await Qn("checkin",ee);const ze=T.value.findIndex(at=>at.id===q.id);ze!==-1&&(T.value[ze]={...T.value[ze],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else Be.value="Failed to check in manually. Please contact the admin."}finally{nt.value=null,Le.value=null}},se.value=!0},$t=()=>{se.value=!1,Qe.value&&(Qe.value(),Qe.value=null)},Rs=()=>{se.value=!1,Qe.value=null},Dn=(q,Z)=>{vt.value=q,Tt.value=Z,ot.value=!0},Ho=()=>{ot.value=!1},ri=async q=>{re.value=!0;try{await eo.create(c.value,q),We.value=!1,zo(),Dn("Incident Reported","An administrator will review it shortly.")}catch(Z){console.error("Failed to report incident:",Z),Dn("Error",Z.response?.data?.message||"Failed to report incident. Please try again.")}finally{re.value=!1}},ct=q=>{H.value=q,Q.value=!0},Et=async({incidentId:q,status:Z})=>{try{await eo.updateStatus(c.value,q,{status:Z});const ee=de.value.find(Se=>Se.incidentId===q);ee&&(ee.status=Z),H.value?.incidentId===q&&(H.value.status=Z)}catch(ee){console.error("Failed to update incident status:",ee),Dn("Error","Failed to update status. Please try again.")}},li=()=>{R.value="",ie.value=!0},Vo=()=>{ie.value=!1,R.value=""},an=async()=>{if(!(!R.value.trim()||!H.value)){W.value=!0;try{await eo.addNote(c.value,H.value.incidentId,R.value.trim()),Vo(),zo();const q=await eo.get(c.value,H.value.incidentId);H.value=q.data}catch(q){console.error("Failed to add note:",q),Dn("Error","Failed to add note. Please try again.")}finally{W.value=!1}}},ci=q=>{F.value=q,N.value=null,te.value=null,Y.value=!0},ao=()=>{Y.value=!1,F.value=null,N.value=null,te.value=null,Nt.value=!1},Nt=E(!1),dt=()=>{Nt.value=!0,Y.value=!1,pe.value="map"},gn=q=>{if(Nt.value&&F.value){ro(F.value.locationId,q.lat,q.lng,"manual"),Nt.value=!1,F.value=null;return}if(Wt.value&&go.value){const Z=go.value;J.value="Update location",Ue.value=`Update ${Z.location?.name||"dynamic checkpoint"} to this location?`,Qe.value=async()=>{await ro(Z.locationId,q.lat,q.lng,"manual")},se.value=!0}},Zn=q=>{if(!Nt.value&&Wt.value&&go.value){const Z=go.value;if(q.id===Z.locationId)return;J.value="Copy location",Ue.value=`Copy location from "${q.name}" to ${Z.location?.name||"your dynamic checkpoint"}?`,Qe.value=async()=>{await ro(Z.locationId,q.latitude,q.longitude,"checkpoint",q.id)},se.value=!0}},ro=async(q,Z,ee,Se,ze=null)=>{ve.value=!0;try{const at=s.params.eventId,Vt={latitude:Z,longitude:ee,sourceType:Se};ze&&(Vt.sourceCheckpointId=ze);const st=await Fn.updatePosition(at,q,Vt);st.data.success&&(xe.value&&Wn(),jn(q,st.data.latitude,st.data.longitude,st.data.lastLocationUpdate))}catch(at){console.error("Failed to update location:",at),at.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{ve.value=!1}},Bs=()=>{Nt.value=!1,Y.value=!0},rs=async()=>{if(F.value){ve.value=!0,N.value=null;try{let q,Z;if(xt.value&&mo.value&&Date.now()-mo.value<3e4&&(q=xt.value.lat,Z=xt.value.lng),!q||!Z){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const at=await new Promise((Vt,st)=>{navigator.geolocation.getCurrentPosition(Vt,st,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});q=at.coords.latitude,Z=at.coords.longitude}const ee=s.params.eventId,Se=F.value.locationId,ze=await Fn.updatePosition(ee,Se,{latitude:q,longitude:Z,sourceType:"gps"});ze.data.success&&(te.value="Location updated successfully!",jn(Se,ze.data.latitude,ze.data.longitude,ze.data.lastLocationUpdate),setTimeout(()=>ao(),1500))}catch(q){console.error("Failed to update location with GPS:",q),q.response?.status===403?N.value="You do not have permission to update this location.":q.code===1?N.value="Location access denied. Please enable location permissions.":q.code===2?N.value="Unable to determine your location. Please try again.":q.code===3||q.message?.includes("Timeout")?N.value="GPS timed out. Please ensure location services are enabled and try again.":N.value="Failed to update location. Please try again."}finally{ve.value=!1}}},rn=async q=>{if(!F.value)return;const Z=I.value.find(ee=>ee.id===q);if(!Z){N.value="Source checkpoint not found.";return}ve.value=!0,N.value=null;try{const ee=s.params.eventId,Se=F.value.locationId,ze=await Fn.updatePosition(ee,Se,{latitude:Z.latitude,longitude:Z.longitude,sourceType:"checkpoint",sourceCheckpointId:q});ze.data.success&&(xe.value&&Wn(),te.value=`Location copied from ${Z.name}!`,jn(Se,ze.data.latitude,ze.data.longitude,ze.data.lastLocationUpdate),setTimeout(()=>ao(),1500))}catch(ee){console.error("Failed to copy location from checkpoint:",ee),ee.response?.status===403?N.value="You do not have permission to update this location.":N.value="Failed to update location. Please try again."}finally{ve.value=!1}},jn=(q,Z,ee,Se)=>{const ze=I.value.find(at=>at.id===q);ze&&(ze.latitude=Z,ze.longitude=ee,ze.lastLocationUpdate=Se)},qn=q=>{xe.value?Wn():Go(q)},Go=q=>{xe.value=!0,Kn(q),we=setInterval(()=>{Kn(q)},6e4)},Wn=()=>{xe.value=!1,we&&(clearInterval(we),we=null)},Kn=async q=>{if(!(!q||!("geolocation"in navigator)))try{const Z=await new Promise((ze,at)=>{navigator.geolocation.getCurrentPosition(ze,at,{enableHighAccuracy:!0,timeout:15e3})}),ee=s.params.eventId,Se=q.locationId;await Fn.updatePosition(ee,Se,{latitude:Z.coords.latitude,longitude:Z.coords.longitude,sourceType:"gps"}),jn(Se,Z.coords.latitude,Z.coords.longitude,new Date().toISOString())}catch(Z){console.warn("Auto-update location failed:",Z)}},ls=()=>{Ve||!I.value.some(Z=>Z.isDynamic||Z.IsDynamic)||(Ve=setInterval(async()=>{try{const Z=s.params.eventId,ee=await Fn.getDynamicCheckpoints(Z);if(ee.data&&Array.isArray(ee.data))for(const Se of ee.data){const ze=I.value.find(at=>at.id===Se.checkpointId);ze&&(ze.latitude=Se.latitude,ze.longitude=Se.longitude,ze.lastLocationUpdate=Se.lastLocationUpdate)}}catch(Z){console.warn("Failed to poll dynamic checkpoints:",Z)}},6e4))},Ns=()=>{Ve&&(clearInterval(Ve),Ve=null)},Fi=q=>q?.isDynamic===!0||q?.IsDynamic===!0,lt=async()=>{try{await ts.logout()}catch{}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${s.params.eventId}`),u.value=!1,f.value=null,g.value=null,T.value=[],Ge.value=[],Xt.value=[],a.push("/")},yn=()=>{J.value="Logout",Ue.value=`Are you sure you want to logout${f.value?.name?`, ${f.value.name}`:""}?`,Qe.value=lt,se.value=!0},kt=q=>q?new Date(q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Zo=q=>q?new Date(q).toLocaleString():"",ui=(q,Z)=>{if(!q&&!Z)return"";const ee=q?kt(q):"?",Se=Z?kt(Z):"?";return`${ee} - ${Se}`},di=q=>q?new Date(q).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",cs=q=>q?new Date(q).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",ko=q=>q?q.replace(/([A-Z])/g," $1").replace(/^./,Z=>Z.toUpperCase()).trim():"",hi=q=>{if(!q)return"";const Z=q.resolvedStyleType||q.ResolvedStyleType,ee=q.resolvedStyleBackgroundColor||q.ResolvedStyleBackgroundColor||q.resolvedStyleColor||q.ResolvedStyleColor,Se=q.resolvedStyleBorderColor||q.ResolvedStyleBorderColor,ze=q.resolvedStyleIconColor||q.ResolvedStyleIconColor,at=q.resolvedStyleBackgroundShape||q.ResolvedStyleBackgroundShape;return Z&&Z!=="default"||ee||Se||ze||at&&at!=="circle"?en({type:Z||"circle",backgroundShape:at||"circle",backgroundColor:ee||"#667eea",borderColor:Se||"#ffffff",iconColor:ze||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};Yt(async()=>{const q=s.params.eventId,Z=s.query.code;V.value=!0;try{Z?await Fo(q,Z):await ii(q)&&await mn()}finally{V.value=!1}u.value&&(Os(),"requestIdleCallback"in window?requestIdleCallback(()=>{is()},{timeout:5e3}):setTimeout(()=>{is()},2e3))}),je(u,q=>{q?Os():ai()}),je(()=>s.query.code,async q=>{if(q&&u.value){V.value=!0;try{await Fo(s.params.eventId,q)}finally{V.value=!1}}}),je(A,q=>{q&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0});let Yn=null;const Ft=()=>{Yn||(Yn=setInterval(async()=>{if(_.value?.marshalId)try{await ts.getMe(s.params.eventId)}catch(q){console.debug("Heartbeat failed:",q)}},300*1e3))},bo=()=>{Yn&&(clearInterval(Yn),Yn=null)};return vo(()=>{ai(),bo(),Wn(),Ns()}),(q,Z)=>(v(),y("div",{class:"marshal-view",style:it(z.value)},[Re(OR),l("header",{class:fe(["header",`logo-${Ce.value}`]),style:it(ae.value)},[Ae.value&&Ce.value==="cover"?(v(),y("div",RR,[l("img",{src:Ae.value,alt:"Event logo",class:"header-logo-cover-img"},null,8,BR)])):D("",!0),u.value&&Ce.value==="right"?(v(),y("button",{key:1,onClick:yn,class:"btn-logout-icon btn-logout-left",style:it({color:j.value}),title:`Logout ${f.value?.name||""}`},[l("span",{innerHTML:G(cn)("logout")},null,8,FR)],12,NR)):D("",!0),Ae.value&&Ce.value==="left"?(v(),y("div",UR,[l("img",{src:Ae.value,alt:"Event logo",class:"header-logo-img"},null,8,zR)])):D("",!0),l("div",HR,[l("div",{class:"header-title",style:it({color:j.value})},[A.value?(v(),y("h1",VR,k(A.value.name),1)):D("",!0),A.value?.eventDate?(v(),y("div",GR,k(cs(A.value.eventDate)),1)):D("",!0)],4),u.value?(v(),y("div",ZR,[l("button",{onClick:Z[0]||(Z[0]=ee=>We.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),l("button",{onClick:Z[1]||(Z[1]=ee=>Ze.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")])):D("",!0)]),Ae.value&&Ce.value==="right"?(v(),y("div",jR,[l("img",{src:Ae.value,alt:"Event logo",class:"header-logo-img"},null,8,qR)])):D("",!0),u.value&&Ce.value!=="right"?(v(),y("button",{key:4,onClick:yn,class:"btn-logout-icon btn-logout-right",style:it({color:j.value}),title:`Logout ${f.value?.name||""}`},[l("span",{innerHTML:G(cn)("logout")},null,8,KR)],12,WR)):D("",!0)],6),l("div",YR,[V.value?(v(),y("div",JR,[...Z[22]||(Z[22]=[l("div",{class:"loading"},"Loading...",-1)])])):!u.value&&!p.value?(v(),y("div",XR,[Z[23]||(Z[23]=l("h2",null,"Welcome",-1)),Z[24]||(Z[24]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),d.value?(v(),y("p",QR,"Authenticating...")):D("",!0)])):p.value?(v(),y("div",eB,[Z[25]||(Z[25]=l("h2",null,"Login failed",-1)),l("p",tB,k(p.value),1),Z[26]||(Z[26]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),y("div",nB,[P.value||M.value?(v(),y("div",oB,[l("div",sB,[f.value?.email?(v(),y("span",iB,k(f.value.email),1)):D("",!0)]),P.value?(v(),y("div",aB,[l("button",{onClick:S,class:"btn-mode-switch"}," Switch to Admin ")])):M.value?(v(),y("div",rB,[...Z[27]||(Z[27]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):D("",!0)])):D("",!0),l("div",lB,[l("div",cB,[l("button",{class:fe(["accordion-header",{active:pe.value==="map"}]),onClick:Z[2]||(Z[2]=ee=>Ot("map"))},[l("span",uB,[l("span",{class:"section-icon",innerHTML:G(cn)("course")},null,8,dB),He(" "+k(G(t).course)+" ",1),xt.value?(v(),y("span",hB,"GPS Active")):(v(),y("span",fB,"GPS Inactive"))]),l("span",pB,k(pe.value==="map"?"":"+"),1)],2),pe.value==="map"?(v(),y("div",vB,[Nt.value?(v(),y("div",mB,[l("span",null,[Z[28]||(Z[28]=He("Click on the map to set the new location for ",-1)),l("strong",null,k(F.value?.location?.name),1)]),l("button",{onClick:Bs,class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),l("div",gB,[Re(xs,{locations:I.value,route:Je.value,center:yo.value,zoom:15,"user-location":xt.value,"highlight-location-ids":Ro.value,"marshal-mode":!0,clickable:Nt.value||Wt.value,class:fe({"selecting-location":Nt.value}),onMapClick:gn,onLocationClick:Zn},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"]),l("button",{class:"fullscreen-btn",onClick:Z[3]||(Z[3]=ee=>No("course")),title:"Full screen"},[...Z[29]||(Z[29]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},[l("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])])])])):D("",!0)]),l("div",yB,[l("button",{class:fe(["accordion-header",{active:pe.value==="assignments"}]),onClick:Z[4]||(Z[4]=ee=>Ot("assignments"))},[l("span",_B,[l("span",{class:"section-icon",innerHTML:G(cn)("checkpoint")},null,8,kB),He(" Your "+k(G(o).checkpoints)+" ("+k(T.value.length)+") ",1)]),l("span",bB,k(pe.value==="assignments"?"":"+"),1)],2),pe.value==="assignments"?(v(),y("div",wB,[T.value.length===0?(v(),y("div",CB,[l("p",null,"You don't have any "+k(G(o).checkpoint)+" assignments yet.",1)])):(v(),y("div",LB,[(v(!0),y(be,null,Oe(sn.value,ee=>(v(),y("div",{key:ee.id,class:"checkpoint-accordion-section"},[l("button",{class:fe(["checkpoint-accordion-header",{active:In.value===ee.id,"checked-in":ee.effectiveIsCheckedIn}]),onClick:Se=>Ni(ee.id)},[l("div",xB,[l("div",$B,[l("span",{class:"checkpoint-icon",innerHTML:hi(ee.location)},null,8,IB),ee.effectiveIsCheckedIn?(v(),y("span",TB,"")):D("",!0),l("span",MB,k(ee.location?.name||ee.locationName),1),ee.areaName?(v(),y("span",AB,k(ee.areaName),1)):D("",!0),ee.location?.startTime||ee.location?.endTime?(v(),y("span",EB,k(ui(ee.location.startTime,ee.location.endTime)),1)):D("",!0)]),ee.location?.description?(v(),y("div",PB,k(ee.location.description),1)):D("",!0)]),l("span",DB,k(In.value===ee.id?"":"+"),1)],10,SB),In.value===ee.id?(v(),y("div",OB,[ee.location?(v(),y("div",RB,[Re(xs,{locations:I.value,route:Je.value,center:{lat:ee.location.latitude,lng:ee.location.longitude},zoom:16,"user-location":xt.value,"highlight-location-id":ee.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:Wt.value,onMapClick:gn,onLocationClick:Zn},null,8,["locations","route","center","user-location","highlight-location-id","clickable"]),l("button",{class:"fullscreen-btn",onClick:Se=>No(ee.id,ee),title:"Full screen"},[...Z[30]||(Z[30]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])],8,BB)])):D("",!0),l("div",NB,[l("div",FB,k(G(t).people)+":",1),l("div",UB,[(v(!0),y(be,null,Oe(ee.allMarshals,Se=>(v(),y("span",{key:Se.marshalId,class:fe(["marshal-tag",{"is-you":Se.marshalId===g.value,"checked-in":Se.effectiveIsCheckedIn}])},[He(k(Se.marshalName)+k(Se.marshalId===g.value?" (you)":"")+" ",1),Se.effectiveIsCheckedIn?(v(),y("span",zB,"")):D("",!0)],2))),128))])]),ee.areaContacts.length>0?(v(),y("div",HB,[l("div",VB,k(G(t).area)+" contacts:",1),l("div",GB,[(v(!0),y(be,null,Oe(ee.areaContacts,Se=>(v(),y("div",{key:Se.marshalId,class:"contact-item"},[l("div",ZB,[l("div",jB,k(Se.marshalName),1),Se.role?(v(),y("div",qB,k(Se.role),1)):D("",!0),Se.phone?(v(),y("div",WB,k(Se.phone),1)):D("",!0),Se.email?(v(),y("div",KB,k(Se.email),1)):D("",!0)]),l("div",YB,[Se.phone?(v(),y("a",{key:0,href:`tel:${Se.phone}`,class:"contact-link"},[...Z[31]||(Z[31]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),He(" Call ",-1)])],8,JB)):D("",!0),Se.phone?(v(),y("a",{key:1,href:`sms:${Se.phone}`,class:"contact-link"},[...Z[32]||(Z[32]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),He(" Text ",-1)])],8,XB)):D("",!0),Se.email?(v(),y("a",{key:2,href:`mailto:${Se.email}`,class:"contact-link"},[...Z[33]||(Z[33]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),He(" Email ",-1)])],8,QB)):D("",!0)])]))),128))])])):D("",!0),ee.effectiveIsCheckedIn?(v(),y("div",eN,[Z[35]||(Z[35]=l("span",{class:"check-icon"},"",-1)),l("div",null,[Z[34]||(Z[34]=l("strong",null,"Checked In",-1)),l("p",tN,k(kt(ee.checkInTime)),1)])])):(v(),y("div",nN,[l("button",{onClick:Se=>as(ee),class:"btn btn-primary",disabled:nt.value===ee.id,style:it(Te.value)},k(nt.value===ee.id?"Checking in...":"GPS Check-In"),13,oN),l("button",{onClick:Se=>mt(ee),class:"btn btn-secondary",disabled:nt.value===ee.id}," Manual ",8,sN)])),Be.value&&Le.value===ee.id?(v(),y("div",iN,k(Be.value),1)):D("",!0),Fi(ee.location)?(v(),y("div",aN,[l("div",rN,[l("span",lN,"Dynamic "+k(ee.location.resolvedCheckpointTerm||G(t).checkpoint),1),ee.location.lastLocationUpdate?(v(),y("span",cN," Last updated: "+k(Zo(ee.location.lastLocationUpdate)),1)):D("",!0)]),l("div",uN,[l("button",{onClick:Se=>ci(ee),class:"btn btn-update-location",disabled:ve.value},[...Z[36]||(Z[36]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),He(" Update location ",-1)])],8,dN),l("button",{onClick:Se=>qn(ee),class:fe(["btn btn-auto-update",{active:xe.value}]),title:xe.value?"Stop auto-updating":"Auto-update every 60 seconds"},[Z[37]||(Z[37]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),He(" "+k(xe.value?"Stop":"Auto"),1)],10,hN)])])):D("",!0)])):D("",!0)]))),128))]))])):D("",!0)]),l("div",fN,[l("button",{class:fe(["accordion-header",{active:pe.value==="checklist"}]),onClick:Z[5]||(Z[5]=ee=>Ot("checklist"))},[l("span",pN,[l("span",{class:"section-icon",innerHTML:G(cn)("checklist")},null,8,vN),He(" Your "+k(G(o).checklists)+" ("+k(Ps.value)+" of "+k(io.value.length)+" complete) ",1)]),l("span",mN,k(pe.value==="checklist"?"":"+"),1)],2),pe.value==="checklist"?(v(),y("div",gN,[ue.value?(v(),y("div",yN,"Loading checklist...")):Pe.value?(v(),y("div",_N,k(Pe.value),1)):io.value.length===0?(v(),y("div",kN,[l("p",null,"No "+k(G(o).checklists)+" for you.",1)])):(v(),y("div",bN,[(v(!0),y(be,null,Oe(io.value,ee=>(v(),y("div",{key:`${ee.itemId}_${ee.completionContextType}_${ee.completionContextId}`,class:fe(["checklist-item",{"item-completed":ee.isCompleted}])},[l("div",wN,[l("input",{type:"checkbox",checked:ee.isCompleted,disabled:!ee.canBeCompletedByMe||Ee.value,onChange:Se=>_o(ee)},null,40,CN)]),l("div",LN,[l("div",{class:fe(["item-text",{"text-completed":ee.isCompleted}])},k(ee.text),3),Gn(ee)?(v(),y("div",SN,k(Gn(ee)),1)):D("",!0),ee.isCompleted?(v(),y("div",xN,[l("span",$N," Completed by "+k(ee.completedByActorName||"Unknown"),1),l("span",IN,k(Zo(ee.completedAt)),1)])):D("",!0)])],2))),128))]))])):D("",!0)]),An.value.length>0||Mn.value?(v(),y("div",TN,[l("button",{class:fe(["accordion-header",{active:pe.value==="eventContacts"}]),onClick:Z[6]||(Z[6]=ee=>Ot("eventContacts"))},[l("span",MN,[l("span",{class:"section-icon",innerHTML:G(cn)("contacts")},null,8,AN),He(" Your contacts ("+k(An.value.length)+") ",1)]),l("span",EN,k(pe.value==="eventContacts"?"":"+"),1)],2),pe.value==="eventContacts"?(v(),y("div",PN,[Mn.value?(v(),y("div",DN,"Loading contacts...")):(v(),y("div",ON,[(v(!0),y(be,null,Oe(An.value,ee=>(v(),y("div",{key:ee.contactId,class:fe(["contact-item",{"primary-contact":ee.isPrimary}])},[l("div",RN,[l("div",BN,[ee.isPrimary?(v(),y("span",NN,"")):D("",!0),l("span",FN,k(ee.name),1),ee.role?(v(),y("span",UN,k(ko(ee.role)),1)):D("",!0)]),ee.notes?(v(),y("div",zN,k(ee.notes),1)):D("",!0),ee.phone?(v(),y("div",HN,k(ee.phone),1)):D("",!0),ee.email?(v(),y("div",VN,k(ee.email),1)):D("",!0)]),l("div",GN,[ee.phone?(v(),y("a",{key:0,href:`tel:${ee.phone}`,class:"contact-link"},[...Z[38]||(Z[38]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),He(" Call ",-1)])],8,ZN)):D("",!0),ee.phone?(v(),y("a",{key:1,href:`sms:${ee.phone}`,class:"contact-link"},[...Z[39]||(Z[39]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),He(" Text ",-1)])],8,jN)):D("",!0),ee.email?(v(),y("a",{key:2,href:`mailto:${ee.email}`,class:"contact-link"},[...Z[40]||(Z[40]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),He(" Email ",-1)])],8,qN)):D("",!0)])],2))),128))]))])):D("",!0)])):D("",!0),l("div",WN,[l("button",{class:fe(["accordion-header",{active:pe.value==="notes"}]),onClick:Z[7]||(Z[7]=ee=>Ot("notes"))},[l("span",KN,[l("span",{class:"section-icon",innerHTML:G(cn)("notes")},null,8,YN),He(" Your notes ("+k(Me.value.length)+") ",1)]),l("span",JN,k(pe.value==="notes"?"":"+"),1)],2),pe.value==="notes"?(v(),y("div",XN,[Re(zl,{"event-id":G(s).params.eventId,"all-notes":Me.value,locations:I.value,areas:C.value,assignments:T.value,"show-scope":!1,onNotesChanged:Uo},null,8,["event-id","all-notes","locations","areas","assignments"])])):D("",!0)]),de.value.length>0||ke.value?(v(),y("div",QN,[l("button",{class:fe(["accordion-header",{active:pe.value==="incidents"}]),onClick:Z[8]||(Z[8]=ee=>Ot("incidents"))},[l("span",e7,[l("span",{class:"section-icon",innerHTML:G(cn)("incidents")},null,8,t7),He(" Your incidents ("+k(de.value.length)+") ",1),oe.value>0?(v(),y("span",n7,k(oe.value)+" open ",1)):D("",!0)]),l("span",o7,k(pe.value==="incidents"?"":"+"),1)],2),pe.value==="incidents"?(v(),y("div",s7,[ke.value?(v(),y("div",i7," Loading incidents... ")):de.value.length===0?(v(),y("div",a7,[...Z[41]||(Z[41]=[l("p",null,"No incidents to show.",-1)])])):(v(),y("div",r7,[(v(!0),y(be,null,Oe(de.value,ee=>(v(),Xe(ma,{key:ee.incidentId,incident:ee,onSelect:Se=>ct(ee)},null,8,["incident","onSelect"]))),128))]))])):D("",!0)])):D("",!0),x.value?(v(),y("div",l7,[l("button",{class:fe(["accordion-header",{active:pe.value==="areaLead"}]),onClick:Z[9]||(Z[9]=ee=>Ot("areaLead"))},[l("span",c7,[l("span",{class:"section-icon",innerHTML:G(cn)("people")},null,8,u7),He(" Your "+k(G(o).people)+" ",1),$e.value?.areas?.length>0?(v(),y("span",d7,[(v(!0),y(be,null,Oe($e.value.areas,ee=>(v(),y("span",{key:ee.areaId,class:"area-lead-badge",style:it({backgroundColor:ee.color||"#667eea"})},k(ee.name),5))),128))])):D("",!0)]),l("span",h7,k(pe.value==="areaLead"?"":"+"),1)],2),pe.value==="areaLead"?(v(),y("div",f7,[Re(xR,{ref_key:"areaLeadRef",ref:$e,"event-id":G(s).params.eventId,"area-ids":b.value,"marshal-id":g.value,route:Je.value,onChecklistUpdated:Pn},null,8,["event-id","area-ids","marshal-id","route"])])):D("",!0)])):D("",!0),A.value?.eventDate||A.value?.description?(v(),y("div",p7,[l("button",{class:fe(["accordion-header",{active:pe.value==="eventDetails"}]),onClick:Z[10]||(Z[10]=ee=>Ot("eventDetails"))},[l("span",v7,[l("span",{class:"section-icon",innerHTML:G(cn)("event")},null,8,m7),Z[42]||(Z[42]=He(" Event details ",-1))]),l("span",g7,k(pe.value==="eventDetails"?"":"+"),1)],2),pe.value==="eventDetails"?(v(),y("div",y7,[l("div",_7,[A.value.eventDate?(v(),y("div",k7,[Z[43]||(Z[43]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",b7,k(di(A.value.eventDate)),1)])):D("",!0),A.value.description?(v(),y("div",w7,[Z[44]||(Z[44]=l("span",{class:"detail-label"},"Description",-1)),l("p",C7,k(A.value.description),1)])):D("",!0)])])):D("",!0)])):D("",!0)])]))]),Re(s8,{show:Ze.value,contacts:Vn.value,notes:Ds.value,onClose:Z[11]||(Z[11]=ee=>Ze.value=!1)},null,8,["show","contacts","notes"]),Re(uv,{show:We.value,"event-id":c.value||"",checkpoint:$.value,"initial-location":xt.value,checkpoints:I.value,route:Je.value,onClose:Z[12]||(Z[12]=ee=>We.value=!1),onSubmit:ri},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route"]),Re(Du,{show:Q.value,incident:H.value,route:Je.value,checkpoints:I.value,"can-manage":x.value,onClose:Z[13]||(Z[13]=ee=>Q.value=!1),onStatusChange:Et,onOpenAddNote:li},null,8,["show","incident","route","checkpoints","can-manage"]),Re(Pt,{show:ie.value,title:"Add update",size:"small",onClose:Vo},{footer:qe(()=>[l("div",S7,[l("button",{type:"button",class:"btn btn-secondary",onClick:Vo}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:an,disabled:!R.value.trim()||W.value},k(W.value?"Adding...":"Add update"),9,x7)])]),default:qe(()=>[l("div",L7,[Ne(l("textarea",{"onUpdate:modelValue":Z[14]||(Z[14]=ee=>R.value=ee),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[et,R.value]])])]),_:1},8,["show"]),Re(ar,{show:se.value,title:J.value,message:Ue.value,onConfirm:$t,onCancel:Rs},null,8,["show","title","message"]),Re(ar,{show:ot.value,title:vt.value,message:Tt.value,"show-cancel":!1,onConfirm:Ho},null,8,["show","title","message"]),Jt.value&&gt.value?(v(),y("div",{key:0,class:"modal-overlay",onClick:Z[18]||(Z[18]=ft(ee=>Bo(gt.value.id),["self"]))},[l("div",$7,[l("div",I7,[Z[45]||(Z[45]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:Z[15]||(Z[15]=ee=>Bo(gt.value.id))},"")]),l("div",T7,[Z[47]||(Z[47]=l("div",{class:"reminder-icon"},"",-1)),l("p",M7,[He(" You have not checked in yet to "+k(G(t).checkpoint.toLowerCase())+" ",1),l("strong",null,k(gt.value.location?.name),1),gt.value.location?.description?(v(),y("span",A7," - "+k(gt.value.location.description),1)):D("",!0),Z[46]||(Z[46]=He(". ",-1))]),l("p",E7," Please check in when you arrive at your "+k(G(t).checkpoint.toLowerCase())+". ",1)]),l("div",P7,[l("button",{onClick:Z[16]||(Z[16]=ee=>Bo(gt.value.id)),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:Z[17]||(Z[17]=ee=>{Bo(gt.value.id),pe.value="assignments",In.value=gt.value.id}),class:"btn btn-primary",style:it(Te.value)}," Go to "+k(G(t).checkpoint),5)])])])):D("",!0),Y.value?(v(),y("div",{key:1,class:"modal-overlay",onClick:ft(ao,["self"])},[l("div",D7,[l("div",O7,[l("h3",null,"Update "+k((F.value?.location?.resolvedCheckpointTerm||G(t).checkpoint).toLowerCase())+" location",1),l("button",{class:"modal-close",onClick:ao},"")]),l("div",R7,[te.value?(v(),y("div",B7,k(te.value),1)):(v(),y("div",N7,[l("p",F7,[Z[48]||(Z[48]=He(" Update the position of ",-1)),l("strong",null,k(F.value?.location?.name),1)]),F.value?.location?.lastLocationUpdate?(v(),y("div",U7," Last updated: "+k(Zo(F.value.location.lastLocationUpdate)),1)):D("",!0),xt.value?(v(),y("div",z7,[...Z[49]||(Z[49]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),He(" GPS active ",-1)])])):D("",!0),l("div",H7,[l("button",{onClick:rs,class:"btn btn-primary btn-full",disabled:ve.value,style:it(Te.value)},[Z[50]||(Z[50]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),He(" "+k(ve.value?"Updating...":"Use current GPS location"),1)],12,V7)]),l("div",G7,[l("label",Z7,[l("input",{type:"checkbox",checked:xe.value,onChange:Z[19]||(Z[19]=ee=>qn(F.value))},null,40,j7),Z[51]||(Z[51]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",q7,"Automatically updates the "+k(G(o).checkpoint)+" location using your GPS every minute.",1)]),l("div",W7,[l("button",{onClick:dt,class:"btn btn-secondary btn-full",disabled:ve.value},[...Z[52]||(Z[52]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),He(" Select location on map ",-1)])],8,K7)]),l("div",Y7,[l("label",J7,"Or copy location from another "+k(G(o).checkpoint)+":",1),nn.value.length>0?(v(),y("div",X7,[(v(!0),y(be,null,Oe(nn.value,ee=>(v(),y("button",{key:ee.id,onClick:Se=>rn(ee.id),class:"btn btn-secondary btn-checkpoint-source",disabled:ve.value},k(ee.name),9,Q7))),128))])):(v(),y("p",eF," No other "+k(G(o).checkpoints)+" available to copy from. ",1))]),N.value?(v(),y("div",tF,k(N.value),1)):D("",!0)]))]),l("div",{class:"modal-footer"},[l("button",{onClick:ao,class:"btn btn-secondary"}," Cancel ")])])])):D("",!0),Dt.value?(v(),y("div",nF,[l("div",{class:"fullscreen-map-header",style:it(ae.value)},[l("div",{class:"fullscreen-map-title",style:it({color:j.value})},[Dt.value==="course"?(v(),y(be,{key:0},[He(k(G(t).course),1)],64)):_t.value?(v(),y(be,{key:1},[He(k(_t.value.location?.name),1)],64)):D("",!0)],4),l("button",{class:"fullscreen-close-btn",style:it({color:j.value}),onClick:Zt},[...Z[53]||(Z[53]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24"},[l("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])],4)],4),Nt.value?(v(),y("div",oF,[l("span",null,[Z[54]||(Z[54]=He("Click on the map to set the new location for ",-1)),l("strong",null,k(F.value?.location?.name),1)]),l("button",{onClick:Bs,class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),Dt.value==="course"?(v(),y("div",sF,[Re(xs,{locations:I.value,route:Je.value,center:yo.value,zoom:15,"user-location":xt.value,"highlight-location-ids":Ro.value,"marshal-mode":!0,clickable:Nt.value||Wt.value,class:fe({"selecting-location":Nt.value}),onMapClick:gn,onLocationClick:Zn},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"])])):_t.value?.location?(v(),y("div",iF,[Re(xs,{locations:I.value,route:Je.value,center:{lat:_t.value.location.latitude,lng:_t.value.location.longitude},zoom:16,"user-location":xt.value,"highlight-location-id":_t.value.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:Wt.value,onMapClick:gn,onLocationClick:Zn},null,8,["locations","route","center","user-location","highlight-location-id","clickable"])])):D("",!0),_t.value?.location?.isDynamic||Dt.value==="course"&&Wt.value?(v(),y("div",aF,[_t.value?(v(),y("button",{key:0,class:"btn btn-primary",style:it(Te.value),onClick:Z[20]||(Z[20]=ee=>ci(_t.value))}," Update Location ",4)):go.value?(v(),y("button",{key:1,class:"btn btn-primary",style:it(Te.value),onClick:Z[21]||(Z[21]=ee=>ci(go.value))}," Update "+k(go.value.location?.name)+" Location ",5)):D("",!0)])):D("",!0)])):D("",!0)],4))}},cF=Ke(lF,[["__scopeId","data-v-db5a5533"]]),uF=[{path:"/",name:"Home",component:xk},{path:"/admin/login",name:"AdminLogin",component:Dk},{path:"/admin/verify",name:"AdminVerify",component:zk},{path:"/admin/dashboard",name:"AdminDashboard",component:Vb,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:v0,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:UO,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:cF},{path:"/:pathMatch(.*)*",redirect:"/"}],dv=b_({history:Qy("/VolunteerCheckin/testing/"),routes:uF});dv.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});Es().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Ru=oy(py);Ru.use(ay());Ru.use(dv);Ru.mount("#app");
