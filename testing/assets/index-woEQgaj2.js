(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();function Du(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Gt={},Oi=[],Yo=()=>{},yf=()=>!1,qr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Ou=e=>e.startsWith("onUpdate:"),gn=Object.assign,Ru=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},ym=Object.prototype.hasOwnProperty,Dt=(e,t)=>ym.call(e,t),lt=Array.isArray,Ri=e=>Hl(e)==="[object Map]",ji=e=>Hl(e)==="[object Set]",$d=e=>Hl(e)==="[object Date]",pt=e=>typeof e=="function",en=e=>typeof e=="string",Qo=e=>typeof e=="symbol",Ft=e=>e!==null&&typeof e=="object",kf=e=>(Ft(e)||pt(e))&&pt(e.then)&&pt(e.catch),_f=Object.prototype.toString,Hl=e=>_f.call(e),km=e=>Hl(e).slice(8,-1),bf=e=>Hl(e)==="[object Object]",Kr=e=>en(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,kl=Du(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Jr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},_m=/-\w/g,Ro=Jr(e=>e.replace(_m,t=>t.slice(1).toUpperCase())),bm=/\B([A-Z])/g,Ta=Jr(e=>e.replace(bm,"-$1").toLowerCase()),Yr=Jr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ac=Jr(e=>e?`on${Yr(e)}`:""),Ca=(e,t)=>!Object.is(e,t),gr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},wf=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},Xr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},wm=e=>{const t=en(e)?Number(e):NaN;return isNaN(t)?e:t};let Td;const Qr=()=>Td||(Td=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function et(e){if(lt(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],s=en(a)?xm(a):et(a);if(s)for(const i in s)t[i]=s[i]}return t}else if(en(e)||Ft(e))return e}const Cm=/;(?![^(]*\))/g,Lm=/:([^]+)/,Sm=/\/\*[^]*?\*\//g;function xm(e){const t={};return e.replace(Sm,"").split(Cm).forEach(o=>{if(o){const a=o.split(Lm);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ve(e){let t="";if(en(e))t=e;else if(lt(e))for(let o=0;o<e.length;o++){const a=ve(e[o]);a&&(t+=a+" ")}else if(Ft(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Im="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",$m=Du(Im);function Cf(e){return!!e||e===""}function Tm(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=si(e[a],t[a]);return o}function si(e,t){if(e===t)return!0;let o=$d(e),a=$d(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=Qo(e),a=Qo(t),o||a)return e===t;if(o=lt(e),a=lt(t),o||a)return o&&a?Tm(e,t):!1;if(o=Ft(e),a=Ft(t),o||a){if(!o||!a)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const r in e){const u=e.hasOwnProperty(r),d=t.hasOwnProperty(r);if(u&&!d||!u&&d||!si(e[r],t[r]))return!1}}return String(e)===String(t)}function Bu(e,t){return e.findIndex(o=>si(o,t))}const Lf=e=>!!(e&&e.__v_isRef===!0),w=e=>en(e)?e:e==null?"":lt(e)||Ft(e)&&(e.toString===_f||!pt(e.toString))?Lf(e)?w(e.value):JSON.stringify(e,Sf,2):String(e),Sf=(e,t)=>Lf(t)?Sf(e,t.value):Ri(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,s],i)=>(o[Ec(a,i)+" =>"]=s,o),{})}:ji(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Ec(o))}:Qo(t)?Ec(t):Ft(t)&&!lt(t)&&!bf(t)?String(t):t,Ec=(e,t="")=>{var o;return Qo(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function Mm(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Pn;class xf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Pn,!t&&Pn&&(this.index=(Pn.scopes||(Pn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Pn;try{return Pn=this,t()}finally{Pn=o}}}on(){++this._on===1&&(this.prevScope=Pn,Pn=this)}off(){this._on>0&&--this._on===0&&(Pn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function If(e){return new xf(e)}function $f(){return Pn}function Am(e,t=!1){Pn&&Pn.cleanups.push(e)}let Wt;const Pc=new WeakSet;class Tf{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Pn&&Pn.active&&Pn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Pc.has(this)&&(Pc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Af(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Md(this),Ef(this);const t=Wt,o=Xo;Wt=this,Xo=!0;try{return this.fn()}finally{Pf(this),Wt=t,Xo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Uu(t);this.deps=this.depsTail=void 0,Md(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Pc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){eu(this)&&this.run()}get dirty(){return eu(this)}}let Mf=0,_l,bl;function Af(e,t=!1){if(e.flags|=8,t){e.next=bl,bl=e;return}e.next=_l,_l=e}function Nu(){Mf++}function Fu(){if(--Mf>0)return;if(bl){let t=bl;for(bl=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;_l;){let t=_l;for(_l=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Ef(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Pf(e){let t,o=e.depsTail,a=o;for(;a;){const s=a.prevDep;a.version===-1?(a===o&&(o=s),Uu(a),Em(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=s}e.deps=t,e.depsTail=o}function eu(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Df(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Df(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Ml)||(e.globalVersion=Ml,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!eu(e))))return;e.flags|=2;const t=e.dep,o=Wt,a=Xo;Wt=e,Xo=!0;try{Ef(e);const s=e.fn(e._value);(t.version===0||Ca(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Wt=o,Xo=a,Pf(e),e.flags&=-3}}function Uu(e,t=!1){const{dep:o,prevSub:a,nextSub:s}=e;if(a&&(a.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)Uu(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Em(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Xo=!0;const Of=[];function zs(){Of.push(Xo),Xo=!1}function Hs(){const e=Of.pop();Xo=e===void 0?!0:e}function Md(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Wt;Wt=void 0;try{t()}finally{Wt=o}}}let Ml=0;class Pm{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class zu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Wt||!Xo||Wt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Wt)o=this.activeLink=new Pm(Wt,this),Wt.deps?(o.prevDep=Wt.depsTail,Wt.depsTail.nextDep=o,Wt.depsTail=o):Wt.deps=Wt.depsTail=o,Rf(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Wt.depsTail,o.nextDep=void 0,Wt.depsTail.nextDep=o,Wt.depsTail=o,Wt.deps===o&&(Wt.deps=a)}return o}trigger(t){this.version++,Ml++,this.notify(t)}notify(t){Nu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Fu()}}}function Rf(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Rf(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const xr=new WeakMap,ei=Symbol(""),tu=Symbol(""),Al=Symbol("");function On(e,t,o){if(Xo&&Wt){let a=xr.get(e);a||xr.set(e,a=new Map);let s=a.get(o);s||(a.set(o,s=new zu),s.map=a,s.key=o),s.track()}}function Ds(e,t,o,a,s,i){const r=xr.get(e);if(!r){Ml++;return}const u=d=>{d&&d.trigger()};if(Nu(),t==="clear")r.forEach(u);else{const d=lt(e),f=d&&Kr(o);if(d&&o==="length"){const p=Number(a);r.forEach((g,y)=>{(y==="length"||y===Al||!Qo(y)&&y>=p)&&u(g)})}else switch((o!==void 0||r.has(void 0))&&u(r.get(o)),f&&u(r.get(Al)),t){case"add":d?f&&u(r.get("length")):(u(r.get(ei)),Ri(e)&&u(r.get(tu)));break;case"delete":d||(u(r.get(ei)),Ri(e)&&u(r.get(tu)));break;case"set":Ri(e)&&u(r.get(ei));break}}Fu()}function Dm(e,t){const o=xr.get(e);return o&&o.get(t)}function $i(e){const t=Mt(e);return t===e?t:(On(t,"iterate",Al),wo(e)?t:t.map(es))}function ec(e){return On(e=Mt(e),"iterate",Al),e}function va(e,t){return Vs(e)?Us(e)?Ui(es(t)):Ui(t):es(t)}const Om={__proto__:null,[Symbol.iterator](){return Dc(this,Symbol.iterator,e=>va(this,e))},concat(...e){return $i(this).concat(...e.map(t=>lt(t)?$i(t):t))},entries(){return Dc(this,"entries",e=>(e[1]=va(this,e[1]),e))},every(e,t){return $s(this,"every",e,t,void 0,arguments)},filter(e,t){return $s(this,"filter",e,t,o=>o.map(a=>va(this,a)),arguments)},find(e,t){return $s(this,"find",e,t,o=>va(this,o),arguments)},findIndex(e,t){return $s(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return $s(this,"findLast",e,t,o=>va(this,o),arguments)},findLastIndex(e,t){return $s(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return $s(this,"forEach",e,t,void 0,arguments)},includes(...e){return Oc(this,"includes",e)},indexOf(...e){return Oc(this,"indexOf",e)},join(e){return $i(this).join(e)},lastIndexOf(...e){return Oc(this,"lastIndexOf",e)},map(e,t){return $s(this,"map",e,t,void 0,arguments)},pop(){return ul(this,"pop")},push(...e){return ul(this,"push",e)},reduce(e,...t){return Ad(this,"reduce",e,t)},reduceRight(e,...t){return Ad(this,"reduceRight",e,t)},shift(){return ul(this,"shift")},some(e,t){return $s(this,"some",e,t,void 0,arguments)},splice(...e){return ul(this,"splice",e)},toReversed(){return $i(this).toReversed()},toSorted(e){return $i(this).toSorted(e)},toSpliced(...e){return $i(this).toSpliced(...e)},unshift(...e){return ul(this,"unshift",e)},values(){return Dc(this,"values",e=>va(this,e))}};function Dc(e,t,o){const a=ec(e),s=a[t]();return a!==e&&!wo(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=o(i.value)),i}),s}const Rm=Array.prototype;function $s(e,t,o,a,s,i){const r=ec(e),u=r!==e&&!wo(e),d=r[t];if(d!==Rm[t]){const g=d.apply(e,i);return u?es(g):g}let f=o;r!==e&&(u?f=function(g,y){return o.call(this,va(e,g),y,e)}:o.length>2&&(f=function(g,y){return o.call(this,g,y,e)}));const p=d.call(r,f,a);return u&&s?s(p):p}function Ad(e,t,o,a){const s=ec(e);let i=o;return s!==e&&(wo(e)?o.length>3&&(i=function(r,u,d){return o.call(this,r,u,d,e)}):i=function(r,u,d){return o.call(this,r,va(e,u),d,e)}),s[t](i,...a)}function Oc(e,t,o){const a=Mt(e);On(a,"iterate",Al);const s=a[t](...o);return(s===-1||s===!1)&&tc(o[0])?(o[0]=Mt(o[0]),a[t](...o)):s}function ul(e,t,o=[]){zs(),Nu();const a=Mt(e)[t].apply(e,o);return Fu(),Hs(),a}const Bm=Du("__proto__,__v_isRef,__isVue"),Bf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Qo));function Nm(e){Qo(e)||(e=String(e));const t=Mt(this);return On(t,"has",e),t.hasOwnProperty(e)}class Nf{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(s?i?qm:Hf:i?zf:Uf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const r=lt(t);if(!s){let d;if(r&&(d=Om[o]))return d;if(o==="hasOwnProperty")return Nm}const u=Reflect.get(t,o,Qt(t)?t:a);if((Qo(o)?Bf.has(o):Bm(o))||(s||On(t,"get",o),i))return u;if(Qt(u)){const d=r&&Kr(o)?u:u.value;return s&&Ft(d)?ou(d):d}return Ft(u)?s?ou(u):ii(u):u}}class Ff extends Nf{constructor(t=!1){super(!1,t)}set(t,o,a,s){let i=t[o];const r=lt(t)&&Kr(o);if(!this._isShallow){const f=Vs(i);if(!wo(a)&&!Vs(a)&&(i=Mt(i),a=Mt(a)),!r&&Qt(i)&&!Qt(a))return f||(i.value=a),!0}const u=r?Number(o)<t.length:Dt(t,o),d=Reflect.set(t,o,a,Qt(t)?t:s);return t===Mt(s)&&(u?Ca(a,i)&&Ds(t,"set",o,a):Ds(t,"add",o,a)),d}deleteProperty(t,o){const a=Dt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&a&&Ds(t,"delete",o,void 0),s}has(t,o){const a=Reflect.has(t,o);return(!Qo(o)||!Bf.has(o))&&On(t,"has",o),a}ownKeys(t){return On(t,"iterate",lt(t)?"length":ei),Reflect.ownKeys(t)}}class Fm extends Nf{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Um=new Ff,zm=new Fm,Hm=new Ff(!0);const nu=e=>e,rr=e=>Reflect.getPrototypeOf(e);function Vm(e,t,o){return function(...a){const s=this.__v_raw,i=Mt(s),r=Ri(i),u=e==="entries"||e===Symbol.iterator&&r,d=e==="keys"&&r,f=s[e](...a),p=o?nu:t?Ui:es;return!t&&On(i,"iterate",d?tu:ei),{next(){const{value:g,done:y}=f.next();return y?{value:g,done:y}:{value:u?[p(g[0]),p(g[1])]:p(g),done:y}},[Symbol.iterator](){return this}}}}function cr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Gm(e,t){const o={get(s){const i=this.__v_raw,r=Mt(i),u=Mt(s);e||(Ca(s,u)&&On(r,"get",s),On(r,"get",u));const{has:d}=rr(r),f=t?nu:e?Ui:es;if(d.call(r,s))return f(i.get(s));if(d.call(r,u))return f(i.get(u));i!==r&&i.get(s)},get size(){const s=this.__v_raw;return!e&&On(Mt(s),"iterate",ei),s.size},has(s){const i=this.__v_raw,r=Mt(i),u=Mt(s);return e||(Ca(s,u)&&On(r,"has",s),On(r,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)},forEach(s,i){const r=this,u=r.__v_raw,d=Mt(u),f=t?nu:e?Ui:es;return!e&&On(d,"iterate",ei),u.forEach((p,g)=>s.call(i,f(p),f(g),r))}};return gn(o,e?{add:cr("add"),set:cr("set"),delete:cr("delete"),clear:cr("clear")}:{add(s){!t&&!wo(s)&&!Vs(s)&&(s=Mt(s));const i=Mt(this);return rr(i).has.call(i,s)||(i.add(s),Ds(i,"add",s,s)),this},set(s,i){!t&&!wo(i)&&!Vs(i)&&(i=Mt(i));const r=Mt(this),{has:u,get:d}=rr(r);let f=u.call(r,s);f||(s=Mt(s),f=u.call(r,s));const p=d.call(r,s);return r.set(s,i),f?Ca(i,p)&&Ds(r,"set",s,i):Ds(r,"add",s,i),this},delete(s){const i=Mt(this),{has:r,get:u}=rr(i);let d=r.call(i,s);d||(s=Mt(s),d=r.call(i,s)),u&&u.call(i,s);const f=i.delete(s);return d&&Ds(i,"delete",s,void 0),f},clear(){const s=Mt(this),i=s.size!==0,r=s.clear();return i&&Ds(s,"clear",void 0,void 0),r}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=Vm(s,e,t)}),o}function Hu(e,t){const o=Gm(e,t);return(a,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?a:Reflect.get(Dt(o,s)&&s in a?o:a,s,i)}const jm={get:Hu(!1,!1)},Zm={get:Hu(!1,!0)},Wm={get:Hu(!0,!1)};const Uf=new WeakMap,zf=new WeakMap,Hf=new WeakMap,qm=new WeakMap;function Km(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Jm(e){return e.__v_skip||!Object.isExtensible(e)?0:Km(km(e))}function ii(e){return Vs(e)?e:Vu(e,!1,Um,jm,Uf)}function Vf(e){return Vu(e,!1,Hm,Zm,zf)}function ou(e){return Vu(e,!0,zm,Wm,Hf)}function Vu(e,t,o,a,s){if(!Ft(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=Jm(e);if(i===0)return e;const r=s.get(e);if(r)return r;const u=new Proxy(e,i===2?a:o);return s.set(e,u),u}function Us(e){return Vs(e)?Us(e.__v_raw):!!(e&&e.__v_isReactive)}function Vs(e){return!!(e&&e.__v_isReadonly)}function wo(e){return!!(e&&e.__v_isShallow)}function tc(e){return e?!!e.__v_raw:!1}function Mt(e){const t=e&&e.__v_raw;return t?Mt(t):e}function Gu(e){return!Dt(e,"__v_skip")&&Object.isExtensible(e)&&wf(e,"__v_skip",!0),e}const es=e=>Ft(e)?ii(e):e,Ui=e=>Ft(e)?ou(e):e;function Qt(e){return e?e.__v_isRef===!0:!1}function M(e){return Gf(e,!1)}function Ym(e){return Gf(e,!0)}function Gf(e,t){return Qt(e)?e:new Xm(e,t)}class Xm{constructor(t,o){this.dep=new zu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Mt(t),this._value=o?t:es(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||wo(t)||Vs(t);t=a?t:Mt(t),Ca(t,o)&&(this._rawValue=t,this._value=a?t:es(t),this.dep.trigger())}}function D(e){return Qt(e)?e.value:e}function Ir(e){return pt(e)?e():D(e)}const Qm={get:(e,t,o)=>t==="__v_raw"?e:D(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const s=e[t];return Qt(s)&&!Qt(o)?(s.value=o,!0):Reflect.set(e,t,o,a)}};function jf(e){return Us(e)?e:new Proxy(e,Qm)}function eg(e){const t=lt(e)?new Array(e.length):{};for(const o in e)t[o]=ng(e,o);return t}class tg{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Mt(t);let s=!0,i=t;if(!lt(t)||!Kr(String(o)))do s=!tc(i)||wo(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=D(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Qt(this._raw[this._key])){const o=this._object[this._key];if(Qt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Dm(this._raw,this._key)}}function ng(e,t,o){return new tg(e,t,o)}class og{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new zu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ml-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Wt!==this)return Af(this,!0),!0}get value(){const t=this.dep.track();return Df(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function sg(e,t,o=!1){let a,s;return pt(e)?a=e:(a=e.get,s=e.set),new og(a,s,o)}const ur={},$r=new WeakMap;let qa;function ag(e,t=!1,o=qa){if(o){let a=$r.get(o);a||$r.set(o,a=[]),a.push(e)}}function ig(e,t,o=Gt){const{immediate:a,deep:s,once:i,scheduler:r,augmentJob:u,call:d}=o,f=B=>s?B:wo(B)||s===!1||s===0?Os(B,1):Os(B);let p,g,y,k,b=!1,C=!1;if(Qt(e)?(g=()=>e.value,b=wo(e)):Us(e)?(g=()=>f(e),b=!0):lt(e)?(C=!0,b=e.some(B=>Us(B)||wo(B)),g=()=>e.map(B=>{if(Qt(B))return B.value;if(Us(B))return f(B);if(pt(B))return d?d(B,2):B()})):pt(e)?t?g=d?()=>d(e,2):e:g=()=>{if(y){zs();try{y()}finally{Hs()}}const B=qa;qa=p;try{return d?d(e,3,[k]):e(k)}finally{qa=B}}:g=Yo,t&&s){const B=g,R=s===!0?1/0:s;g=()=>Os(B(),R)}const x=$f(),$=()=>{p.stop(),x&&x.active&&Ru(x.effects,p)};if(i&&t){const B=t;t=(...R)=>{B(...R),$()}}let I=C?new Array(e.length).fill(ur):ur;const S=B=>{if(!(!(p.flags&1)||!p.dirty&&!B))if(t){const R=p.run();if(s||b||(C?R.some((Z,A)=>Ca(Z,I[A])):Ca(R,I))){y&&y();const Z=qa;qa=p;try{const A=[R,I===ur?void 0:C&&I[0]===ur?[]:I,k];I=R,d?d(t,3,A):t(...A)}finally{qa=Z}}}else p.run()};return u&&u(S),p=new Tf(g),p.scheduler=r?()=>r(S,!1):S,k=B=>ag(B,!1,p),y=p.onStop=()=>{const B=$r.get(p);if(B){if(d)d(B,4);else for(const R of B)R();$r.delete(p)}},t?a?S(!0):I=p.run():r?r(S.bind(null,!0),!0):p.run(),$.pause=p.pause.bind(p),$.resume=p.resume.bind(p),$.stop=$,$}function Os(e,t=1/0,o){if(t<=0||!Ft(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Qt(e))Os(e.value,t,o);else if(lt(e))for(let a=0;a<e.length;a++)Os(e[a],t,o);else if(ji(e)||Ri(e))e.forEach(a=>{Os(a,t,o)});else if(bf(e)){for(const a in e)Os(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Os(e[a],t,o)}return e}function Vl(e,t,o,a){try{return a?e(...a):e()}catch(s){nc(s,t,o)}}function ts(e,t,o,a){if(pt(e)){const s=Vl(e,t,o,a);return s&&kf(s)&&s.catch(i=>{nc(i,t,o)}),s}if(lt(e)){const s=[];for(let i=0;i<e.length;i++)s.push(ts(e[i],t,o,a));return s}}function nc(e,t,o,a=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||Gt;if(t){let u=t.parent;const d=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,d,f)===!1)return}u=u.parent}if(i){zs(),Vl(i,null,10,[e,d,f]),Hs();return}}lg(e,o,s,a,r)}function lg(e,t,o,a=!0,s=!1){if(s)throw e;console.error(e)}const qn=[];let hs=-1;const Bi=[];let ma=null,Mi=0;const Zf=Promise.resolve();let Tr=null;function sn(e){const t=Tr||Zf;return e?t.then(this?e.bind(this):e):t}function rg(e){let t=hs+1,o=qn.length;for(;t<o;){const a=t+o>>>1,s=qn[a],i=El(s);i<e||i===e&&s.flags&2?t=a+1:o=a}return t}function ju(e){if(!(e.flags&1)){const t=El(e),o=qn[qn.length-1];!o||!(e.flags&2)&&t>=El(o)?qn.push(e):qn.splice(rg(t),0,e),e.flags|=1,Wf()}}function Wf(){Tr||(Tr=Zf.then(Jf))}function qf(e){lt(e)?Bi.push(...e):ma&&e.id===-1?ma.splice(Mi+1,0,e):e.flags&1||(Bi.push(e),e.flags|=1),Wf()}function Ed(e,t,o=hs+1){for(;o<qn.length;o++){const a=qn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;qn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function Kf(e){if(Bi.length){const t=[...new Set(Bi)].sort((o,a)=>El(o)-El(a));if(Bi.length=0,ma){ma.push(...t);return}for(ma=t,Mi=0;Mi<ma.length;Mi++){const o=ma[Mi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}ma=null,Mi=0}}const El=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Jf(e){try{for(hs=0;hs<qn.length;hs++){const t=qn[hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Vl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hs<qn.length;hs++){const t=qn[hs];t&&(t.flags&=-2)}hs=-1,qn.length=0,Kf(),Tr=null,(qn.length||Bi.length)&&Jf()}}let Tn=null,Yf=null;function Mr(e){const t=Tn;return Tn=e,Yf=e&&e.type.__scopeId||null,t}function Ve(e,t=Tn,o){if(!t||e._n)return e;const a=(...s)=>{a._d&&Pr(-1);const i=Mr(t);let r;try{r=e(...s)}finally{Mr(i),a._d&&Pr(1)}return r};return a._n=!0,a._c=!0,a._d=!0,a}function Ue(e,t){if(Tn===null)return e;const o=rc(Tn),a=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,r,u,d=Gt]=t[s];i&&(pt(i)&&(i={mounted:i,updated:i}),i.deep&&Os(r),a.push({dir:i,instance:o,value:r,oldValue:void 0,arg:u,modifiers:d}))}return e}function Va(e,t,o,a){const s=e.dirs,i=t&&t.dirs;for(let r=0;r<s.length;r++){const u=s[r];i&&(u.oldValue=i[r].value);let d=u.dir[a];d&&(zs(),ts(d,o,8,[e.el,u,e,t]),Hs())}}function wl(e,t){if(Bn){let o=Bn.provides;const a=Bn.parent&&Bn.parent.provides;a===o&&(o=Bn.provides=Object.create(a)),o[e]=t}}function ro(e,t,o=!1){const a=lc();if(a||ti){let s=ti?ti._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&pt(t)?t.call(a&&a.proxy):t}}function cg(){return!!(lc()||ti)}const ug=Symbol.for("v-scx"),dg=()=>ro(ug);function Ze(e,t,o){return Xf(e,t,o)}function Xf(e,t,o=Gt){const{immediate:a,deep:s,flush:i,once:r}=o,u=gn({},o),d=t&&a||!t&&i!=="post";let f;if(Bl){if(i==="sync"){const k=dg();f=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=Yo,k.resume=Yo,k.pause=Yo,k}}const p=Bn;u.call=(k,b,C)=>ts(k,p,b,C);let g=!1;i==="post"?u.scheduler=k=>{Zn(k,p&&p.suspense)}:i!=="sync"&&(g=!0,u.scheduler=(k,b)=>{b?k():ju(k)}),u.augmentJob=k=>{t&&(k.flags|=4),g&&(k.flags|=2,p&&(k.id=p.uid,k.i=p))};const y=ig(e,t,u);return Bl&&(f?f.push(y):d&&y()),y}function hg(e,t,o){const a=this.proxy,s=en(e)?e.includes(".")?Qf(a,e):()=>a[e]:e.bind(a,a);let i;pt(t)?i=t:(i=t.handler,o=t);const r=Gl(this),u=Xf(s,i.bind(a),o);return r(),u}function Qf(e,t){const o=t.split(".");return()=>{let a=e;for(let s=0;s<o.length&&a;s++)a=a[o[s]];return a}}const ep=Symbol("_vte"),tp=e=>e.__isTeleport,Cl=e=>e&&(e.disabled||e.disabled===""),Pd=e=>e&&(e.defer||e.defer===""),Dd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Od=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,su=(e,t)=>{const o=e&&e.to;return en(o)?t?t(o):null:o},np={name:"Teleport",__isTeleport:!0,process(e,t,o,a,s,i,r,u,d,f){const{mc:p,pc:g,pbc:y,o:{insert:k,querySelector:b,createText:C,createComment:x}}=f,$=Cl(t.props);let{shapeFlag:I,children:S,dynamicChildren:B}=t;if(e==null){const R=t.el=C(""),Z=t.anchor=C("");k(R,o,a),k(Z,o,a);const A=(O,V)=>{I&16&&p(S,O,V,s,i,r,u,d)},N=()=>{const O=t.target=su(t.props,b),V=op(O,t,C,k);O&&(r!=="svg"&&Dd(O)?r="svg":r!=="mathml"&&Od(O)&&(r="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(O),$||(A(O,V),yr(t,!1)))};$&&(A(o,Z),yr(t,!0)),Pd(t.props)?(t.el.__isMounted=!1,Zn(()=>{N(),delete t.el.__isMounted},i)):N()}else{if(Pd(t.props)&&e.el.__isMounted===!1){Zn(()=>{np.process(e,t,o,a,s,i,r,u,d,f)},i);return}t.el=e.el,t.targetStart=e.targetStart;const R=t.anchor=e.anchor,Z=t.target=e.target,A=t.targetAnchor=e.targetAnchor,N=Cl(e.props),O=N?o:Z,V=N?R:A;if(r==="svg"||Dd(Z)?r="svg":(r==="mathml"||Od(Z))&&(r="mathml"),B?(y(e.dynamicChildren,B,O,s,i,r,u),Ku(e,t,!0)):d||g(e,t,O,V,s,i,r,u,!1),$)N?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):dr(t,o,R,f,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const P=t.target=su(t.props,b);P&&dr(t,P,null,f,0)}else N&&dr(t,Z,A,f,1);yr(t,$)}},remove(e,t,o,{um:a,o:{remove:s}},i){const{shapeFlag:r,children:u,anchor:d,targetStart:f,targetAnchor:p,target:g,props:y}=e;if(g&&(s(f),s(p)),i&&s(d),r&16){const k=i||!Cl(y);for(let b=0;b<u.length;b++){const C=u[b];a(C,t,o,k,!!C.dynamicChildren)}}},move:dr,hydrate:fg};function dr(e,t,o,{o:{insert:a},m:s},i=2){i===0&&a(e.targetAnchor,t,o);const{el:r,anchor:u,shapeFlag:d,children:f,props:p}=e,g=i===2;if(g&&a(r,t,o),(!g||Cl(p))&&d&16)for(let y=0;y<f.length;y++)s(f[y],t,o,2);g&&a(u,t,o)}function fg(e,t,o,a,s,i,{o:{nextSibling:r,parentNode:u,querySelector:d,insert:f,createText:p}},g){function y(C,x,$,I){x.anchor=g(r(C),x,u(C),o,a,s,i),x.targetStart=$,x.targetAnchor=I}const k=t.target=su(t.props,d),b=Cl(t.props);if(k){const C=k._lpa||k.firstChild;if(t.shapeFlag&16)if(b)y(e,t,C,C&&r(C));else{t.anchor=r(e);let x=C;for(;x;){if(x&&x.nodeType===8){if(x.data==="teleport start anchor")t.targetStart=x;else if(x.data==="teleport anchor"){t.targetAnchor=x,k._lpa=t.targetAnchor&&r(t.targetAnchor);break}}x=r(x)}t.targetAnchor||op(k,t,p,f),g(C&&r(C),t,k,o,a,s,i)}yr(t,b)}else b&&t.shapeFlag&16&&y(e,t,e,r(e));return t.anchor&&r(t.anchor)}const Pl=np;function yr(e,t){const o=e.ctx;if(o&&o.ut){let a,s;for(t?(a=e.el,s=e.anchor):(a=e.targetStart,s=e.targetAnchor);a&&a!==s;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function op(e,t,o,a){const s=t.targetStart=o(""),i=t.targetAnchor=o("");return s[ep]=i,e&&(a(s,e),a(i,e)),i}const Es=Symbol("_leaveCb"),hr=Symbol("_enterCb");function pg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return tn(()=>{e.isMounted=!0}),fp(()=>{e.isUnmounting=!0}),e}const Do=[Function,Array],sp={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Do,onEnter:Do,onAfterEnter:Do,onEnterCancelled:Do,onBeforeLeave:Do,onLeave:Do,onAfterLeave:Do,onLeaveCancelled:Do,onBeforeAppear:Do,onAppear:Do,onAfterAppear:Do,onAppearCancelled:Do},ap=e=>{const t=e.subTree;return t.component?ap(t.component):t},vg={name:"BaseTransition",props:sp,setup(e,{slots:t}){const o=lc(),a=pg();return()=>{const s=t.default&&rp(t.default(),!0);if(!s||!s.length)return;const i=ip(s),r=Mt(e),{mode:u}=r;if(a.isLeaving)return Rc(i);const d=Rd(i);if(!d)return Rc(i);let f=au(d,r,a,o,g=>f=g);d.type!==Rn&&Dl(d,f);let p=o.subTree&&Rd(o.subTree);if(p&&p.type!==Rn&&!Ka(p,d)&&ap(o).type!==Rn){let g=au(p,r,a,o);if(Dl(p,g),u==="out-in"&&d.type!==Rn)return a.isLeaving=!0,g.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},Rc(i);u==="in-out"&&d.type!==Rn?g.delayLeave=(y,k,b)=>{const C=lp(a,p);C[String(p.key)]=p,y[Es]=()=>{k(),y[Es]=void 0,delete f.delayedLeave,p=void 0},f.delayedLeave=()=>{b(),delete f.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return i}}};function ip(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Rn){t=o;break}}return t}const mg=vg;function lp(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function au(e,t,o,a,s){const{appear:i,mode:r,persisted:u=!1,onBeforeEnter:d,onEnter:f,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:y,onLeave:k,onAfterLeave:b,onLeaveCancelled:C,onBeforeAppear:x,onAppear:$,onAfterAppear:I,onAppearCancelled:S}=t,B=String(e.key),R=lp(o,e),Z=(O,V)=>{O&&ts(O,a,9,V)},A=(O,V)=>{const P=V[1];Z(O,V),lt(O)?O.every(j=>j.length<=1)&&P():O.length<=1&&P()},N={mode:r,persisted:u,beforeEnter(O){let V=d;if(!o.isMounted)if(i)V=x||d;else return;O[Es]&&O[Es](!0);const P=R[B];P&&Ka(e,P)&&P.el[Es]&&P.el[Es](),Z(V,[O])},enter(O){let V=f,P=p,j=g;if(!o.isMounted)if(i)V=$||f,P=I||p,j=S||g;else return;let Q=!1;const ae=O[hr]=pe=>{Q||(Q=!0,pe?Z(j,[O]):Z(P,[O]),N.delayedLeave&&N.delayedLeave(),O[hr]=void 0)};V?A(V,[O,ae]):ae()},leave(O,V){const P=String(e.key);if(O[hr]&&O[hr](!0),o.isUnmounting)return V();Z(y,[O]);let j=!1;const Q=O[Es]=ae=>{j||(j=!0,V(),ae?Z(C,[O]):Z(b,[O]),O[Es]=void 0,R[P]===e&&delete R[P])};R[P]=e,k?A(k,[O,Q]):Q()},clone(O){const V=au(O,t,o,a,s);return s&&s(V),V}};return N}function Rc(e){if(oc(e))return e=xa(e),e.children=null,e}function Rd(e){if(!oc(e))return tp(e.type)&&e.children?ip(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&pt(o.default))return o.default()}}function Dl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Dl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function rp(e,t=!1,o){let a=[],s=0;for(let i=0;i<e.length;i++){let r=e[i];const u=o==null?r.key:String(o)+String(r.key!=null?r.key:i);r.type===Ie?(r.patchFlag&128&&s++,a=a.concat(rp(r.children,t,u))):(t||r.type!==Rn)&&a.push(u!=null?xa(r,{key:u}):r)}if(s>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function cp(e,t){return pt(e)?gn({name:e.name},t,{setup:e}):e}function up(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ar=new WeakMap;function Ll(e,t,o,a,s=!1){if(lt(e)){e.forEach((b,C)=>Ll(b,t&&(lt(t)?t[C]:t),o,a,s));return}if(Ni(a)&&!s){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&Ll(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?rc(a.component):a.el,r=s?null:i,{i:u,r:d}=e,f=t&&t.r,p=u.refs===Gt?u.refs={}:u.refs,g=u.setupState,y=Mt(g),k=g===Gt?yf:b=>Dt(y,b);if(f!=null&&f!==d){if(Bd(t),en(f))p[f]=null,k(f)&&(g[f]=null);else if(Qt(f)){f.value=null;const b=t;b.k&&(p[b.k]=null)}}if(pt(d))Vl(d,u,12,[r,p]);else{const b=en(d),C=Qt(d);if(b||C){const x=()=>{if(e.f){const $=b?k(d)?g[d]:p[d]:d.value;if(s)lt($)&&Ru($,i);else if(lt($))$.includes(i)||$.push(i);else if(b)p[d]=[i],k(d)&&(g[d]=p[d]);else{const I=[i];d.value=I,e.k&&(p[e.k]=I)}}else b?(p[d]=r,k(d)&&(g[d]=r)):C&&(d.value=r,e.k&&(p[e.k]=r))};if(r){const $=()=>{x(),Ar.delete(e)};$.id=-1,Ar.set(e,$),Zn($,o)}else Bd(e),x()}}}function Bd(e){const t=Ar.get(e);t&&(t.flags|=8,Ar.delete(e))}Qr().requestIdleCallback;Qr().cancelIdleCallback;const Ni=e=>!!e.type.__asyncLoader,oc=e=>e.type.__isKeepAlive;function gg(e,t){dp(e,"a",t)}function yg(e,t){dp(e,"da",t)}function dp(e,t,o=Bn){const a=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(sc(t,a,o),o){let s=o.parent;for(;s&&s.parent;)oc(s.parent.vnode)&&kg(a,t,o,s),s=s.parent}}function kg(e,t,o,a){const s=sc(t,e,a,!0);yn(()=>{Ru(a[t],s)},o)}function sc(e,t,o=Bn,a=!1){if(o){const s=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...r)=>{zs();const u=Gl(o),d=ts(t,o,e,r);return u(),Hs(),d});return a?s.unshift(i):s.push(i),i}}const Zs=e=>(t,o=Bn)=>{(!Bl||e==="sp")&&sc(e,(...a)=>t(...a),o)},_g=Zs("bm"),tn=Zs("m"),hp=Zs("bu"),bg=Zs("u"),fp=Zs("bum"),yn=Zs("um"),wg=Zs("sp"),Cg=Zs("rtg"),Lg=Zs("rtc");function Sg(e,t=Bn){sc("ec",e,t)}const pp="components";function Zu(e,t){return mp(pp,e,!0,t)||e}const vp=Symbol.for("v-ndc");function xg(e){return en(e)?mp(pp,e,!1)||e:e||vp}function mp(e,t,o=!0,a=!1){const s=Tn||Bn;if(s){const i=s.type;{const u=cy(i,!1);if(u&&(u===t||u===Ro(t)||u===Yr(Ro(t))))return i}const r=Nd(s[e]||i[e],t)||Nd(s.appContext[e],t);return!r&&a?i:r}}function Nd(e,t){return e&&(e[t]||e[Ro(t)]||e[Yr(Ro(t))])}function Fe(e,t,o,a){let s;const i=o,r=lt(e);if(r||en(e)){const u=r&&Us(e);let d=!1,f=!1;u&&(d=!wo(e),f=Vs(e),e=ec(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(d?f?Ui(es(e[p])):es(e[p]):e[p],p,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,i)}else if(Ft(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,f=u.length;d<f;d++){const p=u[d];s[d]=t(e[p],p,d,i)}}else s=[];return s}function gp(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(lt(a))for(let s=0;s<a.length;s++)e[a[s].name]=a[s].fn;else a&&(e[a.name]=a.key?(...s)=>{const i=a.fn(...s);return i&&(i.key=a.key),i}:a.fn)}return e}function lo(e,t,o={},a,s){if(Tn.ce||Tn.parent&&Ni(Tn.parent)&&Tn.parent.ce){const f=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),qe(Ie,null,[Ae("slot",o,a&&a())],f?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const r=i&&yp(i(o)),u=o.key||r&&r.key,d=qe(Ie,{key:(u&&!Qo(u)?u:`_${t}`)+(!r&&a?"_fb":"")},r||(a?a():[]),r&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function yp(e){return e.some(t=>Rl(t)?!(t.type===Rn||t.type===Ie&&!yp(t.children)):!0)?e:null}const iu=e=>e?Bp(e)?rc(e):iu(e.parent):null,Sl=gn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>iu(e.parent),$root:e=>iu(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>_p(e),$forceUpdate:e=>e.f||(e.f=()=>{ju(e.update)}),$nextTick:e=>e.n||(e.n=sn.bind(e.proxy)),$watch:e=>hg.bind(e)}),Bc=(e,t)=>e!==Gt&&!e.__isScriptSetup&&Dt(e,t),Ig={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:s,props:i,accessCache:r,type:u,appContext:d}=e;if(t[0]!=="$"){const y=r[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return s[t];case 4:return o[t];case 3:return i[t]}else{if(Bc(a,t))return r[t]=1,a[t];if(s!==Gt&&Dt(s,t))return r[t]=2,s[t];if(Dt(i,t))return r[t]=3,i[t];if(o!==Gt&&Dt(o,t))return r[t]=4,o[t];lu&&(r[t]=0)}}const f=Sl[t];let p,g;if(f)return t==="$attrs"&&On(e.attrs,"get",""),f(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Gt&&Dt(o,t))return r[t]=4,o[t];if(g=d.config.globalProperties,Dt(g,t))return g[t]},set({_:e},t,o){const{data:a,setupState:s,ctx:i}=e;return Bc(s,t)?(s[t]=o,!0):a!==Gt&&Dt(a,t)?(a[t]=o,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:s,props:i,type:r}},u){let d;return!!(o[u]||e!==Gt&&u[0]!=="$"&&Dt(e,u)||Bc(t,u)||Dt(i,u)||Dt(a,u)||Dt(Sl,u)||Dt(s.config.globalProperties,u)||(d=r.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Dt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Fd(e){return lt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let lu=!0;function $g(e){const t=_p(e),o=e.proxy,a=e.ctx;lu=!1,t.beforeCreate&&Ud(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:r,watch:u,provide:d,inject:f,created:p,beforeMount:g,mounted:y,beforeUpdate:k,updated:b,activated:C,deactivated:x,beforeDestroy:$,beforeUnmount:I,destroyed:S,unmounted:B,render:R,renderTracked:Z,renderTriggered:A,errorCaptured:N,serverPrefetch:O,expose:V,inheritAttrs:P,components:j,directives:Q,filters:ae}=t;if(f&&Tg(f,a,null),r)for(const oe in r){const U=r[oe];pt(U)&&(a[oe]=U.bind(o))}if(s){const oe=s.call(o,o);Ft(oe)&&(e.data=ii(oe))}if(lu=!0,i)for(const oe in i){const U=i[oe],Y=pt(U)?U.bind(o,o):pt(U.get)?U.get.bind(o,o):Yo,de=!pt(U)&&pt(U.set)?U.set.bind(o):Yo,ke=F({get:Y,set:de});Object.defineProperty(a,oe,{enumerable:!0,configurable:!0,get:()=>ke.value,set:Re=>ke.value=Re})}if(u)for(const oe in u)kp(u[oe],a,o,oe);if(d){const oe=pt(d)?d.call(o):d;Reflect.ownKeys(oe).forEach(U=>{wl(U,oe[U])})}p&&Ud(p,e,"c");function ne(oe,U){lt(U)?U.forEach(Y=>oe(Y.bind(o))):U&&oe(U.bind(o))}if(ne(_g,g),ne(tn,y),ne(hp,k),ne(bg,b),ne(gg,C),ne(yg,x),ne(Sg,N),ne(Lg,Z),ne(Cg,A),ne(fp,I),ne(yn,B),ne(wg,O),lt(V))if(V.length){const oe=e.exposed||(e.exposed={});V.forEach(U=>{Object.defineProperty(oe,U,{get:()=>o[U],set:Y=>o[U]=Y,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===Yo&&(e.render=R),P!=null&&(e.inheritAttrs=P),j&&(e.components=j),Q&&(e.directives=Q),O&&up(e)}function Tg(e,t,o=Yo){lt(e)&&(e=ru(e));for(const a in e){const s=e[a];let i;Ft(s)?"default"in s?i=ro(s.from||a,s.default,!0):i=ro(s.from||a):i=ro(s),Qt(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:r=>i.value=r}):t[a]=i}}function Ud(e,t,o){ts(lt(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function kp(e,t,o,a){let s=a.includes(".")?Qf(o,a):()=>o[a];if(en(e)){const i=t[e];pt(i)&&Ze(s,i)}else if(pt(e))Ze(s,e.bind(o));else if(Ft(e))if(lt(e))e.forEach(i=>kp(i,t,o,a));else{const i=pt(e.handler)?e.handler.bind(o):t[e.handler];pt(i)&&Ze(s,i,e)}}function _p(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:r}}=e.appContext,u=i.get(t);let d;return u?d=u:!s.length&&!o&&!a?d=t:(d={},s.length&&s.forEach(f=>Er(d,f,r,!0)),Er(d,t,r)),Ft(t)&&i.set(t,d),d}function Er(e,t,o,a=!1){const{mixins:s,extends:i}=t;i&&Er(e,i,o,!0),s&&s.forEach(r=>Er(e,r,o,!0));for(const r in t)if(!(a&&r==="expose")){const u=Mg[r]||o&&o[r];e[r]=u?u(e[r],t[r]):t[r]}return e}const Mg={data:zd,props:Hd,emits:Hd,methods:vl,computed:vl,beforeCreate:jn,created:jn,beforeMount:jn,mounted:jn,beforeUpdate:jn,updated:jn,beforeDestroy:jn,beforeUnmount:jn,destroyed:jn,unmounted:jn,activated:jn,deactivated:jn,errorCaptured:jn,serverPrefetch:jn,components:vl,directives:vl,watch:Eg,provide:zd,inject:Ag};function zd(e,t){return t?e?function(){return gn(pt(e)?e.call(this,this):e,pt(t)?t.call(this,this):t)}:t:e}function Ag(e,t){return vl(ru(e),ru(t))}function ru(e){if(lt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function jn(e,t){return e?[...new Set([].concat(e,t))]:t}function vl(e,t){return e?gn(Object.create(null),e,t):t}function Hd(e,t){return e?lt(e)&&lt(t)?[...new Set([...e,...t])]:gn(Object.create(null),Fd(e),Fd(t??{})):t}function Eg(e,t){if(!e)return t;if(!t)return e;const o=gn(Object.create(null),e);for(const a in t)o[a]=jn(e[a],t[a]);return o}function bp(){return{app:null,config:{isNativeTag:yf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Pg=0;function Dg(e,t){return function(a,s=null){pt(a)||(a=gn({},a)),s!=null&&!Ft(s)&&(s=null);const i=bp(),r=new WeakSet,u=[];let d=!1;const f=i.app={_uid:Pg++,_component:a,_props:s,_container:null,_context:i,_instance:null,version:dy,get config(){return i.config},set config(p){},use(p,...g){return r.has(p)||(p&&pt(p.install)?(r.add(p),p.install(f,...g)):pt(p)&&(r.add(p),p(f,...g))),f},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),f},component(p,g){return g?(i.components[p]=g,f):i.components[p]},directive(p,g){return g?(i.directives[p]=g,f):i.directives[p]},mount(p,g,y){if(!d){const k=f._ceVNode||Ae(a,s);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,p,y),d=!0,f._container=p,p.__vue_app__=f,rc(k.component)}},onUnmount(p){u.push(p)},unmount(){d&&(ts(u,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(p,g){return i.provides[p]=g,f},runWithContext(p){const g=ti;ti=f;try{return p()}finally{ti=g}}};return f}}let ti=null;const Og=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ro(t)}Modifiers`]||e[`${Ta(t)}Modifiers`];function Rg(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Gt;let s=o;const i=t.startsWith("update:"),r=i&&Og(a,t.slice(7));r&&(r.trim&&(s=o.map(p=>en(p)?p.trim():p)),r.number&&(s=o.map(Xr)));let u,d=a[u=Ac(t)]||a[u=Ac(Ro(t))];!d&&i&&(d=a[u=Ac(Ta(t))]),d&&ts(d,e,6,s);const f=a[u+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,ts(f,e,6,s)}}const Bg=new WeakMap;function wp(e,t,o=!1){const a=o?Bg:t.emitsCache,s=a.get(e);if(s!==void 0)return s;const i=e.emits;let r={},u=!1;if(!pt(e)){const d=f=>{const p=wp(f,t,!0);p&&(u=!0,gn(r,p))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(Ft(e)&&a.set(e,null),null):(lt(i)?i.forEach(d=>r[d]=null):gn(r,i),Ft(e)&&a.set(e,r),r)}function ac(e,t){return!e||!qr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,Ta(t))||Dt(e,t))}function Vd(e){const{type:t,vnode:o,proxy:a,withProxy:s,propsOptions:[i],slots:r,attrs:u,emit:d,render:f,renderCache:p,props:g,data:y,setupState:k,ctx:b,inheritAttrs:C}=e,x=Mr(e);let $,I;try{if(o.shapeFlag&4){const B=s||a,R=B;$=fs(f.call(R,B,p,g,k,y,b)),I=u}else{const B=t;$=fs(B.length>1?B(g,{attrs:u,slots:r,emit:d}):B(g,null)),I=t.props?u:Ng(u)}}catch(B){Il.length=0,nc(B,e,1),$=Ae(Rn)}let S=$;if(I&&C!==!1){const B=Object.keys(I),{shapeFlag:R}=S;B.length&&R&7&&(i&&B.some(Ou)&&(I=Fg(I,i)),S=xa(S,I,!1,!0))}return o.dirs&&(S=xa(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(o.dirs):o.dirs),o.transition&&Dl(S,o.transition),$=S,Mr(x),$}const Ng=e=>{let t;for(const o in e)(o==="class"||o==="style"||qr(o))&&((t||(t={}))[o]=e[o]);return t},Fg=(e,t)=>{const o={};for(const a in e)(!Ou(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function Ug(e,t,o){const{props:a,children:s,component:i}=e,{props:r,children:u,patchFlag:d}=t,f=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?Gd(a,r,f):!!r;if(d&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const y=p[g];if(r[y]!==a[y]&&!ac(f,y))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:a===r?!1:a?r?Gd(a,r,f):!0:!!r;return!1}function Gd(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let s=0;s<a.length;s++){const i=a[s];if(t[i]!==e[i]&&!ac(o,i))return!0}return!1}function zg({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const Cp={},Lp=()=>Object.create(Cp),Sp=e=>Object.getPrototypeOf(e)===Cp;function Hg(e,t,o,a=!1){const s={},i=Lp();e.propsDefaults=Object.create(null),xp(e,t,s,i);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);o?e.props=a?s:Vf(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function Vg(e,t,o,a){const{props:s,attrs:i,vnode:{patchFlag:r}}=e,u=Mt(s),[d]=e.propsOptions;let f=!1;if((a||r>0)&&!(r&16)){if(r&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let y=p[g];if(ac(e.emitsOptions,y))continue;const k=t[y];if(d)if(Dt(i,y))k!==i[y]&&(i[y]=k,f=!0);else{const b=Ro(y);s[b]=cu(d,u,b,k,e,!1)}else k!==i[y]&&(i[y]=k,f=!0)}}}else{xp(e,t,s,i)&&(f=!0);let p;for(const g in u)(!t||!Dt(t,g)&&((p=Ta(g))===g||!Dt(t,p)))&&(d?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=cu(d,u,g,void 0,e,!0)):delete s[g]);if(i!==u)for(const g in i)(!t||!Dt(t,g))&&(delete i[g],f=!0)}f&&Ds(e.attrs,"set","")}function xp(e,t,o,a){const[s,i]=e.propsOptions;let r=!1,u;if(t)for(let d in t){if(kl(d))continue;const f=t[d];let p;s&&Dt(s,p=Ro(d))?!i||!i.includes(p)?o[p]=f:(u||(u={}))[p]=f:ac(e.emitsOptions,d)||(!(d in a)||f!==a[d])&&(a[d]=f,r=!0)}if(i){const d=Mt(o),f=u||Gt;for(let p=0;p<i.length;p++){const g=i[p];o[g]=cu(s,d,g,f[g],e,!Dt(f,g))}}return r}function cu(e,t,o,a,s,i){const r=e[o];if(r!=null){const u=Dt(r,"default");if(u&&a===void 0){const d=r.default;if(r.type!==Function&&!r.skipFactory&&pt(d)){const{propsDefaults:f}=s;if(o in f)a=f[o];else{const p=Gl(s);a=f[o]=d.call(null,t),p()}}else a=d;s.ce&&s.ce._setProp(o,a)}r[0]&&(i&&!u?a=!1:r[1]&&(a===""||a===Ta(o))&&(a=!0))}return a}const Gg=new WeakMap;function Ip(e,t,o=!1){const a=o?Gg:t.propsCache,s=a.get(e);if(s)return s;const i=e.props,r={},u=[];let d=!1;if(!pt(e)){const p=g=>{d=!0;const[y,k]=Ip(g,t,!0);gn(r,y),k&&u.push(...k)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!i&&!d)return Ft(e)&&a.set(e,Oi),Oi;if(lt(i))for(let p=0;p<i.length;p++){const g=Ro(i[p]);jd(g)&&(r[g]=Gt)}else if(i)for(const p in i){const g=Ro(p);if(jd(g)){const y=i[p],k=r[g]=lt(y)||pt(y)?{type:y}:gn({},y),b=k.type;let C=!1,x=!0;if(lt(b))for(let $=0;$<b.length;++$){const I=b[$],S=pt(I)&&I.name;if(S==="Boolean"){C=!0;break}else S==="String"&&(x=!1)}else C=pt(b)&&b.name==="Boolean";k[0]=C,k[1]=x,(C||Dt(k,"default"))&&u.push(g)}}const f=[r,u];return Ft(e)&&a.set(e,f),f}function jd(e){return e[0]!=="$"&&!kl(e)}const Wu=e=>e==="_"||e==="_ctx"||e==="$stable",qu=e=>lt(e)?e.map(fs):[fs(e)],jg=(e,t,o)=>{if(t._n)return t;const a=Ve((...s)=>qu(t(...s)),o);return a._c=!1,a},$p=(e,t,o)=>{const a=e._ctx;for(const s in e){if(Wu(s))continue;const i=e[s];if(pt(i))t[s]=jg(s,i,a);else if(i!=null){const r=qu(i);t[s]=()=>r}}},Tp=(e,t)=>{const o=qu(t);e.slots.default=()=>o},Mp=(e,t,o)=>{for(const a in t)(o||!Wu(a))&&(e[a]=t[a])},Zg=(e,t,o)=>{const a=e.slots=Lp();if(e.vnode.shapeFlag&32){const s=t._;s?(Mp(a,t,o),o&&wf(a,"_",s,!0)):$p(t,a)}else t&&Tp(e,t)},Wg=(e,t,o)=>{const{vnode:a,slots:s}=e;let i=!0,r=Gt;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:Mp(s,t,o):(i=!t.$stable,$p(t,s)),r=t}else t&&(Tp(e,t),r={default:1});if(i)for(const u in s)!Wu(u)&&r[u]==null&&delete s[u]},Zn=Xg;function qg(e){return Kg(e)}function Kg(e,t){const o=Qr();o.__VUE__=!0;const{insert:a,remove:s,patchProp:i,createElement:r,createText:u,createComment:d,setText:f,setElementText:p,parentNode:g,nextSibling:y,setScopeId:k=Yo,insertStaticContent:b}=e,C=(G,J,ce,Me=null,Be=null,De=null,Le=void 0,X=null,fe=!!J.dynamicChildren)=>{if(G===J)return;G&&!Ka(G,J)&&(Me=ee(G),Re(G,Be,De,!0),G=null),J.patchFlag===-2&&(fe=!1,J.dynamicChildren=null);const{type:xe,ref:Se,shapeFlag:_e}=J;switch(xe){case ic:x(G,J,ce,Me);break;case Rn:$(G,J,ce,Me);break;case xl:G==null&&I(J,ce,Me,Le);break;case Ie:j(G,J,ce,Me,Be,De,Le,X,fe);break;default:_e&1?R(G,J,ce,Me,Be,De,Le,X,fe):_e&6?Q(G,J,ce,Me,Be,De,Le,X,fe):(_e&64||_e&128)&&xe.process(G,J,ce,Me,Be,De,Le,X,fe,ge)}Se!=null&&Be?Ll(Se,G&&G.ref,De,J||G,!J):Se==null&&G&&G.ref!=null&&Ll(G.ref,null,De,G,!0)},x=(G,J,ce,Me)=>{if(G==null)a(J.el=u(J.children),ce,Me);else{const Be=J.el=G.el;J.children!==G.children&&f(Be,J.children)}},$=(G,J,ce,Me)=>{G==null?a(J.el=d(J.children||""),ce,Me):J.el=G.el},I=(G,J,ce,Me)=>{[G.el,G.anchor]=b(G.children,J,ce,Me,G.el,G.anchor)},S=({el:G,anchor:J},ce,Me)=>{let Be;for(;G&&G!==J;)Be=y(G),a(G,ce,Me),G=Be;a(J,ce,Me)},B=({el:G,anchor:J})=>{let ce;for(;G&&G!==J;)ce=y(G),s(G),G=ce;s(J)},R=(G,J,ce,Me,Be,De,Le,X,fe)=>{if(J.type==="svg"?Le="svg":J.type==="math"&&(Le="mathml"),G==null)Z(J,ce,Me,Be,De,Le,X,fe);else{const xe=G.el&&G.el._isVueCE?G.el:null;try{xe&&xe._beginPatch(),O(G,J,Be,De,Le,X,fe)}finally{xe&&xe._endPatch()}}},Z=(G,J,ce,Me,Be,De,Le,X)=>{let fe,xe;const{props:Se,shapeFlag:_e,transition:W,dirs:q}=G;if(fe=G.el=r(G.type,De,Se&&Se.is,Se),_e&8?p(fe,G.children):_e&16&&N(G.children,fe,null,Me,Be,Nc(G,De),Le,X),q&&Va(G,null,Me,"created"),A(fe,G,G.scopeId,Le,Me),Se){for(const le in Se)le!=="value"&&!kl(le)&&i(fe,le,null,Se[le],De,Me);"value"in Se&&i(fe,"value",null,Se.value,De),(xe=Se.onVnodeBeforeMount)&&us(xe,Me,G)}q&&Va(G,null,Me,"beforeMount");const K=Jg(Be,W);K&&W.beforeEnter(fe),a(fe,J,ce),((xe=Se&&Se.onVnodeMounted)||K||q)&&Zn(()=>{xe&&us(xe,Me,G),K&&W.enter(fe),q&&Va(G,null,Me,"mounted")},Be)},A=(G,J,ce,Me,Be)=>{if(ce&&k(G,ce),Me)for(let De=0;De<Me.length;De++)k(G,Me[De]);if(Be){let De=Be.subTree;if(J===De||Pp(De.type)&&(De.ssContent===J||De.ssFallback===J)){const Le=Be.vnode;A(G,Le,Le.scopeId,Le.slotScopeIds,Be.parent)}}},N=(G,J,ce,Me,Be,De,Le,X,fe=0)=>{for(let xe=fe;xe<G.length;xe++){const Se=G[xe]=X?ga(G[xe]):fs(G[xe]);C(null,Se,J,ce,Me,Be,De,Le,X)}},O=(G,J,ce,Me,Be,De,Le)=>{const X=J.el=G.el;let{patchFlag:fe,dynamicChildren:xe,dirs:Se}=J;fe|=G.patchFlag&16;const _e=G.props||Gt,W=J.props||Gt;let q;if(ce&&Ga(ce,!1),(q=W.onVnodeBeforeUpdate)&&us(q,ce,J,G),Se&&Va(J,G,ce,"beforeUpdate"),ce&&Ga(ce,!0),(_e.innerHTML&&W.innerHTML==null||_e.textContent&&W.textContent==null)&&p(X,""),xe?V(G.dynamicChildren,xe,X,ce,Me,Nc(J,Be),De):Le||U(G,J,X,null,ce,Me,Nc(J,Be),De,!1),fe>0){if(fe&16)P(X,_e,W,ce,Be);else if(fe&2&&_e.class!==W.class&&i(X,"class",null,W.class,Be),fe&4&&i(X,"style",_e.style,W.style,Be),fe&8){const K=J.dynamicProps;for(let le=0;le<K.length;le++){const Ee=K[le],Ke=_e[Ee],Qe=W[Ee];(Qe!==Ke||Ee==="value")&&i(X,Ee,Ke,Qe,Be,ce)}}fe&1&&G.children!==J.children&&p(X,J.children)}else!Le&&xe==null&&P(X,_e,W,ce,Be);((q=W.onVnodeUpdated)||Se)&&Zn(()=>{q&&us(q,ce,J,G),Se&&Va(J,G,ce,"updated")},Me)},V=(G,J,ce,Me,Be,De,Le)=>{for(let X=0;X<J.length;X++){const fe=G[X],xe=J[X],Se=fe.el&&(fe.type===Ie||!Ka(fe,xe)||fe.shapeFlag&198)?g(fe.el):ce;C(fe,xe,Se,null,Me,Be,De,Le,!0)}},P=(G,J,ce,Me,Be)=>{if(J!==ce){if(J!==Gt)for(const De in J)!kl(De)&&!(De in ce)&&i(G,De,J[De],null,Be,Me);for(const De in ce){if(kl(De))continue;const Le=ce[De],X=J[De];Le!==X&&De!=="value"&&i(G,De,X,Le,Be,Me)}"value"in ce&&i(G,"value",J.value,ce.value,Be)}},j=(G,J,ce,Me,Be,De,Le,X,fe)=>{const xe=J.el=G?G.el:u(""),Se=J.anchor=G?G.anchor:u("");let{patchFlag:_e,dynamicChildren:W,slotScopeIds:q}=J;q&&(X=X?X.concat(q):q),G==null?(a(xe,ce,Me),a(Se,ce,Me),N(J.children||[],ce,Se,Be,De,Le,X,fe)):_e>0&&_e&64&&W&&G.dynamicChildren&&G.dynamicChildren.length===W.length?(V(G.dynamicChildren,W,ce,Be,De,Le,X),(J.key!=null||Be&&J===Be.subTree)&&Ku(G,J,!0)):U(G,J,ce,Se,Be,De,Le,X,fe)},Q=(G,J,ce,Me,Be,De,Le,X,fe)=>{J.slotScopeIds=X,G==null?J.shapeFlag&512?Be.ctx.activate(J,ce,Me,Le,fe):ae(J,ce,Me,Be,De,Le,fe):pe(G,J,fe)},ae=(G,J,ce,Me,Be,De,Le)=>{const X=G.component=sy(G,Me,Be);if(oc(G)&&(X.ctx.renderer=ge),ay(X,!1,Le),X.asyncDep){if(Be&&Be.registerDep(X,ne,Le),!G.el){const fe=X.subTree=Ae(Rn);$(null,fe,J,ce),G.placeholder=fe.el}}else ne(X,G,J,ce,Be,De,Le)},pe=(G,J,ce)=>{const Me=J.component=G.component;if(Ug(G,J,ce))if(Me.asyncDep&&!Me.asyncResolved){oe(Me,J,ce);return}else Me.next=J,Me.update();else J.el=G.el,Me.vnode=J},ne=(G,J,ce,Me,Be,De,Le)=>{const X=()=>{if(G.isMounted){let{next:_e,bu:W,u:q,parent:K,vnode:le}=G;{const Lt=Ap(G);if(Lt){_e&&(_e.el=le.el,oe(G,_e,Le)),Lt.asyncDep.then(()=>{G.isUnmounted||X()});return}}let Ee=_e,Ke;Ga(G,!1),_e?(_e.el=le.el,oe(G,_e,Le)):_e=le,W&&gr(W),(Ke=_e.props&&_e.props.onVnodeBeforeUpdate)&&us(Ke,K,_e,le),Ga(G,!0);const Qe=Vd(G),gt=G.subTree;G.subTree=Qe,C(gt,Qe,g(gt.el),ee(gt),G,Be,De),_e.el=Qe.el,Ee===null&&zg(G,Qe.el),q&&Zn(q,Be),(Ke=_e.props&&_e.props.onVnodeUpdated)&&Zn(()=>us(Ke,K,_e,le),Be)}else{let _e;const{el:W,props:q}=J,{bm:K,m:le,parent:Ee,root:Ke,type:Qe}=G,gt=Ni(J);Ga(G,!1),K&&gr(K),!gt&&(_e=q&&q.onVnodeBeforeMount)&&us(_e,Ee,J),Ga(G,!0);{Ke.ce&&Ke.ce._def.shadowRoot!==!1&&Ke.ce._injectChildStyle(Qe);const Lt=G.subTree=Vd(G);C(null,Lt,ce,Me,G,Be,De),J.el=Lt.el}if(le&&Zn(le,Be),!gt&&(_e=q&&q.onVnodeMounted)){const Lt=J;Zn(()=>us(_e,Ee,Lt),Be)}(J.shapeFlag&256||Ee&&Ni(Ee.vnode)&&Ee.vnode.shapeFlag&256)&&G.a&&Zn(G.a,Be),G.isMounted=!0,J=ce=Me=null}};G.scope.on();const fe=G.effect=new Tf(X);G.scope.off();const xe=G.update=fe.run.bind(fe),Se=G.job=fe.runIfDirty.bind(fe);Se.i=G,Se.id=G.uid,fe.scheduler=()=>ju(Se),Ga(G,!0),xe()},oe=(G,J,ce)=>{J.component=G;const Me=G.vnode.props;G.vnode=J,G.next=null,Vg(G,J.props,Me,ce),Wg(G,J.children,ce),zs(),Ed(G),Hs()},U=(G,J,ce,Me,Be,De,Le,X,fe=!1)=>{const xe=G&&G.children,Se=G?G.shapeFlag:0,_e=J.children,{patchFlag:W,shapeFlag:q}=J;if(W>0){if(W&128){de(xe,_e,ce,Me,Be,De,Le,X,fe);return}else if(W&256){Y(xe,_e,ce,Me,Be,De,Le,X,fe);return}}q&8?(Se&16&&We(xe,Be,De),_e!==xe&&p(ce,_e)):Se&16?q&16?de(xe,_e,ce,Me,Be,De,Le,X,fe):We(xe,Be,De,!0):(Se&8&&p(ce,""),q&16&&N(_e,ce,Me,Be,De,Le,X,fe))},Y=(G,J,ce,Me,Be,De,Le,X,fe)=>{G=G||Oi,J=J||Oi;const xe=G.length,Se=J.length,_e=Math.min(xe,Se);let W;for(W=0;W<_e;W++){const q=J[W]=fe?ga(J[W]):fs(J[W]);C(G[W],q,ce,null,Be,De,Le,X,fe)}xe>Se?We(G,Be,De,!0,!1,_e):N(J,ce,Me,Be,De,Le,X,fe,_e)},de=(G,J,ce,Me,Be,De,Le,X,fe)=>{let xe=0;const Se=J.length;let _e=G.length-1,W=Se-1;for(;xe<=_e&&xe<=W;){const q=G[xe],K=J[xe]=fe?ga(J[xe]):fs(J[xe]);if(Ka(q,K))C(q,K,ce,null,Be,De,Le,X,fe);else break;xe++}for(;xe<=_e&&xe<=W;){const q=G[_e],K=J[W]=fe?ga(J[W]):fs(J[W]);if(Ka(q,K))C(q,K,ce,null,Be,De,Le,X,fe);else break;_e--,W--}if(xe>_e){if(xe<=W){const q=W+1,K=q<Se?J[q].el:Me;for(;xe<=W;)C(null,J[xe]=fe?ga(J[xe]):fs(J[xe]),ce,K,Be,De,Le,X,fe),xe++}}else if(xe>W)for(;xe<=_e;)Re(G[xe],Be,De,!0),xe++;else{const q=xe,K=xe,le=new Map;for(xe=K;xe<=W;xe++){const kt=J[xe]=fe?ga(J[xe]):fs(J[xe]);kt.key!=null&&le.set(kt.key,xe)}let Ee,Ke=0;const Qe=W-K+1;let gt=!1,Lt=0;const yt=new Array(Qe);for(xe=0;xe<Qe;xe++)yt[xe]=0;for(xe=q;xe<=_e;xe++){const kt=G[xe];if(Ke>=Qe){Re(kt,Be,De,!0);continue}let Ut;if(kt.key!=null)Ut=le.get(kt.key);else for(Ee=K;Ee<=W;Ee++)if(yt[Ee-K]===0&&Ka(kt,J[Ee])){Ut=Ee;break}Ut===void 0?Re(kt,Be,De,!0):(yt[Ut-K]=xe+1,Ut>=Lt?Lt=Ut:gt=!0,C(kt,J[Ut],ce,null,Be,De,Le,X,fe),Ke++)}const xt=gt?Yg(yt):Oi;for(Ee=xt.length-1,xe=Qe-1;xe>=0;xe--){const kt=K+xe,Ut=J[kt],Rt=J[kt+1],ct=kt+1<Se?Rt.el||Ep(Rt):Me;yt[xe]===0?C(null,Ut,ce,ct,Be,De,Le,X,fe):gt&&(Ee<0||xe!==xt[Ee]?ke(Ut,ce,ct,2):Ee--)}}},ke=(G,J,ce,Me,Be=null)=>{const{el:De,type:Le,transition:X,children:fe,shapeFlag:xe}=G;if(xe&6){ke(G.component.subTree,J,ce,Me);return}if(xe&128){G.suspense.move(J,ce,Me);return}if(xe&64){Le.move(G,J,ce,ge);return}if(Le===Ie){a(De,J,ce);for(let _e=0;_e<fe.length;_e++)ke(fe[_e],J,ce,Me);a(G.anchor,J,ce);return}if(Le===xl){S(G,J,ce);return}if(Me!==2&&xe&1&&X)if(Me===0)X.beforeEnter(De),a(De,J,ce),Zn(()=>X.enter(De),Be);else{const{leave:_e,delayLeave:W,afterLeave:q}=X,K=()=>{G.ctx.isUnmounted?s(De):a(De,J,ce)},le=()=>{De._isLeaving&&De[Es](!0),_e(De,()=>{K(),q&&q()})};W?W(De,K,le):le()}else a(De,J,ce)},Re=(G,J,ce,Me=!1,Be=!1)=>{const{type:De,props:Le,ref:X,children:fe,dynamicChildren:xe,shapeFlag:Se,patchFlag:_e,dirs:W,cacheIndex:q}=G;if(_e===-2&&(Be=!1),X!=null&&(zs(),Ll(X,null,ce,G,!0),Hs()),q!=null&&(J.renderCache[q]=void 0),Se&256){J.ctx.deactivate(G);return}const K=Se&1&&W,le=!Ni(G);let Ee;if(le&&(Ee=Le&&Le.onVnodeBeforeUnmount)&&us(Ee,J,G),Se&6)ze(G.component,ce,Me);else{if(Se&128){G.suspense.unmount(ce,Me);return}K&&Va(G,null,J,"beforeUnmount"),Se&64?G.type.remove(G,J,ce,ge,Me):xe&&!xe.hasOnce&&(De!==Ie||_e>0&&_e&64)?We(xe,J,ce,!1,!0):(De===Ie&&_e&384||!Be&&Se&16)&&We(fe,J,ce),Me&&Xe(G)}(le&&(Ee=Le&&Le.onVnodeUnmounted)||K)&&Zn(()=>{Ee&&us(Ee,J,G),K&&Va(G,null,J,"unmounted")},ce)},Xe=G=>{const{type:J,el:ce,anchor:Me,transition:Be}=G;if(J===Ie){Ne(ce,Me);return}if(J===xl){B(G);return}const De=()=>{s(ce),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(G.shapeFlag&1&&Be&&!Be.persisted){const{leave:Le,delayLeave:X}=Be,fe=()=>Le(ce,De);X?X(G.el,De,fe):fe()}else De()},Ne=(G,J)=>{let ce;for(;G!==J;)ce=y(G),s(G),G=ce;s(J)},ze=(G,J,ce)=>{const{bum:Me,scope:Be,job:De,subTree:Le,um:X,m:fe,a:xe}=G;Zd(fe),Zd(xe),Me&&gr(Me),Be.stop(),De&&(De.flags|=8,Re(Le,G,J,ce)),X&&Zn(X,J),Zn(()=>{G.isUnmounted=!0},J)},We=(G,J,ce,Me=!1,Be=!1,De=0)=>{for(let Le=De;Le<G.length;Le++)Re(G[Le],J,ce,Me,Be)},ee=G=>{if(G.shapeFlag&6)return ee(G.component.subTree);if(G.shapeFlag&128)return G.suspense.next();const J=y(G.anchor||G.el),ce=J&&J[ep];return ce?y(ce):J};let ye=!1;const te=(G,J,ce)=>{let Me;G==null?J._vnode&&(Re(J._vnode,null,null,!0),Me=J._vnode.component):C(J._vnode||null,G,J,null,null,null,ce),J._vnode=G,ye||(ye=!0,Ed(Me),Kf(),ye=!1)},ge={p:C,um:Re,m:ke,r:Xe,mt:ae,mc:N,pc:U,pbc:V,n:ee,o:e};return{render:te,hydrate:void 0,createApp:Dg(te)}}function Nc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Ga({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Jg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Ku(e,t,o=!1){const a=e.children,s=t.children;if(lt(a)&&lt(s))for(let i=0;i<a.length;i++){const r=a[i];let u=s[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[i]=ga(s[i]),u.el=r.el),!o&&u.patchFlag!==-2&&Ku(r,u)),u.type===ic&&(u.patchFlag!==-1?u.el=r.el:u.__elIndex=i+(e.type===Ie?1:0)),u.type===Rn&&!u.el&&(u.el=r.el)}}function Yg(e){const t=e.slice(),o=[0];let a,s,i,r,u;const d=e.length;for(a=0;a<d;a++){const f=e[a];if(f!==0){if(s=o[o.length-1],e[s]<f){t[a]=s,o.push(a);continue}for(i=0,r=o.length-1;i<r;)u=i+r>>1,e[o[u]]<f?i=u+1:r=u;f<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,r=o[i-1];i-- >0;)o[i]=r,r=t[r];return o}function Ap(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ap(t)}function Zd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Ep(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Ep(t.subTree):null}const Pp=e=>e.__isSuspense;function Xg(e,t){t&&t.pendingBranch?lt(e)?t.effects.push(...e):t.effects.push(e):qf(e)}const Ie=Symbol.for("v-fgt"),ic=Symbol.for("v-txt"),Rn=Symbol.for("v-cmt"),xl=Symbol.for("v-stc"),Il=[];let bo=null;function v(e=!1){Il.push(bo=e?null:[])}function Qg(){Il.pop(),bo=Il[Il.length-1]||null}let Ol=1;function Pr(e,t=!1){Ol+=e,e<0&&bo&&t&&(bo.hasOnce=!0)}function Dp(e){return e.dynamicChildren=Ol>0?bo||Oi:null,Qg(),Ol>0&&bo&&bo.push(e),e}function m(e,t,o,a,s,i){return Dp(l(e,t,o,a,s,i,!0))}function qe(e,t,o,a,s){return Dp(Ae(e,t,o,a,s,!0))}function Rl(e){return e?e.__v_isVNode===!0:!1}function Ka(e,t){return e.type===t.type&&e.key===t.key}const Op=({key:e})=>e??null,kr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?en(e)||Qt(e)||pt(e)?{i:Tn,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,a=0,s=null,i=e===Ie?0:1,r=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Op(t),ref:t&&kr(t),scopeId:Yf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Tn};return u?(Ju(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=en(o)?8:16),Ol>0&&!r&&bo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&bo.push(d),d}const Ae=ey;function ey(e,t=null,o=null,a=0,s=null,i=!1){if((!e||e===vp)&&(e=Rn),Rl(e)){const u=xa(e,t,!0);return o&&Ju(u,o),Ol>0&&!i&&bo&&(u.shapeFlag&6?bo[bo.indexOf(e)]=u:bo.push(u)),u.patchFlag=-2,u}if(uy(e)&&(e=e.__vccOpts),t){t=ty(t);let{class:u,style:d}=t;u&&!en(u)&&(t.class=ve(u)),Ft(d)&&(tc(d)&&!lt(d)&&(d=gn({},d)),t.style=et(d))}const r=en(e)?1:Pp(e)?128:tp(e)?64:Ft(e)?4:pt(e)?2:0;return l(e,t,o,a,s,r,i,!0)}function ty(e){return e?tc(e)||Sp(e)?gn({},e):e:null}function xa(e,t,o=!1,a=!1){const{props:s,ref:i,patchFlag:r,children:u,transition:d}=e,f=t?Rp(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&Op(f),ref:t&&t.ref?o&&i?lt(i)?i.concat(kr(t)):[i,kr(t)]:kr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ie?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&xa(e.ssContent),ssFallback:e.ssFallback&&xa(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Dl(p,d.clone(p)),p}function Ye(e=" ",t=0){return Ae(ic,null,e,t)}function Dr(e,t){const o=Ae(xl,null,e);return o.staticCount=t,o}function E(e="",t=!1){return t?(v(),qe(Rn,null,e)):Ae(Rn,null,e)}function fs(e){return e==null||typeof e=="boolean"?Ae(Rn):lt(e)?Ae(Ie,null,e.slice()):Rl(e)?ga(e):Ae(ic,null,String(e))}function ga(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:xa(e)}function Ju(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(lt(t))o=16;else if(typeof t=="object")if(a&65){const s=t.default;s&&(s._c&&(s._d=!1),Ju(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Sp(t)?t._ctx=Tn:s===3&&Tn&&(Tn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else pt(t)?(t={default:t,_ctx:Tn},o=32):(t=String(t),a&64?(o=16,t=[Ye(t)]):o=8);e.children=t,e.shapeFlag|=o}function Rp(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const s in a)if(s==="class")t.class!==a.class&&(t.class=ve([t.class,a.class]));else if(s==="style")t.style=et([t.style,a.style]);else if(qr(s)){const i=t[s],r=a[s];r&&i!==r&&!(lt(i)&&i.includes(r))&&(t[s]=i?[].concat(i,r):r)}else s!==""&&(t[s]=a[s])}return t}function us(e,t,o,a=null){ts(e,t,7,[o,a])}const ny=bp();let oy=0;function sy(e,t,o){const a=e.type,s=(t?t.appContext:e.appContext)||ny,i={uid:oy++,vnode:e,type:a,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new xf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ip(a,s),emitsOptions:wp(a,s),emit:null,emitted:null,propsDefaults:Gt,inheritAttrs:a.inheritAttrs,ctx:Gt,data:Gt,props:Gt,attrs:Gt,slots:Gt,refs:Gt,setupState:Gt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Rg.bind(null,i),e.ce&&e.ce(i),i}let Bn=null;const lc=()=>Bn||Tn;let Or,uu;{const e=Qr(),t=(o,a)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(a),i=>{s.length>1?s.forEach(r=>r(i)):s[0](i)}};Or=t("__VUE_INSTANCE_SETTERS__",o=>Bn=o),uu=t("__VUE_SSR_SETTERS__",o=>Bl=o)}const Gl=e=>{const t=Bn;return Or(e),e.scope.on(),()=>{e.scope.off(),Or(t)}},Wd=()=>{Bn&&Bn.scope.off(),Or(null)};function Bp(e){return e.vnode.shapeFlag&4}let Bl=!1;function ay(e,t=!1,o=!1){t&&uu(t);const{props:a,children:s}=e.vnode,i=Bp(e);Hg(e,a,i,t),Zg(e,s,o||t);const r=i?iy(e,t):void 0;return t&&uu(!1),r}function iy(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Ig);const{setup:a}=o;if(a){zs();const s=e.setupContext=a.length>1?ry(e):null,i=Gl(e),r=Vl(a,e,0,[e.props,s]),u=kf(r);if(Hs(),i(),(u||e.sp)&&!Ni(e)&&up(e),u){if(r.then(Wd,Wd),t)return r.then(d=>{qd(e,d)}).catch(d=>{nc(d,e,0)});e.asyncDep=r}else qd(e,r)}else Np(e)}function qd(e,t,o){pt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ft(t)&&(e.setupState=jf(t)),Np(e)}function Np(e,t,o){const a=e.type;e.render||(e.render=a.render||Yo);{const s=Gl(e);zs();try{$g(e)}finally{Hs(),s()}}}const ly={get(e,t){return On(e,"get",""),e[t]}};function ry(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,ly),slots:e.slots,emit:e.emit,expose:t}}function rc(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(jf(Gu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Sl)return Sl[o](e)},has(t,o){return o in t||o in Sl}})):e.proxy}function cy(e,t=!0){return pt(e)?e.displayName||e.name:e.name||t&&e.__name}function uy(e){return pt(e)&&"__vccOpts"in e}const F=(e,t)=>sg(e,t,Bl);function Yu(e,t,o){try{Pr(-1);const a=arguments.length;return a===2?Ft(t)&&!lt(t)?Rl(t)?Ae(e,null,[t]):Ae(e,t):Ae(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&Rl(o)&&(o=[o]),Ae(e,t,o))}finally{Pr(1)}}const dy="3.5.26";let du;const Kd=typeof window<"u"&&window.trustedTypes;if(Kd)try{du=Kd.createPolicy("vue",{createHTML:e=>e})}catch{}const Fp=du?e=>du.createHTML(e):e=>e,hy="http://www.w3.org/2000/svg",fy="http://www.w3.org/1998/Math/MathML",As=typeof document<"u"?document:null,Jd=As&&As.createElement("template"),py={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const s=t==="svg"?As.createElementNS(hy,e):t==="mathml"?As.createElementNS(fy,e):o?As.createElement(e,{is:o}):As.createElement(e);return e==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:e=>As.createTextNode(e),createComment:e=>As.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>As.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,s,i){const r=o?o.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===i||!(s=s.nextSibling)););else{Jd.innerHTML=Fp(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=Jd.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[r?r.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},da="transition",dl="animation",Nl=Symbol("_vtc"),Up={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},vy=gn({},sp,Up),my=e=>(e.displayName="Transition",e.props=vy,e),ys=my((e,{slots:t})=>Yu(mg,gy(e),t)),ja=(e,t=[])=>{lt(e)?e.forEach(o=>o(...t)):e&&e(...t)},Yd=e=>e?lt(e)?e.some(t=>t.length>1):e.length>1:!1;function gy(e){const t={};for(const j in e)j in Up||(t[j]=e[j]);if(e.css===!1)return t;const{name:o="v",type:a,duration:s,enterFromClass:i=`${o}-enter-from`,enterActiveClass:r=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:f=r,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:k=`${o}-leave-to`}=e,b=yy(s),C=b&&b[0],x=b&&b[1],{onBeforeEnter:$,onEnter:I,onEnterCancelled:S,onLeave:B,onLeaveCancelled:R,onBeforeAppear:Z=$,onAppear:A=I,onAppearCancelled:N=S}=t,O=(j,Q,ae,pe)=>{j._enterCancelled=pe,Za(j,Q?p:u),Za(j,Q?f:r),ae&&ae()},V=(j,Q)=>{j._isLeaving=!1,Za(j,g),Za(j,k),Za(j,y),Q&&Q()},P=j=>(Q,ae)=>{const pe=j?A:I,ne=()=>O(Q,j,ae);ja(pe,[Q,ne]),Xd(()=>{Za(Q,j?d:i),Ts(Q,j?p:u),Yd(pe)||Qd(Q,a,C,ne)})};return gn(t,{onBeforeEnter(j){ja($,[j]),Ts(j,i),Ts(j,r)},onBeforeAppear(j){ja(Z,[j]),Ts(j,d),Ts(j,f)},onEnter:P(!1),onAppear:P(!0),onLeave(j,Q){j._isLeaving=!0;const ae=()=>V(j,Q);Ts(j,g),j._enterCancelled?(Ts(j,y),nh(j)):(nh(j),Ts(j,y)),Xd(()=>{j._isLeaving&&(Za(j,g),Ts(j,k),Yd(B)||Qd(j,a,x,ae))}),ja(B,[j,ae])},onEnterCancelled(j){O(j,!1,void 0,!0),ja(S,[j])},onAppearCancelled(j){O(j,!0,void 0,!0),ja(N,[j])},onLeaveCancelled(j){V(j),ja(R,[j])}})}function yy(e){if(e==null)return null;if(Ft(e))return[Fc(e.enter),Fc(e.leave)];{const t=Fc(e);return[t,t]}}function Fc(e){return wm(e)}function Ts(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Nl]||(e[Nl]=new Set)).add(t)}function Za(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Nl];o&&(o.delete(t),o.size||(e[Nl]=void 0))}function Xd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let ky=0;function Qd(e,t,o,a){const s=e._endId=++ky,i=()=>{s===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:r,timeout:u,propCount:d}=_y(e,t);if(!r)return a();const f=r+"end";let p=0;const g=()=>{e.removeEventListener(f,y),i()},y=k=>{k.target===e&&++p>=d&&g()};setTimeout(()=>{p<d&&g()},u+1),e.addEventListener(f,y)}function _y(e,t){const o=window.getComputedStyle(e),a=b=>(o[b]||"").split(", "),s=a(`${da}Delay`),i=a(`${da}Duration`),r=eh(s,i),u=a(`${dl}Delay`),d=a(`${dl}Duration`),f=eh(u,d);let p=null,g=0,y=0;t===da?r>0&&(p=da,g=r,y=i.length):t===dl?f>0&&(p=dl,g=f,y=d.length):(g=Math.max(r,f),p=g>0?r>f?da:dl:null,y=p?p===da?i.length:d.length:0);const k=p===da&&/\b(?:transform|all)(?:,|$)/.test(a(`${da}Property`).toString());return{type:p,timeout:g,propCount:y,hasTransform:k}}function eh(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>th(o)+th(e[a])))}function th(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function nh(e){return(e?e.ownerDocument:document).body.offsetHeight}function by(e,t,o){const a=e[Nl];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Rr=Symbol("_vod"),zp=Symbol("_vsh"),ks={name:"show",beforeMount(e,{value:t},{transition:o}){e[Rr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):hl(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),hl(e,!0),a.enter(e)):a.leave(e,()=>{hl(e,!1)}):hl(e,t))},beforeUnmount(e,{value:t}){hl(e,t)}};function hl(e,t){e.style.display=t?e[Rr]:"none",e[zp]=!t}const Hp=Symbol("");function wy(e){const t=lc();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Br(i,s))},a=()=>{const s=e(t.proxy);t.ce?Br(t.ce,s):hu(t.subTree,s),o(s)};hp(()=>{qf(a)}),tn(()=>{Ze(a,Yo,{flush:"post"});const s=new MutationObserver(a);s.observe(t.subTree.el.parentNode,{childList:!0}),yn(()=>s.disconnect())})}function hu(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{hu(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Br(e.el,t);else if(e.type===Ie)e.children.forEach(o=>hu(o,t));else if(e.type===xl){let{el:o,anchor:a}=e;for(;o&&(Br(o,t),o!==a);)o=o.nextSibling}}function Br(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const s in t){const i=Mm(t[s]);o.setProperty(`--${s}`,i),a+=`--${s}: ${i};`}o[Hp]=a}}const Cy=/(?:^|;)\s*display\s*:/;function Ly(e,t,o){const a=e.style,s=en(o);let i=!1;if(o&&!s){if(t)if(en(t))for(const r of t.split(";")){const u=r.slice(0,r.indexOf(":")).trim();o[u]==null&&_r(a,u,"")}else for(const r in t)o[r]==null&&_r(a,r,"");for(const r in o)r==="display"&&(i=!0),_r(a,r,o[r])}else if(s){if(t!==o){const r=a[Hp];r&&(o+=";"+r),a.cssText=o,i=Cy.test(o)}}else t&&e.removeAttribute("style");Rr in e&&(e[Rr]=i?a.display:"",e[zp]&&(a.display="none"))}const oh=/\s*!important$/;function _r(e,t,o){if(lt(o))o.forEach(a=>_r(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Sy(e,t);oh.test(o)?e.setProperty(Ta(a),o.replace(oh,""),"important"):e[a]=o}}const sh=["Webkit","Moz","ms"],Uc={};function Sy(e,t){const o=Uc[t];if(o)return o;let a=Ro(t);if(a!=="filter"&&a in e)return Uc[t]=a;a=Yr(a);for(let s=0;s<sh.length;s++){const i=sh[s]+a;if(i in e)return Uc[t]=i}return t}const ah="http://www.w3.org/1999/xlink";function ih(e,t,o,a,s,i=$m(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(ah,t.slice(6,t.length)):e.setAttributeNS(ah,t,o):o==null||i&&!Cf(o)?e.removeAttribute(t):e.setAttribute(t,i?"":Qo(o)?String(o):o)}function lh(e,t,o,a,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Fp(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let r=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Cf(o):o==null&&u==="string"?(o="",r=!0):u==="number"&&(o=0,r=!0)}try{e[t]=o}catch{}r&&e.removeAttribute(s||t)}function Rs(e,t,o,a){e.addEventListener(t,o,a)}function xy(e,t,o,a){e.removeEventListener(t,o,a)}const rh=Symbol("_vei");function Iy(e,t,o,a,s=null){const i=e[rh]||(e[rh]={}),r=i[t];if(a&&r)r.value=a;else{const[u,d]=$y(t);if(a){const f=i[t]=Ay(a,s);Rs(e,u,f,d)}else r&&(xy(e,u,r,d),i[t]=void 0)}}const ch=/(?:Once|Passive|Capture)$/;function $y(e){let t;if(ch.test(e)){t={};let a;for(;a=e.match(ch);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ta(e.slice(2)),t]}let zc=0;const Ty=Promise.resolve(),My=()=>zc||(Ty.then(()=>zc=0),zc=Date.now());function Ay(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;ts(Ey(a,o.value),t,5,[a])};return o.value=e,o.attached=My(),o}function Ey(e,t){if(lt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>s=>!s._stopped&&a&&a(s))}else return t}const uh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Py=(e,t,o,a,s,i)=>{const r=s==="svg";t==="class"?by(e,a,r):t==="style"?Ly(e,o,a):qr(t)?Ou(t)||Iy(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Dy(e,t,a,r))?(lh(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&ih(e,t,a,r,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!en(a))?lh(e,Ro(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),ih(e,t,a,r))};function Dy(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&uh(t)&&pt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return uh(t)&&en(o)?!1:t in e}const Ia=e=>{const t=e.props["onUpdate:modelValue"]||!1;return lt(t)?o=>gr(t,o):t};function Oy(e){e.target.composing=!0}function dh(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Oo=Symbol("_assign");function hh(e,t,o){return t&&(e=e.trim()),o&&(e=Xr(e)),e}const at={created(e,{modifiers:{lazy:t,trim:o,number:a}},s){e[Oo]=Ia(s);const i=a||s.props&&s.props.type==="number";Rs(e,t?"change":"input",r=>{r.target.composing||e[Oo](hh(e.value,o,i))}),(o||i)&&Rs(e,"change",()=>{e.value=hh(e.value,o,i)}),t||(Rs(e,"compositionstart",Oy),Rs(e,"compositionend",dh),Rs(e,"change",dh))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:s,number:i}},r){if(e[Oo]=Ia(r),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Xr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Gs={deep:!0,created(e,t,o){e[Oo]=Ia(o),Rs(e,"change",()=>{const a=e._modelValue,s=zi(e),i=e.checked,r=e[Oo];if(lt(a)){const u=Bu(a,s),d=u!==-1;if(i&&!d)r(a.concat(s));else if(!i&&d){const f=[...a];f.splice(u,1),r(f)}}else if(ji(a)){const u=new Set(a);i?u.add(s):u.delete(s),r(u)}else r(Vp(e,i))})},mounted:fh,beforeUpdate(e,t,o){e[Oo]=Ia(o),fh(e,t,o)}};function fh(e,{value:t,oldValue:o},a){e._modelValue=t;let s;if(lt(t))s=Bu(t,a.props.value)>-1;else if(ji(t))s=t.has(a.props.value);else{if(t===o)return;s=si(t,Vp(e,!0))}e.checked!==s&&(e.checked=s)}const ph={created(e,{value:t},o){e.checked=si(t,o.props.value),e[Oo]=Ia(o),Rs(e,"change",()=>{e[Oo](zi(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Oo]=Ia(a),t!==o&&(e.checked=si(t,a.props.value))}},Nn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const s=ji(t);Rs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,r=>r.selected).map(r=>o?Xr(zi(r)):zi(r));e[Oo](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,sn(()=>{e._assigning=!1})}),e[Oo]=Ia(a)},mounted(e,{value:t}){vh(e,t)},beforeUpdate(e,t,o){e[Oo]=Ia(o)},updated(e,{value:t}){e._assigning||vh(e,t)}};function vh(e,t){const o=e.multiple,a=lt(t);if(!(o&&!a&&!ji(t))){for(let s=0,i=e.options.length;s<i;s++){const r=e.options[s],u=zi(r);if(o)if(a){const d=typeof u;d==="string"||d==="number"?r.selected=t.some(f=>String(f)===String(u)):r.selected=Bu(t,u)>-1}else r.selected=t.has(u);else if(si(zi(r),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function zi(e){return"_value"in e?e._value:e.value}function Vp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Ry=["ctrl","shift","alt","meta"],By={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Ry.some(o=>e[`${o}Key`]&&!t.includes(o))},it=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((s,...i)=>{for(let r=0;r<t.length;r++){const u=By[t[r]];if(u&&u(s,t))return}return e(s,...i)}))},Ny={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},vs=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(s=>{if(!("key"in s))return;const i=Ta(s.key);if(t.some(r=>r===i||Ny[r]===i))return e(s)}))},Fy=gn({patchProp:Py},py);let mh;function Uy(){return mh||(mh=qg(Fy))}const zy=((...e)=>{const t=Uy().createApp(...e),{mount:o}=t;return t.mount=a=>{const s=Vy(a);if(!s)return;const i=t._component;!pt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const r=o(s,!1,Hy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t});function Hy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Vy(e){return en(e)?document.querySelector(e):e}let Gp;const cc=e=>Gp=e,jp=Symbol();function fu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var $l;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})($l||($l={}));function Gy(){const e=If(!0),t=e.run(()=>M({}));let o=[],a=[];const s=Gu({install(i){cc(s),s._a=i,i.provide(jp,s),i.config.globalProperties.$pinia=s,a.forEach(r=>o.push(r)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Zp=()=>{};function gh(e,t,o,a=Zp){e.add(t);const s=()=>{e.delete(t)&&a()};return!o&&$f()&&Am(s),s}function Ti(e,...t){e.forEach(o=>{o(...t)})}const jy=e=>e(),yh=Symbol(),Hc=Symbol();function pu(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],s=e[o];fu(s)&&fu(a)&&e.hasOwnProperty(o)&&!Qt(a)&&!Us(a)?e[o]=pu(s,a):e[o]=a}return e}const Zy=Symbol();function Wy(e){return!fu(e)||!Object.prototype.hasOwnProperty.call(e,Zy)}const{assign:fa}=Object;function qy(e){return!!(Qt(e)&&e.effect)}function Ky(e,t,o,a){const{state:s,actions:i,getters:r}=t,u=o.state.value[e];let d;function f(){u||(o.state.value[e]=s?s():{});const p=eg(o.state.value[e]);return fa(p,i,Object.keys(r||{}).reduce((g,y)=>(g[y]=Gu(F(()=>{cc(o);const k=o._s.get(e);return r[y].call(k,k)})),g),{}))}return d=Wp(e,f,t,o,a,!0),d}function Wp(e,t,o={},a,s,i){let r;const u=fa({actions:{}},o),d={deep:!0};let f,p,g=new Set,y=new Set,k;const b=a.state.value[e];!i&&!b&&(a.state.value[e]={}),M({});let C;function x(N){let O;f=p=!1,typeof N=="function"?(N(a.state.value[e]),O={type:$l.patchFunction,storeId:e,events:k}):(pu(a.state.value[e],N),O={type:$l.patchObject,payload:N,storeId:e,events:k});const V=C=Symbol();sn().then(()=>{C===V&&(f=!0)}),p=!0,Ti(g,O,a.state.value[e])}const $=i?function(){const{state:O}=o,V=O?O():{};this.$patch(P=>{fa(P,V)})}:Zp;function I(){r.stop(),g.clear(),y.clear(),a._s.delete(e)}const S=(N,O="")=>{if(yh in N)return N[Hc]=O,N;const V=function(){cc(a);const P=Array.from(arguments),j=new Set,Q=new Set;function ae(oe){j.add(oe)}function pe(oe){Q.add(oe)}Ti(y,{args:P,name:V[Hc],store:R,after:ae,onError:pe});let ne;try{ne=N.apply(this&&this.$id===e?this:R,P)}catch(oe){throw Ti(Q,oe),oe}return ne instanceof Promise?ne.then(oe=>(Ti(j,oe),oe)).catch(oe=>(Ti(Q,oe),Promise.reject(oe))):(Ti(j,ne),ne)};return V[yh]=!0,V[Hc]=O,V},B={_p:a,$id:e,$onAction:gh.bind(null,y),$patch:x,$reset:$,$subscribe(N,O={}){const V=gh(g,N,O.detached,()=>P()),P=r.run(()=>Ze(()=>a.state.value[e],j=>{(O.flush==="sync"?p:f)&&N({storeId:e,type:$l.direct,events:k},j)},fa({},d,O)));return V},$dispose:I},R=ii(B);a._s.set(e,R);const A=(a._a&&a._a.runWithContext||jy)(()=>a._e.run(()=>(r=If()).run(()=>t({action:S}))));for(const N in A){const O=A[N];if(Qt(O)&&!qy(O)||Us(O))i||(b&&Wy(O)&&(Qt(O)?O.value=b[N]:pu(O,b[N])),a.state.value[e][N]=O);else if(typeof O=="function"){const V=S(O,N);A[N]=V,u.actions[N]=O}}return fa(R,A),fa(Mt(R),A),Object.defineProperty(R,"$state",{get:()=>a.state.value[e],set:N=>{x(O=>{fa(O,N)})}}),a._p.forEach(N=>{fa(R,r.run(()=>N({store:R,app:a._a,pinia:a,options:u})))}),b&&i&&o.hydrate&&o.hydrate(R.$state,b),f=!0,p=!0,R}function Xu(e,t,o){let a;const s=typeof t=="function";a=s?o:t;function i(r,u){const d=cg();return r=r||(d?ro(jp,null):null),r&&cc(r),r=Gp,r._s.has(e)||(s?Wp(e,t,a,r):Ky(e,a,r)),r._s.get(e)}return i.$id=e,i}const Ai=typeof document<"u";function qp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Jy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&qp(e.default)}const Pt=Object.assign;function Vc(e,t){const o={};for(const a in t){const s=t[a];o[a]=ns(s)?s.map(e):e(s)}return o}const Tl=()=>{},ns=Array.isArray;function kh(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const Kp=/#/g,Yy=/&/g,Xy=/\//g,Qy=/=/g,e1=/\?/g,Jp=/\+/g,t1=/%5B/g,n1=/%5D/g,Yp=/%5E/g,o1=/%60/g,Xp=/%7B/g,s1=/%7C/g,Qp=/%7D/g,a1=/%20/g;function Qu(e){return e==null?"":encodeURI(""+e).replace(s1,"|").replace(t1,"[").replace(n1,"]")}function i1(e){return Qu(e).replace(Xp,"{").replace(Qp,"}").replace(Yp,"^")}function vu(e){return Qu(e).replace(Jp,"%2B").replace(a1,"+").replace(Kp,"%23").replace(Yy,"%26").replace(o1,"`").replace(Xp,"{").replace(Qp,"}").replace(Yp,"^")}function l1(e){return vu(e).replace(Qy,"%3D")}function r1(e){return Qu(e).replace(Kp,"%23").replace(e1,"%3F")}function c1(e){return r1(e).replace(Xy,"%2F")}function Fl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const u1=/\/$/,d1=e=>e.replace(u1,"");function Gc(e,t,o="/"){let a,s={},i="",r="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),s=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),r=t.slice(u,t.length)),a=v1(a??t,o),{fullPath:a+i+r,path:a,query:s,hash:Fl(r)}}function h1(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function _h(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function f1(e,t,o){const a=t.matched.length-1,s=o.matched.length-1;return a>-1&&a===s&&Hi(t.matched[a],o.matched[s])&&ev(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Hi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ev(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!p1(e[o],t[o]))return!1;return!0}function p1(e,t){return ns(e)?bh(e,t):ns(t)?bh(t,e):e?.valueOf()===t?.valueOf()}function bh(e,t){return ns(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function v1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),s=a[a.length-1];(s===".."||s===".")&&a.push("");let i=o.length-1,r,u;for(r=0;r<a.length;r++)if(u=a[r],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(r).join("/")}const ha={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let mu=(function(e){return e.pop="pop",e.push="push",e})({}),jc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function m1(e){if(!e)if(Ai){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),d1(e)}const g1=/^[^#]+#/;function y1(e,t){return e.replace(g1,"#")+t}function k1(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const uc=()=>({left:window.scrollX,top:window.scrollY});function _1(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=k1(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function wh(e,t){return(history.state?history.state.position-t:-1)+e}const gu=new Map;function b1(e,t){gu.set(e,t)}function w1(e){const t=gu.get(e);return gu.delete(e),t}function C1(e){return typeof e=="string"||e&&typeof e=="object"}function tv(e){return typeof e=="string"||typeof e=="symbol"}let on=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const nv=Symbol("");on.MATCHER_NOT_FOUND+"",on.NAVIGATION_GUARD_REDIRECT+"",on.NAVIGATION_ABORTED+"",on.NAVIGATION_CANCELLED+"",on.NAVIGATION_DUPLICATED+"";function Vi(e,t){return Pt(new Error,{type:e,[nv]:!0},t)}function Ms(e,t){return e instanceof Error&&nv in e&&(t==null||!!(e.type&t))}const L1=["params","query","hash"];function S1(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of L1)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function x1(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const s=o[a].replace(Jp," "),i=s.indexOf("="),r=Fl(i<0?s:s.slice(0,i)),u=i<0?null:Fl(s.slice(i+1));if(r in t){let d=t[r];ns(d)||(d=t[r]=[d]),d.push(u)}else t[r]=u}return t}function Ch(e){let t="";for(let o in e){const a=e[o];if(o=l1(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(ns(a)?a.map(s=>s&&vu(s)):[a&&vu(a)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function I1(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=ns(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return t}const $1=Symbol(""),Lh=Symbol(""),dc=Symbol(""),ed=Symbol(""),yu=Symbol("");function fl(){let e=[];function t(a){return e.push(a),()=>{const s=e.indexOf(a);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function ya(e,t,o,a,s,i=r=>r()){const r=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const f=y=>{y===!1?d(Vi(on.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):C1(y)?d(Vi(on.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(r&&a.enterCallbacks[s]===r&&typeof y=="function"&&r.push(y),u())},p=i(()=>e.call(a&&a.instances[s],t,o,f));let g=Promise.resolve(p);e.length<3&&(g=g.then(f)),g.catch(y=>d(y))})}function Zc(e,t,o,a,s=i=>i()){const i=[];for(const r of e)for(const u in r.components){let d=r.components[u];if(!(t!=="beforeRouteEnter"&&!r.instances[u]))if(qp(d)){const f=(d.__vccOpts||d)[t];f&&i.push(ya(f,o,a,r,u,s))}else{let f=d();i.push(()=>f.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${r.path}"`);const g=Jy(p)?p.default:p;r.mods[u]=p,r.components[u]=g;const y=(g.__vccOpts||g)[t];return y&&ya(y,o,a,r,u,s)()}))}}return i}function T1(e,t){const o=[],a=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let r=0;r<i;r++){const u=t.matched[r];u&&(e.matched.find(f=>Hi(f,u))?a.push(u):o.push(u));const d=e.matched[r];d&&(t.matched.find(f=>Hi(f,d))||s.push(d))}return[o,a,s]}let M1=()=>location.protocol+"//"+location.host;function ov(e,t){const{pathname:o,search:a,hash:s}=t,i=e.indexOf("#");if(i>-1){let r=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(r);return u[0]!=="/"&&(u="/"+u),_h(u,"")}return _h(o,e)+a+s}function A1(e,t,o,a){let s=[],i=[],r=null;const u=({state:y})=>{const k=ov(e,location),b=o.value,C=t.value;let x=0;if(y){if(o.value=k,t.value=y,r&&r===b){r=null;return}x=C?y.position-C.position:0}else a(k);s.forEach($=>{$(o.value,b,{delta:x,type:mu.pop,direction:x?x>0?jc.forward:jc.back:jc.unknown})})};function d(){r=o.value}function f(y){s.push(y);const k=()=>{const b=s.indexOf(y);b>-1&&s.splice(b,1)};return i.push(k),k}function p(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Pt({},y.state,{scroll:uc()}),"")}}function g(){for(const y of i)y();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:d,listen:f,destroy:g}}function Sh(e,t,o,a=!1,s=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:s?uc():null}}function E1(e){const{history:t,location:o}=window,a={value:ov(e,o)},s={value:t.state};s.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,f,p){const g=e.indexOf("#"),y=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:M1()+e+d;try{t[p?"replaceState":"pushState"](f,"",y),s.value=f}catch(k){console.error(k),o[p?"replace":"assign"](y)}}function r(d,f){i(d,Pt({},t.state,Sh(s.value.back,d,s.value.forward,!0),f,{position:s.value.position}),!0),a.value=d}function u(d,f){const p=Pt({},s.value,t.state,{forward:d,scroll:uc()});i(p.current,p,!0),i(d,Pt({},Sh(a.value,d,null),{position:p.position+1},f),!1),a.value=d}return{location:a,state:s,push:u,replace:r}}function P1(e){e=m1(e);const t=E1(e),o=A1(e,t.state,t.location,t.replace);function a(i,r=!0){r||o.pauseListeners(),history.go(i)}const s=Pt({location:"",base:e,go:a,createHref:y1.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function D1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),P1(e)}let Xa=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var fn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(fn||{});const O1={type:Xa.Static,value:""},R1=/[a-zA-Z0-9_]/;function B1(e){if(!e)return[[]];if(e==="/")return[[O1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${o})/"${f}": ${k}`)}let o=fn.Static,a=o;const s=[];let i;function r(){i&&s.push(i),i=[]}let u=0,d,f="",p="";function g(){f&&(o===fn.Static?i.push({type:Xa.Static,value:f}):o===fn.Param||o===fn.ParamRegExp||o===fn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Xa.Param,value:f,regexp:p,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),f="")}function y(){f+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==fn.ParamRegExp){a=o,o=fn.EscapeNext;continue}switch(o){case fn.Static:d==="/"?(f&&g(),r()):d===":"?(g(),o=fn.Param):y();break;case fn.EscapeNext:y(),o=a;break;case fn.Param:d==="("?o=fn.ParamRegExp:R1.test(d)?y():(g(),o=fn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case fn.ParamRegExp:d===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+d:o=fn.ParamRegExpEnd:p+=d;break;case fn.ParamRegExpEnd:g(),o=fn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===fn.ParamRegExp&&t(`Unfinished custom RegExp for param "${f}"`),g(),r(),s}const xh="[^/]+?",N1={sensitive:!1,strict:!1,start:!0,end:!0};var Wn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Wn||{});const F1=/[.+*?^${}()[\]/\\]/g;function U1(e,t){const o=Pt({},N1,t),a=[];let s=o.start?"^":"";const i=[];for(const f of e){const p=f.length?[]:[Wn.Root];o.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const y=f[g];let k=Wn.Segment+(o.sensitive?Wn.BonusCaseSensitive:0);if(y.type===Xa.Static)g||(s+="/"),s+=y.value.replace(F1,"\\$&"),k+=Wn.Static;else if(y.type===Xa.Param){const{value:b,repeatable:C,optional:x,regexp:$}=y;i.push({name:b,repeatable:C,optional:x});const I=$||xh;if(I!==xh){k+=Wn.BonusCustomRegExp;try{`${I}`}catch(B){throw new Error(`Invalid custom RegExp for param "${b}" (${I}): `+B.message)}}let S=C?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;g||(S=x&&f.length<2?`(?:/${S})`:"/"+S),x&&(S+="?"),s+=S,k+=Wn.Dynamic,x&&(k+=Wn.BonusOptional),C&&(k+=Wn.BonusRepeatable),I===".*"&&(k+=Wn.BonusWildcard)}p.push(k)}a.push(p)}if(o.strict&&o.end){const f=a.length-1;a[f][a[f].length-1]+=Wn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const r=new RegExp(s,o.sensitive?"":"i");function u(f){const p=f.match(r),g={};if(!p)return null;for(let y=1;y<p.length;y++){const k=p[y]||"",b=i[y-1];g[b.name]=k&&b.repeatable?k.split("/"):k}return g}function d(f){let p="",g=!1;for(const y of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const k of y)if(k.type===Xa.Static)p+=k.value;else if(k.type===Xa.Param){const{value:b,repeatable:C,optional:x}=k,$=b in f?f[b]:"";if(ns($)&&!C)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const I=ns($)?$.join("/"):$;if(!I)if(x)y.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${b}"`);p+=I}}return p||"/"}return{re:r,score:a,keys:i,parse:u,stringify:d}}function z1(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Wn.Static+Wn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Wn.Static+Wn.Segment?1:-1:0}function sv(e,t){let o=0;const a=e.score,s=t.score;for(;o<a.length&&o<s.length;){const i=z1(a[o],s[o]);if(i)return i;o++}if(Math.abs(s.length-a.length)===1){if(Ih(a))return 1;if(Ih(s))return-1}return s.length-a.length}function Ih(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const H1={strict:!1,end:!0,sensitive:!1};function V1(e,t,o){const a=U1(B1(e.path),o),s=Pt(a,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function G1(e,t){const o=[],a=new Map;t=kh(H1,t);function s(g){return a.get(g)}function i(g,y,k){const b=!k,C=Th(g);C.aliasOf=k&&k.record;const x=kh(t,g),$=[C];if("alias"in g){const B=typeof g.alias=="string"?[g.alias]:g.alias;for(const R of B)$.push(Th(Pt({},C,{components:k?k.record.components:C.components,path:R,aliasOf:k?k.record:C})))}let I,S;for(const B of $){const{path:R}=B;if(y&&R[0]!=="/"){const Z=y.record.path,A=Z[Z.length-1]==="/"?"":"/";B.path=y.record.path+(R&&A+R)}if(I=V1(B,y,x),k?k.alias.push(I):(S=S||I,S!==I&&S.alias.push(I),b&&g.name&&!Mh(I)&&r(g.name)),av(I)&&d(I),C.children){const Z=C.children;for(let A=0;A<Z.length;A++)i(Z[A],I,k&&k.children[A])}k=k||I}return S?()=>{r(S)}:Tl}function r(g){if(tv(g)){const y=a.get(g);y&&(a.delete(g),o.splice(o.indexOf(y),1),y.children.forEach(r),y.alias.forEach(r))}else{const y=o.indexOf(g);y>-1&&(o.splice(y,1),g.record.name&&a.delete(g.record.name),g.children.forEach(r),g.alias.forEach(r))}}function u(){return o}function d(g){const y=W1(g,o);o.splice(y,0,g),g.record.name&&!Mh(g)&&a.set(g.record.name,g)}function f(g,y){let k,b={},C,x;if("name"in g&&g.name){if(k=a.get(g.name),!k)throw Vi(on.MATCHER_NOT_FOUND,{location:g});x=k.record.name,b=Pt($h(y.params,k.keys.filter(S=>!S.optional).concat(k.parent?k.parent.keys.filter(S=>S.optional):[]).map(S=>S.name)),g.params&&$h(g.params,k.keys.map(S=>S.name))),C=k.stringify(b)}else if(g.path!=null)C=g.path,k=o.find(S=>S.re.test(C)),k&&(b=k.parse(C),x=k.record.name);else{if(k=y.name?a.get(y.name):o.find(S=>S.re.test(y.path)),!k)throw Vi(on.MATCHER_NOT_FOUND,{location:g,currentLocation:y});x=k.record.name,b=Pt({},y.params,g.params),C=k.stringify(b)}const $=[];let I=k;for(;I;)$.unshift(I.record),I=I.parent;return{name:x,path:C,params:b,matched:$,meta:Z1($)}}e.forEach(g=>i(g));function p(){o.length=0,a.clear()}return{addRoute:i,resolve:f,removeRoute:r,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function $h(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function Th(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:j1(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function j1(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function Mh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Z1(e){return e.reduce((t,o)=>Pt(t,o.meta),{})}function W1(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;sv(e,t[i])<0?a=i:o=i+1}const s=q1(e);return s&&(a=t.lastIndexOf(s,a-1)),a}function q1(e){let t=e;for(;t=t.parent;)if(av(t)&&sv(e,t)===0)return t}function av({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Ah(e){const t=ro(dc),o=ro(ed),a=F(()=>{const d=D(e.to);return t.resolve(d)}),s=F(()=>{const{matched:d}=a.value,{length:f}=d,p=d[f-1],g=o.matched;if(!p||!g.length)return-1;const y=g.findIndex(Hi.bind(null,p));if(y>-1)return y;const k=Eh(d[f-2]);return f>1&&Eh(p)===k&&g[g.length-1].path!==k?g.findIndex(Hi.bind(null,d[f-2])):y}),i=F(()=>s.value>-1&&Q1(o.params,a.value.params)),r=F(()=>s.value>-1&&s.value===o.matched.length-1&&ev(o.params,a.value.params));function u(d={}){if(X1(d)){const f=t[D(e.replace)?"replace":"push"](D(e.to)).catch(Tl);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:a,href:F(()=>a.value.href),isActive:i,isExactActive:r,navigate:u}}function K1(e){return e.length===1?e[0]:e}const J1=cp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ah,setup(e,{slots:t}){const o=ii(Ah(e)),{options:a}=ro(dc),s=F(()=>({[Ph(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[Ph(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&K1(t.default(o));return e.custom?i:Yu("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},i)}}}),Y1=J1;function X1(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Q1(e,t){for(const o in t){const a=t[o],s=e[o];if(typeof a=="string"){if(a!==s)return!1}else if(!ns(s)||s.length!==a.length||a.some((i,r)=>i.valueOf()!==s[r].valueOf()))return!1}return!0}function Eh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ph=(e,t,o)=>e??t??o,ek=cp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=ro(yu),s=F(()=>e.route||a.value),i=ro(Lh,0),r=F(()=>{let f=D(i);const{matched:p}=s.value;let g;for(;(g=p[f])&&!g.components;)f++;return f}),u=F(()=>s.value.matched[r.value]);wl(Lh,F(()=>r.value+1)),wl($1,u),wl(yu,s);const d=M();return Ze(()=>[d.value,u.value,e.name],([f,p,g],[y,k,b])=>{p&&(p.instances[g]=f,k&&k!==p&&f&&f===y&&(p.leaveGuards.size||(p.leaveGuards=k.leaveGuards),p.updateGuards.size||(p.updateGuards=k.updateGuards))),f&&p&&(!k||!Hi(p,k)||!y)&&(p.enterCallbacks[g]||[]).forEach(C=>C(f))},{flush:"post"}),()=>{const f=s.value,p=e.name,g=u.value,y=g&&g.components[p];if(!y)return Dh(o.default,{Component:y,route:f});const k=g.props[p],b=k?k===!0?f.params:typeof k=="function"?k(f):k:null,x=Yu(y,Pt({},b,t,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(g.instances[p]=null)},ref:d}));return Dh(o.default,{Component:x,route:f})||x}}});function Dh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const tk=ek;function nk(e){const t=G1(e.routes,e),o=e.parseQuery||x1,a=e.stringifyQuery||Ch,s=e.history,i=fl(),r=fl(),u=fl(),d=Ym(ha);let f=ha;Ai&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=Vc.bind(null,ee=>""+ee),g=Vc.bind(null,c1),y=Vc.bind(null,Fl);function k(ee,ye){let te,ge;return tv(ee)?(te=t.getRecordMatcher(ee),ge=ye):ge=ee,t.addRoute(ge,te)}function b(ee){const ye=t.getRecordMatcher(ee);ye&&t.removeRoute(ye)}function C(){return t.getRoutes().map(ee=>ee.record)}function x(ee){return!!t.getRecordMatcher(ee)}function $(ee,ye){if(ye=Pt({},ye||d.value),typeof ee=="string"){const ce=Gc(o,ee,ye.path),Me=t.resolve({path:ce.path},ye),Be=s.createHref(ce.fullPath);return Pt(ce,Me,{params:y(Me.params),hash:Fl(ce.hash),redirectedFrom:void 0,href:Be})}let te;if(ee.path!=null)te=Pt({},ee,{path:Gc(o,ee.path,ye.path).path});else{const ce=Pt({},ee.params);for(const Me in ce)ce[Me]==null&&delete ce[Me];te=Pt({},ee,{params:g(ce)}),ye.params=g(ye.params)}const ge=t.resolve(te,ye),he=ee.hash||"";ge.params=p(y(ge.params));const G=h1(a,Pt({},ee,{hash:i1(he),path:ge.path})),J=s.createHref(G);return Pt({fullPath:G,hash:he,query:a===Ch?I1(ee.query):ee.query||{}},ge,{redirectedFrom:void 0,href:J})}function I(ee){return typeof ee=="string"?Gc(o,ee,d.value.path):Pt({},ee)}function S(ee,ye){if(f!==ee)return Vi(on.NAVIGATION_CANCELLED,{from:ye,to:ee})}function B(ee){return A(ee)}function R(ee){return B(Pt(I(ee),{replace:!0}))}function Z(ee,ye){const te=ee.matched[ee.matched.length-1];if(te&&te.redirect){const{redirect:ge}=te;let he=typeof ge=="function"?ge(ee,ye):ge;return typeof he=="string"&&(he=he.includes("?")||he.includes("#")?he=I(he):{path:he},he.params={}),Pt({query:ee.query,hash:ee.hash,params:he.path!=null?{}:ee.params},he)}}function A(ee,ye){const te=f=$(ee),ge=d.value,he=ee.state,G=ee.force,J=ee.replace===!0,ce=Z(te,ge);if(ce)return A(Pt(I(ce),{state:typeof ce=="object"?Pt({},he,ce.state):he,force:G,replace:J}),ye||te);const Me=te;Me.redirectedFrom=ye;let Be;return!G&&f1(a,ge,te)&&(Be=Vi(on.NAVIGATION_DUPLICATED,{to:Me,from:ge}),ke(ge,ge,!0,!1)),(Be?Promise.resolve(Be):V(Me,ge)).catch(De=>Ms(De)?Ms(De,on.NAVIGATION_GUARD_REDIRECT)?De:de(De):U(De,Me,ge)).then(De=>{if(De){if(Ms(De,on.NAVIGATION_GUARD_REDIRECT))return A(Pt({replace:J},I(De.to),{state:typeof De.to=="object"?Pt({},he,De.to.state):he,force:G}),ye||Me)}else De=j(Me,ge,!0,J,he);return P(Me,ge,De),De})}function N(ee,ye){const te=S(ee,ye);return te?Promise.reject(te):Promise.resolve()}function O(ee){const ye=Ne.values().next().value;return ye&&typeof ye.runWithContext=="function"?ye.runWithContext(ee):ee()}function V(ee,ye){let te;const[ge,he,G]=T1(ee,ye);te=Zc(ge.reverse(),"beforeRouteLeave",ee,ye);for(const ce of ge)ce.leaveGuards.forEach(Me=>{te.push(ya(Me,ee,ye))});const J=N.bind(null,ee,ye);return te.push(J),We(te).then(()=>{te=[];for(const ce of i.list())te.push(ya(ce,ee,ye));return te.push(J),We(te)}).then(()=>{te=Zc(he,"beforeRouteUpdate",ee,ye);for(const ce of he)ce.updateGuards.forEach(Me=>{te.push(ya(Me,ee,ye))});return te.push(J),We(te)}).then(()=>{te=[];for(const ce of G)if(ce.beforeEnter)if(ns(ce.beforeEnter))for(const Me of ce.beforeEnter)te.push(ya(Me,ee,ye));else te.push(ya(ce.beforeEnter,ee,ye));return te.push(J),We(te)}).then(()=>(ee.matched.forEach(ce=>ce.enterCallbacks={}),te=Zc(G,"beforeRouteEnter",ee,ye,O),te.push(J),We(te))).then(()=>{te=[];for(const ce of r.list())te.push(ya(ce,ee,ye));return te.push(J),We(te)}).catch(ce=>Ms(ce,on.NAVIGATION_CANCELLED)?ce:Promise.reject(ce))}function P(ee,ye,te){u.list().forEach(ge=>O(()=>ge(ee,ye,te)))}function j(ee,ye,te,ge,he){const G=S(ee,ye);if(G)return G;const J=ye===ha,ce=Ai?history.state:{};te&&(ge||J?s.replace(ee.fullPath,Pt({scroll:J&&ce&&ce.scroll},he)):s.push(ee.fullPath,he)),d.value=ee,ke(ee,ye,te,J),de()}let Q;function ae(){Q||(Q=s.listen((ee,ye,te)=>{if(!ze.listening)return;const ge=$(ee),he=Z(ge,ze.currentRoute.value);if(he){A(Pt(he,{replace:!0,force:!0}),ge).catch(Tl);return}f=ge;const G=d.value;Ai&&b1(wh(G.fullPath,te.delta),uc()),V(ge,G).catch(J=>Ms(J,on.NAVIGATION_ABORTED|on.NAVIGATION_CANCELLED)?J:Ms(J,on.NAVIGATION_GUARD_REDIRECT)?(A(Pt(I(J.to),{force:!0}),ge).then(ce=>{Ms(ce,on.NAVIGATION_ABORTED|on.NAVIGATION_DUPLICATED)&&!te.delta&&te.type===mu.pop&&s.go(-1,!1)}).catch(Tl),Promise.reject()):(te.delta&&s.go(-te.delta,!1),U(J,ge,G))).then(J=>{J=J||j(ge,G,!1),J&&(te.delta&&!Ms(J,on.NAVIGATION_CANCELLED)?s.go(-te.delta,!1):te.type===mu.pop&&Ms(J,on.NAVIGATION_ABORTED|on.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),P(ge,G,J)}).catch(Tl)}))}let pe=fl(),ne=fl(),oe;function U(ee,ye,te){de(ee);const ge=ne.list();return ge.length?ge.forEach(he=>he(ee,ye,te)):console.error(ee),Promise.reject(ee)}function Y(){return oe&&d.value!==ha?Promise.resolve():new Promise((ee,ye)=>{pe.add([ee,ye])})}function de(ee){return oe||(oe=!ee,ae(),pe.list().forEach(([ye,te])=>ee?te(ee):ye()),pe.reset()),ee}function ke(ee,ye,te,ge){const{scrollBehavior:he}=e;if(!Ai||!he)return Promise.resolve();const G=!te&&w1(wh(ee.fullPath,0))||(ge||!te)&&history.state&&history.state.scroll||null;return sn().then(()=>he(ee,ye,G)).then(J=>J&&_1(J)).catch(J=>U(J,ee,ye))}const Re=ee=>s.go(ee);let Xe;const Ne=new Set,ze={currentRoute:d,listening:!0,addRoute:k,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:x,getRoutes:C,resolve:$,options:e,push:B,replace:R,go:Re,back:()=>Re(-1),forward:()=>Re(1),beforeEach:i.add,beforeResolve:r.add,afterEach:u.add,onError:ne.add,isReady:Y,install(ee){ee.component("RouterLink",Y1),ee.component("RouterView",tk),ee.config.globalProperties.$router=ze,Object.defineProperty(ee.config.globalProperties,"$route",{enumerable:!0,get:()=>D(d)}),Ai&&!Xe&&d.value===ha&&(Xe=!0,B(s.location).catch(ge=>{}));const ye={};for(const ge in ha)Object.defineProperty(ye,ge,{get:()=>d.value[ge],enumerable:!0});ee.provide(dc,ze),ee.provide(ed,Vf(ye)),ee.provide(yu,d);const te=ee.unmount;Ne.add(ee),ee.unmount=function(){Ne.delete(ee),Ne.size<1&&(f=ha,Q&&Q(),Q=null,d.value=ha,Xe=!1,oe=!1),te()}}};function We(ee){return ee.reduce((ye,te)=>ye.then(()=>O(te)),Promise.resolve())}return ze}function Zi(){return ro(dc)}function hc(e){return ro(ed)}const ok={__name:"App",setup(e){const t=Zi(),o=M(""),a=["/","/sessions"];return Ze(()=>t.currentRoute.value,(s,i)=>{if(!i?.path){o.value="";return}const r=a.indexOf(s.path),u=a.indexOf(i.path);r!==-1&&u!==-1?o.value=r>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(s,i)=>{const r=Zu("router-view");return v(),qe(r,null,{default:Ve(({Component:u,route:d})=>[Ae(ys,{name:o.value,mode:"out-in"},{default:Ve(()=>[(v(),qe(xg(u),{key:d.path}))]),_:2},1032,["name"])]),_:1})}}},Wi="marshalSessions",sk=30;function Nr(e,t){return`${e}:${t}`}function td(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function Ma(){try{return JSON.parse(localStorage.getItem(Wi)||"{}")}catch{return{}}}function Fr(e){const t=Ma(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,s])=>({sessionKey:a,...s}));return o.length===0?null:(o.sort((a,s)=>new Date(s.lastAccessed)-new Date(a.lastAccessed)),o[0])}function Oh(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=Ma(),a=Nr(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(Wi,JSON.stringify(o))}function ku(e){const t=Ma(),{eventId:o,marshalId:a}=td(e);delete t[e],localStorage.setItem(Wi,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function iv(e,t){const o=Ma(),a=Nr(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(Wi,JSON.stringify(o)))}function lv(){const e=Ma(),t=new Date;t.setDate(t.getDate()-sk);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:r}=td(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${r}`),o=!0}o&&localStorage.setItem(Wi,JSON.stringify(e))}function rv(){const e=Ma(),t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);if(s&&s.startsWith("marshal_")&&!s.startsWith("marshalCode_")&&!s.startsWith("marshalSessions")){const i=s.replace("marshal_",""),r=localStorage.getItem(s);if(r){const u=Nr(i,r);e[u]||(e[u]={marshalId:r,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(s)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const s=e[a];if(s&&s.marshalId){const i=Nr(a,s.marshalId);e[i]||(e[i]={...s,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(Wi,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function ak(){const e=Ma();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:s}=td(t);return{sessionKey:t,eventId:a,marshalId:s,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function cv(){const e=Ma();return Object.values(e).some(t=>t.token)}function uv(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function ik(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function dv(e,t){return function(){return e.apply(t,arguments)}}const{toString:lk}=Object.prototype,{getPrototypeOf:nd}=Object,{iterator:fc,toStringTag:hv}=Symbol,pc=(e=>t=>{const o=lk.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),os=e=>(e=e.toLowerCase(),t=>pc(t)===e),vc=e=>t=>typeof t===e,{isArray:qi}=Array,Gi=vc("undefined");function jl(e){return e!==null&&!Gi(e)&&e.constructor!==null&&!Gi(e.constructor)&&co(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const fv=os("ArrayBuffer");function rk(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&fv(e.buffer),t}const ck=vc("string"),co=vc("function"),pv=vc("number"),Zl=e=>e!==null&&typeof e=="object",uk=e=>e===!0||e===!1,br=e=>{if(pc(e)!=="object")return!1;const t=nd(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(hv in e)&&!(fc in e)},dk=e=>{if(!Zl(e)||jl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},hk=os("Date"),fk=os("File"),pk=os("Blob"),vk=os("FileList"),mk=e=>Zl(e)&&co(e.pipe),gk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||co(e.append)&&((t=pc(e))==="formdata"||t==="object"&&co(e.toString)&&e.toString()==="[object FormData]"))},yk=os("URLSearchParams"),[kk,_k,bk,wk]=["ReadableStream","Request","Response","Headers"].map(os),Ck=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),qi(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(jl(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let u;for(a=0;a<r;a++)u=i[a],t.call(null,e[u],u,e)}}function vv(e,t){if(jl(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,s;for(;a-- >0;)if(s=o[a],t===s.toLowerCase())return s;return null}const Qa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,mv=e=>!Gi(e)&&e!==Qa;function _u(){const{caseless:e,skipUndefined:t}=mv(this)&&this||{},o={},a=(s,i)=>{const r=e&&vv(o,i)||i;br(o[r])&&br(s)?o[r]=_u(o[r],s):br(s)?o[r]=_u({},s):qi(s)?o[r]=s.slice():(!t||!Gi(s))&&(o[r]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Wl(arguments[s],a);return o}const Lk=(e,t,o,{allOwnKeys:a}={})=>(Wl(t,(s,i)=>{o&&co(s)?e[i]=dv(s,o):e[i]=s},{allOwnKeys:a}),e),Sk=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),xk=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Ik=(e,t,o,a)=>{let s,i,r;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)r=s[i],(!a||a(r,e,t))&&!u[r]&&(t[r]=e[r],u[r]=!0);e=o!==!1&&nd(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},$k=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},Tk=e=>{if(!e)return null;if(qi(e))return e;let t=e.length;if(!pv(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},Mk=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&nd(Uint8Array)),Ak=(e,t)=>{const a=(e&&e[fc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},Ek=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},Pk=os("HTMLFormElement"),Dk=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,s){return a.toUpperCase()+s}),Rh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Ok=os("RegExp"),gv=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};Wl(o,(s,i)=>{let r;(r=t(s,i,e))!==!1&&(a[i]=r||s)}),Object.defineProperties(e,a)},Rk=e=>{gv(e,(t,o)=>{if(co(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(co(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Bk=(e,t)=>{const o={},a=s=>{s.forEach(i=>{o[i]=!0})};return qi(e)?a(e):a(String(e).split(t)),o},Nk=()=>{},Fk=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Uk(e){return!!(e&&co(e.append)&&e[hv]==="FormData"&&e[fc])}const zk=e=>{const t=new Array(10),o=(a,s)=>{if(Zl(a)){if(t.indexOf(a)>=0)return;if(jl(a))return a;if(!("toJSON"in a)){t[s]=a;const i=qi(a)?[]:{};return Wl(a,(r,u)=>{const d=o(r,s+1);!Gi(d)&&(i[u]=d)}),t[s]=void 0,i}}return a};return o(e,0)},Hk=os("AsyncFunction"),Vk=e=>e&&(Zl(e)||co(e))&&co(e.then)&&co(e.catch),yv=((e,t)=>e?setImmediate:t?((o,a)=>(Qa.addEventListener("message",({source:s,data:i})=>{s===Qa&&i===o&&a.length&&a.shift()()},!1),s=>{a.push(s),Qa.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",co(Qa.postMessage)),Gk=typeof queueMicrotask<"u"?queueMicrotask.bind(Qa):typeof process<"u"&&process.nextTick||yv,jk=e=>e!=null&&co(e[fc]),Te={isArray:qi,isArrayBuffer:fv,isBuffer:jl,isFormData:gk,isArrayBufferView:rk,isString:ck,isNumber:pv,isBoolean:uk,isObject:Zl,isPlainObject:br,isEmptyObject:dk,isReadableStream:kk,isRequest:_k,isResponse:bk,isHeaders:wk,isUndefined:Gi,isDate:hk,isFile:fk,isBlob:pk,isRegExp:Ok,isFunction:co,isStream:mk,isURLSearchParams:yk,isTypedArray:Mk,isFileList:vk,forEach:Wl,merge:_u,extend:Lk,trim:Ck,stripBOM:Sk,inherits:xk,toFlatObject:Ik,kindOf:pc,kindOfTest:os,endsWith:$k,toArray:Tk,forEachEntry:Ak,matchAll:Ek,isHTMLForm:Pk,hasOwnProperty:Rh,hasOwnProp:Rh,reduceDescriptors:gv,freezeMethods:Rk,toObjectSet:Bk,toCamelCase:Dk,noop:Nk,toFiniteNumber:Fk,findKey:vv,global:Qa,isContextDefined:mv,isSpecCompliantForm:Uk,toJSONObject:zk,isAsyncFn:Hk,isThenable:Vk,setImmediate:yv,asap:Gk,isIterable:jk};function vt(e,t,o,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}Te.inherits(vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});const kv=vt.prototype,_v={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{_v[e]={value:e}});Object.defineProperties(vt,_v);Object.defineProperty(kv,"isAxiosError",{value:!0});vt.from=(e,t,o,a,s,i)=>{const r=Object.create(kv);Te.toFlatObject(e,r,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return vt.call(r,u,d,o,a,s),e&&r.cause==null&&Object.defineProperty(r,"cause",{value:e,configurable:!0}),r.name=e&&e.name||"Error",i&&Object.assign(r,i),r};const Zk=null;function bu(e){return Te.isPlainObject(e)||Te.isArray(e)}function bv(e){return Te.endsWith(e,"[]")?e.slice(0,-2):e}function Bh(e,t,o){return e?e.concat(t).map(function(s,i){return s=bv(s),!o&&i?"["+s+"]":s}).join(o?".":""):t}function Wk(e){return Te.isArray(e)&&!e.some(bu)}const qk=Te.toFlatObject(Te,{},null,function(t){return/^is[A-Z]/.test(t)});function mc(e,t,o){if(!Te.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Te.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,x){return!Te.isUndefined(x[C])});const a=o.metaTokens,s=o.visitor||p,i=o.dots,r=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(t);if(!Te.isFunction(s))throw new TypeError("visitor must be a function");function f(b){if(b===null)return"";if(Te.isDate(b))return b.toISOString();if(Te.isBoolean(b))return b.toString();if(!d&&Te.isBlob(b))throw new vt("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(b)||Te.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function p(b,C,x){let $=b;if(b&&!x&&typeof b=="object"){if(Te.endsWith(C,"{}"))C=a?C:C.slice(0,-2),b=JSON.stringify(b);else if(Te.isArray(b)&&Wk(b)||(Te.isFileList(b)||Te.endsWith(C,"[]"))&&($=Te.toArray(b)))return C=bv(C),$.forEach(function(S,B){!(Te.isUndefined(S)||S===null)&&t.append(r===!0?Bh([C],B,i):r===null?C:C+"[]",f(S))}),!1}return bu(b)?!0:(t.append(Bh(x,C,i),f(b)),!1)}const g=[],y=Object.assign(qk,{defaultVisitor:p,convertValue:f,isVisitable:bu});function k(b,C){if(!Te.isUndefined(b)){if(g.indexOf(b)!==-1)throw Error("Circular reference detected in "+C.join("."));g.push(b),Te.forEach(b,function($,I){(!(Te.isUndefined($)||$===null)&&s.call(t,$,Te.isString(I)?I.trim():I,C,y))===!0&&k($,C?C.concat(I):[I])}),g.pop()}}if(!Te.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Nh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function od(e,t){this._pairs=[],e&&mc(e,this,t)}const wv=od.prototype;wv.append=function(t,o){this._pairs.push([t,o])};wv.toString=function(t){const o=t?function(a){return t.call(this,a,Nh)}:Nh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function Kk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Cv(e,t,o){if(!t)return e;const a=o&&o.encode||Kk;Te.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let i;if(s?i=s(t,o):i=Te.isURLSearchParams(t)?t.toString():new od(t,o).toString(a),i){const r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Fh{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Te.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Lv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Jk=typeof URLSearchParams<"u"?URLSearchParams:od,Yk=typeof FormData<"u"?FormData:null,Xk=typeof Blob<"u"?Blob:null,Qk={isBrowser:!0,classes:{URLSearchParams:Jk,FormData:Yk,Blob:Xk},protocols:["http","https","file","blob","url","data"]},sd=typeof window<"u"&&typeof document<"u",wu=typeof navigator=="object"&&navigator||void 0,e_=sd&&(!wu||["ReactNative","NativeScript","NS"].indexOf(wu.product)<0),t_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",n_=sd&&window.location.href||"http://localhost",o_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sd,hasStandardBrowserEnv:e_,hasStandardBrowserWebWorkerEnv:t_,navigator:wu,origin:n_},Symbol.toStringTag,{value:"Module"})),Fn={...o_,...Qk};function s_(e,t){return mc(e,new Fn.classes.URLSearchParams,{visitor:function(o,a,s,i){return Fn.isNode&&Te.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function a_(e){return Te.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function i_(e){const t={},o=Object.keys(e);let a;const s=o.length;let i;for(a=0;a<s;a++)i=o[a],t[i]=e[i];return t}function Sv(e){function t(o,a,s,i){let r=o[i++];if(r==="__proto__")return!0;const u=Number.isFinite(+r),d=i>=o.length;return r=!r&&Te.isArray(s)?s.length:r,d?(Te.hasOwnProp(s,r)?s[r]=[s[r],a]:s[r]=a,!u):((!s[r]||!Te.isObject(s[r]))&&(s[r]=[]),t(o,a,s[r],i)&&Te.isArray(s[r])&&(s[r]=i_(s[r])),!u)}if(Te.isFormData(e)&&Te.isFunction(e.entries)){const o={};return Te.forEachEntry(e,(a,s)=>{t(a_(a),s,o,0)}),o}return null}function l_(e,t,o){if(Te.isString(e))try{return(t||JSON.parse)(e),Te.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const ql={transitional:Lv,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",s=a.indexOf("application/json")>-1,i=Te.isObject(t);if(i&&Te.isHTMLForm(t)&&(t=new FormData(t)),Te.isFormData(t))return s?JSON.stringify(Sv(t)):t;if(Te.isArrayBuffer(t)||Te.isBuffer(t)||Te.isStream(t)||Te.isFile(t)||Te.isBlob(t)||Te.isReadableStream(t))return t;if(Te.isArrayBufferView(t))return t.buffer;if(Te.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return s_(t,this.formSerializer).toString();if((u=Te.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return mc(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||s?(o.setContentType("application/json",!1),l_(t)):t}],transformResponse:[function(t){const o=this.transitional||ql.transitional,a=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Te.isResponse(t)||Te.isReadableStream(t))return t;if(t&&Te.isString(t)&&(a&&!this.responseType||s)){const r=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(r)throw u.name==="SyntaxError"?vt.from(u,vt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fn.classes.FormData,Blob:Fn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],e=>{ql.headers[e]={}});const r_=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),c_=e=>{const t={};let o,a,s;return e&&e.split(`
`).forEach(function(r){s=r.indexOf(":"),o=r.substring(0,s).trim().toLowerCase(),a=r.substring(s+1).trim(),!(!o||t[o]&&r_[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},Uh=Symbol("internals");function pl(e){return e&&String(e).trim().toLowerCase()}function wr(e){return e===!1||e==null?e:Te.isArray(e)?e.map(wr):String(e)}function u_(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const d_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Wc(e,t,o,a,s){if(Te.isFunction(a))return a.call(this,t,o);if(s&&(t=o),!!Te.isString(t)){if(Te.isString(a))return t.indexOf(a)!==-1;if(Te.isRegExp(a))return a.test(t)}}function h_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function f_(e,t){const o=Te.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(s,i,r){return this[a].call(this,t,s,i,r)},configurable:!0})})}let uo=class{constructor(t){t&&this.set(t)}set(t,o,a){const s=this;function i(u,d,f){const p=pl(d);if(!p)throw new Error("header name must be a non-empty string");const g=Te.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||d]=wr(u))}const r=(u,d)=>Te.forEach(u,(f,p)=>i(f,p,d));if(Te.isPlainObject(t)||t instanceof this.constructor)r(t,o);else if(Te.isString(t)&&(t=t.trim())&&!d_(t))r(c_(t),o);else if(Te.isObject(t)&&Te.isIterable(t)){let u={},d,f;for(const p of t){if(!Te.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?Te.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}r(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=pl(t),t){const a=Te.findKey(this,t);if(a){const s=this[a];if(!o)return s;if(o===!0)return u_(s);if(Te.isFunction(o))return o.call(this,s,a);if(Te.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=pl(t),t){const a=Te.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||Wc(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let s=!1;function i(r){if(r=pl(r),r){const u=Te.findKey(a,r);u&&(!o||Wc(a,a[u],u,o))&&(delete a[u],s=!0)}}return Te.isArray(t)?t.forEach(i):i(t),s}clear(t){const o=Object.keys(this);let a=o.length,s=!1;for(;a--;){const i=o[a];(!t||Wc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const o=this,a={};return Te.forEach(this,(s,i)=>{const r=Te.findKey(a,i);if(r){o[r]=wr(s),delete o[i];return}const u=t?h_(i):String(i).trim();u!==i&&delete o[i],o[u]=wr(s),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Te.forEach(this,(a,s)=>{a!=null&&a!==!1&&(o[s]=t&&Te.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Uh]=this[Uh]={accessors:{}}).accessors,s=this.prototype;function i(r){const u=pl(r);a[u]||(f_(s,r),a[u]=!0)}return Te.isArray(t)?t.forEach(i):i(t),this}};uo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(uo.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});Te.freezeMethods(uo);function qc(e,t){const o=this||ql,a=t||o,s=uo.from(a.headers);let i=a.data;return Te.forEach(e,function(u){i=u.call(o,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function xv(e){return!!(e&&e.__CANCEL__)}function Ki(e,t,o){vt.call(this,e??"canceled",vt.ERR_CANCELED,t,o),this.name="CanceledError"}Te.inherits(Ki,vt,{__CANCEL__:!0});function Iv(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new vt("Request failed with status code "+o.status,[vt.ERR_BAD_REQUEST,vt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function p_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function v_(e,t){e=e||10;const o=new Array(e),a=new Array(e);let s=0,i=0,r;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=a[i];r||(r=f),o[s]=d,a[s]=f;let g=i,y=0;for(;g!==s;)y+=o[g++],g=g%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),f-r<t)return;const k=p&&f-p;return k?Math.round(y*1e3/k):void 0}}function m_(e,t){let o=0,a=1e3/t,s,i;const r=(f,p=Date.now())=>{o=p,s=null,i&&(clearTimeout(i),i=null),e(...f)};return[(...f)=>{const p=Date.now(),g=p-o;g>=a?r(f,p):(s=f,i||(i=setTimeout(()=>{i=null,r(s)},a-g)))},()=>s&&r(s)]}const Ur=(e,t,o=3)=>{let a=0;const s=v_(50,250);return m_(i=>{const r=i.loaded,u=i.lengthComputable?i.total:void 0,d=r-a,f=s(d),p=r<=u;a=r;const g={loaded:r,total:u,progress:u?r/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-r)/f:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},zh=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Hh=e=>(...t)=>Te.asap(()=>e(...t)),g_=Fn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Fn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Fn.origin),Fn.navigator&&/(msie|trident)/i.test(Fn.navigator.userAgent)):()=>!0,y_=Fn.hasStandardBrowserEnv?{write(e,t,o,a,s,i,r){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Te.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Te.isString(a)&&u.push(`path=${a}`),Te.isString(s)&&u.push(`domain=${s}`),i===!0&&u.push("secure"),Te.isString(r)&&u.push(`SameSite=${r}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function k_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function __(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function $v(e,t,o){let a=!k_(t);return e&&(a||o==!1)?__(e,t):t}const Vh=e=>e instanceof uo?{...e}:e;function ai(e,t){t=t||{};const o={};function a(f,p,g,y){return Te.isPlainObject(f)&&Te.isPlainObject(p)?Te.merge.call({caseless:y},f,p):Te.isPlainObject(p)?Te.merge({},p):Te.isArray(p)?p.slice():p}function s(f,p,g,y){if(Te.isUndefined(p)){if(!Te.isUndefined(f))return a(void 0,f,g,y)}else return a(f,p,g,y)}function i(f,p){if(!Te.isUndefined(p))return a(void 0,p)}function r(f,p){if(Te.isUndefined(p)){if(!Te.isUndefined(f))return a(void 0,f)}else return a(void 0,p)}function u(f,p,g){if(g in t)return a(f,p);if(g in e)return a(void 0,f)}const d={url:i,method:i,data:i,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:u,headers:(f,p,g)=>s(Vh(f),Vh(p),g,!0)};return Te.forEach(Object.keys({...e,...t}),function(p){const g=d[p]||s,y=g(e[p],t[p],p);Te.isUndefined(y)&&g!==u||(o[p]=y)}),o}const Tv=e=>{const t=ai({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:r,auth:u}=t;if(t.headers=r=uo.from(r),t.url=Cv($v(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&r.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Te.isFormData(o)){if(Fn.hasStandardBrowserEnv||Fn.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if(Te.isFunction(o.getHeaders)){const d=o.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,g])=>{f.includes(p.toLowerCase())&&r.set(p,g)})}}if(Fn.hasStandardBrowserEnv&&(a&&Te.isFunction(a)&&(a=a(t)),a||a!==!1&&g_(t.url))){const d=s&&i&&y_.read(i);d&&r.set(s,d)}return t},b_=typeof XMLHttpRequest<"u",w_=b_&&function(e){return new Promise(function(o,a){const s=Tv(e);let i=s.data;const r=uo.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=s,p,g,y,k,b;function C(){k&&k(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let x=new XMLHttpRequest;x.open(s.method.toUpperCase(),s.url,!0),x.timeout=s.timeout;function $(){if(!x)return;const S=uo.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),R={data:!u||u==="text"||u==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:S,config:e,request:x};Iv(function(A){o(A),C()},function(A){a(A),C()},R),x=null}"onloadend"in x?x.onloadend=$:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout($)},x.onabort=function(){x&&(a(new vt("Request aborted",vt.ECONNABORTED,e,x)),x=null)},x.onerror=function(B){const R=B&&B.message?B.message:"Network Error",Z=new vt(R,vt.ERR_NETWORK,e,x);Z.event=B||null,a(Z),x=null},x.ontimeout=function(){let B=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||Lv;s.timeoutErrorMessage&&(B=s.timeoutErrorMessage),a(new vt(B,R.clarifyTimeoutError?vt.ETIMEDOUT:vt.ECONNABORTED,e,x)),x=null},i===void 0&&r.setContentType(null),"setRequestHeader"in x&&Te.forEach(r.toJSON(),function(B,R){x.setRequestHeader(R,B)}),Te.isUndefined(s.withCredentials)||(x.withCredentials=!!s.withCredentials),u&&u!=="json"&&(x.responseType=s.responseType),f&&([y,b]=Ur(f,!0),x.addEventListener("progress",y)),d&&x.upload&&([g,k]=Ur(d),x.upload.addEventListener("progress",g),x.upload.addEventListener("loadend",k)),(s.cancelToken||s.signal)&&(p=S=>{x&&(a(!S||S.type?new Ki(null,e,x):S),x.abort(),x=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const I=p_(s.url);if(I&&Fn.protocols.indexOf(I)===-1){a(new vt("Unsupported protocol "+I+":",vt.ERR_BAD_REQUEST,e));return}x.send(i||null)})},C_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,s;const i=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;a.abort(p instanceof vt?p:new Ki(p instanceof Error?p.message:p))}};let r=t&&setTimeout(()=>{r=null,i(new vt(`timeout ${t} of ms exceeded`,vt.ETIMEDOUT))},t);const u=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Te.asap(u),d}},L_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,s;for(;a<o;)s=a+t,yield e.slice(a,s),a=s},S_=async function*(e,t){for await(const o of x_(e))yield*L_(o,t)},x_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Gh=(e,t,o,a)=>{const s=S_(e,t);let i=0,r,u=d=>{r||(r=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await s.next();if(f){u(),d.close();return}let g=p.byteLength;if(o){let y=i+=g;o(y)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},jh=64*1024,{isFunction:fr}=Te,I_=(({Request:e,Response:t})=>({Request:e,Response:t}))(Te.global),{ReadableStream:Zh,TextEncoder:Wh}=Te.global,qh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},$_=e=>{e=Te.merge.call({skipUndefined:!0},I_,e);const{fetch:t,Request:o,Response:a}=e,s=t?fr(t):typeof fetch=="function",i=fr(o),r=fr(a);if(!s)return!1;const u=s&&fr(Zh),d=s&&(typeof Wh=="function"?(b=>C=>b.encode(C))(new Wh):async b=>new Uint8Array(await new o(b).arrayBuffer())),f=i&&u&&qh(()=>{let b=!1;const C=new o(Fn.origin,{body:new Zh,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!C}),p=r&&u&&qh(()=>Te.isReadableStream(new a("").body)),g={stream:p&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!g[b]&&(g[b]=(C,x)=>{let $=C&&C[b];if($)return $.call(C);throw new vt(`Response type '${b}' is not supported`,vt.ERR_NOT_SUPPORT,x)})});const y=async b=>{if(b==null)return 0;if(Te.isBlob(b))return b.size;if(Te.isSpecCompliantForm(b))return(await new o(Fn.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(b)||Te.isArrayBuffer(b))return b.byteLength;if(Te.isURLSearchParams(b)&&(b=b+""),Te.isString(b))return(await d(b)).byteLength},k=async(b,C)=>{const x=Te.toFiniteNumber(b.getContentLength());return x??y(C)};return async b=>{let{url:C,method:x,data:$,signal:I,cancelToken:S,timeout:B,onDownloadProgress:R,onUploadProgress:Z,responseType:A,headers:N,withCredentials:O="same-origin",fetchOptions:V}=Tv(b),P=t||fetch;A=A?(A+"").toLowerCase():"text";let j=C_([I,S&&S.toAbortSignal()],B),Q=null;const ae=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let pe;try{if(Z&&f&&x!=="get"&&x!=="head"&&(pe=await k(N,$))!==0){let ke=new o(C,{method:"POST",body:$,duplex:"half"}),Re;if(Te.isFormData($)&&(Re=ke.headers.get("content-type"))&&N.setContentType(Re),ke.body){const[Xe,Ne]=zh(pe,Ur(Hh(Z)));$=Gh(ke.body,jh,Xe,Ne)}}Te.isString(O)||(O=O?"include":"omit");const ne=i&&"credentials"in o.prototype,oe={...V,signal:j,method:x.toUpperCase(),headers:N.normalize().toJSON(),body:$,duplex:"half",credentials:ne?O:void 0};Q=i&&new o(C,oe);let U=await(i?P(Q,V):P(C,oe));const Y=p&&(A==="stream"||A==="response");if(p&&(R||Y&&ae)){const ke={};["status","statusText","headers"].forEach(ze=>{ke[ze]=U[ze]});const Re=Te.toFiniteNumber(U.headers.get("content-length")),[Xe,Ne]=R&&zh(Re,Ur(Hh(R),!0))||[];U=new a(Gh(U.body,jh,Xe,()=>{Ne&&Ne(),ae&&ae()}),ke)}A=A||"text";let de=await g[Te.findKey(g,A)||"text"](U,b);return!Y&&ae&&ae(),await new Promise((ke,Re)=>{Iv(ke,Re,{data:de,headers:uo.from(U.headers),status:U.status,statusText:U.statusText,config:b,request:Q})})}catch(ne){throw ae&&ae(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new vt("Network Error",vt.ERR_NETWORK,b,Q),{cause:ne.cause||ne}):vt.from(ne,ne&&ne.code,b,Q)}}},T_=new Map,Mv=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:s}=t,i=[a,s,o];let r=i.length,u=r,d,f,p=T_;for(;u--;)d=i[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:$_(t)),p=f;return f};Mv();const ad={http:Zk,xhr:w_,fetch:{get:Mv}};Te.forEach(ad,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Kh=e=>`- ${e}`,M_=e=>Te.isFunction(e)||e===null||e===!1;function A_(e,t){e=Te.isArray(e)?e:[e];const{length:o}=e;let a,s;const i={};for(let r=0;r<o;r++){a=e[r];let u;if(s=a,!M_(a)&&(s=ad[(u=String(a)).toLowerCase()],s===void 0))throw new vt(`Unknown adapter '${u}'`);if(s&&(Te.isFunction(s)||(s=s.get(t))))break;i[u||"#"+r]=s}if(!s){const r=Object.entries(i).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=o?r.length>1?`since :
`+r.map(Kh).join(`
`):" "+Kh(r[0]):"as no adapter specified";throw new vt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Av={getAdapter:A_,adapters:ad};function Kc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ki(null,e)}function Jh(e){return Kc(e),e.headers=uo.from(e.headers),e.data=qc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Av.getAdapter(e.adapter||ql.adapter,e)(e).then(function(a){return Kc(e),a.data=qc.call(e,e.transformResponse,a),a.headers=uo.from(a.headers),a},function(a){return xv(a)||(Kc(e),a&&a.response&&(a.response.data=qc.call(e,e.transformResponse,a.response),a.response.headers=uo.from(a.response.headers))),Promise.reject(a)})}const Ev="1.13.2",gc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Yh={};gc.transitional=function(t,o,a){function s(i,r){return"[Axios v"+Ev+"] Transitional option '"+i+"'"+r+(a?". "+a:"")}return(i,r,u)=>{if(t===!1)throw new vt(s(r," has been removed"+(o?" in "+o:"")),vt.ERR_DEPRECATED);return o&&!Yh[r]&&(Yh[r]=!0,console.warn(s(r," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,r,u):!0}};gc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function E_(e,t,o){if(typeof e!="object")throw new vt("options must be an object",vt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],r=t[i];if(r){const u=e[i],d=u===void 0||r(u,i,e);if(d!==!0)throw new vt("option "+i+" must be "+d,vt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new vt("Unknown option "+i,vt.ERR_BAD_OPTION)}}const Cr={assertOptions:E_,validators:gc},ds=Cr.validators;let ni=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Fh,response:new Fh}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ai(this.defaults,o);const{transitional:a,paramsSerializer:s,headers:i}=o;a!==void 0&&Cr.assertOptions(a,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(Te.isFunction(s)?o.paramsSerializer={serialize:s}:Cr.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Cr.assertOptions(o,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let r=i&&Te.merge(i.common,i[o.method]);i&&Te.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),o.headers=uo.concat(r,i);const u=[];let d=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(o)===!1||(d=d&&C.synchronous,u.unshift(C.fulfilled,C.rejected))});const f=[];this.interceptors.response.forEach(function(C){f.push(C.fulfilled,C.rejected)});let p,g=0,y;if(!d){const b=[Jh.bind(this),void 0];for(b.unshift(...u),b.push(...f),y=b.length,p=Promise.resolve(o);g<y;)p=p.then(b[g++],b[g++]);return p}y=u.length;let k=o;for(;g<y;){const b=u[g++],C=u[g++];try{k=b(k)}catch(x){C.call(this,x);break}}try{p=Jh.call(this,k)}catch(b){return Promise.reject(b)}for(g=0,y=f.length;g<y;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=ai(this.defaults,t);const o=$v(t.baseURL,t.url,t.allowAbsoluteUrls);return Cv(o,t.params,t.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(t){ni.prototype[t]=function(o,a){return this.request(ai(a||{},{method:t,url:o,data:(a||{}).data}))}});Te.forEach(["post","put","patch"],function(t){function o(a){return function(i,r,u){return this.request(ai(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:r}))}}ni.prototype[t]=o(),ni.prototype[t+"Form"]=o(!0)});let P_=class Pv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const r=new Promise(u=>{a.subscribe(u),i=u}).then(s);return r.cancel=function(){a.unsubscribe(i)},r},t(function(i,r,u){a.reason||(a.reason=new Ki(i,r,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Pv(function(s){t=s}),cancel:t}}};function D_(e){return function(o){return e.apply(null,o)}}function O_(e){return Te.isObject(e)&&e.isAxiosError===!0}const Cu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Cu).forEach(([e,t])=>{Cu[t]=e});function Dv(e){const t=new ni(e),o=dv(ni.prototype.request,t);return Te.extend(o,ni.prototype,t,{allOwnKeys:!0}),Te.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Dv(ai(e,s))},o}const an=Dv(ql);an.Axios=ni;an.CanceledError=Ki;an.CancelToken=P_;an.isCancel=xv;an.VERSION=Ev;an.toFormData=mc;an.AxiosError=vt;an.Cancel=an.CanceledError;an.all=function(t){return Promise.all(t)};an.spread=D_;an.isAxiosError=O_;an.mergeConfig=ai;an.AxiosHeaders=uo;an.formToJSON=e=>Sv(Te.isHTMLForm(e)?new FormData(e):e);an.getAdapter=Av.getAdapter;an.HttpStatusCode=Cu;an.default=an;const{Axios:_H,AxiosError:bH,CanceledError:wH,isCancel:CH,CancelToken:LH,VERSION:SH,all:xH,Cancel:IH,isAxiosError:$H,spread:TH,toFormData:MH,AxiosHeaders:AH,HttpStatusCode:EH,formToJSON:PH,getAdapter:DH,mergeConfig:OH}=an,ka="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",R_="VolunteerCheckinOffline",B_=1;let Jo=null;async function Ws(){return Jo||new Promise((e,t)=>{const o=indexedDB.open(R_,B_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Jo=o.result,e(Jo)},o.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Ul(e,t){return await Ws(),new Promise((o,a)=>{const s=Jo.transaction(["eventData","syncMeta"],"readwrite"),i=s.objectStore("eventData"),r=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),r.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function La(e){return await Ws(),new Promise((t,o)=>{const i=Jo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function Lr(e,t,o){const a=await La(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await Ul(e,a))}async function N_(e){return await Ws(),new Promise((t,o)=>{const s=Jo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},r=s.add(i);r.onsuccess=()=>t(r.result),r.onerror=()=>o(r.error)})}async function Ov(){return await Ws(),new Promise((e,t)=>{const i=Jo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const r=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(r)},i.onerror=()=>t(i.error)})}async function zr(){return(await Ov()).length}async function Xh(e,t){return await Ws(),new Promise((o,a)=>{const s=Jo.transaction(["pendingActions"],"readwrite"),i=s.objectStore("pendingActions"),r=i.get(e);r.onsuccess=()=>{const u=r.result;u&&(Object.assign(u,t),i.put(u))},s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function Qh(e){return await Ws(),new Promise((t,o)=>{const i=Jo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function F_(e){return await Ws(),new Promise((t,o)=>{const i=Jo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const Je=an.create({baseURL:ka,headers:{"Content-Type":"application/json"},timeout:15e3});let Lu=!1,Rv={type:null,eventId:null};function _o(e,t=null){Rv={type:e,eventId:t}}async function U_(){}function ef(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function z_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Bv(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Rv}const H_=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];Je.interceptors.request.use(e=>{if(H_.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Bv();let s=null;if(a.type==="marshal"&&a.eventId){const i=Fr(a.eventId);i?.token&&(s=i.token)}return s||(s=localStorage.getItem("sessionToken")),s&&(e.headers.Authorization=`Bearer ${s}`),e});let Hr=0;const V_=2;function G_(){if(Hr++,Hr>=V_&&Bv().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function j_(){Hr=0}function Jc(){Hr=0}function Z_(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const s=window.location.hash||"";return!!(s.match(/#\/event\/[^/?]+/)||s==="#/marshal"||s.startsWith("#/marshal?"))}Je.interceptors.response.use(e=>{Lu=!1,j_();const t=e.config.url,o=ef(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return Z_(t)||G_(),Promise.reject(e);if(z_(e)&&(Lu=!0,t.method==="get")){const o=ef(t.url);if(o){const a=await La(o);if(a)return console.log("Returning cached data for:",t.url),Promise.resolve({data:a,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function ko(e,t,o){return await N_({type:e,payload:t,eventId:t.eventId}),await U_(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function Dn(){return Lu||!navigator.onLine}const W_={check:()=>Je.head("/health")},Su=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),ms={requestLogin:e=>Je.post("/auth/request-login",{email:e,frontendUrl:Su()}),verifyToken:e=>Je.post("/auth/verify-token",{token:e}),instantLogin:e=>Je.post("/auth/instant-login",{email:e}),createAdmin:e=>Je.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Je.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Je.get("/auth/me",{params:{eventId:e}}),logout:()=>Je.post("/auth/logout")},pr={getProfile:()=>Je.get("/auth/profile"),updateProfile:e=>Je.put("/auth/profile",e),getPerson:(e,t)=>Je.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Je.put(`/people/${e}`,o,{params:{eventId:t}})},_a={create:e=>Je.post("/events",e),getAll:()=>Je.get("/events"),getById:e=>Je.get(`/events/${e}`),update:(e,t)=>Je.put(`/events/${e}`,t),delete:e=>Je.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Je.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Kn={create:e=>Je.post("/locations",e),getById:(e,t)=>Je.get(`/locations/${e}/${t}`),getByEvent:e=>Je.get(`/events/${e}/locations`),update:(e,t,o)=>Je.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),Je.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Je.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Je.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Je.get(`/events/${e}/dynamic-checkpoints`)},ml={create:e=>Je.post("/assignments",e),getById:(e,t)=>Je.get(`/assignments/${e}/${t}`),getByEvent:e=>Je.get(`/assignments/event/${e}`),delete:(e,t)=>Je.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Je.get(`/events/${e}/status`)},Sa={checkIn:e=>Je.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:s}={})=>Je.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:s??null}),adminCheckIn:(e,t)=>Je.post(`/checkin/admin/${e}/${t}`)},Yc={getAdmins:e=>Je.get(`/events/${e}/admins`),addAdmin:(e,t)=>Je.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Je.delete(`/events/${e}/admins/${t}`)},gs={create:e=>Je.post("/marshals",e),getByEvent:e=>Je.get(`/events/${e}/marshals`),getById:(e,t)=>Je.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Je.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Je.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Su()}}),sendMagicLink:(e,t)=>Je.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Su()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Je.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},ba={create:e=>Je.post("/areas",e),getByEvent:e=>Je.get(`/events/${e}/areas`),getById:(e,t)=>Je.get(`/areas/${e}/${t}`),update:(e,t,o)=>Je.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/areas/${e}/${t}`),recalculate:e=>Je.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Je.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Je.get(`/events/${e}/area-lead-dashboard`)},Nt={create:(e,t)=>Je.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Je.get(`/events/${e}/checklist-items`),getById:(e,t)=>Je.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Je.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/checklist-items/${e}/${t}`),getReport:e=>Je.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Je.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Je.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Je.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Ps={create:(e,t)=>Je.post(`/events/${e}/notes`,t),getByEvent:e=>Je.get(`/events/${e}/notes`),getById:(e,t)=>Je.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Je.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Je.get(`/events/${e}/my-notes`)},pa={create:(e,t)=>Je.post(`/events/${e}/contacts`,t),getByEvent:e=>Je.get(`/events/${e}/contacts`),getById:(e,t)=>Je.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Je.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Je.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Je.get(`/events/${e}/my-contacts`)},ps={create:(e,t)=>Je.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Je.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Je.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Je.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Je.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Je.post(`/events/${e}/incidents/${t}/notes`,{note:o})},Ge=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o},q_={class:"hero-animation-container"},K_={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=M(!1);return tn(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,s)=>(v(),m("div",q_,[(v(),m("svg",{viewBox:"0 0 400 350",class:ve(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...s[0]||(s[0]=[Dr(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},J_=Ge(K_,[["__scopeId","data-v-cec8ae43"]]),Y_={class:"hero-header"},X_={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=M(!1);return tn(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),m("div",Y_,[Ae(J_,{animate:t.value},null,8,["animate"]),e.title?(v(),m("div",{key:0,class:ve(["hero-overlay",{"no-animate":!t.value}])},[l("h1",null,w(e.title),1)],2)):E("",!0)]))}},Nv=Ge(X_,[["__scopeId","data-v-c824ab01"]]),Kl=Xu("auth",()=>{const e=M(localStorage.getItem("adminEmail")||null),t=M(!!e.value),o=M(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ms.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ms.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},instantLogin:async u=>{const d=await ms.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},logout:async()=>{try{await ms.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),_o(null)}}}),Q_={class:"modal-card"},eb={key:0,class:"email-sent"},tb={key:1},nb={class:"form-group"},ob=["disabled"],sb={key:0,class:"error"},ab={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,s=Kl(),i=M(""),r=M(!1),u=M(null),d=M(!1);async function f(){r.value=!0,u.value=null;try{const y=await s.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):u.value=y.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{r.value=!1}}function p(){i.value="",d.value=!1,u.value=null}function g(){a("close")}return Ze(()=>o.show,y=>{y||setTimeout(()=>{p()},200)}),(y,k)=>(v(),qe(Pl,{to:"body"},[Ae(ys,{name:"modal"},{default:Ve(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",style:et({zIndex:e.zIndex}),onClick:it(g,["self"])},[l("div",Q_,[l("button",{class:"modal-close",onClick:g},""),d.value?(v(),m("div",eb,[k[2]||(k[2]=l("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=l("h3",null,"Check your email!",-1)),l("p",null,[k[1]||(k[1]=Ye("We've sent a login link to ",-1)),l("strong",null,w(i.value),1)]),k[4]||(k[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:p,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",tb,[k[5]||(k[5]=l("h2",null,"Join us or login",-1)),k[6]||(k[6]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:it(f,["prevent"])},[l("div",nb,[Ue(l("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>i.value=b),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[at,i.value]])]),l("button",{type:"submit",class:"btn btn-primary btn-full",disabled:r.value},w(r.value?"Sending...":"Send login link"),9,ob)],32),u.value?(v(),m("div",sb,w(u.value),1)):E("",!0)]))])],4)):E("",!0)]),_:1})]))}},Fv=Ge(ab,[["__scopeId","data-v-7c646305"]]),ib={class:"home"},lb={class:"hero-section"},rb={class:"content-section"},cb={class:"container"},ub={class:"carousel"},db={class:"carousel-indicators"},hb=["onClick"],fb={__name:"Home",setup(e){const t=hc(),o=Zi();function a(){const y=!!localStorage.getItem("adminEmail"),k=cv();return y||k}function s(){a()?o.push("/sessions"):p.value=!0}const i=M(0);let r=null;function u(y){i.value=y,f()}function d(){i.value=(i.value+1)%2}function f(){r&&clearInterval(r),r=setInterval(d,1e4)}const p=M(!1);function g(){p.value=!1,t.query.login&&o.replace({query:{}})}return tn(()=>{f(),t.query.login&&(a()?o.replace("/sessions"):p.value=!0)}),yn(()=>{r&&clearInterval(r)}),(y,k)=>(v(),m("div",ib,[l("section",lb,[Ae(Nv,{title:"OnTheDay"}),k[0]||(k[0]=l("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),l("button",{class:"btn btn-primary",onClick:s}," Join us or login ")]),l("section",rb,[l("div",cb,[k[2]||(k[2]=Dr('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),l("div",ub,[l("div",{class:"carousel-track",style:et({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[Dr('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),l("div",db,[(v(),m(Ie,null,Fe(2,(b,C)=>l("button",{key:C,class:ve(["indicator",{active:i.value===C}]),onClick:x=>u(C)},null,10,hb)),64))])])])]),Ae(Fv,{show:p.value,onClose:g},null,8,["show"])]))}},pb=Ge(fb,[["__scopeId","data-v-aaecbd22"]]),vb={class:"admin-login"},mb={class:"login-card"},gb={key:0,class:"email-sent"},yb={class:"form-group"},kb=["disabled"],_b={key:0,class:"error"},bb={__name:"AdminLogin",setup(e){const t=Kl(),o=M(""),a=M(!1),s=M(null),i=M(!1),r=async()=>{a.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,s.value=null};return(d,f)=>{const p=Zu("router-link");return v(),m("div",vb,[l("div",mb,[f[7]||(f[7]=l("h2",null,"Admin login",-1)),i.value?(v(),m("div",gb,[f[2]||(f[2]=l("div",{class:"check-icon"},"",-1)),f[3]||(f[3]=l("h3",null,"Check your email!",-1)),l("p",null,[f[1]||(f[1]=Ye("We've sent a login link to ",-1)),l("strong",null,w(o.value),1)]),f[4]||(f[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(Ie,{key:1},[f[5]||(f[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",yb,[Ue(l("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[at,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:a.value},w(a.value?"Sending...":"Send login link"),9,kb)],32),s.value?(v(),m("div",_b,w(s.value),1)):E("",!0)],64)),Ae(p,{to:"/",class:"back-link"},{default:Ve(()=>[...f[6]||(f[6]=[Ye(" Back to Home",-1)])]),_:1})])])}}},wb=Ge(bb,[["__scopeId","data-v-5d0a88c2"]]),Cb={class:"admin-verify"},Lb={class:"verify-card"},Sb={key:0,class:"status"},xb={key:1,class:"status error"},Ib={key:2,class:"status success"},$b={__name:"AdminVerify",setup(e){const t=Zi(),o=hc(),a=Kl(),s=M(!0),i=M(null);return tn(async()=>{const r=o.query.token;if(!r){i.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await a.verifyToken(r);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(r,u)=>{const d=Zu("router-link");return v(),m("div",Cb,[l("div",Lb,[s.value?(v(),m("div",Sb,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),m("div",xb,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,w(i.value),1),Ae(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ve(()=>[...u[1]||(u[1]=[Ye(" Try again ",-1)])]),_:1})])):(v(),m("div",Ib,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to your sessions...",-1)])]))])])}}},Tb=Ge($b,[["__scopeId","data-v-b2435a84"]]),Uv=Xu("events",()=>{const e=M([]),t=M(null),o=M([]),a=M([]),s=M(null),i=M(!1),r=M(null),u=async()=>{i.value=!0,r.value=null;try{const Z=await _a.getAll();e.value=Z.data}catch(Z){throw r.value=Z.message,Z}finally{i.value=!1}},d=async Z=>{i.value=!0,r.value=null;try{const A=await _a.getById(Z);t.value=A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},f=async Z=>{i.value=!0,r.value=null;try{const A=await _a.create(Z);return e.value.push(A.data),A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},p=async(Z,A)=>{i.value=!0,r.value=null;try{const N=await _a.update(Z,A),O=e.value.findIndex(V=>V.id===Z);return O!==-1&&(e.value[O]=N.data),t.value?.id===Z&&(t.value=N.data),N.data}catch(N){throw r.value=N.message,N}finally{i.value=!1}},g=async Z=>{i.value=!0,r.value=null;try{await _a.delete(Z),e.value=e.value.filter(A=>A.id!==Z)}catch(A){throw r.value=A.message,A}finally{i.value=!1}},y=async Z=>{i.value=!0,r.value=null;try{const A=await Kn.getByEvent(Z);o.value=A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:s,loading:i,error:r,fetchEvents:u,fetchEvent:d,createEvent:f,updateEvent:p,deleteEvent:g,fetchLocations:y,createLocation:async Z=>{i.value=!0,r.value=null;try{const A=await Kn.create(Z);return o.value.push(A.data),A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},updateLocation:async(Z,A,N)=>{i.value=!0,r.value=null;try{const O=await Kn.update(Z,A,N),V=o.value.findIndex(P=>P.id===A);return V!==-1&&(o.value[V]=O.data),O.data}catch(O){throw r.value=O.message,O}finally{i.value=!1}},deleteLocation:async(Z,A)=>{i.value=!0,r.value=null;try{await Kn.delete(Z,A),o.value=o.value.filter(N=>N.id!==A)}catch(N){throw r.value=N.message,N}finally{i.value=!1}},bulkUpdateLocationTimes:async(Z,A)=>{i.value=!0,r.value=null;try{const N=await Kn.bulkUpdateTimes(Z,A);return await y(Z),N.data}catch(N){throw r.value=N.message,N}finally{i.value=!1}},fetchAssignments:async Z=>{i.value=!0,r.value=null;try{const A=await ml.getByEvent(Z);a.value=A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},createAssignment:async Z=>{i.value=!0,r.value=null;try{const A=await ml.create(Z);return a.value.push(A.data),A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},deleteAssignment:async(Z,A)=>{i.value=!0,r.value=null;try{await ml.delete(Z,A),a.value=a.value.filter(N=>N.id!==A)}catch(N){throw r.value=N.message,N}finally{i.value=!1}},fetchEventStatus:async Z=>{i.value=!0,r.value=null;try{const A=await ml.getEventStatus(Z);return s.value=A.data,A.data}catch(A){throw r.value=A.message,A}finally{i.value=!1}},updateAssignmentCheckIn:Z=>{const A=a.value.findIndex(N=>N.id===Z.id);A!==-1&&(a.value[A]=Z),s.value&&s.value.locations.forEach(N=>{const O=N.assignments.findIndex(V=>V.id===Z.id);O!==-1&&(N.assignments[O]=Z,N.checkedInCount=N.assignments.filter(V=>V.isCheckedIn).length)})}}});function zv(e="details",t=[]){const o=M(e),a=g=>{o.value=g},s=()=>{o.value=e},i=g=>o.value===g,r=F(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const y=r.value;if(y===-1)return;const k=y+1;k<t.length?o.value=t[k]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const y=r.value;if(y===-1)return;const k=y-1;k>=0?o.value=t[k]:g&&(o.value=t[t.length-1])},f=F(()=>{if(t.length===0)return!1;const g=r.value;return g!==-1&&g<t.length-1}),p=F(()=>t.length===0?!1:r.value>0);return{activeTab:o,activeTabIndex:r,hasNextTab:f,hasPreviousTab:p,switchTab:a,resetTab:s,isActiveTab:i,nextTab:u,previousTab:d}}function Mb(){const e=M(!1),t=M(""),o=M(""),a=M(null),s=M(!1),i=M("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:i,showConfirm:(p,g,y,k={})=>{t.value=p,o.value=g,a.value=y,s.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Ei=M({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Ns={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Bs={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ja(e,t,o="Marshals"){if(!t)return"";const a=Ns[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Ns.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Hv(e,t,o="Marshals"){if(!t)return"";const a=Ns[e]?.[t];return t==="Person points"?`${Ns.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function xu(e,t){return e==="Person points"?`${Ns.people[t]?.singular||"Person"} points`:e}function Iu(e){e&&(Ei.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Wo=e=>e.toLowerCase(),qo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function dt(){const e=p=>{const g=Ei.value[p],y=Ns[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const k=Ei.value.people;return`${Ns.people[k]?.singular||"Person"} point`}return y?.singular||g},t=p=>{const g=Ei.value[p],y=Ns[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const k=Ei.value.people;return`${Ns.people[k]?.singular||"Person"} points`}return y?.plural||g},o=F(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=F(()=>({person:Wo(e("people")),checkpoint:Wo(e("checkpoint")),area:Wo(e("area")),checklist:Wo(e("checklist")),course:Wo(e("course")),people:Wo(t("people")),checkpoints:Wo(t("checkpoint")),areas:Wo(t("area")),checklists:Wo(t("checklist")),courses:Wo(t("course"))})),s=F(()=>({person:qo(e("people")),checkpoint:qo(e("checkpoint")),area:qo(e("area")),checklist:qo(e("checklist")),course:qo(e("course")),people:qo(t("people")),checkpoints:qo(t("checkpoint")),areas:qo(t("area")),checklists:qo(t("checklist")),courses:qo(t("course"))})),i=F(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:s,tabLabels:i,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>Wo(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>qo(g?t(p):e(p)),terminology:Ei}}function Ab(){const e=M(!1),t=M(null),o=M({}),a=M(null),s=M(null),i=M([]),r=M(null),u=M(null),d=M(!1),f=M(!1),p=M(1),g=F(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),y=Q=>{if(Q){const ae=Q.getMapCenter?.(),pe=Q.getMapZoom?.();ae&&pe!==null&&(r.value=ae,u.value=pe)}},k=(Q={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Q.title||"Select checkpoint location",description:Q.description||"Click on the map to set the location. Click again to reposition."}},b=(Q,ae="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${ae}: ${Q}`,description:"Click on the map to set the new location"}},C=(Q={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:Q.title||"Draw area boundary",description:Q.description||"Click to add points. Click Done when finished to complete the area."}},x=(Q=1)=>{p.value=Q,i.value=[],e.value=!0,t.value="add-multiple",f.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},$=Q=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=Q:t.value==="add-multiple"&&I(Q)},I=Q=>{i.value.push({id:`temp-${p.value}`,name:`Checkpoint ${p.value}`,description:"",latitude:Q.lat,longitude:Q.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),p.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},S=Q=>{s.value=Q},B=()=>s.value&&s.value.length>=3?s.value.map(Q=>({lat:Q.lat,lng:Q.lng})):null,R=()=>{e.value=!1,t.value=null,o.value={},a.value=null,r.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:s,tempCheckpoints:i,savedMapCenter:r,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:f,multiCheckpointCounter:p,canCompleteFullscreen:g,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:b,enterDrawAreaMode:C,enterAddMultipleMode:x,handleFullscreenMapClick:$,handlePolygonDrawing:S,getCompletedPolygon:B,exitFullscreen:R,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],f.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),R()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],f.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(Q,ae,pe)=>F(()=>{const ne=[...Q.value];return t.value==="place-checkpoint"&&a.value&&ne.push({id:"temp-single",name:ae.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:ae.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&pe.value&&ne.push({id:"temp-move",name:pe.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:pe.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&ne.push(...i.value),ne}),createDisplayAreas:(Q,ae)=>F(()=>{const pe=[...Q.value];if(t.value==="draw-area"&&ae.value?.polygon?.length>0){const ne=pe.findIndex(oe=>oe.id===ae.value.id);ne>=0?pe[ne]={...ae.value}:pe.push({...ae.value,id:ae.value.id||"temp-area"})}return pe}),calculateStartingNumber:Q=>{const ae=Q.value.map(pe=>{const ne=pe.name.match(/^Checkpoint (\d+)$/);return ne?parseInt(ne[1]):0}).filter(pe=>pe>0);return ae.length>0?Math.max(...ae)+1:1}}}function Eb(e){const t=M([]),o=M(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Yc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Yc.addAdmin(e.value,d)},removeAdmin:async d=>{await Yc.removeAdmin(e.value,d)}}}function Pb(e){const t=M(!1),o=M(!1),a=M(!1),s=M(!1),i=M(!1),r=M(!1),u=M(null),d=M(null),f=M(null),p=M(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:s,importing:i,importingMarshals:r,uploadError:u,importError:d,importResult:f,importMarshalsResult:p,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async R=>{if(!R)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await _a.uploadGpx(e.value,R),!0}catch(Z){return console.error("Failed to upload route:",Z),u.value=Z.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,f.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,f.value=null},importLocations:async(R,Z)=>{if(!R)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,f.value=null;try{const A=await Kn.importCsv(e.value,R,Z);return f.value=A.data,A.data}catch(A){return console.error("Failed to import locations:",A),d.value=A.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,p.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,p.value=null},importMarshals:async R=>{if(!R)return d.value="Please select a CSV file",null;r.value=!0,d.value=null,p.value=null;try{const Z=await gs.importCsv(e.value,R);return p.value=Z.data,Z.data}catch(Z){return console.error("Failed to import marshals:",Z),d.value=Z.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{r.value=!1}},formatImportResultMessage:(R,Z="location")=>{const A=Z==="location"?"location(s)":"marshal(s)";let O=`<p>Created <strong>${R[Z==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${A} and <strong>${R.assignmentsCreated}</strong> assignment(s)</p>`;return R.errors&&R.errors.length>0&&(O+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',R.errors.forEach(V=>{O+=`<li>${V}</li>`}),O+="</ul>"),O}}}const Vv="admin-theme-preference",Wa=M(Db());function Db(){return typeof window>"u"?"system":localStorage.getItem(Vv)||"system"}function Ob(e){localStorage.setItem(Vv,e)}function Gv(){const e=F(()=>Wa.value==="system"?"light dark":Wa.value),t=(s,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Wa.value=s,Ob(s)},o=()=>{const s=["system","light","dark"],r=(s.indexOf(Wa.value)+1)%s.length;t(s[r])},a=F(()=>Wa.value==="dark"?!0:Wa.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Wa,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const jv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",zl=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${s}T${i}:${r}`},Vr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},li=(e,t,o,a)=>{const i=e*Math.PI/180,r=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,f=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(r)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))},Rb=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Bb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gl={exports:{}};var Nb=gl.exports,tf;function Fb(){return tf||(tf=1,(function(e,t){(function(o,a){a(t)})(Nb,(function(o){var a="1.9.4";function s(n){var c,h,_,T;for(h=1,_=arguments.length;h<_;h++){T=arguments[h];for(c in T)n[c]=T[c]}return n}var i=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function r(n,c){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var _=h.call(arguments,2);return function(){return n.apply(c,_.length?_.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,c,h){var _,T,z,se;return se=function(){_=!1,T&&(z.apply(h,T),T=!1)},z=function(){_?T=arguments:(n.apply(h,arguments),setTimeout(se,c),_=!0)},z}function p(n,c,h){var _=c[1],T=c[0],z=_-T;return n===_&&h?n:((n-T)%z+z)%z+T}function g(){return!1}function y(n,c){if(c===!1)return n;var h=Math.pow(10,c===void 0?6:c);return Math.round(n*h)/h}function k(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function b(n){return k(n).split(/\s+/)}function C(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var h in c)n.options[h]=c[h];return n.options}function x(n,c,h){var _=[];for(var T in n)_.push(encodeURIComponent(h?T.toUpperCase():T)+"="+encodeURIComponent(n[T]));return(!c||c.indexOf("?")===-1?"?":"&")+_.join("&")}var $=/\{ *([\w_ -]+) *\}/g;function I(n,c){return n.replace($,function(h,_){var T=c[_];if(T===void 0)throw new Error("No value provided for variable "+h);return typeof T=="function"&&(T=T(c)),T})}var S=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function B(n,c){for(var h=0;h<n.length;h++)if(n[h]===c)return h;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Z(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var A=0;function N(n){var c=+new Date,h=Math.max(0,16-(c-A));return A=c+h,window.setTimeout(n,h)}var O=window.requestAnimationFrame||Z("RequestAnimationFrame")||N,V=window.cancelAnimationFrame||Z("CancelAnimationFrame")||Z("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function P(n,c,h){if(h&&O===N)n.call(c);else return O.call(window,r(n,c))}function j(n){n&&V.call(window,n)}var Q={__proto__:null,extend:s,create:i,bind:r,get lastId(){return u},stamp:d,throttle:f,wrapNum:p,falseFn:g,formatNum:y,trim:k,splitWords:b,setOptions:C,getParamString:x,template:I,isArray:S,indexOf:B,emptyImageUrl:R,requestFn:O,cancelFn:V,requestAnimFrame:P,cancelAnimFrame:j};function ae(){}ae.extend=function(n){var c=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,_=i(h);_.constructor=c,c.prototype=_;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return n.statics&&s(c,n.statics),n.includes&&(pe(n.includes),s.apply(null,[_].concat(n.includes))),s(_,n),delete _.statics,delete _.includes,_.options&&(_.options=h.options?i(h.options):{},s(_.options,n.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var z=0,se=_._initHooks.length;z<se;z++)_._initHooks[z].call(this)}},c},ae.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},ae.mergeOptions=function(n){return s(this.prototype.options,n),this},ae.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function pe(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=S(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ne={on:function(n,c,h){if(typeof n=="object")for(var _ in n)this._on(_,n[_],c);else{n=b(n);for(var T=0,z=n.length;T<z;T++)this._on(n[T],c,h)}return this},off:function(n,c,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var _ in n)this._off(_,n[_],c);else{n=b(n);for(var T=arguments.length===1,z=0,se=n.length;z<se;z++)T?this._off(n[z]):this._off(n[z],c,h)}return this},_on:function(n,c,h,_){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,h)===!1){h===this&&(h=void 0);var T={fn:c,ctx:h};_&&(T.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(T)}},_off:function(n,c,h){var _,T,z;if(this._events&&(_=this._events[n],!!_)){if(arguments.length===1){if(this._firingCount)for(T=0,z=_.length;T<z;T++)_[T].fn=g;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var se=this._listens(n,c,h);if(se!==!1){var Ce=_[se];this._firingCount&&(Ce.fn=g,this._events[n]=_=_.slice()),_.splice(se,1)}}},fire:function(n,c,h){if(!this.listens(n,h))return this;var _=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[n];if(T){this._firingCount=this._firingCount+1||1;for(var z=0,se=T.length;z<se;z++){var Ce=T[z],$e=Ce.fn;Ce.once&&this.off(n,$e,Ce.ctx),$e.call(Ce.ctx||this,_)}this._firingCount--}}return h&&this._propagateEvent(_),this},listens:function(n,c,h,_){typeof n!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(_=!!c,T=void 0,h=void 0);var z=this._events&&this._events[n];if(z&&z.length&&this._listens(n,T,h)!==!1)return!0;if(_){for(var se in this._eventParents)if(this._eventParents[se].listens(n,c,h,_))return!0}return!1},_listens:function(n,c,h){if(!this._events)return!1;var _=this._events[n]||[];if(!c)return!!_.length;h===this&&(h=void 0);for(var T=0,z=_.length;T<z;T++)if(_[T].fn===c&&_[T].ctx===h)return T;return!1},once:function(n,c,h){if(typeof n=="object")for(var _ in n)this._on(_,n[_],c,!0);else{n=b(n);for(var T=0,z=n.length;T<z;T++)this._on(n[T],c,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};ne.addEventListener=ne.on,ne.removeEventListener=ne.clearAllEventListeners=ne.off,ne.addOneTimeEventListener=ne.once,ne.fireEvent=ne.fire,ne.hasEventListeners=ne.listens;var oe=ae.extend(ne);function U(n,c,h){this.x=h?Math.round(n):n,this.y=h?Math.round(c):c}var Y=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(n){return this.clone()._add(de(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(de(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new U(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new U(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Y(this.x),this.y=Y(this.y),this},distanceTo:function(n){n=de(n);var c=n.x-this.x,h=n.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(n){return n=de(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=de(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function de(n,c,h){return n instanceof U?n:S(n)?new U(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new U(n.x,n.y):new U(n,c,h)}function ke(n,c){if(n)for(var h=c?[n,c]:n,_=0,T=h.length;_<T;_++)this.extend(h[_])}ke.prototype={extend:function(n){var c,h;if(!n)return this;if(n instanceof U||typeof n[0]=="number"||"x"in n)c=h=de(n);else if(n=Re(n),c=n.min,h=n.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return de((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return de(this.min.x,this.max.y)},getTopRight:function(){return de(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,h;return typeof n[0]=="number"||n instanceof U?n=de(n):n=Re(n),n instanceof ke?(c=n.min,h=n.max):c=h=n,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Re(n);var c=this.min,h=this.max,_=n.min,T=n.max,z=T.x>=c.x&&_.x<=h.x,se=T.y>=c.y&&_.y<=h.y;return z&&se},overlaps:function(n){n=Re(n);var c=this.min,h=this.max,_=n.min,T=n.max,z=T.x>c.x&&_.x<h.x,se=T.y>c.y&&_.y<h.y;return z&&se},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,h=this.max,_=Math.abs(c.x-h.x)*n,T=Math.abs(c.y-h.y)*n;return Re(de(c.x-_,c.y-T),de(h.x+_,h.y+T))},equals:function(n){return n?(n=Re(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Re(n,c){return!n||n instanceof ke?n:new ke(n,c)}function Xe(n,c){if(n)for(var h=c?[n,c]:n,_=0,T=h.length;_<T;_++)this.extend(h[_])}Xe.prototype={extend:function(n){var c=this._southWest,h=this._northEast,_,T;if(n instanceof ze)_=n,T=n;else if(n instanceof Xe){if(_=n._southWest,T=n._northEast,!_||!T)return this}else return n?this.extend(We(n)||Ne(n)):this;return!c&&!h?(this._southWest=new ze(_.lat,_.lng),this._northEast=new ze(T.lat,T.lng)):(c.lat=Math.min(_.lat,c.lat),c.lng=Math.min(_.lng,c.lng),h.lat=Math.max(T.lat,h.lat),h.lng=Math.max(T.lng,h.lng)),this},pad:function(n){var c=this._southWest,h=this._northEast,_=Math.abs(c.lat-h.lat)*n,T=Math.abs(c.lng-h.lng)*n;return new Xe(new ze(c.lat-_,c.lng-T),new ze(h.lat+_,h.lng+T))},getCenter:function(){return new ze((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ze(this.getNorth(),this.getWest())},getSouthEast:function(){return new ze(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ze||"lat"in n?n=We(n):n=Ne(n);var c=this._southWest,h=this._northEast,_,T;return n instanceof Xe?(_=n.getSouthWest(),T=n.getNorthEast()):_=T=n,_.lat>=c.lat&&T.lat<=h.lat&&_.lng>=c.lng&&T.lng<=h.lng},intersects:function(n){n=Ne(n);var c=this._southWest,h=this._northEast,_=n.getSouthWest(),T=n.getNorthEast(),z=T.lat>=c.lat&&_.lat<=h.lat,se=T.lng>=c.lng&&_.lng<=h.lng;return z&&se},overlaps:function(n){n=Ne(n);var c=this._southWest,h=this._northEast,_=n.getSouthWest(),T=n.getNorthEast(),z=T.lat>c.lat&&_.lat<h.lat,se=T.lng>c.lng&&_.lng<h.lng;return z&&se},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=Ne(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ne(n,c){return n instanceof Xe?n:new Xe(n,c)}function ze(n,c,h){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,h!==void 0&&(this.alt=+h)}ze.prototype={equals:function(n,c){if(!n)return!1;n=We(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return ye.distance(this,We(n))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,h=c/Math.cos(Math.PI/180*this.lat);return Ne([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new ze(this.lat,this.lng,this.alt)}};function We(n,c,h){return n instanceof ze?n:S(n)&&typeof n[0]!="object"?n.length===3?new ze(n[0],n[1],n[2]):n.length===2?new ze(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ze(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new ze(n,c,h)}var ee={latLngToPoint:function(n,c){var h=this.projection.project(n),_=this.scale(c);return this.transformation._transform(h,_)},pointToLatLng:function(n,c){var h=this.scale(c),_=this.transformation.untransform(n,h);return this.projection.unproject(_)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(n),_=this.transformation.transform(c.min,h),T=this.transformation.transform(c.max,h);return new ke(_,T)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,_=n.alt;return new ze(h,c,_)},wrapLatLngBounds:function(n){var c=n.getCenter(),h=this.wrapLatLng(c),_=c.lat-h.lat,T=c.lng-h.lng;if(_===0&&T===0)return n;var z=n.getSouthWest(),se=n.getNorthEast(),Ce=new ze(z.lat-_,z.lng-T),$e=new ze(se.lat-_,se.lng-T);return new Xe(Ce,$e)}},ye=s({},ee,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var h=Math.PI/180,_=n.lat*h,T=c.lat*h,z=Math.sin((c.lat-n.lat)*h/2),se=Math.sin((c.lng-n.lng)*h/2),Ce=z*z+Math.cos(_)*Math.cos(T)*se*se,$e=2*Math.atan2(Math.sqrt(Ce),Math.sqrt(1-Ce));return this.R*$e}}),te=6378137,ge={R:te,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,h=this.MAX_LATITUDE,_=Math.max(Math.min(h,n.lat),-h),T=Math.sin(_*c);return new U(this.R*n.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(n){var c=180/Math.PI;return new ze((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=te*Math.PI;return new ke([-n,-n],[n,n])})()};function he(n,c,h,_){if(S(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=h,this._d=_}he.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new U((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function G(n,c,h,_){return new he(n,c,h,_)}var J=s({},ye,{code:"EPSG:3857",projection:ge,transformation:(function(){var n=.5/(Math.PI*ge.R);return G(n,.5,-n,.5)})()}),ce=s({},J,{code:"EPSG:900913"});function Me(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Be(n,c){var h="",_,T,z,se,Ce,$e;for(_=0,z=n.length;_<z;_++){for(Ce=n[_],T=0,se=Ce.length;T<se;T++)$e=Ce[T],h+=(T?"L":"M")+$e.x+" "+$e.y;h+=c?je.svg?"z":"x":""}return h||"M0 0"}var De=document.documentElement.style,Le="ActiveXObject"in window,X=Le&&!document.addEventListener,fe="msLaunchUri"in navigator&&!("documentMode"in document),xe=st("webkit"),Se=st("android"),_e=st("android 2")||st("android 3"),W=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),q=Se&&st("Google")&&W<537&&!("AudioNode"in window),K=!!window.opera,le=!fe&&st("chrome"),Ee=st("gecko")&&!xe&&!K&&!Le,Ke=!le&&st("safari"),Qe=st("phantom"),gt="OTransition"in De,Lt=navigator.platform.indexOf("Win")===0,yt=Le&&"transition"in De,xt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_e,kt="MozPerspective"in De,Ut=!window.L_DISABLE_3D&&(yt||xt||kt)&&!gt&&!Qe,Rt=typeof orientation<"u"||st("mobile"),ct=Rt&&xe,ln=Rt&&xt,un=!window.PointerEvent&&window.MSPointerEvent,Bt=!!(window.PointerEvent||un),bt="ontouchstart"in window||!!window.TouchEvent,Yn=!window.L_NO_TOUCH&&(bt||Bt),Un=Rt&&K,Xn=Rt&&Ee,kn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kt=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return n})(),_s=(function(){return!!document.createElement("canvas").getContext})(),Qn=!!(document.createElementNS&&Me("svg").createSVGRect),Co=!!Qn&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),re=!Qn&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),ue=navigator.platform.indexOf("Mac")===0,me=navigator.platform.indexOf("Linux")===0;function st(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var je={ie:Le,ielt9:X,edge:fe,webkit:xe,android:Se,android23:_e,androidStock:q,opera:K,chrome:le,gecko:Ee,safari:Ke,phantom:Qe,opera12:gt,win:Lt,ie3d:yt,webkit3d:xt,gecko3d:kt,any3d:Ut,mobile:Rt,mobileWebkit:ct,mobileWebkit3d:ln,msPointer:un,pointer:Bt,touch:Yn,touchNative:bt,mobileOpera:Un,mobileGecko:Xn,retina:kn,passiveEvents:Kt,canvas:_s,svg:Qn,vml:re,inlineSvg:Co,mac:ue,linux:me},$t=je.msPointer?"MSPointerDown":"pointerdown",Yt=je.msPointer?"MSPointerMove":"pointermove",nn=je.msPointer?"MSPointerUp":"pointerup",Bo=je.msPointer?"MSPointerCancel":"pointercancel",ho={touchstart:$t,touchmove:Yt,touchend:nn,touchcancel:Bo},No={touchstart:Lo,touchmove:dn,touchend:dn,touchcancel:dn},zn={},Aa=!1;function bs(n,c,h){return c==="touchstart"&&Ks(),No[c]?(h=No[c].bind(this,h),n.addEventListener(ho[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function Fo(n,c,h){if(!ho[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(ho[c],h,!1)}function ss(n){zn[n.pointerId]=n}function qs(n){zn[n.pointerId]&&(zn[n.pointerId]=n)}function Hn(n){delete zn[n.pointerId]}function Ks(){Aa||(document.addEventListener($t,ss,!0),document.addEventListener(Yt,qs,!0),document.addEventListener(nn,Hn,!0),document.addEventListener(Bo,Hn,!0),Aa=!0)}function dn(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in zn)c.touches.push(zn[h]);c.changedTouches=[c],n(c)}}function Lo(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Jt(c),dn(n,c)}function So(n){var c={},h,_;for(_ in n)h=n[_],c[_]=h&&h.bind?h.bind(n):h;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var ws=200;function fo(n,c){n.addEventListener("dblclick",c);var h=0,_;function T(z){if(z.detail!==1){_=z.detail;return}if(!(z.pointerType==="mouse"||z.sourceCapabilities&&!z.sourceCapabilities.firesTouchEvents)){var se=Da(z);if(!(se.some(function($e){return $e instanceof HTMLLabelElement&&$e.attributes.for})&&!se.some(function($e){return $e instanceof HTMLInputElement||$e instanceof HTMLSelectElement}))){var Ce=Date.now();Ce-h<=ws?(_++,_===2&&c(So(z))):_=1,h=Ce}}}return n.addEventListener("click",T),{dblclick:c,simDblclick:T}}function po(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var eo=as(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xo=as(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),pn=xo==="webkitTransition"||xo==="OTransition"?xo+"End":"transitionend";function vo(n){return typeof n=="string"?document.getElementById(n):n}function to(n,c){var h=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(n,null);h=_?_[c]:null}return h==="auto"?null:h}function mt(n,c,h){var _=document.createElement(n);return _.className=c||"",h&&h.appendChild(_),_}function Et(n){var c=n.parentNode;c&&c.removeChild(n)}function Io(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Uo(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function mo(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Js(n,c){if(n.classList!==void 0)return n.classList.contains(c);var h=Cs(n);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function ht(n,c){if(n.classList!==void 0)for(var h=b(c),_=0,T=h.length;_<T;_++)n.classList.add(h[_]);else if(!Js(n,c)){var z=Cs(n);Ea(n,(z?z+" ":"")+c)}}function zt(n,c){n.classList!==void 0?n.classList.remove(c):Ea(n,k((" "+Cs(n)+" ").replace(" "+c+" "," ")))}function Ea(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function Cs(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Mn(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&Yi(n,c)}function Yi(n,c){var h=!1,_="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(_)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):n.style.filter+=" progid:"+_+"(opacity="+c+")"}function as(n){for(var c=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in c)return n[h];return!1}function $o(n,c,h){var _=c||new U(0,0);n.style[eo]=(je.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(h?" scale("+h+")":"")}function qt(n,c){n._leaflet_pos=c,je.any3d?$o(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function zo(n){return n._leaflet_pos||new U(0,0)}var Ho,Ls,Pa;if("onselectstart"in document)Ho=function(){rt(window,"selectstart",Jt)},Ls=function(){St(window,"selectstart",Jt)};else{var _n=as(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ho=function(){if(_n){var n=document.documentElement.style;Pa=n[_n],n[_n]="none"}},Ls=function(){_n&&(document.documentElement.style[_n]=Pa,Pa=void 0)}}function no(){rt(window,"dragstart",Jt)}function Zt(){St(window,"dragstart",Jt)}var bn,Ys;function Xs(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Qs(),bn=n,Ys=n.style.outlineStyle,n.style.outlineStyle="none",rt(window,"keydown",Qs))}function Qs(){bn&&(bn.style.outlineStyle=Ys,bn=void 0,Ys=void 0,St(window,"keydown",Qs))}function ci(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function An(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var ea={__proto__:null,TRANSFORM:eo,TRANSITION:xo,TRANSITION_END:pn,get:vo,getStyle:to,create:mt,remove:Et,empty:Io,toFront:Uo,toBack:mo,hasClass:Js,addClass:ht,removeClass:zt,setClass:Ea,getClass:Cs,setOpacity:Mn,testProp:as,setTransform:$o,setPosition:qt,getPosition:zo,get disableTextSelection(){return Ho},get enableTextSelection(){return Ls},disableImageDrag:no,enableImageDrag:Zt,preventOutline:Xs,restoreOutline:Qs,getSizedParentNode:ci,getScale:An};function rt(n,c,h,_){if(c&&typeof c=="object")for(var T in c)ta(n,T,c[T],h);else{c=b(c);for(var z=0,se=c.length;z<se;z++)ta(n,c[z],h,_)}return this}var wn="_leaflet_events";function St(n,c,h,_){if(arguments.length===1)go(n),delete n[wn];else if(c&&typeof c=="object")for(var T in c)To(n,T,c[T],h);else if(c=b(c),arguments.length===2)go(n,function(Ce){return B(c,Ce)!==-1});else for(var z=0,se=c.length;z<se;z++)To(n,c[z],h,_);return this}function go(n,c){for(var h in n[wn]){var _=h.split(/\d/)[0];(!c||c(_))&&To(n,_,null,null,h)}}var Vo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ta(n,c,h,_){var T=c+d(h)+(_?"_"+d(_):"");if(n[wn]&&n[wn][T])return this;var z=function(Ce){return h.call(_||n,Ce||window.event)},se=z;!je.touchNative&&je.pointer&&c.indexOf("touch")===0?z=bs(n,c,z):je.touch&&c==="dblclick"?z=fo(n,z):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(Vo[c]||c,z,je.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(z=function(Ce){Ce=Ce||window.event,Ra(n,Ce)&&se(Ce)},n.addEventListener(Vo[c],z,!1)):n.addEventListener(c,se,!1):n.attachEvent("on"+c,z),n[wn]=n[wn]||{},n[wn][T]=z}function To(n,c,h,_,T){T=T||c+d(h)+(_?"_"+d(_):"");var z=n[wn]&&n[wn][T];if(!z)return this;!je.touchNative&&je.pointer&&c.indexOf("touch")===0?Fo(n,c,z):je.touch&&c==="dblclick"?po(n,z):"removeEventListener"in n?n.removeEventListener(Vo[c]||c,z,!1):n.detachEvent("on"+c,z),n[wn][T]=null}function oo(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Mo(n){return ta(n,"wheel",oo),this}function Ao(n){return rt(n,"mousedown touchstart dblclick contextmenu",oo),n._leaflet_disable_click=!0,this}function Jt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Eo(n){return Jt(n),oo(n),this}function Da(n){if(n.composedPath)return n.composedPath();for(var c=[],h=n.target;h;)c.push(h),h=h.parentNode;return c}function na(n,c){if(!c)return new U(n.clientX,n.clientY);var h=An(c),_=h.boundingClientRect;return new U((n.clientX-_.left)/h.x-c.clientLeft,(n.clientY-_.top)/h.y-c.clientTop)}var Xi=je.linux&&je.chrome?window.devicePixelRatio:je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Oa(n){return je.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Xi:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ra(n,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var Qi={__proto__:null,on:rt,off:St,stopPropagation:oo,disableScrollPropagation:Mo,disableClickPropagation:Ao,preventDefault:Jt,stop:Eo,getPropagationPath:Da,getMousePosition:na,getWheelDelta:Oa,isExternalTarget:Ra,addListener:rt,removeListener:St},ui=oe.extend({run:function(n,c,h,_){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=zo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var h=this._startPos.add(this._offset.multiplyBy(n));c&&h._round(),qt(this._el,h),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),_t=oe.extend({options:{crs:J,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=C(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(We(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=xo&&je.any3d&&!je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,pn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(We(n),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var _=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,h.zoom):this._tryAnimatedPan(n,h.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,h){var _=this.getZoomScale(c),T=this.getSize().divideBy(2),z=n instanceof U?n:this.latLngToContainerPoint(n),se=z.subtract(T).multiplyBy(1-1/_),Ce=this.containerPointToLatLng(T.add(se));return this.setView(Ce,c,{zoom:h})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():Ne(n);var h=de(c.paddingTopLeft||c.padding||[0,0]),_=de(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(n,!1,h.add(_));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:n.getCenter(),zoom:T};var z=_.subtract(h).divideBy(2),se=this.project(n.getSouthWest(),T),Ce=this.project(n.getNorthEast(),T),$e=this.unproject(se.add(Ce).divideBy(2).add(z),T);return{center:$e,zoom:T}},fitBounds:function(n,c){if(n=Ne(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=de(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ui,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,h){if(h=h||{},h.animate===!1||!je.any3d)return this.setView(n,c,h);this._stop();var _=this.project(this.getCenter()),T=this.project(n),z=this.getSize(),se=this._zoom;n=We(n),c=c===void 0?se:c;var Ce=Math.max(z.x,z.y),$e=Ce*this.getZoomScale(se,c),He=T.distanceTo(_)||1,ot=1.42,ut=ot*ot;function Ct(rn){var lr=rn?-1:1,pm=rn?$e:Ce,vm=$e*$e-Ce*Ce+lr*ut*ut*He*He,mm=2*pm*ut*He,Mc=vm/mm,Id=Math.sqrt(Mc*Mc+1)-Mc,gm=Id<1e-9?-18:Math.log(Id);return gm}function Gn(rn){return(Math.exp(rn)-Math.exp(-rn))/2}function mn(rn){return(Math.exp(rn)+Math.exp(-rn))/2}function Po(rn){return Gn(rn)/mn(rn)}var io=Ct(0);function Ii(rn){return Ce*(mn(io)/mn(io+ot*rn))}function um(rn){return Ce*(mn(io)*Po(io+ot*rn)-Gn(io))/ut}function dm(rn){return 1-Math.pow(1-rn,1.5)}var hm=Date.now(),Sd=(Ct(1)-io)/ot,fm=h.duration?1e3*h.duration:1e3*Sd*.8;function xd(){var rn=(Date.now()-hm)/fm,lr=dm(rn)*Sd;rn<=1?(this._flyToFrame=P(xd,this),this._move(this.unproject(_.add(T.subtract(_).multiplyBy(um(lr)/He)),se),this.getScaleZoom(Ce/Ii(lr),se),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),xd.call(this),this},flyToBounds:function(n,c){var h=this._getBoundsCenterZoom(n,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(n){return n=Ne(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var h=this.getCenter(),_=this._limitCenter(h,this._zoom,Ne(n));return h.equals(_)||this.panTo(_,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var h=de(c.paddingTopLeft||c.padding||[0,0]),_=de(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),z=this.project(n),se=this.getPixelBounds(),Ce=Re([se.min.add(h),se.max.subtract(_)]),$e=Ce.getSize();if(!Ce.contains(z)){this._enforcingBounds=!0;var He=z.subtract(Ce.getCenter()),ot=Ce.extend(z).getSize().subtract($e);T.x+=He.x<0?-ot.x:ot.x,T.y+=He.y<0?-ot.y:ot.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),_=c.divideBy(2).round(),T=h.divideBy(2).round(),z=_.subtract(T);return!z.x&&!z.y?this:(n.animate&&n.pan?this.panBy(z):(n.pan&&this._rawPanBy(z),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=r(this._handleGeolocationResponse,this),h=r(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,n):navigator.geolocation.getCurrentPosition(c,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,h=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,h=n.coords.longitude,_=new ze(c,h),T=_.toBounds(n.coords.accuracy*2),z=this._locateOptions;if(z.setView){var se=this.getBoundsZoom(T);this.setView(_,z.maxZoom?Math.min(se,z.maxZoom):se)}var Ce={latlng:_,bounds:T,timestamp:n.timestamp};for(var $e in n.coords)typeof n.coords[$e]=="number"&&(Ce[$e]=n.coords[$e]);this.fire("locationfound",Ce)}},addHandler:function(n,c){if(!c)return this;var h=this[n]=new c(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Et(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),_=mt("div",h,c||this._mapPane);return n&&(this._panes[n]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new Xe(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,h){n=Ne(n),h=de(h||[0,0]);var _=this.getZoom()||0,T=this.getMinZoom(),z=this.getMaxZoom(),se=n.getNorthWest(),Ce=n.getSouthEast(),$e=this.getSize().subtract(h),He=Re(this.project(Ce,_),this.project(se,_)).getSize(),ot=je.any3d?this.options.zoomSnap:1,ut=$e.x/He.x,Ct=$e.y/He.y,Gn=c?Math.max(ut,Ct):Math.min(ut,Ct);return _=this.getScaleZoom(Gn,_),ot&&(_=Math.round(_/(ot/100))*(ot/100),_=c?Math.ceil(_/ot)*ot:Math.floor(_/ot)*ot),Math.max(T,Math.min(z,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var h=this._getTopLeftPoint(n,c);return new ke(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(n)/h.scale(c)},getScaleZoom:function(n,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var _=h.zoom(n*h.scale(c));return isNaN(_)?1/0:_},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(We(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(de(n),c)},layerPointToLatLng:function(n){var c=de(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(We(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(We(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Ne(n))},distance:function(n,c){return this.options.crs.distance(We(n),We(c))},containerPointToLayerPoint:function(n){return de(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return de(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(de(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(We(n)))},mouseEventToContainerPoint:function(n){return na(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=vo(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&je.any3d,ht(n,"leaflet-container"+(je.touch?" leaflet-touch":"")+(je.retina?" leaflet-retina":"")+(je.ielt9?" leaflet-oldie":"")+(je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=to(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qt(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(n.markerPane,"leaflet-zoom-hide"),ht(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,h){qt(this._mapPane,new U(0,0));var _=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,h)._move(n,c)._moveEnd(T),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,h,_){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),_?h&&h.pinch&&this.fire("zoom",h):((T||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){qt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?St:rt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),je.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var h=[],_,T=c==="mouseout"||c==="mouseover",z=n.target||n.srcElement,se=!1;z;){if(_=this._targets[d(z)],_&&(c==="click"||c==="preclick")&&this._draggableMoved(_)){se=!0;break}if(_&&_.listens(c,!0)&&(T&&!Ra(z,n)||(h.push(_),T))||z===this._container)break;z=z.parentNode}return!h.length&&!se&&!T&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var h=n.type;h==="mousedown"&&Xs(c),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,h){if(n.type==="click"){var _=s({},n);_.type="preclick",this._fireDOMEvent(_,_.type,h)}var T=this._findEventTargets(n,c);if(h){for(var z=[],se=0;se<h.length;se++)h[se].listens(c,!0)&&z.push(h[se]);T=z.concat(T)}if(T.length){c==="contextmenu"&&Jt(n);var Ce=T[0],$e={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var He=Ce.getLatLng&&(!Ce._radius||Ce._radius<=10);$e.containerPoint=He?this.latLngToContainerPoint(Ce.getLatLng()):this.mouseEventToContainerPoint(n),$e.layerPoint=this.containerPointToLayerPoint($e.containerPoint),$e.latlng=He?Ce.getLatLng():this.layerPointToLatLng($e.layerPoint)}for(se=0;se<T.length;se++)if(T[se].fire(c,$e,!0),$e.originalEvent._stopped||T[se].options.bubblingMouseEvents===!1&&B(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return zo(this._mapPane)||new U(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var h=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var h=this.getSize()._divideBy(2);return this.project(n,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,h){var _=this._getNewPixelOrigin(h,c);return this.project(n,c)._subtract(_)},_latLngBoundsToNewLayerBounds:function(n,c,h){var _=this._getNewPixelOrigin(h,c);return Re([this.project(n.getSouthWest(),c)._subtract(_),this.project(n.getNorthWest(),c)._subtract(_),this.project(n.getSouthEast(),c)._subtract(_),this.project(n.getNorthEast(),c)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,h){if(!h)return n;var _=this.project(n,c),T=this.getSize().divideBy(2),z=new ke(_.subtract(T),_.add(T)),se=this._getBoundsOffset(z,h,c);return Math.abs(se.x)<=1&&Math.abs(se.y)<=1?n:this.unproject(_.add(se),c)},_limitOffset:function(n,c){if(!c)return n;var h=this.getPixelBounds(),_=new ke(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(_,c))},_getBoundsOffset:function(n,c,h){var _=Re(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),T=_.min.subtract(n.min),z=_.max.subtract(n.max),se=this._rebound(T.x,-z.x),Ce=this._rebound(T.y,-z.y);return new U(se,Ce)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),h=this.getMaxZoom(),_=je.any3d?this.options.zoomSnap:1;return _&&(n=Math.round(n/_)*_),Math.max(c,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){zt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var h=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var n=this._proxy=mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var h=eo,_=this._proxy.style[h];$o(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),_===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();$o(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(c),T=this._getCenterOffset(n)._divideBy(1-1/_);return h.animate!==!0&&!this.getSize().contains(T)?!1:(P(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,h,_){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&zt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function di(n,c){return new _t(n,c)}var hn=ae.extend({options:{position:"topright"},initialize:function(n){C(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),h=this.getPosition(),_=n._controlCorners[h];return ht(c,"leaflet-control"),h.indexOf("bottom")!==-1?_.insertBefore(c,_.firstChild):_.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),is=function(n){return new hn(n)};_t.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",h=this._controlContainer=mt("div",c+"control-container",this._container);function _(T,z){var se=c+T+" "+c+z;n[T+z]=mt("div",se,h)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Et(this._controlCorners[n]);Et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var hi=hn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,h,_){return h<_?-1:_<h?1:0}},initialize:function(n,c,h){C(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in n)this._addLayer(n[_],_);for(_ in c)this._addLayer(c[_],_,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return hn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):zt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return zt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=mt("div",n),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Ao(c),Mo(c);var _=this._section=mt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),rt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=mt("a",n+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),rt(T,{keydown:function(z){z.keyCode===13&&this._expandSafely()},click:function(z){Jt(z),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=mt("div",n+"-base",_),this._separator=mt("div",n+"-separator",_),this._overlaysList=mt("div",n+"-overlays",_),c.appendChild(_)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(r(function(_,T){return this.options.sortFunction(_.layer,T.layer,_.name,T.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Io(this._baseLayersList),Io(this._overlaysList),this._layerControlInputs=[];var n,c,h,_,T=0;for(h=0;h<this._layers.length;h++)_=this._layers[h],this._addItem(_),c=c||_.overlay,n=n||!_.overlay,T+=_.overlay?0:1;return this.options.hideSingleBase&&(n=n&&T>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),h=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(n,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=h,_.firstChild},_addItem:function(n){var c=document.createElement("label"),h=this._map.hasLayer(n.layer),_;n.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=h):_=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(_),_.layerId=d(n.layer),rt(_,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+n.name;var z=document.createElement("span");c.appendChild(z),z.appendChild(_),z.appendChild(T);var se=n.overlay?this._overlaysList:this._baseLayersList;return se.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,h,_=[],T=[];this._handlingClick=!0;for(var z=n.length-1;z>=0;z--)c=n[z],h=this._getLayer(c.layerId).layer,c.checked?_.push(h):c.checked||T.push(h);for(z=0;z<T.length;z++)this._map.hasLayer(T[z])&&this._map.removeLayer(T[z]);for(z=0;z<_.length;z++)this._map.hasLayer(_[z])||this._map.addLayer(_[z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,h,_=this._map.getZoom(),T=n.length-1;T>=0;T--)c=n[T],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&_<h.options.minZoom||h.options.maxZoom!==void 0&&_>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,rt(n,"click",Jt),this.expand();var c=this;setTimeout(function(){St(n,"click",Jt),c._preventClick=!1})}}),el=function(n,c,h){return new hi(n,c,h)},Ba=hn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",h=mt("div",c+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,h,_,T){var z=mt("a",h,_);return z.innerHTML=n,z.href="#",z.title=c,z.setAttribute("role","button"),z.setAttribute("aria-label",c),Ao(z),rt(z,"click",Eo),rt(z,"click",T,this),rt(z,"click",this._refocusOnMap,this),z},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";zt(this._zoomInButton,c),zt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ht(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ht(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});_t.mergeOptions({zoomControl:!0}),_t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ba,this.addControl(this.zoomControl))});var oa=function(n){return new Ba(n)},Na=hn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",h=mt("div",c),_=this.options;return this._addScales(_,c+"-line",h),n.on(_.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,h){n.metric&&(this._mScale=mt("div",c,h)),n.imperial&&(this._iScale=mt("div",c,h))},_update:function(){var n=this._map,c=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/n)},_updateImperial:function(n){var c=n*3.2808399,h,_,T;c>5280?(h=c/5280,_=this._getRoundNum(h),this._updateScale(this._iScale,_+" mi",_/h)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(n,c,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),h=n/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),fi=function(n){return new Na(n)},tl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oe=hn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(je.inlineSvg?tl+" ":"")+"Leaflet</a>"},initialize:function(n){C(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=mt("div","leaflet-control-attribution"),Ao(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});_t.mergeOptions({attributionControl:!0}),_t.addInitHook(function(){this.options.attributionControl&&new Oe().addTo(this)});var Pe=function(n){return new Oe(n)};hn.Layers=hi,hn.Zoom=Ba,hn.Scale=Na,hn.Attribution=Oe,is.layers=el,is.zoom=oa,is.scale=fi,is.attribution=Pe;var tt=ae.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});tt.addTo=function(n,c){return n.addHandler(c,this),this};var ft={Events:ne},wt=je.touch?"touchstart mousedown":"mousedown",Ht=oe.extend({options:{clickTolerance:3},initialize:function(n,c,h,_){C(this,_),this._element=n,this._dragStartTarget=c||n,this._preventOutline=h},enable:function(){this._enabled||(rt(this._dragStartTarget,wt,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ht._dragging===this&&this.finishDrag(!0),St(this._dragStartTarget,wt,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Js(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Ht._dragging===this&&this.finishDrag();return}if(!(Ht._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Ht._dragging=this,this._preventOutline&&Xs(this._element),no(),Ho(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,h=ci(this._element);this._startPoint=new U(c.clientX,c.clientY),this._startPos=zo(this._element),this._parentScale=An(h);var _=n.type==="mousedown";rt(document,_?"mousemove":"touchmove",this._onMove,this),rt(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,h=new U(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Jt(n),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),qt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){zt(document.body,"leaflet-dragging"),this._lastTarget&&(zt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),St(document,"mousemove touchmove",this._onMove,this),St(document,"mouseup touchend touchcancel",this._onUp,this),Zt(),Ls();var c=this._moved&&this._moving;this._moving=!1,Ht._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Cn(n,c,h){var _,T=[1,4,2,8],z,se,Ce,$e,He,ot,ut,Ct;for(z=0,ot=n.length;z<ot;z++)n[z]._code=rs(n[z],c);for(Ce=0;Ce<4;Ce++){for(ut=T[Ce],_=[],z=0,ot=n.length,se=ot-1;z<ot;se=z++)$e=n[z],He=n[se],$e._code&ut?He._code&ut||(Ct=mi(He,$e,ut,c,h),Ct._code=rs(Ct,c),_.push(Ct)):(He._code&ut&&(Ct=mi(He,$e,ut,c,h),Ct._code=rs(Ct,c),_.push(Ct)),_.push($e));n=_}return n}function Vn(n,c){var h,_,T,z,se,Ce,$e,He,ot;if(!n||n.length===0)throw new Error("latlngs not passed");ao(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ut=We([0,0]),Ct=Ne(n),Gn=Ct.getNorthWest().distanceTo(Ct.getSouthWest())*Ct.getNorthEast().distanceTo(Ct.getNorthWest());Gn<1700&&(ut=Vt(n));var mn=n.length,Po=[];for(h=0;h<mn;h++){var io=We(n[h]);Po.push(c.project(We([io.lat-ut.lat,io.lng-ut.lng])))}for(Ce=$e=He=0,h=0,_=mn-1;h<mn;_=h++)T=Po[h],z=Po[_],se=T.y*z.x-z.y*T.x,$e+=(T.x+z.x)*se,He+=(T.y+z.y)*se,Ce+=se*3;Ce===0?ot=Po[0]:ot=[$e/Ce,He/Ce];var Ii=c.unproject(de(ot));return We([Ii.lat+ut.lat,Ii.lng+ut.lng])}function Vt(n){for(var c=0,h=0,_=0,T=0;T<n.length;T++){var z=We(n[T]);c+=z.lat,h+=z.lng,_++}return We([c/_,h/_])}var Ln={__proto__:null,clipPolygon:Cn,polygonCenter:Vn,centroid:Vt};function Tt(n,c){if(!c||!n.length)return n.slice();var h=c*c;return n=pi(n,h),n=ls(n,h),n}function Xt(n,c,h){return Math.sqrt(sa(n,c,h,!0))}function so(n,c,h){return sa(n,c,h)}function ls(n,c){var h=n.length,_=typeof Uint8Array<"u"?Uint8Array:Array,T=new _(h);T[0]=T[h-1]=1,Sn(n,T,c,0,h-1);var z,se=[];for(z=0;z<h;z++)T[z]&&se.push(n[z]);return se}function Sn(n,c,h,_,T){var z=0,se,Ce,$e;for(Ce=_+1;Ce<=T-1;Ce++)$e=sa(n[Ce],n[_],n[T],!0),$e>z&&(se=Ce,z=$e);z>h&&(c[se]=1,Sn(n,c,h,_,se),Sn(n,c,h,se,T))}function pi(n,c){for(var h=[n[0]],_=1,T=0,z=n.length;_<z;_++)bc(n[_],n[T])>c&&(h.push(n[_]),T=_);return T<z-1&&h.push(n[z-1]),h}var vi;function nl(n,c,h,_,T){var z=_?vi:rs(n,h),se=rs(c,h),Ce,$e,He;for(vi=se;;){if(!(z|se))return[n,c];if(z&se)return!1;Ce=z||se,$e=mi(n,c,Ce,h,T),He=rs($e,h),Ce===z?(n=$e,z=He):(c=$e,se=He)}}function mi(n,c,h,_,T){var z=c.x-n.x,se=c.y-n.y,Ce=_.min,$e=_.max,He,ot;return h&8?(He=n.x+z*($e.y-n.y)/se,ot=$e.y):h&4?(He=n.x+z*(Ce.y-n.y)/se,ot=Ce.y):h&2?(He=$e.x,ot=n.y+se*($e.x-n.x)/z):h&1&&(He=Ce.x,ot=n.y+se*(Ce.x-n.x)/z),new U(He,ot,T)}function rs(n,c){var h=0;return n.x<c.min.x?h|=1:n.x>c.max.x&&(h|=2),n.y<c.min.y?h|=4:n.y>c.max.y&&(h|=8),h}function bc(n,c){var h=c.x-n.x,_=c.y-n.y;return h*h+_*_}function sa(n,c,h,_){var T=c.x,z=c.y,se=h.x-T,Ce=h.y-z,$e=se*se+Ce*Ce,He;return $e>0&&(He=((n.x-T)*se+(n.y-z)*Ce)/$e,He>1?(T=h.x,z=h.y):He>0&&(T+=se*He,z+=Ce*He)),se=n.x-T,Ce=n.y-z,_?se*se+Ce*Ce:new U(T,z)}function ao(n){return!S(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Xl(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ao(n)}function Ql(n,c){var h,_,T,z,se,Ce,$e,He;if(!n||n.length===0)throw new Error("latlngs not passed");ao(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ot=We([0,0]),ut=Ne(n),Ct=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());Ct<1700&&(ot=Vt(n));var Gn=n.length,mn=[];for(h=0;h<Gn;h++){var Po=We(n[h]);mn.push(c.project(We([Po.lat-ot.lat,Po.lng-ot.lng])))}for(h=0,_=0;h<Gn-1;h++)_+=mn[h].distanceTo(mn[h+1])/2;if(_===0)He=mn[0];else for(h=0,z=0;h<Gn-1;h++)if(se=mn[h],Ce=mn[h+1],T=se.distanceTo(Ce),z+=T,z>_){$e=(z-_)/T,He=[Ce.x-$e*(Ce.x-se.x),Ce.y-$e*(Ce.y-se.y)];break}var io=c.unproject(de(He));return We([io.lat+ot.lat,io.lng+ot.lng])}var wc={__proto__:null,simplify:Tt,pointToSegmentDistance:Xt,closestPointOnSegment:so,clipSegment:nl,_getEdgeIntersection:mi,_getBitCode:rs,_sqClosestPointOnSegment:sa,isFlat:ao,_flat:Xl,polylineCenter:Ql},ol={project:function(n){return new U(n.lng,n.lat)},unproject:function(n){return new ze(n.y,n.x)},bounds:new ke([-180,-90],[180,90])},sl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ke([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,h=this.R,_=n.lat*c,T=this.R_MINOR/h,z=Math.sqrt(1-T*T),se=z*Math.sin(_),Ce=Math.tan(Math.PI/4-_/2)/Math.pow((1-se)/(1+se),z/2);return _=-h*Math.log(Math.max(Ce,1e-10)),new U(n.lng*c*h,_)},unproject:function(n){for(var c=180/Math.PI,h=this.R,_=this.R_MINOR/h,T=Math.sqrt(1-_*_),z=Math.exp(-n.y/h),se=Math.PI/2-2*Math.atan(z),Ce=0,$e=.1,He;Ce<15&&Math.abs($e)>1e-7;Ce++)He=T*Math.sin(se),He=Math.pow((1-He)/(1+He),T/2),$e=Math.PI/2-2*Math.atan(z*He)-se,se+=$e;return new ze(se*c,n.x*c/h)}},Cc={__proto__:null,LonLat:ol,Mercator:sl,SphericalMercator:ge},Lc=s({},ye,{code:"EPSG:3395",projection:sl,transformation:(function(){var n=.5/(Math.PI*sl.R);return G(n,.5,-n,.5)})()}),er=s({},ye,{code:"EPSG:4326",projection:ol,transformation:G(1/180,1,-1/180,.5)}),Sc=s({},ee,{projection:ol,transformation:G(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var h=c.lng-n.lng,_=c.lat-n.lat;return Math.sqrt(h*h+_*_)},infinite:!0});ee.Earth=ye,ee.EPSG3395=Lc,ee.EPSG3857=J,ee.EPSG900913=ce,ee.EPSG4326=er,ee.Simple=Sc;var yo=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});_t.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},_addLayers:function(n){n=n?S(n)?n:[n]:[];for(var c=0,h=n.length;c<h;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,h=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var T=this._zoomBoundLayers[_].options;n=T.minZoom===void 0?n:Math.min(n,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var aa=yo.extend({initialize:function(n,c){C(this,c),this._layers={};var h,_;if(n)for(h=0,_=n.length;h<_;h++)this.addLayer(n[h])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),h,_;for(h in this._layers)_=this._layers[h],_[n]&&_[n].apply(_,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),gi=function(n,c){return new aa(n,c)},Go=aa.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),aa.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),aa.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Xe;for(var c in this._layers){var h=this._layers[c];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),yi=function(n,c){return new Go(n,c)},ia=ae.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){C(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(_,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(n,c){var h=this.options,_=h[c+"Size"];typeof _=="number"&&(_=[_,_]);var T=de(_),z=de(c==="shadow"&&h.shadowAnchor||h.iconAnchor||T&&T.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(h.className||""),z&&(n.style.marginLeft=-z.x+"px",n.style.marginTop=-z.y+"px"),T&&(n.style.width=T.x+"px",n.style.height=T.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return je.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function tr(n){return new ia(n)}var Ss=ia.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ss.imagePath!="string"&&(Ss.imagePath=this._detectIconPath()),(this.options.imagePath||Ss.imagePath)+ia.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(h,_,T){var z=_.exec(h);return z&&z[T]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=mt("div","leaflet-default-icon-path",document.body),c=to(n,"background-image")||to(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),ki=tt.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Ht(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&zt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,h=c._map,_=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,z=zo(c._icon),se=h.getPixelBounds(),Ce=h.getPixelOrigin(),$e=Re(se.min._subtract(Ce).add(T),se.max._subtract(Ce).subtract(T));if(!$e.contains(z)){var He=de((Math.max($e.max.x,z.x)-$e.max.x)/(se.max.x-$e.max.x)-(Math.min($e.min.x,z.x)-$e.min.x)/(se.min.x-$e.min.x),(Math.max($e.max.y,z.y)-$e.max.y)/(se.max.y-$e.max.y)-(Math.min($e.min.y,z.y)-$e.min.y)/(se.min.y-$e.min.y)).multiplyBy(_);h.panBy(He,{animate:!1}),this._draggable._newPos._add(He),this._draggable._startPos._add(He),qt(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=P(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,h=c._shadow,_=zo(c._icon),T=c._map.layerPointToLatLng(_);h&&qt(h,_),c._latlng=T,n.latlng=T,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),_i=yo.extend({options:{icon:new Ss,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){C(this,c),this._latlng=We(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=We(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),_=!1;h!==this._icon&&(this._icon&&this._removeIcon(),_=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ht(h,c),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(h,"focus",this._panOnFocus,this);var T=n.icon.createShadow(this._shadow),z=!1;T!==this._shadow&&(this._removeShadow(),z=!0),T&&(ht(T,c),T.alt=""),this._shadow=T,n.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&z&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&St(this._icon,"focus",this._panOnFocus,this),Et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Et(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&qt(this._icon,n),this._shadow&&qt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ki)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ki(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Mn(this._icon,n),this._shadow&&Mn(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,h=c.iconSize?de(c.iconSize):de(0,0),_=c.iconAnchor?de(c.iconAnchor):de(0,0);n.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:h.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function xc(n,c){return new _i(n,c)}var cs=yo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return C(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),bi=cs.extend({options:{fill:!0,radius:10},initialize:function(n,c){C(this,c),this._latlng=We(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=We(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return cs.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,h=this._clickTolerance(),_=[n+h,c+h];this._pxBounds=new ke(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ic(n,c){return new bi(n,c)}var al=bi.extend({initialize:function(n,c,h){if(typeof c=="number"&&(c=s({},h,{radius:c})),C(this,c),this._latlng=We(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Xe(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:cs.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,h=this._map,_=h.options.crs;if(_.distance===ye.distance){var T=Math.PI/180,z=this._mRadius/ye.R/T,se=h.project([c+z,n]),Ce=h.project([c-z,n]),$e=se.add(Ce).divideBy(2),He=h.unproject($e).lat,ot=Math.acos((Math.cos(z*T)-Math.sin(c*T)*Math.sin(He*T))/(Math.cos(c*T)*Math.cos(He*T)))/T;(isNaN(ot)||ot===0)&&(ot=z/Math.cos(Math.PI/180*c)),this._point=$e.subtract(h.getPixelOrigin()),this._radius=isNaN(ot)?0:$e.x-h.project([He,n-ot]).x,this._radiusY=$e.y-se.y}else{var ut=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ut).x}this._updateBounds()}});function $c(n,c,h){return new al(n,c,h)}var jo=cs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){C(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,h=null,_=sa,T,z,se=0,Ce=this._parts.length;se<Ce;se++)for(var $e=this._parts[se],He=1,ot=$e.length;He<ot;He++){T=$e[He-1],z=$e[He];var ut=_(n,T,z,!0);ut<c&&(c=ut,h=_(n,T,z))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ql(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=We(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Xe,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return ao(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],h=ao(n),_=0,T=n.length;_<T;_++)h?(c[_]=We(n[_]),this._bounds.extend(c[_])):c[_]=this._convertLatLngs(n[_]);return c},_project:function(){var n=new ke;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new U(n,n);this._rawPxBounds&&(this._pxBounds=new ke([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,h){var _=n[0]instanceof ze,T=n.length,z,se;if(_){for(se=[],z=0;z<T;z++)se[z]=this._map.latLngToLayerPoint(n[z]),h.extend(se[z]);c.push(se)}else for(z=0;z<T;z++)this._projectLatlngs(n[z],c,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,_,T,z,se,Ce,$e;for(h=0,T=0,z=this._rings.length;h<z;h++)for($e=this._rings[h],_=0,se=$e.length;_<se-1;_++)Ce=nl($e[_],$e[_+1],n,_,!0),Ce&&(c[T]=c[T]||[],c[T].push(Ce[0]),(Ce[1]!==$e[_+1]||_===se-2)&&(c[T].push(Ce[1]),T++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,h=0,_=n.length;h<_;h++)n[h]=Tt(n[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var h,_,T,z,se,Ce,$e=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,z=this._parts.length;h<z;h++)for(Ce=this._parts[h],_=0,se=Ce.length,T=se-1;_<se;T=_++)if(!(!c&&_===0)&&Xt(n,Ce[T],Ce[_])<=$e)return!0;return!1}});function Tc(n,c){return new jo(n,c)}jo._flat=Xl;var la=jo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=jo.prototype._convertLatLngs.call(this,n),h=c.length;return h>=2&&c[0]instanceof ze&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(n){jo.prototype._setLatLngs.call(this,n),ao(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ao(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,h=new U(c,c);if(n=new ke(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,T=this._rings.length,z;_<T;_++)z=Cn(this._rings[_],n,!0),z.length&&this._parts.push(z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,h,_,T,z,se,Ce,$e,He;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(z=0,$e=this._parts.length;z<$e;z++)for(h=this._parts[z],se=0,He=h.length,Ce=He-1;se<He;Ce=se++)_=h[se],T=h[Ce],_.y>n.y!=T.y>n.y&&n.x<(T.x-_.x)*(n.y-_.y)/(T.y-_.y)+_.x&&(c=!c);return c||jo.prototype._containsPoint.call(this,n,!0)}});function nr(n,c){return new la(n,c)}var Zo=Go.extend({initialize:function(n,c){C(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=S(n)?n:n.features,h,_,T;if(c){for(h=0,_=c.length;h<_;h++)T=c[h],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var z=this.options;if(z.filter&&!z.filter(n))return this;var se=Fa(n,z);return se?(se.feature=Li(n),se.defaultOptions=se.options,this.resetStyle(se),z.onEachFeature&&z.onEachFeature(n,se),this.addLayer(se)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function Fa(n,c){var h=n.type==="Feature"?n.geometry:n,_=h?h.coordinates:null,T=[],z=c&&c.pointToLayer,se=c&&c.coordsToLatLng||il,Ce,$e,He,ot;if(!_&&!h)return null;switch(h.type){case"Point":return Ce=se(_),or(z,n,Ce,c);case"MultiPoint":for(He=0,ot=_.length;He<ot;He++)Ce=se(_[He]),T.push(or(z,n,Ce,c));return new Go(T);case"LineString":case"MultiLineString":return $e=wi(_,h.type==="LineString"?0:1,se),new jo($e,c);case"Polygon":case"MultiPolygon":return $e=wi(_,h.type==="Polygon"?1:2,se),new la($e,c);case"GeometryCollection":for(He=0,ot=h.geometries.length;He<ot;He++){var ut=Fa({geometry:h.geometries[He],type:"Feature",properties:n.properties},c);ut&&T.push(ut)}return new Go(T);case"FeatureCollection":for(He=0,ot=h.features.length;He<ot;He++){var Ct=Fa(h.features[He],c);Ct&&T.push(Ct)}return new Go(T);default:throw new Error("Invalid GeoJSON object.")}}function or(n,c,h,_){return n?n(c,h):new _i(h,_&&_.markersInheritOptions&&_)}function il(n){return new ze(n[1],n[0],n[2])}function wi(n,c,h){for(var _=[],T=0,z=n.length,se;T<z;T++)se=c?wi(n[T],c-1,h):(h||il)(n[T]),_.push(se);return _}function Ua(n,c){return n=We(n),n.alt!==void 0?[y(n.lng,c),y(n.lat,c),y(n.alt,c)]:[y(n.lng,c),y(n.lat,c)]}function Ci(n,c,h,_){for(var T=[],z=0,se=n.length;z<se;z++)T.push(c?Ci(n[z],ao(n[z])?0:c-1,h,_):Ua(n[z],_));return!c&&h&&T.length>0&&T.push(T[0].slice()),T}function ra(n,c){return n.feature?s({},n.feature,{geometry:c}):Li(c)}function Li(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Si={toGeoJSON:function(n){return ra(this,{type:"Point",coordinates:Ua(this.getLatLng(),n)})}};_i.include(Si),al.include(Si),bi.include(Si),jo.include({toGeoJSON:function(n){var c=!ao(this._latlngs),h=Ci(this._latlngs,c?1:0,!1,n);return ra(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),la.include({toGeoJSON:function(n){var c=!ao(this._latlngs),h=c&&!ao(this._latlngs[0]),_=Ci(this._latlngs,h?2:c?1:0,!0,n);return c||(_=[_]),ra(this,{type:(h?"Multi":"")+"Polygon",coordinates:_})}}),aa.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(n).geometry.coordinates)}),ra(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var h=c==="GeometryCollection",_=[];return this.eachLayer(function(T){if(T.toGeoJSON){var z=T.toGeoJSON(n);if(h)_.push(z.geometry);else{var se=Li(z);se.type==="FeatureCollection"?_.push.apply(_,se.features):_.push(se)}}}),h?ra(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function sr(n,c){return new Zo(n,c)}var za=sr,Ha=yo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,h){this._url=n,this._bounds=Ne(c),C(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Uo(this._image),this},bringToBack:function(){return this._map&&mo(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Ne(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:mt("img");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=r(this.fire,this,"load"),c.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;$o(this._image,h,c)},_reset:function(){var n=this._image,c=new ke(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();qt(n,c.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){Mn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),ar=function(n,c,h){return new Ha(n,c,h)},ll=Ha.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:mt("video");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=r(this.fire,this,"load"),n){for(var h=c.getElementsByTagName("source"),_=[],T=0;T<h.length;T++)_.push(h[T].src);this._url=h.length>0?_:[c.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var z=0;z<this._url.length;z++){var se=mt("source");se.src=this._url[z],c.appendChild(se)}}});function H(n,c,h){return new ll(n,c,h)}var ie=Ha.extend({_initImage:function(){var n=this._image=this._url;ht(n,"leaflet-image-layer"),this._zoomAnimated&&ht(n,"leaflet-zoom-animated"),this.options.className&&ht(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function be(n,c,h){return new ie(n,c,h)}var we=yo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof ze||S(n))?(this._latlng=We(n),C(this,c)):(C(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Mn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Mn(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Mn(this._container,0),this._removeTimeout=setTimeout(r(Et,void 0,this._container),200)):Et(this._container),this.options.interactive&&(zt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=We(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Uo(this._container),this},bringToBack:function(){return this._map&&mo(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof Go){c=null;var h=this._source._layers;for(var _ in h)if(h[_]._map){c=h[_];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=de(this.options.offset),h=this._getAnchor();this._zoomAnimated?qt(this._container,n.add(h)):c=c.add(n).add(h);var _=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=_+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});_t.include({_initOverlay:function(n,c,h,_){var T=c;return T instanceof n||(T=new n(_).setContent(c)),h&&T.setLatLng(h),T}}),yo.include({_initOverlay:function(n,c,h,_){var T=h;return T instanceof n?(C(T,_),T._source=this):(T=c&&!_?c:new n(_,this),T.setContent(h)),T}});var nt=we.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,we.prototype.openOn.call(this,n)},onAdd:function(n){we.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof cs||this._source.on("preclick",oo))},onRemove:function(n){we.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof cs||this._source.off("preclick",oo))},getEvents:function(){var n=we.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=mt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=mt("div",n+"-content-wrapper",c);if(this._contentNode=mt("div",n+"-content",h),Ao(c),Mo(this._contentNode),rt(c,"contextmenu",oo),this._tipContainer=mt("div",n+"-tip-container",c),this._tip=mt("div",n+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=mt("a",n+"-close-button",c);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',rt(_,"click",function(T){Jt(T),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var _=n.offsetHeight,T=this.options.maxHeight,z="leaflet-popup-scrolled";T&&_>T?(c.height=T+"px",ht(n,z)):zt(n,z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();qt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(to(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,_=this._containerWidth,T=new U(this._containerLeft,-h-this._containerBottom);T._add(zo(this._container));var z=n.layerPointToContainerPoint(T),se=de(this.options.autoPanPadding),Ce=de(this.options.autoPanPaddingTopLeft||se),$e=de(this.options.autoPanPaddingBottomRight||se),He=n.getSize(),ot=0,ut=0;z.x+_+$e.x>He.x&&(ot=z.x+_-He.x+$e.x),z.x-ot-Ce.x<0&&(ot=z.x-Ce.x),z.y+h+$e.y>He.y&&(ut=z.y+h-He.y+$e.y),z.y-ut-Ce.y<0&&(ut=z.y-Ce.y),(ot||ut)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([ot,ut]))}},_getAnchor:function(){return de(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),It=function(n,c){return new nt(n,c)};_t.mergeOptions({closePopupOnClick:!0}),_t.include({openPopup:function(n,c,h){return this._initOverlay(nt,n,c,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),yo.include({bindPopup:function(n,c){return this._popup=this._initOverlay(nt,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Go||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Eo(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof cs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var At=we.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){we.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){we.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=we.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,h,_=this._map,T=this._container,z=_.latLngToContainerPoint(_.getCenter()),se=_.layerPointToContainerPoint(n),Ce=this.options.direction,$e=T.offsetWidth,He=T.offsetHeight,ot=de(this.options.offset),ut=this._getAnchor();Ce==="top"?(c=$e/2,h=He):Ce==="bottom"?(c=$e/2,h=0):Ce==="center"?(c=$e/2,h=He/2):Ce==="right"?(c=0,h=He/2):Ce==="left"?(c=$e,h=He/2):se.x<z.x?(Ce="right",c=0,h=He/2):(Ce="left",c=$e+(ot.x+ut.x)*2,h=He/2),n=n.subtract(de(c,h,!0)).add(ot).add(ut),zt(T,"leaflet-tooltip-right"),zt(T,"leaflet-tooltip-left"),zt(T,"leaflet-tooltip-top"),zt(T,"leaflet-tooltip-bottom"),ht(T,"leaflet-tooltip-"+Ce),qt(T,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Mn(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return de(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),vn=function(n,c){return new At(n,c)};_t.include({openTooltip:function(n,c,h){return this._initOverlay(At,n,c,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),yo.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(At,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Go||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(rt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),rt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,h,_;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),_=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(c)}});var ca=ia.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Io(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var _=de(h.bgPos);c.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function xi(n){return new ca(n)}ia.Default=Ss;var xs=yo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){C(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Et(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Uo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(mo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof U?n:new U(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,h=-n(-1/0,1/0),_=0,T=c.length,z;_<T;_++)z=c[_].style.zIndex,c[_]!==this._container&&z&&(h=n(h,+z));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!je.ielt9){Mn(this._container,this.options.opacity);var n=+new Date,c=!1,h=!1;for(var _ in this._tiles){var T=this._tiles[_];if(!(!T.current||!T.loaded)){var z=Math.min(1,(n-T.loaded)/200);Mn(T.el,z),z<1?c=!0:(T.active?h=!0:this._onOpaqueTile(T),T.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(j(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=c-Math.abs(n-h),this._onUpdateLevel(h)):(Et(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var _=this._levels[n],T=this._map;return _||(_=this._levels[n]={},_.el=mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=c,_.origin=T.project(T.unproject(T.getPixelOrigin()),n).round(),_.zoom=n,this._setZoomTransform(_,T.getCenter(),T.getZoom()),g(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var _=c.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Et(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,h,_){var T=Math.floor(n/2),z=Math.floor(c/2),se=h-1,Ce=new U(+T,+z);Ce.z=+se;var $e=this._tileCoordsToKey(Ce),He=this._tiles[$e];return He&&He.active?(He.retain=!0,!0):(He&&He.loaded&&(He.retain=!0),se>_?this._retainParent(T,z,se,_):!1)},_retainChildren:function(n,c,h,_){for(var T=2*n;T<2*n+2;T++)for(var z=2*c;z<2*c+2;z++){var se=new U(T,z);se.z=h+1;var Ce=this._tileCoordsToKey(se),$e=this._tiles[Ce];if($e&&$e.active){$e.retain=!0;continue}else $e&&$e.loaded&&($e.retain=!0);h+1<_&&this._retainChildren(T,z,h+1,_)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,h,_){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var z=this.options.updateWhenZooming&&T!==this._tileZoom;(!_||z)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,c)},_setZoomTransform:function(n,c,h){var _=this._map.getZoomScale(h,n.zoom),T=n.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(c,h)).round();je.any3d?$o(n.el,T,_):qt(n.el,T)},_resetGrid:function(){var n=this._map,c=n.options.crs,h=this._tileSize=this.getTileSize(),_=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],_).x/h.x),Math.ceil(n.project([0,c.wrapLng[1]],_).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],_).y/h.x),Math.ceil(n.project([c.wrapLat[1],0],_).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),_=c.getZoomScale(h,this._tileZoom),T=c.project(n,this._tileZoom).floor(),z=c.getSize().divideBy(_*2);return new ke(T.subtract(z),T.add(z))},_update:function(n){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(n),T=this._pxBoundsToTileRange(_),z=T.getCenter(),se=[],Ce=this.options.keepBuffer,$e=new ke(T.getBottomLeft().subtract([Ce,-Ce]),T.getTopRight().add([Ce,-Ce]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var He in this._tiles){var ot=this._tiles[He].coords;(ot.z!==this._tileZoom||!$e.contains(new U(ot.x,ot.y)))&&(this._tiles[He].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ut=T.min.y;ut<=T.max.y;ut++)for(var Ct=T.min.x;Ct<=T.max.x;Ct++){var Gn=new U(Ct,ut);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var mn=this._tiles[this._tileCoordsToKey(Gn)];mn?mn.current=!0:se.push(Gn)}}if(se.sort(function(io,Ii){return io.distanceTo(z)-Ii.distanceTo(z)}),se.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Po=document.createDocumentFragment();for(Ct=0;Ct<se.length;Ct++)this._addTile(se[Ct],Po);this._level.el.appendChild(Po)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!c.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(n);return Ne(this.options.bounds).overlaps(_)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,h=this.getTileSize(),_=n.scaleBy(h),T=_.add(h),z=c.unproject(_,n.z),se=c.unproject(T,n.z);return[z,se]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),h=new Xe(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),h=new U(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(n){var c=this._tiles[n];c&&(Et(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ht(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=g,n.onmousemove=g,je.ielt9&&this.options.opacity<1&&Mn(n,this.options.opacity)},_addTile:function(n,c){var h=this._getTilePos(n),_=this._tileCoordsToKey(n),T=this.createTile(this._wrapCoords(n),r(this._tileReady,this,n));this._initTile(T),this.createTile.length<2&&P(r(this._tileReady,this,n,null,T)),qt(T,h),this._tiles[_]={el:T,coords:n,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:n})},_tileReady:function(n,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:n});var _=this._tileCoordsToKey(n);h=this._tiles[_],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Mn(h.el,0),j(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(ht(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),je.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new U(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new ke(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function ua(n){return new xs(n)}var xn=xs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=C(this,c),c.detectRetina&&je.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var h=document.createElement("img");return rt(h,"load",r(this._tileOnLoad,this,c,h)),rt(h,"error",r(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var c={r:je.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=h),c["-y"]=h}return I(this._url,s(c,this.options))},_tileOnLoad:function(n,c){je.ielt9?setTimeout(r(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,h){var _=this.options.errorTileUrl;_&&c.getAttribute("src")!==_&&(c.src=_),n(h,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,_=this.options.zoomOffset;return h&&(n=c-n),n+_},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=g,c.onerror=g,!c.complete)){c.src=R;var h=this._tiles[n].coords;Et(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",R),xs.prototype._removeTile.call(this,n)},_tileReady:function(n,c,h){if(!(!this._map||h&&h.getAttribute("src")===R))return xs.prototype._tileReady.call(this,n,c,h)}});function hd(n,c){return new xn(n,c)}var fd=xn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var h=s({},this.defaultWmsParams);for(var _ in c)_ in this.options||(h[_]=c[_]);c=C(this,c);var T=c.detectRetina&&je.retina?2:1,z=this.getTileSize();h.width=z.x*T,h.height=z.y*T,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,xn.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),h=this._crs,_=Re(h.project(c[0]),h.project(c[1])),T=_.min,z=_.max,se=(this._wmsVersion>=1.3&&this._crs===er?[T.y,T.x,z.y,z.x]:[T.x,T.y,z.x,z.y]).join(","),Ce=xn.prototype.getTileUrl.call(this,n);return Ce+x(this.wmsParams,Ce,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+se},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function am(n,c){return new fd(n,c)}xn.WMS=fd,hd.wms=am;var Is=yo.extend({options:{padding:.1},initialize:function(n){C(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var h=this._map.getZoomScale(c,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),z=_.multiplyBy(-h).add(T).subtract(this._map._getNewPixelOrigin(n,c));je.any3d?$o(this._container,z,h):qt(this._container,z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new ke(h,h.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),pd=Is.extend({options:{tolerance:0},getEvents:function(){var n=Is.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Is.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");rt(n,"mousemove",this._onMouseMove,this),rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Et(this._container),St(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Is.prototype._update.call(this);var n=this._bounds,c=this._container,h=n.getSize(),_=je.retina?2:1;qt(c,n.min),c.width=_*h.x,c.height=_*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",je.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Is.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,h=c.next,_=c.prev;h?h.prev=_:this._drawLast=_,_?_.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),h=[],_,T;for(T=0;T<c.length;T++){if(_=Number(c[T]),isNaN(_))return;h.push(_)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ke,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)n=_.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var h,_,T,z,se=n._parts,Ce=se.length,$e=this._ctx;if(Ce){for($e.beginPath(),h=0;h<Ce;h++){for(_=0,T=se[h].length;_<T;_++)z=se[h][_],$e[_?"lineTo":"moveTo"](z.x,z.y);c&&$e.closePath()}this._fillStroke($e,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,h=this._ctx,_=Math.max(Math.round(n._radius),1),T=(Math.max(Math.round(n._radiusY),1)||_)/_;T!==1&&(h.save(),h.scale(1,T)),h.beginPath(),h.arc(c.x,c.y/T,_,0,Math.PI*2,!1),T!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,c){var h=c.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),h,_,T=this._drawFirst;T;T=T.next)h=T.layer,h.options.interactive&&h._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(_=h);this._fireEvent(_?[_]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(zt(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var h,_,T=this._drawFirst;T;T=T.next)h=T.layer,h.options.interactive&&h._containsPoint(c)&&(_=h);_!==this._hoveredLayer&&(this._handleMouseOut(n),_&&(ht(this._container,"leaflet-interactive"),this._fireEvent([_],n,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,h){this._map._fireDOMEvent(c,h||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var h=c.next,_=c.prev;if(h)h.prev=_;else return;_?_.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var h=c.next,_=c.prev;if(_)_.next=h;else return;h?h.prev=_:_&&(this._drawLast=_),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function vd(n){return je.canvas?new pd(n):null}var rl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),im={_initContainer:function(){this._container=mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Is.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=rl("shape");ht(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=rl("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;Et(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,h=n._fill,_=n.options,T=n._container;T.stroked=!!_.stroke,T.filled=!!_.fill,_.stroke?(c||(c=n._stroke=rl("stroke")),T.appendChild(c),c.weight=_.weight+"px",c.color=_.color,c.opacity=_.opacity,_.dashArray?c.dashStyle=S(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=_.lineCap.replace("butt","flat"),c.joinstyle=_.lineJoin):c&&(T.removeChild(c),n._stroke=null),_.fill?(h||(h=n._fill=rl("fill")),T.appendChild(h),h.color=_.fillColor||_.color,h.opacity=_.fillOpacity):h&&(T.removeChild(h),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),h=Math.round(n._radius),_=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+_+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){Uo(n._container)},_bringToBack:function(n){mo(n._container)}},ir=je.vml?rl:Me,cl=Is.extend({_initContainer:function(){this._container=ir("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ir("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Et(this._container),St(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Is.prototype._update.call(this);var n=this._bounds,c=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),qt(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=ir("path");n.options.className&&ht(c,n.options.className),n.options.interactive&&ht(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Et(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,h=n.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,Be(n._parts,c))},_updateCircle:function(n){var c=n._point,h=Math.max(Math.round(n._radius),1),_=Math.max(Math.round(n._radiusY),1)||h,T="a"+h+","+_+" 0 1,0 ",z=n._empty()?"M0 0":"M"+(c.x-h)+","+c.y+T+h*2+",0 "+T+-h*2+",0 ";this._setPath(n,z)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){Uo(n._path)},_bringToBack:function(n){mo(n._path)}});je.vml&&cl.include(im);function md(n){return je.svg||je.vml?new cl(n):null}_t.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&vd(n)||md(n)}});var gd=la.extend({initialize:function(n,c){la.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Ne(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function lm(n,c){return new gd(n,c)}cl.create=ir,cl.pointsToPath=Be,Zo.geometryToLayer=Fa,Zo.coordsToLatLng=il,Zo.coordsToLatLngs=wi,Zo.latLngToCoords=Ua,Zo.latLngsToCoords=Ci,Zo.getFeature=ra,Zo.asFeature=Li,_t.mergeOptions({boxZoom:!0});var yd=tt.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){St(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ho(),no(),this._startPoint=this._map.mouseEventToContainerPoint(n),rt(document,{contextmenu:Eo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=mt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new ke(this._point,this._startPoint),h=c.getSize();qt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(Et(this._box),zt(this._container,"leaflet-crosshair")),Ls(),Zt(),St(document,{contextmenu:Eo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var c=new Xe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});_t.addInitHook("addHandler","boxZoom",yd),_t.mergeOptions({doubleClickZoom:!0});var kd=tt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,h=c.getZoom(),_=c.options.zoomDelta,T=n.originalEvent.shiftKey?h-_:h+_;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(n.containerPoint,T)}});_t.addInitHook("addHandler","doubleClickZoom",kd),_t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _d=tt.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Ht(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){zt(this._map._container,"leaflet-grab"),zt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Ne(this._map.options.maxBounds);this._offsetLimit=Re(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),h=this._initialWorldOffset,_=this._draggable._newPos.x,T=(_-c+h)%n+c-h,z=(_+c+h)%n-c-h,se=Math.abs(T+h)<Math.abs(z+h)?T:z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=se},_onDragEnd:function(n){var c=this._map,h=c.options,_=!h.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),_)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),z=(this._lastTime-this._times[0])/1e3,se=h.easeLinearity,Ce=T.multiplyBy(se/z),$e=Ce.distanceTo([0,0]),He=Math.min(h.inertiaMaxSpeed,$e),ot=Ce.multiplyBy(He/$e),ut=He/(h.inertiaDeceleration*se),Ct=ot.multiplyBy(-ut/2).round();!Ct.x&&!Ct.y?c.fire("moveend"):(Ct=c._limitOffset(Ct,c.options.maxBounds),P(function(){c.panBy(Ct,{duration:ut,easeLinearity:se,noMoveStart:!0,animate:!0})}))}}});_t.addInitHook("addHandler","dragging",_d),_t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var bd=tt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),St(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,h=n.scrollTop||c.scrollTop,_=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(_,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},h=this.keyCodes,_,T;for(_=0,T=h.left.length;_<T;_++)c[h.left[_]]=[-1*n,0];for(_=0,T=h.right.length;_<T;_++)c[h.right[_]]=[n,0];for(_=0,T=h.down.length;_<T;_++)c[h.down[_]]=[0,n];for(_=0,T=h.up.length;_<T;_++)c[h.up[_]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},h=this.keyCodes,_,T;for(_=0,T=h.zoomIn.length;_<T;_++)c[h.zoomIn[_]]=n;for(_=0,T=h.zoomOut.length;_<T;_++)c[h.zoomOut[_]]=-n},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){St(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,h=this._map,_;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(_=this._panKeys[c],n.shiftKey&&(_=de(_).multiplyBy(3)),h.options.maxBounds&&(_=h._limitOffset(de(_),h.options.maxBounds)),h.options.worldCopyJump){var T=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(_)));h.panTo(T)}else h.panBy(_)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Eo(n)}}});_t.addInitHook("addHandler","keyboard",bd),_t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wd=tt.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){St(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=Oa(n),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var _=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),_),Eo(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,z=h?Math.ceil(T/h)*h:T,se=n._limitZoom(c+(this._delta>0?z:-z))-c;this._delta=0,this._startTime=null,se&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+se):n.setZoomAround(this._lastMousePos,c+se))}});_t.addInitHook("addHandler","scrollWheelZoom",wd);var rm=600;_t.mergeOptions({tapHold:je.touchNative&&je.safari&&je.mobile,tapTolerance:15});var Cd=tt.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){St(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new U(c.clientX,c.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Jt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),rm),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){St(document,"touchend",Jt),St(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),St(document,"touchend touchcancel contextmenu",this._cancel,this),St(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new U(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});_t.addInitHook("addHandler","tapHold",Cd),_t.mergeOptions({touchZoom:je.touch,bounceAtZoomLimits:!0});var Ld=tt.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){zt(this._map._container,"leaflet-touch-zoom"),St(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(n.touches[0]),_=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(_)._divideBy(2))),this._startDist=h.distanceTo(_),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Jt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(n.touches[0]),_=c.mouseEventToContainerPoint(n.touches[1]),T=h.distanceTo(_)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var z=h._add(_)._divideBy(2)._subtract(this._centerPoint);if(T===1&&z.x===0&&z.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(z),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var se=r(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(se,this,!0),Jt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),St(document,"touchmove",this._onTouchMove,this),St(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});_t.addInitHook("addHandler","touchZoom",Ld),_t.BoxZoom=yd,_t.DoubleClickZoom=kd,_t.Drag=_d,_t.Keyboard=bd,_t.ScrollWheelZoom=wd,_t.TapHold=Cd,_t.TouchZoom=Ld,o.Bounds=ke,o.Browser=je,o.CRS=ee,o.Canvas=pd,o.Circle=al,o.CircleMarker=bi,o.Class=ae,o.Control=hn,o.DivIcon=ca,o.DivOverlay=we,o.DomEvent=Qi,o.DomUtil=ea,o.Draggable=Ht,o.Evented=oe,o.FeatureGroup=Go,o.GeoJSON=Zo,o.GridLayer=xs,o.Handler=tt,o.Icon=ia,o.ImageOverlay=Ha,o.LatLng=ze,o.LatLngBounds=Xe,o.Layer=yo,o.LayerGroup=aa,o.LineUtil=wc,o.Map=_t,o.Marker=_i,o.Mixin=ft,o.Path=cs,o.Point=U,o.PolyUtil=Ln,o.Polygon=la,o.Polyline=jo,o.Popup=nt,o.PosAnimation=ui,o.Projection=Cc,o.Rectangle=gd,o.Renderer=Is,o.SVG=cl,o.SVGOverlay=ie,o.TileLayer=xn,o.Tooltip=At,o.Transformation=he,o.Util=Q,o.VideoOverlay=ll,o.bind=r,o.bounds=Re,o.canvas=vd,o.circle=$c,o.circleMarker=Ic,o.control=is,o.divIcon=xi,o.extend=s,o.featureGroup=yi,o.geoJSON=sr,o.geoJson=za,o.gridLayer=ua,o.icon=tr,o.imageOverlay=ar,o.latLng=We,o.latLngBounds=Ne,o.layerGroup=gi,o.map=di,o.marker=xc,o.point=de,o.polygon=nr,o.polyline=Tc,o.popup=It,o.rectangle=lm,o.setOptions=C,o.stamp=d,o.svg=md,o.svgOverlay=be,o.tileLayer=hd,o.tooltip=vn,o.transformation=G,o.version=a,o.videoOverlay=H;var cm=window.L;o.noConflict=function(){return window.L=cm,this},window.L=o}))})(gl,gl.exports)),gl.exports}var Ub=Fb();const Ot=Bb(Ub);(function(e,t,o){function a(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,r=i.getLatLngs(),u=r.splice(-1,1)[0];this._poly.setLatLngs(r),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),r=this._map.layerPointToLatLng(i);this._currentLatLng=r,this._updateTooltip(r),this._updateGuide(i),this._mouseMarker.setLatLng(r),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,r=i.clientX,u=i.clientY;this._startPoint.call(this,r,u)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,r=i.clientX,u=i.clientY;this._endPoint.call(this,r,u,s),this._clickHandled=null},_endPoint:function(s,i,r){if(this._mouseDownOrigin){var u=L.point(s,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(r.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(r.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(r.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,r,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,r=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,r),this._endPoint.call(this,i,r,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var r;if(this.type===L.Draw.Polyline.TYPE)r=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;r=this._markers[0]}var u=this._map.latLngToContainerPoint(r.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(f)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var r,u,d,f=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<f;y+=this.options.guidelineDistance)r=y/f,u={x:Math.floor(s.x*(1-r)+r*i.x),y:Math.floor(s.y*(1-r)+r*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,r=this._guidesContainer.childNodes.length;i<r;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,r=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=r?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var r,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(r=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[r].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[r].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,r=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?r&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(r)*(this.options.factor||1):this._measurementRunningTotal||0:r&&i?this._measurementRunningTotal+this._map.distance(i,r)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var r;!this.options.allowIntersection&&this.options.showArea&&(r=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(r)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,r,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,f=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),r=f?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:r}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,r=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(r),this._isDrawing){this._drawShape(r),i=this._shape.getRadius().toFixed(1);var f="";u&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var r=parseInt(s.style.marginTop,10)-i,u=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=r+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,r){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,r&&r.drawError&&(r.drawError=L.Util.extend({},this.options.drawError,r.drawError)),this._latlngs=i,L.setOptions(this,r)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(r){L.DomUtil.removeClass(i,r)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(r){L.DomUtil.addClass(i,r)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,r,u,d=this._defaultShape();for(s=0,r=d.length;s<r;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var f,p;for(s=0,i=r-1;s<r;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[i],p=this._markers[s],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return r._origLatLng=s,r._index=i,r.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(r),r},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,r=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),r.options.poly){var d=r._map._editTooltip;if(!r.options.poly.allowIntersection&&r.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var f=r.options.color;r.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){r.setStyle({color:f}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,r=s.target;this._defaultShape().length<i||(this._removeMarker(r),this._updatePrevNext(r._prev,r._next),r._middleLeft&&this._markerGroup.removeLayer(r._middleLeft),r._middleRight&&this._markerGroup.removeLayer(r._middleRight),r._prev&&r._next?this._createMiddleMarker(r._prev,r._next):r._prev?r._next||(r._prev._middleRight=null):r._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i),u=s.target;L.extend(u._origLatLng,r),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(r){r._index>s&&(r._index+=i)})},_createMiddleMarker:function(s,i){var r,u,d,f=this._getMiddleLatLng(s,i),p=this._createMarker(f);p.setOpacity(.6),s._middleRight=i._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=i._index;p._index=g,p.off("click",r,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),i._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,i),this._poly.fire("editstart")},d=function(){p.off("dragstart",u,this),p.off("dragend",d,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,i)},r=function(){u.call(this),d.call(this),this._fireEdit()},p.on("click",r,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var r=this._poly._map,u=r.project(s.getLatLng()),d=r.project(i.getLatLng());return r.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var r=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(r),this._markerGroup.addLayer(r),r},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,r=i.getLatLng();i===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),r=s.target,u=r._cornerIndex;r.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),r=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(r):this._resize(r),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,r=s.length;i<r;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),r=s.target,u=r._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var i,r,u=s.target;u===this._moveMarker&&(i=this._shape.getBounds(),r=i.getCenter(),u.setLatLng(r)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,r=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),f=[],p=0,g=r.length;p<g;p++)i=[r[p].lat-d.lat,r[p].lng-d.lng],f.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,r=this._resizeMarkers.length;i<r;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),r=this._map.project(s);return this._map.unproject([r.x+i,r.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var r={};if(s.touches!==void 0){if(!s.touches.length)return;r=s.touches[0]}else if(s.pointerType!=="touch"||(r=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(r),d=this._map.mouseEventToLayerPoint(r),f=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:f,layerPoint:d,containerPoint:u,pageX:r.pageX,pageY:r.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,r=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return r&&r>100&&r<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var r=0;r<i.length;r++)L.DomEvent.on(s,i[r],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var r=s.indexOf("rv:");return parseInt(s.substring(r+3,s.indexOf(".",r)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],r=0,u=s.length;r<u;r++)Array.isArray(s[r])?i.push(L.LatLngUtil.cloneLatLngs(s[r])):i.push(this.cloneLatLng(s[r]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var r,u,d=i.length,f=0,p=Math.PI/180;if(d>2){for(var g=0;g<d;g++)r=i[g],u=i[(g+1)%d],f+=(u.lng-r.lng)*p*(2+Math.sin(r.lat*p)+Math.sin(u.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(i,r){var u=parseFloat(i).toFixed(r),d=L.drawLocal.format&&L.drawLocal.format.numeric,f=d&&d.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var y=u.split(".");u=p?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):y[0],g=g||".",y.length>1&&(u=u+g+y[1])}return u},readableArea:function(i,r,p){var d,f,p=L.Util.extend({},s,p);return r?(f=["ha","m"],type=typeof r,type==="string"?f=[r]:type!=="boolean"&&(f=r),d=i>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,p.km)+" km":i>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,p.ha)+" ha":L.GeometryUtil.formattedNumber(i,p.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,p.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(i,p.yd)+" yd"),d},readableDistance:function(i,r,u,d,g){var p,g=L.Util.extend({},s,g);switch(r?typeof r=="string"?r:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":p=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(i,g.m)+" m";break;case"feet":i*=3.28083,p=L.GeometryUtil.formattedNumber(i,g.ft)+" ft";break;case"nauticalMile":i*=.53996,p=L.GeometryUtil.formattedNumber(i/1e3,g.nm)+" nm";break;default:i*=1.09361,p=i>1760?L.GeometryUtil.formattedNumber(i/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(i,g.yd)+" yd"}return p},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,r,u){return this._checkCounterclockwise(s,r,u)!==this._checkCounterclockwise(i,r,u)&&this._checkCounterclockwise(s,i,r)!==this._checkCounterclockwise(s,i,u)},_checkCounterclockwise:function(s,i,r){return(r.y-s.y)*(i.x-s.x)>(i.y-s.y)*(r.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,r,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(i=u[s-1],r=u[s],this._lineSegmentsIntersectsRange(i,r,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var r=this._getProjectedPoints(),u=r?r.length:0,d=r?r[u-1]:null,f=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,f,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),r=i?i.length:0;return r+=s||0,!i||r<=3},_lineSegmentsIntersectsRange:function(s,i,r,u){var d,f,p=this._getProjectedPoints();u=u||0;for(var g=r;g>u;g--)if(d=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(s,i,d,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),r=0;r<i.length;r++)s.push(this._map.latLngToLayerPoint(i[r]));return s}}),L.Polygon.include({intersects:function(){var s,i,r,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,i=d[0],r=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(r,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,r=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),r.appendChild(i));return r},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var r in this._toolbars)this._toolbars[r]!==i&&this._toolbars[r].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,r=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",f=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<f.length;i++)f[i].enabled&&this._initModeHandler(f[i].handler,this._toolbarContainer,u++,d,f[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),r.appendChild(this._toolbarContainer),r.appendChild(this._actionsContainer),r},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,r=this._actionButtons.length;i<r;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,r,u,d){var f=s.type;this._modes[f]={},this._modes[f].handler=s,this._modes[f].button=this._createButton({type:f,title:d,className:u+"-"+f,container:i,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=r,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),r=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(r),s.title&&(i.title=s.title,r.innerHTML=s.title),s.text&&(i.innerHTML=s.text,r.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,s.callback,s.context),i},_disposeButton:function(s,i){var r=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,r,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,r,u,d,f=this._actionsContainer,p=this.getActions(s),g=p.length;for(r=0,u=this._actionButtons.length;r<u;r++)this._disposeButton(this._actionButtons[r].button,this._actionButtons[r].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var y=0;y<g;y++)"enabled"in p[y]&&!p[y].enabled||(i=L.DomUtil.create("li","",f),d=this._createButton({title:p[y].title,text:p[y].text,container:i,callback:p[y].callback,context:p[y].context}),this._actionButtons.push({button:d,callback:p[y].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,r=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=r+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),r=this._container;return this._container&&(this._visible&&(r.style.visibility="inherit"),L.DomUtil.setPosition(r,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,r=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,r?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",r?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,r,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(r=L.Util.extend({},this.options.poly),u.options.poly=r),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],r=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(r);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Zv=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",nf=e=>e.length*6+12,Xc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),zb=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(r=>{if(a.contains(r.getLatLng())){const u=e.latLngToContainerPoint(r.getLatLng()),d=r.locationData;d&&o.push({marker:r,pixelPos:u,location:d})}});const s=o.map(({marker:r,pixelPos:u,location:d})=>{const g=nf(d.name),y=d.description?nf(`${d.name}: ${Zv(d.description,50)}`):g;return{marker:r,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return s.forEach(({marker:r,location:u,markerBox:d,baseLabelBox:f,descLabelBox:p},g)=>{if(!u.description)return;let y=!1;for(let k=0;k<s.length;k++){if(g===k)continue;const b=s[k];if(Xc(p,b.markerBox)||Xc(p,b.baseLabelBox)){y=!0;break}if(b.descLabelBox&&i.has(b.location.id)&&Xc(p,b.descLabelBox)){y=!0;break}}y||i.add(u.id)}),i},vr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],Hb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Gr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function oi(e){return Gr.find(t=>t.value===e)||Gr[0]}function Vb(e){return oi(e).defaultColor||"#667eea"}function Gb(e,t){return t||Vb(e)}const $u={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,s=t-4,i=4,r=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${r},${s} ${i},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-s} ${o+s},${a} ${o},${a+s} ${o-s},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-3,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${o+s*Math.cos(d)},${a+s*Math.sin(d)}`);const f=d+Math.PI/5;r.push(`${o+i*Math.cos(f)},${a+i*Math.sin(f)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${r.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<6;r++){const u=Math.PI/6+r*Math.PI/3;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let r=0;r<5;r++){const u=Math.PI/2*-1+r*2*Math.PI/5;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},of={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Pi={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<6;i++){const r=Math.PI/6+i*Math.PI/3;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<5;i++){const r=Math.PI/2*-1+i*2*Math.PI/5;s.push(`${16+12*Math.cos(r)},${16+12*Math.sin(r)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=13,i=s*.4,r=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;r.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const f=d+Math.PI/5;r.push(`${16+i*Math.cos(f)},${16+i*Math.sin(f)}`)}return`<polygon points="${r.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},sf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function In({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:s,size:i="100",outputSize:r=null}){if(!e||e==="default"){if(!(o||a||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=oi(e),d=parseInt(i,10)/100,f=r||Math.round(32*d);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",y=a||"#fff";if(Pi[e])p=Pi[e]({backgroundColor:g,borderColor:y});else return $u[e]?.(g,f)||null}else{const g=o||"#667eea",y=a||"#fff",k=s||"#fff",b=t||"circle";b!=="none"&&Pi[b]&&(p+=Pi[b]({backgroundColor:g,borderColor:y})),sf[e]&&(p+=sf[e](k,g))}return`<svg width="${f}" height="${f}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const jb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function Zb(e,t){return e===0?"missing":e>=t?"full":"partial"}function Tu(e,t){const o=Zb(e,t);return jb[o]}function Wb(e,t,o=32){if(e==="default")return null;if(of[e])return of[e](o);if($u[e]){const a=t||"#667eea";return $u[e](a,o)}return null}const qb=["circle","square","hexagon","pentagon"];function Kb(e){return qb.includes(e)}function Jb(e,t,o,a,s=32,i=!0){const r=Wb(e,t,s),u=Tu(o,a);if(!r)return null;const d=i&&Kb(e),f=Gb(e,t),p=Xb(f),g=Wv(f)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=s>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${r}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function Yb(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function Wv(e){return!e||e.length<6?!1:Yb(e)>.4}function Xb(e){return Wv(e)?"#1F2937":"#FFFFFF"}const Qb={class:"map-container-wrapper"},e0="#667eea",t0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null);let r=null;const u=M([]),d=M([]),f=M([]);let p=null,g=null;const y=M([]);let k=null,b=null,C=!1;const x=M(!1),$=()=>{if(r){const Se=r.getCenter();return{lat:Se.lat,lng:Se.lng}}return null},I=()=>r?r.getZoom():null,S=()=>{if(u.value.length>0){f.value.push([...u.value]);const Se=d.value.pop()||[];u.value=Se,Me(),s("polygon-drawing",u.value)}},B=()=>{if(f.value.length>0){d.value.push([...u.value]);const Se=f.value.pop();u.value=Se,Me(),s("polygon-drawing",u.value)}},R=()=>u.value.length>0,Z=()=>f.value.length>0,A=()=>u.value.length,N=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),O())},O=()=>{u.value=[],d.value=[],f.value=[],Me()},V=()=>{!r||!a.userLocation||(r.setView([a.userLocation.lat,a.userLocation.lng],r.getZoom(),{animate:!0,duration:.5}),x.value=!0)},P=(Se,_e,W=null)=>{if(!r||Se==null||_e==null)return;r.setView([Se,_e],W??r.getZoom(),{animate:!0,duration:.5});const q=a.center&&Math.abs(a.center.lat-Se)<1e-4&&Math.abs(a.center.lng-_e)<1e-4;x.value=!q},j=M(!0),Q=M(!0),ae=(Se,_e)=>{if(!r||Se==null||_e==null)return!0;const W=r.getBounds(),q=Ot.latLng(Se,_e);return W.contains(q)};t({getMapCenter:$,getMapZoom:I,undoPolygonPoint:S,redoPolygonPoint:B,canUndo:R,canRedo:Z,getPolygonPointCount:A,completePolygon:N,clearPolygonDrawing:O,recenterOnUserLocation:V,recenterOnLocation:P,isLocationInView:ae,userLocationInView:Q,highlightedLocationInView:j});const pe=M([]);let ne=null;const oe=M(!0),U=M(!1),Y=M(new Set),de=M([]);let ke=null,Re=null;const Xe=F(()=>a.hideRecenterButton||!a.highlightLocationId||!x.value?!1:!j.value),Ne=M({}),ze=()=>{const Se={};if(a.highlightLocationId){const _e=a.locations.find(W=>W.id===a.highlightLocationId);if(_e?.latitude&&_e?.longitude){const W=ae(_e.latitude,_e.longitude);j.value=W,Se[a.highlightLocationId]=W,Ne.value=Se;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let _e=!0;for(const W of a.highlightLocationIds){const q=a.locations.find(K=>K.id===W);if(q?.latitude&&q?.longitude){const K=ae(q.latitude,q.longitude);Se[W]=K,K||(_e=!1)}else Se[W]=!0}j.value=_e,Ne.value=Se;return}if(!r){j.value=!0,Ne.value={};return}j.value=!0,Ne.value={}},We=()=>{if(!r||!a.userLocation){Q.value=!0;return}Q.value=ae(a.userLocation.lat,a.userLocation.lng)},ee=()=>{ze(),We(),s("visibility-change",{userLocationInView:Q.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:Ne.value})},ye=()=>{if(!r||!a.highlightLocationId)return;const Se=a.locations.find(_e=>_e.id===a.highlightLocationId);!Se||!Se.latitude||!Se.longitude||(r.setView([Se.latitude,Se.longitude],r.getZoom(),{animate:!0,duration:.5}),x.value=!1,j.value=!0)},te=(Se,_e,W,q,K=!1)=>{const le=W?"36px":q?"20px":"30px",Ee=W?"#667eea":"white",Ke=K?"":Tu(Se,_e);return`
    <div style="position: relative; width: ${le}; height: ${le};">
      <div style="
        background-color: ${e0};
        width: ${le};
        height: ${le};
        border-radius: 50%;
        border: 3px solid ${Ee};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${K?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Ke}
      </div>`}
    </div>
  `},ge=()=>{if(!r)return;const Se=zb(r,pe.value),_e=Array.from(Y.value).sort().join(","),W=Array.from(Se).sort().join(",");_e!==W&&(Y.value=Se,xe())},he=()=>{if(Re&&(Re.remove(),Re=null),!r||!a.userLocation)return;const Se=Ot.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Re=Ot.marker([a.userLocation.lat,a.userLocation.lng],{icon:Se}).addTo(r).bindPopup("Your location")},G=()=>{if(!i.value)return;let Se=51.505,_e=-.09,W=13;const q=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,K=(Ee,Ke)=>Ee!=null&&Ke!=null&&!(Ee===0&&Ke===0),le=[];q.length>0&&le.push(...q.filter(Ee=>K(Ee.latitude,Ee.longitude)).map(Ee=>({lat:Ee.latitude,lng:Ee.longitude}))),a.route&&a.route.length>0&&le.push(...a.route.filter(Ee=>K(Ee.lat,Ee.lng)).map(Ee=>({lat:Ee.lat,lng:Ee.lng}))),a.center?(Se=a.center.lat,_e=a.center.lng,W=a.zoom??13):le.length>0&&(Se=le.reduce((Ee,Ke)=>Ee+Ke.lat,0)/le.length,_e=le.reduce((Ee,Ke)=>Ee+Ke.lng,0)/le.length,W=10),r=Ot.map(i.value).setView([Se,_e],W),Ot.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(r),a.clickable&&r.on("click",Ee=>{a.drawingMode||s("map-click",{lat:Ee.latlng.lat,lng:Ee.latlng.lng})}),r.on("zoomstart",()=>{fe=!0}),r.on("zoomend moveend",()=>{fe=!1,X?xe():ge(),ee()}),r.on("dragstart",()=>{x.value=!0}),xe(),J(),ce(),he(),Le(),De(),r.whenReady(()=>{ee()})},J=()=>{if(ne&&(ne.remove(),ne=null),!r||a.route.length===0)return;const Se=a.route.map(_e=>[_e.lat,_e.lng]);ne=Ot.polyline(Se,{color:"blue",weight:4,opacity:.7}).addTo(r)},ce=()=>{de.value.forEach(Se=>Se.remove()),de.value=[],!(!r||a.areas.length===0)&&a.areas.forEach(Se=>{const _e=typeof Se.polygon=="string"?JSON.parse(Se.polygon):Se.polygon;if(!_e||_e.length===0)return;const W=_e.map(Ee=>[Ee.lat,Ee.lng]),q=Se.id===a.selectedAreaId,K=Se.color||"#667eea",le=Ot.polygon(W,{color:K,fillColor:K,fillOpacity:q?.4:.2,weight:q?3:2,opacity:.8}).addTo(r);le.setStyle({pane:"overlayPane"}),a.drawingMode||(le.on("click",()=>s("area-click",Se)),le.on("mouseover",()=>{le.setStyle({fillOpacity:.4})}),le.on("mouseout",()=>{le.setStyle({fillOpacity:q?.4:.2})})),de.value.push(le)})},Me=()=>{if(r&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=Ot.layerGroup().addTo(r),u.value.forEach((Se,_e)=>{const W=_e===0,q=_e===u.value.length-1,K=Ot.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${W?"16px":"12px"};
        height: ${W?"16px":"12px"};
        background-color: ${W?"#667eea":q?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[W?16:12,W?16:12],iconAnchor:[W?8:6,W?8:6]});Ot.marker([Se.lat,Se.lng],{icon:K,interactive:!1}).addTo(g)}),u.value.length>=2))){const Se=u.value.map(_e=>[_e.lat,_e.lng]);u.value.length>=3&&Se.push(Se[0]),p=Ot.polyline(Se,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(r)}},Be=()=>{if(!r||(k&&(k.remove(),k=null),b&&(b.remove(),b=null),y.value.length===0))return;const Se=y.value.map(W=>[W.lat,W.lng]);k=Ot.polygon(Se,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(r),k.bringToFront(),b=Ot.layerGroup({pane:"markerPane"}).addTo(r);const _e=W=>{y.value.length<=3||(y.value.splice(W,1),C=!0,s("polygon-update",[...y.value]),Be())};y.value.forEach((W,q)=>{const K=y.value.length>3,le=Ot.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),Ee=Ot.marker([W.lat,W.lng],{icon:le,draggable:!0}).addTo(b);if(Ee.on("drag",Ke=>{const Qe=Ke.target.getLatLng();y.value[q]={lat:Qe.lat,lng:Qe.lng};const gt=y.value.map(Lt=>[Lt.lat,Lt.lng]);k.setLatLngs(gt)}),Ee.on("dragend",()=>{C=!0,s("polygon-update",[...y.value])}),Ee.on("contextmenu",Ke=>{Ot.DomEvent.preventDefault(Ke),K&&_e(q)}),K){const Ke=document.createElement("div"),Qe=document.createElement("button");Qe.textContent="Delete point",Qe.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const gt=Lt=>{Lt.preventDefault(),Lt.stopPropagation(),Ee.closePopup(),_e(q)};Qe.addEventListener("click",gt),Qe.addEventListener("touchend",gt),Ke.appendChild(Qe),Ee.bindPopup(Ke,{closeButton:!1,className:"vertex-popup"})}})},De=(Se=!0)=>{if(r){if(!a.editingPolygon||a.editingPolygon.length===0){k&&(k.remove(),k=null),b&&(b.remove(),b=null),y.value=[];return}if(y.value=a.editingPolygon.map(_e=>({lat:_e.lat,lng:_e.lng})),Be(),Se&&y.value.length>=3){const _e=Ot.latLngBounds(y.value.map(W=>[W.lat,W.lng]));r.fitBounds(_e,{padding:[50,50]})}}},Le=()=>{if(!r)return;if(ke||(ke=new Ot.FeatureGroup,r.addLayer(ke)),r._customDrawingHandlers&&(r.off("click",r._customDrawingHandlers.handleClick),r.getContainer().removeEventListener("touchstart",r._customDrawingHandlers.handleTouchStart),r.getContainer().removeEventListener("touchend",r._customDrawingHandlers.handleTouchEnd),r.getContainer().removeEventListener("touchmove",r._customDrawingHandlers.handleTouchMove),delete r._customDrawingHandlers),!a.drawingMode){O(),ke&&ke.clearLayers();return}let Se=0,_e=null,W=!1,q=!1;const K=300,le=15,Ee=yt=>{d.value.push([...u.value]),f.value=[],u.value.push({lat:yt.lat,lng:yt.lng}),Me(),s("polygon-drawing",u.value)},Ke=yt=>{yt.originalEvent&&yt.originalEvent.sourceCapabilities?.firesTouchEvents||Ee(yt.latlng)},Qe=yt=>{if(yt.touches.length>1){q=!0;return}q=!1,Se=Date.now(),_e={x:yt.touches[0].clientX,y:yt.touches[0].clientY},W=!1},gt=yt=>{if(!_e||q)return;const xt=yt.touches[0].clientX-_e.x,kt=yt.touches[0].clientY-_e.y;Math.sqrt(xt*xt+kt*kt)>le&&(W=!0)},Lt=yt=>{if(q){q=!1,_e=null;return}if(Date.now()-Se<K&&!W&&_e){const kt=yt.changedTouches[0],Ut=Ot.point(kt.clientX-r.getContainer().getBoundingClientRect().left,kt.clientY-r.getContainer().getBoundingClientRect().top),Rt=r.containerPointToLatLng(Ut);yt.preventDefault(),yt.stopPropagation(),Ee(Rt)}_e=null,W=!1};r.on("click",Ke),r.getContainer().addEventListener("touchstart",Qe,{passive:!0}),r.getContainer().addEventListener("touchmove",gt,{passive:!0}),r.getContainer().addEventListener("touchend",Lt,{passive:!1}),r._customDrawingHandlers={handleClick:Ke,handleTouchStart:Qe,handleTouchMove:gt,handleTouchEnd:Lt},Me()};let X=!1,fe=!1;const xe=()=>{if(r&&(r._animatingZoom||fe)){X=!0;return}if(X=!1,pe.value.forEach(W=>{W._map&&(W.off(),W.remove())}),pe.value=[],!r)return;const Se=i.value?.clientWidth||400,_e=Math.floor(Se*.75);if(a.locations.forEach(W=>{const q=W.latitude??W.Latitude,K=W.longitude??W.Longitude;if(q==null||K==null||q===0&&K===0)return;const le=W.checkedInCount||0,Ee=W.requiredMarshals||1,Ke=a.highlightLocationId===W.id||a.highlightLocationIds.includes(W.id),Qe=a.simplifyNonHighlighted&&!Ke,gt=W.resolvedStyleType||W.ResolvedStyleType,Lt=W.resolvedStyleBackgroundColor||W.ResolvedStyleBackgroundColor||W.resolvedStyleColor||W.ResolvedStyleColor,yt=W.resolvedStyleBorderColor||W.ResolvedStyleBorderColor,xt=W.resolvedStyleIconColor||W.ResolvedStyleIconColor,kt=W.resolvedStyleBackgroundShape||W.ResolvedStyleBackgroundShape,Ut=gt&&gt!=="default"||Lt||yt||xt||kt&&kt!=="circle"&&kt!=="default",Rt=W.resolvedStyleMapRotation??W.ResolvedStyleMapRotation??W.styleMapRotation??W.StyleMapRotation??0,ct=parseInt(Rt,10)||0,ln=W.areaColor||"#999",un=W.areaId&&!a.marshalMode,bt=Y.value.has(W.id)&&W.description?`${W.name}: ${Zv(W.description,50)}`:W.name,Yn=Ke?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Un=Ke?"#667eea":Qe?"#e0e0e0":"white",Xn=Ke?"white":Qe?"#888":"#333";let kn;if(Qe){const st="20px";kn=`
        <div style="
          background-color: #999;
          width: ${st};
          height: ${st};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Kt=!a.marshalMode,_s=Tu(le,Ee),Qn=Kt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${le}/${Ee}</div>`:"";if(!Qe&&Ut){const st=Ke?40:32,je=W.resolvedStyleSize||W.ResolvedStyleSize||"100",$t=In({type:W.resolvedStyleType||W.ResolvedStyleType,backgroundShape:W.resolvedStyleBackgroundShape||W.ResolvedStyleBackgroundShape||"circle",backgroundColor:W.resolvedStyleBackgroundColor||W.ResolvedStyleBackgroundColor||W.resolvedStyleColor||W.ResolvedStyleColor||"",borderColor:W.resolvedStyleBorderColor||W.ResolvedStyleBorderColor||"",iconColor:W.resolvedStyleIconColor||W.ResolvedStyleIconColor||"",size:je});$t?kn=$t:kn=Jb(W.resolvedStyleType,W.resolvedStyleColor,le,Ee,st,Kt)||te(le,Ee,Ke,a.marshalMode,!0)}else Qe||(kn=te(le,Ee,Ke,a.marshalMode,!0));const Co=ct!==0?`transform: rotate(${ct}deg);`:"",re=Ot.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Yn}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${un?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ln};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Co}">
                ${kn}
              </div>
              ${Qe?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${_s}
              </div>`}
              ${Qe?"":Qn}
            </div>
          </div>
          <div style="
            background-color: ${Un};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${Ke?"12px":"11px"};
            font-weight: bold;
            color: ${Xn};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${_e}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${bt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),ue=a.marshalMode?`<b>${W.name}</b>${W.description?`<br>${W.description}`:""}`:`<b>${W.name}</b><br>${W.description||""}<br>Checked in: ${le}/${Ee}`,me=Ot.marker([W.latitude,W.longitude],{icon:re}).addTo(r).bindPopup(ue);me.on("click",()=>{s("location-click",W)}),me.locationData=W,pe.value.push(me)}),r&&oe.value&&!a.center&&!U.value){const W=[],q=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,K=(le,Ee)=>le!=null&&Ee!=null&&!(le===0&&Ee===0);if(q.length>0&&W.push(...q.filter(le=>K(le.latitude,le.longitude)).map(le=>[le.latitude,le.longitude])),a.route.length>0&&W.push(...a.route.filter(le=>K(le.lat,le.lng)).map(le=>[le.lat,le.lng])),W.length>0){const le=Ot.latLngBounds(W);r.fitBounds(le,{padding:[50,50]}),oe.value=!1,U.value=!0}}else a.center&&(oe.value=!1);setTimeout(()=>{r&&!r._animatingZoom&&ge()},100)};return tn(()=>{U.value=!1,oe.value=!0,G();let Se,_e=0,W=0;const q=new ResizeObserver(K=>{if(r&&K.length>0){const{width:le,height:Ee}=K[0].contentRect;(Math.abs(le-_e)>10||Math.abs(Ee-W)>10)&&(_e=le,W=Ee,clearTimeout(Se),Se=setTimeout(()=>{r.invalidateSize()},150))}});i.value&&q.observe(i.value),yn(()=>{clearTimeout(Se),q.disconnect()})}),Ze(()=>a.locations,Se=>{if(xe(),r&&!U.value&&Se.length>0&&!a.center){const _e=Se.map(le=>le.latitude),W=Se.map(le=>le.longitude),q=_e.reduce((le,Ee)=>le+Ee,0)/_e.length,K=W.reduce((le,Ee)=>le+Ee,0)/W.length;r.setView([q,K],10),U.value=!0,oe.value=!1}r&&setTimeout(()=>ee(),50)},{deep:!0}),Ze(()=>a.route,Se=>{if(J(),xe(),r&&!U.value&&Se&&Se.length>0&&!a.center){const _e=Se.map(le=>le.lat),W=Se.map(le=>le.lng),q=_e.reduce((le,Ee)=>le+Ee,0)/_e.length,K=W.reduce((le,Ee)=>le+Ee,0)/W.length;r.setView([q,K],10),U.value=!0,oe.value=!1}},{deep:!0}),Ze(()=>a.center,(Se,_e)=>{r&&!x.value&&(!_e||Math.abs(Se.lat-_e.lat)>1e-6||Math.abs(Se.lng-_e.lng)>1e-6)&&r.setView([Se.lat,Se.lng],a.zoom)}),Ze(()=>a.areas,()=>{ce()},{deep:!0}),Ze(()=>a.selectedAreaId,()=>{ce()}),Ze(()=>a.drawingMode,()=>{Le()}),Ze(()=>a.editingPolygon,()=>{if(C){C=!1;return}De()},{deep:!0}),Ze(()=>a.userLocation,()=>{he()},{deep:!0}),Ze(()=>a.highlightLocationId,()=>{xe()}),Ze(()=>a.highlightLocationIds,()=>{xe(),r&&setTimeout(()=>ee(),50)},{deep:!0}),Ze(()=>a.marshalMode,()=>{xe()}),Ze(()=>a.simplifyNonHighlighted,()=>{xe()}),Ze(()=>a.clickable,Se=>{r&&(r.off("click"),Se&&r.on("click",_e=>{a.drawingMode||s("map-click",{lat:_e.latlng.lat,lng:_e.latlng.lng})}))}),(Se,_e)=>(v(),m("div",Qb,[l("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),Xe.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:ye,title:"Recenter on checkpoint"},[..._e[0]||(_e[0]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),l("span",null,"Recenter",-1)])])):E("",!0)]))}},Mu=Ge(t0,[["__scopeId","data-v-91272c81"]]);function js(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const n0={class:"areas-selection"},o0={key:0,class:"areas-selection-header"},s0={class:"areas-list"},a0=["checked","onChange"],i0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>[...o.areas].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:js(d.name,f.name))),i=F(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),r=d=>{const f=[...o.selectedAreaIds],p=f.indexOf(d);p>=0?f.splice(p,1):f.push(d),a("update:selectedAreaIds",f)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,f)=>(v(),m("div",n0,[e.areas.length>1?(v(),m("div",o0,[l("button",{onClick:u,class:"toggle-all-btn"},w(i.value?"Deselect all":"Select all"),1)])):E("",!0),l("div",s0,[(v(!0),m(Ie,null,Fe(s.value,p=>(v(),m("label",{class:"area-checkbox",key:p.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>r(p.id)},null,40,a0),l("span",{class:"area-color-dot",style:et({backgroundColor:p.color||"#667eea"})},null,4),Ye(" "+w(p.name),1)]))),128))])]))}},l0=Ge(i0,[["__scopeId","data-v-ba19009b"]]),r0={key:1,class:"toolbar-btn-wrapper filters-wrapper"},c0={key:1,class:"dropdown-content filters-dropdown"},u0={class:"filters-header"},d0={class:"filter-section"},h0={class:"filter-checkbox"},f0=["checked"],p0={class:"filter-section"},v0={class:"filter-checkbox"},m0=["checked"],g0={class:"filter-checkbox"},y0=["checked"],k0={class:"filter-checkbox"},_0=["checked"],b0={key:0,class:"filter-section"},w0=["onClick","title"],C0={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},L0={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},S0=["innerHTML"],x0={key:0,class:"dropdown-content action-dropdown"},I0=["onClick"],$0={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=dt(),s=e,i=o,r=M(!1),u=M(null),d=F(()=>u.value!==null),f=()=>{r.value=!r.value,r.value&&(u.value=null)},p=(b,C)=>{i("filter-change",{...s.filters,[b]:C})},g=b=>{b.items&&b.items.length>0?u.value===b.id?u.value=null:(u.value=b.id,r.value=!1):i("action-click",{actionId:b.id})},y=(b,C)=>{u.value=null,i("action-click",{actionId:b,itemId:C})};return t({closeDropdowns:()=>{r.value=!1,u.value=null}}),(b,C)=>(v(),m("div",{class:ve(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:C[0]||(C[0]=x=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...C[8]||(C[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):E("",!0),e.showFilters&&!d.value?(v(),m("div",r0,[r.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:C[1]||(C[1]=x=>r.value=!1)})):E("",!0),l("button",{class:ve(["toolbar-btn",{active:r.value}]),onClick:f,title:"Show/hide options"},[...C[9]||(C[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),r.value?(v(),m("div",c0,[l("div",u0,[C[11]||(C[11]=l("span",{class:"filters-title"},"Map filters",-1)),l("button",{class:"close-filters-btn",onClick:C[2]||(C[2]=x=>r.value=!1),title:"Close"},[...C[10]||(C[10]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),l("div",d0,[C[12]||(C[12]=l("h4",null,"Display",-1)),l("label",h0,[l("input",{type:"checkbox",checked:e.filters.showRoute,onChange:C[3]||(C[3]=x=>p("showRoute",x.target.checked))},null,40,f0),l("span",null,w(D(a).course)+" line",1)])]),l("div",p0,[l("h4",null,w(D(a).checkpoints),1),l("label",v0,[l("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:C[4]||(C[4]=x=>p("showUncheckedIn",x.target.checked))},null,40,m0),C[13]||(C[13]=l("span",{class:"status-indicator unchecked"},null,-1)),C[14]||(C[14]=l("span",null,"Unchecked-in",-1))]),l("label",g0,[l("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:C[5]||(C[5]=x=>p("showPartiallyCheckedIn",x.target.checked))},null,40,y0),C[15]||(C[15]=l("span",{class:"status-indicator partial"},null,-1)),C[16]||(C[16]=l("span",null,"Partially checked-in",-1))]),l("label",k0,[l("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:C[6]||(C[6]=x=>p("showFullyCheckedIn",x.target.checked))},null,40,_0),C[17]||(C[17]=l("span",{class:"status-indicator full"},null,-1)),C[18]||(C[18]=l("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",b0,[l("h4",null,w(D(a).areas),1),Ae(l0,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":C[7]||(C[7]=x=>p("selectedAreaIds",x))},null,8,["areas","selected-area-ids"])])):E("",!0)])):E("",!0)])):E("",!0),(v(!0),m(Ie,null,Fe(e.actions,x=>(v(),m("div",{key:x.id,class:ve(["toolbar-btn-wrapper",{hidden:r.value}])},[l("button",{class:ve(["toolbar-btn",{active:u.value===x.id}]),onClick:$=>g(x),title:x.label||x.id},[x.icon==="plus"?(v(),m("svg",C0,[...C[19]||(C[19]=[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):x.icon==="edit"?(v(),m("svg",L0,[...C[20]||(C[20]=[l("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),l("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):x.icon==="custom"?(v(),m("span",{key:2,innerHTML:x.customIcon},null,8,S0)):E("",!0)],10,w0),x.items&&u.value===x.id?(v(),m("div",x0,[(v(!0),m(Ie,null,Fe(x.items,$=>(v(),m("button",{key:$.id,onClick:I=>y(x.id,$.id),class:"dropdown-item"},w($.label),9,I0))),128))])):E("",!0)],2))),128))],2))}},T0=Ge($0,[["__scopeId","data-v-d04b549d"]]),M0={key:0,class:"drawing-controls"},A0={class:"point-count"},E0={class:"undo-redo-buttons"},P0=["disabled"],D0=["disabled"],O0={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>o.show&&o.pointCount>0),i=r=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?r.metaKey:r.ctrlKey;d&&r.key==="z"&&!r.shiftKey?(r.preventDefault(),o.canUndo&&a("undo")):d&&(r.key==="y"||r.key==="z"&&r.shiftKey)&&(r.preventDefault(),o.canRedo&&a("redo"))};return tn(()=>{document.addEventListener("keydown",i)}),yn(()=>{document.removeEventListener("keydown",i)}),(r,u)=>s.value?(v(),m("div",M0,[l("div",A0,w(e.pointCount)+" point"+w(e.pointCount!==1?"s":""),1),l("div",E0,[l("button",{onClick:u[0]||(u[0]=d=>r.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,P0),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,D0)])])):E("",!0)}},af=Ge(O0,[["__scopeId","data-v-6cd009cb"]]),R0={class:"context-info"},B0={class:"action-buttons"},N0=["disabled"],F0={key:0,class:"fullscreen-map-banner"},U0={class:"fullscreen-map-container"},z0={key:1,class:"fullscreen-map-footer"},H0={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=F(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,i=()=>{s("done")},r=()=>{s("cancel")},u=()=>{s("close")},d=f=>{f.key==="Escape"&&o.show&&(o.mode==="view"?u():r())};return Ze(()=>o.show,f=>{f?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),tn(()=>{document.addEventListener("keydown",d)}),yn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(f,p)=>(v(),qe(Pl,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:p[0]||(p[0]=it(()=>{},["prevent","self"]))},[l("div",{class:"fullscreen-map-header",style:et(e.headerStyle)},[l("div",R0,[l("h3",{style:et({color:e.headerTextColor})},w(e.title),5),e.description?(v(),m("p",{key:0,style:et({color:e.headerTextColor,opacity:.85})},w(e.description),5)):E("",!0)]),l("div",B0,[lo(f.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:it(u,["stop"]),class:"btn btn-close-x",style:et(a.value),title:"Close"},[...p[1]||(p[1]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(Ie,{key:1},[l("button",{type:"button",onClick:r,class:"btn btn-cancel"}," Cancel "),l("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,N0)],64))])],4),f.$slots.banner?(v(),m("div",F0,[lo(f.$slots,"banner",{},void 0)])):E("",!0),l("div",U0,[lo(f.$slots,"default",{},void 0)]),f.$slots.footer?(v(),m("div",z0,[lo(f.$slots,"footer",{},void 0)])):E("",!0)],32)):E("",!0)]))}},V0=Ge(H0,[["__scopeId","data-v-b5d05af4"]]),G0={class:"map-wrapper"},j0={class:"fullscreen-map-wrapper"},Z0={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null),r=M(null),u=M(null),d=M(!1),f=M(0),p=M(!1),g=M(!1),y=M({...a.filters});Ze(()=>a.filters,pe=>{y.value={...pe}},{deep:!0}),Ze(()=>a.areas,pe=>{a.showFilters&&pe.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0)&&(y.value.selectedAreaIds=pe.map(ne=>ne.id))},{immediate:!0});const k=F(()=>a.showFilters?a.locations.filter(pe=>{const ne=pe.checkedInCount||0,oe=pe.requiredMarshals||1,U=ne===0,Y=ne>0&&ne<oe,de=ne>=oe;if(U&&!y.value.showUncheckedIn||Y&&!y.value.showPartiallyCheckedIn||de&&!y.value.showFullyCheckedIn)return!1;const ke=pe.areaIds||pe.AreaIds||[];return!(a.areas.length>0&&ke.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0||!ke.some(Xe=>y.value.selectedAreaIds.includes(Xe))))}):a.locations),b=F(()=>a.showFilters?y.value.showRoute?a.route:[]:a.route),C=F(()=>a.showFilters?y.value.selectedAreaIds&&y.value.selectedAreaIds.length>0?a.areas.filter(pe=>y.value.selectedAreaIds.includes(pe.id)):a.areas.length>0?[]:a.areas:a.areas),x=F(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),$=()=>d.value?r.value:i.value,I=()=>{d.value=!0,s("fullscreen-change",!0)},S=()=>{d.value=!1,s("fullscreen-change",!1)},B=()=>{if(a.mode==="draw-polygon"){const pe=$();pe&&pe.clearPolygonDrawing(),f.value=0,p.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},R=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const pe=$();pe&&pe.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},Z=pe=>{y.value=pe,s("filter-change",pe)},A=pe=>{a.mode==="select-point"&&s("point-selected",pe),s("map-click",pe)},N=pe=>{f.value=pe?.length||0,P(),s("polygon-drawing",pe)},O=pe=>{s("polygon-complete",pe),f.value=0,p.value=!1,g.value=!1},V=pe=>{s("polygon-update",pe)},P=()=>{const pe=$();pe&&(p.value=pe.canUndo?pe.canUndo():!1,g.value=pe.canRedo?pe.canRedo():!1)},j=()=>{const pe=$();pe&&pe.undoPolygonPoint&&(pe.undoPolygonPoint(),P())},Q=()=>{const pe=$();pe&&pe.redoPolygonPoint&&(pe.redoPolygonPoint(),P())};return t({getMapCenter:()=>$()?.getMapCenter?.(),getMapZoom:()=>$()?.getMapZoom?.(),undoPolygonPoint:j,redoPolygonPoint:Q,canUndo:()=>p.value,canRedo:()=>g.value,getPolygonPointCount:()=>f.value,completePolygon:()=>$()?.completePolygon?.(),clearPolygonDrawing:()=>{$()?.clearPolygonDrawing?.(),f.value=0,p.value=!1,g.value=!1},recenterOnUserLocation:()=>$()?.recenterOnUserLocation?.(),recenterOnLocation:(pe,ne,oe)=>$()?.recenterOnLocation?.(pe,ne,oe),isLocationInView:(pe,ne)=>$()?.isLocationInView?.(pe,ne)??!0,getUserLocationInView:()=>$()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>$()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:S,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(pe,ne)=>(v(),m("div",{class:"common-map",style:et({height:e.height})},[l("div",G0,[Ae(Mu,{ref_key:"mapViewRef",ref:i,locations:k.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ne[0]||(ne[0]=oe=>pe.$emit("location-click",oe)),onMapClick:A,onAreaClick:ne[1]||(ne[1]=oe=>pe.$emit("area-click",oe)),onPolygonComplete:O,onPolygonDrawing:N,onPolygonUpdate:V,onVisibilityChange:ne[2]||(ne[2]=oe=>pe.$emit("visibility-change",oe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae(T0,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:y.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:I,onFilterChange:Z,onActionClick:ne[3]||(ne[3]=oe=>pe.$emit("action-click",oe))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ae(af,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:j,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])]),Ae(V0,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":x.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:B,onClose:S},{actions:Ve(()=>[lo(pe.$slots,"fullscreen-actions",{},void 0,!0)]),banner:Ve(()=>[lo(pe.$slots,"fullscreen-banner",{},void 0,!0)]),footer:Ve(()=>[lo(pe.$slots,"fullscreen-footer",{},void 0,!0)]),default:Ve(()=>[l("div",j0,[Ae(Mu,{ref_key:"fullscreenMapViewRef",ref:r,locations:k.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:ne[4]||(ne[4]=oe=>pe.$emit("location-click",oe)),onMapClick:A,onAreaClick:ne[5]||(ne[5]=oe=>pe.$emit("area-click",oe)),onPolygonComplete:O,onPolygonDrawing:N,onPolygonUpdate:V,onVisibilityChange:ne[6]||(ne[6]=oe=>pe.$emit("visibility-change",oe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae(af,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:j,onRedo:Q},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},ri=Ge(Z0,[["__scopeId","data-v-d6bcac0e"]]),W0={class:"course-areas-tab"},q0={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=dt(),i=e,r=o,u=M(null),d=M(null),f=M(0),p=M({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=F(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),y=({actionId:I,itemId:S})=>{I==="add"&&(S==="checkpoint"?(r("add-checkpoint-from-map"),C()):S==="many-checkpoints"?(r("add-many-checkpoints-from-map"),C()):S==="area"?(r("add-area-from-map"),C()):S==="import"?r("import-checkpoints"):S==="upload"&&r("upload-route"))},k=I=>{p.value=I},b=I=>{f.value=I?.length||0},C=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:C,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ze(()=>i.areas,I=>{if(I.length>0){const S=new Set(p.value.selectedAreaIds);I.forEach(B=>{S.has(B.id)||p.value.selectedAreaIds.push(B.id)}),p.value.selectedAreaIds=p.value.selectedAreaIds.filter(B=>I.some(R=>R.id===B))}},{immediate:!0}),Ze(()=>i.drawingMode,I=>{I||(f.value=0)}),(I,S)=>(v(),m("div",W0,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ae(ri,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:p.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${D(s).area} boundary`:D(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:S[0]||(S[0]=B=>I.$emit("map-click",B)),onLocationClick:S[1]||(S[1]=B=>I.$emit("location-click",B)),onAreaClick:S[2]||(S[2]=B=>I.$emit("area-click",B)),onPolygonComplete:S[3]||(S[3]=B=>I.$emit("polygon-complete",B)),onPolygonDrawing:b,onFilterChange:k,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},K0=Ge(q0,[["__scopeId","data-v-c0e54ae9"]]),J0=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),s=parseFloat(o),i=parseFloat(a),r=!isNaN(s)&&String(s)===o,u=!isNaN(i)&&String(i)===a;return r&&u?s-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},Y0={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:ve(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[lo(t.$slots,"default",{},void 0)],2))}},$n=Ge(Y0,[["__scopeId","data-v-a94deea5"]]),X0={class:"check-in-toggle-container"},Q0=["disabled"],ew={key:0,class:"toggle-spinner"},tw={key:1,class:"toggle-icon"},nw={class:"toggle-label"},ow={key:0,class:"check-in-details"},sw={key:0,class:"check-in-method"},aw={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,o=F(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),a=F(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),s=F(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=F(()=>{const{checkedInBy:u,checkInMethod:d,marshalName:f}=t;return u&&u!==f?u:d||""}),r=u=>u?new Date(u).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(u,d)=>(v(),m("div",X0,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=f=>u.$emit("toggle"))},[e.isLoading?(v(),m("span",ew)):e.isCheckedIn?(v(),m("span",tw,"")):E("",!0),l("span",nw,w(s.value),1)],10,Q0),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),m("span",ow,[Ye(w(r(e.checkInTime))+" ",1),i.value?(v(),m("span",sw,"("+w(i.value)+")",1)):E("",!0),o.value?(v(),m("span",{key:1,class:ve(["check-in-distance",a.value]),onClick:d[1]||(d[1]=it(f=>u.$emit("distance-click"),["stop"]))},w(o.value),3)):E("",!0)])):E("",!0)]))}},jr=Ge(aw,[["__scopeId","data-v-f08ae7ff"]]),iw={class:"confirm-modal"},lw={class:"confirm-actions"},rw={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},s=()=>{o("cancel")};return(i,r)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:it(s,["self"])},[l("div",iw,[l("h3",null,w(e.title),1),l("p",null,w(e.message),1),l("div",lw,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},w(e.cancelText),1)):E("",!0),l("button",{onClick:a,class:ve(["btn",e.isDanger?"btn-danger":"btn-primary"])},w(e.confirmText),3)])])])):E("",!0)}},$a=Ge(rw,[["__scopeId","data-v-bead7a29"]]),cw={class:"base-modal-header"},uw={class:"base-modal-header-content"},dw={key:0,class:"base-modal-title"},hw={key:0,class:"base-modal-tab-header"},fw={key:1,class:"base-modal-footer"},pw={key:0,class:"base-modal-actions"},vw={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const S=document.documentElement,B=getComputedStyle(S).getPropertyValue("--modal-resize-duration").trim();return B.endsWith("s")?parseFloat(B)*1e3:300},a=e,s=t,i=M(!1),r=M(!1),u=M(null),d=M(null);let f=null,p=!1,g=0;const y=()=>{if(!d.value||!u.value||p)return;const S=d.value.scrollHeight,B=g;if(B===S||g===0){g=S;return}p=!0,d.value.style.height=`${B}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${S}px`;const R=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),p=!1,g=S},R)},k=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),f=new MutationObserver(()=>{sn(()=>{y()})}),f.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{f&&(f.disconnect(),f=null)};tn(()=>{sn(()=>{a.show&&k()})}),yn(()=>{b()}),Ze(()=>a.show,S=>{S?sn(()=>{g=0,k()}):b()});const C=()=>{a.closeOnOverlay&&x()},x=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:s("close")},$=()=>{i.value=!1,s("close")},I=()=>{i.value=!1};return(S,B)=>(v(),qe(ys,{name:"modal",appear:""},{default:Ve(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:et({zIndex:e.zIndex}),onClick:it(C,["self"])},[l("div",{class:ve(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",cw,[l("div",uw,[lo(S.$slots,"header",{},()=>[e.title?(v(),m("h2",dw,w(e.title),1)):E("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:x,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):E("",!0)]),S.$slots["tab-header"]?(v(),m("div",hw,[lo(S.$slots,"tab-header",{},void 0,!0)])):E("",!0),l("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[l("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[lo(S.$slots,"default",{},void 0,!0)],512)],512),S.$slots.footer||S.$slots.actions?(v(),m("div",fw,[lo(S.$slots,"footer",{},()=>[S.$slots.actions?(v(),m("div",pw,[lo(S.$slots,"actions",{},void 0,!0)])):E("",!0)],!0)])):E("",!0)],2),e.confirmOnClose&&!r.value?(v(),qe($a,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:$,onCancel:I},null,8,["show"])):E("",!0)],4)):E("",!0)]),_:3}))}},jt=Ge(vw,[["__scopeId","data-v-141bdab1"]]),mw={class:"map-modal-content"},gw={class:"location-info"},yw={key:0,class:"info-row"},kw={class:"info-value"},_w={key:1,class:"info-row"},bw={class:"info-label"},ww={class:"info-value"},Cw={key:2,class:"info-row distance-row"},Lw={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=dt(),o=e,a=M(null);let s=null,i=null,r=null;const u=F(()=>t.value.checkpoint),d=F(()=>o.marshalName&&o.checkpointName?`${o.marshalName} - ${o.checkpointName}`:o.marshalName?o.marshalName:"Check-in location"),f=F(()=>o.distance===null?"":o.distance<1e3?`${Math.round(o.distance)} m`:`${(o.distance/1e3).toFixed(2)} km`),p=F(()=>o.distance===null?"":o.distance<=50?"distance-close":o.distance<=100?"distance-medium":"distance-far"),g=(C,x)=>C==null||x==null?"Unknown":`${C.toFixed(6)}, ${x.toFixed(6)}`,y=()=>{if(!a.value||s)return;let C=[51.505,-.09],x=15;o.checkInLocation&&(C=[o.checkInLocation.lat,o.checkInLocation.lng]),s=Ot.map(a.value).setView(C,x),Ot.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(s),k()},k=()=>{if(!s)return;i&&(i.remove(),i=null),r&&(r.remove(),r=null);const C=[];if(o.checkInLocation){const x=Ot.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Ot.marker([o.checkInLocation.lat,o.checkInLocation.lng],{icon:x}).addTo(s).bindPopup(`<b>${o.marshalName||"Marshal"}</b><br>Check-in location`),C.push([o.checkInLocation.lat,o.checkInLocation.lng])}if(o.checkpointLocation&&o.checkpointLocation.lat&&o.checkpointLocation.lng){const x=Ot.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${o.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});r=Ot.marker([o.checkpointLocation.lat,o.checkpointLocation.lng],{icon:x}).addTo(s).bindPopup(`<b>${o.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),C.push([o.checkpointLocation.lat,o.checkpointLocation.lng])}if(C.length===2){const x=Ot.latLngBounds(C);s.fitBounds(x,{padding:[50,50],maxZoom:17})}else C.length===1&&s.setView(C[0],16)},b=()=>{s&&(s.remove(),s=null,i=null,r=null)};return Ze(()=>o.show,async C=>{C?(await sn(),setTimeout(()=>{y()},100)):b()}),Ze([()=>o.checkInLocation,()=>o.checkpointLocation],()=>{s&&k()},{deep:!0}),tn(()=>{o.show&&sn(()=>{setTimeout(()=>{y()},100)})}),yn(()=>{b()}),(C,x)=>(v(),qe(jt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:x[0]||(x[0]=$=>C.$emit("close"))},{default:Ve(()=>[l("div",mw,[l("div",{class:"map-container",ref_key:"mapContainer",ref:a},null,512),l("div",gw,[e.checkInLocation?(v(),m("div",yw,[x[1]||(x[1]=l("span",{class:"info-label"},"Check-in location:",-1)),l("span",kw,w(g(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):E("",!0),e.checkpointLocation?(v(),m("div",_w,[l("span",bw,w(u.value)+" location:",1),l("span",ww,w(g(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):E("",!0),e.distance!==null?(v(),m("div",Cw,[x[2]||(x[2]=l("span",{class:"info-label"},"Distance:",-1)),l("span",{class:ve(["info-value distance-value",p.value])},w(f.value),3)])):E("",!0)])])]),_:1},8,["show","title","z-index"]))}},id=Ge(Lw,[["__scopeId","data-v-011fa479"]]),Sw={class:"marshals-tab"},xw={class:"tab-header"},Iw={class:"button-group"},$w={key:0,class:"status-pills"},Tw={class:"filters-section"},Mw={class:"search-group"},Aw={class:"marshals-grid"},Ew={class:"marshals-table"},Pw={key:0,class:"sort-indicator"},Dw={key:0,class:"sort-indicator"},Ow={key:0,class:"sort-indicator"},Rw={key:0,class:"sort-indicator"},Bw=["onClick"],Nw=["rowspan"],Fw={class:"checkpoint-cell"},Uw={class:"checkpoint-name"},zw={key:0,class:"checkpoint-description"},Hw=["rowspan"],Vw={key:0,class:"last-active-text"},Gw={key:1,class:"last-active-never"},jw=["onClick"],Zw={class:"no-checkpoint-text"},Ww={class:"hide-on-mobile last-active-cell"},qw={key:0,class:"last-active-text"},Kw={key:1,class:"last-active-never"},Jw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=dt(),s=e,i=o,r=M(null),u=M(!1),d=M(null),f=ee=>{r.value=ee},p=ee=>{d.value=ee,u.value=!0},g=()=>{u.value=!1,d.value=null},y=F(()=>d.value?Re(d.value.marshalId):""),k=F(()=>d.value?de(d.value.locationId):""),b=F(()=>{if(!d.value)return null;const{checkInLatitude:ee,checkInLongitude:ye}=d.value;return!ee||!ye?null:{lat:ee,lng:ye}}),C=F(()=>{if(!d.value)return null;const ee=Y(d.value.locationId);return!ee?.latitude||!ee?.longitude?null:{lat:ee.latitude,lng:ee.longitude}}),x=F(()=>d.value?Xe(d.value):null),$=M(!1),I=M(null),S=ee=>{ee.isCheckedIn?(I.value=ee,$.value=!0):i("toggle-check-in",ee)},B=()=>{I.value&&i("toggle-check-in",I.value),$.value=!1,I.value=null},R=()=>{$.value=!1,I.value=null},Z=F(()=>I.value?`Are you sure you want to undo ${Re(I.value.marshalId)}'s check-in?`:"");t({setCheckingIn:f});const A=M("name"),N=M("asc"),O=M(""),V=M("all"),P=ee=>{V.value=ee},j=ee=>{A.value===ee?N.value=N.value==="asc"?"desc":"asc":(A.value=ee,N.value="asc")},Q=ee=>s.assignments.filter(ye=>ye.marshalId===ee),ae=F(()=>new Set(s.assignments.filter(ee=>ee.isCheckedIn).map(ee=>ee.marshalId))),pe=F(()=>new Set(s.assignments.map(ee=>ee.marshalId))),ne=F(()=>ae.value.size),oe=F(()=>s.marshals.filter(ee=>!pe.value.has(ee.id)).length),U=F(()=>s.marshals.filter(ee=>pe.value.has(ee.id)&&!ae.value.has(ee.id)).length),Y=ee=>s.locations.find(ye=>ye.id===ee),de=ee=>{const ye=Y(ee);return ye?ye.name:"Unknown"},ke=ee=>{const ye=Y(ee);return ye?ye.description:""},Re=ee=>{const ye=s.marshals.find(te=>te.id===ee);return ye?ye.name:""},Xe=ee=>{const{checkInLatitude:ye,checkInLongitude:te,locationId:ge}=ee,he=Y(ge);return!ye||!te||!he?.latitude||!he?.longitude?null:li(ye,te,he.latitude,he.longitude)},Ne=ee=>{if(!ee)return"";const ye=new Date(ee),ge=new Date-ye,he=Math.floor(ge/6e4),G=Math.floor(he/60),J=Math.floor(G/24);return he<1?"just now":he<60?`${he}m ago`:G<24?`${G}h ago`:J===1?"yesterday":J<7?`${J}d ago`:ye.toLocaleDateString()},ze=F(()=>{let ee=s.marshals;if(V.value==="unassigned"?ee=ee.filter(ye=>!pe.value.has(ye.id)):V.value==="checked-in"?ee=ee.filter(ye=>ae.value.has(ye.id)):V.value==="not-checked-in"&&(ee=ee.filter(ye=>pe.value.has(ye.id)&&!ae.value.has(ye.id))),O.value.trim()){const ye=O.value.toLowerCase().trim().split(/\s+/);ee=ee.filter(te=>{const he=Q(te.id).map(J=>{const ce=Y(J.locationId);return ce?`${ce.name||""} ${ce.description||""}`:""}).join(" "),G=`${te.name} ${he}`.toLowerCase();return ye.every(J=>G.includes(J))})}return ee}),We=F(()=>{const ee=[...ze.value];return ee.sort((ye,te)=>{let ge=0;if(A.value==="name")ge=ye.name.localeCompare(te.name);else if(A.value==="checkpoint"){const he=Q(ye.id),G=Q(te.id),J=he.length>0?de(he[0].locationId):"",ce=G.length>0?de(G[0].locationId):"";ge=J0(J,ce)}else if(A.value==="status"){const he=Q(ye.id),G=Q(te.id),J=he.length>0&&he[0].isCheckedIn?1:0;ge=(G.length>0&&G[0].isCheckedIn?1:0)-J}else if(A.value==="lastActive"){const he=ye.lastAccessedDate?new Date(ye.lastAccessedDate).getTime():0;ge=(te.lastAccessedDate?new Date(te.lastAccessedDate).getTime():0)-he}return N.value==="asc"?ge:-ge}),ee});return(ee,ye)=>(v(),m("div",Sw,[l("div",xw,[l("div",Iw,[l("button",{onClick:ye[0]||(ye[0]=te=>ee.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(D(a).person.toLowerCase()),1),l("button",{onClick:ye[1]||(ye[1]=te=>ee.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",$w,[Ae($n,{variant:"neutral",active:V.value==="all",onClick:ye[2]||(ye[2]=te=>P("all"))},{default:Ve(()=>[Ye(w(e.marshals.length)+" total ",1)]),_:1},8,["active"]),oe.value>0?(v(),qe($n,{key:0,variant:"warning",active:V.value==="unassigned",onClick:ye[3]||(ye[3]=te=>P("unassigned"))},{default:Ve(()=>[Ye(w(oe.value)+" unassigned ",1)]),_:1},8,["active"])):E("",!0),ne.value>0?(v(),qe($n,{key:1,variant:"success",active:V.value==="checked-in",onClick:ye[4]||(ye[4]=te=>P("checked-in"))},{default:Ve(()=>[Ye(w(ne.value)+" checked in ",1)]),_:1},8,["active"])):E("",!0),U.value>0?(v(),qe($n,{key:2,variant:"danger",active:V.value==="not-checked-in",onClick:ye[5]||(ye[5]=te=>P("not-checked-in"))},{default:Ve(()=>[Ye(w(U.value)+" not checked in ",1)]),_:1},8,["active"])):E("",!0)])):E("",!0)]),l("div",Tw,[l("div",Mw,[Ue(l("input",{"onUpdate:modelValue":ye[6]||(ye[6]=te=>O.value=te),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[at,O.value]])])]),l("div",Aw,[l("table",Ew,[l("thead",null,[l("tr",null,[l("th",{onClick:ye[7]||(ye[7]=te=>j("name")),class:"sortable"},[ye[12]||(ye[12]=Ye(" Name ",-1)),A.value==="name"?(v(),m("span",Pw,w(N.value==="asc"?"":""),1)):E("",!0)]),l("th",{onClick:ye[8]||(ye[8]=te=>j("checkpoint")),class:"sortable"},[Ye(w(D(a).checkpoint)+" ",1),A.value==="checkpoint"?(v(),m("span",Dw,w(N.value==="asc"?"":""),1)):E("",!0)]),l("th",{onClick:ye[9]||(ye[9]=te=>j("status")),class:"sortable"},[ye[13]||(ye[13]=Ye(" Status ",-1)),A.value==="status"?(v(),m("span",Ow,w(N.value==="asc"?"":""),1)):E("",!0)]),l("th",{onClick:ye[10]||(ye[10]=te=>j("lastActive")),class:"sortable hide-on-mobile"},[ye[14]||(ye[14]=Ye(" Last active ",-1)),A.value==="lastActive"?(v(),m("span",Rw,w(N.value==="asc"?"":""),1)):E("",!0)])])]),l("tbody",null,[(v(!0),m(Ie,null,Fe(We.value,te=>(v(),m(Ie,{key:te.id},[Q(te.id).length>0?(v(!0),m(Ie,{key:0},Fe(Q(te.id),(ge,he)=>(v(),m("tr",{key:`${te.id}-${ge.id}`,class:"marshal-row",onClick:G=>ee.$emit("select-marshal",te)},[he===0?(v(),m("td",{key:0,rowspan:Q(te.id).length},w(te.name),9,Nw)):E("",!0),l("td",Fw,[l("div",Uw,w(de(ge.locationId)),1),ke(ge.locationId)?(v(),m("div",zw,w(ke(ge.locationId)),1)):E("",!0)]),l("td",{onClick:ye[11]||(ye[11]=it(()=>{},["stop"])),class:"check-in-cell"},[Ae(jr,{"is-checked-in":ge.isCheckedIn,"check-in-time":ge.checkInTime,"check-in-method":ge.checkInMethod,"checked-in-by":ge.checkedInBy,"marshal-name":Re(ge.marshalId),"is-loading":r.value===ge.id,distance:Xe(ge),onToggle:G=>S(ge),onDistanceClick:G=>p(ge)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),he===0?(v(),m("td",{key:1,rowspan:Q(te.id).length,class:"hide-on-mobile last-active-cell"},[te.lastAccessedDate?(v(),m("span",Vw,w(Ne(te.lastAccessedDate)),1)):(v(),m("span",Gw,"Never"))],8,Hw)):E("",!0)],8,Bw))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:ge=>ee.$emit("select-marshal",te)},[l("td",null,w(te.name),1),l("td",Zw,"No "+w(D(a).checkpoint.toLowerCase())+" assigned",1),ye[15]||(ye[15]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),l("td",Ww,[te.lastAccessedDate?(v(),m("span",qw,w(Ne(te.lastAccessedDate)),1)):(v(),m("span",Kw,"Never"))])],8,jw))],64))),128))])])]),Ae(id,{show:u.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":b.value,"checkpoint-location":C.value,distance:x.value,onClose:g},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Ae($a,{show:$.value,title:"Confirm check-out",message:Z.value,"confirm-text":"Check out","is-danger":!0,onConfirm:B,onCancel:R},null,8,["show","message"])]))}},Yw=Ge(Jw,[["__scopeId","data-v-f74695a8"]]),Xw={class:"checklists-tab"},Qw={class:"checklists-tab-header"},eC={class:"button-group"},tC={class:"filters-section"},nC={class:"search-group"},oC=["placeholder"],sC={class:"checklist-items-list"},aC={key:0,class:"empty-state"},iC={class:"checklist-item-content"},lC=["onClick"],rC={class:"checklist-item-scopes"},cC=["onClick"],uC={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=M(""),r=F(()=>{if(!i.value.trim())return s.checklistItems;const p=i.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const y=(g.text||"").toLowerCase();return p.every(k=>y.includes(k))})}),u=F(()=>[...r.value].sort((p,g)=>p.displayOrder!==g.displayOrder?p.displayOrder-g.displayOrder:js(p.text,g.text))),d=p=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,OnePerArea:`One per ${a.value.area}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryAreaLead:`Every ${a.value.area} lead`,OneLeadPerArea:`One lead per ${a.value.area}`,AreaLead:`${o.value.area} lead`})[p]||p,f=p=>{if(!p)return"";const g=d(p.scope);if(p.itemType===null)return g;const y=p.ids||[];if(y.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(y.includes("ALL_AREAS"))return`${g} (All ${a.value.areas})`;if(y.includes("ALL_CHECKPOINTS"))return`${g} (All ${a.value.checkpoints})`;const k=y.length;return k===0?g:`${g} (${k})`};return(p,g)=>(v(),m("div",Xw,[l("div",Qw,[l("div",eC,[l("button",{onClick:g[0]||(g[0]=y=>p.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(D(a).checklist),1)])]),l("div",tC,[l("div",nC,[Ue(l("input",{"onUpdate:modelValue":g[1]||(g[1]=y=>i.value=y),type:"text",class:"search-input",placeholder:`Search ${D(a).checklists}...`},null,8,oC),[[at,i.value]])])]),l("div",sC,[r.value.length===0?(v(),m("div",aC,[l("p",null,w(i.value?`No ${D(a).checklists} match your search.`:`No ${D(a).checklists} yet. Create one to get started!`),1)])):E("",!0),(v(!0),m(Ie,null,Fe(u.value,y=>(v(),m("div",{key:y.itemId,class:"checklist-item-card"},[l("div",iC,[l("div",{class:"checklist-item-title",onClick:k=>p.$emit("select-checklist-item",y,"details")},[l("strong",null,w(y.text),1)],8,lC),l("div",rC,[(v(!0),m(Ie,null,Fe(y.scopeConfigurations,(k,b)=>(v(),m("span",{key:b,class:"scope-badge",onClick:C=>p.$emit("select-checklist-item",y,"visibility")},w(f(k)),9,cC))),128))])])]))),128))])]))}},dC=Ge(uC,[["__scopeId","data-v-123b7338"]]),hC={class:"notes-tab"},fC={class:"tab-header"},pC={class:"button-group"},vC={class:"filters-section"},mC={class:"search-group"},gC={class:"notes-list"},yC={key:0,class:"empty-state"},kC=["onClick"],_C={class:"note-header"},bC={class:"note-title-row"},wC={key:0,class:"pin-icon",title:"Pinned"},CC={key:1,class:"emergency-indicator",title:"Shown in emergency info"},LC={class:"note-meta"},SC={key:0,class:"category-badge"},xC={class:"created-info"},IC={key:0,class:"note-preview"},$C={class:"note-scopes"},TC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=M(""),i=F(()=>{if(!s.value.trim())return a.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return a.notes.filter(y=>{const k=`${y.title||""} ${y.content||""} ${y.priority||""}`.toLowerCase();return g.every(b=>k.includes(b))})}),r=F(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((y,k)=>{if(y.isPinned!==k.isPinned)return y.isPinned?-1:1;const b=g[y.priority]??2,C=g[k.priority]??2;return b!==C?b-C:y.displayOrder!==k.displayOrder?y.displayOrder-k.displayOrder:js(y.title,k.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const y=u(g.scope);if(g.itemType===null)return y;const k=g.ids||[];if(k.includes("ALL_MARSHALS"))return`${y} (Everyone)`;if(k.includes("ALL_AREAS"))return`${y} (All ${o.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${y} (All ${o.value.checkpoints})`;const b=k.length;return b===0?y:`${y} (${b})`},f=g=>{if(!g)return"";const y=150;return g.length<=y?g:g.substring(0,y)+"..."},p=g=>{if(!g)return"";const y=new Date(g),b=new Date-y,C=Math.floor(b/6e4),x=Math.floor(b/36e5),$=Math.floor(b/864e5);return C<1?"Just now":C<60?`${C}m ago`:x<24?`${x}h ago`:$<7?`${$}d ago`:y.toLocaleDateString()};return(g,y)=>(v(),m("div",hC,[l("div",fC,[l("div",pC,[l("button",{onClick:y[0]||(y[0]=k=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",vC,[l("div",mC,[Ue(l("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>s.value=k),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[at,s.value]])])]),l("div",gC,[i.value.length===0?(v(),m("div",yC,[l("p",null,w(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):E("",!0),(v(!0),m(Ie,null,Fe(r.value,k=>(v(),m("div",{key:k.noteId,class:ve(["note-card",{pinned:k.isPinned}]),onClick:b=>g.$emit("select-note",k)},[l("div",_C,[l("div",bC,[k.isPinned?(v(),m("span",wC,"")):E("",!0),l("span",{class:ve(["priority-indicator",k.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,w(k.title),1),k.showInEmergencyInfo?(v(),m("span",CC,"")):E("",!0)]),l("div",LC,[k.category?(v(),m("span",SC,w(k.category),1)):E("",!0),l("span",xC,w(p(k.createdAt)),1)])]),k.content?(v(),m("div",IC,w(f(k.content)),1)):E("",!0),l("div",$C,[(v(!0),m(Ie,null,Fe(k.scopeConfigurations,(b,C)=>(v(),m("span",{key:C,class:"scope-badge"},w(d(b)),1))),128))])],10,kC))),128))])]))}},MC=Ge(TC,[["__scopeId","data-v-071c9763"]]),AC={key:0,class:"empty-state"},EC={key:0,class:"empty-hint"},PC={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",AC,[l("p",null,w(e.emptyMessage),1),e.emptyHint?(v(),m("p",EC,w(e.emptyHint),1)):E("",!0)])):(v(),m("div",{key:1,class:ve(["cards-grid",e.gridClass])},[lo(t.$slots,"default",{},void 0)],2))}},Jl=Ge(PC,[["__scopeId","data-v-a842b7b1"]]),DC={class:"contact-card-header"},OC={class:"contact-name-row"},RC={key:0,class:"pin-icon",title:"Pinned"},BC={key:1,class:"primary-badge",title:"Primary contact"},NC={class:"contact-name"},FC={key:0,class:"contact-role"},UC={key:0,class:"emergency-indicator",title:"Shown in emergency info"},zC={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},HC=["title"],VC={key:0,class:"contact-card-details"},GC={key:0,class:"contact-phone"},jC={key:1,class:"contact-email"},ZC={key:1,class:"contact-card-notes"},WC={key:2,class:"contact-card-scopes"},qC={key:3,class:"contact-card-badge"},KC={key:4,class:"contact-card-badge"},JC={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=t,r=F(()=>{const y=s.contact.scopeConfigurations;return!y||y.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&i("click",s.contact)},d=y=>y?y==="AreaLead"?`${o.value.area} Lead`:y.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim():"",f=y=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,EveryAreaLead:`Every ${a.value.area} lead`})[y]||y,p=y=>{if(!y)return"";const k=f(y.scope);if(y.itemType===null)return k;const b=y.ids||[];if(b.includes("ALL_MARSHALS"))return`${k} (Everyone)`;if(b.includes("ALL_AREAS"))return`${k} (All ${a.value.areas})`;if(b.includes("ALL_CHECKPOINTS"))return`${k} (All ${a.value.checkpoints})`;const C=b.length;return C===0?k:`${k} (${C})`},g=y=>{if(!y)return"";const k=100;return y.length<=k?y:y.substring(0,k)+"..."};return(y,k)=>(v(),m("div",{class:ve(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[l("div",DC,[l("div",{class:ve(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[l("div",OC,[e.contact.isPinned&&!e.isMarkedForRemoval?(v(),m("span",RC,"")):E("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",BC,"")):E("",!0),l("span",NC,w(e.contact.name),1)]),e.contact.role?(v(),m("span",FC,w(d(e.contact.role)),1)):E("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(v(),m("span",UC,"")):E("",!0),r.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",zC,"!")):E("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:k[0]||(k[0]=it(b=>y.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,HC)):E("",!0),e.isMarkedForRemoval?(v(),m("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:k[1]||(k[1]=it(b=>y.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):E("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",VC,[e.contact.phone?(v(),m("span",GC,w(e.contact.phone),1)):E("",!0),e.contact.email?(v(),m("span",jC,w(e.contact.email),1)):E("",!0)])):E("",!0),e.contact.notes&&e.showNotes?(v(),m("div",ZC,w(g(e.contact.notes)),1)):E("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),m("div",WC,[(v(!0),m(Ie,null,Fe(e.contact.scopeConfigurations,(b,C)=>(v(),m("span",{key:C,class:"scope-badge"},w(p(b)),1))),128))])):E("",!0),e.isPending?(v(),m("div",qC,[...k[2]||(k[2]=[l("span",{class:"pending-indicator"},"Will be added on save",-1)])])):E("",!0),e.isMarkedForRemoval?(v(),m("div",KC,[...k[3]||(k[3]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):E("",!0)],2))}},YC=Ge(JC,[["__scopeId","data-v-e962ffff"]]),qv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,a=s=>!s.isPending;return(s,i)=>(v(),qe(Jl,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(v(!0),m(Ie,null,Fe(e.contacts,r=>(v(),qe(YC,{key:r.contactId,contact:r,"is-pending":r.isPending,"is-marked-for-removal":r.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(r),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(r),onClick:u=>s.$emit("select",r),onRemove:i[0]||(i[0]=u=>s.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},XC={class:"contacts-tab"},QC={class:"tab-header"},e2={class:"button-group"},t2={key:0,class:"status-pills"},n2={class:"filters-section"},o2={class:"search-group"},s2={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=M(""),s=M("all"),i=F(()=>o.contacts.filter(k=>!k.scopeConfigurations||k.scopeConfigurations.length===0).length),r=F(()=>o.contacts.filter(k=>k.scopeConfigurations&&k.scopeConfigurations.length>0).length),u=k=>{s.value=k},d=k=>k?k.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=k=>k?k.replace(/([A-Z])/g," $1").replace(/^./,b=>b.toUpperCase()).trim():"",p=F(()=>{let k=o.contacts;if(s.value==="no-scope"?k=k.filter(b=>!b.scopeConfigurations||b.scopeConfigurations.length===0):s.value==="with-scope"&&(k=k.filter(b=>b.scopeConfigurations&&b.scopeConfigurations.length>0)),a.value.trim()){const C=d(a.value).split(" ").filter(x=>x.length>0);k=k.filter(x=>{const $=f(x.role),I=d(`${x.name||""} ${$} ${x.email||""} ${x.phone||""}`);return C.every(S=>I.includes(S))})}return k}),g=F(()=>[...p.value].sort((k,b)=>{if(k.isPinned!==b.isPinned)return k.isPinned?-1:1;const C=k.displayOrder||0,x=b.displayOrder||0;return C!==x?C-x:(k.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"})})),y=F(()=>{const k=a.value.trim();return s.value==="no-scope"?k?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?k?"No assigned contacts match your search.":"No contacts are assigned yet.":k?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(k,b)=>(v(),m("div",XC,[l("div",QC,[l("div",e2,[l("button",{onClick:b[0]||(b[0]=C=>k.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",t2,[Ae($n,{variant:"neutral",active:s.value==="all",onClick:b[1]||(b[1]=C=>u("all"))},{default:Ve(()=>[Ye(w(e.contacts.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe($n,{key:0,variant:"success",active:s.value==="with-scope",onClick:b[2]||(b[2]=C=>u("with-scope"))},{default:Ve(()=>[Ye(w(r.value)+" assigned ",1)]),_:1},8,["active"])):E("",!0),i.value>0?(v(),qe($n,{key:1,variant:"danger",active:s.value==="no-scope",onClick:b[3]||(b[3]=C=>u("no-scope"))},{default:Ve(()=>[Ye(w(i.value)+" unassigned ",1)]),_:1},8,["active"])):E("",!0)])):E("",!0)]),l("div",n2,[l("div",o2,[Ue(l("input",{"onUpdate:modelValue":b[4]||(b[4]=C=>a.value=C),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[at,a.value]])])]),Ae(qv,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":y.value,onSelect:b[5]||(b[5]=C=>k.$emit("select-contact",C))},null,8,["contacts","empty-message"])]))}},a2=Ge(s2,[["__scopeId","data-v-ec977e71"]]),Kv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],i2={class:"event-details-tab"},l2={class:"event-info-card"},r2={class:"form-group"},c2={class:"form-group"},u2={class:"form-row"},d2={class:"form-group"},h2={class:"form-group"},f2=["value"],p2={class:"form-actions"},v2=["disabled"],m2={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,s=M({...o.eventData});Ze(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},r=()=>{a("submit",{...s.value})};return(u,d)=>(v(),m("div",i2,[l("div",l2,[l("form",{onSubmit:it(r,["prevent"]),class:"event-details-form"},[l("div",r2,[d[4]||(d[4]=l("label",null,"Event name",-1)),Ue(l("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",onInput:i},null,544),[[at,s.value.name]])]),l("div",c2,[d[5]||(d[5]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=f=>s.value.description=f),rows:"3",class:"form-input",onInput:i},null,544),[[at,s.value.description]])]),l("div",u2,[l("div",d2,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),Ue(l("input",{"onUpdate:modelValue":d[2]||(d[2]=f=>s.value.eventDate=f),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[at,s.value.eventDate]])]),l("div",h2,[d[7]||(d[7]=l("label",null,"Time zone",-1)),Ue(l("select",{"onUpdate:modelValue":d[3]||(d[3]=f=>s.value.timeZoneId=f),required:"",class:"form-input",onChange:i},[(v(!0),m(Ie,null,Fe(D(Kv),f=>(v(),m("option",{key:f.value,value:f.value},w(f.label),9,f2))),128))],544),[[Nn,s.value.timeZoneId]])])]),l("div",p2,[l("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,v2)])],32)])]))}},g2=Ge(m2,[["__scopeId","data-v-2754c3cc"]]),y2={class:"admins-list"},k2={class:"admin-info"},_2={class:"admin-role"},b2=["onClick"],w2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[l("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",y2,[(v(!0),m(Ie,null,Fe(e.admins,a=>(v(),m("div",{key:a.userEmail,class:"admin-item"},[l("div",k2,[l("strong",null,w(a.userEmail),1),l("span",_2,w(a.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,b2)):E("",!0)]))),128))])]))}},C2=Ge(w2,[["__scopeId","data-v-e526860b"]]),En=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Sr="#667eea";function L2(e){const t=e.map(a=>a.color);return En.find(a=>!t.includes(a.hex))?.hex||Sr}const S2={class:"modal-content"},x2={class:"modal-body"},I2={class:"preview-section"},$2={class:"map-preview"},T2=["innerHTML"],M2={class:"options-grid"},A2={class:"option-button-content"},E2={class:"option-button-value icon-value"},P2=["innerHTML"],D2={class:"option-button-content"},O2={class:"option-button-value color-value"},R2=["disabled"],B2={class:"option-button-content"},N2={class:"option-button-value color-value"},F2={class:"option-button-content"},U2={class:"option-button-value icon-value"},z2=["innerHTML"],H2=["disabled"],V2={class:"option-button-content"},G2={class:"option-button-value color-value"},j2={class:"option-button-content"},Z2={class:"option-button-value"},W2={class:"option-button-content"},q2={class:"option-button-value"},K2={key:0,class:"centered-popup"},J2={class:"popup-grid"},Y2=["onClick"],X2=["innerHTML"],Q2={key:0},eL={key:1,class:"centered-popup"},tL={class:"popup-grid"},nL=["title","onClick"],oL=["innerHTML"],sL={key:0},aL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},iL={key:1,class:"custom-check-mark"},lL={key:0,class:"custom-hex-input"},rL={class:"hex-input-row"},cL=["disabled"],uL={key:0,class:"hex-error"},dL={key:2,class:"centered-popup"},hL={class:"popup-grid"},fL=["title","onClick"],pL=["innerHTML"],vL={key:0},mL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},gL={key:1,class:"custom-check-mark"},yL={key:0,class:"custom-hex-input"},kL={class:"hex-input-row"},_L=["disabled"],bL={key:0,class:"hex-error"},wL={key:3,class:"centered-popup icon-popup"},CL={class:"popup-grid"},LL=["onClick"],SL=["innerHTML"],xL={key:0},IL={key:4,class:"centered-popup"},$L={class:"popup-grid"},TL=["title","onClick"],ML=["innerHTML"],AL={key:0},EL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},PL={key:1,class:"custom-check-mark"},DL={key:0,class:"custom-hex-input"},OL={class:"hex-input-row"},RL=["disabled"],BL={key:0,class:"hex-error"},NL={key:5,class:"centered-popup"},FL={class:"size-grid"},UL=["onClick"],zL=["innerHTML"],HL={key:6,class:"centered-popup"},VL={class:"rotation-content"},GL={class:"rotation-preview-container"},jL=["innerHTML"],ZL={class:"rotation-control"},WL={class:"rotation-slider-container"},qL=["value"],KL={class:"rotation-value"},JL={class:"rotation-presets"},YL="#667eea",XL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,s=M(o.backgroundShape||"circle"),i=M(o.iconType||"none"),r=M(o.backgroundColor||""),u=M(o.borderColor||""),d=M(o.iconColor||""),f=M(o.size||"100"),p=M(o.mapRotation??""),g=M(null),y=M(!1),k=M(!1),b=M(!1),C=M(""),x=M(""),$=M(""),I=M(null),S=M(null),B=M(null),R=re=>re==="default"?o.inheritedBackgroundShape||"circle":re==="none"?"none":re||"circle",Z=re=>re==="default"||!re?U():re==="none"?"transparent":re,A=re=>re==="default"?o.inheritedBorderColor||"#ffffff":re==="none"||!re?"transparent":re,N=re=>{if(re==="default"){const ue=o.inheritedType;return ue&&ue!=="default"&&oi(ue).category==="content"?ue:"none"}return re==="none"||!re?"none":re},O=re=>re==="default"||!re?o.inheritedIconColor||"#ffffff":re==="none"?"transparent":re,V=re=>re==="default"?o.inheritedSize||"100":re||"100",P=re=>{if(re==="default"||re===""){const ue=o.inheritedMapRotation;return ue!==""&&ue!==void 0&&ue!==null&&parseInt(ue,10)||0}return parseInt(re,10)||0},j=F(()=>{const re=o.inheritedBackgroundShape||"circle",ue=vr.find(me=>me.value===re)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ue})`,showLabel:!0},...vr.filter(me=>me.value!=="none").map(me=>({...me,showLabel:!1}))]}),Q=F(()=>{const re=Gr.filter(st=>st.category==="content"),ue=[{value:"none",label:"None",category:"content",showLabel:!0}],me=o.inheritedType;if(me&&me!=="default"){const st=oi(me);st.category==="content"&&ue.push({value:"default",label:`Default (${st.label||me})`,category:"content",showLabel:!0})}return ue.push(...re.map(st=>({...st,showLabel:!1}))),ue}),ae=F(()=>{const re={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${re[o.inheritedSize]||"Normal"})`},...Hb.map(me=>({value:me.value,label:re[me.value]||me.label}))]}),pe=F(()=>R(s.value)!=="none"),ne=F(()=>N(i.value)!=="none"),oe=F(()=>{const re=o.inheritedBackgroundColor;return re&&re!=="default"&&re.startsWith("#")?re:YL}),U=()=>oe.value,Y=F(()=>r.value&&r.value!=="default"?r.value:U()),de=F(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),ke=F(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Re=F(()=>{const re=oe.value,ue=En.find(me=>me.hex.toLowerCase()===re.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},...En.map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),Xe=F(()=>{const re=o.inheritedBorderColor||"#ffffff",ue=re==="#ffffff"?"White":En.find(me=>me.hex===re)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...En.filter(me=>me.hex!=="#ffffff").map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),Ne=F(()=>{const re=o.inheritedIconColor||"#ffffff",ue=re==="#ffffff"?"White":En.find(me=>me.hex===re)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...En.filter(me=>me.hex!=="#ffffff").map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),ze=re=>re==="default"?!r.value||r.value==="default":r.value===re,We=re=>re==="#ffffff"?!d.value||d.value==="#ffffff":d.value===re,ee=F(()=>{const re=r.value;return!re||re==="default"||re==="none"?!1:!En.some(ue=>ue.hex.toLowerCase()===re.toLowerCase())}),ye=F(()=>{const re=u.value;return!re||re==="default"||re==="none"||re==="#ffffff"||re==="#000000"?!1:!En.some(ue=>ue.hex.toLowerCase()===re.toLowerCase())}),te=F(()=>{const re=d.value;return!re||re==="default"||re==="none"||re==="#ffffff"||re==="#000000"?!1:!En.some(ue=>ue.hex.toLowerCase()===re.toLowerCase())}),ge=F(()=>{if(!C.value)return!1;const re=C.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(re)||/^[0-9A-Fa-f]{3}$/.test(re)}),he=F(()=>{if(!x.value)return!1;const re=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(re)||/^[0-9A-Fa-f]{3}$/.test(re)}),G=F(()=>{if(!$.value)return!1;const re=$.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(re)||/^[0-9A-Fa-f]{3}$/.test(re)}),J=re=>{if(re==="none")return"None";if(re==="default"){const me=o.inheritedBackgroundShape;return me?`Default (${vr.find(je=>je.value===me)?.label||"Circle"})`:"Default (Circle)"}const ue=vr.find(me=>me.value===re);return ue?ue.label:"Circle"},ce=re=>{if(re==="none")return"None";if(re==="default"){const me=o.inheritedType;if(me&&me!=="default"){const st=oi(me);if(st.category==="content")return`Default (${st.label||me})`}return"Default"}const ue=Gr.find(me=>me.value===re);return ue?ue.label:"None"},Me=re=>{if(re==="none")return"None";if(!re||re==="default"){const me=oe.value;return`Default (${En.find(je=>je.hex.toLowerCase()===me.toLowerCase())?.name||"Custom"})`}const ue=[...En].find(me=>me.hex.toLowerCase()===re.toLowerCase());return ue?ue.name:re},Be=re=>{if(re==="none")return"None";if(re==="default"){const me=o.inheritedBorderColor;return me&&me!=="none"?`Default (${me==="#ffffff"?"White":En.find(je=>je.hex===me)?.name||"Custom"})`:"Default (White)"}if(!re||re==="#ffffff")return"White";const ue=[...Xe.value].find(me=>me.hex===re);return ue?ue.name:re},De=re=>{if(re==="none")return"None";if(re==="default"){const me=o.inheritedIconColor;return me?`Default (${me==="#ffffff"?"White":En.find(je=>je.hex===me)?.name||"Custom"})`:"Default (White)"}if(!re||re==="#ffffff")return"White";const ue=[...Ne.value].find(me=>me.hex===re);return ue?ue.name:re},Le=re=>{const ue={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(re==="default"){const me=o.inheritedSize;return`Default (${ue[me]||"Normal"})`}return ue[re]||"Normal"},X=re=>{if(re==="default"||re===""||re===void 0||re===null){const ue=o.inheritedMapRotation;return ue!==""&&ue!==void 0&&ue!==null?`Default (${ue})`:"Default (0)"}return`${re}`},fe=re=>{if(re==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ue=R(re),me=Z(r.value),st=A(u.value);return Pi[ue]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Pi[ue]({backgroundColor:me,borderColor:st==="transparent"?"none":st})}</svg>`:""},xe=re=>{const ue=N(re);return ue==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:In({type:ue,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Se=re=>{const ue=R(re);if(ue==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const me=Z(r.value),st=A(u.value),je=N(i.value),$t=O(d.value);return In({type:je!=="none"?je:ue,backgroundShape:ue,backgroundColor:me,borderColor:st==="transparent"?"none":st,iconColor:$t,size:"100",outputSize:28})},_e=re=>{const ue=Z(re),me=R(s.value),st=A(u.value),je=N(i.value),$t=O(d.value);return me==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ue==="transparent"?"#e2e8f0":ue}"/>
    </svg>`:In({type:je!=="none"?je:me,backgroundShape:me,backgroundColor:ue==="transparent"?"#e2e8f0":ue,borderColor:st==="transparent"?"none":st,iconColor:$t,size:"100",outputSize:28})},W=re=>{const ue=A(re),me=R(s.value),st=Z(r.value),je=N(i.value),$t=O(d.value);return me==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ue}" stroke-width="2"/>
    </svg>`:In({type:je!=="none"?je:me,backgroundShape:me,backgroundColor:st,borderColor:ue==="transparent"?"none":ue,iconColor:$t,size:"100",outputSize:28})},q=re=>{const ue=N(re),me=R(s.value),st=Z(r.value),je=A(u.value),$t=O(d.value);if(ue==="none"&&me==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const Yt=me!=="none"?me:"circle";return In({type:ue!=="none"?ue:Yt,backgroundShape:Yt,backgroundColor:st,borderColor:je==="transparent"?"none":je,iconColor:$t,size:"100",outputSize:42})},K=re=>{const ue=O(re),me=R(s.value),st=Z(r.value),je=A(u.value),$t=N(i.value);return $t==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ue==="transparent"?"#e2e8f0":ue}"/>
    </svg>`:In({type:$t,backgroundShape:me!=="none"?me:"circle",backgroundColor:st,borderColor:je==="transparent"?"none":je,iconColor:ue==="transparent"?"#e2e8f0":ue,size:"100",outputSize:28})},le=re=>{const ue=V(re),me=R(s.value),st=Z(r.value),je=A(u.value),$t=N(i.value),Yt=O(d.value);if(me==="none"&&$t==="none")return"";const nn=me!=="none"?me:"circle";return In({type:$t!=="none"?$t:nn,backgroundShape:nn,backgroundColor:st,borderColor:je==="transparent"?"none":je,iconColor:Yt,size:ue})},Ee=F(()=>{const re=R(s.value),ue=Z(r.value),me=A(u.value),st=N(i.value),je=O(d.value),$t=V(f.value);return re==="none"&&st==="none"?"":In(re==="none"&&st!=="none"?{type:st,backgroundShape:"none",backgroundColor:ue,borderColor:"none",iconColor:je,size:$t}:{type:st!=="none"?st:re,backgroundShape:re,backgroundColor:ue,borderColor:me==="transparent"?"none":me,iconColor:je,size:$t})}),Ke=re=>{g.value=g.value===re?null:re},Qe=()=>{g.value=null,y.value=!1,k.value=!1,b.value=!1},gt=re=>{s.value=re,Qe()},Lt=re=>{r.value=re,Qe()},yt=re=>{u.value=re,Qe()},xt=re=>{i.value=re,Qe()},kt=re=>{d.value=re,Qe()},Ut=re=>{f.value=re,Qe()},Rt=re=>{p.value=re,Qe()},ct=()=>{y.value=!y.value,y.value&&(ee.value?C.value=r.value.replace(/^#/,""):C.value="",sn(()=>I.value?.focus()))},ln=()=>{k.value=!k.value,k.value&&(ye.value?x.value=u.value.replace(/^#/,""):x.value="",sn(()=>S.value?.focus()))},un=()=>{b.value=!b.value,b.value&&(te.value?$.value=d.value.replace(/^#/,""):$.value="",sn(()=>B.value?.focus()))},Bt=()=>{C.value=C.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},bt=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Yn=()=>{$.value=$.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Un=re=>re.length===3?re[0]+re[0]+re[1]+re[1]+re[2]+re[2]:re,Xn=()=>{if(!ge.value)return;const re=Un(C.value);r.value="#"+re,y.value=!1,Qe()},kn=()=>{if(!he.value)return;const re=Un(x.value);u.value="#"+re,k.value=!1,Qe()},Kt=()=>{if(!G.value)return;const re=Un($.value);d.value="#"+re,b.value=!1,Qe()},_s=re=>{p.value=re};Ze(()=>o.isOpen,re=>{if(re){const ue=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",me=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",st=o.backgroundColor&&o.backgroundColor!=="",je=o.borderColor&&o.borderColor!=="",$t=o.iconColor&&o.iconColor!=="",Yt=o.size&&o.size!==""&&o.size!=="100",nn=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ue||me||st||je||$t||Yt||nn?(s.value=o.backgroundShape||"default",i.value=o.iconType||"default",r.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",f.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",i.value="default",r.value="default",u.value="default",d.value="default",f.value="default",p.value="default"),g.value=null}});const Qn=()=>{Qe(),a("update:isOpen",!1),a("cancel")},Co=()=>{Qe();const re=st=>st==="default"?"":st;let ue="";i.value==="none"?ue="none":i.value&&i.value!=="default"&&(ue=i.value);let me="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(me=parseInt(p.value,10)||0),a("apply",{iconType:ue,backgroundShape:re(s.value),backgroundColor:re(r.value),borderColor:re(u.value),iconColor:re(d.value),size:re(f.value),mapRotation:me}),a("update:isOpen",!1)};return(re,ue)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:it(Qn,["self"])},[l("div",S2,[l("div",{class:"modal-header"},[ue[18]||(ue[18]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:Qn},"")]),l("div",x2,[l("div",I2,[l("div",$2,[ue[19]||(ue[19]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:et({transform:`rotate(${P(p.value)}deg)`}),innerHTML:Ee.value},null,12,T2)])]),l("div",M2,[l("button",{type:"button",class:ve(["option-button",{active:g.value==="shape"}]),onClick:ue[0]||(ue[0]=me=>Ke("shape"))},[l("div",A2,[ue[20]||(ue[20]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",E2,[l("div",{class:"icon-preview-small",innerHTML:fe(s.value)},null,8,P2),l("span",null,w(J(s.value)),1)])]),ue[21]||(ue[21]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="bgColor"}]),onClick:ue[1]||(ue[1]=me=>Ke("bgColor"))},[l("div",D2,[ue[22]||(ue[22]=l("span",{class:"option-button-label"},"Background",-1)),l("div",O2,[l("span",{class:"color-swatch",style:et({backgroundColor:Y.value})},null,4),l("span",null,w(Me(r.value)),1)])]),ue[23]||(ue[23]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="borderColor",disabled:!pe.value}]),disabled:!pe.value,onClick:ue[2]||(ue[2]=me=>Ke("borderColor"))},[l("div",B2,[ue[24]||(ue[24]=l("span",{class:"option-button-label"},"Border",-1)),l("div",N2,[l("span",{class:ve(["color-swatch",{"no-border":u.value==="none"}]),style:et(u.value!=="none"?{backgroundColor:de.value}:{})},null,6),l("span",null,w(Be(u.value)),1)])]),ue[25]||(ue[25]=l("span",{class:"option-button-arrow"},"",-1))],10,R2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="icon"}]),onClick:ue[3]||(ue[3]=me=>Ke("icon"))},[l("div",F2,[ue[26]||(ue[26]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",U2,[l("div",{class:"icon-preview-small",innerHTML:xe(i.value)},null,8,z2),l("span",null,w(ce(i.value)),1)])]),ue[27]||(ue[27]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="iconColor",disabled:!ne.value}]),disabled:!ne.value,onClick:ue[4]||(ue[4]=me=>Ke("iconColor"))},[l("div",V2,[ue[28]||(ue[28]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",G2,[l("span",{class:"color-swatch",style:et({backgroundColor:ke.value})},null,4),l("span",null,w(De(d.value)),1)])]),ue[29]||(ue[29]=l("span",{class:"option-button-arrow"},"",-1))],10,H2),l("button",{type:"button",class:ve(["option-button",{active:g.value==="size"}]),onClick:ue[5]||(ue[5]=me=>Ke("size"))},[l("div",j2,[ue[30]||(ue[30]=l("span",{class:"option-button-label"},"Size",-1)),l("span",Z2,w(Le(f.value)),1)]),ue[31]||(ue[31]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:ve(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:ue[6]||(ue[6]=me=>Ke("mapRotation"))},[l("div",W2,[ue[32]||(ue[32]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",q2,w(X(p.value)),1)]),ue[33]||(ue[33]=l("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",K2,[l("div",{class:"popup-header"},[ue[34]||(ue[34]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",J2,[(v(!0),m(Ie,null,Fe(j.value,me=>(v(),m("button",{key:me.value,type:"button",class:ve(["popup-grid-item",{selected:s.value===me.value}]),onClick:st=>gt(me.value)},[l("div",{class:"popup-item-preview",innerHTML:Se(me.value)},null,8,X2),me.showLabel?(v(),m("span",Q2,w(me.label),1)):E("",!0)],10,Y2))),128))])])):E("",!0),g.value==="bgColor"?(v(),m("div",eL,[l("div",{class:"popup-header"},[ue[35]||(ue[35]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",tL,[(v(!0),m(Ie,null,Fe(Re.value,me=>(v(),m("button",{key:me.hex,type:"button",class:ve(["popup-grid-item",{selected:ze(me.hex)}]),title:me.name,onClick:st=>Lt(me.hex)},[l("div",{class:"popup-item-preview",innerHTML:_e(me.hex)},null,8,oL),me.showLabel?(v(),m("span",sL,w(me.name),1)):E("",!0)],10,nL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:ee.value}]),style:et(ee.value?{"--custom-color":r.value}:{}),title:"Custom colour",onClick:ct},[l("div",{class:"popup-item-preview custom-color-preview",style:et(ee.value?{backgroundColor:r.value}:{})},[ee.value?E("",!0):(v(),m("svg",aL,[...ue[36]||(ue[36]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),ee.value?(v(),m("span",iL,"")):E("",!0)],4),ue[37]||(ue[37]=l("span",null,"Custom",-1))],6)]),y.value?(v(),m("div",lL,[ue[39]||(ue[39]=l("label",null,"Enter hex code",-1)),l("div",rL,[ue[38]||(ue[38]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"bgHexInput",ref:I,"onUpdate:modelValue":ue[7]||(ue[7]=me=>C.value=me),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:C.value&&!ge.value}]),onInput:Bt,onKeydown:vs(Xn,["enter"])},null,34),[[at,C.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:ge.value?"#"+C.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!ge.value,onClick:Xn}," Apply ",8,cL)]),C.value&&!ge.value?(v(),m("span",uL," Invalid hex code ")):E("",!0)])):E("",!0)])):E("",!0),g.value==="borderColor"?(v(),m("div",dL,[l("div",{class:"popup-header"},[ue[40]||(ue[40]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",hL,[(v(!0),m(Ie,null,Fe(Xe.value,me=>(v(),m("button",{key:me.hex,type:"button",class:ve(["popup-grid-item",{selected:u.value===me.hex}]),title:me.name,onClick:st=>yt(me.hex)},[l("div",{class:"popup-item-preview",innerHTML:W(me.hex)},null,8,pL),me.showLabel?(v(),m("span",vL,w(me.name),1)):E("",!0)],10,fL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:ye.value}]),style:et(ye.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:ln},[l("div",{class:"popup-item-preview custom-color-preview",style:et(ye.value?{backgroundColor:u.value}:{})},[ye.value?E("",!0):(v(),m("svg",mL,[...ue[41]||(ue[41]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),ye.value?(v(),m("span",gL,"")):E("",!0)],4),ue[42]||(ue[42]=l("span",null,"Custom",-1))],6)]),k.value?(v(),m("div",yL,[ue[44]||(ue[44]=l("label",null,"Enter hex code",-1)),l("div",kL,[ue[43]||(ue[43]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"borderHexInput",ref:S,"onUpdate:modelValue":ue[8]||(ue[8]=me=>x.value=me),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!he.value}]),onInput:bt,onKeydown:vs(kn,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:he.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!he.value,onClick:kn}," Apply ",8,_L)]),x.value&&!he.value?(v(),m("span",bL," Invalid hex code ")):E("",!0)])):E("",!0)])):E("",!0),g.value==="icon"?(v(),m("div",wL,[l("div",{class:"popup-header"},[ue[45]||(ue[45]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",CL,[(v(!0),m(Ie,null,Fe(Q.value,me=>(v(),m("button",{key:me.value,type:"button",class:ve(["popup-grid-item",{selected:i.value===me.value}]),onClick:st=>xt(me.value)},[l("div",{class:"popup-item-preview",innerHTML:q(me.value)},null,8,SL),me.showLabel?(v(),m("span",xL,w(me.label),1)):E("",!0)],10,LL))),128))])])):E("",!0),g.value==="iconColor"?(v(),m("div",IL,[l("div",{class:"popup-header"},[ue[46]||(ue[46]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",$L,[(v(!0),m(Ie,null,Fe(Ne.value,me=>(v(),m("button",{key:me.hex,type:"button",class:ve(["popup-grid-item",{selected:We(me.hex)}]),title:me.name,onClick:st=>kt(me.hex)},[l("div",{class:"popup-item-preview",innerHTML:K(me.hex)},null,8,ML),me.showLabel?(v(),m("span",AL,w(me.name),1)):E("",!0)],10,TL))),128)),l("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:te.value}]),style:et(te.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:un},[l("div",{class:"popup-item-preview custom-color-preview",style:et(te.value?{backgroundColor:d.value}:{})},[te.value?E("",!0):(v(),m("svg",EL,[...ue[47]||(ue[47]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),te.value?(v(),m("span",PL,"")):E("",!0)],4),ue[48]||(ue[48]=l("span",null,"Custom",-1))],6)]),b.value?(v(),m("div",DL,[ue[50]||(ue[50]=l("label",null,"Enter hex code",-1)),l("div",OL,[ue[49]||(ue[49]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"iconHexInput",ref:B,"onUpdate:modelValue":ue[9]||(ue[9]=me=>$.value=me),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:$.value&&!G.value}]),onInput:Yn,onKeydown:vs(Kt,["enter"])},null,34),[[at,$.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:G.value?"#"+$.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!G.value,onClick:Kt}," Apply ",8,RL)]),$.value&&!G.value?(v(),m("span",BL," Invalid hex code ")):E("",!0)])):E("",!0)])):E("",!0),g.value==="size"?(v(),m("div",NL,[l("div",{class:"popup-header"},[ue[51]||(ue[51]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",FL,[(v(!0),m(Ie,null,Fe(ae.value,me=>(v(),m("button",{key:me.value,type:"button",class:ve(["size-grid-item",{selected:f.value===me.value}]),onClick:st=>Ut(me.value)},[l("div",{class:"size-preview",innerHTML:le(me.value)},null,8,zL),l("span",null,w(me.label),1)],10,UL))),128))])])):E("",!0),g.value==="mapRotation"?(v(),m("div",HL,[l("div",{class:"popup-header"},[ue[52]||(ue[52]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:Qe},"")]),l("div",VL,[l("div",GL,[l("div",{class:"rotation-preview-icon",style:et({transform:`rotate(${P(p.value)}deg)`}),innerHTML:Ee.value},null,12,jL)]),ue[53]||(ue[53]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",ZL,[l("button",{type:"button",class:ve(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:ue[10]||(ue[10]=me=>Rt("default"))}," Default ",2),l("div",WL,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:ue[11]||(ue[11]=me=>_s(parseInt(me.target.value,10)))},null,40,qL),l("div",KL,w(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),l("div",JL,[l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===-90}]),onClick:ue[12]||(ue[12]=me=>Rt(-90))},"-90",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===-45}]),onClick:ue[13]||(ue[13]=me=>Rt(-45))},"-45",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===0}]),onClick:ue[14]||(ue[14]=me=>Rt(0))},"0",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===45}]),onClick:ue[15]||(ue[15]=me=>Rt(45))},"+45",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===90}]),onClick:ue[16]||(ue[16]=me=>Rt(90))},"+90",2),l("button",{type:"button",class:ve(["rotation-preset-btn",{selected:p.value===180}]),onClick:ue[17]||(ue[17]=me=>Rt(180))},"180",2)])])])):E("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:Qn},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:Co},"Apply")])])])):E("",!0)}},QL=Ge(XL,[["__scopeId","data-v-bbab1a46"]]),eS={class:"checkpoint-style-picker"},tS={class:"form-group"},nS={class:"style-options"},oS=["innerHTML"],sS={class:"option-label"},aS=["innerHTML"],iS="#667eea",lS={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,s=M(o.styleType),i=M(o.styleColor||""),r=M(o.styleBackgroundShape||"default"),u=M(o.styleBackgroundColor||""),d=M(o.styleBorderColor||""),f=M(o.styleIconColor||""),p=M(o.styleSize||"default"),g=M(o.styleMapRotation||""),y=P=>!P||P==="default"?!1:oi(P).category==="content",k=M(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),b=M(!1),C=F(()=>!!(s.value&&s.value!=="default"||r.value&&r.value!=="default"&&r.value!=="circle"||u.value||d.value||f.value||p.value&&p.value!=="default"&&p.value!=="100")),x=P=>P&&P!==""&&P!=="default",$=P=>P&&P.startsWith("#"),I=F(()=>{const j=x(o.inheritedStyleType),Q=x(o.inheritedBackgroundShape),ae=$(o.inheritedBackgroundColor)||$(o.inheritedStyleColor),pe=$(o.inheritedBorderColor),ne=$(o.inheritedIconColor),oe=x(o.inheritedSize);if(j||Q||ae||pe||ne||oe){const Y=j?o.inheritedStyleType:Q?o.inheritedBackgroundShape:"circle",de=($(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||($(o.inheritedStyleColor)?o.inheritedStyleColor:null)||iS;return In({type:Y,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:de,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),S=F(()=>{const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),B=F(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const j=parseInt(g.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),R=F(()=>{if(C.value){const P=k.value&&k.value!=="none"&&k.value!=="default";let j=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&oi(o.inheritedStyleType).category==="content"&&(j=o.inheritedStyleType);const Q=k.value==="default"&&j,ae=P||Q,pe=P?k.value:Q?j:null,ne=r.value&&r.value!=="default"?r.value:o.inheritedBackgroundShape||"circle",oe=ae?pe:ne,U=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Y=d.value||o.inheritedBorderColor||"#ffffff",de=f.value||o.inheritedIconColor||"#ffffff";return In({type:oe,backgroundShape:ne,backgroundColor:U,borderColor:Y,iconColor:de,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),Z=()=>{s.value="default",k.value="default",a("update:styleType","default"),r.value="default",u.value="",i.value="",d.value="",f.value="",p.value="default",g.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),V()},A=()=>{b.value=!0},N=P=>{P.iconType==="none"?k.value="none":P.iconType?k.value=P.iconType:k.value="default",r.value=P.backgroundShape||"default",u.value=P.backgroundColor||"",d.value=P.borderColor||"",f.value=P.iconColor||"",p.value=P.size||"default",g.value=P.mapRotation??"";const j=P.iconType==="none"||P.iconType&&P.iconType!==""||P.backgroundShape||P.backgroundColor||P.borderColor||P.iconColor||P.size||P.mapRotation!==""&&P.mapRotation!==0;P.iconType&&P.iconType!=="none"?s.value=P.iconType:j?s.value="custom":s.value="default",a("update:styleType",s.value),a("update:styleBackgroundShape",P.backgroundShape),a("update:styleBackgroundColor",P.backgroundColor),a("update:styleBorderColor",P.borderColor),a("update:styleIconColor",P.iconColor),a("update:styleSize",P.size),a("update:styleMapRotation",P.mapRotation??""),V()},O=()=>{},V=()=>{a("change",{styleType:s.value,styleColor:u.value||i.value,styleBackgroundShape:r.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:f.value,styleSize:p.value,styleMapRotation:g.value})};return Ze(()=>o.styleType,P=>{s.value=P,P&&P!=="default"&&P!=="custom"&&y(P)?k.value=P:k.value="default"}),Ze(()=>o.styleColor,P=>{i.value=P||""}),Ze(()=>o.styleBackgroundShape,P=>{r.value=P||"default"}),Ze(()=>o.styleBackgroundColor,P=>{u.value=P||""}),Ze(()=>o.styleBorderColor,P=>{d.value=P||""}),Ze(()=>o.styleIconColor,P=>{f.value=P||""}),Ze(()=>o.styleSize,P=>{p.value=P||"default"}),Ze(()=>o.styleMapRotation,P=>{g.value=P??""}),(P,j)=>(v(),m("div",eS,[l("div",tS,[l("label",null,w(e.iconLabel),1),l("div",nS,[l("button",{type:"button",class:ve(["style-option-button",{selected:!C.value}]),onClick:Z},[l("div",{class:"option-preview",style:et(S.value),innerHTML:I.value},null,12,oS),l("span",sS,w(e.defaultLabel),1)],2),l("button",{type:"button",class:ve(["style-option-button",{selected:C.value}]),onClick:A},[l("div",{class:"option-preview",style:et(B.value),innerHTML:R.value},null,12,aS),j[1]||(j[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Ae(QL,{isOpen:b.value,"onUpdate:isOpen":j[0]||(j[0]=Q=>b.value=Q),"icon-type":k.value,"background-shape":r.value,"background-color":u.value,"border-color":d.value,"icon-color":f.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:N,onCancel:O},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},ld=Ge(lS,[["__scopeId","data-v-c066da64"]]),rS={class:"logo-uploader"},cS={key:0,class:"logo-preview"},uS=["src"],dS=["disabled"],hS={key:0,class:"upload-progress"},fS={key:1,class:"upload-prompt"},pS={key:2,class:"error-message"},lf=5*1024*1024,vS={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=ne=>ne?ne.startsWith("/api")?ka+ne.substring(4):ne:"",s=e;function i(){const ne={},oe=localStorage.getItem("adminEmail");oe&&(ne["X-Admin-Email"]=oe);const U=localStorage.getItem("sessionToken");return U&&(ne.Authorization=`Bearer ${U}`),ne}const r=o;function u(){r("staged-change",{hasPendingChanges:k.value!==null||C.value,isPendingDelete:C.value,displayUrl:b.value||(C.value?"":s.modelValue)||""})}const d=M(null),f=M(!1),p=M(!1),g=M(""),y=M(Date.now()),k=M(null),b=M(""),C=M(!1),x=F(()=>{if(s.staged){if(b.value)return!0;if(C.value)return!1}return!!s.modelValue}),$=F(()=>{if(s.staged&&C.value)return"";if(s.staged&&b.value)return b.value;if(!s.modelValue)return"";const ne=a(s.modelValue),oe=ne.includes("?")?"&":"?";return`${ne}${oe}_t=${y.value}`});function I(){b.value&&(URL.revokeObjectURL(b.value),b.value="")}yn(()=>{I()});const S=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function B(){f.value||d.value?.click()}function R(ne){const oe=ne.target.files?.[0];oe&&A(oe),d.value&&(d.value.value="")}function Z(ne){p.value=!1;const oe=ne.dataTransfer?.files?.[0];oe&&A(oe)}async function A(ne){if(g.value="",!S.includes(ne.type)){g.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(ne.size>lf){g.value=`File too large. Maximum size is ${lf/(1024*1024)}MB.`;return}if(s.staged){I(),k.value=ne,b.value=URL.createObjectURL(ne),C.value=!1,u();return}f.value=!0;try{const oe=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":ne.type,...i()},body:ne});if(!oe.ok){const Y=await oe.text().catch(()=>"");let de=`Upload failed (${oe.status})`;try{de=JSON.parse(Y).message||de}catch{Y&&(de=Y)}throw new Error(de)}const U=await oe.json();y.value=Date.now(),r("update:modelValue",U.logoUrl)}catch(oe){console.error("Logo upload error:",oe),oe.name==="TypeError"&&oe.message==="Failed to fetch"?g.value="Network error. Check your connection or try a smaller file.":oe.message?.includes("401")||oe.message?.includes("403")?g.value="Not authorized. Please refresh the page and try again.":g.value=oe.message||"Failed to upload logo. Please try again."}finally{f.value=!1}}async function N(){if(g.value="",s.staged){k.value?(I(),k.value=null):s.modelValue&&(C.value=!0),u();return}f.value=!0;try{const ne=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!ne.ok){const oe=await ne.json().catch(()=>({}));throw new Error(oe.message||"Delete failed")}r("update:modelValue","")}catch(ne){console.error("Logo delete error:",ne),g.value=ne.message||"Failed to remove logo. Please try again."}finally{f.value=!1}}async function O(){if(!k.value)return{success:!0,logoUrl:C.value?"":s.modelValue};f.value=!0,g.value="";try{const ne=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!ne.ok){const U=await ne.text().catch(()=>"");let Y=`Upload failed (${ne.status})`;try{Y=JSON.parse(U).message||Y}catch{U&&(Y=U)}throw new Error(Y)}const oe=await ne.json();return y.value=Date.now(),I(),k.value=null,C.value=!1,{success:!0,logoUrl:oe.logoUrl}}catch(ne){return console.error("Logo upload error:",ne),g.value=ne.message||"Failed to upload logo. Please try again.",{success:!1,error:ne.message}}finally{f.value=!1}}async function V(){if(!C.value)return{success:!0};f.value=!0,g.value="";try{const ne=await fetch(`${ka}/events/${s.eventId}/logo`,{method:"DELETE",headers:i()});if(!ne.ok){const oe=await ne.json().catch(()=>({}));throw new Error(oe.message||"Delete failed")}return C.value=!1,{success:!0}}catch(ne){return console.error("Logo delete error:",ne),g.value=ne.message||"Failed to remove logo. Please try again.",{success:!1,error:ne.message}}finally{f.value=!1}}function P(){return k.value!==null||C.value}function j(){return k.value}function Q(){return C.value}function ae(){return b.value?b.value:C.value?"":a(s.modelValue)||""}function pe(){I(),k.value=null,C.value=!1}return t({uploadStagedFile:O,deleteStagedLogo:V,hasPendingChanges:P,getStagedFile:j,isPendingDelete:Q,getDisplayUrl:ae,resetStagedState:pe}),(ne,oe)=>(v(),m("div",rS,[oe[4]||(oe[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),x.value?(v(),m("div",cS,[l("img",{src:$.value,alt:"Event logo",class:"logo-image"},null,8,uS),l("button",{type:"button",class:"remove-btn",onClick:N,disabled:f.value}," Remove ",8,dS)])):(v(),m("div",{key:1,class:ve(["upload-area",{"drag-over":p.value,uploading:f.value}]),onDragover:oe[0]||(oe[0]=it(U=>p.value=!0,["prevent"])),onDragleave:oe[1]||(oe[1]=it(U=>p.value=!1,["prevent"])),onDrop:it(Z,["prevent"]),onClick:B},[l("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:R},null,544),f.value?(v(),m("div",hS,[...oe[2]||(oe[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),m("div",fS,[...oe[3]||(oe[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),g.value?(v(),m("div",pS,w(g.value),1)):E("",!0)]))}},mS=Ge(vS,[["__scopeId","data-v-bfb1b332"]]),Jv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function gS(){return{...Jv[0]}}function yS(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function Au(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),r=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*r+.0722*u}function Eu(e){return!e||e===""?"#ffffff":Au(e)>.179?"#333333":"#ffffff"}function Yv(e,t){const o=e||cn.headerGradientStart,a=t||cn.headerGradientEnd,s=Au(o),i=Au(a);return(s+i)/2>.35?"#333333":"#ffffff"}const cn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},kS={class:"marshal-mockup-container"},_S={class:"presets-section"},bS={class:"presets-row"},wS=["title","onClick"],CS={class:"preset-name"},LS={class:"mockup-frame"},SS={key:0,class:"logo-cover-bg"},xS=["src"],IS=["src"],$S={class:"header-center"},TS={class:"event-name"},MS={class:"mockup-buttons"},AS=["src"],ES={class:"mockup-body"},PS={class:"mockup-card"},DS={class:"card-content"},OS={class:"editor-header"},RS={class:"editor-content"},BS={class:"color-grid-inline"},NS={class:"color-field"},FS={class:"color-swatches"},US=["title","onClick"],zS={key:0,class:"check"},HS={class:"custom-color-wrapper"},VS={class:"hex-popup-header"},GS={class:"hex-input-row"},jS=["disabled"],ZS={key:0,class:"hex-error"},WS={class:"gradient-toggle"},qS={key:0,class:"color-field"},KS={class:"color-swatches"},JS=["title","onClick"],YS={key:0,class:"check"},XS={class:"custom-color-wrapper"},QS={class:"hex-popup-header"},ex={class:"hex-input-row"},tx=["disabled"],nx={key:0,class:"hex-error"},ox={key:1,class:"logo-position-section"},sx={class:"position-buttons"},ax={class:"color-swatches"},ix=["title","onClick"],lx={key:0,class:"check"},rx={class:"custom-color-wrapper"},cx={class:"hex-popup-header"},ux={class:"hex-input-row"},dx=["disabled"],hx={key:0,class:"hex-error"},fx={class:"color-grid-inline"},px={class:"color-field"},vx={class:"color-swatches"},mx=["title","onClick"],gx={key:0,class:"check"},yx={class:"custom-color-wrapper"},kx={class:"hex-popup-header"},_x={class:"hex-input-row"},bx=["disabled"],wx={key:0,class:"hex-error"},Cx={class:"gradient-toggle"},Lx={key:0,class:"color-field"},Sx={class:"color-swatches"},xx=["title","onClick"],Ix={key:0,class:"check"},$x={class:"custom-color-wrapper"},Tx={class:"hex-popup-header"},Mx={class:"hex-input-row"},Ax=["disabled"],Ex={key:0,class:"hex-error"},Px={class:"editor-footer"},Dx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=Le=>Le?Le.startsWith("/api")?ka+Le.substring(4):Le:"",s=En,i=e,r=o,u=M(null),d=Jv,f=M(!1),p=M(!1),g=M(null),y=M(!1),k=M(""),b=Le=>{typeof Le=="object"&&Le!==null?(y.value=Le.isPendingDelete,k.value=Le.displayUrl||"",r("logo-staged-change",Le.hasPendingChanges)):(g.value&&(y.value=g.value.isPendingDelete(),k.value=g.value.getDisplayUrl()||""),r("logo-staged-change",!!Le))},C=M(null),x=M(""),$=M(null),I=M(null),S=M({left:"50%",right:"auto",transform:"translateX(-50%)"}),B=Le=>Le?!s.some(X=>X.hex.toLowerCase()===Le.toLowerCase()):!1,R=Le=>!Le||!B(Le)?"#666666":Eu(Le),Z=Le=>!Le||!B(Le)?"#e0e0e0":Le,A=F(()=>{if(!x.value)return!1;const Le=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Le)||/^[0-9A-Fa-f]{3}$/.test(Le)}),N=(Le,X)=>{if(C.value===Le)C.value=null;else{C.value=Le;let fe="";switch(Le){case"headerStart":fe=i.branding.headerGradientStart;break;case"headerEnd":fe=i.branding.headerGradientEnd;break;case"pageStart":fe=i.branding.pageGradientStart;break;case"pageEnd":fe=i.branding.pageGradientEnd;break;case"accent":fe=i.branding.accentColor;break}if(fe&&B(fe)?x.value=fe.replace(/^#/,""):x.value="",X&&I.value){const xe=X.currentTarget,Se=I.value,_e=xe.getBoundingClientRect(),W=Se.getBoundingClientRect(),q=220,K=12,le=_e.left+_e.width/2-W.left,Ee=W.width,Ke=le-q/2;le+q/2>Ee-K?S.value={left:"auto",right:"0",transform:"none"}:Ke<K?S.value={left:"0",right:"auto",transform:"none"}:S.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}sn(()=>$.value?.focus())}},O=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},V=()=>{if(!A.value||!C.value)return;let Le=x.value;Le.length===3&&(Le=Le[0]+Le[0]+Le[1]+Le[1]+Le[2]+Le[2]);const X="#"+Le;switch(C.value){case"headerStart":ye("start",X);break;case"headerEnd":ee("headerGradientEnd",X);break;case"pageStart":te("start",X);break;case"pageEnd":ee("pageGradientEnd",X);break;case"accent":ee("accentColor",X);break}C.value=null};Ze(u,Le=>{if(C.value=null,x.value="",Le==="header"){const X=i.branding.headerGradientStart||cn.headerGradientStart,fe=i.branding.headerGradientEnd||cn.headerGradientEnd;f.value=X!==fe}else if(Le==="page"){const X=i.branding.pageGradientStart||cn.pageGradientStart,fe=i.branding.pageGradientEnd||cn.pageGradientEnd;p.value=X!==fe}});const P={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=F(()=>i.branding.headerGradientStart||cn.headerGradientStart),Q=F(()=>i.branding.headerGradientEnd||cn.headerGradientEnd),ae=F(()=>i.branding.accentColor||cn.accentColor),pe=F(()=>i.branding.pageGradientStart||cn.pageGradientStart),ne=F(()=>i.branding.pageGradientEnd||cn.pageGradientEnd),oe=F(()=>i.branding.logoPosition||"left"),U=M(Date.now());Ze(()=>i.branding.logoUrl,()=>{U.value=Date.now(),y.value=!1,k.value=""});const Y=F(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),de=F(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const fe=a(k.value),xe=fe.includes("?")?"&":"?";return`${fe}${xe}_t=${U.value}`}if(!i.branding.logoUrl)return"";const Le=a(i.branding.logoUrl),X=Le.includes("?")?"&":"?";return`${Le}${X}_t=${U.value}`}),ke=F(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Q.value} 100%)`})),Re=F(()=>Yv(j.value,Q.value)),Xe=F(()=>({background:ae.value,color:Eu(ae.value)})),Ne=F(()=>({background:`linear-gradient(135deg, ${pe.value} 0%, ${ne.value} 100%)`}));function ze(Le){u.value=u.value===Le?null:Le}function We(Le){!Y.value&&Le&&ee("logoPosition",Le),ze("logo")}function ee(Le,X){r("update:branding",{...i.branding,[Le]:X})}function ye(Le,X){f.value?ee("headerGradientStart",X):r("update:branding",{...i.branding,headerGradientStart:X,headerGradientEnd:X})}function te(Le,X){p.value?ee("pageGradientStart",X):r("update:branding",{...i.branding,pageGradientStart:X,pageGradientEnd:X})}function ge(){if(!f.value){const Le=i.branding.headerGradientStart||cn.headerGradientStart;ee("headerGradientEnd",Le)}}function he(){if(!p.value){const Le=i.branding.pageGradientStart||cn.pageGradientStart;ee("pageGradientEnd",Le)}}function G(Le){r("update:branding",yS(i.branding,Le)),u.value=null}async function J(){return g.value?await g.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ce(){return g.value?await g.value.deleteStagedLogo():{success:!0}}function Me(){return g.value?.hasPendingChanges()||!1}function Be(){return g.value?.isPendingDelete()||!1}function De(){g.value&&g.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:J,deleteStagedLogo:ce,hasLogoChanges:Me,isLogoPendingDelete:Be,resetLogo:De}),(Le,X)=>(v(),m("div",kS,[l("div",_S,[X[32]||(X[32]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",bS,[(v(!0),m(Ie,null,Fe(D(d),fe=>(v(),m("button",{key:fe.name,type:"button",class:"preset-btn",title:fe.name,onClick:xe=>G(fe)},[l("span",{class:"preset-preview",style:et({background:`linear-gradient(135deg, ${fe.pageGradientStart} 0%, ${fe.pageGradientEnd} 100%)`})},null,4),l("span",CS,w(fe.name),1)],8,wS))),128))])]),l("div",LS,[l("div",{class:ve(["mockup-page",{"region-active":u.value==="page"}]),style:et(Ne.value),onClick:X[7]||(X[7]=fe=>ze("page"))},[l("div",{class:ve(["mockup-header",[{"region-active":u.value==="header"},Y.value?`logo-${oe.value}`:"logo-none"]]),style:et(ke.value),onClick:X[5]||(X[5]=it(fe=>ze("header"),["stop"]))},[Y.value&&oe.value==="cover"?(v(),m("div",SS,[l("img",{src:de.value,alt:"Logo",class:"logo-cover-img"},null,8,xS)])):E("",!0),Y.value&&oe.value==="cover"?(v(),m("button",{key:1,type:"button",class:ve(["logo-cover-edit-btn",{"region-active":u.value==="logo"}]),onClick:X[0]||(X[0]=it(fe=>ze("logo"),["stop"])),title:"Edit logo"},[...X[33]||(X[33]=[l("span",null,"",-1)])],2)):E("",!0),Y.value&&oe.value==="left"?(v(),m("div",{key:2,class:ve(["mockup-logo logo-left",{"region-active":u.value==="logo"}]),onClick:X[1]||(X[1]=it(fe=>ze("logo"),["stop"]))},[l("img",{src:de.value,alt:"Logo",class:"logo-img"},null,8,IS)],2)):E("",!0),Y.value?E("",!0):(v(),m("div",{key:3,class:ve(["logo-add-area logo-add-left",{"region-active":u.value==="logo"}]),onClick:X[2]||(X[2]=it(fe=>We("left"),["stop"]))},[...X[34]||(X[34]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),l("div",$S,[l("div",{class:"mockup-title",style:et({color:Re.value})},[l("span",TS,w(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:et({color:Re.value})},w(e.eventDate||"Event Date"),5),l("div",MS,[X[35]||(X[35]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:et({color:Re.value})},"Logout",4)])]),Y.value&&oe.value==="right"?(v(),m("div",{key:4,class:ve(["mockup-logo logo-right",{"region-active":u.value==="logo"}]),onClick:X[3]||(X[3]=it(fe=>ze("logo"),["stop"]))},[l("img",{src:de.value,alt:"Logo",class:"logo-img"},null,8,AS)],2)):E("",!0),Y.value?E("",!0):(v(),m("div",{key:5,class:ve(["logo-add-area logo-add-right",{"region-active":u.value==="logo"}]),onClick:X[4]||(X[4]=it(fe=>We("right"),["stop"]))},[...X[36]||(X[36]=[l("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),l("div",ES,[l("div",PS,[X[37]||(X[37]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",DS,[l("div",{class:ve(["mockup-checkin-btn",{"region-active":u.value==="accent"}]),style:et(Xe.value),onClick:X[6]||(X[6]=it(fe=>ze("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),Ue(l("div",{class:"editor-overlay",onClick:X[31]||(X[31]=it(fe=>u.value=null,["self"]))},[l("div",{ref_key:"editorModalRef",ref:I,class:"editor-modal"},[l("div",OS,[l("span",null,w(P[u.value]),1),l("button",{type:"button",class:"editor-close",onClick:X[8]||(X[8]=fe=>u.value=null)},"")]),l("div",RS,[u.value==="header"?(v(),m(Ie,{key:0},[X[46]||(X[46]=l("p",{class:"editor-description"},"Choose the colour for the header.",-1)),l("div",BS,[l("div",NS,[l("label",null,w(f.value?"Start colour":"Colour"),1),l("div",FS,[(v(!0),m(Ie,null,Fe(D(s),fe=>(v(),m("button",{key:"hs-"+fe.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientStart===fe.hex}]),style:et({backgroundColor:fe.hex}),title:fe.name,onClick:xe=>ye("start",fe.hex)},[e.branding.headerGradientStart===fe.hex?(v(),m("span",zS,"")):E("",!0)],14,US))),128)),l("div",HS,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.headerGradientStart)}]),style:et({backgroundColor:Z(e.branding.headerGradientStart)}),title:"Custom colour",onClick:X[9]||(X[9]=fe=>N("headerStart",fe))},[(v(),m("svg",{class:"custom-icon",style:et({color:R(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[38]||(X[38]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="headerStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",VS,[X[39]||(X[39]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:X[10]||(X[10]=fe=>C.value=null)},"")]),l("div",GS,[X[40]||(X[40]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":X[11]||(X[11]=fe=>x.value=fe),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!A.value}]),onInput:O,onKeydown:vs(V,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:A.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!A.value,onClick:V}," Apply ",8,jS)]),x.value&&!A.value?(v(),m("span",ZS,"Invalid hex code")):E("",!0)],4)):E("",!0)])]),l("label",WS,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":X[12]||(X[12]=fe=>f.value=fe),onChange:ge},null,544),[[Gs,f.value]]),X[41]||(X[41]=l("span",null,"Use gradient",-1))])]),f.value?(v(),m("div",qS,[X[45]||(X[45]=l("label",null,"End colour",-1)),l("div",KS,[(v(!0),m(Ie,null,Fe(D(s),fe=>(v(),m("button",{key:"he-"+fe.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientEnd===fe.hex}]),style:et({backgroundColor:fe.hex}),title:fe.name,onClick:xe=>ee("headerGradientEnd",fe.hex)},[e.branding.headerGradientEnd===fe.hex?(v(),m("span",YS,"")):E("",!0)],14,JS))),128)),l("div",XS,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.headerGradientEnd)}]),style:et({backgroundColor:Z(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:X[13]||(X[13]=fe=>N("headerEnd",fe))},[(v(),m("svg",{class:"custom-icon",style:et({color:R(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[42]||(X[42]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="headerEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",QS,[X[43]||(X[43]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:X[14]||(X[14]=fe=>C.value=null)},"")]),l("div",ex,[X[44]||(X[44]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":X[15]||(X[15]=fe=>x.value=fe),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!A.value}]),onInput:O,onKeydown:vs(V,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:A.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!A.value,onClick:V}," Apply ",8,tx)]),x.value&&!A.value?(v(),m("span",nx,"Invalid hex code")):E("",!0)],4)):E("",!0)])])])):E("",!0)])],64)):E("",!0),u.value==="logo"?(v(),m("div",ox,[X[47]||(X[47]=l("label",{class:"editor-label"},"Position",-1)),l("div",sx,[l("button",{type:"button",class:ve(["position-btn",{selected:oe.value==="left"}]),onClick:X[16]||(X[16]=fe=>ee("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:ve(["position-btn",{selected:oe.value==="cover"}]),onClick:X[17]||(X[17]=fe=>ee("logoPosition","cover"))}," Cover ",2),l("button",{type:"button",class:ve(["position-btn",{selected:oe.value==="right"}]),onClick:X[18]||(X[18]=fe=>ee("logoPosition","right"))}," Right ",2)])])):E("",!0),Ue(Ae(mS,{ref_key:"logoUploaderRef",ref:g,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":X[19]||(X[19]=fe=>ee("logoUrl",fe)),onStagedChange:b},null,8,["model-value","event-id","admin-email"]),[[ks,u.value==="logo"]]),u.value==="accent"?(v(),m(Ie,{key:2},[X[51]||(X[51]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",ax,[(v(!0),m(Ie,null,Fe(D(s),fe=>(v(),m("button",{key:"ac-"+fe.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.accentColor===fe.hex}]),style:et({backgroundColor:fe.hex}),title:fe.name,onClick:xe=>ee("accentColor",fe.hex)},[e.branding.accentColor===fe.hex?(v(),m("span",lx,"")):E("",!0)],14,ix))),128)),l("div",rx,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.accentColor)}]),style:et({backgroundColor:Z(e.branding.accentColor)}),title:"Custom colour",onClick:X[20]||(X[20]=fe=>N("accent",fe))},[(v(),m("svg",{class:"custom-icon",style:et({color:R(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[48]||(X[48]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="accent"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",cx,[X[49]||(X[49]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:X[21]||(X[21]=fe=>C.value=null)},"")]),l("div",ux,[X[50]||(X[50]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":X[22]||(X[22]=fe=>x.value=fe),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!A.value}]),onInput:O,onKeydown:vs(V,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:A.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!A.value,onClick:V}," Apply ",8,dx)]),x.value&&!A.value?(v(),m("span",hx,"Invalid hex code")):E("",!0)],4)):E("",!0)])])],64)):E("",!0),u.value==="page"?(v(),m(Ie,{key:3},[X[60]||(X[60]=l("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),l("div",fx,[l("div",px,[l("label",null,w(p.value?"Start colour":"Colour"),1),l("div",vx,[(v(!0),m(Ie,null,Fe(D(s),fe=>(v(),m("button",{key:"ps-"+fe.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientStart===fe.hex}]),style:et({backgroundColor:fe.hex}),title:fe.name,onClick:xe=>te("start",fe.hex)},[e.branding.pageGradientStart===fe.hex?(v(),m("span",gx,"")):E("",!0)],14,mx))),128)),l("div",yx,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.pageGradientStart)}]),style:et({backgroundColor:Z(e.branding.pageGradientStart)}),title:"Custom colour",onClick:X[23]||(X[23]=fe=>N("pageStart",fe))},[(v(),m("svg",{class:"custom-icon",style:et({color:R(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[52]||(X[52]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="pageStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",kx,[X[53]||(X[53]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:X[24]||(X[24]=fe=>C.value=null)},"")]),l("div",_x,[X[54]||(X[54]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":X[25]||(X[25]=fe=>x.value=fe),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!A.value}]),onInput:O,onKeydown:vs(V,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:A.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!A.value,onClick:V}," Apply ",8,bx)]),x.value&&!A.value?(v(),m("span",wx,"Invalid hex code")):E("",!0)],4)):E("",!0)])]),l("label",Cx,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":X[26]||(X[26]=fe=>p.value=fe),onChange:he},null,544),[[Gs,p.value]]),X[55]||(X[55]=l("span",null,"Use gradient",-1))])]),p.value?(v(),m("div",Lx,[X[59]||(X[59]=l("label",null,"End colour",-1)),l("div",Sx,[(v(!0),m(Ie,null,Fe(D(s),fe=>(v(),m("button",{key:"pe-"+fe.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientEnd===fe.hex}]),style:et({backgroundColor:fe.hex}),title:fe.name,onClick:xe=>ee("pageGradientEnd",fe.hex)},[e.branding.pageGradientEnd===fe.hex?(v(),m("span",Ix,"")):E("",!0)],14,xx))),128)),l("div",$x,[l("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:B(e.branding.pageGradientEnd)}]),style:et({backgroundColor:Z(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:X[27]||(X[27]=fe=>N("pageEnd",fe))},[(v(),m("svg",{class:"custom-icon",style:et({color:R(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[56]||(X[56]=[l("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),C.value==="pageEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:et(S.value)},[l("div",Tx,[X[57]||(X[57]=l("span",null,"Custom colour",-1)),l("button",{type:"button",class:"hex-popup-close",onClick:X[28]||(X[28]=fe=>C.value=null)},"")]),l("div",Mx,[X[58]||(X[58]=l("span",{class:"hex-prefix"},"#",-1)),Ue(l("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":X[29]||(X[29]=fe=>x.value=fe),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!A.value}]),onInput:O,onKeydown:vs(V,["enter"])},null,34),[[at,x.value]]),l("div",{class:"hex-preview",style:et({backgroundColor:A.value?"#"+x.value:"#ccc"})},null,4),l("button",{type:"button",class:"hex-apply-btn",disabled:!A.value,onClick:V}," Apply ",8,Ax)]),x.value&&!A.value?(v(),m("span",Ex,"Invalid hex code")):E("",!0)],4)):E("",!0)])])])):E("",!0)])],64)):E("",!0)]),l("div",Px,[l("button",{type:"button",class:"btn-done",onClick:X[30]||(X[30]=fe=>u.value=null)},"Done")])],512)],512),[[ks,u.value]]),X[61]||(X[61]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},Ox=Ge(Dx,[["__scopeId","data-v-01af4f2d"]]),Rx={class:"settings-tab"},Bx={class:"accordion"},Nx={class:"accordion-section"},Fx={class:"accordion-title"},Ux={class:"accordion-icon"},zx={key:0,class:"accordion-content"},Hx={class:"accordion-section"},Vx={class:"accordion-icon"},Gx={key:0,class:"accordion-content"},jx={class:"terminology-grid"},Zx={class:"term-group"},Wx=["value"],qx={class:"term-group"},Kx=["value"],Jx={class:"term-group"},Yx=["value"],Xx={class:"term-group"},Qx=["value"],eI={class:"term-group"},tI=["value"],nI={class:"form-actions"},oI=["disabled"],sI={class:"accordion-section"},aI={class:"accordion-title"},iI={class:"accordion-icon"},lI={key:0,class:"accordion-content"},rI={class:"section-description"},cI={class:"form-actions"},uI=["disabled"],dI={class:"accordion-section"},hI={class:"accordion-title"},fI={class:"accordion-icon"},pI={key:0,class:"accordion-content"},vI={class:"section-description"},mI={class:"form-actions"},gI=["disabled"],yI=["disabled"],rf="admin_settings_accordion",kI={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=Kl(),i=F(()=>s.adminEmail||""),r=e,u=t,d=M({...r.eventData}),f=M(null),p=M(!1),g=()=>r.eventId?`${rf}_${r.eventId}`:rf,y=M(null);tn(()=>{const A=localStorage.getItem(g());A&&(y.value=A)});const k=F(()=>{const A=d.value.peopleTerm||"Marshals";return Bs.checkpoint.map(N=>({value:N,label:xu(N,A)}))}),b=A=>{const N=y.value===A?null:A;y.value=N,N?localStorage.setItem(g(),N):localStorage.removeItem(g())};Ze(()=>r.eventData,A=>{d.value={...A},I.value=!1},{deep:!0});const C=()=>{u("update:formDirty",!0)},x=(A,N)=>{d.value[A]=N,C()},$=F(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),I=M(!1),S=A=>{I.value=A},B=A=>{d.value.brandingHeaderGradientStart=A.headerGradientStart,d.value.brandingHeaderGradientEnd=A.headerGradientEnd,d.value.brandingLogoUrl=A.logoUrl,d.value.brandingLogoPosition=A.logoPosition,d.value.brandingAccentColor=A.accentColor,d.value.brandingPageGradientStart=A.pageGradientStart,d.value.brandingPageGradientEnd=A.pageGradientEnd,C()},R=()=>{gS(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",I.value=!1,f.value?.resetLogo(),C()},Z=async()=>{if(!p.value){p.value=!0;try{if(I.value&&f.value){if(f.value.isLogoPendingDelete()){const N=await f.value.deleteStagedLogo();if(!N.success){console.error("Failed to delete logo:",N.error);return}d.value.brandingLogoUrl=""}else{const N=await f.value.uploadStagedLogo();if(!N.success){console.error("Failed to upload logo:",N.error);return}N.logoUrl&&!N.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=N.logoUrl)}I.value=!1}u("submit",{...d.value})}finally{p.value=!1}}};return(A,N)=>(v(),m("div",Rx,[l("div",Bx,[l("div",Nx,[l("button",{class:ve(["accordion-header",{active:y.value==="admins"}]),onClick:N[0]||(N[0]=O=>b("admins"))},[l("span",Fx,"Administrators ("+w(e.admins.length)+")",1),l("span",Ux,w(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(v(),m("div",zx,[Ae(C2,{admins:e.admins,onAddAdmin:N[1]||(N[1]=O=>A.$emit("add-admin")),onRemoveAdmin:N[2]||(N[2]=O=>A.$emit("remove-admin",O))},null,8,["admins"])])):E("",!0)]),l("div",Hx,[l("button",{class:ve(["accordion-header",{active:y.value==="terminology"}]),onClick:N[3]||(N[3]=O=>b("terminology"))},[N[19]||(N[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",Vx,w(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(v(),m("div",Gx,[N[20]||(N[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",jx,[l("div",Zx,[l("label",null,w(D(o).people)+" are called",1),Ue(l("select",{"onUpdate:modelValue":N[4]||(N[4]=O=>d.value.peopleTerm=O),class:"form-input",onChange:C},[(v(!0),m(Ie,null,Fe(D(Bs).people,O=>(v(),m("option",{key:O,value:O},w(O),9,Wx))),128))],544),[[Nn,d.value.peopleTerm]])]),l("div",qx,[l("label",null,w(D(o).checkpoints)+" are called",1),Ue(l("select",{"onUpdate:modelValue":N[5]||(N[5]=O=>d.value.checkpointTerm=O),class:"form-input",onChange:C},[(v(!0),m(Ie,null,Fe(k.value,O=>(v(),m("option",{key:O.value,value:O.value},w(O.label),9,Kx))),128))],544),[[Nn,d.value.checkpointTerm]])]),l("div",Jx,[l("label",null,w(D(o).areas)+" are called",1),Ue(l("select",{"onUpdate:modelValue":N[6]||(N[6]=O=>d.value.areaTerm=O),class:"form-input",onChange:C},[(v(!0),m(Ie,null,Fe(D(Bs).area,O=>(v(),m("option",{key:O,value:O},w(O),9,Yx))),128))],544),[[Nn,d.value.areaTerm]])]),l("div",Xx,[l("label",null,w(D(o).checklists)+" are called",1),Ue(l("select",{"onUpdate:modelValue":N[7]||(N[7]=O=>d.value.checklistTerm=O),class:"form-input",onChange:C},[(v(!0),m(Ie,null,Fe(D(Bs).checklist,O=>(v(),m("option",{key:O,value:O},w(O),9,Qx))),128))],544),[[Nn,d.value.checklistTerm]])]),l("div",eI,[l("label",null,w(D(o).course)+" is called",1),Ue(l("select",{"onUpdate:modelValue":N[8]||(N[8]=O=>d.value.courseTerm=O),class:"form-input",onChange:C},[(v(!0),m(Ie,null,Fe(D(Bs).course,O=>(v(),m("option",{key:O,value:O},w(O),9,tI))),128))],544),[[Nn,d.value.courseTerm]])])]),l("div",nI,[l("button",{onClick:Z,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,oI)])])):E("",!0)]),l("div",sI,[l("button",{class:ve(["accordion-header",{active:y.value==="appearance"}]),onClick:N[9]||(N[9]=O=>b("appearance"))},[l("span",aI,w(D(o).checkpoint)+" appearance",1),l("span",iI,w(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(v(),m("div",lI,[l("p",rI," Set the default marker style for all "+w(D(a).checkpoints)+" in this event. Individual "+w(D(a).areas)+" and "+w(D(a).checkpoints)+" can override this setting. ",1),Ae(ld,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":N[10]||(N[10]=O=>x("defaultCheckpointStyleType",O)),"onUpdate:styleColor":N[11]||(N[11]=O=>x("defaultCheckpointStyleColor",O)),"onUpdate:styleBackgroundShape":N[12]||(N[12]=O=>x("defaultCheckpointStyleBackgroundShape",O)),"onUpdate:styleBackgroundColor":N[13]||(N[13]=O=>x("defaultCheckpointStyleBackgroundColor",O)),"onUpdate:styleBorderColor":N[14]||(N[14]=O=>x("defaultCheckpointStyleBorderColor",O)),"onUpdate:styleIconColor":N[15]||(N[15]=O=>x("defaultCheckpointStyleIconColor",O)),"onUpdate:styleSize":N[16]||(N[16]=O=>x("defaultCheckpointStyleSize",O)),"onUpdate:styleMapRotation":N[17]||(N[17]=O=>x("defaultCheckpointStyleMapRotation",O))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",cI,[l("button",{onClick:Z,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,uI)])])):E("",!0)]),l("div",dI,[l("button",{class:ve(["accordion-header",{active:y.value==="branding"}]),onClick:N[18]||(N[18]=O=>b("branding"))},[l("span",hI,w(D(o).person)+" branding",1),l("span",fI,w(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(v(),m("div",pI,[l("p",vI," Customise the appearance of the "+w(D(a).person)+" view to match your organisation's branding. ",1),Ae(Ox,{ref_key:"brandingMockupRef",ref:f,branding:$.value,"event-name":d.value.name,"event-date":D(jv)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":B,onLogoStagedChange:S},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",mI,[l("button",{onClick:R,class:"btn btn-secondary",disabled:p.value}," Reset to default ",8,gI),l("button",{onClick:Z,class:"btn btn-primary",disabled:!e.formDirty&&!I.value||p.value},w(p.value?"Saving...":"Save"),9,yI)])])):E("",!0)])])]))}},_I=Ge(kI,[["__scopeId","data-v-bb7e241a"]]),bI={class:"incident-header"},wI={class:"incident-title-row"},CI={class:"incident-title"},LI={class:"incident-badges"},SI={key:0,class:"incident-description"},xI={class:"incident-context"},II={key:0,class:"context-item"},$I={key:1,class:"context-item"},TI={key:2,class:"context-item"},MI={class:"incident-footer"},AI={class:"reporter-info"},EI={class:"time-info"},PI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=F(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",r=u=>{if(!u)return"";const d=new Date(u),p=new Date-d,g=Math.floor(p/6e4),y=Math.floor(p/36e5),k=Math.floor(p/864e5);return g<1?"just now":g<60?`${g}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:ve(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=f=>u.$emit("select",e.incident))},[l("div",bI,[l("div",wI,[l("span",{class:ve(["severity-indicator",e.incident.severity])},null,2),l("strong",CI,w(o.value),1)]),l("div",LI,[l("span",{class:ve(["severity-badge",e.incident.severity])},w(a(e.incident.severity)),3),l("span",{class:ve(["status-badge",e.incident.status])},w(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",SI,w(i(e.incident.description)),1)):E("",!0),l("div",xI,[e.incident.context?.checkpoint?(v(),m("div",II,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",$I,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):E("",!0),e.incident.area?(v(),m("div",TI,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.area.areaName),1)])):E("",!0)]),l("div",MI,[l("span",AI," Reported by "+w(e.incident.reportedBy?.name||"Unknown"),1),l("span",EI,w(r(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},Yl=Ge(PI,[["__scopeId","data-v-690fd385"]]),DI={class:"incidents-tab"},OI={class:"tab-header"},RI={class:"button-group"},BI={key:0,class:"status-pills"},NI={class:"filters-section"},FI={class:"search-group"},UI={class:"incidents-list"},zI={key:0,class:"loading-state"},HI={key:1,class:"empty-state"},VI={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=M(""),s=M("all"),i=y=>{s.value=y},r=F(()=>o.incidents.filter(y=>y.status==="open").length),u=F(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=F(()=>o.incidents.filter(y=>y.status==="resolved").length),f=F(()=>o.incidents.filter(y=>y.status==="closed").length),p=F(()=>{let y=o.incidents;if(s.value==="open"?y=y.filter(k=>k.status==="open"):s.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):s.value==="resolved"?y=y.filter(k=>k.status==="resolved"):s.value==="closed"&&(y=y.filter(k=>k.status==="closed")),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(b=>{const C=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,x=b.area?.areaName||"",$=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map(B=>B.name||"")].join(" "),I=(b.updates||[]).map(B=>B.note||"").join(" "),S=`${b.title||""} ${b.description||""} ${C} ${x} ${$} ${I}`.toLowerCase();return k.every(B=>S.includes(B))})}return y}),g=F(()=>[...p.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(v(),m("div",DI,[l("div",OI,[l("div",RI,[l("button",{onClick:k[0]||(k[0]=b=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",BI,[Ae($n,{variant:"neutral",active:s.value==="all",onClick:k[1]||(k[1]=b=>i("all"))},{default:Ve(()=>[Ye(w(e.incidents.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe($n,{key:0,variant:"info",active:s.value==="open",onClick:k[2]||(k[2]=b=>i("open"))},{default:Ve(()=>[Ye(w(r.value)+" open ",1)]),_:1},8,["active"])):E("",!0),u.value>0?(v(),qe($n,{key:1,variant:"purple",active:s.value==="in-progress",onClick:k[3]||(k[3]=b=>i("in-progress"))},{default:Ve(()=>[Ye(w(u.value)+" in progress ",1)]),_:1},8,["active"])):E("",!0),d.value>0?(v(),qe($n,{key:2,variant:"success",active:s.value==="resolved",onClick:k[4]||(k[4]=b=>i("resolved"))},{default:Ve(()=>[Ye(w(d.value)+" resolved ",1)]),_:1},8,["active"])):E("",!0),f.value>0?(v(),qe($n,{key:3,variant:"neutral",active:s.value==="closed",onClick:k[5]||(k[5]=b=>i("closed"))},{default:Ve(()=>[Ye(w(f.value)+" closed ",1)]),_:1},8,["active"])):E("",!0)])):E("",!0)]),l("div",NI,[l("div",FI,[Ue(l("input",{"onUpdate:modelValue":k[6]||(k[6]=b=>a.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[at,a.value]])])]),l("div",UI,[e.loading?(v(),m("div",zI," Loading incidents... ")):p.value.length===0?(v(),m("div",HI,[l("p",null,w(a.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):E("",!0),(v(!0),m(Ie,null,Fe(g.value,b=>(v(),qe(Yl,{key:b.incidentId,incident:b,onSelect:C=>y.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},GI=Ge(VI,[["__scopeId","data-v-56bde653"]]),jI={class:"checkpoint-card-header"},ZI={class:"checkpoint-name-row"},WI=["innerHTML"],qI={class:"checkpoint-name"},KI={key:0,class:"checkpoint-description"},JI={key:0,class:"checkpoint-card-areas"},YI={class:"checkpoint-card-stats"},XI={key:1,class:"checkpoint-card-marshals"},QI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=x=>{const $=o.areas.find(I=>I.id===x);return $?$.name:null},r=x=>{const $=o.areas.find(I=>I.id===x);return $?$.color:"#999"},u=F(()=>{const x=o.checkpoint,$=x.resolvedStyleBackgroundColor||x.ResolvedStyleBackgroundColor||x.resolvedStyleColor||x.ResolvedStyleColor;return $||(s.value.length>0?r(s.value[0]):"#667eea")}),d=F(()=>{const x=o.checkpoint;return x.requiredMarshals===0?null:x.checkedInCount>=x.requiredMarshals?"full":x.checkedInCount>0?"partial":"none"}),f=F(()=>[...o.checkpoint.assignments||[]].sort(($,I)=>($.marshalName||"").localeCompare(I.marshalName||"",void 0,{sensitivity:"base"}))),p=F(()=>(o.checkpoint.assignments||[]).length),g=F(()=>(o.checkpoint.assignments||[]).filter(x=>x.isCheckedIn).length),y=F(()=>d.value?`staffing-${d.value}`:""),k=F(()=>{const x=p.value,$=g.value;return x===0?"":$===0?"checkin-none":$>=x?"checkin-full":"checkin-partial"}),b=F(()=>{const x=o.checkpoint,$=x.resolvedStyleType||x.ResolvedStyleType,I=x.resolvedStyleBackgroundColor||x.ResolvedStyleBackgroundColor||x.resolvedStyleColor||x.ResolvedStyleColor,S=x.resolvedStyleBorderColor||x.ResolvedStyleBorderColor,B=x.resolvedStyleIconColor||x.ResolvedStyleIconColor,R=x.resolvedStyleBackgroundShape||x.ResolvedStyleBackgroundShape;return $&&$!=="default"||I||S||B||R&&R!=="circle"?In({type:$||"circle",backgroundShape:R||"circle",backgroundColor:I||"#667eea",borderColor:S||"#ffffff",iconColor:B||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),C=()=>{o.clickable&&a("click",o.checkpoint)};return(x,$)=>(v(),m("div",{class:ve(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:et({borderLeftColor:u.value}),onClick:C},[l("div",jI,[l("div",{class:ve(["checkpoint-card-title",{clickable:e.clickable}])},[l("span",ZI,[l("span",{class:"checkpoint-icon",innerHTML:b.value},null,8,WI),l("span",qI,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",KI,"  "+w(e.checkpoint.description),1)):E("",!0)])],2)]),s.value.length>0?(v(),m("div",JI,[(v(!0),m(Ie,null,Fe(s.value,I=>(v(),m("span",{key:I,class:"area-badge",style:et({backgroundColor:r(I)})},w(i(I)),5))),128))])):E("",!0),l("div",YI,[l("span",{class:ve(["stat-badge staffing-badge",y.value])},w(e.checkpoint.checkedInCount)+"/"+w(e.checkpoint.requiredMarshals)+" staffed ",3),p.value>0?(v(),m("span",{key:0,class:ve(["stat-badge",k.value])},w(g.value)+"/"+w(p.value)+" checked in ",3)):E("",!0)]),f.value.length>0?(v(),m("div",XI,[(v(!0),m(Ie,null,Fe(f.value,I=>(v(),m("span",{key:I.id,class:ve(["marshal-badge",{"checked-in":I.isCheckedIn}])},w(I.marshalName),3))),128))])):E("",!0)],6))}},e$=Ge(QI,[["__scopeId","data-v-da001590"]]),Xv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(Jl,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(v(!0),m(Ie,null,Fe(e.checkpoints,a=>(v(),qe(e$,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},t$={class:"checkpoints-tab"},n$={class:"tab-header"},o$={class:"button-group"},s$={key:0,class:"status-pills"},a$={class:"filters-section"},i$={class:"search-group"},l$=["placeholder"],r$={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=dt(),o=e,a=M(""),s=M("all"),i=k=>{s.value=k},r=F(()=>o.locations.filter(k=>k.checkedInCount>=k.requiredMarshals&&k.requiredMarshals>0).length),u=F(()=>o.locations.filter(k=>k.checkedInCount>0&&k.checkedInCount<k.requiredMarshals).length),d=F(()=>o.locations.filter(k=>k.checkedInCount===0&&k.requiredMarshals>0).length),f=k=>{const b=o.areas.find(C=>C.id===k);return b?b.name:null},p=F(()=>{let k=o.locations;if(s.value==="full"?k=k.filter(b=>b.checkedInCount>=b.requiredMarshals&&b.requiredMarshals>0):s.value==="partial"?k=k.filter(b=>b.checkedInCount>0&&b.checkedInCount<b.requiredMarshals):s.value==="missing"&&(k=k.filter(b=>b.checkedInCount===0&&b.requiredMarshals>0)),a.value.trim()){const b=a.value.toLowerCase().trim().split(/\s+/);k=k.filter(C=>{const $=(C.areaIds||C.AreaIds||[]).map(B=>f(B)||"").join(" "),I=(C.assignments||[]).map(B=>B.marshalName||"").join(" "),S=`${C.name||""} ${C.description||""} ${$} ${I}`.toLowerCase();return b.every(B=>S.includes(B))})}return k}),g=F(()=>[...p.value].sort((k,b)=>js(k.name,b.name))),y=F(()=>{const k=a.value.trim();return s.value==="full"?k?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?k?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?k?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:k?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(k,b)=>(v(),m("div",t$,[l("div",n$,[l("div",o$,[l("button",{onClick:b[0]||(b[0]=C=>k.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+w(D(t).checkpoint),1),l("button",{onClick:b[1]||(b[1]=C=>k.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",s$,[Ae($n,{variant:"neutral",active:s.value==="all",onClick:b[2]||(b[2]=C=>i("all"))},{default:Ve(()=>[Ye(w(e.locations.length)+" total ",1)]),_:1},8,["active"]),r.value>0?(v(),qe($n,{key:0,variant:"success",active:s.value==="full",onClick:b[3]||(b[3]=C=>i("full"))},{default:Ve(()=>[Ye(w(r.value)+" fully staffed ",1)]),_:1},8,["active"])):E("",!0),u.value>0?(v(),qe($n,{key:1,variant:"warning",active:s.value==="partial",onClick:b[4]||(b[4]=C=>i("partial"))},{default:Ve(()=>[Ye(w(u.value)+" partial ",1)]),_:1},8,["active"])):E("",!0),d.value>0?(v(),qe($n,{key:2,variant:"danger",active:s.value==="missing",onClick:b[5]||(b[5]=C=>i("missing"))},{default:Ve(()=>[Ye(w(d.value)+" unstaffed ",1)]),_:1},8,["active"])):E("",!0)])):E("",!0)]),l("div",a$,[l("div",i$,[Ue(l("input",{"onUpdate:modelValue":b[6]||(b[6]=C=>a.value=C),type:"text",class:"search-input",placeholder:`Search by name, description, ${D(t).area}, or ${D(t).person}...`},null,8,l$),[[at,a.value]])])]),Ae(Xv,{checkpoints:g.value,areas:e.areas,"empty-message":y.value,onSelect:b[7]||(b[7]=C=>k.$emit("select-location",C))},null,8,["checkpoints","areas","empty-message"])]))}},c$=Ge(r$,[["__scopeId","data-v-35be2364"]]),u$={class:"area-card-header"},d$={class:"area-name-row"},h$={class:"area-name"},f$={key:0,class:"default-badge"},p$={key:0,class:"area-description"},v$={class:"area-card-stats"},m$={class:"stat-badge"},g$={class:"stat-badge"},y$={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(o.area.id)||p.areaId===o.area.id).length),i=F(()=>o.contacts.filter(p=>p.scopeConfigurations?p.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),r=F(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=F(()=>{const p=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Ja("checkpoint",p,r.value):Hv("checkpoint",p,r.value)}),d=F(()=>`${s.value} ${u.value.toLowerCase()}`),f=()=>{o.clickable&&a("click",o.area)};return(p,g)=>(v(),m("div",{class:ve(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:et({borderLeftColor:e.area.color||"#667eea"}),onClick:f},[l("div",u$,[l("div",{class:ve(["area-card-title",{clickable:e.clickable}])},[l("div",d$,[l("span",h$,w(e.area.name),1),e.area.isDefault?(v(),m("span",f$,"Default")):E("",!0)]),e.area.description?(v(),m("span",p$,w(e.area.description),1)):E("",!0)],2)]),l("div",v$,[l("span",m$,w(d.value),1),l("span",g$,w(i.value)+" contact"+w(i.value===1?"":"s"),1)])],6))}},k$=Ge(y$,[["__scopeId","data-v-8ac20bf2"]]),_$={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),qe(Jl,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ve(()=>[(v(!0),m(Ie,null,Fe(e.areas,a=>(v(),qe(k$,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},b$={class:"areas-tab"},w$={class:"tab-header"},C$={class:"button-group"},L$={key:0,class:"status-pills"},S$={class:"filters-section"},x$={class:"search-group"},I$=["placeholder"],$$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=dt(),o=e,a=M(""),s=d=>o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(d)||f.areaId===d),i=F(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(f=>{const g=s(f.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${f.name||""} ${f.description||""} ${g}`.toLowerCase();return d.every(k=>y.includes(k))})}),r=F(()=>[...i.value].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:js(d.name,f.name))),u=F(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,f)=>(v(),m("div",b$,[l("div",w$,[l("div",C$,[l("button",{onClick:f[0]||(f[0]=p=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+w(D(t).area),1)]),e.areas.length>0?(v(),m("div",L$,[Ae($n,{variant:"neutral",active:!1},{default:Ve(()=>[Ye(w(e.areas.length)+" "+w(e.areas.length===1?D(t).area:D(t).areas),1)]),_:1})])):E("",!0)]),l("div",S$,[l("div",x$,[Ue(l("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>a.value=p),type:"text",class:"search-input",placeholder:`Search by ${D(t).area} name or ${D(t).checkpoint} name...`},null,8,I$),[[at,a.value]])])]),Ae(_$,{areas:r.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:f[2]||(f[2]=p=>d.$emit("select-area",p))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},T$=Ge($$,[["__scopeId","data-v-203f9606"]]),M$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Jn=e=>M$[e]||"",A$={class:"responsive-tabs"},E$=["onClick"],P$=["innerHTML"],D$=["innerHTML"],O$={class:"hamburger-label"},R$=["onClick"],B$=["innerHTML"],N$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(null),r=M(null),u=M(!1),d=M({}),f=M(!1),p=F(()=>o.tabs.find($=>$.value===o.modelValue)),g=F(()=>p.value?p.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&i.value){const $=i.value.getBoundingClientRect();d.value={top:`${$.bottom+4}px`}}},k=$=>{a("update:modelValue",$),u.value=!1},b=$=>{if(!s.value)return;const I=s.value.contains($.target);u.value&&!I&&(u.value=!1)},C=()=>{if(!r.value)return;const $=r.value,I=f.value;I&&($.style.visibility="visible",$.style.position="static");const S=$.scrollWidth>$.clientWidth;I&&($.style.visibility="",$.style.position=""),f.value=S};let x=null;return tn(()=>{document.addEventListener("click",b),sn(()=>{C()}),sn(()=>{const $=r.value?.parentElement;$&&(x=new ResizeObserver(()=>{C()}),x.observe($))})}),yn(()=>{document.removeEventListener("click",b),x&&x.disconnect()}),Ze(()=>o.tabs,()=>{sn(()=>{C()})},{deep:!0}),($,I)=>(v(),m("div",A$,[l("div",{ref_key:"visibleTabsRef",ref:r,class:ve(["visible-tabs",{"is-hidden":f.value}])},[(v(!0),m(Ie,null,Fe(e.tabs,S=>(v(),m("button",{key:S.value,class:ve(["tab-button",{active:e.modelValue===S.value}]),onClick:B=>$.$emit("update:modelValue",S.value),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Jn)(S.icon)},null,8,P$)):E("",!0),Ye(" "+w(S.label),1)],10,E$))),128))],2),l("div",{class:ve(["hamburger-only",{"is-visible":f.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:i,class:ve(["hamburger-button",{active:u.value}]),onClick:it(y,["stop"]),type:"button"},[I[1]||(I[1]=l("span",{class:"hamburger-icon"},"",-1)),p.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Jn)(p.value.icon)},null,8,D$)):E("",!0),l("span",O$,w(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:et(d.value),onClick:I[0]||(I[0]=it(()=>{},["stop"]))},[(v(!0),m(Ie,null,Fe(e.tabs,S=>(v(),m("button",{key:S.value,class:ve(["dropdown-item",{active:e.modelValue===S.value}]),onClick:it(B=>k(S.value),["stop"]),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Jn)(S.icon)},null,8,B$)):E("",!0),Ye(" "+w(S.label),1)],10,R$))),128))],4)):E("",!0)],512)],2)]))}},F$=Ge(N$,[["__scopeId","data-v-2467c6fc"]]),U$={class:"instruction"},z$={class:"share-link-container"},H$=["value"],V$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=t,i=M(!1),r=M(null),u=()=>{r.value&&(r.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{s("close")};return(f,p)=>(v(),qe(jt,{show:e.show,title:`${D(o).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[l("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[l("p",U$,"Share this link with "+w(D(a).peoplePlural)+" so they can check in:",1),l("div",z$,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:r},null,8,H$),l("button",{onClick:u,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},G$=Ge(V$,[["__scopeId","data-v-b037c39b"]]),j$={class:"success-content"},Z$={class:"success-message"},W$={class:"link-section"},q$={class:"help-text"},K$={key:0,class:"loading-text"},J$={key:1,class:"magic-link-container"},Y$=["value"],X$={class:"magic-link-actions"},Q$=["disabled"],eT={key:0,class:"success-text"},tT={key:1,class:"error-text"},nT={key:2,class:"error-text"},oT={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=dt(),a=e,s=t,i=M(""),r=M(!1),u=M(!1),d=M(""),f=M(!1),p=M(!1),g=M(!1),y=M(""),k=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const $=await gs.getMagicLink(a.eventId,a.marshalId);i.value=$.data.magicLink,r.value=$.data.hasEmail}catch($){console.error("Failed to fetch magic link:",$),d.value="Failed to load login link"}finally{u.value=!1}}},b=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const $=document.createElement("textarea");$.value=i.value,$.style.position="fixed",$.style.left="-9999px",document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($)}f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch($){console.error("Failed to copy:",$)}},C=async()=>{if(!(!a.eventId||!a.marshalId)){p.value=!0,g.value=!1,y.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch($){console.error("Failed to send email:",$),y.value=$.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},x=()=>{s("close")};return Ze(()=>a.show,$=>{$&&a.marshalId?k():(i.value="",r.value=!1,d.value="",f.value=!1,g.value=!1,y.value="")},{immediate:!0}),($,I)=>(v(),qe(jt,{show:e.show,title:`${D(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:x},{actions:Ve(()=>[l("button",{onClick:x,class:"btn btn-primary"},"Done")]),default:Ve(()=>[l("div",j$,[I[2]||(I[2]=l("div",{class:"success-icon"},"",-1)),l("p",Z$,[l("strong",null,w(e.marshalName),1),I[1]||(I[1]=Ye(" has been added successfully. ",-1))])]),l("div",W$,[I[3]||(I[3]=l("label",null,"Login link",-1)),l("p",q$," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",K$,"Loading link...")):i.value?(v(),m("div",J$,[l("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:I[0]||(I[0]=S=>S.target.select())},null,40,Y$),l("div",X$,[l("button",{type:"button",class:"btn btn-secondary",onClick:b},w(f.value?"Copied!":"Copy link"),1),r.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:C},w(p.value?"Sending...":"Send via email"),9,Q$)):E("",!0)]),g.value?(v(),m("p",eT,"Email sent successfully!")):E("",!0),y.value?(v(),m("p",tT,w(y.value),1)):E("",!0)])):d.value?(v(),m("div",nT,w(d.value),1)):E("",!0)])]),_:1},8,["show","title"]))}},sT=Ge(oT,[["__scopeId","data-v-e99677e9"]]),aT={class:"form-group"},iT={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M("");Ze(()=>o.show,d=>{d||(s.value="")});const i=()=>{a("update:isDirty",!0)},r=()=>{a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),qe(jt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ve(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary"}," Add administrator ")]),default:Ve(()=>[f[2]||(f[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",aT,[f[1]||(f[1]=l("label",null,"Email address",-1)),Ue(l("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[at,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},lT=Ge(iT,[["__scopeId","data-v-a82da194"]]),rT={class:"form-group"},cT={key:0,class:"error"},uT=["disabled"],dT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M(null);Ze(()=>o.show,d=>{d||(s.value=null)});const i=d=>{s.value=d.target.files[0],a("update:isDirty",!0)},r=()=>{s.value&&a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),qe(jt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ve(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:r,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,uT)]),default:Ve(()=>[f[1]||(f[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:it(r,["prevent"])},[l("div",rT,[f[0]||(f[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",cT,w(e.error),1)):E("",!0)],32)]),_:1},8,["show","is-dirty"]))}},hT=Ge(dT,[["__scopeId","data-v-317975db"]]),fT={class:"instruction"},pT={class:"form-group"},vT={class:"form-group"},mT={class:"checkbox-label"},gT={key:0,class:"error"},yT={key:1,class:"import-result"},kT={key:0,class:"import-errors"},_T=["disabled"],bT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=t,r=M(null),u=M(!1);Ze(()=>s.show,y=>{y||(r.value=null,u.value=!1)});const d=y=>{r.value=y.target.files[0],i("update:isDirty",!0)},f=()=>{i("update:isDirty",!0)},p=()=>{r.value&&i("submit",{file:r.value,deleteExisting:u.value})},g=()=>{i("close")};return(y,k)=>(v(),qe(jt,{show:e.show,title:`Import ${D(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:Ve(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${D(a).checkpoints}`),9,_T)]),default:Ve(()=>[l("p",fT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(D(o).people)+" (optional)",1),k[3]||(k[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:it(p,["prevent"])},[l("div",pT,[k[1]||(k[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",vT,[l("label",mT,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=b=>u.value=b),onChange:f},null,544),[[Gs,u.value]]),Ye(" Delete existing "+w(D(a).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",gT,w(e.error),1)):E("",!0),e.result?(v(),m("div",yT,[l("p",null,"Created "+w(e.result.locationsCreated)+" "+w(D(a).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",kT,[k[2]||(k[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Ie,null,Fe(e.result.errors,(b,C)=>(v(),m("li",{key:C},w(b),1))),128))])])):E("",!0)])):E("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},wT=Ge(bT,[["__scopeId","data-v-75c79d31"]]),CT={class:"instruction"},LT={class:"form-group"},ST={key:0,class:"error"},xT={key:1,class:"import-result"},IT={key:0,class:"import-errors"},$T=["disabled"],TT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=t,r=M(null);Ze(()=>s.show,p=>{p||(r.value=null)});const u=p=>{r.value=p.target.files[0],i("update:isDirty",!0)},d=()=>{r.value&&i("submit",r.value)},f=()=>{i("close")};return(p,g)=>(v(),qe(jt,{show:e.show,title:`Import ${D(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{actions:Ve(()=>[l("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${D(a).people}`),9,$T)]),default:Ve(()=>[l("p",CT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(D(o).checkpoint)+" (optional)",1),g[2]||(g[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:it(d,["prevent"])},[l("div",LT,[g[0]||(g[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",ST,w(e.error),1)):E("",!0),e.result?(v(),m("div",xT,[l("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(D(a).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",IT,[g[1]||(g[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Ie,null,Fe(e.result.errors,(y,k)=>(v(),m("li",{key:k},w(y),1))),128))])])):E("",!0)])):E("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},MT=Ge(TT,[["__scopeId","data-v-be89bf1f"]]),AT=["onClick"],ET=["innerHTML"],PT={class:"hamburger-nav"},DT=["disabled"],OT=["innerHTML"],RT={class:"current-tab-label"},BT=["disabled"],NT={key:0,class:"hamburger-menu"},FT=["onClick"],UT=["innerHTML"],zT=400,HT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(null),r=M(null),u=M(!1),d=M(!1),f=F(()=>{const R=o.tabs.find(Z=>Z.value===o.modelValue);return R?R.label:""}),p=F(()=>o.tabs.find(Z=>Z.value===o.modelValue)?.icon||null),g=F(()=>o.tabs.findIndex(R=>R.value===o.modelValue)),y=F(()=>g.value>0),k=F(()=>g.value<o.tabs.length-1),b=()=>{y.value&&a("update:modelValue",o.tabs[g.value-1].value)},C=()=>{k.value&&a("update:modelValue",o.tabs[g.value+1].value)},x=()=>{if(!s.value)return;const R=s.value.clientWidth;if(R<zT){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>R&&(u.value=!0);return}const Z=o.tabs.some(O=>O.icon)?110:90,A=o.tabs.length*Z,N=(o.tabs.length-1)*8;A+N<=R&&(u.value=!1,sn(()=>{i.value&&i.value.scrollWidth>R&&(u.value=!0)}))},$=()=>{d.value=!d.value},I=R=>{a("update:modelValue",R),d.value=!1},S=R=>{r.value&&!r.value.contains(R.target)&&(d.value=!1)};let B=null;return tn(()=>{sn(()=>{x(),s.value&&typeof ResizeObserver<"u"&&(B=new ResizeObserver(()=>{x()}),B.observe(s.value)),document.addEventListener("click",S)})}),yn(()=>{B&&B.disconnect(),document.removeEventListener("click",S)}),Ze(()=>o.tabs,()=>{sn(()=>{x()})},{deep:!0}),(R,Z)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:r},[l("div",PT,[l("button",{class:ve(["nav-arrow",{invisible:!y.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,DT),l("button",{class:"hamburger-button",onClick:$,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:D(Jn)(p.value)},null,8,OT)):E("",!0),l("span",RT,w(f.value),1),Z[0]||(Z[0]=l("span",{class:"hamburger-chevron"},"",-1))]),l("button",{class:ve(["nav-arrow",{invisible:!k.value}]),onClick:C,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,BT)]),d.value?(v(),m("div",NT,[(v(!0),m(Ie,null,Fe(e.tabs,A=>(v(),m("button",{key:A.value,class:ve(["menu-item",{active:e.modelValue===A.value}]),onClick:N=>I(A.value),type:"button"},[A.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Jn)(A.icon)},null,8,UT)):E("",!0),Ye(" "+w(A.label),1)],10,FT))),128))])):E("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),m(Ie,null,Fe(e.tabs,A=>(v(),m("button",{key:A.value,class:ve(["tab-button",{active:e.modelValue===A.value}]),onClick:N=>R.$emit("update:modelValue",A.value),type:"button"},[A.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:D(Jn)(A.icon)},null,8,ET)):E("",!0),Ye(" "+w(A.label),1)],10,AT))),128))],512))],512))}},Ji=Ge(HT,[["__scopeId","data-v-736c5d0a"]]),VT={class:"tab-content"},GT={class:"form-group"},jT=["value"],ZT={class:"form-group"},WT=["value"],qT={class:"form-group"},KT={class:"area-display"},JT={key:0,class:"no-area"},YT={class:"form-help"},XT={class:"form-group checkbox-group"},QT={class:"checkbox-label"},eM=["checked"],tM={class:"form-help"},nM={key:0,class:"custom-times-section"},oM={class:"form-group"},sM=["value"],aM={class:"form-help"},iM={class:"form-group"},lM=["value"],rM={class:"form-help"},cM={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(f=>f.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},r=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const f=zl(o.eventDate);d.startTime=f,d.endTime=f}a("update:form",d),a("input")};return(u,d)=>(v(),m("div",VT,[l("form",{onSubmit:d[5]||(d[5]=it(f=>u.$emit("save"),["prevent"]))},[l("div",GT,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=f=>i("name",f.target.value)),type:"text",required:"",class:"form-input"},null,40,jT)]),l("div",ZT,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=f=>i("description",f.target.value)),type:"text",class:"form-input"},null,40,WT)]),l("div",qT,[l("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",KT,[s.value.length===0?(v(),m("span",JT," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):E("",!0),(v(!0),m(Ie,null,Fe(s.value,f=>(v(),m("span",{key:f.id,class:"area-badge",style:et({backgroundColor:f.color||"var(--brand-primary)"})},w(f.name),5))),128))]),l("small",YT,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",XT,[l("label",QT,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=f=>r(f.target.checked)),type:"checkbox"},null,40,eM),l("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("small",tM," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",nM,[l("div",oM,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=f=>i("startTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,sM),l("small",aM," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("div",iM,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=f=>i("endTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,lM),l("small",rM," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):E("",!0)],32)]))}},uM=Ge(cM,[["__scopeId","data-v-aa628901"]]),dM={class:"scope-configuration-editor"},hM={class:"editor-header"},fM={class:"scope-types-list"},pM=["onClick"],vM={class:"scope-type-label"},mM={class:"scope-type-pill"},gM={class:"expand-label"},yM={class:"expand-icon"},kM={class:"modal-content"},_M={class:"modal-header"},bM={class:"modal-body"},wM={class:"scope-help"},CM={key:0,class:"form-group"},LM={class:"checkbox-label special-option"},SM=["checked"],xM={key:0,class:"specific-selection"},IM=["placeholder"],$M={class:"checkbox-group scrollable"},TM=["checked","onChange"],MM={key:1,class:"form-group"},AM={class:"checkbox-label special-option"},EM=["checked"],PM={key:0,class:"specific-selection"},DM={class:"checkbox-group scrollable"},OM=["checked","onChange"],RM={key:2,class:"form-group"},BM={class:"checkbox-label special-option"},NM=["checked"],FM={key:0,class:"specific-selection"},UM=["placeholder"],zM={class:"checkbox-group scrollable"},HM={key:0,class:"checkbox-label this-checkpoint-option"},VM=["checked"],GM={class:"checkpoint-info"},jM={class:"checkpoint-name"},ZM=["checked","onChange"],WM={class:"checkpoint-info"},qM={class:"checkpoint-name"},KM={key:0,class:"checkpoint-description"},JM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=F(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),r=M({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=M(null),d=M(""),f=M(""),p=M(!a.isEditing);let g=!0,y=!1;const k=F(()=>i.value.filter(te=>!a.excludeScopes.includes(te.scope))),b=F(()=>p.value?k.value:k.value.filter(te=>V(te.scope))),C=F(()=>k.value.filter(ge=>V(ge.scope)).length<k.value.length),x=F(()=>{const te=k.value.filter(ge=>V(ge.scope)).length;return k.value.length-te}),$=F(()=>!a.currentCheckpointId&&a.intent==="location-update");Ze(()=>a.modelValue,te=>{if(te){if(y){y=!1;return}g=!0,Object.keys(r.value).forEach(ge=>{r.value[ge]={enabled:!1,ids:[]}}),te.forEach(ge=>{ge.scope==="Everyone"?r.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:ge.scope==="AreaLead"?r.value.EveryAreaLead={enabled:!0,ids:[...ge.ids]}:r.value[ge.scope]&&(r.value[ge.scope]={enabled:!0,ids:[...ge.ids]})}),g=!1}},{immediate:!0});const I=()=>{const te=[];return Object.keys(r.value).forEach(ge=>{const he=r.value[ge];if(he.enabled){const G={scope:ge,itemType:S(ge),ids:[...he.ids]};te.push(G)}}),te};Ze(r,()=>{if(g)return;if(Object.keys(r.value).some(he=>he!=="SpecificPeople"&&r.value[he].enabled)&&r.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const he=r.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");r.value.SpecificPeople.ids.splice(he,1),r.value.SpecificPeople.ids.length===0&&(r.value.SpecificPeople.enabled=!1)}y=!0;const ge=I();s("update:modelValue",ge),s("user-changed")},{deep:!0});const S=te=>B(te)?"Area":R(te)?"Checkpoint":Z(te)?"Marshal":null,B=te=>te==="EveryoneInAreas"||te==="OnePerArea"||te==="EveryAreaLead"||te==="OneLeadPerArea",R=te=>te==="EveryoneAtCheckpoints"||te==="OnePerCheckpoint",Z=te=>te==="SpecificPeople",A=te=>{const ge=i.value.find(he=>he.scope===te);return ge?ge.label:te},N=F(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${o.value.checklist}?`),O=te=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[te]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[te]||"",V=te=>r.value[te]?.enabled||!1,P=te=>{const ge=r.value[te];if(!ge||!ge.enabled)return"No";const he=ge.ids||[];if(B(te)){if(he.includes("ALL_AREAS"))return`All ${o.value.areas}`;const G=he.length;return G>0?`${G} ${G!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(R(te)){if(he.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(he.length===1&&he[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const G=he.length;return G>0?`${G} ${G!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(Z(te)){if(he.includes("ALL_MARSHALS"))return"Everyone";const G=he.length;return G>0?`${G} ${G!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},j=te=>{u.value=te,d.value="",f.value=""},Q=()=>{u.value=null},ae=()=>{u.value&&(r.value[u.value]={enabled:!1,ids:[]}),Q()},pe=()=>u.value&&r.value[u.value]?.ids.includes("ALL_MARSHALS"),ne=()=>{if(!u.value)return;const te=r.value[u.value];pe()?(te.ids=[],te.enabled=!1):(te.ids=["ALL_MARSHALS"],te.enabled=!0)},oe=te=>u.value&&r.value[u.value]?.ids.includes(te),U=te=>{if(!u.value)return;const ge=r.value[u.value],he=ge.ids.indexOf(te);he>=0?(ge.ids.splice(he,1),ge.ids.length===0&&(ge.enabled=!1)):(ge.ids.push(te),ge.enabled=!0)},Y=F(()=>{if(!f.value)return a.marshals;const te=f.value.toLowerCase();return a.marshals.filter(ge=>ge.name.toLowerCase().includes(te)||ge.email&&ge.email.toLowerCase().includes(te))}),de=()=>u.value&&r.value[u.value]?.ids.includes("ALL_AREAS"),ke=()=>{if(!u.value)return;const te=r.value[u.value];de()?(te.ids=[],te.enabled=!1):(te.ids=["ALL_AREAS"],te.enabled=!0)},Re=te=>u.value&&r.value[u.value]?.ids.includes(te),Xe=te=>{if(!u.value)return;const ge=r.value[u.value],he=ge.ids.indexOf(te);he>=0?(ge.ids.splice(he,1),ge.ids.length===0&&(ge.enabled=!1)):(ge.ids.push(te),ge.enabled=!0)},Ne=()=>u.value&&r.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),ze=()=>{if(!u.value)return;const te=r.value[u.value];Ne()?(te.ids=[],te.enabled=!1):(te.ids=["ALL_CHECKPOINTS"],te.enabled=!0)},We=te=>u.value&&r.value[u.value]?.ids.includes(te),ee=te=>{if(!u.value)return;const ge=r.value[u.value],he=ge.ids.indexOf(te);he>=0?(ge.ids.splice(he,1),ge.ids.length===0&&(ge.enabled=!1)):(ge.ids.push(te),ge.enabled=!0)},ye=F(()=>{let te=a.locations;if(d.value){const ge=d.value.toLowerCase();te=te.filter(he=>he.name.toLowerCase().includes(ge)||he.description&&he.description.toLowerCase().includes(ge))}return[...te].sort((ge,he)=>js(ge.name,he.name))});return(te,ge)=>(v(),m("div",dM,[l("div",hM,[l("h4",null,w(N.value),1)]),l("div",fM,[(v(!0),m(Ie,null,Fe(b.value,he=>(v(),m("div",{key:he.scope,class:ve(["scope-type-row",{active:V(he.scope)}]),onClick:G=>j(he.scope)},[l("div",vM,w(he.label),1),l("div",mM,w(P(he.scope)),1)],10,pM))),128)),C.value?(v(),m("div",{key:0,class:"expand-row",onClick:ge[0]||(ge[0]=he=>p.value=!p.value)},[l("div",gM,w(p.value?"Show less":`Show ${x.value} more option${x.value!==1?"s":""}...`),1),l("div",yM,w(p.value?"":""),1)])):E("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:it(Q,["self"])},[l("div",kM,[l("div",_M,[l("h5",null,w(A(u.value)),1),l("button",{onClick:Q,class:"btn-close",type:"button"},"")]),l("div",bM,[l("p",wM,w(O(u.value)),1),Z(u.value)?(v(),m("div",CM,[l("label",LM,[l("input",{type:"checkbox",checked:pe(),onChange:ne},null,40,SM),l("span",null,[ge[4]||(ge[4]=l("strong",null,"Everyone at the event",-1)),Ye(" (all current and future "+w(D(o).people)+")",1)])]),pe()?E("",!0):(v(),m("div",xM,[Ue(l("input",{"onUpdate:modelValue":ge[1]||(ge[1]=he=>f.value=he),type:"text",placeholder:`Search ${D(o).people}...`,class:"search-input"},null,8,IM),[[at,f.value]]),l("div",$M,[(v(!0),m(Ie,null,Fe(Y.value,he=>(v(),m("label",{key:he.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:oe(he.id),onChange:G=>U(he.id)},null,40,TM),l("span",null,w(he.name),1)]))),128))])]))])):E("",!0),B(u.value)?(v(),m("div",MM,[l("label",AM,[l("input",{type:"checkbox",checked:de(),onChange:ke},null,40,EM),l("span",null,[l("strong",null,"All "+w(D(o).areas),1),Ye(" (includes future "+w(D(o).areas)+")",1)])]),de()?E("",!0):(v(),m("div",PM,[l("div",DM,[(v(!0),m(Ie,null,Fe(e.areas,he=>(v(),m("label",{key:he.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Re(he.id),onChange:G=>Xe(he.id)},null,40,OM),l("span",{class:"area-color-dot",style:et({backgroundColor:he.color||"#667eea"})},null,4),l("span",null,w(he.name),1)]))),128))])]))])):E("",!0),R(u.value)?(v(),m("div",RM,[l("label",BM,[l("input",{type:"checkbox",checked:Ne(),onChange:ze},null,40,NM),l("span",null,[l("strong",null,"All "+w(D(o).checkpoints),1),Ye(" (includes future "+w(D(o).checkpoints)+")",1)])]),Ne()?E("",!0):(v(),m("div",FM,[Ue(l("input",{"onUpdate:modelValue":ge[2]||(ge[2]=he=>d.value=he),type:"text",placeholder:`Search ${D(o).checkpoints}...`,class:"search-input"},null,8,UM),[[at,d.value]]),l("div",zM,[$.value?(v(),m("label",HM,[l("input",{type:"checkbox",checked:We("THIS_CHECKPOINT"),onChange:ge[3]||(ge[3]=he=>ee("THIS_CHECKPOINT"))},null,40,VM),l("div",GM,[l("span",jM,[l("strong",null,"This "+w(D(o).checkpoint),1)])])])):E("",!0),(v(!0),m(Ie,null,Fe(ye.value,he=>(v(),m("label",{key:he.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:We(he.id),onChange:G=>ee(he.id)},null,40,ZM),l("div",WM,[l("span",qM,w(he.name),1),he.description?(v(),m("span",KM," - "+w(he.description),1)):E("",!0)])]))),128))])]))])):E("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:ae,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:Q,class:"btn btn-primary",type:"button"},"Done")])])])):E("",!0)]))}},yc=Ge(JM,[["__scopeId","data-v-3107d36b"]]),YM={class:"tab-content"},XM={class:"form-group"},QM=["value"],eA={key:0,class:"form-error"},tA={class:"form-row"},nA={class:"form-group"},oA=["disabled"],sA={class:"form-group"},aA=["disabled"],iA={class:"form-group"},lA={class:"accordion-item"},rA={class:"accordion-preview"},cA={class:"accordion-arrow"},uA={key:0,class:"accordion-content"},dA={class:"section-description"},hA={class:"dynamic-checkbox"},fA=["checked"],pA={key:0,class:"dynamic-settings"},vA={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,s=M(!1),i=M(""),r=M(""),u=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ze(()=>o.form.longitude,k=>{i.value=u(k)},{immediate:!0}),Ze(()=>o.form.latitude,k=>{r.value=u(k)},{immediate:!0});const d=k=>{const b=k==="longitude"?i:r,C=parseFloat(b.value);isNaN(C)?b.value.trim()===""&&(a("update:form",{...o.form,[k]:0}),a("input"),b.value=u(0)):(a("update:form",{...o.form,[k]:C}),a("input"),b.value=u(C))},f=(k,b)=>{a("update:form",{...o.form,[k]:b}),a("input")},p=k=>{if(k){const b=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],C=o.form.locationUpdateScopeConfigurations||[],x=C.length>0?C:b;a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else a("update:form",{...o.form,isDynamic:!1});a("input")},g=k=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:k}),a("input")},y=k=>{if(!k)return!0;const b=k.includes(".")?k.split("."):k.split("/");if(b.length!==3)return!1;const C=/^[a-z]{1,20}$/;return b.every(x=>C.test(x))};return(k,b)=>(v(),m("div",YM,[l("form",{onSubmit:b[6]||(b[6]=it(C=>k.$emit("save"),["prevent"]))},[l("div",XM,[b[10]||(b[10]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=C=>f("what3Words",C.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,QM),e.form.what3Words&&!y(e.form.what3Words)?(v(),m("small",eA," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):E("",!0)]),e.form.isDynamic?E("",!0):(v(),m(Ie,{key:0},[l("div",tA,[l("div",nA,[b[11]||(b[11]=l("label",null,"Longitude",-1)),Ue(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>i.value=C),onBlur:b[2]||(b[2]=C=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,oA),[[at,i.value]])]),l("div",sA,[b[12]||(b[12]=l("label",null,"Latitude",-1)),Ue(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>r.value=C),onBlur:b[4]||(b[4]=C=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,aA),[[at,r.value]])])]),l("div",iA,[l("button",{type:"button",onClick:b[5]||(b[5]=C=>k.$emit("move-location")),class:ve(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ye(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",lA,[l("button",{type:"button",class:ve(["accordion-header",{expanded:s.value}]),onClick:b[7]||(b[7]=C=>s.value=!s.value)},[b[14]||(b[14]=Dr('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),l("span",rA,w(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",cA,w(s.value?"":""),1)],2),s.value?(v(),m("div",uA,[l("p",dA," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",hA,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=C=>p(C.target.checked))},null,40,fA),l("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",pA,[Ae(yc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:b[9]||(b[9]=C=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):E("",!0)])):E("",!0)])]))}},mA=Ge(vA,[["__scopeId","data-v-c3ce308d"]]);function Qv(e){const t=M(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const y=!o(p);y===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,y),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const gA={class:"card-main"},yA={class:"card-title"},kA={class:"marshal-name"},_A={key:0,class:"card-check-in"},bA={class:"toggle-icon"},wA={class:"toggle-label"},CA={key:0,class:"check-in-time"},LA={key:0,class:"check-in-method"},SA={key:1,class:"unsaved-indicator"},xA={key:1,class:"card-status-readonly"},IA={class:"status-icon"},$A={key:0,class:"check-in-time"},TA={key:0,class:"check-in-method"},MA={key:2,class:"card-badge"},AA={key:3,class:"card-badge"},EA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const o=e,a=t,s=()=>{a("distance-click",o.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",r=F(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:b}=o.assignment;return y&&y!==b?y:k||""}),u=F(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),d=F(()=>{const{checkInLatitude:y,checkInLongitude:k}=o.assignment,b=o.location;return!y||!k||!b?.latitude||!b?.longitude?null:li(y,k,b.latitude,b.longitude)}),f=F(()=>d.value===null?null:Rb(d.value)),p=F(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),g=()=>{u.value&&a("click",o.assignment)};return(y,k)=>(v(),m("div",{class:ve(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":u.value}]),onClick:g},[l("div",gA,[l("div",yA,[l("span",kA,w(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",_A,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=it(b=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[l("span",bA,w(e.effectiveCheckInStatus?"":""),1),l("span",wA,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",CA,[Ye(w(i(e.assignment.checkInTime))+" ",1),r.value?(v(),m("span",LA,"("+w(r.value)+")",1)):E("",!0),f.value?(v(),m("span",{key:1,class:ve(["check-in-distance",p.value]),onClick:it(s,["stop"])},w(f.value),3)):E("",!0)])):e.hasUnsavedChanges?(v(),m("span",SA," Unsaved ")):E("",!0)])):E("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",xA,[l("span",{class:ve(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[l("span",IA,w(e.effectiveCheckInStatus?"":""),1),Ye(" "+w(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",$A,[Ye(w(i(e.assignment.checkInTime))+" ",1),r.value?(v(),m("span",TA,"("+w(r.value)+")",1)):E("",!0),f.value?(v(),m("span",{key:1,class:ve(["check-in-distance",p.value]),onClick:it(s,["stop"])},w(f.value),3)):E("",!0)])):E("",!0)])):E("",!0),e.assignment.isPending?(v(),m("div",MA,[...k[3]||(k[3]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):E("",!0),e.isMarkedForRemoval?(v(),m("div",AA,[...k[4]||(k[4]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):E("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=it(b=>y.$emit("remove",e.assignment),["stop"]))},"  ")):E("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=it(b=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):E("",!0)],2))}},PA=Ge(EA,[["__scopeId","data-v-85a18d73"]]),DA={class:"tab-content"},OA={key:0,class:"read-only-notice"},RA={key:1,class:"form-group"},BA=["value"],NA={class:"section-title"},FA={key:2,class:"assign-section"},UA={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:o}){const a=e,s=F(()=>a.peopleTerm.toLowerCase()),i=F(()=>a.personTerm.toLowerCase()),r=F(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:f,handleToggleCheckIn:p}=Qv(()=>u("input")),g=M(new Set),y=F(()=>a.assignments?.length||0),k=F(()=>a.assignments?[...a.assignments].sort((O,V)=>(O.marshalName||"").localeCompare(V.marshalName||"",void 0,{sensitivity:"base"})):[]),b=O=>g.value.has(O),C=O=>{O.isPending||u("select-marshal",O)},x=M(!1),$=M(null),I=O=>{f(O)?($.value=O,x.value=!0):p(O)},S=()=>{$.value&&p($.value),x.value=!1,$.value=null},B=()=>{x.value=!1,$.value=null},R=F(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),Z=O=>{O.isPending?u("remove-assignment",O):(g.value.add(O.id),u("input"))},A=O=>{g.value.delete(O.id),u("input")},N=(O,V)=>{u("update:form",{...a.form,[O]:Number(V)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([O,V])=>({assignmentId:O,shouldBeCheckedIn:V})),getMarkedForRemoval:()=>Array.from(g.value)}),(O,V)=>(v(),m("div",DA,[e.readOnly?(v(),m("div",OA," Viewing from "+w(i.value)+" - "+w(s.value)+" cannot be modified here. ",1)):E("",!0),e.readOnly?E("",!0):(v(),m("div",RA,[l("label",null,"Required "+w(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:V[0]||(V[0]=P=>N("requiredMarshals",P.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,BA)])),l("h3",NA,"Assigned "+w(s.value)+" ("+w(y.value)+")",1),Ae(Jl,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${r.value}.`},{default:Ve(()=>[(v(!0),m(Ie,null,Fe(k.value,P=>(v(),qe(PA,{key:P.id,assignment:P,"effective-check-in-status":D(f)(P),"has-unsaved-changes":D(d).has(P.id),"is-marked-for-removal":b(P.id),"read-only":e.readOnly,location:e.form,onClick:C,onToggleCheckIn:I,onRemove:Z,onUndoRemove:A,onDistanceClick:V[1]||(V[1]=j=>O.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?E("",!0):(v(),m("div",FA,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:V[2]||(V[2]=P=>O.$emit("open-assign-modal"))}," + Assign "+w(i.value)+"... ",1)])),Ae($a,{show:x.value,title:"Confirm check-out",message:R.value,"confirm-text":"Check out","is-danger":!0,onConfirm:S,onCancel:B},null,8,["show","message"])]))}},zA=Ge(UA,[["__scopeId","data-v-7124720e"]]),HA={class:"grouped-tasks-list"},VA={key:0,class:"empty-state"},GA={key:1,class:"task-groups"},jA=["onClick"],ZA={class:"task-header-content"},WA={class:"task-checkbox-area"},qA={class:"task-info"},KA={class:"task-name"},JA={class:"task-summary"},YA={key:0,class:"modified-badge"},XA={class:"task-scope"},QA=["title"],eE={class:"expand-arrow"},tE={key:0,class:"task-group-details"},nE={class:"detail-checkbox"},oE=["checked","disabled","onChange"],sE={class:"detail-content"},aE={class:"detail-context"},iE={key:0,class:"detail-completion"},lE={key:0,class:"pending-text"},rE={class:"completion-text"},cE={class:"completion-time"},uE={key:1,class:"detail-uncomplete"},dE={key:2,class:"detail-disabled"},hE={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=M(new Set),r=F(()=>{const b=new Map;for(const C of s.items){b.has(C.itemId)||b.set(C.itemId,{itemId:C.itemId,text:C.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const x=b.get(C.itemId);x.items.push(C),x.totalCount++,C.localIsCompleted&&x.completedCount++,C.isModified&&(x.hasModified=!0)}for(const C of b.values())C.allCompleted=C.completedCount===C.totalCount,C.items.sort((x,$)=>{const I=y(x),S=y($);return I.localeCompare(S,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(b.values()).sort((C,x)=>C.text.localeCompare(x.text,void 0,{sensitivity:"base"}))}),u=b=>{i.value.has(b)?i.value.delete(b):i.value.add(b),i.value=new Set(i.value)},d=b=>b.hasModified?"status-modified":b.allCompleted?"status-completed":b.completedCount>0?"status-partial":"status-pending",f=b=>b.allCompleted?"":b.completedCount>0?"":"",p=b=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[b.matchedScope]||b.matchedScope,g=b=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[b.matchedScope]||"",y=b=>{if(!b.completionContextType||!b.completionContextId)return"Everyone";if(b.completionContextType==="Checkpoint"){const C=s.locations.find(x=>x.id===b.completionContextId);return C?C.description?`${C.name} - ${C.description}`:C.name:`${o.value.checkpoint} (unknown)`}if(b.completionContextType==="Area"){const C=s.areas.find(x=>x.id===b.completionContextId);return C?C.name:`${o.value.area} (unknown)`}if(b.completionContextType==="Personal"){if(b.contextOwnerName)return b.contextOwnerName;if(b.completionContextId&&s.marshals.length>0){const C=s.marshals.find(x=>x.id===b.completionContextId||x.marshalId===b.completionContextId);if(C)return C.name||C.marshalName}return"Assigned individually"}return b.completionContextType},k=b=>b?new Date(b).toLocaleString():"";return(b,C)=>(v(),m("div",HA,[r.value.length===0?(v(),m("div",VA,[...C[0]||(C[0]=[l("p",null,"No tasks available.",-1)])])):(v(),m("div",GA,[(v(!0),m(Ie,null,Fe(r.value,x=>(v(),m("div",{key:x.itemId,class:ve(["task-group",{"all-completed":x.allCompleted,"has-modified":x.hasModified}])},[l("button",{type:"button",class:"task-group-header",onClick:$=>u(x.itemId)},[l("div",ZA,[l("div",WA,[l("span",{class:ve(["task-status-icon",d(x)])},w(f(x)),3)]),l("div",qA,[l("div",KA,w(x.text),1),l("div",JA,[l("span",{class:ve(["completion-count",{"all-done":x.allCompleted}])},w(x.completedCount)+"/"+w(x.totalCount)+" completed ",3),x.hasModified?(v(),m("span",YA," Modified ")):E("",!0)])]),l("div",XA,[l("span",{class:"scope-pill",title:g(x.items[0])},w(p(x.items[0])),9,QA)])]),l("span",eE,w(i.value.has(x.itemId)?"":""),1)],8,jA),i.value.has(x.itemId)?(v(),m("div",tE,[(v(!0),m(Ie,null,Fe(x.items,$=>(v(),m("div",{key:`${$.itemId}-${$.completionContextId}`,class:ve(["task-detail-item",{"item-completed":$.localIsCompleted,"item-modified":$.isModified}])},[l("div",nE,[l("input",{type:"checkbox",checked:$.localIsCompleted,disabled:!$.canBeCompletedByMe&&!$.localIsCompleted,onChange:I=>b.$emit("toggle-complete",$)},null,40,oE)]),l("div",sE,[l("div",aE,w(y($)),1),$.localIsCompleted?(v(),m("div",iE,[$.isModified&&!$.isCompleted?(v(),m("span",lE," Will be marked as completed ")):(v(),m(Ie,{key:1},[l("span",rE,w($.completedByActorName||"Unknown"),1),l("span",cE,w(k($.completedAt)),1)],64))])):$.isModified&&$.isCompleted?(v(),m("div",uE,[...C[1]||(C[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):$.canBeCompletedByMe?E("",!0):(v(),m("div",dE," Already completed by someone else "))])],2))),128))])):E("",!0)],2))),128))]))]))}},rd=Ge(hE,[["__scopeId","data-v-409a65e7"]]),fE={class:"checkpoint-checklist-view"},pE={key:0,class:"loading-state"},vE={key:1,class:"error-state"},mE={key:2,class:"empty-state"},gE={class:"help-text"},yE={key:3,class:"empty-state"},kE={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=dt(),s=e,i=o,r=M([]),u=M(!1),d=M(null),f=M(new Map),p=F(()=>s.assignments.length===0),g=F(()=>r.value.map(x=>{const $=f.value.get(`${x.itemId}|||${x.completionContextId}`),I=$!==void 0?$.complete:x.isCompleted,S=$!==void 0&&$.complete!==x.isCompleted;return{...x,localIsCompleted:I,isModified:S}})),y=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const x=s.locationId?await Nt.getCheckpointChecklist(s.eventId,s.locationId):await Nt.getAreaChecklist(s.eventId,s.areaId);if(r.value=x.data||[],s.modelValue&&s.modelValue.length>0){const $=new Map;s.modelValue.forEach(I=>{$.set(`${I.itemId}|||${I.contextId}`,{complete:I.complete,contextType:I.contextType,contextId:I.contextId})}),f.value=$}}catch(x){console.error("Failed to load checklist:",x),d.value=x.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},k=x=>{const $=x.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!$)return;const I=`${x.itemId}|||${x.completionContextId}`,S=f.value.get(I),B=S!==void 0?S.complete:x.isCompleted;f.value.set(I,{complete:!B,contextType:x.completionContextType,contextId:x.completionContextId,marshalId:$}),b()},b=()=>{const x=[];for(const[$,I]of f.value.entries()){const[S,B]=$.split("|||"),R=r.value.find(Z=>Z.itemId===S&&Z.completionContextId===B);R&&I.complete!==R.isCompleted&&x.push({itemId:S,complete:I.complete,contextType:I.contextType,contextId:I.contextId,marshalId:I.marshalId})}i("update:modelValue",x),i("change",x)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const x=new Map;s.modelValue.forEach($=>{x.set(`${$.itemId}|||${$.contextId}`,{complete:$.complete,contextType:$.contextType,contextId:$.contextId,marshalId:$.marshalId})}),f.value=x}},loadChecklist:y}),Ze(()=>[s.eventId,s.locationId,s.areaId],()=>{y()},{immediate:!0}),(x,$)=>(v(),m("div",fE,[u.value?(v(),m("div",pE," Loading checklist... ")):d.value?(v(),m("div",vE,[l("p",null,w(d.value),1),l("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):p.value?(v(),m("div",mE,[l("p",null,"No "+w(D(a).peoplePlural)+" assigned to this "+w(D(a).checkpoint)+" yet.",1),l("p",gE,"Assign "+w(D(a).peoplePlural)+" to enable "+w(D(a).checklist)+" completion.",1)])):r.value.length===0?(v(),m("div",yE,[l("p",null,"No checklist items for this "+w(D(a).checkpoint)+".",1)])):(v(),qe(rd,{key:4,items:g.value,locations:e.locations,areas:e.areas,onToggleComplete:k},null,8,["items","locations","areas"]))]))}},em=Ge(kE,[["__scopeId","data-v-52b7a966"]]),_E={class:"notes-view"},bE={key:0,class:"loading-state"},wE={key:1,class:"error-state"},CE={key:2,class:"empty-state"},LE={key:3,class:"notes-list"},SE={class:"note-header"},xE={class:"note-title-row"},IE={key:0,class:"pin-icon",title:"Pinned"},$E={class:"note-title"},TE={class:"note-meta"},ME={key:0,class:"category-badge"},AE={key:0,class:"note-content"},EE={class:"note-footer"},PE={class:"created-info"},DE={key:0,class:"scope-info"},OE={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=M([]),s=M(!1),i=M(null),r=F(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=F(()=>o.areaId?o.locations.filter($=>$.areaIds&&$.areaIds.includes(o.areaId)):[]),d=F(()=>u.value.map($=>$.id)),f=F(()=>{if(!o.areaId)return[];const $=new Set;return o.assignments.filter(I=>d.value.includes(I.locationId)).forEach(I=>$.add(I.marshalId)),Array.from($)}),p=$=>o.assignments.filter(I=>I.marshalId===$).map(I=>I.locationId),g=$=>{const I=p($),S=new Set;for(const B of I){const R=o.locations.find(Z=>Z.id===B);R?.areaIds&&R.areaIds.forEach(Z=>S.add(Z))}return Array.from(S)},y=($,I)=>{if(!$.scopeConfigurations)return null;for(const S of $.scopeConfigurations){if(S.itemType==="Area"){if(I.type==="area"&&(S.ids.includes(I.areaId)||S.ids.includes("ALL_AREAS")))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"};if(I.type==="checkpoint"){const R=o.locations.find(Z=>Z.id===I.locationId)?.areaIds||[];if(S.ids.includes("ALL_AREAS")||R.some(Z=>S.ids.includes(Z)))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(S.itemType==="Checkpoint"){if(I.type==="checkpoint"&&(S.ids.includes(I.locationId)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(I.type==="area"&&I.checkpointIds.some(R=>S.ids.includes(R)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(S.itemType==="Marshal"){if(I.type==="marshal"&&(S.ids.includes(I.marshalId)||S.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(I.type==="checkpoint"){const B=o.assignments.filter(Z=>Z.locationId===I.locationId).map(Z=>Z.marshalId);if(S.ids.includes("ALL_MARSHALS")||B.some(Z=>S.ids.includes(Z)))return{matched:!0,scope:"Marshal at checkpoint"}}if(I.type==="area"&&(S.ids.includes("ALL_MARSHALS")||I.marshalIds.some(R=>S.ids.includes(R))))return{matched:!0,scope:"Marshal in area"}}if(I.type==="marshal"&&I.checkpointIds&&I.areaIds){if(S.itemType==="Checkpoint"&&(S.ids.includes("ALL_CHECKPOINTS")||I.checkpointIds.some(R=>S.ids.includes(R))))return{matched:!0,scope:"Assigned checkpoint"};if(S.itemType==="Area"&&(S.ids.includes("ALL_AREAS")||I.areaIds.some(R=>S.ids.includes(R))))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},k=F(()=>{const $=o.allNotes||a.value;if(!$||$.length===0)return[];if(o.areaId&&o.allNotes){const I={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:f.value},S=[],B=new Set;for(const R of $){if(B.has(R.noteId))continue;const Z=y(R,I);Z&&(B.add(R.noteId),S.push({...R,matchedScope:Z.scope}))}return S}if(o.locationId&&o.allNotes){const I={type:"checkpoint",locationId:o.locationId},S=[],B=new Set;for(const R of $){if(B.has(R.noteId))continue;const Z=y(R,I);Z&&(B.add(R.noteId),S.push({...R,matchedScope:Z.scope}))}return S}if(o.marshalId&&o.allNotes){const I=p(o.marshalId),S=g(o.marshalId),B={type:"marshal",marshalId:o.marshalId,checkpointIds:I,areaIds:S},R=[],Z=new Set;for(const A of $){if(Z.has(A.noteId))continue;const N=y(A,B);N&&(Z.add(A.noteId),R.push({...A,matchedScope:N.scope}))}return R}return $}),b=F(()=>{const $={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...k.value].sort((I,S)=>{if(I.isPinned!==S.isPinned)return I.isPinned?-1:1;const B=$[I.priority]??2,R=$[S.priority]??2;return B!==R?B-R:I.displayOrder!==S.displayOrder?I.displayOrder-S.displayOrder:new Date(S.createdAt)-new Date(I.createdAt)})}),C=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,i.value=null;try{let $;o.marshalId?$=await Ps.getMarshalNotes(o.eventId,o.marshalId):$=await Ps.getByEvent(o.eventId),a.value=$.data||[]}catch($){console.error("Failed to load notes:",$),i.value=$.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ze(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&C()},{immediate:!0});const x=$=>{if(!$)return"";const I=new Date($),B=new Date-I,R=Math.floor(B/6e4),Z=Math.floor(B/36e5),A=Math.floor(B/864e5);return R<1?"just now":R<60?`${R}m ago`:Z<24?`${Z}h ago`:A<7?`${A}d ago`:I.toLocaleDateString()};return t({loadNotes:C}),($,I)=>(v(),m("div",_E,[s.value?(v(),m("div",bE," Loading notes... ")):i.value?(v(),m("div",wE,[l("p",null,w(i.value),1),l("button",{onClick:C,class:"btn btn-secondary btn-small"}," Retry ")])):k.value.length===0?(v(),m("div",CE,[l("p",null,w(r.value),1)])):(v(),m("div",LE,[(v(!0),m(Ie,null,Fe(b.value,S=>(v(),m("div",{key:S.noteId,class:ve(["note-item",{pinned:S.isPinned}])},[l("div",SE,[l("div",xE,[S.isPinned?(v(),m("span",IE,"")):E("",!0),l("span",{class:ve(["priority-indicator",(S.priority||"Normal").toLowerCase()])},null,2),l("strong",$E,w(S.title),1)]),l("div",TE,[S.category?(v(),m("span",ME,w(S.category),1)):E("",!0),l("span",{class:ve(["priority-badge",(S.priority||"Normal").toLowerCase()])},w(S.priority||"Normal"),3)])]),S.content?(v(),m("div",AE,w(S.content),1)):E("",!0),l("div",EE,[l("span",PE," Created by "+w(S.createdByName||"Unknown")+"  "+w(x(S.createdAt)),1),S.matchedScope&&e.showScope?(v(),m("span",DE,w(S.matchedScope),1)):E("",!0)])],2))),128))]))]))}},kc=Ge(OE,[["__scopeId","data-v-9fdf0b0b"]]),RE={class:"checklist-preview"},BE={class:"preview-actions"},NE={class:"preview-header"},FE={key:0,class:"add-item-form"},UE=["placeholder"],zE=["disabled"],HE={key:1,class:"pending-items"},VE={class:"item-content"},GE={class:"item-header"},jE={class:"item-text"},ZE={class:"item-scope"},WE=["onClick"],qE={key:2,class:"empty-state"},KE={key:0,class:"help-text"},JE={key:3,class:"checklist-items"},YE={class:"item-content"},XE={class:"item-header"},QE={class:"item-text"},e4={class:"item-scope"},t4=["title"],n4={key:0,class:"item-context"},o4={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=F(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():a.value.checkpoint),r=t,u=M(!1),d=M(""),f=M([...s.modelValue]);Ze(()=>s.modelValue,S=>{f.value=[...S]},{deep:!0});const p=()=>{d.value.trim()&&(f.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},g=S=>{f.value.splice(S,1),y()},y=()=>{r("update:modelValue",[...f.value]),r("change")},k=S=>{const B=S.scope,R=S.itemType,Z=S.ids||[];return(B==="EveryoneAtCheckpoints"||B==="OnePerCheckpoint")&&R==="Checkpoint"?Z.includes("ALL_CHECKPOINTS"):B==="OnePerCheckpoint"&&R==="Area"?Z.includes("ALL_AREAS")?!0:Z.some(A=>s.pendingAreaIds.includes(A)):(B==="EveryoneInAreas"||B==="OnePerArea"||B==="EveryAreaLead"||B==="OneLeadPerArea")&&R==="Area"?Z.includes("ALL_AREAS")?!0:Z.some(A=>s.pendingAreaIds.includes(A)):!1},b=F(()=>s.allChecklistItems.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>k(B)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[S]||S,x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(Z=>k(Z));if(!B)return C(S.scopeConfigurations[0].scope);const R=B.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${a.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(Z=>k(Z));return B&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[B.scope]||""},I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(A=>k(A));if(!B)return null;const R=B.itemType,Z=B.ids||[];if(Z.includes("ALL_CHECKPOINTS")||Z.includes("ALL_AREAS"))return null;if(R==="Area"){const A=s.areas.filter(N=>Z.includes(N.id)&&s.pendingAreaIds.includes(N.id)).map(N=>N.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(S,B)=>(v(),m("div",RE,[l("div",BE,[l("p",NE,w(e.isEditing?`Add new ${D(a).checklist} for this ${i.value}:`:`${D(o).checklists} that will apply at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=R=>u.value=!u.value)},w(u.value?"Cancel":`Add ${D(a).checklist}`),1)]),u.value?(v(),m("div",FE,[Ue(l("input",{"onUpdate:modelValue":B[1]||(B[1]=R=>d.value=R),type:"text",placeholder:`Enter ${D(a).checklist} text...`,class:"add-item-input",onKeyup:vs(p,["enter"])},null,40,UE),[[at,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:p}," Add ",8,zE)])):E("",!0),f.value.length>0?(v(),m("div",HE,[(v(!0),m(Ie,null,Fe(f.value,(R,Z)=>(v(),m("div",{key:`pending-${Z}`,class:"checklist-item pending"},[B[3]||(B[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",VE,[l("div",GE,[l("div",jE,w(R.text),1),l("div",ZE,[B[2]||(B[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:A=>g(Z),title:"Remove"},"  ",8,WE)])])])]))),128))])):E("",!0),!e.isEditing&&b.value.length===0&&f.value.length===0?(v(),m("div",qE,[l("p",null,"No "+w(D(a).checklists)+" will apply based on the current "+w(D(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",KE," Assign "+w(D(a).areas)+" to see relevant "+w(D(a).checklists)+". ",1)):E("",!0)])):E("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",JE,[(v(!0),m(Ie,null,Fe(b.value,R=>(v(),m("div",{key:R.id,class:"checklist-item"},[B[4]||(B[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",YE,[l("div",XE,[l("div",QE,w(R.text),1),l("div",e4,[l("span",{class:"scope-pill",title:$(R)},w(x(R)),9,t4)])]),I(R)?(v(),m("div",n4,w(I(R)),1)):E("",!0)])]))),128))])):E("",!0)]))}},s4=Ge(o4,[["__scopeId","data-v-7d943b21"]]),a4={class:"notes-preview"},i4={class:"preview-actions"},l4={class:"preview-header"},r4={key:0,class:"add-item-form"},c4={class:"add-form-fields"},u4=["disabled"],d4={key:1,class:"pending-items"},h4={class:"note-header"},f4={class:"note-title"},p4={class:"note-actions"},v4=["onClick"],m4={key:0,class:"note-content"},g4={key:2,class:"empty-state"},y4={key:0,class:"help-text"},k4={key:3,class:"notes-list"},_4={class:"note-header"},b4={class:"note-title"},w4=["title"],C4={key:0,class:"note-content"},L4={key:1,class:"note-context"},S4={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=F(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),r=M(!1),u=M(""),d=M(""),f=M([...a.modelValue]);Ze(()=>a.modelValue,S=>{f.value=[...S]},{deep:!0});const p=()=>{!u.value.trim()&&!d.value.trim()||(f.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",r.value=!1,y())},g=S=>{f.value.splice(S,1),y()},y=()=>{s("update:modelValue",[...f.value]),s("change")},k=S=>{const B=S.scope,R=S.itemType,Z=S.ids||[];return B==="EveryoneAtCheckpoints"&&R==="Checkpoint"?Z.includes("ALL_CHECKPOINTS"):B==="EveryoneInAreas"&&R==="Area"?Z.includes("ALL_AREAS")?!0:Z.some(A=>a.pendingAreaIds.includes(A)):!1},b=F(()=>a.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>k(B)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(Z=>k(Z));if(!B)return C(S.scopeConfigurations[0].scope);const R=B.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(Z=>k(Z));return B&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[B.scope]||""},I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(A=>k(A));if(!B)return null;const R=B.itemType,Z=B.ids||[];if(Z.includes("ALL_CHECKPOINTS")||Z.includes("ALL_AREAS"))return null;if(R==="Area"){const A=a.areas.filter(N=>Z.includes(N.id)&&a.pendingAreaIds.includes(N.id)).map(N=>N.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(S,B)=>(v(),m("div",a4,[l("div",i4,[l("p",l4,w(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=R=>r.value=!r.value)},w(r.value?"Cancel":"Add note"),1)]),r.value?(v(),m("div",r4,[l("div",c4,[Ue(l("input",{"onUpdate:modelValue":B[1]||(B[1]=R=>u.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,u.value]]),Ue(l("textarea",{"onUpdate:modelValue":B[2]||(B[2]=R=>d.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:p}," Add ",8,u4)])):E("",!0),f.value.length>0?(v(),m("div",d4,[(v(!0),m(Ie,null,Fe(f.value,(R,Z)=>(v(),m("div",{key:`pending-${Z}`,class:"note-item pending"},[l("div",h4,[l("span",f4,w(R.title||"Untitled"),1),l("div",p4,[B[3]||(B[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:A=>g(Z),title:"Remove"},"  ",8,v4)])]),R.content?(v(),m("div",m4,w(R.content),1)):E("",!0)]))),128))])):E("",!0),!e.isEditing&&b.value.length===0&&f.value.length===0?(v(),m("div",g4,[l("p",null,"No notes will apply based on the current "+w(D(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",y4," Assign "+w(D(o).areas)+" to see relevant notes. ",1)):E("",!0)])):E("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",k4,[(v(!0),m(Ie,null,Fe(b.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[l("div",_4,[l("span",b4,w(R.title||"Untitled"),1),l("span",{class:"scope-pill",title:$(R)},w(x(R)),9,w4)]),R.content?(v(),m("div",C4,w(R.content),1)):E("",!0),I(R)?(v(),m("div",L4,w(I(R)),1)):E("",!0)]))),128))])):E("",!0)]))}},x4=Ge(S4,[["__scopeId","data-v-71646c3f"]]),I4={class:"base-modal-title modal-title-with-icon"},$4=["innerHTML"],T4={key:7,class:"tab-content appearance-tab"},M4={class:"accordion-item"},A4=["innerHTML"],E4={class:"accordion-title"},P4={class:"accordion-arrow"},D4={key:0,class:"accordion-content"},O4={class:"section-description"},R4={class:"accordion-item"},B4={class:"accordion-preview"},N4={class:"accordion-arrow"},F4={key:0,class:"accordion-content"},U4={class:"section-description"},z4={class:"terminology-row"},H4={class:"terminology-field"},V4=["value"],G4={value:""},j4=["value"],Z4={class:"terminology-field"},W4=["value"],q4={value:""},K4=["value"],J4={key:8,class:"tab-content incidents-tab"},Y4={class:"incidents-list"},X4={class:"custom-footer"},Q4={class:"footer-left"},cf="edit_location_accordion",e3={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=dt(),a=e,s=t,i=M("details"),r=M(!1),u=M(null),d=M(null),f=M([]),p=M([]),g=M([]),y=M({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=M(!1),b=M(null),C=q=>{b.value=q,k.value=!0},x=()=>{k.value=!1,b.value=null},$=F(()=>b.value&&b.value.marshalName||""),I=F(()=>y.value.name||a.location?.name||""),S=F(()=>{if(!b.value)return null;const{checkInLatitude:q,checkInLongitude:K}=b.value;return!q||!K?null:{lat:q,lng:K}}),B=F(()=>{const q=y.value.latitude,K=y.value.longitude;return!q||!K?null:{lat:q,lng:K}}),R=F(()=>{if(!b.value)return null;const{checkInLatitude:q,checkInLongitude:K}=b.value,le=y.value.latitude,Ee=y.value.longitude;return!q||!K||!le||!Ee?null:li(q,K,le,Ee)}),Z=()=>a.eventId?`${cf}_${a.eventId}`:cf,A=M({iconStyle:!1,terminology:!1});tn(()=>{const q=localStorage.getItem(Z());if(q)try{const K=JSON.parse(q);A.value={...A.value,...K}}catch{}});const N=q=>{A.value[q]=!A.value[q],localStorage.setItem(Z(),JSON.stringify(A.value))},O=F(()=>{const q=y.value.areaIds||[];if(q.length>0){const K=a.areas.filter(le=>q.includes(le.id)&&le.peopleTerm).sort((le,Ee)=>(le.checkpointCount||0)-(Ee.checkpointCount||0));if(K.length>0)return K[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),V=F(()=>y.value.peopleTerm?y.value.peopleTerm:O.value),P=F(()=>{const q=y.value.areaIds||[];if(q.length>0){const K=a.areas.filter(le=>q.includes(le.id)&&le.checkpointTerm).sort((le,Ee)=>(le.checkpointCount||0)-(Ee.checkpointCount||0));if(K.length>0)return K[0].checkpointTerm}return o.value.checkpoint});F(()=>P.value.toLowerCase());const j=F(()=>{const q=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(q)return Ja("checkpoint",q,V.value);const K=y.value.areaIds||[];let le=null;if(K.length>0){const Ee=a.areas.filter(Ke=>K.includes(Ke.id)&&Ke.checkpointTerm).sort((Ke,Qe)=>(Ke.checkpointCount||0)-(Qe.checkpointCount||0));Ee.length>0&&(le=Ee[0].checkpointTerm)}return le?Ja("checkpoint",le,V.value):o.value.checkpoint}),Q=F(()=>j.value.toLowerCase()),ae=F(()=>{const q=V.value;return Ja("people",q)});F(()=>ae.value.toLowerCase());const pe=F(()=>o.value.area);F(()=>pe.value.toLowerCase());const ne=F(()=>o.value.area),oe=F(()=>ne.value.toLowerCase()),U=F(()=>o.value.areas),Y=F(()=>!!(a.location&&a.location.id)),de=F(()=>Y.value?`Edit ${Q.value}: ${a.location?.name||""}`:`Add ${Q.value}`),ke=F(()=>{const q=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:V.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&q.push({value:"incidents",label:"Incidents",icon:"incidents"}),q}),Re=F(()=>ke.value.findIndex(q=>q.value===i.value)),Xe=F(()=>Re.value===ke.value.length-1),Ne=F(()=>{const q=y.value.areaIds||[],K=a.areas.filter(ct=>q.includes(ct.id)).sort((ct,ln)=>(ct.checkpointCount||0)-(ln.checkpointCount||0)),le=(ct,ln)=>{for(const un of K){const Bt=ct(un);if(Bt&&Bt!=="default")return{value:Bt,source:"area"}}return ln&&ln!=="default"?{value:ln,source:"event"}:{value:"",source:"none"}},Ee=le(ct=>ct.checkpointStyleType||ct.CheckpointStyleType,a.eventDefaultStyleType),Ke=le(ct=>ct.checkpointStyleColor||ct.CheckpointStyleColor,a.eventDefaultStyleColor),Qe=le(ct=>ct.checkpointStyleBackgroundShape||ct.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),gt=le(ct=>ct.checkpointStyleBackgroundColor||ct.CheckpointStyleBackgroundColor||ct.checkpointStyleColor||ct.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),Lt=le(ct=>ct.checkpointStyleBorderColor||ct.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),yt=le(ct=>ct.checkpointStyleIconColor||ct.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),xt=le(ct=>ct.checkpointStyleSize||ct.CheckpointStyleSize,a.eventDefaultStyleSize),kt=le(ct=>ct.checkpointStyleMapRotation??ct.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Rt=[Ee,Qe,gt,Lt,yt,xt,kt].some(ct=>ct.source==="area");return{type:Ee.value||"default",color:Ke.value,backgroundShape:Qe.value,backgroundColor:gt.value,borderColor:Lt.value,iconColor:yt.value,size:xt.value,mapRotation:kt.value,source:Rt?"area":Ee.value?"event":"none"}}),ze=F(()=>Ne.value.source==="area"?`${ne.value} default`:"Event default"),We=F(()=>{const q=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,K=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",le=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",Ee=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",Ke=y.value.styleIconColor||Ne.value.iconColor||"#ffffff";return In({type:q||"circle",backgroundShape:K,backgroundColor:le,borderColor:Ee,iconColor:Ke,size:"100"})}),ee=F(()=>{let q,K,le,Ee,Ke;return Y.value&&a.location?(q=a.location.resolvedStyleType||a.location.ResolvedStyleType,K=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",le=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",Ee=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",Ke=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(q=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,K=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",le=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",Ee=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",Ke=y.value.styleIconColor||Ne.value.iconColor||"#ffffff"),In({type:q||"circle",backgroundShape:K,backgroundColor:le,borderColor:Ee,iconColor:Ke,size:"100",outputSize:28})}),ye=F(()=>{const q=!!y.value.checkpointTerm,K=!!y.value.peopleTerm;return q&&K?`${Ja("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:q?Ja("checkpoint",y.value.checkpointTerm,V.value):K?y.value.peopleTerm:"Using defaults"}),te=F(()=>Xe.value?null:ke.value[Re.value+1]),ge=F(()=>te.value?`${te.value.label}...`:""),he=M(!1),G=M(null);Ze(()=>a.location,q=>{if(q){const K=q.id||"new";if(G.value!==K){G.value=K,he.value=!0;let le="",Ee="";q.startTime&&(le=zl(q.startTime)),q.endTime&&(Ee=zl(q.endTime)),y.value={id:q.id||null,name:q.name||"",description:q.description||"",what3Words:q.what3Words||"",latitude:q.latitude||0,longitude:q.longitude||0,requiredMarshals:q.requiredMarshals||1,useCustomTimes:!!(q.startTime||q.endTime),startTime:le,endTime:Ee,areaIds:q.areaIds||q.AreaIds||[],styleType:q.styleType||q.StyleType||"default",styleColor:q.styleColor||q.StyleColor||"",styleBackgroundShape:q.styleBackgroundShape||q.StyleBackgroundShape||"",styleBackgroundColor:q.styleBackgroundColor||q.StyleBackgroundColor||"",styleBorderColor:q.styleBorderColor||q.StyleBorderColor||"",styleIconColor:q.styleIconColor||q.StyleIconColor||"",styleSize:q.styleSize||q.StyleSize||"",styleMapRotation:q.styleMapRotation??q.StyleMapRotation??"",peopleTerm:q.peopleTerm||"",checkpointTerm:q.checkpointTerm||"",isDynamic:q.isDynamic||!1,locationUpdateScopeConfigurations:q.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ze(()=>a.show,q=>{q?(i.value="details",r.value=!1,f.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(G.value=null,he.value=!1)});const J=q=>{y.value=q},ce=()=>{s("update:isDirty",!0)},Me=()=>{r.value=!r.value,s("move-location",{isMoving:r.value,formData:{...y.value}})},Be=q=>{f.value=q,ce()},De=()=>{te.value&&(i.value=te.value.value)},Le=()=>{const q={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:f.value||[],pendingAssignments:a.assignments.filter(K=>K.isPending).map(K=>({marshalId:K.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",q)},X=()=>{a.location&&a.location.id&&s("delete",a.location.id)},fe=q=>{s("remove-assignment",q)},xe=()=>{s("open-assign-modal")},Se=q=>{s("select-marshal",q)},_e=()=>{s("close")},W=(q,K)=>{y.value[q]=K,ce()};return(q,K)=>(v(),qe(jt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:_e},{header:Ve(()=>[l("h2",I4,[ee.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:ee.value},null,8,$4)):E("",!0),Ye(" "+w(de.value),1)])]),"tab-header":Ve(()=>[Ae(Ji,{modelValue:i.value,"onUpdate:modelValue":K[0]||(K[0]=le=>i.value=le),tabs:ke.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[l("div",X4,[l("div",Q4,[Y.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:X,class:"btn btn-danger"}," Delete ")):E("",!0),!Y.value&&!Xe.value?(v(),m("button",{key:1,type:"button",onClick:De,class:"btn btn-secondary mobile-only"},w(ge.value),1)):E("",!0)]),l("button",{type:"button",onClick:Le,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[i.value==="details"?(v(),qe(uM,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":ne.value,"area-term-plural":U.value,"checkpoint-term-singular":j.value,"people-term-plural":V.value,"onUpdate:form":J,onInput:ce,onSave:Le},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):E("",!0),i.value==="location"?(v(),qe(mA,{key:1,form:y.value,"is-moving":r.value,"checkpoint-term-singular":j.value,"people-term-plural":V.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":Y.value,"onUpdate:form":J,onInput:ce,onSave:Le,onMoveLocation:Me},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):E("",!0),i.value==="marshals"?(v(),qe(zA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":V.value,"person-term":ae.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":J,onInput:ce,onRemoveAssignment:fe,onOpenAssignModal:xe,onSelectMarshal:Se,onDistanceClick:C},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):E("",!0),i.value==="checklists"&&Y.value?(v(),qe(em,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:f.value,"onUpdate:modelValue":K[1]||(K[1]=le=>f.value=le),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:Be},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):E("",!0),i.value==="checklists"?(v(),qe(s4,{key:4,modelValue:p.value,"onUpdate:modelValue":K[2]||(K[2]=le=>p.value=le),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ce},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):E("",!0),i.value==="notes"&&Y.value?(v(),qe(kc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):E("",!0),i.value==="notes"?(v(),qe(x4,{key:6,modelValue:g.value,"onUpdate:modelValue":K[3]||(K[3]=le=>g.value=le),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Y.value,"checkpoint-term-singular":j.value,onChange:ce},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):E("",!0),i.value==="appearance"?(v(),m("div",T4,[l("div",M4,[l("button",{type:"button",class:ve(["accordion-header",{expanded:A.value.iconStyle}]),onClick:K[4]||(K[4]=le=>N("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:We.value},null,8,A4),l("span",E4,w(j.value)+" marker style",1),l("span",P4,w(A.value.iconStyle?"":""),1)],2),A.value.iconStyle?(v(),m("div",D4,[l("p",O4," Choose a custom icon for this "+w(Q.value)+", or leave as Default to inherit from "+w(oe.value)+" or event settings. ",1),Ae(ld,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":Ne.value.type,"inherited-style-color":Ne.value.color,"inherited-background-shape":Ne.value.backgroundShape||"","inherited-background-color":Ne.value.backgroundColor||Ne.value.color||"","inherited-border-color":Ne.value.borderColor||"","inherited-icon-color":Ne.value.iconColor||"","inherited-size":Ne.value.size||"","inherited-map-rotation":Ne.value.mapRotation??"","default-label":ze.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":K[5]||(K[5]=le=>W("styleType",le)),"onUpdate:styleColor":K[6]||(K[6]=le=>W("styleColor",le)),"onUpdate:styleBackgroundShape":K[7]||(K[7]=le=>W("styleBackgroundShape",le)),"onUpdate:styleBackgroundColor":K[8]||(K[8]=le=>W("styleBackgroundColor",le)),"onUpdate:styleBorderColor":K[9]||(K[9]=le=>W("styleBorderColor",le)),"onUpdate:styleIconColor":K[10]||(K[10]=le=>W("styleIconColor",le)),"onUpdate:styleSize":K[11]||(K[11]=le=>W("styleSize",le)),"onUpdate:styleMapRotation":K[12]||(K[12]=le=>W("styleMapRotation",le))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):E("",!0)]),l("div",R4,[l("button",{type:"button",class:ve(["accordion-header",{expanded:A.value.terminology}]),onClick:K[13]||(K[13]=le=>N("terminology"))},[K[17]||(K[17]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),K[18]||(K[18]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",B4,w(ye.value),1),l("span",N4,w(A.value.terminology?"":""),1)],2),A.value.terminology?(v(),m("div",F4,[l("p",U4," Customise what this "+w(Q.value)+" and its "+w(V.value.toLowerCase())+" are called. ",1),l("div",z4,[l("div",H4,[l("label",null,"What is this "+w(Q.value)+" called?",1),l("select",{value:y.value.checkpointTerm,class:"form-input",onChange:K[14]||(K[14]=le=>{J({...y.value,checkpointTerm:le.target.value}),ce()})},[l("option",G4,"Use "+w(oe.value)+" default ("+w(j.value)+")",1),K[19]||(K[19]=l("option",{value:"Vehicle"},"Vehicle",-1)),K[20]||(K[20]=l("option",{value:"Car"},"Car",-1)),K[21]||(K[21]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),m(Ie,null,Fe(D(Bs).checkpoint,le=>(v(),m("option",{key:le,value:le},w(le),9,j4))),128))],40,V4)]),l("div",Z4,[l("label",null,"What are "+w(V.value.toLowerCase())+" called here?",1),l("select",{value:y.value.peopleTerm,class:"form-input",onChange:K[15]||(K[15]=le=>{J({...y.value,peopleTerm:le.target.value}),ce()})},[l("option",q4,"Use "+w(oe.value)+" default ("+w(O.value)+")",1),(v(!0),m(Ie,null,Fe(D(Bs).people,le=>(v(),m("option",{key:le,value:le},w(le),9,K4))),128))],40,W4)])])])):E("",!0)])])):E("",!0),i.value==="incidents"?(v(),m("div",J4,[l("div",Y4,[(v(!0),m(Ie,null,Fe(e.incidents,le=>(v(),qe(Yl,{key:le.incidentId,incident:le,onSelect:K[16]||(K[16]=Ee=>q.$emit("select-incident",Ee))},null,8,["incident"]))),128))])])):E("",!0),Ae(id,{show:k.value,"marshal-name":$.value,"checkpoint-name":I.value,"check-in-location":S.value,"checkpoint-location":B.value,distance:R.value,"z-index":e.zIndex+100,onClose:x},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},t3=Ge(e3,[["__scopeId","data-v-88dde962"]]),n3={class:"tab-content"},o3={key:0,class:"error-banner"},s3=["value"],a3={key:0,class:"field-error"},i3={class:"contact-row"},l3=["value"],r3={key:0,class:"field-error"},c3=["value"],u3={key:0,class:"field-error"},d3=["value"],h3={key:0,class:"field-error"},f3={key:1,class:"magic-link-section"},p3={key:0,class:"loading-text"},v3={key:1,class:"magic-link-container"},m3={class:"magic-link-row"},g3=["value"],y3={key:0,class:"error-text"},k3={key:1,class:"magic-link-actions"},_3=["disabled"],b3={key:2,class:"success-text"},w3={key:3,class:"error-text"},C3={key:2,class:"error-text"},L3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=M(null),r=M(null),u=M(null),d=M(null),f=M(""),p=M(!1),g=M(!1),y=M(""),k=M(!1),b=M(!1),C=M(!1),x=M(""),$=(A,N)=>{s("update:form",{...a.form,[A]:N}),s("input")},I=async()=>{if(!(!a.eventId||!a.marshalId)){g.value=!0,y.value="";try{const A=await gs.getMagicLink(a.eventId,a.marshalId);f.value=A.data.magicLink,p.value=A.data.hasEmail}catch(A){console.error("Failed to fetch magic link:",A),y.value="Failed to load login link"}finally{g.value=!1}}},S=M(""),B=async()=>{S.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(f.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(A){console.warn("Clipboard API failed, trying fallback:",A)}try{const A=document.createElement("textarea");A.value=f.value,A.style.position="fixed",A.style.left="-9999px",A.style.top="0",document.body.appendChild(A),A.focus(),A.select();const N=document.execCommand("copy");document.body.removeChild(A),N?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(S.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3))}catch(A){console.error("Fallback copy failed:",A),S.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3)}},R=async()=>{if(!(!a.eventId||!a.marshalId)){b.value=!0,C.value=!1,x.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),C.value=!0,setTimeout(()=>{C.value=!1},3e3)}catch(A){console.error("Failed to send email:",A),x.value=A.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ze(()=>a.marshalId,A=>{A?I():(f.value="",p.value=!1)},{immediate:!0}),t({focusField:A=>{sn(()=>{const O={name:i,email:r,phoneNumber:u,notes:d}[A];O?.value&&(O.value.focus(),O.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(A,N)=>(v(),m("div",n3,[e.validationErrors.general?(v(),m("div",o3,w(e.validationErrors.general),1)):E("",!0),l("div",{class:ve(["form-group",{"has-error":e.validationErrors.name}])},[N[5]||(N[5]=l("label",null,"Name *",-1)),l("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:N[0]||(N[0]=O=>$("name",O.target.value)),type:"text",required:"",class:ve(["form-input",{"input-error":e.validationErrors.name}])},null,42,s3),e.validationErrors.name?(v(),m("span",a3,w(e.validationErrors.name),1)):E("",!0)],2),l("div",i3,[l("div",{class:ve(["form-group contact-email",{"has-error":e.validationErrors.email}])},[N[6]||(N[6]=l("label",null,"Email",-1)),l("input",{ref_key:"emailInputRef",ref:r,value:e.form.email,onInput:N[1]||(N[1]=O=>$("email",O.target.value)),type:"email",class:ve(["form-input",{"input-error":e.validationErrors.email}])},null,42,l3),e.validationErrors.email?(v(),m("span",r3,w(e.validationErrors.email),1)):E("",!0)],2),l("div",{class:ve(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[N[7]||(N[7]=l("label",null,"Phone number",-1)),l("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:N[2]||(N[2]=O=>$("phoneNumber",O.target.value)),type:"tel",class:ve(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,c3),e.validationErrors.phoneNumber?(v(),m("span",u3,w(e.validationErrors.phoneNumber),1)):E("",!0)],2)]),l("div",{class:ve(["form-group",{"has-error":e.validationErrors.notes}])},[N[8]||(N[8]=l("label",null,"Notes",-1)),l("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:N[3]||(N[3]=O=>$("notes",O.target.value)),class:ve(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,d3),e.validationErrors.notes?(v(),m("span",h3,w(e.validationErrors.notes),1)):E("",!0)],2),e.marshalId?(v(),m("div",f3,[N[9]||(N[9]=l("label",null,"Login link",-1)),N[10]||(N[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",p3,"Loading link...")):f.value?(v(),m("div",v3,[l("div",m3,[l("input",{type:"text",value:f.value,readonly:"",class:"form-input magic-link-input",onFocus:N[4]||(N[4]=O=>O.target.select())},null,40,g3),l("button",{type:"button",class:"btn btn-secondary",onClick:B},w(k.value?"Copied!":"Copy link"),1)]),S.value?(v(),m("p",y3,w(S.value),1)):E("",!0),p.value?(v(),m("div",k3,[l("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:R},w(b.value?"Sending...":"Send via email"),9,_3)])):E("",!0),C.value?(v(),m("p",b3,"Email sent successfully!")):E("",!0),x.value?(v(),m("p",w3,w(x.value),1)):E("",!0)])):y.value?(v(),m("div",C3,w(y.value),1)):E("",!0)])):E("",!0)]))}},S3=Ge(L3,[["__scopeId","data-v-16ffb81b"]]),x3={class:"card-header"},I3={class:"checkpoint-name-row"},$3=["innerHTML"],T3={class:"checkpoint-name"},M3={key:0,class:"checkpoint-description"},A3={key:0,class:"card-areas"},E3={key:1,class:"card-check-in"},P3={key:0,class:"check-in-time"},D3={key:0,class:"check-in-method"},O3={key:1,class:"unsaved-indicator"},R3={key:2,class:"card-locked"},B3={class:"locked-badge"},N3={key:3,class:"card-badge"},F3={key:4,class:"card-badge"},U3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=F(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),r=F(()=>i.value.map($=>{const I=a.areas.find(S=>S.id===$);return I?I.name:null}).filter(Boolean)),u=F(()=>i.value.map($=>{const I=a.areas.find(S=>S.id===$);return I?I.color:"#999"})),d=F(()=>{if(!a.location)return"#667eea";const $=a.location,I=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor;if(I)return I;if(i.value.length>0){const S=a.areas.find(B=>B.id===i.value[0]);if(S)return S.color}return"#667eea"}),f=F(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const $=a.location,I=$.resolvedStyleType||$.ResolvedStyleType,S=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor,B=$.resolvedStyleBorderColor||$.ResolvedStyleBorderColor,R=$.resolvedStyleIconColor||$.ResolvedStyleIconColor,Z=$.resolvedStyleBackgroundShape||$.ResolvedStyleBackgroundShape;return I&&I!=="default"||S||B||R||Z&&Z!=="circle"?In({type:I||"circle",backgroundShape:Z||"circle",backgroundColor:S||"#667eea",borderColor:B||"#ffffff",iconColor:R||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),p=$=>$?new Date($).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=F(()=>{const{checkedInBy:$,checkInMethod:I,marshalName:S}=a.assignment;return $&&$!==S?$:I||""}),y=F(()=>{const{checkInLatitude:$,checkInLongitude:I}=a.assignment,S=a.location;return!$||!I||!S?.latitude||!S?.longitude?null:li($,I,S.latitude,S.longitude)}),k=F(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),b=F(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),C=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&s("click",a.assignment)},x=()=>{s("distance-click",a.assignment)};return($,I)=>(v(),m("div",{class:ve(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:et({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[l("div",x3,[l("div",{class:"card-title",onClick:C},[l("span",I3,[l("span",{class:"checkpoint-icon",innerHTML:f.value},null,8,$3),l("span",T3,w(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",M3,"  "+w(e.assignment.locationDescription),1)):E("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:I[0]||(I[0]=it(S=>$.$emit("remove",e.assignment),["stop"]))},"  ")):E("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:I[1]||(I[1]=it(S=>$.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):E("",!0)]),r.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",A3,[(v(!0),m(Ie,null,Fe(r.value,(S,B)=>(v(),m("span",{key:B,class:"area-badge",style:et({backgroundColor:u.value[B]})},w(S),5))),128))])):E("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",E3,[l("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:I[2]||(I[2]=S=>$.$emit("toggle-check-in",e.assignment))},[...I[3]||(I[3]=[l("span",{class:"toggle-icon"},"",-1),l("span",{class:"toggle-label-wrapper"},[l("span",{class:"toggle-label toggle-label-check-in"},"Check in"),l("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",P3,[Ye(w(p(e.assignment.checkInTime))+" ",1),g.value?(v(),m("span",D3,"("+w(g.value)+")",1)):E("",!0),k.value?(v(),m("span",{key:1,class:ve(["check-in-distance",b.value]),onClick:it(x,["stop"])},w(k.value),3)):E("",!0)])):e.hasUnsavedChanges?(v(),m("span",O3," Unsaved ")):E("",!0)])):E("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",R3,[l("span",B3,"Viewing from this "+w(D(o).checkpoint),1)])):E("",!0),e.assignment.isPending?(v(),m("div",N3,[...I[4]||(I[4]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):E("",!0),e.isMarkedForRemoval?(v(),m("div",F3,[...I[5]||(I[5]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):E("",!0)],6))}},z3=Ge(U3,[["__scopeId","data-v-d3de6925"]]),H3={class:"tab-content"},V3={key:0,class:"read-only-notice"},G3={class:"section-title"},j3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},Z3={value:""},W3=["value"],q3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:o}){const{termsLower:a}=dt(),s=e,i=o,{pendingCheckInChanges:r,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=Qv(()=>i("input")),f=M(""),p=M(new Set),g=F(()=>s.assignments?.length||0),y=V=>s.allLocations&&s.allLocations.find(P=>P.id===V)||null,k=F(()=>[...s.assignments].sort((V,P)=>(V.locationName||"").localeCompare(P.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=V=>p.value.has(V),C=V=>{V.isPending||i("select-checkpoint",V)},x=M(!1),$=M(null),I=V=>{u(V)?($.value=V,x.value=!0):d(V)},S=()=>{$.value&&d($.value),x.value=!1,$.value=null},B=()=>{x.value=!1,$.value=null},R=F(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),Z=V=>{V.isPending?i("remove-assignment",V):(p.value.add(V.id),i("input"))},A=V=>{p.value.delete(V.id),i("input")},N=F(()=>{const V=[...s.availableLocations];return V.sort((P,j)=>P.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),V}),O=()=>{f.value&&(i("assign-to-location",f.value),f.value="")};return t({pendingCheckInChanges:r,clearPendingChanges:()=>{r.value.clear(),p.value.clear(),f.value=""},getPendingChanges:()=>Array.from(r.value.entries()).map(([V,P])=>({assignmentId:V,shouldBeCheckedIn:P})),getMarkedForRemoval:()=>Array.from(p.value)}),(V,P)=>(v(),m("div",H3,[e.lockedCheckpointId?(v(),m("div",V3," Viewing from "+w(D(a).checkpoint)+" - "+w(D(a).checkpoints)+" cannot be modified here. ",1)):E("",!0),l("h3",G3,"Assigned "+w(D(a).checkpoints)+" ("+w(g.value)+")",1),Ae(Jl,{"is-empty":e.assignments.length===0,"empty-message":`No ${D(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${D(a).person} to ${D(a).checkpoints}.`},{default:Ve(()=>[(v(!0),m(Ie,null,Fe(k.value,j=>(v(),qe(z3,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":D(u)(j),"has-unsaved-changes":D(r).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b(j.id),onClick:C,onToggleCheckIn:I,onRemove:Z,onUndoRemove:A,onDistanceClick:P[0]||(P[0]=Q=>V.$emit("distance-click",Q))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&N.value.length>0?(v(),m("div",j3,[l("label",null,"Assign to "+w(D(a).checkpoint),1),Ue(l("select",{"onUpdate:modelValue":P[1]||(P[1]=j=>f.value=j),class:"form-input",onChange:O},[l("option",Z3,"Select a "+w(D(a).checkpoint)+"...",1),(v(!0),m(Ie,null,Fe(N.value,j=>(v(),m("option",{key:j.id,value:j.id},[Ye(w(j.name),1),j.description?(v(),m(Ie,{key:0},[Ye(" - "+w(j.description),1)],64)):E("",!0)],8,W3))),128))],544),[[Nn,f.value]])])):E("",!0),Ae($a,{show:x.value,title:"Confirm check-out",message:R.value,"confirm-text":"Check out","is-danger":!0,onConfirm:S,onCancel:B},null,8,["show","message"])]))}},K3=Ge(q3,[["__scopeId","data-v-07754949"]]),J3={class:"marshal-checklist-view"},Y3={key:0,class:"loading-state"},X3={key:1,class:"error-state"},Q3={key:2,class:"empty-state"},eP={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=dt(),s=e,i=o,r=M([]),u=M(!1),d=M(null),f=M(new Map),p=F(()=>r.value.map(C=>{const x=f.value.get(C.itemId),$=x!==void 0?x.complete:C.isCompleted,I=x!==void 0&&x.complete!==C.isCompleted;return{...C,localIsCompleted:$,isModified:I}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const C=await Nt.getMarshalChecklist(s.eventId,s.marshalId);if(r.value=C.data||[],s.modelValue&&s.modelValue.length>0){const x=new Map;s.modelValue.forEach($=>{x.set($.itemId,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),f.value=x}}catch(C){console.error("Failed to load checklist:",C),d.value=C.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=C=>{const x=f.value.get(C.itemId),$=x!==void 0?x.complete:C.isCompleted;f.value.set(C.itemId,{complete:!$,contextType:C.completionContextType,contextId:C.completionContextId}),k()},k=()=>{const C=[];for(const[x,$]of f.value.entries()){const I=r.value.find(S=>S.itemId===x);I&&$.complete!==I.isCompleted&&C.push({itemId:x,complete:$.complete,contextType:$.contextType,contextId:$.contextId})}i("update:modelValue",C),i("change",C)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const C=new Map;s.modelValue.forEach(x=>{C.set(x.itemId,{complete:x.complete,contextType:x.contextType,contextId:x.contextId})}),f.value=C}},loadChecklist:g}),Ze(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(C,x)=>(v(),m("div",J3,[u.value?(v(),m("div",Y3," Loading checklist... ")):d.value?(v(),m("div",X3,[l("p",null,w(d.value),1),l("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):r.value.length===0?(v(),m("div",Q3,[l("p",null,"No checklist items for this "+w(D(a).person)+".",1)])):(v(),qe(rd,{key:3,items:p.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},tP=Ge(eP,[["__scopeId","data-v-7460304c"]]),nP={class:"checklist-preview"},oP={class:"preview-actions"},sP={class:"preview-header"},aP={key:0,class:"add-item-form"},iP=["placeholder"],lP=["disabled"],rP={key:1,class:"pending-items"},cP={class:"item-content"},uP={class:"item-header"},dP={class:"item-text"},hP={class:"item-scope"},fP=["onClick"],pP={key:2,class:"empty-state"},vP={key:0,class:"help-text"},mP={key:3,class:"checklist-items"},gP={class:"item-content"},yP={class:"item-header"},kP={class:"item-text"},_P={class:"item-scope"},bP=["title"],wP={key:0,class:"item-context"},CP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=M(!1),r=M(""),u=M([...a.modelValue]);Ze(()=>a.modelValue,I=>{u.value=[...I]},{deep:!0});const d=()=>{r.value.trim()&&(u.value.push({text:r.value.trim(),isNew:!0}),r.value="",i.value=!1,p())},f=I=>{u.value.splice(I,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=F(()=>{const I=new Set;for(const S of a.pendingLocationIds){const B=a.allLocations.find(R=>R.id===S);B&&(B.areaIds||B.AreaIds||[]).forEach(Z=>I.add(Z))}return[...I]}),y=I=>{const S=I.scope,B=I.itemType,R=I.ids||[];return S==="SpecificPeople"&&B==="Marshal"?R.includes("ALL_MARSHALS"):(S==="EveryoneAtCheckpoints"||S==="OnePerCheckpoint")&&B==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(Z=>a.pendingLocationIds.includes(Z)):S==="OnePerCheckpoint"&&B==="Area"?R.includes("ALL_AREAS")?!0:R.some(Z=>g.value.includes(Z)):(S==="EveryoneInAreas"||S==="OnePerArea"||S==="EveryAreaLead"||S==="OneLeadPerArea")&&B==="Area"?R.includes("ALL_AREAS")?!0:R.some(Z=>g.value.includes(Z)):!1},k=F(()=>a.allChecklistItems.filter(I=>I.scopeConfigurations&&I.scopeConfigurations.length>0?I.scopeConfigurations.some(S=>y(S)):!1)),b=I=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[I]||I,C=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return"Unknown";const S=I.scopeConfigurations.find(R=>y(R));if(!S)return b(I.scopeConfigurations[0].scope);const B=S.ids||[];return B.includes("ALL_MARSHALS")?"Everyone":B.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:B.includes("ALL_AREAS")?`All ${o.value.areas}`:b(S.scope)},x=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return"";const S=I.scopeConfigurations.find(R=>y(R));return S&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[S.scope]||""},$=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return null;const S=I.scopeConfigurations.find(Z=>y(Z));if(!S)return null;const B=S.itemType,R=S.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if(B==="Checkpoint"){const Z=a.allLocations.filter(A=>R.includes(A.id)&&a.pendingLocationIds.includes(A.id)).map(A=>A.name);if(Z.length>0)return`At: ${Z.join(", ")}`}if(B==="Area"){const Z=a.areas.filter(A=>R.includes(A.id)&&g.value.includes(A.id)).map(A=>A.name);if(Z.length>0)return`In: ${Z.join(", ")}`}return null};return(I,S)=>(v(),m("div",nP,[l("div",oP,[l("p",sP,w(e.isEditing?`Add new ${D(o).checklist} for this ${D(o).person}:`:`${D(o).checklists} that will apply to this ${D(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=B=>i.value=!i.value)},w(i.value?"Cancel":`Add ${D(o).checklist}`),1)]),i.value?(v(),m("div",aP,[Ue(l("input",{"onUpdate:modelValue":S[1]||(S[1]=B=>r.value=B),type:"text",placeholder:`Enter ${D(o).checklist} text...`,class:"add-item-input",onKeyup:vs(d,["enter"])},null,40,iP),[[at,r.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim(),onClick:d}," Add ",8,lP)])):E("",!0),u.value.length>0?(v(),m("div",rP,[(v(!0),m(Ie,null,Fe(u.value,(B,R)=>(v(),m("div",{key:`pending-${R}`,class:"checklist-item pending"},[S[3]||(S[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",cP,[l("div",uP,[l("div",dP,w(B.text),1),l("div",hP,[S[2]||(S[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:Z=>f(R),title:"Remove"},"  ",8,fP)])])])]))),128))])):E("",!0),!e.isEditing&&k.value.length===0&&u.value.length===0?(v(),m("div",pP,[l("p",null,"No "+w(D(o).checklists)+" will apply based on the current "+w(D(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",vP," Assign "+w(D(o).checkpoints)+" to see relevant "+w(D(o).checklists)+". ",1)):E("",!0)])):E("",!0),!e.isEditing&&k.value.length>0?(v(),m("div",mP,[(v(!0),m(Ie,null,Fe(k.value,B=>(v(),m("div",{key:B.id,class:"checklist-item"},[S[4]||(S[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",gP,[l("div",yP,[l("div",kP,w(B.text),1),l("div",_P,[l("span",{class:"scope-pill",title:x(B)},w(C(B)),9,bP)])]),$(B)?(v(),m("div",wP,w($(B)),1)):E("",!0)])]))),128))])):E("",!0)]))}},LP=Ge(CP,[["__scopeId","data-v-6deaacc2"]]),SP={class:"notes-preview"},xP={class:"preview-actions"},IP={class:"preview-header"},$P={key:0,class:"add-item-form"},TP={class:"add-form-fields"},MP=["disabled"],AP={key:1,class:"pending-items"},EP={class:"note-header"},PP={class:"note-title"},DP={class:"note-actions"},OP=["onClick"],RP={key:0,class:"note-content"},BP={key:2,class:"empty-state"},NP={key:0,class:"help-text"},FP={key:3,class:"notes-list"},UP={class:"note-header"},zP={class:"note-title"},HP=["title"],VP={key:0,class:"note-content"},GP={key:1,class:"note-context"},jP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=M(!1),r=M(""),u=M(""),d=M([...a.modelValue]);Ze(()=>a.modelValue,S=>{d.value=[...S]},{deep:!0});const f=()=>{!r.value.trim()&&!u.value.trim()||(d.value.push({title:r.value.trim(),content:u.value.trim(),isNew:!0}),r.value="",u.value="",i.value=!1,g())},p=S=>{d.value.splice(S,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},y=F(()=>{const S=new Set;for(const B of a.pendingLocationIds){const R=a.allLocations.find(Z=>Z.id===B);R&&(R.areaIds||R.AreaIds||[]).forEach(A=>S.add(A))}return[...S]}),k=S=>{const B=S.scope,R=S.itemType,Z=S.ids||[];return B==="SpecificPeople"&&R==="Marshal"?Z.includes("ALL_MARSHALS"):B==="EveryoneAtCheckpoints"&&R==="Checkpoint"?Z.includes("ALL_CHECKPOINTS")?!0:Z.some(A=>a.pendingLocationIds.includes(A)):B==="EveryoneInAreas"&&R==="Area"?Z.includes("ALL_AREAS")?!0:Z.some(A=>y.value.includes(A)):!1},b=F(()=>a.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some(B=>k(B)):!1)),C=S=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,x=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const B=S.scopeConfigurations.find(Z=>k(Z));if(!B)return C(S.scopeConfigurations[0].scope);const R=B.ids||[];return R.includes("ALL_MARSHALS")?"Everyone":R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:C(B.scope)},$=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const B=S.scopeConfigurations.find(Z=>k(Z));return B&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[B.scope]||""},I=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const B=S.scopeConfigurations.find(A=>k(A));if(!B)return null;const R=B.itemType,Z=B.ids||[];if(Z.includes("ALL_MARSHALS")||Z.includes("ALL_CHECKPOINTS")||Z.includes("ALL_AREAS"))return null;if(R==="Checkpoint"){const A=a.allLocations.filter(N=>Z.includes(N.id)&&a.pendingLocationIds.includes(N.id)).map(N=>N.name);if(A.length>0)return`At: ${A.join(", ")}`}if(R==="Area"){const A=a.areas.filter(N=>Z.includes(N.id)&&y.value.includes(N.id)).map(N=>N.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(S,B)=>(v(),m("div",SP,[l("div",xP,[l("p",IP,w(e.isEditing?`Add new note for this ${D(o).person}:`:`Notes that will be visible to this ${D(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:B[0]||(B[0]=R=>i.value=!i.value)},w(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",$P,[l("div",TP,[Ue(l("input",{"onUpdate:modelValue":B[1]||(B[1]=R=>r.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,r.value]]),Ue(l("textarea",{"onUpdate:modelValue":B[2]||(B[2]=R=>u.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!r.value.trim()&&!u.value.trim(),onClick:f}," Add ",8,MP)])):E("",!0),d.value.length>0?(v(),m("div",AP,[(v(!0),m(Ie,null,Fe(d.value,(R,Z)=>(v(),m("div",{key:`pending-${Z}`,class:"note-item pending"},[l("div",EP,[l("span",PP,w(R.title||"Untitled"),1),l("div",DP,[B[3]||(B[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:A=>p(Z),title:"Remove"},"  ",8,OP)])]),R.content?(v(),m("div",RP,w(R.content),1)):E("",!0)]))),128))])):E("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(v(),m("div",BP,[l("p",null,"No notes will be visible based on the current "+w(D(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",NP," Assign "+w(D(o).checkpoints)+" to see relevant notes. ",1)):E("",!0)])):E("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",FP,[(v(!0),m(Ie,null,Fe(b.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[l("div",UP,[l("span",zP,w(R.title||"Untitled"),1),l("span",{class:"scope-pill",title:$(R)},w(x(R)),9,HP)]),R.content?(v(),m("div",VP,w(R.content),1)):E("",!0),I(R)?(v(),m("div",GP,w(I(R)),1)):E("",!0)]))),128))])):E("",!0)]))}},ZP=Ge(jP,[["__scopeId","data-v-e8e0946a"]]),WP={key:6,class:"tab-content incidents-tab"},qP={class:"incidents-list"},KP={class:"custom-footer"},JP={class:"footer-left"},YP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=dt(),i=e,r=o,u=M("details"),d=M(null),f=M(null),p=M(null),g=M([]),y=M([]),k=M([]),b=M([]),C=M({name:"",email:"",phoneNumber:"",notes:""}),x=M(!1),$=M(null),I=he=>{$.value=he,x.value=!0},S=()=>{x.value=!1,$.value=null},B=he=>i.allLocations.find(G=>G.id===he),R=F(()=>C.value.name||i.marshal?.name||""),Z=F(()=>$.value&&B($.value.locationId)?.name||""),A=F(()=>{if(!$.value)return null;const{checkInLatitude:he,checkInLongitude:G}=$.value;return!he||!G?null:{lat:he,lng:G}}),N=F(()=>{if(!$.value)return null;const he=B($.value.locationId);return!he?.latitude||!he?.longitude?null:{lat:he.latitude,lng:he.longitude}}),O=F(()=>{if(!$.value)return null;const{checkInLatitude:he,checkInLongitude:G,locationId:J}=$.value,ce=B(J);return!he||!G||!ce?.latitude||!ce?.longitude?null:li(he,G,ce.latitude,ce.longitude)}),V=F(()=>{const he=i.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,G=C.value.name?.trim();return G?`${he} - ${G}`:he}),P=F(()=>{const he=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&he.push({value:"incidents",label:"Incidents",icon:"incidents"}),he}),j=F(()=>P.value.findIndex(he=>he.value===u.value)),Q=F(()=>j.value===P.value.length-1),ae=F(()=>Q.value?null:P.value[j.value+1]),pe=F(()=>ae.value?`${ae.value.label}...`:""),ne=F(()=>y.value.map(he=>he.locationId)),oe=F(()=>i.isEditing?i.assignments:y.value.map(he=>({id:`pending-${he.locationId}`,locationId:he.locationId,locationName:i.allLocations.find(G=>G.id===he.locationId)?.name||"Unknown",isPending:!0}))),U=F(()=>{if(i.isEditing)return i.availableLocations;const he=y.value.map(G=>G.locationId);return i.allLocations.filter(G=>!he.includes(G.id))});Ze(()=>i.marshal,he=>{he?C.value={name:he.name||"",email:he.email||"",phoneNumber:he.phoneNumber||"",notes:he.notes||""}:C.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ze(()=>i.show,he=>{he&&(u.value="details",g.value=[],y.value=[],k.value=[],b.value=[],i.isEditing||(C.value={name:"",email:"",phoneNumber:"",notes:""}),f.value?.clearPendingChanges&&f.value.clearPendingChanges(),p.value?.resetLocalState&&p.value.resetLocalState())});const Y=he=>{C.value=he},de=()=>{r("update:isDirty",!0)},ke=()=>{r("update:isDirty",!0)},Re=()=>{ae.value&&(u.value=ae.value.value)},Xe=()=>{const he={...C.value,checkInChanges:f.value?.getPendingChanges?.()||[],assignmentsToRemove:f.value?.getMarkedForRemoval?.()||[],checklistChanges:g.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:b.value};r("save",he)},Ne=()=>{r("delete")},ze=he=>{!i.isEditing&&he.isPending?y.value=y.value.filter(G=>G.locationId!==he.locationId):r("remove-assignment",he)},We=he=>{i.isEditing?r("assign-to-location",he):(y.value.push({locationId:he}),r("update:isDirty",!0))},ee=he=>{r("select-checkpoint",he)},ye=()=>{r("close")};return t({switchToTab:he=>{u.value=he},focusField:he=>{d.value?.focusField&&d.value.focusField(he)}}),(he,G)=>(v(),qe(jt,{show:e.show,title:V.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ye},{"tab-header":Ve(()=>[Ae(Ji,{modelValue:u.value,"onUpdate:modelValue":G[0]||(G[0]=J=>u.value=J),tabs:P.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[l("div",KP,[l("div",JP,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:Ne,class:"btn btn-danger"}," Delete ")):E("",!0),!e.isEditing&&!Q.value?(v(),m("button",{key:1,type:"button",onClick:Re,class:"btn btn-secondary mobile-only"},w(pe.value),1)):E("",!0)]),l("button",{type:"button",onClick:Xe,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[u.value==="details"?(v(),qe(S3,{key:0,ref_key:"detailsTabRef",ref:d,form:C.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Y,onInput:de},null,8,["form","event-id","marshal-id","validation-errors"])):E("",!0),u.value==="checkpoints"?(v(),qe(K3,{key:1,ref_key:"checkpointsTabRef",ref:f,assignments:oe.value,"available-locations":U.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:de,onRemoveAssignment:ze,onAssignToLocation:We,onSelectCheckpoint:ee,onDistanceClick:I},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):E("",!0),u.value==="checklists"&&e.isEditing?(v(),qe(tP,{key:2,ref_key:"checklistTabRef",ref:p,modelValue:g.value,"onUpdate:modelValue":G[1]||(G[1]=J=>g.value=J),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ke},null,8,["modelValue","event-id","marshal-id","locations","areas"])):E("",!0),u.value==="checklists"?(v(),qe(LP,{key:3,modelValue:k.value,"onUpdate:modelValue":G[2]||(G[2]=J=>k.value=J),"all-checklist-items":e.allChecklistItems,"pending-location-ids":ne.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:de},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):E("",!0),u.value==="notes"&&e.isEditing?(v(),qe(kc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):E("",!0),u.value==="notes"?(v(),qe(ZP,{key:5,modelValue:b.value,"onUpdate:modelValue":G[3]||(G[3]=J=>b.value=J),"all-notes":e.eventNotes,"pending-location-ids":ne.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:de},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):E("",!0),u.value==="incidents"?(v(),m("div",WP,[l("div",qP,[(v(!0),m(Ie,null,Fe(e.incidents,J=>(v(),qe(Yl,{key:J.incidentId,incident:J,onSelect:G[4]||(G[4]=ce=>he.$emit("select-incident",ce))},null,8,["incident"]))),128))])])):E("",!0),Ae(id,{show:x.value,"marshal-name":R.value,"checkpoint-name":Z.value,"check-in-location":A.value,"checkpoint-location":N.value,distance:O.value,"z-index":e.zIndex+100,onClose:S},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},XP=Ge(YP,[["__scopeId","data-v-bbedeb7b"]]),QP={class:"locations-list"},e6={class:"conflict-actions"},t6={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=t,i=u=>{s("choice",u)},r=()=>{s("close")};return(u,d)=>(v(),qe(jt,{show:e.show,title:`${D(o).person} already assigned`,size:"medium","z-index":1100,onClose:r},{actions:Ve(()=>[l("div",e6,[l("button",{onClick:d[0]||(d[0]=f=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+w(D(a).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=f=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=f=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=f=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ve(()=>[l("p",null,[l("strong",null,w(e.conflictData.marshalName),1),d[4]||(d[4]=Ye(" is currently assigned to: ",-1))]),l("ul",QP,[(v(!0),m(Ie,null,Fe(e.conflictData.locations,f=>(v(),m("li",{key:f},w(f),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},n6=Ge(t6,[["__scopeId","data-v-997e8aaa"]]),o6={key:0,class:"assign-marshal-section"},s6={value:""},a6=["value"],i6=["disabled"],l6={key:1,class:"assign-marshal-section create-mode"},r6={class:"form-group"},c6={class:"form-group"},u6={class:"form-group"},d6={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=M(!1),r=M(""),u=M({name:"",email:"",phoneNumber:""});Ze(()=>a.show,k=>{k||(i.value=!1,r.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},f=()=>{r.value&&s("assign-existing",r.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{s("close")};return(k,b)=>(v(),qe(jt,{show:e.show,title:i.value?`Create new ${D(o).person}`:`Assign ${D(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ve(()=>[i.value?(v(),m(Ie,{key:0},[l("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):E("",!0)]),default:Ve(()=>[i.value?(v(),m("div",l6,[l("h3",null,"Create new "+w(D(o).person),1),l("div",r6,[b[5]||(b[5]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>u.value.name=C),type:"text",required:"",class:"form-input"},null,512),[[at,u.value.name]])]),l("div",c6,[b[6]||(b[6]=l("label",null,"Email",-1)),Ue(l("input",{"onUpdate:modelValue":b[2]||(b[2]=C=>u.value.email=C),type:"email",class:"form-input"},null,512),[[at,u.value.email]])]),l("div",u6,[b[7]||(b[7]=l("label",null,"Phone",-1)),Ue(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>u.value.phoneNumber=C),type:"tel",class:"form-input"},null,512),[[at,u.value.phoneNumber]])])])):(v(),m("div",o6,[l("h3",null,"Select existing "+w(D(o).person),1),Ue(l("select",{"onUpdate:modelValue":b[0]||(b[0]=C=>r.value=C),class:"form-input"},[l("option",s6,"Choose a "+w(D(o).person)+"...",1),(v(!0),m(Ie,null,Fe(e.marshals,C=>(v(),m("option",{key:C.id,value:C.id},[Ye(w(C.name)+" ",1),C.assignedLocationIds&&C.assignedLocationIds.length>0?(v(),m(Ie,{key:0},[Ye(" (assigned to "+w(C.assignedLocationIds.length)+" "+w(C.assignedLocationIds.length>1?D(o).checkpoints:D(o).checkpoint)+") ",1)],64)):E("",!0)],8,a6))),128))],512),[[Nn,r.value]]),l("button",{onClick:f,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!r.value}," Assign selected "+w(D(o).person),9,i6),b[4]||(b[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+w(D(o).person),1)]))]),_:1},8,["show","title"]))}},h6=Ge(d6,[["__scopeId","data-v-fa70b913"]]),f6={class:"shift-times-content"},p6={class:"info-text"},v6={class:"time-delta-info"},m6={class:"delta-detail"},g6={class:"delta-detail"},y6={class:"delta-summary"},k6={class:"affected-checkpoints"},_6={class:"option-selection"},b6={class:"radio-option"},w6={class:"radio-option"},C6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=dt(),s=e,i=t,r=M("shift"),u=F(()=>{const y=new Date(s.oldEventDate);return new Date(s.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=y=>{const k=Math.abs(y),b=y>=0?"+":"-",C=Math.floor(k/(1e3*60*60*24)),x=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),$=Math.floor(k%(1e3*60*60)/(1e3*60)),I=[];return C>0&&I.push(`${C}d`),x>0&&I.push(`${x}h`),$>0&&I.push(`${$}m`),`${b}${I.join(" ")}`},p=()=>{i("confirm",{shouldShift:r.value==="shift",timeDelta:u.value})},g=()=>{i("cancel")};return(y,k)=>(v(),qe(jt,{show:e.show,title:`Shift ${D(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:Ve(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary"},w(r.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ve(()=>[l("div",f6,[l("p",p6," You've changed the event date/time. Some "+w(D(a).checkpoints)+" have custom times set. ",1),l("div",v6,[k[2]||(k[2]=l("strong",null,"Event time change:",-1)),l("div",m6," Old: "+w(d(e.oldEventDate)),1),l("div",g6," New: "+w(d(e.newEventDate)),1),l("div",y6," Delta: "+w(f(u.value)),1)]),l("p",k6,[l("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?D(a).checkpoint:D(a).checkpoints),1),k[3]||(k[3]=Ye(" with custom times will be shifted by the same amount. ",-1))]),l("div",_6,[l("label",b6,[Ue(l("input",{"onUpdate:modelValue":k[0]||(k[0]=b=>r.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[ph,r.value]]),l("div",null,[l("strong",null,"Shift all "+w(D(a).checkpoint)+" times",1),k[4]||(k[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",w6,[Ue(l("input",{"onUpdate:modelValue":k[1]||(k[1]=b=>r.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[ph,r.value]]),l("div",null,[l("strong",null,"Keep "+w(D(a).checkpoint)+" times unchanged",1),l("small",null,w(D(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},L6=Ge(C6,[["__scopeId","data-v-a6454aff"]]),S6={class:"search-section"},x6={class:"form-group"},I6={class:"suggestions-list"},$6={class:"suggestion-content"},T6={key:0,class:"suggestion-detail"},M6=["onClick"],A6={class:"suggestion-content"},E6={class:"suggestion-name"},P6={key:0,class:"suggestion-detail"},D6=["onClick"],O6={class:"suggestion-content"},R6={class:"suggestion-name"},B6={key:0,class:"suggestion-detail"},N6={key:1,class:"no-results"},F6={key:2,class:"no-results"},U6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=dt(),a=e,s=t,i=M(""),r=M(null),u=F(()=>a.contacts.filter(A=>a.excludeContactIds.includes(A.contactId)&&A.marshalId).map(A=>A.marshalId)),d=F(()=>a.contacts.filter(A=>A.marshalId).map(A=>A.marshalId)),f=F(()=>a.contacts.filter(A=>!a.excludeContactIds.includes(A.contactId))),p=F(()=>a.marshals.filter(A=>!u.value.includes(A.id)&&!d.value.includes(A.id))),g=A=>A?A.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=F(()=>{const A=g(i.value);return A?A.split(" ").filter(N=>N.length>0):[]}),k=(A,N)=>{if(N.length===0)return{score:1,isPartial:!1};const O=g(A);let V=0;for(const P of N)O.includes(P)&&V++;return{score:V,isPartial:V>0&&V<N.length,isFullMatch:V===N.length}},b=F(()=>{const A=y.value,N=[];return f.value.forEach(O=>{const V=`${O.name||""} ${O.role||""}`,P=k(V,A);(A.length===0||P.score>0)&&N.push({key:`contact-${O.contactId}`,type:"contact",name:O.name,detail:O.role?Z(O.role):null,data:O,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),p.value.forEach(O=>{const V=`${O.name||""} ${O.email||""}`,P=k(V,A);(A.length===0||P.score>0)&&N.push({key:`marshal-${O.id}`,type:"marshal",name:O.name,detail:O.email||O.phoneNumber||null,data:O,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),N.sort((O,V)=>V.matchScore!==O.matchScore?V.matchScore-O.matchScore:O.name.localeCompare(V.name,void 0,{sensitivity:"base"})),N}),C=F(()=>y.value.length===0?b.value:b.value.filter(A=>A.isFullMatch)),x=F(()=>y.value.length===0?[]:b.value.filter(A=>A.isPartial)),$=F(()=>x.value.length>0);Ze(()=>a.show,async A=>{A&&(i.value="",await sn(),r.value?.focus())});const I=A=>{const N=a.contacts.find(O=>O.marshalId===A.id);if(N){if(a.excludeContactIds.includes(N.contactId))return;s("select-contact",N)}else s("create-from-marshal",A)},S=A=>{s("select-contact",A)},B=()=>{s("create-new",i.value.trim())},R=()=>{s("close")},Z=A=>A?A.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"";return(A,N)=>(v(),qe(jt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:R},{actions:Ve(()=>[l("button",{onClick:R,class:"btn btn-secondary"}," Cancel ")]),default:Ve(()=>[l("div",S6,[l("div",x6,[N[1]||(N[1]=l("label",null,"Search or create",-1)),Ue(l("input",{ref_key:"searchInputRef",ref:r,"onUpdate:modelValue":N[0]||(N[0]=O=>i.value=O),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[at,i.value]])]),l("div",I6,[l("div",{class:"suggestion-item create-new",onClick:B},[N[3]||(N[3]=l("span",{class:"suggestion-icon create-icon"},"+",-1)),l("div",$6,[N[2]||(N[2]=l("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),m("span",T6,'"'+w(i.value.trim())+'"',1)):E("",!0)])]),(v(!0),m(Ie,null,Fe(C.value,O=>(v(),m("div",{key:O.key,class:"suggestion-item",onClick:V=>O.type==="marshal"?I(O.data):S(O.data)},[l("span",{class:ve(["suggestion-icon",O.type==="marshal"?"marshal-icon":"contact-icon"])},w(O.type==="marshal"?"M":"C"),3),l("div",A6,[l("span",E6,w(O.name),1),O.detail?(v(),m("span",P6,w(O.detail),1)):E("",!0)]),l("span",{class:ve(["suggestion-badge",{"contact-badge":O.type==="contact"}])},w(O.type==="marshal"?D(o).person:"Contact"),3)],8,M6))),128)),$.value?(v(),m(Ie,{key:0},[N[4]||(N[4]=l("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(Ie,null,Fe(x.value,O=>(v(),m("div",{key:O.key,class:"suggestion-item",onClick:V=>O.type==="marshal"?I(O.data):S(O.data)},[l("span",{class:ve(["suggestion-icon",O.type==="marshal"?"marshal-icon":"contact-icon"])},w(O.type==="marshal"?"M":"C"),3),l("div",O6,[l("span",R6,w(O.name),1),O.detail?(v(),m("span",B6,w(O.detail),1)):E("",!0)]),l("span",{class:ve(["suggestion-badge",{"contact-badge":O.type==="contact"}])},w(O.type==="marshal"?D(o).person:"Contact"),3)],8,D6))),128))],64)):E("",!0),i.value.trim()&&C.value.length===0&&x.value.length===0?(v(),m("div",N6," No matching "+w(D(o).people.toLowerCase())+" or contacts found. ",1)):E("",!0),!i.value.trim()&&C.value.length===0?(v(),m("div",F6," No "+w(D(o).people.toLowerCase())+" or contacts available to add. ",1)):E("",!0)])])]),_:1},8,["show","title"]))}},z6=Ge(U6,[["__scopeId","data-v-e25ca97b"]]),H6={key:0,class:"tab-content"},V6={class:"form-group"},G6=["disabled"],j6={class:"form-group"},Z6={key:1,class:"tab-content"},W6={class:"boundary-section"},q6={key:0,class:"boundary-preview"},K6={class:"boundary-actions"},J6={key:2,class:"tab-content"},Y6={class:"contacts-header"},X6={class:"section-title"},Q6={key:3,class:"tab-content"},e5={class:"section-title"},t5={key:4,class:"placeholder-message"},n5={key:6,class:"placeholder-message"},o5={key:8,class:"placeholder-message"},s5={key:9,class:"tab-content appearance-tab"},a5={class:"accordion-item"},i5=["innerHTML"],l5={class:"accordion-title"},r5={class:"accordion-arrow"},c5={key:0,class:"accordion-content"},u5={class:"section-description"},d5={class:"color-picker"},h5=["title","onClick"],f5={class:"accordion-item"},p5=["innerHTML"],v5={class:"accordion-title"},m5={class:"accordion-arrow"},g5={key:0,class:"accordion-content"},y5={class:"section-description"},k5={class:"accordion-item"},_5={class:"accordion-title"},b5={class:"accordion-preview"},w5={class:"accordion-arrow"},C5={key:0,class:"accordion-content"},L5={class:"section-description"},S5={class:"form-group"},x5={value:""},I5=["value"],$5={class:"accordion-item"},T5={class:"accordion-title"},M5={class:"accordion-preview"},A5={class:"accordion-arrow"},E5={key:0,class:"accordion-content"},P5={class:"section-description"},D5={class:"form-group"},O5={value:""},R5=["value"],B5={key:10,class:"tab-content incidents-tab"},N5={class:"incidents-list"},F5={class:"custom-footer"},U5={class:"footer-left"},uf="edit_area_accordion",z5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=dt(),i=()=>S.value.peopleTerm?S.value.peopleTerm:d.eventPeopleTerm||"Marshals",r=(W=!0)=>{const q=S.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",K=i();return W?Hv("checkpoint",q,K):Ja("checkpoint",q,K)},u=(W=!0)=>r(W).toLowerCase(),d=e,f=o,p=M("details"),g=M(null),y=M([]),k=M({}),b=M({}),C=M(!1),x=M(!1),$=M([]),I=M([]),S=M({name:"",description:"",color:Sr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),B=()=>({name:"",description:"",color:L2(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>d.eventId?`${uf}_${d.eventId}`:uf,Z=M({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});tn(()=>{const W=localStorage.getItem(R());if(W)try{const q=JSON.parse(W);Z.value={...Z.value,...q}}catch{}});const A=W=>{Z.value[W]=!Z.value[W],localStorage.setItem(R(),JSON.stringify(Z.value))},N=F(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${S.value.color||Sr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),O=F(()=>{const W=S.value.checkpointStyleType!=="default"||S.value.checkpointStyleBackgroundShape||S.value.checkpointStyleBackgroundColor||S.value.checkpointStyleBorderColor||S.value.checkpointStyleIconColor||S.value.checkpointStyleSize,q=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!W&&!q)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const K=S.value.checkpointStyleType&&S.value.checkpointStyleType!=="default"?S.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",le=S.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Ee=S.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Ke=S.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Qe=S.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",gt=S.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return In({type:K!=="default"?K:le,backgroundShape:le,backgroundColor:Ee,borderColor:Ke,iconColor:Qe,size:gt,outputSize:24})}),V=F(()=>d.area&&d.area.id),P=F(()=>!S.value.polygon||S.value.polygon.length===0?[]:S.value.polygon.map((W,q)=>({id:`polygon-point-${q}`,latitude:W.lat,longitude:W.lng}))),j=F(()=>d.area?.id?d.areas.filter(W=>W.id!==d.area.id).map(W=>({...W,color:"#999999"})):d.areas.map(W=>({...W,color:"#999999"})));F(()=>Y.value.map(W=>W.id));const Q=F(()=>{const W=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:r(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&W.push({value:"incidents",label:"Incidents",icon:"incidents"}),W}),ae=F(()=>Q.value.findIndex(W=>W.value===p.value)),pe=F(()=>ae.value===Q.value.length-1),ne=F(()=>pe.value?null:Q.value[ae.value+1]),oe=F(()=>ne.value?`${ne.value.label}...`:""),U=F(()=>{if(!d.area||!d.area.id)return[];const W=d.checkpoints.filter(q=>q.areaIds&&q.areaIds.includes(d.area.id)).map(q=>q.id);return d.assignments.filter(q=>W.includes(q.locationId))}),Y=F(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(W=>W.areaIds&&W.areaIds.includes(d.area.id))),de=F(()=>{const W=[...Y.value];return W.sort((q,K)=>{const le=q.name.match(/^(\d+)/),Ee=K.name.match(/^(\d+)/);if(le&&Ee){const Ke=parseInt(le[1]),Qe=parseInt(Ee[1]);if(Ke!==Qe)return Ke-Qe}return q.name.localeCompare(K.name,void 0,{numeric:!0,sensitivity:"base"})}),W}),ke=F(()=>!d.area||!d.area.id?[]:d.contacts.filter(W=>W.scopeConfigurations?W.scopeConfigurations.some(q=>q.scope==="EveryoneInAreas"&&q.itemType==="Area"?q.ids?.includes("ALL_AREAS")?!0:q.ids?.includes(d.area.id):!1):!1)),Re=F(()=>{const W=new Set(ke.value.map(le=>le.contactId)),q=ke.value.map(le=>({...le,isPending:!1,isExisting:!0,isMarkedForRemoval:I.value.includes(le.contactId)})),K=$.value.filter(le=>!W.has(le.contactId)).map(le=>({...le,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...q,...K].sort((le,Ee)=>le.name.localeCompare(Ee.name,void 0,{sensitivity:"base"}))}),Xe=F(()=>{const W=ke.value.map(K=>K.contactId),q=$.value.map(K=>K.contactId);return[...W,...q]}),Ne=async W=>{if(!(k.value[W]||b.value[W])){b.value[W]=!0;try{const K=(await Nt.getCheckpointChecklist(d.eventId,W)).data||[];k.value[W]={total:K.length,completed:K.filter(le=>le.isCompleted).length}}catch(q){console.error("Failed to load checklist status for checkpoint:",W,q),k.value[W]={total:0,completed:0}}finally{b.value[W]=!1}}};Ze(()=>d.area,W=>{if(W){const q=W.polygon?typeof W.polygon=="string"?JSON.parse(W.polygon):W.polygon:[];S.value={name:W.name||"",description:W.description||"",color:W.color||Sr,displayOrder:W.displayOrder||0,isDefault:W.isDefault||!1,polygon:q,checkpointStyleType:W.checkpointStyleType||"default",checkpointStyleColor:W.checkpointStyleColor||"",checkpointStyleBackgroundShape:W.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:W.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:W.checkpointStyleBorderColor||"",checkpointStyleIconColor:W.checkpointStyleIconColor||"",checkpointStyleSize:W.checkpointStyleSize||"",checkpointStyleMapRotation:W.checkpointStyleMapRotation??"",peopleTerm:W.peopleTerm||"",checkpointTerm:W.checkpointTerm||""}}else S.value=B()},{immediate:!0,deep:!0}),Ze(()=>d.show,W=>{W&&(p.value=d.initialTab||"details",y.value=[],k.value={},b.value={},$.value=[],I.value=[],x.value=!1,V.value||(S.value=B()),g.value?.resetLocalState&&g.value.resetLocalState())}),Ze(p,W=>{W==="checkpoints"&&d.area&&d.area.id&&Y.value.forEach(q=>{setTimeout(()=>Ne(q.id),0)})});const ze=()=>{f("update:isDirty",!0)},We=W=>{S.value.color=W,ze()},ee=(W,q)=>{S.value[W]=q,ze()},ye=()=>{f("draw-boundary",S.value)},te=W=>{S.value.polygon=W,ze()},ge=()=>{S.value.polygon=[],C.value=!1,ze()},he=W=>{x.value=!1,f("create-contact-from-marshal",{marshal:W,area:d.area})},G=W=>{x.value=!1,f("create-new-contact",{name:W,area:d.area})},J=W=>{$.value.find(q=>q.contactId===W.contactId)||($.value.push(W),ze()),x.value=!1},ce=W=>{$.value=$.value.filter(q=>q.contactId!==W),ze()},Me=W=>{I.value.includes(W)||(I.value.push(W),ze())},Be=W=>W.isPending?"Remove pending contact":`Remove from ${s.value.area}`,De=W=>{Re.value.find(K=>K.contactId===W)?.isPending?ce(W):Me(W)},Le=W=>{I.value=I.value.filter(q=>q!==W),ze()},X=W=>{y.value=W,ze()},fe=()=>{ne.value&&(p.value=ne.value.value)},xe=()=>{const W=d.area?{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,displayOrder:S.value.displayOrder,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:$.value||[],contactsToRemove:I.value||[]}:{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,pendingContacts:$.value||[]};f("save",W)},Se=()=>{f("delete",d.area.id)},_e=()=>{f("close")};return t({addPendingContact:W=>{W&&!$.value.find(q=>q.contactId===W.contactId)&&($.value.push(W),ze())},removeContactById:W=>{const q=$.value.some(K=>K.contactId===W);$.value=$.value.filter(K=>K.contactId!==W),I.value=I.value.filter(K=>K!==W),q&&ze()}}),(W,q)=>(v(),qe(jt,{show:e.show,title:e.area&&e.area.id?`Edit ${D(s).area}: ${e.area.name}`:`Create new ${D(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:_e},{"tab-header":Ve(()=>[Ae(Ji,{modelValue:p.value,"onUpdate:modelValue":q[0]||(q[0]=K=>p.value=K),tabs:Q.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[l("div",F5,[l("div",U5,[V.value&&!S.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:Se,class:"btn btn-danger"}," Delete ")):E("",!0),!V.value&&!pe.value?(v(),m("button",{key:1,type:"button",onClick:fe,class:"btn btn-secondary mobile-only"},w(oe.value),1)):E("",!0)]),l("button",{type:"button",onClick:xe,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[p.value==="details"?(v(),m("div",H6,[l("form",{onSubmit:it(xe,["prevent"])},[l("div",V6,[q[25]||(q[25]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":q[1]||(q[1]=K=>S.value.name=K),type:"text",required:"",class:"form-input",disabled:S.value.isDefault,onInput:ze},null,40,G6),[[at,S.value.name]])]),l("div",j6,[q[26]||(q[26]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":q[2]||(q[2]=K=>S.value.description=K),class:"form-input",rows:"3",onInput:ze},null,544),[[at,S.value.description]])])],32)])):E("",!0),p.value==="boundary"?(v(),m("div",Z6,[l("div",W6,[S.value.polygon&&S.value.polygon.length>0?(v(),m("div",q6,[Ae(ri,{mode:"edit-polygon","editing-polygon":S.value.polygon,route:e.route,locations:e.checkpoints,areas:j.value,"all-locations-for-bounds":P.value,height:"300px",onPolygonUpdate:te},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),q[27]||(q[27]=l("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):E("",!0),l("div",K6,[!S.value.polygon||S.value.polygon.length===0?(v(),m("button",{key:0,onClick:ye,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(Ie,{key:1},[l("button",{onClick:ye,class:"btn btn-secondary"}," Redraw "),l("button",{onClick:q[3]||(q[3]=K=>C.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):E("",!0),Ae($a,{show:C.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:ge,onCancel:q[4]||(q[4]=K=>C.value=!1)},null,8,["show"]),p.value==="contacts"?(v(),m("div",J6,[l("div",Y6,[l("h3",X6,w(D(a).area)+" contacts ("+w(Re.value.length)+")",1),l("button",{onClick:q[5]||(q[5]=K=>x.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ae(qv,{contacts:Re.value,"show-remove-button":!0,"remove-title":Be,"empty-message":`No contacts assigned to this ${D(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${D(s).people} in this ${D(s).area}.`,onSelect:q[6]||(q[6]=K=>W.$emit("edit-contact",K)),onRemove:De,onUndoRemove:Le},null,8,["contacts","empty-message","empty-hint"])])):E("",!0),Ae(z6,{show:x.value,"area-name":S.value.name||"this "+D(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Xe.value,onClose:q[7]||(q[7]=K=>x.value=!1),onSelectContact:J,onCreateFromMarshal:he,onCreateNew:G},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),p.value==="checkpoints"&&V.value?(v(),m("div",Q6,[l("h3",e5,w(r())+" in "+w(e.area?.name)+" ("+w(Y.value.length)+")",1),Ae(Xv,{checkpoints:de.value,areas:e.areas,"empty-message":`No ${u()} in this ${D(s).area} yet.`,onSelect:q[8]||(q[8]=K=>W.$emit("select-checkpoint",K))},null,8,["checkpoints","areas","empty-message"])])):E("",!0),p.value==="checkpoints"&&!V.value?(v(),m("div",t5,[l("p",null,w(r())+" will be automatically assigned based on boundaries after the "+w(D(s).area)+" is created.",1)])):E("",!0),p.value==="checklists"&&V.value?(v(),qe(em,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:y.value,"onUpdate:modelValue":q[9]||(q[9]=K=>y.value=K),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:U.value,onChange:X},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):E("",!0),p.value==="checklists"&&!V.value?(v(),m("div",n5,[l("p",null,w(D(a).checklists)+" can be assigned after the "+w(D(s).area)+" is created.",1)])):E("",!0),p.value==="notes"&&V.value?(v(),qe(kc,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):E("",!0),p.value==="notes"&&!V.value?(v(),m("div",o5,[l("p",null,"Notes can be viewed after the "+w(D(s).area)+" is created.",1)])):E("",!0),p.value==="appearance"?(v(),m("div",s5,[l("div",a5,[l("button",{type:"button",class:ve(["accordion-header",{expanded:Z.value.polygonColor}]),onClick:q[10]||(q[10]=K=>A("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:N.value},null,8,i5),l("span",l5,w(D(a).area)+" polygon colour",1),l("span",r5,w(Z.value.polygonColor?"":""),1)],2),Z.value.polygonColor?(v(),m("div",c5,[l("p",u5," Choose a colour for this "+w(D(s).area)+"'s boundary on the map. ",1),l("div",d5,[(v(!0),m(Ie,null,Fe(D(En),K=>(v(),m("div",{key:K.hex,class:ve(["color-swatch",{selected:S.value.color===K.hex}]),style:et({backgroundColor:K.hex}),title:K.name,onClick:le=>We(K.hex)},null,14,h5))),128))])])):E("",!0)]),l("div",f5,[l("button",{type:"button",class:ve(["accordion-header",{expanded:Z.value.iconStyle}]),onClick:q[11]||(q[11]=K=>A("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:O.value},null,8,p5),l("span",v5,w(r(!1))+" marker style",1),l("span",m5,w(Z.value.iconStyle?"":""),1)],2),Z.value.iconStyle?(v(),m("div",g5,[l("p",y5," Set a default marker style for all "+w(u())+" in this "+w(D(s).area)+". Individual "+w(u())+" can override this setting. ",1),Ae(ld,{"style-type":S.value.checkpointStyleType||"default","style-color":S.value.checkpointStyleColor||"","style-background-shape":S.value.checkpointStyleBackgroundShape||"","style-background-color":S.value.checkpointStyleBackgroundColor||"","style-border-color":S.value.checkpointStyleBorderColor||"","style-icon-color":S.value.checkpointStyleIconColor||"","style-size":S.value.checkpointStyleSize||"","style-map-rotation":S.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":q[12]||(q[12]=K=>ee("checkpointStyleType",K)),"onUpdate:styleColor":q[13]||(q[13]=K=>ee("checkpointStyleColor",K)),"onUpdate:styleBackgroundShape":q[14]||(q[14]=K=>ee("checkpointStyleBackgroundShape",K)),"onUpdate:styleBackgroundColor":q[15]||(q[15]=K=>ee("checkpointStyleBackgroundColor",K)),"onUpdate:styleBorderColor":q[16]||(q[16]=K=>ee("checkpointStyleBorderColor",K)),"onUpdate:styleIconColor":q[17]||(q[17]=K=>ee("checkpointStyleIconColor",K)),"onUpdate:styleSize":q[18]||(q[18]=K=>ee("checkpointStyleSize",K)),"onUpdate:styleMapRotation":q[19]||(q[19]=K=>ee("checkpointStyleMapRotation",K))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):E("",!0)]),l("div",k5,[l("button",{type:"button",class:ve(["accordion-header",{expanded:Z.value.peopleTerm}]),onClick:q[20]||(q[20]=K=>A("peopleTerm"))},[q[28]||(q[28]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",_5,w(i())+" terminology",1),l("span",b5,w(S.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",w5,w(Z.value.peopleTerm?"":""),1)],2),Z.value.peopleTerm?(v(),m("div",C5,[l("p",L5," Choose what "+w(i().toLowerCase())+" are called in this "+w(D(s).area)+". This will be inherited by "+w(u())+" unless they override it. ",1),l("div",S5,[q[29]||(q[29]=l("label",null,"What are people called?",-1)),Ue(l("select",{"onUpdate:modelValue":q[21]||(q[21]=K=>S.value.peopleTerm=K),class:"form-input",onChange:ze},[l("option",x5,"Use event default ("+w(e.eventPeopleTerm)+")",1),(v(!0),m(Ie,null,Fe(D(Bs).people,K=>(v(),m("option",{key:K,value:K},w(K),9,I5))),128))],544),[[Nn,S.value.peopleTerm]])])])):E("",!0)]),l("div",$5,[l("button",{type:"button",class:ve(["accordion-header",{expanded:Z.value.checkpointTerm}]),onClick:q[22]||(q[22]=K=>A("checkpointTerm"))},[q[30]||(q[30]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",T5,w(r(!1))+" terminology",1),l("span",M5,w(S.value.checkpointTerm?D(xu)(S.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),l("span",A5,w(Z.value.checkpointTerm?"":""),1)],2),Z.value.checkpointTerm?(v(),m("div",E5,[l("p",P5," Choose what "+w(u())+" are called in this "+w(D(s).area)+". ",1),l("div",D5,[l("label",null,"What are "+w(u())+" called?",1),Ue(l("select",{"onUpdate:modelValue":q[23]||(q[23]=K=>S.value.checkpointTerm=K),class:"form-input",onChange:ze},[l("option",O5,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(v(!0),m(Ie,null,Fe(D(Bs).checkpoint,K=>(v(),m("option",{key:K,value:K},w(D(xu)(K,i())),9,R5))),128))],544),[[Nn,S.value.checkpointTerm]])])])):E("",!0)])])):E("",!0),p.value==="incidents"?(v(),m("div",B5,[l("div",N5,[(v(!0),m(Ie,null,Fe(e.incidents,K=>(v(),qe(Yl,{key:K.incidentId,incident:K,onSelect:q[24]||(q[24]=le=>W.$emit("select-incident",le))},null,8,["incident"]))),128))])])):E("",!0)]),_:1},8,["show","title","is-dirty"]))}},H5=Ge(z5,[["__scopeId","data-v-94cf46bf"]]),V5=["innerHTML"],G5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(s,i)=>(v(),qe(jt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:Ve(()=>[l("button",{onClick:a,class:"btn btn-primary"},w(e.okText),1)]),default:Ve(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,V5)]),_:1},8,["show","title"]))}},_c=Ge(G5,[["__scopeId","data-v-a6e7148c"]]),j5={class:"tab-content"},Z5={class:"form-group"},W5={for:"text"},q5=["placeholder"],K5={key:0,class:"checkbox-label-inline create-separate-items"},J5={class:"tab-content"},Y5={class:"custom-footer"},X5={class:"footer-left"},Q5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:o,termsSentence:a}=dt(),s=e,i=t,r=M(!1),u=M(""),d=M("details"),f=M({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),p=F(()=>!!s.checklistItem),g=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],y=F(()=>g.findIndex(A=>A.value===d.value)),k=F(()=>y.value===g.length-1),b=F(()=>k.value?"":g[y.value+1]?.label||"");Ze(()=>s.show,A=>{A&&(d.value=s.initialTab,s.checklistItem?f.value={text:s.checklistItem.text||"",scopeConfigurations:s.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(s.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:s.checklistItem.displayOrder||0,isRequired:s.checklistItem.isRequired!==!1,visibleFrom:s.checklistItem.visibleFrom?C(s.checklistItem.visibleFrom):null,visibleUntil:s.checklistItem.visibleUntil?C(s.checklistItem.visibleUntil):null,mustCompleteBy:s.checklistItem.mustCompleteBy?C(s.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:f.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const C=A=>{if(!A)return null;const N=new Date(A),O=N.getTimezoneOffset();return new Date(N.getTime()-O*60*1e3).toISOString().slice(0,16)},x=A=>A?new Date(A).toISOString():null,$=()=>{i("update:isDirty",!0)},I=()=>{i("close")},S=()=>{k.value||(d.value=g[y.value+1].value)},B=A=>{u.value=A,r.value=!0},R=()=>{if(!f.value.text||!f.value.text.trim()){B(`Please enter ${o.value.checklist} text`);return}if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){B("Please select at least one scope");return}if(!f.value.scopeConfigurations.some(O=>!(O.itemType!==null&&(!O.ids||O.ids.length===0)))){B("Please configure at least one scope with valid selections");return}const N={text:f.value.text,scopeConfigurations:f.value.scopeConfigurations,displayOrder:f.value.displayOrder||0,isRequired:f.value.isRequired,visibleFrom:x(f.value.visibleFrom),visibleUntil:x(f.value.visibleUntil),mustCompleteBy:x(f.value.mustCompleteBy)};p.value||(N.createSeparateItems=f.value.createSeparateItems),i("save",N)},Z=()=>{i("delete",s.checklistItem.itemId)};return(A,N)=>(v(),m(Ie,null,[Ae(jt,{show:e.show,title:p.value?`Edit ${D(o).checklist}`:`Create ${D(o).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:I},{"tab-header":Ve(()=>[Ae(Ji,{modelValue:d.value,"onUpdate:modelValue":N[0]||(N[0]=O=>d.value=O),tabs:g},null,8,["modelValue"])]),footer:Ve(()=>[l("div",Y5,[l("div",X5,[p.value?(v(),m("button",{key:0,type:"button",onClick:Z,class:"btn btn-danger"}," Delete ")):E("",!0),!p.value&&!k.value?(v(),m("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},w(b.value)+"... ",1)):E("",!0)]),l("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[l("form",{onSubmit:it(R,["prevent"]),class:"checklist-form"},[Ue(l("div",j5,[l("div",Z5,[l("label",W5,w(D(a).checklist)+" text: *",1),Ue(l("textarea",{id:"text","onUpdate:modelValue":N[1]||(N[1]=O=>f.value.text=O),onInput:$,required:"",rows:"3",placeholder:f.value.createSeparateItems?`Enter ${D(o).checklists}, one per line...`:`Enter the ${D(o).checklist} text...`},null,40,q5),[[at,f.value.text]]),p.value?E("",!0):(v(),m("label",K5,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":N[2]||(N[2]=O=>f.value.createSeparateItems=O),onChange:$},null,544),[[Gs,f.value.createSeparateItems]]),N[5]||(N[5]=l("span",null,"Each line creates a new item",-1))]))])],512),[[ks,d.value==="details"]]),Ue(l("div",J5,[Ae(yc,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":N[3]||(N[3]=O=>f.value.scopeConfigurations=O),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,onUserChanged:$},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(_c,{show:r.value,title:"Validation error",message:u.value,onClose:N[4]||(N[4]=O=>r.value=!1)},null,8,["show","message"])],64))}},e8=Ge(Q5,[["__scopeId","data-v-eddaaf3c"]]),t8={class:"tab-content"},n8={class:"form-group"},o8={class:"form-group"},s8={class:"form-row"},a8={class:"form-group"},i8={class:"checkbox-label-inline show-emergency-checkbox"},l8={class:"form-group"},r8={class:"form-row"},c8={class:"form-group"},u8={class:"form-group checkbox-group-inline"},d8={class:"checkbox-label-inline"},h8={class:"tab-content"},f8={class:"custom-footer"},p8={class:"footer-left"},v8={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=M(!1),i=M(""),r=M("details"),u=M({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=B=>B==="Urgent"||B==="Emergency",f=F(()=>!!o.note),p=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],g=F(()=>p.findIndex(B=>B.value===r.value)),y=F(()=>g.value===p.length-1),k=F(()=>y.value?"":p[g.value+1]?.label||"");Ze(()=>o.show,B=>{B&&(r.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1,showInEmergencyInfo:o.note.showInEmergencyInfo??d(o.note.priority)}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),Ze(()=>u.value.priority,(B,R)=>{!f.value&&B!==R&&(d(B)?u.value.showInEmergencyInfo=!0:d(R)&&(u.value.showInEmergencyInfo=!1))});const b=()=>{a("update:isDirty",!0)},C=()=>{a("close")},x=()=>{y.value||(r.value=p[g.value+1].value)},$=B=>{i.value=B,s.value=!0},I=()=>{if(!u.value.title||!u.value.title.trim()){$("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){$("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(Z=>!(Z.itemType!==null&&(!Z.ids||Z.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const R={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1,showInEmergencyInfo:u.value.showInEmergencyInfo};a("save",R)},S=()=>{a("delete",o.note.noteId)};return(B,R)=>(v(),m(Ie,null,[Ae(jt,{show:e.show,title:f.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":Ve(()=>[Ae(Ji,{modelValue:r.value,"onUpdate:modelValue":R[0]||(R[0]=Z=>r.value=Z),tabs:p},null,8,["modelValue"])]),footer:Ve(()=>[l("div",f8,[l("div",p8,[f.value?(v(),m("button",{key:0,type:"button",onClick:S,class:"btn btn-danger"}," Delete ")):E("",!0),!f.value&&!y.value?(v(),m("button",{key:1,type:"button",onClick:x,class:"btn btn-secondary mobile-only"},w(k.value)+"... ",1)):E("",!0)]),l("button",{type:"button",onClick:I,class:"btn btn-success"}," Save ")])]),default:Ve(()=>[l("form",{onSubmit:it(I,["prevent"]),class:"note-form"},[Ue(l("div",t8,[l("div",n8,[R[10]||(R[10]=l("label",{for:"title"},"Title: *",-1)),Ue(l("input",{id:"title","onUpdate:modelValue":R[1]||(R[1]=Z=>u.value.title=Z),type:"text",onInput:b,required:"",placeholder:"Enter note title..."},null,544),[[at,u.value.title]])]),l("div",o8,[R[11]||(R[11]=l("label",{for:"content"},"Content:",-1)),Ue(l("textarea",{id:"content","onUpdate:modelValue":R[2]||(R[2]=Z=>u.value.content=Z),onInput:b,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[at,u.value.content]])]),l("div",s8,[l("div",a8,[R[14]||(R[14]=l("label",{for:"priority"},"Priority:",-1)),Ue(l("select",{id:"priority","onUpdate:modelValue":R[3]||(R[3]=Z=>u.value.priority=Z),onChange:b},[...R[12]||(R[12]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[Nn,u.value.priority]]),l("label",i8,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":R[4]||(R[4]=Z=>u.value.showInEmergencyInfo=Z),onChange:b},null,544),[[Gs,u.value.showInEmergencyInfo]]),R[13]||(R[13]=l("span",null,"Show in emergency info",-1))])]),l("div",l8,[R[15]||(R[15]=l("label",{for:"category"},"Category:",-1)),Ue(l("input",{id:"category","onUpdate:modelValue":R[5]||(R[5]=Z=>u.value.category=Z),type:"text",onInput:b,placeholder:"e.g., Safety, Logistics..."},null,544),[[at,u.value.category]])])]),l("div",r8,[l("div",c8,[R[16]||(R[16]=l("label",{for:"displayOrder"},"Display order:",-1)),Ue(l("input",{id:"displayOrder","onUpdate:modelValue":R[6]||(R[6]=Z=>u.value.displayOrder=Z),type:"number",onInput:b,min:"0"},null,544),[[at,u.value.displayOrder,void 0,{number:!0}]]),R[17]||(R[17]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",u8,[l("label",d8,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":R[7]||(R[7]=Z=>u.value.isPinned=Z),onChange:b},null,544),[[Gs,u.value.isPinned]]),R[18]||(R[18]=l("span",null,"Pin to top",-1))]),R[19]||(R[19]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ks,r.value==="details"]]),Ue(l("div",h8,[Ae(yc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":R[8]||(R[8]=Z=>u.value.scopeConfigurations=Z),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:b},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,r.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(_c,{show:s.value,title:"Validation error",message:i.value,onClose:R[9]||(R[9]=Z=>s.value=!1)},null,8,["show","message"])],64))}},m8=Ge(v8,[["__scopeId","data-v-e8488047"]]),g8={class:"incident-detail-header"},y8={class:"header-title-row"},k8={class:"modal-title"},_8={class:"header-badges"},b8=["disabled"],w8={key:0,class:"status-dropdown-menu"},C8=["onClick","disabled"],L8={key:0,class:"incident-detail-content"},S8={class:"accordion-section"},x8={class:"accordion-arrow"},I8={key:0,class:"accordion-content"},$8={class:"description-text"},T8={class:"accordion-section"},M8={class:"accordion-arrow"},A8={key:0,class:"accordion-content"},E8={class:"info-grid"},P8={class:"info-item"},D8={class:"info-value"},O8={class:"info-item"},R8={class:"info-value"},B8={key:0,class:"info-item"},N8={class:"info-label"},F8={class:"info-value"},U8={key:1,class:"info-item"},z8={class:"info-label"},H8={class:"info-value"},V8={key:2,class:"info-item"},G8={class:"info-value"},j8={key:0,class:"incident-map-container"},Z8={class:"accordion-section"},W8={class:"accordion-preview"},q8={class:"accordion-arrow"},K8={key:0,class:"accordion-content"},J8={class:"reporter-info"},Y8={class:"reporter-name"},X8={key:0,class:"accordion-section"},Q8={class:"accordion-title"},eD={class:"accordion-preview"},tD={class:"accordion-arrow"},nD={key:0,class:"accordion-content"},oD={class:"marshals-list"},sD={class:"marshal-name"},aD={key:0,class:"checkin-badge success"},iD={key:1,class:"checkin-badge not-checked-in"},lD={class:"accordion-section"},rD={key:0,class:"accordion-preview"},cD={class:"accordion-arrow"},uD={key:0,class:"accordion-content"},dD={key:0,class:"notes-timeline"},hD={class:"note-header"},fD={class:"note-author"},pD={class:"note-time"},vD={key:0,class:"note-status-change"},mD={key:1,class:"note-text"},gD={key:1,class:"no-notes"},yD={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:o,termsSentence:a}=dt(),s=e,i=t,r=M(!1),u=M(!1),d=M(null),f=M({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ze(()=>s.show,V=>{V&&(f.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},u.value=!1)});const p=V=>{d.value&&!d.value.contains(V.target)&&(u.value=!1)};Ze(u,V=>{V?document.addEventListener("click",p):document.removeEventListener("click",p)});const g=()=>{u.value=!u.value},y=V=>{s.incident?.status!==V&&(u.value=!1,O(V))},k=V=>{const P=f.value[V];Object.keys(f.value).forEach(j=>{f.value[j]=!1}),P||(f.value[V]=!0)},b=F(()=>s.incident?.latitude!=null&&s.incident?.longitude!=null),C=F(()=>b.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),x=F(()=>b.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),$=F(()=>{if(!s.incident)return"Incident Details";if(s.incident.title)return s.incident.title;const V=s.incident.description||"";return V.length<=50?V:V.substring(0,47)+"..."}),I=F(()=>[...s.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((P,j)=>(P.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),S=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],B=V=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[V]||V,R=V=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[V]||V,Z=V=>{if(!V)return"";let P=V.name||"";if(V.description){const j=V.description,Q=40,ae=j.length>Q?j.substring(0,Q-3)+"...":j;P+=` - ${ae}`}return P},A=V=>V?new Date(V).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=V=>{if(!V)return"";const P=new Date(V),Q=new Date-P,ae=Math.floor(Q/6e4),pe=Math.floor(Q/36e5),ne=Math.floor(Q/864e5);return ae<1?"just now":ae<60?`${ae}m ago`:pe<24?`${pe}h ago`:ne<7?`${ne}d ago`:P.toLocaleDateString()},O=async V=>{if(s.incident?.status!==V){r.value=!0;try{i("status-change",{incidentId:s.incident.incidentId,status:V})}finally{r.value=!1}}};return(V,P)=>(v(),qe(jt,{show:e.show,title:$.value,size:"large",onClose:P[7]||(P[7]=j=>V.$emit("close"))},{header:Ve(()=>[l("div",g8,[l("div",y8,[l("span",{class:ve(["severity-indicator",e.incident?.severity])},null,2),l("h2",k8,w($.value),1)]),l("div",_8,[l("span",{class:ve(["severity-badge",e.incident?.severity])},w(B(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[l("button",{type:"button",class:ve(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:g,disabled:r.value},[Ye(w(R(e.incident?.status))+" ",1),P[8]||(P[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,b8),u.value?(v(),m("div",w8,[(v(),m(Ie,null,Fe(S,j=>l("button",{key:j.value,type:"button",class:ve(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Q=>y(j.value),disabled:e.incident?.status===j.value},[l("span",{class:ve(["status-dot",j.value])},null,2),Ye(" "+w(j.label),1)],10,C8)),64))])):E("",!0)],512)):(v(),m("span",{key:1,class:ve(["status-badge",e.incident?.status])},w(R(e.incident?.status)),3))])])]),footer:Ve(()=>[l("button",{class:"btn btn-secondary",onClick:P[6]||(P[6]=j=>V.$emit("close"))},"Close")]),default:Ve(()=>[e.incident?(v(),m("div",L8,[l("div",S8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:f.value.description}]),onClick:P[0]||(P[0]=j=>k("description"))},[P[9]||(P[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",x8,w(f.value.description?"":""),1)],2),f.value.description?(v(),m("div",I8,[l("p",$8,w(e.incident.description),1)])):E("",!0)]),l("div",T8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:f.value.timeLocation}]),onClick:P[1]||(P[1]=j=>k("timeLocation"))},[P[10]||(P[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",M8,w(f.value.timeLocation?"":""),1)],2),f.value.timeLocation?(v(),m("div",A8,[l("div",E8,[l("div",P8,[P[11]||(P[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",D8,w(A(e.incident.incidentTime)),1)]),l("div",O8,[P[12]||(P[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",R8,w(A(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",B8,[l("span",N8,w(D(a).checkpoint),1),l("span",F8,w(Z(e.incident.context.checkpoint)),1)])):E("",!0),e.incident.area?(v(),m("div",U8,[l("span",z8,w(D(a).area),1),l("span",H8,w(e.incident.area.areaName),1)])):E("",!0),b.value?(v(),m("div",V8,[P[13]||(P[13]=l("span",{class:"info-label"},"GPS location",-1)),l("span",G8,w(e.incident.latitude.toFixed(6))+", "+w(e.incident.longitude.toFixed(6)),1)])):E("",!0)]),b.value?(v(),m("div",j8,[Ae(ri,{locations:e.checkpoints,route:e.route,center:C.value,zoom:15,"user-location":x.value,height:"200px"},null,8,["locations","route","center","user-location"])])):E("",!0)])):E("",!0)]),l("div",Z8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:f.value.reporter}]),onClick:P[2]||(P[2]=j=>k("reporter"))},[P[14]||(P[14]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",W8,w(e.incident.reportedBy?.name||"Unknown"),1),l("span",q8,w(f.value.reporter?"":""),1)],2),f.value.reporter?(v(),m("div",K8,[l("div",J8,[l("span",Y8,w(e.incident.reportedBy?.name||"Unknown"),1)])])):E("",!0)]),I.value.length?(v(),m("div",X8,[l("button",{type:"button",class:ve(["accordion-header",{expanded:f.value.marshals}]),onClick:P[3]||(P[3]=j=>k("marshals"))},[l("span",Q8,w(D(o).peoplePlural)+" at "+w(D(o).checkpoint.toLowerCase()),1),l("span",eD,w(I.value.length),1),l("span",tD,w(f.value.marshals?"":""),1)],2),f.value.marshals?(v(),m("div",nD,[l("div",oD,[(v(!0),m(Ie,null,Fe(I.value,j=>(v(),m("div",{key:j.marshalId,class:ve(["marshal-item",{"checked-in":j.wasCheckedIn}])},[l("span",sD,w(j.name),1),j.wasCheckedIn?(v(),m("span",aD," Checked in "+w(N(j.checkInTime)),1)):(v(),m("span",iD," Not checked in "))],2))),128))])])):E("",!0)])):E("",!0),l("div",lD,[l("button",{type:"button",class:ve(["accordion-header",{expanded:f.value.notes}]),onClick:P[4]||(P[4]=j=>k("notes"))},[P[15]||(P[15]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",rD,w(e.incident.updates.length),1)):E("",!0),l("span",cD,w(f.value.notes?"":""),1)],2),f.value.notes?(v(),m("div",uD,[e.incident.updates?.length?(v(),m("div",dD,[(v(!0),m(Ie,null,Fe(e.incident.updates,(j,Q)=>(v(),m("div",{key:Q,class:"note-item"},[l("div",hD,[l("span",fD,w(j.authorName||"System"),1),l("span",pD,w(N(j.timestamp)),1)]),j.statusChange?(v(),m("div",vD,[P[16]||(P[16]=Ye(" Status changed to ",-1)),l("span",{class:ve(["status-badge",j.statusChange])},w(R(j.statusChange)),3)])):j.note?(v(),m("p",mD,w(j.note),1)):E("",!0)]))),128))])):(v(),m("div",gD," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:P[5]||(P[5]=j=>V.$emit("open-add-note"))}," Add update ")])):E("",!0)])])):E("",!0)]),_:1},8,["show","title"]))}},tm=Ge(yD,[["__scopeId","data-v-df0707d4"]]),kD={class:"form-group"},_D={class:"form-group"},bD={class:"form-row"},wD={class:"form-group form-group-half"},CD=["value"],LD={class:"form-group form-group-half"},SD={key:0,class:"form-group"},xD={for:"checkpoint",class:"form-label"},ID=["value"],$D={key:1,class:"form-group"},TD={class:"form-label"},MD={class:"checkpoint-toggle"},AD={class:"checkbox-label"},ED={class:"checkpoint-name"},PD={key:0,class:"checkpoint-description"},DD={class:"form-group"},OD={class:"location-options"},RD={class:"location-buttons"},BD={key:0,class:"location-status"},ND={key:0,class:"location-getting"},FD={key:1,class:"location-display"},UD={key:0,class:"location-accuracy"},zD={key:2,class:"location-error"},HD={key:1,class:"map-picker-container"},VD={key:0,class:"map-picker-hint"},GD={key:2,class:"location-display"},jD={key:2,class:"error-message"},ZD={class:"modal-actions"},WD=["disabled"],qD={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:o}=dt(),a=e,s=t,i=M({title:"",description:"",severity:"medium",incidentTime:""}),r=M(""),u=M(!0),d=M("none"),f=M(!1),p=M(null),g=M(null),y=M(null),k=M(!1),b=M(!1),C=M(null),x=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],$=()=>{const j=new Date,Q=j.getFullYear(),ae=String(j.getMonth()+1).padStart(2,"0"),pe=String(j.getDate()).padStart(2,"0"),ne=String(j.getHours()).padStart(2,"0"),oe=String(j.getMinutes()).padStart(2,"0");return`${Q}-${ae}-${pe}T${ne}:${oe}`},I=j=>j?new Date(j).toISOString():null,S=F(()=>a.checkpoints||[]),B=F(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(r.value){const j=S.value.find(Q=>Q.id===r.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(S.value.length>0){const j=S.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.route?.length>0){const j=a.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),R=F(()=>i.value.description.trim()!==""),Z=F(()=>i.value.description.trim()!=="");Ze(()=>a.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:$()},r.value="",u.value=!0,b.value=!1,C.value=null,y.value=null,p.value=null,g.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy,d.value="gps",f.value=!1):(d.value="none",f.value=!1),a.checkpoint&&(r.value=a.checkpoint.locationId||a.checkpoint.id||""))});const A=j=>{y.value=null,j==="map"?d.value==="map"?f.value=!f.value:(d.value="map",f.value=!0,g.value=null):j==="gps"?(d.value="gps",f.value=!1,O()):(d.value="none",f.value=!1,p.value=null,g.value=null)},N=j=>{p.value={latitude:j.lat,longitude:j.lng},g.value=null,f.value=!1},O=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){p.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{p.value={latitude:j.coords.latitude,longitude:j.coords.longitude},g.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},V=async()=>{if(!(!Z.value||b.value)){b.value=!0,C.value=null;try{const j=(d.value==="gps"||d.value==="map")&&p.value;let Q=null,ae=!1;S.value.length>0?r.value?Q=r.value:ae=!0:a.checkpoint&&(u.value?Q=a.checkpoint.locationId||a.checkpoint.id||null:ae=!0);const pe={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:I(i.value.incidentTime),latitude:j?p.value.latitude:null,longitude:j?p.value.longitude:null,checkpointId:Q,skipCheckpointAutoAssign:ae};s("submit",pe)}catch(j){C.value=j.message||"Failed to report incident. Please try again.",b.value=!1}}},P=()=>{s("close")};return(j,Q)=>(v(),qe(jt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":R.value,onClose:P},{footer:Ve(()=>[l("div",ZD,[l("button",{type:"button",class:"btn btn-secondary",onClick:P}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:V,disabled:!Z.value||b.value},w(b.value?"Reporting...":"Report Incident"),9,WD)])]),default:Ve(()=>[l("form",{onSubmit:it(V,["prevent"]),class:"incident-form"},[l("div",kD,[Q[10]||(Q[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),Ue(l("input",{id:"title","onUpdate:modelValue":Q[0]||(Q[0]=ae=>i.value.title=ae),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[at,i.value.title]])]),l("div",_D,[Q[11]||(Q[11]=l("label",{for:"description",class:"form-label"},[Ye("Description "),l("span",{class:"required"},"*")],-1)),Ue(l("textarea",{id:"description","onUpdate:modelValue":Q[1]||(Q[1]=ae=>i.value.description=ae),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[at,i.value.description]])]),l("div",bD,[l("div",wD,[Q[12]||(Q[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),Ue(l("select",{id:"severity","onUpdate:modelValue":Q[2]||(Q[2]=ae=>i.value.severity=ae),class:"form-input form-select"},[(v(),m(Ie,null,Fe(x,ae=>l("option",{key:ae.value,value:ae.value},w(ae.label),9,CD)),64))],512),[[Nn,i.value.severity]])]),l("div",LD,[Q[13]||(Q[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ue(l("input",{id:"incidentTime","onUpdate:modelValue":Q[3]||(Q[3]=ae=>i.value.incidentTime=ae),type:"datetime-local",class:"form-input"},null,512),[[at,i.value.incidentTime]])])]),S.value.length>0?(v(),m("div",SD,[l("label",xD,w(D(o).checkpoint),1),Ue(l("select",{id:"checkpoint","onUpdate:modelValue":Q[4]||(Q[4]=ae=>r.value=ae),class:"form-input form-select"},[Q[14]||(Q[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(Ie,null,Fe(S.value,ae=>(v(),m("option",{key:ae.id,value:ae.id},w(ae.name)+w(ae.description?` - ${ae.description}`:""),9,ID))),128))],512),[[Nn,r.value]])])):e.checkpoint?(v(),m("div",$D,[l("label",TD,w(D(o).checkpoint),1),l("div",MD,[l("label",AD,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":Q[5]||(Q[5]=ae=>u.value=ae)},null,512),[[Gs,u.value]]),l("span",ED,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",PD," - "+w(e.checkpoint.description),1)):E("",!0)])])])):E("",!0),l("div",DD,[Q[15]||(Q[15]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",OD,[l("div",RD,[l("button",{type:"button",class:ve(["location-btn",{active:d.value==="gps"}]),onClick:Q[6]||(Q[6]=ae=>A("gps"))}," GPS ",2),l("button",{type:"button",class:ve(["location-btn",{active:d.value==="map"}]),onClick:Q[7]||(Q[7]=ae=>A("map"))}," Pick on map ",2),l("button",{type:"button",class:ve(["location-btn",{active:d.value==="none"}]),onClick:Q[8]||(Q[8]=ae=>A("none"))}," None ",2)]),d.value==="gps"?(v(),m("div",BD,[k.value?(v(),m("div",ND," Getting location... ")):p.value&&p.value.latitude!=null?(v(),m("div",FD,[l("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),g.value?(v(),m("span",UD,"("+w(Math.round(g.value))+"m)",1)):E("",!0)])):y.value?(v(),m("div",zD,w(y.value),1)):E("",!0)])):E("",!0),d.value==="map"?(v(),m("div",HD,[f.value?(v(),m("div",VD,"Tap to select location")):E("",!0),f.value?(v(),qe(ri,{key:1,locations:S.value,route:e.route,center:B.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":r.value,height:"150px",onPointSelected:N},null,8,["locations","route","center","user-location","highlight-location-id"])):E("",!0),p.value&&p.value.latitude!=null?(v(),m("div",GD,[l("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),f.value?E("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:Q[9]||(Q[9]=ae=>f.value=!0)},"Edit"))])):E("",!0)])):E("",!0)])]),C.value?(v(),m("div",jD,w(C.value),1)):E("",!0)],32)]),_:1},8,["show","is-dirty"]))}},nm=Ge(qD,[["__scopeId","data-v-20b520b6"]]),KD={class:"tab-content"},JD={key:0,class:"form-group"},YD={for:"marshalId"},XD=["value"],QD={class:"help-text"},eO={key:1,class:"form-group"},tO={class:"linked-marshal-info"},nO={class:"linked-marshal-name"},oO={class:"linked-marshal-hint"},sO={key:2,class:"form-group"},aO={class:"form-group"},iO={class:"role-input-group"},lO={key:0,label:"Built-in Roles"},rO=["value"],cO={key:1,label:"Custom Roles"},uO=["value"],dO={class:"checkbox-label-inline show-emergency-checkbox"},hO={class:"form-row"},fO={class:"form-group"},pO={class:"form-group"},vO={class:"form-group"},mO={class:"form-row"},gO={class:"form-group"},yO={class:"form-group checkbox-group-inline"},kO={class:"checkbox-label-inline"},_O={class:"tab-content"},bO={class:"custom-footer"},wO={class:"footer-left"},CO=["disabled"],LO={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=dt(),a=e,s=t,i=M(!1),r=M(""),u=M("details"),d=M(!1),f=M({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=V=>V==="EmergencyContact",g=F(()=>!!a.contact),y=F(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),k=F(()=>!!f.value.marshalId),b=F(()=>!g.value&&!!a.prefilledMarshalId),C=F(()=>g.value&&!!a.contact?.marshalId),x=F(()=>a.contact?.marshalId?a.marshals.find(P=>P.id===a.contact.marshalId)?.name||"Unknown":""),$=F(()=>[...a.marshals].sort((V,P)=>js(V.name,P.name)));Ze(()=>a.show,V=>{if(V){if(u.value=a.initialTab,a.contact){const P=[...a.availableRoles.builtInRoles||[],...a.availableRoles.customRoles||[]];d.value=a.contact.role&&!P.includes(a.contact.role),f.value={role:a.contact.role||"",name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??p(a.contact.role),displayOrder:a.contact.displayOrder||0,isPinned:a.contact.isPinned||!1,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let P;a.createFromAreaContext?P=[]:a.preselectedArea?P=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:P=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let j={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const Q=a.marshals.find(ae=>ae.id===a.prefilledMarshalId);Q&&(j={name:Q.name||"",phone:Q.phoneNumber||"",email:Q.email||""})}f.value={role:"",name:j.name,phone:j.phone,email:j.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:P}}s("update:isDirty",!1)}}),Ze(()=>f.value.role,(V,P)=>{!g.value&&V!==P&&(p(V)?f.value.showInEmergencyInfo=!0:p(P)&&(f.value.showInEmergencyInfo=!1))});const I=V=>V?V==="AreaLead"?`${o.value.area} Lead`:V.replace(/([A-Z])/g," $1").replace(/^./,P=>P.toUpperCase()).trim():"",S=()=>{s("update:isDirty",!0)},B=()=>{if(f.value.marshalId){const V=a.marshals.find(P=>P.id===f.value.marshalId);V&&(f.value.name=V.name,!f.value.phone&&V.phoneNumber&&(f.value.phone=V.phoneNumber),!f.value.email&&V.email&&(f.value.email=V.email))}S()},R=()=>{s("close")},Z=()=>{if(!f.value.role||!f.value.role.trim()){A("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){A("Please enter a contact name");return}u.value="visibility"},A=V=>{r.value=V,i.value=!0},N=()=>{if(!f.value.role||!f.value.role.trim()){A("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){A("Please enter a contact name");return}if(!a.createFromAreaContext){if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){A("Please select at least one visibility scope");return}if(!f.value.scopeConfigurations.some(j=>!(j.itemType!==null&&(!j.ids||j.ids.length===0)))){A("Please configure at least one scope with valid selections");return}}const V={role:f.value.role.trim(),name:f.value.name.trim(),phone:f.value.phone?.trim()||null,email:f.value.email?.trim()||null,notes:f.value.notes?.trim()||null,marshalId:f.value.marshalId||null,showInEmergencyInfo:f.value.showInEmergencyInfo,displayOrder:f.value.displayOrder||0,isPinned:f.value.isPinned||!1,scopeConfigurations:f.value.scopeConfigurations};s("save",V)},O=()=>{s("delete",a.contact.contactId)};return(V,P)=>(v(),m(Ie,null,[Ae(jt,{show:e.show,title:g.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:R},{"tab-header":Ve(()=>[Ae(Ji,{modelValue:u.value,"onUpdate:modelValue":P[0]||(P[0]=j=>u.value=j),tabs:y.value},null,8,["modelValue","tabs"])]),footer:Ve(()=>[l("div",bO,[l("div",wO,[g.value?(v(),m("button",{key:0,type:"button",onClick:O,class:"btn btn-danger"}," Delete ")):E("",!0),!g.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:Z,class:"btn btn-secondary mobile-only"}," Visibility... ")):E("",!0)]),l("button",{type:"button",onClick:N,class:"btn btn-success",disabled:g.value&&!e.isDirty}," Save ",8,CO)])]),default:Ve(()=>[l("form",{onSubmit:it(N,["prevent"]),class:"contact-form"},[Ue(l("div",KD,[!b.value&&!C.value?(v(),m("div",JD,[l("label",YD,"Link to "+w(D(o).person.toLowerCase())+":",1),Ue(l("select",{id:"marshalId","onUpdate:modelValue":P[1]||(P[1]=j=>f.value.marshalId=j),onChange:B},[P[14]||(P[14]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),m(Ie,null,Fe($.value,j=>(v(),m("option",{key:j.id,value:j.id},w(j.name),9,XD))),128))],544),[[Nn,f.value.marshalId]]),l("span",QD,"Optionally link to an existing "+w(D(o).person.toLowerCase())+" in the system",1)])):E("",!0),C.value?(v(),m("div",eO,[l("label",null,"Linked "+w(D(o).person.toLowerCase())+":",1),l("div",tO,[l("span",nO,w(x.value),1),l("span",oO,"Contact details are synced with this "+w(D(o).person.toLowerCase()),1)])])):E("",!0),k.value?E("",!0):(v(),m("div",sO,[P[15]||(P[15]=l("label",{for:"name"},"Name: *",-1)),Ue(l("input",{id:"name","onUpdate:modelValue":P[2]||(P[2]=j=>f.value.name=j),type:"text",onInput:S,placeholder:"Contact name..."},null,544),[[at,f.value.name]])])),l("div",aO,[P[18]||(P[18]=l("label",{for:"role"},"Role: *",-1)),l("div",iO,[d.value?Ue((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":P[4]||(P[4]=j=>f.value.role=j),type:"text",onInput:S,placeholder:"Enter custom role name..."},null,544)),[[at,f.value.role]]):Ue((v(),m("select",{key:0,id:"role","onUpdate:modelValue":P[3]||(P[3]=j=>f.value.role=j),onChange:S},[P[16]||(P[16]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",lO,[(v(!0),m(Ie,null,Fe(e.availableRoles.builtInRoles,j=>(v(),m("option",{key:j,value:j},w(I(j)),9,rO))),128))])):E("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",cO,[(v(!0),m(Ie,null,Fe(e.availableRoles.customRoles,j=>(v(),m("option",{key:j,value:j},w(I(j)),9,uO))),128))])):E("",!0)],544)),[[Nn,f.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:P[5]||(P[5]=j=>d.value=!d.value)},w(d.value?"Use existing":"Custom"),1)]),l("label",dO,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":P[6]||(P[6]=j=>f.value.showInEmergencyInfo=j),onChange:S},null,544),[[Gs,f.value.showInEmergencyInfo]]),P[17]||(P[17]=l("span",null,"Show in emergency info",-1))])]),l("div",hO,[l("div",fO,[P[19]||(P[19]=l("label",{for:"phone"},"Phone:",-1)),Ue(l("input",{id:"phone","onUpdate:modelValue":P[7]||(P[7]=j=>f.value.phone=j),type:"tel",onInput:S,placeholder:"Phone number..."},null,544),[[at,f.value.phone]])]),l("div",pO,[P[20]||(P[20]=l("label",{for:"email"},"Email:",-1)),Ue(l("input",{id:"email","onUpdate:modelValue":P[8]||(P[8]=j=>f.value.email=j),type:"email",onInput:S,placeholder:"Email address..."},null,544),[[at,f.value.email]])])]),l("div",vO,[P[21]||(P[21]=l("label",{for:"notes"},"Notes / Instructions:",-1)),Ue(l("textarea",{id:"notes","onUpdate:modelValue":P[9]||(P[9]=j=>f.value.notes=j),onInput:S,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[at,f.value.notes]])]),l("div",mO,[l("div",gO,[P[22]||(P[22]=l("label",{for:"displayOrder"},"Display order:",-1)),Ue(l("input",{id:"displayOrder","onUpdate:modelValue":P[10]||(P[10]=j=>f.value.displayOrder=j),type:"number",onInput:S,min:"0"},null,544),[[at,f.value.displayOrder,void 0,{number:!0}]]),P[23]||(P[23]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",yO,[l("label",kO,[Ue(l("input",{type:"checkbox","onUpdate:modelValue":P[11]||(P[11]=j=>f.value.isPinned=j),onChange:S},null,544),[[Gs,f.value.isPinned]]),P[24]||(P[24]=l("span",null,"Pin to top",-1))]),P[25]||(P[25]=l("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[ks,u.value==="details"]]),Ue(l("div",_O,[Ae(yc,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":P[12]||(P[12]=j=>f.value.scopeConfigurations=j),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":g.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:S},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(_c,{show:i.value,title:"Validation error",message:r.value,onClose:P[13]||(P[13]=j=>i.value=!1)},null,8,["show","message"])],64))}},SO=Ge(LO,[["__scopeId","data-v-21d18628"]]),xO={key:0,class:"fullscreen-map-overlay"},IO={class:"fullscreen-map-header"},$O={class:"context-info"},TO={key:0},MO={class:"action-buttons"},AO=["disabled"],EO={class:"fullscreen-map-container"},PO={key:0,class:"drawing-controls"},DO={class:"point-count"},OO={class:"undo-redo-buttons"},RO=["disabled"],BO=["disabled"],NO=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,s=M(null),i=M(0),r=M(!1),u=M(!1),d=()=>{a("done")},f=()=>{a("cancel")},p=C=>{i.value=C?.length||0,g(),a("polygon-drawing",C)},g=()=>{s.value&&(r.value=s.value.canUndo(),u.value=s.value.canRedo())},y=()=>{s.value&&(s.value.undoPolygonPoint(),g())},k=()=>{s.value&&(s.value.redoPolygonPoint(),g())};Ze(()=>o.show,C=>{C||(i.value=0,r.value=!1,u.value=!1)});const b=C=>{C.key==="Escape"&&o.show&&f(),o.show&&o.drawingMode&&((C.ctrlKey||C.metaKey)&&C.key==="z"&&!C.shiftKey?(C.preventDefault(),y()):(C.ctrlKey||C.metaKey)&&(C.key==="y"||C.key==="z"&&C.shiftKey)&&(C.preventDefault(),k()))};return tn(()=>{document.addEventListener("keydown",b)}),yn(()=>{document.removeEventListener("keydown",b)}),(C,x)=>(v(),qe(Pl,{to:"body"},[e.show?(v(),m("div",xO,[l("div",IO,[l("div",$O,[l("h3",null,w(e.contextTitle),1),e.contextDescription?(v(),m("p",TO,w(e.contextDescription),1)):E("",!0)]),l("div",MO,[e.mode==="view"?(v(),m("button",{key:0,onClick:f,class:"btn btn-done"}," Close ")):(v(),m(Ie,{key:1},[l("button",{onClick:f,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,AO)],64))])]),l("div",EO,[Ae(Mu,Rp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},C.$attrs,{onMapClick:x[0]||(x[0]=$=>C.$emit("map-click",$)),onPolygonComplete:x[1]||(x[1]=$=>C.$emit("polygon-complete",$)),onPolygonDrawing:p,onLocationClick:x[2]||(x[2]=$=>C.$emit("location-click",$)),onAreaClick:x[3]||(x[3]=$=>C.$emit("area-click",$))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),m("div",PO,[l("div",DO,w(i.value)+" point"+w(i.value!==1?"s":""),1),l("div",OO,[l("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!r.value,title:"Undo last point"},"  Undo ",8,RO),l("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,BO)])])):E("",!0)])])):E("",!0)]))}}),FO=Ge(NO,[["__scopeId","data-v-9ce62b55"]]),UO={class:"form-group"},zO={class:"form-group"},HO={class:"form-group"},VO={key:0,class:"form-error"},GO={class:"form-row"},jO={class:"form-group",style:{flex:"1"}},ZO={class:"form-group",style:{flex:"1"}},WO={class:"form-group",style:{flex:"0 0 auto"}},qO={class:"form-group"},KO={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=dt(),a=e,s=t,i=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ze(()=>a.location,f=>{f&&(i.value={...f})},{immediate:!0,deep:!0});const r=()=>{s("update:isDirty",!0),s("update:location",{...i.value})},u=()=>{if(!Vr(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}s("save",i.value)},d=()=>{s("close")};return(f,p)=>(v(),qe(jt,{show:e.show,title:`Add ${D(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ve(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+w(D(o).checkpoint),1)]),default:Ve(()=>[l("form",{onSubmit:it(u,["prevent"])},[l("div",UO,[p[7]||(p[7]=l("label",null,"Name",-1)),Ue(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>i.value.name=g),type:"text",required:"",class:"form-input",onInput:r},null,544),[[at,i.value.name]])]),l("div",zO,[p[8]||(p[8]=l("label",null,"Description",-1)),Ue(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>i.value.description=g),type:"text",class:"form-input",onInput:r},null,544),[[at,i.value.description]])]),l("div",HO,[p[9]||(p[9]=l("label",null,"What3Words (optional)",-1)),Ue(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>i.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:r},null,544),[[at,i.value.what3Words]]),i.value.what3Words&&!D(Vr)(i.value.what3Words)?(v(),m("small",VO," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):E("",!0)]),l("div",GO,[l("div",jO,[p[10]||(p[10]=l("label",null,"Longitude",-1)),Ue(l("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>i.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[at,i.value.longitude,void 0,{number:!0}]])]),l("div",ZO,[p[11]||(p[11]=l("label",null,"Latitude",-1)),Ue(l("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>i.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:r},null,544),[[at,i.value.latitude,void 0,{number:!0}]])]),l("div",WO,[p[12]||(p[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>f.$emit("set-on-map"))},"  ")])]),l("div",qO,[l("label",null,"Required "+w(D(o).people),1),Ue(l("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>i.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:r},null,544),[[at,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},JO=Ge(KO,[["__scopeId","data-v-fb51fed0"]]),YO=["aria-expanded","title"],XO=["innerHTML"],QO={key:0,class:"dropdown-menu"},eR=["onClick"],tR=["innerHTML"],nR={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=Gv(),s=M(!1),i=M(null),r={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:r.system},{value:"light",label:"Light",icon:r.light},{value:"dark",label:"Dark",icon:r.dark}],d=F(()=>o.value?r.dark:r.light),f=()=>{s.value=!s.value},p=y=>{a(y),s.value=!1},g=y=>{i.value&&!i.value.contains(y.target)&&(s.value=!1)};return tn(()=>{document.addEventListener("click",g)}),yn(()=>{document.removeEventListener("click",g)}),(y,k)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[l("button",{class:"theme-toggle-btn",onClick:f,type:"button","aria-expanded":s.value,title:D(o)?"Dark mode":"Light mode"},[l("span",{class:"theme-icon",innerHTML:d.value},null,8,XO)],8,YO),s.value?(v(),m("div",QO,[(v(),m(Ie,null,Fe(u,b=>l("button",{key:b.value,class:ve(["dropdown-item",{active:D(t)===b.value}]),onClick:C=>p(b.value)},[l("span",{class:"option-icon",innerHTML:b.icon},null,8,tR),l("span",null,w(b.label),1)],10,eR)),64))])):E("",!0)],512))}},oR=Ge(nR,[["__scopeId","data-v-969124a4"]]),sR={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},aR=["id"],iR=["filter"],lR={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){wy(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=F(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),m("svg",sR,[l("defs",null,[l("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[l("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,aR)]),l("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,iR),a[2]||(a[2]=l("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),l("g",{class:ve({"marshal-figure":e.animate})},[...a[1]||(a[1]=[l("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),l("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},rR=Ge(lR,[["__scopeId","data-v-3e647831"]]),cR={class:"header"},uR={class:"header-left"},dR={key:0},hR={class:"event-date"},fR={class:"header-actions"},pR={class:"container"},vR={class:"tabs-nav"},mR={class:"tab-content-wrapper"},gR={class:"add-note-form"},yR={class:"modal-footer-actions"},kR=["disabled"],_R=6e4,bR={__name:"AdminEventManage",setup(e){const t=hc(),o=Zi(),a=Uv(),s=F(()=>t.params.eventId),{activeTab:i,switchTab:r}=zv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:f,confirmModalIsDanger:p,confirmModalConfirmText:g,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:b}=Mb(),{tabLabels:C,terms:x,termsLower:$}=dt(),I=Ab(),S=Pb(s),B=Eb(s),{colorScheme:R}=Gv(),Z=F(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:C.value.course,icon:"course"},{value:"areas",label:C.value.areas,icon:"area"},{value:"checkpoints",label:C.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:C.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:C.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),A=M(null),N=M([]),O=M([]),V=M({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),P=M(null),j=M(!1),Q=M(!1),ae=M(null),pe=M(null),ne=M(!1),oe=M(!1),U=M(null),Y=M(""),de=B.eventAdmins,ke=B.showAddAdmin,Re=S.showUploadRoute,Xe=S.uploading,Ne=S.uploadError,ze=S.showImportLocations,We=S.showImportMarshals,ee=S.importing,ye=S.importingMarshals,te=S.importError,ge=S.importResult,he=S.importMarshalsResult,G=M(!1),J=M(!1),ce=M({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Me=M(!1),Be=M(!1),De=M({marshalName:"",locations:[],marshal:null}),Le=M(null),X=M([]),fe=M(!1),xe=M(null),Se=M(null),_e=M(null),W=M({}),q=M({id:"",name:"",email:"",phoneNumber:"",notes:""}),K=M(!1),le=M([]),Ee=M([]),Ke=M([]),Qe=M([]),gt=M(!1),Lt=M(""),yt=M(""),xt=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),kt=M(!1),Ut=M(!1),Rt=M(""),ct=M(""),ln=M(0),un=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Bt=M([]),bt=M(null),Yn=M(!1),Un=M("details"),Xn=M(null),kn=M(null),Kt=M(null),_s=I.isAddingMultipleCheckpoints,Qn=I.multiCheckpointCounter,Co=I.isFullscreenMapActive,re=I.fullscreenMode,ue=I.fullscreenContext,me=I.tempLocationCoords,st=I.tempCheckpoints,je=I.savedMapCenter,$t=I.savedMapZoom,Yt=I.isDrawingAreaBoundary,nn=M(null),Bo=M([]),ho=M(null),No=M(!1),zn=M("details"),Aa=M(null),bs=M([]),Fo=M(null),ss=M(!1),qs=M("details"),Hn=M([]),Ks=M(!1),dn=M(null),Lo=M(!1),So=M(!1),ws=M(!1),fo=M(""),po=M(!1),eo=M([]),xo=M({builtInRoles:[],customRoles:[]}),pn=M(null),vo=M(!1),to=M("details"),mt=M(null),Et=M(""),Io=M(null),Uo=M(null),mo=F(()=>Uo.value?.marshalId!=null),Js=()=>{o.push(`/event/${t.params.eventId}`)},ht=F(()=>`${window.location.origin}/#/event/${t.params.eventId}`),zt=F(()=>{const H=[];return O.value.forEach(ie=>{ie.assignments&&H.push(...ie.assignments)}),H}),Ea=F(()=>{if(!xe.value)return O.value;const H=xe.value.assignedLocationIds||[],ie=Ke.value.map(we=>we.locationId),be=Qe.value;return O.value.filter(we=>!H.includes(we.id)&&!ie.includes(we.id)||be.includes(we.id))}),Cs=F(()=>{let H=X.value;if(P.value){const ie=P.value.assignments.map(we=>we.marshalName),be=le.value.map(we=>we.marshalName);H=X.value.filter(we=>!ie.includes(we.name)&&!be.includes(we.name))}return H.slice().sort((ie,be)=>ie.name.localeCompare(be.name))}),Mn=F(()=>re.value==="draw-area"&&bt.value?.polygon?.length>0||I.canCompleteFullscreen.value),Yi=F(()=>re.value==="move-checkpoint"&&P.value?.id?P.value.id:null),as=F(()=>{const H=[...O.value];return re.value==="place-checkpoint"&&me.value&&H.push({id:"temp-single",name:un.value.name||"New Checkpoint",latitude:me.value.lat,longitude:me.value.lng,requiredMarshals:un.value.requiredMarshals||1,assignments:[],isTemporary:!0}),re.value==="move-checkpoint"&&me.value&&P.value&&H.push({id:"temp-move",name:P.value.name+" (new position)",latitude:me.value.lat,longitude:me.value.lng,requiredMarshals:P.value.requiredMarshals,assignments:[],isTemporary:!0}),re.value==="add-multiple"&&H.push(...st.value),H}),$o=F(()=>{let H=[...Bt.value];return re.value==="draw-area"&&bt.value?.id&&(H=H.filter(ie=>ie.id!==bt.value.id)),re.value==="draw-area"&&bt.value?.polygon?.length>0&&H.push({...bt.value,id:bt.value.id||"temp-area"}),H}),qt=F(()=>{if(!xe.value||!Hn.value.length)return[];const H=xe.value.id,ie=xe.value.assignedLocationIds||[];return Hn.value.filter(be=>{if(be.reportedBy?.marshalId===H)return!0;const we=be.context?.checkpoint?.checkpointId;return!!(we&&ie.includes(we))}).sort((be,we)=>new Date(we.incidentTime||we.createdAt)-new Date(be.incidentTime||be.createdAt))}),zo=F(()=>{if(!P.value||!Hn.value.length)return[];const H=P.value.id;return Hn.value.filter(ie=>ie.context?.checkpoint?.checkpointId===H).sort((ie,be)=>new Date(be.incidentTime||be.createdAt)-new Date(ie.incidentTime||ie.createdAt))}),Ho=F(()=>{if(!bt.value||!Hn.value.length)return[];const H=bt.value.id,ie=O.value.filter(be=>be.areaIds&&be.areaIds.includes(H)).map(be=>be.id);return Hn.value.filter(be=>{const we=be.context?.checkpoint?.checkpointId;return we&&ie.includes(we)}).sort((be,we)=>new Date(we.incidentTime||we.createdAt)-new Date(be.incidentTime||be.createdAt))}),Ls=H=>{dn.value=H,Lo.value=!0},Pa=H=>{dn.value=H,Lo.value=!0},_n=H=>{dn.value=H,Lo.value=!0},no=()=>{o.push("/sessions")},Zt=(H=!0)=>{K.value=H},bn=()=>{kt.value=!0},Ys=async H=>{try{H&&(xt.value={...H});const ie=zl(A.value.eventDate),be=xt.value.eventDate;if(ie!==be){const we=N.value.filter(nt=>nt.startTime||nt.endTime);if(we.length>0){Rt.value=ie,ct.value=be,ln.value=we.length,Ut.value=!0;return}}await Xs(!1,null)}catch(ie){console.error("Failed to update event:",ie),alert("Failed to update event. Please try again.")}},Xs=async(H,ie)=>{try{if(await a.updateEvent(t.params.eventId,{...xt.value,defaultCheckpointStyleMapRotation:xt.value.defaultCheckpointStyleMapRotation!=null?String(xt.value.defaultCheckpointStyleMapRotation):null}),H&&ie!==null){const be=Math.floor(Math.abs(ie)/1e3),we=ie<0,nt=Math.floor(be/3600),It=Math.floor(be%3600/60),At=be%60,vn=`${we?"-":""}${nt.toString().padStart(2,"0")}:${It.toString().padStart(2,"0")}:${At.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,vn)}await An(),kt.value=!1}catch(be){console.error("Failed to update event:",be),alert("Failed to update event. Please try again.")}},Qs=async({shouldShift:H,timeDelta:ie})=>{Ut.value=!1,await Xs(H,ie)},ci=()=>{Ut.value=!1,An()},An=async()=>{try{await a.fetchEvent(t.params.eventId),A.value=a.currentEvent,A.value&&(xt.value={name:A.value.name||"",description:A.value.description||"",eventDate:zl(A.value.eventDate),timeZoneId:A.value.timeZoneId||"UTC",peopleTerm:A.value.peopleTerm||"Marshals",checkpointTerm:A.value.checkpointTerm||"Checkpoints",areaTerm:A.value.areaTerm||"Areas",checklistTerm:A.value.checklistTerm||"Checklists",courseTerm:A.value.courseTerm||"Course",defaultCheckpointStyleType:A.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:A.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:A.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:A.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:A.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:A.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:A.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:A.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:A.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:A.value.brandingHeaderGradientEnd||"",brandingLogoUrl:A.value.brandingLogoUrl||"",brandingLogoPosition:A.value.brandingLogoPosition||"",brandingAccentColor:A.value.brandingAccentColor||"",brandingPageGradientStart:A.value.brandingPageGradientStart||"",brandingPageGradientEnd:A.value.brandingPageGradientEnd||""},kt.value=!1,Iu(A.value));const H=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Sn(),ea(),rt(),wn(),St(),go(),Vo()]);N.value=a.locations,O.value=a.eventStatus.locations,H.forEach((ie,be)=>{ie.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][be]}:`,ie.reason)})}catch(H){console.error("Failed to load event data:",H)}},ea=async()=>{try{const H=await gs.getByEvent(t.params.eventId);X.value=H.data,V.value.marshals=Date.now()}catch(H){console.error("Failed to load marshals:",H)}},rt=async()=>{try{const H=await ba.getByEvent(t.params.eventId);Bt.value=H.data,V.value.areas=Date.now()}catch(H){console.error("Failed to load areas:",H)}},wn=async()=>{try{const[H,ie]=await Promise.all([Nt.getByEvent(t.params.eventId),Nt.getReport(t.params.eventId)]);Bo.value=H.data,Aa.value=ie.data,V.value.checklists=Date.now()}catch(H){console.error("Failed to load checklists:",H)}},St=async()=>{try{const H=await Ps.getByEvent(t.params.eventId);bs.value=H.data,V.value.notes=Date.now()}catch(H){console.error("Failed to load notes:",H)}},go=async()=>{Ks.value=!0;try{const H=await ps.getAll(t.params.eventId);Hn.value=H.data.incidents||[],V.value.incidents=Date.now()}catch(H){console.error("Failed to load incidents:",H)}finally{Ks.value=!1}},Vo=async()=>{try{const[H,ie]=await Promise.all([pa.getByEvent(t.params.eventId),pa.getRoles(t.params.eventId)]);eo.value=H.data,xo.value=ie.data,V.value.contacts=Date.now()}catch(H){console.error("Failed to load contacts:",H)}},ta=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),N.value=a.locations,V.value.checkpoints=Date.now(),O.value=a.eventStatus.locations},To=async()=>{await Promise.all([ea(),a.fetchEventStatus(t.params.eventId)]),O.value=a.eventStatus.locations},oo=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),rt()]),N.value=a.locations,O.value=a.eventStatus.locations},Mo=async()=>{await a.fetchEventStatus(t.params.eventId),O.value=a.eventStatus.locations},Ao=()=>{bt.value=null,Un.value="details",K.value=!1,Yn.value=!0},Jt=H=>{bt.value=H,kn.value=H.id,Un.value="details",K.value=!1,Yn.value=!0},Eo=async H=>{try{let ie;if(bt.value&&bt.value.id){if(ie=bt.value.id,await ba.update(t.params.eventId,ie,H),H.checklistChanges&&H.checklistChanges.length>0)for(const be of H.checklistChanges)try{be.complete?await Nt.complete(t.params.eventId,be.itemId,{marshalId:be.marshalId,contextType:be.contextType,contextId:be.contextId}):await Nt.uncomplete(t.params.eventId,be.itemId,{marshalId:be.marshalId,contextType:be.contextType,contextId:be.contextId})}catch(we){console.error("Failed to update checklist item:",be,we)}}else ie=(await ba.create({eventId:t.params.eventId,...H})).data.id;if(H.pendingContacts&&H.pendingContacts.length>0&&ie)for(const be of H.pendingContacts)try{const we=be.scopeConfigurations?JSON.parse(JSON.stringify(be.scopeConfigurations)):[],nt=we.find(It=>It.scope==="EveryoneInAreas"&&It.itemType==="Area");nt?(nt.ids||(nt.ids=[]),nt.ids.includes(ie)||nt.ids.push(ie)):we.push({scope:"EveryoneInAreas",itemType:"Area",ids:[ie]}),await pa.update(t.params.eventId,be.contactId,{...be,scopeConfigurations:we})}catch(we){console.error("Failed to add area to contact:",be,we)}if(H.contactsToRemove&&H.contactsToRemove.length>0&&ie)for(const be of H.contactsToRemove)try{const we=eo.value.find(At=>At.contactId===be);if(!we)continue;const nt=we.scopeConfigurations?JSON.parse(JSON.stringify(we.scopeConfigurations)):[],It=nt.find(At=>At.scope==="EveryoneInAreas"&&At.itemType==="Area");if(It&&It.ids){It.ids=It.ids.filter(vn=>vn!==ie);const At=It.ids.length>0?nt:nt.filter(vn=>!(vn.scope==="EveryoneInAreas"&&vn.itemType==="Area"));await pa.update(t.params.eventId,be,{...we,scopeConfigurations:At})}}catch(we){console.error("Failed to remove area from contact:",be,we)}(H.pendingContacts&&H.pendingContacts.length>0||H.contactsToRemove&&H.contactsToRemove.length>0)&&await Vo(),await rt(),await An(),na()}catch(ie){console.error("Failed to save area:",ie),alert(ie.response?.data?.message||"Failed to save area. Please try again.")}},Da=async H=>{y(`Delete ${$.value.area}`,`Are you sure you want to delete this ${$.value.area}? ${x.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ba.delete(t.params.eventId,H),await ba.recalculate(t.params.eventId),await rt(),await An(),na()}catch(ie){console.error(`Failed to delete ${$.value.area}:`,ie),alert(ie.response?.data?.message||`Failed to delete ${$.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},na=()=>{Yn.value=!1,bt.value=null,kn.value=null,K.value=!1,Yt.value=!1,Kt.value=null},Xi=({marshal:H,area:ie})=>{pn.value=null,to.value="details",K.value=!1,mt.value=ie,Et.value="",Io.value=H.id,vo.value=!0},Oa=({name:H,area:ie})=>{pn.value=null,to.value="details",K.value=!1,mt.value=ie,Et.value=H,Io.value=null,vo.value=!0},Ra=H=>{pn.value=H,to.value="details",K.value=!1,vo.value=!0},Qi=()=>{ho.value=null,zn.value="details",K.value=!1,No.value=!0},ui=(H,ie="details")=>{ho.value=H,zn.value=ie,K.value=!1,No.value=!0},_t=async H=>{try{if(ho.value&&ho.value.itemId)await Nt.update(t.params.eventId,ho.value.itemId,H);else{const ie=await Nt.create(t.params.eventId,H);ie.data.count&&ie.data.count>1&&(Lt.value="Checklist Items Created",yt.value=`Successfully created ${ie.data.count} checklist items.`,gt.value=!0)}await wn(),hn()}catch(ie){console.error("Failed to save checklist item:",ie);const be=ie.response?.data?.message||"Failed to save checklist item. Please try again.";alert(be)}},di=async H=>{y(`Delete ${$.value.checklist}`,`Are you sure you want to delete this ${$.value.checklist}?`,async()=>{try{await Nt.delete(t.params.eventId,H),await wn(),hn()}catch(ie){console.error(`Failed to delete ${$.value.checklist}:`,ie),alert(ie.response?.data?.message||`Failed to delete ${$.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},hn=()=>{No.value=!1,ho.value=null,K.value=!1},is=()=>{Fo.value=null,qs.value="details",K.value=!1,ss.value=!0},hi=H=>{Fo.value=H,qs.value="details",K.value=!1,ss.value=!0},el=async H=>{try{Fo.value&&Fo.value.noteId?await Ps.update(t.params.eventId,Fo.value.noteId,H):await Ps.create(t.params.eventId,H),await St(),oa()}catch(ie){console.error("Failed to save note:",ie);const be=ie.response?.data?.message||"Failed to save note. Please try again.";alert(be)}},Ba=async H=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await Ps.delete(t.params.eventId,H),await St(),oa()}catch(ie){console.error("Failed to delete note:",ie),alert(ie.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},oa=()=>{ss.value=!1,Fo.value=null,K.value=!1},Na=()=>{So.value=!0},fi=async H=>{try{await ps.create(t.params.eventId,H),So.value=!1,await go()}catch(ie){console.error("Failed to report incident:",ie),alert(ie.response?.data?.message||"Failed to report incident. Please try again.")}},tl=H=>{dn.value=H,Lo.value=!0},Oe=()=>{Lo.value=!1,dn.value=null},Pe=async({incidentId:H,status:ie})=>{try{if(await ps.updateStatus(t.params.eventId,H,{status:ie}),await go(),dn.value?.incidentId===H){const be=Hn.value.find(we=>we.incidentId===H);be&&(dn.value=be)}}catch(be){console.error("Failed to update incident status:",be),alert(be.response?.data?.message||"Failed to update status. Please try again.")}},tt=()=>{fo.value="",ws.value=!0},ft=()=>{ws.value=!1,fo.value=""},wt=async()=>{if(!(!fo.value.trim()||!dn.value)){po.value=!0;try{await ps.addNote(t.params.eventId,dn.value.incidentId,fo.value.trim()),ft(),await go();const H=Hn.value.find(ie=>ie.incidentId===dn.value.incidentId);H&&(dn.value=H)}catch(H){console.error("Failed to add note to incident:",H),alert(H.response?.data?.message||"Failed to add note. Please try again.")}finally{po.value=!1}}},Ht=()=>{pn.value=null,to.value="details",mt.value=null,K.value=!1,vo.value=!0},Cn=H=>{pn.value=H,to.value="details",K.value=!1,vo.value=!0},Vn=async H=>{try{let ie=null;const be=!pn.value||!pn.value.contactId,we=!!mt.value;if(pn.value&&pn.value.contactId)await pa.update(t.params.eventId,pn.value.contactId,H);else{const nt=await pa.create(t.params.eventId,H);ie=nt.data?.contactId||nt.data?.id}if(await Vo(),be&&we&&ie&&Xn.value){const nt=eo.value.find(It=>It.contactId===ie);nt&&Xn.value.addPendingContact(nt)}Ln()}catch(ie){console.error("Failed to save contact:",ie);const be=ie.response?.data?.message||"Failed to save contact. Please try again.";alert(be)}},Vt=async H=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await pa.delete(t.params.eventId,H),await Vo(),Xn.value&&Xn.value.removeContactById(H),Ln()}catch(ie){console.error("Failed to delete contact:",ie),alert(ie.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ln=()=>{vo.value=!1,pn.value=null,mt.value=null,Et.value="",Io.value=null,K.value=!1},Tt=H=>{Kt.value={...H,id:bt.value?.id};const ie={...H,id:bt.value?.id,polygon:[]};bt.value=ie;let be=!1;if(H.polygon&&H.polygon.length>0){const we=H.polygon.map(xn=>xn.lat||xn[0]),nt=H.polygon.map(xn=>xn.lng||xn[1]),It=Math.min(...we),At=Math.max(...we),vn=Math.min(...nt),ca=Math.max(...nt);je.value={lat:(It+At)/2,lng:(vn+ca)/2};const xi=At-It,xs=ca-vn,ua=Math.max(xi,xs);$t.value=ua<.005?17:ua<.01?16:ua<.02?15:ua<.05?14:13,be=!0}if(!be&&H.checkpointIds&&H.checkpointIds.length>0){const we=O.value.filter(nt=>H.checkpointIds.includes(nt.id));if(we.length>0){const nt=we.map(At=>At.latitude).filter(Boolean),It=we.map(At=>At.longitude).filter(Boolean);if(nt.length>0&&It.length>0){const At=Math.min(...nt),vn=Math.max(...nt),ca=Math.min(...It),xi=Math.max(...It);je.value={lat:(At+vn)/2,lng:(ca+xi)/2};const xs=vn-At,ua=xi-ca,xn=Math.max(xs,ua);$t.value=xn<.005?16:xn<.01?15:xn<.02?14:xn<.05?13:12,be=!0}}}if(!be&&ae.value){const we=ae.value.getMapCenter(),nt=ae.value.getMapZoom();we&&nt!==null&&(je.value=we,$t.value=nt)}Co.value=!0,re.value="draw-area",Yt.value=!0,ue.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},Xt=H=>{Kt.value?bt.value={...bt.value||{},...Kt.value,polygon:H}:bt.value={...bt.value,polygon:H}},so=H=>{I.handlePolygonDrawing(H)},ls=()=>{Yt.value=!1,Kt.value&&(bt.value=Kt.value,Yn.value=!0,Kt.value=null)},Sn=()=>B.loadEventAdmins(),pi=async H=>{try{await B.addAdmin(H),await Sn(),nl()}catch(ie){console.error("Failed to add admin:",ie),alert(ie.response?.data?.message||"Failed to add administrator. Please try again.")}},vi=async H=>{y("Remove administrator",`Remove ${H} as an administrator?`,async()=>{try{await B.removeAdmin(H),await Sn()}catch(ie){console.error("Failed to remove admin:",ie),alert(ie.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},nl=()=>{B.closeAddAdminModal(),K.value=!1},mi=async H=>{await S.uploadRoute(H)&&(await ta(),rs())},rs=()=>{S.closeUploadRouteModal()},bc=async({file:H,deleteExisting:ie})=>{const be=await S.importLocations(H,ie);if(be){await oo(),sa();const we=S.formatImportResultMessage(be,"location");Lt.value="Import Complete",yt.value=we,gt.value=!0}},sa=()=>{S.closeImportLocationsModal()},ao=async H=>{if(Q.value)un.value.latitude=H.lat,un.value.longitude=H.lng;else if(J.value)ce.value.latitude=H.lat,ce.value.longitude=H.lng,P.value&&(P.value={...P.value,latitude:H.lat,longitude:H.lng}),J.value=!1,G.value=!0,Zt();else if(_s.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${Qn.value}`,description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""}),Qn.value++,await An()}catch(ie){console.error("Failed to create checkpoint:",ie),alert("Failed to create checkpoint. Please try again.")}},Xl=H=>{I.handleFullscreenMapClick(H)},Ql=H=>{un.value={...H}},wc=()=>{Q.value=!1,I.enterPlaceCheckpointMode()},ol=()=>{I.saveMapState(ae.value),un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},I.enterPlaceCheckpointMode()},sl=()=>{I.saveMapState(ae.value),Co.value=!0,re.value="view",ue.value={title:"Course map",description:""}},Cc=()=>{I.saveMapState(ae.value),bt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Bt.value.length},I.enterDrawAreaMode()},Lc=()=>{P.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ce.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},le.value=[],Ee.value=[],K.value=!1,G.value=!0},er=()=>{const H=I.calculateStartingNumber(O);I.saveMapState(ae.value),I.enterAddMultipleMode(H)},Sc=()=>{if(re.value==="place-checkpoint"){const H=I.getPlacedCoords()||{lat:0,lng:0};P.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ce.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""},le.value=[],Ee.value=[],K.value=!1,gi(),G.value=!0}else if(re.value==="move-checkpoint"){const H=I.getPlacedCoords();H&&(ce.value.latitude=H.lat,ce.value.longitude=H.lng,P.value&&(P.value={...P.value,...nn.value||{},latitude:H.lat,longitude:H.lng}),Zt()),nn.value=null,gi(),G.value=!0}else if(re.value==="draw-area"){const H=I.getCompletedPolygon();H&&(Kt.value?bt.value={...bt.value||{},...Kt.value,polygon:H}:bt.value={...bt.value||{},polygon:H}),Kt.value=null,gi()}else re.value==="add-multiple"&&yo()},yo=async()=>{const H=I.getTempCheckpoints();try{for(const ie of H)await a.createLocation({eventId:t.params.eventId,name:ie.name,description:ie.description,latitude:ie.latitude,longitude:ie.longitude,requiredMarshals:ie.requiredMarshals,what3Words:ie.what3Words});I.clearTempCheckpoints(),gi(),await An()}catch(ie){console.error("Failed to create checkpoints:",ie),alert("Failed to create checkpoints. Please try again.")}},aa=()=>{re.value==="draw-area"?Kt.value&&(bt.value=Kt.value,Kt.value=null):re.value==="move-checkpoint"&&(nn.value&&P.value&&Object.assign(P.value,nn.value),G.value=!0,J.value=!1),I.cancelFullscreen()},gi=()=>{I.exitFullscreen()},Go=H=>{yi(H)},yi=H=>{P.value=H,ce.value={id:H.id,name:H.name,description:H.description||"",latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||""},le.value=[],Ee.value=[],K.value=!1,G.value=!0,setTimeout(()=>{ae.value?.scrollMapIntoView()},100)},ia=async H=>{if(!Vr(H.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...H}),await An(),tr()}catch(ie){console.error("Failed to save location:",ie),alert("Failed to save location. Please try again.")}},tr=()=>{Q.value=!1,un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},K.value=!1,K.value=!1},Ss=()=>{G.value=!1,P.value=null,j.value=!1,J.value=!1,Me.value=!1,nn.value=null,ce.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},le.value=[],Ee.value=[],K.value=!1},ki=()=>{Me.value=!1},_i=()=>{Me.value=!0},xc=H=>{H?.formData&&(nn.value=H.formData),G.value=!1,me.value=null;const ie=nn.value?.latitude??P.value?.latitude,be=nn.value?.longitude??P.value?.longitude;if(ie&&be)je.value={lat:ie,lng:be},$t.value=16;else if(ae.value){const nt=ae.value.getMapCenter(),It=ae.value.getMapZoom();nt&&It!==null&&(je.value=nt,$t.value=It)}const we=nn.value?.name||P.value?.name;Co.value=!0,re.value="move-checkpoint",ue.value={title:`Move ${$.value.checkpoint}: ${we}`,description:"Click on the map to set the new location"}},cs=async H=>{if(!Vr(H.what3Words)){alert("Invalid What3Words format.");return}try{const ie=!P.value.id;if(ie){const be=await a.createLocation({eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const we of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:be.id,marshalId:we.marshalId})}else{const be=P.value.id;if(await Kn.update(t.params.eventId,be,{eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const we of H.pendingNewChecklistItems)we.text?.trim()&&await Nt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[be]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const we of H.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await Ps.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[be]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const we of Ee.value)await a.deleteAssignment(t.params.eventId,we);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const we of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of le.value)await a.createAssignment({eventId:t.params.eventId,locationId:P.value.id,marshalId:we.marshalId});if(H.checkInChanges&&H.checkInChanges.length>0)for(const we of H.checkInChanges){const nt=P.value.assignments.find(It=>It.id===we.assignmentId);nt&&nt.isCheckedIn!==we.shouldBeCheckedIn&&await Sa.adminCheckIn(t.params.eventId,we.assignmentId)}}if(!ie&&H.checklistChanges&&H.checklistChanges.length>0)for(const be of H.checklistChanges)try{be.complete?await Nt.complete(t.params.eventId,be.itemId,{marshalId:be.marshalId,contextType:be.contextType,contextId:be.contextId}):await Nt.uncomplete(t.params.eventId,be.itemId,{marshalId:be.marshalId,contextType:be.contextType,contextId:be.contextId})}catch(we){console.error("Failed to update checklist item:",be,we)}await An(),Ss()}catch(ie){console.error("Failed to update location:",ie),alert("Failed to update location. Please try again.")}},bi=async H=>{y(`Delete ${$.value.checkpoint}`,`Are you sure you want to delete this ${$.value.checkpoint}?`,async()=>{try{await Kn.delete(t.params.eventId,H),await oo(),Ss()}catch(ie){console.error(`Failed to delete ${$.value.checkpoint}:`,ie),alert(`Failed to delete ${$.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Ic=async H=>{try{if(pe.value&&pe.value.setCheckingIn(H.id),await Sa.adminCheckIn(t.params.eventId,H.id),await Mo(),P.value){const ie=O.value.find(be=>be.id===P.value.id);ie&&(P.value=ie)}}catch(ie){console.error("Failed to toggle check-in:",ie),alert("Failed to toggle check-in. Please try again.")}finally{pe.value&&pe.value.setCheckingIn(null)}},al=H=>{const ie=H?.id??H;if(ie?.toString().startsWith("temp-")){const be=P.value.assignments.find(we=>we.id===ie);be&&(le.value=le.value.filter(we=>we.marshalId!==be.marshalId)),P.value.assignments=P.value.assignments.filter(we=>we.id!==ie),Zt()}else Ee.value.includes(ie)||(Ee.value.push(ie),P.value.assignments=P.value.assignments.filter(be=>be.id!==ie),Zt())},$c=async H=>{const ie=X.value.find(we=>we.id===H);if(!ie)return;const be=O.value.filter(we=>we.assignments?.some(nt=>nt.marshalId===H&&we.id!==P.value.id));if(be.length>0){De.value={marshalName:ie.name,locations:be.map(nt=>nt.name),marshal:ie};const we=await new Promise(nt=>{Le.value=nt,Be.value=!0});if(we==="cancel"||we==="choose-other")return;if(we==="move")for(const nt of be){const It=nt.assignments.find(At=>At.marshalId===H);if(It){Ee.value.push(It.id);const At=O.value.findIndex(vn=>vn.id===nt.id);At!==-1&&(O.value[At].assignments=O.value[At].assignments.filter(vn=>vn.id!==It.id))}}}le.value.push({marshalId:ie.id,marshalName:ie.name}),P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ie.id,marshalName:ie.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0}),Zt(),ki()},jo=async H=>{try{const be=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber})).data;await ea(),le.value.push({marshalId:be.id,marshalName:be.name}),P.value&&(P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:be.id,marshalName:be.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0})),Zt(),ki()}catch(ie){console.error("Failed to create marshal:",ie),alert("Failed to create marshal. Please try again.")}},Tc=()=>{xe.value=null,W.value={},q.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ke.value=[],Qe.value=[],K.value=!1,fe.value=!0},la=H=>{xe.value=H,W.value={},q.value={id:H.id,name:H.name,email:H.email||"",phoneNumber:H.phoneNumber||"",notes:H.notes||""},Ke.value=[],Qe.value=[],K.value=!1,fe.value=!0},nr=F(()=>{if(!xe.value)return[];const H=[];return O.value.forEach(ie=>{ie.assignments.filter(we=>we.marshalName===xe.value.name&&!Qe.value.includes(we.id)).forEach(we=>{H.push({...we,locationName:ie.name,locationDescription:ie.description||""})})}),Ke.value.forEach((ie,be)=>{const we=O.value.find(nt=>nt.id===ie.locationId);we&&H.push({id:`pending-${be}`,locationId:ie.locationId,locationName:we.name,locationDescription:we.description||"",marshalId:xe.value.id,marshalName:xe.value.name,isCheckedIn:!1,isPending:!0})}),H}),Zo=async H=>{try{let ie=xe.value?.id,be=!1;if(xe.value){if(await gs.update(t.params.eventId,xe.value.id,{name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const we of H.pendingNewChecklistItems)we.text?.trim()&&await Nt.create(t.params.eventId,{text:we.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ie]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const we of H.pendingNewNotes)!we.title?.trim()&&!we.content?.trim()||await Ps.create(t.params.eventId,{title:we.title||"Untitled",content:we.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ie]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ie=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]})).data.id,be=!0;for(const we of Qe.value)await a.deleteAssignment(t.params.eventId,we);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const we of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,we);for(const we of Ke.value)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:ie});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const we of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:we.locationId,marshalId:ie});if(H.checkInChanges&&H.checkInChanges.length>0){const we=nr.value;for(const nt of H.checkInChanges){const It=we.find(At=>At.id===nt.assignmentId);It&&It.isCheckedIn!==nt.shouldBeCheckedIn&&await Sa.adminCheckIn(t.params.eventId,nt.assignmentId)}}if(H.checklistChanges&&H.checklistChanges.length>0)for(const we of H.checklistChanges)try{const nt={marshalId:ie};we.contextType&&we.contextId&&(nt.contextType=we.contextType,nt.contextId=we.contextId),we.complete?await Nt.complete(t.params.eventId,we.itemId,nt):await Nt.uncomplete(t.params.eventId,we.itemId,nt)}catch(nt){console.error("Failed to process checklist change:",nt);const It=nt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${It}`)}if(await An(),P.value){const we=O.value.find(nt=>nt.id===P.value.id);we&&(P.value=we)}Ua(),be&&(U.value=ie,Y.value=H.name,oe.value=!0)}catch(ie){console.error("Failed to save marshal:",ie);const be=ie.response?.data?.message||"Failed to save marshal. Please try again.";if(ie.response?.status===400){const we=be.toLowerCase();we.includes("name")?(W.value={name:be},_e.value&&(_e.value.switchToTab("details"),_e.value.focusField("name"))):we.includes("email")?(W.value={email:be},_e.value&&(_e.value.switchToTab("details"),_e.value.focusField("email"))):(W.value={general:be},_e.value&&_e.value.switchToTab("details"))}else W.value={general:be},_e.value&&_e.value.switchToTab("details")}},Fa=async H=>{const ie=H||xe.value?.id;if(!ie){console.error("No marshal ID to delete");return}const be=$.value.person;y(`Delete ${be}`,`Are you sure you want to delete this ${be}?`,async()=>{try{await gs.delete(t.params.eventId,ie),await To(),Ua()}catch(we){console.error(`Failed to delete ${be}:`,we),alert(`Failed to delete ${be}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},or=H=>{Fa(H.id)},il=H=>{const ie=H?.id??H;if(ie?.toString().startsWith("pending-")){const be=H?.locationId;be&&(Ke.value=Ke.value.filter(we=>we.locationId!==be)),Zt()}else Qe.value.includes(ie)||(Qe.value.push(ie),Zt())},wi=H=>{Ke.value.push({locationId:H}),Zt()},Ua=()=>{fe.value=!1,xe.value=null,Se.value=null,W.value={},q.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ke.value=[],Qe.value=[],K.value=!1},Ci=async H=>{const ie=X.value.find(be=>be.id===H.marshalId);if(!ie){console.error("Marshal not found:",H.marshalId);return}Se.value=P.value?.id||null,K.value=!1,xe.value=ie,fe.value=!0},ra=H=>{const ie=O.value.find(be=>be.id===H.locationId);if(!ie){console.error("Location not found:",H.locationId);return}j.value=!0,K.value=!1,P.value=ie,G.value=!0},Li=async({file:H})=>{const ie=await S.importMarshals(H);if(ie){await To(),Si();const be=S.formatImportResultMessage(ie,"marshal");Lt.value="Import Complete",yt.value=be,gt.value=!0}},Si=()=>{S.closeImportMarshalsModal()},sr=H=>{Le.value&&(Le.value(H),Le.value=null),Be.value=!1};let za=null;const Ha=async()=>{try{const H=t.params.eventId,ie=await Kn.getDynamicCheckpoints(H);if(ie.data&&Array.isArray(ie.data))for(const be of ie.data){const we=O.value.find(nt=>nt.id===be.checkpointId);we&&(we.latitude=be.latitude,we.longitude=be.longitude,we.lastLocationUpdate=be.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},ar=()=>{za||!O.value.some(ie=>ie.isDynamic||ie.IsDynamic)||(Ha(),za=setInterval(Ha,6e4))},ll=()=>{za&&(clearInterval(za),za=null)};return Ze(i,H=>{H==="course"?ar():ll();const ie=Date.now(),be=we=>ie-V.value[we]>_R;switch(H){case"marshals":be("marshals")&&ea();break;case"areas":be("areas")&&rt();break;case"checkpoints":be("checkpoints")&&ta();break;case"checklists":be("checklists")&&wn();break;case"notes":be("notes")&&St();break;case"incidents":be("incidents")&&go();break;case"contacts":be("contacts")&&Vo();break}}),tn(async()=>{await An();try{const H=await ms.getMe(t.params.eventId);Uo.value=H.data}catch(H){console.warn("Failed to fetch user claims:",H)}i.value==="course"&&ar()}),Ze(A,H=>{H&&(document.title="OnTheDay App - Admin")},{immediate:!0}),yn(()=>{ll()}),(H,ie)=>(v(),m("div",{class:"admin-event-manage",style:et({colorScheme:D(R)})},[l("header",cR,[l("div",uR,[l("button",{onClick:no,class:"btn-back",title:"Back to sessions"},[Ae(rR,{size:48,animate:""})]),A.value?(v(),m("div",dR,[l("h1",null,w(A.value.name),1),l("p",hR,w(D(jv)(A.value.eventDate)),1)])):E("",!0)]),l("div",fR,[mo.value?(v(),m("button",{key:0,onClick:Js,class:"btn btn-marshal-mode"}," Switch to Marshal ")):E("",!0)]),Ae(oR,{class:"theme-toggle-fixed"})]),l("div",pR,[l("div",vR,[Ae(F$,{tabs:Z.value,"model-value":D(i),"onUpdate:modelValue":D(r)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",mR,[D(i)==="course"?(v(),qe(K0,{key:0,ref_key:"courseAreasTab",ref:ae,checkpoints:O.value,areas:Bt.value,route:A.value?.route||[],"selected-area-id":kn.value,"drawing-mode":D(Yt),onMapClick:ao,onLocationClick:Go,onAreaClick:Jt,onImportCheckpoints:ie[0]||(ie[0]=be=>ze.value=!0),onUploadRoute:ie[1]||(ie[1]=be=>Re.value=!0),onSelectLocation:yi,onAddArea:Ao,onSelectArea:Jt,onPolygonComplete:Xt,onCancelDrawing:ls,onAddCheckpointFromMap:ol,onAddManyCheckpointsFromMap:er,onAddAreaFromMap:Cc,onFullscreen:sl},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):E("",!0),D(i)==="checkpoints"?(v(),qe(c$,{key:1,locations:O.value,areas:Bt.value,onAddCheckpointManually:Lc,onImportCheckpoints:ie[2]||(ie[2]=be=>ze.value=!0),onSelectLocation:yi},null,8,["locations","areas"])):E("",!0),D(i)==="areas"?(v(),qe(T$,{key:2,areas:Bt.value,checkpoints:O.value,contacts:eo.value,"event-people-term":A.value?.peopleTerm||"Marshals","event-checkpoint-term":A.value?.checkpointTerm||"Checkpoints",onAddArea:Ao,onSelectArea:Jt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):E("",!0),D(i)==="marshals"?(v(),qe(Yw,{key:3,ref_key:"marshalsTabRef",ref:pe,marshals:X.value,assignments:zt.value,locations:O.value,onAddMarshal:Tc,onImportMarshals:ie[3]||(ie[3]=be=>We.value=!0),onSelectMarshal:la,onDeleteMarshal:or,onToggleCheckIn:Ic},null,8,["marshals","assignments","locations"])):E("",!0),D(i)==="checklists"?(v(),qe(dC,{key:4,"checklist-items":Bo.value,areas:Bt.value,locations:O.value,marshals:X.value,"completion-report":Aa.value,onAddChecklistItem:Qi,onSelectChecklistItem:ui},null,8,["checklist-items","areas","locations","marshals","completion-report"])):E("",!0),D(i)==="notes"?(v(),qe(MC,{key:5,notes:bs.value,areas:Bt.value,locations:O.value,marshals:X.value,onAddNote:is,onSelectNote:hi},null,8,["notes","areas","locations","marshals"])):E("",!0),D(i)==="incidents"?(v(),qe(GI,{key:6,incidents:Hn.value,areas:Bt.value,loading:Ks.value,onSelectIncident:tl,onReportIncident:Na},null,8,["incidents","areas","loading"])):E("",!0),D(i)==="contacts"?(v(),qe(a2,{key:7,contacts:eo.value,areas:Bt.value,locations:O.value,marshals:X.value,"available-roles":xo.value,onAddContact:Ht,onSelectContact:Cn},null,8,["contacts","areas","locations","marshals","available-roles"])):E("",!0),D(i)==="details"?(v(),qe(g2,{key:8,"event-data":xt.value,"form-dirty":kt.value,onSubmit:Ys,"onUpdate:formDirty":bn},null,8,["event-data","form-dirty"])):E("",!0),D(i)==="settings"?(v(),qe(_I,{key:9,"event-data":xt.value,"event-id":D(t).params.eventId,admins:D(de),"form-dirty":kt.value,onSubmit:Ys,onAddAdmin:ie[4]||(ie[4]=be=>ke.value=!0),onRemoveAdmin:vi,"onUpdate:formDirty":bn},null,8,["event-data","event-id","admins","form-dirty"])):E("",!0)])]),Ae(JO,{show:Q.value,location:un.value,"is-dirty":K.value,onClose:tr,onSave:ia,onSetOnMap:wc,"onUpdate:isDirty":Zt,"onUpdate:location":Ql},null,8,["show","location","is-dirty"]),Ae(t3,{show:G.value,location:P.value,assignments:P.value?.assignments||[],"event-date":A.value?.eventDate||"",areas:Bt.value,"event-id":D(t).params.eventId,"all-locations":O.value,notes:bs.value,"available-marshals":Cs.value,"all-checklist-items":Bo.value,incidents:zo.value,"is-dirty":K.value,"event-default-style-type":A.value?.defaultCheckpointStyleType||A.value?.DefaultCheckpointStyleType||"default","event-default-style-color":A.value?.defaultCheckpointStyleColor||A.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":A.value?.defaultCheckpointStyleBackgroundShape||A.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":A.value?.defaultCheckpointStyleBackgroundColor||A.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":A.value?.defaultCheckpointStyleBorderColor||A.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":A.value?.defaultCheckpointStyleIconColor||A.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":A.value?.defaultCheckpointStyleSize||A.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":A.value?.defaultCheckpointStyleMapRotation??A.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":A.value?.peopleTerm||"Marshals","z-index":Yn.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:Ss,onSave:cs,onDelete:bi,onMoveLocation:xc,onRemoveAssignment:al,onOpenAssignModal:_i,"onUpdate:isDirty":Zt,onSelectIncident:Pa,onSelectMarshal:Ci},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ae(G$,{show:ne.value,link:ht.value,"is-dirty":!1,onClose:ie[5]||(ie[5]=be=>ne.value=!1)},null,8,["show","link"]),Ae(sT,{show:oe.value,"event-id":D(t).params.eventId,"marshal-id":U.value,"marshal-name":Y.value,onClose:ie[6]||(ie[6]=be=>oe.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ae(lT,{show:D(ke),"is-dirty":K.value,onClose:nl,onSubmit:pi,"onUpdate:isDirty":Zt},null,8,["show","is-dirty"]),Ae(hT,{show:D(Re),uploading:D(Xe),error:D(Ne),"is-dirty":K.value,onClose:rs,onSubmit:mi,"onUpdate:isDirty":Zt},null,8,["show","uploading","error","is-dirty"]),Ae(wT,{show:D(ze),importing:D(ee),error:D(te),result:D(ge),"is-dirty":K.value,onClose:sa,onSubmit:bc,"onUpdate:isDirty":Zt},null,8,["show","importing","error","result","is-dirty"]),Ae(XP,{ref_key:"editMarshalModalRef",ref:_e,show:fe.value,marshal:xe.value,"event-id":D(t).params.eventId,assignments:nr.value,"available-locations":Ea.value,"all-locations":O.value,areas:Bt.value,"is-editing":!!xe.value,"event-notes":bs.value,"all-checklist-items":Bo.value,incidents:qt.value,"is-dirty":K.value,"validation-errors":W.value,"locked-checkpoint-id":Se.value,"z-index":Se.value?1100:1e3,onClose:Ua,onSave:Zo,onDelete:Fa,onRemoveAssignment:il,onAssignToLocation:wi,"onUpdate:isDirty":Zt,onSelectIncident:Ls,onSelectCheckpoint:ra},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ae(MT,{show:D(We),importing:D(ye),error:D(te),result:D(he),"is-dirty":K.value,onClose:Si,onSubmit:Li,"onUpdate:isDirty":Zt},null,8,["show","importing","error","result","is-dirty"]),Ae(n6,{show:Be.value,"conflict-data":De.value,onClose:ie[7]||(ie[7]=be=>Be.value=!1),onChoice:sr},null,8,["show","conflict-data"]),Ae(h6,{show:Me.value,"location-name":P.value?.name||"",marshals:Cs.value,onClose:ki,onAssignExisting:$c,onCreateAndAssign:jo},null,8,["show","location-name","marshals"]),Ae(L6,{show:Ut.value,"old-event-date":Rt.value,"new-event-date":ct.value,"affected-checkpoints-count":ln.value,onConfirm:Qs,onCancel:ci},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ae(H5,{ref_key:"editAreaModalRef",ref:Xn,show:Yn.value,area:bt.value,"initial-tab":Un.value,checkpoints:O.value,marshals:X.value,areas:Bt.value,route:A.value?.route||[],"is-dirty":K.value,"event-id":D(t).params.eventId,"all-locations":O.value,assignments:zt.value,notes:bs.value,contacts:eo.value,incidents:Ho.value,"event-default-style-type":A.value?.defaultCheckpointStyleType||A.value?.DefaultCheckpointStyleType||"default","event-default-style-color":A.value?.defaultCheckpointStyleColor||A.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":A.value?.defaultCheckpointStyleBackgroundShape||A.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":A.value?.defaultCheckpointStyleBackgroundColor||A.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":A.value?.defaultCheckpointStyleBorderColor||A.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":A.value?.defaultCheckpointStyleIconColor||A.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":A.value?.defaultCheckpointStyleSize||A.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":A.value?.defaultCheckpointStyleMapRotation??A.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":A.value?.peopleTerm||"Marshals","event-checkpoint-term":A.value?.checkpointTerm||"Checkpoints",onClose:na,onSave:Eo,onDelete:Da,onDrawBoundary:Tt,"onUpdate:isDirty":Zt,onSelectCheckpoint:yi,onCreateContactFromMarshal:Xi,onCreateNewContact:Oa,onEditContact:Ra,onSelectIncident:_n},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ae(e8,{show:No.value,"checklist-item":ho.value,"initial-tab":zn.value,areas:Bt.value,locations:O.value,marshals:X.value,"is-dirty":K.value,onClose:hn,onSave:_t,onDelete:di,"onUpdate:isDirty":Zt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ae(m8,{show:ss.value,note:Fo.value,"initial-tab":qs.value,areas:Bt.value,locations:O.value,marshals:X.value,"is-dirty":K.value,onClose:oa,onSave:el,onDelete:Ba,"onUpdate:isDirty":Zt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ae(tm,{show:Lo.value,incident:dn.value,route:A.value?.route||[],checkpoints:O.value,"can-manage":!0,onClose:Oe,onStatusChange:Pe,onOpenAddNote:tt},null,8,["show","incident","route","checkpoints"]),Ae(jt,{show:ws.value,title:"Add update",size:"small",onClose:ft},{footer:Ve(()=>[l("div",yR,[l("button",{type:"button",class:"btn btn-secondary",onClick:ft}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:wt,disabled:!fo.value.trim()||po.value},w(po.value?"Adding...":"Add update"),9,kR)])]),default:Ve(()=>[l("div",gR,[Ue(l("textarea",{"onUpdate:modelValue":ie[8]||(ie[8]=be=>fo.value=be),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,fo.value]])])]),_:1},8,["show"]),Ae(nm,{show:So.value,"event-id":D(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:O.value,route:A.value?.route||[],onClose:ie[9]||(ie[9]=be=>So.value=!1),onSubmit:fi},null,8,["show","event-id","checkpoints","route"]),Ae(SO,{show:vo.value,contact:pn.value,"initial-tab":to.value,areas:Bt.value,locations:O.value,marshals:X.value,"available-roles":xo.value,"is-dirty":K.value,"prefilled-name":Et.value,"prefilled-marshal-id":Io.value,"create-from-area-context":!!mt.value,onClose:Ln,onSave:Vn,onDelete:Vt,"onUpdate:isDirty":Zt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ae(FO,{show:D(Co),mode:D(re),"context-title":D(ue).title,"context-description":D(ue).description,"can-complete":Mn.value,clickable:D(re)!=="draw-area","drawing-mode":D(re)==="draw-area"&&D(Yt),locations:as.value,areas:$o.value,route:A.value?.route||[],"selected-area-id":kn.value,center:D(je),zoom:D($t),"highlight-location-id":Yi.value,onMapClick:Xl,onPolygonComplete:Xt,onPolygonDrawing:so,onDone:Sc,onCancel:aa},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ae(_c,{show:gt.value,title:Lt.value,message:yt.value,onClose:ie[10]||(ie[10]=be=>gt.value=!1)},null,8,["show","title","message"]),Ae($a,{show:D(u),title:D(d),message:D(f),"is-danger":D(p),"confirm-text":D(g),onConfirm:D(k),onCancel:D(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},wR=Ge(bR,[["__scopeId","data-v-d8917ba7"]]),CR={key:0,class:"emergency-notes-section"},LR={class:"emergency-notes-list"},SR={class:"note-header"},xR={key:0,class:"note-content"},IR={key:1,class:"emergency-contacts-section"},$R={class:"emergency-contacts-list"},TR={class:"contact-header"},MR={key:0,class:"role-badge"},AR={class:"contact-details"},ER={key:0,class:"info-section"},PR=["href"],DR={key:1,class:"info-section"},OR=["href"],RR={key:2,class:"info-section"},BR=["href"],NR={key:2,class:"no-contacts"},FR={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,s=F(()=>o.notes?[...o.notes].filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,f)=>{const p=d.isPinned||d.IsPinned,g=f.isPinned||f.IsPinned;if(p!==g)return p?-1:1;const y=d.displayOrder||d.DisplayOrder||0,k=f.displayOrder||f.DisplayOrder||0;if(y!==k)return y-k;const b=d.priority||d.Priority,C=f.priority||f.Priority;return b==="Emergency"&&C!=="Emergency"?-1:C==="Emergency"&&b!=="Emergency"?1:0}):[]),i=F(()=>o.contacts?o.contacts.filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,f)=>{const p=d.isPinned||d.IsPinned,g=f.isPinned||f.IsPinned;if(p!==g)return p?-1:1;const y=d.displayOrder||d.DisplayOrder||0,k=f.displayOrder||f.DisplayOrder||0;if(y!==k)return y-k;const b=d.name||d.Name||"",C=f.name||f.Name||"";return b.localeCompare(C,void 0,{sensitivity:"base"})}):[]),r=()=>{a("close")},u=d=>d?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[d]||d.replace(/([A-Z])/g," $1").trim():"";return(d,f)=>(v(),qe(jt,{show:e.show,title:"Emergency information",size:"medium",onClose:r},{actions:Ve(()=>[l("button",{onClick:r,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[s.value.length>0?(v(),m("div",CR,[f[0]||(f[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",LR,[(v(!0),m(Ie,null,Fe(s.value,p=>(v(),m("div",{key:p.noteId||p.NoteId,class:ve(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[l("div",SR,[l("h3",null,w(p.title||p.Title),1),l("span",{class:ve(["priority-badge",(p.priority||p.Priority).toLowerCase()])},w(p.priority||p.Priority),3)]),p.content||p.Content?(v(),m("div",xR,w(p.content||p.Content),1)):E("",!0)],2))),128))])])):E("",!0),i.value&&i.value.length>0?(v(),m("div",IR,[f[4]||(f[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",$R,[(v(!0),m(Ie,null,Fe(i.value,p=>(v(),m("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[l("div",TR,[l("h3",null,w(p.name),1),p.role?(v(),m("span",MR,w(u(p.role)),1)):E("",!0)]),l("div",AR,[p.phone?(v(),m("div",ER,[f[1]||(f[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${p.phone}`,class:"phone-link"},w(p.phone),9,PR)])):E("",!0),p.email?(v(),m("div",DR,[f[2]||(f[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${p.email}`,class:"email-link"},w(p.email),9,OR)])):E("",!0),p.notes||p.details?(v(),m("div",RR,[f[3]||(f[3]=l("label",null,"Details",-1)),l("p",null,w(p.notes||p.details),1)])):E("",!0)]),p.phone?(v(),m("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+w(p.name),9,BR)):E("",!0)]))),128))])])):E("",!0),i.value.length===0&&s.value.length===0?(v(),m("div",NR,[...f[5]||(f[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):E("",!0)]),_:1},8,["show"]))}},UR=Ge(FR,[["__scopeId","data-v-57827f4f"]]),yl=M(navigator.onLine),Fs=M(!0),wa=M(0),mr=M(null),Ya=M("idle"),Fi=M(null),Pu=M(!1);let df=null,Qc=!1,Ko=null,hf=0;function zR(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Zr(){Ko&&(clearTimeout(Ko),Ko=null);const e=zR(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Ko=setTimeout(async()=>{if(Ko=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await zr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Wr();const o=await zr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Zr())},e)}async function Di(){if(!navigator.onLine)return Fs.value=!1,!1;try{return await W_.check(),Fs.value=!0,!0}catch(e){return e.response?.status===404?(Fs.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Fs.value=!1,!1)}}async function cd(){const e=Date.now();if(e-hf<2e3)return;hf=e;const t=navigator.onLine;if(yl.value=t,!t){Fs.value=!1;return}Pu.value=!0;try{await Di()&&wa.value>0&&Zr()}finally{Pu.value=!1}}function ff(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),cd())}function pf(){console.log("Window focused, checking connectivity..."),cd()}async function HR(e){try{switch(e.type){case"checkin":await Sa.checkIn(e.payload);break;case"checkin_toggle":await Sa.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await Sa.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Nt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Nt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Wr(){if(!Qc&&navigator.onLine){Qc=!0,Ya.value="syncing",Fi.value=null;try{const e=await Ov();if(e.length===0){Ya.value="success",wa.value=0;return}let t=0,o=0;for(const a of e){const s=await HR(a);if(s===!0)await Qh(a.id),t++;else if(s==="permanent_failure")await Qh(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await Xh(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await Xh(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}wa.value=await zr(),o>0?(Ya.value="error",Fi.value=`${o} action(s) failed to sync`):Ya.value="success"}catch(e){console.error("Sync error:",e),Ya.value="error",Fi.value="Failed to sync pending actions"}finally{Qc=!1}}}function VR(){df||(df=setInterval(async()=>{navigator.onLine&&(await Di(),Fs.value&&wa.value>0&&await Wr())},3e4))}function ud(){const e=F(()=>yl.value&&Fs.value);async function t(){wa.value=await zr()}async function o(){yl.value=!0,await Di()&&wa.value>0&&Zr()}function a(){yl.value=!1,Fs.value=!1,Ko&&(clearTimeout(Ko),Ko=null)}tn(async()=>{await Ws(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",ff),window.addEventListener("focus",pf),navigator.onLine&&await Di()&&wa.value>0&&Zr(),VR()}),yn(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",ff),window.removeEventListener("focus",pf),Ko&&(clearTimeout(Ko),Ko=null)});async function s(d,f){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await f();return await Ul(d,p),mr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function i(d){const f=await La(d);return f&&(mr.value=f.cachedAt),f}async function r(d){mr.value=await F_(d)}async function u(){return navigator.onLine?await Di()?(await Wr(),Ya.value==="success"):(Fi.value="Server is not responding",!1):(Fi.value="Cannot sync while offline",!1)}return{isOnline:yl,isServerHealthy:Fs,isFullyOnline:e,isCheckingStatus:Pu,pendingActionsCount:wa,lastSyncTime:mr,syncStatus:Ya,syncError:Fi,checkServerHealth:Di,quickConnectivityCheck:cd,syncPendingActions:Wr,updatePendingCount:t,refreshCache:s,getCachedData:i,loadLastSyncTime:r,forcSync:u}}const GR={class:"offline-indicator-container"},jR={class:"offline-icon"},ZR={key:0,viewBox:"0 0 24 24",fill:"currentColor"},WR={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},qR={class:"offline-text"},KR={key:0,class:"last-sync"},JR={class:"pending-text"},YR={key:0,class:"pending-subtext"},XR={key:1,class:"syncing-text"},QR={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:s,lastSyncTime:i,syncStatus:r,syncError:u,forcSync:d}=ud(),f=M(!1),p=M(""),g=M(""),y=F(()=>{if(!i.value)return"";const b=new Date(i.value),x=new Date-b,$=Math.floor(x/6e4),I=Math.floor($/60);return $<1?"just now":$<60?`${$}m ago`:I<24?`${I}h ago`:b.toLocaleDateString()}),k=async()=>{await d()};return Ze(r,b=>{b==="success"&&s.value===0?(p.value="All actions synced successfully!",g.value="success",f.value=!0,setTimeout(()=>{f.value=!1},3e3)):b==="error"&&(p.value=u.value||"Sync failed",g.value="error",f.value=!0,setTimeout(()=>{f.value=!1},5e3))}),(b,C)=>(v(),m("div",GR,[Ae(ys,{name:"slide"},{default:Ve(()=>[D(o)?E("",!0):(v(),m("div",{key:0,class:ve(["offline-banner",{checking:D(a)}])},[l("span",jR,[D(a)?(v(),m("svg",WR,[...C[1]||(C[1]=[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",ZR,[...C[0]||(C[0]=[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),l("span",qR,w(D(a)?"Checking connection...":D(t)?"Server unavailable":"You're offline"),1),D(i)&&!D(a)?(v(),m("span",KR," Last synced: "+w(y.value),1)):E("",!0)],2))]),_:1}),Ae(ys,{name:"fade"},{default:Ve(()=>[D(s)>0?(v(),m("div",{key:0,class:ve(["pending-banner",{"offline-pending":!D(o)}])},[C[2]||(C[2]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",JR,[Ye(w(D(s))+" pending action"+w(D(s)!==1?"s":"")+" ",1),D(o)?E("",!0):(v(),m("span",YR,"(will sync when online)"))]),D(o)&&D(r)!=="syncing"?(v(),m("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):D(r)==="syncing"?(v(),m("span",XR,"Syncing...")):E("",!0)],2)):E("",!0)]),_:1}),Ae(ys,{name:"fade"},{default:Ve(()=>[f.value?(v(),m("div",{key:0,class:ve(["sync-toast",g.value])},w(p.value),3)):E("",!0)]),_:1})]))}},eB=Ge(QR,[["__scopeId","data-v-9c1e58f4"]]),tB={class:"modal-content check-in-reminder-modal"},nB={class:"modal-header warning"},oB={class:"modal-body"},sB={class:"reminder-message"},aB={key:0},iB={class:"reminder-hint"},lB={class:"modal-footer"},rB={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=dt();return(o,a)=>(v(),qe(ys,{name:"modal"},{default:Ve(()=>[e.show&&e.checkpoint?(v(),m("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=it(s=>o.$emit("dismiss"),["self"]))},[l("div",tB,[l("div",nB,[a[4]||(a[4]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:a[0]||(a[0]=s=>o.$emit("dismiss"))},"")]),l("div",oB,[a[6]||(a[6]=l("div",{class:"reminder-icon"},"",-1)),l("p",sB,[Ye(" You have not checked in yet to "+w(D(t).checkpoint)+" ",1),l("strong",null,w(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),m("span",aB," - "+w(e.checkpoint.location.description),1)):E("",!0),a[5]||(a[5]=Ye(". ",-1))]),l("p",iB," Please check in when you arrive at your "+w(D(t).checkpoint)+". ",1)]),l("div",lB,[l("button",{onClick:a[1]||(a[1]=s=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:a[2]||(a[2]=s=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:et(e.accentButtonStyle)}," Go to "+w(D(t).checkpoint),5)])])])):E("",!0)]),_:1}))}},cB=Ge(rB,[["__scopeId","data-v-4761fdb9"]]),uB={class:"modal-content location-update-modal"},dB={class:"modal-header"},hB={class:"modal-body"},fB={key:0,class:"success-message"},pB={key:1},vB={class:"modal-description"},mB={key:0,class:"last-update-info"},gB={key:1,class:"gps-status active"},yB={class:"update-option"},kB=["disabled"],_B={class:"update-option auto-update-option"},bB={class:"checkbox-label"},wB=["checked"],CB={class:"option-hint"},LB={class:"update-option"},SB=["disabled"],xB={class:"update-option"},IB={class:"option-label"},$B={key:0,class:"checkpoint-list"},TB=["onClick","disabled"],MB={key:1,class:"no-checkpoints"},AB={key:2,class:"error"},EB={class:"modal-footer"},PB={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=dt(),o=a=>a?new Date(a).toLocaleString():"";return(a,s)=>(v(),qe(ys,{name:"modal"},{default:Ve(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:s[5]||(s[5]=it(i=>a.$emit("close"),["self"]))},[l("div",uB,[l("div",dB,[l("h3",null,"Update "+w(D(t).checkpoint)+" location",1),l("button",{class:"modal-close",onClick:s[0]||(s[0]=i=>a.$emit("close"))},"")]),l("div",hB,[e.success?(v(),m("div",fB,w(e.success),1)):(v(),m("div",pB,[l("p",vB,[s[6]||(s[6]=Ye(" Update the position of ",-1)),l("strong",null,w(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),m("div",mB," Last updated: "+w(o(e.assignment.location.lastLocationUpdate)),1)):E("",!0),e.userLocation?(v(),m("div",gB,[...s[7]||(s[7]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ye(" GPS active ",-1)])])):E("",!0),l("div",yB,[l("button",{onClick:s[1]||(s[1]=i=>a.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:et(e.accentButtonStyle)},[s[8]||(s[8]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ye(" "+w(e.updating?"Updating...":"Use current GPS location"),1)],12,kB)]),l("div",_B,[l("label",bB,[l("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:s[2]||(s[2]=i=>a.$emit("toggle-auto-update"))},null,40,wB),s[9]||(s[9]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",CB,"Automatically updates the "+w(D(t).checkpoint)+" location using your GPS every minute.",1)]),l("div",LB,[l("button",{onClick:s[3]||(s[3]=i=>a.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...s[10]||(s[10]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ye(" Select location on map ",-1)])],8,SB)]),l("div",xB,[l("label",IB,"Or copy location from another "+w(D(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),m("div",$B,[(v(!0),m(Ie,null,Fe(e.availableCheckpoints,i=>(v(),m("button",{key:i.id,onClick:r=>a.$emit("copy-from-checkpoint",i.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},w(i.name),9,TB))),128))])):(v(),m("p",MB," No other "+w(D(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),m("div",AB,w(e.error),1)):E("",!0)]))]),l("div",EB,[l("button",{onClick:s[4]||(s[4]=i=>a.$emit("close")),class:"btn btn-secondary"}," Cancel ")])])])):E("",!0)]),_:1}))}},DB=Ge(PB,[["__scopeId","data-v-93b6a4a2"]]),OB={class:"contact-info"},RB={class:"contact-name-row"},BB={key:0,class:"primary-badge"},NB={class:"contact-name"},FB={key:0,class:"contact-notes-text"},UB={key:1,class:"contact-detail"},zB={key:2,class:"contact-detail"},HB={class:"contact-actions"},VB=["href"],GB=["href"],jB=["href"],ZB={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],a=F(()=>t.role?o.some(i=>t.role.toLowerCase().includes(i.toLowerCase())):!1),s=F(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,i=>i.toUpperCase()).trim():"");return(i,r)=>(v(),m("div",{class:ve(["contact-item",{"primary-contact":e.isPrimary}])},[l("div",OB,[l("div",RB,[e.isPrimary?(v(),m("span",BB,"")):E("",!0),l("span",NB,w(e.name),1),e.role?(v(),m("span",{key:1,class:ve(["contact-role-badge",{"emergency-role":a.value}])},w(s.value),3)):E("",!0)]),e.notes?(v(),m("div",FB,w(e.notes),1)):E("",!0),e.phone?(v(),m("div",UB,w(e.phone),1)):E("",!0),e.email?(v(),m("div",zB,w(e.email),1)):E("",!0)]),l("div",HB,[e.phone?(v(),m("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...r[0]||(r[0]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ye(" Call ",-1)])],8,VB)):E("",!0),e.phone?(v(),m("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...r[1]||(r[1]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ye(" Text ",-1)])],8,GB)):E("",!0),e.email?(v(),m("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...r[2]||(r[2]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ye(" Email ",-1)])],8,jB)):E("",!0)])],2))}},om=Ge(ZB,[["__scopeId","data-v-6cf4fca2"]]),WB={key:0,class:"accordion-section"},qB={class:"accordion-title"},KB=["innerHTML"],JB={class:"accordion-icon"},YB={key:0,class:"accordion-content"},XB={key:0,class:"loading"},QB={key:1,class:"contact-list"},eN={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),m("div",WB,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",qB,[l("span",{class:"section-icon",innerHTML:D(Jn)("contacts")},null,8,KB),Ye(" Your "+w(e.contacts.length===1?"contact":"contacts")+w(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),l("span",JB,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",YB,[e.loading?(v(),m("div",XB,"Loading contacts...")):(v(),m("div",QB,[(v(!0),m(Ie,null,Fe(e.contacts,a=>(v(),qe(om,{key:a.contactId,name:a.name,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):E("",!0)])):E("",!0)}},tN=Ge(eN,[["__scopeId","data-v-246302be"]]),nN={key:0,class:"accordion-section"},oN={class:"accordion-title"},sN=["innerHTML"],aN={class:"accordion-icon"},iN={key:0,class:"accordion-content"},lN={key:0,class:"loading-state"},rN={key:1,class:"empty-state"},cN={key:2,class:"incidents-list"},uN={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),m("div",nN,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",oN,[l("span",{class:"section-icon",innerHTML:D(Jn)("incidents")},null,8,sN),Ye(" Your "+w(e.incidents.length===1?"incident":"incidents")+w(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),l("span",aN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",iN,[e.loading?(v(),m("div",lN," Loading incidents... ")):e.incidents.length===0?(v(),m("div",rN,[...o[1]||(o[1]=[l("p",null,"No incidents to show.",-1)])])):(v(),m("div",cN,[(v(!0),m(Ie,null,Fe(e.incidents,a=>(v(),qe(Yl,{key:a.incidentId,incident:a,onSelect:s=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):E("",!0)])):E("",!0)}},dN=Ge(uN,[["__scopeId","data-v-e84cbdf1"]]),hN={key:0,class:"accordion-section"},fN={class:"accordion-title"},pN=["innerHTML"],vN={class:"accordion-icon"},mN={key:0,class:"accordion-content"},gN={class:"event-details"},yN={key:0,class:"event-detail-row"},kN={class:"detail-value"},_N={key:1,class:"event-description"},bN={class:"detail-value"},wN={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),m("div",hN,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=s=>o.$emit("toggle"))},[l("span",fN,[l("span",{class:"section-icon",innerHTML:D(Jn)("event")},null,8,pN),a[1]||(a[1]=Ye(" Event details ",-1))]),l("span",vN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",mN,[l("div",gN,[e.eventDate?(v(),m("div",yN,[a[2]||(a[2]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",kN,w(t(e.eventDate)),1)])):E("",!0),e.description?(v(),m("div",_N,[a[3]||(a[3]=l("span",{class:"detail-label"},"Description",-1)),l("p",bN,w(e.description),1)])):E("",!0)])])):E("",!0)])):E("",!0)}},CN=Ge(wN,[["__scopeId","data-v-7c880ad1"]]),LN={class:"accordion-section"},SN={class:"accordion-title"},xN=["innerHTML"],IN={class:"accordion-icon"},$N={key:0,class:"accordion-content"},TN={key:0,class:"loading"},MN={key:1,class:"error"},AN={key:2,class:"empty-state"},EN={class:"checklist-section"},PN={key:0,class:"empty-state small"},DN={key:1,class:"my-jobs-list"},ON=["checked","disabled","onChange"],RN={key:0,class:"checklist-section"},BN={class:"checklist-section-title"},NN={key:0,class:"checklist-items"},FN={class:"item-checkbox"},UN=["checked","disabled","onChange"],zN={class:"item-content"},HN={key:0,class:"item-context"},VN={key:1,class:"completion-info"},GN={class:"completion-text"},jN={class:"completion-time"},ZN={key:1,class:"checklist-groups"},WN=["onClick"],qN={class:"group-title"},KN={class:"group-status"},JN={class:"group-count"},YN={class:"group-expand-icon"},XN={key:0,class:"checklist-group-items"},QN={class:"item-checkbox"},e9=["checked","disabled","onChange"],t9={class:"item-content"},n9={key:0,class:"completion-info"},o9={class:"completion-text"},s9={class:"completion-time"},a9={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=dt(),o=e,a=F(()=>o.visibleItems.length),s=i=>i?new Date(i).toLocaleString():"";return(i,r)=>(v(),m("div",LN,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[l("span",SN,[l("span",{class:"section-icon",innerHTML:D(Jn)("checklist")},null,8,xN),Ye(" Your "+w(D(t).checklists)+" ("+w(e.completedCount)+" of "+w(a.value)+" complete) ",1)]),l("span",IN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",$N,[e.loading?(v(),m("div",TN,"Loading checklist...")):e.error?(v(),m("div",MN,w(e.error),1)):a.value===0?(v(),m("div",AN,[l("p",null,"No "+w(D(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),m(Ie,{key:3},[l("div",EN,[r[3]||(r[3]=l("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),m("div",PN,[...r[2]||(r[2]=[l("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",DN,[(v(!0),m(Ie,null,Fe(e.myItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,ON),l("span",{class:ve(["my-job-text",{completed:u.isCompleted}])},w(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),m("div",RN,[l("h4",BN,"Your "+w(D(t).area)+"'s jobs",1),Ae(rd,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:r[1]||(r[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):E("",!0)],64)):(v(),m(Ie,{key:4},[e.effectiveGroupBy==="none"?(v(),m("div",NN,[(v(!0),m(Ie,null,Fe(e.visibleItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:ve(["checklist-item",{"item-completed":u.isCompleted}])},[l("div",FN,[l("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,UN)]),l("div",zN,[l("div",{class:ve(["item-text",{"text-completed":u.isCompleted}])},w(u.text),3),e.getContextName(u)?(v(),m("div",HN,w(e.getContextName(u)),1)):E("",!0),u.isCompleted?(v(),m("div",VN,[l("span",GN," Completed by "+w(u.completedByActorName||"Unknown"),1),l("span",jN,w(s(u.completedAt)),1)])):E("",!0)])],2))),128))])):(v(),m("div",ZN,[(v(!0),m(Ie,null,Fe(e.groupedItems,u=>(v(),m("div",{key:u.key,class:"checklist-group"},[l("button",{class:ve(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[l("span",qN,w(u.name),1),l("span",KN,[l("span",JN,w(u.completedCount)+"/"+w(u.items.length),1),l("span",YN,w(e.expandedGroup===u.key?"":"+"),1)])],10,WN),e.expandedGroup===u.key?(v(),m("div",XN,[(v(!0),m(Ie,null,Fe(u.items,d=>(v(),m("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:ve(["checklist-item",{"item-completed":d.isCompleted}])},[l("div",QN,[l("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:f=>i.$emit("toggle-item",d)},null,40,e9)]),l("div",t9,[l("div",{class:ve(["item-text",{"text-completed":d.isCompleted}])},w(d.text),3),d.isCompleted?(v(),m("div",n9,[l("span",o9,w(d.completedByActorName||"Unknown"),1),l("span",s9,w(s(d.completedAt)),1)])):E("",!0)])],2))),128))])):E("",!0)]))),128))]))],64))])):E("",!0)]))}},i9=Ge(a9,[["__scopeId","data-v-b2878e4f"]]),l9={class:"accordion-section"},r9={class:"accordion-title"},c9=["innerHTML"],u9={class:"accordion-icon"},d9={key:0,class:"accordion-content"},h9={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),m("div",l9,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[l("span",r9,[l("span",{class:"section-icon",innerHTML:D(Jn)("notes")},null,8,c9),Ye(" Your "+w(e.notes.length===1?"note":"notes")+w(e.notes.length>1?` (${e.notes.length})`:""),1)]),l("span",u9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",d9,[Ae(kc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):E("",!0)]))}},f9=Ge(h9,[["__scopeId","data-v-10b7523a"]]),p9={class:"accordion-section"},v9={class:"accordion-title"},m9=["innerHTML"],g9={key:0,class:"location-status active"},y9={key:1,class:"location-status"},k9={class:"accordion-icon"},_9={key:0,class:"accordion-content map-content"},b9={key:0,class:"map-selection-banner"},w9={class:"map-wrapper"},C9={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=dt(),a=ro("marshalBranding",{headerStyle:{},headerTextColor:""}),s=ii({headerStyle:F(()=>Ir(a.headerStyle)),headerTextColor:F(()=>Ir(a.headerTextColor))}),i=M(null);return t({mapRef:i,recenterOnLocation:(r,u,d)=>i.value?.recenterOnLocation?.(r,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.()}),(r,u)=>(v(),m("div",p9,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>r.$emit("toggle"))},[l("span",v9,[l("span",{class:"section-icon",innerHTML:D(Jn)("course")},null,8,m9),Ye(" "+w(D(o).course)+" ",1),e.userLocation?(v(),m("span",g9,"GPS Active")):(v(),m("span",y9,"GPS Inactive"))]),l("span",k9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",_9,[e.selectingLocation?(v(),m("div",b9,[l("span",null,[u[7]||(u[7]=Ye("Click on the map to set the new location for ",-1)),l("strong",null,w(e.selectingLocationName),1)]),l("button",{onClick:u[1]||(u[1]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):E("",!0),l("div",w9,[Ae(ri,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":D(o).course,"fullscreen-header-style":s.headerStyle,"fullscreen-header-text-color":s.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:ve({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>r.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>r.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>r.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>r.$emit("visibility-change",d))},gp({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ve(()=>[l("span",null,[u[8]||(u[8]=Ye("Click on the map to set the new location for ",-1)),l("strong",null,w(e.selectingLocationName),1)]),l("button",{onClick:u[2]||(u[2]=d=>r.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):E("",!0)]))}},L9=Ge(C9,[["__scopeId","data-v-97a9b1f4"]]),S9={class:"area-lead-content"},x9={key:0,class:"loading-state"},I9={key:1,class:"error-state"},$9={key:2,class:"empty-state"},T9={key:3,class:"checkpoint-accordion"},M9=["onClick"],A9={class:"checkpoint-header-content"},E9={class:"checkpoint-title-row"},P9={class:"checkpoint-name"},D9={key:0,class:"area-badge"},O9={key:0,class:"checkpoint-description-preview"},R9={class:"checkpoint-status-row"},B9={class:"status-badge marshals-status"},N9={key:0,class:"status-badge tasks-status"},F9={class:"accordion-icon"},U9={key:0,class:"checkpoint-accordion-content"},z9={class:"checkpoint-mini-map"},H9={class:"checkpoint-marshals-section"},V9={class:"marshals-label"},G9={key:0,class:"empty-state"},j9={key:1,class:"marshals-list"},Z9=["onClick"],W9={class:"marshal-header"},q9={class:"marshal-name-row"},K9={class:"marshal-name"},J9={key:0,class:"task-count"},Y9={class:"check-status-row"},X9=["onClick","disabled"],Q9={key:0,class:"check-in-time"},eF={key:0},tF={key:1,class:"last-access-time"},nF={key:0,class:"checkpoint-tasks-section"},oF={class:"marshals-label"},sF={class:"tasks-list"},aF=["disabled","onChange"],iF={class:"task-text"},lF=["disabled","onChange"],rF={class:"task-text"},cF={key:0,class:"marshal-details-modal"},uF={class:"details-section"},dF={class:"contact-info"},hF={key:0,class:"contact-row"},fF=["href"],pF={key:1,class:"contact-row"},vF=["href"],mF={key:2,class:"no-contact"},gF={class:"details-section"},yF={key:0,class:"checked-in-section"},kF={class:"checked-in-details"},_F={class:"check-time-detail"},bF={key:0,class:"check-method"},wF=["disabled"],CF={key:1,class:"not-checked-in-section"},LF=["disabled"],SF={key:2,class:"last-access-detail"},xF={class:"details-section"},IF={key:0,class:"no-tasks"},$F={key:1,class:"tasks-list modal-tasks"},TF=["disabled","onChange"],MF={class:"task-text"},AF={class:"details-section contact-actions-section"},EF={class:"contact-buttons"},PF=["href"],DF=["href"],OF=["href"],RF={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=dt(),{updatePendingCount:i}=ud(),r=e,u=o,d=M(!1),f=M(null),p=M([]),g=M([]),y=M(null),k=M(!1),b=M(null),C=F(()=>{const U=new Set(r.areaIds);return U.size===0?[...g.value].sort((Y,de)=>js(Y.name,de.name)):g.value.filter(Y=>(Y.areaIds||[]).some(ke=>U.has(ke))).sort((Y,de)=>js(Y.name,de.name))}),x=(U,Y=60)=>U?U.length<=Y?U:U.substring(0,Y).trim()+"...":"",$=M(!1),I=M(null),S=M(null),B=async()=>{if(!(!r.eventId||r.areaIds.length===0)){if(d.value=!0,f.value=null,Dn()){try{const U=await La(r.eventId);if(U?.areaLeadDashboard){p.value=U.areaLeadDashboard.areas||[],g.value=U.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(U){console.warn("Failed to load cached dashboard:",U)}f.value="Offline - no cached data available",d.value=!1;return}try{const U=await ba.getAreaLeadDashboard(r.eventId);p.value=U.data.areas||[],g.value=U.data.checkpoints||[];try{const Y=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await La(r.eventId)?await Lr(r.eventId,"areaLeadDashboard",Y):await Ul(r.eventId,{areaLeadDashboard:Y})}catch(Y){console.warn("Failed to cache dashboard:",Y)}}catch(U){console.error("Failed to load area lead dashboard:",U);try{const Y=await La(r.eventId);if(Y?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=Y.areaLeadDashboard.areas||[],g.value=Y.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Y){console.warn("Failed to load cached dashboard:",Y)}f.value=U.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},R=U=>{y.value=y.value===U?null:U},Z=U=>U.marshals.filter(Y=>Y.isCheckedIn).length,A=U=>{const Y=U.marshals.reduce((de,ke)=>de+ke.outstandingTaskCount,0);return U.outstandingTaskCount+Y},N=(U,Y)=>{I.value=U,S.value=Y,$.value=!0},O=()=>{$.value=!1,I.value=null,S.value=null},V=async(U,Y)=>{if(b.value)return;const de=U.assignmentId||U.id;if(!de){console.error("No assignment ID found for marshal:",U);return}b.value=U.marshalId;try{if(Dn())await ko("checkin_toggle",{eventId:r.eventId,assignmentId:de}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await Sa.toggleCheckIn(r.eventId,de),await B(),u("checkin-updated"),I.value?.marshalId===U.marshalId&&S.value){const ke=g.value.find(Re=>Re.checkpointId===S.value.checkpointId);if(ke){const Re=ke.marshals.find(Xe=>Xe.marshalId===U.marshalId);Re&&(I.value=Re)}}}catch(ke){console.error("Failed to check in marshal:",ke),(Dn()||!ke.response)&&(await ko("checkin_toggle",{eventId:r.eventId,assignmentId:de}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{b.value=null}},P=async(U,Y)=>{if(k.value)return;k.value=!0;const ke={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:r.marshalId,contextType:U.contextType,contextId:U.contextId};try{Dn()?(await ko("checklist_complete",{eventId:r.eventId,itemId:U.itemId,data:ke}),Y.outstandingTasks=Y.outstandingTasks.filter(Re=>Re.itemId!==U.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Nt.complete(r.eventId,U.itemId,ke),await B(),u("checklist-updated"))}catch(Re){console.error("Failed to complete task:",Re),(Dn()||!Re.response)&&(await ko("checklist_complete",{eventId:r.eventId,itemId:U.itemId,data:ke}),Y.outstandingTasks=Y.outstandingTasks.filter(Xe=>Xe.itemId!==U.itemId),Y.outstandingTaskCount=Math.max(0,Y.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},j=async(U,Y)=>{if(k.value)return;k.value=!0;const ke={marshalId:Y.marshals.length>0?Y.marshals[0].marshalId:r.marshalId,contextType:U.contextType,contextId:U.contextId,actorMarshalId:r.marshalId};try{Dn()?(await ko("checklist_uncomplete",{eventId:r.eventId,itemId:U.itemId,data:ke}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(Re=>Re.itemId!==U.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(U),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Nt.uncomplete(r.eventId,U.itemId,ke),await B(),u("checklist-updated"))}catch(Re){console.error("Failed to uncomplete task:",Re),(Dn()||!Re.response)&&(await ko("checklist_uncomplete",{eventId:r.eventId,itemId:U.itemId,data:ke}),Y.completedTasks&&(Y.completedTasks=Y.completedTasks.filter(Xe=>Xe.itemId!==U.itemId)),Y.outstandingTasks||(Y.outstandingTasks=[]),Y.outstandingTasks.push(U),Y.outstandingTaskCount=(Y.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{k.value=!1}},Q=async U=>{if(k.value||!I.value)return;k.value=!0;const Y={marshalId:I.value.marshalId,contextType:U.contextType,contextId:U.contextId};try{if(Dn())await ko("checklist_complete",{eventId:r.eventId,itemId:U.itemId,data:Y}),I.value.outstandingTasks=I.value.outstandingTasks.filter(de=>de.itemId!==U.itemId),I.value.outstandingTaskCount=Math.max(0,I.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Nt.complete(r.eventId,U.itemId,Y),await B(),I.value&&S.value){const de=g.value.find(ke=>ke.checkpointId===S.value.checkpointId);if(de){const ke=de.marshals.find(Re=>Re.marshalId===I.value.marshalId);ke&&(I.value=ke)}}u("checklist-updated")}}catch(de){console.error("Failed to complete task:",de),(Dn()||!de.response)&&(await ko("checklist_complete",{eventId:r.eventId,itemId:U.itemId,data:Y}),I.value.outstandingTasks=I.value.outstandingTasks.filter(ke=>ke.itemId!==U.itemId),I.value.outstandingTaskCount=Math.max(0,I.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},ae=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",pe=U=>U?new Date(U).toLocaleString():"",ne=U=>{if(!U)return"";const Y=new Date(U),ke=new Date-Y,Re=Math.floor(ke/6e4),Xe=Math.floor(Re/60),Ne=Math.floor(Xe/24);return Re<1?"just now":Re<60?`${Re}m ago`:Xe<24?`${Xe}h ago`:Ne===1?"yesterday":Ne<7?`${Ne}d ago`:Y.toLocaleDateString()},oe=U=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[U]||U;return t({areas:p,checkpoints:g,loading:d,loadDashboard:B}),Ze(()=>r.eventId,()=>{B()},{immediate:!0}),(U,Y)=>(v(),m("div",S9,[d.value?(v(),m("div",x9," Loading dashboard... ")):f.value?(v(),m("div",I9,[l("p",null,w(f.value),1),l("button",{onClick:B,class:"btn btn-secondary"},"Retry")])):C.value.length===0?(v(),m("div",$9,[l("p",null,"No "+w(D(s).checkpoints)+" in your "+w(D(s).areas)+".",1)])):(v(),m("div",T9,[(v(!0),m(Ie,null,Fe(C.value,de=>(v(),m("div",{key:de.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:ve(["checkpoint-accordion-header",{active:y.value===de.checkpointId}]),onClick:ke=>R(de.checkpointId)},[l("div",A9,[l("div",E9,[l("span",P9,w(de.name),1),de.areaName?(v(),m("span",D9,w(de.areaName),1)):E("",!0)]),de.description?(v(),m("div",O9,w(x(de.description)),1)):E("",!0),l("div",R9,[l("span",B9,w(Z(de))+" / "+w(de.marshals.length)+" checked in ",1),A(de)>0?(v(),m("span",N9,w(A(de))+" tasks ",1)):E("",!0)])]),l("span",F9,w(y.value===de.checkpointId?"":"+"),1)],10,M9),y.value===de.checkpointId?(v(),m("div",U9,[l("div",z9,[Ae(ri,{locations:[{id:de.checkpointId,name:de.name,description:de.description,latitude:de.latitude,longitude:de.longitude}],route:e.route,center:{lat:de.latitude,lng:de.longitude},zoom:16,"highlight-location-id":de.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),l("div",H9,[l("div",V9,w(D(a).people)+" ("+w(de.marshals.length)+")",1),de.marshals.length===0?(v(),m("div",G9," No "+w(D(s).people)+" assigned to this "+w(D(s).checkpoint)+". ",1)):(v(),m("div",j9,[(v(!0),m(Ie,null,Fe(de.marshals,ke=>(v(),m("div",{key:ke.marshalId,class:ve(["marshal-card",{"is-checked-in":ke.isCheckedIn}]),onClick:Re=>N(ke,de)},[l("div",W9,[l("div",q9,[l("span",K9,w(ke.name),1),ke.outstandingTaskCount>0?(v(),m("span",J9,w(ke.outstandingTaskCount)+" tasks ",1)):E("",!0)]),l("div",Y9,[l("div",{class:ve(["check-status",{"checked-in":ke.isCheckedIn}])},w(ke.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:it(Re=>V(ke),["stop"]),class:ve(["quick-checkin-btn",{"undo-btn":ke.isCheckedIn}]),disabled:b.value===ke.marshalId},w(b.value===ke.marshalId?"...":ke.isCheckedIn?"Undo":"Check In"),11,X9)])]),ke.isCheckedIn&&ke.checkInTime?(v(),m("div",Q9,[Ye(w(ae(ke.checkInTime))+" ",1),ke.checkInMethod?(v(),m("span",eF," ("+w(oe(ke.checkInMethod))+")",1)):E("",!0)])):E("",!0),ke.lastAccessedAt?(v(),m("div",tF," Last active: "+w(ne(ke.lastAccessedAt)),1)):E("",!0)],10,Z9))),128))]))]),de.outstandingTaskCount>0||de.completedTasks&&de.completedTasks.length>0?(v(),m("div",nF,[l("div",oF,w(D(a).checkpoint)+" tasks",1),l("div",sF,[(v(!0),m(Ie,null,Fe(de.outstandingTasks,ke=>(v(),m("div",{key:ke.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:k.value,onChange:Re=>P(ke,de)},null,40,aF),l("span",iF,w(ke.text),1)]))),128)),(v(!0),m(Ie,null,Fe(de.completedTasks||[],ke=>(v(),m("div",{key:`completed-${ke.itemId}`,class:"task-item task-completed"},[l("input",{type:"checkbox",checked:"",disabled:k.value,onChange:Re=>j(ke,de)},null,40,lF),l("span",rF,w(ke.text),1)]))),128))])])):E("",!0)])):E("",!0)]))),128))])),Ae(jt,{show:$.value,title:I.value?.name||"Marshal Details",size:"large",onClose:O},{actions:Ve(()=>[l("button",{onClick:O,class:"btn btn-secondary"},"Close")]),default:Ve(()=>[I.value?(v(),m("div",cF,[l("div",uF,[Y[4]||(Y[4]=l("h4",null,"Contact Details",-1)),l("div",dF,[I.value.email?(v(),m("div",hF,[Y[2]||(Y[2]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${I.value.email}`},w(I.value.email),9,fF)])):E("",!0),I.value.phoneNumber?(v(),m("div",pF,[Y[3]||(Y[3]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${I.value.phoneNumber}`},w(I.value.phoneNumber),9,vF)])):E("",!0),!I.value.email&&!I.value.phoneNumber?(v(),m("div",mF," No contact details available. ")):E("",!0)])]),l("div",gF,[Y[8]||(Y[8]=l("h4",null,"Check-in Status",-1)),I.value.isCheckedIn?(v(),m("div",yF,[l("div",kF,[Y[6]||(Y[6]=l("span",{class:"check-icon"},"",-1)),l("div",null,[Y[5]||(Y[5]=l("strong",null,"Checked In",-1)),l("p",_F,w(pe(I.value.checkInTime)),1),I.value.checkInMethod?(v(),m("p",bF," Method: "+w(oe(I.value.checkInMethod)),1)):E("",!0)])]),l("button",{onClick:Y[0]||(Y[0]=de=>V(I.value,S.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===I.value.marshalId},w(b.value===I.value.marshalId?"Undoing...":"Undo Check-in"),9,wF)])):(v(),m("div",CF,[Y[7]||(Y[7]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:Y[1]||(Y[1]=de=>V(I.value,S.value)),class:"btn btn-primary check-in-btn",disabled:b.value===I.value.marshalId},w(b.value===I.value.marshalId?"Checking in...":"Check In"),9,LF)])),I.value.lastAccessedAt?(v(),m("div",SF," Last active: "+w(ne(I.value.lastAccessedAt)),1)):E("",!0)]),l("div",xF,[l("h4",null,w(D(a).checklists)+" ("+w(I.value.outstandingTasks?.length||0)+" outstanding)",1),!I.value.outstandingTasks||I.value.outstandingTasks.length===0?(v(),m("div",IF," No outstanding tasks. ")):(v(),m("div",$F,[(v(!0),m(Ie,null,Fe(I.value.outstandingTasks,de=>(v(),m("div",{key:de.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:k.value,onChange:ke=>Q(de)},null,40,TF),l("span",MF,w(de.text),1)]))),128))]))]),l("div",AF,[l("div",EF,[I.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${I.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,PF)):E("",!0),I.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${I.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,DF)):E("",!0),I.value.email?(v(),m("a",{key:2,href:`mailto:${I.value.email}`,class:"btn btn-secondary"}," Email ",8,OF)):E("",!0)])])])):E("",!0)]),_:1},8,["show","title"])]))}},BF=Ge(RF,[["__scopeId","data-v-067e0528"]]),NF={key:0,class:"accordion-section"},FF={class:"accordion-title"},UF=["innerHTML"],zF={class:"accordion-icon"},HF={key:0,class:"accordion-content area-lead-accordion-content"},VF={key:0,class:"area-filter-pills"},GF=["onClick"],jF={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=dt(),a=M(null);return t({areaLeadRef:a}),(s,i)=>e.isAreaLead?(v(),m("div",NF,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",FF,[l("span",{class:"section-icon",innerHTML:D(Jn)("area")},null,8,UF),Ye(" Your "+w(e.areas.length===1?D(o).area:D(o).areas)+w(e.areas.length>1?` (${e.areas.length})`:""),1)]),l("span",zF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",HF,[e.areas.length>1?(v(),m("div",VF,[(v(!0),m(Ie,null,Fe(e.areas,r=>(v(),m("button",{key:r.areaId,class:ve(["area-filter-pill",{selected:e.selectedFilters.has(r.areaId)}]),style:et(e.selectedFilters.has(r.areaId)?{backgroundColor:r.color||"#667eea",borderColor:r.color||"#667eea"}:{}),onClick:u=>s.$emit("toggle-filter",r.areaId)},w(r.name),15,GF))),128))])):E("",!0),Ae(BF,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=r=>s.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):E("",!0)])):E("",!0)}},ZF=Ge(jF,[["__scopeId","data-v-9278e6a8"]]),WF={key:0,class:"accordion-section"},qF={class:"accordion-title"},KF=["innerHTML"],JF={class:"accordion-icon"},YF={key:0,class:"accordion-content area-lead-marshals-content"},XF={class:"area-lead-marshals-list"},QF=["onClick"],e7={class:"marshal-header-info"},t7={class:"marshal-name-row"},n7={class:"marshal-name"},o7={class:"marshal-meta"},s7={class:"marshal-checkpoint"},a7={key:0,class:"marshal-task-count"},i7={class:"accordion-icon"},l7={key:0,class:"area-lead-marshal-content"},r7={class:"marshal-checkin-section"},c7={key:0,class:"marshal-contact-section"},u7=["href"],d7=["href"],h7={key:1,class:"marshal-tasks-section"},f7={class:"tasks-label"},p7={class:"tasks-list"},v7=["checked","disabled","onChange"],m7={class:"task-text"},g7={key:2,class:"no-tasks-message"},y7={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=dt(),a=s=>!s||s.length===0?"":s.length===1?s[0].name:s.map(i=>i.name).join(", ");return(s,i)=>e.isAreaLead&&e.marshals.length>0?(v(),m("div",WF,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=r=>s.$emit("toggle"))},[l("span",qF,[l("span",{class:"section-icon",innerHTML:D(Jn)("marshal")},null,8,KF),Ye(" Your "+w(e.marshals.length===1?D(o).person:D(o).people)+w(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),l("span",JF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",YF,[l("div",XF,[(v(!0),m(Ie,null,Fe(e.marshals,r=>(v(),m("div",{key:r.marshalId,class:"area-lead-marshal-item"},[l("button",{class:ve(["area-lead-marshal-header",{active:e.expandedMarshalId===r.marshalId,"is-checked-in":r.isCheckedIn}]),onClick:u=>s.$emit("toggle-marshal",r.marshalId)},[l("div",e7,[l("div",t7,[l("span",n7,w(r.name),1),l("span",{class:ve(["check-status-badge",{"checked-in":r.isCheckedIn}])},w(r.isCheckedIn?"":""),3)]),l("div",o7,[l("span",s7,w(a(r.checkpoints)),1),r.totalTaskCount>0?(v(),m("span",a7,w(r.completedTaskCount)+" / "+w(r.totalTaskCount)+" "+w(D(o).checklists)+" complete ",1)):E("",!0)])]),l("span",i7,w(e.expandedMarshalId===r.marshalId?"":"+"),1)],10,QF),e.expandedMarshalId===r.marshalId?(v(),m("div",l7,[l("div",r7,[Ae(jr,{"is-checked-in":r.isCheckedIn,"check-in-time":r.checkInTime,"check-in-method":r.checkInMethod,"checked-in-by":r.checkedInBy,"marshal-name":r.marshalName,"is-loading":e.checkingInMarshalId===r.id,onToggle:u=>s.$emit("check-in",r)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),r.email||r.phoneNumber?(v(),m("div",c7,[r.phoneNumber?(v(),m("a",{key:0,href:`tel:${r.phoneNumber}`,class:"contact-link"},w(r.phoneNumber),9,u7)):E("",!0),r.email?(v(),m("a",{key:1,href:`mailto:${r.email}`,class:"contact-link"},w(r.email),9,d7)):E("",!0)])):E("",!0),r.allTasks.length>0?(v(),m("div",h7,[l("div",f7,w(D(t).checklists),1),l("div",p7,[(v(!0),m(Ie,null,Fe(r.allTasks,u=>(v(),m("div",{key:`${u.itemId}-${u.contextId}`,class:ve(["task-item",{"task-completed":u.isCompleted}])},[l("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>s.$emit("toggle-task",u,r)},null,40,v7),l("span",m7,w(u.text),1)],2))),128))])])):(v(),m("div",g7," No "+w(D(o).checklists)+" assigned. ",1))])):E("",!0)]))),128))])])):E("",!0)])):E("",!0)}},k7=Ge(y7,[["__scopeId","data-v-49a1421b"]]),_7={class:"checkpoint-note-header"},b7={key:0,class:"pin-icon",title:"Pinned"},w7={class:"checkpoint-note-title"},C7={key:0,class:"checkpoint-note-content"},L7={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=F(()=>(t.priority||"Normal").toLowerCase());return(a,s)=>(v(),m("div",{class:ve(["checkpoint-note-item",o.value])},[l("div",_7,[e.isPinned?(v(),m("span",b7,"")):E("",!0),l("span",{class:ve(["priority-indicator",o.value])},null,2),l("strong",w7,w(e.title),1),l("span",{class:ve(["priority-badge",o.value])},w(e.priority),3)]),e.content?(v(),m("div",C7,w(e.content),1)):E("",!0)],2))}},S7=Ge(L7,[["__scopeId","data-v-5f2df920"]]),x7={class:"checkpoint-accordion-section"},I7={class:"checkpoint-header-content"},$7={class:"checkpoint-title-row"},T7=["innerHTML"],M7={key:0,class:"checkpoint-check-icon"},A7={class:"checkpoint-name"},E7={key:1,class:"area-badge"},P7={key:2,class:"checkpoint-time-badge"},D7={key:3,class:"checkpoint-distance-badge"},O7={key:0,class:"checkpoint-description-preview"},R7={class:"accordion-icon"},B7={key:0,class:"checkpoint-accordion-content"},N7={key:0,class:"checkpoint-mini-map"},F7={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},U7={class:"my-checkin-section"},z7={key:0,class:"check-in-error"},H7={class:"checkpoint-marshals"},V7={class:"marshals-label"},G7={key:0,class:"marshals-list"},j7={key:0,class:"check-badge"},Z7={key:1,class:"marshals-list-expanded"},W7=["onClick"],q7={class:"marshal-name-text"},K7={class:"marshal-status-icons"},J7={key:0,class:"check-badge"},Y7={class:"expand-icon"},X7={key:0,class:"marshal-details-panel"},Q7={class:"detail-row"},eU={key:0,class:"detail-row"},tU={key:1,class:"detail-row"},nU={key:2,class:"detail-row"},oU=["href"],sU={key:3,class:"detail-row"},aU=["href"],iU={key:4,class:"contact-buttons-mini"},lU=["href"],rU=["href"],cU=["href"],uU={key:5,class:"checkpoint-marshal-checkin"},dU={key:1,class:"checkpoint-area-contacts"},hU={class:"marshals-label"},fU={class:"contact-list"},pU={key:2,class:"checkpoint-notes"},vU={class:"checkpoint-notes-list"},mU={key:3,class:"dynamic-location-section"},gU={class:"dynamic-location-header"},yU={class:"dynamic-badge"},kU={key:0,class:"last-update"},_U={class:"dynamic-location-actions"},bU=["disabled"],wU=["title"],CU={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=dt(),s=ro("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ii({headerStyle:F(()=>Ir(s.headerStyle)),headerTextColor:F(()=>Ir(s.headerTextColor))}),r=e,u=M(null),d=F(()=>r.assignment.location?.isDynamic),f=F(()=>{if(!r.userLocation?.lat||!r.userLocation?.lng)return null;const x=r.assignment.location;return!x?.latitude||!x?.longitude?null:li(r.userLocation.lat,r.userLocation.lng,x.latitude,x.longitude)}),p=F(()=>{const x=f.value;return x==null?null:x<1e3?`${Math.round(x/10)*10} m`:`${(Math.round(x/100)/10).toFixed(1)} km`});t({mapRef:u});const g=x=>{const $=x?.iconType||"checkpoint",I=x?.iconColor||"#667eea",S={checkpoint:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return S[$]||S.checkpoint},y=(x,$)=>{const I=S=>S?new Date(S).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return x&&$?`${I(x)} - ${I($)}`:x?`from ${I(x)}`:$?`until ${I($)}`:""},k=x=>x?new Date(x).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",b=x=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[x]||x,C=x=>x?new Date(x).toLocaleString():"";return(x,$)=>(v(),m("div",x7,[l("button",{class:ve(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:$[0]||($[0]=I=>x.$emit("toggle"))},[l("div",I7,[l("div",$7,[l("span",{class:"checkpoint-icon",innerHTML:g(e.assignment.location)},null,8,T7),e.assignment.effectiveIsCheckedIn?(v(),m("span",M7,"")):E("",!0),l("span",A7,w(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),m("span",E7,w(e.assignment.areaName),1)):E("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),m("span",P7,w(y(e.assignment.location.startTime,e.assignment.location.endTime)),1)):E("",!0),p.value?(v(),m("span",D7,w(p.value),1)):E("",!0)]),e.assignment.location?.description?(v(),m("div",O7,w(e.assignment.location.description),1)):E("",!0)]),l("span",R7,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",B7,[e.assignment.location?(v(),m("div",N7,[Ae(ri,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:$[2]||($[2]=I=>x.$emit("map-click",I)),onLocationClick:$[3]||($[3]=I=>x.$emit("location-click",I)),onActionClick:$[4]||($[4]=I=>x.$emit("action-click",I)),onVisibilityChange:$[5]||($[5]=I=>x.$emit("visibility-change",I))},gp({_:2},[e.assignment.location?.isDynamic?{name:"fullscreen-footer",fn:Ve(()=>[l("button",{class:"btn btn-primary",onClick:$[1]||($[1]=I=>x.$emit("update-location"))},[(v(),m("svg",F7,[...$[9]||($[9]=[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),$[10]||($[10]=Ye(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):E("",!0),l("div",U7,[Ae(jr,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:$[6]||($[6]=I=>x.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),m("div",z7,w(e.checkInError),1)):E("",!0)]),l("div",H7,[l("div",V7,w(D(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),m("div",Z7,[(v(!0),m(Ie,null,Fe(e.assignment.allMarshals,I=>(v(),m("div",{key:I.marshalId,class:ve(["marshal-card-mini",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn,expanded:e.expandedMarshalId===I.marshalId}])},[l("button",{class:"marshal-card-header",onClick:S=>x.$emit("toggle-marshal",I.marshalId)},[l("span",q7,w(I.marshalName)+w(I.marshalId===e.currentMarshalId?" (you)":""),1),l("span",K7,[I.effectiveIsCheckedIn?(v(),m("span",J7,"")):E("",!0),l("span",Y7,w(e.expandedMarshalId===I.marshalId?"":"+"),1)])],8,W7),e.expandedMarshalId===I.marshalId?(v(),m("div",X7,[l("div",Q7,[$[11]||($[11]=l("span",{class:"detail-label"},"Status:",-1)),l("span",{class:ve(I.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},w(I.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),I.effectiveIsCheckedIn&&I.checkInTime?(v(),m("div",eU,[$[12]||($[12]=l("span",{class:"detail-label"},"Check-in time:",-1)),l("span",null,w(k(I.checkInTime)),1)])):E("",!0),I.checkInMethod?(v(),m("div",tU,[$[13]||($[13]=l("span",{class:"detail-label"},"Method:",-1)),l("span",null,w(b(I.checkInMethod)),1)])):E("",!0),I.email?(v(),m("div",nU,[$[14]||($[14]=l("span",{class:"detail-label"},"Email:",-1)),l("a",{href:"mailto:"+I.email},w(I.email),9,oU)])):E("",!0),I.phoneNumber?(v(),m("div",sU,[$[15]||($[15]=l("span",{class:"detail-label"},"Phone:",-1)),l("a",{href:"tel:"+I.phoneNumber},w(I.phoneNumber),9,aU)])):E("",!0),I.email||I.phoneNumber?(v(),m("div",iU,[I.phoneNumber?(v(),m("a",{key:0,href:"tel:"+I.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,lU)):E("",!0),I.phoneNumber?(v(),m("a",{key:1,href:"sms:"+I.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,rU)):E("",!0),I.email?(v(),m("a",{key:2,href:"mailto:"+I.email,class:"btn btn-sm btn-secondary"},"Email",8,cU)):E("",!0)])):E("",!0),I.marshalId!==e.currentMarshalId?(v(),m("div",uU,[Ae(jr,{"is-checked-in":I.effectiveIsCheckedIn,"check-in-time":I.checkInTime,"check-in-method":I.checkInMethod,"checked-in-by":I.checkedInBy,"marshal-name":I.marshalName,"is-loading":e.checkingInMarshalId===I.id,onToggle:S=>x.$emit("marshal-check-in",I)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):E("",!0)])):E("",!0)],2))),128))])):(v(),m("div",G7,[(v(!0),m(Ie,null,Fe(e.assignment.allMarshals,I=>(v(),m("span",{key:I.marshalId,class:ve(["marshal-tag",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn}])},[Ye(w(I.marshalName)+w(I.marshalId===e.currentMarshalId?" (you)":"")+" ",1),I.effectiveIsCheckedIn?(v(),m("span",j7,"")):E("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),m("div",dU,[l("div",hU,w(D(o).area)+" contacts:",1),l("div",fU,[(v(!0),m(Ie,null,Fe(e.assignment.areaContacts,I=>(v(),qe(om,{key:I.marshalId,name:I.marshalName,role:I.role,phone:I.phone,email:I.email},null,8,["name","role","phone","email"]))),128))])])):E("",!0),e.notes.length>0?(v(),m("div",pU,[$[16]||($[16]=l("div",{class:"marshals-label"},"Notes:",-1)),l("div",vU,[(v(!0),m(Ie,null,Fe(e.notes,I=>(v(),qe(S7,{key:I.noteId,title:I.title,content:I.content,priority:I.priority,"is-pinned":I.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):E("",!0),d.value?(v(),m("div",mU,[l("div",gU,[l("span",yU,"Dynamic "+w(e.assignment.location.resolvedCheckpointTerm||D(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),m("span",kU," Last updated: "+w(C(e.assignment.location.lastLocationUpdate)),1)):E("",!0)]),l("div",_U,[l("button",{onClick:$[7]||($[7]=I=>x.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...$[17]||($[17]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ye(" Update location ",-1)])],8,bU),l("button",{onClick:$[8]||($[8]=I=>x.$emit("toggle-auto-update")),class:ve(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[$[18]||($[18]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ye(" "+w(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,wU)])])):E("",!0)])):E("",!0)]))}},LU=Ge(CU,[["__scopeId","data-v-d668da0f"]]),SU={class:"accordion-section"},xU={class:"accordion-title"},IU=["innerHTML"],$U={class:"accordion-icon"},TU={key:0,class:"accordion-content assignments-accordion-content"},MU={key:0,class:"empty-state"},AU={key:1,class:"checkpoint-accordion"},EU={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=dt(),a={},s=(i,r)=>{r?a[i]=r:delete a[i]};return t({checkpointRefs:a}),(i,r)=>(v(),m("div",SU,[l("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:r[0]||(r[0]=u=>i.$emit("toggle"))},[l("span",xU,[l("span",{class:"section-icon",innerHTML:D(Jn)("checkpoint")},null,8,IU),Ye(" Your "+w(e.assignments.length===1?D(o).checkpoint:D(o).checkpoints)+w(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),l("span",$U,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",TU,[e.assignments.length===0?(v(),m("div",MU,[l("p",null,"You don't have any "+w(D(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",AU,[(v(!0),m(Ie,null,Fe(e.assignments,u=>(v(),qe(LU,{key:u.id,ref_for:!0,ref:d=>s(u.id,d),assignment:u,"is-expanded":e.expandedCheckpointId===u.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(u.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===u.id,"check-in-error":e.checkingInAssignmentId===u.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(u.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(u.locationId,u.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,onToggle:d=>i.$emit("toggle-checkpoint",u.id),onMapClick:r[1]||(r[1]=d=>i.$emit("map-click",d)),onLocationClick:r[2]||(r[2]=d=>i.$emit("location-click",d)),onActionClick:d=>i.$emit("action-click",u,d),onVisibilityChange:d=>i.$emit("visibility-change",u.id,d),onUpdateLocation:d=>i.$emit("update-location",u),onCheckIn:d=>i.$emit("check-in",u),onToggleMarshal:r[3]||(r[3]=d=>i.$emit("toggle-marshal",d)),onMarshalCheckIn:d=>i.$emit("marshal-check-in",d,u.locationId),onToggleAutoUpdate:d=>i.$emit("toggle-auto-update",u)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):E("",!0)]))}},PU=Ge(EU,[["__scopeId","data-v-d18e3955"]]);function DU(e){const t=F(()=>{const f=e.value?.brandingPageGradientStart||cn.pageGradientStart,p=e.value?.brandingPageGradientEnd||cn.pageGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),o=F(()=>{const f=e.value?.brandingHeaderGradientStart||cn.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||cn.headerGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),a=F(()=>{const f=e.value?.brandingHeaderGradientStart||cn.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||cn.headerGradientEnd;return Yv(f,p)}),s=F(()=>e.value?.brandingAccentColor||cn.accentColor),i=F(()=>Eu(s.value)),r=F(()=>({background:s.value,color:i.value})),u=F(()=>{const f=e.value?.brandingLogoUrl||"";return f?f.startsWith("/api")?ka+f.substring(4):f:""}),d=F(()=>e.value?.brandingLogoPosition||"left");return{pageBackgroundStyle:t,headerStyle:o,headerTextColor:a,accentColor:s,accentTextColor:i,accentButtonStyle:r,brandingLogoUrl:u,brandingLogoPosition:d}}function OU(){const e=M(null),t=M(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return yn(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:s}}function RU({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:s,isAreaLead:i,allLocations:r,areas:u,terms:d,termsLower:f,areaLeadRef:p,areaLeadCheckpoints:g,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:b}){const C=M([]),x=M(!1),$=M(null),I=M(!1),S=M("person"),B=M(null),R=F(()=>C.value.filter(U=>U.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(U.matchedScope)?U.completedByActorId===t.value:!0)),Z=F(()=>R.value.filter(U=>U.isCompleted).length),A=F(()=>{const U=a.value.map(Y=>Y.locationId);return R.value.filter(Y=>Y.completionContextType==="Personal"?Y.contextOwnerMarshalId===t.value:Y.completionContextType==="Checkpoint"?U.includes(Y.completionContextId):Y.completionContextType==="Area"?s.value.includes(Y.completionContextId):!0)}),N=F(()=>{if(!i.value)return[];const U=a.value.map(Y=>Y.locationId);return R.value.filter(Y=>Y.completionContextType==="Personal"?Y.contextOwnerMarshalId!==t.value:Y.completionContextType==="Checkpoint"?!U.includes(Y.completionContextId):Y.completionContextType==="Area"?!s.value.includes(Y.completionContextId):!1)}),O=F(()=>A.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),V=F(()=>N.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),P=F(()=>{const U=p.value?.checkpoints||g.value||[];if(U.length===0)return[];const Y=[],de=new Set;for(const ke of U)for(const Re of ke.marshals||[])de.has(Re.marshalId)||(de.add(Re.marshalId),Y.push(Re));return Y}),j=F(()=>{if(i.value)return"none";const U=R.value,Y=new Set;for(const de of U)de.completionContextType==="Checkpoint"&&de.completionContextId&&Y.add(de.completionContextId);return Y.size>1?"checkpoint":"none"}),Q=F(()=>{const U=R.value,Y={};for(const de of U){let ke,Re;de.completionContextType==="Checkpoint"&&de.completionContextId?(ke=`checkpoint_${de.completionContextId}`,Re=r.value.find(Ne=>Ne.id===de.completionContextId)?.name||"Unknown "+d.value.checkpoint):de.completionContextType==="Area"&&de.completionContextId?(ke=`area_${de.completionContextId}`,Re=u.value.find(Ne=>Ne.id===de.completionContextId)?.name||"Unknown "+d.value.area):(ke="personal",Re="Personal"),Y[ke]||(Y[ke]={key:ke,name:Re,items:[],completedCount:0}),Y[ke].items.push(de),de.isCompleted&&Y[ke].completedCount++}return Object.values(Y).sort((de,ke)=>de.name.localeCompare(ke.name,void 0,{numeric:!0,sensitivity:"base"}))}),ae=U=>{B.value=B.value===U?null:U},pe=U=>{if(!U.completionContextType||!U.completionContextId)return null;if(U.completionContextType==="Checkpoint"){const Y=r.value.find(ke=>ke.id===U.completionContextId);if(!Y)return null;const de=Y.description?` - ${Y.description}`:"";return`At ${f.value.checkpoint} ${Y.name}${de}`}if(U.completionContextType==="Area"){const Y=u.value.find(de=>de.id===U.completionContextId);return Y?`At ${f.value.area} ${Y.name}`:null}return U.completionContextType==="Personal"?"Personal item":null},ne=async(U=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}U||(x.value=!0),$.value=null;try{const Y=e.value;console.log("Fetching checklist for marshal:",t.value);let ke=(await Nt.getMarshalChecklist(Y,t.value)).data||[];if(i.value&&s.value.length>0){console.log("Fetching area checklists for areas:",s.value);const Re=s.value.map(ze=>Nt.getAreaChecklist(Y,ze).catch(We=>(console.warn(`Failed to fetch checklist for area ${ze}:`,We),{data:[]}))),Xe=await Promise.all(Re),Ne=new Map;for(const ze of ke){const We=`${ze.itemId}_${ze.completionContextType}_${ze.completionContextId}`;Ne.set(We,ze)}for(const ze of Xe)for(const We of ze.data||[]){const ee=`${We.itemId}_${We.completionContextType}_${We.completionContextId}`;Ne.has(ee)||Ne.set(ee,We)}ke=Array.from(Ne.values()),console.log("Merged checklist items:",ke.length)}C.value=ke,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",C.value.length,"items")}catch(Y){console.error("Failed to load checklist:",Y.response?.status,Y.response?.data),$.value=Y.response?.data?.message||"Failed to load checklist"}finally{U||(x.value=!1)}};return{checklistItems:C,checklistLoading:x,checklistError:$,savingChecklist:I,checklistGroupBy:S,expandedChecklistGroup:B,visibleChecklistItems:R,completedChecklistCount:Z,myChecklistItems:A,areaChecklistItems:N,myChecklistItemsWithLocalState:O,areaChecklistItemsWithLocalState:V,areaMarshalsForChecklist:P,effectiveChecklistGroupBy:j,groupedChecklistItems:Q,loadChecklist:ne,handleToggleChecklist:async U=>{if(I.value)return;I.value=!0;const Y=e.value,de={marshalId:U.contextOwnerMarshalId||t.value,contextType:U.completionContextType,contextId:U.completionContextId,actorMarshalId:t.value};try{U.isCompleted?Dn()?(await ko("checklist_uncomplete",{eventId:Y,itemId:U.itemId,data:de}),U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null,b&&await b()):(await Nt.uncomplete(Y,U.itemId,de),await ne(!0)):Dn()?(await ko("checklist_complete",{eventId:Y,itemId:U.itemId,data:de}),U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You",b&&await b()):(await Nt.complete(Y,U.itemId,de),await ne(!0)),k&&await k(Y,"checklist",JSON.parse(JSON.stringify(C.value)))}catch(ke){if(console.error("Failed to toggle checklist item:",ke),Dn()||!ke.response){const Re=U.isCompleted?"checklist_uncomplete":"checklist_complete";await ko(Re,{eventId:Y,itemId:U.itemId,data:de}),U.isCompleted?(U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null):(U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You"),b&&await b(),k&&await k(Y,"checklist",JSON.parse(JSON.stringify(C.value)))}}finally{I.value=!1}},toggleChecklistGroup:ae,getContextName:pe}}function BU({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const s=M(!1),i=M(null),r=M(null),u=M(null),d=M(!1),f=M(!1),p=M(!1);let g=null,y=null;const k=ae=>ae?.isDynamic===!0||ae?.IsDynamic===!0,b=(ae,pe,ne,oe)=>{const U=t.value.find(Y=>Y.id===ae);U&&(U.latitude=pe,U.longitude=ne,U.lastLocationUpdate=oe)},C=ae=>{i.value=ae,r.value=null,u.value=null,s.value=!0},x=()=>{s.value=!1,i.value=null,r.value=null,u.value=null,p.value=!1},$=()=>{s.value=!1,p.value=!0},I=()=>{p.value=!1,s.value=!0},S=async(ae,pe,ne,oe,U=null)=>{d.value=!0;try{const Y=e.value,de={latitude:pe,longitude:ne,sourceType:oe};U&&(de.sourceCheckpointId=U);const ke=await Kn.updatePosition(Y,ae,de);ke.data.success&&(f.value&&O(),b(ae,ke.data.latitude,ke.data.longitude,ke.data.lastLocationUpdate))}catch(Y){console.error("Failed to update location:",Y),Y.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},B=async()=>{if(i.value){d.value=!0,r.value=null;try{let ae,pe;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(ae=o.value.lat,pe=o.value.lng),!ae||!pe){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Y=await new Promise((de,ke)=>{navigator.geolocation.getCurrentPosition(de,ke,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});ae=Y.coords.latitude,pe=Y.coords.longitude}const ne=e.value,oe=i.value.locationId,U=await Kn.updatePosition(ne,oe,{latitude:ae,longitude:pe,sourceType:"gps"});U.data.success&&(u.value="Location updated successfully!",b(oe,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(ae){console.error("Failed to update location with GPS:",ae),ae.response?.status===403?r.value="You do not have permission to update this location.":ae.code===1?r.value="Location access denied. Please enable location permissions.":ae.code===2?r.value="Unable to determine your location. Please try again.":ae.code===3||ae.message?.includes("Timeout")?r.value="GPS timed out. Please ensure location services are enabled and try again.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async ae=>{if(!i.value)return;const pe=t.value.find(ne=>ne.id===ae);if(!pe){r.value="Source checkpoint not found.";return}d.value=!0,r.value=null;try{const ne=e.value,oe=i.value.locationId,U=await Kn.updatePosition(ne,oe,{latitude:pe.latitude,longitude:pe.longitude,sourceType:"checkpoint",sourceCheckpointId:ae});U.data.success&&(f.value&&O(),u.value=`Location copied from ${pe.name}!`,b(oe,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(ne){console.error("Failed to copy location from checkpoint:",ne),ne.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}},Z=async(ae,pe)=>{if(i.value){d.value=!0,r.value=null;try{const ne=e.value,oe=i.value.locationId,U=await Kn.updatePosition(ne,oe,{latitude:ae,longitude:pe,sourceType:"manual"});U.data.success&&(u.value="Location updated successfully!",b(oe,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(ne){console.error("Failed to update location manually:",ne),ne.response?.status===403?r.value="You do not have permission to update this location.":r.value="Failed to update location. Please try again."}finally{d.value=!1}}},A=async ae=>{if(!(!ae||!("geolocation"in navigator)))try{const pe=await new Promise((U,Y)=>{navigator.geolocation.getCurrentPosition(U,Y,{enableHighAccuracy:!0,timeout:15e3})}),ne=e.value,oe=ae.locationId;await Kn.updatePosition(ne,oe,{latitude:pe.coords.latitude,longitude:pe.coords.longitude,sourceType:"gps"}),b(oe,pe.coords.latitude,pe.coords.longitude,new Date().toISOString())}catch(pe){console.warn("Auto-update location failed:",pe)}},N=ae=>{f.value=!0,A(ae),g=setInterval(()=>{A(ae)},6e4)},O=()=>{f.value=!1,g&&(clearInterval(g),g=null)};return{showLocationUpdateModal:s,updatingLocationFor:i,locationUpdateError:r,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:f,selectingLocationOnMap:p,isDynamicCheckpoint:k,openLocationUpdateModal:C,closeLocationUpdateModal:x,startMapLocationSelect:$,cancelMapLocationSelect:I,updateDynamicCheckpointLocation:S,updateLocationWithGps:B,updateLocationFromCheckpoint:R,updateLocationManually:Z,toggleAutoUpdate:ae=>{f.value?O():N(ae)},startAutoUpdate:N,stopAutoUpdate:O,startDynamicCheckpointPolling:()=>{y||!t.value.some(pe=>pe.isDynamic||pe.IsDynamic)||(y=setInterval(async()=>{try{const pe=e.value,ne=await Kn.getDynamicCheckpoints(pe);if(ne.data&&Array.isArray(ne.data))for(const oe of ne.data){const U=t.value.find(Y=>Y.id===oe.checkpointId);U&&(U.latitude=oe.latitude,U.longitude=oe.longitude,U.lastLocationUpdate=oe.lastLocationUpdate)}}catch(pe){console.warn("Failed to poll dynamic checkpoints:",pe)}},6e4))},stopDynamicCheckpointPolling:()=>{y&&(clearInterval(y),y=null)},handleMapClickForLocation:ae=>{p.value&&i.value&&(S(i.value.locationId,ae.lat,ae.lng,"manual"),p.value=!1)}}}function NU({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:s,areaLeadMarshalDataVersion:i,updatePendingCount:r,updateCachedField:u}){const{termsLower:d}=dt(),f=M(null),p=M(null),g=M(null),y=M(!1),k=M(null),b=M(new Set),C=M(!1),x=M(""),$=V=>{if(!V)return!0;const P=new Date(V);return(new Date-P)/(1e3*60*60)>24},I=V=>V?new Date(V).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=V=>{if(!V)return"";switch(V){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return V}},B=V=>{b.value.add(V),y.value=!1,k.value=null},R=()=>{C.value=!1,x.value=""},Z=V=>V<1e3?`${Math.round(V/10)*10} m`:`${(Math.round(V/100)/10).toFixed(1)} km`,A=(V,P,j)=>{if(V==null||P==null)return;const Q=o.value?.find(oe=>oe.id===j);if(!Q)return;const ae=Q.latitude,pe=Q.longitude;if(ae==null||pe==null)return;const ne=li(V,P,ae,pe);if(ne>50){const oe=Z(ne);x.value=`Thanks for checking in. Just so you know, it's possible you are more than ${oe} from your ${d.value.checkpoint} area.`,C.value=!0}},N=async(V,P=!0,j=null)=>{if(!V?.id){g.value="Cannot check in: Assignment ID is missing";return}f.value=V.id,p.value=V.id,g.value=null;const Q=e.value;if(!Q){g.value="Cannot check in: Event ID is missing",f.value=null,p.value=null;return}const ae=V.effectiveIsCheckedIn!==void 0?V.effectiveIsCheckedIn:V.isCheckedIn&&!$(V.checkInTime),pe=V.isCheckedIn&&!ae,ne=ae?"check-out":pe?"refresh":"check-in",oe=!ae;let U=null,Y=null,de="Manual";if(P&&!ae&&"geolocation"in navigator)try{const Re=await new Promise((Xe,Ne)=>{navigator.geolocation.getCurrentPosition(Xe,Ne,{enableHighAccuracy:!0,timeout:5e3})});U=Re.coords.latitude,Y=Re.coords.longitude,de="GPS"}catch(Re){console.log("GPS unavailable, using manual check-in:",Re.message)}const ke={latitude:U,longitude:Y,action:ne};try{if(Dn()){await ko("checkin_toggle",{eventId:Q,assignmentId:V.id,gpsData:ke});const Re=t.value.findIndex(Xe=>Xe.id===V.id);if(Re!==-1&&(t.value[Re]={...t.value[Re],isCheckedIn:oe,checkInTime:oe?new Date().toISOString():null,checkInMethod:oe?`${de} (pending)`:null,checkInLatitude:U,checkInLongitude:Y}),j){const Xe=o.value.find(Ne=>Ne.id===j);if(Xe?.assignments){const Ne=Xe.assignments.find(ze=>ze.id===V.id||ze.marshalId===V.marshalId);Ne&&(Ne.isCheckedIn=oe,Ne.checkInTime=oe?new Date().toISOString():null)}}r&&await r(),u&&await u(Q,"locations",o.value)}else{const Re=await Sa.toggleCheckIn(Q,V.id,ke),Xe=t.value.findIndex(Ne=>Ne.id===V.id);if(Xe!==-1&&(t.value[Xe]=Re.data),j){const Ne=o.value.find(ze=>ze.id===j);if(Ne?.assignments){const ze=Ne.assignments.find(We=>We.id===V.id||We.marshalId===V.marshalId);ze&&Object.assign(ze,Re.data)}}}if(j&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++,oe&&U!=null&&Y!=null){const Re=j||V.locationId;Re&&A(U,Y,Re)}}catch(Re){if(Dn()||!Re.response){await ko("checkin_toggle",{eventId:Q,assignmentId:V.id,gpsData:ke});const Xe=t.value.findIndex(Ne=>Ne.id===V.id);Xe!==-1&&(t.value[Xe]={...t.value[Xe],isCheckedIn:oe,checkInTime:oe?new Date().toISOString():null,checkInMethod:oe?"Manual (pending)":null}),r&&await r()}else Re.response?.data?.message?g.value=Re.response.data.message:Re.message?g.value=Re.message:g.value=`Failed to ${ne}. Please try again.`}finally{f.value=null,p.value=null}};return{checkingIn:f,checkingInAssignment:p,checkInError:g,showCheckInReminderModal:y,checkInReminderCheckpoint:k,dismissedCheckInReminders:b,showDistanceWarning:C,distanceWarningMessage:x,isCheckInStale:$,formatCheckInTime:I,formatCheckInMethod:S,handleCheckInToggle:N,handleAreaLeadMarshalCheckIn:async V=>{const j=(a?.value?.checkpoints||s?.value||[]).find(ne=>ne.marshals?.some(oe=>oe.marshalId===V.marshalId));if(!j){console.error("Could not find checkpoint for marshal:",V);return}const Q=j.marshals.find(ne=>ne.marshalId===V.marshalId);if(!Q)return;const ae=Q.assignmentId||Q.id;if(!ae){console.error("No assignment ID found for marshal:",Q);return}const pe={id:ae,marshalId:V.marshalId,isCheckedIn:V.isCheckedIn,effectiveIsCheckedIn:V.isCheckedIn};await N(pe,!1,j.locationId)},dismissCheckInReminder:B,dismissDistanceWarning:R}}function FU({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:s,showMessage:i}){const r=M([]),u=M(!1),d=M(null),f=M(!1),p=M(!1),g=M(""),y=M(!1),k=M(!1),b=M(!1),C=F(()=>r.value.filter(N=>N.status==="open"||N.status==="acknowledged"||N.status==="in_progress").length),x=async()=>{const N=e.value;u.value=!0;try{const O=new Map;if(o.value&&a.value.length>0)for(const V of a.value)try{const j=(await ps.getForArea(N,V)).data.incidents||[];for(const Q of j)O.set(Q.incidentId,Q)}catch(P){console.warn(`Failed to load incidents for area ${V}:`,P)}try{const P=(await ps.getAll(N)).data.incidents||[];for(const j of P)j.reportedBy?.marshalId===t.value&&O.set(j.incidentId,j)}catch(V){console.debug("Could not load all incidents:",V)}r.value=Array.from(O.values()).sort((V,P)=>new Date(P.incidentTime||P.createdAt)-new Date(V.incidentTime||V.createdAt)),s?.value&&(s.value.incidents=Date.now()),console.log("My incidents loaded:",r.value.length)}catch(O){console.error("Failed to load incidents:",O)}finally{u.value=!1}},$=async N=>{b.value=!0;try{await ps.create(e.value,N),k.value=!1,x(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(O){console.error("Failed to report incident:",O),i&&i("Error",O.response?.data?.message||"Failed to report incident. Please try again.")}finally{b.value=!1}},I=N=>{d.value=N,f.value=!0},S=()=>{f.value=!1,d.value=null},B=async({incidentId:N,status:O})=>{try{await ps.updateStatus(e.value,N,{status:O});const V=r.value.find(P=>P.incidentId===N);V&&(V.status=O),d.value?.incidentId===N&&(d.value.status=O)}catch(V){console.error("Failed to update incident status:",V),i&&i("Error","Failed to update status. Please try again.")}},R=()=>{g.value="",p.value=!0},Z=()=>{p.value=!1,g.value=""};return{myIncidents:r,incidentsLoading:u,selectedIncident:d,showIncidentDetail:f,showAddIncidentNoteModal:p,incidentNoteText:g,submittingIncidentNote:y,showReportIncident:k,reportingIncident:b,openIncidentsCount:C,loadMyIncidents:x,handleReportIncident:$,openIncidentDetail:I,closeIncidentDetail:S,handleIncidentStatusChange:B,openAddIncidentNoteModal:R,closeAddIncidentNoteModal:Z,submitIncidentNote:async()=>{if(!(!g.value.trim()||!d.value)){y.value=!0;try{await ps.addNote(e.value,d.value.incidentId,g.value.trim()),Z(),x();const N=await ps.get(e.value,d.value.incidentId);d.value=N.data}catch(N){console.error("Failed to add note:",N),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const vf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',mf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function UU({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=dt(),s=M({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=M(-1),r=M({}),u={},d=F(()=>t.value.filter(x=>x.location?.latitude&&x.location?.longitude&&!(x.location.latitude===0&&x.location.longitude===0))),f=F(()=>{const x=[];return e.value&&!s.value.userLocationInView&&x.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:vf}),d.value.length>0&&!s.value.highlightedLocationInView&&x.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:mf}),x}),p=x=>{const $=s.value,I=$.userLocationInView!==x.userLocationInView||$.highlightedLocationInView!==x.highlightedLocationInView,S=JSON.stringify($.highlightedLocationsVisibility)!==JSON.stringify(x.highlightedLocationsVisibility||{});(I||S)&&(s.value={...x,highlightedLocationsVisibility:x.highlightedLocationsVisibility||{}})},g=()=>{const x=d.value;if(x.length===0)return null;if(x.length===1)return i.value=0,x[0];const $=s.value.highlightedLocationsVisibility||{},I=[];for(let R=0;R<x.length;R++){const Z=x[R].locationId;$[Z]===!1&&I.push(R)}if(I.length===0)return i.value=0,x[0];if(I.length===1)return i.value=I[0],x[I[0]];const S=i.value;let B=-1;for(const R of I)if(R>S){B=R;break}return B===-1&&(B=I[0]),i.value=B,x[B]};return{courseMapVisibility:s,courseMapActions:f,handleCourseMapVisibilityChange:p,handleCourseMapAction:({actionId:x})=>{if(x==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(x==="recenter-checkpoint"){const $=g();$?.location&&o.value?.recenterOnLocation($.location.latitude,$.location.longitude)}},checkpointMapVisibility:r,checkpointMapRefs:u,getCheckpointMapActions:x=>{const $=[],I=r.value[x]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!I.userLocationInView&&$.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:vf}),I.highlightedLocationInView||$.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:mf}),$},handleCheckpointMapVisibilityChange:(x,$)=>{const I=r.value[x];(!I||I.userLocationInView!==$.userLocationInView||I.highlightedLocationInView!==$.highlightedLocationInView)&&(r.value={...r.value,[x]:$})},handleCheckpointMapAction:(x,{actionId:$})=>{const I=u[x.id];$==="recenter-user"&&e.value?I?.recenterOnUserLocation():$==="recenter-checkpoint"&&x.location&&I?.recenterOnLocation(x.location.latitude,x.location.longitude)}}}function zU({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,loadChecklist:s}){const i=M(null),r=M(!1),u=M(0),d=g=>{i.value=i.value===g?null:g},f=F(()=>{u.value;const g=o?.value?.checkpoints||a?.value||[],y=new Map;for(const k of g)for(const b of k.marshals||[]){y.has(b.marshalId)||y.set(b.marshalId,{...b,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const C=y.get(b.marshalId);if(C.checkpoints.push({checkpointId:k.checkpointId,name:k.name,description:k.description}),b.outstandingTasks)for(const x of b.outstandingTasks)C.allTasks.push({...x,isCompleted:!1,checkpointName:k.name}),C.totalTaskCount++;if(b.completedTasks)for(const x of b.completedTasks)C.allTasks.push({...x,isCompleted:!0,checkpointName:k.name}),C.totalTaskCount++,C.completedTaskCount++}return Array.from(y.values()).sort((k,b)=>(k.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:i,savingAreaLeadMarshalTask:r,areaLeadMarshalDataVersion:u,allAreaLeadMarshals:f,toggleAreaLeadMarshalExpansion:d,toggleAreaLeadMarshalTask:async(g,y)=>{if(r.value)return;r.value=!0;const k={marshalId:y.marshalId,contextType:g.contextType,contextId:g.contextId,actorMarshalId:t.value};try{g.isCompleted?await Nt.uncomplete(e.value,g.itemId,k):await Nt.complete(e.value,g.itemId,k),o?.value?.loadDashboard&&await o.value.loadDashboard(),u.value++,s&&await s(!0)}catch(b){console.error("Failed to toggle area lead marshal task:",b)}finally{r.value=!1}}}}function HU({router:e,route:t,onAuthSuccess:o}){const a=M(!1),s=M(!1),i=M(null),r=M(null),u=M(null),d=M(null),f=F(()=>r.value?.name||null),p=F(()=>d.value?.eventRoles?d.value.eventRoles.filter(O=>O.role==="EventAreaLead").flatMap(O=>O.areaIds||[]):[]),g=F(()=>p.value.length>0),y=F(()=>d.value?.eventRoles?d.value.eventRoles.some(N=>N.role==="EventAdmin"):!1),k=F(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),b=F(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let C=null;const x=()=>{C||(C=setInterval(async()=>{if(d.value?.marshalId)try{await ms.getMe(t.params.eventId)}catch(N){console.debug("Heartbeat failed:",N)}},300*1e3))},$=()=>{C&&(clearInterval(C),C=null)},I=async(N,O,V=!1)=>{s.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:N,code:O,isReauth:V}),Jc();try{_o("marshal",N);const P=await ms.marshalLogin(N,O);if(console.log("Auth response:",P.data),P.data.success){Oh(N,{token:P.data.sessionToken,marshalId:P.data.marshalId,marshalName:P.data.person?.name||null}),ik(N,P.data.marshalId,O),r.value=P.data.person,u.value=P.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,r.value?.name);try{const j=await ms.getMe(N);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),x(),o&&await o()}else i.value=P.data.message||"Authentication failed"}catch(P){console.error("Authentication failed:",P),i.value=P.response?.data?.message||"Invalid or expired login link"}finally{s.value=!1}};return{isAuthenticated:a,authenticating:s,loginError:i,currentPerson:r,currentMarshalId:u,userClaims:d,currentMarshalName:f,areaLeadAreaIds:p,isAreaLead:g,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:b,authenticateWithMagicCode:I,checkExistingSession:async N=>{_o("marshal",N);const O=Fr(N),V=O?.marshalId,P=V?uv(N,V):null;if(!O?.token)return P?(console.log("No session but have stored code, attempting re-authentication..."),Jc(),await I(N,P,!0),a.value):!1;try{const j=await ms.getMe(N);if(j.data&&j.data.marshalId)return d.value=j.data,r.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},u.value=j.data.marshalId,a.value=!0,iv(N,j.data.marshalId),x(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),P)try{if(Jc(),await I(N,P,!0),a.value)return console.log("Re-authentication successful"),!0}catch(Q){console.error("Re-authentication failed:",Q)}O?.sessionKey&&ku(O.sessionKey)}return!1},handleClose:N=>{$(),_o(null),a.value=!1,r.value=null,u.value=null,d.value=null,N&&N(),e.push("/marshal")},handleRemoveSession:async N=>{const[O]=N.split(":");_o("marshal",O);try{await ms.logout()}catch{}ku(N),_o(null)},updateSessionEventInfo:(N,O,V)=>{const P=Fr(N);P&&P.marshalId&&Oh(N,{marshalId:P.marshalId,marshalName:P.marshalName,token:P.token,eventName:O,eventDate:V})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:x,stopHeartbeat:$}}const VU={key:0,class:"header-logo-cover"},GU=["src"],jU={key:2,class:"header-logo header-logo-left"},ZU=["src"],WU={class:"header-center"},qU={key:0},KU={key:1,class:"header-event-date"},JU={key:0,class:"header-actions"},YU={key:3,class:"header-logo header-logo-right"},XU=["src"],QU={class:"container"},ez={key:0,class:"selection-card"},tz={key:1,class:"selection-card"},nz={key:0,class:"loading"},oz={key:2,class:"selection-card error-card"},sz={class:"error"},az={key:3,class:"dashboard"},iz={key:0,class:"welcome-bar"},lz={class:"welcome-info"},rz={key:0,class:"welcome-email"},cz={key:0,class:"mode-switch"},uz={key:1,class:"mode-switch"},dz={class:"accordion"},hz={class:"add-note-form"},fz={class:"modal-actions"},pz=["disabled"],vz=6e4,mz={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=dt(),{updatePendingCount:a}=ud(),s=hc(),i=Zi(),r=F(()=>s.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:f,loginError:p,currentPerson:g,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:b,isAreaLead:C,canSwitchToAdmin:x,isAdminButNeedsReauth:$,authenticateWithMagicCode:I,checkExistingSession:S,handleClose:B,updateSessionEventInfo:R,switchToAdminMode:Z,stopHeartbeat:A}=HU({router:i,route:s,onAuthSuccess:()=>u.onAuthSuccess?.()}),N=M(new Set),O=F(()=>b.value.length?ne.value.filter(Oe=>b.value.includes(Oe.id)).map(Oe=>({areaId:Oe.id,name:Oe.name,color:Oe.color})).sort((Oe,Pe)=>(Oe.name||"").localeCompare(Pe.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ze(O,Oe=>{Oe.length>0&&N.value.size===0&&(N.value=new Set(Oe.map(Pe=>Pe.areaId)))},{immediate:!0});const V=F(()=>b.value.filter(Oe=>N.value.has(Oe))),P=Oe=>{const Pe=new Set(N.value);Pe.has(Oe)?Pe.delete(Oe):Pe.add(Oe),N.value=Pe},j=F(()=>{const Oe=bn.value.find(tt=>tt.isCheckedIn&&!ss(tt.checkInTime)&&tt.location);if(Oe?.location)return{id:Oe.location.id,locationId:Oe.location.id,name:Oe.location.name,description:Oe.location.description};if(no.value){const tt=bn.value.find(ft=>ft.id===no.value);if(tt?.location)return{id:tt.location.id,locationId:tt.location.id,name:tt.location.name,description:tt.location.description}}const Pe=bn.value[0];return Pe?.location?{id:Pe.location.id,locationId:Pe.location.id,name:Pe.location.name,description:Pe.location.description}:null}),Q=M(null),ae=M([]),pe=M([]),ne=M([]),oe=M(!0),{pageBackgroundStyle:U,headerStyle:Y,headerTextColor:de,accentColor:ke,accentTextColor:Re,accentButtonStyle:Xe,brandingLogoUrl:Ne,brandingLogoPosition:ze}=DU(Q);wl("marshalBranding",{headerStyle:Y,headerTextColor:de,accentButtonStyle:Xe,accentColor:ke,accentTextColor:Re});const We=M("assignments"),ee=M({checklist:0,notes:0,incidents:0,eventContacts:0}),ye=M([]),te=M([]),ge=M(null),he=F(()=>ge.value?.areaLeadRef?.value),{checklistItems:G,checklistLoading:J,checklistError:ce,savingChecklist:Me,expandedChecklistGroup:Be,visibleChecklistItems:De,completedChecklistCount:Le,myChecklistItems:X,areaChecklistItems:fe,areaChecklistItemsWithLocalState:xe,areaMarshalsForChecklist:Se,effectiveChecklistGroupBy:_e,groupedChecklistItems:W,loadChecklist:q,handleToggleChecklist:K,toggleChecklistGroup:le,getContextName:Ee}=RU({eventId:r,currentMarshalId:y,currentPerson:g,assignments:pe,areaLeadAreaIds:b,isAreaLead:C,allLocations:ae,areas:ne,terms:t,termsLower:o,areaLeadRef:he,areaLeadCheckpoints:ye,sectionLastLoadedAt:ee,updateCachedField:Lr,updatePendingCount:a}),{userLocation:Ke,locationLastUpdated:Qe,startLocationTracking:gt,stopLocationTracking:Lt}=OU(),{showLocationUpdateModal:yt,updatingLocationFor:xt,locationUpdateError:kt,locationUpdateSuccess:Ut,updatingLocation:Rt,autoUpdateEnabled:ct,selectingLocationOnMap:ln,openLocationUpdateModal:un,closeLocationUpdateModal:Bt,startMapLocationSelect:bt,cancelMapLocationSelect:Yn,updateDynamicCheckpointLocation:Un,updateLocationWithGps:Xn,updateLocationFromCheckpoint:kn,toggleAutoUpdate:Kt,stopAutoUpdate:_s,startDynamicCheckpointPolling:Qn,stopDynamicCheckpointPolling:Co}=BU({eventId:r,allLocations:ae,userLocation:Ke,locationLastUpdated:Qe}),re=()=>{bt(),We.value="map"},{expandedAreaLeadMarshal:ue,savingAreaLeadMarshalTask:me,areaLeadMarshalDataVersion:st,allAreaLeadMarshals:je,toggleAreaLeadMarshalExpansion:$t,toggleAreaLeadMarshalTask:Yt}=zU({eventId:r,currentMarshalId:y,areaLeadRef:he,areaLeadCheckpoints:ye,loadChecklist:q}),{checkingIn:nn,checkingInAssignment:Bo,checkInError:ho,showCheckInReminderModal:No,checkInReminderCheckpoint:zn,dismissedCheckInReminders:Aa,showDistanceWarning:bs,distanceWarningMessage:Fo,isCheckInStale:ss,handleCheckInToggle:qs,handleAreaLeadMarshalCheckIn:Hn,dismissCheckInReminder:Ks,dismissDistanceWarning:dn}=NU({eventId:r,assignments:pe,allLocations:ae,areaLeadRef:he,areaLeadCheckpoints:ye,areaLeadMarshalDataVersion:st,updatePendingCount:a,updateCachedField:Lr}),Lo=M(!1),So=M(!1),ws=M(""),fo=M(""),po=M(null),eo=M(!1),xo=M(""),pn=M(""),vo=(Oe,Pe)=>{xo.value=Oe,pn.value=Pe,eo.value=!0},{myIncidents:to,incidentsLoading:mt,selectedIncident:Et,showIncidentDetail:Io,showAddIncidentNoteModal:Uo,incidentNoteText:mo,submittingIncidentNote:Js,showReportIncident:ht,loadMyIncidents:zt,handleReportIncident:Ea,openIncidentDetail:Cs,handleIncidentStatusChange:Mn,openAddIncidentNoteModal:Yi,closeAddIncidentNoteModal:as,submitIncidentNote:$o}=FU({eventId:r,currentMarshalId:y,isAreaLead:C,areaLeadAreaIds:b,sectionLastLoadedAt:ee,showMessage:vo}),qt=M(null),zo=F(()=>qt.value),Ho=M(null),Ls=Oe=>!Oe||Oe.length===0?!1:Oe.some(Pe=>b.value.includes(Pe)),Pa=Oe=>{Ho.value=Ho.value===Oe?null:Oe},_n=Oe=>{const Pe=We.value===Oe;if(We.value=Pe?null:Oe,!Pe){const tt=Date.now(),ft=wt=>tt-ee.value[wt]>vz;switch(Oe){case"checklist":ft("checklist")&&q();break;case"notes":ft("notes")&&hn();break;case"incidents":ft("incidents")&&zt();break;case"eventContacts":ft("eventContacts")&&is();break}}},no=M(null),Zt=Oe=>{no.value=no.value===Oe?null:Oe};Ze(()=>pe.value,Oe=>{Oe.length===1&&no.value===null&&(no.value=Oe[0].id)},{immediate:!0});const bn=F(()=>pe.value.map(Oe=>{const Pe=ae.value.find(Tt=>Tt.id===Oe.locationId),tt=Pe?.areaIds||Pe?.AreaIds||[];let ft=null;tt.length>0&&ne.value.length>0&&(ft=ne.value.find(Xt=>tt.includes(Xt.id))?.name);const Ht=(Pe?.assignments||[]).map(Tt=>({...Tt,effectiveIsCheckedIn:Tt.isCheckedIn&&!ss(Tt.checkInTime)})).sort((Tt,Xt)=>(Tt.marshalName||"").localeCompare(Xt.marshalName||"",void 0,{sensitivity:"base"})),Cn=Oa.value.filter(Tt=>tt.includes(Tt.areaId)&&(!Tt.marshalId||Tt.marshalId!==y.value)),Vn=new Set,Vt=Cn.filter(Tt=>{const Xt=JSON.stringify({name:Tt.name||"",marshalId:Tt.marshalId||"",role:Tt.role||"",phone:Tt.phone||"",email:Tt.email||"",notes:Tt.notes||""});return Vn.has(Xt)?!1:(Vn.add(Xt),!0)}).sort((Tt,Xt)=>(Tt.marshalName||Tt.name||"").localeCompare(Xt.marshalName||Xt.name||"",void 0,{sensitivity:"base"})),Ln=Oe.isCheckedIn&&!ss(Oe.checkInTime);return{...Oe,location:Pe,areaName:ft,areaIds:tt,allMarshals:Ht,areaContacts:Vt,locationName:Pe?.name||"Unknown Location",effectiveIsCheckedIn:Ln}})),{courseMapActions:Ys,handleCourseMapVisibilityChange:Xs,handleCourseMapAction:Qs,getCheckpointMapActions:ci,handleCheckpointMapVisibilityChange:An,handleCheckpointMapAction:ea}=UU({userLocation:Ke,assignmentsWithDetails:bn,courseMapRef:zo}),rt=F(()=>pe.value.length>0?pe.value[0]:null),wn=F(()=>pe.value.map(Oe=>Oe.locationId)),St=F(()=>bn.value.some(Oe=>Oe.location?.isDynamic||Oe.location?.IsDynamic)),go=F(()=>bn.value.find(Oe=>Oe.location?.isDynamic||Oe.location?.IsDynamic)),Vo=F(()=>{if(!Q.value||!bn.value.length)return[];const Oe=new Date,Pe=Q.value.eventDate?new Date(Q.value.eventDate):null;return bn.value.filter(tt=>{if(tt.effectiveIsCheckedIn||Aa.value.has(tt.id))return!1;const ft=tt.location;if(!ft)return!1;const wt=ft.startTime?new Date(ft.startTime):Pe;if(!wt)return!1;let Ht;if(ft.endTime)Ht=new Date(ft.endTime);else if(Pe)Ht=new Date(Pe.getTime()+7200*1e3);else return!1;return Oe>=wt&&Oe<Ht})});Ze(Vo,Oe=>{Oe.length>0&&!No.value&&(zn.value=Oe[0],No.value=!0)},{immediate:!0}),Ze(bs,Oe=>{Oe&&(vo("Distance notice",Fo.value),dn())});const ta=()=>{const Oe=zn.value;Oe&&(Ks(Oe.id),We.value="assignments",no.value=Oe.id)},To=F(()=>Q.value?.route?(typeof Q.value.route=="string"?JSON.parse(Q.value.route):Q.value.route)||[]:[]),oo=F(()=>!rt.value||!ae.value.length?null:ae.value.find(Oe=>Oe.id===rt.value.locationId)),Mo=M([]),Ao=M(!1),Jt=F(()=>{const Oe=Mo.value.filter(ft=>!ft.marshalId||ft.marshalId!==y.value),Pe=new Set;return Oe.filter(ft=>{const wt=JSON.stringify({name:ft.name||"",marshalId:ft.marshalId||"",role:ft.role||"",phone:ft.phone||"",email:ft.email||"",notes:ft.notes||""});return Pe.has(wt)?!1:(Pe.add(wt),!0)}).sort((ft,wt)=>{if(ft.isPinned!==wt.isPinned)return ft.isPinned?-1:1;const Ht=ft.displayOrder||0,Cn=wt.displayOrder||0;return Ht!==Cn?Ht-Cn:(ft.name||"").localeCompare(wt.name||"",void 0,{sensitivity:"base"})})}),Eo=F(()=>Jt.value.filter(Oe=>Oe.showInEmergencyInfo)),Da=F(()=>te.value.filter(Oe=>Oe.showInEmergencyInfo)),na=F(()=>Eo.value.length>0||Da.value.length>0),Xi=(Oe,Pe=[])=>{if(!te.value||te.value.length===0)return[];const tt=ae.value.find(Vt=>Vt.id===Oe),ft=tt?.areaIds||tt?.AreaIds||[],wt=Pe.length>0?Pe:ft,Ht=[],Cn=new Set;for(const Vt of te.value){const Ln=Vt.noteId||Vt.NoteId||Vt.id;if(Cn.has(Ln))continue;const Tt=Vt.scopeConfigurations||Vt.ScopeConfigurations||[];let Xt=!1;if(Tt.length>0)for(const so of Tt){const ls=so.itemType||so.ItemType,Sn=so.ids||so.Ids||[];if(ls==="Checkpoint"&&(Sn.includes(Oe)||Sn.includes("ALL_CHECKPOINTS"))){Xt=!0;break}if(ls==="Area"&&(Sn.includes("ALL_AREAS")||wt.length>0&&wt.some(vi=>Sn.includes(vi)))){Xt=!0;break}}else{const so=Vt.matchedScope||Vt.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(Sn=>so.includes(Sn)||so===Sn)&&(Xt=!0)}Xt&&(Cn.add(Ln),Ht.push(Vt))}const Vn={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Ht.sort((Vt,Ln)=>{const Tt=Vt.isPinned||Vt.IsPinned,Xt=Ln.isPinned||Ln.IsPinned;if(Tt&&!Xt)return-1;if(!Tt&&Xt)return 1;const so=Vn[Vt.priority||Vt.Priority||"Normal"]??3,ls=Vn[Ln.priority||Ln.Priority||"Normal"]??3;if(so!==ls)return so-ls;const Sn=Vt.createdAt||Vt.CreatedAt,pi=Ln.createdAt||Ln.CreatedAt;return new Date(pi)-new Date(Sn)})},Oa=M([]),Ra=(Oe,Pe)=>Oe.localeCompare(Pe,void 0,{numeric:!0,sensitivity:"base"}),Qi=F(()=>{if(!xt.value)return[];const Oe=xt.value.locationId;return ae.value.filter(Pe=>Pe.id!==Oe&&Pe.latitude!==0&&Pe.longitude!==0).sort((Pe,tt)=>Ra(Pe.name,tt.name))}),ui=F(()=>oo.value?{lat:oo.value.latitude,lng:oo.value.longitude}:Ke.value?Ke.value:ae.value.length>0?{lat:ae.value[0].latitude,lng:ae.value[0].longitude}:{lat:51.505,lng:-.09}),_t=async()=>{const Oe=s.params.eventId;if(console.log("Loading event data for:",{eventId:Oe,marshalId:y.value}),Dn()){console.log("Offline mode detected, attempting to load from cache...");const wt=await La(Oe);if(wt){if(console.log("Loaded cached data from:",wt.cachedAt),Q.value=wt.event,ne.value=wt.areas||[],ae.value=wt.locations||[],G.value=wt.checklist||[],Mo.value=wt.contacts||[],te.value=wt.notes||[],wt.areaLeadDashboard?.checkpoints&&(ye.value=wt.areaLeadDashboard.checkpoints),Q.value&&Iu(Q.value),y.value){const Ht=[];for(const Cn of ae.value){const Vn=Cn.assignments?.find(Vt=>Vt.marshalId===y.value);Vn&&Ht.push(Vn)}pe.value=Ht}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[Pe,tt,ft]=await Promise.allSettled([_a.getById(Oe),ba.getByEvent(Oe),ml.getEventStatus(Oe)]);if(Pe.status==="fulfilled"?(Q.value=Pe.value.data,console.log("Event loaded:",Q.value?.name),Q.value&&(Iu(Q.value),R(Oe,Q.value.name,Q.value.eventDate))):console.error("Failed to load event:",Pe.reason),tt.status==="fulfilled"?(ne.value=tt.value.data||[],console.log("Areas loaded:",ne.value.length)):console.error("Failed to load areas:",tt.reason),ft.status==="fulfilled"){if(ae.value=ft.value.data?.locations||[],console.log("Locations loaded:",ae.value.length),y.value){const wt=[];for(const Ht of ae.value){const Cn=Ht.assignments?.find(Vn=>Vn.marshalId===y.value);Cn&&wt.push(Cn)}pe.value=wt,console.log("Total assignments found:",pe.value.length)}}else console.error("Failed to load event status:",ft.reason);await Promise.allSettled([q(),is(),hn(),zt()]);try{const wt=JSON.parse(JSON.stringify({event:Q.value,areas:ne.value,locations:ae.value,checklist:G.value,contacts:Mo.value,notes:te.value,marshalId:y.value}));await Ul(Oe,wt),console.log("Event data cached for offline access")}catch(wt){console.warn("Failed to cache event data:",wt)}Qn()};u.onAuthSuccess=_t;const di=async()=>{const Oe=s.params.eventId;if(Dn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Pe=await ba.getAreaLeadDashboard(Oe);if(Pe.data){ye.value=Pe.data.checkpoints||[];const tt=JSON.parse(JSON.stringify({areas:Pe.data.areas||[],checkpoints:Pe.data.checkpoints||[]}));await La(Oe)?await Lr(Oe,"areaLeadDashboard",tt):await Ul(Oe,{areaLeadDashboard:tt}),console.log("Area lead dashboard cached for offline access")}}catch(Pe){Pe.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Pe)}console.log("Background preload complete")},hn=async()=>{const Oe=s.params.eventId;try{const Pe=await Ps.getMyNotes(Oe);te.value=Pe.data||[],ee.value.notes=Date.now(),console.log("Notes loaded:",te.value.length)}catch(Pe){console.error("Failed to load notes:",Pe)}},is=async()=>{const Oe=s.params.eventId;Ao.value=!0;try{const Pe=await pa.getMyContacts(Oe);Mo.value=Pe.data||[],ee.value.eventContacts=Date.now(),console.log("Contacts loaded:",Mo.value.length)}catch(Pe){console.warn("Failed to load contacts:",Pe),Mo.value=[]}finally{Ao.value=!1}},hi=()=>{So.value=!1,po.value&&(po.value(),po.value=null)},el=()=>{So.value=!1,po.value=null},Ba=()=>{eo.value=!1},oa=Oe=>{if(ln.value&&xt.value){Un(xt.value.locationId,Oe.lat,Oe.lng,"manual"),ln.value=!1,xt.value=null;return}if(St.value&&go.value){const Pe=go.value;ws.value="Update location",fo.value=`Update ${Pe.location?.name||"dynamic checkpoint"} to this location?`,po.value=async()=>{await Un(Pe.locationId,Oe.lat,Oe.lng,"manual")},So.value=!0}},Na=Oe=>{if(!ln.value&&St.value&&go.value){const Pe=go.value;if(Oe.id===Pe.locationId)return;ws.value="Copy location",fo.value=`Copy location from "${Oe.name}" to ${Pe.location?.name||"your dynamic checkpoint"}?`,po.value=async()=>{await Un(Pe.locationId,Oe.latitude,Oe.longitude,"checkpoint",Oe.id)},So.value=!0}},fi=()=>{B(()=>{pe.value=[],G.value=[],Oa.value=[]})},tl=Oe=>Oe?new Date(Oe).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return tn(async()=>{const Oe=s.params.eventId,Pe=s.query.code;oe.value=!0;try{Pe?await I(Oe,Pe):await S(Oe)&&await _t()}finally{oe.value=!1}d.value&&(gt(),"requestIdleCallback"in window?requestIdleCallback(()=>{di()},{timeout:5e3}):setTimeout(()=>{di()},2e3))}),Ze(d,Oe=>{Oe?gt():Lt()}),Ze(()=>s.query.code,async Oe=>{if(Oe&&d.value){oe.value=!0;try{await I(s.params.eventId,Oe)}finally{oe.value=!1}}}),Ze(Q,Oe=>{Oe&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),yn(()=>{A(),_s(),Co()}),(Oe,Pe)=>(v(),m("div",{class:"marshal-view",style:et(D(U))},[Ae(eB),l("header",{class:ve(["header",`logo-${D(ze)}`]),style:et(D(Y))},[D(Ne)&&D(ze)==="cover"?(v(),m("div",VU,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-cover-img"},null,8,GU)])):E("",!0),D(d)&&D(ze)==="right"?(v(),m("button",{key:1,onClick:fi,class:"btn-close-session btn-close-left",style:et({color:D(de)}),title:"Close session"},"  ",4)):E("",!0),D(Ne)&&D(ze)==="left"?(v(),m("div",jU,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-img"},null,8,ZU)])):E("",!0),l("div",WU,[l("div",{class:"header-title",style:et({color:D(de)})},[Q.value?(v(),m("h1",qU,w(Q.value.name),1)):E("",!0),Q.value?.eventDate?(v(),m("div",KU,w(tl(Q.value.eventDate)),1)):E("",!0)],4),D(d)?(v(),m("div",JU,[l("button",{onClick:Pe[0]||(Pe[0]=tt=>ht.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),na.value?(v(),m("button",{key:0,onClick:Pe[1]||(Pe[1]=tt=>Lo.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):E("",!0)])):E("",!0)]),D(Ne)&&D(ze)==="right"?(v(),m("div",YU,[l("img",{src:D(Ne),alt:"Event logo",class:"header-logo-img"},null,8,XU)])):E("",!0),D(d)&&D(ze)!=="right"?(v(),m("button",{key:4,onClick:fi,class:"btn-close-session btn-close-right",style:et({color:D(de)}),title:"Close session"},"  ",4)):E("",!0)],6),l("div",QU,[oe.value?(v(),m("div",ez,[...Pe[22]||(Pe[22]=[l("div",{class:"loading"},"Loading...",-1)])])):!D(d)&&!D(p)?(v(),m("div",tz,[Pe[23]||(Pe[23]=l("h2",null,"Welcome",-1)),Pe[24]||(Pe[24]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),D(f)?(v(),m("p",nz,"Authenticating...")):E("",!0)])):D(p)?(v(),m("div",oz,[Pe[25]||(Pe[25]=l("h2",null,"Login failed",-1)),l("p",sz,w(D(p)),1),Pe[26]||(Pe[26]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",az,[D(x)||D($)?(v(),m("div",iz,[l("div",lz,[D(g)?.email?(v(),m("span",rz,w(D(g).email),1)):E("",!0)]),D(x)?(v(),m("div",cz,[l("button",{onClick:Pe[2]||(Pe[2]=(...tt)=>D(Z)&&D(Z)(...tt)),class:"btn-mode-switch"}," Switch to Admin ")])):D($)?(v(),m("div",uz,[...Pe[27]||(Pe[27]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):E("",!0)])):E("",!0),l("div",dz,[Ae(PU,{ref:"assignmentsSectionRef","is-expanded":We.value==="assignments",assignments:bn.value,"expanded-checkpoint-id":no.value,"all-locations":ae.value,route:To.value,"user-location":D(Ke),"has-dynamic-assignment":St.value,"current-marshal-id":D(y),"current-marshal-name":D(k),"checking-in-id":D(nn),"checking-in-assignment-id":D(Bo),"check-in-error":D(ho),"checking-in-marshal-id":D(nn),"expanded-marshal-id":Ho.value,"updating-location":D(Rt),"auto-update-enabled":D(ct),"get-toolbar-actions":D(ci),"is-area-lead-for-areas":Ls,"get-notes-for-checkpoint":Xi,onToggle:Pe[3]||(Pe[3]=tt=>_n("assignments")),onToggleCheckpoint:Zt,onMapClick:oa,onLocationClick:Na,onActionClick:D(ea),onVisibilityChange:D(An),onUpdateLocation:D(un),onCheckIn:Pe[4]||(Pe[4]=tt=>D(qs)(tt,!0)),onToggleMarshal:Pa,onMarshalCheckIn:Pe[5]||(Pe[5]=(tt,ft)=>D(qs)(tt,!1,ft)),onToggleAutoUpdate:D(Kt)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ae(i9,{loading:D(J),error:D(ce),"is-expanded":We.value==="checklist","is-area-lead":D(C),"my-items":D(X),"area-items":D(fe),"area-items-with-local-state":D(xe),"visible-items":D(De),"grouped-items":D(W),"completed-count":D(Le),saving:D(Me),"effective-group-by":D(_e),"expanded-group":D(Be),locations:ae.value,areas:ne.value,marshals:D(Se),"get-context-name":D(Ee),onToggle:Pe[6]||(Pe[6]=tt=>_n("checklist")),onToggleItem:D(K),onToggleGroup:D(le)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ae(f9,{"event-id":D(s).params.eventId,notes:te.value,locations:ae.value,areas:ne.value,assignments:pe.value,"is-expanded":We.value==="notes",onToggle:Pe[7]||(Pe[7]=tt=>_n("notes")),onNotesChanged:hn},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ae(tN,{contacts:Jt.value,loading:Ao.value,"is-expanded":We.value==="eventContacts",onToggle:Pe[8]||(Pe[8]=tt=>_n("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ae(dN,{incidents:D(to),loading:D(mt),"is-expanded":We.value==="incidents",onToggle:Pe[9]||(Pe[9]=tt=>_n("incidents")),onSelectIncident:D(Cs)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ae(ZF,{ref_key:"areaLeadSectionRef",ref:ge,"is-area-lead":D(C),"is-expanded":We.value==="areaLead",areas:O.value,"selected-filters":N.value,"filtered-area-ids":V.value,"event-id":D(s).params.eventId,"marshal-id":D(y),route:To.value,onToggle:Pe[10]||(Pe[10]=tt=>_n("areaLead")),onToggleFilter:P,onChecklistUpdated:D(q)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ae(k7,{"is-area-lead":D(C),"is-expanded":We.value==="areaLeadMarshals",marshals:D(je),"expanded-marshal-id":D(ue),"checking-in-marshal-id":D(nn),"saving-task":D(me),onToggle:Pe[11]||(Pe[11]=tt=>_n("areaLeadMarshals")),onToggleMarshal:D($t),onCheckIn:D(Hn),onToggleTask:D(Yt)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Ae(L9,{ref_key:"routeSectionRef",ref:qt,"is-expanded":We.value==="map","user-location":D(Ke),"selecting-location":D(ln),"selecting-location-name":D(xt)?.location?.name||"",locations:ae.value,route:To.value,center:ui.value,"highlight-location-ids":wn.value,clickable:D(ln)||St.value,"toolbar-actions":D(Ys),onToggle:Pe[12]||(Pe[12]=tt=>_n("map")),onCancelSelect:D(Yn),onMapClick:oa,onLocationClick:Na,onActionClick:D(Qs),onVisibilityChange:D(Xs)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onCancelSelect","onActionClick","onVisibilityChange"]),Ae(CN,{"event-date":Q.value?.eventDate,description:Q.value?.description,"is-expanded":We.value==="eventDetails",onToggle:Pe[13]||(Pe[13]=tt=>_n("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ae(UR,{show:Lo.value,contacts:Eo.value,notes:Da.value,onClose:Pe[14]||(Pe[14]=tt=>Lo.value=!1)},null,8,["show","contacts","notes"]),Ae(nm,{show:D(ht),"event-id":r.value||"",checkpoint:j.value,"initial-location":D(Ke),checkpoints:ae.value,route:To.value,onClose:Pe[15]||(Pe[15]=tt=>ht.value=!1),onSubmit:D(Ea)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ae(tm,{show:D(Io),incident:D(Et),route:To.value,checkpoints:ae.value,"can-manage":D(C),onClose:Pe[16]||(Pe[16]=tt=>Io.value=!1),onStatusChange:D(Mn),onOpenAddNote:D(Yi)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ae(jt,{show:D(Uo),title:"Add update",size:"small",onClose:D(as)},{footer:Ve(()=>[l("div",fz,[l("button",{type:"button",class:"btn btn-secondary",onClick:Pe[18]||(Pe[18]=(...tt)=>D(as)&&D(as)(...tt))}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Pe[19]||(Pe[19]=(...tt)=>D($o)&&D($o)(...tt)),disabled:!D(mo).trim()||D(Js)},w(D(Js)?"Adding...":"Add update"),9,pz)])]),default:Ve(()=>[l("div",hz,[Ue(l("textarea",{"onUpdate:modelValue":Pe[17]||(Pe[17]=tt=>Qt(mo)?mo.value=tt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,D(mo)]])])]),_:1},8,["show","onClose"]),Ae($a,{show:So.value,title:ws.value,message:fo.value,onConfirm:hi,onCancel:el},null,8,["show","title","message"]),Ae($a,{show:eo.value,title:xo.value,message:pn.value,"show-cancel":!1,onConfirm:Ba},null,8,["show","title","message"]),Ae(cB,{show:D(No),checkpoint:D(zn),"accent-button-style":D(Xe),onDismiss:Pe[20]||(Pe[20]=tt=>D(Ks)(D(zn)?.id)),onGoToCheckpoint:ta},null,8,["show","checkpoint","accent-button-style"]),Ae(DB,{show:D(yt),assignment:D(xt),"user-location":D(Ke),"auto-update-enabled":D(ct),updating:D(Rt),error:D(kt),success:D(Ut),"available-checkpoints":Qi.value,"accent-button-style":D(Xe),onClose:D(Bt),onUpdateGps:D(Xn),onToggleAutoUpdate:Pe[21]||(Pe[21]=tt=>D(Kt)(D(xt))),onSelectOnMap:re,onCopyFromCheckpoint:D(kn)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},gz=Ge(mz,[["__scopeId","data-v-735fa489"]]),yz={class:"form-group"},kz={class:"form-group"},_z={class:"form-group"},bz={class:"actions-left"},wz={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,s=M({name:"",email:"",phone:""});Ze(()=>o.profile,f=>{f&&(s.value={name:f.name||"",email:f.email||"",phone:f.phone||""})},{immediate:!0,deep:!0}),Ze(()=>o.show,f=>{f&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},r=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}a("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(f,p)=>(v(),qe(jt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ve(()=>[l("div",bz,[e.showLogout?(v(),m("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):E("",!0)]),l("button",{type:"button",onClick:r,class:"btn btn-success"}," Save ")]),default:Ve(()=>[l("form",{onSubmit:it(r,["prevent"])},[l("div",yz,[p[3]||(p[3]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>s.value.name=g),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[at,s.value.name]])]),l("div",kz,[p[4]||(p[4]=l("label",null,"Email *",-1)),Ue(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>s.value.email=g),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[at,s.value.email]])]),l("div",_z,[p[5]||(p[5]=l("label",null,"Phone",-1)),Ue(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>s.value.phone=g),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[at,s.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},Cz=Ge(wz,[["__scopeId","data-v-178e5f48"]]),Lz={class:"tabs"},Sz={class:"tab-content"},xz={class:"form-group"},Iz={class:"form-group"},$z={class:"form-group"},Tz={class:"form-group"},Mz=["value"],Az={class:"tab-content"},Ez={class:"emergency-contacts-section"},Pz={key:0,class:"empty-state"},Dz={class:"card-header"},Oz=["onClick"],Rz={class:"form-group"},Bz=["onUpdate:modelValue"],Nz={class:"form-group"},Fz=["onUpdate:modelValue"],Uz={class:"form-group"},zz=["onUpdate:modelValue"],Hz={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:s,switchTab:i,resetTab:r}=zv("basic",["basic","emergency"]),u=M({...o.eventData});Ze(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ze(()=>o.show,y=>{y&&r()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},f=y=>{u.value.emergencyContacts.splice(y,1)},p=()=>{a("submit",{...u.value})},g=()=>{a("close")};return(y,k)=>(v(),qe(jt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":Ve(()=>[l("div",Lz,[l("button",{type:"button",onClick:k[0]||(k[0]=b=>D(i)("basic")),class:ve(["tab-button",{active:D(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:k[1]||(k[1]=b=>D(i)("emergency")),class:ve(["tab-button",{active:D(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ve(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-success"}," Save ")]),default:Ve(()=>[l("form",{onSubmit:it(p,["prevent"])},[Ue(l("div",Sz,[l("div",xz,[k[6]||(k[6]=l("label",null,"Event name *",-1)),Ue(l("input",{"onUpdate:modelValue":k[2]||(k[2]=b=>u.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[at,u.value.name]])]),l("div",Iz,[k[7]||(k[7]=l("label",null,"Description",-1)),Ue(l("textarea",{"onUpdate:modelValue":k[3]||(k[3]=b=>u.value.description=b),rows:"3",class:"form-input"},null,512),[[at,u.value.description]])]),l("div",$z,[k[8]||(k[8]=l("label",null,"Event date *",-1)),Ue(l("input",{"onUpdate:modelValue":k[4]||(k[4]=b=>u.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[at,u.value.eventDate]])]),l("div",Tz,[k[9]||(k[9]=l("label",null,"Time zone *",-1)),Ue(l("select",{"onUpdate:modelValue":k[5]||(k[5]=b=>u.value.timeZoneId=b),required:"",class:"form-input"},[(v(!0),m(Ie,null,Fe(D(Kv),b=>(v(),m("option",{key:b.value,value:b.value},w(b.label),9,Mz))),128))],512),[[Nn,u.value.timeZoneId]])])],512),[[ks,D(s)==="basic"]]),Ue(l("div",Az,[l("div",Ez,[l("div",{class:"section-header-small"},[k[10]||(k[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",Pz,[...k[11]||(k[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):E("",!0),(v(!0),m(Ie,null,Fe(u.value.emergencyContacts,(b,C)=>(v(),m("div",{key:C,class:"emergency-contact-card"},[l("div",Dz,[l("h4",null,"Contact "+w(C+1),1),l("button",{type:"button",onClick:x=>f(C),class:"btn-remove"},"  ",8,Oz)]),l("div",Rz,[k[12]||(k[12]=l("label",null,"Name *",-1)),Ue(l("input",{"onUpdate:modelValue":x=>b.name=x,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Bz),[[at,b.name]])]),l("div",Nz,[k[13]||(k[13]=l("label",null,"Phone *",-1)),Ue(l("input",{"onUpdate:modelValue":x=>b.phone=x,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Fz),[[at,b.phone]])]),l("div",Uz,[k[14]||(k[14]=l("label",null,"Additional details",-1)),Ue(l("textarea",{"onUpdate:modelValue":x=>b.details=x,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,zz),[[at,b.details]])])]))),128))])],512),[[ks,D(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Vz=Ge(Hz,[["__scopeId","data-v-d820eb4f"]]),Gz=Xu("profile",()=>{const e=M(null),t=M(!1),o=M(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await pr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const f=await pr.updateProfile(d);return e.value=f.data,f.data}catch(f){throw o.value=f.response?.data?.message||"Failed to update profile",f}finally{t.value=!1}},fetchPerson:async(d,f)=>{t.value=!0,o.value=null;try{return(await pr.getPerson(d,f)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(d,f,p)=>{t.value=!0,o.value=null;try{return(await pr.updatePerson(d,f,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),jz={class:"sessions-view"},Zz={class:"sessions-container"},Wz={key:0,class:"loading-state"},qz={key:1,class:"empty-state"},Kz={key:2,class:"sessions-list"},Jz={class:"section-header"},Yz={class:"section-actions"},Xz=["onClick"],Qz={class:"session-info"},eH={class:"event-name"},tH={key:0,class:"event-date"},nH={key:1,class:"sign-in-section"},oH={key:2,class:"section-header"},sH=["onClick"],aH={class:"session-info"},iH={class:"event-name"},lH={class:"role-name"},rH={key:0,class:"event-date"},cH=["onClick"],uH={class:"modal-card"},dH={class:"modal-actions"},hH={class:"modal-card"},fH={class:"modal-actions"},pH={__name:"SessionsView",setup(e){const t=Zi(),o=Kl(),a=Uv(),s=Gz(),i=M([]),r=M([]),u=M(!0),d=M(!1),f=M(!1),p=M(!1),g=M(!1),y=M(null),k=M(!1),b=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),C=F(()=>localStorage.getItem("adminEmail")),x=F(()=>!!C.value),$=()=>{i.value=ak()},I=oe=>{iv(oe.eventId,oe.marshalId),t.push(`/event/${oe.eventId}`)},S=oe=>{y.value=oe,p.value=!0},B=async()=>{if(!y.value)return;const{sessionKey:oe,eventId:U}=y.value;try{_o("marshal",U),await authApi.logout()}catch{}ku(oe),_o(null),$(),p.value=!1,y.value=null},R=()=>{g.value=!0},Z=async()=>{await o.logout(),r.value=[],g.value=!1},A=async()=>{if(f.value=!0,!s.profile)try{await s.fetchProfile()}catch(oe){console.error("Failed to load profile:",oe)}},N=async oe=>{try{await s.updateProfile(oe),f.value=!1}catch(U){console.error("Failed to save profile:",U),alert("Failed to save profile. Please try again.")}},O=async()=>{await o.logout(),r.value=[],f.value=!1},V=oe=>oe?new Date(oe).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",P=async()=>{if(x.value)try{_o("admin");const oe=await _a.getAll();r.value=oe.data||[]}catch(oe){console.error("Failed to load admin events:",oe),r.value=[]}},j=oe=>{t.push(`/admin/event/${oe}`)},Q=()=>{t.push("/")},ae=()=>{},pe=()=>{k.value=!1,b.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},ne=async oe=>{try{const U={...oe,adminEmail:o.adminEmail};await a.createEvent(U),pe(),await P()}catch(U){console.error("Failed to create event:",U),alert("Failed to create event. Please try again.")}};return tn(async()=>{document.title="OnTheDay App - Sessions",rv(),lv(),$(),await P(),u.value=!1}),(oe,U)=>(v(),m("div",jz,[l("div",Zz,[Ae(Nv,{title:"Your sessions"}),u.value?(v(),m("div",Wz,[...U[9]||(U[9]=[l("p",null,"Loading sessions...",-1)])])):i.value.length===0&&r.value.length===0?(v(),m("div",qz,[U[10]||(U[10]=l("p",null,"No active sessions.",-1)),U[11]||(U[11]=l("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),l("button",{class:"btn btn-primary",onClick:U[0]||(U[0]=Y=>d.value=!0)}," Sign in ")])):(v(),m("div",Kz,[x.value?(v(),m(Ie,{key:0},[l("div",Jz,[U[12]||(U[12]=l("span",{class:"section-label"},"Admin events",-1)),l("div",Yz,[l("button",{class:"btn btn-small btn-primary",onClick:A}," Profile "),l("button",{class:"btn btn-small btn-primary",onClick:U[1]||(U[1]=Y=>k.value=!0)}," Create event ")])]),(v(!0),m(Ie,null,Fe(r.value,Y=>(v(),m("div",{key:"admin-"+Y.id,class:"session-card admin-card",onClick:de=>j(Y.id)},[U[14]||(U[14]=l("div",{class:"card-icon admin-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),l("div",Qz,[l("div",eH,w(Y.name),1),U[13]||(U[13]=l("div",{class:"role-name"},"Admin",-1)),Y.eventDate?(v(),m("div",tH,w(V(Y.eventDate)),1)):E("",!0)]),l("button",{class:"btn-logout",onClick:it(R,["stop"]),title:"Log out as admin"},"  ")],8,Xz))),128))],64)):(v(),m("div",nH,[l("button",{class:"btn btn-primary",onClick:U[2]||(U[2]=Y=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),m("div",oH,[...U[15]||(U[15]=[l("span",{class:"section-label"},"Marshal sessions",-1)])])):E("",!0),(v(!0),m(Ie,null,Fe(i.value,Y=>(v(),m("div",{key:Y.sessionKey,class:"session-card",onClick:de=>I(Y)},[U[16]||(U[16]=l("div",{class:"card-icon marshal-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),l("div",aH,[l("div",iH,w(Y.eventName||"Event"),1),l("div",lH,w(Y.marshalName||"Marshal"),1),Y.eventDate?(v(),m("div",rH,w(V(Y.eventDate)),1)):E("",!0)]),l("button",{class:"btn-logout",onClick:it(de=>S(Y),["stop"]),title:"Log out from this session"},"  ",8,cH)],8,sH))),128))])),l("button",{class:"btn-back-home",onClick:Q,title:"Back to home"},"  ")]),Ae(Fv,{show:d.value,onClose:U[3]||(U[3]=Y=>d.value=!1),onSuccess:ae},null,8,["show"]),Ae(Cz,{show:f.value,profile:D(s).profile,"show-logout":!0,onClose:U[4]||(U[4]=Y=>f.value=!1),onSubmit:N,onLogout:O},null,8,["show","profile"]),Ae(Vz,{show:k.value,"event-data":b.value,"is-editing":!1,onClose:pe,onSubmit:ne},null,8,["show","event-data"]),(v(),qe(Pl,{to:"body"},[Ae(ys,{name:"modal"},{default:Ve(()=>[g.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[6]||(U[6]=it(Y=>g.value=!1,["self"]))},[l("div",uH,[U[17]||(U[17]=l("h3",null,"Log out as admin?",-1)),U[18]||(U[18]=l("p",null,"This will log you out from all admin events.",-1)),U[19]||(U[19]=l("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),l("div",dH,[l("button",{class:"btn btn-secondary",onClick:U[5]||(U[5]=Y=>g.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:Z},"Log out")])])])):E("",!0)]),_:1})])),(v(),qe(Pl,{to:"body"},[Ae(ys,{name:"modal"},{default:Ve(()=>[p.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[8]||(U[8]=it(Y=>p.value=!1,["self"]))},[l("div",hH,[U[22]||(U[22]=l("h3",null,"Log out from session?",-1)),l("p",null,[U[20]||(U[20]=Ye("This will log you out from ",-1)),l("strong",null,w(y.value?.eventName||"this event"),1),U[21]||(U[21]=Ye(".",-1))]),U[23]||(U[23]=l("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),l("div",fH,[l("button",{class:"btn btn-secondary",onClick:U[7]||(U[7]=Y=>p.value=!1)},"Cancel"),l("button",{class:"btn btn-danger",onClick:B},"Log out")])])])):E("",!0)]),_:1})]))]))}},vH=Ge(pH,[["__scopeId","data-v-add55e1c"]]);let gf=!1;function mH(){gf||(gf=!0,rv(),lv())}const gH=[{path:"/",name:"Home",component:pb},{path:"/admin/login",name:"AdminLogin",component:wb},{path:"/admin/verify",name:"AdminVerify",component:Tb},{path:"/sessions",name:"Sessions",component:vH},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:wR,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:gz},{path:"/:pathMatch(.*)*",redirect:"/"}],sm=nk({history:D1("/VolunteerCheckin/testing/"),routes:gH});sm.beforeEach((e,t,o)=>{mH();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?_o("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&_o(null),e.name==="MarshalView"){const s=e.params.eventId,i=!!e.query.code,r=Fr(s),u=r?.marshalId?uv(s,r.marshalId):null;if(i){o();return}if(r?.token){o();return}if(u){o();return}if(cv()){o({name:"Sessions"});return}}o()});Ws().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const dd=zy(ok);dd.use(Gy());dd.use(sm);dd.mount("#app");
